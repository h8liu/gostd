<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3605360">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3605415">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3605469">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3605520">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="3605580">package</span>&nbsp;<span class="ident" id="3605588">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3605594">import</span>&nbsp;<span class="op" id="3605601">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605604">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605613">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605623">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605637">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605653">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605672">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605686">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605701">_</span>&nbsp;<span class="string" id="3605703">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605720">_</span>&nbsp;<span class="string" id="3605722">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605739">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605759">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605776">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605792">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605802">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605808">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605820">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605827">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3605838">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3605845">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3605848">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="3605928">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="3605944">type</span>&nbsp;<span class="ident" id="3605949">pkixPublicKey</span>&nbsp;<span class="keyword" id="3605963">struct</span>&nbsp;<span class="op" id="3605970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605973">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605983">pkix</span><span class="op" id="3605987">.</span><span class="ident" id="3605988">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606009">BitString</span>&nbsp;<span class="ident" id="3606019">asn1</span><span class="op" id="3606023">.</span><span class="ident" id="3606024">BitString</span><br>
<span class="lineno"></span><span class="op" id="3606034">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3606037">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3606109">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3606167">func</span>&nbsp;<span class="ident" id="3606172">ParsePKIXPublicKey</span><span class="op" id="3606190">(</span><span class="ident" id="3606191">derBytes</span>&nbsp;<span class="op" id="3606200">[</span><span class="op" id="3606201">]</span><span class="builtintype" id="3606202">byte</span><span class="op" id="3606206">)</span>&nbsp;<span class="op" id="3606208">(</span><span class="ident" id="3606209">pub</span>&nbsp;<span class="keyword" id="3606213">interface</span><span class="op" id="3606222">{</span><span class="op" id="3606223">}</span><span class="op" id="3606224">,</span>&nbsp;<span class="ident" id="3606226">err</span>&nbsp;<span class="builtintype" id="3606230">error</span><span class="op" id="3606235">)</span>&nbsp;<span class="op" id="3606237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606240">var</span>&nbsp;<span class="ident" id="3606244">pki</span>&nbsp;<span class="ident" id="3606248">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606263">if</span>&nbsp;<span class="ident" id="3606266">_</span><span class="op" id="3606267">,</span>&nbsp;<span class="ident" id="3606269">err</span>&nbsp;<span class="op" id="3606273">=</span>&nbsp;<span class="ident" id="3606275">asn1</span><span class="op" id="3606279">.</span><span class="ident" id="3606280">Unmarshal</span><span class="op" id="3606289">(</span><span class="ident" id="3606290">derBytes</span><span class="op" id="3606298">,</span>&nbsp;<span class="op" id="3606300">&amp;</span><span class="ident" id="3606301">pki</span><span class="op" id="3606304">)</span><span class="op" id="3606305">;</span>&nbsp;<span class="ident" id="3606307">err</span>&nbsp;<span class="op" id="3606311">!=</span>&nbsp;<span class="ident" id="3606314">nil</span>&nbsp;<span class="op" id="3606318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3606330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606333">algo</span>&nbsp;<span class="op" id="3606338">:=</span>&nbsp;<span class="ident" id="3606341">getPublicKeyAlgorithmFromOID</span><span class="op" id="3606369">(</span><span class="ident" id="3606370">pki</span><span class="op" id="3606373">.</span><span class="ident" id="3606374">Algorithm</span><span class="op" id="3606383">.</span><span class="ident" id="3606384">Algorithm</span><span class="op" id="3606393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606396">if</span>&nbsp;<span class="ident" id="3606399">algo</span>&nbsp;<span class="op" id="3606404">==</span>&nbsp;<span class="ident" id="3606407">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="3606433">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606437">return</span>&nbsp;<span class="ident" id="3606444">nil</span><span class="op" id="3606447">,</span>&nbsp;<span class="ident" id="3606449">errors</span><span class="op" id="3606455">.</span><span class="ident" id="3606456">New</span><span class="op" id="3606459">(</span><span class="string" id="3606460">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="3606496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3606499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606502">return</span>&nbsp;<span class="ident" id="3606509">parsePublicKey</span><span class="op" id="3606523">(</span><span class="ident" id="3606524">algo</span><span class="op" id="3606528">,</span>&nbsp;<span class="op" id="3606530">&amp;</span><span class="ident" id="3606531">pki</span><span class="op" id="3606534">)</span><br>
<span class="lineno"></span><span class="op" id="3606536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="3606539">func</span>&nbsp;<span class="ident" id="3606544">marshalPublicKey</span><span class="op" id="3606560">(</span><span class="ident" id="3606561">pub</span>&nbsp;<span class="keyword" id="3606565">interface</span><span class="op" id="3606574">{</span><span class="op" id="3606575">}</span><span class="op" id="3606576">)</span>&nbsp;<span class="op" id="3606578">(</span><span class="ident" id="3606579">publicKeyBytes</span>&nbsp;<span class="op" id="3606594">[</span><span class="op" id="3606595">]</span><span class="builtintype" id="3606596">byte</span><span class="op" id="3606600">,</span>&nbsp;<span class="ident" id="3606602">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3606621">pkix</span><span class="op" id="3606625">.</span><span class="ident" id="3606626">AlgorithmIdentifier</span><span class="op" id="3606645">,</span>&nbsp;<span class="ident" id="3606647">err</span>&nbsp;<span class="builtintype" id="3606651">error</span><span class="op" id="3606656">)</span>&nbsp;<span class="op" id="3606658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606661">switch</span>&nbsp;<span class="ident" id="3606668">pub</span>&nbsp;<span class="op" id="3606672">:=</span>&nbsp;<span class="ident" id="3606675">pub</span><span class="op" id="3606678">.</span><span class="op" id="3606679">(</span><span class="keyword" id="3606680">type</span><span class="op" id="3606684">)</span>&nbsp;<span class="op" id="3606686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606689">case</span>&nbsp;<span class="op" id="3606694">*</span><span class="ident" id="3606695">rsa</span><span class="op" id="3606698">.</span><span class="ident" id="3606699">PublicKey</span><span class="op" id="3606708">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606712">publicKeyBytes</span><span class="op" id="3606726">,</span>&nbsp;<span class="ident" id="3606728">err</span>&nbsp;<span class="op" id="3606732">=</span>&nbsp;<span class="ident" id="3606734">asn1</span><span class="op" id="3606738">.</span><span class="ident" id="3606739">Marshal</span><span class="op" id="3606746">(</span><span class="ident" id="3606747">rsaPublicKey</span><span class="op" id="3606759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606764">N</span><span class="op" id="3606765">:</span>&nbsp;<span class="ident" id="3606767">pub</span><span class="op" id="3606770">.</span><span class="ident" id="3606771">N</span><span class="op" id="3606772">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606777">E</span><span class="op" id="3606778">:</span>&nbsp;<span class="ident" id="3606780">pub</span><span class="op" id="3606783">.</span><span class="ident" id="3606784">E</span><span class="op" id="3606785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3606789">}</span><span class="op" id="3606790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606794">publicKeyAlgorithm</span><span class="op" id="3606812">.</span><span class="ident" id="3606813">Algorithm</span>&nbsp;<span class="op" id="3606823">=</span>&nbsp;<span class="ident" id="3606825">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606843">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606901">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606959">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607010">publicKeyAlgorithm</span><span class="op" id="3607028">.</span><span class="ident" id="3607029">Parameters</span>&nbsp;<span class="op" id="3607040">=</span>&nbsp;<span class="ident" id="3607042">asn1</span><span class="op" id="3607046">.</span><span class="ident" id="3607047">RawValue</span><span class="op" id="3607055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607060">Tag</span><span class="op" id="3607063">:</span>&nbsp;<span class="num" id="3607065">5</span><span class="op" id="3607066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607073">case</span>&nbsp;<span class="op" id="3607078">*</span><span class="ident" id="3607079">ecdsa</span><span class="op" id="3607084">.</span><span class="ident" id="3607085">PublicKey</span><span class="op" id="3607094">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607098">publicKeyBytes</span>&nbsp;<span class="op" id="3607113">=</span>&nbsp;<span class="ident" id="3607115">elliptic</span><span class="op" id="3607123">.</span><span class="ident" id="3607124">Marshal</span><span class="op" id="3607131">(</span><span class="ident" id="3607132">pub</span><span class="op" id="3607135">.</span><span class="ident" id="3607136">Curve</span><span class="op" id="3607141">,</span>&nbsp;<span class="ident" id="3607143">pub</span><span class="op" id="3607146">.</span><span class="ident" id="3607147">X</span><span class="op" id="3607148">,</span>&nbsp;<span class="ident" id="3607150">pub</span><span class="op" id="3607153">.</span><span class="ident" id="3607154">Y</span><span class="op" id="3607155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607159">oid</span><span class="op" id="3607162">,</span>&nbsp;<span class="ident" id="3607164">ok</span>&nbsp;<span class="op" id="3607167">:=</span>&nbsp;<span class="ident" id="3607170">oidFromNamedCurve</span><span class="op" id="3607187">(</span><span class="ident" id="3607188">pub</span><span class="op" id="3607191">.</span><span class="ident" id="3607192">Curve</span><span class="op" id="3607197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607201">if</span>&nbsp;<span class="op" id="3607204">!</span><span class="ident" id="3607205">ok</span>&nbsp;<span class="op" id="3607208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607213">return</span>&nbsp;<span class="ident" id="3607220">nil</span><span class="op" id="3607223">,</span>&nbsp;<span class="ident" id="3607225">pkix</span><span class="op" id="3607229">.</span><span class="ident" id="3607230">AlgorithmIdentifier</span><span class="op" id="3607249">{</span><span class="op" id="3607250">}</span><span class="op" id="3607251">,</span>&nbsp;<span class="ident" id="3607253">errors</span><span class="op" id="3607259">.</span><span class="ident" id="3607260">New</span><span class="op" id="3607263">(</span><span class="string" id="3607264">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3607298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607302">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607306">publicKeyAlgorithm</span><span class="op" id="3607324">.</span><span class="ident" id="3607325">Algorithm</span>&nbsp;<span class="op" id="3607335">=</span>&nbsp;<span class="ident" id="3607337">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607357">var</span>&nbsp;<span class="ident" id="3607361">paramBytes</span>&nbsp;<span class="op" id="3607372">[</span><span class="op" id="3607373">]</span><span class="builtintype" id="3607374">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607381">paramBytes</span><span class="op" id="3607391">,</span>&nbsp;<span class="ident" id="3607393">err</span>&nbsp;<span class="op" id="3607397">=</span>&nbsp;<span class="ident" id="3607399">asn1</span><span class="op" id="3607403">.</span><span class="ident" id="3607404">Marshal</span><span class="op" id="3607411">(</span><span class="ident" id="3607412">oid</span><span class="op" id="3607415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607419">if</span>&nbsp;<span class="ident" id="3607422">err</span>&nbsp;<span class="op" id="3607426">!=</span>&nbsp;<span class="ident" id="3607429">nil</span>&nbsp;<span class="op" id="3607433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607438">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607451">publicKeyAlgorithm</span><span class="op" id="3607469">.</span><span class="ident" id="3607470">Parameters</span><span class="op" id="3607480">.</span><span class="ident" id="3607481">FullBytes</span>&nbsp;<span class="op" id="3607491">=</span>&nbsp;<span class="ident" id="3607493">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607505">default</span><span class="op" id="3607512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607516">return</span>&nbsp;<span class="ident" id="3607523">nil</span><span class="op" id="3607526">,</span>&nbsp;<span class="ident" id="3607528">pkix</span><span class="op" id="3607532">.</span><span class="ident" id="3607533">AlgorithmIdentifier</span><span class="op" id="3607552">{</span><span class="op" id="3607553">}</span><span class="op" id="3607554">,</span>&nbsp;<span class="ident" id="3607556">errors</span><span class="op" id="3607562">.</span><span class="ident" id="3607563">New</span><span class="op" id="3607566">(</span><span class="string" id="3607567">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="3607615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607618">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607622">return</span>&nbsp;<span class="ident" id="3607629">publicKeyBytes</span><span class="op" id="3607643">,</span>&nbsp;<span class="ident" id="3607645">publicKeyAlgorithm</span><span class="op" id="3607663">,</span>&nbsp;<span class="ident" id="3607665">nil</span><br>
<span class="lineno"></span><span class="op" id="3607669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3607672">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="3607748">func</span>&nbsp;<span class="ident" id="3607753">MarshalPKIXPublicKey</span><span class="op" id="3607773">(</span><span class="ident" id="3607774">pub</span>&nbsp;<span class="keyword" id="3607778">interface</span><span class="op" id="3607787">{</span><span class="op" id="3607788">}</span><span class="op" id="3607789">)</span>&nbsp;<span class="op" id="3607791">(</span><span class="op" id="3607792">[</span><span class="op" id="3607793">]</span><span class="builtintype" id="3607794">byte</span><span class="op" id="3607798">,</span>&nbsp;<span class="builtintype" id="3607800">error</span><span class="op" id="3607805">)</span>&nbsp;<span class="op" id="3607807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607810">var</span>&nbsp;<span class="ident" id="3607814">publicKeyBytes</span>&nbsp;<span class="op" id="3607829">[</span><span class="op" id="3607830">]</span><span class="builtintype" id="3607831">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607837">var</span>&nbsp;<span class="ident" id="3607841">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3607860">pkix</span><span class="op" id="3607864">.</span><span class="ident" id="3607865">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607886">var</span>&nbsp;<span class="ident" id="3607890">err</span>&nbsp;<span class="builtintype" id="3607894">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607902">if</span>&nbsp;<span class="ident" id="3607905">publicKeyBytes</span><span class="op" id="3607919">,</span>&nbsp;<span class="ident" id="3607921">publicKeyAlgorithm</span><span class="op" id="3607939">,</span>&nbsp;<span class="ident" id="3607941">err</span>&nbsp;<span class="op" id="3607945">=</span>&nbsp;<span class="ident" id="3607947">marshalPublicKey</span><span class="op" id="3607963">(</span><span class="ident" id="3607964">pub</span><span class="op" id="3607967">)</span><span class="op" id="3607968">;</span>&nbsp;<span class="ident" id="3607970">err</span>&nbsp;<span class="op" id="3607974">!=</span>&nbsp;<span class="ident" id="3607977">nil</span>&nbsp;<span class="op" id="3607981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607985">return</span>&nbsp;<span class="ident" id="3607992">nil</span><span class="op" id="3607995">,</span>&nbsp;<span class="ident" id="3607997">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608006">pkix</span>&nbsp;<span class="op" id="3608011">:=</span>&nbsp;<span class="ident" id="3608014">pkixPublicKey</span><span class="op" id="3608027">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608031">Algo</span><span class="op" id="3608035">:</span>&nbsp;<span class="ident" id="3608037">publicKeyAlgorithm</span><span class="op" id="3608055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608059">BitString</span><span class="op" id="3608068">:</span>&nbsp;<span class="ident" id="3608070">asn1</span><span class="op" id="3608074">.</span><span class="ident" id="3608075">BitString</span><span class="op" id="3608084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608089">Bytes</span><span class="op" id="3608094">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608100">publicKeyBytes</span><span class="op" id="3608114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608119">BitLength</span><span class="op" id="3608128">:</span>&nbsp;<span class="num" id="3608130">8</span>&nbsp;<span class="op" id="3608132">*</span>&nbsp;<span class="builtinfunc" id="3608134">len</span><span class="op" id="3608137">(</span><span class="ident" id="3608138">publicKeyBytes</span><span class="op" id="3608152">)</span><span class="op" id="3608153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608157">}</span><span class="op" id="3608158">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608165">ret</span><span class="op" id="3608168">,</span>&nbsp;<span class="ident" id="3608170">_</span>&nbsp;<span class="op" id="3608172">:=</span>&nbsp;<span class="ident" id="3608175">asn1</span><span class="op" id="3608179">.</span><span class="ident" id="3608180">Marshal</span><span class="op" id="3608187">(</span><span class="ident" id="3608188">pkix</span><span class="op" id="3608192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608195">return</span>&nbsp;<span class="ident" id="3608202">ret</span><span class="op" id="3608205">,</span>&nbsp;<span class="ident" id="3608207">nil</span><br>
<span class="lineno"></span><span class="op" id="3608211">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3608214">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3608287">type</span>&nbsp;<span class="ident" id="3608292">certificate</span>&nbsp;<span class="keyword" id="3608304">struct</span>&nbsp;<span class="op" id="3608311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608314">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608333">asn1</span><span class="op" id="3608337">.</span><span class="ident" id="3608338">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608350">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608369">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608385">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3608404">pkix</span><span class="op" id="3608408">.</span><span class="ident" id="3608409">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608430">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608449">asn1</span><span class="op" id="3608453">.</span><span class="ident" id="3608454">BitString</span><br>
<span class="lineno"></span><span class="op" id="3608464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3608467">type</span>&nbsp;<span class="ident" id="3608472">tbsCertificate</span>&nbsp;<span class="keyword" id="3608487">struct</span>&nbsp;<span class="op" id="3608494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608497">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608516">asn1</span><span class="op" id="3608520">.</span><span class="ident" id="3608521">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608533">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3608552">int</span>&nbsp;<span class="string" id="3608556">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608600">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3608619">*</span><span class="ident" id="3608620">big</span><span class="op" id="3608623">.</span><span class="ident" id="3608624">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608629">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3608648">pkix</span><span class="op" id="3608652">.</span><span class="ident" id="3608653">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608674">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608693">asn1</span><span class="op" id="3608697">.</span><span class="ident" id="3608698">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608708">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608727">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608737">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608756">asn1</span><span class="op" id="3608760">.</span><span class="ident" id="3608761">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608771">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608790">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608805">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608824">asn1</span><span class="op" id="3608828">.</span><span class="ident" id="3608829">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3608841">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608866">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608885">asn1</span><span class="op" id="3608889">.</span><span class="ident" id="3608890">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3608902">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608927">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3608946">[</span><span class="op" id="3608947">]</span><span class="ident" id="3608948">pkix</span><span class="op" id="3608952">.</span><span class="ident" id="3608953">Extension</span>&nbsp;<span class="string" id="3608963">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3608996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3608999">type</span>&nbsp;<span class="ident" id="3609004">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="3609027">struct</span>&nbsp;<span class="op" id="3609034">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609037">P</span><span class="op" id="3609038">,</span>&nbsp;<span class="ident" id="3609040">Q</span><span class="op" id="3609041">,</span>&nbsp;<span class="ident" id="3609043">G</span>&nbsp;<span class="op" id="3609045">*</span><span class="ident" id="3609046">big</span><span class="op" id="3609049">.</span><span class="ident" id="3609050">Int</span><br>
<span class="lineno"></span><span class="op" id="3609054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3609057">type</span>&nbsp;<span class="ident" id="3609062">dsaSignature</span>&nbsp;<span class="keyword" id="3609075">struct</span>&nbsp;<span class="op" id="3609082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609085">R</span><span class="op" id="3609086">,</span>&nbsp;<span class="ident" id="3609088">S</span>&nbsp;<span class="op" id="3609090">*</span><span class="ident" id="3609091">big</span><span class="op" id="3609094">.</span><span class="ident" id="3609095">Int</span><br>
<span class="lineno">135</span><span class="op" id="3609099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3609102">type</span>&nbsp;<span class="ident" id="3609107">ecdsaSignature</span>&nbsp;<span class="ident" id="3609122">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3609136">type</span>&nbsp;<span class="ident" id="3609141">validity</span>&nbsp;<span class="keyword" id="3609150">struct</span>&nbsp;<span class="op" id="3609157">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609160">NotBefore</span><span class="op" id="3609169">,</span>&nbsp;<span class="ident" id="3609171">NotAfter</span>&nbsp;<span class="ident" id="3609180">time</span><span class="op" id="3609184">.</span><span class="ident" id="3609185">Time</span><br>
<span class="lineno"></span><span class="op" id="3609190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3609193">type</span>&nbsp;<span class="ident" id="3609198">publicKeyInfo</span>&nbsp;<span class="keyword" id="3609212">struct</span>&nbsp;<span class="op" id="3609219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609222">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609232">asn1</span><span class="op" id="3609236">.</span><span class="ident" id="3609237">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609249">Algorithm</span>&nbsp;<span class="ident" id="3609259">pkix</span><span class="op" id="3609263">.</span><span class="ident" id="3609264">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609285">PublicKey</span>&nbsp;<span class="ident" id="3609295">asn1</span><span class="op" id="3609299">.</span><span class="ident" id="3609300">BitString</span><br>
<span class="lineno"></span><span class="op" id="3609310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3609313">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="3609335">type</span>&nbsp;<span class="ident" id="3609340">authKeyId</span>&nbsp;<span class="keyword" id="3609350">struct</span>&nbsp;<span class="op" id="3609357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609360">Id</span>&nbsp;<span class="op" id="3609363">[</span><span class="op" id="3609364">]</span><span class="builtintype" id="3609365">byte</span>&nbsp;<span class="string" id="3609370">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3609394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3609397">type</span>&nbsp;<span class="ident" id="3609402">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="3609421">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="3609426">const</span>&nbsp;<span class="op" id="3609432">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609435">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="3609461">SignatureAlgorithm</span>&nbsp;<span class="op" id="3609480">=</span>&nbsp;<span class="ident" id="3609482">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609488">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609500">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609512">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609525">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609540">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609555">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609570">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609583">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609598">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609613">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609630">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609647">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="3609663">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3609666">type</span>&nbsp;<span class="ident" id="3609671">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="3609690">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3609695">const</span>&nbsp;<span class="op" id="3609701">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609704">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3609730">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3609749">=</span>&nbsp;<span class="ident" id="3609751">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609757">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609762">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609767">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="3609773">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="3609776">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3609809">//</span><br>
<span class="lineno"></span><span class="comment" id="3609812">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3609846">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="3609909">//</span><br>
<span class="lineno"></span><span class="comment" id="3609912">//</span><br>
<span class="lineno"></span><span class="comment" id="3609915">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3609958">//</span><br>
<span class="lineno"></span><span class="comment" id="3609961">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="3610020">//</span><br>
<span class="lineno"></span><span class="comment" id="3610023">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3610082">//</span><br>
<span class="lineno"></span><span class="comment" id="3610085">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3610146">//</span><br>
<span class="lineno">195</span><span class="comment" id="3610149">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3610188">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3610249">//</span><br>
<span class="lineno"></span><span class="comment" id="3610252">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3610296">//</span><br>
<span class="lineno">200</span><span class="comment" id="3610299">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3610342">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="3610395">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="3610435">//</span><br>
<span class="lineno"></span><span class="comment" id="3610438">//</span><br>
<span class="lineno">205</span><span class="comment" id="3610441">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="3610475">//</span><br>
<span class="lineno"></span><span class="comment" id="3610478">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3610541">//</span><br>
<span class="lineno"></span><span class="comment" id="3610544">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="3610607">//</span><br>
<span class="lineno"></span><span class="comment" id="3610610">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3610673">//</span><br>
<span class="lineno"></span><span class="comment" id="3610676">//</span><br>
<span class="lineno"></span><span class="comment" id="3610679">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="3610720">//</span><br>
<span class="lineno"></span><span class="comment" id="3610723">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3610764">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="3610834">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="3610885">//</span><br>
<span class="lineno">220</span><span class="comment" id="3610888">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3610930">//</span><br>
<span class="lineno"></span><span class="comment" id="3610933">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3611000">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3611069">//</span><br>
<span class="lineno">225</span><span class="comment" id="3611072">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3611139">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3611208">//</span><br>
<span class="lineno"></span><span class="comment" id="3611211">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3611278">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3611348">var</span>&nbsp;<span class="op" id="3611352">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3611355">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611383">=</span>&nbsp;<span class="ident" id="3611385">asn1</span><span class="op" id="3611389">.</span><span class="ident" id="3611390">ObjectIdentifier</span><span class="op" id="3611406">{</span><span class="num" id="3611407">1</span><span class="op" id="3611408">,</span>&nbsp;<span class="num" id="3611410">2</span><span class="op" id="3611411">,</span>&nbsp;<span class="num" id="3611413">840</span><span class="op" id="3611416">,</span>&nbsp;<span class="num" id="3611418">113549</span><span class="op" id="3611424">,</span>&nbsp;<span class="num" id="3611426">1</span><span class="op" id="3611427">,</span>&nbsp;<span class="num" id="3611429">1</span><span class="op" id="3611430">,</span>&nbsp;<span class="num" id="3611432">2</span><span class="op" id="3611433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3611436">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611464">=</span>&nbsp;<span class="ident" id="3611466">asn1</span><span class="op" id="3611470">.</span><span class="ident" id="3611471">ObjectIdentifier</span><span class="op" id="3611487">{</span><span class="num" id="3611488">1</span><span class="op" id="3611489">,</span>&nbsp;<span class="num" id="3611491">2</span><span class="op" id="3611492">,</span>&nbsp;<span class="num" id="3611494">840</span><span class="op" id="3611497">,</span>&nbsp;<span class="num" id="3611499">113549</span><span class="op" id="3611505">,</span>&nbsp;<span class="num" id="3611507">1</span><span class="op" id="3611508">,</span>&nbsp;<span class="num" id="3611510">1</span><span class="op" id="3611511">,</span>&nbsp;<span class="num" id="3611513">4</span><span class="op" id="3611514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3611517">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611545">=</span>&nbsp;<span class="ident" id="3611547">asn1</span><span class="op" id="3611551">.</span><span class="ident" id="3611552">ObjectIdentifier</span><span class="op" id="3611568">{</span><span class="num" id="3611569">1</span><span class="op" id="3611570">,</span>&nbsp;<span class="num" id="3611572">2</span><span class="op" id="3611573">,</span>&nbsp;<span class="num" id="3611575">840</span><span class="op" id="3611578">,</span>&nbsp;<span class="num" id="3611580">113549</span><span class="op" id="3611586">,</span>&nbsp;<span class="num" id="3611588">1</span><span class="op" id="3611589">,</span>&nbsp;<span class="num" id="3611591">1</span><span class="op" id="3611592">,</span>&nbsp;<span class="num" id="3611594">5</span><span class="op" id="3611595">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3611598">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3611626">=</span>&nbsp;<span class="ident" id="3611628">asn1</span><span class="op" id="3611632">.</span><span class="ident" id="3611633">ObjectIdentifier</span><span class="op" id="3611649">{</span><span class="num" id="3611650">1</span><span class="op" id="3611651">,</span>&nbsp;<span class="num" id="3611653">2</span><span class="op" id="3611654">,</span>&nbsp;<span class="num" id="3611656">840</span><span class="op" id="3611659">,</span>&nbsp;<span class="num" id="3611661">113549</span><span class="op" id="3611667">,</span>&nbsp;<span class="num" id="3611669">1</span><span class="op" id="3611670">,</span>&nbsp;<span class="num" id="3611672">1</span><span class="op" id="3611673">,</span>&nbsp;<span class="num" id="3611675">11</span><span class="op" id="3611677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3611680">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3611708">=</span>&nbsp;<span class="ident" id="3611710">asn1</span><span class="op" id="3611714">.</span><span class="ident" id="3611715">ObjectIdentifier</span><span class="op" id="3611731">{</span><span class="num" id="3611732">1</span><span class="op" id="3611733">,</span>&nbsp;<span class="num" id="3611735">2</span><span class="op" id="3611736">,</span>&nbsp;<span class="num" id="3611738">840</span><span class="op" id="3611741">,</span>&nbsp;<span class="num" id="3611743">113549</span><span class="op" id="3611749">,</span>&nbsp;<span class="num" id="3611751">1</span><span class="op" id="3611752">,</span>&nbsp;<span class="num" id="3611754">1</span><span class="op" id="3611755">,</span>&nbsp;<span class="num" id="3611757">12</span><span class="op" id="3611759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3611762">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3611790">=</span>&nbsp;<span class="ident" id="3611792">asn1</span><span class="op" id="3611796">.</span><span class="ident" id="3611797">ObjectIdentifier</span><span class="op" id="3611813">{</span><span class="num" id="3611814">1</span><span class="op" id="3611815">,</span>&nbsp;<span class="num" id="3611817">2</span><span class="op" id="3611818">,</span>&nbsp;<span class="num" id="3611820">840</span><span class="op" id="3611823">,</span>&nbsp;<span class="num" id="3611825">113549</span><span class="op" id="3611831">,</span>&nbsp;<span class="num" id="3611833">1</span><span class="op" id="3611834">,</span>&nbsp;<span class="num" id="3611836">1</span><span class="op" id="3611837">,</span>&nbsp;<span class="num" id="3611839">13</span><span class="op" id="3611841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3611844">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611872">=</span>&nbsp;<span class="ident" id="3611874">asn1</span><span class="op" id="3611878">.</span><span class="ident" id="3611879">ObjectIdentifier</span><span class="op" id="3611895">{</span><span class="num" id="3611896">1</span><span class="op" id="3611897">,</span>&nbsp;<span class="num" id="3611899">2</span><span class="op" id="3611900">,</span>&nbsp;<span class="num" id="3611902">840</span><span class="op" id="3611905">,</span>&nbsp;<span class="num" id="3611907">10040</span><span class="op" id="3611912">,</span>&nbsp;<span class="num" id="3611914">4</span><span class="op" id="3611915">,</span>&nbsp;<span class="num" id="3611917">3</span><span class="op" id="3611918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3611921">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3611949">=</span>&nbsp;<span class="ident" id="3611951">asn1</span><span class="op" id="3611955">.</span><span class="ident" id="3611956">ObjectIdentifier</span><span class="op" id="3611972">{</span><span class="num" id="3611973">2</span><span class="op" id="3611974">,</span>&nbsp;<span class="num" id="3611976">16</span><span class="op" id="3611978">,</span>&nbsp;<span class="num" id="3611980">840</span><span class="op" id="3611983">,</span>&nbsp;<span class="num" id="3611985">1</span><span class="op" id="3611986">,</span>&nbsp;<span class="num" id="3611988">101</span><span class="op" id="3611991">,</span>&nbsp;<span class="num" id="3611993">4</span><span class="op" id="3611994">,</span>&nbsp;<span class="num" id="3611996">3</span><span class="op" id="3611997">,</span>&nbsp;<span class="num" id="3611999">2</span><span class="op" id="3612000">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612003">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3612031">=</span>&nbsp;<span class="ident" id="3612033">asn1</span><span class="op" id="3612037">.</span><span class="ident" id="3612038">ObjectIdentifier</span><span class="op" id="3612054">{</span><span class="num" id="3612055">1</span><span class="op" id="3612056">,</span>&nbsp;<span class="num" id="3612058">2</span><span class="op" id="3612059">,</span>&nbsp;<span class="num" id="3612061">840</span><span class="op" id="3612064">,</span>&nbsp;<span class="num" id="3612066">10045</span><span class="op" id="3612071">,</span>&nbsp;<span class="num" id="3612073">4</span><span class="op" id="3612074">,</span>&nbsp;<span class="num" id="3612076">1</span><span class="op" id="3612077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612080">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="3612108">=</span>&nbsp;<span class="ident" id="3612110">asn1</span><span class="op" id="3612114">.</span><span class="ident" id="3612115">ObjectIdentifier</span><span class="op" id="3612131">{</span><span class="num" id="3612132">1</span><span class="op" id="3612133">,</span>&nbsp;<span class="num" id="3612135">2</span><span class="op" id="3612136">,</span>&nbsp;<span class="num" id="3612138">840</span><span class="op" id="3612141">,</span>&nbsp;<span class="num" id="3612143">10045</span><span class="op" id="3612148">,</span>&nbsp;<span class="num" id="3612150">4</span><span class="op" id="3612151">,</span>&nbsp;<span class="num" id="3612153">3</span><span class="op" id="3612154">,</span>&nbsp;<span class="num" id="3612156">2</span><span class="op" id="3612157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612160">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="3612188">=</span>&nbsp;<span class="ident" id="3612190">asn1</span><span class="op" id="3612194">.</span><span class="ident" id="3612195">ObjectIdentifier</span><span class="op" id="3612211">{</span><span class="num" id="3612212">1</span><span class="op" id="3612213">,</span>&nbsp;<span class="num" id="3612215">2</span><span class="op" id="3612216">,</span>&nbsp;<span class="num" id="3612218">840</span><span class="op" id="3612221">,</span>&nbsp;<span class="num" id="3612223">10045</span><span class="op" id="3612228">,</span>&nbsp;<span class="num" id="3612230">4</span><span class="op" id="3612231">,</span>&nbsp;<span class="num" id="3612233">3</span><span class="op" id="3612234">,</span>&nbsp;<span class="num" id="3612236">3</span><span class="op" id="3612237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612240">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="3612268">=</span>&nbsp;<span class="ident" id="3612270">asn1</span><span class="op" id="3612274">.</span><span class="ident" id="3612275">ObjectIdentifier</span><span class="op" id="3612291">{</span><span class="num" id="3612292">1</span><span class="op" id="3612293">,</span>&nbsp;<span class="num" id="3612295">2</span><span class="op" id="3612296">,</span>&nbsp;<span class="num" id="3612298">840</span><span class="op" id="3612301">,</span>&nbsp;<span class="num" id="3612303">10045</span><span class="op" id="3612308">,</span>&nbsp;<span class="num" id="3612310">4</span><span class="op" id="3612311">,</span>&nbsp;<span class="num" id="3612313">3</span><span class="op" id="3612314">,</span>&nbsp;<span class="num" id="3612316">4</span><span class="op" id="3612317">}</span><br>
<span class="lineno"></span><span class="op" id="3612319">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="3612322">var</span>&nbsp;<span class="ident" id="3612326">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3612352">=</span>&nbsp;<span class="op" id="3612354">[</span><span class="op" id="3612355">]</span><span class="keyword" id="3612356">struct</span>&nbsp;<span class="op" id="3612363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612366">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612377">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612397">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612408">asn1</span><span class="op" id="3612412">.</span><span class="ident" id="3612413">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612431">pubKeyAlgo</span>&nbsp;<span class="ident" id="3612442">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3612462">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612473">crypto</span><span class="op" id="3612479">.</span><span class="ident" id="3612480">Hash</span><br>
<span class="lineno"></span><span class="op" id="3612485">}</span><span class="op" id="3612486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3612489">{</span><span class="ident" id="3612490">MD2WithRSA</span><span class="op" id="3612500">,</span>&nbsp;<span class="ident" id="3612502">oidSignatureMD2WithRSA</span><span class="op" id="3612524">,</span>&nbsp;<span class="ident" id="3612526">RSA</span><span class="op" id="3612529">,</span>&nbsp;<span class="ident" id="3612531">crypto</span><span class="op" id="3612537">.</span><span class="ident" id="3612538">Hash</span><span class="op" id="3612542">(</span><span class="num" id="3612543">0</span><span class="op" id="3612544">)</span>&nbsp;<span class="comment" id="3612546">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="3612568">}</span><span class="op" id="3612569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3612572">{</span><span class="ident" id="3612573">MD5WithRSA</span><span class="op" id="3612583">,</span>&nbsp;<span class="ident" id="3612585">oidSignatureMD5WithRSA</span><span class="op" id="3612607">,</span>&nbsp;<span class="ident" id="3612609">RSA</span><span class="op" id="3612612">,</span>&nbsp;<span class="ident" id="3612614">crypto</span><span class="op" id="3612620">.</span><span class="ident" id="3612621">MD5</span><span class="op" id="3612624">}</span><span class="op" id="3612625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3612628">{</span><span class="ident" id="3612629">SHA1WithRSA</span><span class="op" id="3612640">,</span>&nbsp;<span class="ident" id="3612642">oidSignatureSHA1WithRSA</span><span class="op" id="3612665">,</span>&nbsp;<span class="ident" id="3612667">RSA</span><span class="op" id="3612670">,</span>&nbsp;<span class="ident" id="3612672">crypto</span><span class="op" id="3612678">.</span><span class="ident" id="3612679">SHA1</span><span class="op" id="3612683">}</span><span class="op" id="3612684">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3612687">{</span><span class="ident" id="3612688">SHA256WithRSA</span><span class="op" id="3612701">,</span>&nbsp;<span class="ident" id="3612703">oidSignatureSHA256WithRSA</span><span class="op" id="3612728">,</span>&nbsp;<span class="ident" id="3612730">RSA</span><span class="op" id="3612733">,</span>&nbsp;<span class="ident" id="3612735">crypto</span><span class="op" id="3612741">.</span><span class="ident" id="3612742">SHA256</span><span class="op" id="3612748">}</span><span class="op" id="3612749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3612752">{</span><span class="ident" id="3612753">SHA384WithRSA</span><span class="op" id="3612766">,</span>&nbsp;<span class="ident" id="3612768">oidSignatureSHA384WithRSA</span><span class="op" id="3612793">,</span>&nbsp;<span class="ident" id="3612795">RSA</span><span class="op" id="3612798">,</span>&nbsp;<span class="ident" id="3612800">crypto</span><span class="op" id="3612806">.</span><span class="ident" id="3612807">SHA384</span><span class="op" id="3612813">}</span><span class="op" id="3612814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3612817">{</span><span class="ident" id="3612818">SHA512WithRSA</span><span class="op" id="3612831">,</span>&nbsp;<span class="ident" id="3612833">oidSignatureSHA512WithRSA</span><span class="op" id="3612858">,</span>&nbsp;<span class="ident" id="3612860">RSA</span><span class="op" id="3612863">,</span>&nbsp;<span class="ident" id="3612865">crypto</span><span class="op" id="3612871">.</span><span class="ident" id="3612872">SHA512</span><span class="op" id="3612878">}</span><span class="op" id="3612879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3612882">{</span><span class="ident" id="3612883">DSAWithSHA1</span><span class="op" id="3612894">,</span>&nbsp;<span class="ident" id="3612896">oidSignatureDSAWithSHA1</span><span class="op" id="3612919">,</span>&nbsp;<span class="ident" id="3612921">DSA</span><span class="op" id="3612924">,</span>&nbsp;<span class="ident" id="3612926">crypto</span><span class="op" id="3612932">.</span><span class="ident" id="3612933">SHA1</span><span class="op" id="3612937">}</span><span class="op" id="3612938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3612941">{</span><span class="ident" id="3612942">DSAWithSHA256</span><span class="op" id="3612955">,</span>&nbsp;<span class="ident" id="3612957">oidSignatureDSAWithSHA256</span><span class="op" id="3612982">,</span>&nbsp;<span class="ident" id="3612984">DSA</span><span class="op" id="3612987">,</span>&nbsp;<span class="ident" id="3612989">crypto</span><span class="op" id="3612995">.</span><span class="ident" id="3612996">SHA256</span><span class="op" id="3613002">}</span><span class="op" id="3613003">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3613006">{</span><span class="ident" id="3613007">ECDSAWithSHA1</span><span class="op" id="3613020">,</span>&nbsp;<span class="ident" id="3613022">oidSignatureECDSAWithSHA1</span><span class="op" id="3613047">,</span>&nbsp;<span class="ident" id="3613049">ECDSA</span><span class="op" id="3613054">,</span>&nbsp;<span class="ident" id="3613056">crypto</span><span class="op" id="3613062">.</span><span class="ident" id="3613063">SHA1</span><span class="op" id="3613067">}</span><span class="op" id="3613068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3613071">{</span><span class="ident" id="3613072">ECDSAWithSHA256</span><span class="op" id="3613087">,</span>&nbsp;<span class="ident" id="3613089">oidSignatureECDSAWithSHA256</span><span class="op" id="3613116">,</span>&nbsp;<span class="ident" id="3613118">ECDSA</span><span class="op" id="3613123">,</span>&nbsp;<span class="ident" id="3613125">crypto</span><span class="op" id="3613131">.</span><span class="ident" id="3613132">SHA256</span><span class="op" id="3613138">}</span><span class="op" id="3613139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3613142">{</span><span class="ident" id="3613143">ECDSAWithSHA384</span><span class="op" id="3613158">,</span>&nbsp;<span class="ident" id="3613160">oidSignatureECDSAWithSHA384</span><span class="op" id="3613187">,</span>&nbsp;<span class="ident" id="3613189">ECDSA</span><span class="op" id="3613194">,</span>&nbsp;<span class="ident" id="3613196">crypto</span><span class="op" id="3613202">.</span><span class="ident" id="3613203">SHA384</span><span class="op" id="3613209">}</span><span class="op" id="3613210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3613213">{</span><span class="ident" id="3613214">ECDSAWithSHA512</span><span class="op" id="3613229">,</span>&nbsp;<span class="ident" id="3613231">oidSignatureECDSAWithSHA512</span><span class="op" id="3613258">,</span>&nbsp;<span class="ident" id="3613260">ECDSA</span><span class="op" id="3613265">,</span>&nbsp;<span class="ident" id="3613267">crypto</span><span class="op" id="3613273">.</span><span class="ident" id="3613274">SHA512</span><span class="op" id="3613280">}</span><span class="op" id="3613281">,</span><br>
<span class="lineno"></span><span class="op" id="3613283">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="3613286">func</span>&nbsp;<span class="ident" id="3613291">getSignatureAlgorithmFromOID</span><span class="op" id="3613319">(</span><span class="ident" id="3613320">oid</span>&nbsp;<span class="ident" id="3613324">asn1</span><span class="op" id="3613328">.</span><span class="ident" id="3613329">ObjectIdentifier</span><span class="op" id="3613345">)</span>&nbsp;<span class="ident" id="3613347">SignatureAlgorithm</span>&nbsp;<span class="op" id="3613366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3613369">for</span>&nbsp;<span class="ident" id="3613373">_</span><span class="op" id="3613374">,</span>&nbsp;<span class="ident" id="3613376">details</span>&nbsp;<span class="op" id="3613384">:=</span>&nbsp;<span class="keyword" id="3613387">range</span>&nbsp;<span class="ident" id="3613393">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3613419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3613423">if</span>&nbsp;<span class="ident" id="3613426">oid</span><span class="op" id="3613429">.</span><span class="ident" id="3613430">Equal</span><span class="op" id="3613435">(</span><span class="ident" id="3613436">details</span><span class="op" id="3613443">.</span><span class="ident" id="3613444">oid</span><span class="op" id="3613447">)</span>&nbsp;<span class="op" id="3613449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3613454">return</span>&nbsp;<span class="ident" id="3613461">details</span><span class="op" id="3613468">.</span><span class="ident" id="3613469">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3613476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3613479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3613482">return</span>&nbsp;<span class="ident" id="3613489">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="3613515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="3613518">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3613557">//</span><br>
<span class="lineno"></span><span class="comment" id="3613560">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="3613625">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3613658">//</span><br>
<span class="lineno">280</span><span class="comment" id="3613661">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3613715">//</span><br>
<span class="lineno"></span><span class="comment" id="3613718">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="3613783">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3613814">//</span><br>
<span class="lineno">285</span><span class="comment" id="3613817">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="3613885">//</span><br>
<span class="lineno"></span><span class="comment" id="3613888">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3613930">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="3614002">var</span>&nbsp;<span class="op" id="3614006">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614009">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3614027">=</span>&nbsp;<span class="ident" id="3614029">asn1</span><span class="op" id="3614033">.</span><span class="ident" id="3614034">ObjectIdentifier</span><span class="op" id="3614050">{</span><span class="num" id="3614051">1</span><span class="op" id="3614052">,</span>&nbsp;<span class="num" id="3614054">2</span><span class="op" id="3614055">,</span>&nbsp;<span class="num" id="3614057">840</span><span class="op" id="3614060">,</span>&nbsp;<span class="num" id="3614062">113549</span><span class="op" id="3614068">,</span>&nbsp;<span class="num" id="3614070">1</span><span class="op" id="3614071">,</span>&nbsp;<span class="num" id="3614073">1</span><span class="op" id="3614074">,</span>&nbsp;<span class="num" id="3614076">1</span><span class="op" id="3614077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614080">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3614098">=</span>&nbsp;<span class="ident" id="3614100">asn1</span><span class="op" id="3614104">.</span><span class="ident" id="3614105">ObjectIdentifier</span><span class="op" id="3614121">{</span><span class="num" id="3614122">1</span><span class="op" id="3614123">,</span>&nbsp;<span class="num" id="3614125">2</span><span class="op" id="3614126">,</span>&nbsp;<span class="num" id="3614128">840</span><span class="op" id="3614131">,</span>&nbsp;<span class="num" id="3614133">10040</span><span class="op" id="3614138">,</span>&nbsp;<span class="num" id="3614140">4</span><span class="op" id="3614141">,</span>&nbsp;<span class="num" id="3614143">1</span><span class="op" id="3614144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614147">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="3614165">=</span>&nbsp;<span class="ident" id="3614167">asn1</span><span class="op" id="3614171">.</span><span class="ident" id="3614172">ObjectIdentifier</span><span class="op" id="3614188">{</span><span class="num" id="3614189">1</span><span class="op" id="3614190">,</span>&nbsp;<span class="num" id="3614192">2</span><span class="op" id="3614193">,</span>&nbsp;<span class="num" id="3614195">840</span><span class="op" id="3614198">,</span>&nbsp;<span class="num" id="3614200">10045</span><span class="op" id="3614205">,</span>&nbsp;<span class="num" id="3614207">2</span><span class="op" id="3614208">,</span>&nbsp;<span class="num" id="3614210">1</span><span class="op" id="3614211">}</span><br>
<span class="lineno"></span><span class="op" id="3614213">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="3614216">func</span>&nbsp;<span class="ident" id="3614221">getPublicKeyAlgorithmFromOID</span><span class="op" id="3614249">(</span><span class="ident" id="3614250">oid</span>&nbsp;<span class="ident" id="3614254">asn1</span><span class="op" id="3614258">.</span><span class="ident" id="3614259">ObjectIdentifier</span><span class="op" id="3614275">)</span>&nbsp;<span class="ident" id="3614277">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3614296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3614299">switch</span>&nbsp;<span class="op" id="3614306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3614309">case</span>&nbsp;<span class="ident" id="3614314">oid</span><span class="op" id="3614317">.</span><span class="ident" id="3614318">Equal</span><span class="op" id="3614323">(</span><span class="ident" id="3614324">oidPublicKeyRSA</span><span class="op" id="3614339">)</span><span class="op" id="3614340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3614344">return</span>&nbsp;<span class="ident" id="3614351">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3614356">case</span>&nbsp;<span class="ident" id="3614361">oid</span><span class="op" id="3614364">.</span><span class="ident" id="3614365">Equal</span><span class="op" id="3614370">(</span><span class="ident" id="3614371">oidPublicKeyDSA</span><span class="op" id="3614386">)</span><span class="op" id="3614387">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3614391">return</span>&nbsp;<span class="ident" id="3614398">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3614403">case</span>&nbsp;<span class="ident" id="3614408">oid</span><span class="op" id="3614411">.</span><span class="ident" id="3614412">Equal</span><span class="op" id="3614417">(</span><span class="ident" id="3614418">oidPublicKeyECDSA</span><span class="op" id="3614435">)</span><span class="op" id="3614436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3614440">return</span>&nbsp;<span class="ident" id="3614447">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3614454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3614457">return</span>&nbsp;<span class="ident" id="3614464">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="3614490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3614493">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="3614527">//</span><br>
<span class="lineno"></span><span class="comment" id="3614530">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="3614567">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3614634">//</span><br>
<span class="lineno"></span><span class="comment" id="3614637">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3614674">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="3614737">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="3614755">//</span><br>
<span class="lineno"></span><span class="comment" id="3614758">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3614795">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3614862">//</span><br>
<span class="lineno"></span><span class="comment" id="3614865">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="3614902">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3614969">//</span><br>
<span class="lineno"></span><span class="comment" id="3614972">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="3615017">var</span>&nbsp;<span class="op" id="3615021">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615024">oidNamedCurveP224</span>&nbsp;<span class="op" id="3615042">=</span>&nbsp;<span class="ident" id="3615044">asn1</span><span class="op" id="3615048">.</span><span class="ident" id="3615049">ObjectIdentifier</span><span class="op" id="3615065">{</span><span class="num" id="3615066">1</span><span class="op" id="3615067">,</span>&nbsp;<span class="num" id="3615069">3</span><span class="op" id="3615070">,</span>&nbsp;<span class="num" id="3615072">132</span><span class="op" id="3615075">,</span>&nbsp;<span class="num" id="3615077">0</span><span class="op" id="3615078">,</span>&nbsp;<span class="num" id="3615080">33</span><span class="op" id="3615082">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615085">oidNamedCurveP256</span>&nbsp;<span class="op" id="3615103">=</span>&nbsp;<span class="ident" id="3615105">asn1</span><span class="op" id="3615109">.</span><span class="ident" id="3615110">ObjectIdentifier</span><span class="op" id="3615126">{</span><span class="num" id="3615127">1</span><span class="op" id="3615128">,</span>&nbsp;<span class="num" id="3615130">2</span><span class="op" id="3615131">,</span>&nbsp;<span class="num" id="3615133">840</span><span class="op" id="3615136">,</span>&nbsp;<span class="num" id="3615138">10045</span><span class="op" id="3615143">,</span>&nbsp;<span class="num" id="3615145">3</span><span class="op" id="3615146">,</span>&nbsp;<span class="num" id="3615148">1</span><span class="op" id="3615149">,</span>&nbsp;<span class="num" id="3615151">7</span><span class="op" id="3615152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615155">oidNamedCurveP384</span>&nbsp;<span class="op" id="3615173">=</span>&nbsp;<span class="ident" id="3615175">asn1</span><span class="op" id="3615179">.</span><span class="ident" id="3615180">ObjectIdentifier</span><span class="op" id="3615196">{</span><span class="num" id="3615197">1</span><span class="op" id="3615198">,</span>&nbsp;<span class="num" id="3615200">3</span><span class="op" id="3615201">,</span>&nbsp;<span class="num" id="3615203">132</span><span class="op" id="3615206">,</span>&nbsp;<span class="num" id="3615208">0</span><span class="op" id="3615209">,</span>&nbsp;<span class="num" id="3615211">34</span><span class="op" id="3615213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615216">oidNamedCurveP521</span>&nbsp;<span class="op" id="3615234">=</span>&nbsp;<span class="ident" id="3615236">asn1</span><span class="op" id="3615240">.</span><span class="ident" id="3615241">ObjectIdentifier</span><span class="op" id="3615257">{</span><span class="num" id="3615258">1</span><span class="op" id="3615259">,</span>&nbsp;<span class="num" id="3615261">3</span><span class="op" id="3615262">,</span>&nbsp;<span class="num" id="3615264">132</span><span class="op" id="3615267">,</span>&nbsp;<span class="num" id="3615269">0</span><span class="op" id="3615270">,</span>&nbsp;<span class="num" id="3615272">35</span><span class="op" id="3615274">}</span><br>
<span class="lineno"></span><span class="op" id="3615276">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="3615279">func</span>&nbsp;<span class="ident" id="3615284">namedCurveFromOID</span><span class="op" id="3615301">(</span><span class="ident" id="3615302">oid</span>&nbsp;<span class="ident" id="3615306">asn1</span><span class="op" id="3615310">.</span><span class="ident" id="3615311">ObjectIdentifier</span><span class="op" id="3615327">)</span>&nbsp;<span class="ident" id="3615329">elliptic</span><span class="op" id="3615337">.</span><span class="ident" id="3615338">Curve</span>&nbsp;<span class="op" id="3615344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615347">switch</span>&nbsp;<span class="op" id="3615354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615357">case</span>&nbsp;<span class="ident" id="3615362">oid</span><span class="op" id="3615365">.</span><span class="ident" id="3615366">Equal</span><span class="op" id="3615371">(</span><span class="ident" id="3615372">oidNamedCurveP224</span><span class="op" id="3615389">)</span><span class="op" id="3615390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615394">return</span>&nbsp;<span class="ident" id="3615401">elliptic</span><span class="op" id="3615409">.</span><span class="ident" id="3615410">P224</span><span class="op" id="3615414">(</span><span class="op" id="3615415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615418">case</span>&nbsp;<span class="ident" id="3615423">oid</span><span class="op" id="3615426">.</span><span class="ident" id="3615427">Equal</span><span class="op" id="3615432">(</span><span class="ident" id="3615433">oidNamedCurveP256</span><span class="op" id="3615450">)</span><span class="op" id="3615451">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615455">return</span>&nbsp;<span class="ident" id="3615462">elliptic</span><span class="op" id="3615470">.</span><span class="ident" id="3615471">P256</span><span class="op" id="3615475">(</span><span class="op" id="3615476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615479">case</span>&nbsp;<span class="ident" id="3615484">oid</span><span class="op" id="3615487">.</span><span class="ident" id="3615488">Equal</span><span class="op" id="3615493">(</span><span class="ident" id="3615494">oidNamedCurveP384</span><span class="op" id="3615511">)</span><span class="op" id="3615512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615516">return</span>&nbsp;<span class="ident" id="3615523">elliptic</span><span class="op" id="3615531">.</span><span class="ident" id="3615532">P384</span><span class="op" id="3615536">(</span><span class="op" id="3615537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615540">case</span>&nbsp;<span class="ident" id="3615545">oid</span><span class="op" id="3615548">.</span><span class="ident" id="3615549">Equal</span><span class="op" id="3615554">(</span><span class="ident" id="3615555">oidNamedCurveP521</span><span class="op" id="3615572">)</span><span class="op" id="3615573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615577">return</span>&nbsp;<span class="ident" id="3615584">elliptic</span><span class="op" id="3615592">.</span><span class="ident" id="3615593">P521</span><span class="op" id="3615597">(</span><span class="op" id="3615598">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615604">return</span>&nbsp;<span class="ident" id="3615611">nil</span><br>
<span class="lineno"></span><span class="op" id="3615615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3615618">func</span>&nbsp;<span class="ident" id="3615623">oidFromNamedCurve</span><span class="op" id="3615640">(</span><span class="ident" id="3615641">curve</span>&nbsp;<span class="ident" id="3615647">elliptic</span><span class="op" id="3615655">.</span><span class="ident" id="3615656">Curve</span><span class="op" id="3615661">)</span>&nbsp;<span class="op" id="3615663">(</span><span class="ident" id="3615664">asn1</span><span class="op" id="3615668">.</span><span class="ident" id="3615669">ObjectIdentifier</span><span class="op" id="3615685">,</span>&nbsp;<span class="builtintype" id="3615687">bool</span><span class="op" id="3615691">)</span>&nbsp;<span class="op" id="3615693">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615696">switch</span>&nbsp;<span class="ident" id="3615703">curve</span>&nbsp;<span class="op" id="3615709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615712">case</span>&nbsp;<span class="ident" id="3615717">elliptic</span><span class="op" id="3615725">.</span><span class="ident" id="3615726">P224</span><span class="op" id="3615730">(</span><span class="op" id="3615731">)</span><span class="op" id="3615732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615736">return</span>&nbsp;<span class="ident" id="3615743">oidNamedCurveP224</span><span class="op" id="3615760">,</span>&nbsp;<span class="builtintype" id="3615762">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615768">case</span>&nbsp;<span class="ident" id="3615773">elliptic</span><span class="op" id="3615781">.</span><span class="ident" id="3615782">P256</span><span class="op" id="3615786">(</span><span class="op" id="3615787">)</span><span class="op" id="3615788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615792">return</span>&nbsp;<span class="ident" id="3615799">oidNamedCurveP256</span><span class="op" id="3615816">,</span>&nbsp;<span class="builtintype" id="3615818">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615824">case</span>&nbsp;<span class="ident" id="3615829">elliptic</span><span class="op" id="3615837">.</span><span class="ident" id="3615838">P384</span><span class="op" id="3615842">(</span><span class="op" id="3615843">)</span><span class="op" id="3615844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615848">return</span>&nbsp;<span class="ident" id="3615855">oidNamedCurveP384</span><span class="op" id="3615872">,</span>&nbsp;<span class="builtintype" id="3615874">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615880">case</span>&nbsp;<span class="ident" id="3615885">elliptic</span><span class="op" id="3615893">.</span><span class="ident" id="3615894">P521</span><span class="op" id="3615898">(</span><span class="op" id="3615899">)</span><span class="op" id="3615900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615904">return</span>&nbsp;<span class="ident" id="3615911">oidNamedCurveP521</span><span class="op" id="3615928">,</span>&nbsp;<span class="builtintype" id="3615930">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615936">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615940">return</span>&nbsp;<span class="ident" id="3615947">nil</span><span class="op" id="3615950">,</span>&nbsp;<span class="builtintype" id="3615952">false</span><br>
<span class="lineno"></span><span class="op" id="3615958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3615961">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="3616040">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3616080">type</span>&nbsp;<span class="ident" id="3616085">KeyUsage</span>&nbsp;<span class="builtintype" id="3616094">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3616099">const</span>&nbsp;<span class="op" id="3616105">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616108">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="3616133">KeyUsage</span>&nbsp;<span class="op" id="3616142">=</span>&nbsp;<span class="num" id="3616144">1</span>&nbsp;<span class="op" id="3616146">&lt;&lt;</span>&nbsp;<span class="ident" id="3616149">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616155">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616182">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616207">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616233">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616255">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616273">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616290">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616312">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="3616333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="3616336">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="3616378">//</span><br>
<span class="lineno"></span><span class="comment" id="3616381">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3616450">//</span><br>
<span class="lineno"></span><span class="comment" id="3616453">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="3616498">//</span><br>
<span class="lineno"></span><span class="comment" id="3616501">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3616567">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3616633">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3616699">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="3616765">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3616831">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="3616897">var</span>&nbsp;<span class="op" id="3616901">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616904">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3616945">=</span>&nbsp;<span class="ident" id="3616947">asn1</span><span class="op" id="3616951">.</span><span class="ident" id="3616952">ObjectIdentifier</span><span class="op" id="3616968">{</span><span class="num" id="3616969">2</span><span class="op" id="3616970">,</span>&nbsp;<span class="num" id="3616972">5</span><span class="op" id="3616973">,</span>&nbsp;<span class="num" id="3616975">29</span><span class="op" id="3616977">,</span>&nbsp;<span class="num" id="3616979">37</span><span class="op" id="3616981">,</span>&nbsp;<span class="num" id="3616983">0</span><span class="op" id="3616984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616987">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617028">=</span>&nbsp;<span class="ident" id="3617030">asn1</span><span class="op" id="3617034">.</span><span class="ident" id="3617035">ObjectIdentifier</span><span class="op" id="3617051">{</span><span class="num" id="3617052">1</span><span class="op" id="3617053">,</span>&nbsp;<span class="num" id="3617055">3</span><span class="op" id="3617056">,</span>&nbsp;<span class="num" id="3617058">6</span><span class="op" id="3617059">,</span>&nbsp;<span class="num" id="3617061">1</span><span class="op" id="3617062">,</span>&nbsp;<span class="num" id="3617064">5</span><span class="op" id="3617065">,</span>&nbsp;<span class="num" id="3617067">5</span><span class="op" id="3617068">,</span>&nbsp;<span class="num" id="3617070">7</span><span class="op" id="3617071">,</span>&nbsp;<span class="num" id="3617073">3</span><span class="op" id="3617074">,</span>&nbsp;<span class="num" id="3617076">1</span><span class="op" id="3617077">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617080">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617121">=</span>&nbsp;<span class="ident" id="3617123">asn1</span><span class="op" id="3617127">.</span><span class="ident" id="3617128">ObjectIdentifier</span><span class="op" id="3617144">{</span><span class="num" id="3617145">1</span><span class="op" id="3617146">,</span>&nbsp;<span class="num" id="3617148">3</span><span class="op" id="3617149">,</span>&nbsp;<span class="num" id="3617151">6</span><span class="op" id="3617152">,</span>&nbsp;<span class="num" id="3617154">1</span><span class="op" id="3617155">,</span>&nbsp;<span class="num" id="3617157">5</span><span class="op" id="3617158">,</span>&nbsp;<span class="num" id="3617160">5</span><span class="op" id="3617161">,</span>&nbsp;<span class="num" id="3617163">7</span><span class="op" id="3617164">,</span>&nbsp;<span class="num" id="3617166">3</span><span class="op" id="3617167">,</span>&nbsp;<span class="num" id="3617169">2</span><span class="op" id="3617170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617173">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617214">=</span>&nbsp;<span class="ident" id="3617216">asn1</span><span class="op" id="3617220">.</span><span class="ident" id="3617221">ObjectIdentifier</span><span class="op" id="3617237">{</span><span class="num" id="3617238">1</span><span class="op" id="3617239">,</span>&nbsp;<span class="num" id="3617241">3</span><span class="op" id="3617242">,</span>&nbsp;<span class="num" id="3617244">6</span><span class="op" id="3617245">,</span>&nbsp;<span class="num" id="3617247">1</span><span class="op" id="3617248">,</span>&nbsp;<span class="num" id="3617250">5</span><span class="op" id="3617251">,</span>&nbsp;<span class="num" id="3617253">5</span><span class="op" id="3617254">,</span>&nbsp;<span class="num" id="3617256">7</span><span class="op" id="3617257">,</span>&nbsp;<span class="num" id="3617259">3</span><span class="op" id="3617260">,</span>&nbsp;<span class="num" id="3617262">3</span><span class="op" id="3617263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617266">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617307">=</span>&nbsp;<span class="ident" id="3617309">asn1</span><span class="op" id="3617313">.</span><span class="ident" id="3617314">ObjectIdentifier</span><span class="op" id="3617330">{</span><span class="num" id="3617331">1</span><span class="op" id="3617332">,</span>&nbsp;<span class="num" id="3617334">3</span><span class="op" id="3617335">,</span>&nbsp;<span class="num" id="3617337">6</span><span class="op" id="3617338">,</span>&nbsp;<span class="num" id="3617340">1</span><span class="op" id="3617341">,</span>&nbsp;<span class="num" id="3617343">5</span><span class="op" id="3617344">,</span>&nbsp;<span class="num" id="3617346">5</span><span class="op" id="3617347">,</span>&nbsp;<span class="num" id="3617349">7</span><span class="op" id="3617350">,</span>&nbsp;<span class="num" id="3617352">3</span><span class="op" id="3617353">,</span>&nbsp;<span class="num" id="3617355">4</span><span class="op" id="3617356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617359">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617400">=</span>&nbsp;<span class="ident" id="3617402">asn1</span><span class="op" id="3617406">.</span><span class="ident" id="3617407">ObjectIdentifier</span><span class="op" id="3617423">{</span><span class="num" id="3617424">1</span><span class="op" id="3617425">,</span>&nbsp;<span class="num" id="3617427">3</span><span class="op" id="3617428">,</span>&nbsp;<span class="num" id="3617430">6</span><span class="op" id="3617431">,</span>&nbsp;<span class="num" id="3617433">1</span><span class="op" id="3617434">,</span>&nbsp;<span class="num" id="3617436">5</span><span class="op" id="3617437">,</span>&nbsp;<span class="num" id="3617439">5</span><span class="op" id="3617440">,</span>&nbsp;<span class="num" id="3617442">7</span><span class="op" id="3617443">,</span>&nbsp;<span class="num" id="3617445">3</span><span class="op" id="3617446">,</span>&nbsp;<span class="num" id="3617448">5</span><span class="op" id="3617449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617452">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617493">=</span>&nbsp;<span class="ident" id="3617495">asn1</span><span class="op" id="3617499">.</span><span class="ident" id="3617500">ObjectIdentifier</span><span class="op" id="3617516">{</span><span class="num" id="3617517">1</span><span class="op" id="3617518">,</span>&nbsp;<span class="num" id="3617520">3</span><span class="op" id="3617521">,</span>&nbsp;<span class="num" id="3617523">6</span><span class="op" id="3617524">,</span>&nbsp;<span class="num" id="3617526">1</span><span class="op" id="3617527">,</span>&nbsp;<span class="num" id="3617529">5</span><span class="op" id="3617530">,</span>&nbsp;<span class="num" id="3617532">5</span><span class="op" id="3617533">,</span>&nbsp;<span class="num" id="3617535">7</span><span class="op" id="3617536">,</span>&nbsp;<span class="num" id="3617538">3</span><span class="op" id="3617539">,</span>&nbsp;<span class="num" id="3617541">6</span><span class="op" id="3617542">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617545">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617586">=</span>&nbsp;<span class="ident" id="3617588">asn1</span><span class="op" id="3617592">.</span><span class="ident" id="3617593">ObjectIdentifier</span><span class="op" id="3617609">{</span><span class="num" id="3617610">1</span><span class="op" id="3617611">,</span>&nbsp;<span class="num" id="3617613">3</span><span class="op" id="3617614">,</span>&nbsp;<span class="num" id="3617616">6</span><span class="op" id="3617617">,</span>&nbsp;<span class="num" id="3617619">1</span><span class="op" id="3617620">,</span>&nbsp;<span class="num" id="3617622">5</span><span class="op" id="3617623">,</span>&nbsp;<span class="num" id="3617625">5</span><span class="op" id="3617626">,</span>&nbsp;<span class="num" id="3617628">7</span><span class="op" id="3617629">,</span>&nbsp;<span class="num" id="3617631">3</span><span class="op" id="3617632">,</span>&nbsp;<span class="num" id="3617634">7</span><span class="op" id="3617635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617638">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617679">=</span>&nbsp;<span class="ident" id="3617681">asn1</span><span class="op" id="3617685">.</span><span class="ident" id="3617686">ObjectIdentifier</span><span class="op" id="3617702">{</span><span class="num" id="3617703">1</span><span class="op" id="3617704">,</span>&nbsp;<span class="num" id="3617706">3</span><span class="op" id="3617707">,</span>&nbsp;<span class="num" id="3617709">6</span><span class="op" id="3617710">,</span>&nbsp;<span class="num" id="3617712">1</span><span class="op" id="3617713">,</span>&nbsp;<span class="num" id="3617715">5</span><span class="op" id="3617716">,</span>&nbsp;<span class="num" id="3617718">5</span><span class="op" id="3617719">,</span>&nbsp;<span class="num" id="3617721">7</span><span class="op" id="3617722">,</span>&nbsp;<span class="num" id="3617724">3</span><span class="op" id="3617725">,</span>&nbsp;<span class="num" id="3617727">8</span><span class="op" id="3617728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617731">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617772">=</span>&nbsp;<span class="ident" id="3617774">asn1</span><span class="op" id="3617778">.</span><span class="ident" id="3617779">ObjectIdentifier</span><span class="op" id="3617795">{</span><span class="num" id="3617796">1</span><span class="op" id="3617797">,</span>&nbsp;<span class="num" id="3617799">3</span><span class="op" id="3617800">,</span>&nbsp;<span class="num" id="3617802">6</span><span class="op" id="3617803">,</span>&nbsp;<span class="num" id="3617805">1</span><span class="op" id="3617806">,</span>&nbsp;<span class="num" id="3617808">5</span><span class="op" id="3617809">,</span>&nbsp;<span class="num" id="3617811">5</span><span class="op" id="3617812">,</span>&nbsp;<span class="num" id="3617814">7</span><span class="op" id="3617815">,</span>&nbsp;<span class="num" id="3617817">3</span><span class="op" id="3617818">,</span>&nbsp;<span class="num" id="3617820">9</span><span class="op" id="3617821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617824">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="3617865">=</span>&nbsp;<span class="ident" id="3617867">asn1</span><span class="op" id="3617871">.</span><span class="ident" id="3617872">ObjectIdentifier</span><span class="op" id="3617888">{</span><span class="num" id="3617889">1</span><span class="op" id="3617890">,</span>&nbsp;<span class="num" id="3617892">3</span><span class="op" id="3617893">,</span>&nbsp;<span class="num" id="3617895">6</span><span class="op" id="3617896">,</span>&nbsp;<span class="num" id="3617898">1</span><span class="op" id="3617899">,</span>&nbsp;<span class="num" id="3617901">4</span><span class="op" id="3617902">,</span>&nbsp;<span class="num" id="3617904">1</span><span class="op" id="3617905">,</span>&nbsp;<span class="num" id="3617907">311</span><span class="op" id="3617910">,</span>&nbsp;<span class="num" id="3617912">10</span><span class="op" id="3617914">,</span>&nbsp;<span class="num" id="3617916">3</span><span class="op" id="3617917">,</span>&nbsp;<span class="num" id="3617919">3</span><span class="op" id="3617920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617923">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="3617964">=</span>&nbsp;<span class="ident" id="3617966">asn1</span><span class="op" id="3617970">.</span><span class="ident" id="3617971">ObjectIdentifier</span><span class="op" id="3617987">{</span><span class="num" id="3617988">2</span><span class="op" id="3617989">,</span>&nbsp;<span class="num" id="3617991">16</span><span class="op" id="3617993">,</span>&nbsp;<span class="num" id="3617995">840</span><span class="op" id="3617998">,</span>&nbsp;<span class="num" id="3618000">1</span><span class="op" id="3618001">,</span>&nbsp;<span class="num" id="3618003">113730</span><span class="op" id="3618009">,</span>&nbsp;<span class="num" id="3618011">4</span><span class="op" id="3618012">,</span>&nbsp;<span class="num" id="3618014">1</span><span class="op" id="3618015">}</span><br>
<span class="lineno">400</span><span class="op" id="3618017">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3618020">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="3618105">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3618167">type</span>&nbsp;<span class="ident" id="3618172">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="3618184">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="3618189">const</span>&nbsp;<span class="op" id="3618195">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618198">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="3618213">ExtKeyUsage</span>&nbsp;<span class="op" id="3618225">=</span>&nbsp;<span class="ident" id="3618227">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618233">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618256">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618279">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618303">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618331">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618358">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618382">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618404">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618429">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618453">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618492">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="3618529">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="3618532">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="3618608">var</span>&nbsp;<span class="ident" id="3618612">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3618628">=</span>&nbsp;<span class="op" id="3618630">[</span><span class="op" id="3618631">]</span><span class="keyword" id="3618632">struct</span>&nbsp;<span class="op" id="3618639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618642">extKeyUsage</span>&nbsp;<span class="ident" id="3618654">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3618667">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618679">asn1</span><span class="op" id="3618683">.</span><span class="ident" id="3618684">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="3618701">}</span><span class="op" id="3618702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3618705">{</span><span class="ident" id="3618706">ExtKeyUsageAny</span><span class="op" id="3618720">,</span>&nbsp;<span class="ident" id="3618722">oidExtKeyUsageAny</span><span class="op" id="3618739">}</span><span class="op" id="3618740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3618743">{</span><span class="ident" id="3618744">ExtKeyUsageServerAuth</span><span class="op" id="3618765">,</span>&nbsp;<span class="ident" id="3618767">oidExtKeyUsageServerAuth</span><span class="op" id="3618791">}</span><span class="op" id="3618792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3618795">{</span><span class="ident" id="3618796">ExtKeyUsageClientAuth</span><span class="op" id="3618817">,</span>&nbsp;<span class="ident" id="3618819">oidExtKeyUsageClientAuth</span><span class="op" id="3618843">}</span><span class="op" id="3618844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3618847">{</span><span class="ident" id="3618848">ExtKeyUsageCodeSigning</span><span class="op" id="3618870">,</span>&nbsp;<span class="ident" id="3618872">oidExtKeyUsageCodeSigning</span><span class="op" id="3618897">}</span><span class="op" id="3618898">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3618901">{</span><span class="ident" id="3618902">ExtKeyUsageEmailProtection</span><span class="op" id="3618928">,</span>&nbsp;<span class="ident" id="3618930">oidExtKeyUsageEmailProtection</span><span class="op" id="3618959">}</span><span class="op" id="3618960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3618963">{</span><span class="ident" id="3618964">ExtKeyUsageIPSECEndSystem</span><span class="op" id="3618989">,</span>&nbsp;<span class="ident" id="3618991">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="3619019">}</span><span class="op" id="3619020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619023">{</span><span class="ident" id="3619024">ExtKeyUsageIPSECTunnel</span><span class="op" id="3619046">,</span>&nbsp;<span class="ident" id="3619048">oidExtKeyUsageIPSECTunnel</span><span class="op" id="3619073">}</span><span class="op" id="3619074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619077">{</span><span class="ident" id="3619078">ExtKeyUsageIPSECUser</span><span class="op" id="3619098">,</span>&nbsp;<span class="ident" id="3619100">oidExtKeyUsageIPSECUser</span><span class="op" id="3619123">}</span><span class="op" id="3619124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619127">{</span><span class="ident" id="3619128">ExtKeyUsageTimeStamping</span><span class="op" id="3619151">,</span>&nbsp;<span class="ident" id="3619153">oidExtKeyUsageTimeStamping</span><span class="op" id="3619179">}</span><span class="op" id="3619180">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619183">{</span><span class="ident" id="3619184">ExtKeyUsageOCSPSigning</span><span class="op" id="3619206">,</span>&nbsp;<span class="ident" id="3619208">oidExtKeyUsageOCSPSigning</span><span class="op" id="3619233">}</span><span class="op" id="3619234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619237">{</span><span class="ident" id="3619238">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="3619275">,</span>&nbsp;<span class="ident" id="3619277">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="3619317">}</span><span class="op" id="3619318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619321">{</span><span class="ident" id="3619322">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="3619358">,</span>&nbsp;<span class="ident" id="3619360">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="3619399">}</span><span class="op" id="3619400">,</span><br>
<span class="lineno"></span><span class="op" id="3619402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="3619405">func</span>&nbsp;<span class="ident" id="3619410">extKeyUsageFromOID</span><span class="op" id="3619428">(</span><span class="ident" id="3619429">oid</span>&nbsp;<span class="ident" id="3619433">asn1</span><span class="op" id="3619437">.</span><span class="ident" id="3619438">ObjectIdentifier</span><span class="op" id="3619454">)</span>&nbsp;<span class="op" id="3619456">(</span><span class="ident" id="3619457">eku</span>&nbsp;<span class="ident" id="3619461">ExtKeyUsage</span><span class="op" id="3619472">,</span>&nbsp;<span class="ident" id="3619474">ok</span>&nbsp;<span class="builtintype" id="3619477">bool</span><span class="op" id="3619481">)</span>&nbsp;<span class="op" id="3619483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619486">for</span>&nbsp;<span class="ident" id="3619490">_</span><span class="op" id="3619491">,</span>&nbsp;<span class="ident" id="3619493">pair</span>&nbsp;<span class="op" id="3619498">:=</span>&nbsp;<span class="keyword" id="3619501">range</span>&nbsp;<span class="ident" id="3619507">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3619523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619527">if</span>&nbsp;<span class="ident" id="3619530">oid</span><span class="op" id="3619533">.</span><span class="ident" id="3619534">Equal</span><span class="op" id="3619539">(</span><span class="ident" id="3619540">pair</span><span class="op" id="3619544">.</span><span class="ident" id="3619545">oid</span><span class="op" id="3619548">)</span>&nbsp;<span class="op" id="3619550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619555">return</span>&nbsp;<span class="ident" id="3619562">pair</span><span class="op" id="3619566">.</span><span class="ident" id="3619567">extKeyUsage</span><span class="op" id="3619578">,</span>&nbsp;<span class="builtintype" id="3619580">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619587">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619593">return</span><br>
<span class="lineno"></span><span class="op" id="3619600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3619603">func</span>&nbsp;<span class="ident" id="3619608">oidFromExtKeyUsage</span><span class="op" id="3619626">(</span><span class="ident" id="3619627">eku</span>&nbsp;<span class="ident" id="3619631">ExtKeyUsage</span><span class="op" id="3619642">)</span>&nbsp;<span class="op" id="3619644">(</span><span class="ident" id="3619645">oid</span>&nbsp;<span class="ident" id="3619649">asn1</span><span class="op" id="3619653">.</span><span class="ident" id="3619654">ObjectIdentifier</span><span class="op" id="3619670">,</span>&nbsp;<span class="ident" id="3619672">ok</span>&nbsp;<span class="builtintype" id="3619675">bool</span><span class="op" id="3619679">)</span>&nbsp;<span class="op" id="3619681">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619684">for</span>&nbsp;<span class="ident" id="3619688">_</span><span class="op" id="3619689">,</span>&nbsp;<span class="ident" id="3619691">pair</span>&nbsp;<span class="op" id="3619696">:=</span>&nbsp;<span class="keyword" id="3619699">range</span>&nbsp;<span class="ident" id="3619705">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3619721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619725">if</span>&nbsp;<span class="ident" id="3619728">eku</span>&nbsp;<span class="op" id="3619732">==</span>&nbsp;<span class="ident" id="3619735">pair</span><span class="op" id="3619739">.</span><span class="ident" id="3619740">extKeyUsage</span>&nbsp;<span class="op" id="3619752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619757">return</span>&nbsp;<span class="ident" id="3619764">pair</span><span class="op" id="3619768">.</span><span class="ident" id="3619769">oid</span><span class="op" id="3619772">,</span>&nbsp;<span class="builtintype" id="3619774">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3619784">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3619787">return</span><br>
<span class="lineno"></span><span class="op" id="3619794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3619797">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="3619847">type</span>&nbsp;<span class="ident" id="3619852">Certificate</span>&nbsp;<span class="keyword" id="3619864">struct</span>&nbsp;<span class="op" id="3619871">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619874">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619898">[</span><span class="op" id="3619899">]</span><span class="builtintype" id="3619900">byte</span>&nbsp;<span class="comment" id="3619905">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3619986">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620010">[</span><span class="op" id="3620011">]</span><span class="builtintype" id="3620012">byte</span>&nbsp;<span class="comment" id="3620017">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620064">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="3620088">[</span><span class="op" id="3620089">]</span><span class="builtintype" id="3620090">byte</span>&nbsp;<span class="comment" id="3620095">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620133">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620157">[</span><span class="op" id="3620158">]</span><span class="builtintype" id="3620159">byte</span>&nbsp;<span class="comment" id="3620164">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620188">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620212">[</span><span class="op" id="3620213">]</span><span class="builtintype" id="3620214">byte</span>&nbsp;<span class="comment" id="3620219">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620243">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620262">[</span><span class="op" id="3620263">]</span><span class="builtintype" id="3620264">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620270">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3620289">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620310">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3620329">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620349">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620368">interface</span><span class="op" id="3620377">{</span><span class="op" id="3620378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620382">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3620402">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620407">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620427">*</span><span class="ident" id="3620428">big</span><span class="op" id="3620431">.</span><span class="ident" id="3620432">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620437">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620457">pkix</span><span class="op" id="3620461">.</span><span class="ident" id="3620462">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620468">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620488">pkix</span><span class="op" id="3620492">.</span><span class="ident" id="3620493">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620499">NotBefore</span><span class="op" id="3620508">,</span>&nbsp;<span class="ident" id="3620510">NotAfter</span>&nbsp;<span class="ident" id="3620519">time</span><span class="op" id="3620523">.</span><span class="ident" id="3620524">Time</span>&nbsp;<span class="comment" id="3620529">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620550">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620570">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3620581">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3620654">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3620723">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3620796">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3620839">Extensions</span>&nbsp;<span class="op" id="3620850">[</span><span class="op" id="3620851">]</span><span class="ident" id="3620852">pkix</span><span class="op" id="3620856">.</span><span class="ident" id="3620857">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3620869">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3620937">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621007">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621080">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621150">ExtraExtensions</span>&nbsp;<span class="op" id="3621166">[</span><span class="op" id="3621167">]</span><span class="ident" id="3621168">pkix</span><span class="op" id="3621172">.</span><span class="ident" id="3621173">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621185">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3621204">[</span><span class="op" id="3621205">]</span><span class="ident" id="3621206">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621228">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621265">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="3621284">[</span><span class="op" id="3621285">]</span><span class="ident" id="3621286">asn1</span><span class="op" id="3621290">.</span><span class="ident" id="3621291">ObjectIdentifier</span>&nbsp;<span class="comment" id="3621308">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621370">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="3621392">bool</span>&nbsp;<span class="comment" id="3621397">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621445">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3621467">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621473">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3621495">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621500">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621566">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621639">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621709">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621728">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="3621743">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621750">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3621765">[</span><span class="op" id="3621766">]</span><span class="builtintype" id="3621767">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621773">AuthorityKeyId</span>&nbsp;<span class="op" id="3621788">[</span><span class="op" id="3621789">]</span><span class="builtintype" id="3621790">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621797">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621850">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3621872">[</span><span class="op" id="3621873">]</span><span class="builtintype" id="3621874">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621882">IssuingCertificateURL</span>&nbsp;<span class="op" id="3621904">[</span><span class="op" id="3621905">]</span><span class="builtintype" id="3621906">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3621915">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621949">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3621964">[</span><span class="op" id="3621965">]</span><span class="builtintype" id="3621966">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621974">EmailAddresses</span>&nbsp;<span class="op" id="3621989">[</span><span class="op" id="3621990">]</span><span class="builtintype" id="3621991">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3621999">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622014">[</span><span class="op" id="3622015">]</span><span class="ident" id="3622016">net</span><span class="op" id="3622019">.</span><span class="ident" id="3622020">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3622025">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3622046">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="3622074">bool</span>&nbsp;<span class="comment" id="3622079">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3622138">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622166">[</span><span class="op" id="3622167">]</span><span class="builtintype" id="3622168">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3622177">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3622205">CRLDistributionPoints</span>&nbsp;<span class="op" id="3622227">[</span><span class="op" id="3622228">]</span><span class="builtintype" id="3622229">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3622238">PolicyIdentifiers</span>&nbsp;<span class="op" id="3622256">[</span><span class="op" id="3622257">]</span><span class="ident" id="3622258">asn1</span><span class="op" id="3622262">.</span><span class="ident" id="3622263">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="3622280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="3622283">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3622363">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="3622422">var</span>&nbsp;<span class="ident" id="3622426">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="3622450">=</span>&nbsp;<span class="ident" id="3622452">errors</span><span class="op" id="3622458">.</span><span class="ident" id="3622459">New</span><span class="op" id="3622462">(</span><span class="string" id="3622463">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="3622519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3622522">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="3622601">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3622681">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3622709">type</span>&nbsp;<span class="ident" id="3622714">ConstraintViolationError</span>&nbsp;<span class="keyword" id="3622739">struct</span><span class="op" id="3622745">{</span><span class="op" id="3622746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3622749">func</span>&nbsp;<span class="op" id="3622754">(</span><span class="ident" id="3622755">ConstraintViolationError</span><span class="op" id="3622779">)</span>&nbsp;<span class="ident" id="3622781">Error</span><span class="op" id="3622786">(</span><span class="op" id="3622787">)</span>&nbsp;<span class="builtintype" id="3622789">string</span>&nbsp;<span class="op" id="3622796">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3622799">return</span>&nbsp;<span class="string" id="3622806">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="3622889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3622892">func</span>&nbsp;<span class="op" id="3622897">(</span><span class="ident" id="3622898">c</span>&nbsp;<span class="op" id="3622900">*</span><span class="ident" id="3622901">Certificate</span><span class="op" id="3622912">)</span>&nbsp;<span class="ident" id="3622914">Equal</span><span class="op" id="3622919">(</span><span class="ident" id="3622920">other</span>&nbsp;<span class="op" id="3622926">*</span><span class="ident" id="3622927">Certificate</span><span class="op" id="3622938">)</span>&nbsp;<span class="builtintype" id="3622940">bool</span>&nbsp;<span class="op" id="3622945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3622948">return</span>&nbsp;<span class="ident" id="3622955">bytes</span><span class="op" id="3622960">.</span><span class="ident" id="3622961">Equal</span><span class="op" id="3622966">(</span><span class="ident" id="3622967">c</span><span class="op" id="3622968">.</span><span class="ident" id="3622969">Raw</span><span class="op" id="3622972">,</span>&nbsp;<span class="ident" id="3622974">other</span><span class="op" id="3622979">.</span><span class="ident" id="3622980">Raw</span><span class="op" id="3622983">)</span><br>
<span class="lineno">540</span><span class="op" id="3622985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3622988">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="3623060">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="3623140">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="3623162">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3623237">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="3623280">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="3623346">//</span><br>
<span class="lineno"></span><span class="comment" id="3623349">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="3623421">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="3623436">var</span>&nbsp;<span class="ident" id="3623440">entrustBrokenSPKI</span>&nbsp;<span class="op" id="3623458">=</span>&nbsp;<span class="op" id="3623460">[</span><span class="op" id="3623461">]</span><span class="builtintype" id="3623462">byte</span><span class="op" id="3623466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623469">0x30</span><span class="op" id="3623473">,</span>&nbsp;<span class="num" id="3623475">0x82</span><span class="op" id="3623479">,</span>&nbsp;<span class="num" id="3623481">0x01</span><span class="op" id="3623485">,</span>&nbsp;<span class="num" id="3623487">0x22</span><span class="op" id="3623491">,</span>&nbsp;<span class="num" id="3623493">0x30</span><span class="op" id="3623497">,</span>&nbsp;<span class="num" id="3623499">0x0d</span><span class="op" id="3623503">,</span>&nbsp;<span class="num" id="3623505">0x06</span><span class="op" id="3623509">,</span>&nbsp;<span class="num" id="3623511">0x09</span><span class="op" id="3623515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623518">0x2a</span><span class="op" id="3623522">,</span>&nbsp;<span class="num" id="3623524">0x86</span><span class="op" id="3623528">,</span>&nbsp;<span class="num" id="3623530">0x48</span><span class="op" id="3623534">,</span>&nbsp;<span class="num" id="3623536">0x86</span><span class="op" id="3623540">,</span>&nbsp;<span class="num" id="3623542">0xf7</span><span class="op" id="3623546">,</span>&nbsp;<span class="num" id="3623548">0x0d</span><span class="op" id="3623552">,</span>&nbsp;<span class="num" id="3623554">0x01</span><span class="op" id="3623558">,</span>&nbsp;<span class="num" id="3623560">0x01</span><span class="op" id="3623564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623567">0x01</span><span class="op" id="3623571">,</span>&nbsp;<span class="num" id="3623573">0x05</span><span class="op" id="3623577">,</span>&nbsp;<span class="num" id="3623579">0x00</span><span class="op" id="3623583">,</span>&nbsp;<span class="num" id="3623585">0x03</span><span class="op" id="3623589">,</span>&nbsp;<span class="num" id="3623591">0x82</span><span class="op" id="3623595">,</span>&nbsp;<span class="num" id="3623597">0x01</span><span class="op" id="3623601">,</span>&nbsp;<span class="num" id="3623603">0x0f</span><span class="op" id="3623607">,</span>&nbsp;<span class="num" id="3623609">0x00</span><span class="op" id="3623613">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623616">0x30</span><span class="op" id="3623620">,</span>&nbsp;<span class="num" id="3623622">0x82</span><span class="op" id="3623626">,</span>&nbsp;<span class="num" id="3623628">0x01</span><span class="op" id="3623632">,</span>&nbsp;<span class="num" id="3623634">0x0a</span><span class="op" id="3623638">,</span>&nbsp;<span class="num" id="3623640">0x02</span><span class="op" id="3623644">,</span>&nbsp;<span class="num" id="3623646">0x82</span><span class="op" id="3623650">,</span>&nbsp;<span class="num" id="3623652">0x01</span><span class="op" id="3623656">,</span>&nbsp;<span class="num" id="3623658">0x01</span><span class="op" id="3623662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623665">0x00</span><span class="op" id="3623669">,</span>&nbsp;<span class="num" id="3623671">0x97</span><span class="op" id="3623675">,</span>&nbsp;<span class="num" id="3623677">0xa3</span><span class="op" id="3623681">,</span>&nbsp;<span class="num" id="3623683">0x2d</span><span class="op" id="3623687">,</span>&nbsp;<span class="num" id="3623689">0x3c</span><span class="op" id="3623693">,</span>&nbsp;<span class="num" id="3623695">0x9e</span><span class="op" id="3623699">,</span>&nbsp;<span class="num" id="3623701">0xde</span><span class="op" id="3623705">,</span>&nbsp;<span class="num" id="3623707">0x05</span><span class="op" id="3623711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623714">0xda</span><span class="op" id="3623718">,</span>&nbsp;<span class="num" id="3623720">0x13</span><span class="op" id="3623724">,</span>&nbsp;<span class="num" id="3623726">0xc2</span><span class="op" id="3623730">,</span>&nbsp;<span class="num" id="3623732">0x11</span><span class="op" id="3623736">,</span>&nbsp;<span class="num" id="3623738">0x8d</span><span class="op" id="3623742">,</span>&nbsp;<span class="num" id="3623744">0x9d</span><span class="op" id="3623748">,</span>&nbsp;<span class="num" id="3623750">0x8e</span><span class="op" id="3623754">,</span>&nbsp;<span class="num" id="3623756">0xe3</span><span class="op" id="3623760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623763">0x7f</span><span class="op" id="3623767">,</span>&nbsp;<span class="num" id="3623769">0xc7</span><span class="op" id="3623773">,</span>&nbsp;<span class="num" id="3623775">0x4b</span><span class="op" id="3623779">,</span>&nbsp;<span class="num" id="3623781">0x7e</span><span class="op" id="3623785">,</span>&nbsp;<span class="num" id="3623787">0x5a</span><span class="op" id="3623791">,</span>&nbsp;<span class="num" id="3623793">0x9f</span><span class="op" id="3623797">,</span>&nbsp;<span class="num" id="3623799">0xb3</span><span class="op" id="3623803">,</span>&nbsp;<span class="num" id="3623805">0xff</span><span class="op" id="3623809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623812">0x62</span><span class="op" id="3623816">,</span>&nbsp;<span class="num" id="3623818">0xab</span><span class="op" id="3623822">,</span>&nbsp;<span class="num" id="3623824">0x73</span><span class="op" id="3623828">,</span>&nbsp;<span class="num" id="3623830">0xc8</span><span class="op" id="3623834">,</span>&nbsp;<span class="num" id="3623836">0x28</span><span class="op" id="3623840">,</span>&nbsp;<span class="num" id="3623842">0x6b</span><span class="op" id="3623846">,</span>&nbsp;<span class="num" id="3623848">0xba</span><span class="op" id="3623852">,</span>&nbsp;<span class="num" id="3623854">0x10</span><span class="op" id="3623858">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623861">0x64</span><span class="op" id="3623865">,</span>&nbsp;<span class="num" id="3623867">0x82</span><span class="op" id="3623871">,</span>&nbsp;<span class="num" id="3623873">0x87</span><span class="op" id="3623877">,</span>&nbsp;<span class="num" id="3623879">0x13</span><span class="op" id="3623883">,</span>&nbsp;<span class="num" id="3623885">0xcd</span><span class="op" id="3623889">,</span>&nbsp;<span class="num" id="3623891">0x57</span><span class="op" id="3623895">,</span>&nbsp;<span class="num" id="3623897">0x18</span><span class="op" id="3623901">,</span>&nbsp;<span class="num" id="3623903">0xff</span><span class="op" id="3623907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623910">0x28</span><span class="op" id="3623914">,</span>&nbsp;<span class="num" id="3623916">0xce</span><span class="op" id="3623920">,</span>&nbsp;<span class="num" id="3623922">0xc0</span><span class="op" id="3623926">,</span>&nbsp;<span class="num" id="3623928">0xe6</span><span class="op" id="3623932">,</span>&nbsp;<span class="num" id="3623934">0x0e</span><span class="op" id="3623938">,</span>&nbsp;<span class="num" id="3623940">0x06</span><span class="op" id="3623944">,</span>&nbsp;<span class="num" id="3623946">0x91</span><span class="op" id="3623950">,</span>&nbsp;<span class="num" id="3623952">0x50</span><span class="op" id="3623956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3623959">0x29</span><span class="op" id="3623963">,</span>&nbsp;<span class="num" id="3623965">0x83</span><span class="op" id="3623969">,</span>&nbsp;<span class="num" id="3623971">0xd1</span><span class="op" id="3623975">,</span>&nbsp;<span class="num" id="3623977">0xf2</span><span class="op" id="3623981">,</span>&nbsp;<span class="num" id="3623983">0xc3</span><span class="op" id="3623987">,</span>&nbsp;<span class="num" id="3623989">0x2a</span><span class="op" id="3623993">,</span>&nbsp;<span class="num" id="3623995">0xdb</span><span class="op" id="3623999">,</span>&nbsp;<span class="num" id="3624001">0xd8</span><span class="op" id="3624005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624008">0xdb</span><span class="op" id="3624012">,</span>&nbsp;<span class="num" id="3624014">0x4e</span><span class="op" id="3624018">,</span>&nbsp;<span class="num" id="3624020">0x04</span><span class="op" id="3624024">,</span>&nbsp;<span class="num" id="3624026">0xcc</span><span class="op" id="3624030">,</span>&nbsp;<span class="num" id="3624032">0x00</span><span class="op" id="3624036">,</span>&nbsp;<span class="num" id="3624038">0xeb</span><span class="op" id="3624042">,</span>&nbsp;<span class="num" id="3624044">0x8b</span><span class="op" id="3624048">,</span>&nbsp;<span class="num" id="3624050">0xb6</span><span class="op" id="3624054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624057">0x96</span><span class="op" id="3624061">,</span>&nbsp;<span class="num" id="3624063">0xdc</span><span class="op" id="3624067">,</span>&nbsp;<span class="num" id="3624069">0xbc</span><span class="op" id="3624073">,</span>&nbsp;<span class="num" id="3624075">0xaa</span><span class="op" id="3624079">,</span>&nbsp;<span class="num" id="3624081">0xfa</span><span class="op" id="3624085">,</span>&nbsp;<span class="num" id="3624087">0x52</span><span class="op" id="3624091">,</span>&nbsp;<span class="num" id="3624093">0x77</span><span class="op" id="3624097">,</span>&nbsp;<span class="num" id="3624099">0x04</span><span class="op" id="3624103">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624106">0xc1</span><span class="op" id="3624110">,</span>&nbsp;<span class="num" id="3624112">0xdb</span><span class="op" id="3624116">,</span>&nbsp;<span class="num" id="3624118">0x19</span><span class="op" id="3624122">,</span>&nbsp;<span class="num" id="3624124">0xe4</span><span class="op" id="3624128">,</span>&nbsp;<span class="num" id="3624130">0xae</span><span class="op" id="3624134">,</span>&nbsp;<span class="num" id="3624136">0x9c</span><span class="op" id="3624140">,</span>&nbsp;<span class="num" id="3624142">0xfd</span><span class="op" id="3624146">,</span>&nbsp;<span class="num" id="3624148">0x3c</span><span class="op" id="3624152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624155">0x8b</span><span class="op" id="3624159">,</span>&nbsp;<span class="num" id="3624161">0x03</span><span class="op" id="3624165">,</span>&nbsp;<span class="num" id="3624167">0xef</span><span class="op" id="3624171">,</span>&nbsp;<span class="num" id="3624173">0x4d</span><span class="op" id="3624177">,</span>&nbsp;<span class="num" id="3624179">0xbc</span><span class="op" id="3624183">,</span>&nbsp;<span class="num" id="3624185">0x1a</span><span class="op" id="3624189">,</span>&nbsp;<span class="num" id="3624191">0x03</span><span class="op" id="3624195">,</span>&nbsp;<span class="num" id="3624197">0x65</span><span class="op" id="3624201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624204">0xf9</span><span class="op" id="3624208">,</span>&nbsp;<span class="num" id="3624210">0xc1</span><span class="op" id="3624214">,</span>&nbsp;<span class="num" id="3624216">0xb1</span><span class="op" id="3624220">,</span>&nbsp;<span class="num" id="3624222">0x3f</span><span class="op" id="3624226">,</span>&nbsp;<span class="num" id="3624228">0x72</span><span class="op" id="3624232">,</span>&nbsp;<span class="num" id="3624234">0x86</span><span class="op" id="3624238">,</span>&nbsp;<span class="num" id="3624240">0xf2</span><span class="op" id="3624244">,</span>&nbsp;<span class="num" id="3624246">0x38</span><span class="op" id="3624250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624253">0xaa</span><span class="op" id="3624257">,</span>&nbsp;<span class="num" id="3624259">0x19</span><span class="op" id="3624263">,</span>&nbsp;<span class="num" id="3624265">0xae</span><span class="op" id="3624269">,</span>&nbsp;<span class="num" id="3624271">0x10</span><span class="op" id="3624275">,</span>&nbsp;<span class="num" id="3624277">0x88</span><span class="op" id="3624281">,</span>&nbsp;<span class="num" id="3624283">0x78</span><span class="op" id="3624287">,</span>&nbsp;<span class="num" id="3624289">0x28</span><span class="op" id="3624293">,</span>&nbsp;<span class="num" id="3624295">0xda</span><span class="op" id="3624299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624302">0x75</span><span class="op" id="3624306">,</span>&nbsp;<span class="num" id="3624308">0xc3</span><span class="op" id="3624312">,</span>&nbsp;<span class="num" id="3624314">0x3d</span><span class="op" id="3624318">,</span>&nbsp;<span class="num" id="3624320">0x02</span><span class="op" id="3624324">,</span>&nbsp;<span class="num" id="3624326">0x82</span><span class="op" id="3624330">,</span>&nbsp;<span class="num" id="3624332">0x02</span><span class="op" id="3624336">,</span>&nbsp;<span class="num" id="3624338">0x9c</span><span class="op" id="3624342">,</span>&nbsp;<span class="num" id="3624344">0xb9</span><span class="op" id="3624348">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624351">0xc1</span><span class="op" id="3624355">,</span>&nbsp;<span class="num" id="3624357">0x65</span><span class="op" id="3624361">,</span>&nbsp;<span class="num" id="3624363">0x77</span><span class="op" id="3624367">,</span>&nbsp;<span class="num" id="3624369">0x76</span><span class="op" id="3624373">,</span>&nbsp;<span class="num" id="3624375">0x24</span><span class="op" id="3624379">,</span>&nbsp;<span class="num" id="3624381">0x4c</span><span class="op" id="3624385">,</span>&nbsp;<span class="num" id="3624387">0x98</span><span class="op" id="3624391">,</span>&nbsp;<span class="num" id="3624393">0xf7</span><span class="op" id="3624397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624400">0x6d</span><span class="op" id="3624404">,</span>&nbsp;<span class="num" id="3624406">0x31</span><span class="op" id="3624410">,</span>&nbsp;<span class="num" id="3624412">0x38</span><span class="op" id="3624416">,</span>&nbsp;<span class="num" id="3624418">0xfb</span><span class="op" id="3624422">,</span>&nbsp;<span class="num" id="3624424">0xdb</span><span class="op" id="3624428">,</span>&nbsp;<span class="num" id="3624430">0xfe</span><span class="op" id="3624434">,</span>&nbsp;<span class="num" id="3624436">0xdb</span><span class="op" id="3624440">,</span>&nbsp;<span class="num" id="3624442">0x37</span><span class="op" id="3624446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624449">0x02</span><span class="op" id="3624453">,</span>&nbsp;<span class="num" id="3624455">0x76</span><span class="op" id="3624459">,</span>&nbsp;<span class="num" id="3624461">0xa1</span><span class="op" id="3624465">,</span>&nbsp;<span class="num" id="3624467">0x18</span><span class="op" id="3624471">,</span>&nbsp;<span class="num" id="3624473">0x97</span><span class="op" id="3624477">,</span>&nbsp;<span class="num" id="3624479">0xa6</span><span class="op" id="3624483">,</span>&nbsp;<span class="num" id="3624485">0xcc</span><span class="op" id="3624489">,</span>&nbsp;<span class="num" id="3624491">0xde</span><span class="op" id="3624495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624498">0x20</span><span class="op" id="3624502">,</span>&nbsp;<span class="num" id="3624504">0x09</span><span class="op" id="3624508">,</span>&nbsp;<span class="num" id="3624510">0x49</span><span class="op" id="3624514">,</span>&nbsp;<span class="num" id="3624516">0x36</span><span class="op" id="3624520">,</span>&nbsp;<span class="num" id="3624522">0x24</span><span class="op" id="3624526">,</span>&nbsp;<span class="num" id="3624528">0x69</span><span class="op" id="3624532">,</span>&nbsp;<span class="num" id="3624534">0x42</span><span class="op" id="3624538">,</span>&nbsp;<span class="num" id="3624540">0xf6</span><span class="op" id="3624544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624547">0xe4</span><span class="op" id="3624551">,</span>&nbsp;<span class="num" id="3624553">0x37</span><span class="op" id="3624557">,</span>&nbsp;<span class="num" id="3624559">0x62</span><span class="op" id="3624563">,</span>&nbsp;<span class="num" id="3624565">0xf1</span><span class="op" id="3624569">,</span>&nbsp;<span class="num" id="3624571">0x59</span><span class="op" id="3624575">,</span>&nbsp;<span class="num" id="3624577">0x6d</span><span class="op" id="3624581">,</span>&nbsp;<span class="num" id="3624583">0xa9</span><span class="op" id="3624587">,</span>&nbsp;<span class="num" id="3624589">0x3c</span><span class="op" id="3624593">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624596">0xed</span><span class="op" id="3624600">,</span>&nbsp;<span class="num" id="3624602">0x34</span><span class="op" id="3624606">,</span>&nbsp;<span class="num" id="3624608">0x9c</span><span class="op" id="3624612">,</span>&nbsp;<span class="num" id="3624614">0xa3</span><span class="op" id="3624618">,</span>&nbsp;<span class="num" id="3624620">0x8e</span><span class="op" id="3624624">,</span>&nbsp;<span class="num" id="3624626">0xdb</span><span class="op" id="3624630">,</span>&nbsp;<span class="num" id="3624632">0xdc</span><span class="op" id="3624636">,</span>&nbsp;<span class="num" id="3624638">0x3a</span><span class="op" id="3624642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624645">0xd7</span><span class="op" id="3624649">,</span>&nbsp;<span class="num" id="3624651">0xf7</span><span class="op" id="3624655">,</span>&nbsp;<span class="num" id="3624657">0x0a</span><span class="op" id="3624661">,</span>&nbsp;<span class="num" id="3624663">0x6f</span><span class="op" id="3624667">,</span>&nbsp;<span class="num" id="3624669">0xef</span><span class="op" id="3624673">,</span>&nbsp;<span class="num" id="3624675">0x2e</span><span class="op" id="3624679">,</span>&nbsp;<span class="num" id="3624681">0xd8</span><span class="op" id="3624685">,</span>&nbsp;<span class="num" id="3624687">0xd5</span><span class="op" id="3624691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624694">0x93</span><span class="op" id="3624698">,</span>&nbsp;<span class="num" id="3624700">0x5a</span><span class="op" id="3624704">,</span>&nbsp;<span class="num" id="3624706">0x7a</span><span class="op" id="3624710">,</span>&nbsp;<span class="num" id="3624712">0xed</span><span class="op" id="3624716">,</span>&nbsp;<span class="num" id="3624718">0x08</span><span class="op" id="3624722">,</span>&nbsp;<span class="num" id="3624724">0x49</span><span class="op" id="3624728">,</span>&nbsp;<span class="num" id="3624730">0x68</span><span class="op" id="3624734">,</span>&nbsp;<span class="num" id="3624736">0xe2</span><span class="op" id="3624740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624743">0x41</span><span class="op" id="3624747">,</span>&nbsp;<span class="num" id="3624749">0xe3</span><span class="op" id="3624753">,</span>&nbsp;<span class="num" id="3624755">0x5a</span><span class="op" id="3624759">,</span>&nbsp;<span class="num" id="3624761">0x90</span><span class="op" id="3624765">,</span>&nbsp;<span class="num" id="3624767">0xc1</span><span class="op" id="3624771">,</span>&nbsp;<span class="num" id="3624773">0x86</span><span class="op" id="3624777">,</span>&nbsp;<span class="num" id="3624779">0x55</span><span class="op" id="3624783">,</span>&nbsp;<span class="num" id="3624785">0xfc</span><span class="op" id="3624789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624792">0x51</span><span class="op" id="3624796">,</span>&nbsp;<span class="num" id="3624798">0x43</span><span class="op" id="3624802">,</span>&nbsp;<span class="num" id="3624804">0x9d</span><span class="op" id="3624808">,</span>&nbsp;<span class="num" id="3624810">0xe0</span><span class="op" id="3624814">,</span>&nbsp;<span class="num" id="3624816">0xb2</span><span class="op" id="3624820">,</span>&nbsp;<span class="num" id="3624822">0xc4</span><span class="op" id="3624826">,</span>&nbsp;<span class="num" id="3624828">0x67</span><span class="op" id="3624832">,</span>&nbsp;<span class="num" id="3624834">0xb4</span><span class="op" id="3624838">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624841">0xcb</span><span class="op" id="3624845">,</span>&nbsp;<span class="num" id="3624847">0x32</span><span class="op" id="3624851">,</span>&nbsp;<span class="num" id="3624853">0x31</span><span class="op" id="3624857">,</span>&nbsp;<span class="num" id="3624859">0x25</span><span class="op" id="3624863">,</span>&nbsp;<span class="num" id="3624865">0xf0</span><span class="op" id="3624869">,</span>&nbsp;<span class="num" id="3624871">0x54</span><span class="op" id="3624875">,</span>&nbsp;<span class="num" id="3624877">0x9f</span><span class="op" id="3624881">,</span>&nbsp;<span class="num" id="3624883">0x4b</span><span class="op" id="3624887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624890">0xd1</span><span class="op" id="3624894">,</span>&nbsp;<span class="num" id="3624896">0x6f</span><span class="op" id="3624900">,</span>&nbsp;<span class="num" id="3624902">0xdb</span><span class="op" id="3624906">,</span>&nbsp;<span class="num" id="3624908">0xd4</span><span class="op" id="3624912">,</span>&nbsp;<span class="num" id="3624914">0xdd</span><span class="op" id="3624918">,</span>&nbsp;<span class="num" id="3624920">0xfc</span><span class="op" id="3624924">,</span>&nbsp;<span class="num" id="3624926">0xaf</span><span class="op" id="3624930">,</span>&nbsp;<span class="num" id="3624932">0x5e</span><span class="op" id="3624936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624939">0x6c</span><span class="op" id="3624943">,</span>&nbsp;<span class="num" id="3624945">0x78</span><span class="op" id="3624949">,</span>&nbsp;<span class="num" id="3624951">0x90</span><span class="op" id="3624955">,</span>&nbsp;<span class="num" id="3624957">0x95</span><span class="op" id="3624961">,</span>&nbsp;<span class="num" id="3624963">0xde</span><span class="op" id="3624967">,</span>&nbsp;<span class="num" id="3624969">0xca</span><span class="op" id="3624973">,</span>&nbsp;<span class="num" id="3624975">0x3a</span><span class="op" id="3624979">,</span>&nbsp;<span class="num" id="3624981">0x48</span><span class="op" id="3624985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3624988">0xb9</span><span class="op" id="3624992">,</span>&nbsp;<span class="num" id="3624994">0x79</span><span class="op" id="3624998">,</span>&nbsp;<span class="num" id="3625000">0x3c</span><span class="op" id="3625004">,</span>&nbsp;<span class="num" id="3625006">0x9b</span><span class="op" id="3625010">,</span>&nbsp;<span class="num" id="3625012">0x19</span><span class="op" id="3625016">,</span>&nbsp;<span class="num" id="3625018">0xd6</span><span class="op" id="3625022">,</span>&nbsp;<span class="num" id="3625024">0x75</span><span class="op" id="3625028">,</span>&nbsp;<span class="num" id="3625030">0x05</span><span class="op" id="3625034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3625037">0xa0</span><span class="op" id="3625041">,</span>&nbsp;<span class="num" id="3625043">0xf9</span><span class="op" id="3625047">,</span>&nbsp;<span class="num" id="3625049">0x88</span><span class="op" id="3625053">,</span>&nbsp;<span class="num" id="3625055">0xd7</span><span class="op" id="3625059">,</span>&nbsp;<span class="num" id="3625061">0xc1</span><span class="op" id="3625065">,</span>&nbsp;<span class="num" id="3625067">0xe8</span><span class="op" id="3625071">,</span>&nbsp;<span class="num" id="3625073">0xa5</span><span class="op" id="3625077">,</span>&nbsp;<span class="num" id="3625079">0x09</span><span class="op" id="3625083">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3625086">0xe4</span><span class="op" id="3625090">,</span>&nbsp;<span class="num" id="3625092">0x1a</span><span class="op" id="3625096">,</span>&nbsp;<span class="num" id="3625098">0x15</span><span class="op" id="3625102">,</span>&nbsp;<span class="num" id="3625104">0xdc</span><span class="op" id="3625108">,</span>&nbsp;<span class="num" id="3625110">0x87</span><span class="op" id="3625114">,</span>&nbsp;<span class="num" id="3625116">0x23</span><span class="op" id="3625120">,</span>&nbsp;<span class="num" id="3625122">0xaa</span><span class="op" id="3625126">,</span>&nbsp;<span class="num" id="3625128">0xb2</span><span class="op" id="3625132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3625135">0x75</span><span class="op" id="3625139">,</span>&nbsp;<span class="num" id="3625141">0x8c</span><span class="op" id="3625145">,</span>&nbsp;<span class="num" id="3625147">0x63</span><span class="op" id="3625151">,</span>&nbsp;<span class="num" id="3625153">0x25</span><span class="op" id="3625157">,</span>&nbsp;<span class="num" id="3625159">0x87</span><span class="op" id="3625163">,</span>&nbsp;<span class="num" id="3625165">0xd8</span><span class="op" id="3625169">,</span>&nbsp;<span class="num" id="3625171">0xf8</span><span class="op" id="3625175">,</span>&nbsp;<span class="num" id="3625177">0x3d</span><span class="op" id="3625181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3625184">0xa6</span><span class="op" id="3625188">,</span>&nbsp;<span class="num" id="3625190">0xc2</span><span class="op" id="3625194">,</span>&nbsp;<span class="num" id="3625196">0xcc</span><span class="op" id="3625200">,</span>&nbsp;<span class="num" id="3625202">0x66</span><span class="op" id="3625206">,</span>&nbsp;<span class="num" id="3625208">0xff</span><span class="op" id="3625212">,</span>&nbsp;<span class="num" id="3625214">0xa5</span><span class="op" id="3625218">,</span>&nbsp;<span class="num" id="3625220">0x66</span><span class="op" id="3625224">,</span>&nbsp;<span class="num" id="3625226">0x68</span><span class="op" id="3625230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3625233">0x55</span><span class="op" id="3625237">,</span>&nbsp;<span class="num" id="3625239">0x02</span><span class="op" id="3625243">,</span>&nbsp;<span class="num" id="3625245">0x03</span><span class="op" id="3625249">,</span>&nbsp;<span class="num" id="3625251">0x01</span><span class="op" id="3625255">,</span>&nbsp;<span class="num" id="3625257">0x00</span><span class="op" id="3625261">,</span>&nbsp;<span class="num" id="3625263">0x01</span><span class="op" id="3625267">,</span><br>
<span class="lineno"></span><span class="op" id="3625269">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="3625272">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="3625348">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="3625364">func</span>&nbsp;<span class="op" id="3625369">(</span><span class="ident" id="3625370">c</span>&nbsp;<span class="op" id="3625372">*</span><span class="ident" id="3625373">Certificate</span><span class="op" id="3625384">)</span>&nbsp;<span class="ident" id="3625386">CheckSignatureFrom</span><span class="op" id="3625404">(</span><span class="ident" id="3625405">parent</span>&nbsp;<span class="op" id="3625412">*</span><span class="ident" id="3625413">Certificate</span><span class="op" id="3625424">)</span>&nbsp;<span class="op" id="3625426">(</span><span class="ident" id="3625427">err</span>&nbsp;<span class="builtintype" id="3625431">error</span><span class="op" id="3625436">)</span>&nbsp;<span class="op" id="3625438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3625441">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3625464">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3625534">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3625605">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3625676">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3625705">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3625767">if</span>&nbsp;<span class="op" id="3625770">(</span><span class="ident" id="3625771">parent</span><span class="op" id="3625777">.</span><span class="ident" id="3625778">Version</span>&nbsp;<span class="op" id="3625786">==</span>&nbsp;<span class="num" id="3625789">3</span>&nbsp;<span class="op" id="3625791">&amp;&amp;</span>&nbsp;<span class="op" id="3625794">!</span><span class="ident" id="3625795">parent</span><span class="op" id="3625801">.</span><span class="ident" id="3625802">BasicConstraintsValid</span>&nbsp;<span class="op" id="3625824">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3625829">parent</span><span class="op" id="3625835">.</span><span class="ident" id="3625836">BasicConstraintsValid</span>&nbsp;<span class="op" id="3625858">&amp;&amp;</span>&nbsp;<span class="op" id="3625861">!</span><span class="ident" id="3625862">parent</span><span class="op" id="3625868">.</span><span class="ident" id="3625869">IsCA</span><span class="op" id="3625873">)</span>&nbsp;<span class="op" id="3625875">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3625880">!</span><span class="ident" id="3625881">bytes</span><span class="op" id="3625886">.</span><span class="ident" id="3625887">Equal</span><span class="op" id="3625892">(</span><span class="ident" id="3625893">c</span><span class="op" id="3625894">.</span><span class="ident" id="3625895">RawSubjectPublicKeyInfo</span><span class="op" id="3625918">,</span>&nbsp;<span class="ident" id="3625920">entrustBrokenSPKI</span><span class="op" id="3625937">)</span>&nbsp;<span class="op" id="3625939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3625943">return</span>&nbsp;<span class="ident" id="3625950">ConstraintViolationError</span><span class="op" id="3625974">{</span><span class="op" id="3625975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3625978">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3625982">if</span>&nbsp;<span class="ident" id="3625985">parent</span><span class="op" id="3625991">.</span><span class="ident" id="3625992">KeyUsage</span>&nbsp;<span class="op" id="3626001">!=</span>&nbsp;<span class="num" id="3626004">0</span>&nbsp;<span class="op" id="3626006">&amp;&amp;</span>&nbsp;<span class="ident" id="3626009">parent</span><span class="op" id="3626015">.</span><span class="ident" id="3626016">KeyUsage</span><span class="op" id="3626024">&amp;</span><span class="ident" id="3626025">KeyUsageCertSign</span>&nbsp;<span class="op" id="3626042">==</span>&nbsp;<span class="num" id="3626045">0</span>&nbsp;<span class="op" id="3626047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626051">return</span>&nbsp;<span class="ident" id="3626058">ConstraintViolationError</span><span class="op" id="3626082">{</span><span class="op" id="3626083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3626086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626090">if</span>&nbsp;<span class="ident" id="3626093">parent</span><span class="op" id="3626099">.</span><span class="ident" id="3626100">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3626119">==</span>&nbsp;<span class="ident" id="3626122">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="3626148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626152">return</span>&nbsp;<span class="ident" id="3626159">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3626184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3626188">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626245">return</span>&nbsp;<span class="ident" id="3626252">parent</span><span class="op" id="3626258">.</span><span class="ident" id="3626259">CheckSignature</span><span class="op" id="3626273">(</span><span class="ident" id="3626274">c</span><span class="op" id="3626275">.</span><span class="ident" id="3626276">SignatureAlgorithm</span><span class="op" id="3626294">,</span>&nbsp;<span class="ident" id="3626296">c</span><span class="op" id="3626297">.</span><span class="ident" id="3626298">RawTBSCertificate</span><span class="op" id="3626315">,</span>&nbsp;<span class="ident" id="3626317">c</span><span class="op" id="3626318">.</span><span class="ident" id="3626319">Signature</span><span class="op" id="3626328">)</span><br>
<span class="lineno"></span><span class="op" id="3626330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3626333">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="3626413">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3626432">func</span>&nbsp;<span class="op" id="3626437">(</span><span class="ident" id="3626438">c</span>&nbsp;<span class="op" id="3626440">*</span><span class="ident" id="3626441">Certificate</span><span class="op" id="3626452">)</span>&nbsp;<span class="ident" id="3626454">CheckSignature</span><span class="op" id="3626468">(</span><span class="ident" id="3626469">algo</span>&nbsp;<span class="ident" id="3626474">SignatureAlgorithm</span><span class="op" id="3626492">,</span>&nbsp;<span class="ident" id="3626494">signed</span><span class="op" id="3626500">,</span>&nbsp;<span class="ident" id="3626502">signature</span>&nbsp;<span class="op" id="3626512">[</span><span class="op" id="3626513">]</span><span class="builtintype" id="3626514">byte</span><span class="op" id="3626518">)</span>&nbsp;<span class="op" id="3626520">(</span><span class="ident" id="3626521">err</span>&nbsp;<span class="builtintype" id="3626525">error</span><span class="op" id="3626530">)</span>&nbsp;<span class="op" id="3626532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626535">var</span>&nbsp;<span class="ident" id="3626539">hashType</span>&nbsp;<span class="ident" id="3626548">crypto</span><span class="op" id="3626554">.</span><span class="ident" id="3626555">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626562">switch</span>&nbsp;<span class="ident" id="3626569">algo</span>&nbsp;<span class="op" id="3626574">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626577">case</span>&nbsp;<span class="ident" id="3626582">SHA1WithRSA</span><span class="op" id="3626593">,</span>&nbsp;<span class="ident" id="3626595">DSAWithSHA1</span><span class="op" id="3626606">,</span>&nbsp;<span class="ident" id="3626608">ECDSAWithSHA1</span><span class="op" id="3626621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3626625">hashType</span>&nbsp;<span class="op" id="3626634">=</span>&nbsp;<span class="ident" id="3626636">crypto</span><span class="op" id="3626642">.</span><span class="ident" id="3626643">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626649">case</span>&nbsp;<span class="ident" id="3626654">SHA256WithRSA</span><span class="op" id="3626667">,</span>&nbsp;<span class="ident" id="3626669">DSAWithSHA256</span><span class="op" id="3626682">,</span>&nbsp;<span class="ident" id="3626684">ECDSAWithSHA256</span><span class="op" id="3626699">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3626703">hashType</span>&nbsp;<span class="op" id="3626712">=</span>&nbsp;<span class="ident" id="3626714">crypto</span><span class="op" id="3626720">.</span><span class="ident" id="3626721">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626729">case</span>&nbsp;<span class="ident" id="3626734">SHA384WithRSA</span><span class="op" id="3626747">,</span>&nbsp;<span class="ident" id="3626749">ECDSAWithSHA384</span><span class="op" id="3626764">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3626768">hashType</span>&nbsp;<span class="op" id="3626777">=</span>&nbsp;<span class="ident" id="3626779">crypto</span><span class="op" id="3626785">.</span><span class="ident" id="3626786">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626794">case</span>&nbsp;<span class="ident" id="3626799">SHA512WithRSA</span><span class="op" id="3626812">,</span>&nbsp;<span class="ident" id="3626814">ECDSAWithSHA512</span><span class="op" id="3626829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3626833">hashType</span>&nbsp;<span class="op" id="3626842">=</span>&nbsp;<span class="ident" id="3626844">crypto</span><span class="op" id="3626850">.</span><span class="ident" id="3626851">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626859">default</span><span class="op" id="3626866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626870">return</span>&nbsp;<span class="ident" id="3626877">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3626902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626906">if</span>&nbsp;<span class="op" id="3626909">!</span><span class="ident" id="3626910">hashType</span><span class="op" id="3626918">.</span><span class="ident" id="3626919">Available</span><span class="op" id="3626928">(</span><span class="op" id="3626929">)</span>&nbsp;<span class="op" id="3626931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3626935">return</span>&nbsp;<span class="ident" id="3626942">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3626967">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3626970">h</span>&nbsp;<span class="op" id="3626972">:=</span>&nbsp;<span class="ident" id="3626975">hashType</span><span class="op" id="3626983">.</span><span class="ident" id="3626984">New</span><span class="op" id="3626987">(</span><span class="op" id="3626988">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3626992">h</span><span class="op" id="3626993">.</span><span class="ident" id="3626994">Write</span><span class="op" id="3626999">(</span><span class="ident" id="3627000">signed</span><span class="op" id="3627006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3627009">digest</span>&nbsp;<span class="op" id="3627016">:=</span>&nbsp;<span class="ident" id="3627019">h</span><span class="op" id="3627020">.</span><span class="ident" id="3627021">Sum</span><span class="op" id="3627024">(</span><span class="ident" id="3627025">nil</span><span class="op" id="3627028">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627032">switch</span>&nbsp;<span class="ident" id="3627039">pub</span>&nbsp;<span class="op" id="3627043">:=</span>&nbsp;<span class="ident" id="3627046">c</span><span class="op" id="3627047">.</span><span class="ident" id="3627048">PublicKey</span><span class="op" id="3627057">.</span><span class="op" id="3627058">(</span><span class="keyword" id="3627059">type</span><span class="op" id="3627063">)</span>&nbsp;<span class="op" id="3627065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627068">case</span>&nbsp;<span class="op" id="3627073">*</span><span class="ident" id="3627074">rsa</span><span class="op" id="3627077">.</span><span class="ident" id="3627078">PublicKey</span><span class="op" id="3627087">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627091">return</span>&nbsp;<span class="ident" id="3627098">rsa</span><span class="op" id="3627101">.</span><span class="ident" id="3627102">VerifyPKCS1v15</span><span class="op" id="3627116">(</span><span class="ident" id="3627117">pub</span><span class="op" id="3627120">,</span>&nbsp;<span class="ident" id="3627122">hashType</span><span class="op" id="3627130">,</span>&nbsp;<span class="ident" id="3627132">digest</span><span class="op" id="3627138">,</span>&nbsp;<span class="ident" id="3627140">signature</span><span class="op" id="3627149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627152">case</span>&nbsp;<span class="op" id="3627157">*</span><span class="ident" id="3627158">dsa</span><span class="op" id="3627161">.</span><span class="ident" id="3627162">PublicKey</span><span class="op" id="3627171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3627175">dsaSig</span>&nbsp;<span class="op" id="3627182">:=</span>&nbsp;<span class="builtinfunc" id="3627185">new</span><span class="op" id="3627188">(</span><span class="ident" id="3627189">dsaSignature</span><span class="op" id="3627201">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627205">if</span>&nbsp;<span class="ident" id="3627208">_</span><span class="op" id="3627209">,</span>&nbsp;<span class="ident" id="3627211">err</span>&nbsp;<span class="op" id="3627215">:=</span>&nbsp;<span class="ident" id="3627218">asn1</span><span class="op" id="3627222">.</span><span class="ident" id="3627223">Unmarshal</span><span class="op" id="3627232">(</span><span class="ident" id="3627233">signature</span><span class="op" id="3627242">,</span>&nbsp;<span class="ident" id="3627244">dsaSig</span><span class="op" id="3627250">)</span><span class="op" id="3627251">;</span>&nbsp;<span class="ident" id="3627253">err</span>&nbsp;<span class="op" id="3627257">!=</span>&nbsp;<span class="ident" id="3627260">nil</span>&nbsp;<span class="op" id="3627264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627269">return</span>&nbsp;<span class="ident" id="3627276">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3627282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627286">if</span>&nbsp;<span class="ident" id="3627289">dsaSig</span><span class="op" id="3627295">.</span><span class="ident" id="3627296">R</span><span class="op" id="3627297">.</span><span class="ident" id="3627298">Sign</span><span class="op" id="3627302">(</span><span class="op" id="3627303">)</span>&nbsp;<span class="op" id="3627305">&lt;=</span>&nbsp;<span class="num" id="3627308">0</span>&nbsp;<span class="op" id="3627310">||</span>&nbsp;<span class="ident" id="3627313">dsaSig</span><span class="op" id="3627319">.</span><span class="ident" id="3627320">S</span><span class="op" id="3627321">.</span><span class="ident" id="3627322">Sign</span><span class="op" id="3627326">(</span><span class="op" id="3627327">)</span>&nbsp;<span class="op" id="3627329">&lt;=</span>&nbsp;<span class="num" id="3627332">0</span>&nbsp;<span class="op" id="3627334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627339">return</span>&nbsp;<span class="ident" id="3627346">errors</span><span class="op" id="3627352">.</span><span class="ident" id="3627353">New</span><span class="op" id="3627356">(</span><span class="string" id="3627357">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="3627412">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3627416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627420">if</span>&nbsp;<span class="op" id="3627423">!</span><span class="ident" id="3627424">dsa</span><span class="op" id="3627427">.</span><span class="ident" id="3627428">Verify</span><span class="op" id="3627434">(</span><span class="ident" id="3627435">pub</span><span class="op" id="3627438">,</span>&nbsp;<span class="ident" id="3627440">digest</span><span class="op" id="3627446">,</span>&nbsp;<span class="ident" id="3627448">dsaSig</span><span class="op" id="3627454">.</span><span class="ident" id="3627455">R</span><span class="op" id="3627456">,</span>&nbsp;<span class="ident" id="3627458">dsaSig</span><span class="op" id="3627464">.</span><span class="ident" id="3627465">S</span><span class="op" id="3627466">)</span>&nbsp;<span class="op" id="3627468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627473">return</span>&nbsp;<span class="ident" id="3627480">errors</span><span class="op" id="3627486">.</span><span class="ident" id="3627487">New</span><span class="op" id="3627490">(</span><span class="string" id="3627491">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="3627523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3627527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627531">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627539">case</span>&nbsp;<span class="op" id="3627544">*</span><span class="ident" id="3627545">ecdsa</span><span class="op" id="3627550">.</span><span class="ident" id="3627551">PublicKey</span><span class="op" id="3627560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3627564">ecdsaSig</span>&nbsp;<span class="op" id="3627573">:=</span>&nbsp;<span class="builtinfunc" id="3627576">new</span><span class="op" id="3627579">(</span><span class="ident" id="3627580">ecdsaSignature</span><span class="op" id="3627594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627598">if</span>&nbsp;<span class="ident" id="3627601">_</span><span class="op" id="3627602">,</span>&nbsp;<span class="ident" id="3627604">err</span>&nbsp;<span class="op" id="3627608">:=</span>&nbsp;<span class="ident" id="3627611">asn1</span><span class="op" id="3627615">.</span><span class="ident" id="3627616">Unmarshal</span><span class="op" id="3627625">(</span><span class="ident" id="3627626">signature</span><span class="op" id="3627635">,</span>&nbsp;<span class="ident" id="3627637">ecdsaSig</span><span class="op" id="3627645">)</span><span class="op" id="3627646">;</span>&nbsp;<span class="ident" id="3627648">err</span>&nbsp;<span class="op" id="3627652">!=</span>&nbsp;<span class="ident" id="3627655">nil</span>&nbsp;<span class="op" id="3627659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627664">return</span>&nbsp;<span class="ident" id="3627671">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3627677">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627681">if</span>&nbsp;<span class="ident" id="3627684">ecdsaSig</span><span class="op" id="3627692">.</span><span class="ident" id="3627693">R</span><span class="op" id="3627694">.</span><span class="ident" id="3627695">Sign</span><span class="op" id="3627699">(</span><span class="op" id="3627700">)</span>&nbsp;<span class="op" id="3627702">&lt;=</span>&nbsp;<span class="num" id="3627705">0</span>&nbsp;<span class="op" id="3627707">||</span>&nbsp;<span class="ident" id="3627710">ecdsaSig</span><span class="op" id="3627718">.</span><span class="ident" id="3627719">S</span><span class="op" id="3627720">.</span><span class="ident" id="3627721">Sign</span><span class="op" id="3627725">(</span><span class="op" id="3627726">)</span>&nbsp;<span class="op" id="3627728">&lt;=</span>&nbsp;<span class="num" id="3627731">0</span>&nbsp;<span class="op" id="3627733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627738">return</span>&nbsp;<span class="ident" id="3627745">errors</span><span class="op" id="3627751">.</span><span class="ident" id="3627752">New</span><span class="op" id="3627755">(</span><span class="string" id="3627756">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="3627813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3627817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627821">if</span>&nbsp;<span class="op" id="3627824">!</span><span class="ident" id="3627825">ecdsa</span><span class="op" id="3627830">.</span><span class="ident" id="3627831">Verify</span><span class="op" id="3627837">(</span><span class="ident" id="3627838">pub</span><span class="op" id="3627841">,</span>&nbsp;<span class="ident" id="3627843">digest</span><span class="op" id="3627849">,</span>&nbsp;<span class="ident" id="3627851">ecdsaSig</span><span class="op" id="3627859">.</span><span class="ident" id="3627860">R</span><span class="op" id="3627861">,</span>&nbsp;<span class="ident" id="3627863">ecdsaSig</span><span class="op" id="3627871">.</span><span class="ident" id="3627872">S</span><span class="op" id="3627873">)</span>&nbsp;<span class="op" id="3627875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627880">return</span>&nbsp;<span class="ident" id="3627887">errors</span><span class="op" id="3627893">.</span><span class="ident" id="3627894">New</span><span class="op" id="3627897">(</span><span class="string" id="3627898">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="3627932">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3627936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627940">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3627948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3627951">return</span>&nbsp;<span class="ident" id="3627958">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="3627982">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="3627985">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3628050">func</span>&nbsp;<span class="op" id="3628055">(</span><span class="ident" id="3628056">c</span>&nbsp;<span class="op" id="3628058">*</span><span class="ident" id="3628059">Certificate</span><span class="op" id="3628070">)</span>&nbsp;<span class="ident" id="3628072">CheckCRLSignature</span><span class="op" id="3628089">(</span><span class="ident" id="3628090">crl</span>&nbsp;<span class="op" id="3628094">*</span><span class="ident" id="3628095">pkix</span><span class="op" id="3628099">.</span><span class="ident" id="3628100">CertificateList</span><span class="op" id="3628115">)</span>&nbsp;<span class="op" id="3628117">(</span><span class="ident" id="3628118">err</span>&nbsp;<span class="builtintype" id="3628122">error</span><span class="op" id="3628127">)</span>&nbsp;<span class="op" id="3628129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628132">algo</span>&nbsp;<span class="op" id="3628137">:=</span>&nbsp;<span class="ident" id="3628140">getSignatureAlgorithmFromOID</span><span class="op" id="3628168">(</span><span class="ident" id="3628169">crl</span><span class="op" id="3628172">.</span><span class="ident" id="3628173">SignatureAlgorithm</span><span class="op" id="3628191">.</span><span class="ident" id="3628192">Algorithm</span><span class="op" id="3628201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3628204">return</span>&nbsp;<span class="ident" id="3628211">c</span><span class="op" id="3628212">.</span><span class="ident" id="3628213">CheckSignature</span><span class="op" id="3628227">(</span><span class="ident" id="3628228">algo</span><span class="op" id="3628232">,</span>&nbsp;<span class="ident" id="3628234">crl</span><span class="op" id="3628237">.</span><span class="ident" id="3628238">TBSCertList</span><span class="op" id="3628249">.</span><span class="ident" id="3628250">Raw</span><span class="op" id="3628253">,</span>&nbsp;<span class="ident" id="3628255">crl</span><span class="op" id="3628258">.</span><span class="ident" id="3628259">SignatureValue</span><span class="op" id="3628273">.</span><span class="ident" id="3628274">RightAlign</span><span class="op" id="3628284">(</span><span class="op" id="3628285">)</span><span class="op" id="3628286">)</span><br>
<span class="lineno">680</span><span class="op" id="3628288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3628291">type</span>&nbsp;<span class="ident" id="3628296">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="3628323">struct</span><span class="op" id="3628329">{</span><span class="op" id="3628330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3628333">func</span>&nbsp;<span class="op" id="3628338">(</span><span class="ident" id="3628339">h</span>&nbsp;<span class="ident" id="3628341">UnhandledCriticalExtension</span><span class="op" id="3628367">)</span>&nbsp;<span class="ident" id="3628369">Error</span><span class="op" id="3628374">(</span><span class="op" id="3628375">)</span>&nbsp;<span class="builtintype" id="3628377">string</span>&nbsp;<span class="op" id="3628384">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3628387">return</span>&nbsp;<span class="string" id="3628394">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="3628431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3628434">type</span>&nbsp;<span class="ident" id="3628439">basicConstraints</span>&nbsp;<span class="keyword" id="3628456">struct</span>&nbsp;<span class="op" id="3628463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628466">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3628477">bool</span>&nbsp;<span class="string" id="3628482">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628501">MaxPathLen</span>&nbsp;<span class="builtintype" id="3628512">int</span>&nbsp;&nbsp;<span class="string" id="3628517">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3628546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3628549">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="3628569">type</span>&nbsp;<span class="ident" id="3628574">policyInformation</span>&nbsp;<span class="keyword" id="3628592">struct</span>&nbsp;<span class="op" id="3628599">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628602">Policy</span>&nbsp;<span class="ident" id="3628609">asn1</span><span class="op" id="3628613">.</span><span class="ident" id="3628614">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3628632">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="3628660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3628663">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="3628685">type</span>&nbsp;<span class="ident" id="3628690">nameConstraints</span>&nbsp;<span class="keyword" id="3628706">struct</span>&nbsp;<span class="op" id="3628713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628716">Permitted</span>&nbsp;<span class="op" id="3628726">[</span><span class="op" id="3628727">]</span><span class="ident" id="3628728">generalSubtree</span>&nbsp;<span class="string" id="3628743">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628768">Excluded</span>&nbsp;&nbsp;<span class="op" id="3628778">[</span><span class="op" id="3628779">]</span><span class="ident" id="3628780">generalSubtree</span>&nbsp;<span class="string" id="3628795">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3628819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="3628822">type</span>&nbsp;<span class="ident" id="3628827">generalSubtree</span>&nbsp;<span class="keyword" id="3628842">struct</span>&nbsp;<span class="op" id="3628849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628852">Name</span>&nbsp;<span class="builtintype" id="3628857">string</span>&nbsp;<span class="string" id="3628864">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3628892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3628895">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="3628916">type</span>&nbsp;<span class="ident" id="3628921">authorityInfoAccess</span>&nbsp;<span class="keyword" id="3628941">struct</span>&nbsp;<span class="op" id="3628948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628951">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3628960">asn1</span><span class="op" id="3628964">.</span><span class="ident" id="3628965">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3628983">Location</span>&nbsp;<span class="ident" id="3628992">asn1</span><span class="op" id="3628996">.</span><span class="ident" id="3628997">RawValue</span><br>
<span class="lineno"></span><span class="op" id="3629006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="3629009">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="3629031">type</span>&nbsp;<span class="ident" id="3629036">distributionPoint</span>&nbsp;<span class="keyword" id="3629054">struct</span>&nbsp;<span class="op" id="3629061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629064">DistributionPoint</span>&nbsp;<span class="ident" id="3629082">distributionPointName</span>&nbsp;<span class="string" id="3629104">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629129">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629147">asn1</span><span class="op" id="3629151">.</span><span class="ident" id="3629152">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3629169">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629194">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629212">asn1</span><span class="op" id="3629216">.</span><span class="ident" id="3629217">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3629234">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="3629258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3629261">type</span>&nbsp;<span class="ident" id="3629266">distributionPointName</span>&nbsp;<span class="keyword" id="3629288">struct</span>&nbsp;<span class="op" id="3629295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629298">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629311">asn1</span><span class="op" id="3629315">.</span><span class="ident" id="3629316">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3629328">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629353">RelativeName</span>&nbsp;<span class="ident" id="3629366">pkix</span><span class="op" id="3629370">.</span><span class="ident" id="3629371">RDNSequence</span>&nbsp;<span class="string" id="3629383">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="3629407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3629410">func</span>&nbsp;<span class="ident" id="3629415">parsePublicKey</span><span class="op" id="3629429">(</span><span class="ident" id="3629430">algo</span>&nbsp;<span class="ident" id="3629435">PublicKeyAlgorithm</span><span class="op" id="3629453">,</span>&nbsp;<span class="ident" id="3629455">keyData</span>&nbsp;<span class="op" id="3629463">*</span><span class="ident" id="3629464">publicKeyInfo</span><span class="op" id="3629477">)</span>&nbsp;<span class="op" id="3629479">(</span><span class="keyword" id="3629480">interface</span><span class="op" id="3629489">{</span><span class="op" id="3629490">}</span><span class="op" id="3629491">,</span>&nbsp;<span class="builtintype" id="3629493">error</span><span class="op" id="3629498">)</span>&nbsp;<span class="op" id="3629500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629503">asn1Data</span>&nbsp;<span class="op" id="3629512">:=</span>&nbsp;<span class="ident" id="3629515">keyData</span><span class="op" id="3629522">.</span><span class="ident" id="3629523">PublicKey</span><span class="op" id="3629532">.</span><span class="ident" id="3629533">RightAlign</span><span class="op" id="3629543">(</span><span class="op" id="3629544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629547">switch</span>&nbsp;<span class="ident" id="3629554">algo</span>&nbsp;<span class="op" id="3629559">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629562">case</span>&nbsp;<span class="ident" id="3629567">RSA</span><span class="op" id="3629570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629574">p</span>&nbsp;<span class="op" id="3629576">:=</span>&nbsp;<span class="builtinfunc" id="3629579">new</span><span class="op" id="3629582">(</span><span class="ident" id="3629583">rsaPublicKey</span><span class="op" id="3629595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629599">_</span><span class="op" id="3629600">,</span>&nbsp;<span class="ident" id="3629602">err</span>&nbsp;<span class="op" id="3629606">:=</span>&nbsp;<span class="ident" id="3629609">asn1</span><span class="op" id="3629613">.</span><span class="ident" id="3629614">Unmarshal</span><span class="op" id="3629623">(</span><span class="ident" id="3629624">asn1Data</span><span class="op" id="3629632">,</span>&nbsp;<span class="ident" id="3629634">p</span><span class="op" id="3629635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629639">if</span>&nbsp;<span class="ident" id="3629642">err</span>&nbsp;<span class="op" id="3629646">!=</span>&nbsp;<span class="ident" id="3629649">nil</span>&nbsp;<span class="op" id="3629653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629658">return</span>&nbsp;<span class="ident" id="3629665">nil</span><span class="op" id="3629668">,</span>&nbsp;<span class="ident" id="3629670">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3629676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629681">if</span>&nbsp;<span class="ident" id="3629684">p</span><span class="op" id="3629685">.</span><span class="ident" id="3629686">N</span><span class="op" id="3629687">.</span><span class="ident" id="3629688">Sign</span><span class="op" id="3629692">(</span><span class="op" id="3629693">)</span>&nbsp;<span class="op" id="3629695">&lt;=</span>&nbsp;<span class="num" id="3629698">0</span>&nbsp;<span class="op" id="3629700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629705">return</span>&nbsp;<span class="ident" id="3629712">nil</span><span class="op" id="3629715">,</span>&nbsp;<span class="ident" id="3629717">errors</span><span class="op" id="3629723">.</span><span class="ident" id="3629724">New</span><span class="op" id="3629727">(</span><span class="string" id="3629728">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="3629772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3629776">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629780">if</span>&nbsp;<span class="ident" id="3629783">p</span><span class="op" id="3629784">.</span><span class="ident" id="3629785">E</span>&nbsp;<span class="op" id="3629787">&lt;=</span>&nbsp;<span class="num" id="3629790">0</span>&nbsp;<span class="op" id="3629792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629797">return</span>&nbsp;<span class="ident" id="3629804">nil</span><span class="op" id="3629807">,</span>&nbsp;<span class="ident" id="3629809">errors</span><span class="op" id="3629815">.</span><span class="ident" id="3629816">New</span><span class="op" id="3629819">(</span><span class="string" id="3629820">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="3629872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3629876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629881">pub</span>&nbsp;<span class="op" id="3629885">:=</span>&nbsp;<span class="op" id="3629888">&amp;</span><span class="ident" id="3629889">rsa</span><span class="op" id="3629892">.</span><span class="ident" id="3629893">PublicKey</span><span class="op" id="3629902">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629907">E</span><span class="op" id="3629908">:</span>&nbsp;<span class="ident" id="3629910">p</span><span class="op" id="3629911">.</span><span class="ident" id="3629912">E</span><span class="op" id="3629913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629918">N</span><span class="op" id="3629919">:</span>&nbsp;<span class="ident" id="3629921">p</span><span class="op" id="3629922">.</span><span class="ident" id="3629923">N</span><span class="op" id="3629924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3629928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629932">return</span>&nbsp;<span class="ident" id="3629939">pub</span><span class="op" id="3629942">,</span>&nbsp;<span class="ident" id="3629944">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629949">case</span>&nbsp;<span class="ident" id="3629954">DSA</span><span class="op" id="3629957">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3629961">var</span>&nbsp;<span class="ident" id="3629965">p</span>&nbsp;<span class="op" id="3629967">*</span><span class="ident" id="3629968">big</span><span class="op" id="3629971">.</span><span class="ident" id="3629972">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3629978">_</span><span class="op" id="3629979">,</span>&nbsp;<span class="ident" id="3629981">err</span>&nbsp;<span class="op" id="3629985">:=</span>&nbsp;<span class="ident" id="3629988">asn1</span><span class="op" id="3629992">.</span><span class="ident" id="3629993">Unmarshal</span><span class="op" id="3630002">(</span><span class="ident" id="3630003">asn1Data</span><span class="op" id="3630011">,</span>&nbsp;<span class="op" id="3630013">&amp;</span><span class="ident" id="3630014">p</span><span class="op" id="3630015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630019">if</span>&nbsp;<span class="ident" id="3630022">err</span>&nbsp;<span class="op" id="3630026">!=</span>&nbsp;<span class="ident" id="3630029">nil</span>&nbsp;<span class="op" id="3630033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630038">return</span>&nbsp;<span class="ident" id="3630045">nil</span><span class="op" id="3630048">,</span>&nbsp;<span class="ident" id="3630050">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630056">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630060">paramsData</span>&nbsp;<span class="op" id="3630071">:=</span>&nbsp;<span class="ident" id="3630074">keyData</span><span class="op" id="3630081">.</span><span class="ident" id="3630082">Algorithm</span><span class="op" id="3630091">.</span><span class="ident" id="3630092">Parameters</span><span class="op" id="3630102">.</span><span class="ident" id="3630103">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630115">params</span>&nbsp;<span class="op" id="3630122">:=</span>&nbsp;<span class="builtinfunc" id="3630125">new</span><span class="op" id="3630128">(</span><span class="ident" id="3630129">dsaAlgorithmParameters</span><span class="op" id="3630151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630155">_</span><span class="op" id="3630156">,</span>&nbsp;<span class="ident" id="3630158">err</span>&nbsp;<span class="op" id="3630162">=</span>&nbsp;<span class="ident" id="3630164">asn1</span><span class="op" id="3630168">.</span><span class="ident" id="3630169">Unmarshal</span><span class="op" id="3630178">(</span><span class="ident" id="3630179">paramsData</span><span class="op" id="3630189">,</span>&nbsp;<span class="ident" id="3630191">params</span><span class="op" id="3630197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630201">if</span>&nbsp;<span class="ident" id="3630204">err</span>&nbsp;<span class="op" id="3630208">!=</span>&nbsp;<span class="ident" id="3630211">nil</span>&nbsp;<span class="op" id="3630215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630220">return</span>&nbsp;<span class="ident" id="3630227">nil</span><span class="op" id="3630230">,</span>&nbsp;<span class="ident" id="3630232">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630242">if</span>&nbsp;<span class="ident" id="3630245">p</span><span class="op" id="3630246">.</span><span class="ident" id="3630247">Sign</span><span class="op" id="3630251">(</span><span class="op" id="3630252">)</span>&nbsp;<span class="op" id="3630254">&lt;=</span>&nbsp;<span class="num" id="3630257">0</span>&nbsp;<span class="op" id="3630259">||</span>&nbsp;<span class="ident" id="3630262">params</span><span class="op" id="3630268">.</span><span class="ident" id="3630269">P</span><span class="op" id="3630270">.</span><span class="ident" id="3630271">Sign</span><span class="op" id="3630275">(</span><span class="op" id="3630276">)</span>&nbsp;<span class="op" id="3630278">&lt;=</span>&nbsp;<span class="num" id="3630281">0</span>&nbsp;<span class="op" id="3630283">||</span>&nbsp;<span class="ident" id="3630286">params</span><span class="op" id="3630292">.</span><span class="ident" id="3630293">Q</span><span class="op" id="3630294">.</span><span class="ident" id="3630295">Sign</span><span class="op" id="3630299">(</span><span class="op" id="3630300">)</span>&nbsp;<span class="op" id="3630302">&lt;=</span>&nbsp;<span class="num" id="3630305">0</span>&nbsp;<span class="op" id="3630307">||</span>&nbsp;<span class="ident" id="3630310">params</span><span class="op" id="3630316">.</span><span class="ident" id="3630317">G</span><span class="op" id="3630318">.</span><span class="ident" id="3630319">Sign</span><span class="op" id="3630323">(</span><span class="op" id="3630324">)</span>&nbsp;<span class="op" id="3630326">&lt;=</span>&nbsp;<span class="num" id="3630329">0</span>&nbsp;<span class="op" id="3630331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630336">return</span>&nbsp;<span class="ident" id="3630343">nil</span><span class="op" id="3630346">,</span>&nbsp;<span class="ident" id="3630348">errors</span><span class="op" id="3630354">.</span><span class="ident" id="3630355">New</span><span class="op" id="3630358">(</span><span class="string" id="3630359">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="3630397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630405">pub</span>&nbsp;<span class="op" id="3630409">:=</span>&nbsp;<span class="op" id="3630412">&amp;</span><span class="ident" id="3630413">dsa</span><span class="op" id="3630416">.</span><span class="ident" id="3630417">PublicKey</span><span class="op" id="3630426">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630431">Parameters</span><span class="op" id="3630441">:</span>&nbsp;<span class="ident" id="3630443">dsa</span><span class="op" id="3630446">.</span><span class="ident" id="3630447">Parameters</span><span class="op" id="3630457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630463">P</span><span class="op" id="3630464">:</span>&nbsp;<span class="ident" id="3630466">params</span><span class="op" id="3630472">.</span><span class="ident" id="3630473">P</span><span class="op" id="3630474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630480">Q</span><span class="op" id="3630481">:</span>&nbsp;<span class="ident" id="3630483">params</span><span class="op" id="3630489">.</span><span class="ident" id="3630490">Q</span><span class="op" id="3630491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630497">G</span><span class="op" id="3630498">:</span>&nbsp;<span class="ident" id="3630500">params</span><span class="op" id="3630506">.</span><span class="ident" id="3630507">G</span><span class="op" id="3630508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630513">}</span><span class="op" id="3630514">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630519">Y</span><span class="op" id="3630520">:</span>&nbsp;<span class="ident" id="3630522">p</span><span class="op" id="3630523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630531">return</span>&nbsp;<span class="ident" id="3630538">pub</span><span class="op" id="3630541">,</span>&nbsp;<span class="ident" id="3630543">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630548">case</span>&nbsp;<span class="ident" id="3630553">ECDSA</span><span class="op" id="3630558">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630562">paramsData</span>&nbsp;<span class="op" id="3630573">:=</span>&nbsp;<span class="ident" id="3630576">keyData</span><span class="op" id="3630583">.</span><span class="ident" id="3630584">Algorithm</span><span class="op" id="3630593">.</span><span class="ident" id="3630594">Parameters</span><span class="op" id="3630604">.</span><span class="ident" id="3630605">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630617">namedCurveOID</span>&nbsp;<span class="op" id="3630631">:=</span>&nbsp;<span class="builtinfunc" id="3630634">new</span><span class="op" id="3630637">(</span><span class="ident" id="3630638">asn1</span><span class="op" id="3630642">.</span><span class="ident" id="3630643">ObjectIdentifier</span><span class="op" id="3630659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630663">_</span><span class="op" id="3630664">,</span>&nbsp;<span class="ident" id="3630666">err</span>&nbsp;<span class="op" id="3630670">:=</span>&nbsp;<span class="ident" id="3630673">asn1</span><span class="op" id="3630677">.</span><span class="ident" id="3630678">Unmarshal</span><span class="op" id="3630687">(</span><span class="ident" id="3630688">paramsData</span><span class="op" id="3630698">,</span>&nbsp;<span class="ident" id="3630700">namedCurveOID</span><span class="op" id="3630713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630717">if</span>&nbsp;<span class="ident" id="3630720">err</span>&nbsp;<span class="op" id="3630724">!=</span>&nbsp;<span class="ident" id="3630727">nil</span>&nbsp;<span class="op" id="3630731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630736">return</span>&nbsp;<span class="ident" id="3630743">nil</span><span class="op" id="3630746">,</span>&nbsp;<span class="ident" id="3630748">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630754">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630758">namedCurve</span>&nbsp;<span class="op" id="3630769">:=</span>&nbsp;<span class="ident" id="3630772">namedCurveFromOID</span><span class="op" id="3630789">(</span><span class="op" id="3630790">*</span><span class="ident" id="3630791">namedCurveOID</span><span class="op" id="3630804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630808">if</span>&nbsp;<span class="ident" id="3630811">namedCurve</span>&nbsp;<span class="op" id="3630822">==</span>&nbsp;<span class="ident" id="3630825">nil</span>&nbsp;<span class="op" id="3630829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630834">return</span>&nbsp;<span class="ident" id="3630841">nil</span><span class="op" id="3630844">,</span>&nbsp;<span class="ident" id="3630846">errors</span><span class="op" id="3630852">.</span><span class="ident" id="3630853">New</span><span class="op" id="3630856">(</span><span class="string" id="3630857">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3630891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3630895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3630899">x</span><span class="op" id="3630900">,</span>&nbsp;<span class="ident" id="3630902">y</span>&nbsp;<span class="op" id="3630904">:=</span>&nbsp;<span class="ident" id="3630907">elliptic</span><span class="op" id="3630915">.</span><span class="ident" id="3630916">Unmarshal</span><span class="op" id="3630925">(</span><span class="ident" id="3630926">namedCurve</span><span class="op" id="3630936">,</span>&nbsp;<span class="ident" id="3630938">asn1Data</span><span class="op" id="3630946">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630950">if</span>&nbsp;<span class="ident" id="3630953">x</span>&nbsp;<span class="op" id="3630955">==</span>&nbsp;<span class="ident" id="3630958">nil</span>&nbsp;<span class="op" id="3630962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3630967">return</span>&nbsp;<span class="ident" id="3630974">nil</span><span class="op" id="3630977">,</span>&nbsp;<span class="ident" id="3630979">errors</span><span class="op" id="3630985">.</span><span class="ident" id="3630986">New</span><span class="op" id="3630989">(</span><span class="string" id="3630990">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="3631038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3631042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631046">pub</span>&nbsp;<span class="op" id="3631050">:=</span>&nbsp;<span class="op" id="3631053">&amp;</span><span class="ident" id="3631054">ecdsa</span><span class="op" id="3631059">.</span><span class="ident" id="3631060">PublicKey</span><span class="op" id="3631069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631074">Curve</span><span class="op" id="3631079">:</span>&nbsp;<span class="ident" id="3631081">namedCurve</span><span class="op" id="3631091">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631096">X</span><span class="op" id="3631097">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631103">x</span><span class="op" id="3631104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3631109">Y</span><span class="op" id="3631110">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631116">y</span><span class="op" id="3631117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3631121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631125">return</span>&nbsp;<span class="ident" id="3631132">pub</span><span class="op" id="3631135">,</span>&nbsp;<span class="ident" id="3631137">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631142">default</span><span class="op" id="3631149">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631153">return</span>&nbsp;<span class="ident" id="3631160">nil</span><span class="op" id="3631163">,</span>&nbsp;<span class="ident" id="3631165">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3631170">}</span><br>
<span class="lineno"></span><span class="op" id="3631172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3631175">func</span>&nbsp;<span class="ident" id="3631180">parseSANExtension</span><span class="op" id="3631197">(</span><span class="ident" id="3631198">value</span>&nbsp;<span class="op" id="3631204">[</span><span class="op" id="3631205">]</span><span class="builtintype" id="3631206">byte</span><span class="op" id="3631210">)</span>&nbsp;<span class="op" id="3631212">(</span><span class="ident" id="3631213">dnsNames</span><span class="op" id="3631221">,</span>&nbsp;<span class="ident" id="3631223">emailAddresses</span>&nbsp;<span class="op" id="3631238">[</span><span class="op" id="3631239">]</span><span class="builtintype" id="3631240">string</span><span class="op" id="3631246">,</span>&nbsp;<span class="ident" id="3631248">ipAddresses</span>&nbsp;<span class="op" id="3631260">[</span><span class="op" id="3631261">]</span><span class="ident" id="3631262">net</span><span class="op" id="3631265">.</span><span class="ident" id="3631266">IP</span><span class="op" id="3631268">,</span>&nbsp;<span class="ident" id="3631270">err</span>&nbsp;<span class="builtintype" id="3631274">error</span><span class="op" id="3631279">)</span>&nbsp;<span class="op" id="3631281">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631284">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631307">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631343">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631347">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631406">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631410">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631439">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631499">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631559">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631619">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631679">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631734">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631797">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631857">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3631920">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3631989">var</span>&nbsp;<span class="ident" id="3631993">seq</span>&nbsp;<span class="ident" id="3631997">asn1</span><span class="op" id="3632001">.</span><span class="ident" id="3632002">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632012">if</span>&nbsp;<span class="ident" id="3632015">_</span><span class="op" id="3632016">,</span>&nbsp;<span class="ident" id="3632018">err</span>&nbsp;<span class="op" id="3632022">=</span>&nbsp;<span class="ident" id="3632024">asn1</span><span class="op" id="3632028">.</span><span class="ident" id="3632029">Unmarshal</span><span class="op" id="3632038">(</span><span class="ident" id="3632039">value</span><span class="op" id="3632044">,</span>&nbsp;<span class="op" id="3632046">&amp;</span><span class="ident" id="3632047">seq</span><span class="op" id="3632050">)</span><span class="op" id="3632051">;</span>&nbsp;<span class="ident" id="3632053">err</span>&nbsp;<span class="op" id="3632057">!=</span>&nbsp;<span class="ident" id="3632060">nil</span>&nbsp;<span class="op" id="3632064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632068">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632076">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632079">if</span>&nbsp;<span class="op" id="3632082">!</span><span class="ident" id="3632083">seq</span><span class="op" id="3632086">.</span><span class="ident" id="3632087">IsCompound</span>&nbsp;<span class="op" id="3632098">||</span>&nbsp;<span class="ident" id="3632101">seq</span><span class="op" id="3632104">.</span><span class="ident" id="3632105">Tag</span>&nbsp;<span class="op" id="3632109">!=</span>&nbsp;<span class="num" id="3632112">16</span>&nbsp;<span class="op" id="3632115">||</span>&nbsp;<span class="ident" id="3632118">seq</span><span class="op" id="3632121">.</span><span class="ident" id="3632122">Class</span>&nbsp;<span class="op" id="3632128">!=</span>&nbsp;<span class="num" id="3632131">0</span>&nbsp;<span class="op" id="3632133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632137">err</span>&nbsp;<span class="op" id="3632141">=</span>&nbsp;<span class="ident" id="3632143">asn1</span><span class="op" id="3632147">.</span><span class="ident" id="3632148">StructuralError</span><span class="op" id="3632163">{</span><span class="ident" id="3632164">Msg</span><span class="op" id="3632167">:</span>&nbsp;<span class="string" id="3632169">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="3632187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632191">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632203">rest</span>&nbsp;<span class="op" id="3632208">:=</span>&nbsp;<span class="ident" id="3632211">seq</span><span class="op" id="3632214">.</span><span class="ident" id="3632215">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632222">for</span>&nbsp;<span class="builtinfunc" id="3632226">len</span><span class="op" id="3632229">(</span><span class="ident" id="3632230">rest</span><span class="op" id="3632234">)</span>&nbsp;<span class="op" id="3632236">&gt;</span>&nbsp;<span class="num" id="3632238">0</span>&nbsp;<span class="op" id="3632240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632244">var</span>&nbsp;<span class="ident" id="3632248">v</span>&nbsp;<span class="ident" id="3632250">asn1</span><span class="op" id="3632254">.</span><span class="ident" id="3632255">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632266">rest</span><span class="op" id="3632270">,</span>&nbsp;<span class="ident" id="3632272">err</span>&nbsp;<span class="op" id="3632276">=</span>&nbsp;<span class="ident" id="3632278">asn1</span><span class="op" id="3632282">.</span><span class="ident" id="3632283">Unmarshal</span><span class="op" id="3632292">(</span><span class="ident" id="3632293">rest</span><span class="op" id="3632297">,</span>&nbsp;<span class="op" id="3632299">&amp;</span><span class="ident" id="3632300">v</span><span class="op" id="3632301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632305">if</span>&nbsp;<span class="ident" id="3632308">err</span>&nbsp;<span class="op" id="3632312">!=</span>&nbsp;<span class="ident" id="3632315">nil</span>&nbsp;<span class="op" id="3632319">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632324">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632337">switch</span>&nbsp;<span class="ident" id="3632344">v</span><span class="op" id="3632345">.</span><span class="ident" id="3632346">Tag</span>&nbsp;<span class="op" id="3632350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632354">case</span>&nbsp;<span class="num" id="3632359">1</span><span class="op" id="3632360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632365">emailAddresses</span>&nbsp;<span class="op" id="3632380">=</span>&nbsp;<span class="builtinfunc" id="3632382">append</span><span class="op" id="3632388">(</span><span class="ident" id="3632389">emailAddresses</span><span class="op" id="3632403">,</span>&nbsp;<span class="builtintype" id="3632405">string</span><span class="op" id="3632411">(</span><span class="ident" id="3632412">v</span><span class="op" id="3632413">.</span><span class="ident" id="3632414">Bytes</span><span class="op" id="3632419">)</span><span class="op" id="3632420">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632424">case</span>&nbsp;<span class="num" id="3632429">2</span><span class="op" id="3632430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632435">dnsNames</span>&nbsp;<span class="op" id="3632444">=</span>&nbsp;<span class="builtinfunc" id="3632446">append</span><span class="op" id="3632452">(</span><span class="ident" id="3632453">dnsNames</span><span class="op" id="3632461">,</span>&nbsp;<span class="builtintype" id="3632463">string</span><span class="op" id="3632469">(</span><span class="ident" id="3632470">v</span><span class="op" id="3632471">.</span><span class="ident" id="3632472">Bytes</span><span class="op" id="3632477">)</span><span class="op" id="3632478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632482">case</span>&nbsp;<span class="num" id="3632487">7</span><span class="op" id="3632488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632493">switch</span>&nbsp;<span class="builtinfunc" id="3632500">len</span><span class="op" id="3632503">(</span><span class="ident" id="3632504">v</span><span class="op" id="3632505">.</span><span class="ident" id="3632506">Bytes</span><span class="op" id="3632511">)</span>&nbsp;<span class="op" id="3632513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632518">case</span>&nbsp;<span class="ident" id="3632523">net</span><span class="op" id="3632526">.</span><span class="ident" id="3632527">IPv4len</span><span class="op" id="3632534">,</span>&nbsp;<span class="ident" id="3632536">net</span><span class="op" id="3632539">.</span><span class="ident" id="3632540">IPv6len</span><span class="op" id="3632547">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632553">ipAddresses</span>&nbsp;<span class="op" id="3632565">=</span>&nbsp;<span class="builtinfunc" id="3632567">append</span><span class="op" id="3632573">(</span><span class="ident" id="3632574">ipAddresses</span><span class="op" id="3632585">,</span>&nbsp;<span class="ident" id="3632587">v</span><span class="op" id="3632588">.</span><span class="ident" id="3632589">Bytes</span><span class="op" id="3632594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632599">default</span><span class="op" id="3632606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632612">err</span>&nbsp;<span class="op" id="3632616">=</span>&nbsp;<span class="ident" id="3632618">errors</span><span class="op" id="3632624">.</span><span class="ident" id="3632625">New</span><span class="op" id="3632628">(</span><span class="string" id="3632629">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="3632681">+</span>&nbsp;<span class="ident" id="3632683">strconv</span><span class="op" id="3632690">.</span><span class="ident" id="3632691">Itoa</span><span class="op" id="3632695">(</span><span class="builtinfunc" id="3632696">len</span><span class="op" id="3632699">(</span><span class="ident" id="3632700">v</span><span class="op" id="3632701">.</span><span class="ident" id="3632702">Bytes</span><span class="op" id="3632707">)</span><span class="op" id="3632708">)</span><span class="op" id="3632709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632715">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632725">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3632732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3632736">return</span><br>
<span class="lineno"></span><span class="op" id="3632743">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="3632746">func</span>&nbsp;<span class="ident" id="3632751">parseCertificate</span><span class="op" id="3632767">(</span><span class="ident" id="3632768">in</span>&nbsp;<span class="op" id="3632771">*</span><span class="ident" id="3632772">certificate</span><span class="op" id="3632783">)</span>&nbsp;<span class="op" id="3632785">(</span><span class="op" id="3632786">*</span><span class="ident" id="3632787">Certificate</span><span class="op" id="3632798">,</span>&nbsp;<span class="builtintype" id="3632800">error</span><span class="op" id="3632805">)</span>&nbsp;<span class="op" id="3632807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632810">out</span>&nbsp;<span class="op" id="3632814">:=</span>&nbsp;<span class="builtinfunc" id="3632817">new</span><span class="op" id="3632820">(</span><span class="ident" id="3632821">Certificate</span><span class="op" id="3632832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632835">out</span><span class="op" id="3632838">.</span><span class="ident" id="3632839">Raw</span>&nbsp;<span class="op" id="3632843">=</span>&nbsp;<span class="ident" id="3632845">in</span><span class="op" id="3632847">.</span><span class="ident" id="3632848">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632853">out</span><span class="op" id="3632856">.</span><span class="ident" id="3632857">RawTBSCertificate</span>&nbsp;<span class="op" id="3632875">=</span>&nbsp;<span class="ident" id="3632877">in</span><span class="op" id="3632879">.</span><span class="ident" id="3632880">TBSCertificate</span><span class="op" id="3632894">.</span><span class="ident" id="3632895">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632900">out</span><span class="op" id="3632903">.</span><span class="ident" id="3632904">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="3632928">=</span>&nbsp;<span class="ident" id="3632930">in</span><span class="op" id="3632932">.</span><span class="ident" id="3632933">TBSCertificate</span><span class="op" id="3632947">.</span><span class="ident" id="3632948">PublicKey</span><span class="op" id="3632957">.</span><span class="ident" id="3632958">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3632963">out</span><span class="op" id="3632966">.</span><span class="ident" id="3632967">RawSubject</span>&nbsp;<span class="op" id="3632978">=</span>&nbsp;<span class="ident" id="3632980">in</span><span class="op" id="3632982">.</span><span class="ident" id="3632983">TBSCertificate</span><span class="op" id="3632997">.</span><span class="ident" id="3632998">Subject</span><span class="op" id="3633005">.</span><span class="ident" id="3633006">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633017">out</span><span class="op" id="3633020">.</span><span class="ident" id="3633021">RawIssuer</span>&nbsp;<span class="op" id="3633031">=</span>&nbsp;<span class="ident" id="3633033">in</span><span class="op" id="3633035">.</span><span class="ident" id="3633036">TBSCertificate</span><span class="op" id="3633050">.</span><span class="ident" id="3633051">Issuer</span><span class="op" id="3633057">.</span><span class="ident" id="3633058">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633070">out</span><span class="op" id="3633073">.</span><span class="ident" id="3633074">Signature</span>&nbsp;<span class="op" id="3633084">=</span>&nbsp;<span class="ident" id="3633086">in</span><span class="op" id="3633088">.</span><span class="ident" id="3633089">SignatureValue</span><span class="op" id="3633103">.</span><span class="ident" id="3633104">RightAlign</span><span class="op" id="3633114">(</span><span class="op" id="3633115">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633118">out</span><span class="op" id="3633121">.</span><span class="ident" id="3633122">SignatureAlgorithm</span>&nbsp;<span class="op" id="3633141">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633145">getSignatureAlgorithmFromOID</span><span class="op" id="3633173">(</span><span class="ident" id="3633174">in</span><span class="op" id="3633176">.</span><span class="ident" id="3633177">TBSCertificate</span><span class="op" id="3633191">.</span><span class="ident" id="3633192">SignatureAlgorithm</span><span class="op" id="3633210">.</span><span class="ident" id="3633211">Algorithm</span><span class="op" id="3633220">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633224">out</span><span class="op" id="3633227">.</span><span class="ident" id="3633228">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3633247">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633251">getPublicKeyAlgorithmFromOID</span><span class="op" id="3633279">(</span><span class="ident" id="3633280">in</span><span class="op" id="3633282">.</span><span class="ident" id="3633283">TBSCertificate</span><span class="op" id="3633297">.</span><span class="ident" id="3633298">PublicKey</span><span class="op" id="3633307">.</span><span class="ident" id="3633308">Algorithm</span><span class="op" id="3633317">.</span><span class="ident" id="3633318">Algorithm</span><span class="op" id="3633327">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633330">var</span>&nbsp;<span class="ident" id="3633334">err</span>&nbsp;<span class="builtintype" id="3633338">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633345">out</span><span class="op" id="3633348">.</span><span class="ident" id="3633349">PublicKey</span><span class="op" id="3633358">,</span>&nbsp;<span class="ident" id="3633360">err</span>&nbsp;<span class="op" id="3633364">=</span>&nbsp;<span class="ident" id="3633366">parsePublicKey</span><span class="op" id="3633380">(</span><span class="ident" id="3633381">out</span><span class="op" id="3633384">.</span><span class="ident" id="3633385">PublicKeyAlgorithm</span><span class="op" id="3633403">,</span>&nbsp;<span class="op" id="3633405">&amp;</span><span class="ident" id="3633406">in</span><span class="op" id="3633408">.</span><span class="ident" id="3633409">TBSCertificate</span><span class="op" id="3633423">.</span><span class="ident" id="3633424">PublicKey</span><span class="op" id="3633433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633436">if</span>&nbsp;<span class="ident" id="3633439">err</span>&nbsp;<span class="op" id="3633443">!=</span>&nbsp;<span class="ident" id="3633446">nil</span>&nbsp;<span class="op" id="3633450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633454">return</span>&nbsp;<span class="ident" id="3633461">nil</span><span class="op" id="3633464">,</span>&nbsp;<span class="ident" id="3633466">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3633471">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633475">if</span>&nbsp;<span class="ident" id="3633478">in</span><span class="op" id="3633480">.</span><span class="ident" id="3633481">TBSCertificate</span><span class="op" id="3633495">.</span><span class="ident" id="3633496">SerialNumber</span><span class="op" id="3633508">.</span><span class="ident" id="3633509">Sign</span><span class="op" id="3633513">(</span><span class="op" id="3633514">)</span>&nbsp;<span class="op" id="3633516">&lt;</span>&nbsp;<span class="num" id="3633518">0</span>&nbsp;<span class="op" id="3633520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633524">return</span>&nbsp;<span class="ident" id="3633531">nil</span><span class="op" id="3633534">,</span>&nbsp;<span class="ident" id="3633536">errors</span><span class="op" id="3633542">.</span><span class="ident" id="3633543">New</span><span class="op" id="3633546">(</span><span class="string" id="3633547">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="3633577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3633580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633584">out</span><span class="op" id="3633587">.</span><span class="ident" id="3633588">Version</span>&nbsp;<span class="op" id="3633596">=</span>&nbsp;<span class="ident" id="3633598">in</span><span class="op" id="3633600">.</span><span class="ident" id="3633601">TBSCertificate</span><span class="op" id="3633615">.</span><span class="ident" id="3633616">Version</span>&nbsp;<span class="op" id="3633624">+</span>&nbsp;<span class="num" id="3633626">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633629">out</span><span class="op" id="3633632">.</span><span class="ident" id="3633633">SerialNumber</span>&nbsp;<span class="op" id="3633646">=</span>&nbsp;<span class="ident" id="3633648">in</span><span class="op" id="3633650">.</span><span class="ident" id="3633651">TBSCertificate</span><span class="op" id="3633665">.</span><span class="ident" id="3633666">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633681">var</span>&nbsp;<span class="ident" id="3633685">issuer</span><span class="op" id="3633691">,</span>&nbsp;<span class="ident" id="3633693">subject</span>&nbsp;<span class="ident" id="3633701">pkix</span><span class="op" id="3633705">.</span><span class="ident" id="3633706">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633719">if</span>&nbsp;<span class="ident" id="3633722">_</span><span class="op" id="3633723">,</span>&nbsp;<span class="ident" id="3633725">err</span>&nbsp;<span class="op" id="3633729">:=</span>&nbsp;<span class="ident" id="3633732">asn1</span><span class="op" id="3633736">.</span><span class="ident" id="3633737">Unmarshal</span><span class="op" id="3633746">(</span><span class="ident" id="3633747">in</span><span class="op" id="3633749">.</span><span class="ident" id="3633750">TBSCertificate</span><span class="op" id="3633764">.</span><span class="ident" id="3633765">Subject</span><span class="op" id="3633772">.</span><span class="ident" id="3633773">FullBytes</span><span class="op" id="3633782">,</span>&nbsp;<span class="op" id="3633784">&amp;</span><span class="ident" id="3633785">subject</span><span class="op" id="3633792">)</span><span class="op" id="3633793">;</span>&nbsp;<span class="ident" id="3633795">err</span>&nbsp;<span class="op" id="3633799">!=</span>&nbsp;<span class="ident" id="3633802">nil</span>&nbsp;<span class="op" id="3633806">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633810">return</span>&nbsp;<span class="ident" id="3633817">nil</span><span class="op" id="3633820">,</span>&nbsp;<span class="ident" id="3633822">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3633827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633830">if</span>&nbsp;<span class="ident" id="3633833">_</span><span class="op" id="3633834">,</span>&nbsp;<span class="ident" id="3633836">err</span>&nbsp;<span class="op" id="3633840">:=</span>&nbsp;<span class="ident" id="3633843">asn1</span><span class="op" id="3633847">.</span><span class="ident" id="3633848">Unmarshal</span><span class="op" id="3633857">(</span><span class="ident" id="3633858">in</span><span class="op" id="3633860">.</span><span class="ident" id="3633861">TBSCertificate</span><span class="op" id="3633875">.</span><span class="ident" id="3633876">Issuer</span><span class="op" id="3633882">.</span><span class="ident" id="3633883">FullBytes</span><span class="op" id="3633892">,</span>&nbsp;<span class="op" id="3633894">&amp;</span><span class="ident" id="3633895">issuer</span><span class="op" id="3633901">)</span><span class="op" id="3633902">;</span>&nbsp;<span class="ident" id="3633904">err</span>&nbsp;<span class="op" id="3633908">!=</span>&nbsp;<span class="ident" id="3633911">nil</span>&nbsp;<span class="op" id="3633915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3633919">return</span>&nbsp;<span class="ident" id="3633926">nil</span><span class="op" id="3633929">,</span>&nbsp;<span class="ident" id="3633931">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3633936">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633940">out</span><span class="op" id="3633943">.</span><span class="ident" id="3633944">Issuer</span><span class="op" id="3633950">.</span><span class="ident" id="3633951">FillFromRDNSequence</span><span class="op" id="3633970">(</span><span class="op" id="3633971">&amp;</span><span class="ident" id="3633972">issuer</span><span class="op" id="3633978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3633981">out</span><span class="op" id="3633984">.</span><span class="ident" id="3633985">Subject</span><span class="op" id="3633992">.</span><span class="ident" id="3633993">FillFromRDNSequence</span><span class="op" id="3634012">(</span><span class="op" id="3634013">&amp;</span><span class="ident" id="3634014">subject</span><span class="op" id="3634021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634025">out</span><span class="op" id="3634028">.</span><span class="ident" id="3634029">NotBefore</span>&nbsp;<span class="op" id="3634039">=</span>&nbsp;<span class="ident" id="3634041">in</span><span class="op" id="3634043">.</span><span class="ident" id="3634044">TBSCertificate</span><span class="op" id="3634058">.</span><span class="ident" id="3634059">Validity</span><span class="op" id="3634067">.</span><span class="ident" id="3634068">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634079">out</span><span class="op" id="3634082">.</span><span class="ident" id="3634083">NotAfter</span>&nbsp;<span class="op" id="3634092">=</span>&nbsp;<span class="ident" id="3634094">in</span><span class="op" id="3634096">.</span><span class="ident" id="3634097">TBSCertificate</span><span class="op" id="3634111">.</span><span class="ident" id="3634112">Validity</span><span class="op" id="3634120">.</span><span class="ident" id="3634121">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634132">for</span>&nbsp;<span class="ident" id="3634136">_</span><span class="op" id="3634137">,</span>&nbsp;<span class="ident" id="3634139">e</span>&nbsp;<span class="op" id="3634141">:=</span>&nbsp;<span class="keyword" id="3634144">range</span>&nbsp;<span class="ident" id="3634150">in</span><span class="op" id="3634152">.</span><span class="ident" id="3634153">TBSCertificate</span><span class="op" id="3634167">.</span><span class="ident" id="3634168">Extensions</span>&nbsp;<span class="op" id="3634179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634183">out</span><span class="op" id="3634186">.</span><span class="ident" id="3634187">Extensions</span>&nbsp;<span class="op" id="3634198">=</span>&nbsp;<span class="builtinfunc" id="3634200">append</span><span class="op" id="3634206">(</span><span class="ident" id="3634207">out</span><span class="op" id="3634210">.</span><span class="ident" id="3634211">Extensions</span><span class="op" id="3634221">,</span>&nbsp;<span class="ident" id="3634223">e</span><span class="op" id="3634224">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634229">if</span>&nbsp;<span class="builtinfunc" id="3634232">len</span><span class="op" id="3634235">(</span><span class="ident" id="3634236">e</span><span class="op" id="3634237">.</span><span class="ident" id="3634238">Id</span><span class="op" id="3634240">)</span>&nbsp;<span class="op" id="3634242">==</span>&nbsp;<span class="num" id="3634245">4</span>&nbsp;<span class="op" id="3634247">&amp;&amp;</span>&nbsp;<span class="ident" id="3634250">e</span><span class="op" id="3634251">.</span><span class="ident" id="3634252">Id</span><span class="op" id="3634254">[</span><span class="num" id="3634255">0</span><span class="op" id="3634256">]</span>&nbsp;<span class="op" id="3634258">==</span>&nbsp;<span class="num" id="3634261">2</span>&nbsp;<span class="op" id="3634263">&amp;&amp;</span>&nbsp;<span class="ident" id="3634266">e</span><span class="op" id="3634267">.</span><span class="ident" id="3634268">Id</span><span class="op" id="3634270">[</span><span class="num" id="3634271">1</span><span class="op" id="3634272">]</span>&nbsp;<span class="op" id="3634274">==</span>&nbsp;<span class="num" id="3634277">5</span>&nbsp;<span class="op" id="3634279">&amp;&amp;</span>&nbsp;<span class="ident" id="3634282">e</span><span class="op" id="3634283">.</span><span class="ident" id="3634284">Id</span><span class="op" id="3634286">[</span><span class="num" id="3634287">2</span><span class="op" id="3634288">]</span>&nbsp;<span class="op" id="3634290">==</span>&nbsp;<span class="num" id="3634293">29</span>&nbsp;<span class="op" id="3634296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634301">switch</span>&nbsp;<span class="ident" id="3634308">e</span><span class="op" id="3634309">.</span><span class="ident" id="3634310">Id</span><span class="op" id="3634312">[</span><span class="num" id="3634313">3</span><span class="op" id="3634314">]</span>&nbsp;<span class="op" id="3634316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634321">case</span>&nbsp;<span class="num" id="3634326">15</span><span class="op" id="3634328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3634334">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634359">var</span>&nbsp;<span class="ident" id="3634363">usageBits</span>&nbsp;<span class="ident" id="3634373">asn1</span><span class="op" id="3634377">.</span><span class="ident" id="3634378">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634392">_</span><span class="op" id="3634393">,</span>&nbsp;<span class="ident" id="3634395">err</span>&nbsp;<span class="op" id="3634399">:=</span>&nbsp;<span class="ident" id="3634402">asn1</span><span class="op" id="3634406">.</span><span class="ident" id="3634407">Unmarshal</span><span class="op" id="3634416">(</span><span class="ident" id="3634417">e</span><span class="op" id="3634418">.</span><span class="ident" id="3634419">Value</span><span class="op" id="3634424">,</span>&nbsp;<span class="op" id="3634426">&amp;</span><span class="ident" id="3634427">usageBits</span><span class="op" id="3634436">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634443">if</span>&nbsp;<span class="ident" id="3634446">err</span>&nbsp;<span class="op" id="3634450">==</span>&nbsp;<span class="ident" id="3634453">nil</span>&nbsp;<span class="op" id="3634457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634464">var</span>&nbsp;<span class="ident" id="3634468">usage</span>&nbsp;<span class="builtintype" id="3634474">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634483">for</span>&nbsp;<span class="ident" id="3634487">i</span>&nbsp;<span class="op" id="3634489">:=</span>&nbsp;<span class="num" id="3634492">0</span><span class="op" id="3634493">;</span>&nbsp;<span class="ident" id="3634495">i</span>&nbsp;<span class="op" id="3634497">&lt;</span>&nbsp;<span class="num" id="3634499">9</span><span class="op" id="3634500">;</span>&nbsp;<span class="ident" id="3634502">i</span><span class="op" id="3634503">++</span>&nbsp;<span class="op" id="3634506">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634514">if</span>&nbsp;<span class="ident" id="3634517">usageBits</span><span class="op" id="3634526">.</span><span class="ident" id="3634527">At</span><span class="op" id="3634529">(</span><span class="ident" id="3634530">i</span><span class="op" id="3634531">)</span>&nbsp;<span class="op" id="3634533">!=</span>&nbsp;<span class="num" id="3634536">0</span>&nbsp;<span class="op" id="3634538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634547">usage</span>&nbsp;<span class="op" id="3634553">|=</span>&nbsp;<span class="num" id="3634556">1</span>&nbsp;<span class="op" id="3634558">&lt;&lt;</span>&nbsp;<span class="builtintype" id="3634561">uint</span><span class="op" id="3634565">(</span><span class="ident" id="3634566">i</span><span class="op" id="3634567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3634575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3634582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634589">out</span><span class="op" id="3634592">.</span><span class="ident" id="3634593">KeyUsage</span>&nbsp;<span class="op" id="3634602">=</span>&nbsp;<span class="ident" id="3634604">KeyUsage</span><span class="op" id="3634612">(</span><span class="ident" id="3634613">usage</span><span class="op" id="3634618">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634625">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3634638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634643">case</span>&nbsp;<span class="num" id="3634648">19</span><span class="op" id="3634650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3634656">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634681">var</span>&nbsp;<span class="ident" id="3634685">constraints</span>&nbsp;<span class="ident" id="3634697">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634718">_</span><span class="op" id="3634719">,</span>&nbsp;<span class="ident" id="3634721">err</span>&nbsp;<span class="op" id="3634725">:=</span>&nbsp;<span class="ident" id="3634728">asn1</span><span class="op" id="3634732">.</span><span class="ident" id="3634733">Unmarshal</span><span class="op" id="3634742">(</span><span class="ident" id="3634743">e</span><span class="op" id="3634744">.</span><span class="ident" id="3634745">Value</span><span class="op" id="3634750">,</span>&nbsp;<span class="op" id="3634752">&amp;</span><span class="ident" id="3634753">constraints</span><span class="op" id="3634764">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634771">if</span>&nbsp;<span class="ident" id="3634774">err</span>&nbsp;<span class="op" id="3634778">==</span>&nbsp;<span class="ident" id="3634781">nil</span>&nbsp;<span class="op" id="3634785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634792">out</span><span class="op" id="3634795">.</span><span class="ident" id="3634796">BasicConstraintsValid</span>&nbsp;<span class="op" id="3634818">=</span>&nbsp;<span class="builtintype" id="3634820">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634830">out</span><span class="op" id="3634833">.</span><span class="ident" id="3634834">IsCA</span>&nbsp;<span class="op" id="3634839">=</span>&nbsp;<span class="ident" id="3634841">constraints</span><span class="op" id="3634852">.</span><span class="ident" id="3634853">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634863">out</span><span class="op" id="3634866">.</span><span class="ident" id="3634867">MaxPathLen</span>&nbsp;<span class="op" id="3634878">=</span>&nbsp;<span class="ident" id="3634880">constraints</span><span class="op" id="3634891">.</span><span class="ident" id="3634892">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634908">out</span><span class="op" id="3634911">.</span><span class="ident" id="3634912">MaxPathLenZero</span>&nbsp;<span class="op" id="3634927">=</span>&nbsp;<span class="ident" id="3634929">out</span><span class="op" id="3634932">.</span><span class="ident" id="3634933">MaxPathLen</span>&nbsp;<span class="op" id="3634944">==</span>&nbsp;<span class="num" id="3634947">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634954">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3634967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3634972">case</span>&nbsp;<span class="num" id="3634977">17</span><span class="op" id="3634979">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3634985">out</span><span class="op" id="3634988">.</span><span class="ident" id="3634989">DNSNames</span><span class="op" id="3634997">,</span>&nbsp;<span class="ident" id="3634999">out</span><span class="op" id="3635002">.</span><span class="ident" id="3635003">EmailAddresses</span><span class="op" id="3635017">,</span>&nbsp;<span class="ident" id="3635019">out</span><span class="op" id="3635022">.</span><span class="ident" id="3635023">IPAddresses</span><span class="op" id="3635034">,</span>&nbsp;<span class="ident" id="3635036">err</span>&nbsp;<span class="op" id="3635040">=</span>&nbsp;<span class="ident" id="3635042">parseSANExtension</span><span class="op" id="3635059">(</span><span class="ident" id="3635060">e</span><span class="op" id="3635061">.</span><span class="ident" id="3635062">Value</span><span class="op" id="3635067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3635073">if</span>&nbsp;<span class="ident" id="3635076">err</span>&nbsp;<span class="op" id="3635080">!=</span>&nbsp;<span class="ident" id="3635083">nil</span>&nbsp;<span class="op" id="3635087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3635094">return</span>&nbsp;<span class="ident" id="3635101">nil</span><span class="op" id="3635104">,</span>&nbsp;<span class="ident" id="3635106">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3635114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3635121">if</span>&nbsp;<span class="builtinfunc" id="3635124">len</span><span class="op" id="3635127">(</span><span class="ident" id="3635128">out</span><span class="op" id="3635131">.</span><span class="ident" id="3635132">DNSNames</span><span class="op" id="3635140">)</span>&nbsp;<span class="op" id="3635142">&gt;</span>&nbsp;<span class="num" id="3635144">0</span>&nbsp;<span class="op" id="3635146">||</span>&nbsp;<span class="builtinfunc" id="3635149">len</span><span class="op" id="3635152">(</span><span class="ident" id="3635153">out</span><span class="op" id="3635156">.</span><span class="ident" id="3635157">EmailAddresses</span><span class="op" id="3635171">)</span>&nbsp;<span class="op" id="3635173">&gt;</span>&nbsp;<span class="num" id="3635175">0</span>&nbsp;<span class="op" id="3635177">||</span>&nbsp;<span class="builtinfunc" id="3635180">len</span><span class="op" id="3635183">(</span><span class="ident" id="3635184">out</span><span class="op" id="3635187">.</span><span class="ident" id="3635188">IPAddresses</span><span class="op" id="3635199">)</span>&nbsp;<span class="op" id="3635201">&gt;</span>&nbsp;<span class="num" id="3635203">0</span>&nbsp;<span class="op" id="3635205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3635212">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3635225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635231">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635282">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3635331">case</span>&nbsp;<span class="num" id="3635336">30</span><span class="op" id="3635338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635344">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635371">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635409">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635479">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635550">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635557">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635625">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635632">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635669">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635718">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635778">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635838">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3635845">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3635887">var</span>&nbsp;<span class="ident" id="3635891">constraints</span>&nbsp;<span class="ident" id="3635903">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3635923">_</span><span class="op" id="3635924">,</span>&nbsp;<span class="ident" id="3635926">err</span>&nbsp;<span class="op" id="3635930">:=</span>&nbsp;<span class="ident" id="3635933">asn1</span><span class="op" id="3635937">.</span><span class="ident" id="3635938">Unmarshal</span><span class="op" id="3635947">(</span><span class="ident" id="3635948">e</span><span class="op" id="3635949">.</span><span class="ident" id="3635950">Value</span><span class="op" id="3635955">,</span>&nbsp;<span class="op" id="3635957">&amp;</span><span class="ident" id="3635958">constraints</span><span class="op" id="3635969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3635975">if</span>&nbsp;<span class="ident" id="3635978">err</span>&nbsp;<span class="op" id="3635982">!=</span>&nbsp;<span class="ident" id="3635985">nil</span>&nbsp;<span class="op" id="3635989">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3635996">return</span>&nbsp;<span class="ident" id="3636003">nil</span><span class="op" id="3636006">,</span>&nbsp;<span class="ident" id="3636008">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3636016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636023">if</span>&nbsp;<span class="builtinfunc" id="3636026">len</span><span class="op" id="3636029">(</span><span class="ident" id="3636030">constraints</span><span class="op" id="3636041">.</span><span class="ident" id="3636042">Excluded</span><span class="op" id="3636050">)</span>&nbsp;<span class="op" id="3636052">&gt;</span>&nbsp;<span class="num" id="3636054">0</span>&nbsp;<span class="op" id="3636056">&amp;&amp;</span>&nbsp;<span class="ident" id="3636059">e</span><span class="op" id="3636060">.</span><span class="ident" id="3636061">Critical</span>&nbsp;<span class="op" id="3636070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636077">return</span>&nbsp;<span class="ident" id="3636084">out</span><span class="op" id="3636087">,</span>&nbsp;<span class="ident" id="3636089">UnhandledCriticalExtension</span><span class="op" id="3636115">{</span><span class="op" id="3636116">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3636122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636129">for</span>&nbsp;<span class="ident" id="3636133">_</span><span class="op" id="3636134">,</span>&nbsp;<span class="ident" id="3636136">subtree</span>&nbsp;<span class="op" id="3636144">:=</span>&nbsp;<span class="keyword" id="3636147">range</span>&nbsp;<span class="ident" id="3636153">constraints</span><span class="op" id="3636164">.</span><span class="ident" id="3636165">Permitted</span>&nbsp;<span class="op" id="3636175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636182">if</span>&nbsp;<span class="builtinfunc" id="3636185">len</span><span class="op" id="3636188">(</span><span class="ident" id="3636189">subtree</span><span class="op" id="3636196">.</span><span class="ident" id="3636197">Name</span><span class="op" id="3636201">)</span>&nbsp;<span class="op" id="3636203">==</span>&nbsp;<span class="num" id="3636206">0</span>&nbsp;<span class="op" id="3636208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636216">if</span>&nbsp;<span class="ident" id="3636219">e</span><span class="op" id="3636220">.</span><span class="ident" id="3636221">Critical</span>&nbsp;<span class="op" id="3636230">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636239">return</span>&nbsp;<span class="ident" id="3636246">out</span><span class="op" id="3636249">,</span>&nbsp;<span class="ident" id="3636251">UnhandledCriticalExtension</span><span class="op" id="3636277">{</span><span class="op" id="3636278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3636286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636294">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3636308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3636315">out</span><span class="op" id="3636318">.</span><span class="ident" id="3636319">PermittedDNSDomains</span>&nbsp;<span class="op" id="3636339">=</span>&nbsp;<span class="builtinfunc" id="3636341">append</span><span class="op" id="3636347">(</span><span class="ident" id="3636348">out</span><span class="op" id="3636351">.</span><span class="ident" id="3636352">PermittedDNSDomains</span><span class="op" id="3636371">,</span>&nbsp;<span class="ident" id="3636373">subtree</span><span class="op" id="3636380">.</span><span class="ident" id="3636381">Name</span><span class="op" id="3636385">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3636391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636397">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636410">case</span>&nbsp;<span class="num" id="3636415">31</span><span class="op" id="3636417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636423">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636450">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636527">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636534">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636574">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636649">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636714">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636781">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636788">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636830">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3636887">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3636959">var</span>&nbsp;<span class="ident" id="3636963">cdp</span>&nbsp;<span class="op" id="3636967">[</span><span class="op" id="3636968">]</span><span class="ident" id="3636969">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3636991">_</span><span class="op" id="3636992">,</span>&nbsp;<span class="ident" id="3636994">err</span>&nbsp;<span class="op" id="3636998">:=</span>&nbsp;<span class="ident" id="3637001">asn1</span><span class="op" id="3637005">.</span><span class="ident" id="3637006">Unmarshal</span><span class="op" id="3637015">(</span><span class="ident" id="3637016">e</span><span class="op" id="3637017">.</span><span class="ident" id="3637018">Value</span><span class="op" id="3637023">,</span>&nbsp;<span class="op" id="3637025">&amp;</span><span class="ident" id="3637026">cdp</span><span class="op" id="3637029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637035">if</span>&nbsp;<span class="ident" id="3637038">err</span>&nbsp;<span class="op" id="3637042">!=</span>&nbsp;<span class="ident" id="3637045">nil</span>&nbsp;<span class="op" id="3637049">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637056">return</span>&nbsp;<span class="ident" id="3637063">nil</span><span class="op" id="3637066">,</span>&nbsp;<span class="ident" id="3637068">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637083">for</span>&nbsp;<span class="ident" id="3637087">_</span><span class="op" id="3637088">,</span>&nbsp;<span class="ident" id="3637090">dp</span>&nbsp;<span class="op" id="3637093">:=</span>&nbsp;<span class="keyword" id="3637096">range</span>&nbsp;<span class="ident" id="3637102">cdp</span>&nbsp;<span class="op" id="3637106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637113">var</span>&nbsp;<span class="ident" id="3637117">n</span>&nbsp;<span class="ident" id="3637119">asn1</span><span class="op" id="3637123">.</span><span class="ident" id="3637124">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637138">_</span><span class="op" id="3637139">,</span>&nbsp;<span class="ident" id="3637141">err</span>&nbsp;<span class="op" id="3637145">=</span>&nbsp;<span class="ident" id="3637147">asn1</span><span class="op" id="3637151">.</span><span class="ident" id="3637152">Unmarshal</span><span class="op" id="3637161">(</span><span class="ident" id="3637162">dp</span><span class="op" id="3637164">.</span><span class="ident" id="3637165">DistributionPoint</span><span class="op" id="3637182">.</span><span class="ident" id="3637183">FullName</span><span class="op" id="3637191">.</span><span class="ident" id="3637192">Bytes</span><span class="op" id="3637197">,</span>&nbsp;<span class="op" id="3637199">&amp;</span><span class="ident" id="3637200">n</span><span class="op" id="3637201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637208">if</span>&nbsp;<span class="ident" id="3637211">err</span>&nbsp;<span class="op" id="3637215">!=</span>&nbsp;<span class="ident" id="3637218">nil</span>&nbsp;<span class="op" id="3637222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637230">return</span>&nbsp;<span class="ident" id="3637237">nil</span><span class="op" id="3637240">,</span>&nbsp;<span class="ident" id="3637242">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637259">if</span>&nbsp;<span class="ident" id="3637262">n</span><span class="op" id="3637263">.</span><span class="ident" id="3637264">Tag</span>&nbsp;<span class="op" id="3637268">==</span>&nbsp;<span class="num" id="3637271">6</span>&nbsp;<span class="op" id="3637273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637281">out</span><span class="op" id="3637284">.</span><span class="ident" id="3637285">CRLDistributionPoints</span>&nbsp;<span class="op" id="3637307">=</span>&nbsp;<span class="builtinfunc" id="3637309">append</span><span class="op" id="3637315">(</span><span class="ident" id="3637316">out</span><span class="op" id="3637319">.</span><span class="ident" id="3637320">CRLDistributionPoints</span><span class="op" id="3637341">,</span>&nbsp;<span class="builtintype" id="3637343">string</span><span class="op" id="3637349">(</span><span class="ident" id="3637350">n</span><span class="op" id="3637351">.</span><span class="ident" id="3637352">Bytes</span><span class="op" id="3637357">)</span><span class="op" id="3637358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637377">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637390">case</span>&nbsp;<span class="num" id="3637395">35</span><span class="op" id="3637397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637403">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637428">var</span>&nbsp;<span class="ident" id="3637432">a</span>&nbsp;<span class="ident" id="3637434">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637448">_</span><span class="op" id="3637449">,</span>&nbsp;<span class="ident" id="3637451">err</span>&nbsp;<span class="op" id="3637455">=</span>&nbsp;<span class="ident" id="3637457">asn1</span><span class="op" id="3637461">.</span><span class="ident" id="3637462">Unmarshal</span><span class="op" id="3637471">(</span><span class="ident" id="3637472">e</span><span class="op" id="3637473">.</span><span class="ident" id="3637474">Value</span><span class="op" id="3637479">,</span>&nbsp;<span class="op" id="3637481">&amp;</span><span class="ident" id="3637482">a</span><span class="op" id="3637483">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637489">if</span>&nbsp;<span class="ident" id="3637492">err</span>&nbsp;<span class="op" id="3637496">!=</span>&nbsp;<span class="ident" id="3637499">nil</span>&nbsp;<span class="op" id="3637503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637510">return</span>&nbsp;<span class="ident" id="3637517">nil</span><span class="op" id="3637520">,</span>&nbsp;<span class="ident" id="3637522">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637536">out</span><span class="op" id="3637539">.</span><span class="ident" id="3637540">AuthorityKeyId</span>&nbsp;<span class="op" id="3637555">=</span>&nbsp;<span class="ident" id="3637557">a</span><span class="op" id="3637558">.</span><span class="ident" id="3637559">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637566">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637579">case</span>&nbsp;<span class="num" id="3637584">37</span><span class="op" id="3637586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637592">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637640">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637700">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637707">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637775">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3637782">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637825">var</span>&nbsp;<span class="ident" id="3637829">keyUsage</span>&nbsp;<span class="op" id="3637838">[</span><span class="op" id="3637839">]</span><span class="ident" id="3637840">asn1</span><span class="op" id="3637844">.</span><span class="ident" id="3637845">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3637866">_</span><span class="op" id="3637867">,</span>&nbsp;<span class="ident" id="3637869">err</span>&nbsp;<span class="op" id="3637873">=</span>&nbsp;<span class="ident" id="3637875">asn1</span><span class="op" id="3637879">.</span><span class="ident" id="3637880">Unmarshal</span><span class="op" id="3637889">(</span><span class="ident" id="3637890">e</span><span class="op" id="3637891">.</span><span class="ident" id="3637892">Value</span><span class="op" id="3637897">,</span>&nbsp;<span class="op" id="3637899">&amp;</span><span class="ident" id="3637900">keyUsage</span><span class="op" id="3637908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637914">if</span>&nbsp;<span class="ident" id="3637917">err</span>&nbsp;<span class="op" id="3637921">!=</span>&nbsp;<span class="ident" id="3637924">nil</span>&nbsp;<span class="op" id="3637928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637935">return</span>&nbsp;<span class="ident" id="3637942">nil</span><span class="op" id="3637945">,</span>&nbsp;<span class="ident" id="3637947">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3637955">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637962">for</span>&nbsp;<span class="ident" id="3637966">_</span><span class="op" id="3637967">,</span>&nbsp;<span class="ident" id="3637969">u</span>&nbsp;<span class="op" id="3637971">:=</span>&nbsp;<span class="keyword" id="3637974">range</span>&nbsp;<span class="ident" id="3637980">keyUsage</span>&nbsp;<span class="op" id="3637989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3637996">if</span>&nbsp;<span class="ident" id="3637999">extKeyUsage</span><span class="op" id="3638010">,</span>&nbsp;<span class="ident" id="3638012">ok</span>&nbsp;<span class="op" id="3638015">:=</span>&nbsp;<span class="ident" id="3638018">extKeyUsageFromOID</span><span class="op" id="3638036">(</span><span class="ident" id="3638037">u</span><span class="op" id="3638038">)</span><span class="op" id="3638039">;</span>&nbsp;<span class="ident" id="3638041">ok</span>&nbsp;<span class="op" id="3638044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638052">out</span><span class="op" id="3638055">.</span><span class="ident" id="3638056">ExtKeyUsage</span>&nbsp;<span class="op" id="3638068">=</span>&nbsp;<span class="builtinfunc" id="3638070">append</span><span class="op" id="3638076">(</span><span class="ident" id="3638077">out</span><span class="op" id="3638080">.</span><span class="ident" id="3638081">ExtKeyUsage</span><span class="op" id="3638092">,</span>&nbsp;<span class="ident" id="3638094">extKeyUsage</span><span class="op" id="3638105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638112">}</span>&nbsp;<span class="keyword" id="3638114">else</span>&nbsp;<span class="op" id="3638119">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638127">out</span><span class="op" id="3638130">.</span><span class="ident" id="3638131">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="3638150">=</span>&nbsp;<span class="builtinfunc" id="3638152">append</span><span class="op" id="3638158">(</span><span class="ident" id="3638159">out</span><span class="op" id="3638162">.</span><span class="ident" id="3638163">UnknownExtKeyUsage</span><span class="op" id="3638181">,</span>&nbsp;<span class="ident" id="3638183">u</span><span class="op" id="3638184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638204">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638217">case</span>&nbsp;<span class="num" id="3638222">14</span><span class="op" id="3638224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3638230">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638255">var</span>&nbsp;<span class="ident" id="3638259">keyid</span>&nbsp;<span class="op" id="3638265">[</span><span class="op" id="3638266">]</span><span class="builtintype" id="3638267">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638276">_</span><span class="op" id="3638277">,</span>&nbsp;<span class="ident" id="3638279">err</span>&nbsp;<span class="op" id="3638283">=</span>&nbsp;<span class="ident" id="3638285">asn1</span><span class="op" id="3638289">.</span><span class="ident" id="3638290">Unmarshal</span><span class="op" id="3638299">(</span><span class="ident" id="3638300">e</span><span class="op" id="3638301">.</span><span class="ident" id="3638302">Value</span><span class="op" id="3638307">,</span>&nbsp;<span class="op" id="3638309">&amp;</span><span class="ident" id="3638310">keyid</span><span class="op" id="3638315">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638321">if</span>&nbsp;<span class="ident" id="3638324">err</span>&nbsp;<span class="op" id="3638328">!=</span>&nbsp;<span class="ident" id="3638331">nil</span>&nbsp;<span class="op" id="3638335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638342">return</span>&nbsp;<span class="ident" id="3638349">nil</span><span class="op" id="3638352">,</span>&nbsp;<span class="ident" id="3638354">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638368">out</span><span class="op" id="3638371">.</span><span class="ident" id="3638372">SubjectKeyId</span>&nbsp;<span class="op" id="3638385">=</span>&nbsp;<span class="ident" id="3638387">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638397">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638410">case</span>&nbsp;<span class="num" id="3638415">32</span><span class="op" id="3638417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3638423">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638469">var</span>&nbsp;<span class="ident" id="3638473">policies</span>&nbsp;<span class="op" id="3638482">[</span><span class="op" id="3638483">]</span><span class="ident" id="3638484">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638506">if</span>&nbsp;<span class="ident" id="3638509">_</span><span class="op" id="3638510">,</span>&nbsp;<span class="ident" id="3638512">err</span>&nbsp;<span class="op" id="3638516">=</span>&nbsp;<span class="ident" id="3638518">asn1</span><span class="op" id="3638522">.</span><span class="ident" id="3638523">Unmarshal</span><span class="op" id="3638532">(</span><span class="ident" id="3638533">e</span><span class="op" id="3638534">.</span><span class="ident" id="3638535">Value</span><span class="op" id="3638540">,</span>&nbsp;<span class="op" id="3638542">&amp;</span><span class="ident" id="3638543">policies</span><span class="op" id="3638551">)</span><span class="op" id="3638552">;</span>&nbsp;<span class="ident" id="3638554">err</span>&nbsp;<span class="op" id="3638558">!=</span>&nbsp;<span class="ident" id="3638561">nil</span>&nbsp;<span class="op" id="3638565">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638572">return</span>&nbsp;<span class="ident" id="3638579">nil</span><span class="op" id="3638582">,</span>&nbsp;<span class="ident" id="3638584">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638598">out</span><span class="op" id="3638601">.</span><span class="ident" id="3638602">PolicyIdentifiers</span>&nbsp;<span class="op" id="3638620">=</span>&nbsp;<span class="builtinfunc" id="3638622">make</span><span class="op" id="3638626">(</span><span class="op" id="3638627">[</span><span class="op" id="3638628">]</span><span class="ident" id="3638629">asn1</span><span class="op" id="3638633">.</span><span class="ident" id="3638634">ObjectIdentifier</span><span class="op" id="3638650">,</span>&nbsp;<span class="builtinfunc" id="3638652">len</span><span class="op" id="3638655">(</span><span class="ident" id="3638656">policies</span><span class="op" id="3638664">)</span><span class="op" id="3638665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638671">for</span>&nbsp;<span class="ident" id="3638675">i</span><span class="op" id="3638676">,</span>&nbsp;<span class="ident" id="3638678">policy</span>&nbsp;<span class="op" id="3638685">:=</span>&nbsp;<span class="keyword" id="3638688">range</span>&nbsp;<span class="ident" id="3638694">policies</span>&nbsp;<span class="op" id="3638703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638710">out</span><span class="op" id="3638713">.</span><span class="ident" id="3638714">PolicyIdentifiers</span><span class="op" id="3638731">[</span><span class="ident" id="3638732">i</span><span class="op" id="3638733">]</span>&nbsp;<span class="op" id="3638735">=</span>&nbsp;<span class="ident" id="3638737">policy</span><span class="op" id="3638743">.</span><span class="ident" id="3638744">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638764">}</span>&nbsp;<span class="keyword" id="3638766">else</span>&nbsp;<span class="keyword" id="3638771">if</span>&nbsp;<span class="ident" id="3638774">e</span><span class="op" id="3638775">.</span><span class="ident" id="3638776">Id</span><span class="op" id="3638778">.</span><span class="ident" id="3638779">Equal</span><span class="op" id="3638784">(</span><span class="ident" id="3638785">oidExtensionAuthorityInfoAccess</span><span class="op" id="3638816">)</span>&nbsp;<span class="op" id="3638818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3638823">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638876">var</span>&nbsp;<span class="ident" id="3638880">aia</span>&nbsp;<span class="op" id="3638884">[</span><span class="op" id="3638885">]</span><span class="ident" id="3638886">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638909">if</span>&nbsp;<span class="ident" id="3638912">_</span><span class="op" id="3638913">,</span>&nbsp;<span class="ident" id="3638915">err</span>&nbsp;<span class="op" id="3638919">=</span>&nbsp;<span class="ident" id="3638921">asn1</span><span class="op" id="3638925">.</span><span class="ident" id="3638926">Unmarshal</span><span class="op" id="3638935">(</span><span class="ident" id="3638936">e</span><span class="op" id="3638937">.</span><span class="ident" id="3638938">Value</span><span class="op" id="3638943">,</span>&nbsp;<span class="op" id="3638945">&amp;</span><span class="ident" id="3638946">aia</span><span class="op" id="3638949">)</span><span class="op" id="3638950">;</span>&nbsp;<span class="ident" id="3638952">err</span>&nbsp;<span class="op" id="3638956">!=</span>&nbsp;<span class="ident" id="3638959">nil</span>&nbsp;<span class="op" id="3638963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638969">return</span>&nbsp;<span class="ident" id="3638976">nil</span><span class="op" id="3638979">,</span>&nbsp;<span class="ident" id="3638981">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638994">for</span>&nbsp;<span class="ident" id="3638998">_</span><span class="op" id="3638999">,</span>&nbsp;<span class="ident" id="3639001">v</span>&nbsp;<span class="op" id="3639003">:=</span>&nbsp;<span class="keyword" id="3639006">range</span>&nbsp;<span class="ident" id="3639012">aia</span>&nbsp;<span class="op" id="3639016">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3639022">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639082">if</span>&nbsp;<span class="ident" id="3639085">v</span><span class="op" id="3639086">.</span><span class="ident" id="3639087">Location</span><span class="op" id="3639095">.</span><span class="ident" id="3639096">Tag</span>&nbsp;<span class="op" id="3639100">!=</span>&nbsp;<span class="num" id="3639103">6</span>&nbsp;<span class="op" id="3639105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639112">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639131">if</span>&nbsp;<span class="ident" id="3639134">v</span><span class="op" id="3639135">.</span><span class="ident" id="3639136">Method</span><span class="op" id="3639142">.</span><span class="ident" id="3639143">Equal</span><span class="op" id="3639148">(</span><span class="ident" id="3639149">oidAuthorityInfoAccessOcsp</span><span class="op" id="3639175">)</span>&nbsp;<span class="op" id="3639177">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639184">out</span><span class="op" id="3639187">.</span><span class="ident" id="3639188">OCSPServer</span>&nbsp;<span class="op" id="3639199">=</span>&nbsp;<span class="builtinfunc" id="3639201">append</span><span class="op" id="3639207">(</span><span class="ident" id="3639208">out</span><span class="op" id="3639211">.</span><span class="ident" id="3639212">OCSPServer</span><span class="op" id="3639222">,</span>&nbsp;<span class="builtintype" id="3639224">string</span><span class="op" id="3639230">(</span><span class="ident" id="3639231">v</span><span class="op" id="3639232">.</span><span class="ident" id="3639233">Location</span><span class="op" id="3639241">.</span><span class="ident" id="3639242">Bytes</span><span class="op" id="3639247">)</span><span class="op" id="3639248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639254">}</span>&nbsp;<span class="keyword" id="3639256">else</span>&nbsp;<span class="keyword" id="3639261">if</span>&nbsp;<span class="ident" id="3639264">v</span><span class="op" id="3639265">.</span><span class="ident" id="3639266">Method</span><span class="op" id="3639272">.</span><span class="ident" id="3639273">Equal</span><span class="op" id="3639278">(</span><span class="ident" id="3639279">oidAuthorityInfoAccessIssuers</span><span class="op" id="3639308">)</span>&nbsp;<span class="op" id="3639310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639317">out</span><span class="op" id="3639320">.</span><span class="ident" id="3639321">IssuingCertificateURL</span>&nbsp;<span class="op" id="3639343">=</span>&nbsp;<span class="builtinfunc" id="3639345">append</span><span class="op" id="3639351">(</span><span class="ident" id="3639352">out</span><span class="op" id="3639355">.</span><span class="ident" id="3639356">IssuingCertificateURL</span><span class="op" id="3639377">,</span>&nbsp;<span class="builtintype" id="3639379">string</span><span class="op" id="3639385">(</span><span class="ident" id="3639386">v</span><span class="op" id="3639387">.</span><span class="ident" id="3639388">Location</span><span class="op" id="3639396">.</span><span class="ident" id="3639397">Bytes</span><span class="op" id="3639402">)</span><span class="op" id="3639403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639414">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639423">if</span>&nbsp;<span class="ident" id="3639426">e</span><span class="op" id="3639427">.</span><span class="ident" id="3639428">Critical</span>&nbsp;<span class="op" id="3639437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639442">return</span>&nbsp;<span class="ident" id="3639449">out</span><span class="op" id="3639452">,</span>&nbsp;<span class="ident" id="3639454">UnhandledCriticalExtension</span><span class="op" id="3639480">{</span><span class="op" id="3639481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639485">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639492">return</span>&nbsp;<span class="ident" id="3639499">out</span><span class="op" id="3639502">,</span>&nbsp;<span class="ident" id="3639504">nil</span><br>
<span class="lineno"></span><span class="op" id="3639508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="3639511">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3639590">func</span>&nbsp;<span class="ident" id="3639595">ParseCertificate</span><span class="op" id="3639611">(</span><span class="ident" id="3639612">asn1Data</span>&nbsp;<span class="op" id="3639621">[</span><span class="op" id="3639622">]</span><span class="builtintype" id="3639623">byte</span><span class="op" id="3639627">)</span>&nbsp;<span class="op" id="3639629">(</span><span class="op" id="3639630">*</span><span class="ident" id="3639631">Certificate</span><span class="op" id="3639642">,</span>&nbsp;<span class="builtintype" id="3639644">error</span><span class="op" id="3639649">)</span>&nbsp;<span class="op" id="3639651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639654">var</span>&nbsp;<span class="ident" id="3639658">cert</span>&nbsp;<span class="ident" id="3639663">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639676">rest</span><span class="op" id="3639680">,</span>&nbsp;<span class="ident" id="3639682">err</span>&nbsp;<span class="op" id="3639686">:=</span>&nbsp;<span class="ident" id="3639689">asn1</span><span class="op" id="3639693">.</span><span class="ident" id="3639694">Unmarshal</span><span class="op" id="3639703">(</span><span class="ident" id="3639704">asn1Data</span><span class="op" id="3639712">,</span>&nbsp;<span class="op" id="3639714">&amp;</span><span class="ident" id="3639715">cert</span><span class="op" id="3639719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639722">if</span>&nbsp;<span class="ident" id="3639725">err</span>&nbsp;<span class="op" id="3639729">!=</span>&nbsp;<span class="ident" id="3639732">nil</span>&nbsp;<span class="op" id="3639736">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639740">return</span>&nbsp;<span class="ident" id="3639747">nil</span><span class="op" id="3639750">,</span>&nbsp;<span class="ident" id="3639752">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639760">if</span>&nbsp;<span class="builtinfunc" id="3639763">len</span><span class="op" id="3639766">(</span><span class="ident" id="3639767">rest</span><span class="op" id="3639771">)</span>&nbsp;<span class="op" id="3639773">&gt;</span>&nbsp;<span class="num" id="3639775">0</span>&nbsp;<span class="op" id="3639777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639781">return</span>&nbsp;<span class="ident" id="3639788">nil</span><span class="op" id="3639791">,</span>&nbsp;<span class="ident" id="3639793">asn1</span><span class="op" id="3639797">.</span><span class="ident" id="3639798">SyntaxError</span><span class="op" id="3639809">{</span><span class="ident" id="3639810">Msg</span><span class="op" id="3639813">:</span>&nbsp;<span class="string" id="3639815">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3639830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639833">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639837">return</span>&nbsp;<span class="ident" id="3639844">parseCertificate</span><span class="op" id="3639860">(</span><span class="op" id="3639861">&amp;</span><span class="ident" id="3639862">cert</span><span class="op" id="3639866">)</span><br>
<span class="lineno"></span><span class="op" id="3639868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3639871">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="3639949">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="3640026">func</span>&nbsp;<span class="ident" id="3640031">ParseCertificates</span><span class="op" id="3640048">(</span><span class="ident" id="3640049">asn1Data</span>&nbsp;<span class="op" id="3640058">[</span><span class="op" id="3640059">]</span><span class="builtintype" id="3640060">byte</span><span class="op" id="3640064">)</span>&nbsp;<span class="op" id="3640066">(</span><span class="op" id="3640067">[</span><span class="op" id="3640068">]</span><span class="op" id="3640069">*</span><span class="ident" id="3640070">Certificate</span><span class="op" id="3640081">,</span>&nbsp;<span class="builtintype" id="3640083">error</span><span class="op" id="3640088">)</span>&nbsp;<span class="op" id="3640090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640093">var</span>&nbsp;<span class="ident" id="3640097">v</span>&nbsp;<span class="op" id="3640099">[</span><span class="op" id="3640100">]</span><span class="op" id="3640101">*</span><span class="ident" id="3640102">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640116">for</span>&nbsp;<span class="builtinfunc" id="3640120">len</span><span class="op" id="3640123">(</span><span class="ident" id="3640124">asn1Data</span><span class="op" id="3640132">)</span>&nbsp;<span class="op" id="3640134">&gt;</span>&nbsp;<span class="num" id="3640136">0</span>&nbsp;<span class="op" id="3640138">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640142">cert</span>&nbsp;<span class="op" id="3640147">:=</span>&nbsp;<span class="builtinfunc" id="3640150">new</span><span class="op" id="3640153">(</span><span class="ident" id="3640154">certificate</span><span class="op" id="3640165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640169">var</span>&nbsp;<span class="ident" id="3640173">err</span>&nbsp;<span class="builtintype" id="3640177">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640185">asn1Data</span><span class="op" id="3640193">,</span>&nbsp;<span class="ident" id="3640195">err</span>&nbsp;<span class="op" id="3640199">=</span>&nbsp;<span class="ident" id="3640201">asn1</span><span class="op" id="3640205">.</span><span class="ident" id="3640206">Unmarshal</span><span class="op" id="3640215">(</span><span class="ident" id="3640216">asn1Data</span><span class="op" id="3640224">,</span>&nbsp;<span class="ident" id="3640226">cert</span><span class="op" id="3640230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640234">if</span>&nbsp;<span class="ident" id="3640237">err</span>&nbsp;<span class="op" id="3640241">!=</span>&nbsp;<span class="ident" id="3640244">nil</span>&nbsp;<span class="op" id="3640248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640253">return</span>&nbsp;<span class="ident" id="3640260">nil</span><span class="op" id="3640263">,</span>&nbsp;<span class="ident" id="3640265">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640275">v</span>&nbsp;<span class="op" id="3640277">=</span>&nbsp;<span class="builtinfunc" id="3640279">append</span><span class="op" id="3640285">(</span><span class="ident" id="3640286">v</span><span class="op" id="3640287">,</span>&nbsp;<span class="ident" id="3640289">cert</span><span class="op" id="3640293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640300">ret</span>&nbsp;<span class="op" id="3640304">:=</span>&nbsp;<span class="builtinfunc" id="3640307">make</span><span class="op" id="3640311">(</span><span class="op" id="3640312">[</span><span class="op" id="3640313">]</span><span class="op" id="3640314">*</span><span class="ident" id="3640315">Certificate</span><span class="op" id="3640326">,</span>&nbsp;<span class="builtinfunc" id="3640328">len</span><span class="op" id="3640331">(</span><span class="ident" id="3640332">v</span><span class="op" id="3640333">)</span><span class="op" id="3640334">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640337">for</span>&nbsp;<span class="ident" id="3640341">i</span><span class="op" id="3640342">,</span>&nbsp;<span class="ident" id="3640344">ci</span>&nbsp;<span class="op" id="3640347">:=</span>&nbsp;<span class="keyword" id="3640350">range</span>&nbsp;<span class="ident" id="3640356">v</span>&nbsp;<span class="op" id="3640358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640362">cert</span><span class="op" id="3640366">,</span>&nbsp;<span class="ident" id="3640368">err</span>&nbsp;<span class="op" id="3640372">:=</span>&nbsp;<span class="ident" id="3640375">parseCertificate</span><span class="op" id="3640391">(</span><span class="ident" id="3640392">ci</span><span class="op" id="3640394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640398">if</span>&nbsp;<span class="ident" id="3640401">err</span>&nbsp;<span class="op" id="3640405">!=</span>&nbsp;<span class="ident" id="3640408">nil</span>&nbsp;<span class="op" id="3640412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640417">return</span>&nbsp;<span class="ident" id="3640424">nil</span><span class="op" id="3640427">,</span>&nbsp;<span class="ident" id="3640429">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640435">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640439">ret</span><span class="op" id="3640442">[</span><span class="ident" id="3640443">i</span><span class="op" id="3640444">]</span>&nbsp;<span class="op" id="3640446">=</span>&nbsp;<span class="ident" id="3640448">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640458">return</span>&nbsp;<span class="ident" id="3640465">ret</span><span class="op" id="3640468">,</span>&nbsp;<span class="ident" id="3640470">nil</span><br>
<span class="lineno"></span><span class="op" id="3640474">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="3640477">func</span>&nbsp;<span class="ident" id="3640482">reverseBitsInAByte</span><span class="op" id="3640500">(</span><span class="ident" id="3640501">in</span>&nbsp;<span class="builtintype" id="3640504">byte</span><span class="op" id="3640508">)</span>&nbsp;<span class="builtintype" id="3640510">byte</span>&nbsp;<span class="op" id="3640515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640518">b1</span>&nbsp;<span class="op" id="3640521">:=</span>&nbsp;<span class="ident" id="3640524">in</span><span class="op" id="3640526">&gt;&gt;</span><span class="num" id="3640528">4</span>&nbsp;<span class="op" id="3640530">|</span>&nbsp;<span class="ident" id="3640532">in</span><span class="op" id="3640534">&lt;&lt;</span><span class="num" id="3640536">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640539">b2</span>&nbsp;<span class="op" id="3640542">:=</span>&nbsp;<span class="ident" id="3640545">b1</span><span class="op" id="3640547">&gt;&gt;</span><span class="num" id="3640549">2</span><span class="op" id="3640550">&amp;</span><span class="num" id="3640551">0x33</span>&nbsp;<span class="op" id="3640556">|</span>&nbsp;<span class="ident" id="3640558">b1</span><span class="op" id="3640560">&lt;&lt;</span><span class="num" id="3640562">2</span><span class="op" id="3640563">&amp;</span><span class="num" id="3640564">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640570">b3</span>&nbsp;<span class="op" id="3640573">:=</span>&nbsp;<span class="ident" id="3640576">b2</span><span class="op" id="3640578">&gt;&gt;</span><span class="num" id="3640580">1</span><span class="op" id="3640581">&amp;</span><span class="num" id="3640582">0x55</span>&nbsp;<span class="op" id="3640587">|</span>&nbsp;<span class="ident" id="3640589">b2</span><span class="op" id="3640591">&lt;&lt;</span><span class="num" id="3640593">1</span><span class="op" id="3640594">&amp;</span><span class="num" id="3640595">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640601">return</span>&nbsp;<span class="ident" id="3640608">b3</span><br>
<span class="lineno"></span><span class="op" id="3640611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3640614">var</span>&nbsp;<span class="op" id="3640618">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640621">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640655">=</span>&nbsp;<span class="op" id="3640657">[</span><span class="op" id="3640658">]</span><span class="builtintype" id="3640659">int</span><span class="op" id="3640662">{</span><span class="num" id="3640663">2</span><span class="op" id="3640664">,</span>&nbsp;<span class="num" id="3640666">5</span><span class="op" id="3640667">,</span>&nbsp;<span class="num" id="3640669">29</span><span class="op" id="3640671">,</span>&nbsp;<span class="num" id="3640673">14</span><span class="op" id="3640675">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640678">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640712">=</span>&nbsp;<span class="op" id="3640714">[</span><span class="op" id="3640715">]</span><span class="builtintype" id="3640716">int</span><span class="op" id="3640719">{</span><span class="num" id="3640720">2</span><span class="op" id="3640721">,</span>&nbsp;<span class="num" id="3640723">5</span><span class="op" id="3640724">,</span>&nbsp;<span class="num" id="3640726">29</span><span class="op" id="3640728">,</span>&nbsp;<span class="num" id="3640730">15</span><span class="op" id="3640732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640735">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640769">=</span>&nbsp;<span class="op" id="3640771">[</span><span class="op" id="3640772">]</span><span class="builtintype" id="3640773">int</span><span class="op" id="3640776">{</span><span class="num" id="3640777">2</span><span class="op" id="3640778">,</span>&nbsp;<span class="num" id="3640780">5</span><span class="op" id="3640781">,</span>&nbsp;<span class="num" id="3640783">29</span><span class="op" id="3640785">,</span>&nbsp;<span class="num" id="3640787">37</span><span class="op" id="3640789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640792">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640826">=</span>&nbsp;<span class="op" id="3640828">[</span><span class="op" id="3640829">]</span><span class="builtintype" id="3640830">int</span><span class="op" id="3640833">{</span><span class="num" id="3640834">2</span><span class="op" id="3640835">,</span>&nbsp;<span class="num" id="3640837">5</span><span class="op" id="3640838">,</span>&nbsp;<span class="num" id="3640840">29</span><span class="op" id="3640842">,</span>&nbsp;<span class="num" id="3640844">35</span><span class="op" id="3640846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640849">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640883">=</span>&nbsp;<span class="op" id="3640885">[</span><span class="op" id="3640886">]</span><span class="builtintype" id="3640887">int</span><span class="op" id="3640890">{</span><span class="num" id="3640891">2</span><span class="op" id="3640892">,</span>&nbsp;<span class="num" id="3640894">5</span><span class="op" id="3640895">,</span>&nbsp;<span class="num" id="3640897">29</span><span class="op" id="3640899">,</span>&nbsp;<span class="num" id="3640901">19</span><span class="op" id="3640903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640906">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640940">=</span>&nbsp;<span class="op" id="3640942">[</span><span class="op" id="3640943">]</span><span class="builtintype" id="3640944">int</span><span class="op" id="3640947">{</span><span class="num" id="3640948">2</span><span class="op" id="3640949">,</span>&nbsp;<span class="num" id="3640951">5</span><span class="op" id="3640952">,</span>&nbsp;<span class="num" id="3640954">29</span><span class="op" id="3640956">,</span>&nbsp;<span class="num" id="3640958">17</span><span class="op" id="3640960">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640963">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3640997">=</span>&nbsp;<span class="op" id="3640999">[</span><span class="op" id="3641000">]</span><span class="builtintype" id="3641001">int</span><span class="op" id="3641004">{</span><span class="num" id="3641005">2</span><span class="op" id="3641006">,</span>&nbsp;<span class="num" id="3641008">5</span><span class="op" id="3641009">,</span>&nbsp;<span class="num" id="3641011">29</span><span class="op" id="3641013">,</span>&nbsp;<span class="num" id="3641015">32</span><span class="op" id="3641017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641020">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641054">=</span>&nbsp;<span class="op" id="3641056">[</span><span class="op" id="3641057">]</span><span class="builtintype" id="3641058">int</span><span class="op" id="3641061">{</span><span class="num" id="3641062">2</span><span class="op" id="3641063">,</span>&nbsp;<span class="num" id="3641065">5</span><span class="op" id="3641066">,</span>&nbsp;<span class="num" id="3641068">29</span><span class="op" id="3641070">,</span>&nbsp;<span class="num" id="3641072">30</span><span class="op" id="3641074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641077">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="3641111">=</span>&nbsp;<span class="op" id="3641113">[</span><span class="op" id="3641114">]</span><span class="builtintype" id="3641115">int</span><span class="op" id="3641118">{</span><span class="num" id="3641119">2</span><span class="op" id="3641120">,</span>&nbsp;<span class="num" id="3641122">5</span><span class="op" id="3641123">,</span>&nbsp;<span class="num" id="3641125">29</span><span class="op" id="3641127">,</span>&nbsp;<span class="num" id="3641129">31</span><span class="op" id="3641131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641134">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3641168">=</span>&nbsp;<span class="op" id="3641170">[</span><span class="op" id="3641171">]</span><span class="builtintype" id="3641172">int</span><span class="op" id="3641175">{</span><span class="num" id="3641176">1</span><span class="op" id="3641177">,</span>&nbsp;<span class="num" id="3641179">3</span><span class="op" id="3641180">,</span>&nbsp;<span class="num" id="3641182">6</span><span class="op" id="3641183">,</span>&nbsp;<span class="num" id="3641185">1</span><span class="op" id="3641186">,</span>&nbsp;<span class="num" id="3641188">5</span><span class="op" id="3641189">,</span>&nbsp;<span class="num" id="3641191">5</span><span class="op" id="3641192">,</span>&nbsp;<span class="num" id="3641194">7</span><span class="op" id="3641195">,</span>&nbsp;<span class="num" id="3641197">1</span><span class="op" id="3641198">,</span>&nbsp;<span class="num" id="3641200">1</span><span class="op" id="3641201">}</span><br>
<span class="lineno"></span><span class="op" id="3641203">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="3641206">var</span>&nbsp;<span class="op" id="3641210">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641213">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641243">=</span>&nbsp;<span class="ident" id="3641245">asn1</span><span class="op" id="3641249">.</span><span class="ident" id="3641250">ObjectIdentifier</span><span class="op" id="3641266">{</span><span class="num" id="3641267">1</span><span class="op" id="3641268">,</span>&nbsp;<span class="num" id="3641270">3</span><span class="op" id="3641271">,</span>&nbsp;<span class="num" id="3641273">6</span><span class="op" id="3641274">,</span>&nbsp;<span class="num" id="3641276">1</span><span class="op" id="3641277">,</span>&nbsp;<span class="num" id="3641279">5</span><span class="op" id="3641280">,</span>&nbsp;<span class="num" id="3641282">5</span><span class="op" id="3641283">,</span>&nbsp;<span class="num" id="3641285">7</span><span class="op" id="3641286">,</span>&nbsp;<span class="num" id="3641288">48</span><span class="op" id="3641290">,</span>&nbsp;<span class="num" id="3641292">1</span><span class="op" id="3641293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641296">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="3641326">=</span>&nbsp;<span class="ident" id="3641328">asn1</span><span class="op" id="3641332">.</span><span class="ident" id="3641333">ObjectIdentifier</span><span class="op" id="3641349">{</span><span class="num" id="3641350">1</span><span class="op" id="3641351">,</span>&nbsp;<span class="num" id="3641353">3</span><span class="op" id="3641354">,</span>&nbsp;<span class="num" id="3641356">6</span><span class="op" id="3641357">,</span>&nbsp;<span class="num" id="3641359">1</span><span class="op" id="3641360">,</span>&nbsp;<span class="num" id="3641362">5</span><span class="op" id="3641363">,</span>&nbsp;<span class="num" id="3641365">5</span><span class="op" id="3641366">,</span>&nbsp;<span class="num" id="3641368">7</span><span class="op" id="3641369">,</span>&nbsp;<span class="num" id="3641371">48</span><span class="op" id="3641373">,</span>&nbsp;<span class="num" id="3641375">2</span><span class="op" id="3641376">}</span><br>
<span class="lineno"></span><span class="op" id="3641378">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="3641381">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3641461">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="3641476">func</span>&nbsp;<span class="ident" id="3641481">oidInExtensions</span><span class="op" id="3641496">(</span><span class="ident" id="3641497">oid</span>&nbsp;<span class="ident" id="3641501">asn1</span><span class="op" id="3641505">.</span><span class="ident" id="3641506">ObjectIdentifier</span><span class="op" id="3641522">,</span>&nbsp;<span class="ident" id="3641524">extensions</span>&nbsp;<span class="op" id="3641535">[</span><span class="op" id="3641536">]</span><span class="ident" id="3641537">pkix</span><span class="op" id="3641541">.</span><span class="ident" id="3641542">Extension</span><span class="op" id="3641551">)</span>&nbsp;<span class="builtintype" id="3641553">bool</span>&nbsp;<span class="op" id="3641558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641561">for</span>&nbsp;<span class="ident" id="3641565">_</span><span class="op" id="3641566">,</span>&nbsp;<span class="ident" id="3641568">e</span>&nbsp;<span class="op" id="3641570">:=</span>&nbsp;<span class="keyword" id="3641573">range</span>&nbsp;<span class="ident" id="3641579">extensions</span>&nbsp;<span class="op" id="3641590">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641594">if</span>&nbsp;<span class="ident" id="3641597">e</span><span class="op" id="3641598">.</span><span class="ident" id="3641599">Id</span><span class="op" id="3641601">.</span><span class="ident" id="3641602">Equal</span><span class="op" id="3641607">(</span><span class="ident" id="3641608">oid</span><span class="op" id="3641611">)</span>&nbsp;<span class="op" id="3641613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641618">return</span>&nbsp;<span class="builtintype" id="3641625">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641638">return</span>&nbsp;<span class="builtintype" id="3641645">false</span><br>
<span class="lineno">1165</span><span class="op" id="3641651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3641654">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="3641730">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="3641767">func</span>&nbsp;<span class="ident" id="3641772">marshalSANs</span><span class="op" id="3641783">(</span><span class="ident" id="3641784">dnsNames</span><span class="op" id="3641792">,</span>&nbsp;<span class="ident" id="3641794">emailAddresses</span>&nbsp;<span class="op" id="3641809">[</span><span class="op" id="3641810">]</span><span class="builtintype" id="3641811">string</span><span class="op" id="3641817">,</span>&nbsp;<span class="ident" id="3641819">ipAddresses</span>&nbsp;<span class="op" id="3641831">[</span><span class="op" id="3641832">]</span><span class="ident" id="3641833">net</span><span class="op" id="3641836">.</span><span class="ident" id="3641837">IP</span><span class="op" id="3641839">)</span>&nbsp;<span class="op" id="3641841">(</span><span class="ident" id="3641842">derBytes</span>&nbsp;<span class="op" id="3641851">[</span><span class="op" id="3641852">]</span><span class="builtintype" id="3641853">byte</span><span class="op" id="3641857">,</span>&nbsp;<span class="ident" id="3641859">err</span>&nbsp;<span class="builtintype" id="3641863">error</span><span class="op" id="3641868">)</span>&nbsp;<span class="op" id="3641870">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641873">var</span>&nbsp;<span class="ident" id="3641877">rawValues</span>&nbsp;<span class="op" id="3641887">[</span><span class="op" id="3641888">]</span><span class="ident" id="3641889">asn1</span><span class="op" id="3641893">.</span><span class="ident" id="3641894">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641904">for</span>&nbsp;<span class="ident" id="3641908">_</span><span class="op" id="3641909">,</span>&nbsp;<span class="ident" id="3641911">name</span>&nbsp;<span class="op" id="3641916">:=</span>&nbsp;<span class="keyword" id="3641919">range</span>&nbsp;<span class="ident" id="3641925">dnsNames</span>&nbsp;<span class="op" id="3641934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641938">rawValues</span>&nbsp;<span class="op" id="3641948">=</span>&nbsp;<span class="builtinfunc" id="3641950">append</span><span class="op" id="3641956">(</span><span class="ident" id="3641957">rawValues</span><span class="op" id="3641966">,</span>&nbsp;<span class="ident" id="3641968">asn1</span><span class="op" id="3641972">.</span><span class="ident" id="3641973">RawValue</span><span class="op" id="3641981">{</span><span class="ident" id="3641982">Tag</span><span class="op" id="3641985">:</span>&nbsp;<span class="num" id="3641987">2</span><span class="op" id="3641988">,</span>&nbsp;<span class="ident" id="3641990">Class</span><span class="op" id="3641995">:</span>&nbsp;<span class="num" id="3641997">2</span><span class="op" id="3641998">,</span>&nbsp;<span class="ident" id="3642000">Bytes</span><span class="op" id="3642005">:</span>&nbsp;<span class="op" id="3642007">[</span><span class="op" id="3642008">]</span><span class="builtintype" id="3642009">byte</span><span class="op" id="3642013">(</span><span class="ident" id="3642014">name</span><span class="op" id="3642018">)</span><span class="op" id="3642019">}</span><span class="op" id="3642020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642026">for</span>&nbsp;<span class="ident" id="3642030">_</span><span class="op" id="3642031">,</span>&nbsp;<span class="ident" id="3642033">email</span>&nbsp;<span class="op" id="3642039">:=</span>&nbsp;<span class="keyword" id="3642042">range</span>&nbsp;<span class="ident" id="3642048">emailAddresses</span>&nbsp;<span class="op" id="3642063">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642067">rawValues</span>&nbsp;<span class="op" id="3642077">=</span>&nbsp;<span class="builtinfunc" id="3642079">append</span><span class="op" id="3642085">(</span><span class="ident" id="3642086">rawValues</span><span class="op" id="3642095">,</span>&nbsp;<span class="ident" id="3642097">asn1</span><span class="op" id="3642101">.</span><span class="ident" id="3642102">RawValue</span><span class="op" id="3642110">{</span><span class="ident" id="3642111">Tag</span><span class="op" id="3642114">:</span>&nbsp;<span class="num" id="3642116">1</span><span class="op" id="3642117">,</span>&nbsp;<span class="ident" id="3642119">Class</span><span class="op" id="3642124">:</span>&nbsp;<span class="num" id="3642126">2</span><span class="op" id="3642127">,</span>&nbsp;<span class="ident" id="3642129">Bytes</span><span class="op" id="3642134">:</span>&nbsp;<span class="op" id="3642136">[</span><span class="op" id="3642137">]</span><span class="builtintype" id="3642138">byte</span><span class="op" id="3642142">(</span><span class="ident" id="3642143">email</span><span class="op" id="3642148">)</span><span class="op" id="3642149">}</span><span class="op" id="3642150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642156">for</span>&nbsp;<span class="ident" id="3642160">_</span><span class="op" id="3642161">,</span>&nbsp;<span class="ident" id="3642163">rawIP</span>&nbsp;<span class="op" id="3642169">:=</span>&nbsp;<span class="keyword" id="3642172">range</span>&nbsp;<span class="ident" id="3642178">ipAddresses</span>&nbsp;<span class="op" id="3642190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3642194">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642264">ip</span>&nbsp;<span class="op" id="3642267">:=</span>&nbsp;<span class="ident" id="3642270">rawIP</span><span class="op" id="3642275">.</span><span class="ident" id="3642276">To4</span><span class="op" id="3642279">(</span><span class="op" id="3642280">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642284">if</span>&nbsp;<span class="ident" id="3642287">ip</span>&nbsp;<span class="op" id="3642290">==</span>&nbsp;<span class="ident" id="3642293">nil</span>&nbsp;<span class="op" id="3642297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642302">ip</span>&nbsp;<span class="op" id="3642305">=</span>&nbsp;<span class="ident" id="3642307">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642319">rawValues</span>&nbsp;<span class="op" id="3642329">=</span>&nbsp;<span class="builtinfunc" id="3642331">append</span><span class="op" id="3642337">(</span><span class="ident" id="3642338">rawValues</span><span class="op" id="3642347">,</span>&nbsp;<span class="ident" id="3642349">asn1</span><span class="op" id="3642353">.</span><span class="ident" id="3642354">RawValue</span><span class="op" id="3642362">{</span><span class="ident" id="3642363">Tag</span><span class="op" id="3642366">:</span>&nbsp;<span class="num" id="3642368">7</span><span class="op" id="3642369">,</span>&nbsp;<span class="ident" id="3642371">Class</span><span class="op" id="3642376">:</span>&nbsp;<span class="num" id="3642378">2</span><span class="op" id="3642379">,</span>&nbsp;<span class="ident" id="3642381">Bytes</span><span class="op" id="3642386">:</span>&nbsp;<span class="ident" id="3642388">ip</span><span class="op" id="3642390">}</span><span class="op" id="3642391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642394">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642397">return</span>&nbsp;<span class="ident" id="3642404">asn1</span><span class="op" id="3642408">.</span><span class="ident" id="3642409">Marshal</span><span class="op" id="3642416">(</span><span class="ident" id="3642417">rawValues</span><span class="op" id="3642426">)</span><br>
<span class="lineno"></span><span class="op" id="3642428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3642431">func</span>&nbsp;<span class="ident" id="3642436">buildExtensions</span><span class="op" id="3642451">(</span><span class="ident" id="3642452">template</span>&nbsp;<span class="op" id="3642461">*</span><span class="ident" id="3642462">Certificate</span><span class="op" id="3642473">)</span>&nbsp;<span class="op" id="3642475">(</span><span class="ident" id="3642476">ret</span>&nbsp;<span class="op" id="3642480">[</span><span class="op" id="3642481">]</span><span class="ident" id="3642482">pkix</span><span class="op" id="3642486">.</span><span class="ident" id="3642487">Extension</span><span class="op" id="3642496">,</span>&nbsp;<span class="ident" id="3642498">err</span>&nbsp;<span class="builtintype" id="3642502">error</span><span class="op" id="3642507">)</span>&nbsp;<span class="op" id="3642509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642512">ret</span>&nbsp;<span class="op" id="3642516">=</span>&nbsp;<span class="builtinfunc" id="3642518">make</span><span class="op" id="3642522">(</span><span class="op" id="3642523">[</span><span class="op" id="3642524">]</span><span class="ident" id="3642525">pkix</span><span class="op" id="3642529">.</span><span class="ident" id="3642530">Extension</span><span class="op" id="3642539">,</span>&nbsp;<span class="num" id="3642541">10</span>&nbsp;<span class="comment" id="3642544">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="3642577">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642580">n</span>&nbsp;<span class="op" id="3642582">:=</span>&nbsp;<span class="num" id="3642585">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642589">if</span>&nbsp;<span class="ident" id="3642592">template</span><span class="op" id="3642600">.</span><span class="ident" id="3642601">KeyUsage</span>&nbsp;<span class="op" id="3642610">!=</span>&nbsp;<span class="num" id="3642613">0</span>&nbsp;<span class="op" id="3642615">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642620">!</span><span class="ident" id="3642621">oidInExtensions</span><span class="op" id="3642636">(</span><span class="ident" id="3642637">oidExtensionKeyUsage</span><span class="op" id="3642657">,</span>&nbsp;<span class="ident" id="3642659">template</span><span class="op" id="3642667">.</span><span class="ident" id="3642668">ExtraExtensions</span><span class="op" id="3642683">)</span>&nbsp;<span class="op" id="3642685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642689">ret</span><span class="op" id="3642692">[</span><span class="ident" id="3642693">n</span><span class="op" id="3642694">]</span><span class="op" id="3642695">.</span><span class="ident" id="3642696">Id</span>&nbsp;<span class="op" id="3642699">=</span>&nbsp;<span class="ident" id="3642701">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642724">ret</span><span class="op" id="3642727">[</span><span class="ident" id="3642728">n</span><span class="op" id="3642729">]</span><span class="op" id="3642730">.</span><span class="ident" id="3642731">Critical</span>&nbsp;<span class="op" id="3642740">=</span>&nbsp;<span class="builtintype" id="3642742">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642750">var</span>&nbsp;<span class="ident" id="3642754">a</span>&nbsp;<span class="op" id="3642756">[</span><span class="num" id="3642757">2</span><span class="op" id="3642758">]</span><span class="builtintype" id="3642759">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642766">a</span><span class="op" id="3642767">[</span><span class="num" id="3642768">0</span><span class="op" id="3642769">]</span>&nbsp;<span class="op" id="3642771">=</span>&nbsp;<span class="ident" id="3642773">reverseBitsInAByte</span><span class="op" id="3642791">(</span><span class="builtintype" id="3642792">byte</span><span class="op" id="3642796">(</span><span class="ident" id="3642797">template</span><span class="op" id="3642805">.</span><span class="ident" id="3642806">KeyUsage</span><span class="op" id="3642814">)</span><span class="op" id="3642815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642819">a</span><span class="op" id="3642820">[</span><span class="num" id="3642821">1</span><span class="op" id="3642822">]</span>&nbsp;<span class="op" id="3642824">=</span>&nbsp;<span class="ident" id="3642826">reverseBitsInAByte</span><span class="op" id="3642844">(</span><span class="builtintype" id="3642845">byte</span><span class="op" id="3642849">(</span><span class="ident" id="3642850">template</span><span class="op" id="3642858">.</span><span class="ident" id="3642859">KeyUsage</span>&nbsp;<span class="op" id="3642868">&gt;&gt;</span>&nbsp;<span class="num" id="3642871">8</span><span class="op" id="3642872">)</span><span class="op" id="3642873">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642878">l</span>&nbsp;<span class="op" id="3642880">:=</span>&nbsp;<span class="num" id="3642883">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642887">if</span>&nbsp;<span class="ident" id="3642890">a</span><span class="op" id="3642891">[</span><span class="num" id="3642892">1</span><span class="op" id="3642893">]</span>&nbsp;<span class="op" id="3642895">!=</span>&nbsp;<span class="num" id="3642898">0</span>&nbsp;<span class="op" id="3642900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642905">l</span>&nbsp;<span class="op" id="3642907">=</span>&nbsp;<span class="num" id="3642909">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642913">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642918">ret</span><span class="op" id="3642921">[</span><span class="ident" id="3642922">n</span><span class="op" id="3642923">]</span><span class="op" id="3642924">.</span><span class="ident" id="3642925">Value</span><span class="op" id="3642930">,</span>&nbsp;<span class="ident" id="3642932">err</span>&nbsp;<span class="op" id="3642936">=</span>&nbsp;<span class="ident" id="3642938">asn1</span><span class="op" id="3642942">.</span><span class="ident" id="3642943">Marshal</span><span class="op" id="3642950">(</span><span class="ident" id="3642951">asn1</span><span class="op" id="3642955">.</span><span class="ident" id="3642956">BitString</span><span class="op" id="3642965">{</span><span class="ident" id="3642966">Bytes</span><span class="op" id="3642971">:</span>&nbsp;<span class="ident" id="3642973">a</span><span class="op" id="3642974">[</span><span class="num" id="3642975">0</span><span class="op" id="3642976">:</span><span class="ident" id="3642977">l</span><span class="op" id="3642978">]</span><span class="op" id="3642979">,</span>&nbsp;<span class="ident" id="3642981">BitLength</span><span class="op" id="3642990">:</span>&nbsp;<span class="ident" id="3642992">l</span>&nbsp;<span class="op" id="3642994">*</span>&nbsp;<span class="num" id="3642996">8</span><span class="op" id="3642997">}</span><span class="op" id="3642998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643002">if</span>&nbsp;<span class="ident" id="3643005">err</span>&nbsp;<span class="op" id="3643009">!=</span>&nbsp;<span class="ident" id="3643012">nil</span>&nbsp;<span class="op" id="3643016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643021">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643030">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643034">n</span><span class="op" id="3643035">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643043">if</span>&nbsp;<span class="op" id="3643046">(</span><span class="builtinfunc" id="3643047">len</span><span class="op" id="3643050">(</span><span class="ident" id="3643051">template</span><span class="op" id="3643059">.</span><span class="ident" id="3643060">ExtKeyUsage</span><span class="op" id="3643071">)</span>&nbsp;<span class="op" id="3643073">&gt;</span>&nbsp;<span class="num" id="3643075">0</span>&nbsp;<span class="op" id="3643077">||</span>&nbsp;<span class="builtinfunc" id="3643080">len</span><span class="op" id="3643083">(</span><span class="ident" id="3643084">template</span><span class="op" id="3643092">.</span><span class="ident" id="3643093">UnknownExtKeyUsage</span><span class="op" id="3643111">)</span>&nbsp;<span class="op" id="3643113">&gt;</span>&nbsp;<span class="num" id="3643115">0</span><span class="op" id="3643116">)</span>&nbsp;<span class="op" id="3643118">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643123">!</span><span class="ident" id="3643124">oidInExtensions</span><span class="op" id="3643139">(</span><span class="ident" id="3643140">oidExtensionExtendedKeyUsage</span><span class="op" id="3643168">,</span>&nbsp;<span class="ident" id="3643170">template</span><span class="op" id="3643178">.</span><span class="ident" id="3643179">ExtraExtensions</span><span class="op" id="3643194">)</span>&nbsp;<span class="op" id="3643196">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643200">ret</span><span class="op" id="3643203">[</span><span class="ident" id="3643204">n</span><span class="op" id="3643205">]</span><span class="op" id="3643206">.</span><span class="ident" id="3643207">Id</span>&nbsp;<span class="op" id="3643210">=</span>&nbsp;<span class="ident" id="3643212">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643244">var</span>&nbsp;<span class="ident" id="3643248">oids</span>&nbsp;<span class="op" id="3643253">[</span><span class="op" id="3643254">]</span><span class="ident" id="3643255">asn1</span><span class="op" id="3643259">.</span><span class="ident" id="3643260">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643279">for</span>&nbsp;<span class="ident" id="3643283">_</span><span class="op" id="3643284">,</span>&nbsp;<span class="ident" id="3643286">u</span>&nbsp;<span class="op" id="3643288">:=</span>&nbsp;<span class="keyword" id="3643291">range</span>&nbsp;<span class="ident" id="3643297">template</span><span class="op" id="3643305">.</span><span class="ident" id="3643306">ExtKeyUsage</span>&nbsp;<span class="op" id="3643318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643323">if</span>&nbsp;<span class="ident" id="3643326">oid</span><span class="op" id="3643329">,</span>&nbsp;<span class="ident" id="3643331">ok</span>&nbsp;<span class="op" id="3643334">:=</span>&nbsp;<span class="ident" id="3643337">oidFromExtKeyUsage</span><span class="op" id="3643355">(</span><span class="ident" id="3643356">u</span><span class="op" id="3643357">)</span><span class="op" id="3643358">;</span>&nbsp;<span class="ident" id="3643360">ok</span>&nbsp;<span class="op" id="3643363">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643369">oids</span>&nbsp;<span class="op" id="3643374">=</span>&nbsp;<span class="builtinfunc" id="3643376">append</span><span class="op" id="3643382">(</span><span class="ident" id="3643383">oids</span><span class="op" id="3643387">,</span>&nbsp;<span class="ident" id="3643389">oid</span><span class="op" id="3643392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643397">}</span>&nbsp;<span class="keyword" id="3643399">else</span>&nbsp;<span class="op" id="3643404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3643410">panic</span><span class="op" id="3643415">(</span><span class="string" id="3643416">&#34;internal&nbsp;error&#34;</span><span class="op" id="3643432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643441">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643446">oids</span>&nbsp;<span class="op" id="3643451">=</span>&nbsp;<span class="builtinfunc" id="3643453">append</span><span class="op" id="3643459">(</span><span class="ident" id="3643460">oids</span><span class="op" id="3643464">,</span>&nbsp;<span class="ident" id="3643466">template</span><span class="op" id="3643474">.</span><span class="ident" id="3643475">UnknownExtKeyUsage</span><span class="op" id="3643493">...</span><span class="op" id="3643496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643501">ret</span><span class="op" id="3643504">[</span><span class="ident" id="3643505">n</span><span class="op" id="3643506">]</span><span class="op" id="3643507">.</span><span class="ident" id="3643508">Value</span><span class="op" id="3643513">,</span>&nbsp;<span class="ident" id="3643515">err</span>&nbsp;<span class="op" id="3643519">=</span>&nbsp;<span class="ident" id="3643521">asn1</span><span class="op" id="3643525">.</span><span class="ident" id="3643526">Marshal</span><span class="op" id="3643533">(</span><span class="ident" id="3643534">oids</span><span class="op" id="3643538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643542">if</span>&nbsp;<span class="ident" id="3643545">err</span>&nbsp;<span class="op" id="3643549">!=</span>&nbsp;<span class="ident" id="3643552">nil</span>&nbsp;<span class="op" id="3643556">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643561">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643574">n</span><span class="op" id="3643575">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643583">if</span>&nbsp;<span class="ident" id="3643586">template</span><span class="op" id="3643594">.</span><span class="ident" id="3643595">BasicConstraintsValid</span>&nbsp;<span class="op" id="3643617">&amp;&amp;</span>&nbsp;<span class="op" id="3643620">!</span><span class="ident" id="3643621">oidInExtensions</span><span class="op" id="3643636">(</span><span class="ident" id="3643637">oidExtensionBasicConstraints</span><span class="op" id="3643665">,</span>&nbsp;<span class="ident" id="3643667">template</span><span class="op" id="3643675">.</span><span class="ident" id="3643676">ExtraExtensions</span><span class="op" id="3643691">)</span>&nbsp;<span class="op" id="3643693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3643697">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3643760">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3643825">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643884">maxPathLen</span>&nbsp;<span class="op" id="3643895">:=</span>&nbsp;<span class="ident" id="3643898">template</span><span class="op" id="3643906">.</span><span class="ident" id="3643907">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643920">if</span>&nbsp;<span class="ident" id="3643923">maxPathLen</span>&nbsp;<span class="op" id="3643934">==</span>&nbsp;<span class="num" id="3643937">0</span>&nbsp;<span class="op" id="3643939">&amp;&amp;</span>&nbsp;<span class="op" id="3643942">!</span><span class="ident" id="3643943">template</span><span class="op" id="3643951">.</span><span class="ident" id="3643952">MaxPathLenZero</span>&nbsp;<span class="op" id="3643967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643972">maxPathLen</span>&nbsp;<span class="op" id="3643983">=</span>&nbsp;<span class="op" id="3643985">-</span><span class="num" id="3643986">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643994">ret</span><span class="op" id="3643997">[</span><span class="ident" id="3643998">n</span><span class="op" id="3643999">]</span><span class="op" id="3644000">.</span><span class="ident" id="3644001">Id</span>&nbsp;<span class="op" id="3644004">=</span>&nbsp;<span class="ident" id="3644006">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644037">ret</span><span class="op" id="3644040">[</span><span class="ident" id="3644041">n</span><span class="op" id="3644042">]</span><span class="op" id="3644043">.</span><span class="ident" id="3644044">Value</span><span class="op" id="3644049">,</span>&nbsp;<span class="ident" id="3644051">err</span>&nbsp;<span class="op" id="3644055">=</span>&nbsp;<span class="ident" id="3644057">asn1</span><span class="op" id="3644061">.</span><span class="ident" id="3644062">Marshal</span><span class="op" id="3644069">(</span><span class="ident" id="3644070">basicConstraints</span><span class="op" id="3644086">{</span><span class="ident" id="3644087">template</span><span class="op" id="3644095">.</span><span class="ident" id="3644096">IsCA</span><span class="op" id="3644100">,</span>&nbsp;<span class="ident" id="3644102">maxPathLen</span><span class="op" id="3644112">}</span><span class="op" id="3644113">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644117">ret</span><span class="op" id="3644120">[</span><span class="ident" id="3644121">n</span><span class="op" id="3644122">]</span><span class="op" id="3644123">.</span><span class="ident" id="3644124">Critical</span>&nbsp;<span class="op" id="3644133">=</span>&nbsp;<span class="builtintype" id="3644135">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644142">if</span>&nbsp;<span class="ident" id="3644145">err</span>&nbsp;<span class="op" id="3644149">!=</span>&nbsp;<span class="ident" id="3644152">nil</span>&nbsp;<span class="op" id="3644156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644161">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644174">n</span><span class="op" id="3644175">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644183">if</span>&nbsp;<span class="builtinfunc" id="3644186">len</span><span class="op" id="3644189">(</span><span class="ident" id="3644190">template</span><span class="op" id="3644198">.</span><span class="ident" id="3644199">SubjectKeyId</span><span class="op" id="3644211">)</span>&nbsp;<span class="op" id="3644213">&gt;</span>&nbsp;<span class="num" id="3644215">0</span>&nbsp;<span class="op" id="3644217">&amp;&amp;</span>&nbsp;<span class="op" id="3644220">!</span><span class="ident" id="3644221">oidInExtensions</span><span class="op" id="3644236">(</span><span class="ident" id="3644237">oidExtensionSubjectKeyId</span><span class="op" id="3644261">,</span>&nbsp;<span class="ident" id="3644263">template</span><span class="op" id="3644271">.</span><span class="ident" id="3644272">ExtraExtensions</span><span class="op" id="3644287">)</span>&nbsp;<span class="op" id="3644289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644293">ret</span><span class="op" id="3644296">[</span><span class="ident" id="3644297">n</span><span class="op" id="3644298">]</span><span class="op" id="3644299">.</span><span class="ident" id="3644300">Id</span>&nbsp;<span class="op" id="3644303">=</span>&nbsp;<span class="ident" id="3644305">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644332">ret</span><span class="op" id="3644335">[</span><span class="ident" id="3644336">n</span><span class="op" id="3644337">]</span><span class="op" id="3644338">.</span><span class="ident" id="3644339">Value</span><span class="op" id="3644344">,</span>&nbsp;<span class="ident" id="3644346">err</span>&nbsp;<span class="op" id="3644350">=</span>&nbsp;<span class="ident" id="3644352">asn1</span><span class="op" id="3644356">.</span><span class="ident" id="3644357">Marshal</span><span class="op" id="3644364">(</span><span class="ident" id="3644365">template</span><span class="op" id="3644373">.</span><span class="ident" id="3644374">SubjectKeyId</span><span class="op" id="3644386">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644390">if</span>&nbsp;<span class="ident" id="3644393">err</span>&nbsp;<span class="op" id="3644397">!=</span>&nbsp;<span class="ident" id="3644400">nil</span>&nbsp;<span class="op" id="3644404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644409">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644422">n</span><span class="op" id="3644423">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644427">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644431">if</span>&nbsp;<span class="builtinfunc" id="3644434">len</span><span class="op" id="3644437">(</span><span class="ident" id="3644438">template</span><span class="op" id="3644446">.</span><span class="ident" id="3644447">AuthorityKeyId</span><span class="op" id="3644461">)</span>&nbsp;<span class="op" id="3644463">&gt;</span>&nbsp;<span class="num" id="3644465">0</span>&nbsp;<span class="op" id="3644467">&amp;&amp;</span>&nbsp;<span class="op" id="3644470">!</span><span class="ident" id="3644471">oidInExtensions</span><span class="op" id="3644486">(</span><span class="ident" id="3644487">oidExtensionAuthorityKeyId</span><span class="op" id="3644513">,</span>&nbsp;<span class="ident" id="3644515">template</span><span class="op" id="3644523">.</span><span class="ident" id="3644524">ExtraExtensions</span><span class="op" id="3644539">)</span>&nbsp;<span class="op" id="3644541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644545">ret</span><span class="op" id="3644548">[</span><span class="ident" id="3644549">n</span><span class="op" id="3644550">]</span><span class="op" id="3644551">.</span><span class="ident" id="3644552">Id</span>&nbsp;<span class="op" id="3644555">=</span>&nbsp;<span class="ident" id="3644557">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644586">ret</span><span class="op" id="3644589">[</span><span class="ident" id="3644590">n</span><span class="op" id="3644591">]</span><span class="op" id="3644592">.</span><span class="ident" id="3644593">Value</span><span class="op" id="3644598">,</span>&nbsp;<span class="ident" id="3644600">err</span>&nbsp;<span class="op" id="3644604">=</span>&nbsp;<span class="ident" id="3644606">asn1</span><span class="op" id="3644610">.</span><span class="ident" id="3644611">Marshal</span><span class="op" id="3644618">(</span><span class="ident" id="3644619">authKeyId</span><span class="op" id="3644628">{</span><span class="ident" id="3644629">template</span><span class="op" id="3644637">.</span><span class="ident" id="3644638">AuthorityKeyId</span><span class="op" id="3644652">}</span><span class="op" id="3644653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644657">if</span>&nbsp;<span class="ident" id="3644660">err</span>&nbsp;<span class="op" id="3644664">!=</span>&nbsp;<span class="ident" id="3644667">nil</span>&nbsp;<span class="op" id="3644671">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644676">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644689">n</span><span class="op" id="3644690">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644698">if</span>&nbsp;<span class="op" id="3644701">(</span><span class="builtinfunc" id="3644702">len</span><span class="op" id="3644705">(</span><span class="ident" id="3644706">template</span><span class="op" id="3644714">.</span><span class="ident" id="3644715">OCSPServer</span><span class="op" id="3644725">)</span>&nbsp;<span class="op" id="3644727">&gt;</span>&nbsp;<span class="num" id="3644729">0</span>&nbsp;<span class="op" id="3644731">||</span>&nbsp;<span class="builtinfunc" id="3644734">len</span><span class="op" id="3644737">(</span><span class="ident" id="3644738">template</span><span class="op" id="3644746">.</span><span class="ident" id="3644747">IssuingCertificateURL</span><span class="op" id="3644768">)</span>&nbsp;<span class="op" id="3644770">&gt;</span>&nbsp;<span class="num" id="3644772">0</span><span class="op" id="3644773">)</span>&nbsp;<span class="op" id="3644775">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644780">!</span><span class="ident" id="3644781">oidInExtensions</span><span class="op" id="3644796">(</span><span class="ident" id="3644797">oidExtensionAuthorityInfoAccess</span><span class="op" id="3644828">,</span>&nbsp;<span class="ident" id="3644830">template</span><span class="op" id="3644838">.</span><span class="ident" id="3644839">ExtraExtensions</span><span class="op" id="3644854">)</span>&nbsp;<span class="op" id="3644856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644860">ret</span><span class="op" id="3644863">[</span><span class="ident" id="3644864">n</span><span class="op" id="3644865">]</span><span class="op" id="3644866">.</span><span class="ident" id="3644867">Id</span>&nbsp;<span class="op" id="3644870">=</span>&nbsp;<span class="ident" id="3644872">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644906">var</span>&nbsp;<span class="ident" id="3644910">aiaValues</span>&nbsp;<span class="op" id="3644920">[</span><span class="op" id="3644921">]</span><span class="ident" id="3644922">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644944">for</span>&nbsp;<span class="ident" id="3644948">_</span><span class="op" id="3644949">,</span>&nbsp;<span class="ident" id="3644951">name</span>&nbsp;<span class="op" id="3644956">:=</span>&nbsp;<span class="keyword" id="3644959">range</span>&nbsp;<span class="ident" id="3644965">template</span><span class="op" id="3644973">.</span><span class="ident" id="3644974">OCSPServer</span>&nbsp;<span class="op" id="3644985">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644990">aiaValues</span>&nbsp;<span class="op" id="3645000">=</span>&nbsp;<span class="builtinfunc" id="3645002">append</span><span class="op" id="3645008">(</span><span class="ident" id="3645009">aiaValues</span><span class="op" id="3645018">,</span>&nbsp;<span class="ident" id="3645020">authorityInfoAccess</span><span class="op" id="3645039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645045">Method</span><span class="op" id="3645051">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3645055">oidAuthorityInfoAccessOcsp</span><span class="op" id="3645081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645087">Location</span><span class="op" id="3645095">:</span>&nbsp;<span class="ident" id="3645097">asn1</span><span class="op" id="3645101">.</span><span class="ident" id="3645102">RawValue</span><span class="op" id="3645110">{</span><span class="ident" id="3645111">Tag</span><span class="op" id="3645114">:</span>&nbsp;<span class="num" id="3645116">6</span><span class="op" id="3645117">,</span>&nbsp;<span class="ident" id="3645119">Class</span><span class="op" id="3645124">:</span>&nbsp;<span class="num" id="3645126">2</span><span class="op" id="3645127">,</span>&nbsp;<span class="ident" id="3645129">Bytes</span><span class="op" id="3645134">:</span>&nbsp;<span class="op" id="3645136">[</span><span class="op" id="3645137">]</span><span class="builtintype" id="3645138">byte</span><span class="op" id="3645142">(</span><span class="ident" id="3645143">name</span><span class="op" id="3645147">)</span><span class="op" id="3645148">}</span><span class="op" id="3645149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645154">}</span><span class="op" id="3645155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645159">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645163">for</span>&nbsp;<span class="ident" id="3645167">_</span><span class="op" id="3645168">,</span>&nbsp;<span class="ident" id="3645170">name</span>&nbsp;<span class="op" id="3645175">:=</span>&nbsp;<span class="keyword" id="3645178">range</span>&nbsp;<span class="ident" id="3645184">template</span><span class="op" id="3645192">.</span><span class="ident" id="3645193">IssuingCertificateURL</span>&nbsp;<span class="op" id="3645215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645220">aiaValues</span>&nbsp;<span class="op" id="3645230">=</span>&nbsp;<span class="builtinfunc" id="3645232">append</span><span class="op" id="3645238">(</span><span class="ident" id="3645239">aiaValues</span><span class="op" id="3645248">,</span>&nbsp;<span class="ident" id="3645250">authorityInfoAccess</span><span class="op" id="3645269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645275">Method</span><span class="op" id="3645281">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3645285">oidAuthorityInfoAccessIssuers</span><span class="op" id="3645314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645320">Location</span><span class="op" id="3645328">:</span>&nbsp;<span class="ident" id="3645330">asn1</span><span class="op" id="3645334">.</span><span class="ident" id="3645335">RawValue</span><span class="op" id="3645343">{</span><span class="ident" id="3645344">Tag</span><span class="op" id="3645347">:</span>&nbsp;<span class="num" id="3645349">6</span><span class="op" id="3645350">,</span>&nbsp;<span class="ident" id="3645352">Class</span><span class="op" id="3645357">:</span>&nbsp;<span class="num" id="3645359">2</span><span class="op" id="3645360">,</span>&nbsp;<span class="ident" id="3645362">Bytes</span><span class="op" id="3645367">:</span>&nbsp;<span class="op" id="3645369">[</span><span class="op" id="3645370">]</span><span class="builtintype" id="3645371">byte</span><span class="op" id="3645375">(</span><span class="ident" id="3645376">name</span><span class="op" id="3645380">)</span><span class="op" id="3645381">}</span><span class="op" id="3645382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645387">}</span><span class="op" id="3645388">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645396">ret</span><span class="op" id="3645399">[</span><span class="ident" id="3645400">n</span><span class="op" id="3645401">]</span><span class="op" id="3645402">.</span><span class="ident" id="3645403">Value</span><span class="op" id="3645408">,</span>&nbsp;<span class="ident" id="3645410">err</span>&nbsp;<span class="op" id="3645414">=</span>&nbsp;<span class="ident" id="3645416">asn1</span><span class="op" id="3645420">.</span><span class="ident" id="3645421">Marshal</span><span class="op" id="3645428">(</span><span class="ident" id="3645429">aiaValues</span><span class="op" id="3645438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645442">if</span>&nbsp;<span class="ident" id="3645445">err</span>&nbsp;<span class="op" id="3645449">!=</span>&nbsp;<span class="ident" id="3645452">nil</span>&nbsp;<span class="op" id="3645456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645461">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645470">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645474">n</span><span class="op" id="3645475">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645483">if</span>&nbsp;<span class="op" id="3645486">(</span><span class="builtinfunc" id="3645487">len</span><span class="op" id="3645490">(</span><span class="ident" id="3645491">template</span><span class="op" id="3645499">.</span><span class="ident" id="3645500">DNSNames</span><span class="op" id="3645508">)</span>&nbsp;<span class="op" id="3645510">&gt;</span>&nbsp;<span class="num" id="3645512">0</span>&nbsp;<span class="op" id="3645514">||</span>&nbsp;<span class="builtinfunc" id="3645517">len</span><span class="op" id="3645520">(</span><span class="ident" id="3645521">template</span><span class="op" id="3645529">.</span><span class="ident" id="3645530">EmailAddresses</span><span class="op" id="3645544">)</span>&nbsp;<span class="op" id="3645546">&gt;</span>&nbsp;<span class="num" id="3645548">0</span>&nbsp;<span class="op" id="3645550">||</span>&nbsp;<span class="builtinfunc" id="3645553">len</span><span class="op" id="3645556">(</span><span class="ident" id="3645557">template</span><span class="op" id="3645565">.</span><span class="ident" id="3645566">IPAddresses</span><span class="op" id="3645577">)</span>&nbsp;<span class="op" id="3645579">&gt;</span>&nbsp;<span class="num" id="3645581">0</span><span class="op" id="3645582">)</span>&nbsp;<span class="op" id="3645584">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645589">!</span><span class="ident" id="3645590">oidInExtensions</span><span class="op" id="3645605">(</span><span class="ident" id="3645606">oidExtensionSubjectAltName</span><span class="op" id="3645632">,</span>&nbsp;<span class="ident" id="3645634">template</span><span class="op" id="3645642">.</span><span class="ident" id="3645643">ExtraExtensions</span><span class="op" id="3645658">)</span>&nbsp;<span class="op" id="3645660">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645664">ret</span><span class="op" id="3645667">[</span><span class="ident" id="3645668">n</span><span class="op" id="3645669">]</span><span class="op" id="3645670">.</span><span class="ident" id="3645671">Id</span>&nbsp;<span class="op" id="3645674">=</span>&nbsp;<span class="ident" id="3645676">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645705">ret</span><span class="op" id="3645708">[</span><span class="ident" id="3645709">n</span><span class="op" id="3645710">]</span><span class="op" id="3645711">.</span><span class="ident" id="3645712">Value</span><span class="op" id="3645717">,</span>&nbsp;<span class="ident" id="3645719">err</span>&nbsp;<span class="op" id="3645723">=</span>&nbsp;<span class="ident" id="3645725">marshalSANs</span><span class="op" id="3645736">(</span><span class="ident" id="3645737">template</span><span class="op" id="3645745">.</span><span class="ident" id="3645746">DNSNames</span><span class="op" id="3645754">,</span>&nbsp;<span class="ident" id="3645756">template</span><span class="op" id="3645764">.</span><span class="ident" id="3645765">EmailAddresses</span><span class="op" id="3645779">,</span>&nbsp;<span class="ident" id="3645781">template</span><span class="op" id="3645789">.</span><span class="ident" id="3645790">IPAddresses</span><span class="op" id="3645801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645805">if</span>&nbsp;<span class="ident" id="3645808">err</span>&nbsp;<span class="op" id="3645812">!=</span>&nbsp;<span class="ident" id="3645815">nil</span>&nbsp;<span class="op" id="3645819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645824">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645833">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645837">n</span><span class="op" id="3645838">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645846">if</span>&nbsp;<span class="builtinfunc" id="3645849">len</span><span class="op" id="3645852">(</span><span class="ident" id="3645853">template</span><span class="op" id="3645861">.</span><span class="ident" id="3645862">PolicyIdentifiers</span><span class="op" id="3645879">)</span>&nbsp;<span class="op" id="3645881">&gt;</span>&nbsp;<span class="num" id="3645883">0</span>&nbsp;<span class="op" id="3645885">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645890">!</span><span class="ident" id="3645891">oidInExtensions</span><span class="op" id="3645906">(</span><span class="ident" id="3645907">oidExtensionCertificatePolicies</span><span class="op" id="3645938">,</span>&nbsp;<span class="ident" id="3645940">template</span><span class="op" id="3645948">.</span><span class="ident" id="3645949">ExtraExtensions</span><span class="op" id="3645964">)</span>&nbsp;<span class="op" id="3645966">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645970">ret</span><span class="op" id="3645973">[</span><span class="ident" id="3645974">n</span><span class="op" id="3645975">]</span><span class="op" id="3645976">.</span><span class="ident" id="3645977">Id</span>&nbsp;<span class="op" id="3645980">=</span>&nbsp;<span class="ident" id="3645982">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646016">policies</span>&nbsp;<span class="op" id="3646025">:=</span>&nbsp;<span class="builtinfunc" id="3646028">make</span><span class="op" id="3646032">(</span><span class="op" id="3646033">[</span><span class="op" id="3646034">]</span><span class="ident" id="3646035">policyInformation</span><span class="op" id="3646052">,</span>&nbsp;<span class="builtinfunc" id="3646054">len</span><span class="op" id="3646057">(</span><span class="ident" id="3646058">template</span><span class="op" id="3646066">.</span><span class="ident" id="3646067">PolicyIdentifiers</span><span class="op" id="3646084">)</span><span class="op" id="3646085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646089">for</span>&nbsp;<span class="ident" id="3646093">i</span><span class="op" id="3646094">,</span>&nbsp;<span class="ident" id="3646096">policy</span>&nbsp;<span class="op" id="3646103">:=</span>&nbsp;<span class="keyword" id="3646106">range</span>&nbsp;<span class="ident" id="3646112">template</span><span class="op" id="3646120">.</span><span class="ident" id="3646121">PolicyIdentifiers</span>&nbsp;<span class="op" id="3646139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646144">policies</span><span class="op" id="3646152">[</span><span class="ident" id="3646153">i</span><span class="op" id="3646154">]</span><span class="op" id="3646155">.</span><span class="ident" id="3646156">Policy</span>&nbsp;<span class="op" id="3646163">=</span>&nbsp;<span class="ident" id="3646165">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3646174">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646178">ret</span><span class="op" id="3646181">[</span><span class="ident" id="3646182">n</span><span class="op" id="3646183">]</span><span class="op" id="3646184">.</span><span class="ident" id="3646185">Value</span><span class="op" id="3646190">,</span>&nbsp;<span class="ident" id="3646192">err</span>&nbsp;<span class="op" id="3646196">=</span>&nbsp;<span class="ident" id="3646198">asn1</span><span class="op" id="3646202">.</span><span class="ident" id="3646203">Marshal</span><span class="op" id="3646210">(</span><span class="ident" id="3646211">policies</span><span class="op" id="3646219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646223">if</span>&nbsp;<span class="ident" id="3646226">err</span>&nbsp;<span class="op" id="3646230">!=</span>&nbsp;<span class="ident" id="3646233">nil</span>&nbsp;<span class="op" id="3646237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646242">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3646251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646255">n</span><span class="op" id="3646256">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3646260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646264">if</span>&nbsp;<span class="builtinfunc" id="3646267">len</span><span class="op" id="3646270">(</span><span class="ident" id="3646271">template</span><span class="op" id="3646279">.</span><span class="ident" id="3646280">PermittedDNSDomains</span><span class="op" id="3646299">)</span>&nbsp;<span class="op" id="3646301">&gt;</span>&nbsp;<span class="num" id="3646303">0</span>&nbsp;<span class="op" id="3646305">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3646310">!</span><span class="ident" id="3646311">oidInExtensions</span><span class="op" id="3646326">(</span><span class="ident" id="3646327">oidExtensionNameConstraints</span><span class="op" id="3646354">,</span>&nbsp;<span class="ident" id="3646356">template</span><span class="op" id="3646364">.</span><span class="ident" id="3646365">ExtraExtensions</span><span class="op" id="3646380">)</span>&nbsp;<span class="op" id="3646382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646386">ret</span><span class="op" id="3646389">[</span><span class="ident" id="3646390">n</span><span class="op" id="3646391">]</span><span class="op" id="3646392">.</span><span class="ident" id="3646393">Id</span>&nbsp;<span class="op" id="3646396">=</span>&nbsp;<span class="ident" id="3646398">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646428">ret</span><span class="op" id="3646431">[</span><span class="ident" id="3646432">n</span><span class="op" id="3646433">]</span><span class="op" id="3646434">.</span><span class="ident" id="3646435">Critical</span>&nbsp;<span class="op" id="3646444">=</span>&nbsp;<span class="ident" id="3646446">template</span><span class="op" id="3646454">.</span><span class="ident" id="3646455">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646486">var</span>&nbsp;<span class="ident" id="3646490">out</span>&nbsp;<span class="ident" id="3646494">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646512">out</span><span class="op" id="3646515">.</span><span class="ident" id="3646516">Permitted</span>&nbsp;<span class="op" id="3646526">=</span>&nbsp;<span class="builtinfunc" id="3646528">make</span><span class="op" id="3646532">(</span><span class="op" id="3646533">[</span><span class="op" id="3646534">]</span><span class="ident" id="3646535">generalSubtree</span><span class="op" id="3646549">,</span>&nbsp;<span class="builtinfunc" id="3646551">len</span><span class="op" id="3646554">(</span><span class="ident" id="3646555">template</span><span class="op" id="3646563">.</span><span class="ident" id="3646564">PermittedDNSDomains</span><span class="op" id="3646583">)</span><span class="op" id="3646584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646588">for</span>&nbsp;<span class="ident" id="3646592">i</span><span class="op" id="3646593">,</span>&nbsp;<span class="ident" id="3646595">permitted</span>&nbsp;<span class="op" id="3646605">:=</span>&nbsp;<span class="keyword" id="3646608">range</span>&nbsp;<span class="ident" id="3646614">template</span><span class="op" id="3646622">.</span><span class="ident" id="3646623">PermittedDNSDomains</span>&nbsp;<span class="op" id="3646643">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646648">out</span><span class="op" id="3646651">.</span><span class="ident" id="3646652">Permitted</span><span class="op" id="3646661">[</span><span class="ident" id="3646662">i</span><span class="op" id="3646663">]</span>&nbsp;<span class="op" id="3646665">=</span>&nbsp;<span class="ident" id="3646667">generalSubtree</span><span class="op" id="3646681">{</span><span class="ident" id="3646682">Name</span><span class="op" id="3646686">:</span>&nbsp;<span class="ident" id="3646688">permitted</span><span class="op" id="3646697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3646701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646705">ret</span><span class="op" id="3646708">[</span><span class="ident" id="3646709">n</span><span class="op" id="3646710">]</span><span class="op" id="3646711">.</span><span class="ident" id="3646712">Value</span><span class="op" id="3646717">,</span>&nbsp;<span class="ident" id="3646719">err</span>&nbsp;<span class="op" id="3646723">=</span>&nbsp;<span class="ident" id="3646725">asn1</span><span class="op" id="3646729">.</span><span class="ident" id="3646730">Marshal</span><span class="op" id="3646737">(</span><span class="ident" id="3646738">out</span><span class="op" id="3646741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646745">if</span>&nbsp;<span class="ident" id="3646748">err</span>&nbsp;<span class="op" id="3646752">!=</span>&nbsp;<span class="ident" id="3646755">nil</span>&nbsp;<span class="op" id="3646759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646764">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3646773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646777">n</span><span class="op" id="3646778">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3646782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646786">if</span>&nbsp;<span class="builtinfunc" id="3646789">len</span><span class="op" id="3646792">(</span><span class="ident" id="3646793">template</span><span class="op" id="3646801">.</span><span class="ident" id="3646802">CRLDistributionPoints</span><span class="op" id="3646823">)</span>&nbsp;<span class="op" id="3646825">&gt;</span>&nbsp;<span class="num" id="3646827">0</span>&nbsp;<span class="op" id="3646829">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3646834">!</span><span class="ident" id="3646835">oidInExtensions</span><span class="op" id="3646850">(</span><span class="ident" id="3646851">oidExtensionCRLDistributionPoints</span><span class="op" id="3646884">,</span>&nbsp;<span class="ident" id="3646886">template</span><span class="op" id="3646894">.</span><span class="ident" id="3646895">ExtraExtensions</span><span class="op" id="3646910">)</span>&nbsp;<span class="op" id="3646912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3646916">ret</span><span class="op" id="3646919">[</span><span class="ident" id="3646920">n</span><span class="op" id="3646921">]</span><span class="op" id="3646922">.</span><span class="ident" id="3646923">Id</span>&nbsp;<span class="op" id="3646926">=</span>&nbsp;<span class="ident" id="3646928">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646965">var</span>&nbsp;<span class="ident" id="3646969">crlDp</span>&nbsp;<span class="op" id="3646975">[</span><span class="op" id="3646976">]</span><span class="ident" id="3646977">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3646997">for</span>&nbsp;<span class="ident" id="3647001">_</span><span class="op" id="3647002">,</span>&nbsp;<span class="ident" id="3647004">name</span>&nbsp;<span class="op" id="3647009">:=</span>&nbsp;<span class="keyword" id="3647012">range</span>&nbsp;<span class="ident" id="3647018">template</span><span class="op" id="3647026">.</span><span class="ident" id="3647027">CRLDistributionPoints</span>&nbsp;<span class="op" id="3647049">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647054">rawFullName</span><span class="op" id="3647065">,</span>&nbsp;<span class="ident" id="3647067">_</span>&nbsp;<span class="op" id="3647069">:=</span>&nbsp;<span class="ident" id="3647072">asn1</span><span class="op" id="3647076">.</span><span class="ident" id="3647077">Marshal</span><span class="op" id="3647084">(</span><span class="ident" id="3647085">asn1</span><span class="op" id="3647089">.</span><span class="ident" id="3647090">RawValue</span><span class="op" id="3647098">{</span><span class="ident" id="3647099">Tag</span><span class="op" id="3647102">:</span>&nbsp;<span class="num" id="3647104">6</span><span class="op" id="3647105">,</span>&nbsp;<span class="ident" id="3647107">Class</span><span class="op" id="3647112">:</span>&nbsp;<span class="num" id="3647114">2</span><span class="op" id="3647115">,</span>&nbsp;<span class="ident" id="3647117">Bytes</span><span class="op" id="3647122">:</span>&nbsp;<span class="op" id="3647124">[</span><span class="op" id="3647125">]</span><span class="builtintype" id="3647126">byte</span><span class="op" id="3647130">(</span><span class="ident" id="3647131">name</span><span class="op" id="3647135">)</span><span class="op" id="3647136">}</span><span class="op" id="3647137">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647143">dp</span>&nbsp;<span class="op" id="3647146">:=</span>&nbsp;<span class="ident" id="3647149">distributionPoint</span><span class="op" id="3647166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647172">DistributionPoint</span><span class="op" id="3647189">:</span>&nbsp;<span class="ident" id="3647191">distributionPointName</span><span class="op" id="3647212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647219">FullName</span><span class="op" id="3647227">:</span>&nbsp;<span class="ident" id="3647229">asn1</span><span class="op" id="3647233">.</span><span class="ident" id="3647234">RawValue</span><span class="op" id="3647242">{</span><span class="ident" id="3647243">Tag</span><span class="op" id="3647246">:</span>&nbsp;<span class="num" id="3647248">0</span><span class="op" id="3647249">,</span>&nbsp;<span class="ident" id="3647251">Class</span><span class="op" id="3647256">:</span>&nbsp;<span class="num" id="3647258">2</span><span class="op" id="3647259">,</span>&nbsp;<span class="ident" id="3647261">IsCompound</span><span class="op" id="3647271">:</span>&nbsp;<span class="builtintype" id="3647273">true</span><span class="op" id="3647277">,</span>&nbsp;<span class="ident" id="3647279">Bytes</span><span class="op" id="3647284">:</span>&nbsp;<span class="ident" id="3647286">rawFullName</span><span class="op" id="3647297">}</span><span class="op" id="3647298">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647304">}</span><span class="op" id="3647305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647315">crlDp</span>&nbsp;<span class="op" id="3647321">=</span>&nbsp;<span class="builtinfunc" id="3647323">append</span><span class="op" id="3647329">(</span><span class="ident" id="3647330">crlDp</span><span class="op" id="3647335">,</span>&nbsp;<span class="ident" id="3647337">dp</span><span class="op" id="3647339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647348">ret</span><span class="op" id="3647351">[</span><span class="ident" id="3647352">n</span><span class="op" id="3647353">]</span><span class="op" id="3647354">.</span><span class="ident" id="3647355">Value</span><span class="op" id="3647360">,</span>&nbsp;<span class="ident" id="3647362">err</span>&nbsp;<span class="op" id="3647366">=</span>&nbsp;<span class="ident" id="3647368">asn1</span><span class="op" id="3647372">.</span><span class="ident" id="3647373">Marshal</span><span class="op" id="3647380">(</span><span class="ident" id="3647381">crlDp</span><span class="op" id="3647386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647390">if</span>&nbsp;<span class="ident" id="3647393">err</span>&nbsp;<span class="op" id="3647397">!=</span>&nbsp;<span class="ident" id="3647400">nil</span>&nbsp;<span class="op" id="3647404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647409">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3647422">n</span><span class="op" id="3647423">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3647431">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3647504">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647563">return</span>&nbsp;<span class="builtinfunc" id="3647570">append</span><span class="op" id="3647576">(</span><span class="ident" id="3647577">ret</span><span class="op" id="3647580">[</span><span class="op" id="3647581">:</span><span class="ident" id="3647582">n</span><span class="op" id="3647583">]</span><span class="op" id="3647584">,</span>&nbsp;<span class="ident" id="3647586">template</span><span class="op" id="3647594">.</span><span class="ident" id="3647595">ExtraExtensions</span><span class="op" id="3647610">...</span><span class="op" id="3647613">)</span><span class="op" id="3647614">,</span>&nbsp;<span class="ident" id="3647616">nil</span><br>
<span class="lineno"></span><span class="op" id="3647620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3647623">func</span>&nbsp;<span class="ident" id="3647628">subjectBytes</span><span class="op" id="3647640">(</span><span class="ident" id="3647641">cert</span>&nbsp;<span class="op" id="3647646">*</span><span class="ident" id="3647647">Certificate</span><span class="op" id="3647658">)</span>&nbsp;<span class="op" id="3647660">(</span><span class="op" id="3647661">[</span><span class="op" id="3647662">]</span><span class="builtintype" id="3647663">byte</span><span class="op" id="3647667">,</span>&nbsp;<span class="builtintype" id="3647669">error</span><span class="op" id="3647674">)</span>&nbsp;<span class="op" id="3647676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647679">if</span>&nbsp;<span class="builtinfunc" id="3647682">len</span><span class="op" id="3647685">(</span><span class="ident" id="3647686">cert</span><span class="op" id="3647690">.</span><span class="ident" id="3647691">RawSubject</span><span class="op" id="3647701">)</span>&nbsp;<span class="op" id="3647703">&gt;</span>&nbsp;<span class="num" id="3647705">0</span>&nbsp;<span class="op" id="3647707">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647711">return</span>&nbsp;<span class="ident" id="3647718">cert</span><span class="op" id="3647722">.</span><span class="ident" id="3647723">RawSubject</span><span class="op" id="3647733">,</span>&nbsp;<span class="ident" id="3647735">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3647740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3647744">return</span>&nbsp;<span class="ident" id="3647751">asn1</span><span class="op" id="3647755">.</span><span class="ident" id="3647756">Marshal</span><span class="op" id="3647763">(</span><span class="ident" id="3647764">cert</span><span class="op" id="3647768">.</span><span class="ident" id="3647769">Subject</span><span class="op" id="3647776">.</span><span class="ident" id="3647777">ToRDNSequence</span><span class="op" id="3647790">(</span><span class="op" id="3647791">)</span><span class="op" id="3647792">)</span><br>
<span class="lineno"></span><span class="op" id="3647794">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="3647797">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3647874">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="3647945">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3647969">func</span>&nbsp;<span class="ident" id="3647974">signingParamsForPrivateKey</span><span class="op" id="3648000">(</span><span class="ident" id="3648001">priv</span>&nbsp;<span class="keyword" id="3648006">interface</span><span class="op" id="3648015">{</span><span class="op" id="3648016">}</span><span class="op" id="3648017">,</span>&nbsp;<span class="ident" id="3648019">requestedSigAlgo</span>&nbsp;<span class="ident" id="3648036">SignatureAlgorithm</span><span class="op" id="3648054">)</span>&nbsp;<span class="op" id="3648056">(</span><span class="ident" id="3648057">hashFunc</span>&nbsp;<span class="ident" id="3648066">crypto</span><span class="op" id="3648072">.</span><span class="ident" id="3648073">Hash</span><span class="op" id="3648077">,</span>&nbsp;<span class="ident" id="3648079">sigAlgo</span>&nbsp;<span class="ident" id="3648087">pkix</span><span class="op" id="3648091">.</span><span class="ident" id="3648092">AlgorithmIdentifier</span><span class="op" id="3648111">,</span>&nbsp;<span class="ident" id="3648113">err</span>&nbsp;<span class="builtintype" id="3648117">error</span><span class="op" id="3648122">)</span>&nbsp;<span class="op" id="3648124">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648127">var</span>&nbsp;<span class="ident" id="3648131">pubType</span>&nbsp;<span class="ident" id="3648139">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648160">switch</span>&nbsp;<span class="ident" id="3648167">priv</span>&nbsp;<span class="op" id="3648172">:=</span>&nbsp;<span class="ident" id="3648175">priv</span><span class="op" id="3648179">.</span><span class="op" id="3648180">(</span><span class="keyword" id="3648181">type</span><span class="op" id="3648185">)</span>&nbsp;<span class="op" id="3648187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648190">case</span>&nbsp;<span class="op" id="3648195">*</span><span class="ident" id="3648196">rsa</span><span class="op" id="3648199">.</span><span class="ident" id="3648200">PrivateKey</span><span class="op" id="3648210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648214">pubType</span>&nbsp;<span class="op" id="3648222">=</span>&nbsp;<span class="ident" id="3648224">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648230">sigAlgo</span><span class="op" id="3648237">.</span><span class="ident" id="3648238">Algorithm</span>&nbsp;<span class="op" id="3648248">=</span>&nbsp;<span class="ident" id="3648250">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648278">hashFunc</span>&nbsp;<span class="op" id="3648287">=</span>&nbsp;<span class="ident" id="3648289">crypto</span><span class="op" id="3648295">.</span><span class="ident" id="3648296">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648305">case</span>&nbsp;<span class="op" id="3648310">*</span><span class="ident" id="3648311">ecdsa</span><span class="op" id="3648316">.</span><span class="ident" id="3648317">PrivateKey</span><span class="op" id="3648327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648331">pubType</span>&nbsp;<span class="op" id="3648339">=</span>&nbsp;<span class="ident" id="3648341">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648350">switch</span>&nbsp;<span class="ident" id="3648357">priv</span><span class="op" id="3648361">.</span><span class="ident" id="3648362">Curve</span>&nbsp;<span class="op" id="3648368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648372">case</span>&nbsp;<span class="ident" id="3648377">elliptic</span><span class="op" id="3648385">.</span><span class="ident" id="3648386">P224</span><span class="op" id="3648390">(</span><span class="op" id="3648391">)</span><span class="op" id="3648392">,</span>&nbsp;<span class="ident" id="3648394">elliptic</span><span class="op" id="3648402">.</span><span class="ident" id="3648403">P256</span><span class="op" id="3648407">(</span><span class="op" id="3648408">)</span><span class="op" id="3648409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648414">hashFunc</span>&nbsp;<span class="op" id="3648423">=</span>&nbsp;<span class="ident" id="3648425">crypto</span><span class="op" id="3648431">.</span><span class="ident" id="3648432">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648442">sigAlgo</span><span class="op" id="3648449">.</span><span class="ident" id="3648450">Algorithm</span>&nbsp;<span class="op" id="3648460">=</span>&nbsp;<span class="ident" id="3648462">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648492">case</span>&nbsp;<span class="ident" id="3648497">elliptic</span><span class="op" id="3648505">.</span><span class="ident" id="3648506">P384</span><span class="op" id="3648510">(</span><span class="op" id="3648511">)</span><span class="op" id="3648512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648517">hashFunc</span>&nbsp;<span class="op" id="3648526">=</span>&nbsp;<span class="ident" id="3648528">crypto</span><span class="op" id="3648534">.</span><span class="ident" id="3648535">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648545">sigAlgo</span><span class="op" id="3648552">.</span><span class="ident" id="3648553">Algorithm</span>&nbsp;<span class="op" id="3648563">=</span>&nbsp;<span class="ident" id="3648565">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648595">case</span>&nbsp;<span class="ident" id="3648600">elliptic</span><span class="op" id="3648608">.</span><span class="ident" id="3648609">P521</span><span class="op" id="3648613">(</span><span class="op" id="3648614">)</span><span class="op" id="3648615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648620">hashFunc</span>&nbsp;<span class="op" id="3648629">=</span>&nbsp;<span class="ident" id="3648631">crypto</span><span class="op" id="3648637">.</span><span class="ident" id="3648638">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648648">sigAlgo</span><span class="op" id="3648655">.</span><span class="ident" id="3648656">Algorithm</span>&nbsp;<span class="op" id="3648666">=</span>&nbsp;<span class="ident" id="3648668">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648698">default</span><span class="op" id="3648705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648710">err</span>&nbsp;<span class="op" id="3648714">=</span>&nbsp;<span class="ident" id="3648716">errors</span><span class="op" id="3648722">.</span><span class="ident" id="3648723">New</span><span class="op" id="3648726">(</span><span class="string" id="3648727">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3648757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3648761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648765">default</span><span class="op" id="3648772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648776">err</span>&nbsp;<span class="op" id="3648780">=</span>&nbsp;<span class="ident" id="3648782">errors</span><span class="op" id="3648788">.</span><span class="ident" id="3648789">New</span><span class="op" id="3648792">(</span><span class="string" id="3648793">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="3648842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3648845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648849">if</span>&nbsp;<span class="ident" id="3648852">err</span>&nbsp;<span class="op" id="3648856">!=</span>&nbsp;<span class="ident" id="3648859">nil</span>&nbsp;<span class="op" id="3648863">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648867">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3648875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648879">if</span>&nbsp;<span class="ident" id="3648882">requestedSigAlgo</span>&nbsp;<span class="op" id="3648899">==</span>&nbsp;<span class="num" id="3648902">0</span>&nbsp;<span class="op" id="3648904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648908">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3648916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3648920">found</span>&nbsp;<span class="op" id="3648926">:=</span>&nbsp;<span class="builtintype" id="3648929">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648936">for</span>&nbsp;<span class="ident" id="3648940">_</span><span class="op" id="3648941">,</span>&nbsp;<span class="ident" id="3648943">details</span>&nbsp;<span class="op" id="3648951">:=</span>&nbsp;<span class="keyword" id="3648954">range</span>&nbsp;<span class="ident" id="3648960">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3648986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3648990">if</span>&nbsp;<span class="ident" id="3648993">details</span><span class="op" id="3649000">.</span><span class="ident" id="3649001">algo</span>&nbsp;<span class="op" id="3649006">==</span>&nbsp;<span class="ident" id="3649009">requestedSigAlgo</span>&nbsp;<span class="op" id="3649026">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649031">if</span>&nbsp;<span class="ident" id="3649034">details</span><span class="op" id="3649041">.</span><span class="ident" id="3649042">pubKeyAlgo</span>&nbsp;<span class="op" id="3649053">!=</span>&nbsp;<span class="ident" id="3649056">pubType</span>&nbsp;<span class="op" id="3649064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3649070">err</span>&nbsp;<span class="op" id="3649074">=</span>&nbsp;<span class="ident" id="3649076">errors</span><span class="op" id="3649082">.</span><span class="ident" id="3649083">New</span><span class="op" id="3649086">(</span><span class="string" id="3649087">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="3649155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649161">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3649176">sigAlgo</span><span class="op" id="3649183">.</span><span class="ident" id="3649184">Algorithm</span><span class="op" id="3649193">,</span>&nbsp;<span class="ident" id="3649195">hashFunc</span>&nbsp;<span class="op" id="3649204">=</span>&nbsp;<span class="ident" id="3649206">details</span><span class="op" id="3649213">.</span><span class="ident" id="3649214">oid</span><span class="op" id="3649217">,</span>&nbsp;<span class="ident" id="3649219">details</span><span class="op" id="3649226">.</span><span class="ident" id="3649227">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649235">if</span>&nbsp;<span class="ident" id="3649238">hashFunc</span>&nbsp;<span class="op" id="3649247">==</span>&nbsp;<span class="num" id="3649250">0</span>&nbsp;<span class="op" id="3649252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3649258">err</span>&nbsp;<span class="op" id="3649262">=</span>&nbsp;<span class="ident" id="3649264">errors</span><span class="op" id="3649270">.</span><span class="ident" id="3649271">New</span><span class="op" id="3649274">(</span><span class="string" id="3649275">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="3649323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649329">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3649344">found</span>&nbsp;<span class="op" id="3649350">=</span>&nbsp;<span class="builtintype" id="3649352">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649360">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649375">if</span>&nbsp;<span class="op" id="3649378">!</span><span class="ident" id="3649379">found</span>&nbsp;<span class="op" id="3649385">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3649389">err</span>&nbsp;<span class="op" id="3649393">=</span>&nbsp;<span class="ident" id="3649395">errors</span><span class="op" id="3649401">.</span><span class="ident" id="3649402">New</span><span class="op" id="3649405">(</span><span class="string" id="3649406">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="3649440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3649443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3649447">return</span><br>
<span class="lineno"></span><span class="op" id="3649454">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="3649457">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3649529">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="3649606">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="3649685">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="3649759">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="3649803">//</span><br>
<span class="lineno"></span><span class="comment" id="3649806">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3649886">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3649960">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="3650013">//</span><br>
<span class="lineno"></span><span class="comment" id="3650016">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="3650074">//</span><br>
<span class="lineno"></span><span class="comment" id="3650077">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3650146">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="3650223">func</span>&nbsp;<span class="ident" id="3650228">CreateCertificate</span><span class="op" id="3650245">(</span><span class="ident" id="3650246">rand</span>&nbsp;<span class="ident" id="3650251">io</span><span class="op" id="3650253">.</span><span class="ident" id="3650254">Reader</span><span class="op" id="3650260">,</span>&nbsp;<span class="ident" id="3650262">template</span><span class="op" id="3650270">,</span>&nbsp;<span class="ident" id="3650272">parent</span>&nbsp;<span class="op" id="3650279">*</span><span class="ident" id="3650280">Certificate</span><span class="op" id="3650291">,</span>&nbsp;<span class="ident" id="3650293">pub</span>&nbsp;<span class="keyword" id="3650297">interface</span><span class="op" id="3650306">{</span><span class="op" id="3650307">}</span><span class="op" id="3650308">,</span>&nbsp;<span class="ident" id="3650310">priv</span>&nbsp;<span class="keyword" id="3650315">interface</span><span class="op" id="3650324">{</span><span class="op" id="3650325">}</span><span class="op" id="3650326">)</span>&nbsp;<span class="op" id="3650328">(</span><span class="ident" id="3650329">cert</span>&nbsp;<span class="op" id="3650334">[</span><span class="op" id="3650335">]</span><span class="builtintype" id="3650336">byte</span><span class="op" id="3650340">,</span>&nbsp;<span class="ident" id="3650342">err</span>&nbsp;<span class="builtintype" id="3650346">error</span><span class="op" id="3650351">)</span>&nbsp;<span class="op" id="3650353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650356">hashFunc</span><span class="op" id="3650364">,</span>&nbsp;<span class="ident" id="3650366">signatureAlgorithm</span><span class="op" id="3650384">,</span>&nbsp;<span class="ident" id="3650386">err</span>&nbsp;<span class="op" id="3650390">:=</span>&nbsp;<span class="ident" id="3650393">signingParamsForPrivateKey</span><span class="op" id="3650419">(</span><span class="ident" id="3650420">priv</span><span class="op" id="3650424">,</span>&nbsp;<span class="ident" id="3650426">template</span><span class="op" id="3650434">.</span><span class="ident" id="3650435">SignatureAlgorithm</span><span class="op" id="3650453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650456">if</span>&nbsp;<span class="ident" id="3650459">err</span>&nbsp;<span class="op" id="3650463">!=</span>&nbsp;<span class="ident" id="3650466">nil</span>&nbsp;<span class="op" id="3650470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650474">return</span>&nbsp;<span class="ident" id="3650481">nil</span><span class="op" id="3650484">,</span>&nbsp;<span class="ident" id="3650486">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650491">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650495">publicKeyBytes</span><span class="op" id="3650509">,</span>&nbsp;<span class="ident" id="3650511">publicKeyAlgorithm</span><span class="op" id="3650529">,</span>&nbsp;<span class="ident" id="3650531">err</span>&nbsp;<span class="op" id="3650535">:=</span>&nbsp;<span class="ident" id="3650538">marshalPublicKey</span><span class="op" id="3650554">(</span><span class="ident" id="3650555">pub</span><span class="op" id="3650558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650561">if</span>&nbsp;<span class="ident" id="3650564">err</span>&nbsp;<span class="op" id="3650568">!=</span>&nbsp;<span class="ident" id="3650571">nil</span>&nbsp;<span class="op" id="3650575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650579">return</span>&nbsp;<span class="ident" id="3650586">nil</span><span class="op" id="3650589">,</span>&nbsp;<span class="ident" id="3650591">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650596">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650600">if</span>&nbsp;<span class="ident" id="3650603">err</span>&nbsp;<span class="op" id="3650607">!=</span>&nbsp;<span class="ident" id="3650610">nil</span>&nbsp;<span class="op" id="3650614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650618">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650630">if</span>&nbsp;<span class="builtinfunc" id="3650633">len</span><span class="op" id="3650636">(</span><span class="ident" id="3650637">parent</span><span class="op" id="3650643">.</span><span class="ident" id="3650644">SubjectKeyId</span><span class="op" id="3650656">)</span>&nbsp;<span class="op" id="3650658">&gt;</span>&nbsp;<span class="num" id="3650660">0</span>&nbsp;<span class="op" id="3650662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650666">template</span><span class="op" id="3650674">.</span><span class="ident" id="3650675">AuthorityKeyId</span>&nbsp;<span class="op" id="3650690">=</span>&nbsp;<span class="ident" id="3650692">parent</span><span class="op" id="3650698">.</span><span class="ident" id="3650699">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650717">extensions</span><span class="op" id="3650727">,</span>&nbsp;<span class="ident" id="3650729">err</span>&nbsp;<span class="op" id="3650733">:=</span>&nbsp;<span class="ident" id="3650736">buildExtensions</span><span class="op" id="3650751">(</span><span class="ident" id="3650752">template</span><span class="op" id="3650760">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650763">if</span>&nbsp;<span class="ident" id="3650766">err</span>&nbsp;<span class="op" id="3650770">!=</span>&nbsp;<span class="ident" id="3650773">nil</span>&nbsp;<span class="op" id="3650777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650781">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650793">asn1Issuer</span><span class="op" id="3650803">,</span>&nbsp;<span class="ident" id="3650805">err</span>&nbsp;<span class="op" id="3650809">:=</span>&nbsp;<span class="ident" id="3650812">subjectBytes</span><span class="op" id="3650824">(</span><span class="ident" id="3650825">parent</span><span class="op" id="3650831">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650834">if</span>&nbsp;<span class="ident" id="3650837">err</span>&nbsp;<span class="op" id="3650841">!=</span>&nbsp;<span class="ident" id="3650844">nil</span>&nbsp;<span class="op" id="3650848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650852">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650864">asn1Subject</span><span class="op" id="3650875">,</span>&nbsp;<span class="ident" id="3650877">err</span>&nbsp;<span class="op" id="3650881">:=</span>&nbsp;<span class="ident" id="3650884">subjectBytes</span><span class="op" id="3650896">(</span><span class="ident" id="3650897">template</span><span class="op" id="3650905">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650908">if</span>&nbsp;<span class="ident" id="3650911">err</span>&nbsp;<span class="op" id="3650915">!=</span>&nbsp;<span class="ident" id="3650918">nil</span>&nbsp;<span class="op" id="3650922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650926">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3650934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650938">encodedPublicKey</span>&nbsp;<span class="op" id="3650955">:=</span>&nbsp;<span class="ident" id="3650958">asn1</span><span class="op" id="3650962">.</span><span class="ident" id="3650963">BitString</span><span class="op" id="3650972">{</span><span class="ident" id="3650973">BitLength</span><span class="op" id="3650982">:</span>&nbsp;<span class="builtinfunc" id="3650984">len</span><span class="op" id="3650987">(</span><span class="ident" id="3650988">publicKeyBytes</span><span class="op" id="3651002">)</span>&nbsp;<span class="op" id="3651004">*</span>&nbsp;<span class="num" id="3651006">8</span><span class="op" id="3651007">,</span>&nbsp;<span class="ident" id="3651009">Bytes</span><span class="op" id="3651014">:</span>&nbsp;<span class="ident" id="3651016">publicKeyBytes</span><span class="op" id="3651030">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651033">c</span>&nbsp;<span class="op" id="3651035">:=</span>&nbsp;<span class="ident" id="3651038">tbsCertificate</span><span class="op" id="3651052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651056">Version</span><span class="op" id="3651063">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3651076">2</span><span class="op" id="3651077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651081">SerialNumber</span><span class="op" id="3651093">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651101">template</span><span class="op" id="3651109">.</span><span class="ident" id="3651110">SerialNumber</span><span class="op" id="3651122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651126">SignatureAlgorithm</span><span class="op" id="3651144">:</span>&nbsp;<span class="ident" id="3651146">signatureAlgorithm</span><span class="op" id="3651164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651168">Issuer</span><span class="op" id="3651174">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651188">asn1</span><span class="op" id="3651192">.</span><span class="ident" id="3651193">RawValue</span><span class="op" id="3651201">{</span><span class="ident" id="3651202">FullBytes</span><span class="op" id="3651211">:</span>&nbsp;<span class="ident" id="3651213">asn1Issuer</span><span class="op" id="3651223">}</span><span class="op" id="3651224">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651228">Validity</span><span class="op" id="3651236">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651248">validity</span><span class="op" id="3651256">{</span><span class="ident" id="3651257">template</span><span class="op" id="3651265">.</span><span class="ident" id="3651266">NotBefore</span><span class="op" id="3651275">.</span><span class="ident" id="3651276">UTC</span><span class="op" id="3651279">(</span><span class="op" id="3651280">)</span><span class="op" id="3651281">,</span>&nbsp;<span class="ident" id="3651283">template</span><span class="op" id="3651291">.</span><span class="ident" id="3651292">NotAfter</span><span class="op" id="3651300">.</span><span class="ident" id="3651301">UTC</span><span class="op" id="3651304">(</span><span class="op" id="3651305">)</span><span class="op" id="3651306">}</span><span class="op" id="3651307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651311">Subject</span><span class="op" id="3651318">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651331">asn1</span><span class="op" id="3651335">.</span><span class="ident" id="3651336">RawValue</span><span class="op" id="3651344">{</span><span class="ident" id="3651345">FullBytes</span><span class="op" id="3651354">:</span>&nbsp;<span class="ident" id="3651356">asn1Subject</span><span class="op" id="3651367">}</span><span class="op" id="3651368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651372">PublicKey</span><span class="op" id="3651381">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651392">publicKeyInfo</span><span class="op" id="3651405">{</span><span class="ident" id="3651406">nil</span><span class="op" id="3651409">,</span>&nbsp;<span class="ident" id="3651411">publicKeyAlgorithm</span><span class="op" id="3651429">,</span>&nbsp;<span class="ident" id="3651431">encodedPublicKey</span><span class="op" id="3651447">}</span><span class="op" id="3651448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651452">Extensions</span><span class="op" id="3651462">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651472">extensions</span><span class="op" id="3651482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651485">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651489">tbsCertContents</span><span class="op" id="3651504">,</span>&nbsp;<span class="ident" id="3651506">err</span>&nbsp;<span class="op" id="3651510">:=</span>&nbsp;<span class="ident" id="3651513">asn1</span><span class="op" id="3651517">.</span><span class="ident" id="3651518">Marshal</span><span class="op" id="3651525">(</span><span class="ident" id="3651526">c</span><span class="op" id="3651527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651530">if</span>&nbsp;<span class="ident" id="3651533">err</span>&nbsp;<span class="op" id="3651537">!=</span>&nbsp;<span class="ident" id="3651540">nil</span>&nbsp;<span class="op" id="3651544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651548">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651556">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651560">c</span><span class="op" id="3651561">.</span><span class="ident" id="3651562">Raw</span>&nbsp;<span class="op" id="3651566">=</span>&nbsp;<span class="ident" id="3651568">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651586">h</span>&nbsp;<span class="op" id="3651588">:=</span>&nbsp;<span class="ident" id="3651591">hashFunc</span><span class="op" id="3651599">.</span><span class="ident" id="3651600">New</span><span class="op" id="3651603">(</span><span class="op" id="3651604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651607">h</span><span class="op" id="3651608">.</span><span class="ident" id="3651609">Write</span><span class="op" id="3651614">(</span><span class="ident" id="3651615">tbsCertContents</span><span class="op" id="3651630">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651633">digest</span>&nbsp;<span class="op" id="3651640">:=</span>&nbsp;<span class="ident" id="3651643">h</span><span class="op" id="3651644">.</span><span class="ident" id="3651645">Sum</span><span class="op" id="3651648">(</span><span class="ident" id="3651649">nil</span><span class="op" id="3651652">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651656">var</span>&nbsp;<span class="ident" id="3651660">signature</span>&nbsp;<span class="op" id="3651670">[</span><span class="op" id="3651671">]</span><span class="builtintype" id="3651672">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651679">switch</span>&nbsp;<span class="ident" id="3651686">priv</span>&nbsp;<span class="op" id="3651691">:=</span>&nbsp;<span class="ident" id="3651694">priv</span><span class="op" id="3651698">.</span><span class="op" id="3651699">(</span><span class="keyword" id="3651700">type</span><span class="op" id="3651704">)</span>&nbsp;<span class="op" id="3651706">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651709">case</span>&nbsp;<span class="op" id="3651714">*</span><span class="ident" id="3651715">rsa</span><span class="op" id="3651718">.</span><span class="ident" id="3651719">PrivateKey</span><span class="op" id="3651729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651733">signature</span><span class="op" id="3651742">,</span>&nbsp;<span class="ident" id="3651744">err</span>&nbsp;<span class="op" id="3651748">=</span>&nbsp;<span class="ident" id="3651750">rsa</span><span class="op" id="3651753">.</span><span class="ident" id="3651754">SignPKCS1v15</span><span class="op" id="3651766">(</span><span class="ident" id="3651767">rand</span><span class="op" id="3651771">,</span>&nbsp;<span class="ident" id="3651773">priv</span><span class="op" id="3651777">,</span>&nbsp;<span class="ident" id="3651779">hashFunc</span><span class="op" id="3651787">,</span>&nbsp;<span class="ident" id="3651789">digest</span><span class="op" id="3651795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651798">case</span>&nbsp;<span class="op" id="3651803">*</span><span class="ident" id="3651804">ecdsa</span><span class="op" id="3651809">.</span><span class="ident" id="3651810">PrivateKey</span><span class="op" id="3651820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651824">var</span>&nbsp;<span class="ident" id="3651828">r</span><span class="op" id="3651829">,</span>&nbsp;<span class="ident" id="3651831">s</span>&nbsp;<span class="op" id="3651833">*</span><span class="ident" id="3651834">big</span><span class="op" id="3651837">.</span><span class="ident" id="3651838">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651844">if</span>&nbsp;<span class="ident" id="3651847">r</span><span class="op" id="3651848">,</span>&nbsp;<span class="ident" id="3651850">s</span><span class="op" id="3651851">,</span>&nbsp;<span class="ident" id="3651853">err</span>&nbsp;<span class="op" id="3651857">=</span>&nbsp;<span class="ident" id="3651859">ecdsa</span><span class="op" id="3651864">.</span><span class="ident" id="3651865">Sign</span><span class="op" id="3651869">(</span><span class="ident" id="3651870">rand</span><span class="op" id="3651874">,</span>&nbsp;<span class="ident" id="3651876">priv</span><span class="op" id="3651880">,</span>&nbsp;<span class="ident" id="3651882">digest</span><span class="op" id="3651888">)</span><span class="op" id="3651889">;</span>&nbsp;<span class="ident" id="3651891">err</span>&nbsp;<span class="op" id="3651895">==</span>&nbsp;<span class="ident" id="3651898">nil</span>&nbsp;<span class="op" id="3651902">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651907">signature</span><span class="op" id="3651916">,</span>&nbsp;<span class="ident" id="3651918">err</span>&nbsp;<span class="op" id="3651922">=</span>&nbsp;<span class="ident" id="3651924">asn1</span><span class="op" id="3651928">.</span><span class="ident" id="3651929">Marshal</span><span class="op" id="3651936">(</span><span class="ident" id="3651937">ecdsaSignature</span><span class="op" id="3651951">{</span><span class="ident" id="3651952">r</span><span class="op" id="3651953">,</span>&nbsp;<span class="ident" id="3651955">s</span><span class="op" id="3651956">}</span><span class="op" id="3651957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651964">default</span><span class="op" id="3651971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3651975">panic</span><span class="op" id="3651980">(</span><span class="string" id="3651981">&#34;internal&nbsp;error&#34;</span><span class="op" id="3651997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652000">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652004">if</span>&nbsp;<span class="ident" id="3652007">err</span>&nbsp;<span class="op" id="3652011">!=</span>&nbsp;<span class="ident" id="3652014">nil</span>&nbsp;<span class="op" id="3652018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652022">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652034">cert</span><span class="op" id="3652038">,</span>&nbsp;<span class="ident" id="3652040">err</span>&nbsp;<span class="op" id="3652044">=</span>&nbsp;<span class="ident" id="3652046">asn1</span><span class="op" id="3652050">.</span><span class="ident" id="3652051">Marshal</span><span class="op" id="3652058">(</span><span class="ident" id="3652059">certificate</span><span class="op" id="3652070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652074">nil</span><span class="op" id="3652077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652081">c</span><span class="op" id="3652082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652086">signatureAlgorithm</span><span class="op" id="3652104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652108">asn1</span><span class="op" id="3652112">.</span><span class="ident" id="3652113">BitString</span><span class="op" id="3652122">{</span><span class="ident" id="3652123">Bytes</span><span class="op" id="3652128">:</span>&nbsp;<span class="ident" id="3652130">signature</span><span class="op" id="3652139">,</span>&nbsp;<span class="ident" id="3652141">BitLength</span><span class="op" id="3652150">:</span>&nbsp;<span class="builtinfunc" id="3652152">len</span><span class="op" id="3652155">(</span><span class="ident" id="3652156">signature</span><span class="op" id="3652165">)</span>&nbsp;<span class="op" id="3652167">*</span>&nbsp;<span class="num" id="3652169">8</span><span class="op" id="3652170">}</span><span class="op" id="3652171">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652174">}</span><span class="op" id="3652175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652178">return</span><br>
<span class="lineno"></span><span class="op" id="3652185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3652188">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="3652266">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="3652274">var</span>&nbsp;<span class="ident" id="3652278">pemCRLPrefix</span>&nbsp;<span class="op" id="3652291">=</span>&nbsp;<span class="op" id="3652293">[</span><span class="op" id="3652294">]</span><span class="builtintype" id="3652295">byte</span><span class="op" id="3652299">(</span><span class="string" id="3652300">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="3652321">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3652324">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="3652369">var</span>&nbsp;<span class="ident" id="3652373">pemType</span>&nbsp;<span class="op" id="3652381">=</span>&nbsp;<span class="string" id="3652383">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="3652395">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="3652471">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="3652550">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="3652627">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="3652639">func</span>&nbsp;<span class="ident" id="3652644">ParseCRL</span><span class="op" id="3652652">(</span><span class="ident" id="3652653">crlBytes</span>&nbsp;<span class="op" id="3652662">[</span><span class="op" id="3652663">]</span><span class="builtintype" id="3652664">byte</span><span class="op" id="3652668">)</span>&nbsp;<span class="op" id="3652670">(</span><span class="ident" id="3652671">certList</span>&nbsp;<span class="op" id="3652680">*</span><span class="ident" id="3652681">pkix</span><span class="op" id="3652685">.</span><span class="ident" id="3652686">CertificateList</span><span class="op" id="3652701">,</span>&nbsp;<span class="ident" id="3652703">err</span>&nbsp;<span class="builtintype" id="3652707">error</span><span class="op" id="3652712">)</span>&nbsp;<span class="op" id="3652714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652717">if</span>&nbsp;<span class="ident" id="3652720">bytes</span><span class="op" id="3652725">.</span><span class="ident" id="3652726">HasPrefix</span><span class="op" id="3652735">(</span><span class="ident" id="3652736">crlBytes</span><span class="op" id="3652744">,</span>&nbsp;<span class="ident" id="3652746">pemCRLPrefix</span><span class="op" id="3652758">)</span>&nbsp;<span class="op" id="3652760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652764">block</span><span class="op" id="3652769">,</span>&nbsp;<span class="ident" id="3652771">_</span>&nbsp;<span class="op" id="3652773">:=</span>&nbsp;<span class="ident" id="3652776">pem</span><span class="op" id="3652779">.</span><span class="ident" id="3652780">Decode</span><span class="op" id="3652786">(</span><span class="ident" id="3652787">crlBytes</span><span class="op" id="3652795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652799">if</span>&nbsp;<span class="ident" id="3652802">block</span>&nbsp;<span class="op" id="3652808">!=</span>&nbsp;<span class="ident" id="3652811">nil</span>&nbsp;<span class="op" id="3652815">&amp;&amp;</span>&nbsp;<span class="ident" id="3652818">block</span><span class="op" id="3652823">.</span><span class="ident" id="3652824">Type</span>&nbsp;<span class="op" id="3652829">==</span>&nbsp;<span class="ident" id="3652832">pemType</span>&nbsp;<span class="op" id="3652840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652845">crlBytes</span>&nbsp;<span class="op" id="3652854">=</span>&nbsp;<span class="ident" id="3652856">block</span><span class="op" id="3652861">.</span><span class="ident" id="3652862">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652876">return</span>&nbsp;<span class="ident" id="3652883">ParseDERCRL</span><span class="op" id="3652894">(</span><span class="ident" id="3652895">crlBytes</span><span class="op" id="3652903">)</span><br>
<span class="lineno"></span><span class="op" id="3652905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="3652908">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3652970">func</span>&nbsp;<span class="ident" id="3652975">ParseDERCRL</span><span class="op" id="3652986">(</span><span class="ident" id="3652987">derBytes</span>&nbsp;<span class="op" id="3652996">[</span><span class="op" id="3652997">]</span><span class="builtintype" id="3652998">byte</span><span class="op" id="3653002">)</span>&nbsp;<span class="op" id="3653004">(</span><span class="ident" id="3653005">certList</span>&nbsp;<span class="op" id="3653014">*</span><span class="ident" id="3653015">pkix</span><span class="op" id="3653019">.</span><span class="ident" id="3653020">CertificateList</span><span class="op" id="3653035">,</span>&nbsp;<span class="ident" id="3653037">err</span>&nbsp;<span class="builtintype" id="3653041">error</span><span class="op" id="3653046">)</span>&nbsp;<span class="op" id="3653048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653051">certList</span>&nbsp;<span class="op" id="3653060">=</span>&nbsp;<span class="builtinfunc" id="3653062">new</span><span class="op" id="3653065">(</span><span class="ident" id="3653066">pkix</span><span class="op" id="3653070">.</span><span class="ident" id="3653071">CertificateList</span><span class="op" id="3653086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653089">_</span><span class="op" id="3653090">,</span>&nbsp;<span class="ident" id="3653092">err</span>&nbsp;<span class="op" id="3653096">=</span>&nbsp;<span class="ident" id="3653098">asn1</span><span class="op" id="3653102">.</span><span class="ident" id="3653103">Unmarshal</span><span class="op" id="3653112">(</span><span class="ident" id="3653113">derBytes</span><span class="op" id="3653121">,</span>&nbsp;<span class="ident" id="3653123">certList</span><span class="op" id="3653131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653134">if</span>&nbsp;<span class="ident" id="3653137">err</span>&nbsp;<span class="op" id="3653141">!=</span>&nbsp;<span class="ident" id="3653144">nil</span>&nbsp;<span class="op" id="3653148">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653152">certList</span>&nbsp;<span class="op" id="3653161">=</span>&nbsp;<span class="ident" id="3653163">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653171">return</span><br>
<span class="lineno"></span><span class="op" id="3653178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="3653181">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3653254">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="3653306">//</span><br>
<span class="lineno"></span><span class="comment" id="3653309">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="3653375">func</span>&nbsp;<span class="op" id="3653380">(</span><span class="ident" id="3653381">c</span>&nbsp;<span class="op" id="3653383">*</span><span class="ident" id="3653384">Certificate</span><span class="op" id="3653395">)</span>&nbsp;<span class="ident" id="3653397">CreateCRL</span><span class="op" id="3653406">(</span><span class="ident" id="3653407">rand</span>&nbsp;<span class="ident" id="3653412">io</span><span class="op" id="3653414">.</span><span class="ident" id="3653415">Reader</span><span class="op" id="3653421">,</span>&nbsp;<span class="ident" id="3653423">priv</span>&nbsp;<span class="keyword" id="3653428">interface</span><span class="op" id="3653437">{</span><span class="op" id="3653438">}</span><span class="op" id="3653439">,</span>&nbsp;<span class="ident" id="3653441">revokedCerts</span>&nbsp;<span class="op" id="3653454">[</span><span class="op" id="3653455">]</span><span class="ident" id="3653456">pkix</span><span class="op" id="3653460">.</span><span class="ident" id="3653461">RevokedCertificate</span><span class="op" id="3653479">,</span>&nbsp;<span class="ident" id="3653481">now</span><span class="op" id="3653484">,</span>&nbsp;<span class="ident" id="3653486">expiry</span>&nbsp;<span class="ident" id="3653493">time</span><span class="op" id="3653497">.</span><span class="ident" id="3653498">Time</span><span class="op" id="3653502">)</span>&nbsp;<span class="op" id="3653504">(</span><span class="ident" id="3653505">crlBytes</span>&nbsp;<span class="op" id="3653514">[</span><span class="op" id="3653515">]</span><span class="builtintype" id="3653516">byte</span><span class="op" id="3653520">,</span>&nbsp;<span class="ident" id="3653522">err</span>&nbsp;<span class="builtintype" id="3653526">error</span><span class="op" id="3653531">)</span>&nbsp;<span class="op" id="3653533">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653536">rsaPriv</span><span class="op" id="3653543">,</span>&nbsp;<span class="ident" id="3653545">ok</span>&nbsp;<span class="op" id="3653548">:=</span>&nbsp;<span class="ident" id="3653551">priv</span><span class="op" id="3653555">.</span><span class="op" id="3653556">(</span><span class="op" id="3653557">*</span><span class="ident" id="3653558">rsa</span><span class="op" id="3653561">.</span><span class="ident" id="3653562">PrivateKey</span><span class="op" id="3653572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653575">if</span>&nbsp;<span class="op" id="3653578">!</span><span class="ident" id="3653579">ok</span>&nbsp;<span class="op" id="3653582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653586">return</span>&nbsp;<span class="ident" id="3653593">nil</span><span class="op" id="3653596">,</span>&nbsp;<span class="ident" id="3653598">errors</span><span class="op" id="3653604">.</span><span class="ident" id="3653605">New</span><span class="op" id="3653608">(</span><span class="string" id="3653609">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3653651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653657">tbsCertList</span>&nbsp;<span class="op" id="3653669">:=</span>&nbsp;<span class="ident" id="3653672">pkix</span><span class="op" id="3653676">.</span><span class="ident" id="3653677">TBSCertificateList</span><span class="op" id="3653695">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653699">Version</span><span class="op" id="3653706">:</span>&nbsp;<span class="num" id="3653708">2</span><span class="op" id="3653709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653713">Signature</span><span class="op" id="3653722">:</span>&nbsp;<span class="ident" id="3653724">pkix</span><span class="op" id="3653728">.</span><span class="ident" id="3653729">AlgorithmIdentifier</span><span class="op" id="3653748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653753">Algorithm</span><span class="op" id="3653762">:</span>&nbsp;<span class="ident" id="3653764">oidSignatureSHA1WithRSA</span><span class="op" id="3653787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653791">}</span><span class="op" id="3653792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653796">Issuer</span><span class="op" id="3653802">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653817">c</span><span class="op" id="3653818">.</span><span class="ident" id="3653819">Subject</span><span class="op" id="3653826">.</span><span class="ident" id="3653827">ToRDNSequence</span><span class="op" id="3653840">(</span><span class="op" id="3653841">)</span><span class="op" id="3653842">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653846">ThisUpdate</span><span class="op" id="3653856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653867">now</span><span class="op" id="3653870">.</span><span class="ident" id="3653871">UTC</span><span class="op" id="3653874">(</span><span class="op" id="3653875">)</span><span class="op" id="3653876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653880">NextUpdate</span><span class="op" id="3653890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653901">expiry</span><span class="op" id="3653907">.</span><span class="ident" id="3653908">UTC</span><span class="op" id="3653911">(</span><span class="op" id="3653912">)</span><span class="op" id="3653913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653917">RevokedCertificates</span><span class="op" id="3653936">:</span>&nbsp;<span class="ident" id="3653938">revokedCerts</span><span class="op" id="3653950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653957">tbsCertListContents</span><span class="op" id="3653976">,</span>&nbsp;<span class="ident" id="3653978">err</span>&nbsp;<span class="op" id="3653982">:=</span>&nbsp;<span class="ident" id="3653985">asn1</span><span class="op" id="3653989">.</span><span class="ident" id="3653990">Marshal</span><span class="op" id="3653997">(</span><span class="ident" id="3653998">tbsCertList</span><span class="op" id="3654009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654012">if</span>&nbsp;<span class="ident" id="3654015">err</span>&nbsp;<span class="op" id="3654019">!=</span>&nbsp;<span class="ident" id="3654022">nil</span>&nbsp;<span class="op" id="3654026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654030">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654042">h</span>&nbsp;<span class="op" id="3654044">:=</span>&nbsp;<span class="ident" id="3654047">sha1</span><span class="op" id="3654051">.</span><span class="ident" id="3654052">New</span><span class="op" id="3654055">(</span><span class="op" id="3654056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654059">h</span><span class="op" id="3654060">.</span><span class="ident" id="3654061">Write</span><span class="op" id="3654066">(</span><span class="ident" id="3654067">tbsCertListContents</span><span class="op" id="3654086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654089">digest</span>&nbsp;<span class="op" id="3654096">:=</span>&nbsp;<span class="ident" id="3654099">h</span><span class="op" id="3654100">.</span><span class="ident" id="3654101">Sum</span><span class="op" id="3654104">(</span><span class="ident" id="3654105">nil</span><span class="op" id="3654108">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654112">signature</span><span class="op" id="3654121">,</span>&nbsp;<span class="ident" id="3654123">err</span>&nbsp;<span class="op" id="3654127">:=</span>&nbsp;<span class="ident" id="3654130">rsa</span><span class="op" id="3654133">.</span><span class="ident" id="3654134">SignPKCS1v15</span><span class="op" id="3654146">(</span><span class="ident" id="3654147">rand</span><span class="op" id="3654151">,</span>&nbsp;<span class="ident" id="3654153">rsaPriv</span><span class="op" id="3654160">,</span>&nbsp;<span class="ident" id="3654162">crypto</span><span class="op" id="3654168">.</span><span class="ident" id="3654169">SHA1</span><span class="op" id="3654173">,</span>&nbsp;<span class="ident" id="3654175">digest</span><span class="op" id="3654181">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654184">if</span>&nbsp;<span class="ident" id="3654187">err</span>&nbsp;<span class="op" id="3654191">!=</span>&nbsp;<span class="ident" id="3654194">nil</span>&nbsp;<span class="op" id="3654198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654202">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654214">return</span>&nbsp;<span class="ident" id="3654221">asn1</span><span class="op" id="3654225">.</span><span class="ident" id="3654226">Marshal</span><span class="op" id="3654233">(</span><span class="ident" id="3654234">pkix</span><span class="op" id="3654238">.</span><span class="ident" id="3654239">CertificateList</span><span class="op" id="3654254">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654258">TBSCertList</span><span class="op" id="3654269">:</span>&nbsp;<span class="ident" id="3654271">tbsCertList</span><span class="op" id="3654282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654286">SignatureAlgorithm</span><span class="op" id="3654304">:</span>&nbsp;<span class="ident" id="3654306">pkix</span><span class="op" id="3654310">.</span><span class="ident" id="3654311">AlgorithmIdentifier</span><span class="op" id="3654330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654335">Algorithm</span><span class="op" id="3654344">:</span>&nbsp;<span class="ident" id="3654346">oidSignatureSHA1WithRSA</span><span class="op" id="3654369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654373">}</span><span class="op" id="3654374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654378">SignatureValue</span><span class="op" id="3654392">:</span>&nbsp;<span class="ident" id="3654394">asn1</span><span class="op" id="3654398">.</span><span class="ident" id="3654399">BitString</span><span class="op" id="3654408">{</span><span class="ident" id="3654409">Bytes</span><span class="op" id="3654414">:</span>&nbsp;<span class="ident" id="3654416">signature</span><span class="op" id="3654425">,</span>&nbsp;<span class="ident" id="3654427">BitLength</span><span class="op" id="3654436">:</span>&nbsp;<span class="builtinfunc" id="3654438">len</span><span class="op" id="3654441">(</span><span class="ident" id="3654442">signature</span><span class="op" id="3654451">)</span>&nbsp;<span class="op" id="3654453">*</span>&nbsp;<span class="num" id="3654455">8</span><span class="op" id="3654456">}</span><span class="op" id="3654457">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654460">}</span><span class="op" id="3654461">)</span><br>
<span class="lineno"></span><span class="op" id="3654463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3654466">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3654542">type</span>&nbsp;<span class="ident" id="3654547">CertificateRequest</span>&nbsp;<span class="keyword" id="3654566">struct</span>&nbsp;<span class="op" id="3654573">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654576">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654601">[</span><span class="op" id="3654602">]</span><span class="builtintype" id="3654603">byte</span>&nbsp;<span class="comment" id="3654608">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654681">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="3654706">[</span><span class="op" id="3654707">]</span><span class="builtintype" id="3654708">byte</span>&nbsp;<span class="comment" id="3654713">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654773">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="3654798">[</span><span class="op" id="3654799">]</span><span class="builtintype" id="3654800">byte</span>&nbsp;<span class="comment" id="3654805">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654843">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654868">[</span><span class="op" id="3654869">]</span><span class="builtintype" id="3654870">byte</span>&nbsp;<span class="comment" id="3654875">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654901">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3654920">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654925">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654944">[</span><span class="op" id="3654945">]</span><span class="builtintype" id="3654946">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654952">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3654971">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654992">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3655011">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655031">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655050">interface</span><span class="op" id="3655059">{</span><span class="op" id="3655060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655064">Subject</span>&nbsp;<span class="ident" id="3655072">pkix</span><span class="op" id="3655076">.</span><span class="ident" id="3655077">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655084">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655139">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655204">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655234">Attributes</span>&nbsp;<span class="op" id="3655245">[</span><span class="op" id="3655246">]</span><span class="ident" id="3655247">pkix</span><span class="op" id="3655251">.</span><span class="ident" id="3655252">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655279">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655349">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655415">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655428">Extensions</span>&nbsp;<span class="op" id="3655439">[</span><span class="op" id="3655440">]</span><span class="ident" id="3655441">pkix</span><span class="op" id="3655445">.</span><span class="ident" id="3655446">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655458">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655526">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655597">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655665">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655705">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655709">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655779">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655795">ExtraExtensions</span>&nbsp;<span class="op" id="3655811">[</span><span class="op" id="3655812">]</span><span class="ident" id="3655813">pkix</span><span class="op" id="3655817">.</span><span class="ident" id="3655818">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3655830">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655865">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655880">[</span><span class="op" id="3655881">]</span><span class="builtintype" id="3655882">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655890">EmailAddresses</span>&nbsp;<span class="op" id="3655905">[</span><span class="op" id="3655906">]</span><span class="builtintype" id="3655907">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655915">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655930">[</span><span class="op" id="3655931">]</span><span class="ident" id="3655932">net</span><span class="op" id="3655935">.</span><span class="ident" id="3655936">IP</span><br>
<span class="lineno"></span><span class="op" id="3655939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3655942">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="3656011">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3656050">type</span>&nbsp;<span class="ident" id="3656055">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="3656077">struct</span>&nbsp;<span class="op" id="3656084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656087">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656098">asn1</span><span class="op" id="3656102">.</span><span class="ident" id="3656103">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656115">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3656126">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656131">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656142">asn1</span><span class="op" id="3656146">.</span><span class="ident" id="3656147">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656157">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="3656168">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656183">Attributes</span>&nbsp;<span class="op" id="3656194">[</span><span class="op" id="3656195">]</span><span class="ident" id="3656196">pkix</span><span class="op" id="3656200">.</span><span class="ident" id="3656201">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="3656226">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3656241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="3656244">type</span>&nbsp;<span class="ident" id="3656249">certificateRequest</span>&nbsp;<span class="keyword" id="3656268">struct</span>&nbsp;<span class="op" id="3656275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656278">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656297">asn1</span><span class="op" id="3656301">.</span><span class="ident" id="3656302">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656314">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656333">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656356">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3656375">pkix</span><span class="op" id="3656379">.</span><span class="ident" id="3656380">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656401">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656420">asn1</span><span class="op" id="3656424">.</span><span class="ident" id="3656425">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="3656435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3656438">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="3656516">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="3656540">var</span>&nbsp;<span class="ident" id="3656544">oidExtensionRequest</span>&nbsp;<span class="op" id="3656564">=</span>&nbsp;<span class="ident" id="3656566">asn1</span><span class="op" id="3656570">.</span><span class="ident" id="3656571">ObjectIdentifier</span><span class="op" id="3656587">{</span><span class="num" id="3656588">1</span><span class="op" id="3656589">,</span>&nbsp;<span class="num" id="3656591">2</span><span class="op" id="3656592">,</span>&nbsp;<span class="num" id="3656594">840</span><span class="op" id="3656597">,</span>&nbsp;<span class="num" id="3656599">113549</span><span class="op" id="3656605">,</span>&nbsp;<span class="num" id="3656607">1</span><span class="op" id="3656608">,</span>&nbsp;<span class="num" id="3656610">9</span><span class="op" id="3656611">,</span>&nbsp;<span class="num" id="3656613">14</span><span class="op" id="3656615">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="3656618">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3656697">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="3656761">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="3656839">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="3656892">//</span><br>
<span class="lineno"></span><span class="comment" id="3656895">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="3656961">//</span><br>
<span class="lineno"></span><span class="comment" id="3656964">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="3657032">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="3657056">func</span>&nbsp;<span class="ident" id="3657061">CreateCertificateRequest</span><span class="op" id="3657085">(</span><span class="ident" id="3657086">rand</span>&nbsp;<span class="ident" id="3657091">io</span><span class="op" id="3657093">.</span><span class="ident" id="3657094">Reader</span><span class="op" id="3657100">,</span>&nbsp;<span class="ident" id="3657102">template</span>&nbsp;<span class="op" id="3657111">*</span><span class="ident" id="3657112">CertificateRequest</span><span class="op" id="3657130">,</span>&nbsp;<span class="ident" id="3657132">priv</span>&nbsp;<span class="keyword" id="3657137">interface</span><span class="op" id="3657146">{</span><span class="op" id="3657147">}</span><span class="op" id="3657148">)</span>&nbsp;<span class="op" id="3657150">(</span><span class="ident" id="3657151">csr</span>&nbsp;<span class="op" id="3657155">[</span><span class="op" id="3657156">]</span><span class="builtintype" id="3657157">byte</span><span class="op" id="3657161">,</span>&nbsp;<span class="ident" id="3657163">err</span>&nbsp;<span class="builtintype" id="3657167">error</span><span class="op" id="3657172">)</span>&nbsp;<span class="op" id="3657174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657177">hashFunc</span><span class="op" id="3657185">,</span>&nbsp;<span class="ident" id="3657187">sigAlgo</span><span class="op" id="3657194">,</span>&nbsp;<span class="ident" id="3657196">err</span>&nbsp;<span class="op" id="3657200">:=</span>&nbsp;<span class="ident" id="3657203">signingParamsForPrivateKey</span><span class="op" id="3657229">(</span><span class="ident" id="3657230">priv</span><span class="op" id="3657234">,</span>&nbsp;<span class="ident" id="3657236">template</span><span class="op" id="3657244">.</span><span class="ident" id="3657245">SignatureAlgorithm</span><span class="op" id="3657263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657266">if</span>&nbsp;<span class="ident" id="3657269">err</span>&nbsp;<span class="op" id="3657273">!=</span>&nbsp;<span class="ident" id="3657276">nil</span>&nbsp;<span class="op" id="3657280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657284">return</span>&nbsp;<span class="ident" id="3657291">nil</span><span class="op" id="3657294">,</span>&nbsp;<span class="ident" id="3657296">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657301">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657305">var</span>&nbsp;<span class="ident" id="3657309">publicKeyBytes</span>&nbsp;<span class="op" id="3657324">[</span><span class="op" id="3657325">]</span><span class="builtintype" id="3657326">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657332">var</span>&nbsp;<span class="ident" id="3657336">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3657355">pkix</span><span class="op" id="3657359">.</span><span class="ident" id="3657360">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657382">switch</span>&nbsp;<span class="ident" id="3657389">priv</span>&nbsp;<span class="op" id="3657394">:=</span>&nbsp;<span class="ident" id="3657397">priv</span><span class="op" id="3657401">.</span><span class="op" id="3657402">(</span><span class="keyword" id="3657403">type</span><span class="op" id="3657407">)</span>&nbsp;<span class="op" id="3657409">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657412">case</span>&nbsp;<span class="op" id="3657417">*</span><span class="ident" id="3657418">rsa</span><span class="op" id="3657421">.</span><span class="ident" id="3657422">PrivateKey</span><span class="op" id="3657432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657436">publicKeyBytes</span><span class="op" id="3657450">,</span>&nbsp;<span class="ident" id="3657452">publicKeyAlgorithm</span><span class="op" id="3657470">,</span>&nbsp;<span class="ident" id="3657472">err</span>&nbsp;<span class="op" id="3657476">=</span>&nbsp;<span class="ident" id="3657478">marshalPublicKey</span><span class="op" id="3657494">(</span><span class="op" id="3657495">&amp;</span><span class="ident" id="3657496">priv</span><span class="op" id="3657500">.</span><span class="ident" id="3657501">PublicKey</span><span class="op" id="3657510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657513">case</span>&nbsp;<span class="op" id="3657518">*</span><span class="ident" id="3657519">ecdsa</span><span class="op" id="3657524">.</span><span class="ident" id="3657525">PrivateKey</span><span class="op" id="3657535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657539">publicKeyBytes</span><span class="op" id="3657553">,</span>&nbsp;<span class="ident" id="3657555">publicKeyAlgorithm</span><span class="op" id="3657573">,</span>&nbsp;<span class="ident" id="3657575">err</span>&nbsp;<span class="op" id="3657579">=</span>&nbsp;<span class="ident" id="3657581">marshalPublicKey</span><span class="op" id="3657597">(</span><span class="op" id="3657598">&amp;</span><span class="ident" id="3657599">priv</span><span class="op" id="3657603">.</span><span class="ident" id="3657604">PublicKey</span><span class="op" id="3657613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657616">default</span><span class="op" id="3657623">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3657627">panic</span><span class="op" id="3657632">(</span><span class="string" id="3657633">&#34;internal&nbsp;error&#34;</span><span class="op" id="3657649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657656">if</span>&nbsp;<span class="ident" id="3657659">err</span>&nbsp;<span class="op" id="3657663">!=</span>&nbsp;<span class="ident" id="3657666">nil</span>&nbsp;<span class="op" id="3657670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657674">return</span>&nbsp;<span class="ident" id="3657681">nil</span><span class="op" id="3657684">,</span>&nbsp;<span class="ident" id="3657686">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657695">var</span>&nbsp;<span class="ident" id="3657699">extensions</span>&nbsp;<span class="op" id="3657710">[</span><span class="op" id="3657711">]</span><span class="ident" id="3657712">pkix</span><span class="op" id="3657716">.</span><span class="ident" id="3657717">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657729">if</span>&nbsp;<span class="op" id="3657732">(</span><span class="builtinfunc" id="3657733">len</span><span class="op" id="3657736">(</span><span class="ident" id="3657737">template</span><span class="op" id="3657745">.</span><span class="ident" id="3657746">DNSNames</span><span class="op" id="3657754">)</span>&nbsp;<span class="op" id="3657756">&gt;</span>&nbsp;<span class="num" id="3657758">0</span>&nbsp;<span class="op" id="3657760">||</span>&nbsp;<span class="builtinfunc" id="3657763">len</span><span class="op" id="3657766">(</span><span class="ident" id="3657767">template</span><span class="op" id="3657775">.</span><span class="ident" id="3657776">EmailAddresses</span><span class="op" id="3657790">)</span>&nbsp;<span class="op" id="3657792">&gt;</span>&nbsp;<span class="num" id="3657794">0</span>&nbsp;<span class="op" id="3657796">||</span>&nbsp;<span class="builtinfunc" id="3657799">len</span><span class="op" id="3657802">(</span><span class="ident" id="3657803">template</span><span class="op" id="3657811">.</span><span class="ident" id="3657812">IPAddresses</span><span class="op" id="3657823">)</span>&nbsp;<span class="op" id="3657825">&gt;</span>&nbsp;<span class="num" id="3657827">0</span><span class="op" id="3657828">)</span>&nbsp;<span class="op" id="3657830">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657835">!</span><span class="ident" id="3657836">oidInExtensions</span><span class="op" id="3657851">(</span><span class="ident" id="3657852">oidExtensionSubjectAltName</span><span class="op" id="3657878">,</span>&nbsp;<span class="ident" id="3657880">template</span><span class="op" id="3657888">.</span><span class="ident" id="3657889">ExtraExtensions</span><span class="op" id="3657904">)</span>&nbsp;<span class="op" id="3657906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657910">sanBytes</span><span class="op" id="3657918">,</span>&nbsp;<span class="ident" id="3657920">err</span>&nbsp;<span class="op" id="3657924">:=</span>&nbsp;<span class="ident" id="3657927">marshalSANs</span><span class="op" id="3657938">(</span><span class="ident" id="3657939">template</span><span class="op" id="3657947">.</span><span class="ident" id="3657948">DNSNames</span><span class="op" id="3657956">,</span>&nbsp;<span class="ident" id="3657958">template</span><span class="op" id="3657966">.</span><span class="ident" id="3657967">EmailAddresses</span><span class="op" id="3657981">,</span>&nbsp;<span class="ident" id="3657983">template</span><span class="op" id="3657991">.</span><span class="ident" id="3657992">IPAddresses</span><span class="op" id="3658003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658007">if</span>&nbsp;<span class="ident" id="3658010">err</span>&nbsp;<span class="op" id="3658014">!=</span>&nbsp;<span class="ident" id="3658017">nil</span>&nbsp;<span class="op" id="3658021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658026">return</span>&nbsp;<span class="ident" id="3658033">nil</span><span class="op" id="3658036">,</span>&nbsp;<span class="ident" id="3658038">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658044">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658049">extensions</span>&nbsp;<span class="op" id="3658060">=</span>&nbsp;<span class="builtinfunc" id="3658062">append</span><span class="op" id="3658068">(</span><span class="ident" id="3658069">extensions</span><span class="op" id="3658079">,</span>&nbsp;<span class="ident" id="3658081">pkix</span><span class="op" id="3658085">.</span><span class="ident" id="3658086">Extension</span><span class="op" id="3658095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658100">Id</span><span class="op" id="3658102">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3658107">oidExtensionSubjectAltName</span><span class="op" id="3658133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658138">Value</span><span class="op" id="3658143">:</span>&nbsp;<span class="ident" id="3658145">sanBytes</span><span class="op" id="3658153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658157">}</span><span class="op" id="3658158">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658165">extensions</span>&nbsp;<span class="op" id="3658176">=</span>&nbsp;<span class="builtinfunc" id="3658178">append</span><span class="op" id="3658184">(</span><span class="ident" id="3658185">extensions</span><span class="op" id="3658195">,</span>&nbsp;<span class="ident" id="3658197">template</span><span class="op" id="3658205">.</span><span class="ident" id="3658206">ExtraExtensions</span><span class="op" id="3658221">...</span><span class="op" id="3658224">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658228">var</span>&nbsp;<span class="ident" id="3658232">attributes</span>&nbsp;<span class="op" id="3658243">[</span><span class="op" id="3658244">]</span><span class="ident" id="3658245">pkix</span><span class="op" id="3658249">.</span><span class="ident" id="3658250">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658276">attributes</span>&nbsp;<span class="op" id="3658287">=</span>&nbsp;<span class="builtinfunc" id="3658289">append</span><span class="op" id="3658295">(</span><span class="ident" id="3658296">attributes</span><span class="op" id="3658306">,</span>&nbsp;<span class="ident" id="3658308">template</span><span class="op" id="3658316">.</span><span class="ident" id="3658317">Attributes</span><span class="op" id="3658327">...</span><span class="op" id="3658330">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658334">if</span>&nbsp;<span class="builtinfunc" id="3658337">len</span><span class="op" id="3658340">(</span><span class="ident" id="3658341">extensions</span><span class="op" id="3658351">)</span>&nbsp;<span class="op" id="3658353">&gt;</span>&nbsp;<span class="num" id="3658355">0</span>&nbsp;<span class="op" id="3658357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658361">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658422">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658468">specifiedExtensions</span>&nbsp;<span class="op" id="3658488">:=</span>&nbsp;<span class="builtinfunc" id="3658491">make</span><span class="op" id="3658495">(</span><span class="keyword" id="3658496">map</span><span class="op" id="3658499">[</span><span class="builtintype" id="3658500">string</span><span class="op" id="3658506">]</span><span class="builtintype" id="3658507">bool</span><span class="op" id="3658511">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658516">for</span>&nbsp;<span class="ident" id="3658520">_</span><span class="op" id="3658521">,</span>&nbsp;<span class="ident" id="3658523">atvSet</span>&nbsp;<span class="op" id="3658530">:=</span>&nbsp;<span class="keyword" id="3658533">range</span>&nbsp;<span class="ident" id="3658539">template</span><span class="op" id="3658547">.</span><span class="ident" id="3658548">Attributes</span>&nbsp;<span class="op" id="3658559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658564">if</span>&nbsp;<span class="op" id="3658567">!</span><span class="ident" id="3658568">atvSet</span><span class="op" id="3658574">.</span><span class="ident" id="3658575">Type</span><span class="op" id="3658579">.</span><span class="ident" id="3658580">Equal</span><span class="op" id="3658585">(</span><span class="ident" id="3658586">oidExtensionRequest</span><span class="op" id="3658605">)</span>&nbsp;<span class="op" id="3658607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658613">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658631">for</span>&nbsp;<span class="ident" id="3658635">_</span><span class="op" id="3658636">,</span>&nbsp;<span class="ident" id="3658638">atvs</span>&nbsp;<span class="op" id="3658643">:=</span>&nbsp;<span class="keyword" id="3658646">range</span>&nbsp;<span class="ident" id="3658652">atvSet</span><span class="op" id="3658658">.</span><span class="ident" id="3658659">Value</span>&nbsp;<span class="op" id="3658665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658671">for</span>&nbsp;<span class="ident" id="3658675">_</span><span class="op" id="3658676">,</span>&nbsp;<span class="ident" id="3658678">atv</span>&nbsp;<span class="op" id="3658682">:=</span>&nbsp;<span class="keyword" id="3658685">range</span>&nbsp;<span class="ident" id="3658691">atvs</span>&nbsp;<span class="op" id="3658696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658703">specifiedExtensions</span><span class="op" id="3658722">[</span><span class="ident" id="3658723">atv</span><span class="op" id="3658726">.</span><span class="ident" id="3658727">Type</span><span class="op" id="3658731">.</span><span class="ident" id="3658732">String</span><span class="op" id="3658738">(</span><span class="op" id="3658739">)</span><span class="op" id="3658740">]</span>&nbsp;<span class="op" id="3658742">=</span>&nbsp;<span class="builtintype" id="3658744">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658767">atvs</span>&nbsp;<span class="op" id="3658772">:=</span>&nbsp;<span class="builtinfunc" id="3658775">make</span><span class="op" id="3658779">(</span><span class="op" id="3658780">[</span><span class="op" id="3658781">]</span><span class="ident" id="3658782">pkix</span><span class="op" id="3658786">.</span><span class="ident" id="3658787">AttributeTypeAndValue</span><span class="op" id="3658808">,</span>&nbsp;<span class="num" id="3658810">0</span><span class="op" id="3658811">,</span>&nbsp;<span class="builtinfunc" id="3658813">len</span><span class="op" id="3658816">(</span><span class="ident" id="3658817">extensions</span><span class="op" id="3658827">)</span><span class="op" id="3658828">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658832">for</span>&nbsp;<span class="ident" id="3658836">_</span><span class="op" id="3658837">,</span>&nbsp;<span class="ident" id="3658839">e</span>&nbsp;<span class="op" id="3658841">:=</span>&nbsp;<span class="keyword" id="3658844">range</span>&nbsp;<span class="ident" id="3658850">extensions</span>&nbsp;<span class="op" id="3658861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658866">if</span>&nbsp;<span class="ident" id="3658869">specifiedExtensions</span><span class="op" id="3658888">[</span><span class="ident" id="3658889">e</span><span class="op" id="3658890">.</span><span class="ident" id="3658891">Id</span><span class="op" id="3658893">.</span><span class="ident" id="3658894">String</span><span class="op" id="3658900">(</span><span class="op" id="3658901">)</span><span class="op" id="3658902">]</span>&nbsp;<span class="op" id="3658904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658910">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3658958">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659003">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659021">atvs</span>&nbsp;<span class="op" id="3659026">=</span>&nbsp;<span class="builtinfunc" id="3659028">append</span><span class="op" id="3659034">(</span><span class="ident" id="3659035">atvs</span><span class="op" id="3659039">,</span>&nbsp;<span class="ident" id="3659041">pkix</span><span class="op" id="3659045">.</span><span class="ident" id="3659046">AttributeTypeAndValue</span><span class="op" id="3659067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659073">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659130">Type</span><span class="op" id="3659134">:</span>&nbsp;&nbsp;<span class="ident" id="3659137">e</span><span class="op" id="3659138">.</span><span class="ident" id="3659139">Id</span><span class="op" id="3659141">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659147">Value</span><span class="op" id="3659152">:</span>&nbsp;<span class="ident" id="3659154">e</span><span class="op" id="3659155">.</span><span class="ident" id="3659156">Value</span><span class="op" id="3659161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659166">}</span><span class="op" id="3659167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659176">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659241">appended</span>&nbsp;<span class="op" id="3659250">:=</span>&nbsp;<span class="builtintype" id="3659253">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659261">for</span>&nbsp;<span class="ident" id="3659265">_</span><span class="op" id="3659266">,</span>&nbsp;<span class="ident" id="3659268">atvSet</span>&nbsp;<span class="op" id="3659275">:=</span>&nbsp;<span class="keyword" id="3659278">range</span>&nbsp;<span class="ident" id="3659284">attributes</span>&nbsp;<span class="op" id="3659295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659300">if</span>&nbsp;<span class="op" id="3659303">!</span><span class="ident" id="3659304">atvSet</span><span class="op" id="3659310">.</span><span class="ident" id="3659311">Type</span><span class="op" id="3659315">.</span><span class="ident" id="3659316">Equal</span><span class="op" id="3659321">(</span><span class="ident" id="3659322">oidExtensionRequest</span><span class="op" id="3659341">)</span>&nbsp;<span class="op" id="3659343">||</span>&nbsp;<span class="builtinfunc" id="3659346">len</span><span class="op" id="3659349">(</span><span class="ident" id="3659350">atvSet</span><span class="op" id="3659356">.</span><span class="ident" id="3659357">Value</span><span class="op" id="3659362">)</span>&nbsp;<span class="op" id="3659364">==</span>&nbsp;<span class="num" id="3659367">0</span>&nbsp;<span class="op" id="3659369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659375">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659387">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659393">atvSet</span><span class="op" id="3659399">.</span><span class="ident" id="3659400">Value</span><span class="op" id="3659405">[</span><span class="num" id="3659406">0</span><span class="op" id="3659407">]</span>&nbsp;<span class="op" id="3659409">=</span>&nbsp;<span class="builtinfunc" id="3659411">append</span><span class="op" id="3659417">(</span><span class="ident" id="3659418">atvSet</span><span class="op" id="3659424">.</span><span class="ident" id="3659425">Value</span><span class="op" id="3659430">[</span><span class="num" id="3659431">0</span><span class="op" id="3659432">]</span><span class="op" id="3659433">,</span>&nbsp;<span class="ident" id="3659435">atvs</span><span class="op" id="3659439">...</span><span class="op" id="3659442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659447">appended</span>&nbsp;<span class="op" id="3659456">=</span>&nbsp;<span class="builtintype" id="3659458">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659466">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659474">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659479">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659535">if</span>&nbsp;<span class="op" id="3659538">!</span><span class="ident" id="3659539">appended</span>&nbsp;<span class="op" id="3659548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659553">attributes</span>&nbsp;<span class="op" id="3659564">=</span>&nbsp;<span class="builtinfunc" id="3659566">append</span><span class="op" id="3659572">(</span><span class="ident" id="3659573">attributes</span><span class="op" id="3659583">,</span>&nbsp;<span class="ident" id="3659585">pkix</span><span class="op" id="3659589">.</span><span class="ident" id="3659590">AttributeTypeAndValueSET</span><span class="op" id="3659614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659620">Type</span><span class="op" id="3659624">:</span>&nbsp;<span class="ident" id="3659626">oidExtensionRequest</span><span class="op" id="3659645">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659651">Value</span><span class="op" id="3659656">:</span>&nbsp;<span class="op" id="3659658">[</span><span class="op" id="3659659">]</span><span class="op" id="3659660">[</span><span class="op" id="3659661">]</span><span class="ident" id="3659662">pkix</span><span class="op" id="3659666">.</span><span class="ident" id="3659667">AttributeTypeAndValue</span><span class="op" id="3659688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659695">atvs</span><span class="op" id="3659699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659705">}</span><span class="op" id="3659706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659711">}</span><span class="op" id="3659712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659716">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659723">asn1Subject</span>&nbsp;<span class="op" id="3659735">:=</span>&nbsp;<span class="ident" id="3659738">template</span><span class="op" id="3659746">.</span><span class="ident" id="3659747">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659759">if</span>&nbsp;<span class="builtinfunc" id="3659762">len</span><span class="op" id="3659765">(</span><span class="ident" id="3659766">asn1Subject</span><span class="op" id="3659777">)</span>&nbsp;<span class="op" id="3659779">==</span>&nbsp;<span class="num" id="3659782">0</span>&nbsp;<span class="op" id="3659784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659788">asn1Subject</span><span class="op" id="3659799">,</span>&nbsp;<span class="ident" id="3659801">err</span>&nbsp;<span class="op" id="3659805">=</span>&nbsp;<span class="ident" id="3659807">asn1</span><span class="op" id="3659811">.</span><span class="ident" id="3659812">Marshal</span><span class="op" id="3659819">(</span><span class="ident" id="3659820">template</span><span class="op" id="3659828">.</span><span class="ident" id="3659829">Subject</span><span class="op" id="3659836">.</span><span class="ident" id="3659837">ToRDNSequence</span><span class="op" id="3659850">(</span><span class="op" id="3659851">)</span><span class="op" id="3659852">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659856">if</span>&nbsp;<span class="ident" id="3659859">err</span>&nbsp;<span class="op" id="3659863">!=</span>&nbsp;<span class="ident" id="3659866">nil</span>&nbsp;<span class="op" id="3659870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659875">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659891">tbsCSR</span>&nbsp;<span class="op" id="3659898">:=</span>&nbsp;<span class="ident" id="3659901">tbsCertificateRequest</span><span class="op" id="3659922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659926">Version</span><span class="op" id="3659933">:</span>&nbsp;<span class="num" id="3659935">0</span><span class="op" id="3659936">,</span>&nbsp;<span class="comment" id="3659938">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659962">Subject</span><span class="op" id="3659969">:</span>&nbsp;<span class="ident" id="3659971">asn1</span><span class="op" id="3659975">.</span><span class="ident" id="3659976">RawValue</span><span class="op" id="3659984">{</span><span class="ident" id="3659985">FullBytes</span><span class="op" id="3659994">:</span>&nbsp;<span class="ident" id="3659996">asn1Subject</span><span class="op" id="3660007">}</span><span class="op" id="3660008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660012">PublicKey</span><span class="op" id="3660021">:</span>&nbsp;<span class="ident" id="3660023">publicKeyInfo</span><span class="op" id="3660036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660041">Algorithm</span><span class="op" id="3660050">:</span>&nbsp;<span class="ident" id="3660052">publicKeyAlgorithm</span><span class="op" id="3660070">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660075">PublicKey</span><span class="op" id="3660084">:</span>&nbsp;<span class="ident" id="3660086">asn1</span><span class="op" id="3660090">.</span><span class="ident" id="3660091">BitString</span><span class="op" id="3660100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660106">Bytes</span><span class="op" id="3660111">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660117">publicKeyBytes</span><span class="op" id="3660131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660137">BitLength</span><span class="op" id="3660146">:</span>&nbsp;<span class="builtinfunc" id="3660148">len</span><span class="op" id="3660151">(</span><span class="ident" id="3660152">publicKeyBytes</span><span class="op" id="3660166">)</span>&nbsp;<span class="op" id="3660168">*</span>&nbsp;<span class="num" id="3660170">8</span><span class="op" id="3660171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660176">}</span><span class="op" id="3660177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660181">}</span><span class="op" id="3660182">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660186">Attributes</span><span class="op" id="3660196">:</span>&nbsp;<span class="ident" id="3660198">attributes</span><span class="op" id="3660208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660215">tbsCSRContents</span><span class="op" id="3660229">,</span>&nbsp;<span class="ident" id="3660231">err</span>&nbsp;<span class="op" id="3660235">:=</span>&nbsp;<span class="ident" id="3660238">asn1</span><span class="op" id="3660242">.</span><span class="ident" id="3660243">Marshal</span><span class="op" id="3660250">(</span><span class="ident" id="3660251">tbsCSR</span><span class="op" id="3660257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660260">if</span>&nbsp;<span class="ident" id="3660263">err</span>&nbsp;<span class="op" id="3660267">!=</span>&nbsp;<span class="ident" id="3660270">nil</span>&nbsp;<span class="op" id="3660274">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660278">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660289">tbsCSR</span><span class="op" id="3660295">.</span><span class="ident" id="3660296">Raw</span>&nbsp;<span class="op" id="3660300">=</span>&nbsp;<span class="ident" id="3660302">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660319">h</span>&nbsp;<span class="op" id="3660321">:=</span>&nbsp;<span class="ident" id="3660324">hashFunc</span><span class="op" id="3660332">.</span><span class="ident" id="3660333">New</span><span class="op" id="3660336">(</span><span class="op" id="3660337">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660340">h</span><span class="op" id="3660341">.</span><span class="ident" id="3660342">Write</span><span class="op" id="3660347">(</span><span class="ident" id="3660348">tbsCSRContents</span><span class="op" id="3660362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660365">digest</span>&nbsp;<span class="op" id="3660372">:=</span>&nbsp;<span class="ident" id="3660375">h</span><span class="op" id="3660376">.</span><span class="ident" id="3660377">Sum</span><span class="op" id="3660380">(</span><span class="ident" id="3660381">nil</span><span class="op" id="3660384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660388">var</span>&nbsp;<span class="ident" id="3660392">signature</span>&nbsp;<span class="op" id="3660402">[</span><span class="op" id="3660403">]</span><span class="builtintype" id="3660404">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660410">switch</span>&nbsp;<span class="ident" id="3660417">priv</span>&nbsp;<span class="op" id="3660422">:=</span>&nbsp;<span class="ident" id="3660425">priv</span><span class="op" id="3660429">.</span><span class="op" id="3660430">(</span><span class="keyword" id="3660431">type</span><span class="op" id="3660435">)</span>&nbsp;<span class="op" id="3660437">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660440">case</span>&nbsp;<span class="op" id="3660445">*</span><span class="ident" id="3660446">rsa</span><span class="op" id="3660449">.</span><span class="ident" id="3660450">PrivateKey</span><span class="op" id="3660460">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660464">signature</span><span class="op" id="3660473">,</span>&nbsp;<span class="ident" id="3660475">err</span>&nbsp;<span class="op" id="3660479">=</span>&nbsp;<span class="ident" id="3660481">rsa</span><span class="op" id="3660484">.</span><span class="ident" id="3660485">SignPKCS1v15</span><span class="op" id="3660497">(</span><span class="ident" id="3660498">rand</span><span class="op" id="3660502">,</span>&nbsp;<span class="ident" id="3660504">priv</span><span class="op" id="3660508">,</span>&nbsp;<span class="ident" id="3660510">hashFunc</span><span class="op" id="3660518">,</span>&nbsp;<span class="ident" id="3660520">digest</span><span class="op" id="3660526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660529">case</span>&nbsp;<span class="op" id="3660534">*</span><span class="ident" id="3660535">ecdsa</span><span class="op" id="3660540">.</span><span class="ident" id="3660541">PrivateKey</span><span class="op" id="3660551">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660555">var</span>&nbsp;<span class="ident" id="3660559">r</span><span class="op" id="3660560">,</span>&nbsp;<span class="ident" id="3660562">s</span>&nbsp;<span class="op" id="3660564">*</span><span class="ident" id="3660565">big</span><span class="op" id="3660568">.</span><span class="ident" id="3660569">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660575">if</span>&nbsp;<span class="ident" id="3660578">r</span><span class="op" id="3660579">,</span>&nbsp;<span class="ident" id="3660581">s</span><span class="op" id="3660582">,</span>&nbsp;<span class="ident" id="3660584">err</span>&nbsp;<span class="op" id="3660588">=</span>&nbsp;<span class="ident" id="3660590">ecdsa</span><span class="op" id="3660595">.</span><span class="ident" id="3660596">Sign</span><span class="op" id="3660600">(</span><span class="ident" id="3660601">rand</span><span class="op" id="3660605">,</span>&nbsp;<span class="ident" id="3660607">priv</span><span class="op" id="3660611">,</span>&nbsp;<span class="ident" id="3660613">digest</span><span class="op" id="3660619">)</span><span class="op" id="3660620">;</span>&nbsp;<span class="ident" id="3660622">err</span>&nbsp;<span class="op" id="3660626">==</span>&nbsp;<span class="ident" id="3660629">nil</span>&nbsp;<span class="op" id="3660633">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660638">signature</span><span class="op" id="3660647">,</span>&nbsp;<span class="ident" id="3660649">err</span>&nbsp;<span class="op" id="3660653">=</span>&nbsp;<span class="ident" id="3660655">asn1</span><span class="op" id="3660659">.</span><span class="ident" id="3660660">Marshal</span><span class="op" id="3660667">(</span><span class="ident" id="3660668">ecdsaSignature</span><span class="op" id="3660682">{</span><span class="ident" id="3660683">r</span><span class="op" id="3660684">,</span>&nbsp;<span class="ident" id="3660686">s</span><span class="op" id="3660687">}</span><span class="op" id="3660688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660695">default</span><span class="op" id="3660702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3660706">panic</span><span class="op" id="3660711">(</span><span class="string" id="3660712">&#34;internal&nbsp;error&#34;</span><span class="op" id="3660728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660731">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660735">if</span>&nbsp;<span class="ident" id="3660738">err</span>&nbsp;<span class="op" id="3660742">!=</span>&nbsp;<span class="ident" id="3660745">nil</span>&nbsp;<span class="op" id="3660749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660753">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660765">return</span>&nbsp;<span class="ident" id="3660772">asn1</span><span class="op" id="3660776">.</span><span class="ident" id="3660777">Marshal</span><span class="op" id="3660784">(</span><span class="ident" id="3660785">certificateRequest</span><span class="op" id="3660803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660807">TBSCSR</span><span class="op" id="3660813">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660827">tbsCSR</span><span class="op" id="3660833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660837">SignatureAlgorithm</span><span class="op" id="3660855">:</span>&nbsp;<span class="ident" id="3660857">sigAlgo</span><span class="op" id="3660864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660868">SignatureValue</span><span class="op" id="3660882">:</span>&nbsp;<span class="ident" id="3660884">asn1</span><span class="op" id="3660888">.</span><span class="ident" id="3660889">BitString</span><span class="op" id="3660898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660903">Bytes</span><span class="op" id="3660908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660914">signature</span><span class="op" id="3660923">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660928">BitLength</span><span class="op" id="3660937">:</span>&nbsp;<span class="builtinfunc" id="3660939">len</span><span class="op" id="3660942">(</span><span class="ident" id="3660943">signature</span><span class="op" id="3660952">)</span>&nbsp;<span class="op" id="3660954">*</span>&nbsp;<span class="num" id="3660956">8</span><span class="op" id="3660957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660961">}</span><span class="op" id="3660962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660965">}</span><span class="op" id="3660966">)</span><br>
<span class="lineno"></span><span class="op" id="3660968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="3660971">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3661043">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3661068">func</span>&nbsp;<span class="ident" id="3661073">ParseCertificateRequest</span><span class="op" id="3661096">(</span><span class="ident" id="3661097">asn1Data</span>&nbsp;<span class="op" id="3661106">[</span><span class="op" id="3661107">]</span><span class="builtintype" id="3661108">byte</span><span class="op" id="3661112">)</span>&nbsp;<span class="op" id="3661114">(</span><span class="op" id="3661115">*</span><span class="ident" id="3661116">CertificateRequest</span><span class="op" id="3661134">,</span>&nbsp;<span class="builtintype" id="3661136">error</span><span class="op" id="3661141">)</span>&nbsp;<span class="op" id="3661143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661146">var</span>&nbsp;<span class="ident" id="3661150">csr</span>&nbsp;<span class="ident" id="3661154">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661175">rest</span><span class="op" id="3661179">,</span>&nbsp;<span class="ident" id="3661181">err</span>&nbsp;<span class="op" id="3661185">:=</span>&nbsp;<span class="ident" id="3661188">asn1</span><span class="op" id="3661192">.</span><span class="ident" id="3661193">Unmarshal</span><span class="op" id="3661202">(</span><span class="ident" id="3661203">asn1Data</span><span class="op" id="3661211">,</span>&nbsp;<span class="op" id="3661213">&amp;</span><span class="ident" id="3661214">csr</span><span class="op" id="3661217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661220">if</span>&nbsp;<span class="ident" id="3661223">err</span>&nbsp;<span class="op" id="3661227">!=</span>&nbsp;<span class="ident" id="3661230">nil</span>&nbsp;<span class="op" id="3661234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661238">return</span>&nbsp;<span class="ident" id="3661245">nil</span><span class="op" id="3661248">,</span>&nbsp;<span class="ident" id="3661250">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3661255">}</span>&nbsp;<span class="keyword" id="3661257">else</span>&nbsp;<span class="keyword" id="3661262">if</span>&nbsp;<span class="builtinfunc" id="3661265">len</span><span class="op" id="3661268">(</span><span class="ident" id="3661269">rest</span><span class="op" id="3661273">)</span>&nbsp;<span class="op" id="3661275">!=</span>&nbsp;<span class="num" id="3661278">0</span>&nbsp;<span class="op" id="3661280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661284">return</span>&nbsp;<span class="ident" id="3661291">nil</span><span class="op" id="3661294">,</span>&nbsp;<span class="ident" id="3661296">asn1</span><span class="op" id="3661300">.</span><span class="ident" id="3661301">SyntaxError</span><span class="op" id="3661312">{</span><span class="ident" id="3661313">Msg</span><span class="op" id="3661316">:</span>&nbsp;<span class="string" id="3661318">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3661333">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3661336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661340">return</span>&nbsp;<span class="ident" id="3661347">parseCertificateRequest</span><span class="op" id="3661370">(</span><span class="op" id="3661371">&amp;</span><span class="ident" id="3661372">csr</span><span class="op" id="3661375">)</span><br>
<span class="lineno"></span><span class="op" id="3661377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="3661380">func</span>&nbsp;<span class="ident" id="3661385">parseCertificateRequest</span><span class="op" id="3661408">(</span><span class="ident" id="3661409">in</span>&nbsp;<span class="op" id="3661412">*</span><span class="ident" id="3661413">certificateRequest</span><span class="op" id="3661431">)</span>&nbsp;<span class="op" id="3661433">(</span><span class="op" id="3661434">*</span><span class="ident" id="3661435">CertificateRequest</span><span class="op" id="3661453">,</span>&nbsp;<span class="builtintype" id="3661455">error</span><span class="op" id="3661460">)</span>&nbsp;<span class="op" id="3661462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661465">out</span>&nbsp;<span class="op" id="3661469">:=</span>&nbsp;<span class="op" id="3661472">&amp;</span><span class="ident" id="3661473">CertificateRequest</span><span class="op" id="3661491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661495">Raw</span><span class="op" id="3661498">:</span>&nbsp;<span class="ident" id="3661500">in</span><span class="op" id="3661502">.</span><span class="ident" id="3661503">Raw</span><span class="op" id="3661506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661510">RawTBSCertificateRequest</span><span class="op" id="3661534">:</span>&nbsp;<span class="ident" id="3661536">in</span><span class="op" id="3661538">.</span><span class="ident" id="3661539">TBSCSR</span><span class="op" id="3661545">.</span><span class="ident" id="3661546">Raw</span><span class="op" id="3661549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661553">RawSubjectPublicKeyInfo</span><span class="op" id="3661576">:</span>&nbsp;&nbsp;<span class="ident" id="3661579">in</span><span class="op" id="3661581">.</span><span class="ident" id="3661582">TBSCSR</span><span class="op" id="3661588">.</span><span class="ident" id="3661589">PublicKey</span><span class="op" id="3661598">.</span><span class="ident" id="3661599">Raw</span><span class="op" id="3661602">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661606">RawSubject</span><span class="op" id="3661616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3661632">in</span><span class="op" id="3661634">.</span><span class="ident" id="3661635">TBSCSR</span><span class="op" id="3661641">.</span><span class="ident" id="3661642">Subject</span><span class="op" id="3661649">.</span><span class="ident" id="3661650">FullBytes</span><span class="op" id="3661659">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661664">Signature</span><span class="op" id="3661673">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3661684">in</span><span class="op" id="3661686">.</span><span class="ident" id="3661687">SignatureValue</span><span class="op" id="3661701">.</span><span class="ident" id="3661702">RightAlign</span><span class="op" id="3661712">(</span><span class="op" id="3661713">)</span><span class="op" id="3661714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661718">SignatureAlgorithm</span><span class="op" id="3661736">:</span>&nbsp;<span class="ident" id="3661738">getSignatureAlgorithmFromOID</span><span class="op" id="3661766">(</span><span class="ident" id="3661767">in</span><span class="op" id="3661769">.</span><span class="ident" id="3661770">SignatureAlgorithm</span><span class="op" id="3661788">.</span><span class="ident" id="3661789">Algorithm</span><span class="op" id="3661798">)</span><span class="op" id="3661799">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661804">PublicKeyAlgorithm</span><span class="op" id="3661822">:</span>&nbsp;<span class="ident" id="3661824">getPublicKeyAlgorithmFromOID</span><span class="op" id="3661852">(</span><span class="ident" id="3661853">in</span><span class="op" id="3661855">.</span><span class="ident" id="3661856">TBSCSR</span><span class="op" id="3661862">.</span><span class="ident" id="3661863">PublicKey</span><span class="op" id="3661872">.</span><span class="ident" id="3661873">Algorithm</span><span class="op" id="3661882">.</span><span class="ident" id="3661883">Algorithm</span><span class="op" id="3661892">)</span><span class="op" id="3661893">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661898">Version</span><span class="op" id="3661905">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3661910">in</span><span class="op" id="3661912">.</span><span class="ident" id="3661913">TBSCSR</span><span class="op" id="3661919">.</span><span class="ident" id="3661920">Version</span><span class="op" id="3661927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661931">Attributes</span><span class="op" id="3661941">:</span>&nbsp;<span class="ident" id="3661943">in</span><span class="op" id="3661945">.</span><span class="ident" id="3661946">TBSCSR</span><span class="op" id="3661952">.</span><span class="ident" id="3661953">Attributes</span><span class="op" id="3661963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3661966">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661970">var</span>&nbsp;<span class="ident" id="3661974">err</span>&nbsp;<span class="builtintype" id="3661978">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661985">out</span><span class="op" id="3661988">.</span><span class="ident" id="3661989">PublicKey</span><span class="op" id="3661998">,</span>&nbsp;<span class="ident" id="3662000">err</span>&nbsp;<span class="op" id="3662004">=</span>&nbsp;<span class="ident" id="3662006">parsePublicKey</span><span class="op" id="3662020">(</span><span class="ident" id="3662021">out</span><span class="op" id="3662024">.</span><span class="ident" id="3662025">PublicKeyAlgorithm</span><span class="op" id="3662043">,</span>&nbsp;<span class="op" id="3662045">&amp;</span><span class="ident" id="3662046">in</span><span class="op" id="3662048">.</span><span class="ident" id="3662049">TBSCSR</span><span class="op" id="3662055">.</span><span class="ident" id="3662056">PublicKey</span><span class="op" id="3662065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662068">if</span>&nbsp;<span class="ident" id="3662071">err</span>&nbsp;<span class="op" id="3662075">!=</span>&nbsp;<span class="ident" id="3662078">nil</span>&nbsp;<span class="op" id="3662082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662086">return</span>&nbsp;<span class="ident" id="3662093">nil</span><span class="op" id="3662096">,</span>&nbsp;<span class="ident" id="3662098">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3662103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662107">var</span>&nbsp;<span class="ident" id="3662111">subject</span>&nbsp;<span class="ident" id="3662119">pkix</span><span class="op" id="3662123">.</span><span class="ident" id="3662124">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662137">if</span>&nbsp;<span class="ident" id="3662140">_</span><span class="op" id="3662141">,</span>&nbsp;<span class="ident" id="3662143">err</span>&nbsp;<span class="op" id="3662147">:=</span>&nbsp;<span class="ident" id="3662150">asn1</span><span class="op" id="3662154">.</span><span class="ident" id="3662155">Unmarshal</span><span class="op" id="3662164">(</span><span class="ident" id="3662165">in</span><span class="op" id="3662167">.</span><span class="ident" id="3662168">TBSCSR</span><span class="op" id="3662174">.</span><span class="ident" id="3662175">Subject</span><span class="op" id="3662182">.</span><span class="ident" id="3662183">FullBytes</span><span class="op" id="3662192">,</span>&nbsp;<span class="op" id="3662194">&amp;</span><span class="ident" id="3662195">subject</span><span class="op" id="3662202">)</span><span class="op" id="3662203">;</span>&nbsp;<span class="ident" id="3662205">err</span>&nbsp;<span class="op" id="3662209">!=</span>&nbsp;<span class="ident" id="3662212">nil</span>&nbsp;<span class="op" id="3662216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662220">return</span>&nbsp;<span class="ident" id="3662227">nil</span><span class="op" id="3662230">,</span>&nbsp;<span class="ident" id="3662232">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3662237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662241">out</span><span class="op" id="3662244">.</span><span class="ident" id="3662245">Subject</span><span class="op" id="3662252">.</span><span class="ident" id="3662253">FillFromRDNSequence</span><span class="op" id="3662272">(</span><span class="op" id="3662273">&amp;</span><span class="ident" id="3662274">subject</span><span class="op" id="3662281">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662285">var</span>&nbsp;<span class="ident" id="3662289">extensions</span>&nbsp;<span class="op" id="3662300">[</span><span class="op" id="3662301">]</span><span class="ident" id="3662302">pkix</span><span class="op" id="3662306">.</span><span class="ident" id="3662307">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662331">for</span>&nbsp;<span class="ident" id="3662335">_</span><span class="op" id="3662336">,</span>&nbsp;<span class="ident" id="3662338">atvSet</span>&nbsp;<span class="op" id="3662345">:=</span>&nbsp;<span class="keyword" id="3662348">range</span>&nbsp;<span class="ident" id="3662354">in</span><span class="op" id="3662356">.</span><span class="ident" id="3662357">TBSCSR</span><span class="op" id="3662363">.</span><span class="ident" id="3662364">Attributes</span>&nbsp;<span class="op" id="3662375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662379">if</span>&nbsp;<span class="op" id="3662382">!</span><span class="ident" id="3662383">atvSet</span><span class="op" id="3662389">.</span><span class="ident" id="3662390">Type</span><span class="op" id="3662394">.</span><span class="ident" id="3662395">Equal</span><span class="op" id="3662400">(</span><span class="ident" id="3662401">oidExtensionRequest</span><span class="op" id="3662420">)</span>&nbsp;<span class="op" id="3662422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662427">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3662438">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662443">for</span>&nbsp;<span class="ident" id="3662447">_</span><span class="op" id="3662448">,</span>&nbsp;<span class="ident" id="3662450">atvs</span>&nbsp;<span class="op" id="3662455">:=</span>&nbsp;<span class="keyword" id="3662458">range</span>&nbsp;<span class="ident" id="3662464">atvSet</span><span class="op" id="3662470">.</span><span class="ident" id="3662471">Value</span>&nbsp;<span class="op" id="3662477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662482">extensions</span>&nbsp;<span class="op" id="3662493">=</span>&nbsp;<span class="builtinfunc" id="3662495">append</span><span class="op" id="3662501">(</span><span class="ident" id="3662502">extensions</span><span class="op" id="3662512">,</span>&nbsp;<span class="ident" id="3662514">atvs</span><span class="op" id="3662518">...</span><span class="op" id="3662521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3662525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3662528">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662532">out</span><span class="op" id="3662535">.</span><span class="ident" id="3662536">Extensions</span>&nbsp;<span class="op" id="3662547">=</span>&nbsp;<span class="builtinfunc" id="3662549">make</span><span class="op" id="3662553">(</span><span class="op" id="3662554">[</span><span class="op" id="3662555">]</span><span class="ident" id="3662556">pkix</span><span class="op" id="3662560">.</span><span class="ident" id="3662561">Extension</span><span class="op" id="3662570">,</span>&nbsp;<span class="num" id="3662572">0</span><span class="op" id="3662573">,</span>&nbsp;<span class="builtinfunc" id="3662575">len</span><span class="op" id="3662578">(</span><span class="ident" id="3662579">extensions</span><span class="op" id="3662589">)</span><span class="op" id="3662590">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662594">for</span>&nbsp;<span class="ident" id="3662598">_</span><span class="op" id="3662599">,</span>&nbsp;<span class="ident" id="3662601">e</span>&nbsp;<span class="op" id="3662603">:=</span>&nbsp;<span class="keyword" id="3662606">range</span>&nbsp;<span class="ident" id="3662612">extensions</span>&nbsp;<span class="op" id="3662623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662627">value</span><span class="op" id="3662632">,</span>&nbsp;<span class="ident" id="3662634">ok</span>&nbsp;<span class="op" id="3662637">:=</span>&nbsp;<span class="ident" id="3662640">e</span><span class="op" id="3662641">.</span><span class="ident" id="3662642">Value</span><span class="op" id="3662647">.</span><span class="op" id="3662648">(</span><span class="op" id="3662649">[</span><span class="op" id="3662650">]</span><span class="builtintype" id="3662651">byte</span><span class="op" id="3662655">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662659">if</span>&nbsp;<span class="op" id="3662662">!</span><span class="ident" id="3662663">ok</span>&nbsp;<span class="op" id="3662666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662671">return</span>&nbsp;<span class="ident" id="3662678">nil</span><span class="op" id="3662681">,</span>&nbsp;<span class="ident" id="3662683">errors</span><span class="op" id="3662689">.</span><span class="ident" id="3662690">New</span><span class="op" id="3662693">(</span><span class="string" id="3662694">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="3662753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3662757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662762">out</span><span class="op" id="3662765">.</span><span class="ident" id="3662766">Extensions</span>&nbsp;<span class="op" id="3662777">=</span>&nbsp;<span class="builtinfunc" id="3662779">append</span><span class="op" id="3662785">(</span><span class="ident" id="3662786">out</span><span class="op" id="3662789">.</span><span class="ident" id="3662790">Extensions</span><span class="op" id="3662800">,</span>&nbsp;<span class="ident" id="3662802">pkix</span><span class="op" id="3662806">.</span><span class="ident" id="3662807">Extension</span><span class="op" id="3662816">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662821">Id</span><span class="op" id="3662823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3662828">e</span><span class="op" id="3662829">.</span><span class="ident" id="3662830">Type</span><span class="op" id="3662834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662839">Value</span><span class="op" id="3662844">:</span>&nbsp;<span class="ident" id="3662846">value</span><span class="op" id="3662851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3662855">}</span><span class="op" id="3662856">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662861">if</span>&nbsp;<span class="builtinfunc" id="3662864">len</span><span class="op" id="3662867">(</span><span class="ident" id="3662868">e</span><span class="op" id="3662869">.</span><span class="ident" id="3662870">Type</span><span class="op" id="3662874">)</span>&nbsp;<span class="op" id="3662876">==</span>&nbsp;<span class="num" id="3662879">4</span>&nbsp;<span class="op" id="3662881">&amp;&amp;</span>&nbsp;<span class="ident" id="3662884">e</span><span class="op" id="3662885">.</span><span class="ident" id="3662886">Type</span><span class="op" id="3662890">[</span><span class="num" id="3662891">0</span><span class="op" id="3662892">]</span>&nbsp;<span class="op" id="3662894">==</span>&nbsp;<span class="num" id="3662897">2</span>&nbsp;<span class="op" id="3662899">&amp;&amp;</span>&nbsp;<span class="ident" id="3662902">e</span><span class="op" id="3662903">.</span><span class="ident" id="3662904">Type</span><span class="op" id="3662908">[</span><span class="num" id="3662909">1</span><span class="op" id="3662910">]</span>&nbsp;<span class="op" id="3662912">==</span>&nbsp;<span class="num" id="3662915">5</span>&nbsp;<span class="op" id="3662917">&amp;&amp;</span>&nbsp;<span class="ident" id="3662920">e</span><span class="op" id="3662921">.</span><span class="ident" id="3662922">Type</span><span class="op" id="3662926">[</span><span class="num" id="3662927">2</span><span class="op" id="3662928">]</span>&nbsp;<span class="op" id="3662930">==</span>&nbsp;<span class="num" id="3662933">29</span>&nbsp;<span class="op" id="3662936">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662941">switch</span>&nbsp;<span class="ident" id="3662948">e</span><span class="op" id="3662949">.</span><span class="ident" id="3662950">Type</span><span class="op" id="3662954">[</span><span class="num" id="3662955">3</span><span class="op" id="3662956">]</span>&nbsp;<span class="op" id="3662958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662963">case</span>&nbsp;<span class="num" id="3662968">17</span><span class="op" id="3662970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662976">out</span><span class="op" id="3662979">.</span><span class="ident" id="3662980">DNSNames</span><span class="op" id="3662988">,</span>&nbsp;<span class="ident" id="3662990">out</span><span class="op" id="3662993">.</span><span class="ident" id="3662994">EmailAddresses</span><span class="op" id="3663008">,</span>&nbsp;<span class="ident" id="3663010">out</span><span class="op" id="3663013">.</span><span class="ident" id="3663014">IPAddresses</span><span class="op" id="3663025">,</span>&nbsp;<span class="ident" id="3663027">err</span>&nbsp;<span class="op" id="3663031">=</span>&nbsp;<span class="ident" id="3663033">parseSANExtension</span><span class="op" id="3663050">(</span><span class="ident" id="3663051">value</span><span class="op" id="3663056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663062">if</span>&nbsp;<span class="ident" id="3663065">err</span>&nbsp;<span class="op" id="3663069">!=</span>&nbsp;<span class="ident" id="3663072">nil</span>&nbsp;<span class="op" id="3663076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663083">return</span>&nbsp;<span class="ident" id="3663090">nil</span><span class="op" id="3663093">,</span>&nbsp;<span class="ident" id="3663095">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3663103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3663108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3663112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3663115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663119">return</span>&nbsp;<span class="ident" id="3663126">out</span><span class="op" id="3663129">,</span>&nbsp;<span class="ident" id="3663131">nil</span><br>
<span class="lineno"></span><span class="op" id="3663135">}</span>
</div>
</body>
</html>
