<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html" class="current">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6743121">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6743177">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6743231">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6743282">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="6743361">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6743370">package</span>&nbsp;<span class="ident" id="6743378">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6743383">import</span>&nbsp;<span class="op" id="6743390">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6743393">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6743399">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6743410">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6743421">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6743432">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6743439">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6743442">func</span>&nbsp;<span class="ident" id="6743447">packetConnTestData</span><span class="op" id="6743465">(</span><span class="ident" id="6743466">t</span>&nbsp;<span class="op" id="6743468">*</span><span class="ident" id="6743469">testing</span><span class="op" id="6743476">.</span><span class="ident" id="6743477">T</span><span class="op" id="6743478">,</span>&nbsp;<span class="ident" id="6743480">net</span>&nbsp;<span class="builtintype" id="6743484">string</span><span class="op" id="6743490">,</span>&nbsp;<span class="ident" id="6743492">i</span>&nbsp;<span class="builtintype" id="6743494">int</span><span class="op" id="6743497">)</span>&nbsp;<span class="op" id="6743499">(</span><span class="op" id="6743500">[</span><span class="op" id="6743501">]</span><span class="builtintype" id="6743502">byte</span><span class="op" id="6743506">,</span>&nbsp;<span class="keyword" id="6743508">func</span><span class="op" id="6743512">(</span><span class="op" id="6743513">)</span><span class="op" id="6743514">)</span>&nbsp;<span class="op" id="6743516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743519">switch</span>&nbsp;<span class="ident" id="6743526">net</span>&nbsp;<span class="op" id="6743530">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743533">case</span>&nbsp;<span class="string" id="6743538">&#34;udp&#34;</span><span class="op" id="6743543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743547">return</span>&nbsp;<span class="op" id="6743554">[</span><span class="op" id="6743555">]</span><span class="builtintype" id="6743556">byte</span><span class="op" id="6743560">(</span><span class="string" id="6743561">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6743582">)</span><span class="op" id="6743583">,</span>&nbsp;<span class="builtintype" id="6743585">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743590">case</span>&nbsp;<span class="string" id="6743595">&#34;ip&#34;</span><span class="op" id="6743599">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743603">if</span>&nbsp;<span class="ident" id="6743606">skip</span><span class="op" id="6743610">,</span>&nbsp;<span class="ident" id="6743612">skipmsg</span>&nbsp;<span class="op" id="6743620">:=</span>&nbsp;<span class="ident" id="6743623">skipRawSocketTest</span><span class="op" id="6743640">(</span><span class="ident" id="6743641">t</span><span class="op" id="6743642">)</span><span class="op" id="6743643">;</span>&nbsp;<span class="ident" id="6743645">skip</span>&nbsp;<span class="op" id="6743650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743655">return</span>&nbsp;<span class="builtintype" id="6743662">nil</span><span class="op" id="6743665">,</span>&nbsp;<span class="keyword" id="6743667">func</span><span class="op" id="6743671">(</span><span class="op" id="6743672">)</span>&nbsp;<span class="op" id="6743674">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743680">t</span><span class="op" id="6743681">.</span><span class="ident" id="6743682">Logf</span><span class="op" id="6743686">(</span><span class="ident" id="6743687">skipmsg</span><span class="op" id="6743694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743707">b</span><span class="op" id="6743708">,</span>&nbsp;<span class="ident" id="6743710">err</span>&nbsp;<span class="op" id="6743714">:=</span>&nbsp;<span class="op" id="6743717">(</span><span class="op" id="6743718">&amp;</span><span class="ident" id="6743719">icmpMessage</span><span class="op" id="6743730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743735">Type</span><span class="op" id="6743739">:</span>&nbsp;<span class="ident" id="6743741">icmpv4EchoRequest</span><span class="op" id="6743758">,</span>&nbsp;<span class="ident" id="6743760">Code</span><span class="op" id="6743764">:</span>&nbsp;<span class="num" id="6743766">0</span><span class="op" id="6743767">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743772">Body</span><span class="op" id="6743776">:</span>&nbsp;<span class="op" id="6743778">&amp;</span><span class="ident" id="6743779">icmpEcho</span><span class="op" id="6743787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743793">ID</span><span class="op" id="6743795">:</span>&nbsp;<span class="ident" id="6743797">os</span><span class="op" id="6743799">.</span><span class="ident" id="6743800">Getpid</span><span class="op" id="6743806">(</span><span class="op" id="6743807">)</span>&nbsp;<span class="op" id="6743809">&amp;</span>&nbsp;<span class="num" id="6743811">0xffff</span><span class="op" id="6743817">,</span>&nbsp;<span class="ident" id="6743819">Seq</span><span class="op" id="6743822">:</span>&nbsp;<span class="ident" id="6743824">i</span>&nbsp;<span class="op" id="6743826">+</span>&nbsp;<span class="num" id="6743828">1</span><span class="op" id="6743829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743835">Data</span><span class="op" id="6743839">:</span>&nbsp;<span class="op" id="6743841">[</span><span class="op" id="6743842">]</span><span class="builtintype" id="6743843">byte</span><span class="op" id="6743847">(</span><span class="string" id="6743848">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6743868">)</span><span class="op" id="6743869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743874">}</span><span class="op" id="6743875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743879">}</span><span class="op" id="6743880">)</span><span class="op" id="6743881">.</span><span class="ident" id="6743882">Marshal</span><span class="op" id="6743889">(</span><span class="op" id="6743890">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743894">if</span>&nbsp;<span class="ident" id="6743897">err</span>&nbsp;<span class="op" id="6743901">!=</span>&nbsp;<span class="builtintype" id="6743904">nil</span>&nbsp;<span class="op" id="6743908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743913">return</span>&nbsp;<span class="builtintype" id="6743920">nil</span><span class="op" id="6743923">,</span>&nbsp;<span class="keyword" id="6743925">func</span><span class="op" id="6743929">(</span><span class="op" id="6743930">)</span>&nbsp;<span class="op" id="6743932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743938">t</span><span class="op" id="6743939">.</span><span class="ident" id="6743940">Fatalf</span><span class="op" id="6743946">(</span><span class="string" id="6743947">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6743979">,</span>&nbsp;<span class="ident" id="6743981">err</span><span class="op" id="6743984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743993">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743997">return</span>&nbsp;<span class="ident" id="6744004">b</span><span class="op" id="6744005">,</span>&nbsp;<span class="builtintype" id="6744007">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744012">case</span>&nbsp;<span class="string" id="6744017">&#34;unixgram&#34;</span><span class="op" id="6744027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744031">switch</span>&nbsp;<span class="ident" id="6744038">runtime</span><span class="op" id="6744045">.</span><span class="ident" id="6744046">GOOS</span>&nbsp;<span class="op" id="6744051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744055">case</span>&nbsp;<span class="string" id="6744060">&#34;nacl&#34;</span><span class="op" id="6744066">,</span>&nbsp;<span class="string" id="6744068">&#34;plan9&#34;</span><span class="op" id="6744075">,</span>&nbsp;<span class="string" id="6744077">&#34;windows&#34;</span><span class="op" id="6744086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744091">return</span>&nbsp;<span class="builtintype" id="6744098">nil</span><span class="op" id="6744101">,</span>&nbsp;<span class="keyword" id="6744103">func</span><span class="op" id="6744107">(</span><span class="op" id="6744108">)</span>&nbsp;<span class="op" id="6744110">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744116">t</span><span class="op" id="6744117">.</span><span class="ident" id="6744118">Logf</span><span class="op" id="6744122">(</span><span class="string" id="6744123">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6744147">,</span>&nbsp;<span class="ident" id="6744149">net</span><span class="op" id="6744152">,</span>&nbsp;<span class="ident" id="6744154">runtime</span><span class="op" id="6744161">.</span><span class="ident" id="6744162">GOOS</span><span class="op" id="6744166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744175">default</span><span class="op" id="6744182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744187">return</span>&nbsp;<span class="op" id="6744194">[</span><span class="op" id="6744195">]</span><span class="builtintype" id="6744196">byte</span><span class="op" id="6744200">(</span><span class="string" id="6744201">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6744227">)</span><span class="op" id="6744228">,</span>&nbsp;<span class="builtintype" id="6744230">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744236">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744239">default</span><span class="op" id="6744246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744250">return</span>&nbsp;<span class="builtintype" id="6744257">nil</span><span class="op" id="6744260">,</span>&nbsp;<span class="keyword" id="6744262">func</span><span class="op" id="6744266">(</span><span class="op" id="6744267">)</span>&nbsp;<span class="op" id="6744269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744274">t</span><span class="op" id="6744275">.</span><span class="ident" id="6744276">Logf</span><span class="op" id="6744280">(</span><span class="string" id="6744281">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="6744299">,</span>&nbsp;<span class="ident" id="6744301">net</span><span class="op" id="6744304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744311">}</span><br>
<span class="lineno">55</span><span class="op" id="6744313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6744316">var</span>&nbsp;<span class="ident" id="6744320">packetConnTests</span>&nbsp;<span class="op" id="6744336">=</span>&nbsp;<span class="op" id="6744338">[</span><span class="op" id="6744339">]</span><span class="keyword" id="6744340">struct</span>&nbsp;<span class="op" id="6744347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744350">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6744356">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744364">addr1</span>&nbsp;<span class="builtintype" id="6744370">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744378">addr2</span>&nbsp;<span class="builtintype" id="6744384">string</span><br>
<span class="lineno"></span><span class="op" id="6744391">}</span><span class="op" id="6744392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744395">{</span><span class="string" id="6744396">&#34;udp&#34;</span><span class="op" id="6744401">,</span>&nbsp;<span class="string" id="6744403">&#34;127.0.0.1:0&#34;</span><span class="op" id="6744416">,</span>&nbsp;<span class="string" id="6744418">&#34;127.0.0.1:0&#34;</span><span class="op" id="6744431">}</span><span class="op" id="6744432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744435">{</span><span class="string" id="6744436">&#34;ip:icmp&#34;</span><span class="op" id="6744445">,</span>&nbsp;<span class="string" id="6744447">&#34;127.0.0.1&#34;</span><span class="op" id="6744458">,</span>&nbsp;<span class="string" id="6744460">&#34;127.0.0.1&#34;</span><span class="op" id="6744471">}</span><span class="op" id="6744472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744475">{</span><span class="string" id="6744476">&#34;unixgram&#34;</span><span class="op" id="6744486">,</span>&nbsp;<span class="ident" id="6744488">testUnixAddr</span><span class="op" id="6744500">(</span><span class="op" id="6744501">)</span><span class="op" id="6744502">,</span>&nbsp;<span class="ident" id="6744504">testUnixAddr</span><span class="op" id="6744516">(</span><span class="op" id="6744517">)</span><span class="op" id="6744518">}</span><span class="op" id="6744519">,</span><br>
<span class="lineno">65</span><span class="op" id="6744521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6744524">func</span>&nbsp;<span class="ident" id="6744529">TestPacketConn</span><span class="op" id="6744543">(</span><span class="ident" id="6744544">t</span>&nbsp;<span class="op" id="6744546">*</span><span class="ident" id="6744547">testing</span><span class="op" id="6744554">.</span><span class="ident" id="6744555">T</span><span class="op" id="6744556">)</span>&nbsp;<span class="op" id="6744558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744561">closer</span>&nbsp;<span class="op" id="6744568">:=</span>&nbsp;<span class="keyword" id="6744571">func</span><span class="op" id="6744575">(</span><span class="ident" id="6744576">c</span>&nbsp;<span class="ident" id="6744578">PacketConn</span><span class="op" id="6744588">,</span>&nbsp;<span class="ident" id="6744590">net</span><span class="op" id="6744593">,</span>&nbsp;<span class="ident" id="6744595">addr1</span><span class="op" id="6744600">,</span>&nbsp;<span class="ident" id="6744602">addr2</span>&nbsp;<span class="builtintype" id="6744608">string</span><span class="op" id="6744614">)</span>&nbsp;<span class="op" id="6744616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744620">c</span><span class="op" id="6744621">.</span><span class="ident" id="6744622">Close</span><span class="op" id="6744627">(</span><span class="op" id="6744628">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744632">switch</span>&nbsp;<span class="ident" id="6744639">net</span>&nbsp;<span class="op" id="6744643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744647">case</span>&nbsp;<span class="string" id="6744652">&#34;unixgram&#34;</span><span class="op" id="6744662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744667">os</span><span class="op" id="6744669">.</span><span class="ident" id="6744670">Remove</span><span class="op" id="6744676">(</span><span class="ident" id="6744677">addr1</span><span class="op" id="6744682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744687">os</span><span class="op" id="6744689">.</span><span class="ident" id="6744690">Remove</span><span class="op" id="6744696">(</span><span class="ident" id="6744697">addr2</span><span class="op" id="6744702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744706">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744713">for</span>&nbsp;<span class="ident" id="6744717">i</span><span class="op" id="6744718">,</span>&nbsp;<span class="ident" id="6744720">tt</span>&nbsp;<span class="op" id="6744723">:=</span>&nbsp;<span class="keyword" id="6744726">range</span>&nbsp;<span class="ident" id="6744732">packetConnTests</span>&nbsp;<span class="op" id="6744748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744752">netstr</span>&nbsp;<span class="op" id="6744759">:=</span>&nbsp;<span class="ident" id="6744762">strings</span><span class="op" id="6744769">.</span><span class="ident" id="6744770">Split</span><span class="op" id="6744775">(</span><span class="ident" id="6744776">tt</span><span class="op" id="6744778">.</span><span class="ident" id="6744779">net</span><span class="op" id="6744782">,</span>&nbsp;<span class="string" id="6744784">&#34;:&#34;</span><span class="op" id="6744787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744791">wb</span><span class="op" id="6744793">,</span>&nbsp;<span class="ident" id="6744795">skipOrFatalFn</span>&nbsp;<span class="op" id="6744809">:=</span>&nbsp;<span class="ident" id="6744812">packetConnTestData</span><span class="op" id="6744830">(</span><span class="ident" id="6744831">t</span><span class="op" id="6744832">,</span>&nbsp;<span class="ident" id="6744834">netstr</span><span class="op" id="6744840">[</span><span class="num" id="6744841">0</span><span class="op" id="6744842">]</span><span class="op" id="6744843">,</span>&nbsp;<span class="ident" id="6744845">i</span><span class="op" id="6744846">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744850">if</span>&nbsp;<span class="ident" id="6744853">skipOrFatalFn</span>&nbsp;<span class="op" id="6744867">!=</span>&nbsp;<span class="builtintype" id="6744870">nil</span>&nbsp;<span class="op" id="6744874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744879">skipOrFatalFn</span><span class="op" id="6744892">(</span><span class="op" id="6744893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744898">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744914">c1</span><span class="op" id="6744916">,</span>&nbsp;<span class="ident" id="6744918">err</span>&nbsp;<span class="op" id="6744922">:=</span>&nbsp;<span class="ident" id="6744925">ListenPacket</span><span class="op" id="6744937">(</span><span class="ident" id="6744938">tt</span><span class="op" id="6744940">.</span><span class="ident" id="6744941">net</span><span class="op" id="6744944">,</span>&nbsp;<span class="ident" id="6744946">tt</span><span class="op" id="6744948">.</span><span class="ident" id="6744949">addr1</span><span class="op" id="6744954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744958">if</span>&nbsp;<span class="ident" id="6744961">err</span>&nbsp;<span class="op" id="6744965">!=</span>&nbsp;<span class="builtintype" id="6744968">nil</span>&nbsp;<span class="op" id="6744972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744977">t</span><span class="op" id="6744978">.</span><span class="ident" id="6744979">Fatalf</span><span class="op" id="6744985">(</span><span class="string" id="6744986">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745011">,</span>&nbsp;<span class="ident" id="6745013">err</span><span class="op" id="6745016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745024">defer</span>&nbsp;<span class="ident" id="6745030">closer</span><span class="op" id="6745036">(</span><span class="ident" id="6745037">c1</span><span class="op" id="6745039">,</span>&nbsp;<span class="ident" id="6745041">netstr</span><span class="op" id="6745047">[</span><span class="num" id="6745048">0</span><span class="op" id="6745049">]</span><span class="op" id="6745050">,</span>&nbsp;<span class="ident" id="6745052">tt</span><span class="op" id="6745054">.</span><span class="ident" id="6745055">addr1</span><span class="op" id="6745060">,</span>&nbsp;<span class="ident" id="6745062">tt</span><span class="op" id="6745064">.</span><span class="ident" id="6745065">addr2</span><span class="op" id="6745070">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745074">c1</span><span class="op" id="6745076">.</span><span class="ident" id="6745077">LocalAddr</span><span class="op" id="6745086">(</span><span class="op" id="6745087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745091">c1</span><span class="op" id="6745093">.</span><span class="ident" id="6745094">SetDeadline</span><span class="op" id="6745105">(</span><span class="ident" id="6745106">time</span><span class="op" id="6745110">.</span><span class="ident" id="6745111">Now</span><span class="op" id="6745114">(</span><span class="op" id="6745115">)</span><span class="op" id="6745116">.</span><span class="ident" id="6745117">Add</span><span class="op" id="6745120">(</span><span class="num" id="6745121">100</span>&nbsp;<span class="op" id="6745125">*</span>&nbsp;<span class="ident" id="6745127">time</span><span class="op" id="6745131">.</span><span class="ident" id="6745132">Millisecond</span><span class="op" id="6745143">)</span><span class="op" id="6745144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745148">c1</span><span class="op" id="6745150">.</span><span class="ident" id="6745151">SetReadDeadline</span><span class="op" id="6745166">(</span><span class="ident" id="6745167">time</span><span class="op" id="6745171">.</span><span class="ident" id="6745172">Now</span><span class="op" id="6745175">(</span><span class="op" id="6745176">)</span><span class="op" id="6745177">.</span><span class="ident" id="6745178">Add</span><span class="op" id="6745181">(</span><span class="num" id="6745182">100</span>&nbsp;<span class="op" id="6745186">*</span>&nbsp;<span class="ident" id="6745188">time</span><span class="op" id="6745192">.</span><span class="ident" id="6745193">Millisecond</span><span class="op" id="6745204">)</span><span class="op" id="6745205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745209">c1</span><span class="op" id="6745211">.</span><span class="ident" id="6745212">SetWriteDeadline</span><span class="op" id="6745228">(</span><span class="ident" id="6745229">time</span><span class="op" id="6745233">.</span><span class="ident" id="6745234">Now</span><span class="op" id="6745237">(</span><span class="op" id="6745238">)</span><span class="op" id="6745239">.</span><span class="ident" id="6745240">Add</span><span class="op" id="6745243">(</span><span class="num" id="6745244">100</span>&nbsp;<span class="op" id="6745248">*</span>&nbsp;<span class="ident" id="6745250">time</span><span class="op" id="6745254">.</span><span class="ident" id="6745255">Millisecond</span><span class="op" id="6745266">)</span><span class="op" id="6745267">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745272">c2</span><span class="op" id="6745274">,</span>&nbsp;<span class="ident" id="6745276">err</span>&nbsp;<span class="op" id="6745280">:=</span>&nbsp;<span class="ident" id="6745283">ListenPacket</span><span class="op" id="6745295">(</span><span class="ident" id="6745296">tt</span><span class="op" id="6745298">.</span><span class="ident" id="6745299">net</span><span class="op" id="6745302">,</span>&nbsp;<span class="ident" id="6745304">tt</span><span class="op" id="6745306">.</span><span class="ident" id="6745307">addr2</span><span class="op" id="6745312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745316">if</span>&nbsp;<span class="ident" id="6745319">err</span>&nbsp;<span class="op" id="6745323">!=</span>&nbsp;<span class="builtintype" id="6745326">nil</span>&nbsp;<span class="op" id="6745330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745335">t</span><span class="op" id="6745336">.</span><span class="ident" id="6745337">Fatalf</span><span class="op" id="6745343">(</span><span class="string" id="6745344">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745369">,</span>&nbsp;<span class="ident" id="6745371">err</span><span class="op" id="6745374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745382">defer</span>&nbsp;<span class="ident" id="6745388">closer</span><span class="op" id="6745394">(</span><span class="ident" id="6745395">c2</span><span class="op" id="6745397">,</span>&nbsp;<span class="ident" id="6745399">netstr</span><span class="op" id="6745405">[</span><span class="num" id="6745406">0</span><span class="op" id="6745407">]</span><span class="op" id="6745408">,</span>&nbsp;<span class="ident" id="6745410">tt</span><span class="op" id="6745412">.</span><span class="ident" id="6745413">addr1</span><span class="op" id="6745418">,</span>&nbsp;<span class="ident" id="6745420">tt</span><span class="op" id="6745422">.</span><span class="ident" id="6745423">addr2</span><span class="op" id="6745428">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745432">c2</span><span class="op" id="6745434">.</span><span class="ident" id="6745435">LocalAddr</span><span class="op" id="6745444">(</span><span class="op" id="6745445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745449">c2</span><span class="op" id="6745451">.</span><span class="ident" id="6745452">SetDeadline</span><span class="op" id="6745463">(</span><span class="ident" id="6745464">time</span><span class="op" id="6745468">.</span><span class="ident" id="6745469">Now</span><span class="op" id="6745472">(</span><span class="op" id="6745473">)</span><span class="op" id="6745474">.</span><span class="ident" id="6745475">Add</span><span class="op" id="6745478">(</span><span class="num" id="6745479">100</span>&nbsp;<span class="op" id="6745483">*</span>&nbsp;<span class="ident" id="6745485">time</span><span class="op" id="6745489">.</span><span class="ident" id="6745490">Millisecond</span><span class="op" id="6745501">)</span><span class="op" id="6745502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745506">c2</span><span class="op" id="6745508">.</span><span class="ident" id="6745509">SetReadDeadline</span><span class="op" id="6745524">(</span><span class="ident" id="6745525">time</span><span class="op" id="6745529">.</span><span class="ident" id="6745530">Now</span><span class="op" id="6745533">(</span><span class="op" id="6745534">)</span><span class="op" id="6745535">.</span><span class="ident" id="6745536">Add</span><span class="op" id="6745539">(</span><span class="num" id="6745540">100</span>&nbsp;<span class="op" id="6745544">*</span>&nbsp;<span class="ident" id="6745546">time</span><span class="op" id="6745550">.</span><span class="ident" id="6745551">Millisecond</span><span class="op" id="6745562">)</span><span class="op" id="6745563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745567">c2</span><span class="op" id="6745569">.</span><span class="ident" id="6745570">SetWriteDeadline</span><span class="op" id="6745586">(</span><span class="ident" id="6745587">time</span><span class="op" id="6745591">.</span><span class="ident" id="6745592">Now</span><span class="op" id="6745595">(</span><span class="op" id="6745596">)</span><span class="op" id="6745597">.</span><span class="ident" id="6745598">Add</span><span class="op" id="6745601">(</span><span class="num" id="6745602">100</span>&nbsp;<span class="op" id="6745606">*</span>&nbsp;<span class="ident" id="6745608">time</span><span class="op" id="6745612">.</span><span class="ident" id="6745613">Millisecond</span><span class="op" id="6745624">)</span><span class="op" id="6745625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745630">if</span>&nbsp;<span class="ident" id="6745633">_</span><span class="op" id="6745634">,</span>&nbsp;<span class="ident" id="6745636">err</span>&nbsp;<span class="op" id="6745640">:=</span>&nbsp;<span class="ident" id="6745643">c1</span><span class="op" id="6745645">.</span><span class="ident" id="6745646">WriteTo</span><span class="op" id="6745653">(</span><span class="ident" id="6745654">wb</span><span class="op" id="6745656">,</span>&nbsp;<span class="ident" id="6745658">c2</span><span class="op" id="6745660">.</span><span class="ident" id="6745661">LocalAddr</span><span class="op" id="6745670">(</span><span class="op" id="6745671">)</span><span class="op" id="6745672">)</span><span class="op" id="6745673">;</span>&nbsp;<span class="ident" id="6745675">err</span>&nbsp;<span class="op" id="6745679">!=</span>&nbsp;<span class="builtintype" id="6745682">nil</span>&nbsp;<span class="op" id="6745686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745691">t</span><span class="op" id="6745692">.</span><span class="ident" id="6745693">Fatalf</span><span class="op" id="6745699">(</span><span class="string" id="6745700">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745731">,</span>&nbsp;<span class="ident" id="6745733">err</span><span class="op" id="6745736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745744">rb2</span>&nbsp;<span class="op" id="6745748">:=</span>&nbsp;<span class="builtinfunc" id="6745751">make</span><span class="op" id="6745755">(</span><span class="op" id="6745756">[</span><span class="op" id="6745757">]</span><span class="builtintype" id="6745758">byte</span><span class="op" id="6745762">,</span>&nbsp;<span class="num" id="6745764">128</span><span class="op" id="6745767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745771">if</span>&nbsp;<span class="ident" id="6745774">_</span><span class="op" id="6745775">,</span>&nbsp;<span class="ident" id="6745777">_</span><span class="op" id="6745778">,</span>&nbsp;<span class="ident" id="6745780">err</span>&nbsp;<span class="op" id="6745784">:=</span>&nbsp;<span class="ident" id="6745787">c2</span><span class="op" id="6745789">.</span><span class="ident" id="6745790">ReadFrom</span><span class="op" id="6745798">(</span><span class="ident" id="6745799">rb2</span><span class="op" id="6745802">)</span><span class="op" id="6745803">;</span>&nbsp;<span class="ident" id="6745805">err</span>&nbsp;<span class="op" id="6745809">!=</span>&nbsp;<span class="builtintype" id="6745812">nil</span>&nbsp;<span class="op" id="6745816">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745821">t</span><span class="op" id="6745822">.</span><span class="ident" id="6745823">Fatalf</span><span class="op" id="6745829">(</span><span class="string" id="6745830">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745862">,</span>&nbsp;<span class="ident" id="6745864">err</span><span class="op" id="6745867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745875">if</span>&nbsp;<span class="ident" id="6745878">_</span><span class="op" id="6745879">,</span>&nbsp;<span class="ident" id="6745881">err</span>&nbsp;<span class="op" id="6745885">:=</span>&nbsp;<span class="ident" id="6745888">c2</span><span class="op" id="6745890">.</span><span class="ident" id="6745891">WriteTo</span><span class="op" id="6745898">(</span><span class="ident" id="6745899">wb</span><span class="op" id="6745901">,</span>&nbsp;<span class="ident" id="6745903">c1</span><span class="op" id="6745905">.</span><span class="ident" id="6745906">LocalAddr</span><span class="op" id="6745915">(</span><span class="op" id="6745916">)</span><span class="op" id="6745917">)</span><span class="op" id="6745918">;</span>&nbsp;<span class="ident" id="6745920">err</span>&nbsp;<span class="op" id="6745924">!=</span>&nbsp;<span class="builtintype" id="6745927">nil</span>&nbsp;<span class="op" id="6745931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745936">t</span><span class="op" id="6745937">.</span><span class="ident" id="6745938">Fatalf</span><span class="op" id="6745944">(</span><span class="string" id="6745945">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745976">,</span>&nbsp;<span class="ident" id="6745978">err</span><span class="op" id="6745981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745985">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745989">rb1</span>&nbsp;<span class="op" id="6745993">:=</span>&nbsp;<span class="builtinfunc" id="6745996">make</span><span class="op" id="6746000">(</span><span class="op" id="6746001">[</span><span class="op" id="6746002">]</span><span class="builtintype" id="6746003">byte</span><span class="op" id="6746007">,</span>&nbsp;<span class="num" id="6746009">128</span><span class="op" id="6746012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746016">if</span>&nbsp;<span class="ident" id="6746019">_</span><span class="op" id="6746020">,</span>&nbsp;<span class="ident" id="6746022">_</span><span class="op" id="6746023">,</span>&nbsp;<span class="ident" id="6746025">err</span>&nbsp;<span class="op" id="6746029">:=</span>&nbsp;<span class="ident" id="6746032">c1</span><span class="op" id="6746034">.</span><span class="ident" id="6746035">ReadFrom</span><span class="op" id="6746043">(</span><span class="ident" id="6746044">rb1</span><span class="op" id="6746047">)</span><span class="op" id="6746048">;</span>&nbsp;<span class="ident" id="6746050">err</span>&nbsp;<span class="op" id="6746054">!=</span>&nbsp;<span class="builtintype" id="6746057">nil</span>&nbsp;<span class="op" id="6746061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746066">t</span><span class="op" id="6746067">.</span><span class="ident" id="6746068">Fatalf</span><span class="op" id="6746074">(</span><span class="string" id="6746075">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746107">,</span>&nbsp;<span class="ident" id="6746109">err</span><span class="op" id="6746112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746119">}</span><br>
<span class="lineno">120</span><span class="op" id="6746121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6746124">func</span>&nbsp;<span class="ident" id="6746129">TestConnAndPacketConn</span><span class="op" id="6746150">(</span><span class="ident" id="6746151">t</span>&nbsp;<span class="op" id="6746153">*</span><span class="ident" id="6746154">testing</span><span class="op" id="6746161">.</span><span class="ident" id="6746162">T</span><span class="op" id="6746163">)</span>&nbsp;<span class="op" id="6746165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746168">closer</span>&nbsp;<span class="op" id="6746175">:=</span>&nbsp;<span class="keyword" id="6746178">func</span><span class="op" id="6746182">(</span><span class="ident" id="6746183">c</span>&nbsp;<span class="ident" id="6746185">PacketConn</span><span class="op" id="6746195">,</span>&nbsp;<span class="ident" id="6746197">net</span><span class="op" id="6746200">,</span>&nbsp;<span class="ident" id="6746202">addr1</span><span class="op" id="6746207">,</span>&nbsp;<span class="ident" id="6746209">addr2</span>&nbsp;<span class="builtintype" id="6746215">string</span><span class="op" id="6746221">)</span>&nbsp;<span class="op" id="6746223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746227">c</span><span class="op" id="6746228">.</span><span class="ident" id="6746229">Close</span><span class="op" id="6746234">(</span><span class="op" id="6746235">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746239">switch</span>&nbsp;<span class="ident" id="6746246">net</span>&nbsp;<span class="op" id="6746250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746254">case</span>&nbsp;<span class="string" id="6746259">&#34;unixgram&#34;</span><span class="op" id="6746269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746274">os</span><span class="op" id="6746276">.</span><span class="ident" id="6746277">Remove</span><span class="op" id="6746283">(</span><span class="ident" id="6746284">addr1</span><span class="op" id="6746289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746294">os</span><span class="op" id="6746296">.</span><span class="ident" id="6746297">Remove</span><span class="op" id="6746303">(</span><span class="ident" id="6746304">addr2</span><span class="op" id="6746309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746313">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746320">for</span>&nbsp;<span class="ident" id="6746324">i</span><span class="op" id="6746325">,</span>&nbsp;<span class="ident" id="6746327">tt</span>&nbsp;<span class="op" id="6746330">:=</span>&nbsp;<span class="keyword" id="6746333">range</span>&nbsp;<span class="ident" id="6746339">packetConnTests</span>&nbsp;<span class="op" id="6746355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746359">var</span>&nbsp;<span class="ident" id="6746363">wb</span>&nbsp;<span class="op" id="6746366">[</span><span class="op" id="6746367">]</span><span class="builtintype" id="6746368">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746375">netstr</span>&nbsp;<span class="op" id="6746382">:=</span>&nbsp;<span class="ident" id="6746385">strings</span><span class="op" id="6746392">.</span><span class="ident" id="6746393">Split</span><span class="op" id="6746398">(</span><span class="ident" id="6746399">tt</span><span class="op" id="6746401">.</span><span class="ident" id="6746402">net</span><span class="op" id="6746405">,</span>&nbsp;<span class="string" id="6746407">&#34;:&#34;</span><span class="op" id="6746410">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746414">wb</span><span class="op" id="6746416">,</span>&nbsp;<span class="ident" id="6746418">skipOrFatalFn</span>&nbsp;<span class="op" id="6746432">:=</span>&nbsp;<span class="ident" id="6746435">packetConnTestData</span><span class="op" id="6746453">(</span><span class="ident" id="6746454">t</span><span class="op" id="6746455">,</span>&nbsp;<span class="ident" id="6746457">netstr</span><span class="op" id="6746463">[</span><span class="num" id="6746464">0</span><span class="op" id="6746465">]</span><span class="op" id="6746466">,</span>&nbsp;<span class="ident" id="6746468">i</span><span class="op" id="6746469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746473">if</span>&nbsp;<span class="ident" id="6746476">skipOrFatalFn</span>&nbsp;<span class="op" id="6746490">!=</span>&nbsp;<span class="builtintype" id="6746493">nil</span>&nbsp;<span class="op" id="6746497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746502">skipOrFatalFn</span><span class="op" id="6746515">(</span><span class="op" id="6746516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746521">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746532">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746537">c1</span><span class="op" id="6746539">,</span>&nbsp;<span class="ident" id="6746541">err</span>&nbsp;<span class="op" id="6746545">:=</span>&nbsp;<span class="ident" id="6746548">ListenPacket</span><span class="op" id="6746560">(</span><span class="ident" id="6746561">tt</span><span class="op" id="6746563">.</span><span class="ident" id="6746564">net</span><span class="op" id="6746567">,</span>&nbsp;<span class="ident" id="6746569">tt</span><span class="op" id="6746571">.</span><span class="ident" id="6746572">addr1</span><span class="op" id="6746577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746581">if</span>&nbsp;<span class="ident" id="6746584">err</span>&nbsp;<span class="op" id="6746588">!=</span>&nbsp;<span class="builtintype" id="6746591">nil</span>&nbsp;<span class="op" id="6746595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746600">t</span><span class="op" id="6746601">.</span><span class="ident" id="6746602">Fatalf</span><span class="op" id="6746608">(</span><span class="string" id="6746609">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746634">,</span>&nbsp;<span class="ident" id="6746636">err</span><span class="op" id="6746639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746643">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746647">defer</span>&nbsp;<span class="ident" id="6746653">closer</span><span class="op" id="6746659">(</span><span class="ident" id="6746660">c1</span><span class="op" id="6746662">,</span>&nbsp;<span class="ident" id="6746664">netstr</span><span class="op" id="6746670">[</span><span class="num" id="6746671">0</span><span class="op" id="6746672">]</span><span class="op" id="6746673">,</span>&nbsp;<span class="ident" id="6746675">tt</span><span class="op" id="6746677">.</span><span class="ident" id="6746678">addr1</span><span class="op" id="6746683">,</span>&nbsp;<span class="ident" id="6746685">tt</span><span class="op" id="6746687">.</span><span class="ident" id="6746688">addr2</span><span class="op" id="6746693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746697">c1</span><span class="op" id="6746699">.</span><span class="ident" id="6746700">LocalAddr</span><span class="op" id="6746709">(</span><span class="op" id="6746710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746714">c1</span><span class="op" id="6746716">.</span><span class="ident" id="6746717">SetDeadline</span><span class="op" id="6746728">(</span><span class="ident" id="6746729">time</span><span class="op" id="6746733">.</span><span class="ident" id="6746734">Now</span><span class="op" id="6746737">(</span><span class="op" id="6746738">)</span><span class="op" id="6746739">.</span><span class="ident" id="6746740">Add</span><span class="op" id="6746743">(</span><span class="num" id="6746744">100</span>&nbsp;<span class="op" id="6746748">*</span>&nbsp;<span class="ident" id="6746750">time</span><span class="op" id="6746754">.</span><span class="ident" id="6746755">Millisecond</span><span class="op" id="6746766">)</span><span class="op" id="6746767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746771">c1</span><span class="op" id="6746773">.</span><span class="ident" id="6746774">SetReadDeadline</span><span class="op" id="6746789">(</span><span class="ident" id="6746790">time</span><span class="op" id="6746794">.</span><span class="ident" id="6746795">Now</span><span class="op" id="6746798">(</span><span class="op" id="6746799">)</span><span class="op" id="6746800">.</span><span class="ident" id="6746801">Add</span><span class="op" id="6746804">(</span><span class="num" id="6746805">100</span>&nbsp;<span class="op" id="6746809">*</span>&nbsp;<span class="ident" id="6746811">time</span><span class="op" id="6746815">.</span><span class="ident" id="6746816">Millisecond</span><span class="op" id="6746827">)</span><span class="op" id="6746828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746832">c1</span><span class="op" id="6746834">.</span><span class="ident" id="6746835">SetWriteDeadline</span><span class="op" id="6746851">(</span><span class="ident" id="6746852">time</span><span class="op" id="6746856">.</span><span class="ident" id="6746857">Now</span><span class="op" id="6746860">(</span><span class="op" id="6746861">)</span><span class="op" id="6746862">.</span><span class="ident" id="6746863">Add</span><span class="op" id="6746866">(</span><span class="num" id="6746867">100</span>&nbsp;<span class="op" id="6746871">*</span>&nbsp;<span class="ident" id="6746873">time</span><span class="op" id="6746877">.</span><span class="ident" id="6746878">Millisecond</span><span class="op" id="6746889">)</span><span class="op" id="6746890">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746895">c2</span><span class="op" id="6746897">,</span>&nbsp;<span class="ident" id="6746899">err</span>&nbsp;<span class="op" id="6746903">:=</span>&nbsp;<span class="ident" id="6746906">Dial</span><span class="op" id="6746910">(</span><span class="ident" id="6746911">tt</span><span class="op" id="6746913">.</span><span class="ident" id="6746914">net</span><span class="op" id="6746917">,</span>&nbsp;<span class="ident" id="6746919">c1</span><span class="op" id="6746921">.</span><span class="ident" id="6746922">LocalAddr</span><span class="op" id="6746931">(</span><span class="op" id="6746932">)</span><span class="op" id="6746933">.</span><span class="ident" id="6746934">String</span><span class="op" id="6746940">(</span><span class="op" id="6746941">)</span><span class="op" id="6746942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746946">if</span>&nbsp;<span class="ident" id="6746949">err</span>&nbsp;<span class="op" id="6746953">!=</span>&nbsp;<span class="builtintype" id="6746956">nil</span>&nbsp;<span class="op" id="6746960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746965">t</span><span class="op" id="6746966">.</span><span class="ident" id="6746967">Fatalf</span><span class="op" id="6746973">(</span><span class="string" id="6746974">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746991">,</span>&nbsp;<span class="ident" id="6746993">err</span><span class="op" id="6746996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6747000">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747004">defer</span>&nbsp;<span class="ident" id="6747010">c2</span><span class="op" id="6747012">.</span><span class="ident" id="6747013">Close</span><span class="op" id="6747018">(</span><span class="op" id="6747019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747023">c2</span><span class="op" id="6747025">.</span><span class="ident" id="6747026">LocalAddr</span><span class="op" id="6747035">(</span><span class="op" id="6747036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747040">c2</span><span class="op" id="6747042">.</span><span class="ident" id="6747043">RemoteAddr</span><span class="op" id="6747053">(</span><span class="op" id="6747054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747058">c2</span><span class="op" id="6747060">.</span><span class="ident" id="6747061">SetDeadline</span><span class="op" id="6747072">(</span><span class="ident" id="6747073">time</span><span class="op" id="6747077">.</span><span class="ident" id="6747078">Now</span><span class="op" id="6747081">(</span><span class="op" id="6747082">)</span><span class="op" id="6747083">.</span><span class="ident" id="6747084">Add</span><span class="op" id="6747087">(</span><span class="num" id="6747088">100</span>&nbsp;<span class="op" id="6747092">*</span>&nbsp;<span class="ident" id="6747094">time</span><span class="op" id="6747098">.</span><span class="ident" id="6747099">Millisecond</span><span class="op" id="6747110">)</span><span class="op" id="6747111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747115">c2</span><span class="op" id="6747117">.</span><span class="ident" id="6747118">SetReadDeadline</span><span class="op" id="6747133">(</span><span class="ident" id="6747134">time</span><span class="op" id="6747138">.</span><span class="ident" id="6747139">Now</span><span class="op" id="6747142">(</span><span class="op" id="6747143">)</span><span class="op" id="6747144">.</span><span class="ident" id="6747145">Add</span><span class="op" id="6747148">(</span><span class="num" id="6747149">100</span>&nbsp;<span class="op" id="6747153">*</span>&nbsp;<span class="ident" id="6747155">time</span><span class="op" id="6747159">.</span><span class="ident" id="6747160">Millisecond</span><span class="op" id="6747171">)</span><span class="op" id="6747172">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747176">c2</span><span class="op" id="6747178">.</span><span class="ident" id="6747179">SetWriteDeadline</span><span class="op" id="6747195">(</span><span class="ident" id="6747196">time</span><span class="op" id="6747200">.</span><span class="ident" id="6747201">Now</span><span class="op" id="6747204">(</span><span class="op" id="6747205">)</span><span class="op" id="6747206">.</span><span class="ident" id="6747207">Add</span><span class="op" id="6747210">(</span><span class="num" id="6747211">100</span>&nbsp;<span class="op" id="6747215">*</span>&nbsp;<span class="ident" id="6747217">time</span><span class="op" id="6747221">.</span><span class="ident" id="6747222">Millisecond</span><span class="op" id="6747233">)</span><span class="op" id="6747234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747239">if</span>&nbsp;<span class="ident" id="6747242">_</span><span class="op" id="6747243">,</span>&nbsp;<span class="ident" id="6747245">err</span>&nbsp;<span class="op" id="6747249">:=</span>&nbsp;<span class="ident" id="6747252">c2</span><span class="op" id="6747254">.</span><span class="ident" id="6747255">Write</span><span class="op" id="6747260">(</span><span class="ident" id="6747261">wb</span><span class="op" id="6747263">)</span><span class="op" id="6747264">;</span>&nbsp;<span class="ident" id="6747266">err</span>&nbsp;<span class="op" id="6747270">!=</span>&nbsp;<span class="builtintype" id="6747273">nil</span>&nbsp;<span class="op" id="6747277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747282">t</span><span class="op" id="6747283">.</span><span class="ident" id="6747284">Fatalf</span><span class="op" id="6747290">(</span><span class="string" id="6747291">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6747314">,</span>&nbsp;<span class="ident" id="6747316">err</span><span class="op" id="6747319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6747323">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747327">rb1</span>&nbsp;<span class="op" id="6747331">:=</span>&nbsp;<span class="builtinfunc" id="6747334">make</span><span class="op" id="6747338">(</span><span class="op" id="6747339">[</span><span class="op" id="6747340">]</span><span class="builtintype" id="6747341">byte</span><span class="op" id="6747345">,</span>&nbsp;<span class="num" id="6747347">128</span><span class="op" id="6747350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747354">if</span>&nbsp;<span class="ident" id="6747357">_</span><span class="op" id="6747358">,</span>&nbsp;<span class="ident" id="6747360">_</span><span class="op" id="6747361">,</span>&nbsp;<span class="ident" id="6747363">err</span>&nbsp;<span class="op" id="6747367">:=</span>&nbsp;<span class="ident" id="6747370">c1</span><span class="op" id="6747372">.</span><span class="ident" id="6747373">ReadFrom</span><span class="op" id="6747381">(</span><span class="ident" id="6747382">rb1</span><span class="op" id="6747385">)</span><span class="op" id="6747386">;</span>&nbsp;<span class="ident" id="6747388">err</span>&nbsp;<span class="op" id="6747392">!=</span>&nbsp;<span class="builtintype" id="6747395">nil</span>&nbsp;<span class="op" id="6747399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747404">t</span><span class="op" id="6747405">.</span><span class="ident" id="6747406">Fatalf</span><span class="op" id="6747412">(</span><span class="string" id="6747413">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6747445">,</span>&nbsp;<span class="ident" id="6747447">err</span><span class="op" id="6747450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6747454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747458">var</span>&nbsp;<span class="ident" id="6747462">dst</span>&nbsp;<span class="ident" id="6747466">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747473">switch</span>&nbsp;<span class="ident" id="6747480">netstr</span><span class="op" id="6747486">[</span><span class="num" id="6747487">0</span><span class="op" id="6747488">]</span>&nbsp;<span class="op" id="6747490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747494">case</span>&nbsp;<span class="string" id="6747499">&#34;ip&#34;</span><span class="op" id="6747503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747508">dst</span>&nbsp;<span class="op" id="6747512">=</span>&nbsp;<span class="op" id="6747514">&amp;</span><span class="ident" id="6747515">IPAddr</span><span class="op" id="6747521">{</span><span class="ident" id="6747522">IP</span><span class="op" id="6747524">:</span>&nbsp;<span class="ident" id="6747526">IPv4</span><span class="op" id="6747530">(</span><span class="num" id="6747531">127</span><span class="op" id="6747534">,</span>&nbsp;<span class="num" id="6747536">0</span><span class="op" id="6747537">,</span>&nbsp;<span class="num" id="6747539">0</span><span class="op" id="6747540">,</span>&nbsp;<span class="num" id="6747542">1</span><span class="op" id="6747543">)</span><span class="op" id="6747544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747548">case</span>&nbsp;<span class="string" id="6747553">&#34;unixgram&#34;</span><span class="op" id="6747563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747568">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747579">default</span><span class="op" id="6747586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747591">dst</span>&nbsp;<span class="op" id="6747595">=</span>&nbsp;<span class="ident" id="6747597">c2</span><span class="op" id="6747599">.</span><span class="ident" id="6747600">LocalAddr</span><span class="op" id="6747609">(</span><span class="op" id="6747610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6747614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747618">if</span>&nbsp;<span class="ident" id="6747621">_</span><span class="op" id="6747622">,</span>&nbsp;<span class="ident" id="6747624">err</span>&nbsp;<span class="op" id="6747628">:=</span>&nbsp;<span class="ident" id="6747631">c1</span><span class="op" id="6747633">.</span><span class="ident" id="6747634">WriteTo</span><span class="op" id="6747641">(</span><span class="ident" id="6747642">wb</span><span class="op" id="6747644">,</span>&nbsp;<span class="ident" id="6747646">dst</span><span class="op" id="6747649">)</span><span class="op" id="6747650">;</span>&nbsp;<span class="ident" id="6747652">err</span>&nbsp;<span class="op" id="6747656">!=</span>&nbsp;<span class="builtintype" id="6747659">nil</span>&nbsp;<span class="op" id="6747663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747668">t</span><span class="op" id="6747669">.</span><span class="ident" id="6747670">Fatalf</span><span class="op" id="6747676">(</span><span class="string" id="6747677">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6747708">,</span>&nbsp;<span class="ident" id="6747710">err</span><span class="op" id="6747713">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6747717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747721">rb2</span>&nbsp;<span class="op" id="6747725">:=</span>&nbsp;<span class="builtinfunc" id="6747728">make</span><span class="op" id="6747732">(</span><span class="op" id="6747733">[</span><span class="op" id="6747734">]</span><span class="builtintype" id="6747735">byte</span><span class="op" id="6747739">,</span>&nbsp;<span class="num" id="6747741">128</span><span class="op" id="6747744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6747748">if</span>&nbsp;<span class="ident" id="6747751">_</span><span class="op" id="6747752">,</span>&nbsp;<span class="ident" id="6747754">err</span>&nbsp;<span class="op" id="6747758">:=</span>&nbsp;<span class="ident" id="6747761">c2</span><span class="op" id="6747763">.</span><span class="ident" id="6747764">Read</span><span class="op" id="6747768">(</span><span class="ident" id="6747769">rb2</span><span class="op" id="6747772">)</span><span class="op" id="6747773">;</span>&nbsp;<span class="ident" id="6747775">err</span>&nbsp;<span class="op" id="6747779">!=</span>&nbsp;<span class="builtintype" id="6747782">nil</span>&nbsp;<span class="op" id="6747786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6747791">t</span><span class="op" id="6747792">.</span><span class="ident" id="6747793">Fatalf</span><span class="op" id="6747799">(</span><span class="string" id="6747800">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6747822">,</span>&nbsp;<span class="ident" id="6747824">err</span><span class="op" id="6747827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6747831">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6747834">}</span><br>
<span class="lineno"></span><span class="op" id="6747836">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
