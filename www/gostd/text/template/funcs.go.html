<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html" class="current">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3236843">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3236898">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3236952">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3237003">package</span>&nbsp;<span class="ident" id="3237011">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3237021">import</span>&nbsp;<span class="op" id="3237028">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237031">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237040">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237050">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237057">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237063">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237074">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237085">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237096">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237107">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3237122">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3237125">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to&nbsp;functions.</span><br>
<span class="lineno">20</span><span class="comment" id="3237205">//&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two&nbsp;return&nbsp;values&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3237286">//&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the&nbsp;second&nbsp;(error)</span><br>
<span class="lineno"></span><span class="comment" id="3237358">//&nbsp;return&nbsp;value&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution&nbsp;terminates&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3237438">//&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3237469">type</span>&nbsp;<span class="ident" id="3237474">FuncMap</span>&nbsp;<span class="keyword" id="3237482">map</span><span class="op" id="3237485">[</span><span class="builtintype" id="3237486">string</span><span class="op" id="3237492">]</span><span class="keyword" id="3237493">interface</span><span class="op" id="3237502">{</span><span class="op" id="3237503">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3237506">var</span>&nbsp;<span class="ident" id="3237510">builtins</span>&nbsp;<span class="op" id="3237519">=</span>&nbsp;<span class="ident" id="3237521">FuncMap</span><span class="op" id="3237528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237531">&#34;and&#34;</span><span class="op" id="3237536">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237543">and</span><span class="op" id="3237546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237549">&#34;call&#34;</span><span class="op" id="3237555">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237561">call</span><span class="op" id="3237565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237568">&#34;html&#34;</span><span class="op" id="3237574">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237580">HTMLEscaper</span><span class="op" id="3237591">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237594">&#34;index&#34;</span><span class="op" id="3237601">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237606">index</span><span class="op" id="3237611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237614">&#34;js&#34;</span><span class="op" id="3237618">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237626">JSEscaper</span><span class="op" id="3237635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237638">&#34;len&#34;</span><span class="op" id="3237643">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237650">length</span><span class="op" id="3237656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237659">&#34;not&#34;</span><span class="op" id="3237664">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237671">not</span><span class="op" id="3237674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237677">&#34;or&#34;</span><span class="op" id="3237681">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237689">or</span><span class="op" id="3237691">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237694">&#34;print&#34;</span><span class="op" id="3237701">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237706">fmt</span><span class="op" id="3237709">.</span><span class="ident" id="3237710">Sprint</span><span class="op" id="3237716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237719">&#34;printf&#34;</span><span class="op" id="3237727">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3237731">fmt</span><span class="op" id="3237734">.</span><span class="ident" id="3237735">Sprintf</span><span class="op" id="3237742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237745">&#34;println&#34;</span><span class="op" id="3237754">:</span>&nbsp;&nbsp;<span class="ident" id="3237757">fmt</span><span class="op" id="3237760">.</span><span class="ident" id="3237761">Sprintln</span><span class="op" id="3237769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237772">&#34;urlquery&#34;</span><span class="op" id="3237782">:</span>&nbsp;<span class="ident" id="3237784">URLQueryEscaper</span><span class="op" id="3237799">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3237803">//&nbsp;Comparisons</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237819">&#34;eq&#34;</span><span class="op" id="3237823">:</span>&nbsp;<span class="ident" id="3237825">eq</span><span class="op" id="3237827">,</span>&nbsp;<span class="comment" id="3237829">//&nbsp;==</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237836">&#34;ge&#34;</span><span class="op" id="3237840">:</span>&nbsp;<span class="ident" id="3237842">ge</span><span class="op" id="3237844">,</span>&nbsp;<span class="comment" id="3237846">//&nbsp;&gt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237853">&#34;gt&#34;</span><span class="op" id="3237857">:</span>&nbsp;<span class="ident" id="3237859">gt</span><span class="op" id="3237861">,</span>&nbsp;<span class="comment" id="3237863">//&nbsp;&gt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237869">&#34;le&#34;</span><span class="op" id="3237873">:</span>&nbsp;<span class="ident" id="3237875">le</span><span class="op" id="3237877">,</span>&nbsp;<span class="comment" id="3237879">//&nbsp;&lt;=</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237886">&#34;lt&#34;</span><span class="op" id="3237890">:</span>&nbsp;<span class="ident" id="3237892">lt</span><span class="op" id="3237894">,</span>&nbsp;<span class="comment" id="3237896">//&nbsp;&lt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3237902">&#34;ne&#34;</span><span class="op" id="3237906">:</span>&nbsp;<span class="ident" id="3237908">ne</span><span class="op" id="3237910">,</span>&nbsp;<span class="comment" id="3237912">//&nbsp;!=</span><br>
<span class="lineno"></span><span class="op" id="3237918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3237921">var</span>&nbsp;<span class="ident" id="3237925">builtinFuncs</span>&nbsp;<span class="op" id="3237938">=</span>&nbsp;<span class="ident" id="3237940">createValueFuncs</span><span class="op" id="3237956">(</span><span class="ident" id="3237957">builtins</span><span class="op" id="3237965">)</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="3237968">//&nbsp;createValueFuncs&nbsp;turns&nbsp;a&nbsp;FuncMap&nbsp;into&nbsp;a&nbsp;map[string]reflect.Value</span><br>
<span class="lineno"></span><span class="keyword" id="3238036">func</span>&nbsp;<span class="ident" id="3238041">createValueFuncs</span><span class="op" id="3238057">(</span><span class="ident" id="3238058">funcMap</span>&nbsp;<span class="ident" id="3238066">FuncMap</span><span class="op" id="3238073">)</span>&nbsp;<span class="keyword" id="3238075">map</span><span class="op" id="3238078">[</span><span class="builtintype" id="3238079">string</span><span class="op" id="3238085">]</span><span class="ident" id="3238086">reflect</span><span class="op" id="3238093">.</span><span class="ident" id="3238094">Value</span>&nbsp;<span class="op" id="3238100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238103">m</span>&nbsp;<span class="op" id="3238105">:=</span>&nbsp;<span class="builtinfunc" id="3238108">make</span><span class="op" id="3238112">(</span><span class="keyword" id="3238113">map</span><span class="op" id="3238116">[</span><span class="builtintype" id="3238117">string</span><span class="op" id="3238123">]</span><span class="ident" id="3238124">reflect</span><span class="op" id="3238131">.</span><span class="ident" id="3238132">Value</span><span class="op" id="3238137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238140">addValueFuncs</span><span class="op" id="3238153">(</span><span class="ident" id="3238154">m</span><span class="op" id="3238155">,</span>&nbsp;<span class="ident" id="3238157">funcMap</span><span class="op" id="3238164">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238167">return</span>&nbsp;<span class="ident" id="3238174">m</span><br>
<span class="lineno"></span><span class="op" id="3238176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3238179">//&nbsp;addValueFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs,&nbsp;converting&nbsp;them&nbsp;to&nbsp;reflect.Values.</span><br>
<span class="lineno"></span><span class="keyword" id="3238270">func</span>&nbsp;<span class="ident" id="3238275">addValueFuncs</span><span class="op" id="3238288">(</span><span class="ident" id="3238289">out</span>&nbsp;<span class="keyword" id="3238293">map</span><span class="op" id="3238296">[</span><span class="builtintype" id="3238297">string</span><span class="op" id="3238303">]</span><span class="ident" id="3238304">reflect</span><span class="op" id="3238311">.</span><span class="ident" id="3238312">Value</span><span class="op" id="3238317">,</span>&nbsp;<span class="ident" id="3238319">in</span>&nbsp;<span class="ident" id="3238322">FuncMap</span><span class="op" id="3238329">)</span>&nbsp;<span class="op" id="3238331">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238334">for</span>&nbsp;<span class="ident" id="3238338">name</span><span class="op" id="3238342">,</span>&nbsp;<span class="ident" id="3238344">fn</span>&nbsp;<span class="op" id="3238347">:=</span>&nbsp;<span class="keyword" id="3238350">range</span>&nbsp;<span class="ident" id="3238356">in</span>&nbsp;<span class="op" id="3238359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238363">v</span>&nbsp;<span class="op" id="3238365">:=</span>&nbsp;<span class="ident" id="3238368">reflect</span><span class="op" id="3238375">.</span><span class="ident" id="3238376">ValueOf</span><span class="op" id="3238383">(</span><span class="ident" id="3238384">fn</span><span class="op" id="3238386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238390">if</span>&nbsp;<span class="ident" id="3238393">v</span><span class="op" id="3238394">.</span><span class="ident" id="3238395">Kind</span><span class="op" id="3238399">(</span><span class="op" id="3238400">)</span>&nbsp;<span class="op" id="3238402">!=</span>&nbsp;<span class="ident" id="3238405">reflect</span><span class="op" id="3238412">.</span><span class="ident" id="3238413">Func</span>&nbsp;<span class="op" id="3238418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3238423">panic</span><span class="op" id="3238428">(</span><span class="string" id="3238429">&#34;value&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="3238442">+</span>&nbsp;<span class="ident" id="3238444">name</span>&nbsp;<span class="op" id="3238449">+</span>&nbsp;<span class="string" id="3238451">&#34;&nbsp;not&nbsp;a&nbsp;function&#34;</span><span class="op" id="3238468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238472">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238476">if</span>&nbsp;<span class="op" id="3238479">!</span><span class="ident" id="3238480">goodFunc</span><span class="op" id="3238488">(</span><span class="ident" id="3238489">v</span><span class="op" id="3238490">.</span><span class="ident" id="3238491">Type</span><span class="op" id="3238495">(</span><span class="op" id="3238496">)</span><span class="op" id="3238497">)</span>&nbsp;<span class="op" id="3238499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3238504">panic</span><span class="op" id="3238509">(</span><span class="ident" id="3238510">fmt</span><span class="op" id="3238513">.</span><span class="ident" id="3238514">Errorf</span><span class="op" id="3238520">(</span><span class="string" id="3238521">&#34;can&#39;t&nbsp;install&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3238571">,</span>&nbsp;<span class="ident" id="3238573">name</span><span class="op" id="3238577">,</span>&nbsp;<span class="ident" id="3238579">v</span><span class="op" id="3238580">.</span><span class="ident" id="3238581">Type</span><span class="op" id="3238585">(</span><span class="op" id="3238586">)</span><span class="op" id="3238587">.</span><span class="ident" id="3238588">NumOut</span><span class="op" id="3238594">(</span><span class="op" id="3238595">)</span><span class="op" id="3238596">)</span><span class="op" id="3238597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238605">out</span><span class="op" id="3238608">[</span><span class="ident" id="3238609">name</span><span class="op" id="3238613">]</span>&nbsp;<span class="op" id="3238615">=</span>&nbsp;<span class="ident" id="3238617">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238620">}</span><br>
<span class="lineno">70</span><span class="op" id="3238622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3238625">//&nbsp;addFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs.&nbsp;It&nbsp;does&nbsp;no&nbsp;checking&nbsp;of&nbsp;the&nbsp;input&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="3238711">//&nbsp;call&nbsp;addValueFuncs&nbsp;first.</span><br>
<span class="lineno"></span><span class="keyword" id="3238740">func</span>&nbsp;<span class="ident" id="3238745">addFuncs</span><span class="op" id="3238753">(</span><span class="ident" id="3238754">out</span><span class="op" id="3238757">,</span>&nbsp;<span class="ident" id="3238759">in</span>&nbsp;<span class="ident" id="3238762">FuncMap</span><span class="op" id="3238769">)</span>&nbsp;<span class="op" id="3238771">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238774">for</span>&nbsp;<span class="ident" id="3238778">name</span><span class="op" id="3238782">,</span>&nbsp;<span class="ident" id="3238784">fn</span>&nbsp;<span class="op" id="3238787">:=</span>&nbsp;<span class="keyword" id="3238790">range</span>&nbsp;<span class="ident" id="3238796">in</span>&nbsp;<span class="op" id="3238799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238803">out</span><span class="op" id="3238806">[</span><span class="ident" id="3238807">name</span><span class="op" id="3238811">]</span>&nbsp;<span class="op" id="3238813">=</span>&nbsp;<span class="ident" id="3238815">fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238819">}</span><br>
<span class="lineno"></span><span class="op" id="3238821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3238824">//&nbsp;goodFunc&nbsp;checks&nbsp;that&nbsp;the&nbsp;function&nbsp;or&nbsp;method&nbsp;has&nbsp;the&nbsp;right&nbsp;result&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="3238903">func</span>&nbsp;<span class="ident" id="3238908">goodFunc</span><span class="op" id="3238916">(</span><span class="ident" id="3238917">typ</span>&nbsp;<span class="ident" id="3238921">reflect</span><span class="op" id="3238928">.</span><span class="ident" id="3238929">Type</span><span class="op" id="3238933">)</span>&nbsp;<span class="builtintype" id="3238935">bool</span>&nbsp;<span class="op" id="3238940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3238943">//&nbsp;We&nbsp;allow&nbsp;functions&nbsp;with&nbsp;1&nbsp;result&nbsp;or&nbsp;2&nbsp;results&nbsp;where&nbsp;the&nbsp;second&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239023">switch</span>&nbsp;<span class="op" id="3239030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239033">case</span>&nbsp;<span class="ident" id="3239038">typ</span><span class="op" id="3239041">.</span><span class="ident" id="3239042">NumOut</span><span class="op" id="3239048">(</span><span class="op" id="3239049">)</span>&nbsp;<span class="op" id="3239051">==</span>&nbsp;<span class="num" id="3239054">1</span><span class="op" id="3239055">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239059">return</span>&nbsp;<span class="builtintype" id="3239066">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239072">case</span>&nbsp;<span class="ident" id="3239077">typ</span><span class="op" id="3239080">.</span><span class="ident" id="3239081">NumOut</span><span class="op" id="3239087">(</span><span class="op" id="3239088">)</span>&nbsp;<span class="op" id="3239090">==</span>&nbsp;<span class="num" id="3239093">2</span>&nbsp;<span class="op" id="3239095">&amp;&amp;</span>&nbsp;<span class="ident" id="3239098">typ</span><span class="op" id="3239101">.</span><span class="ident" id="3239102">Out</span><span class="op" id="3239105">(</span><span class="num" id="3239106">1</span><span class="op" id="3239107">)</span>&nbsp;<span class="op" id="3239109">==</span>&nbsp;<span class="ident" id="3239112">errorType</span><span class="op" id="3239121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239125">return</span>&nbsp;<span class="builtintype" id="3239132">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3239138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239141">return</span>&nbsp;<span class="builtintype" id="3239148">false</span><br>
<span class="lineno">90</span><span class="op" id="3239154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3239157">//&nbsp;findFunction&nbsp;looks&nbsp;for&nbsp;a&nbsp;function&nbsp;in&nbsp;the&nbsp;template,&nbsp;and&nbsp;global&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="3239227">func</span>&nbsp;<span class="ident" id="3239232">findFunction</span><span class="op" id="3239244">(</span><span class="ident" id="3239245">name</span>&nbsp;<span class="builtintype" id="3239250">string</span><span class="op" id="3239256">,</span>&nbsp;<span class="ident" id="3239258">tmpl</span>&nbsp;<span class="op" id="3239263">*</span><span class="ident" id="3239264">Template</span><span class="op" id="3239272">)</span>&nbsp;<span class="op" id="3239274">(</span><span class="ident" id="3239275">reflect</span><span class="op" id="3239282">.</span><span class="ident" id="3239283">Value</span><span class="op" id="3239288">,</span>&nbsp;<span class="builtintype" id="3239290">bool</span><span class="op" id="3239294">)</span>&nbsp;<span class="op" id="3239296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239299">if</span>&nbsp;<span class="ident" id="3239302">tmpl</span>&nbsp;<span class="op" id="3239307">!=</span>&nbsp;<span class="ident" id="3239310">nil</span>&nbsp;<span class="op" id="3239314">&amp;&amp;</span>&nbsp;<span class="ident" id="3239317">tmpl</span><span class="op" id="3239321">.</span><span class="ident" id="3239322">common</span>&nbsp;<span class="op" id="3239329">!=</span>&nbsp;<span class="ident" id="3239332">nil</span>&nbsp;<span class="op" id="3239336">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239340">if</span>&nbsp;<span class="ident" id="3239343">fn</span>&nbsp;<span class="op" id="3239346">:=</span>&nbsp;<span class="ident" id="3239349">tmpl</span><span class="op" id="3239353">.</span><span class="ident" id="3239354">execFuncs</span><span class="op" id="3239363">[</span><span class="ident" id="3239364">name</span><span class="op" id="3239368">]</span><span class="op" id="3239369">;</span>&nbsp;<span class="ident" id="3239371">fn</span><span class="op" id="3239373">.</span><span class="ident" id="3239374">IsValid</span><span class="op" id="3239381">(</span><span class="op" id="3239382">)</span>&nbsp;<span class="op" id="3239384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239389">return</span>&nbsp;<span class="ident" id="3239396">fn</span><span class="op" id="3239398">,</span>&nbsp;<span class="builtintype" id="3239400">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3239407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3239410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239413">if</span>&nbsp;<span class="ident" id="3239416">fn</span>&nbsp;<span class="op" id="3239419">:=</span>&nbsp;<span class="ident" id="3239422">builtinFuncs</span><span class="op" id="3239434">[</span><span class="ident" id="3239435">name</span><span class="op" id="3239439">]</span><span class="op" id="3239440">;</span>&nbsp;<span class="ident" id="3239442">fn</span><span class="op" id="3239444">.</span><span class="ident" id="3239445">IsValid</span><span class="op" id="3239452">(</span><span class="op" id="3239453">)</span>&nbsp;<span class="op" id="3239455">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239459">return</span>&nbsp;<span class="ident" id="3239466">fn</span><span class="op" id="3239468">,</span>&nbsp;<span class="builtintype" id="3239470">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3239476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239479">return</span>&nbsp;<span class="ident" id="3239486">reflect</span><span class="op" id="3239493">.</span><span class="ident" id="3239494">Value</span><span class="op" id="3239499">{</span><span class="op" id="3239500">}</span><span class="op" id="3239501">,</span>&nbsp;<span class="builtintype" id="3239503">false</span><br>
<span class="lineno"></span><span class="op" id="3239509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="3239512">//&nbsp;Indexing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3239526">//&nbsp;index&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;indexing&nbsp;its&nbsp;first&nbsp;argument&nbsp;by&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="3239602">//&nbsp;arguments.&nbsp;&nbsp;Thus&nbsp;&#34;index&nbsp;x&nbsp;1&nbsp;2&nbsp;3&#34;&nbsp;is,&nbsp;in&nbsp;Go&nbsp;syntax,&nbsp;x[1][2][3].&nbsp;Each</span><br>
<span class="lineno"></span><span class="comment" id="3239673">//&nbsp;indexed&nbsp;item&nbsp;must&nbsp;be&nbsp;a&nbsp;map,&nbsp;slice,&nbsp;or&nbsp;array.</span><br>
<span class="lineno">110</span><span class="keyword" id="3239721">func</span>&nbsp;<span class="ident" id="3239726">index</span><span class="op" id="3239731">(</span><span class="ident" id="3239732">item</span>&nbsp;<span class="keyword" id="3239737">interface</span><span class="op" id="3239746">{</span><span class="op" id="3239747">}</span><span class="op" id="3239748">,</span>&nbsp;<span class="ident" id="3239750">indices</span>&nbsp;<span class="op" id="3239758">...</span><span class="keyword" id="3239761">interface</span><span class="op" id="3239770">{</span><span class="op" id="3239771">}</span><span class="op" id="3239772">)</span>&nbsp;<span class="op" id="3239774">(</span><span class="keyword" id="3239775">interface</span><span class="op" id="3239784">{</span><span class="op" id="3239785">}</span><span class="op" id="3239786">,</span>&nbsp;<span class="builtintype" id="3239788">error</span><span class="op" id="3239793">)</span>&nbsp;<span class="op" id="3239795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3239798">v</span>&nbsp;<span class="op" id="3239800">:=</span>&nbsp;<span class="ident" id="3239803">reflect</span><span class="op" id="3239810">.</span><span class="ident" id="3239811">ValueOf</span><span class="op" id="3239818">(</span><span class="ident" id="3239819">item</span><span class="op" id="3239823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239826">for</span>&nbsp;<span class="ident" id="3239830">_</span><span class="op" id="3239831">,</span>&nbsp;<span class="ident" id="3239833">i</span>&nbsp;<span class="op" id="3239835">:=</span>&nbsp;<span class="keyword" id="3239838">range</span>&nbsp;<span class="ident" id="3239844">indices</span>&nbsp;<span class="op" id="3239852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3239856">index</span>&nbsp;<span class="op" id="3239862">:=</span>&nbsp;<span class="ident" id="3239865">reflect</span><span class="op" id="3239872">.</span><span class="ident" id="3239873">ValueOf</span><span class="op" id="3239880">(</span><span class="ident" id="3239881">i</span><span class="op" id="3239882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239886">var</span>&nbsp;<span class="ident" id="3239890">isNil</span>&nbsp;<span class="builtintype" id="3239896">bool</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239903">if</span>&nbsp;<span class="ident" id="3239906">v</span><span class="op" id="3239907">,</span>&nbsp;<span class="ident" id="3239909">isNil</span>&nbsp;<span class="op" id="3239915">=</span>&nbsp;<span class="ident" id="3239917">indirect</span><span class="op" id="3239925">(</span><span class="ident" id="3239926">v</span><span class="op" id="3239927">)</span><span class="op" id="3239928">;</span>&nbsp;<span class="ident" id="3239930">isNil</span>&nbsp;<span class="op" id="3239936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239941">return</span>&nbsp;<span class="ident" id="3239948">nil</span><span class="op" id="3239951">,</span>&nbsp;<span class="ident" id="3239953">fmt</span><span class="op" id="3239956">.</span><span class="ident" id="3239957">Errorf</span><span class="op" id="3239963">(</span><span class="string" id="3239964">&#34;index&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3239986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3239990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239994">switch</span>&nbsp;<span class="ident" id="3240001">v</span><span class="op" id="3240002">.</span><span class="ident" id="3240003">Kind</span><span class="op" id="3240007">(</span><span class="op" id="3240008">)</span>&nbsp;<span class="op" id="3240010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240014">case</span>&nbsp;<span class="ident" id="3240019">reflect</span><span class="op" id="3240026">.</span><span class="ident" id="3240027">Array</span><span class="op" id="3240032">,</span>&nbsp;<span class="ident" id="3240034">reflect</span><span class="op" id="3240041">.</span><span class="ident" id="3240042">Slice</span><span class="op" id="3240047">,</span>&nbsp;<span class="ident" id="3240049">reflect</span><span class="op" id="3240056">.</span><span class="ident" id="3240057">String</span><span class="op" id="3240063">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240068">var</span>&nbsp;<span class="ident" id="3240072">x</span>&nbsp;<span class="ident" id="3240074">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240083">switch</span>&nbsp;<span class="ident" id="3240090">index</span><span class="op" id="3240095">.</span><span class="ident" id="3240096">Kind</span><span class="op" id="3240100">(</span><span class="op" id="3240101">)</span>&nbsp;<span class="op" id="3240103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240108">case</span>&nbsp;<span class="ident" id="3240113">reflect</span><span class="op" id="3240120">.</span><span class="ident" id="3240121">Int</span><span class="op" id="3240124">,</span>&nbsp;<span class="ident" id="3240126">reflect</span><span class="op" id="3240133">.</span><span class="ident" id="3240134">Int8</span><span class="op" id="3240138">,</span>&nbsp;<span class="ident" id="3240140">reflect</span><span class="op" id="3240147">.</span><span class="ident" id="3240148">Int16</span><span class="op" id="3240153">,</span>&nbsp;<span class="ident" id="3240155">reflect</span><span class="op" id="3240162">.</span><span class="ident" id="3240163">Int32</span><span class="op" id="3240168">,</span>&nbsp;<span class="ident" id="3240170">reflect</span><span class="op" id="3240177">.</span><span class="ident" id="3240178">Int64</span><span class="op" id="3240183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240189">x</span>&nbsp;<span class="op" id="3240191">=</span>&nbsp;<span class="ident" id="3240193">index</span><span class="op" id="3240198">.</span><span class="ident" id="3240199">Int</span><span class="op" id="3240202">(</span><span class="op" id="3240203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240208">case</span>&nbsp;<span class="ident" id="3240213">reflect</span><span class="op" id="3240220">.</span><span class="ident" id="3240221">Uint</span><span class="op" id="3240225">,</span>&nbsp;<span class="ident" id="3240227">reflect</span><span class="op" id="3240234">.</span><span class="ident" id="3240235">Uint8</span><span class="op" id="3240240">,</span>&nbsp;<span class="ident" id="3240242">reflect</span><span class="op" id="3240249">.</span><span class="ident" id="3240250">Uint16</span><span class="op" id="3240256">,</span>&nbsp;<span class="ident" id="3240258">reflect</span><span class="op" id="3240265">.</span><span class="ident" id="3240266">Uint32</span><span class="op" id="3240272">,</span>&nbsp;<span class="ident" id="3240274">reflect</span><span class="op" id="3240281">.</span><span class="ident" id="3240282">Uint64</span><span class="op" id="3240288">,</span>&nbsp;<span class="ident" id="3240290">reflect</span><span class="op" id="3240297">.</span><span class="ident" id="3240298">Uintptr</span><span class="op" id="3240305">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240311">x</span>&nbsp;<span class="op" id="3240313">=</span>&nbsp;<span class="ident" id="3240315">int64</span><span class="op" id="3240320">(</span><span class="ident" id="3240321">index</span><span class="op" id="3240326">.</span><span class="ident" id="3240327">Uint</span><span class="op" id="3240331">(</span><span class="op" id="3240332">)</span><span class="op" id="3240333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240338">default</span><span class="op" id="3240345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240351">return</span>&nbsp;<span class="ident" id="3240358">nil</span><span class="op" id="3240361">,</span>&nbsp;<span class="ident" id="3240363">fmt</span><span class="op" id="3240366">.</span><span class="ident" id="3240367">Errorf</span><span class="op" id="3240373">(</span><span class="string" id="3240374">&#34;cannot&nbsp;index&nbsp;slice/array&nbsp;with&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3240413">,</span>&nbsp;<span class="ident" id="3240415">index</span><span class="op" id="3240420">.</span><span class="ident" id="3240421">Type</span><span class="op" id="3240425">(</span><span class="op" id="3240426">)</span><span class="op" id="3240427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240437">if</span>&nbsp;<span class="ident" id="3240440">x</span>&nbsp;<span class="op" id="3240442">&lt;</span>&nbsp;<span class="num" id="3240444">0</span>&nbsp;<span class="op" id="3240446">||</span>&nbsp;<span class="ident" id="3240449">x</span>&nbsp;<span class="op" id="3240451">&gt;=</span>&nbsp;<span class="ident" id="3240454">int64</span><span class="op" id="3240459">(</span><span class="ident" id="3240460">v</span><span class="op" id="3240461">.</span><span class="ident" id="3240462">Len</span><span class="op" id="3240465">(</span><span class="op" id="3240466">)</span><span class="op" id="3240467">)</span>&nbsp;<span class="op" id="3240469">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240475">return</span>&nbsp;<span class="ident" id="3240482">nil</span><span class="op" id="3240485">,</span>&nbsp;<span class="ident" id="3240487">fmt</span><span class="op" id="3240490">.</span><span class="ident" id="3240491">Errorf</span><span class="op" id="3240497">(</span><span class="string" id="3240498">&#34;index&nbsp;out&nbsp;of&nbsp;range:&nbsp;%d&#34;</span><span class="op" id="3240522">,</span>&nbsp;<span class="ident" id="3240524">x</span><span class="op" id="3240525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240535">v</span>&nbsp;<span class="op" id="3240537">=</span>&nbsp;<span class="ident" id="3240539">v</span><span class="op" id="3240540">.</span><span class="ident" id="3240541">Index</span><span class="op" id="3240546">(</span><span class="builtintype" id="3240547">int</span><span class="op" id="3240550">(</span><span class="ident" id="3240551">x</span><span class="op" id="3240552">)</span><span class="op" id="3240553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240557">case</span>&nbsp;<span class="ident" id="3240562">reflect</span><span class="op" id="3240569">.</span><span class="ident" id="3240570">Map</span><span class="op" id="3240573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240578">if</span>&nbsp;<span class="op" id="3240581">!</span><span class="ident" id="3240582">index</span><span class="op" id="3240587">.</span><span class="ident" id="3240588">IsValid</span><span class="op" id="3240595">(</span><span class="op" id="3240596">)</span>&nbsp;<span class="op" id="3240598">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240604">index</span>&nbsp;<span class="op" id="3240610">=</span>&nbsp;<span class="ident" id="3240612">reflect</span><span class="op" id="3240619">.</span><span class="ident" id="3240620">Zero</span><span class="op" id="3240624">(</span><span class="ident" id="3240625">v</span><span class="op" id="3240626">.</span><span class="ident" id="3240627">Type</span><span class="op" id="3240631">(</span><span class="op" id="3240632">)</span><span class="op" id="3240633">.</span><span class="ident" id="3240634">Key</span><span class="op" id="3240637">(</span><span class="op" id="3240638">)</span><span class="op" id="3240639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240649">if</span>&nbsp;<span class="op" id="3240652">!</span><span class="ident" id="3240653">index</span><span class="op" id="3240658">.</span><span class="ident" id="3240659">Type</span><span class="op" id="3240663">(</span><span class="op" id="3240664">)</span><span class="op" id="3240665">.</span><span class="ident" id="3240666">AssignableTo</span><span class="op" id="3240678">(</span><span class="ident" id="3240679">v</span><span class="op" id="3240680">.</span><span class="ident" id="3240681">Type</span><span class="op" id="3240685">(</span><span class="op" id="3240686">)</span><span class="op" id="3240687">.</span><span class="ident" id="3240688">Key</span><span class="op" id="3240691">(</span><span class="op" id="3240692">)</span><span class="op" id="3240693">)</span>&nbsp;<span class="op" id="3240695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240701">return</span>&nbsp;<span class="ident" id="3240708">nil</span><span class="op" id="3240711">,</span>&nbsp;<span class="ident" id="3240713">fmt</span><span class="op" id="3240716">.</span><span class="ident" id="3240717">Errorf</span><span class="op" id="3240723">(</span><span class="string" id="3240724">&#34;%s&nbsp;is&nbsp;not&nbsp;index&nbsp;type&nbsp;for&nbsp;%s&#34;</span><span class="op" id="3240753">,</span>&nbsp;<span class="ident" id="3240755">index</span><span class="op" id="3240760">.</span><span class="ident" id="3240761">Type</span><span class="op" id="3240765">(</span><span class="op" id="3240766">)</span><span class="op" id="3240767">,</span>&nbsp;<span class="ident" id="3240769">v</span><span class="op" id="3240770">.</span><span class="ident" id="3240771">Type</span><span class="op" id="3240775">(</span><span class="op" id="3240776">)</span><span class="op" id="3240777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240782">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240787">if</span>&nbsp;<span class="ident" id="3240790">x</span>&nbsp;<span class="op" id="3240792">:=</span>&nbsp;<span class="ident" id="3240795">v</span><span class="op" id="3240796">.</span><span class="ident" id="3240797">MapIndex</span><span class="op" id="3240805">(</span><span class="ident" id="3240806">index</span><span class="op" id="3240811">)</span><span class="op" id="3240812">;</span>&nbsp;<span class="ident" id="3240814">x</span><span class="op" id="3240815">.</span><span class="ident" id="3240816">IsValid</span><span class="op" id="3240823">(</span><span class="op" id="3240824">)</span>&nbsp;<span class="op" id="3240826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240832">v</span>&nbsp;<span class="op" id="3240834">=</span>&nbsp;<span class="ident" id="3240836">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240841">}</span>&nbsp;<span class="keyword" id="3240843">else</span>&nbsp;<span class="op" id="3240848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240854">v</span>&nbsp;<span class="op" id="3240856">=</span>&nbsp;<span class="ident" id="3240858">reflect</span><span class="op" id="3240865">.</span><span class="ident" id="3240866">Zero</span><span class="op" id="3240870">(</span><span class="ident" id="3240871">v</span><span class="op" id="3240872">.</span><span class="ident" id="3240873">Type</span><span class="op" id="3240877">(</span><span class="op" id="3240878">)</span><span class="op" id="3240879">.</span><span class="ident" id="3240880">Elem</span><span class="op" id="3240884">(</span><span class="op" id="3240885">)</span><span class="op" id="3240886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240891">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240895">default</span><span class="op" id="3240902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240907">return</span>&nbsp;<span class="ident" id="3240914">nil</span><span class="op" id="3240917">,</span>&nbsp;<span class="ident" id="3240919">fmt</span><span class="op" id="3240922">.</span><span class="ident" id="3240923">Errorf</span><span class="op" id="3240929">(</span><span class="string" id="3240930">&#34;can&#39;t&nbsp;index&nbsp;item&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3240959">,</span>&nbsp;<span class="ident" id="3240961">v</span><span class="op" id="3240962">.</span><span class="ident" id="3240963">Type</span><span class="op" id="3240967">(</span><span class="op" id="3240968">)</span><span class="op" id="3240969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240979">return</span>&nbsp;<span class="ident" id="3240986">v</span><span class="op" id="3240987">.</span><span class="ident" id="3240988">Interface</span><span class="op" id="3240997">(</span><span class="op" id="3240998">)</span><span class="op" id="3240999">,</span>&nbsp;<span class="ident" id="3241001">nil</span><br>
<span class="lineno">150</span><span class="op" id="3241005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3241008">//&nbsp;Length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3241019">//&nbsp;length&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;item,&nbsp;with&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;defined&nbsp;length.</span><br>
<span class="lineno">155</span><span class="keyword" id="3241104">func</span>&nbsp;<span class="ident" id="3241109">length</span><span class="op" id="3241115">(</span><span class="ident" id="3241116">item</span>&nbsp;<span class="keyword" id="3241121">interface</span><span class="op" id="3241130">{</span><span class="op" id="3241131">}</span><span class="op" id="3241132">)</span>&nbsp;<span class="op" id="3241134">(</span><span class="builtintype" id="3241135">int</span><span class="op" id="3241138">,</span>&nbsp;<span class="builtintype" id="3241140">error</span><span class="op" id="3241145">)</span>&nbsp;<span class="op" id="3241147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3241150">v</span><span class="op" id="3241151">,</span>&nbsp;<span class="ident" id="3241153">isNil</span>&nbsp;<span class="op" id="3241159">:=</span>&nbsp;<span class="ident" id="3241162">indirect</span><span class="op" id="3241170">(</span><span class="ident" id="3241171">reflect</span><span class="op" id="3241178">.</span><span class="ident" id="3241179">ValueOf</span><span class="op" id="3241186">(</span><span class="ident" id="3241187">item</span><span class="op" id="3241191">)</span><span class="op" id="3241192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241195">if</span>&nbsp;<span class="ident" id="3241198">isNil</span>&nbsp;<span class="op" id="3241204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241208">return</span>&nbsp;<span class="num" id="3241215">0</span><span class="op" id="3241216">,</span>&nbsp;<span class="ident" id="3241218">fmt</span><span class="op" id="3241221">.</span><span class="ident" id="3241222">Errorf</span><span class="op" id="3241228">(</span><span class="string" id="3241229">&#34;len&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3241249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3241252">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241255">switch</span>&nbsp;<span class="ident" id="3241262">v</span><span class="op" id="3241263">.</span><span class="ident" id="3241264">Kind</span><span class="op" id="3241268">(</span><span class="op" id="3241269">)</span>&nbsp;<span class="op" id="3241271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241274">case</span>&nbsp;<span class="ident" id="3241279">reflect</span><span class="op" id="3241286">.</span><span class="ident" id="3241287">Array</span><span class="op" id="3241292">,</span>&nbsp;<span class="ident" id="3241294">reflect</span><span class="op" id="3241301">.</span><span class="ident" id="3241302">Chan</span><span class="op" id="3241306">,</span>&nbsp;<span class="ident" id="3241308">reflect</span><span class="op" id="3241315">.</span><span class="ident" id="3241316">Map</span><span class="op" id="3241319">,</span>&nbsp;<span class="ident" id="3241321">reflect</span><span class="op" id="3241328">.</span><span class="ident" id="3241329">Slice</span><span class="op" id="3241334">,</span>&nbsp;<span class="ident" id="3241336">reflect</span><span class="op" id="3241343">.</span><span class="ident" id="3241344">String</span><span class="op" id="3241350">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241354">return</span>&nbsp;<span class="ident" id="3241361">v</span><span class="op" id="3241362">.</span><span class="ident" id="3241363">Len</span><span class="op" id="3241366">(</span><span class="op" id="3241367">)</span><span class="op" id="3241368">,</span>&nbsp;<span class="ident" id="3241370">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3241375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241378">return</span>&nbsp;<span class="num" id="3241385">0</span><span class="op" id="3241386">,</span>&nbsp;<span class="ident" id="3241388">fmt</span><span class="op" id="3241391">.</span><span class="ident" id="3241392">Errorf</span><span class="op" id="3241398">(</span><span class="string" id="3241399">&#34;len&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3241415">,</span>&nbsp;<span class="ident" id="3241417">v</span><span class="op" id="3241418">.</span><span class="ident" id="3241419">Type</span><span class="op" id="3241423">(</span><span class="op" id="3241424">)</span><span class="op" id="3241425">)</span><br>
<span class="lineno">165</span><span class="op" id="3241427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3241430">//&nbsp;Function&nbsp;invocation</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3241454">//&nbsp;call&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;evaluating&nbsp;the&nbsp;first&nbsp;argument&nbsp;as&nbsp;a&nbsp;function.</span><br>
<span class="lineno">170</span><span class="comment" id="3241529">//&nbsp;The&nbsp;function&nbsp;must&nbsp;return&nbsp;1&nbsp;result,&nbsp;or&nbsp;2&nbsp;results,&nbsp;the&nbsp;second&nbsp;of&nbsp;which&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3241614">func</span>&nbsp;<span class="ident" id="3241619">call</span><span class="op" id="3241623">(</span><span class="ident" id="3241624">fn</span>&nbsp;<span class="keyword" id="3241627">interface</span><span class="op" id="3241636">{</span><span class="op" id="3241637">}</span><span class="op" id="3241638">,</span>&nbsp;<span class="ident" id="3241640">args</span>&nbsp;<span class="op" id="3241645">...</span><span class="keyword" id="3241648">interface</span><span class="op" id="3241657">{</span><span class="op" id="3241658">}</span><span class="op" id="3241659">)</span>&nbsp;<span class="op" id="3241661">(</span><span class="keyword" id="3241662">interface</span><span class="op" id="3241671">{</span><span class="op" id="3241672">}</span><span class="op" id="3241673">,</span>&nbsp;<span class="builtintype" id="3241675">error</span><span class="op" id="3241680">)</span>&nbsp;<span class="op" id="3241682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3241685">v</span>&nbsp;<span class="op" id="3241687">:=</span>&nbsp;<span class="ident" id="3241690">reflect</span><span class="op" id="3241697">.</span><span class="ident" id="3241698">ValueOf</span><span class="op" id="3241705">(</span><span class="ident" id="3241706">fn</span><span class="op" id="3241708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3241711">typ</span>&nbsp;<span class="op" id="3241715">:=</span>&nbsp;<span class="ident" id="3241718">v</span><span class="op" id="3241719">.</span><span class="ident" id="3241720">Type</span><span class="op" id="3241724">(</span><span class="op" id="3241725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241728">if</span>&nbsp;<span class="ident" id="3241731">typ</span><span class="op" id="3241734">.</span><span class="ident" id="3241735">Kind</span><span class="op" id="3241739">(</span><span class="op" id="3241740">)</span>&nbsp;<span class="op" id="3241742">!=</span>&nbsp;<span class="ident" id="3241745">reflect</span><span class="op" id="3241752">.</span><span class="ident" id="3241753">Func</span>&nbsp;<span class="op" id="3241758">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241762">return</span>&nbsp;<span class="ident" id="3241769">nil</span><span class="op" id="3241772">,</span>&nbsp;<span class="ident" id="3241774">fmt</span><span class="op" id="3241777">.</span><span class="ident" id="3241778">Errorf</span><span class="op" id="3241784">(</span><span class="string" id="3241785">&#34;non-function&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3241810">,</span>&nbsp;<span class="ident" id="3241812">typ</span><span class="op" id="3241815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3241818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241821">if</span>&nbsp;<span class="op" id="3241824">!</span><span class="ident" id="3241825">goodFunc</span><span class="op" id="3241833">(</span><span class="ident" id="3241834">typ</span><span class="op" id="3241837">)</span>&nbsp;<span class="op" id="3241839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241843">return</span>&nbsp;<span class="ident" id="3241850">nil</span><span class="op" id="3241853">,</span>&nbsp;<span class="ident" id="3241855">fmt</span><span class="op" id="3241858">.</span><span class="ident" id="3241859">Errorf</span><span class="op" id="3241865">(</span><span class="string" id="3241866">&#34;function&nbsp;called&nbsp;with&nbsp;%d&nbsp;args;&nbsp;should&nbsp;be&nbsp;1&nbsp;or&nbsp;2&#34;</span><span class="op" id="3241914">,</span>&nbsp;<span class="ident" id="3241916">typ</span><span class="op" id="3241919">.</span><span class="ident" id="3241920">NumOut</span><span class="op" id="3241926">(</span><span class="op" id="3241927">)</span><span class="op" id="3241928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3241931">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3241934">numIn</span>&nbsp;<span class="op" id="3241940">:=</span>&nbsp;<span class="ident" id="3241943">typ</span><span class="op" id="3241946">.</span><span class="ident" id="3241947">NumIn</span><span class="op" id="3241952">(</span><span class="op" id="3241953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241956">var</span>&nbsp;<span class="ident" id="3241960">dddType</span>&nbsp;<span class="ident" id="3241968">reflect</span><span class="op" id="3241975">.</span><span class="ident" id="3241976">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3241982">if</span>&nbsp;<span class="ident" id="3241985">typ</span><span class="op" id="3241988">.</span><span class="ident" id="3241989">IsVariadic</span><span class="op" id="3241999">(</span><span class="op" id="3242000">)</span>&nbsp;<span class="op" id="3242002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242006">if</span>&nbsp;<span class="builtinfunc" id="3242009">len</span><span class="op" id="3242012">(</span><span class="ident" id="3242013">args</span><span class="op" id="3242017">)</span>&nbsp;<span class="op" id="3242019">&lt;</span>&nbsp;<span class="ident" id="3242021">numIn</span><span class="op" id="3242026">-</span><span class="num" id="3242027">1</span>&nbsp;<span class="op" id="3242029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242034">return</span>&nbsp;<span class="ident" id="3242041">nil</span><span class="op" id="3242044">,</span>&nbsp;<span class="ident" id="3242046">fmt</span><span class="op" id="3242049">.</span><span class="ident" id="3242050">Errorf</span><span class="op" id="3242056">(</span><span class="string" id="3242057">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&#34;</span><span class="op" id="3242104">,</span>&nbsp;<span class="builtinfunc" id="3242106">len</span><span class="op" id="3242109">(</span><span class="ident" id="3242110">args</span><span class="op" id="3242114">)</span><span class="op" id="3242115">,</span>&nbsp;<span class="ident" id="3242117">numIn</span><span class="op" id="3242122">-</span><span class="num" id="3242123">1</span><span class="op" id="3242124">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3242132">dddType</span>&nbsp;<span class="op" id="3242140">=</span>&nbsp;<span class="ident" id="3242142">typ</span><span class="op" id="3242145">.</span><span class="ident" id="3242146">In</span><span class="op" id="3242148">(</span><span class="ident" id="3242149">numIn</span>&nbsp;<span class="op" id="3242155">-</span>&nbsp;<span class="num" id="3242157">1</span><span class="op" id="3242158">)</span><span class="op" id="3242159">.</span><span class="ident" id="3242160">Elem</span><span class="op" id="3242164">(</span><span class="op" id="3242165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242168">}</span>&nbsp;<span class="keyword" id="3242170">else</span>&nbsp;<span class="op" id="3242175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242179">if</span>&nbsp;<span class="builtinfunc" id="3242182">len</span><span class="op" id="3242185">(</span><span class="ident" id="3242186">args</span><span class="op" id="3242190">)</span>&nbsp;<span class="op" id="3242192">!=</span>&nbsp;<span class="ident" id="3242195">numIn</span>&nbsp;<span class="op" id="3242201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242206">return</span>&nbsp;<span class="ident" id="3242213">nil</span><span class="op" id="3242216">,</span>&nbsp;<span class="ident" id="3242218">fmt</span><span class="op" id="3242221">.</span><span class="ident" id="3242222">Errorf</span><span class="op" id="3242228">(</span><span class="string" id="3242229">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="3242267">,</span>&nbsp;<span class="builtinfunc" id="3242269">len</span><span class="op" id="3242272">(</span><span class="ident" id="3242273">args</span><span class="op" id="3242277">)</span><span class="op" id="3242278">,</span>&nbsp;<span class="ident" id="3242280">numIn</span><span class="op" id="3242285">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3242295">argv</span>&nbsp;<span class="op" id="3242300">:=</span>&nbsp;<span class="builtinfunc" id="3242303">make</span><span class="op" id="3242307">(</span><span class="op" id="3242308">[</span><span class="op" id="3242309">]</span><span class="ident" id="3242310">reflect</span><span class="op" id="3242317">.</span><span class="ident" id="3242318">Value</span><span class="op" id="3242323">,</span>&nbsp;<span class="builtinfunc" id="3242325">len</span><span class="op" id="3242328">(</span><span class="ident" id="3242329">args</span><span class="op" id="3242333">)</span><span class="op" id="3242334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242337">for</span>&nbsp;<span class="ident" id="3242341">i</span><span class="op" id="3242342">,</span>&nbsp;<span class="ident" id="3242344">arg</span>&nbsp;<span class="op" id="3242348">:=</span>&nbsp;<span class="keyword" id="3242351">range</span>&nbsp;<span class="ident" id="3242357">args</span>&nbsp;<span class="op" id="3242362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3242366">value</span>&nbsp;<span class="op" id="3242372">:=</span>&nbsp;<span class="ident" id="3242375">reflect</span><span class="op" id="3242382">.</span><span class="ident" id="3242383">ValueOf</span><span class="op" id="3242390">(</span><span class="ident" id="3242391">arg</span><span class="op" id="3242394">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3242398">//&nbsp;Compute&nbsp;the&nbsp;expected&nbsp;type.&nbsp;Clumsy&nbsp;because&nbsp;of&nbsp;variadics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242459">var</span>&nbsp;<span class="ident" id="3242463">argType</span>&nbsp;<span class="ident" id="3242471">reflect</span><span class="op" id="3242478">.</span><span class="ident" id="3242479">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242486">if</span>&nbsp;<span class="op" id="3242489">!</span><span class="ident" id="3242490">typ</span><span class="op" id="3242493">.</span><span class="ident" id="3242494">IsVariadic</span><span class="op" id="3242504">(</span><span class="op" id="3242505">)</span>&nbsp;<span class="op" id="3242507">||</span>&nbsp;<span class="ident" id="3242510">i</span>&nbsp;<span class="op" id="3242512">&lt;</span>&nbsp;<span class="ident" id="3242514">numIn</span><span class="op" id="3242519">-</span><span class="num" id="3242520">1</span>&nbsp;<span class="op" id="3242522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3242527">argType</span>&nbsp;<span class="op" id="3242535">=</span>&nbsp;<span class="ident" id="3242537">typ</span><span class="op" id="3242540">.</span><span class="ident" id="3242541">In</span><span class="op" id="3242543">(</span><span class="ident" id="3242544">i</span><span class="op" id="3242545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242549">}</span>&nbsp;<span class="keyword" id="3242551">else</span>&nbsp;<span class="op" id="3242556">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3242561">argType</span>&nbsp;<span class="op" id="3242569">=</span>&nbsp;<span class="ident" id="3242571">dddType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242585">if</span>&nbsp;<span class="op" id="3242588">!</span><span class="ident" id="3242589">value</span><span class="op" id="3242594">.</span><span class="ident" id="3242595">IsValid</span><span class="op" id="3242602">(</span><span class="op" id="3242603">)</span>&nbsp;<span class="op" id="3242605">&amp;&amp;</span>&nbsp;<span class="ident" id="3242608">canBeNil</span><span class="op" id="3242616">(</span><span class="ident" id="3242617">argType</span><span class="op" id="3242624">)</span>&nbsp;<span class="op" id="3242626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3242631">value</span>&nbsp;<span class="op" id="3242637">=</span>&nbsp;<span class="ident" id="3242639">reflect</span><span class="op" id="3242646">.</span><span class="ident" id="3242647">Zero</span><span class="op" id="3242651">(</span><span class="ident" id="3242652">argType</span><span class="op" id="3242659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242663">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242667">if</span>&nbsp;<span class="op" id="3242670">!</span><span class="ident" id="3242671">value</span><span class="op" id="3242676">.</span><span class="ident" id="3242677">Type</span><span class="op" id="3242681">(</span><span class="op" id="3242682">)</span><span class="op" id="3242683">.</span><span class="ident" id="3242684">AssignableTo</span><span class="op" id="3242696">(</span><span class="ident" id="3242697">argType</span><span class="op" id="3242704">)</span>&nbsp;<span class="op" id="3242706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242711">return</span>&nbsp;<span class="ident" id="3242718">nil</span><span class="op" id="3242721">,</span>&nbsp;<span class="ident" id="3242723">fmt</span><span class="op" id="3242726">.</span><span class="ident" id="3242727">Errorf</span><span class="op" id="3242733">(</span><span class="string" id="3242734">&#34;arg&nbsp;%d&nbsp;has&nbsp;type&nbsp;%s;&nbsp;should&nbsp;be&nbsp;%s&#34;</span><span class="op" id="3242768">,</span>&nbsp;<span class="ident" id="3242770">i</span><span class="op" id="3242771">,</span>&nbsp;<span class="ident" id="3242773">value</span><span class="op" id="3242778">.</span><span class="ident" id="3242779">Type</span><span class="op" id="3242783">(</span><span class="op" id="3242784">)</span><span class="op" id="3242785">,</span>&nbsp;<span class="ident" id="3242787">argType</span><span class="op" id="3242794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3242802">argv</span><span class="op" id="3242806">[</span><span class="ident" id="3242807">i</span><span class="op" id="3242808">]</span>&nbsp;<span class="op" id="3242810">=</span>&nbsp;<span class="ident" id="3242812">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242819">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3242822">result</span>&nbsp;<span class="op" id="3242829">:=</span>&nbsp;<span class="ident" id="3242832">v</span><span class="op" id="3242833">.</span><span class="ident" id="3242834">Call</span><span class="op" id="3242838">(</span><span class="ident" id="3242839">argv</span><span class="op" id="3242843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242846">if</span>&nbsp;<span class="builtinfunc" id="3242849">len</span><span class="op" id="3242852">(</span><span class="ident" id="3242853">result</span><span class="op" id="3242859">)</span>&nbsp;<span class="op" id="3242861">==</span>&nbsp;<span class="num" id="3242864">2</span>&nbsp;<span class="op" id="3242866">&amp;&amp;</span>&nbsp;<span class="op" id="3242869">!</span><span class="ident" id="3242870">result</span><span class="op" id="3242876">[</span><span class="num" id="3242877">1</span><span class="op" id="3242878">]</span><span class="op" id="3242879">.</span><span class="ident" id="3242880">IsNil</span><span class="op" id="3242885">(</span><span class="op" id="3242886">)</span>&nbsp;<span class="op" id="3242888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242892">return</span>&nbsp;<span class="ident" id="3242899">result</span><span class="op" id="3242905">[</span><span class="num" id="3242906">0</span><span class="op" id="3242907">]</span><span class="op" id="3242908">.</span><span class="ident" id="3242909">Interface</span><span class="op" id="3242918">(</span><span class="op" id="3242919">)</span><span class="op" id="3242920">,</span>&nbsp;<span class="ident" id="3242922">result</span><span class="op" id="3242928">[</span><span class="num" id="3242929">1</span><span class="op" id="3242930">]</span><span class="op" id="3242931">.</span><span class="ident" id="3242932">Interface</span><span class="op" id="3242941">(</span><span class="op" id="3242942">)</span><span class="op" id="3242943">.</span><span class="op" id="3242944">(</span><span class="builtintype" id="3242945">error</span><span class="op" id="3242950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3242953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3242956">return</span>&nbsp;<span class="ident" id="3242963">result</span><span class="op" id="3242969">[</span><span class="num" id="3242970">0</span><span class="op" id="3242971">]</span><span class="op" id="3242972">.</span><span class="ident" id="3242973">Interface</span><span class="op" id="3242982">(</span><span class="op" id="3242983">)</span><span class="op" id="3242984">,</span>&nbsp;<span class="ident" id="3242986">nil</span><br>
<span class="lineno">215</span><span class="op" id="3242990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3242993">//&nbsp;Boolean&nbsp;logic.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3243012">func</span>&nbsp;<span class="ident" id="3243017">truth</span><span class="op" id="3243022">(</span><span class="ident" id="3243023">a</span>&nbsp;<span class="keyword" id="3243025">interface</span><span class="op" id="3243034">{</span><span class="op" id="3243035">}</span><span class="op" id="3243036">)</span>&nbsp;<span class="builtintype" id="3243038">bool</span>&nbsp;<span class="op" id="3243043">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3243046">t</span><span class="op" id="3243047">,</span>&nbsp;<span class="ident" id="3243049">_</span>&nbsp;<span class="op" id="3243051">:=</span>&nbsp;<span class="ident" id="3243054">isTrue</span><span class="op" id="3243060">(</span><span class="ident" id="3243061">reflect</span><span class="op" id="3243068">.</span><span class="ident" id="3243069">ValueOf</span><span class="op" id="3243076">(</span><span class="ident" id="3243077">a</span><span class="op" id="3243078">)</span><span class="op" id="3243079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243082">return</span>&nbsp;<span class="ident" id="3243089">t</span><br>
<span class="lineno"></span><span class="op" id="3243091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3243094">//&nbsp;and&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;AND&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">225</span><span class="comment" id="3243154">//&nbsp;the&nbsp;first&nbsp;false&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="3243219">func</span>&nbsp;<span class="ident" id="3243224">and</span><span class="op" id="3243227">(</span><span class="ident" id="3243228">arg0</span>&nbsp;<span class="keyword" id="3243233">interface</span><span class="op" id="3243242">{</span><span class="op" id="3243243">}</span><span class="op" id="3243244">,</span>&nbsp;<span class="ident" id="3243246">args</span>&nbsp;<span class="op" id="3243251">...</span><span class="keyword" id="3243254">interface</span><span class="op" id="3243263">{</span><span class="op" id="3243264">}</span><span class="op" id="3243265">)</span>&nbsp;<span class="keyword" id="3243267">interface</span><span class="op" id="3243276">{</span><span class="op" id="3243277">}</span>&nbsp;<span class="op" id="3243279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243282">if</span>&nbsp;<span class="op" id="3243285">!</span><span class="ident" id="3243286">truth</span><span class="op" id="3243291">(</span><span class="ident" id="3243292">arg0</span><span class="op" id="3243296">)</span>&nbsp;<span class="op" id="3243298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243302">return</span>&nbsp;<span class="ident" id="3243309">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3243315">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243318">for</span>&nbsp;<span class="ident" id="3243322">i</span>&nbsp;<span class="op" id="3243324">:=</span>&nbsp;<span class="keyword" id="3243327">range</span>&nbsp;<span class="ident" id="3243333">args</span>&nbsp;<span class="op" id="3243338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3243342">arg0</span>&nbsp;<span class="op" id="3243347">=</span>&nbsp;<span class="ident" id="3243349">args</span><span class="op" id="3243353">[</span><span class="ident" id="3243354">i</span><span class="op" id="3243355">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243359">if</span>&nbsp;<span class="op" id="3243362">!</span><span class="ident" id="3243363">truth</span><span class="op" id="3243368">(</span><span class="ident" id="3243369">arg0</span><span class="op" id="3243373">)</span>&nbsp;<span class="op" id="3243375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243380">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3243388">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3243391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243394">return</span>&nbsp;<span class="ident" id="3243401">arg0</span><br>
<span class="lineno"></span><span class="op" id="3243406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3243409">//&nbsp;or&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;OR&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">240</span><span class="comment" id="3243467">//&nbsp;the&nbsp;first&nbsp;true&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="3243531">func</span>&nbsp;<span class="ident" id="3243536">or</span><span class="op" id="3243538">(</span><span class="ident" id="3243539">arg0</span>&nbsp;<span class="keyword" id="3243544">interface</span><span class="op" id="3243553">{</span><span class="op" id="3243554">}</span><span class="op" id="3243555">,</span>&nbsp;<span class="ident" id="3243557">args</span>&nbsp;<span class="op" id="3243562">...</span><span class="keyword" id="3243565">interface</span><span class="op" id="3243574">{</span><span class="op" id="3243575">}</span><span class="op" id="3243576">)</span>&nbsp;<span class="keyword" id="3243578">interface</span><span class="op" id="3243587">{</span><span class="op" id="3243588">}</span>&nbsp;<span class="op" id="3243590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243593">if</span>&nbsp;<span class="ident" id="3243596">truth</span><span class="op" id="3243601">(</span><span class="ident" id="3243602">arg0</span><span class="op" id="3243606">)</span>&nbsp;<span class="op" id="3243608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243612">return</span>&nbsp;<span class="ident" id="3243619">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3243625">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243628">for</span>&nbsp;<span class="ident" id="3243632">i</span>&nbsp;<span class="op" id="3243634">:=</span>&nbsp;<span class="keyword" id="3243637">range</span>&nbsp;<span class="ident" id="3243643">args</span>&nbsp;<span class="op" id="3243648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3243652">arg0</span>&nbsp;<span class="op" id="3243657">=</span>&nbsp;<span class="ident" id="3243659">args</span><span class="op" id="3243663">[</span><span class="ident" id="3243664">i</span><span class="op" id="3243665">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243669">if</span>&nbsp;<span class="ident" id="3243672">truth</span><span class="op" id="3243677">(</span><span class="ident" id="3243678">arg0</span><span class="op" id="3243682">)</span>&nbsp;<span class="op" id="3243684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243689">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3243697">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3243700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243703">return</span>&nbsp;<span class="ident" id="3243710">arg0</span><br>
<span class="lineno"></span><span class="op" id="3243715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3243718">//&nbsp;not&nbsp;returns&nbsp;the&nbsp;Boolean&nbsp;negation&nbsp;of&nbsp;its&nbsp;argument.</span><br>
<span class="lineno">255</span><span class="keyword" id="3243771">func</span>&nbsp;<span class="ident" id="3243776">not</span><span class="op" id="3243779">(</span><span class="ident" id="3243780">arg</span>&nbsp;<span class="keyword" id="3243784">interface</span><span class="op" id="3243793">{</span><span class="op" id="3243794">}</span><span class="op" id="3243795">)</span>&nbsp;<span class="op" id="3243797">(</span><span class="ident" id="3243798">truth</span>&nbsp;<span class="builtintype" id="3243804">bool</span><span class="op" id="3243808">)</span>&nbsp;<span class="op" id="3243810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3243813">truth</span><span class="op" id="3243818">,</span>&nbsp;<span class="ident" id="3243820">_</span>&nbsp;<span class="op" id="3243822">=</span>&nbsp;<span class="ident" id="3243824">isTrue</span><span class="op" id="3243830">(</span><span class="ident" id="3243831">reflect</span><span class="op" id="3243838">.</span><span class="ident" id="3243839">ValueOf</span><span class="op" id="3243846">(</span><span class="ident" id="3243847">arg</span><span class="op" id="3243850">)</span><span class="op" id="3243851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3243854">return</span>&nbsp;<span class="op" id="3243861">!</span><span class="ident" id="3243862">truth</span><br>
<span class="lineno"></span><span class="op" id="3243868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3243871">//&nbsp;Comparison.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3243887">//&nbsp;TODO:&nbsp;Perhaps&nbsp;allow&nbsp;comparison&nbsp;between&nbsp;signed&nbsp;and&nbsp;unsigned&nbsp;integers.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3243960">var</span>&nbsp;<span class="op" id="3243964">(</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3243967">errBadComparisonType</span>&nbsp;<span class="op" id="3243988">=</span>&nbsp;<span class="ident" id="3243990">errors</span><span class="op" id="3243996">.</span><span class="ident" id="3243997">New</span><span class="op" id="3244000">(</span><span class="string" id="3244001">&#34;invalid&nbsp;type&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3244030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244033">errBadComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3244054">=</span>&nbsp;<span class="ident" id="3244056">errors</span><span class="op" id="3244062">.</span><span class="ident" id="3244063">New</span><span class="op" id="3244066">(</span><span class="string" id="3244067">&#34;incompatible&nbsp;types&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3244102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244105">errNoComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3244126">=</span>&nbsp;<span class="ident" id="3244128">errors</span><span class="op" id="3244134">.</span><span class="ident" id="3244135">New</span><span class="op" id="3244138">(</span><span class="string" id="3244139">&#34;missing&nbsp;argument&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3244172">)</span><br>
<span class="lineno"></span><span class="op" id="3244174">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3244177">type</span>&nbsp;<span class="ident" id="3244182">kind</span>&nbsp;<span class="builtintype" id="3244187">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3244192">const</span>&nbsp;<span class="op" id="3244198">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244201">invalidKind</span>&nbsp;<span class="ident" id="3244213">kind</span>&nbsp;<span class="op" id="3244218">=</span>&nbsp;<span class="ident" id="3244220">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244226">boolKind</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244236">complexKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244249">intKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244258">floatKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244269">integerKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244282">stringKind</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244294">uintKind</span><br>
<span class="lineno"></span><span class="op" id="3244303">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3244306">func</span>&nbsp;<span class="ident" id="3244311">basicKind</span><span class="op" id="3244320">(</span><span class="ident" id="3244321">v</span>&nbsp;<span class="ident" id="3244323">reflect</span><span class="op" id="3244330">.</span><span class="ident" id="3244331">Value</span><span class="op" id="3244336">)</span>&nbsp;<span class="op" id="3244338">(</span><span class="ident" id="3244339">kind</span><span class="op" id="3244343">,</span>&nbsp;<span class="builtintype" id="3244345">error</span><span class="op" id="3244350">)</span>&nbsp;<span class="op" id="3244352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244355">switch</span>&nbsp;<span class="ident" id="3244362">v</span><span class="op" id="3244363">.</span><span class="ident" id="3244364">Kind</span><span class="op" id="3244368">(</span><span class="op" id="3244369">)</span>&nbsp;<span class="op" id="3244371">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244374">case</span>&nbsp;<span class="ident" id="3244379">reflect</span><span class="op" id="3244386">.</span><span class="ident" id="3244387">Bool</span><span class="op" id="3244391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244395">return</span>&nbsp;<span class="ident" id="3244402">boolKind</span><span class="op" id="3244410">,</span>&nbsp;<span class="ident" id="3244412">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244417">case</span>&nbsp;<span class="ident" id="3244422">reflect</span><span class="op" id="3244429">.</span><span class="ident" id="3244430">Int</span><span class="op" id="3244433">,</span>&nbsp;<span class="ident" id="3244435">reflect</span><span class="op" id="3244442">.</span><span class="ident" id="3244443">Int8</span><span class="op" id="3244447">,</span>&nbsp;<span class="ident" id="3244449">reflect</span><span class="op" id="3244456">.</span><span class="ident" id="3244457">Int16</span><span class="op" id="3244462">,</span>&nbsp;<span class="ident" id="3244464">reflect</span><span class="op" id="3244471">.</span><span class="ident" id="3244472">Int32</span><span class="op" id="3244477">,</span>&nbsp;<span class="ident" id="3244479">reflect</span><span class="op" id="3244486">.</span><span class="ident" id="3244487">Int64</span><span class="op" id="3244492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244496">return</span>&nbsp;<span class="ident" id="3244503">intKind</span><span class="op" id="3244510">,</span>&nbsp;<span class="ident" id="3244512">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244517">case</span>&nbsp;<span class="ident" id="3244522">reflect</span><span class="op" id="3244529">.</span><span class="ident" id="3244530">Uint</span><span class="op" id="3244534">,</span>&nbsp;<span class="ident" id="3244536">reflect</span><span class="op" id="3244543">.</span><span class="ident" id="3244544">Uint8</span><span class="op" id="3244549">,</span>&nbsp;<span class="ident" id="3244551">reflect</span><span class="op" id="3244558">.</span><span class="ident" id="3244559">Uint16</span><span class="op" id="3244565">,</span>&nbsp;<span class="ident" id="3244567">reflect</span><span class="op" id="3244574">.</span><span class="ident" id="3244575">Uint32</span><span class="op" id="3244581">,</span>&nbsp;<span class="ident" id="3244583">reflect</span><span class="op" id="3244590">.</span><span class="ident" id="3244591">Uint64</span><span class="op" id="3244597">,</span>&nbsp;<span class="ident" id="3244599">reflect</span><span class="op" id="3244606">.</span><span class="ident" id="3244607">Uintptr</span><span class="op" id="3244614">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244618">return</span>&nbsp;<span class="ident" id="3244625">uintKind</span><span class="op" id="3244633">,</span>&nbsp;<span class="ident" id="3244635">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244640">case</span>&nbsp;<span class="ident" id="3244645">reflect</span><span class="op" id="3244652">.</span><span class="ident" id="3244653">Float32</span><span class="op" id="3244660">,</span>&nbsp;<span class="ident" id="3244662">reflect</span><span class="op" id="3244669">.</span><span class="ident" id="3244670">Float64</span><span class="op" id="3244677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244681">return</span>&nbsp;<span class="ident" id="3244688">floatKind</span><span class="op" id="3244697">,</span>&nbsp;<span class="ident" id="3244699">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244704">case</span>&nbsp;<span class="ident" id="3244709">reflect</span><span class="op" id="3244716">.</span><span class="ident" id="3244717">Complex64</span><span class="op" id="3244726">,</span>&nbsp;<span class="ident" id="3244728">reflect</span><span class="op" id="3244735">.</span><span class="ident" id="3244736">Complex128</span><span class="op" id="3244746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244750">return</span>&nbsp;<span class="ident" id="3244757">complexKind</span><span class="op" id="3244768">,</span>&nbsp;<span class="ident" id="3244770">nil</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244775">case</span>&nbsp;<span class="ident" id="3244780">reflect</span><span class="op" id="3244787">.</span><span class="ident" id="3244788">String</span><span class="op" id="3244794">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244798">return</span>&nbsp;<span class="ident" id="3244805">stringKind</span><span class="op" id="3244815">,</span>&nbsp;<span class="ident" id="3244817">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3244822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244825">return</span>&nbsp;<span class="ident" id="3244832">invalidKind</span><span class="op" id="3244843">,</span>&nbsp;<span class="ident" id="3244845">errBadComparisonType</span><br>
<span class="lineno"></span><span class="op" id="3244866">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="3244869">//&nbsp;eq&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;==&nbsp;b&nbsp;||&nbsp;a&nbsp;==&nbsp;c&nbsp;||&nbsp;...</span><br>
<span class="lineno"></span><span class="keyword" id="3244924">func</span>&nbsp;<span class="ident" id="3244929">eq</span><span class="op" id="3244931">(</span><span class="ident" id="3244932">arg1</span>&nbsp;<span class="keyword" id="3244937">interface</span><span class="op" id="3244946">{</span><span class="op" id="3244947">}</span><span class="op" id="3244948">,</span>&nbsp;<span class="ident" id="3244950">arg2</span>&nbsp;<span class="op" id="3244955">...</span><span class="keyword" id="3244958">interface</span><span class="op" id="3244967">{</span><span class="op" id="3244968">}</span><span class="op" id="3244969">)</span>&nbsp;<span class="op" id="3244971">(</span><span class="builtintype" id="3244972">bool</span><span class="op" id="3244976">,</span>&nbsp;<span class="builtintype" id="3244978">error</span><span class="op" id="3244983">)</span>&nbsp;<span class="op" id="3244985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244988">v1</span>&nbsp;<span class="op" id="3244991">:=</span>&nbsp;<span class="ident" id="3244994">reflect</span><span class="op" id="3245001">.</span><span class="ident" id="3245002">ValueOf</span><span class="op" id="3245009">(</span><span class="ident" id="3245010">arg1</span><span class="op" id="3245014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245017">k1</span><span class="op" id="3245019">,</span>&nbsp;<span class="ident" id="3245021">err</span>&nbsp;<span class="op" id="3245025">:=</span>&nbsp;<span class="ident" id="3245028">basicKind</span><span class="op" id="3245037">(</span><span class="ident" id="3245038">v1</span><span class="op" id="3245040">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245043">if</span>&nbsp;<span class="ident" id="3245046">err</span>&nbsp;<span class="op" id="3245050">!=</span>&nbsp;<span class="ident" id="3245053">nil</span>&nbsp;<span class="op" id="3245057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245061">return</span>&nbsp;<span class="builtintype" id="3245068">false</span><span class="op" id="3245073">,</span>&nbsp;<span class="ident" id="3245075">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245083">if</span>&nbsp;<span class="builtinfunc" id="3245086">len</span><span class="op" id="3245089">(</span><span class="ident" id="3245090">arg2</span><span class="op" id="3245094">)</span>&nbsp;<span class="op" id="3245096">==</span>&nbsp;<span class="num" id="3245099">0</span>&nbsp;<span class="op" id="3245101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245105">return</span>&nbsp;<span class="builtintype" id="3245112">false</span><span class="op" id="3245117">,</span>&nbsp;<span class="ident" id="3245119">errNoComparison</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245139">for</span>&nbsp;<span class="ident" id="3245143">_</span><span class="op" id="3245144">,</span>&nbsp;<span class="ident" id="3245146">arg</span>&nbsp;<span class="op" id="3245150">:=</span>&nbsp;<span class="keyword" id="3245153">range</span>&nbsp;<span class="ident" id="3245159">arg2</span>&nbsp;<span class="op" id="3245164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245168">v2</span>&nbsp;<span class="op" id="3245171">:=</span>&nbsp;<span class="ident" id="3245174">reflect</span><span class="op" id="3245181">.</span><span class="ident" id="3245182">ValueOf</span><span class="op" id="3245189">(</span><span class="ident" id="3245190">arg</span><span class="op" id="3245193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245197">k2</span><span class="op" id="3245199">,</span>&nbsp;<span class="ident" id="3245201">err</span>&nbsp;<span class="op" id="3245205">:=</span>&nbsp;<span class="ident" id="3245208">basicKind</span><span class="op" id="3245217">(</span><span class="ident" id="3245218">v2</span><span class="op" id="3245220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245224">if</span>&nbsp;<span class="ident" id="3245227">err</span>&nbsp;<span class="op" id="3245231">!=</span>&nbsp;<span class="ident" id="3245234">nil</span>&nbsp;<span class="op" id="3245238">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245243">return</span>&nbsp;<span class="builtintype" id="3245250">false</span><span class="op" id="3245255">,</span>&nbsp;<span class="ident" id="3245257">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245267">truth</span>&nbsp;<span class="op" id="3245273">:=</span>&nbsp;<span class="builtintype" id="3245276">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245284">if</span>&nbsp;<span class="ident" id="3245287">k1</span>&nbsp;<span class="op" id="3245290">!=</span>&nbsp;<span class="ident" id="3245293">k2</span>&nbsp;<span class="op" id="3245296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3245301">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245375">switch</span>&nbsp;<span class="op" id="3245382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245387">case</span>&nbsp;<span class="ident" id="3245392">k1</span>&nbsp;<span class="op" id="3245395">==</span>&nbsp;<span class="ident" id="3245398">intKind</span>&nbsp;<span class="op" id="3245406">&amp;&amp;</span>&nbsp;<span class="ident" id="3245409">k2</span>&nbsp;<span class="op" id="3245412">==</span>&nbsp;<span class="ident" id="3245415">uintKind</span><span class="op" id="3245423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245429">truth</span>&nbsp;<span class="op" id="3245435">=</span>&nbsp;<span class="ident" id="3245437">v1</span><span class="op" id="3245439">.</span><span class="ident" id="3245440">Int</span><span class="op" id="3245443">(</span><span class="op" id="3245444">)</span>&nbsp;<span class="op" id="3245446">&gt;=</span>&nbsp;<span class="num" id="3245449">0</span>&nbsp;<span class="op" id="3245451">&amp;&amp;</span>&nbsp;<span class="ident" id="3245454">uint64</span><span class="op" id="3245460">(</span><span class="ident" id="3245461">v1</span><span class="op" id="3245463">.</span><span class="ident" id="3245464">Int</span><span class="op" id="3245467">(</span><span class="op" id="3245468">)</span><span class="op" id="3245469">)</span>&nbsp;<span class="op" id="3245471">==</span>&nbsp;<span class="ident" id="3245474">v2</span><span class="op" id="3245476">.</span><span class="ident" id="3245477">Uint</span><span class="op" id="3245481">(</span><span class="op" id="3245482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245487">case</span>&nbsp;<span class="ident" id="3245492">k1</span>&nbsp;<span class="op" id="3245495">==</span>&nbsp;<span class="ident" id="3245498">uintKind</span>&nbsp;<span class="op" id="3245507">&amp;&amp;</span>&nbsp;<span class="ident" id="3245510">k2</span>&nbsp;<span class="op" id="3245513">==</span>&nbsp;<span class="ident" id="3245516">intKind</span><span class="op" id="3245523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245529">truth</span>&nbsp;<span class="op" id="3245535">=</span>&nbsp;<span class="ident" id="3245537">v2</span><span class="op" id="3245539">.</span><span class="ident" id="3245540">Int</span><span class="op" id="3245543">(</span><span class="op" id="3245544">)</span>&nbsp;<span class="op" id="3245546">&gt;=</span>&nbsp;<span class="num" id="3245549">0</span>&nbsp;<span class="op" id="3245551">&amp;&amp;</span>&nbsp;<span class="ident" id="3245554">v1</span><span class="op" id="3245556">.</span><span class="ident" id="3245557">Uint</span><span class="op" id="3245561">(</span><span class="op" id="3245562">)</span>&nbsp;<span class="op" id="3245564">==</span>&nbsp;<span class="ident" id="3245567">uint64</span><span class="op" id="3245573">(</span><span class="ident" id="3245574">v2</span><span class="op" id="3245576">.</span><span class="ident" id="3245577">Int</span><span class="op" id="3245580">(</span><span class="op" id="3245581">)</span><span class="op" id="3245582">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245587">default</span><span class="op" id="3245594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245600">return</span>&nbsp;<span class="builtintype" id="3245607">false</span><span class="op" id="3245612">,</span>&nbsp;<span class="ident" id="3245614">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245638">}</span>&nbsp;<span class="keyword" id="3245640">else</span>&nbsp;<span class="op" id="3245645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245650">switch</span>&nbsp;<span class="ident" id="3245657">k1</span>&nbsp;<span class="op" id="3245660">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245665">case</span>&nbsp;<span class="ident" id="3245670">boolKind</span><span class="op" id="3245678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245684">truth</span>&nbsp;<span class="op" id="3245690">=</span>&nbsp;<span class="ident" id="3245692">v1</span><span class="op" id="3245694">.</span><span class="ident" id="3245695">Bool</span><span class="op" id="3245699">(</span><span class="op" id="3245700">)</span>&nbsp;<span class="op" id="3245702">==</span>&nbsp;<span class="ident" id="3245705">v2</span><span class="op" id="3245707">.</span><span class="ident" id="3245708">Bool</span><span class="op" id="3245712">(</span><span class="op" id="3245713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245718">case</span>&nbsp;<span class="ident" id="3245723">complexKind</span><span class="op" id="3245734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245740">truth</span>&nbsp;<span class="op" id="3245746">=</span>&nbsp;<span class="ident" id="3245748">v1</span><span class="op" id="3245750">.</span><span class="ident" id="3245751">Complex</span><span class="op" id="3245758">(</span><span class="op" id="3245759">)</span>&nbsp;<span class="op" id="3245761">==</span>&nbsp;<span class="ident" id="3245764">v2</span><span class="op" id="3245766">.</span><span class="ident" id="3245767">Complex</span><span class="op" id="3245774">(</span><span class="op" id="3245775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245780">case</span>&nbsp;<span class="ident" id="3245785">floatKind</span><span class="op" id="3245794">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245800">truth</span>&nbsp;<span class="op" id="3245806">=</span>&nbsp;<span class="ident" id="3245808">v1</span><span class="op" id="3245810">.</span><span class="ident" id="3245811">Float</span><span class="op" id="3245816">(</span><span class="op" id="3245817">)</span>&nbsp;<span class="op" id="3245819">==</span>&nbsp;<span class="ident" id="3245822">v2</span><span class="op" id="3245824">.</span><span class="ident" id="3245825">Float</span><span class="op" id="3245830">(</span><span class="op" id="3245831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245836">case</span>&nbsp;<span class="ident" id="3245841">intKind</span><span class="op" id="3245848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245854">truth</span>&nbsp;<span class="op" id="3245860">=</span>&nbsp;<span class="ident" id="3245862">v1</span><span class="op" id="3245864">.</span><span class="ident" id="3245865">Int</span><span class="op" id="3245868">(</span><span class="op" id="3245869">)</span>&nbsp;<span class="op" id="3245871">==</span>&nbsp;<span class="ident" id="3245874">v2</span><span class="op" id="3245876">.</span><span class="ident" id="3245877">Int</span><span class="op" id="3245880">(</span><span class="op" id="3245881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245886">case</span>&nbsp;<span class="ident" id="3245891">stringKind</span><span class="op" id="3245901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245907">truth</span>&nbsp;<span class="op" id="3245913">=</span>&nbsp;<span class="ident" id="3245915">v1</span><span class="op" id="3245917">.</span><span class="ident" id="3245918">String</span><span class="op" id="3245924">(</span><span class="op" id="3245925">)</span>&nbsp;<span class="op" id="3245927">==</span>&nbsp;<span class="ident" id="3245930">v2</span><span class="op" id="3245932">.</span><span class="ident" id="3245933">String</span><span class="op" id="3245939">(</span><span class="op" id="3245940">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245945">case</span>&nbsp;<span class="ident" id="3245950">uintKind</span><span class="op" id="3245958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245964">truth</span>&nbsp;<span class="op" id="3245970">=</span>&nbsp;<span class="ident" id="3245972">v1</span><span class="op" id="3245974">.</span><span class="ident" id="3245975">Uint</span><span class="op" id="3245979">(</span><span class="op" id="3245980">)</span>&nbsp;<span class="op" id="3245982">==</span>&nbsp;<span class="ident" id="3245985">v2</span><span class="op" id="3245987">.</span><span class="ident" id="3245988">Uint</span><span class="op" id="3245992">(</span><span class="op" id="3245993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245998">default</span><span class="op" id="3246005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3246011">panic</span><span class="op" id="3246016">(</span><span class="string" id="3246017">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="3246031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246036">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246044">if</span>&nbsp;<span class="ident" id="3246047">truth</span>&nbsp;<span class="op" id="3246053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246058">return</span>&nbsp;<span class="builtintype" id="3246065">true</span><span class="op" id="3246069">,</span>&nbsp;<span class="ident" id="3246071">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246080">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246083">return</span>&nbsp;<span class="builtintype" id="3246090">false</span><span class="op" id="3246095">,</span>&nbsp;<span class="ident" id="3246097">nil</span><br>
<span class="lineno"></span><span class="op" id="3246101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3246104">//&nbsp;ne&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3246143">func</span>&nbsp;<span class="ident" id="3246148">ne</span><span class="op" id="3246150">(</span><span class="ident" id="3246151">arg1</span><span class="op" id="3246155">,</span>&nbsp;<span class="ident" id="3246157">arg2</span>&nbsp;<span class="keyword" id="3246162">interface</span><span class="op" id="3246171">{</span><span class="op" id="3246172">}</span><span class="op" id="3246173">)</span>&nbsp;<span class="op" id="3246175">(</span><span class="builtintype" id="3246176">bool</span><span class="op" id="3246180">,</span>&nbsp;<span class="builtintype" id="3246182">error</span><span class="op" id="3246187">)</span>&nbsp;<span class="op" id="3246189">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3246192">//&nbsp;!=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;==.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246221">equal</span><span class="op" id="3246226">,</span>&nbsp;<span class="ident" id="3246228">err</span>&nbsp;<span class="op" id="3246232">:=</span>&nbsp;<span class="ident" id="3246235">eq</span><span class="op" id="3246237">(</span><span class="ident" id="3246238">arg1</span><span class="op" id="3246242">,</span>&nbsp;<span class="ident" id="3246244">arg2</span><span class="op" id="3246248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246251">return</span>&nbsp;<span class="op" id="3246258">!</span><span class="ident" id="3246259">equal</span><span class="op" id="3246264">,</span>&nbsp;<span class="ident" id="3246266">err</span><br>
<span class="lineno"></span><span class="op" id="3246270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="3246273">//&nbsp;lt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&lt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3246311">func</span>&nbsp;<span class="ident" id="3246316">lt</span><span class="op" id="3246318">(</span><span class="ident" id="3246319">arg1</span><span class="op" id="3246323">,</span>&nbsp;<span class="ident" id="3246325">arg2</span>&nbsp;<span class="keyword" id="3246330">interface</span><span class="op" id="3246339">{</span><span class="op" id="3246340">}</span><span class="op" id="3246341">)</span>&nbsp;<span class="op" id="3246343">(</span><span class="builtintype" id="3246344">bool</span><span class="op" id="3246348">,</span>&nbsp;<span class="builtintype" id="3246350">error</span><span class="op" id="3246355">)</span>&nbsp;<span class="op" id="3246357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246360">v1</span>&nbsp;<span class="op" id="3246363">:=</span>&nbsp;<span class="ident" id="3246366">reflect</span><span class="op" id="3246373">.</span><span class="ident" id="3246374">ValueOf</span><span class="op" id="3246381">(</span><span class="ident" id="3246382">arg1</span><span class="op" id="3246386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246389">k1</span><span class="op" id="3246391">,</span>&nbsp;<span class="ident" id="3246393">err</span>&nbsp;<span class="op" id="3246397">:=</span>&nbsp;<span class="ident" id="3246400">basicKind</span><span class="op" id="3246409">(</span><span class="ident" id="3246410">v1</span><span class="op" id="3246412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246415">if</span>&nbsp;<span class="ident" id="3246418">err</span>&nbsp;<span class="op" id="3246422">!=</span>&nbsp;<span class="ident" id="3246425">nil</span>&nbsp;<span class="op" id="3246429">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246433">return</span>&nbsp;<span class="builtintype" id="3246440">false</span><span class="op" id="3246445">,</span>&nbsp;<span class="ident" id="3246447">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246455">v2</span>&nbsp;<span class="op" id="3246458">:=</span>&nbsp;<span class="ident" id="3246461">reflect</span><span class="op" id="3246468">.</span><span class="ident" id="3246469">ValueOf</span><span class="op" id="3246476">(</span><span class="ident" id="3246477">arg2</span><span class="op" id="3246481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246484">k2</span><span class="op" id="3246486">,</span>&nbsp;<span class="ident" id="3246488">err</span>&nbsp;<span class="op" id="3246492">:=</span>&nbsp;<span class="ident" id="3246495">basicKind</span><span class="op" id="3246504">(</span><span class="ident" id="3246505">v2</span><span class="op" id="3246507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246510">if</span>&nbsp;<span class="ident" id="3246513">err</span>&nbsp;<span class="op" id="3246517">!=</span>&nbsp;<span class="ident" id="3246520">nil</span>&nbsp;<span class="op" id="3246524">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246528">return</span>&nbsp;<span class="builtintype" id="3246535">false</span><span class="op" id="3246540">,</span>&nbsp;<span class="ident" id="3246542">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246550">truth</span>&nbsp;<span class="op" id="3246556">:=</span>&nbsp;<span class="builtintype" id="3246559">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246566">if</span>&nbsp;<span class="ident" id="3246569">k1</span>&nbsp;<span class="op" id="3246572">!=</span>&nbsp;<span class="ident" id="3246575">k2</span>&nbsp;<span class="op" id="3246578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3246582">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246655">switch</span>&nbsp;<span class="op" id="3246662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246666">case</span>&nbsp;<span class="ident" id="3246671">k1</span>&nbsp;<span class="op" id="3246674">==</span>&nbsp;<span class="ident" id="3246677">intKind</span>&nbsp;<span class="op" id="3246685">&amp;&amp;</span>&nbsp;<span class="ident" id="3246688">k2</span>&nbsp;<span class="op" id="3246691">==</span>&nbsp;<span class="ident" id="3246694">uintKind</span><span class="op" id="3246702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246707">truth</span>&nbsp;<span class="op" id="3246713">=</span>&nbsp;<span class="ident" id="3246715">v1</span><span class="op" id="3246717">.</span><span class="ident" id="3246718">Int</span><span class="op" id="3246721">(</span><span class="op" id="3246722">)</span>&nbsp;<span class="op" id="3246724">&lt;</span>&nbsp;<span class="num" id="3246726">0</span>&nbsp;<span class="op" id="3246728">||</span>&nbsp;<span class="ident" id="3246731">uint64</span><span class="op" id="3246737">(</span><span class="ident" id="3246738">v1</span><span class="op" id="3246740">.</span><span class="ident" id="3246741">Int</span><span class="op" id="3246744">(</span><span class="op" id="3246745">)</span><span class="op" id="3246746">)</span>&nbsp;<span class="op" id="3246748">&lt;</span>&nbsp;<span class="ident" id="3246750">v2</span><span class="op" id="3246752">.</span><span class="ident" id="3246753">Uint</span><span class="op" id="3246757">(</span><span class="op" id="3246758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246762">case</span>&nbsp;<span class="ident" id="3246767">k1</span>&nbsp;<span class="op" id="3246770">==</span>&nbsp;<span class="ident" id="3246773">uintKind</span>&nbsp;<span class="op" id="3246782">&amp;&amp;</span>&nbsp;<span class="ident" id="3246785">k2</span>&nbsp;<span class="op" id="3246788">==</span>&nbsp;<span class="ident" id="3246791">intKind</span><span class="op" id="3246798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246803">truth</span>&nbsp;<span class="op" id="3246809">=</span>&nbsp;<span class="ident" id="3246811">v2</span><span class="op" id="3246813">.</span><span class="ident" id="3246814">Int</span><span class="op" id="3246817">(</span><span class="op" id="3246818">)</span>&nbsp;<span class="op" id="3246820">&gt;=</span>&nbsp;<span class="num" id="3246823">0</span>&nbsp;<span class="op" id="3246825">&amp;&amp;</span>&nbsp;<span class="ident" id="3246828">v1</span><span class="op" id="3246830">.</span><span class="ident" id="3246831">Uint</span><span class="op" id="3246835">(</span><span class="op" id="3246836">)</span>&nbsp;<span class="op" id="3246838">&lt;</span>&nbsp;<span class="ident" id="3246840">uint64</span><span class="op" id="3246846">(</span><span class="ident" id="3246847">v2</span><span class="op" id="3246849">.</span><span class="ident" id="3246850">Int</span><span class="op" id="3246853">(</span><span class="op" id="3246854">)</span><span class="op" id="3246855">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246859">default</span><span class="op" id="3246866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246871">return</span>&nbsp;<span class="builtintype" id="3246878">false</span><span class="op" id="3246883">,</span>&nbsp;<span class="ident" id="3246885">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246907">}</span>&nbsp;<span class="keyword" id="3246909">else</span>&nbsp;<span class="op" id="3246914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246918">switch</span>&nbsp;<span class="ident" id="3246925">k1</span>&nbsp;<span class="op" id="3246928">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246932">case</span>&nbsp;<span class="ident" id="3246937">boolKind</span><span class="op" id="3246945">,</span>&nbsp;<span class="ident" id="3246947">complexKind</span><span class="op" id="3246958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246963">return</span>&nbsp;<span class="builtintype" id="3246970">false</span><span class="op" id="3246975">,</span>&nbsp;<span class="ident" id="3246977">errBadComparisonType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247000">case</span>&nbsp;<span class="ident" id="3247005">floatKind</span><span class="op" id="3247014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247019">truth</span>&nbsp;<span class="op" id="3247025">=</span>&nbsp;<span class="ident" id="3247027">v1</span><span class="op" id="3247029">.</span><span class="ident" id="3247030">Float</span><span class="op" id="3247035">(</span><span class="op" id="3247036">)</span>&nbsp;<span class="op" id="3247038">&lt;</span>&nbsp;<span class="ident" id="3247040">v2</span><span class="op" id="3247042">.</span><span class="ident" id="3247043">Float</span><span class="op" id="3247048">(</span><span class="op" id="3247049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247053">case</span>&nbsp;<span class="ident" id="3247058">intKind</span><span class="op" id="3247065">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247070">truth</span>&nbsp;<span class="op" id="3247076">=</span>&nbsp;<span class="ident" id="3247078">v1</span><span class="op" id="3247080">.</span><span class="ident" id="3247081">Int</span><span class="op" id="3247084">(</span><span class="op" id="3247085">)</span>&nbsp;<span class="op" id="3247087">&lt;</span>&nbsp;<span class="ident" id="3247089">v2</span><span class="op" id="3247091">.</span><span class="ident" id="3247092">Int</span><span class="op" id="3247095">(</span><span class="op" id="3247096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247100">case</span>&nbsp;<span class="ident" id="3247105">stringKind</span><span class="op" id="3247115">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247120">truth</span>&nbsp;<span class="op" id="3247126">=</span>&nbsp;<span class="ident" id="3247128">v1</span><span class="op" id="3247130">.</span><span class="ident" id="3247131">String</span><span class="op" id="3247137">(</span><span class="op" id="3247138">)</span>&nbsp;<span class="op" id="3247140">&lt;</span>&nbsp;<span class="ident" id="3247142">v2</span><span class="op" id="3247144">.</span><span class="ident" id="3247145">String</span><span class="op" id="3247151">(</span><span class="op" id="3247152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247156">case</span>&nbsp;<span class="ident" id="3247161">uintKind</span><span class="op" id="3247169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247174">truth</span>&nbsp;<span class="op" id="3247180">=</span>&nbsp;<span class="ident" id="3247182">v1</span><span class="op" id="3247184">.</span><span class="ident" id="3247185">Uint</span><span class="op" id="3247189">(</span><span class="op" id="3247190">)</span>&nbsp;<span class="op" id="3247192">&lt;</span>&nbsp;<span class="ident" id="3247194">v2</span><span class="op" id="3247196">.</span><span class="ident" id="3247197">Uint</span><span class="op" id="3247201">(</span><span class="op" id="3247202">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247206">default</span><span class="op" id="3247213">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3247218">panic</span><span class="op" id="3247223">(</span><span class="string" id="3247224">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="3247238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247248">return</span>&nbsp;<span class="ident" id="3247255">truth</span><span class="op" id="3247260">,</span>&nbsp;<span class="ident" id="3247262">nil</span><br>
<span class="lineno">400</span><span class="op" id="3247266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3247269">//&nbsp;le&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;&lt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3247306">func</span>&nbsp;<span class="ident" id="3247311">le</span><span class="op" id="3247313">(</span><span class="ident" id="3247314">arg1</span><span class="op" id="3247318">,</span>&nbsp;<span class="ident" id="3247320">arg2</span>&nbsp;<span class="keyword" id="3247325">interface</span><span class="op" id="3247334">{</span><span class="op" id="3247335">}</span><span class="op" id="3247336">)</span>&nbsp;<span class="op" id="3247338">(</span><span class="builtintype" id="3247339">bool</span><span class="op" id="3247343">,</span>&nbsp;<span class="builtintype" id="3247345">error</span><span class="op" id="3247350">)</span>&nbsp;<span class="op" id="3247352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3247355">//&nbsp;&lt;=&nbsp;is&nbsp;&lt;&nbsp;or&nbsp;==.</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247374">lessThan</span><span class="op" id="3247382">,</span>&nbsp;<span class="ident" id="3247384">err</span>&nbsp;<span class="op" id="3247388">:=</span>&nbsp;<span class="ident" id="3247391">lt</span><span class="op" id="3247393">(</span><span class="ident" id="3247394">arg1</span><span class="op" id="3247398">,</span>&nbsp;<span class="ident" id="3247400">arg2</span><span class="op" id="3247404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247407">if</span>&nbsp;<span class="ident" id="3247410">lessThan</span>&nbsp;<span class="op" id="3247419">||</span>&nbsp;<span class="ident" id="3247422">err</span>&nbsp;<span class="op" id="3247426">!=</span>&nbsp;<span class="ident" id="3247429">nil</span>&nbsp;<span class="op" id="3247433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247437">return</span>&nbsp;<span class="ident" id="3247444">lessThan</span><span class="op" id="3247452">,</span>&nbsp;<span class="ident" id="3247454">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247462">return</span>&nbsp;<span class="ident" id="3247469">eq</span><span class="op" id="3247471">(</span><span class="ident" id="3247472">arg1</span><span class="op" id="3247476">,</span>&nbsp;<span class="ident" id="3247478">arg2</span><span class="op" id="3247482">)</span><br>
<span class="lineno">410</span><span class="op" id="3247484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3247487">//&nbsp;gt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3247525">func</span>&nbsp;<span class="ident" id="3247530">gt</span><span class="op" id="3247532">(</span><span class="ident" id="3247533">arg1</span><span class="op" id="3247537">,</span>&nbsp;<span class="ident" id="3247539">arg2</span>&nbsp;<span class="keyword" id="3247544">interface</span><span class="op" id="3247553">{</span><span class="op" id="3247554">}</span><span class="op" id="3247555">)</span>&nbsp;<span class="op" id="3247557">(</span><span class="builtintype" id="3247558">bool</span><span class="op" id="3247562">,</span>&nbsp;<span class="builtintype" id="3247564">error</span><span class="op" id="3247569">)</span>&nbsp;<span class="op" id="3247571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3247574">//&nbsp;&gt;&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;=.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247602">lessOrEqual</span><span class="op" id="3247613">,</span>&nbsp;<span class="ident" id="3247615">err</span>&nbsp;<span class="op" id="3247619">:=</span>&nbsp;<span class="ident" id="3247622">le</span><span class="op" id="3247624">(</span><span class="ident" id="3247625">arg1</span><span class="op" id="3247629">,</span>&nbsp;<span class="ident" id="3247631">arg2</span><span class="op" id="3247635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247638">if</span>&nbsp;<span class="ident" id="3247641">err</span>&nbsp;<span class="op" id="3247645">!=</span>&nbsp;<span class="ident" id="3247648">nil</span>&nbsp;<span class="op" id="3247652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247656">return</span>&nbsp;<span class="builtintype" id="3247663">false</span><span class="op" id="3247668">,</span>&nbsp;<span class="ident" id="3247670">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247678">return</span>&nbsp;<span class="op" id="3247685">!</span><span class="ident" id="3247686">lessOrEqual</span><span class="op" id="3247697">,</span>&nbsp;<span class="ident" id="3247699">nil</span><br>
<span class="lineno">420</span><span class="op" id="3247703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3247706">//&nbsp;ge&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3247745">func</span>&nbsp;<span class="ident" id="3247750">ge</span><span class="op" id="3247752">(</span><span class="ident" id="3247753">arg1</span><span class="op" id="3247757">,</span>&nbsp;<span class="ident" id="3247759">arg2</span>&nbsp;<span class="keyword" id="3247764">interface</span><span class="op" id="3247773">{</span><span class="op" id="3247774">}</span><span class="op" id="3247775">)</span>&nbsp;<span class="op" id="3247777">(</span><span class="builtintype" id="3247778">bool</span><span class="op" id="3247782">,</span>&nbsp;<span class="builtintype" id="3247784">error</span><span class="op" id="3247789">)</span>&nbsp;<span class="op" id="3247791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3247794">//&nbsp;&gt;=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247822">lessThan</span><span class="op" id="3247830">,</span>&nbsp;<span class="ident" id="3247832">err</span>&nbsp;<span class="op" id="3247836">:=</span>&nbsp;<span class="ident" id="3247839">lt</span><span class="op" id="3247841">(</span><span class="ident" id="3247842">arg1</span><span class="op" id="3247846">,</span>&nbsp;<span class="ident" id="3247848">arg2</span><span class="op" id="3247852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247855">if</span>&nbsp;<span class="ident" id="3247858">err</span>&nbsp;<span class="op" id="3247862">!=</span>&nbsp;<span class="ident" id="3247865">nil</span>&nbsp;<span class="op" id="3247869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247873">return</span>&nbsp;<span class="builtintype" id="3247880">false</span><span class="op" id="3247885">,</span>&nbsp;<span class="ident" id="3247887">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247895">return</span>&nbsp;<span class="op" id="3247902">!</span><span class="ident" id="3247903">lessThan</span><span class="op" id="3247911">,</span>&nbsp;<span class="ident" id="3247913">nil</span><br>
<span class="lineno">430</span><span class="op" id="3247917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3247920">//&nbsp;HTML&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3247939">var</span>&nbsp;<span class="op" id="3247943">(</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247946">htmlQuot</span>&nbsp;<span class="op" id="3247955">=</span>&nbsp;<span class="op" id="3247957">[</span><span class="op" id="3247958">]</span><span class="builtintype" id="3247959">byte</span><span class="op" id="3247963">(</span><span class="string" id="3247964">&#34;&amp;#34;&#34;</span><span class="op" id="3247971">)</span>&nbsp;<span class="comment" id="3247973">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;quot;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247999">htmlApos</span>&nbsp;<span class="op" id="3248008">=</span>&nbsp;<span class="op" id="3248010">[</span><span class="op" id="3248011">]</span><span class="builtintype" id="3248012">byte</span><span class="op" id="3248016">(</span><span class="string" id="3248017">&#34;&amp;#39;&#34;</span><span class="op" id="3248024">)</span>&nbsp;<span class="comment" id="3248026">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;apos;&#34;&nbsp;and&nbsp;apos&nbsp;was&nbsp;not&nbsp;in&nbsp;HTML&nbsp;until&nbsp;HTML5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248089">htmlAmp</span>&nbsp;&nbsp;<span class="op" id="3248098">=</span>&nbsp;<span class="op" id="3248100">[</span><span class="op" id="3248101">]</span><span class="builtintype" id="3248102">byte</span><span class="op" id="3248106">(</span><span class="string" id="3248107">&#34;&amp;amp;&#34;</span><span class="op" id="3248114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248117">htmlLt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3248126">=</span>&nbsp;<span class="op" id="3248128">[</span><span class="op" id="3248129">]</span><span class="builtintype" id="3248130">byte</span><span class="op" id="3248134">(</span><span class="string" id="3248135">&#34;&amp;lt;&#34;</span><span class="op" id="3248141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248144">htmlGt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3248153">=</span>&nbsp;<span class="op" id="3248155">[</span><span class="op" id="3248156">]</span><span class="builtintype" id="3248157">byte</span><span class="op" id="3248161">(</span><span class="string" id="3248162">&#34;&amp;gt;&#34;</span><span class="op" id="3248168">)</span><br>
<span class="lineno">440</span><span class="op" id="3248170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3248173">//&nbsp;HTMLEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3248253">func</span>&nbsp;<span class="ident" id="3248258">HTMLEscape</span><span class="op" id="3248268">(</span><span class="ident" id="3248269">w</span>&nbsp;<span class="ident" id="3248271">io</span><span class="op" id="3248273">.</span><span class="ident" id="3248274">Writer</span><span class="op" id="3248280">,</span>&nbsp;<span class="ident" id="3248282">b</span>&nbsp;<span class="op" id="3248284">[</span><span class="op" id="3248285">]</span><span class="builtintype" id="3248286">byte</span><span class="op" id="3248290">)</span>&nbsp;<span class="op" id="3248292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248295">last</span>&nbsp;<span class="op" id="3248300">:=</span>&nbsp;<span class="num" id="3248303">0</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248306">for</span>&nbsp;<span class="ident" id="3248310">i</span><span class="op" id="3248311">,</span>&nbsp;<span class="ident" id="3248313">c</span>&nbsp;<span class="op" id="3248315">:=</span>&nbsp;<span class="keyword" id="3248318">range</span>&nbsp;<span class="ident" id="3248324">b</span>&nbsp;<span class="op" id="3248326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248330">var</span>&nbsp;<span class="ident" id="3248334">html</span>&nbsp;<span class="op" id="3248339">[</span><span class="op" id="3248340">]</span><span class="builtintype" id="3248341">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248348">switch</span>&nbsp;<span class="ident" id="3248355">c</span>&nbsp;<span class="op" id="3248357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248361">case</span>&nbsp;<span class="string" id="3248366">&#39;&#34;&#39;</span><span class="op" id="3248369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248374">html</span>&nbsp;<span class="op" id="3248379">=</span>&nbsp;<span class="ident" id="3248381">htmlQuot</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248392">case</span>&nbsp;<span class="string" id="3248397">&#39;\&#39;&#39;</span><span class="op" id="3248401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248406">html</span>&nbsp;<span class="op" id="3248411">=</span>&nbsp;<span class="ident" id="3248413">htmlApos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248424">case</span>&nbsp;<span class="string" id="3248429">&#39;&amp;&#39;</span><span class="op" id="3248432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248437">html</span>&nbsp;<span class="op" id="3248442">=</span>&nbsp;<span class="ident" id="3248444">htmlAmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248454">case</span>&nbsp;<span class="string" id="3248459">&#39;&lt;&#39;</span><span class="op" id="3248462">:</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248467">html</span>&nbsp;<span class="op" id="3248472">=</span>&nbsp;<span class="ident" id="3248474">htmlLt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248483">case</span>&nbsp;<span class="string" id="3248488">&#39;&gt;&#39;</span><span class="op" id="3248491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248496">html</span>&nbsp;<span class="op" id="3248501">=</span>&nbsp;<span class="ident" id="3248503">htmlGt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248512">default</span><span class="op" id="3248519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248524">continue</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3248535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248539">w</span><span class="op" id="3248540">.</span><span class="ident" id="3248541">Write</span><span class="op" id="3248546">(</span><span class="ident" id="3248547">b</span><span class="op" id="3248548">[</span><span class="ident" id="3248549">last</span><span class="op" id="3248553">:</span><span class="ident" id="3248554">i</span><span class="op" id="3248555">]</span><span class="op" id="3248556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248560">w</span><span class="op" id="3248561">.</span><span class="ident" id="3248562">Write</span><span class="op" id="3248567">(</span><span class="ident" id="3248568">html</span><span class="op" id="3248572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248576">last</span>&nbsp;<span class="op" id="3248581">=</span>&nbsp;<span class="ident" id="3248583">i</span>&nbsp;<span class="op" id="3248585">+</span>&nbsp;<span class="num" id="3248587">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3248590">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248593">w</span><span class="op" id="3248594">.</span><span class="ident" id="3248595">Write</span><span class="op" id="3248600">(</span><span class="ident" id="3248601">b</span><span class="op" id="3248602">[</span><span class="ident" id="3248603">last</span><span class="op" id="3248607">:</span><span class="op" id="3248608">]</span><span class="op" id="3248609">)</span><br>
<span class="lineno"></span><span class="op" id="3248611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3248614">//&nbsp;HTMLEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3248696">func</span>&nbsp;<span class="ident" id="3248701">HTMLEscapeString</span><span class="op" id="3248717">(</span><span class="ident" id="3248718">s</span>&nbsp;<span class="builtintype" id="3248720">string</span><span class="op" id="3248726">)</span>&nbsp;<span class="builtintype" id="3248728">string</span>&nbsp;<span class="op" id="3248735">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3248738">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248770">if</span>&nbsp;<span class="ident" id="3248773">strings</span><span class="op" id="3248780">.</span><span class="ident" id="3248781">IndexAny</span><span class="op" id="3248789">(</span><span class="ident" id="3248790">s</span><span class="op" id="3248791">,</span>&nbsp;<span class="string" id="3248793">`&#39;&#34;&amp;&lt;&gt;`</span><span class="op" id="3248800">)</span>&nbsp;<span class="op" id="3248802">&lt;</span>&nbsp;<span class="num" id="3248804">0</span>&nbsp;<span class="op" id="3248806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248810">return</span>&nbsp;<span class="ident" id="3248817">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3248820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248823">var</span>&nbsp;<span class="ident" id="3248827">b</span>&nbsp;<span class="ident" id="3248829">bytes</span><span class="op" id="3248834">.</span><span class="ident" id="3248835">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3248843">HTMLEscape</span><span class="op" id="3248853">(</span><span class="op" id="3248854">&amp;</span><span class="ident" id="3248855">b</span><span class="op" id="3248856">,</span>&nbsp;<span class="op" id="3248858">[</span><span class="op" id="3248859">]</span><span class="builtintype" id="3248860">byte</span><span class="op" id="3248864">(</span><span class="ident" id="3248865">s</span><span class="op" id="3248866">)</span><span class="op" id="3248867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3248870">return</span>&nbsp;<span class="ident" id="3248877">b</span><span class="op" id="3248878">.</span><span class="ident" id="3248879">String</span><span class="op" id="3248885">(</span><span class="op" id="3248886">)</span><br>
<span class="lineno"></span><span class="op" id="3248888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3248891">//&nbsp;HTMLEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">480</span><span class="comment" id="3248957">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="3248993">func</span>&nbsp;<span class="ident" id="3248998">HTMLEscaper</span><span class="op" id="3249009">(</span><span class="ident" id="3249010">args</span>&nbsp;<span class="op" id="3249015">...</span><span class="keyword" id="3249018">interface</span><span class="op" id="3249027">{</span><span class="op" id="3249028">}</span><span class="op" id="3249029">)</span>&nbsp;<span class="builtintype" id="3249031">string</span>&nbsp;<span class="op" id="3249038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249041">return</span>&nbsp;<span class="ident" id="3249048">HTMLEscapeString</span><span class="op" id="3249064">(</span><span class="ident" id="3249065">evalArgs</span><span class="op" id="3249073">(</span><span class="ident" id="3249074">args</span><span class="op" id="3249078">)</span><span class="op" id="3249079">)</span><br>
<span class="lineno"></span><span class="op" id="3249081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="3249084">//&nbsp;JavaScript&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3249109">var</span>&nbsp;<span class="op" id="3249113">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249116">jsLowUni</span>&nbsp;<span class="op" id="3249125">=</span>&nbsp;<span class="op" id="3249127">[</span><span class="op" id="3249128">]</span><span class="builtintype" id="3249129">byte</span><span class="op" id="3249133">(</span><span class="string" id="3249134">`\u00`</span><span class="op" id="3249140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249143">hex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249152">=</span>&nbsp;<span class="op" id="3249154">[</span><span class="op" id="3249155">]</span><span class="builtintype" id="3249156">byte</span><span class="op" id="3249160">(</span><span class="string" id="3249161">&#34;0123456789ABCDEF&#34;</span><span class="op" id="3249179">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249183">jsBackslash</span>&nbsp;<span class="op" id="3249195">=</span>&nbsp;<span class="op" id="3249197">[</span><span class="op" id="3249198">]</span><span class="builtintype" id="3249199">byte</span><span class="op" id="3249203">(</span><span class="string" id="3249204">`\\`</span><span class="op" id="3249208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249211">jsApos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249223">=</span>&nbsp;<span class="op" id="3249225">[</span><span class="op" id="3249226">]</span><span class="builtintype" id="3249227">byte</span><span class="op" id="3249231">(</span><span class="string" id="3249232">`\&#39;`</span><span class="op" id="3249236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249239">jsQuot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249251">=</span>&nbsp;<span class="op" id="3249253">[</span><span class="op" id="3249254">]</span><span class="builtintype" id="3249255">byte</span><span class="op" id="3249259">(</span><span class="string" id="3249260">`\&#34;`</span><span class="op" id="3249264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249267">jsLt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249279">=</span>&nbsp;<span class="op" id="3249281">[</span><span class="op" id="3249282">]</span><span class="builtintype" id="3249283">byte</span><span class="op" id="3249287">(</span><span class="string" id="3249288">`\x3C`</span><span class="op" id="3249294">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249297">jsGt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249309">=</span>&nbsp;<span class="op" id="3249311">[</span><span class="op" id="3249312">]</span><span class="builtintype" id="3249313">byte</span><span class="op" id="3249317">(</span><span class="string" id="3249318">`\x3E`</span><span class="op" id="3249324">)</span><br>
<span class="lineno"></span><span class="op" id="3249326">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3249329">//&nbsp;JSEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3249413">func</span>&nbsp;<span class="ident" id="3249418">JSEscape</span><span class="op" id="3249426">(</span><span class="ident" id="3249427">w</span>&nbsp;<span class="ident" id="3249429">io</span><span class="op" id="3249431">.</span><span class="ident" id="3249432">Writer</span><span class="op" id="3249438">,</span>&nbsp;<span class="ident" id="3249440">b</span>&nbsp;<span class="op" id="3249442">[</span><span class="op" id="3249443">]</span><span class="builtintype" id="3249444">byte</span><span class="op" id="3249448">)</span>&nbsp;<span class="op" id="3249450">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249453">last</span>&nbsp;<span class="op" id="3249458">:=</span>&nbsp;<span class="num" id="3249461">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249464">for</span>&nbsp;<span class="ident" id="3249468">i</span>&nbsp;<span class="op" id="3249470">:=</span>&nbsp;<span class="num" id="3249473">0</span><span class="op" id="3249474">;</span>&nbsp;<span class="ident" id="3249476">i</span>&nbsp;<span class="op" id="3249478">&lt;</span>&nbsp;<span class="builtinfunc" id="3249480">len</span><span class="op" id="3249483">(</span><span class="ident" id="3249484">b</span><span class="op" id="3249485">)</span><span class="op" id="3249486">;</span>&nbsp;<span class="ident" id="3249488">i</span><span class="op" id="3249489">++</span>&nbsp;<span class="op" id="3249492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249496">c</span>&nbsp;<span class="op" id="3249498">:=</span>&nbsp;<span class="ident" id="3249501">b</span><span class="op" id="3249502">[</span><span class="ident" id="3249503">i</span><span class="op" id="3249504">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249509">if</span>&nbsp;<span class="op" id="3249512">!</span><span class="ident" id="3249513">jsIsSpecial</span><span class="op" id="3249524">(</span><span class="builtintype" id="3249525">rune</span><span class="op" id="3249529">(</span><span class="ident" id="3249530">c</span><span class="op" id="3249531">)</span><span class="op" id="3249532">)</span>&nbsp;<span class="op" id="3249534">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3249539">//&nbsp;fast&nbsp;path:&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249570">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3249581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249585">w</span><span class="op" id="3249586">.</span><span class="ident" id="3249587">Write</span><span class="op" id="3249592">(</span><span class="ident" id="3249593">b</span><span class="op" id="3249594">[</span><span class="ident" id="3249595">last</span><span class="op" id="3249599">:</span><span class="ident" id="3249600">i</span><span class="op" id="3249601">]</span><span class="op" id="3249602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249607">if</span>&nbsp;<span class="ident" id="3249610">c</span>&nbsp;<span class="op" id="3249612">&lt;</span>&nbsp;<span class="ident" id="3249614">utf8</span><span class="op" id="3249618">.</span><span class="ident" id="3249619">RuneSelf</span>&nbsp;<span class="op" id="3249628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3249633">//&nbsp;Quotes,&nbsp;slashes&nbsp;and&nbsp;angle&nbsp;brackets&nbsp;get&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3249686">//&nbsp;Control&nbsp;characters&nbsp;get&nbsp;written&nbsp;as&nbsp;\u00XX.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249734">switch</span>&nbsp;<span class="ident" id="3249741">c</span>&nbsp;<span class="op" id="3249743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249748">case</span>&nbsp;<span class="string" id="3249753">&#39;\\&#39;</span><span class="op" id="3249757">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249763">w</span><span class="op" id="3249764">.</span><span class="ident" id="3249765">Write</span><span class="op" id="3249770">(</span><span class="ident" id="3249771">jsBackslash</span><span class="op" id="3249782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249787">case</span>&nbsp;<span class="string" id="3249792">&#39;\&#39;&#39;</span><span class="op" id="3249796">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249802">w</span><span class="op" id="3249803">.</span><span class="ident" id="3249804">Write</span><span class="op" id="3249809">(</span><span class="ident" id="3249810">jsApos</span><span class="op" id="3249816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249821">case</span>&nbsp;<span class="string" id="3249826">&#39;&#34;&#39;</span><span class="op" id="3249829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249835">w</span><span class="op" id="3249836">.</span><span class="ident" id="3249837">Write</span><span class="op" id="3249842">(</span><span class="ident" id="3249843">jsQuot</span><span class="op" id="3249849">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249854">case</span>&nbsp;<span class="string" id="3249859">&#39;&lt;&#39;</span><span class="op" id="3249862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249868">w</span><span class="op" id="3249869">.</span><span class="ident" id="3249870">Write</span><span class="op" id="3249875">(</span><span class="ident" id="3249876">jsLt</span><span class="op" id="3249880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249885">case</span>&nbsp;<span class="string" id="3249890">&#39;&gt;&#39;</span><span class="op" id="3249893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249899">w</span><span class="op" id="3249900">.</span><span class="ident" id="3249901">Write</span><span class="op" id="3249906">(</span><span class="ident" id="3249907">jsGt</span><span class="op" id="3249911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3249916">default</span><span class="op" id="3249923">:</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249929">w</span><span class="op" id="3249930">.</span><span class="ident" id="3249931">Write</span><span class="op" id="3249936">(</span><span class="ident" id="3249937">jsLowUni</span><span class="op" id="3249945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249951">t</span><span class="op" id="3249952">,</span>&nbsp;<span class="ident" id="3249954">b</span>&nbsp;<span class="op" id="3249956">:=</span>&nbsp;<span class="ident" id="3249959">c</span><span class="op" id="3249960">&gt;&gt;</span><span class="num" id="3249962">4</span><span class="op" id="3249963">,</span>&nbsp;<span class="ident" id="3249965">c</span><span class="op" id="3249966">&amp;</span><span class="num" id="3249967">0x0f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3249976">w</span><span class="op" id="3249977">.</span><span class="ident" id="3249978">Write</span><span class="op" id="3249983">(</span><span class="ident" id="3249984">hex</span><span class="op" id="3249987">[</span><span class="ident" id="3249988">t</span>&nbsp;<span class="op" id="3249990">:</span>&nbsp;<span class="ident" id="3249992">t</span><span class="op" id="3249993">+</span><span class="num" id="3249994">1</span><span class="op" id="3249995">]</span><span class="op" id="3249996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250002">w</span><span class="op" id="3250003">.</span><span class="ident" id="3250004">Write</span><span class="op" id="3250009">(</span><span class="ident" id="3250010">hex</span><span class="op" id="3250013">[</span><span class="ident" id="3250014">b</span>&nbsp;<span class="op" id="3250016">:</span>&nbsp;<span class="ident" id="3250018">b</span><span class="op" id="3250019">+</span><span class="num" id="3250020">1</span><span class="op" id="3250021">]</span><span class="op" id="3250022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250027">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250031">}</span>&nbsp;<span class="keyword" id="3250033">else</span>&nbsp;<span class="op" id="3250038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3250043">//&nbsp;Unicode&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250063">r</span><span class="op" id="3250064">,</span>&nbsp;<span class="ident" id="3250066">size</span>&nbsp;<span class="op" id="3250071">:=</span>&nbsp;<span class="ident" id="3250074">utf8</span><span class="op" id="3250078">.</span><span class="ident" id="3250079">DecodeRune</span><span class="op" id="3250089">(</span><span class="ident" id="3250090">b</span><span class="op" id="3250091">[</span><span class="ident" id="3250092">i</span><span class="op" id="3250093">:</span><span class="op" id="3250094">]</span><span class="op" id="3250095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250100">if</span>&nbsp;<span class="ident" id="3250103">unicode</span><span class="op" id="3250110">.</span><span class="ident" id="3250111">IsPrint</span><span class="op" id="3250118">(</span><span class="ident" id="3250119">r</span><span class="op" id="3250120">)</span>&nbsp;<span class="op" id="3250122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250128">w</span><span class="op" id="3250129">.</span><span class="ident" id="3250130">Write</span><span class="op" id="3250135">(</span><span class="ident" id="3250136">b</span><span class="op" id="3250137">[</span><span class="ident" id="3250138">i</span>&nbsp;<span class="op" id="3250140">:</span>&nbsp;<span class="ident" id="3250142">i</span><span class="op" id="3250143">+</span><span class="ident" id="3250144">size</span><span class="op" id="3250148">]</span><span class="op" id="3250149">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250154">}</span>&nbsp;<span class="keyword" id="3250156">else</span>&nbsp;<span class="op" id="3250161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250167">fmt</span><span class="op" id="3250170">.</span><span class="ident" id="3250171">Fprintf</span><span class="op" id="3250178">(</span><span class="ident" id="3250179">w</span><span class="op" id="3250180">,</span>&nbsp;<span class="string" id="3250182">&#34;\\u%04X&#34;</span><span class="op" id="3250191">,</span>&nbsp;<span class="ident" id="3250193">r</span><span class="op" id="3250194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250204">i</span>&nbsp;<span class="op" id="3250206">+=</span>&nbsp;<span class="ident" id="3250209">size</span>&nbsp;<span class="op" id="3250214">-</span>&nbsp;<span class="num" id="3250216">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250220">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250224">last</span>&nbsp;<span class="op" id="3250229">=</span>&nbsp;<span class="ident" id="3250231">i</span>&nbsp;<span class="op" id="3250233">+</span>&nbsp;<span class="num" id="3250235">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250241">w</span><span class="op" id="3250242">.</span><span class="ident" id="3250243">Write</span><span class="op" id="3250248">(</span><span class="ident" id="3250249">b</span><span class="op" id="3250250">[</span><span class="ident" id="3250251">last</span><span class="op" id="3250255">:</span><span class="op" id="3250256">]</span><span class="op" id="3250257">)</span><br>
<span class="lineno"></span><span class="op" id="3250259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="3250262">//&nbsp;JSEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3250348">func</span>&nbsp;<span class="ident" id="3250353">JSEscapeString</span><span class="op" id="3250367">(</span><span class="ident" id="3250368">s</span>&nbsp;<span class="builtintype" id="3250370">string</span><span class="op" id="3250376">)</span>&nbsp;<span class="builtintype" id="3250378">string</span>&nbsp;<span class="op" id="3250385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3250388">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250420">if</span>&nbsp;<span class="ident" id="3250423">strings</span><span class="op" id="3250430">.</span><span class="ident" id="3250431">IndexFunc</span><span class="op" id="3250440">(</span><span class="ident" id="3250441">s</span><span class="op" id="3250442">,</span>&nbsp;<span class="ident" id="3250444">jsIsSpecial</span><span class="op" id="3250455">)</span>&nbsp;<span class="op" id="3250457">&lt;</span>&nbsp;<span class="num" id="3250459">0</span>&nbsp;<span class="op" id="3250461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250465">return</span>&nbsp;<span class="ident" id="3250472">s</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250478">var</span>&nbsp;<span class="ident" id="3250482">b</span>&nbsp;<span class="ident" id="3250484">bytes</span><span class="op" id="3250489">.</span><span class="ident" id="3250490">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250498">JSEscape</span><span class="op" id="3250506">(</span><span class="op" id="3250507">&amp;</span><span class="ident" id="3250508">b</span><span class="op" id="3250509">,</span>&nbsp;<span class="op" id="3250511">[</span><span class="op" id="3250512">]</span><span class="builtintype" id="3250513">byte</span><span class="op" id="3250517">(</span><span class="ident" id="3250518">s</span><span class="op" id="3250519">)</span><span class="op" id="3250520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250523">return</span>&nbsp;<span class="ident" id="3250530">b</span><span class="op" id="3250531">.</span><span class="ident" id="3250532">String</span><span class="op" id="3250538">(</span><span class="op" id="3250539">)</span><br>
<span class="lineno"></span><span class="op" id="3250541">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span><span class="keyword" id="3250544">func</span>&nbsp;<span class="ident" id="3250549">jsIsSpecial</span><span class="op" id="3250560">(</span><span class="ident" id="3250561">r</span>&nbsp;<span class="builtintype" id="3250563">rune</span><span class="op" id="3250567">)</span>&nbsp;<span class="builtintype" id="3250569">bool</span>&nbsp;<span class="op" id="3250574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250577">switch</span>&nbsp;<span class="ident" id="3250584">r</span>&nbsp;<span class="op" id="3250586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250589">case</span>&nbsp;<span class="string" id="3250594">&#39;\\&#39;</span><span class="op" id="3250598">,</span>&nbsp;<span class="string" id="3250600">&#39;\&#39;&#39;</span><span class="op" id="3250604">,</span>&nbsp;<span class="string" id="3250606">&#39;&#34;&#39;</span><span class="op" id="3250609">,</span>&nbsp;<span class="string" id="3250611">&#39;&lt;&#39;</span><span class="op" id="3250614">,</span>&nbsp;<span class="string" id="3250616">&#39;&gt;&#39;</span><span class="op" id="3250619">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250623">return</span>&nbsp;<span class="builtintype" id="3250630">true</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250639">return</span>&nbsp;<span class="ident" id="3250646">r</span>&nbsp;<span class="op" id="3250648">&lt;</span>&nbsp;<span class="string" id="3250650">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3250654">||</span>&nbsp;<span class="ident" id="3250657">utf8</span><span class="op" id="3250661">.</span><span class="ident" id="3250662">RuneSelf</span>&nbsp;<span class="op" id="3250671">&lt;=</span>&nbsp;<span class="ident" id="3250674">r</span><br>
<span class="lineno"></span><span class="op" id="3250676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3250679">//&nbsp;JSEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">565</span><span class="comment" id="3250749">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="3250785">func</span>&nbsp;<span class="ident" id="3250790">JSEscaper</span><span class="op" id="3250799">(</span><span class="ident" id="3250800">args</span>&nbsp;<span class="op" id="3250805">...</span><span class="keyword" id="3250808">interface</span><span class="op" id="3250817">{</span><span class="op" id="3250818">}</span><span class="op" id="3250819">)</span>&nbsp;<span class="builtintype" id="3250821">string</span>&nbsp;<span class="op" id="3250828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250831">return</span>&nbsp;<span class="ident" id="3250838">JSEscapeString</span><span class="op" id="3250852">(</span><span class="ident" id="3250853">evalArgs</span><span class="op" id="3250861">(</span><span class="ident" id="3250862">args</span><span class="op" id="3250866">)</span><span class="op" id="3250867">)</span><br>
<span class="lineno"></span><span class="op" id="3250869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="comment" id="3250872">//&nbsp;URLQueryEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;value&nbsp;of&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3250950">//&nbsp;its&nbsp;arguments&nbsp;in&nbsp;a&nbsp;form&nbsp;suitable&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;URL&nbsp;query.</span><br>
<span class="lineno"></span><span class="keyword" id="3251016">func</span>&nbsp;<span class="ident" id="3251021">URLQueryEscaper</span><span class="op" id="3251036">(</span><span class="ident" id="3251037">args</span>&nbsp;<span class="op" id="3251042">...</span><span class="keyword" id="3251045">interface</span><span class="op" id="3251054">{</span><span class="op" id="3251055">}</span><span class="op" id="3251056">)</span>&nbsp;<span class="builtintype" id="3251058">string</span>&nbsp;<span class="op" id="3251065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251068">return</span>&nbsp;<span class="ident" id="3251075">url</span><span class="op" id="3251078">.</span><span class="ident" id="3251079">QueryEscape</span><span class="op" id="3251090">(</span><span class="ident" id="3251091">evalArgs</span><span class="op" id="3251099">(</span><span class="ident" id="3251100">args</span><span class="op" id="3251104">)</span><span class="op" id="3251105">)</span><br>
<span class="lineno"></span><span class="op" id="3251107">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3251110">//&nbsp;evalArgs&nbsp;formats&nbsp;the&nbsp;list&nbsp;of&nbsp;arguments&nbsp;into&nbsp;a&nbsp;string.&nbsp;It&nbsp;is&nbsp;therefore&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3251197">//&nbsp;&nbsp;&nbsp;&nbspfmt.Sprint(args...)</span><br>
<span class="lineno"></span><span class="comment" id="3251220">//&nbsp;except&nbsp;that&nbsp;each&nbsp;argument&nbsp;is&nbsp;indirected&nbsp;(if&nbsp;a&nbsp;pointer),&nbsp;as&nbsp;required,</span><br>
<span class="lineno"></span><span class="comment" id="3251292">//&nbsp;using&nbsp;the&nbsp;same&nbsp;rules&nbsp;as&nbsp;the&nbsp;default&nbsp;string&nbsp;evaluation&nbsp;during&nbsp;template</span><br>
<span class="lineno">580</span><span class="comment" id="3251365">//&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="3251379">func</span>&nbsp;<span class="ident" id="3251384">evalArgs</span><span class="op" id="3251392">(</span><span class="ident" id="3251393">args</span>&nbsp;<span class="op" id="3251398">[</span><span class="op" id="3251399">]</span><span class="keyword" id="3251400">interface</span><span class="op" id="3251409">{</span><span class="op" id="3251410">}</span><span class="op" id="3251411">)</span>&nbsp;<span class="builtintype" id="3251413">string</span>&nbsp;<span class="op" id="3251420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251423">ok</span>&nbsp;<span class="op" id="3251426">:=</span>&nbsp;<span class="builtintype" id="3251429">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251436">var</span>&nbsp;<span class="ident" id="3251440">s</span>&nbsp;<span class="builtintype" id="3251442">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251450">//&nbsp;Fast&nbsp;path&nbsp;for&nbsp;simple&nbsp;common&nbsp;case.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251488">if</span>&nbsp;<span class="builtinfunc" id="3251491">len</span><span class="op" id="3251494">(</span><span class="ident" id="3251495">args</span><span class="op" id="3251499">)</span>&nbsp;<span class="op" id="3251501">==</span>&nbsp;<span class="num" id="3251504">1</span>&nbsp;<span class="op" id="3251506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251510">s</span><span class="op" id="3251511">,</span>&nbsp;<span class="ident" id="3251513">ok</span>&nbsp;<span class="op" id="3251516">=</span>&nbsp;<span class="ident" id="3251518">args</span><span class="op" id="3251522">[</span><span class="num" id="3251523">0</span><span class="op" id="3251524">]</span><span class="op" id="3251525">.</span><span class="op" id="3251526">(</span><span class="builtintype" id="3251527">string</span><span class="op" id="3251533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251539">if</span>&nbsp;<span class="op" id="3251542">!</span><span class="ident" id="3251543">ok</span>&nbsp;<span class="op" id="3251546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251550">for</span>&nbsp;<span class="ident" id="3251554">i</span><span class="op" id="3251555">,</span>&nbsp;<span class="ident" id="3251557">arg</span>&nbsp;<span class="op" id="3251561">:=</span>&nbsp;<span class="keyword" id="3251564">range</span>&nbsp;<span class="ident" id="3251570">args</span>&nbsp;<span class="op" id="3251575">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251580">a</span><span class="op" id="3251581">,</span>&nbsp;<span class="ident" id="3251583">ok</span>&nbsp;<span class="op" id="3251586">:=</span>&nbsp;<span class="ident" id="3251589">printableValue</span><span class="op" id="3251603">(</span><span class="ident" id="3251604">reflect</span><span class="op" id="3251611">.</span><span class="ident" id="3251612">ValueOf</span><span class="op" id="3251619">(</span><span class="ident" id="3251620">arg</span><span class="op" id="3251623">)</span><span class="op" id="3251624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251629">if</span>&nbsp;<span class="ident" id="3251632">ok</span>&nbsp;<span class="op" id="3251635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251641">args</span><span class="op" id="3251645">[</span><span class="ident" id="3251646">i</span><span class="op" id="3251647">]</span>&nbsp;<span class="op" id="3251649">=</span>&nbsp;<span class="ident" id="3251651">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251656">}</span>&nbsp;<span class="comment" id="3251658">//&nbsp;else&nbsp;left&nbsp;fmt&nbsp;do&nbsp;its&nbsp;thing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251690">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251694">s</span>&nbsp;<span class="op" id="3251696">=</span>&nbsp;<span class="ident" id="3251698">fmt</span><span class="op" id="3251701">.</span><span class="ident" id="3251702">Sprint</span><span class="op" id="3251708">(</span><span class="ident" id="3251709">args</span><span class="op" id="3251713">...</span><span class="op" id="3251716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251722">return</span>&nbsp;<span class="ident" id="3251729">s</span><br>
<span class="lineno"></span><span class="op" id="3251731">}</span>
</div>
</body>
</html>
