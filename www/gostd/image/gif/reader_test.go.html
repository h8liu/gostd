<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/gif</h2>
<ul>
<li><a href="/gostd/image/gif/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/gif/reader_test.go.html" class="current">reader_test.go</a></li>
<li><a href="/gostd/image/gif/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/gif/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7481411">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7481466">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7481520">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7481571">package</span>&nbsp;<span class="ident" id="7481579">gif</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7481584">import</span>&nbsp;<span class="op" id="7481591">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481594">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481603">&#34;compress/lzw&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481619">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481628">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481643">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481654">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7481664">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7481667">//&nbsp;header,&nbsp;palette&nbsp;and&nbsp;trailer&nbsp;are&nbsp;parts&nbsp;of&nbsp;a&nbsp;valid&nbsp;2x1&nbsp;GIF&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="7481734">const</span>&nbsp;<span class="op" id="7481740">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481743">headerStr</span>&nbsp;<span class="op" id="7481753">=</span>&nbsp;<span class="string" id="7481755">&#34;GIF89a&#34;</span>&nbsp;<span class="op" id="7481764">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481768">&#34;\x02\x00\x01\x00&#34;</span>&nbsp;<span class="op" id="7481787">+</span>&nbsp;<span class="comment" id="7481789">//&nbsp;width=2,&nbsp;height=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481812">&#34;\x80\x00\x00&#34;</span>&nbsp;<span class="comment" id="7481827">//&nbsp;headerFields=(a&nbsp;color&nbsp;map&nbsp;of&nbsp;2&nbsp;pixels),&nbsp;backgroundIndex,&nbsp;aspect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481895">paletteStr</span>&nbsp;<span class="op" id="7481906">=</span>&nbsp;<span class="string" id="7481908">&#34;\x10\x20\x30\x40\x50\x60&#34;</span>&nbsp;<span class="comment" id="7481935">//&nbsp;the&nbsp;color&nbsp;map,&nbsp;also&nbsp;known&nbsp;as&nbsp;a&nbsp;palette</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481978">trailerStr</span>&nbsp;<span class="op" id="7481989">=</span>&nbsp;<span class="string" id="7481991">&#34;\x3b&#34;</span><br>
<span class="lineno"></span><span class="op" id="7481998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="7482001">//&nbsp;lzwEncode&nbsp;returns&nbsp;an&nbsp;LZW&nbsp;encoding&nbsp;(with&nbsp;2-bit&nbsp;literals)&nbsp;of&nbsp;n&nbsp;zeroes.</span><br>
<span class="lineno"></span><span class="keyword" id="7482073">func</span>&nbsp;<span class="ident" id="7482078">lzwEncode</span><span class="op" id="7482087">(</span><span class="ident" id="7482088">n</span>&nbsp;<span class="builtintype" id="7482090">int</span><span class="op" id="7482093">)</span>&nbsp;<span class="op" id="7482095">[</span><span class="op" id="7482096">]</span><span class="builtintype" id="7482097">byte</span>&nbsp;<span class="op" id="7482102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482105">b</span>&nbsp;<span class="op" id="7482107">:=</span>&nbsp;<span class="op" id="7482110">&amp;</span><span class="ident" id="7482111"><a href="/gostd/image/gif/reader_test.go.html#7481594">bytes</a></span><span class="op" id="7482116">.</span><span class="ident" id="7482117"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7482123">{</span><span class="op" id="7482124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482127">w</span>&nbsp;<span class="op" id="7482129">:=</span>&nbsp;<span class="ident" id="7482132"><a href="/gostd/image/gif/reader_test.go.html#7481603">lzw</a></span><span class="op" id="7482135">.</span><span class="ident" id="7482136"><a href="/gostd/compress/lzw/writer.go.html#5746657">NewWriter</a></span><span class="op" id="7482145">(</span><span class="ident" id="7482146"><a href="/gostd/image/gif/reader_test.go.html#7482105">b</a></span><span class="op" id="7482147">,</span>&nbsp;<span class="ident" id="7482149"><a href="/gostd/image/gif/reader_test.go.html#7481603">lzw</a></span><span class="op" id="7482152">.</span><span class="ident" id="7482153"><a href="/gostd/compress/lzw/reader.go.html#5734384">LSB</a></span><span class="op" id="7482156">,</span>&nbsp;<span class="num" id="7482158">2</span><span class="op" id="7482159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482162"><a href="/gostd/image/gif/reader_test.go.html#7482127">w</a></span><span class="op" id="7482163">.</span><span class="ident" id="7482164"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7482169">(</span><span class="builtinfunc" id="7482170">make</span><span class="op" id="7482174">(</span><span class="op" id="7482175">[</span><span class="op" id="7482176">]</span><span class="builtintype" id="7482177">byte</span><span class="op" id="7482181">,</span>&nbsp;<span class="ident" id="7482183"><a href="/gostd/image/gif/reader_test.go.html#7482088">n</a></span><span class="op" id="7482184">)</span><span class="op" id="7482185">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482188"><a href="/gostd/image/gif/reader_test.go.html#7482127">w</a></span><span class="op" id="7482189">.</span><span class="ident" id="7482190"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="7482195">(</span><span class="op" id="7482196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482199">return</span>&nbsp;<span class="ident" id="7482206"><a href="/gostd/image/gif/reader_test.go.html#7482105">b</a></span><span class="op" id="7482207">.</span><span class="ident" id="7482208"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7482213">(</span><span class="op" id="7482214">)</span><br>
<span class="lineno"></span><span class="op" id="7482216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7482219">func</span>&nbsp;<span class="ident" id="7482224">TestDecode</span><span class="op" id="7482234">(</span><span class="ident" id="7482235">t</span>&nbsp;<span class="op" id="7482237">*</span><span class="ident" id="7482238"><a href="/gostd/image/gif/reader_test.go.html#7481654">testing</a></span><span class="op" id="7482245">.</span><span class="ident" id="7482246"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7482247">)</span>&nbsp;<span class="op" id="7482249">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482252">testCases</span>&nbsp;<span class="op" id="7482262">:=</span>&nbsp;<span class="op" id="7482265">[</span><span class="op" id="7482266">]</span><span class="keyword" id="7482267">struct</span>&nbsp;<span class="op" id="7482274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482278">nPix</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7482286">int</span>&nbsp;&nbsp;<span class="comment" id="7482291">//&nbsp;The&nbsp;number&nbsp;of&nbsp;pixels&nbsp;in&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482336">extra</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7482344">bool</span>&nbsp;<span class="comment" id="7482349">//&nbsp;Whether&nbsp;to&nbsp;write&nbsp;an&nbsp;extra&nbsp;block&nbsp;after&nbsp;the&nbsp;LZW-encoded&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482414">wantErr</span>&nbsp;<span class="builtintype" id="7482422">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482429">}</span><span class="op" id="7482430">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482434">{</span><span class="num" id="7482435">0</span><span class="op" id="7482436">,</span>&nbsp;<span class="builtintype" id="7482438">false</span><span class="op" id="7482443">,</span>&nbsp;<span class="ident" id="7482445"><a href="/gostd/image/gif/reader.go.html#5714593">errNotEnough</a></span><span class="op" id="7482457">}</span><span class="op" id="7482458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482462">{</span><span class="num" id="7482463">1</span><span class="op" id="7482464">,</span>&nbsp;<span class="builtintype" id="7482466">false</span><span class="op" id="7482471">,</span>&nbsp;<span class="ident" id="7482473"><a href="/gostd/image/gif/reader.go.html#5714593">errNotEnough</a></span><span class="op" id="7482485">}</span><span class="op" id="7482486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482490">{</span><span class="num" id="7482491">2</span><span class="op" id="7482492">,</span>&nbsp;<span class="builtintype" id="7482494">false</span><span class="op" id="7482499">,</span>&nbsp;<span class="builtintype" id="7482501">nil</span><span class="op" id="7482504">}</span><span class="op" id="7482505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482509">{</span><span class="num" id="7482510">2</span><span class="op" id="7482511">,</span>&nbsp;<span class="builtintype" id="7482513">true</span><span class="op" id="7482517">,</span>&nbsp;<span class="ident" id="7482519"><a href="/gostd/image/gif/reader.go.html#5714650">errTooMuch</a></span><span class="op" id="7482529">}</span><span class="op" id="7482530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482534">{</span><span class="num" id="7482535">3</span><span class="op" id="7482536">,</span>&nbsp;<span class="builtintype" id="7482538">false</span><span class="op" id="7482543">,</span>&nbsp;<span class="ident" id="7482545"><a href="/gostd/image/gif/reader.go.html#5714650">errTooMuch</a></span><span class="op" id="7482555">}</span><span class="op" id="7482556">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482562">for</span>&nbsp;<span class="ident" id="7482566">_</span><span class="op" id="7482567">,</span>&nbsp;<span class="ident" id="7482569">tc</span>&nbsp;<span class="op" id="7482572">:=</span>&nbsp;<span class="keyword" id="7482575">range</span>&nbsp;<span class="ident" id="7482581"><a href="/gostd/image/gif/reader_test.go.html#7482252">testCases</a></span>&nbsp;<span class="op" id="7482591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482595">b</span>&nbsp;<span class="op" id="7482597">:=</span>&nbsp;<span class="op" id="7482600">&amp;</span><span class="ident" id="7482601"><a href="/gostd/image/gif/reader_test.go.html#7481594">bytes</a></span><span class="op" id="7482606">.</span><span class="ident" id="7482607"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7482613">{</span><span class="op" id="7482614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482618"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7482619">.</span><span class="ident" id="7482620"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7482631">(</span><span class="ident" id="7482632"><a href="/gostd/image/gif/reader_test.go.html#7481743">headerStr</a></span><span class="op" id="7482641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482645"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7482646">.</span><span class="ident" id="7482647"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7482658">(</span><span class="ident" id="7482659"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7482669">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7482673">//&nbsp;Write&nbsp;an&nbsp;image&nbsp;with&nbsp;bounds&nbsp;2x1&nbsp;but&nbsp;tc.nPix&nbsp;pixels.&nbsp;If&nbsp;tc.nPix&nbsp;!=&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7482745">//&nbsp;then&nbsp;this&nbsp;should&nbsp;result&nbsp;in&nbsp;an&nbsp;invalid&nbsp;GIF&nbsp;image.&nbsp;First,&nbsp;write&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7482814">//&nbsp;magic&nbsp;0x2c&nbsp;(image&nbsp;descriptor)&nbsp;byte,&nbsp;bounds=(0,0)-(2,1),&nbsp;a&nbsp;flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7482883">//&nbsp;byte,&nbsp;and&nbsp;2-bit&nbsp;LZW&nbsp;literals.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482918"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7482919">.</span><span class="ident" id="7482920"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7482931">(</span><span class="string" id="7482932">&#34;\x2c\x00\x00\x00\x00\x02\x00\x01\x00\x00\x02&#34;</span><span class="op" id="7482978">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482982">if</span>&nbsp;<span class="ident" id="7482985"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7482987">.</span><span class="ident" id="7482988"><a href="/gostd/image/gif/reader_test.go.html#7482278">nPix</a></span>&nbsp;<span class="op" id="7482993">&gt;</span>&nbsp;<span class="num" id="7482995">0</span>&nbsp;<span class="op" id="7482997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483002">enc</span>&nbsp;<span class="op" id="7483006">:=</span>&nbsp;<span class="ident" id="7483009"><a href="/gostd/image/gif/reader_test.go.html#7482078">lzwEncode</a></span><span class="op" id="7483018">(</span><span class="ident" id="7483019"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483021">.</span><span class="ident" id="7483022"><a href="/gostd/image/gif/reader_test.go.html#7482278">nPix</a></span><span class="op" id="7483026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483031">if</span>&nbsp;<span class="builtinfunc" id="7483034">len</span><span class="op" id="7483037">(</span><span class="ident" id="7483038"><a href="/gostd/image/gif/reader_test.go.html#7483002">enc</a></span><span class="op" id="7483041">)</span>&nbsp;<span class="op" id="7483043">&gt;</span>&nbsp;<span class="num" id="7483045">0xff</span>&nbsp;<span class="op" id="7483050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483056"><a href="/gostd/image/gif/reader_test.go.html#7482235">t</a></span><span class="op" id="7483057">.</span><span class="ident" id="7483058"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7483064">(</span><span class="string" id="7483065">&#34;nPix=%d,&nbsp;extra=%t:&nbsp;compressed&nbsp;length&nbsp;%d&nbsp;is&nbsp;too&nbsp;large&#34;</span><span class="op" id="7483119">,</span>&nbsp;<span class="ident" id="7483121"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483123">.</span><span class="ident" id="7483124"><a href="/gostd/image/gif/reader_test.go.html#7482278">nPix</a></span><span class="op" id="7483128">,</span>&nbsp;<span class="ident" id="7483130"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483132">.</span><span class="ident" id="7483133"><a href="/gostd/image/gif/reader_test.go.html#7482336">extra</a></span><span class="op" id="7483138">,</span>&nbsp;<span class="builtinfunc" id="7483140">len</span><span class="op" id="7483143">(</span><span class="ident" id="7483144"><a href="/gostd/image/gif/reader_test.go.html#7483002">enc</a></span><span class="op" id="7483147">)</span><span class="op" id="7483148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483154">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483171"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7483172">.</span><span class="ident" id="7483173"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7483182">(</span><span class="builtintype" id="7483183">byte</span><span class="op" id="7483187">(</span><span class="builtinfunc" id="7483188">len</span><span class="op" id="7483191">(</span><span class="ident" id="7483192"><a href="/gostd/image/gif/reader_test.go.html#7483002">enc</a></span><span class="op" id="7483195">)</span><span class="op" id="7483196">)</span><span class="op" id="7483197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483202"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7483203">.</span><span class="ident" id="7483204"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="7483209">(</span><span class="ident" id="7483210"><a href="/gostd/image/gif/reader_test.go.html#7483002">enc</a></span><span class="op" id="7483213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483221">if</span>&nbsp;<span class="ident" id="7483224"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483226">.</span><span class="ident" id="7483227"><a href="/gostd/image/gif/reader_test.go.html#7482336">extra</a></span>&nbsp;<span class="op" id="7483233">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483238"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7483239">.</span><span class="ident" id="7483240"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7483251">(</span><span class="string" id="7483252">&#34;\x01\x02&#34;</span><span class="op" id="7483262">)</span>&nbsp;<span class="comment" id="7483264">//&nbsp;A&nbsp;1-byte&nbsp;payload&nbsp;with&nbsp;an&nbsp;0x02&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483309"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7483310">.</span><span class="ident" id="7483311"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7483320">(</span><span class="num" id="7483321">0x00</span><span class="op" id="7483325">)</span>&nbsp;<span class="comment" id="7483327">//&nbsp;An&nbsp;empty&nbsp;block&nbsp;signifies&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483384"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7483385">.</span><span class="ident" id="7483386"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7483397">(</span><span class="ident" id="7483398"><a href="/gostd/image/gif/reader_test.go.html#7481978">trailerStr</a></span><span class="op" id="7483408">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483413">got</span><span class="op" id="7483416">,</span>&nbsp;<span class="ident" id="7483418">err</span>&nbsp;<span class="op" id="7483422">:=</span>&nbsp;<span class="ident" id="7483425"><a href="/gostd/image/gif/reader.go.html#5724576">Decode</a></span><span class="op" id="7483431">(</span><span class="ident" id="7483432"><a href="/gostd/image/gif/reader_test.go.html#7482595">b</a></span><span class="op" id="7483433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483437">if</span>&nbsp;<span class="ident" id="7483440"><a href="/gostd/image/gif/reader_test.go.html#7483418">err</a></span>&nbsp;<span class="op" id="7483444">!=</span>&nbsp;<span class="ident" id="7483447"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483449">.</span><span class="ident" id="7483450"><a href="/gostd/image/gif/reader_test.go.html#7482414">wantErr</a></span>&nbsp;<span class="op" id="7483458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483463"><a href="/gostd/image/gif/reader_test.go.html#7482235">t</a></span><span class="op" id="7483464">.</span><span class="ident" id="7483465"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7483471">(</span><span class="string" id="7483472">&#34;nPix=%d,&nbsp;extra=%t\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7483509">,</span>&nbsp;<span class="ident" id="7483511"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483513">.</span><span class="ident" id="7483514"><a href="/gostd/image/gif/reader_test.go.html#7482278">nPix</a></span><span class="op" id="7483518">,</span>&nbsp;<span class="ident" id="7483520"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483522">.</span><span class="ident" id="7483523"><a href="/gostd/image/gif/reader_test.go.html#7482336">extra</a></span><span class="op" id="7483528">,</span>&nbsp;<span class="ident" id="7483530"><a href="/gostd/image/gif/reader_test.go.html#7483418">err</a></span><span class="op" id="7483533">,</span>&nbsp;<span class="ident" id="7483535"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483537">.</span><span class="ident" id="7483538"><a href="/gostd/image/gif/reader_test.go.html#7482414">wantErr</a></span><span class="op" id="7483545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483554">if</span>&nbsp;<span class="ident" id="7483557"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483559">.</span><span class="ident" id="7483560"><a href="/gostd/image/gif/reader_test.go.html#7482414">wantErr</a></span>&nbsp;<span class="op" id="7483568">!=</span>&nbsp;<span class="builtintype" id="7483571">nil</span>&nbsp;<span class="op" id="7483575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483580">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483595">want</span>&nbsp;<span class="op" id="7483600">:=</span>&nbsp;<span class="op" id="7483603">&amp;</span><span class="ident" id="7483604"><a href="/gostd/image/gif/reader_test.go.html#7481619">image</a></span><span class="op" id="7483609">.</span><span class="ident" id="7483610"><a href="/gostd/image/image.go.html#5176435">Paletted</a></span><span class="op" id="7483618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483623"><a href="/gostd/image/image.go.html#5176589">Pix</a></span><span class="op" id="7483626">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483631">[</span><span class="op" id="7483632">]</span><span class="builtintype" id="7483633">uint8</span><span class="op" id="7483638">{</span><span class="num" id="7483639">0</span><span class="op" id="7483640">,</span>&nbsp;<span class="num" id="7483642">0</span><span class="op" id="7483643">}</span><span class="op" id="7483644">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483649"><a href="/gostd/image/image.go.html#5176678">Stride</a></span><span class="op" id="7483655">:</span>&nbsp;<span class="num" id="7483657">2</span><span class="op" id="7483658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483663"><a href="/gostd/image/image.go.html#5176722">Rect</a></span><span class="op" id="7483667">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7483671"><a href="/gostd/image/gif/reader_test.go.html#7481619">image</a></span><span class="op" id="7483676">.</span><span class="ident" id="7483677"><a href="/gostd/image/geom.go.html#5153452">Rect</a></span><span class="op" id="7483681">(</span><span class="num" id="7483682">0</span><span class="op" id="7483683">,</span>&nbsp;<span class="num" id="7483685">0</span><span class="op" id="7483686">,</span>&nbsp;<span class="num" id="7483688">2</span><span class="op" id="7483689">,</span>&nbsp;<span class="num" id="7483691">1</span><span class="op" id="7483692">)</span><span class="op" id="7483693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483698"><a href="/gostd/image/image.go.html#5176774">Palette</a></span><span class="op" id="7483705">:</span>&nbsp;<span class="ident" id="7483707"><a href="/gostd/image/gif/reader_test.go.html#7481628">color</a></span><span class="op" id="7483712">.</span><span class="ident" id="7483713"><a href="/gostd/image/color/color.go.html#5190467">Palette</a></span><span class="op" id="7483720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483726"><a href="/gostd/image/gif/reader_test.go.html#7481628">color</a></span><span class="op" id="7483731">.</span><span class="ident" id="7483732"><a href="/gostd/image/color/color.go.html#5185612">RGBA</a></span><span class="op" id="7483736">{</span><span class="num" id="7483737">0x10</span><span class="op" id="7483741">,</span>&nbsp;<span class="num" id="7483743">0x20</span><span class="op" id="7483747">,</span>&nbsp;<span class="num" id="7483749">0x30</span><span class="op" id="7483753">,</span>&nbsp;<span class="num" id="7483755">0xff</span><span class="op" id="7483759">}</span><span class="op" id="7483760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483766"><a href="/gostd/image/gif/reader_test.go.html#7481628">color</a></span><span class="op" id="7483771">.</span><span class="ident" id="7483772"><a href="/gostd/image/color/color.go.html#5185612">RGBA</a></span><span class="op" id="7483776">{</span><span class="num" id="7483777">0x40</span><span class="op" id="7483781">,</span>&nbsp;<span class="num" id="7483783">0x50</span><span class="op" id="7483787">,</span>&nbsp;<span class="num" id="7483789">0x60</span><span class="op" id="7483793">,</span>&nbsp;<span class="num" id="7483795">0xff</span><span class="op" id="7483799">}</span><span class="op" id="7483800">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483805">}</span><span class="op" id="7483806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483814">if</span>&nbsp;<span class="op" id="7483817">!</span><span class="ident" id="7483818"><a href="/gostd/image/gif/reader_test.go.html#7481643">reflect</a></span><span class="op" id="7483825">.</span><span class="ident" id="7483826"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7483835">(</span><span class="ident" id="7483836"><a href="/gostd/image/gif/reader_test.go.html#7483413">got</a></span><span class="op" id="7483839">,</span>&nbsp;<span class="ident" id="7483841"><a href="/gostd/image/gif/reader_test.go.html#7483595">want</a></span><span class="op" id="7483845">)</span>&nbsp;<span class="op" id="7483847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483852"><a href="/gostd/image/gif/reader_test.go.html#7482235">t</a></span><span class="op" id="7483853">.</span><span class="ident" id="7483854"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7483860">(</span><span class="string" id="7483861">&#34;nPix=%d,&nbsp;extra=%t\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7483898">,</span>&nbsp;<span class="ident" id="7483900"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483902">.</span><span class="ident" id="7483903"><a href="/gostd/image/gif/reader_test.go.html#7482278">nPix</a></span><span class="op" id="7483907">,</span>&nbsp;<span class="ident" id="7483909"><a href="/gostd/image/gif/reader_test.go.html#7482569">tc</a></span><span class="op" id="7483911">.</span><span class="ident" id="7483912"><a href="/gostd/image/gif/reader_test.go.html#7482336">extra</a></span><span class="op" id="7483917">,</span>&nbsp;<span class="ident" id="7483919"><a href="/gostd/image/gif/reader_test.go.html#7483413">got</a></span><span class="op" id="7483922">,</span>&nbsp;<span class="ident" id="7483924"><a href="/gostd/image/gif/reader_test.go.html#7483595">want</a></span><span class="op" id="7483928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483932">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483935">}</span><br>
<span class="lineno"></span><span class="op" id="7483937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7483940">func</span>&nbsp;<span class="ident" id="7483945">TestTransparentIndex</span><span class="op" id="7483965">(</span><span class="ident" id="7483966">t</span>&nbsp;<span class="op" id="7483968">*</span><span class="ident" id="7483969"><a href="/gostd/image/gif/reader_test.go.html#7481654">testing</a></span><span class="op" id="7483976">.</span><span class="ident" id="7483977"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7483978">)</span>&nbsp;<span class="op" id="7483980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483983">b</span>&nbsp;<span class="op" id="7483985">:=</span>&nbsp;<span class="op" id="7483988">&amp;</span><span class="ident" id="7483989"><a href="/gostd/image/gif/reader_test.go.html#7481594">bytes</a></span><span class="op" id="7483994">.</span><span class="ident" id="7483995"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7484001">{</span><span class="op" id="7484002">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484005"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484006">.</span><span class="ident" id="7484007"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7484018">(</span><span class="ident" id="7484019"><a href="/gostd/image/gif/reader_test.go.html#7481743">headerStr</a></span><span class="op" id="7484028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484031"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484032">.</span><span class="ident" id="7484033"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7484044">(</span><span class="ident" id="7484045"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7484055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484058">for</span>&nbsp;<span class="ident" id="7484062">transparentIndex</span>&nbsp;<span class="op" id="7484079">:=</span>&nbsp;<span class="num" id="7484082">0</span><span class="op" id="7484083">;</span>&nbsp;<span class="ident" id="7484085"><a href="/gostd/image/gif/reader_test.go.html#7484062">transparentIndex</a></span>&nbsp;<span class="op" id="7484102">&lt;</span>&nbsp;<span class="num" id="7484104">3</span><span class="op" id="7484105">;</span>&nbsp;<span class="ident" id="7484107"><a href="/gostd/image/gif/reader_test.go.html#7484062">transparentIndex</a></span><span class="op" id="7484123">++</span>&nbsp;<span class="op" id="7484126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484130">if</span>&nbsp;<span class="ident" id="7484133"><a href="/gostd/image/gif/reader_test.go.html#7484062">transparentIndex</a></span>&nbsp;<span class="op" id="7484150">&lt;</span>&nbsp;<span class="num" id="7484152">2</span>&nbsp;<span class="op" id="7484154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7484159">//&nbsp;Write&nbsp;the&nbsp;graphic&nbsp;control&nbsp;for&nbsp;the&nbsp;transparent&nbsp;index.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484218"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484219">.</span><span class="ident" id="7484220"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7484231">(</span><span class="string" id="7484232">&#34;\x21\xf9\x00\x01\x00\x00&#34;</span><span class="op" id="7484258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484263"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484264">.</span><span class="ident" id="7484265"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7484274">(</span><span class="builtintype" id="7484275">byte</span><span class="op" id="7484279">(</span><span class="ident" id="7484280"><a href="/gostd/image/gif/reader_test.go.html#7484062">transparentIndex</a></span><span class="op" id="7484296">)</span><span class="op" id="7484297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484302"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484303">.</span><span class="ident" id="7484304"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7484313">(</span><span class="num" id="7484314">0</span><span class="op" id="7484315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7484323">//&nbsp;Write&nbsp;an&nbsp;image&nbsp;with&nbsp;bounds&nbsp;2x1,&nbsp;as&nbsp;per&nbsp;TestDecode.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484379"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484380">.</span><span class="ident" id="7484381"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7484392">(</span><span class="string" id="7484393">&#34;\x2c\x00\x00\x00\x00\x02\x00\x01\x00\x00\x02&#34;</span><span class="op" id="7484439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484443">enc</span>&nbsp;<span class="op" id="7484447">:=</span>&nbsp;<span class="ident" id="7484450"><a href="/gostd/image/gif/reader_test.go.html#7482078">lzwEncode</a></span><span class="op" id="7484459">(</span><span class="num" id="7484460">2</span><span class="op" id="7484461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484465">if</span>&nbsp;<span class="builtinfunc" id="7484468">len</span><span class="op" id="7484471">(</span><span class="ident" id="7484472"><a href="/gostd/image/gif/reader_test.go.html#7484443">enc</a></span><span class="op" id="7484475">)</span>&nbsp;<span class="op" id="7484477">&gt;</span>&nbsp;<span class="num" id="7484479">0xff</span>&nbsp;<span class="op" id="7484484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484489"><a href="/gostd/image/gif/reader_test.go.html#7483966">t</a></span><span class="op" id="7484490">.</span><span class="ident" id="7484491"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7484497">(</span><span class="string" id="7484498">&#34;compressed&nbsp;length&nbsp;%d&nbsp;is&nbsp;too&nbsp;large&#34;</span><span class="op" id="7484533">,</span>&nbsp;<span class="builtinfunc" id="7484535">len</span><span class="op" id="7484538">(</span><span class="ident" id="7484539"><a href="/gostd/image/gif/reader_test.go.html#7484443">enc</a></span><span class="op" id="7484542">)</span><span class="op" id="7484543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484547">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484551"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484552">.</span><span class="ident" id="7484553"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7484562">(</span><span class="builtintype" id="7484563">byte</span><span class="op" id="7484567">(</span><span class="builtinfunc" id="7484568">len</span><span class="op" id="7484571">(</span><span class="ident" id="7484572"><a href="/gostd/image/gif/reader_test.go.html#7484443">enc</a></span><span class="op" id="7484575">)</span><span class="op" id="7484576">)</span><span class="op" id="7484577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484581"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484582">.</span><span class="ident" id="7484583"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="7484588">(</span><span class="ident" id="7484589"><a href="/gostd/image/gif/reader_test.go.html#7484443">enc</a></span><span class="op" id="7484592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484596"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484597">.</span><span class="ident" id="7484598"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7484607">(</span><span class="num" id="7484608">0x00</span><span class="op" id="7484612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484618"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484619">.</span><span class="ident" id="7484620"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7484631">(</span><span class="ident" id="7484632"><a href="/gostd/image/gif/reader_test.go.html#7481978">trailerStr</a></span><span class="op" id="7484642">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484646">g</span><span class="op" id="7484647">,</span>&nbsp;<span class="ident" id="7484649">err</span>&nbsp;<span class="op" id="7484653">:=</span>&nbsp;<span class="ident" id="7484656"><a href="/gostd/image/gif/reader.go.html#5725121">DecodeAll</a></span><span class="op" id="7484665">(</span><span class="ident" id="7484666"><a href="/gostd/image/gif/reader_test.go.html#7483983">b</a></span><span class="op" id="7484667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484670">if</span>&nbsp;<span class="ident" id="7484673"><a href="/gostd/image/gif/reader_test.go.html#7484649">err</a></span>&nbsp;<span class="op" id="7484677">!=</span>&nbsp;<span class="builtintype" id="7484680">nil</span>&nbsp;<span class="op" id="7484684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484688"><a href="/gostd/image/gif/reader_test.go.html#7483966">t</a></span><span class="op" id="7484689">.</span><span class="ident" id="7484690"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7484696">(</span><span class="string" id="7484697">&#34;DecodeAll:&nbsp;%v&#34;</span><span class="op" id="7484712">,</span>&nbsp;<span class="ident" id="7484714"><a href="/gostd/image/gif/reader_test.go.html#7484649">err</a></span><span class="op" id="7484717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484720">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484723">c0</span>&nbsp;<span class="op" id="7484726">:=</span>&nbsp;<span class="ident" id="7484729"><a href="/gostd/image/gif/reader_test.go.html#7481628">color</a></span><span class="op" id="7484734">.</span><span class="ident" id="7484735"><a href="/gostd/image/color/color.go.html#5185612">RGBA</a></span><span class="op" id="7484739">{</span><span class="ident" id="7484740"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7484750">[</span><span class="num" id="7484751">0</span><span class="op" id="7484752">]</span><span class="op" id="7484753">,</span>&nbsp;<span class="ident" id="7484755"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7484765">[</span><span class="num" id="7484766">1</span><span class="op" id="7484767">]</span><span class="op" id="7484768">,</span>&nbsp;<span class="ident" id="7484770"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7484780">[</span><span class="num" id="7484781">2</span><span class="op" id="7484782">]</span><span class="op" id="7484783">,</span>&nbsp;<span class="num" id="7484785">0xff</span><span class="op" id="7484789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484792">c1</span>&nbsp;<span class="op" id="7484795">:=</span>&nbsp;<span class="ident" id="7484798"><a href="/gostd/image/gif/reader_test.go.html#7481628">color</a></span><span class="op" id="7484803">.</span><span class="ident" id="7484804"><a href="/gostd/image/color/color.go.html#5185612">RGBA</a></span><span class="op" id="7484808">{</span><span class="ident" id="7484809"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7484819">[</span><span class="num" id="7484820">3</span><span class="op" id="7484821">]</span><span class="op" id="7484822">,</span>&nbsp;<span class="ident" id="7484824"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7484834">[</span><span class="num" id="7484835">4</span><span class="op" id="7484836">]</span><span class="op" id="7484837">,</span>&nbsp;<span class="ident" id="7484839"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7484849">[</span><span class="num" id="7484850">5</span><span class="op" id="7484851">]</span><span class="op" id="7484852">,</span>&nbsp;<span class="num" id="7484854">0xff</span><span class="op" id="7484858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484861">cz</span>&nbsp;<span class="op" id="7484864">:=</span>&nbsp;<span class="ident" id="7484867"><a href="/gostd/image/gif/reader_test.go.html#7481628">color</a></span><span class="op" id="7484872">.</span><span class="ident" id="7484873"><a href="/gostd/image/color/color.go.html#5185612">RGBA</a></span><span class="op" id="7484877">{</span><span class="op" id="7484878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484881">wants</span>&nbsp;<span class="op" id="7484887">:=</span>&nbsp;<span class="op" id="7484890">[</span><span class="op" id="7484891">]</span><span class="ident" id="7484892"><a href="/gostd/image/gif/reader_test.go.html#7481628">color</a></span><span class="op" id="7484897">.</span><span class="ident" id="7484898"><a href="/gostd/image/color/color.go.html#5190467">Palette</a></span><span class="op" id="7484905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484909">{</span><span class="ident" id="7484910"><a href="/gostd/image/gif/reader_test.go.html#7484861">cz</a></span><span class="op" id="7484912">,</span>&nbsp;<span class="ident" id="7484914"><a href="/gostd/image/gif/reader_test.go.html#7484792">c1</a></span><span class="op" id="7484916">}</span><span class="op" id="7484917">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484921">{</span><span class="ident" id="7484922"><a href="/gostd/image/gif/reader_test.go.html#7484723">c0</a></span><span class="op" id="7484924">,</span>&nbsp;<span class="ident" id="7484926"><a href="/gostd/image/gif/reader_test.go.html#7484861">cz</a></span><span class="op" id="7484928">}</span><span class="op" id="7484929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484933">{</span><span class="ident" id="7484934"><a href="/gostd/image/gif/reader_test.go.html#7484723">c0</a></span><span class="op" id="7484936">,</span>&nbsp;<span class="ident" id="7484938"><a href="/gostd/image/gif/reader_test.go.html#7484792">c1</a></span><span class="op" id="7484940">}</span><span class="op" id="7484941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484947">if</span>&nbsp;<span class="builtinfunc" id="7484950">len</span><span class="op" id="7484953">(</span><span class="ident" id="7484954"><a href="/gostd/image/gif/reader_test.go.html#7484646">g</a></span><span class="op" id="7484955">.</span><span class="ident" id="7484956"><a href="/gostd/image/gif/reader.go.html#5724814">Image</a></span><span class="op" id="7484961">)</span>&nbsp;<span class="op" id="7484963">!=</span>&nbsp;<span class="builtinfunc" id="7484966">len</span><span class="op" id="7484969">(</span><span class="ident" id="7484970"><a href="/gostd/image/gif/reader_test.go.html#7484881">wants</a></span><span class="op" id="7484975">)</span>&nbsp;<span class="op" id="7484977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484981"><a href="/gostd/image/gif/reader_test.go.html#7483966">t</a></span><span class="op" id="7484982">.</span><span class="ident" id="7484983"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7484989">(</span><span class="string" id="7484990">&#34;got&nbsp;%d&nbsp;images,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7485014">,</span>&nbsp;<span class="builtinfunc" id="7485016">len</span><span class="op" id="7485019">(</span><span class="ident" id="7485020"><a href="/gostd/image/gif/reader_test.go.html#7484646">g</a></span><span class="op" id="7485021">.</span><span class="ident" id="7485022"><a href="/gostd/image/gif/reader.go.html#5724814">Image</a></span><span class="op" id="7485027">)</span><span class="op" id="7485028">,</span>&nbsp;<span class="builtinfunc" id="7485030">len</span><span class="op" id="7485033">(</span><span class="ident" id="7485034"><a href="/gostd/image/gif/reader_test.go.html#7484881">wants</a></span><span class="op" id="7485039">)</span><span class="op" id="7485040">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485046">for</span>&nbsp;<span class="ident" id="7485050">i</span><span class="op" id="7485051">,</span>&nbsp;<span class="ident" id="7485053">want</span>&nbsp;<span class="op" id="7485058">:=</span>&nbsp;<span class="keyword" id="7485061">range</span>&nbsp;<span class="ident" id="7485067"><a href="/gostd/image/gif/reader_test.go.html#7484881">wants</a></span>&nbsp;<span class="op" id="7485073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485077">got</span>&nbsp;<span class="op" id="7485081">:=</span>&nbsp;<span class="ident" id="7485084"><a href="/gostd/image/gif/reader_test.go.html#7484646">g</a></span><span class="op" id="7485085">.</span><span class="ident" id="7485086"><a href="/gostd/image/gif/reader.go.html#5724814">Image</a></span><span class="op" id="7485091">[</span><span class="ident" id="7485092"><a href="/gostd/image/gif/reader_test.go.html#7485050">i</a></span><span class="op" id="7485093">]</span><span class="op" id="7485094">.</span><span class="ident" id="7485095"><a href="/gostd/image/image.go.html#5176774">Palette</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485105">if</span>&nbsp;<span class="op" id="7485108">!</span><span class="ident" id="7485109"><a href="/gostd/image/gif/reader_test.go.html#7481643">reflect</a></span><span class="op" id="7485116">.</span><span class="ident" id="7485117"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="7485126">(</span><span class="ident" id="7485127"><a href="/gostd/image/gif/reader_test.go.html#7485077">got</a></span><span class="op" id="7485130">,</span>&nbsp;<span class="ident" id="7485132"><a href="/gostd/image/gif/reader_test.go.html#7485053">want</a></span><span class="op" id="7485136">)</span>&nbsp;<span class="op" id="7485138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485143"><a href="/gostd/image/gif/reader_test.go.html#7483966">t</a></span><span class="op" id="7485144">.</span><span class="ident" id="7485145"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7485151">(</span><span class="string" id="7485152">&#34;palette&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7485184">,</span>&nbsp;<span class="ident" id="7485186"><a href="/gostd/image/gif/reader_test.go.html#7485050">i</a></span><span class="op" id="7485187">,</span>&nbsp;<span class="ident" id="7485189"><a href="/gostd/image/gif/reader_test.go.html#7485077">got</a></span><span class="op" id="7485192">,</span>&nbsp;<span class="ident" id="7485194"><a href="/gostd/image/gif/reader_test.go.html#7485053">want</a></span><span class="op" id="7485198">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485205">}</span><br>
<span class="lineno"></span><span class="op" id="7485207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7485210">//&nbsp;testGIF&nbsp;is&nbsp;a&nbsp;simple&nbsp;GIF&nbsp;that&nbsp;we&nbsp;can&nbsp;modify&nbsp;to&nbsp;test&nbsp;different&nbsp;scenarios.</span><br>
<span class="lineno">140</span><span class="keyword" id="7485285">var</span>&nbsp;<span class="ident" id="7485289">testGIF</span>&nbsp;<span class="op" id="7485297">=</span>&nbsp;<span class="op" id="7485299">[</span><span class="op" id="7485300">]</span><span class="builtintype" id="7485301">byte</span><span class="op" id="7485305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7485308">&#39;G&#39;</span><span class="op" id="7485311">,</span>&nbsp;<span class="string" id="7485313">&#39;I&#39;</span><span class="op" id="7485316">,</span>&nbsp;<span class="string" id="7485318">&#39;F&#39;</span><span class="op" id="7485321">,</span>&nbsp;<span class="string" id="7485323">&#39;8&#39;</span><span class="op" id="7485326">,</span>&nbsp;<span class="string" id="7485328">&#39;9&#39;</span><span class="op" id="7485331">,</span>&nbsp;<span class="string" id="7485333">&#39;a&#39;</span><span class="op" id="7485336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485339">1</span><span class="op" id="7485340">,</span>&nbsp;<span class="num" id="7485342">0</span><span class="op" id="7485343">,</span>&nbsp;<span class="num" id="7485345">1</span><span class="op" id="7485346">,</span>&nbsp;<span class="num" id="7485348">0</span><span class="op" id="7485349">,</span>&nbsp;<span class="comment" id="7485351">//&nbsp;w=1,&nbsp;h=1&nbsp;(6)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485368">128</span><span class="op" id="7485371">,</span>&nbsp;<span class="num" id="7485373">0</span><span class="op" id="7485374">,</span>&nbsp;<span class="num" id="7485376">0</span><span class="op" id="7485377">,</span>&nbsp;<span class="comment" id="7485379">//&nbsp;headerFields,&nbsp;bg,&nbsp;aspect&nbsp;(10)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485413">0</span><span class="op" id="7485414">,</span>&nbsp;<span class="num" id="7485416">0</span><span class="op" id="7485417">,</span>&nbsp;<span class="num" id="7485419">0</span><span class="op" id="7485420">,</span>&nbsp;<span class="num" id="7485422">1</span><span class="op" id="7485423">,</span>&nbsp;<span class="num" id="7485425">1</span><span class="op" id="7485426">,</span>&nbsp;<span class="num" id="7485428">1</span><span class="op" id="7485429">,</span>&nbsp;<span class="comment" id="7485431">//&nbsp;color&nbsp;map&nbsp;and&nbsp;graphics&nbsp;control&nbsp;(13)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485471">0x21</span><span class="op" id="7485475">,</span>&nbsp;<span class="num" id="7485477">0xf9</span><span class="op" id="7485481">,</span>&nbsp;<span class="num" id="7485483">0x04</span><span class="op" id="7485487">,</span>&nbsp;<span class="num" id="7485489">0x00</span><span class="op" id="7485493">,</span>&nbsp;<span class="num" id="7485495">0x00</span><span class="op" id="7485499">,</span>&nbsp;<span class="num" id="7485501">0x00</span><span class="op" id="7485505">,</span>&nbsp;<span class="num" id="7485507">0xff</span><span class="op" id="7485511">,</span>&nbsp;<span class="num" id="7485513">0x00</span><span class="op" id="7485517">,</span>&nbsp;<span class="comment" id="7485519">//&nbsp;(19)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7485528">//&nbsp;frame&nbsp;1&nbsp;(0,0&nbsp;-&nbsp;1,1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485552">0x2c</span><span class="op" id="7485556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485559">0x00</span><span class="op" id="7485563">,</span>&nbsp;<span class="num" id="7485565">0x00</span><span class="op" id="7485569">,</span>&nbsp;<span class="num" id="7485571">0x00</span><span class="op" id="7485575">,</span>&nbsp;<span class="num" id="7485577">0x00</span><span class="op" id="7485581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485584">0x01</span><span class="op" id="7485588">,</span>&nbsp;<span class="num" id="7485590">0x00</span><span class="op" id="7485594">,</span>&nbsp;<span class="num" id="7485596">0x01</span><span class="op" id="7485600">,</span>&nbsp;<span class="num" id="7485602">0x00</span><span class="op" id="7485606">,</span>&nbsp;<span class="comment" id="7485608">//&nbsp;(32)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485617">0x00</span><span class="op" id="7485621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485624">0x02</span><span class="op" id="7485628">,</span>&nbsp;<span class="num" id="7485630">0x02</span><span class="op" id="7485634">,</span>&nbsp;<span class="num" id="7485636">0x4c</span><span class="op" id="7485640">,</span>&nbsp;<span class="num" id="7485642">0x01</span><span class="op" id="7485646">,</span>&nbsp;<span class="num" id="7485648">0x00</span><span class="op" id="7485652">,</span>&nbsp;<span class="comment" id="7485654">//&nbsp;lzw&nbsp;pixels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7485669">//&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7485681">0x3b</span><span class="op" id="7485685">,</span><br>
<span class="lineno"></span><span class="op" id="7485687">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="7485690">func</span>&nbsp;<span class="ident" id="7485695">try</span><span class="op" id="7485698">(</span><span class="ident" id="7485699">t</span>&nbsp;<span class="op" id="7485701">*</span><span class="ident" id="7485702"><a href="/gostd/image/gif/reader_test.go.html#7481654">testing</a></span><span class="op" id="7485709">.</span><span class="ident" id="7485710"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7485711">,</span>&nbsp;<span class="ident" id="7485713">b</span>&nbsp;<span class="op" id="7485715">[</span><span class="op" id="7485716">]</span><span class="builtintype" id="7485717">byte</span><span class="op" id="7485721">,</span>&nbsp;<span class="ident" id="7485723">want</span>&nbsp;<span class="builtintype" id="7485728">string</span><span class="op" id="7485734">)</span>&nbsp;<span class="op" id="7485736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485739">_</span><span class="op" id="7485740">,</span>&nbsp;<span class="ident" id="7485742">err</span>&nbsp;<span class="op" id="7485746">:=</span>&nbsp;<span class="ident" id="7485749"><a href="/gostd/image/gif/reader.go.html#5725121">DecodeAll</a></span><span class="op" id="7485758">(</span><span class="ident" id="7485759"><a href="/gostd/image/gif/reader_test.go.html#7481594">bytes</a></span><span class="op" id="7485764">.</span><span class="ident" id="7485765"><a href="/gostd/bytes/reader.go.html#1418136">NewReader</a></span><span class="op" id="7485774">(</span><span class="ident" id="7485775"><a href="/gostd/image/gif/reader_test.go.html#7485713">b</a></span><span class="op" id="7485776">)</span><span class="op" id="7485777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485780">var</span>&nbsp;<span class="ident" id="7485784">got</span>&nbsp;<span class="builtintype" id="7485788">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485796">if</span>&nbsp;<span class="ident" id="7485799"><a href="/gostd/image/gif/reader_test.go.html#7485742">err</a></span>&nbsp;<span class="op" id="7485803">!=</span>&nbsp;<span class="builtintype" id="7485806">nil</span>&nbsp;<span class="op" id="7485810">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485814"><a href="/gostd/image/gif/reader_test.go.html#7485784">got</a></span>&nbsp;<span class="op" id="7485818">=</span>&nbsp;<span class="ident" id="7485820"><a href="/gostd/image/gif/reader_test.go.html#7485742">err</a></span><span class="op" id="7485823">.</span><span class="ident" id="7485824">Error</span><span class="op" id="7485829">(</span><span class="op" id="7485830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485836">if</span>&nbsp;<span class="ident" id="7485839"><a href="/gostd/image/gif/reader_test.go.html#7485784">got</a></span>&nbsp;<span class="op" id="7485843">!=</span>&nbsp;<span class="ident" id="7485846"><a href="/gostd/image/gif/reader_test.go.html#7485723">want</a></span>&nbsp;<span class="op" id="7485851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485855"><a href="/gostd/image/gif/reader_test.go.html#7485699">t</a></span><span class="op" id="7485856">.</span><span class="ident" id="7485857"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7485863">(</span><span class="string" id="7485864">&#34;got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7485881">,</span>&nbsp;<span class="ident" id="7485883"><a href="/gostd/image/gif/reader_test.go.html#7485784">got</a></span><span class="op" id="7485886">,</span>&nbsp;<span class="ident" id="7485888"><a href="/gostd/image/gif/reader_test.go.html#7485723">want</a></span><span class="op" id="7485892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485895">}</span><br>
<span class="lineno">165</span><span class="op" id="7485897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7485900">func</span>&nbsp;<span class="ident" id="7485905">TestBounds</span><span class="op" id="7485915">(</span><span class="ident" id="7485916">t</span>&nbsp;<span class="op" id="7485918">*</span><span class="ident" id="7485919"><a href="/gostd/image/gif/reader_test.go.html#7481654">testing</a></span><span class="op" id="7485926">.</span><span class="ident" id="7485927"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7485928">)</span>&nbsp;<span class="op" id="7485930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7485933">//&nbsp;Make&nbsp;a&nbsp;local&nbsp;copy&nbsp;of&nbsp;testGIF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485967">gif</span>&nbsp;<span class="op" id="7485971">:=</span>&nbsp;<span class="builtinfunc" id="7485974">make</span><span class="op" id="7485978">(</span><span class="op" id="7485979">[</span><span class="op" id="7485980">]</span><span class="builtintype" id="7485981">byte</span><span class="op" id="7485985">,</span>&nbsp;<span class="builtinfunc" id="7485987">len</span><span class="op" id="7485990">(</span><span class="ident" id="7485991"><a href="/gostd/image/gif/reader_test.go.html#7485289">testGIF</a></span><span class="op" id="7485998">)</span><span class="op" id="7485999">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7486002">copy</span><span class="op" id="7486006">(</span><span class="ident" id="7486007"><a href="/gostd/image/gif/reader_test.go.html#7485967">gif</a></span><span class="op" id="7486010">,</span>&nbsp;<span class="ident" id="7486012"><a href="/gostd/image/gif/reader_test.go.html#7485289">testGIF</a></span><span class="op" id="7486019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7486022">//&nbsp;Make&nbsp;the&nbsp;bounds&nbsp;too&nbsp;big,&nbsp;just&nbsp;by&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486064"><a href="/gostd/image/gif/reader_test.go.html#7485967">gif</a></span><span class="op" id="7486067">[</span><span class="num" id="7486068">32</span><span class="op" id="7486070">]</span>&nbsp;<span class="op" id="7486072">=</span>&nbsp;<span class="num" id="7486074">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486077">want</span>&nbsp;<span class="op" id="7486082">:=</span>&nbsp;<span class="string" id="7486085">&#34;gif:&nbsp;frame&nbsp;bounds&nbsp;larger&nbsp;than&nbsp;image&nbsp;bounds&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486131"><a href="/gostd/image/gif/reader_test.go.html#7485695">try</a></span><span class="op" id="7486134">(</span><span class="ident" id="7486135"><a href="/gostd/image/gif/reader_test.go.html#7485916">t</a></span><span class="op" id="7486136">,</span>&nbsp;<span class="ident" id="7486138"><a href="/gostd/image/gif/reader_test.go.html#7485967">gif</a></span><span class="op" id="7486141">,</span>&nbsp;<span class="ident" id="7486143"><a href="/gostd/image/gif/reader_test.go.html#7486077">want</a></span><span class="op" id="7486147">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7486151">//&nbsp;Make&nbsp;the&nbsp;bounds&nbsp;too&nbsp;small;&nbsp;does&nbsp;not&nbsp;trigger&nbsp;bounds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7486206">//&nbsp;check,&nbsp;but&nbsp;now&nbsp;there&#39;s&nbsp;too&nbsp;much&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486248"><a href="/gostd/image/gif/reader_test.go.html#7485967">gif</a></span><span class="op" id="7486251">[</span><span class="num" id="7486252">32</span><span class="op" id="7486254">]</span>&nbsp;<span class="op" id="7486256">=</span>&nbsp;<span class="num" id="7486258">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486261"><a href="/gostd/image/gif/reader_test.go.html#7486077">want</a></span>&nbsp;<span class="op" id="7486266">=</span>&nbsp;<span class="string" id="7486268">&#34;gif:&nbsp;too&nbsp;much&nbsp;image&nbsp;data&#34;</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486296"><a href="/gostd/image/gif/reader_test.go.html#7485695">try</a></span><span class="op" id="7486299">(</span><span class="ident" id="7486300"><a href="/gostd/image/gif/reader_test.go.html#7485916">t</a></span><span class="op" id="7486301">,</span>&nbsp;<span class="ident" id="7486303"><a href="/gostd/image/gif/reader_test.go.html#7485967">gif</a></span><span class="op" id="7486306">,</span>&nbsp;<span class="ident" id="7486308"><a href="/gostd/image/gif/reader_test.go.html#7486077">want</a></span><span class="op" id="7486312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486315"><a href="/gostd/image/gif/reader_test.go.html#7485967">gif</a></span><span class="op" id="7486318">[</span><span class="num" id="7486319">32</span><span class="op" id="7486321">]</span>&nbsp;<span class="op" id="7486323">=</span>&nbsp;<span class="num" id="7486325">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7486329">//&nbsp;Make&nbsp;the&nbsp;bounds&nbsp;really&nbsp;big,&nbsp;expect&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486378"><a href="/gostd/image/gif/reader_test.go.html#7486077">want</a></span>&nbsp;<span class="op" id="7486383">=</span>&nbsp;<span class="string" id="7486385">&#34;gif:&nbsp;frame&nbsp;bounds&nbsp;larger&nbsp;than&nbsp;image&nbsp;bounds&#34;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7486431">for</span>&nbsp;<span class="ident" id="7486435">i</span>&nbsp;<span class="op" id="7486437">:=</span>&nbsp;<span class="num" id="7486440">0</span><span class="op" id="7486441">;</span>&nbsp;<span class="ident" id="7486443"><a href="/gostd/image/gif/reader_test.go.html#7486435">i</a></span>&nbsp;<span class="op" id="7486445">&lt;</span>&nbsp;<span class="num" id="7486447">4</span><span class="op" id="7486448">;</span>&nbsp;<span class="ident" id="7486450"><a href="/gostd/image/gif/reader_test.go.html#7486435">i</a></span><span class="op" id="7486451">++</span>&nbsp;<span class="op" id="7486454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486458"><a href="/gostd/image/gif/reader_test.go.html#7485967">gif</a></span><span class="op" id="7486461">[</span><span class="num" id="7486462">32</span><span class="op" id="7486464">+</span><span class="ident" id="7486465"><a href="/gostd/image/gif/reader_test.go.html#7486435">i</a></span><span class="op" id="7486466">]</span>&nbsp;<span class="op" id="7486468">=</span>&nbsp;<span class="num" id="7486470">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7486476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486479"><a href="/gostd/image/gif/reader_test.go.html#7485695">try</a></span><span class="op" id="7486482">(</span><span class="ident" id="7486483"><a href="/gostd/image/gif/reader_test.go.html#7485916">t</a></span><span class="op" id="7486484">,</span>&nbsp;<span class="ident" id="7486486"><a href="/gostd/image/gif/reader_test.go.html#7485967">gif</a></span><span class="op" id="7486489">,</span>&nbsp;<span class="ident" id="7486491"><a href="/gostd/image/gif/reader_test.go.html#7486077">want</a></span><span class="op" id="7486495">)</span><br>
<span class="lineno"></span><span class="op" id="7486497">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="keyword" id="7486500">func</span>&nbsp;<span class="ident" id="7486505">TestNoPalette</span><span class="op" id="7486518">(</span><span class="ident" id="7486519">t</span>&nbsp;<span class="op" id="7486521">*</span><span class="ident" id="7486522"><a href="/gostd/image/gif/reader_test.go.html#7481654">testing</a></span><span class="op" id="7486529">.</span><span class="ident" id="7486530"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7486531">)</span>&nbsp;<span class="op" id="7486533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486536">b</span>&nbsp;<span class="op" id="7486538">:=</span>&nbsp;<span class="op" id="7486541">&amp;</span><span class="ident" id="7486542"><a href="/gostd/image/gif/reader_test.go.html#7481594">bytes</a></span><span class="op" id="7486547">.</span><span class="ident" id="7486548"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7486554">{</span><span class="op" id="7486555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7486559">//&nbsp;Manufacture&nbsp;a&nbsp;GIF&nbsp;with&nbsp;no&nbsp;palette,&nbsp;so&nbsp;any&nbsp;pixel&nbsp;at&nbsp;all</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7486618">//&nbsp;will&nbsp;be&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486639"><a href="/gostd/image/gif/reader_test.go.html#7486536">b</a></span><span class="op" id="7486640">.</span><span class="ident" id="7486641"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7486652">(</span><span class="ident" id="7486653"><a href="/gostd/image/gif/reader_test.go.html#7481743">headerStr</a></span><span class="op" id="7486662">[</span><span class="op" id="7486663">:</span><span class="builtinfunc" id="7486664">len</span><span class="op" id="7486667">(</span><span class="ident" id="7486668"><a href="/gostd/image/gif/reader_test.go.html#7481743">headerStr</a></span><span class="op" id="7486677">)</span><span class="op" id="7486678">-</span><span class="num" id="7486679">3</span><span class="op" id="7486680">]</span><span class="op" id="7486681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486684"><a href="/gostd/image/gif/reader_test.go.html#7486536">b</a></span><span class="op" id="7486685">.</span><span class="ident" id="7486686"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7486697">(</span><span class="string" id="7486698">&#34;\x00\x00\x00&#34;</span><span class="op" id="7486712">)</span>&nbsp;<span class="comment" id="7486714">//&nbsp;No&nbsp;global&nbsp;palette.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7486738">//&nbsp;Image&nbsp;descriptor:&nbsp;2x1,&nbsp;no&nbsp;local&nbsp;palette.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486783"><a href="/gostd/image/gif/reader_test.go.html#7486536">b</a></span><span class="op" id="7486784">.</span><span class="ident" id="7486785"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7486796">(</span><span class="string" id="7486797">&#34;\x2c\x00\x00\x00\x00\x02\x00\x01\x00\x00\x02&#34;</span><span class="op" id="7486843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7486847">//&nbsp;Encode&nbsp;the&nbsp;pixels:&nbsp;neither&nbsp;is&nbsp;in&nbsp;range,&nbsp;because&nbsp;there&nbsp;is&nbsp;no&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486920">pix</span>&nbsp;<span class="op" id="7486924">:=</span>&nbsp;<span class="op" id="7486927">[</span><span class="op" id="7486928">]</span><span class="builtintype" id="7486929">byte</span><span class="op" id="7486933">{</span><span class="num" id="7486934">0</span><span class="op" id="7486935">,</span>&nbsp;<span class="num" id="7486937">128</span><span class="op" id="7486940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486943">enc</span>&nbsp;<span class="op" id="7486947">:=</span>&nbsp;<span class="op" id="7486950">&amp;</span><span class="ident" id="7486951"><a href="/gostd/image/gif/reader_test.go.html#7481594">bytes</a></span><span class="op" id="7486956">.</span><span class="ident" id="7486957"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7486963">{</span><span class="op" id="7486964">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7486967">w</span>&nbsp;<span class="op" id="7486969">:=</span>&nbsp;<span class="ident" id="7486972"><a href="/gostd/image/gif/reader_test.go.html#7481603">lzw</a></span><span class="op" id="7486975">.</span><span class="ident" id="7486976"><a href="/gostd/compress/lzw/writer.go.html#5746657">NewWriter</a></span><span class="op" id="7486985">(</span><span class="ident" id="7486986"><a href="/gostd/image/gif/reader_test.go.html#7486943">enc</a></span><span class="op" id="7486989">,</span>&nbsp;<span class="ident" id="7486991"><a href="/gostd/image/gif/reader_test.go.html#7481603">lzw</a></span><span class="op" id="7486994">.</span><span class="ident" id="7486995"><a href="/gostd/compress/lzw/reader.go.html#5734384">LSB</a></span><span class="op" id="7486998">,</span>&nbsp;<span class="num" id="7487000">2</span><span class="op" id="7487001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487004"><a href="/gostd/image/gif/reader_test.go.html#7486967">w</a></span><span class="op" id="7487005">.</span><span class="ident" id="7487006"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7487011">(</span><span class="ident" id="7487012"><a href="/gostd/image/gif/reader_test.go.html#7486920">pix</a></span><span class="op" id="7487015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487018"><a href="/gostd/image/gif/reader_test.go.html#7486967">w</a></span><span class="op" id="7487019">.</span><span class="ident" id="7487020"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="7487025">(</span><span class="op" id="7487026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487029"><a href="/gostd/image/gif/reader_test.go.html#7486536">b</a></span><span class="op" id="7487030">.</span><span class="ident" id="7487031"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7487040">(</span><span class="builtintype" id="7487041">byte</span><span class="op" id="7487045">(</span><span class="builtinfunc" id="7487046">len</span><span class="op" id="7487049">(</span><span class="ident" id="7487050"><a href="/gostd/image/gif/reader_test.go.html#7486943">enc</a></span><span class="op" id="7487053">.</span><span class="ident" id="7487054"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7487059">(</span><span class="op" id="7487060">)</span><span class="op" id="7487061">)</span><span class="op" id="7487062">)</span><span class="op" id="7487063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487066"><a href="/gostd/image/gif/reader_test.go.html#7486536">b</a></span><span class="op" id="7487067">.</span><span class="ident" id="7487068"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="7487073">(</span><span class="ident" id="7487074"><a href="/gostd/image/gif/reader_test.go.html#7486943">enc</a></span><span class="op" id="7487077">.</span><span class="ident" id="7487078"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7487083">(</span><span class="op" id="7487084">)</span><span class="op" id="7487085">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487088"><a href="/gostd/image/gif/reader_test.go.html#7486536">b</a></span><span class="op" id="7487089">.</span><span class="ident" id="7487090"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7487099">(</span><span class="num" id="7487100">0x00</span><span class="op" id="7487104">)</span>&nbsp;<span class="comment" id="7487106">//&nbsp;An&nbsp;empty&nbsp;block&nbsp;signifies&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487163"><a href="/gostd/image/gif/reader_test.go.html#7486536">b</a></span><span class="op" id="7487164">.</span><span class="ident" id="7487165"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7487176">(</span><span class="ident" id="7487177"><a href="/gostd/image/gif/reader_test.go.html#7481978">trailerStr</a></span><span class="op" id="7487187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487191"><a href="/gostd/image/gif/reader_test.go.html#7485695">try</a></span><span class="op" id="7487194">(</span><span class="ident" id="7487195"><a href="/gostd/image/gif/reader_test.go.html#7486519">t</a></span><span class="op" id="7487196">,</span>&nbsp;<span class="ident" id="7487198"><a href="/gostd/image/gif/reader_test.go.html#7486536">b</a></span><span class="op" id="7487199">.</span><span class="ident" id="7487200"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7487205">(</span><span class="op" id="7487206">)</span><span class="op" id="7487207">,</span>&nbsp;<span class="string" id="7487209">&#34;gif:&nbsp;invalid&nbsp;pixel&nbsp;value&#34;</span><span class="op" id="7487235">)</span><br>
<span class="lineno">215</span><span class="op" id="7487237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7487240">func</span>&nbsp;<span class="ident" id="7487245">TestPixelOutsidePaletteRange</span><span class="op" id="7487273">(</span><span class="ident" id="7487274">t</span>&nbsp;<span class="op" id="7487276">*</span><span class="ident" id="7487277"><a href="/gostd/image/gif/reader_test.go.html#7481654">testing</a></span><span class="op" id="7487284">.</span><span class="ident" id="7487285"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7487286">)</span>&nbsp;<span class="op" id="7487288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7487291">for</span>&nbsp;<span class="ident" id="7487295">_</span><span class="op" id="7487296">,</span>&nbsp;<span class="ident" id="7487298">pval</span>&nbsp;<span class="op" id="7487303">:=</span>&nbsp;<span class="keyword" id="7487306">range</span>&nbsp;<span class="op" id="7487312">[</span><span class="op" id="7487313">]</span><span class="builtintype" id="7487314">byte</span><span class="op" id="7487318">{</span><span class="num" id="7487319">0</span><span class="op" id="7487320">,</span>&nbsp;<span class="num" id="7487322">1</span><span class="op" id="7487323">,</span>&nbsp;<span class="num" id="7487325">2</span><span class="op" id="7487326">,</span>&nbsp;<span class="num" id="7487328">3</span><span class="op" id="7487329">,</span>&nbsp;<span class="num" id="7487331">255</span><span class="op" id="7487334">}</span>&nbsp;<span class="op" id="7487336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487340">b</span>&nbsp;<span class="op" id="7487342">:=</span>&nbsp;<span class="op" id="7487345">&amp;</span><span class="ident" id="7487346"><a href="/gostd/image/gif/reader_test.go.html#7481594">bytes</a></span><span class="op" id="7487351">.</span><span class="ident" id="7487352"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7487358">{</span><span class="op" id="7487359">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7487364">//&nbsp;Manufacture&nbsp;a&nbsp;GIF&nbsp;with&nbsp;a&nbsp;2&nbsp;color&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487411"><a href="/gostd/image/gif/reader_test.go.html#7487340">b</a></span><span class="op" id="7487412">.</span><span class="ident" id="7487413"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7487424">(</span><span class="ident" id="7487425"><a href="/gostd/image/gif/reader_test.go.html#7481743">headerStr</a></span><span class="op" id="7487434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487438"><a href="/gostd/image/gif/reader_test.go.html#7487340">b</a></span><span class="op" id="7487439">.</span><span class="ident" id="7487440"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7487451">(</span><span class="ident" id="7487452"><a href="/gostd/image/gif/reader_test.go.html#7481895">paletteStr</a></span><span class="op" id="7487462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7487467">//&nbsp;Image&nbsp;descriptor:&nbsp;2x1,&nbsp;no&nbsp;local&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487513"><a href="/gostd/image/gif/reader_test.go.html#7487340">b</a></span><span class="op" id="7487514">.</span><span class="ident" id="7487515"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7487526">(</span><span class="string" id="7487527">&#34;\x2c\x00\x00\x00\x00\x02\x00\x01\x00\x00\x02&#34;</span><span class="op" id="7487573">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7487578">//&nbsp;Encode&nbsp;the&nbsp;pixels;&nbsp;some&nbsp;pvals&nbsp;trigger&nbsp;the&nbsp;expected&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487641">pix</span>&nbsp;<span class="op" id="7487645">:=</span>&nbsp;<span class="op" id="7487648">[</span><span class="op" id="7487649">]</span><span class="builtintype" id="7487650">byte</span><span class="op" id="7487654">{</span><span class="ident" id="7487655"><a href="/gostd/image/gif/reader_test.go.html#7487298">pval</a></span><span class="op" id="7487659">,</span>&nbsp;<span class="ident" id="7487661"><a href="/gostd/image/gif/reader_test.go.html#7487298">pval</a></span><span class="op" id="7487665">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487669">enc</span>&nbsp;<span class="op" id="7487673">:=</span>&nbsp;<span class="op" id="7487676">&amp;</span><span class="ident" id="7487677"><a href="/gostd/image/gif/reader_test.go.html#7481594">bytes</a></span><span class="op" id="7487682">.</span><span class="ident" id="7487683"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7487689">{</span><span class="op" id="7487690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487694">w</span>&nbsp;<span class="op" id="7487696">:=</span>&nbsp;<span class="ident" id="7487699"><a href="/gostd/image/gif/reader_test.go.html#7481603">lzw</a></span><span class="op" id="7487702">.</span><span class="ident" id="7487703"><a href="/gostd/compress/lzw/writer.go.html#5746657">NewWriter</a></span><span class="op" id="7487712">(</span><span class="ident" id="7487713"><a href="/gostd/image/gif/reader_test.go.html#7487669">enc</a></span><span class="op" id="7487716">,</span>&nbsp;<span class="ident" id="7487718"><a href="/gostd/image/gif/reader_test.go.html#7481603">lzw</a></span><span class="op" id="7487721">.</span><span class="ident" id="7487722"><a href="/gostd/compress/lzw/reader.go.html#5734384">LSB</a></span><span class="op" id="7487725">,</span>&nbsp;<span class="num" id="7487727">2</span><span class="op" id="7487728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487732"><a href="/gostd/image/gif/reader_test.go.html#7487694">w</a></span><span class="op" id="7487733">.</span><span class="ident" id="7487734"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7487739">(</span><span class="ident" id="7487740"><a href="/gostd/image/gif/reader_test.go.html#7487641">pix</a></span><span class="op" id="7487743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487747"><a href="/gostd/image/gif/reader_test.go.html#7487694">w</a></span><span class="op" id="7487748">.</span><span class="ident" id="7487749"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="7487754">(</span><span class="op" id="7487755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487759"><a href="/gostd/image/gif/reader_test.go.html#7487340">b</a></span><span class="op" id="7487760">.</span><span class="ident" id="7487761"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7487770">(</span><span class="builtintype" id="7487771">byte</span><span class="op" id="7487775">(</span><span class="builtinfunc" id="7487776">len</span><span class="op" id="7487779">(</span><span class="ident" id="7487780"><a href="/gostd/image/gif/reader_test.go.html#7487669">enc</a></span><span class="op" id="7487783">.</span><span class="ident" id="7487784"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7487789">(</span><span class="op" id="7487790">)</span><span class="op" id="7487791">)</span><span class="op" id="7487792">)</span><span class="op" id="7487793">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487797"><a href="/gostd/image/gif/reader_test.go.html#7487340">b</a></span><span class="op" id="7487798">.</span><span class="ident" id="7487799"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="7487804">(</span><span class="ident" id="7487805"><a href="/gostd/image/gif/reader_test.go.html#7487669">enc</a></span><span class="op" id="7487808">.</span><span class="ident" id="7487809"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7487814">(</span><span class="op" id="7487815">)</span><span class="op" id="7487816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487820"><a href="/gostd/image/gif/reader_test.go.html#7487340">b</a></span><span class="op" id="7487821">.</span><span class="ident" id="7487822"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="7487831">(</span><span class="num" id="7487832">0x00</span><span class="op" id="7487836">)</span>&nbsp;<span class="comment" id="7487838">//&nbsp;An&nbsp;empty&nbsp;block&nbsp;signifies&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487896"><a href="/gostd/image/gif/reader_test.go.html#7487340">b</a></span><span class="op" id="7487897">.</span><span class="ident" id="7487898"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="7487909">(</span><span class="ident" id="7487910"><a href="/gostd/image/gif/reader_test.go.html#7481978">trailerStr</a></span><span class="op" id="7487920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7487925">//&nbsp;No&nbsp;error&nbsp;expected,&nbsp;unless&nbsp;the&nbsp;pixels&nbsp;are&nbsp;beyond&nbsp;the&nbsp;2&nbsp;color&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7487999">want</span>&nbsp;<span class="op" id="7488004">:=</span>&nbsp;<span class="string" id="7488007">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7488012">if</span>&nbsp;<span class="ident" id="7488015"><a href="/gostd/image/gif/reader_test.go.html#7487298">pval</a></span>&nbsp;<span class="op" id="7488020">&gt;=</span>&nbsp;<span class="num" id="7488023">2</span>&nbsp;<span class="op" id="7488025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488030"><a href="/gostd/image/gif/reader_test.go.html#7487999">want</a></span>&nbsp;<span class="op" id="7488035">=</span>&nbsp;<span class="string" id="7488037">&#34;gif:&nbsp;invalid&nbsp;pixel&nbsp;value&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7488066">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7488070"><a href="/gostd/image/gif/reader_test.go.html#7485695">try</a></span><span class="op" id="7488073">(</span><span class="ident" id="7488074"><a href="/gostd/image/gif/reader_test.go.html#7487274">t</a></span><span class="op" id="7488075">,</span>&nbsp;<span class="ident" id="7488077"><a href="/gostd/image/gif/reader_test.go.html#7487340">b</a></span><span class="op" id="7488078">.</span><span class="ident" id="7488079"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7488084">(</span><span class="op" id="7488085">)</span><span class="op" id="7488086">,</span>&nbsp;<span class="ident" id="7488088"><a href="/gostd/image/gif/reader_test.go.html#7487999">want</a></span><span class="op" id="7488092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7488095">}</span><br>
<span class="lineno"></span><span class="op" id="7488097">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
