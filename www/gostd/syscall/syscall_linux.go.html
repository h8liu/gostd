<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html" class="current">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2502839">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2502894">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2502948">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2502999">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2503022">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2503068">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2503106">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2503171">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2503228">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2503273">package</span>&nbsp;<span class="ident" id="2503281">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2503290">import</span>&nbsp;<span class="string" id="2503297">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2503307">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2503326">//sys&nbsp;&nbsp;&nbsp;&nbsp;open(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2503394">func</span>&nbsp;<span class="ident" id="2503399">Open</span><span class="op" id="2503403">(</span><span class="ident" id="2503404">path</span>&nbsp;<span class="builtintype" id="2503409">string</span><span class="op" id="2503415">,</span>&nbsp;<span class="ident" id="2503417">mode</span>&nbsp;<span class="builtintype" id="2503422">int</span><span class="op" id="2503425">,</span>&nbsp;<span class="ident" id="2503427">perm</span>&nbsp;<span class="builtintype" id="2503432">uint32</span><span class="op" id="2503438">)</span>&nbsp;<span class="op" id="2503440">(</span><span class="ident" id="2503441">fd</span>&nbsp;<span class="builtintype" id="2503444">int</span><span class="op" id="2503447">,</span>&nbsp;<span class="ident" id="2503449">err</span>&nbsp;<span class="builtintype" id="2503453">error</span><span class="op" id="2503458">)</span>&nbsp;<span class="op" id="2503460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503463">return</span>&nbsp;<span class="ident" id="2503470">open</span><span class="op" id="2503474">(</span><span class="ident" id="2503475">path</span><span class="op" id="2503479">,</span>&nbsp;<span class="ident" id="2503481">mode</span><span class="op" id="2503485">|</span><span class="ident" id="2503486">O_LARGEFILE</span><span class="op" id="2503497">,</span>&nbsp;<span class="ident" id="2503499">perm</span><span class="op" id="2503503">)</span><br>
<span class="lineno"></span><span class="op" id="2503505">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2503508">//sys&nbsp;&nbsp;&nbsp;&nbsp;openat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2503590">func</span>&nbsp;<span class="ident" id="2503595">Openat</span><span class="op" id="2503601">(</span><span class="ident" id="2503602">dirfd</span>&nbsp;<span class="builtintype" id="2503608">int</span><span class="op" id="2503611">,</span>&nbsp;<span class="ident" id="2503613">path</span>&nbsp;<span class="builtintype" id="2503618">string</span><span class="op" id="2503624">,</span>&nbsp;<span class="ident" id="2503626">flags</span>&nbsp;<span class="builtintype" id="2503632">int</span><span class="op" id="2503635">,</span>&nbsp;<span class="ident" id="2503637">mode</span>&nbsp;<span class="builtintype" id="2503642">uint32</span><span class="op" id="2503648">)</span>&nbsp;<span class="op" id="2503650">(</span><span class="ident" id="2503651">fd</span>&nbsp;<span class="builtintype" id="2503654">int</span><span class="op" id="2503657">,</span>&nbsp;<span class="ident" id="2503659">err</span>&nbsp;<span class="builtintype" id="2503663">error</span><span class="op" id="2503668">)</span>&nbsp;<span class="op" id="2503670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503673">return</span>&nbsp;<span class="ident" id="2503680">openat</span><span class="op" id="2503686">(</span><span class="ident" id="2503687">dirfd</span><span class="op" id="2503692">,</span>&nbsp;<span class="ident" id="2503694">path</span><span class="op" id="2503698">,</span>&nbsp;<span class="ident" id="2503700">flags</span><span class="op" id="2503705">|</span><span class="ident" id="2503706">O_LARGEFILE</span><span class="op" id="2503717">,</span>&nbsp;<span class="ident" id="2503719">mode</span><span class="op" id="2503723">)</span><br>
<span class="lineno">30</span><span class="op" id="2503725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2503728">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;pipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2503768">func</span>&nbsp;<span class="ident" id="2503773">Pipe</span><span class="op" id="2503777">(</span><span class="ident" id="2503778">p</span>&nbsp;<span class="op" id="2503780">[</span><span class="op" id="2503781">]</span><span class="builtintype" id="2503782">int</span><span class="op" id="2503785">)</span>&nbsp;<span class="op" id="2503787">(</span><span class="ident" id="2503788">err</span>&nbsp;<span class="builtintype" id="2503792">error</span><span class="op" id="2503797">)</span>&nbsp;<span class="op" id="2503799">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503802">if</span>&nbsp;<span class="builtinfunc" id="2503805">len</span><span class="op" id="2503808">(</span><span class="ident" id="2503809">p</span><span class="op" id="2503810">)</span>&nbsp;<span class="op" id="2503812">!=</span>&nbsp;<span class="num" id="2503815">2</span>&nbsp;<span class="op" id="2503817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503821">return</span>&nbsp;<span class="ident" id="2503828">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2503836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503839">var</span>&nbsp;<span class="ident" id="2503843">pp</span>&nbsp;<span class="op" id="2503846">[</span><span class="num" id="2503847">2</span><span class="op" id="2503848">]</span><span class="ident" id="2503849">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503857">err</span>&nbsp;<span class="op" id="2503861">=</span>&nbsp;<span class="ident" id="2503863">pipe</span><span class="op" id="2503867">(</span><span class="op" id="2503868">&amp;</span><span class="ident" id="2503869">pp</span><span class="op" id="2503871">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503874">p</span><span class="op" id="2503875">[</span><span class="num" id="2503876">0</span><span class="op" id="2503877">]</span>&nbsp;<span class="op" id="2503879">=</span>&nbsp;<span class="builtintype" id="2503881">int</span><span class="op" id="2503884">(</span><span class="ident" id="2503885">pp</span><span class="op" id="2503887">[</span><span class="num" id="2503888">0</span><span class="op" id="2503889">]</span><span class="op" id="2503890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503893">p</span><span class="op" id="2503894">[</span><span class="num" id="2503895">1</span><span class="op" id="2503896">]</span>&nbsp;<span class="op" id="2503898">=</span>&nbsp;<span class="builtintype" id="2503900">int</span><span class="op" id="2503903">(</span><span class="ident" id="2503904">pp</span><span class="op" id="2503906">[</span><span class="num" id="2503907">1</span><span class="op" id="2503908">]</span><span class="op" id="2503909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503912">return</span><br>
<span class="lineno"></span><span class="op" id="2503919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2503922">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2503974">func</span>&nbsp;<span class="ident" id="2503979">Pipe2</span><span class="op" id="2503984">(</span><span class="ident" id="2503985">p</span>&nbsp;<span class="op" id="2503987">[</span><span class="op" id="2503988">]</span><span class="builtintype" id="2503989">int</span><span class="op" id="2503992">,</span>&nbsp;<span class="ident" id="2503994">flags</span>&nbsp;<span class="builtintype" id="2504000">int</span><span class="op" id="2504003">)</span>&nbsp;<span class="op" id="2504005">(</span><span class="ident" id="2504006">err</span>&nbsp;<span class="builtintype" id="2504010">error</span><span class="op" id="2504015">)</span>&nbsp;<span class="op" id="2504017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504020">if</span>&nbsp;<span class="builtinfunc" id="2504023">len</span><span class="op" id="2504026">(</span><span class="ident" id="2504027">p</span><span class="op" id="2504028">)</span>&nbsp;<span class="op" id="2504030">!=</span>&nbsp;<span class="num" id="2504033">2</span>&nbsp;<span class="op" id="2504035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504039">return</span>&nbsp;<span class="ident" id="2504046">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2504054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504057">var</span>&nbsp;<span class="ident" id="2504061">pp</span>&nbsp;<span class="op" id="2504064">[</span><span class="num" id="2504065">2</span><span class="op" id="2504066">]</span><span class="ident" id="2504067">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2504075">err</span>&nbsp;<span class="op" id="2504079">=</span>&nbsp;<span class="ident" id="2504081">pipe2</span><span class="op" id="2504086">(</span><span class="op" id="2504087">&amp;</span><span class="ident" id="2504088">pp</span><span class="op" id="2504090">,</span>&nbsp;<span class="ident" id="2504092">flags</span><span class="op" id="2504097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2504100">p</span><span class="op" id="2504101">[</span><span class="num" id="2504102">0</span><span class="op" id="2504103">]</span>&nbsp;<span class="op" id="2504105">=</span>&nbsp;<span class="builtintype" id="2504107">int</span><span class="op" id="2504110">(</span><span class="ident" id="2504111">pp</span><span class="op" id="2504113">[</span><span class="num" id="2504114">0</span><span class="op" id="2504115">]</span><span class="op" id="2504116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2504119">p</span><span class="op" id="2504120">[</span><span class="num" id="2504121">1</span><span class="op" id="2504122">]</span>&nbsp;<span class="op" id="2504124">=</span>&nbsp;<span class="builtintype" id="2504126">int</span><span class="op" id="2504129">(</span><span class="ident" id="2504130">pp</span><span class="op" id="2504132">[</span><span class="num" id="2504133">1</span><span class="op" id="2504134">]</span><span class="op" id="2504135">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504138">return</span><br>
<span class="lineno"></span><span class="op" id="2504145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2504148">//sys&nbsp;&nbsp;&nbsp;&nbsp;utimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2504206">func</span>&nbsp;<span class="ident" id="2504211">Utimes</span><span class="op" id="2504217">(</span><span class="ident" id="2504218">path</span>&nbsp;<span class="builtintype" id="2504223">string</span><span class="op" id="2504229">,</span>&nbsp;<span class="ident" id="2504231">tv</span>&nbsp;<span class="op" id="2504234">[</span><span class="op" id="2504235">]</span><span class="ident" id="2504236">Timeval</span><span class="op" id="2504243">)</span>&nbsp;<span class="op" id="2504245">(</span><span class="ident" id="2504246">err</span>&nbsp;<span class="builtintype" id="2504250">error</span><span class="op" id="2504255">)</span>&nbsp;<span class="op" id="2504257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504260">if</span>&nbsp;<span class="builtinfunc" id="2504263">len</span><span class="op" id="2504266">(</span><span class="ident" id="2504267">tv</span><span class="op" id="2504269">)</span>&nbsp;<span class="op" id="2504271">!=</span>&nbsp;<span class="num" id="2504274">2</span>&nbsp;<span class="op" id="2504276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504280">return</span>&nbsp;<span class="ident" id="2504287">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2504295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504298">return</span>&nbsp;<span class="ident" id="2504305">utimes</span><span class="op" id="2504311">(</span><span class="ident" id="2504312">path</span><span class="op" id="2504316">,</span>&nbsp;<span class="op" id="2504318">(</span><span class="op" id="2504319">*</span><span class="op" id="2504320">[</span><span class="num" id="2504321">2</span><span class="op" id="2504322">]</span><span class="ident" id="2504323">Timeval</span><span class="op" id="2504330">)</span><span class="op" id="2504331">(</span><span class="ident" id="2504332">unsafe</span><span class="op" id="2504338">.</span><span class="ident" id="2504339">Pointer</span><span class="op" id="2504346">(</span><span class="op" id="2504347">&amp;</span><span class="ident" id="2504348">tv</span><span class="op" id="2504350">[</span><span class="num" id="2504351">0</span><span class="op" id="2504352">]</span><span class="op" id="2504353">)</span><span class="op" id="2504354">)</span><span class="op" id="2504355">)</span><br>
<span class="lineno">65</span><span class="op" id="2504357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2504360">//sys&nbsp;&nbsp;&nbsp;&nbsp;utimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2504433">func</span>&nbsp;<span class="ident" id="2504438">UtimesNano</span><span class="op" id="2504448">(</span><span class="ident" id="2504449">path</span>&nbsp;<span class="builtintype" id="2504454">string</span><span class="op" id="2504460">,</span>&nbsp;<span class="ident" id="2504462">ts</span>&nbsp;<span class="op" id="2504465">[</span><span class="op" id="2504466">]</span><span class="ident" id="2504467">Timespec</span><span class="op" id="2504475">)</span>&nbsp;<span class="op" id="2504477">(</span><span class="ident" id="2504478">err</span>&nbsp;<span class="builtintype" id="2504482">error</span><span class="op" id="2504487">)</span>&nbsp;<span class="op" id="2504489">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504492">if</span>&nbsp;<span class="builtinfunc" id="2504495">len</span><span class="op" id="2504498">(</span><span class="ident" id="2504499">ts</span><span class="op" id="2504501">)</span>&nbsp;<span class="op" id="2504503">!=</span>&nbsp;<span class="num" id="2504506">2</span>&nbsp;<span class="op" id="2504508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504512">return</span>&nbsp;<span class="ident" id="2504519">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2504527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2504530">err</span>&nbsp;<span class="op" id="2504534">=</span>&nbsp;<span class="ident" id="2504536">utimensat</span><span class="op" id="2504545">(</span><span class="ident" id="2504546">_AT_FDCWD</span><span class="op" id="2504555">,</span>&nbsp;<span class="ident" id="2504557">path</span><span class="op" id="2504561">,</span>&nbsp;<span class="op" id="2504563">(</span><span class="op" id="2504564">*</span><span class="op" id="2504565">[</span><span class="num" id="2504566">2</span><span class="op" id="2504567">]</span><span class="ident" id="2504568">Timespec</span><span class="op" id="2504576">)</span><span class="op" id="2504577">(</span><span class="ident" id="2504578">unsafe</span><span class="op" id="2504584">.</span><span class="ident" id="2504585">Pointer</span><span class="op" id="2504592">(</span><span class="op" id="2504593">&amp;</span><span class="ident" id="2504594">ts</span><span class="op" id="2504596">[</span><span class="num" id="2504597">0</span><span class="op" id="2504598">]</span><span class="op" id="2504599">)</span><span class="op" id="2504600">)</span><span class="op" id="2504601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504604">if</span>&nbsp;<span class="ident" id="2504607">err</span>&nbsp;<span class="op" id="2504611">!=</span>&nbsp;<span class="ident" id="2504614">ENOSYS</span>&nbsp;<span class="op" id="2504621">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504625">return</span>&nbsp;<span class="ident" id="2504632">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2504637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504640">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504715">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504778">var</span>&nbsp;<span class="ident" id="2504782">tv</span>&nbsp;<span class="op" id="2504785">[</span><span class="num" id="2504786">2</span><span class="op" id="2504787">]</span><span class="ident" id="2504788">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504797">for</span>&nbsp;<span class="ident" id="2504801">i</span>&nbsp;<span class="op" id="2504803">:=</span>&nbsp;<span class="num" id="2504806">0</span><span class="op" id="2504807">;</span>&nbsp;<span class="ident" id="2504809">i</span>&nbsp;<span class="op" id="2504811">&lt;</span>&nbsp;<span class="num" id="2504813">2</span><span class="op" id="2504814">;</span>&nbsp;<span class="ident" id="2504816">i</span><span class="op" id="2504817">++</span>&nbsp;<span class="op" id="2504820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2504824">tv</span><span class="op" id="2504826">[</span><span class="ident" id="2504827">i</span><span class="op" id="2504828">]</span><span class="op" id="2504829">.</span><span class="ident" id="2504830">Sec</span>&nbsp;<span class="op" id="2504834">=</span>&nbsp;<span class="ident" id="2504836">ts</span><span class="op" id="2504838">[</span><span class="ident" id="2504839">i</span><span class="op" id="2504840">]</span><span class="op" id="2504841">.</span><span class="ident" id="2504842">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2504848">tv</span><span class="op" id="2504850">[</span><span class="ident" id="2504851">i</span><span class="op" id="2504852">]</span><span class="op" id="2504853">.</span><span class="ident" id="2504854">Usec</span>&nbsp;<span class="op" id="2504859">=</span>&nbsp;<span class="ident" id="2504861">ts</span><span class="op" id="2504863">[</span><span class="ident" id="2504864">i</span><span class="op" id="2504865">]</span><span class="op" id="2504866">.</span><span class="ident" id="2504867">Nsec</span>&nbsp;<span class="op" id="2504872">/</span>&nbsp;<span class="num" id="2504874">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2504880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2504883">return</span>&nbsp;<span class="ident" id="2504890">utimes</span><span class="op" id="2504896">(</span><span class="ident" id="2504897">path</span><span class="op" id="2504901">,</span>&nbsp;<span class="op" id="2504903">(</span><span class="op" id="2504904">*</span><span class="op" id="2504905">[</span><span class="num" id="2504906">2</span><span class="op" id="2504907">]</span><span class="ident" id="2504908">Timeval</span><span class="op" id="2504915">)</span><span class="op" id="2504916">(</span><span class="ident" id="2504917">unsafe</span><span class="op" id="2504923">.</span><span class="ident" id="2504924">Pointer</span><span class="op" id="2504931">(</span><span class="op" id="2504932">&amp;</span><span class="ident" id="2504933">tv</span><span class="op" id="2504935">[</span><span class="num" id="2504936">0</span><span class="op" id="2504937">]</span><span class="op" id="2504938">)</span><span class="op" id="2504939">)</span><span class="op" id="2504940">)</span><br>
<span class="lineno">85</span><span class="op" id="2504942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2504945">//sys&nbsp;&nbsp;&nbsp;&nbsp;futimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505016">func</span>&nbsp;<span class="ident" id="2505021">Futimesat</span><span class="op" id="2505030">(</span><span class="ident" id="2505031">dirfd</span>&nbsp;<span class="builtintype" id="2505037">int</span><span class="op" id="2505040">,</span>&nbsp;<span class="ident" id="2505042">path</span>&nbsp;<span class="builtintype" id="2505047">string</span><span class="op" id="2505053">,</span>&nbsp;<span class="ident" id="2505055">tv</span>&nbsp;<span class="op" id="2505058">[</span><span class="op" id="2505059">]</span><span class="ident" id="2505060">Timeval</span><span class="op" id="2505067">)</span>&nbsp;<span class="op" id="2505069">(</span><span class="ident" id="2505070">err</span>&nbsp;<span class="builtintype" id="2505074">error</span><span class="op" id="2505079">)</span>&nbsp;<span class="op" id="2505081">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505084">if</span>&nbsp;<span class="builtinfunc" id="2505087">len</span><span class="op" id="2505090">(</span><span class="ident" id="2505091">tv</span><span class="op" id="2505093">)</span>&nbsp;<span class="op" id="2505095">!=</span>&nbsp;<span class="num" id="2505098">2</span>&nbsp;<span class="op" id="2505100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505104">return</span>&nbsp;<span class="ident" id="2505111">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505122">pathp</span><span class="op" id="2505127">,</span>&nbsp;<span class="ident" id="2505129">err</span>&nbsp;<span class="op" id="2505133">:=</span>&nbsp;<span class="ident" id="2505136">BytePtrFromString</span><span class="op" id="2505153">(</span><span class="ident" id="2505154">path</span><span class="op" id="2505158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505161">if</span>&nbsp;<span class="ident" id="2505164">err</span>&nbsp;<span class="op" id="2505168">!=</span>&nbsp;<span class="builtintype" id="2505171">nil</span>&nbsp;<span class="op" id="2505175">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505179">return</span>&nbsp;<span class="ident" id="2505186">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505194">err</span>&nbsp;<span class="op" id="2505198">=</span>&nbsp;<span class="ident" id="2505200">futimesat</span><span class="op" id="2505209">(</span><span class="ident" id="2505210">dirfd</span><span class="op" id="2505215">,</span>&nbsp;<span class="ident" id="2505217">pathp</span><span class="op" id="2505222">,</span>&nbsp;<span class="op" id="2505224">(</span><span class="op" id="2505225">*</span><span class="op" id="2505226">[</span><span class="num" id="2505227">2</span><span class="op" id="2505228">]</span><span class="ident" id="2505229">Timeval</span><span class="op" id="2505236">)</span><span class="op" id="2505237">(</span><span class="ident" id="2505238">unsafe</span><span class="op" id="2505244">.</span><span class="ident" id="2505245">Pointer</span><span class="op" id="2505252">(</span><span class="op" id="2505253">&amp;</span><span class="ident" id="2505254">tv</span><span class="op" id="2505256">[</span><span class="num" id="2505257">0</span><span class="op" id="2505258">]</span><span class="op" id="2505259">)</span><span class="op" id="2505260">)</span><span class="op" id="2505261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505264">use</span><span class="op" id="2505267">(</span><span class="ident" id="2505268">unsafe</span><span class="op" id="2505274">.</span><span class="ident" id="2505275">Pointer</span><span class="op" id="2505282">(</span><span class="ident" id="2505283">pathp</span><span class="op" id="2505288">)</span><span class="op" id="2505289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505292">return</span>&nbsp;<span class="ident" id="2505299">err</span><br>
<span class="lineno">100</span><span class="op" id="2505303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505306">func</span>&nbsp;<span class="ident" id="2505311">Futimes</span><span class="op" id="2505318">(</span><span class="ident" id="2505319">fd</span>&nbsp;<span class="builtintype" id="2505322">int</span><span class="op" id="2505325">,</span>&nbsp;<span class="ident" id="2505327">tv</span>&nbsp;<span class="op" id="2505330">[</span><span class="op" id="2505331">]</span><span class="ident" id="2505332">Timeval</span><span class="op" id="2505339">)</span>&nbsp;<span class="op" id="2505341">(</span><span class="ident" id="2505342">err</span>&nbsp;<span class="builtintype" id="2505346">error</span><span class="op" id="2505351">)</span>&nbsp;<span class="op" id="2505353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505356">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505415">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505445">return</span>&nbsp;<span class="ident" id="2505452">Utimes</span><span class="op" id="2505458">(</span><span class="string" id="2505459">&#34;/proc/self/fd/&#34;</span><span class="op" id="2505475">+</span><span class="ident" id="2505476">itoa</span><span class="op" id="2505480">(</span><span class="ident" id="2505481">fd</span><span class="op" id="2505483">)</span><span class="op" id="2505484">,</span>&nbsp;<span class="ident" id="2505486">tv</span><span class="op" id="2505488">)</span><br>
<span class="lineno"></span><span class="op" id="2505490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505493">const</span>&nbsp;<span class="ident" id="2505499">ImplementsGetwd</span>&nbsp;<span class="op" id="2505515">=</span>&nbsp;<span class="builtintype" id="2505517">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2505523">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505568">func</span>&nbsp;<span class="ident" id="2505573">Getwd</span><span class="op" id="2505578">(</span><span class="op" id="2505579">)</span>&nbsp;<span class="op" id="2505581">(</span><span class="ident" id="2505582">wd</span>&nbsp;<span class="builtintype" id="2505585">string</span><span class="op" id="2505591">,</span>&nbsp;<span class="ident" id="2505593">err</span>&nbsp;<span class="builtintype" id="2505597">error</span><span class="op" id="2505602">)</span>&nbsp;<span class="op" id="2505604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505607">var</span>&nbsp;<span class="ident" id="2505611">buf</span>&nbsp;<span class="op" id="2505615">[</span><span class="ident" id="2505616">PathMax</span><span class="op" id="2505623">]</span><span class="builtintype" id="2505624">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505630">n</span><span class="op" id="2505631">,</span>&nbsp;<span class="ident" id="2505633">err</span>&nbsp;<span class="op" id="2505637">:=</span>&nbsp;<span class="ident" id="2505640">Getcwd</span><span class="op" id="2505646">(</span><span class="ident" id="2505647">buf</span><span class="op" id="2505650">[</span><span class="num" id="2505651">0</span><span class="op" id="2505652">:</span><span class="op" id="2505653">]</span><span class="op" id="2505654">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505657">if</span>&nbsp;<span class="ident" id="2505660">err</span>&nbsp;<span class="op" id="2505664">!=</span>&nbsp;<span class="builtintype" id="2505667">nil</span>&nbsp;<span class="op" id="2505671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505675">return</span>&nbsp;<span class="string" id="2505682">&#34;&#34;</span><span class="op" id="2505684">,</span>&nbsp;<span class="ident" id="2505686">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505694">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505768">if</span>&nbsp;<span class="ident" id="2505771">n</span>&nbsp;<span class="op" id="2505773">&lt;</span>&nbsp;<span class="num" id="2505775">1</span>&nbsp;<span class="op" id="2505777">||</span>&nbsp;<span class="ident" id="2505780">n</span>&nbsp;<span class="op" id="2505782">&gt;</span>&nbsp;<span class="builtinfunc" id="2505784">len</span><span class="op" id="2505787">(</span><span class="ident" id="2505788">buf</span><span class="op" id="2505791">)</span>&nbsp;<span class="op" id="2505793">||</span>&nbsp;<span class="ident" id="2505796">buf</span><span class="op" id="2505799">[</span><span class="ident" id="2505800">n</span><span class="op" id="2505801">-</span><span class="num" id="2505802">1</span><span class="op" id="2505803">]</span>&nbsp;<span class="op" id="2505805">!=</span>&nbsp;<span class="num" id="2505808">0</span>&nbsp;<span class="op" id="2505810">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505814">return</span>&nbsp;<span class="string" id="2505821">&#34;&#34;</span><span class="op" id="2505823">,</span>&nbsp;<span class="ident" id="2505825">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505836">return</span>&nbsp;<span class="builtintype" id="2505843">string</span><span class="op" id="2505849">(</span><span class="ident" id="2505850">buf</span><span class="op" id="2505853">[</span><span class="num" id="2505854">0</span>&nbsp;<span class="op" id="2505856">:</span>&nbsp;<span class="ident" id="2505858">n</span><span class="op" id="2505859">-</span><span class="num" id="2505860">1</span><span class="op" id="2505861">]</span><span class="op" id="2505862">)</span><span class="op" id="2505863">,</span>&nbsp;<span class="builtintype" id="2505865">nil</span><br>
<span class="lineno"></span><span class="op" id="2505869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2505872">func</span>&nbsp;<span class="ident" id="2505877">Getgroups</span><span class="op" id="2505886">(</span><span class="op" id="2505887">)</span>&nbsp;<span class="op" id="2505889">(</span><span class="ident" id="2505890">gids</span>&nbsp;<span class="op" id="2505895">[</span><span class="op" id="2505896">]</span><span class="builtintype" id="2505897">int</span><span class="op" id="2505900">,</span>&nbsp;<span class="ident" id="2505902">err</span>&nbsp;<span class="builtintype" id="2505906">error</span><span class="op" id="2505911">)</span>&nbsp;<span class="op" id="2505913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505916">n</span><span class="op" id="2505917">,</span>&nbsp;<span class="ident" id="2505919">err</span>&nbsp;<span class="op" id="2505923">:=</span>&nbsp;<span class="ident" id="2505926">getgroups</span><span class="op" id="2505935">(</span><span class="num" id="2505936">0</span><span class="op" id="2505937">,</span>&nbsp;<span class="builtintype" id="2505939">nil</span><span class="op" id="2505942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505945">if</span>&nbsp;<span class="ident" id="2505948">err</span>&nbsp;<span class="op" id="2505952">!=</span>&nbsp;<span class="builtintype" id="2505955">nil</span>&nbsp;<span class="op" id="2505959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505963">return</span>&nbsp;<span class="builtintype" id="2505970">nil</span><span class="op" id="2505973">,</span>&nbsp;<span class="ident" id="2505975">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505980">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505983">if</span>&nbsp;<span class="ident" id="2505986">n</span>&nbsp;<span class="op" id="2505988">==</span>&nbsp;<span class="num" id="2505991">0</span>&nbsp;<span class="op" id="2505993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505997">return</span>&nbsp;<span class="builtintype" id="2506004">nil</span><span class="op" id="2506007">,</span>&nbsp;<span class="builtintype" id="2506009">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2506018">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506072">if</span>&nbsp;<span class="ident" id="2506075">n</span>&nbsp;<span class="op" id="2506077">&lt;</span>&nbsp;<span class="num" id="2506079">0</span>&nbsp;<span class="op" id="2506081">||</span>&nbsp;<span class="ident" id="2506084">n</span>&nbsp;<span class="op" id="2506086">&gt;</span>&nbsp;<span class="num" id="2506088">1</span><span class="op" id="2506089">&lt;&lt;</span><span class="num" id="2506091">20</span>&nbsp;<span class="op" id="2506094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506098">return</span>&nbsp;<span class="builtintype" id="2506105">nil</span><span class="op" id="2506108">,</span>&nbsp;<span class="ident" id="2506110">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506122">a</span>&nbsp;<span class="op" id="2506124">:=</span>&nbsp;<span class="builtinfunc" id="2506127">make</span><span class="op" id="2506131">(</span><span class="op" id="2506132">[</span><span class="op" id="2506133">]</span><span class="ident" id="2506134">_Gid_t</span><span class="op" id="2506140">,</span>&nbsp;<span class="ident" id="2506142">n</span><span class="op" id="2506143">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506146">n</span><span class="op" id="2506147">,</span>&nbsp;<span class="ident" id="2506149">err</span>&nbsp;<span class="op" id="2506153">=</span>&nbsp;<span class="ident" id="2506155">getgroups</span><span class="op" id="2506164">(</span><span class="ident" id="2506165">n</span><span class="op" id="2506166">,</span>&nbsp;<span class="op" id="2506168">&amp;</span><span class="ident" id="2506169">a</span><span class="op" id="2506170">[</span><span class="num" id="2506171">0</span><span class="op" id="2506172">]</span><span class="op" id="2506173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506176">if</span>&nbsp;<span class="ident" id="2506179">err</span>&nbsp;<span class="op" id="2506183">!=</span>&nbsp;<span class="builtintype" id="2506186">nil</span>&nbsp;<span class="op" id="2506190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506194">return</span>&nbsp;<span class="builtintype" id="2506201">nil</span><span class="op" id="2506204">,</span>&nbsp;<span class="ident" id="2506206">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506214">gids</span>&nbsp;<span class="op" id="2506219">=</span>&nbsp;<span class="builtinfunc" id="2506221">make</span><span class="op" id="2506225">(</span><span class="op" id="2506226">[</span><span class="op" id="2506227">]</span><span class="builtintype" id="2506228">int</span><span class="op" id="2506231">,</span>&nbsp;<span class="ident" id="2506233">n</span><span class="op" id="2506234">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506237">for</span>&nbsp;<span class="ident" id="2506241">i</span><span class="op" id="2506242">,</span>&nbsp;<span class="ident" id="2506244">v</span>&nbsp;<span class="op" id="2506246">:=</span>&nbsp;<span class="keyword" id="2506249">range</span>&nbsp;<span class="ident" id="2506255">a</span><span class="op" id="2506256">[</span><span class="num" id="2506257">0</span><span class="op" id="2506258">:</span><span class="ident" id="2506259">n</span><span class="op" id="2506260">]</span>&nbsp;<span class="op" id="2506262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506266">gids</span><span class="op" id="2506270">[</span><span class="ident" id="2506271">i</span><span class="op" id="2506272">]</span>&nbsp;<span class="op" id="2506274">=</span>&nbsp;<span class="builtintype" id="2506276">int</span><span class="op" id="2506279">(</span><span class="ident" id="2506280">v</span><span class="op" id="2506281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506287">return</span><br>
<span class="lineno"></span><span class="op" id="2506294">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2506297">func</span>&nbsp;<span class="ident" id="2506302">Setgroups</span><span class="op" id="2506311">(</span><span class="ident" id="2506312">gids</span>&nbsp;<span class="op" id="2506317">[</span><span class="op" id="2506318">]</span><span class="builtintype" id="2506319">int</span><span class="op" id="2506322">)</span>&nbsp;<span class="op" id="2506324">(</span><span class="ident" id="2506325">err</span>&nbsp;<span class="builtintype" id="2506329">error</span><span class="op" id="2506334">)</span>&nbsp;<span class="op" id="2506336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506339">if</span>&nbsp;<span class="builtinfunc" id="2506342">len</span><span class="op" id="2506345">(</span><span class="ident" id="2506346">gids</span><span class="op" id="2506350">)</span>&nbsp;<span class="op" id="2506352">==</span>&nbsp;<span class="num" id="2506355">0</span>&nbsp;<span class="op" id="2506357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506361">return</span>&nbsp;<span class="ident" id="2506368">setgroups</span><span class="op" id="2506377">(</span><span class="num" id="2506378">0</span><span class="op" id="2506379">,</span>&nbsp;<span class="builtintype" id="2506381">nil</span><span class="op" id="2506384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506387">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506391">a</span>&nbsp;<span class="op" id="2506393">:=</span>&nbsp;<span class="builtinfunc" id="2506396">make</span><span class="op" id="2506400">(</span><span class="op" id="2506401">[</span><span class="op" id="2506402">]</span><span class="ident" id="2506403">_Gid_t</span><span class="op" id="2506409">,</span>&nbsp;<span class="builtinfunc" id="2506411">len</span><span class="op" id="2506414">(</span><span class="ident" id="2506415">gids</span><span class="op" id="2506419">)</span><span class="op" id="2506420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506423">for</span>&nbsp;<span class="ident" id="2506427">i</span><span class="op" id="2506428">,</span>&nbsp;<span class="ident" id="2506430">v</span>&nbsp;<span class="op" id="2506432">:=</span>&nbsp;<span class="keyword" id="2506435">range</span>&nbsp;<span class="ident" id="2506441">gids</span>&nbsp;<span class="op" id="2506446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506450">a</span><span class="op" id="2506451">[</span><span class="ident" id="2506452">i</span><span class="op" id="2506453">]</span>&nbsp;<span class="op" id="2506455">=</span>&nbsp;<span class="ident" id="2506457">_Gid_t</span><span class="op" id="2506463">(</span><span class="ident" id="2506464">v</span><span class="op" id="2506465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506468">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506471">return</span>&nbsp;<span class="ident" id="2506478">setgroups</span><span class="op" id="2506487">(</span><span class="builtinfunc" id="2506488">len</span><span class="op" id="2506491">(</span><span class="ident" id="2506492">a</span><span class="op" id="2506493">)</span><span class="op" id="2506494">,</span>&nbsp;<span class="op" id="2506496">&amp;</span><span class="ident" id="2506497">a</span><span class="op" id="2506498">[</span><span class="num" id="2506499">0</span><span class="op" id="2506500">]</span><span class="op" id="2506501">)</span><br>
<span class="lineno"></span><span class="op" id="2506503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2506506">type</span>&nbsp;<span class="ident" id="2506511">WaitStatus</span>&nbsp;<span class="builtintype" id="2506522">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2506530">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2506585">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2506644">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2506694">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2506748">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2506799">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2506854">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2506909">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2506949">const</span>&nbsp;<span class="op" id="2506955">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506958">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506966">=</span>&nbsp;<span class="num" id="2506968">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506974">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506982">=</span>&nbsp;<span class="num" id="2506984">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506990">exited</span>&nbsp;&nbsp;<span class="op" id="2506998">=</span>&nbsp;<span class="num" id="2507000">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507006">stopped</span>&nbsp;<span class="op" id="2507014">=</span>&nbsp;<span class="num" id="2507016">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507022">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2507030">=</span>&nbsp;<span class="num" id="2507032">8</span><br>
<span class="lineno">180</span><span class="op" id="2507034">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2507037">func</span>&nbsp;<span class="op" id="2507042">(</span><span class="ident" id="2507043">w</span>&nbsp;<span class="ident" id="2507045">WaitStatus</span><span class="op" id="2507055">)</span>&nbsp;<span class="ident" id="2507057">Exited</span><span class="op" id="2507063">(</span><span class="op" id="2507064">)</span>&nbsp;<span class="builtintype" id="2507066">bool</span>&nbsp;<span class="op" id="2507071">{</span>&nbsp;<span class="keyword" id="2507073">return</span>&nbsp;<span class="ident" id="2507080">w</span><span class="op" id="2507081">&amp;</span><span class="ident" id="2507082">mask</span>&nbsp;<span class="op" id="2507087">==</span>&nbsp;<span class="ident" id="2507090">exited</span>&nbsp;<span class="op" id="2507097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2507100">func</span>&nbsp;<span class="op" id="2507105">(</span><span class="ident" id="2507106">w</span>&nbsp;<span class="ident" id="2507108">WaitStatus</span><span class="op" id="2507118">)</span>&nbsp;<span class="ident" id="2507120">Signaled</span><span class="op" id="2507128">(</span><span class="op" id="2507129">)</span>&nbsp;<span class="builtintype" id="2507131">bool</span>&nbsp;<span class="op" id="2507136">{</span>&nbsp;<span class="keyword" id="2507138">return</span>&nbsp;<span class="ident" id="2507145">w</span><span class="op" id="2507146">&amp;</span><span class="ident" id="2507147">mask</span>&nbsp;<span class="op" id="2507152">!=</span>&nbsp;<span class="ident" id="2507155">stopped</span>&nbsp;<span class="op" id="2507163">&amp;&amp;</span>&nbsp;<span class="ident" id="2507166">w</span><span class="op" id="2507167">&amp;</span><span class="ident" id="2507168">mask</span>&nbsp;<span class="op" id="2507173">!=</span>&nbsp;<span class="ident" id="2507176">exited</span>&nbsp;<span class="op" id="2507183">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2507186">func</span>&nbsp;<span class="op" id="2507191">(</span><span class="ident" id="2507192">w</span>&nbsp;<span class="ident" id="2507194">WaitStatus</span><span class="op" id="2507204">)</span>&nbsp;<span class="ident" id="2507206">Stopped</span><span class="op" id="2507213">(</span><span class="op" id="2507214">)</span>&nbsp;<span class="builtintype" id="2507216">bool</span>&nbsp;<span class="op" id="2507221">{</span>&nbsp;<span class="keyword" id="2507223">return</span>&nbsp;<span class="ident" id="2507230">w</span><span class="op" id="2507231">&amp;</span><span class="num" id="2507232">0xFF</span>&nbsp;<span class="op" id="2507237">==</span>&nbsp;<span class="ident" id="2507240">stopped</span>&nbsp;<span class="op" id="2507248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2507251">func</span>&nbsp;<span class="op" id="2507256">(</span><span class="ident" id="2507257">w</span>&nbsp;<span class="ident" id="2507259">WaitStatus</span><span class="op" id="2507269">)</span>&nbsp;<span class="ident" id="2507271">Continued</span><span class="op" id="2507280">(</span><span class="op" id="2507281">)</span>&nbsp;<span class="builtintype" id="2507283">bool</span>&nbsp;<span class="op" id="2507288">{</span>&nbsp;<span class="keyword" id="2507290">return</span>&nbsp;<span class="ident" id="2507297">w</span>&nbsp;<span class="op" id="2507299">==</span>&nbsp;<span class="num" id="2507302">0xFFFF</span>&nbsp;<span class="op" id="2507309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2507312">func</span>&nbsp;<span class="op" id="2507317">(</span><span class="ident" id="2507318">w</span>&nbsp;<span class="ident" id="2507320">WaitStatus</span><span class="op" id="2507330">)</span>&nbsp;<span class="ident" id="2507332">CoreDump</span><span class="op" id="2507340">(</span><span class="op" id="2507341">)</span>&nbsp;<span class="builtintype" id="2507343">bool</span>&nbsp;<span class="op" id="2507348">{</span>&nbsp;<span class="keyword" id="2507350">return</span>&nbsp;<span class="ident" id="2507357">w</span><span class="op" id="2507358">.</span><span class="ident" id="2507359">Signaled</span><span class="op" id="2507367">(</span><span class="op" id="2507368">)</span>&nbsp;<span class="op" id="2507370">&amp;&amp;</span>&nbsp;<span class="ident" id="2507373">w</span><span class="op" id="2507374">&amp;</span><span class="ident" id="2507375">core</span>&nbsp;<span class="op" id="2507380">!=</span>&nbsp;<span class="num" id="2507383">0</span>&nbsp;<span class="op" id="2507385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2507388">func</span>&nbsp;<span class="op" id="2507393">(</span><span class="ident" id="2507394">w</span>&nbsp;<span class="ident" id="2507396">WaitStatus</span><span class="op" id="2507406">)</span>&nbsp;<span class="ident" id="2507408">ExitStatus</span><span class="op" id="2507418">(</span><span class="op" id="2507419">)</span>&nbsp;<span class="builtintype" id="2507421">int</span>&nbsp;<span class="op" id="2507425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507428">if</span>&nbsp;<span class="op" id="2507431">!</span><span class="ident" id="2507432">w</span><span class="op" id="2507433">.</span><span class="ident" id="2507434">Exited</span><span class="op" id="2507440">(</span><span class="op" id="2507441">)</span>&nbsp;<span class="op" id="2507443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507447">return</span>&nbsp;<span class="op" id="2507454">-</span><span class="num" id="2507455">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507461">return</span>&nbsp;<span class="builtintype" id="2507468">int</span><span class="op" id="2507471">(</span><span class="ident" id="2507472">w</span><span class="op" id="2507473">&gt;&gt;</span><span class="ident" id="2507475">shift</span><span class="op" id="2507480">)</span>&nbsp;<span class="op" id="2507482">&amp;</span>&nbsp;<span class="num" id="2507484">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2507489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2507492">func</span>&nbsp;<span class="op" id="2507497">(</span><span class="ident" id="2507498">w</span>&nbsp;<span class="ident" id="2507500">WaitStatus</span><span class="op" id="2507510">)</span>&nbsp;<span class="ident" id="2507512">Signal</span><span class="op" id="2507518">(</span><span class="op" id="2507519">)</span>&nbsp;<span class="ident" id="2507521">Signal</span>&nbsp;<span class="op" id="2507528">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507531">if</span>&nbsp;<span class="op" id="2507534">!</span><span class="ident" id="2507535">w</span><span class="op" id="2507536">.</span><span class="ident" id="2507537">Signaled</span><span class="op" id="2507545">(</span><span class="op" id="2507546">)</span>&nbsp;<span class="op" id="2507548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507552">return</span>&nbsp;<span class="op" id="2507559">-</span><span class="num" id="2507560">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507566">return</span>&nbsp;<span class="ident" id="2507573">Signal</span><span class="op" id="2507579">(</span><span class="ident" id="2507580">w</span>&nbsp;<span class="op" id="2507582">&amp;</span>&nbsp;<span class="ident" id="2507584">mask</span><span class="op" id="2507588">)</span><br>
<span class="lineno"></span><span class="op" id="2507590">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2507593">func</span>&nbsp;<span class="op" id="2507598">(</span><span class="ident" id="2507599">w</span>&nbsp;<span class="ident" id="2507601">WaitStatus</span><span class="op" id="2507611">)</span>&nbsp;<span class="ident" id="2507613">StopSignal</span><span class="op" id="2507623">(</span><span class="op" id="2507624">)</span>&nbsp;<span class="ident" id="2507626">Signal</span>&nbsp;<span class="op" id="2507633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507636">if</span>&nbsp;<span class="op" id="2507639">!</span><span class="ident" id="2507640">w</span><span class="op" id="2507641">.</span><span class="ident" id="2507642">Stopped</span><span class="op" id="2507649">(</span><span class="op" id="2507650">)</span>&nbsp;<span class="op" id="2507652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507656">return</span>&nbsp;<span class="op" id="2507663">-</span><span class="num" id="2507664">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507667">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507670">return</span>&nbsp;<span class="ident" id="2507677">Signal</span><span class="op" id="2507683">(</span><span class="ident" id="2507684">w</span><span class="op" id="2507685">&gt;&gt;</span><span class="ident" id="2507687">shift</span><span class="op" id="2507692">)</span>&nbsp;<span class="op" id="2507694">&amp;</span>&nbsp;<span class="num" id="2507696">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2507701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2507704">func</span>&nbsp;<span class="op" id="2507709">(</span><span class="ident" id="2507710">w</span>&nbsp;<span class="ident" id="2507712">WaitStatus</span><span class="op" id="2507722">)</span>&nbsp;<span class="ident" id="2507724">TrapCause</span><span class="op" id="2507733">(</span><span class="op" id="2507734">)</span>&nbsp;<span class="builtintype" id="2507736">int</span>&nbsp;<span class="op" id="2507740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507743">if</span>&nbsp;<span class="ident" id="2507746">w</span><span class="op" id="2507747">.</span><span class="ident" id="2507748">StopSignal</span><span class="op" id="2507758">(</span><span class="op" id="2507759">)</span>&nbsp;<span class="op" id="2507761">!=</span>&nbsp;<span class="ident" id="2507764">SIGTRAP</span>&nbsp;<span class="op" id="2507772">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507776">return</span>&nbsp;<span class="op" id="2507783">-</span><span class="num" id="2507784">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507790">return</span>&nbsp;<span class="builtintype" id="2507797">int</span><span class="op" id="2507800">(</span><span class="ident" id="2507801">w</span><span class="op" id="2507802">&gt;&gt;</span><span class="ident" id="2507804">shift</span><span class="op" id="2507809">)</span>&nbsp;<span class="op" id="2507811">&gt;&gt;</span>&nbsp;<span class="num" id="2507814">8</span><br>
<span class="lineno"></span><span class="op" id="2507816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2507819">//sys&nbsp;&nbsp;&nbsp;&nbsp;wait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2507909">func</span>&nbsp;<span class="ident" id="2507914">Wait4</span><span class="op" id="2507919">(</span><span class="ident" id="2507920">pid</span>&nbsp;<span class="builtintype" id="2507924">int</span><span class="op" id="2507927">,</span>&nbsp;<span class="ident" id="2507929">wstatus</span>&nbsp;<span class="op" id="2507937">*</span><span class="ident" id="2507938">WaitStatus</span><span class="op" id="2507948">,</span>&nbsp;<span class="ident" id="2507950">options</span>&nbsp;<span class="builtintype" id="2507958">int</span><span class="op" id="2507961">,</span>&nbsp;<span class="ident" id="2507963">rusage</span>&nbsp;<span class="op" id="2507970">*</span><span class="ident" id="2507971">Rusage</span><span class="op" id="2507977">)</span>&nbsp;<span class="op" id="2507979">(</span><span class="ident" id="2507980">wpid</span>&nbsp;<span class="builtintype" id="2507985">int</span><span class="op" id="2507988">,</span>&nbsp;<span class="ident" id="2507990">err</span>&nbsp;<span class="builtintype" id="2507994">error</span><span class="op" id="2507999">)</span>&nbsp;<span class="op" id="2508001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508004">var</span>&nbsp;<span class="ident" id="2508008">status</span>&nbsp;<span class="ident" id="2508015">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508023">wpid</span><span class="op" id="2508027">,</span>&nbsp;<span class="ident" id="2508029">err</span>&nbsp;<span class="op" id="2508033">=</span>&nbsp;<span class="ident" id="2508035">wait4</span><span class="op" id="2508040">(</span><span class="ident" id="2508041">pid</span><span class="op" id="2508044">,</span>&nbsp;<span class="op" id="2508046">&amp;</span><span class="ident" id="2508047">status</span><span class="op" id="2508053">,</span>&nbsp;<span class="ident" id="2508055">options</span><span class="op" id="2508062">,</span>&nbsp;<span class="ident" id="2508064">rusage</span><span class="op" id="2508070">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508073">if</span>&nbsp;<span class="ident" id="2508076">wstatus</span>&nbsp;<span class="op" id="2508084">!=</span>&nbsp;<span class="builtintype" id="2508087">nil</span>&nbsp;<span class="op" id="2508091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508095">*</span><span class="ident" id="2508096">wstatus</span>&nbsp;<span class="op" id="2508104">=</span>&nbsp;<span class="ident" id="2508106">WaitStatus</span><span class="op" id="2508116">(</span><span class="ident" id="2508117">status</span><span class="op" id="2508123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508129">return</span><br>
<span class="lineno"></span><span class="op" id="2508136">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2508139">func</span>&nbsp;<span class="ident" id="2508144">Mkfifo</span><span class="op" id="2508150">(</span><span class="ident" id="2508151">path</span>&nbsp;<span class="builtintype" id="2508156">string</span><span class="op" id="2508162">,</span>&nbsp;<span class="ident" id="2508164">mode</span>&nbsp;<span class="builtintype" id="2508169">uint32</span><span class="op" id="2508175">)</span>&nbsp;<span class="op" id="2508177">(</span><span class="ident" id="2508178">err</span>&nbsp;<span class="builtintype" id="2508182">error</span><span class="op" id="2508187">)</span>&nbsp;<span class="op" id="2508189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508192">return</span>&nbsp;<span class="ident" id="2508199">Mknod</span><span class="op" id="2508204">(</span><span class="ident" id="2508205">path</span><span class="op" id="2508209">,</span>&nbsp;<span class="ident" id="2508211">mode</span><span class="op" id="2508215">|</span><span class="ident" id="2508216">S_IFIFO</span><span class="op" id="2508223">,</span>&nbsp;<span class="num" id="2508225">0</span><span class="op" id="2508226">)</span><br>
<span class="lineno"></span><span class="op" id="2508228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2508231">func</span>&nbsp;<span class="op" id="2508236">(</span><span class="ident" id="2508237">sa</span>&nbsp;<span class="op" id="2508240">*</span><span class="ident" id="2508241">SockaddrInet4</span><span class="op" id="2508254">)</span>&nbsp;<span class="ident" id="2508256">sockaddr</span><span class="op" id="2508264">(</span><span class="op" id="2508265">)</span>&nbsp;<span class="op" id="2508267">(</span><span class="ident" id="2508268">unsafe</span><span class="op" id="2508274">.</span><span class="ident" id="2508275">Pointer</span><span class="op" id="2508282">,</span>&nbsp;<span class="ident" id="2508284">_Socklen</span><span class="op" id="2508292">,</span>&nbsp;<span class="builtintype" id="2508294">error</span><span class="op" id="2508299">)</span>&nbsp;<span class="op" id="2508301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508304">if</span>&nbsp;<span class="ident" id="2508307">sa</span><span class="op" id="2508309">.</span><span class="ident" id="2508310">Port</span>&nbsp;<span class="op" id="2508315">&lt;</span>&nbsp;<span class="num" id="2508317">0</span>&nbsp;<span class="op" id="2508319">||</span>&nbsp;<span class="ident" id="2508322">sa</span><span class="op" id="2508324">.</span><span class="ident" id="2508325">Port</span>&nbsp;<span class="op" id="2508330">&gt;</span>&nbsp;<span class="num" id="2508332">0xFFFF</span>&nbsp;<span class="op" id="2508339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508343">return</span>&nbsp;<span class="builtintype" id="2508350">nil</span><span class="op" id="2508353">,</span>&nbsp;<span class="num" id="2508355">0</span><span class="op" id="2508356">,</span>&nbsp;<span class="ident" id="2508358">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508369">sa</span><span class="op" id="2508371">.</span><span class="ident" id="2508372">raw</span><span class="op" id="2508375">.</span><span class="ident" id="2508376">Family</span>&nbsp;<span class="op" id="2508383">=</span>&nbsp;<span class="ident" id="2508385">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508394">p</span>&nbsp;<span class="op" id="2508396">:=</span>&nbsp;<span class="op" id="2508399">(</span><span class="op" id="2508400">*</span><span class="op" id="2508401">[</span><span class="num" id="2508402">2</span><span class="op" id="2508403">]</span><span class="builtintype" id="2508404">byte</span><span class="op" id="2508408">)</span><span class="op" id="2508409">(</span><span class="ident" id="2508410">unsafe</span><span class="op" id="2508416">.</span><span class="ident" id="2508417">Pointer</span><span class="op" id="2508424">(</span><span class="op" id="2508425">&amp;</span><span class="ident" id="2508426">sa</span><span class="op" id="2508428">.</span><span class="ident" id="2508429">raw</span><span class="op" id="2508432">.</span><span class="ident" id="2508433">Port</span><span class="op" id="2508437">)</span><span class="op" id="2508438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508441">p</span><span class="op" id="2508442">[</span><span class="num" id="2508443">0</span><span class="op" id="2508444">]</span>&nbsp;<span class="op" id="2508446">=</span>&nbsp;<span class="builtintype" id="2508448">byte</span><span class="op" id="2508452">(</span><span class="ident" id="2508453">sa</span><span class="op" id="2508455">.</span><span class="ident" id="2508456">Port</span>&nbsp;<span class="op" id="2508461">&gt;&gt;</span>&nbsp;<span class="num" id="2508464">8</span><span class="op" id="2508465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508468">p</span><span class="op" id="2508469">[</span><span class="num" id="2508470">1</span><span class="op" id="2508471">]</span>&nbsp;<span class="op" id="2508473">=</span>&nbsp;<span class="builtintype" id="2508475">byte</span><span class="op" id="2508479">(</span><span class="ident" id="2508480">sa</span><span class="op" id="2508482">.</span><span class="ident" id="2508483">Port</span><span class="op" id="2508487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508490">for</span>&nbsp;<span class="ident" id="2508494">i</span>&nbsp;<span class="op" id="2508496">:=</span>&nbsp;<span class="num" id="2508499">0</span><span class="op" id="2508500">;</span>&nbsp;<span class="ident" id="2508502">i</span>&nbsp;<span class="op" id="2508504">&lt;</span>&nbsp;<span class="builtinfunc" id="2508506">len</span><span class="op" id="2508509">(</span><span class="ident" id="2508510">sa</span><span class="op" id="2508512">.</span><span class="ident" id="2508513">Addr</span><span class="op" id="2508517">)</span><span class="op" id="2508518">;</span>&nbsp;<span class="ident" id="2508520">i</span><span class="op" id="2508521">++</span>&nbsp;<span class="op" id="2508524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508528">sa</span><span class="op" id="2508530">.</span><span class="ident" id="2508531">raw</span><span class="op" id="2508534">.</span><span class="ident" id="2508535">Addr</span><span class="op" id="2508539">[</span><span class="ident" id="2508540">i</span><span class="op" id="2508541">]</span>&nbsp;<span class="op" id="2508543">=</span>&nbsp;<span class="ident" id="2508545">sa</span><span class="op" id="2508547">.</span><span class="ident" id="2508548">Addr</span><span class="op" id="2508552">[</span><span class="ident" id="2508553">i</span><span class="op" id="2508554">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508560">return</span>&nbsp;<span class="ident" id="2508567">unsafe</span><span class="op" id="2508573">.</span><span class="ident" id="2508574">Pointer</span><span class="op" id="2508581">(</span><span class="op" id="2508582">&amp;</span><span class="ident" id="2508583">sa</span><span class="op" id="2508585">.</span><span class="ident" id="2508586">raw</span><span class="op" id="2508589">)</span><span class="op" id="2508590">,</span>&nbsp;<span class="ident" id="2508592">SizeofSockaddrInet4</span><span class="op" id="2508611">,</span>&nbsp;<span class="builtintype" id="2508613">nil</span><br>
<span class="lineno"></span><span class="op" id="2508617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2508620">func</span>&nbsp;<span class="op" id="2508625">(</span><span class="ident" id="2508626">sa</span>&nbsp;<span class="op" id="2508629">*</span><span class="ident" id="2508630">SockaddrInet6</span><span class="op" id="2508643">)</span>&nbsp;<span class="ident" id="2508645">sockaddr</span><span class="op" id="2508653">(</span><span class="op" id="2508654">)</span>&nbsp;<span class="op" id="2508656">(</span><span class="ident" id="2508657">unsafe</span><span class="op" id="2508663">.</span><span class="ident" id="2508664">Pointer</span><span class="op" id="2508671">,</span>&nbsp;<span class="ident" id="2508673">_Socklen</span><span class="op" id="2508681">,</span>&nbsp;<span class="builtintype" id="2508683">error</span><span class="op" id="2508688">)</span>&nbsp;<span class="op" id="2508690">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508693">if</span>&nbsp;<span class="ident" id="2508696">sa</span><span class="op" id="2508698">.</span><span class="ident" id="2508699">Port</span>&nbsp;<span class="op" id="2508704">&lt;</span>&nbsp;<span class="num" id="2508706">0</span>&nbsp;<span class="op" id="2508708">||</span>&nbsp;<span class="ident" id="2508711">sa</span><span class="op" id="2508713">.</span><span class="ident" id="2508714">Port</span>&nbsp;<span class="op" id="2508719">&gt;</span>&nbsp;<span class="num" id="2508721">0xFFFF</span>&nbsp;<span class="op" id="2508728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508732">return</span>&nbsp;<span class="builtintype" id="2508739">nil</span><span class="op" id="2508742">,</span>&nbsp;<span class="num" id="2508744">0</span><span class="op" id="2508745">,</span>&nbsp;<span class="ident" id="2508747">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508758">sa</span><span class="op" id="2508760">.</span><span class="ident" id="2508761">raw</span><span class="op" id="2508764">.</span><span class="ident" id="2508765">Family</span>&nbsp;<span class="op" id="2508772">=</span>&nbsp;<span class="ident" id="2508774">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508784">p</span>&nbsp;<span class="op" id="2508786">:=</span>&nbsp;<span class="op" id="2508789">(</span><span class="op" id="2508790">*</span><span class="op" id="2508791">[</span><span class="num" id="2508792">2</span><span class="op" id="2508793">]</span><span class="builtintype" id="2508794">byte</span><span class="op" id="2508798">)</span><span class="op" id="2508799">(</span><span class="ident" id="2508800">unsafe</span><span class="op" id="2508806">.</span><span class="ident" id="2508807">Pointer</span><span class="op" id="2508814">(</span><span class="op" id="2508815">&amp;</span><span class="ident" id="2508816">sa</span><span class="op" id="2508818">.</span><span class="ident" id="2508819">raw</span><span class="op" id="2508822">.</span><span class="ident" id="2508823">Port</span><span class="op" id="2508827">)</span><span class="op" id="2508828">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508831">p</span><span class="op" id="2508832">[</span><span class="num" id="2508833">0</span><span class="op" id="2508834">]</span>&nbsp;<span class="op" id="2508836">=</span>&nbsp;<span class="builtintype" id="2508838">byte</span><span class="op" id="2508842">(</span><span class="ident" id="2508843">sa</span><span class="op" id="2508845">.</span><span class="ident" id="2508846">Port</span>&nbsp;<span class="op" id="2508851">&gt;&gt;</span>&nbsp;<span class="num" id="2508854">8</span><span class="op" id="2508855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508858">p</span><span class="op" id="2508859">[</span><span class="num" id="2508860">1</span><span class="op" id="2508861">]</span>&nbsp;<span class="op" id="2508863">=</span>&nbsp;<span class="builtintype" id="2508865">byte</span><span class="op" id="2508869">(</span><span class="ident" id="2508870">sa</span><span class="op" id="2508872">.</span><span class="ident" id="2508873">Port</span><span class="op" id="2508877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508880">sa</span><span class="op" id="2508882">.</span><span class="ident" id="2508883">raw</span><span class="op" id="2508886">.</span><span class="ident" id="2508887">Scope_id</span>&nbsp;<span class="op" id="2508896">=</span>&nbsp;<span class="ident" id="2508898">sa</span><span class="op" id="2508900">.</span><span class="ident" id="2508901">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508909">for</span>&nbsp;<span class="ident" id="2508913">i</span>&nbsp;<span class="op" id="2508915">:=</span>&nbsp;<span class="num" id="2508918">0</span><span class="op" id="2508919">;</span>&nbsp;<span class="ident" id="2508921">i</span>&nbsp;<span class="op" id="2508923">&lt;</span>&nbsp;<span class="builtinfunc" id="2508925">len</span><span class="op" id="2508928">(</span><span class="ident" id="2508929">sa</span><span class="op" id="2508931">.</span><span class="ident" id="2508932">Addr</span><span class="op" id="2508936">)</span><span class="op" id="2508937">;</span>&nbsp;<span class="ident" id="2508939">i</span><span class="op" id="2508940">++</span>&nbsp;<span class="op" id="2508943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508947">sa</span><span class="op" id="2508949">.</span><span class="ident" id="2508950">raw</span><span class="op" id="2508953">.</span><span class="ident" id="2508954">Addr</span><span class="op" id="2508958">[</span><span class="ident" id="2508959">i</span><span class="op" id="2508960">]</span>&nbsp;<span class="op" id="2508962">=</span>&nbsp;<span class="ident" id="2508964">sa</span><span class="op" id="2508966">.</span><span class="ident" id="2508967">Addr</span><span class="op" id="2508971">[</span><span class="ident" id="2508972">i</span><span class="op" id="2508973">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508979">return</span>&nbsp;<span class="ident" id="2508986">unsafe</span><span class="op" id="2508992">.</span><span class="ident" id="2508993">Pointer</span><span class="op" id="2509000">(</span><span class="op" id="2509001">&amp;</span><span class="ident" id="2509002">sa</span><span class="op" id="2509004">.</span><span class="ident" id="2509005">raw</span><span class="op" id="2509008">)</span><span class="op" id="2509009">,</span>&nbsp;<span class="ident" id="2509011">SizeofSockaddrInet6</span><span class="op" id="2509030">,</span>&nbsp;<span class="builtintype" id="2509032">nil</span><br>
<span class="lineno"></span><span class="op" id="2509036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2509039">func</span>&nbsp;<span class="op" id="2509044">(</span><span class="ident" id="2509045">sa</span>&nbsp;<span class="op" id="2509048">*</span><span class="ident" id="2509049">SockaddrUnix</span><span class="op" id="2509061">)</span>&nbsp;<span class="ident" id="2509063">sockaddr</span><span class="op" id="2509071">(</span><span class="op" id="2509072">)</span>&nbsp;<span class="op" id="2509074">(</span><span class="ident" id="2509075">unsafe</span><span class="op" id="2509081">.</span><span class="ident" id="2509082">Pointer</span><span class="op" id="2509089">,</span>&nbsp;<span class="ident" id="2509091">_Socklen</span><span class="op" id="2509099">,</span>&nbsp;<span class="builtintype" id="2509101">error</span><span class="op" id="2509106">)</span>&nbsp;<span class="op" id="2509108">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509111">name</span>&nbsp;<span class="op" id="2509116">:=</span>&nbsp;<span class="ident" id="2509119">sa</span><span class="op" id="2509121">.</span><span class="ident" id="2509122">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509128">n</span>&nbsp;<span class="op" id="2509130">:=</span>&nbsp;<span class="builtinfunc" id="2509133">len</span><span class="op" id="2509136">(</span><span class="ident" id="2509137">name</span><span class="op" id="2509141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2509144">if</span>&nbsp;<span class="ident" id="2509147">n</span>&nbsp;<span class="op" id="2509149">&gt;=</span>&nbsp;<span class="builtinfunc" id="2509152">len</span><span class="op" id="2509155">(</span><span class="ident" id="2509156">sa</span><span class="op" id="2509158">.</span><span class="ident" id="2509159">raw</span><span class="op" id="2509162">.</span><span class="ident" id="2509163">Path</span><span class="op" id="2509167">)</span>&nbsp;<span class="op" id="2509169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2509173">return</span>&nbsp;<span class="builtintype" id="2509180">nil</span><span class="op" id="2509183">,</span>&nbsp;<span class="num" id="2509185">0</span><span class="op" id="2509186">,</span>&nbsp;<span class="ident" id="2509188">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509196">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509199">sa</span><span class="op" id="2509201">.</span><span class="ident" id="2509202">raw</span><span class="op" id="2509205">.</span><span class="ident" id="2509206">Family</span>&nbsp;<span class="op" id="2509213">=</span>&nbsp;<span class="ident" id="2509215">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2509224">for</span>&nbsp;<span class="ident" id="2509228">i</span>&nbsp;<span class="op" id="2509230">:=</span>&nbsp;<span class="num" id="2509233">0</span><span class="op" id="2509234">;</span>&nbsp;<span class="ident" id="2509236">i</span>&nbsp;<span class="op" id="2509238">&lt;</span>&nbsp;<span class="ident" id="2509240">n</span><span class="op" id="2509241">;</span>&nbsp;<span class="ident" id="2509243">i</span><span class="op" id="2509244">++</span>&nbsp;<span class="op" id="2509247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509251">sa</span><span class="op" id="2509253">.</span><span class="ident" id="2509254">raw</span><span class="op" id="2509257">.</span><span class="ident" id="2509258">Path</span><span class="op" id="2509262">[</span><span class="ident" id="2509263">i</span><span class="op" id="2509264">]</span>&nbsp;<span class="op" id="2509266">=</span>&nbsp;<span class="builtintype" id="2509268">int8</span><span class="op" id="2509272">(</span><span class="ident" id="2509273">name</span><span class="op" id="2509277">[</span><span class="ident" id="2509278">i</span><span class="op" id="2509279">]</span><span class="op" id="2509280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2509286">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509328">sl</span>&nbsp;<span class="op" id="2509331">:=</span>&nbsp;<span class="ident" id="2509334">_Socklen</span><span class="op" id="2509342">(</span><span class="num" id="2509343">2</span><span class="op" id="2509344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2509347">if</span>&nbsp;<span class="ident" id="2509350">n</span>&nbsp;<span class="op" id="2509352">&gt;</span>&nbsp;<span class="num" id="2509354">0</span>&nbsp;<span class="op" id="2509356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509360">sl</span>&nbsp;<span class="op" id="2509363">+=</span>&nbsp;<span class="ident" id="2509366">_Socklen</span><span class="op" id="2509374">(</span><span class="ident" id="2509375">n</span><span class="op" id="2509376">)</span>&nbsp;<span class="op" id="2509378">+</span>&nbsp;<span class="num" id="2509380">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2509386">if</span>&nbsp;<span class="ident" id="2509389">sa</span><span class="op" id="2509391">.</span><span class="ident" id="2509392">raw</span><span class="op" id="2509395">.</span><span class="ident" id="2509396">Path</span><span class="op" id="2509400">[</span><span class="num" id="2509401">0</span><span class="op" id="2509402">]</span>&nbsp;<span class="op" id="2509404">==</span>&nbsp;<span class="string" id="2509407">&#39;@&#39;</span>&nbsp;<span class="op" id="2509411">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509415">sa</span><span class="op" id="2509417">.</span><span class="ident" id="2509418">raw</span><span class="op" id="2509421">.</span><span class="ident" id="2509422">Path</span><span class="op" id="2509426">[</span><span class="num" id="2509427">0</span><span class="op" id="2509428">]</span>&nbsp;<span class="op" id="2509430">=</span>&nbsp;<span class="num" id="2509432">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2509436">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509488">sl</span><span class="op" id="2509490">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2509498">return</span>&nbsp;<span class="ident" id="2509505">unsafe</span><span class="op" id="2509511">.</span><span class="ident" id="2509512">Pointer</span><span class="op" id="2509519">(</span><span class="op" id="2509520">&amp;</span><span class="ident" id="2509521">sa</span><span class="op" id="2509523">.</span><span class="ident" id="2509524">raw</span><span class="op" id="2509527">)</span><span class="op" id="2509528">,</span>&nbsp;<span class="ident" id="2509530">sl</span><span class="op" id="2509532">,</span>&nbsp;<span class="builtintype" id="2509534">nil</span><br>
<span class="lineno"></span><span class="op" id="2509538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2509541">type</span>&nbsp;<span class="ident" id="2509546">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2509564">struct</span>&nbsp;<span class="op" id="2509571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509574">Protocol</span>&nbsp;<span class="builtintype" id="2509583">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509591">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2509600">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509605">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2509614">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509622">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2509631">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509638">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2509647">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509654">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509663">[</span><span class="num" id="2509664">8</span><span class="op" id="2509665">]</span><span class="builtintype" id="2509666">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509672">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509681">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2509702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2509705">func</span>&nbsp;<span class="op" id="2509710">(</span><span class="ident" id="2509711">sa</span>&nbsp;<span class="op" id="2509714">*</span><span class="ident" id="2509715">SockaddrLinklayer</span><span class="op" id="2509732">)</span>&nbsp;<span class="ident" id="2509734">sockaddr</span><span class="op" id="2509742">(</span><span class="op" id="2509743">)</span>&nbsp;<span class="op" id="2509745">(</span><span class="ident" id="2509746">unsafe</span><span class="op" id="2509752">.</span><span class="ident" id="2509753">Pointer</span><span class="op" id="2509760">,</span>&nbsp;<span class="ident" id="2509762">_Socklen</span><span class="op" id="2509770">,</span>&nbsp;<span class="builtintype" id="2509772">error</span><span class="op" id="2509777">)</span>&nbsp;<span class="op" id="2509779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2509782">if</span>&nbsp;<span class="ident" id="2509785">sa</span><span class="op" id="2509787">.</span><span class="ident" id="2509788">Ifindex</span>&nbsp;<span class="op" id="2509796">&lt;</span>&nbsp;<span class="num" id="2509798">0</span>&nbsp;<span class="op" id="2509800">||</span>&nbsp;<span class="ident" id="2509803">sa</span><span class="op" id="2509805">.</span><span class="ident" id="2509806">Ifindex</span>&nbsp;<span class="op" id="2509814">&gt;</span>&nbsp;<span class="num" id="2509816">0x7fffffff</span>&nbsp;<span class="op" id="2509827">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2509831">return</span>&nbsp;<span class="builtintype" id="2509838">nil</span><span class="op" id="2509841">,</span>&nbsp;<span class="num" id="2509843">0</span><span class="op" id="2509844">,</span>&nbsp;<span class="ident" id="2509846">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509857">sa</span><span class="op" id="2509859">.</span><span class="ident" id="2509860">raw</span><span class="op" id="2509863">.</span><span class="ident" id="2509864">Family</span>&nbsp;<span class="op" id="2509871">=</span>&nbsp;<span class="ident" id="2509873">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509884">sa</span><span class="op" id="2509886">.</span><span class="ident" id="2509887">raw</span><span class="op" id="2509890">.</span><span class="ident" id="2509891">Protocol</span>&nbsp;<span class="op" id="2509900">=</span>&nbsp;<span class="ident" id="2509902">sa</span><span class="op" id="2509904">.</span><span class="ident" id="2509905">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509915">sa</span><span class="op" id="2509917">.</span><span class="ident" id="2509918">raw</span><span class="op" id="2509921">.</span><span class="ident" id="2509922">Ifindex</span>&nbsp;<span class="op" id="2509930">=</span>&nbsp;<span class="builtintype" id="2509932">int32</span><span class="op" id="2509937">(</span><span class="ident" id="2509938">sa</span><span class="op" id="2509940">.</span><span class="ident" id="2509941">Ifindex</span><span class="op" id="2509948">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509951">sa</span><span class="op" id="2509953">.</span><span class="ident" id="2509954">raw</span><span class="op" id="2509957">.</span><span class="ident" id="2509958">Hatype</span>&nbsp;<span class="op" id="2509965">=</span>&nbsp;<span class="ident" id="2509967">sa</span><span class="op" id="2509969">.</span><span class="ident" id="2509970">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2509978">sa</span><span class="op" id="2509980">.</span><span class="ident" id="2509981">raw</span><span class="op" id="2509984">.</span><span class="ident" id="2509985">Pkttype</span>&nbsp;<span class="op" id="2509993">=</span>&nbsp;<span class="ident" id="2509995">sa</span><span class="op" id="2509997">.</span><span class="ident" id="2509998">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510007">sa</span><span class="op" id="2510009">.</span><span class="ident" id="2510010">raw</span><span class="op" id="2510013">.</span><span class="ident" id="2510014">Halen</span>&nbsp;<span class="op" id="2510020">=</span>&nbsp;<span class="ident" id="2510022">sa</span><span class="op" id="2510024">.</span><span class="ident" id="2510025">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2510032">for</span>&nbsp;<span class="ident" id="2510036">i</span>&nbsp;<span class="op" id="2510038">:=</span>&nbsp;<span class="num" id="2510041">0</span><span class="op" id="2510042">;</span>&nbsp;<span class="ident" id="2510044">i</span>&nbsp;<span class="op" id="2510046">&lt;</span>&nbsp;<span class="builtinfunc" id="2510048">len</span><span class="op" id="2510051">(</span><span class="ident" id="2510052">sa</span><span class="op" id="2510054">.</span><span class="ident" id="2510055">Addr</span><span class="op" id="2510059">)</span><span class="op" id="2510060">;</span>&nbsp;<span class="ident" id="2510062">i</span><span class="op" id="2510063">++</span>&nbsp;<span class="op" id="2510066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510070">sa</span><span class="op" id="2510072">.</span><span class="ident" id="2510073">raw</span><span class="op" id="2510076">.</span><span class="ident" id="2510077">Addr</span><span class="op" id="2510081">[</span><span class="ident" id="2510082">i</span><span class="op" id="2510083">]</span>&nbsp;<span class="op" id="2510085">=</span>&nbsp;<span class="ident" id="2510087">sa</span><span class="op" id="2510089">.</span><span class="ident" id="2510090">Addr</span><span class="op" id="2510094">[</span><span class="ident" id="2510095">i</span><span class="op" id="2510096">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2510099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2510102">return</span>&nbsp;<span class="ident" id="2510109">unsafe</span><span class="op" id="2510115">.</span><span class="ident" id="2510116">Pointer</span><span class="op" id="2510123">(</span><span class="op" id="2510124">&amp;</span><span class="ident" id="2510125">sa</span><span class="op" id="2510127">.</span><span class="ident" id="2510128">raw</span><span class="op" id="2510131">)</span><span class="op" id="2510132">,</span>&nbsp;<span class="ident" id="2510134">SizeofSockaddrLinklayer</span><span class="op" id="2510157">,</span>&nbsp;<span class="builtintype" id="2510159">nil</span><br>
<span class="lineno"></span><span class="op" id="2510163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2510166">type</span>&nbsp;<span class="ident" id="2510171">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2510187">struct</span>&nbsp;<span class="op" id="2510194">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510197">Family</span>&nbsp;<span class="builtintype" id="2510204">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510212">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2510219">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510227">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2510234">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510242">Groups</span>&nbsp;<span class="builtintype" id="2510249">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510257">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510264">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2510283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2510286">func</span>&nbsp;<span class="op" id="2510291">(</span><span class="ident" id="2510292">sa</span>&nbsp;<span class="op" id="2510295">*</span><span class="ident" id="2510296">SockaddrNetlink</span><span class="op" id="2510311">)</span>&nbsp;<span class="ident" id="2510313">sockaddr</span><span class="op" id="2510321">(</span><span class="op" id="2510322">)</span>&nbsp;<span class="op" id="2510324">(</span><span class="ident" id="2510325">unsafe</span><span class="op" id="2510331">.</span><span class="ident" id="2510332">Pointer</span><span class="op" id="2510339">,</span>&nbsp;<span class="ident" id="2510341">_Socklen</span><span class="op" id="2510349">,</span>&nbsp;<span class="builtintype" id="2510351">error</span><span class="op" id="2510356">)</span>&nbsp;<span class="op" id="2510358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510361">sa</span><span class="op" id="2510363">.</span><span class="ident" id="2510364">raw</span><span class="op" id="2510367">.</span><span class="ident" id="2510368">Family</span>&nbsp;<span class="op" id="2510375">=</span>&nbsp;<span class="ident" id="2510377">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510389">sa</span><span class="op" id="2510391">.</span><span class="ident" id="2510392">raw</span><span class="op" id="2510395">.</span><span class="ident" id="2510396">Pad</span>&nbsp;<span class="op" id="2510400">=</span>&nbsp;<span class="ident" id="2510402">sa</span><span class="op" id="2510404">.</span><span class="ident" id="2510405">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510410">sa</span><span class="op" id="2510412">.</span><span class="ident" id="2510413">raw</span><span class="op" id="2510416">.</span><span class="ident" id="2510417">Pid</span>&nbsp;<span class="op" id="2510421">=</span>&nbsp;<span class="ident" id="2510423">sa</span><span class="op" id="2510425">.</span><span class="ident" id="2510426">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510431">sa</span><span class="op" id="2510433">.</span><span class="ident" id="2510434">raw</span><span class="op" id="2510437">.</span><span class="ident" id="2510438">Groups</span>&nbsp;<span class="op" id="2510445">=</span>&nbsp;<span class="ident" id="2510447">sa</span><span class="op" id="2510449">.</span><span class="ident" id="2510450">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2510458">return</span>&nbsp;<span class="ident" id="2510465">unsafe</span><span class="op" id="2510471">.</span><span class="ident" id="2510472">Pointer</span><span class="op" id="2510479">(</span><span class="op" id="2510480">&amp;</span><span class="ident" id="2510481">sa</span><span class="op" id="2510483">.</span><span class="ident" id="2510484">raw</span><span class="op" id="2510487">)</span><span class="op" id="2510488">,</span>&nbsp;<span class="ident" id="2510490">SizeofSockaddrNetlink</span><span class="op" id="2510511">,</span>&nbsp;<span class="builtintype" id="2510513">nil</span><br>
<span class="lineno"></span><span class="op" id="2510517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2510520">func</span>&nbsp;<span class="ident" id="2510525">anyToSockaddr</span><span class="op" id="2510538">(</span><span class="ident" id="2510539">rsa</span>&nbsp;<span class="op" id="2510543">*</span><span class="ident" id="2510544">RawSockaddrAny</span><span class="op" id="2510558">)</span>&nbsp;<span class="op" id="2510560">(</span><span class="ident" id="2510561">Sockaddr</span><span class="op" id="2510569">,</span>&nbsp;<span class="builtintype" id="2510571">error</span><span class="op" id="2510576">)</span>&nbsp;<span class="op" id="2510578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2510581">switch</span>&nbsp;<span class="ident" id="2510588">rsa</span><span class="op" id="2510591">.</span><span class="ident" id="2510592">Addr</span><span class="op" id="2510596">.</span><span class="ident" id="2510597">Family</span>&nbsp;<span class="op" id="2510604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2510607">case</span>&nbsp;<span class="ident" id="2510612">AF_NETLINK</span><span class="op" id="2510622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510626">pp</span>&nbsp;<span class="op" id="2510629">:=</span>&nbsp;<span class="op" id="2510632">(</span><span class="op" id="2510633">*</span><span class="ident" id="2510634">RawSockaddrNetlink</span><span class="op" id="2510652">)</span><span class="op" id="2510653">(</span><span class="ident" id="2510654">unsafe</span><span class="op" id="2510660">.</span><span class="ident" id="2510661">Pointer</span><span class="op" id="2510668">(</span><span class="ident" id="2510669">rsa</span><span class="op" id="2510672">)</span><span class="op" id="2510673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510677">sa</span>&nbsp;<span class="op" id="2510680">:=</span>&nbsp;<span class="builtinfunc" id="2510683">new</span><span class="op" id="2510686">(</span><span class="ident" id="2510687">SockaddrNetlink</span><span class="op" id="2510702">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510706">sa</span><span class="op" id="2510708">.</span><span class="ident" id="2510709">Family</span>&nbsp;<span class="op" id="2510716">=</span>&nbsp;<span class="ident" id="2510718">pp</span><span class="op" id="2510720">.</span><span class="ident" id="2510721">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510730">sa</span><span class="op" id="2510732">.</span><span class="ident" id="2510733">Pad</span>&nbsp;<span class="op" id="2510737">=</span>&nbsp;<span class="ident" id="2510739">pp</span><span class="op" id="2510741">.</span><span class="ident" id="2510742">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510748">sa</span><span class="op" id="2510750">.</span><span class="ident" id="2510751">Pid</span>&nbsp;<span class="op" id="2510755">=</span>&nbsp;<span class="ident" id="2510757">pp</span><span class="op" id="2510759">.</span><span class="ident" id="2510760">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510766">sa</span><span class="op" id="2510768">.</span><span class="ident" id="2510769">Groups</span>&nbsp;<span class="op" id="2510776">=</span>&nbsp;<span class="ident" id="2510778">pp</span><span class="op" id="2510780">.</span><span class="ident" id="2510781">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2510790">return</span>&nbsp;<span class="ident" id="2510797">sa</span><span class="op" id="2510799">,</span>&nbsp;<span class="builtintype" id="2510801">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2510807">case</span>&nbsp;<span class="ident" id="2510812">AF_PACKET</span><span class="op" id="2510821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510825">pp</span>&nbsp;<span class="op" id="2510828">:=</span>&nbsp;<span class="op" id="2510831">(</span><span class="op" id="2510832">*</span><span class="ident" id="2510833">RawSockaddrLinklayer</span><span class="op" id="2510853">)</span><span class="op" id="2510854">(</span><span class="ident" id="2510855">unsafe</span><span class="op" id="2510861">.</span><span class="ident" id="2510862">Pointer</span><span class="op" id="2510869">(</span><span class="ident" id="2510870">rsa</span><span class="op" id="2510873">)</span><span class="op" id="2510874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510878">sa</span>&nbsp;<span class="op" id="2510881">:=</span>&nbsp;<span class="builtinfunc" id="2510884">new</span><span class="op" id="2510887">(</span><span class="ident" id="2510888">SockaddrLinklayer</span><span class="op" id="2510905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510909">sa</span><span class="op" id="2510911">.</span><span class="ident" id="2510912">Protocol</span>&nbsp;<span class="op" id="2510921">=</span>&nbsp;<span class="ident" id="2510923">pp</span><span class="op" id="2510925">.</span><span class="ident" id="2510926">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510937">sa</span><span class="op" id="2510939">.</span><span class="ident" id="2510940">Ifindex</span>&nbsp;<span class="op" id="2510948">=</span>&nbsp;<span class="builtintype" id="2510950">int</span><span class="op" id="2510953">(</span><span class="ident" id="2510954">pp</span><span class="op" id="2510956">.</span><span class="ident" id="2510957">Ifindex</span><span class="op" id="2510964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510968">sa</span><span class="op" id="2510970">.</span><span class="ident" id="2510971">Hatype</span>&nbsp;<span class="op" id="2510978">=</span>&nbsp;<span class="ident" id="2510980">pp</span><span class="op" id="2510982">.</span><span class="ident" id="2510983">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2510992">sa</span><span class="op" id="2510994">.</span><span class="ident" id="2510995">Pkttype</span>&nbsp;<span class="op" id="2511003">=</span>&nbsp;<span class="ident" id="2511005">pp</span><span class="op" id="2511007">.</span><span class="ident" id="2511008">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511018">sa</span><span class="op" id="2511020">.</span><span class="ident" id="2511021">Halen</span>&nbsp;<span class="op" id="2511027">=</span>&nbsp;<span class="ident" id="2511029">pp</span><span class="op" id="2511031">.</span><span class="ident" id="2511032">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2511040">for</span>&nbsp;<span class="ident" id="2511044">i</span>&nbsp;<span class="op" id="2511046">:=</span>&nbsp;<span class="num" id="2511049">0</span><span class="op" id="2511050">;</span>&nbsp;<span class="ident" id="2511052">i</span>&nbsp;<span class="op" id="2511054">&lt;</span>&nbsp;<span class="builtinfunc" id="2511056">len</span><span class="op" id="2511059">(</span><span class="ident" id="2511060">sa</span><span class="op" id="2511062">.</span><span class="ident" id="2511063">Addr</span><span class="op" id="2511067">)</span><span class="op" id="2511068">;</span>&nbsp;<span class="ident" id="2511070">i</span><span class="op" id="2511071">++</span>&nbsp;<span class="op" id="2511074">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511079">sa</span><span class="op" id="2511081">.</span><span class="ident" id="2511082">Addr</span><span class="op" id="2511086">[</span><span class="ident" id="2511087">i</span><span class="op" id="2511088">]</span>&nbsp;<span class="op" id="2511090">=</span>&nbsp;<span class="ident" id="2511092">pp</span><span class="op" id="2511094">.</span><span class="ident" id="2511095">Addr</span><span class="op" id="2511099">[</span><span class="ident" id="2511100">i</span><span class="op" id="2511101">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2511105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2511109">return</span>&nbsp;<span class="ident" id="2511116">sa</span><span class="op" id="2511118">,</span>&nbsp;<span class="builtintype" id="2511120">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2511126">case</span>&nbsp;<span class="ident" id="2511131">AF_UNIX</span><span class="op" id="2511138">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511142">pp</span>&nbsp;<span class="op" id="2511145">:=</span>&nbsp;<span class="op" id="2511148">(</span><span class="op" id="2511149">*</span><span class="ident" id="2511150">RawSockaddrUnix</span><span class="op" id="2511165">)</span><span class="op" id="2511166">(</span><span class="ident" id="2511167">unsafe</span><span class="op" id="2511173">.</span><span class="ident" id="2511174">Pointer</span><span class="op" id="2511181">(</span><span class="ident" id="2511182">rsa</span><span class="op" id="2511185">)</span><span class="op" id="2511186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511190">sa</span>&nbsp;<span class="op" id="2511193">:=</span>&nbsp;<span class="builtinfunc" id="2511196">new</span><span class="op" id="2511199">(</span><span class="ident" id="2511200">SockaddrUnix</span><span class="op" id="2511212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2511216">if</span>&nbsp;<span class="ident" id="2511219">pp</span><span class="op" id="2511221">.</span><span class="ident" id="2511222">Path</span><span class="op" id="2511226">[</span><span class="num" id="2511227">0</span><span class="op" id="2511228">]</span>&nbsp;<span class="op" id="2511230">==</span>&nbsp;<span class="num" id="2511233">0</span>&nbsp;<span class="op" id="2511235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511240">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511277">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511329">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511370">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511412">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511452">pp</span><span class="op" id="2511454">.</span><span class="ident" id="2511455">Path</span><span class="op" id="2511459">[</span><span class="num" id="2511460">0</span><span class="op" id="2511461">]</span>&nbsp;<span class="op" id="2511463">=</span>&nbsp;<span class="string" id="2511465">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2511471">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511476">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511506">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511559">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511612">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2511666">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511702">n</span>&nbsp;<span class="op" id="2511704">:=</span>&nbsp;<span class="num" id="2511707">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2511711">for</span>&nbsp;<span class="ident" id="2511715">n</span>&nbsp;<span class="op" id="2511717">&lt;</span>&nbsp;<span class="builtinfunc" id="2511719">len</span><span class="op" id="2511722">(</span><span class="ident" id="2511723">pp</span><span class="op" id="2511725">.</span><span class="ident" id="2511726">Path</span><span class="op" id="2511730">)</span>&nbsp;<span class="op" id="2511732">&amp;&amp;</span>&nbsp;<span class="ident" id="2511735">pp</span><span class="op" id="2511737">.</span><span class="ident" id="2511738">Path</span><span class="op" id="2511742">[</span><span class="ident" id="2511743">n</span><span class="op" id="2511744">]</span>&nbsp;<span class="op" id="2511746">!=</span>&nbsp;<span class="num" id="2511749">0</span>&nbsp;<span class="op" id="2511751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511756">n</span><span class="op" id="2511757">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2511762">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511766">bytes</span>&nbsp;<span class="op" id="2511772">:=</span>&nbsp;<span class="op" id="2511775">(</span><span class="op" id="2511776">*</span><span class="op" id="2511777">[</span><span class="num" id="2511778">10000</span><span class="op" id="2511783">]</span><span class="builtintype" id="2511784">byte</span><span class="op" id="2511788">)</span><span class="op" id="2511789">(</span><span class="ident" id="2511790">unsafe</span><span class="op" id="2511796">.</span><span class="ident" id="2511797">Pointer</span><span class="op" id="2511804">(</span><span class="op" id="2511805">&amp;</span><span class="ident" id="2511806">pp</span><span class="op" id="2511808">.</span><span class="ident" id="2511809">Path</span><span class="op" id="2511813">[</span><span class="num" id="2511814">0</span><span class="op" id="2511815">]</span><span class="op" id="2511816">)</span><span class="op" id="2511817">)</span><span class="op" id="2511818">[</span><span class="num" id="2511819">0</span><span class="op" id="2511820">:</span><span class="ident" id="2511821">n</span><span class="op" id="2511822">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511826">sa</span><span class="op" id="2511828">.</span><span class="ident" id="2511829">Name</span>&nbsp;<span class="op" id="2511834">=</span>&nbsp;<span class="builtintype" id="2511836">string</span><span class="op" id="2511842">(</span><span class="ident" id="2511843">bytes</span><span class="op" id="2511848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2511852">return</span>&nbsp;<span class="ident" id="2511859">sa</span><span class="op" id="2511861">,</span>&nbsp;<span class="builtintype" id="2511863">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2511869">case</span>&nbsp;<span class="ident" id="2511874">AF_INET</span><span class="op" id="2511881">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511885">pp</span>&nbsp;<span class="op" id="2511888">:=</span>&nbsp;<span class="op" id="2511891">(</span><span class="op" id="2511892">*</span><span class="ident" id="2511893">RawSockaddrInet4</span><span class="op" id="2511909">)</span><span class="op" id="2511910">(</span><span class="ident" id="2511911">unsafe</span><span class="op" id="2511917">.</span><span class="ident" id="2511918">Pointer</span><span class="op" id="2511925">(</span><span class="ident" id="2511926">rsa</span><span class="op" id="2511929">)</span><span class="op" id="2511930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511934">sa</span>&nbsp;<span class="op" id="2511937">:=</span>&nbsp;<span class="builtinfunc" id="2511940">new</span><span class="op" id="2511943">(</span><span class="ident" id="2511944">SockaddrInet4</span><span class="op" id="2511957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2511961">p</span>&nbsp;<span class="op" id="2511963">:=</span>&nbsp;<span class="op" id="2511966">(</span><span class="op" id="2511967">*</span><span class="op" id="2511968">[</span><span class="num" id="2511969">2</span><span class="op" id="2511970">]</span><span class="builtintype" id="2511971">byte</span><span class="op" id="2511975">)</span><span class="op" id="2511976">(</span><span class="ident" id="2511977">unsafe</span><span class="op" id="2511983">.</span><span class="ident" id="2511984">Pointer</span><span class="op" id="2511991">(</span><span class="op" id="2511992">&amp;</span><span class="ident" id="2511993">pp</span><span class="op" id="2511995">.</span><span class="ident" id="2511996">Port</span><span class="op" id="2512000">)</span><span class="op" id="2512001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512005">sa</span><span class="op" id="2512007">.</span><span class="ident" id="2512008">Port</span>&nbsp;<span class="op" id="2512013">=</span>&nbsp;<span class="builtintype" id="2512015">int</span><span class="op" id="2512018">(</span><span class="ident" id="2512019">p</span><span class="op" id="2512020">[</span><span class="num" id="2512021">0</span><span class="op" id="2512022">]</span><span class="op" id="2512023">)</span><span class="op" id="2512024">&lt;&lt;</span><span class="num" id="2512026">8</span>&nbsp;<span class="op" id="2512028">+</span>&nbsp;<span class="builtintype" id="2512030">int</span><span class="op" id="2512033">(</span><span class="ident" id="2512034">p</span><span class="op" id="2512035">[</span><span class="num" id="2512036">1</span><span class="op" id="2512037">]</span><span class="op" id="2512038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512042">for</span>&nbsp;<span class="ident" id="2512046">i</span>&nbsp;<span class="op" id="2512048">:=</span>&nbsp;<span class="num" id="2512051">0</span><span class="op" id="2512052">;</span>&nbsp;<span class="ident" id="2512054">i</span>&nbsp;<span class="op" id="2512056">&lt;</span>&nbsp;<span class="builtinfunc" id="2512058">len</span><span class="op" id="2512061">(</span><span class="ident" id="2512062">sa</span><span class="op" id="2512064">.</span><span class="ident" id="2512065">Addr</span><span class="op" id="2512069">)</span><span class="op" id="2512070">;</span>&nbsp;<span class="ident" id="2512072">i</span><span class="op" id="2512073">++</span>&nbsp;<span class="op" id="2512076">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512081">sa</span><span class="op" id="2512083">.</span><span class="ident" id="2512084">Addr</span><span class="op" id="2512088">[</span><span class="ident" id="2512089">i</span><span class="op" id="2512090">]</span>&nbsp;<span class="op" id="2512092">=</span>&nbsp;<span class="ident" id="2512094">pp</span><span class="op" id="2512096">.</span><span class="ident" id="2512097">Addr</span><span class="op" id="2512101">[</span><span class="ident" id="2512102">i</span><span class="op" id="2512103">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512111">return</span>&nbsp;<span class="ident" id="2512118">sa</span><span class="op" id="2512120">,</span>&nbsp;<span class="builtintype" id="2512122">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512128">case</span>&nbsp;<span class="ident" id="2512133">AF_INET6</span><span class="op" id="2512141">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512145">pp</span>&nbsp;<span class="op" id="2512148">:=</span>&nbsp;<span class="op" id="2512151">(</span><span class="op" id="2512152">*</span><span class="ident" id="2512153">RawSockaddrInet6</span><span class="op" id="2512169">)</span><span class="op" id="2512170">(</span><span class="ident" id="2512171">unsafe</span><span class="op" id="2512177">.</span><span class="ident" id="2512178">Pointer</span><span class="op" id="2512185">(</span><span class="ident" id="2512186">rsa</span><span class="op" id="2512189">)</span><span class="op" id="2512190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512194">sa</span>&nbsp;<span class="op" id="2512197">:=</span>&nbsp;<span class="builtinfunc" id="2512200">new</span><span class="op" id="2512203">(</span><span class="ident" id="2512204">SockaddrInet6</span><span class="op" id="2512217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512221">p</span>&nbsp;<span class="op" id="2512223">:=</span>&nbsp;<span class="op" id="2512226">(</span><span class="op" id="2512227">*</span><span class="op" id="2512228">[</span><span class="num" id="2512229">2</span><span class="op" id="2512230">]</span><span class="builtintype" id="2512231">byte</span><span class="op" id="2512235">)</span><span class="op" id="2512236">(</span><span class="ident" id="2512237">unsafe</span><span class="op" id="2512243">.</span><span class="ident" id="2512244">Pointer</span><span class="op" id="2512251">(</span><span class="op" id="2512252">&amp;</span><span class="ident" id="2512253">pp</span><span class="op" id="2512255">.</span><span class="ident" id="2512256">Port</span><span class="op" id="2512260">)</span><span class="op" id="2512261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512265">sa</span><span class="op" id="2512267">.</span><span class="ident" id="2512268">Port</span>&nbsp;<span class="op" id="2512273">=</span>&nbsp;<span class="builtintype" id="2512275">int</span><span class="op" id="2512278">(</span><span class="ident" id="2512279">p</span><span class="op" id="2512280">[</span><span class="num" id="2512281">0</span><span class="op" id="2512282">]</span><span class="op" id="2512283">)</span><span class="op" id="2512284">&lt;&lt;</span><span class="num" id="2512286">8</span>&nbsp;<span class="op" id="2512288">+</span>&nbsp;<span class="builtintype" id="2512290">int</span><span class="op" id="2512293">(</span><span class="ident" id="2512294">p</span><span class="op" id="2512295">[</span><span class="num" id="2512296">1</span><span class="op" id="2512297">]</span><span class="op" id="2512298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512302">sa</span><span class="op" id="2512304">.</span><span class="ident" id="2512305">ZoneId</span>&nbsp;<span class="op" id="2512312">=</span>&nbsp;<span class="ident" id="2512314">pp</span><span class="op" id="2512316">.</span><span class="ident" id="2512317">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512328">for</span>&nbsp;<span class="ident" id="2512332">i</span>&nbsp;<span class="op" id="2512334">:=</span>&nbsp;<span class="num" id="2512337">0</span><span class="op" id="2512338">;</span>&nbsp;<span class="ident" id="2512340">i</span>&nbsp;<span class="op" id="2512342">&lt;</span>&nbsp;<span class="builtinfunc" id="2512344">len</span><span class="op" id="2512347">(</span><span class="ident" id="2512348">sa</span><span class="op" id="2512350">.</span><span class="ident" id="2512351">Addr</span><span class="op" id="2512355">)</span><span class="op" id="2512356">;</span>&nbsp;<span class="ident" id="2512358">i</span><span class="op" id="2512359">++</span>&nbsp;<span class="op" id="2512362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512367">sa</span><span class="op" id="2512369">.</span><span class="ident" id="2512370">Addr</span><span class="op" id="2512374">[</span><span class="ident" id="2512375">i</span><span class="op" id="2512376">]</span>&nbsp;<span class="op" id="2512378">=</span>&nbsp;<span class="ident" id="2512380">pp</span><span class="op" id="2512382">.</span><span class="ident" id="2512383">Addr</span><span class="op" id="2512387">[</span><span class="ident" id="2512388">i</span><span class="op" id="2512389">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512397">return</span>&nbsp;<span class="ident" id="2512404">sa</span><span class="op" id="2512406">,</span>&nbsp;<span class="builtintype" id="2512408">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512413">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512416">return</span>&nbsp;<span class="builtintype" id="2512423">nil</span><span class="op" id="2512426">,</span>&nbsp;<span class="ident" id="2512428">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2512441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2512444">func</span>&nbsp;<span class="ident" id="2512449">Accept</span><span class="op" id="2512455">(</span><span class="ident" id="2512456">fd</span>&nbsp;<span class="builtintype" id="2512459">int</span><span class="op" id="2512462">)</span>&nbsp;<span class="op" id="2512464">(</span><span class="ident" id="2512465">nfd</span>&nbsp;<span class="builtintype" id="2512469">int</span><span class="op" id="2512472">,</span>&nbsp;<span class="ident" id="2512474">sa</span>&nbsp;<span class="ident" id="2512477">Sockaddr</span><span class="op" id="2512485">,</span>&nbsp;<span class="ident" id="2512487">err</span>&nbsp;<span class="builtintype" id="2512491">error</span><span class="op" id="2512496">)</span>&nbsp;<span class="op" id="2512498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512501">var</span>&nbsp;<span class="ident" id="2512505">rsa</span>&nbsp;<span class="ident" id="2512509">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512525">var</span>&nbsp;<span class="builtinfunc" id="2512529">len</span>&nbsp;<span class="ident" id="2512533">_Socklen</span>&nbsp;<span class="op" id="2512542">=</span>&nbsp;<span class="ident" id="2512544">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512563">nfd</span><span class="op" id="2512566">,</span>&nbsp;<span class="ident" id="2512568">err</span>&nbsp;<span class="op" id="2512572">=</span>&nbsp;<span class="ident" id="2512574">accept</span><span class="op" id="2512580">(</span><span class="ident" id="2512581">fd</span><span class="op" id="2512583">,</span>&nbsp;<span class="op" id="2512585">&amp;</span><span class="ident" id="2512586">rsa</span><span class="op" id="2512589">,</span>&nbsp;<span class="op" id="2512591">&amp;</span><span class="builtinfunc" id="2512592">len</span><span class="op" id="2512595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512598">if</span>&nbsp;<span class="ident" id="2512601">err</span>&nbsp;<span class="op" id="2512605">!=</span>&nbsp;<span class="builtintype" id="2512608">nil</span>&nbsp;<span class="op" id="2512612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512616">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512624">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512627">sa</span><span class="op" id="2512629">,</span>&nbsp;<span class="ident" id="2512631">err</span>&nbsp;<span class="op" id="2512635">=</span>&nbsp;<span class="ident" id="2512637">anyToSockaddr</span><span class="op" id="2512650">(</span><span class="op" id="2512651">&amp;</span><span class="ident" id="2512652">rsa</span><span class="op" id="2512655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512658">if</span>&nbsp;<span class="ident" id="2512661">err</span>&nbsp;<span class="op" id="2512665">!=</span>&nbsp;<span class="builtintype" id="2512668">nil</span>&nbsp;<span class="op" id="2512672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512676">Close</span><span class="op" id="2512681">(</span><span class="ident" id="2512682">nfd</span><span class="op" id="2512685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512689">nfd</span>&nbsp;<span class="op" id="2512693">=</span>&nbsp;<span class="num" id="2512695">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512698">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512701">return</span><br>
<span class="lineno"></span><span class="op" id="2512708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2512711">func</span>&nbsp;<span class="ident" id="2512716">Accept4</span><span class="op" id="2512723">(</span><span class="ident" id="2512724">fd</span>&nbsp;<span class="builtintype" id="2512727">int</span><span class="op" id="2512730">,</span>&nbsp;<span class="ident" id="2512732">flags</span>&nbsp;<span class="builtintype" id="2512738">int</span><span class="op" id="2512741">)</span>&nbsp;<span class="op" id="2512743">(</span><span class="ident" id="2512744">nfd</span>&nbsp;<span class="builtintype" id="2512748">int</span><span class="op" id="2512751">,</span>&nbsp;<span class="ident" id="2512753">sa</span>&nbsp;<span class="ident" id="2512756">Sockaddr</span><span class="op" id="2512764">,</span>&nbsp;<span class="ident" id="2512766">err</span>&nbsp;<span class="builtintype" id="2512770">error</span><span class="op" id="2512775">)</span>&nbsp;<span class="op" id="2512777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512780">var</span>&nbsp;<span class="ident" id="2512784">rsa</span>&nbsp;<span class="ident" id="2512788">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512804">var</span>&nbsp;<span class="builtinfunc" id="2512808">len</span>&nbsp;<span class="ident" id="2512812">_Socklen</span>&nbsp;<span class="op" id="2512821">=</span>&nbsp;<span class="ident" id="2512823">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512842">nfd</span><span class="op" id="2512845">,</span>&nbsp;<span class="ident" id="2512847">err</span>&nbsp;<span class="op" id="2512851">=</span>&nbsp;<span class="ident" id="2512853">accept4</span><span class="op" id="2512860">(</span><span class="ident" id="2512861">fd</span><span class="op" id="2512863">,</span>&nbsp;<span class="op" id="2512865">&amp;</span><span class="ident" id="2512866">rsa</span><span class="op" id="2512869">,</span>&nbsp;<span class="op" id="2512871">&amp;</span><span class="builtinfunc" id="2512872">len</span><span class="op" id="2512875">,</span>&nbsp;<span class="ident" id="2512877">flags</span><span class="op" id="2512882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512885">if</span>&nbsp;<span class="ident" id="2512888">err</span>&nbsp;<span class="op" id="2512892">!=</span>&nbsp;<span class="builtintype" id="2512895">nil</span>&nbsp;<span class="op" id="2512899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512911">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2512914">if</span>&nbsp;<span class="builtinfunc" id="2512917">len</span>&nbsp;<span class="op" id="2512921">&gt;</span>&nbsp;<span class="ident" id="2512923">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2512941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2512945">panic</span><span class="op" id="2512950">(</span><span class="string" id="2512951">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2512977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2512983">sa</span><span class="op" id="2512985">,</span>&nbsp;<span class="ident" id="2512987">err</span>&nbsp;<span class="op" id="2512991">=</span>&nbsp;<span class="ident" id="2512993">anyToSockaddr</span><span class="op" id="2513006">(</span><span class="op" id="2513007">&amp;</span><span class="ident" id="2513008">rsa</span><span class="op" id="2513011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513014">if</span>&nbsp;<span class="ident" id="2513017">err</span>&nbsp;<span class="op" id="2513021">!=</span>&nbsp;<span class="builtintype" id="2513024">nil</span>&nbsp;<span class="op" id="2513028">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513032">Close</span><span class="op" id="2513037">(</span><span class="ident" id="2513038">nfd</span><span class="op" id="2513041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513045">nfd</span>&nbsp;<span class="op" id="2513049">=</span>&nbsp;<span class="num" id="2513051">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2513054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513057">return</span><br>
<span class="lineno"></span><span class="op" id="2513064">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2513067">func</span>&nbsp;<span class="ident" id="2513072">Getsockname</span><span class="op" id="2513083">(</span><span class="ident" id="2513084">fd</span>&nbsp;<span class="builtintype" id="2513087">int</span><span class="op" id="2513090">)</span>&nbsp;<span class="op" id="2513092">(</span><span class="ident" id="2513093">sa</span>&nbsp;<span class="ident" id="2513096">Sockaddr</span><span class="op" id="2513104">,</span>&nbsp;<span class="ident" id="2513106">err</span>&nbsp;<span class="builtintype" id="2513110">error</span><span class="op" id="2513115">)</span>&nbsp;<span class="op" id="2513117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513120">var</span>&nbsp;<span class="ident" id="2513124">rsa</span>&nbsp;<span class="ident" id="2513128">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513144">var</span>&nbsp;<span class="builtinfunc" id="2513148">len</span>&nbsp;<span class="ident" id="2513152">_Socklen</span>&nbsp;<span class="op" id="2513161">=</span>&nbsp;<span class="ident" id="2513163">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513182">if</span>&nbsp;<span class="ident" id="2513185">err</span>&nbsp;<span class="op" id="2513189">=</span>&nbsp;<span class="ident" id="2513191">getsockname</span><span class="op" id="2513202">(</span><span class="ident" id="2513203">fd</span><span class="op" id="2513205">,</span>&nbsp;<span class="op" id="2513207">&amp;</span><span class="ident" id="2513208">rsa</span><span class="op" id="2513211">,</span>&nbsp;<span class="op" id="2513213">&amp;</span><span class="builtinfunc" id="2513214">len</span><span class="op" id="2513217">)</span><span class="op" id="2513218">;</span>&nbsp;<span class="ident" id="2513220">err</span>&nbsp;<span class="op" id="2513224">!=</span>&nbsp;<span class="builtintype" id="2513227">nil</span>&nbsp;<span class="op" id="2513231">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513235">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2513243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513246">return</span>&nbsp;<span class="ident" id="2513253">anyToSockaddr</span><span class="op" id="2513266">(</span><span class="op" id="2513267">&amp;</span><span class="ident" id="2513268">rsa</span><span class="op" id="2513271">)</span><br>
<span class="lineno"></span><span class="op" id="2513273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2513276">func</span>&nbsp;<span class="ident" id="2513281">GetsockoptInet4Addr</span><span class="op" id="2513300">(</span><span class="ident" id="2513301">fd</span><span class="op" id="2513303">,</span>&nbsp;<span class="ident" id="2513305">level</span><span class="op" id="2513310">,</span>&nbsp;<span class="ident" id="2513312">opt</span>&nbsp;<span class="builtintype" id="2513316">int</span><span class="op" id="2513319">)</span>&nbsp;<span class="op" id="2513321">(</span><span class="ident" id="2513322">value</span>&nbsp;<span class="op" id="2513328">[</span><span class="num" id="2513329">4</span><span class="op" id="2513330">]</span><span class="builtintype" id="2513331">byte</span><span class="op" id="2513335">,</span>&nbsp;<span class="ident" id="2513337">err</span>&nbsp;<span class="builtintype" id="2513341">error</span><span class="op" id="2513346">)</span>&nbsp;<span class="op" id="2513348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513351">vallen</span>&nbsp;<span class="op" id="2513358">:=</span>&nbsp;<span class="ident" id="2513361">_Socklen</span><span class="op" id="2513369">(</span><span class="num" id="2513370">4</span><span class="op" id="2513371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513374">err</span>&nbsp;<span class="op" id="2513378">=</span>&nbsp;<span class="ident" id="2513380">getsockopt</span><span class="op" id="2513390">(</span><span class="ident" id="2513391">fd</span><span class="op" id="2513393">,</span>&nbsp;<span class="ident" id="2513395">level</span><span class="op" id="2513400">,</span>&nbsp;<span class="ident" id="2513402">opt</span><span class="op" id="2513405">,</span>&nbsp;<span class="ident" id="2513407">unsafe</span><span class="op" id="2513413">.</span><span class="ident" id="2513414">Pointer</span><span class="op" id="2513421">(</span><span class="op" id="2513422">&amp;</span><span class="ident" id="2513423">value</span><span class="op" id="2513428">[</span><span class="num" id="2513429">0</span><span class="op" id="2513430">]</span><span class="op" id="2513431">)</span><span class="op" id="2513432">,</span>&nbsp;<span class="op" id="2513434">&amp;</span><span class="ident" id="2513435">vallen</span><span class="op" id="2513441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513444">return</span>&nbsp;<span class="ident" id="2513451">value</span><span class="op" id="2513456">,</span>&nbsp;<span class="ident" id="2513458">err</span><br>
<span class="lineno"></span><span class="op" id="2513462">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2513465">func</span>&nbsp;<span class="ident" id="2513470">GetsockoptIPMreq</span><span class="op" id="2513486">(</span><span class="ident" id="2513487">fd</span><span class="op" id="2513489">,</span>&nbsp;<span class="ident" id="2513491">level</span><span class="op" id="2513496">,</span>&nbsp;<span class="ident" id="2513498">opt</span>&nbsp;<span class="builtintype" id="2513502">int</span><span class="op" id="2513505">)</span>&nbsp;<span class="op" id="2513507">(</span><span class="op" id="2513508">*</span><span class="ident" id="2513509">IPMreq</span><span class="op" id="2513515">,</span>&nbsp;<span class="builtintype" id="2513517">error</span><span class="op" id="2513522">)</span>&nbsp;<span class="op" id="2513524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513527">var</span>&nbsp;<span class="ident" id="2513531">value</span>&nbsp;<span class="ident" id="2513537">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513545">vallen</span>&nbsp;<span class="op" id="2513552">:=</span>&nbsp;<span class="ident" id="2513555">_Socklen</span><span class="op" id="2513563">(</span><span class="ident" id="2513564">SizeofIPMreq</span><span class="op" id="2513576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513579">err</span>&nbsp;<span class="op" id="2513583">:=</span>&nbsp;<span class="ident" id="2513586">getsockopt</span><span class="op" id="2513596">(</span><span class="ident" id="2513597">fd</span><span class="op" id="2513599">,</span>&nbsp;<span class="ident" id="2513601">level</span><span class="op" id="2513606">,</span>&nbsp;<span class="ident" id="2513608">opt</span><span class="op" id="2513611">,</span>&nbsp;<span class="ident" id="2513613">unsafe</span><span class="op" id="2513619">.</span><span class="ident" id="2513620">Pointer</span><span class="op" id="2513627">(</span><span class="op" id="2513628">&amp;</span><span class="ident" id="2513629">value</span><span class="op" id="2513634">)</span><span class="op" id="2513635">,</span>&nbsp;<span class="op" id="2513637">&amp;</span><span class="ident" id="2513638">vallen</span><span class="op" id="2513644">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513647">return</span>&nbsp;<span class="op" id="2513654">&amp;</span><span class="ident" id="2513655">value</span><span class="op" id="2513660">,</span>&nbsp;<span class="ident" id="2513662">err</span><br>
<span class="lineno"></span><span class="op" id="2513666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2513669">func</span>&nbsp;<span class="ident" id="2513674">GetsockoptIPMreqn</span><span class="op" id="2513691">(</span><span class="ident" id="2513692">fd</span><span class="op" id="2513694">,</span>&nbsp;<span class="ident" id="2513696">level</span><span class="op" id="2513701">,</span>&nbsp;<span class="ident" id="2513703">opt</span>&nbsp;<span class="builtintype" id="2513707">int</span><span class="op" id="2513710">)</span>&nbsp;<span class="op" id="2513712">(</span><span class="op" id="2513713">*</span><span class="ident" id="2513714">IPMreqn</span><span class="op" id="2513721">,</span>&nbsp;<span class="builtintype" id="2513723">error</span><span class="op" id="2513728">)</span>&nbsp;<span class="op" id="2513730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513733">var</span>&nbsp;<span class="ident" id="2513737">value</span>&nbsp;<span class="ident" id="2513743">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513752">vallen</span>&nbsp;<span class="op" id="2513759">:=</span>&nbsp;<span class="ident" id="2513762">_Socklen</span><span class="op" id="2513770">(</span><span class="ident" id="2513771">SizeofIPMreqn</span><span class="op" id="2513784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513787">err</span>&nbsp;<span class="op" id="2513791">:=</span>&nbsp;<span class="ident" id="2513794">getsockopt</span><span class="op" id="2513804">(</span><span class="ident" id="2513805">fd</span><span class="op" id="2513807">,</span>&nbsp;<span class="ident" id="2513809">level</span><span class="op" id="2513814">,</span>&nbsp;<span class="ident" id="2513816">opt</span><span class="op" id="2513819">,</span>&nbsp;<span class="ident" id="2513821">unsafe</span><span class="op" id="2513827">.</span><span class="ident" id="2513828">Pointer</span><span class="op" id="2513835">(</span><span class="op" id="2513836">&amp;</span><span class="ident" id="2513837">value</span><span class="op" id="2513842">)</span><span class="op" id="2513843">,</span>&nbsp;<span class="op" id="2513845">&amp;</span><span class="ident" id="2513846">vallen</span><span class="op" id="2513852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513855">return</span>&nbsp;<span class="op" id="2513862">&amp;</span><span class="ident" id="2513863">value</span><span class="op" id="2513868">,</span>&nbsp;<span class="ident" id="2513870">err</span><br>
<span class="lineno"></span><span class="op" id="2513874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2513877">func</span>&nbsp;<span class="ident" id="2513882">GetsockoptIPv6Mreq</span><span class="op" id="2513900">(</span><span class="ident" id="2513901">fd</span><span class="op" id="2513903">,</span>&nbsp;<span class="ident" id="2513905">level</span><span class="op" id="2513910">,</span>&nbsp;<span class="ident" id="2513912">opt</span>&nbsp;<span class="builtintype" id="2513916">int</span><span class="op" id="2513919">)</span>&nbsp;<span class="op" id="2513921">(</span><span class="op" id="2513922">*</span><span class="ident" id="2513923">IPv6Mreq</span><span class="op" id="2513931">,</span>&nbsp;<span class="builtintype" id="2513933">error</span><span class="op" id="2513938">)</span>&nbsp;<span class="op" id="2513940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2513943">var</span>&nbsp;<span class="ident" id="2513947">value</span>&nbsp;<span class="ident" id="2513953">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513963">vallen</span>&nbsp;<span class="op" id="2513970">:=</span>&nbsp;<span class="ident" id="2513973">_Socklen</span><span class="op" id="2513981">(</span><span class="ident" id="2513982">SizeofIPv6Mreq</span><span class="op" id="2513996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2513999">err</span>&nbsp;<span class="op" id="2514003">:=</span>&nbsp;<span class="ident" id="2514006">getsockopt</span><span class="op" id="2514016">(</span><span class="ident" id="2514017">fd</span><span class="op" id="2514019">,</span>&nbsp;<span class="ident" id="2514021">level</span><span class="op" id="2514026">,</span>&nbsp;<span class="ident" id="2514028">opt</span><span class="op" id="2514031">,</span>&nbsp;<span class="ident" id="2514033">unsafe</span><span class="op" id="2514039">.</span><span class="ident" id="2514040">Pointer</span><span class="op" id="2514047">(</span><span class="op" id="2514048">&amp;</span><span class="ident" id="2514049">value</span><span class="op" id="2514054">)</span><span class="op" id="2514055">,</span>&nbsp;<span class="op" id="2514057">&amp;</span><span class="ident" id="2514058">vallen</span><span class="op" id="2514064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2514067">return</span>&nbsp;<span class="op" id="2514074">&amp;</span><span class="ident" id="2514075">value</span><span class="op" id="2514080">,</span>&nbsp;<span class="ident" id="2514082">err</span><br>
<span class="lineno">470</span><span class="op" id="2514086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2514089">func</span>&nbsp;<span class="ident" id="2514094">GetsockoptIPv6MTUInfo</span><span class="op" id="2514115">(</span><span class="ident" id="2514116">fd</span><span class="op" id="2514118">,</span>&nbsp;<span class="ident" id="2514120">level</span><span class="op" id="2514125">,</span>&nbsp;<span class="ident" id="2514127">opt</span>&nbsp;<span class="builtintype" id="2514131">int</span><span class="op" id="2514134">)</span>&nbsp;<span class="op" id="2514136">(</span><span class="op" id="2514137">*</span><span class="ident" id="2514138">IPv6MTUInfo</span><span class="op" id="2514149">,</span>&nbsp;<span class="builtintype" id="2514151">error</span><span class="op" id="2514156">)</span>&nbsp;<span class="op" id="2514158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2514161">var</span>&nbsp;<span class="ident" id="2514165">value</span>&nbsp;<span class="ident" id="2514171">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2514184">vallen</span>&nbsp;<span class="op" id="2514191">:=</span>&nbsp;<span class="ident" id="2514194">_Socklen</span><span class="op" id="2514202">(</span><span class="ident" id="2514203">SizeofIPv6MTUInfo</span><span class="op" id="2514220">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2514223">err</span>&nbsp;<span class="op" id="2514227">:=</span>&nbsp;<span class="ident" id="2514230">getsockopt</span><span class="op" id="2514240">(</span><span class="ident" id="2514241">fd</span><span class="op" id="2514243">,</span>&nbsp;<span class="ident" id="2514245">level</span><span class="op" id="2514250">,</span>&nbsp;<span class="ident" id="2514252">opt</span><span class="op" id="2514255">,</span>&nbsp;<span class="ident" id="2514257">unsafe</span><span class="op" id="2514263">.</span><span class="ident" id="2514264">Pointer</span><span class="op" id="2514271">(</span><span class="op" id="2514272">&amp;</span><span class="ident" id="2514273">value</span><span class="op" id="2514278">)</span><span class="op" id="2514279">,</span>&nbsp;<span class="op" id="2514281">&amp;</span><span class="ident" id="2514282">vallen</span><span class="op" id="2514288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2514291">return</span>&nbsp;<span class="op" id="2514298">&amp;</span><span class="ident" id="2514299">value</span><span class="op" id="2514304">,</span>&nbsp;<span class="ident" id="2514306">err</span><br>
<span class="lineno"></span><span class="op" id="2514310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2514313">func</span>&nbsp;<span class="ident" id="2514318">GetsockoptICMPv6Filter</span><span class="op" id="2514340">(</span><span class="ident" id="2514341">fd</span><span class="op" id="2514343">,</span>&nbsp;<span class="ident" id="2514345">level</span><span class="op" id="2514350">,</span>&nbsp;<span class="ident" id="2514352">opt</span>&nbsp;<span class="builtintype" id="2514356">int</span><span class="op" id="2514359">)</span>&nbsp;<span class="op" id="2514361">(</span><span class="op" id="2514362">*</span><span class="ident" id="2514363">ICMPv6Filter</span><span class="op" id="2514375">,</span>&nbsp;<span class="builtintype" id="2514377">error</span><span class="op" id="2514382">)</span>&nbsp;<span class="op" id="2514384">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2514387">var</span>&nbsp;<span class="ident" id="2514391">value</span>&nbsp;<span class="ident" id="2514397">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2514411">vallen</span>&nbsp;<span class="op" id="2514418">:=</span>&nbsp;<span class="ident" id="2514421">_Socklen</span><span class="op" id="2514429">(</span><span class="ident" id="2514430">SizeofICMPv6Filter</span><span class="op" id="2514448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2514451">err</span>&nbsp;<span class="op" id="2514455">:=</span>&nbsp;<span class="ident" id="2514458">getsockopt</span><span class="op" id="2514468">(</span><span class="ident" id="2514469">fd</span><span class="op" id="2514471">,</span>&nbsp;<span class="ident" id="2514473">level</span><span class="op" id="2514478">,</span>&nbsp;<span class="ident" id="2514480">opt</span><span class="op" id="2514483">,</span>&nbsp;<span class="ident" id="2514485">unsafe</span><span class="op" id="2514491">.</span><span class="ident" id="2514492">Pointer</span><span class="op" id="2514499">(</span><span class="op" id="2514500">&amp;</span><span class="ident" id="2514501">value</span><span class="op" id="2514506">)</span><span class="op" id="2514507">,</span>&nbsp;<span class="op" id="2514509">&amp;</span><span class="ident" id="2514510">vallen</span><span class="op" id="2514516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2514519">return</span>&nbsp;<span class="op" id="2514526">&amp;</span><span class="ident" id="2514527">value</span><span class="op" id="2514532">,</span>&nbsp;<span class="ident" id="2514534">err</span><br>
<span class="lineno"></span><span class="op" id="2514538">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2514541">func</span>&nbsp;<span class="ident" id="2514546">GetsockoptUcred</span><span class="op" id="2514561">(</span><span class="ident" id="2514562">fd</span><span class="op" id="2514564">,</span>&nbsp;<span class="ident" id="2514566">level</span><span class="op" id="2514571">,</span>&nbsp;<span class="ident" id="2514573">opt</span>&nbsp;<span class="builtintype" id="2514577">int</span><span class="op" id="2514580">)</span>&nbsp;<span class="op" id="2514582">(</span><span class="op" id="2514583">*</span><span class="ident" id="2514584">Ucred</span><span class="op" id="2514589">,</span>&nbsp;<span class="builtintype" id="2514591">error</span><span class="op" id="2514596">)</span>&nbsp;<span class="op" id="2514598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2514601">var</span>&nbsp;<span class="ident" id="2514605">value</span>&nbsp;<span class="ident" id="2514611">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2514618">vallen</span>&nbsp;<span class="op" id="2514625">:=</span>&nbsp;<span class="ident" id="2514628">_Socklen</span><span class="op" id="2514636">(</span><span class="ident" id="2514637">SizeofUcred</span><span class="op" id="2514648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2514651">err</span>&nbsp;<span class="op" id="2514655">:=</span>&nbsp;<span class="ident" id="2514658">getsockopt</span><span class="op" id="2514668">(</span><span class="ident" id="2514669">fd</span><span class="op" id="2514671">,</span>&nbsp;<span class="ident" id="2514673">level</span><span class="op" id="2514678">,</span>&nbsp;<span class="ident" id="2514680">opt</span><span class="op" id="2514683">,</span>&nbsp;<span class="ident" id="2514685">unsafe</span><span class="op" id="2514691">.</span><span class="ident" id="2514692">Pointer</span><span class="op" id="2514699">(</span><span class="op" id="2514700">&amp;</span><span class="ident" id="2514701">value</span><span class="op" id="2514706">)</span><span class="op" id="2514707">,</span>&nbsp;<span class="op" id="2514709">&amp;</span><span class="ident" id="2514710">vallen</span><span class="op" id="2514716">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2514719">return</span>&nbsp;<span class="op" id="2514726">&amp;</span><span class="ident" id="2514727">value</span><span class="op" id="2514732">,</span>&nbsp;<span class="ident" id="2514734">err</span><br>
<span class="lineno"></span><span class="op" id="2514738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2514741">func</span>&nbsp;<span class="ident" id="2514746">SetsockoptIPMreqn</span><span class="op" id="2514763">(</span><span class="ident" id="2514764">fd</span><span class="op" id="2514766">,</span>&nbsp;<span class="ident" id="2514768">level</span><span class="op" id="2514773">,</span>&nbsp;<span class="ident" id="2514775">opt</span>&nbsp;<span class="builtintype" id="2514779">int</span><span class="op" id="2514782">,</span>&nbsp;<span class="ident" id="2514784">mreq</span>&nbsp;<span class="op" id="2514789">*</span><span class="ident" id="2514790">IPMreqn</span><span class="op" id="2514797">)</span>&nbsp;<span class="op" id="2514799">(</span><span class="ident" id="2514800">err</span>&nbsp;<span class="builtintype" id="2514804">error</span><span class="op" id="2514809">)</span>&nbsp;<span class="op" id="2514811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2514814">return</span>&nbsp;<span class="ident" id="2514821">setsockopt</span><span class="op" id="2514831">(</span><span class="ident" id="2514832">fd</span><span class="op" id="2514834">,</span>&nbsp;<span class="ident" id="2514836">level</span><span class="op" id="2514841">,</span>&nbsp;<span class="ident" id="2514843">opt</span><span class="op" id="2514846">,</span>&nbsp;<span class="ident" id="2514848">unsafe</span><span class="op" id="2514854">.</span><span class="ident" id="2514855">Pointer</span><span class="op" id="2514862">(</span><span class="ident" id="2514863">mreq</span><span class="op" id="2514867">)</span><span class="op" id="2514868">,</span>&nbsp;<span class="ident" id="2514870">unsafe</span><span class="op" id="2514876">.</span><span class="ident" id="2514877">Sizeof</span><span class="op" id="2514883">(</span><span class="op" id="2514884">*</span><span class="ident" id="2514885">mreq</span><span class="op" id="2514889">)</span><span class="op" id="2514890">)</span><br>
<span class="lineno">495</span><span class="op" id="2514892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2514895">func</span>&nbsp;<span class="ident" id="2514900">Recvmsg</span><span class="op" id="2514907">(</span><span class="ident" id="2514908">fd</span>&nbsp;<span class="builtintype" id="2514911">int</span><span class="op" id="2514914">,</span>&nbsp;<span class="ident" id="2514916">p</span><span class="op" id="2514917">,</span>&nbsp;<span class="ident" id="2514919">oob</span>&nbsp;<span class="op" id="2514923">[</span><span class="op" id="2514924">]</span><span class="builtintype" id="2514925">byte</span><span class="op" id="2514929">,</span>&nbsp;<span class="ident" id="2514931">flags</span>&nbsp;<span class="builtintype" id="2514937">int</span><span class="op" id="2514940">)</span>&nbsp;<span class="op" id="2514942">(</span><span class="ident" id="2514943">n</span><span class="op" id="2514944">,</span>&nbsp;<span class="ident" id="2514946">oobn</span>&nbsp;<span class="builtintype" id="2514951">int</span><span class="op" id="2514954">,</span>&nbsp;<span class="ident" id="2514956">recvflags</span>&nbsp;<span class="builtintype" id="2514966">int</span><span class="op" id="2514969">,</span>&nbsp;<span class="ident" id="2514971">from</span>&nbsp;<span class="ident" id="2514976">Sockaddr</span><span class="op" id="2514984">,</span>&nbsp;<span class="ident" id="2514986">err</span>&nbsp;<span class="builtintype" id="2514990">error</span><span class="op" id="2514995">)</span>&nbsp;<span class="op" id="2514997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515000">var</span>&nbsp;<span class="ident" id="2515004">msg</span>&nbsp;<span class="ident" id="2515008">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515016">var</span>&nbsp;<span class="ident" id="2515020">rsa</span>&nbsp;<span class="ident" id="2515024">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515040">msg</span><span class="op" id="2515043">.</span><span class="ident" id="2515044">Name</span>&nbsp;<span class="op" id="2515049">=</span>&nbsp;<span class="op" id="2515051">(</span><span class="op" id="2515052">*</span><span class="builtintype" id="2515053">byte</span><span class="op" id="2515057">)</span><span class="op" id="2515058">(</span><span class="ident" id="2515059">unsafe</span><span class="op" id="2515065">.</span><span class="ident" id="2515066">Pointer</span><span class="op" id="2515073">(</span><span class="op" id="2515074">&amp;</span><span class="ident" id="2515075">rsa</span><span class="op" id="2515078">)</span><span class="op" id="2515079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515082">msg</span><span class="op" id="2515085">.</span><span class="ident" id="2515086">Namelen</span>&nbsp;<span class="op" id="2515094">=</span>&nbsp;<span class="builtintype" id="2515096">uint32</span><span class="op" id="2515102">(</span><span class="ident" id="2515103">SizeofSockaddrAny</span><span class="op" id="2515120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515123">var</span>&nbsp;<span class="ident" id="2515127">iov</span>&nbsp;<span class="ident" id="2515131">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515138">if</span>&nbsp;<span class="builtinfunc" id="2515141">len</span><span class="op" id="2515144">(</span><span class="ident" id="2515145">p</span><span class="op" id="2515146">)</span>&nbsp;<span class="op" id="2515148">&gt;</span>&nbsp;<span class="num" id="2515150">0</span>&nbsp;<span class="op" id="2515152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515156">iov</span><span class="op" id="2515159">.</span><span class="ident" id="2515160">Base</span>&nbsp;<span class="op" id="2515165">=</span>&nbsp;<span class="op" id="2515167">(</span><span class="op" id="2515168">*</span><span class="builtintype" id="2515169">byte</span><span class="op" id="2515173">)</span><span class="op" id="2515174">(</span><span class="ident" id="2515175">unsafe</span><span class="op" id="2515181">.</span><span class="ident" id="2515182">Pointer</span><span class="op" id="2515189">(</span><span class="op" id="2515190">&amp;</span><span class="ident" id="2515191">p</span><span class="op" id="2515192">[</span><span class="num" id="2515193">0</span><span class="op" id="2515194">]</span><span class="op" id="2515195">)</span><span class="op" id="2515196">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515200">iov</span><span class="op" id="2515203">.</span><span class="ident" id="2515204">SetLen</span><span class="op" id="2515210">(</span><span class="builtinfunc" id="2515211">len</span><span class="op" id="2515214">(</span><span class="ident" id="2515215">p</span><span class="op" id="2515216">)</span><span class="op" id="2515217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2515220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515223">var</span>&nbsp;<span class="ident" id="2515227">dummy</span>&nbsp;<span class="builtintype" id="2515233">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515239">if</span>&nbsp;<span class="builtinfunc" id="2515242">len</span><span class="op" id="2515245">(</span><span class="ident" id="2515246">oob</span><span class="op" id="2515249">)</span>&nbsp;<span class="op" id="2515251">&gt;</span>&nbsp;<span class="num" id="2515253">0</span>&nbsp;<span class="op" id="2515255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2515259">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515297">if</span>&nbsp;<span class="builtinfunc" id="2515300">len</span><span class="op" id="2515303">(</span><span class="ident" id="2515304">p</span><span class="op" id="2515305">)</span>&nbsp;<span class="op" id="2515307">==</span>&nbsp;<span class="num" id="2515310">0</span>&nbsp;<span class="op" id="2515312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515317">iov</span><span class="op" id="2515320">.</span><span class="ident" id="2515321">Base</span>&nbsp;<span class="op" id="2515326">=</span>&nbsp;<span class="op" id="2515328">&amp;</span><span class="ident" id="2515329">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515338">iov</span><span class="op" id="2515341">.</span><span class="ident" id="2515342">SetLen</span><span class="op" id="2515348">(</span><span class="num" id="2515349">1</span><span class="op" id="2515350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2515354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515358">msg</span><span class="op" id="2515361">.</span><span class="ident" id="2515362">Control</span>&nbsp;<span class="op" id="2515370">=</span>&nbsp;<span class="op" id="2515372">(</span><span class="op" id="2515373">*</span><span class="builtintype" id="2515374">byte</span><span class="op" id="2515378">)</span><span class="op" id="2515379">(</span><span class="ident" id="2515380">unsafe</span><span class="op" id="2515386">.</span><span class="ident" id="2515387">Pointer</span><span class="op" id="2515394">(</span><span class="op" id="2515395">&amp;</span><span class="ident" id="2515396">oob</span><span class="op" id="2515399">[</span><span class="num" id="2515400">0</span><span class="op" id="2515401">]</span><span class="op" id="2515402">)</span><span class="op" id="2515403">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515407">msg</span><span class="op" id="2515410">.</span><span class="ident" id="2515411">SetControllen</span><span class="op" id="2515424">(</span><span class="builtinfunc" id="2515425">len</span><span class="op" id="2515428">(</span><span class="ident" id="2515429">oob</span><span class="op" id="2515432">)</span><span class="op" id="2515433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2515436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515439">msg</span><span class="op" id="2515442">.</span><span class="ident" id="2515443">Iov</span>&nbsp;<span class="op" id="2515447">=</span>&nbsp;<span class="op" id="2515449">&amp;</span><span class="ident" id="2515450">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515455">msg</span><span class="op" id="2515458">.</span><span class="ident" id="2515459">Iovlen</span>&nbsp;<span class="op" id="2515466">=</span>&nbsp;<span class="num" id="2515468">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515471">if</span>&nbsp;<span class="ident" id="2515474">n</span><span class="op" id="2515475">,</span>&nbsp;<span class="ident" id="2515477">err</span>&nbsp;<span class="op" id="2515481">=</span>&nbsp;<span class="ident" id="2515483">recvmsg</span><span class="op" id="2515490">(</span><span class="ident" id="2515491">fd</span><span class="op" id="2515493">,</span>&nbsp;<span class="op" id="2515495">&amp;</span><span class="ident" id="2515496">msg</span><span class="op" id="2515499">,</span>&nbsp;<span class="ident" id="2515501">flags</span><span class="op" id="2515506">)</span><span class="op" id="2515507">;</span>&nbsp;<span class="ident" id="2515509">err</span>&nbsp;<span class="op" id="2515513">!=</span>&nbsp;<span class="builtintype" id="2515516">nil</span>&nbsp;<span class="op" id="2515520">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515524">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2515532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515535">oobn</span>&nbsp;<span class="op" id="2515540">=</span>&nbsp;<span class="builtintype" id="2515542">int</span><span class="op" id="2515545">(</span><span class="ident" id="2515546">msg</span><span class="op" id="2515549">.</span><span class="ident" id="2515550">Controllen</span><span class="op" id="2515560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515563">recvflags</span>&nbsp;<span class="op" id="2515573">=</span>&nbsp;<span class="builtintype" id="2515575">int</span><span class="op" id="2515578">(</span><span class="ident" id="2515579">msg</span><span class="op" id="2515582">.</span><span class="ident" id="2515583">Flags</span><span class="op" id="2515588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2515591">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515657">if</span>&nbsp;<span class="ident" id="2515660">rsa</span><span class="op" id="2515663">.</span><span class="ident" id="2515664">Addr</span><span class="op" id="2515668">.</span><span class="ident" id="2515669">Family</span>&nbsp;<span class="op" id="2515676">!=</span>&nbsp;<span class="ident" id="2515679">AF_UNSPEC</span>&nbsp;<span class="op" id="2515689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515693">from</span><span class="op" id="2515697">,</span>&nbsp;<span class="ident" id="2515699">err</span>&nbsp;<span class="op" id="2515703">=</span>&nbsp;<span class="ident" id="2515705">anyToSockaddr</span><span class="op" id="2515718">(</span><span class="op" id="2515719">&amp;</span><span class="ident" id="2515720">rsa</span><span class="op" id="2515723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2515726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515729">return</span><br>
<span class="lineno"></span><span class="op" id="2515736">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2515739">func</span>&nbsp;<span class="ident" id="2515744">Sendmsg</span><span class="op" id="2515751">(</span><span class="ident" id="2515752">fd</span>&nbsp;<span class="builtintype" id="2515755">int</span><span class="op" id="2515758">,</span>&nbsp;<span class="ident" id="2515760">p</span><span class="op" id="2515761">,</span>&nbsp;<span class="ident" id="2515763">oob</span>&nbsp;<span class="op" id="2515767">[</span><span class="op" id="2515768">]</span><span class="builtintype" id="2515769">byte</span><span class="op" id="2515773">,</span>&nbsp;<span class="ident" id="2515775">to</span>&nbsp;<span class="ident" id="2515778">Sockaddr</span><span class="op" id="2515786">,</span>&nbsp;<span class="ident" id="2515788">flags</span>&nbsp;<span class="builtintype" id="2515794">int</span><span class="op" id="2515797">)</span>&nbsp;<span class="op" id="2515799">(</span><span class="ident" id="2515800">err</span>&nbsp;<span class="builtintype" id="2515804">error</span><span class="op" id="2515809">)</span>&nbsp;<span class="op" id="2515811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2515814">_</span><span class="op" id="2515815">,</span>&nbsp;<span class="ident" id="2515817">err</span>&nbsp;<span class="op" id="2515821">=</span>&nbsp;<span class="ident" id="2515823">SendmsgN</span><span class="op" id="2515831">(</span><span class="ident" id="2515832">fd</span><span class="op" id="2515834">,</span>&nbsp;<span class="ident" id="2515836">p</span><span class="op" id="2515837">,</span>&nbsp;<span class="ident" id="2515839">oob</span><span class="op" id="2515842">,</span>&nbsp;<span class="ident" id="2515844">to</span><span class="op" id="2515846">,</span>&nbsp;<span class="ident" id="2515848">flags</span><span class="op" id="2515853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515856">return</span><br>
<span class="lineno"></span><span class="op" id="2515863">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2515866">func</span>&nbsp;<span class="ident" id="2515871">SendmsgN</span><span class="op" id="2515879">(</span><span class="ident" id="2515880">fd</span>&nbsp;<span class="builtintype" id="2515883">int</span><span class="op" id="2515886">,</span>&nbsp;<span class="ident" id="2515888">p</span><span class="op" id="2515889">,</span>&nbsp;<span class="ident" id="2515891">oob</span>&nbsp;<span class="op" id="2515895">[</span><span class="op" id="2515896">]</span><span class="builtintype" id="2515897">byte</span><span class="op" id="2515901">,</span>&nbsp;<span class="ident" id="2515903">to</span>&nbsp;<span class="ident" id="2515906">Sockaddr</span><span class="op" id="2515914">,</span>&nbsp;<span class="ident" id="2515916">flags</span>&nbsp;<span class="builtintype" id="2515922">int</span><span class="op" id="2515925">)</span>&nbsp;<span class="op" id="2515927">(</span><span class="ident" id="2515928">n</span>&nbsp;<span class="builtintype" id="2515930">int</span><span class="op" id="2515933">,</span>&nbsp;<span class="ident" id="2515935">err</span>&nbsp;<span class="builtintype" id="2515939">error</span><span class="op" id="2515944">)</span>&nbsp;<span class="op" id="2515946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515949">var</span>&nbsp;<span class="ident" id="2515953">ptr</span>&nbsp;<span class="ident" id="2515957">unsafe</span><span class="op" id="2515963">.</span><span class="ident" id="2515964">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515973">var</span>&nbsp;<span class="ident" id="2515977">salen</span>&nbsp;<span class="ident" id="2515983">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2515993">if</span>&nbsp;<span class="ident" id="2515996">to</span>&nbsp;<span class="op" id="2515999">!=</span>&nbsp;<span class="builtintype" id="2516002">nil</span>&nbsp;<span class="op" id="2516006">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516010">var</span>&nbsp;<span class="ident" id="2516014">err</span>&nbsp;<span class="builtintype" id="2516018">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516026">ptr</span><span class="op" id="2516029">,</span>&nbsp;<span class="ident" id="2516031">salen</span><span class="op" id="2516036">,</span>&nbsp;<span class="ident" id="2516038">err</span>&nbsp;<span class="op" id="2516042">=</span>&nbsp;<span class="ident" id="2516044">to</span><span class="op" id="2516046">.</span><span class="ident" id="2516047">sockaddr</span><span class="op" id="2516055">(</span><span class="op" id="2516056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516060">if</span>&nbsp;<span class="ident" id="2516063">err</span>&nbsp;<span class="op" id="2516067">!=</span>&nbsp;<span class="builtintype" id="2516070">nil</span>&nbsp;<span class="op" id="2516074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516079">return</span>&nbsp;<span class="num" id="2516086">0</span><span class="op" id="2516087">,</span>&nbsp;<span class="ident" id="2516089">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2516095">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2516098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516101">var</span>&nbsp;<span class="ident" id="2516105">msg</span>&nbsp;<span class="ident" id="2516109">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516117">msg</span><span class="op" id="2516120">.</span><span class="ident" id="2516121">Name</span>&nbsp;<span class="op" id="2516126">=</span>&nbsp;<span class="op" id="2516128">(</span><span class="op" id="2516129">*</span><span class="builtintype" id="2516130">byte</span><span class="op" id="2516134">)</span><span class="op" id="2516135">(</span><span class="ident" id="2516136">unsafe</span><span class="op" id="2516142">.</span><span class="ident" id="2516143">Pointer</span><span class="op" id="2516150">(</span><span class="ident" id="2516151">ptr</span><span class="op" id="2516154">)</span><span class="op" id="2516155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516158">msg</span><span class="op" id="2516161">.</span><span class="ident" id="2516162">Namelen</span>&nbsp;<span class="op" id="2516170">=</span>&nbsp;<span class="builtintype" id="2516172">uint32</span><span class="op" id="2516178">(</span><span class="ident" id="2516179">salen</span><span class="op" id="2516184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516187">var</span>&nbsp;<span class="ident" id="2516191">iov</span>&nbsp;<span class="ident" id="2516195">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516202">if</span>&nbsp;<span class="builtinfunc" id="2516205">len</span><span class="op" id="2516208">(</span><span class="ident" id="2516209">p</span><span class="op" id="2516210">)</span>&nbsp;<span class="op" id="2516212">&gt;</span>&nbsp;<span class="num" id="2516214">0</span>&nbsp;<span class="op" id="2516216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516220">iov</span><span class="op" id="2516223">.</span><span class="ident" id="2516224">Base</span>&nbsp;<span class="op" id="2516229">=</span>&nbsp;<span class="op" id="2516231">(</span><span class="op" id="2516232">*</span><span class="builtintype" id="2516233">byte</span><span class="op" id="2516237">)</span><span class="op" id="2516238">(</span><span class="ident" id="2516239">unsafe</span><span class="op" id="2516245">.</span><span class="ident" id="2516246">Pointer</span><span class="op" id="2516253">(</span><span class="op" id="2516254">&amp;</span><span class="ident" id="2516255">p</span><span class="op" id="2516256">[</span><span class="num" id="2516257">0</span><span class="op" id="2516258">]</span><span class="op" id="2516259">)</span><span class="op" id="2516260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516264">iov</span><span class="op" id="2516267">.</span><span class="ident" id="2516268">SetLen</span><span class="op" id="2516274">(</span><span class="builtinfunc" id="2516275">len</span><span class="op" id="2516278">(</span><span class="ident" id="2516279">p</span><span class="op" id="2516280">)</span><span class="op" id="2516281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2516284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516287">var</span>&nbsp;<span class="ident" id="2516291">dummy</span>&nbsp;<span class="builtintype" id="2516297">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516303">if</span>&nbsp;<span class="builtinfunc" id="2516306">len</span><span class="op" id="2516309">(</span><span class="ident" id="2516310">oob</span><span class="op" id="2516313">)</span>&nbsp;<span class="op" id="2516315">&gt;</span>&nbsp;<span class="num" id="2516317">0</span>&nbsp;<span class="op" id="2516319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2516323">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516358">if</span>&nbsp;<span class="builtinfunc" id="2516361">len</span><span class="op" id="2516364">(</span><span class="ident" id="2516365">p</span><span class="op" id="2516366">)</span>&nbsp;<span class="op" id="2516368">==</span>&nbsp;<span class="num" id="2516371">0</span>&nbsp;<span class="op" id="2516373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516378">iov</span><span class="op" id="2516381">.</span><span class="ident" id="2516382">Base</span>&nbsp;<span class="op" id="2516387">=</span>&nbsp;<span class="op" id="2516389">&amp;</span><span class="ident" id="2516390">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516399">iov</span><span class="op" id="2516402">.</span><span class="ident" id="2516403">SetLen</span><span class="op" id="2516409">(</span><span class="num" id="2516410">1</span><span class="op" id="2516411">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2516415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516419">msg</span><span class="op" id="2516422">.</span><span class="ident" id="2516423">Control</span>&nbsp;<span class="op" id="2516431">=</span>&nbsp;<span class="op" id="2516433">(</span><span class="op" id="2516434">*</span><span class="builtintype" id="2516435">byte</span><span class="op" id="2516439">)</span><span class="op" id="2516440">(</span><span class="ident" id="2516441">unsafe</span><span class="op" id="2516447">.</span><span class="ident" id="2516448">Pointer</span><span class="op" id="2516455">(</span><span class="op" id="2516456">&amp;</span><span class="ident" id="2516457">oob</span><span class="op" id="2516460">[</span><span class="num" id="2516461">0</span><span class="op" id="2516462">]</span><span class="op" id="2516463">)</span><span class="op" id="2516464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516468">msg</span><span class="op" id="2516471">.</span><span class="ident" id="2516472">SetControllen</span><span class="op" id="2516485">(</span><span class="builtinfunc" id="2516486">len</span><span class="op" id="2516489">(</span><span class="ident" id="2516490">oob</span><span class="op" id="2516493">)</span><span class="op" id="2516494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2516497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516500">msg</span><span class="op" id="2516503">.</span><span class="ident" id="2516504">Iov</span>&nbsp;<span class="op" id="2516508">=</span>&nbsp;<span class="op" id="2516510">&amp;</span><span class="ident" id="2516511">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516516">msg</span><span class="op" id="2516519">.</span><span class="ident" id="2516520">Iovlen</span>&nbsp;<span class="op" id="2516527">=</span>&nbsp;<span class="num" id="2516529">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516532">if</span>&nbsp;<span class="ident" id="2516535">n</span><span class="op" id="2516536">,</span>&nbsp;<span class="ident" id="2516538">err</span>&nbsp;<span class="op" id="2516542">=</span>&nbsp;<span class="ident" id="2516544">sendmsg</span><span class="op" id="2516551">(</span><span class="ident" id="2516552">fd</span><span class="op" id="2516554">,</span>&nbsp;<span class="op" id="2516556">&amp;</span><span class="ident" id="2516557">msg</span><span class="op" id="2516560">,</span>&nbsp;<span class="ident" id="2516562">flags</span><span class="op" id="2516567">)</span><span class="op" id="2516568">;</span>&nbsp;<span class="ident" id="2516570">err</span>&nbsp;<span class="op" id="2516574">!=</span>&nbsp;<span class="builtintype" id="2516577">nil</span>&nbsp;<span class="op" id="2516581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516585">return</span>&nbsp;<span class="num" id="2516592">0</span><span class="op" id="2516593">,</span>&nbsp;<span class="ident" id="2516595">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2516600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516603">if</span>&nbsp;<span class="builtinfunc" id="2516606">len</span><span class="op" id="2516609">(</span><span class="ident" id="2516610">oob</span><span class="op" id="2516613">)</span>&nbsp;<span class="op" id="2516615">&gt;</span>&nbsp;<span class="num" id="2516617">0</span>&nbsp;<span class="op" id="2516619">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2516622">len</span><span class="op" id="2516625">(</span><span class="ident" id="2516626">p</span><span class="op" id="2516627">)</span>&nbsp;<span class="op" id="2516629">==</span>&nbsp;<span class="num" id="2516632">0</span>&nbsp;<span class="op" id="2516634">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2516638">n</span>&nbsp;<span class="op" id="2516640">=</span>&nbsp;<span class="num" id="2516642">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2516645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516648">return</span>&nbsp;<span class="ident" id="2516655">n</span><span class="op" id="2516656">,</span>&nbsp;<span class="builtintype" id="2516658">nil</span><br>
<span class="lineno"></span><span class="op" id="2516662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2516665">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2516728">func</span>&nbsp;<span class="ident" id="2516733">BindToDevice</span><span class="op" id="2516745">(</span><span class="ident" id="2516746">fd</span>&nbsp;<span class="builtintype" id="2516749">int</span><span class="op" id="2516752">,</span>&nbsp;<span class="ident" id="2516754">device</span>&nbsp;<span class="builtintype" id="2516761">string</span><span class="op" id="2516767">)</span>&nbsp;<span class="op" id="2516769">(</span><span class="ident" id="2516770">err</span>&nbsp;<span class="builtintype" id="2516774">error</span><span class="op" id="2516779">)</span>&nbsp;<span class="op" id="2516781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2516784">return</span>&nbsp;<span class="ident" id="2516791">SetsockoptString</span><span class="op" id="2516807">(</span><span class="ident" id="2516808">fd</span><span class="op" id="2516810">,</span>&nbsp;<span class="ident" id="2516812">SOL_SOCKET</span><span class="op" id="2516822">,</span>&nbsp;<span class="ident" id="2516824">SO_BINDTODEVICE</span><span class="op" id="2516839">,</span>&nbsp;<span class="ident" id="2516841">device</span><span class="op" id="2516847">)</span><br>
<span class="lineno"></span><span class="op" id="2516849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2516852">//sys&nbsp;&nbsp;&nbsp;&nbsp;ptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2516928">func</span>&nbsp;<span class="ident" id="2516933">ptracePeek</span><span class="op" id="2516943">(</span><span class="ident" id="2516944">req</span>&nbsp;<span class="builtintype" id="2516948">int</span><span class="op" id="2516951">,</span>&nbsp;<span class="ident" id="2516953">pid</span>&nbsp;<span class="builtintype" id="2516957">int</span><span class="op" id="2516960">,</span>&nbsp;<span class="ident" id="2516962">addr</span>&nbsp;<span class="builtintype" id="2516967">uintptr</span><span class="op" id="2516974">,</span>&nbsp;<span class="ident" id="2516976">out</span>&nbsp;<span class="op" id="2516980">[</span><span class="op" id="2516981">]</span><span class="builtintype" id="2516982">byte</span><span class="op" id="2516986">)</span>&nbsp;<span class="op" id="2516988">(</span><span class="ident" id="2516989">count</span>&nbsp;<span class="builtintype" id="2516995">int</span><span class="op" id="2516998">,</span>&nbsp;<span class="ident" id="2517000">err</span>&nbsp;<span class="builtintype" id="2517004">error</span><span class="op" id="2517009">)</span>&nbsp;<span class="op" id="2517011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517014">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517077">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517117">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517169">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2517232">var</span>&nbsp;<span class="ident" id="2517236">buf</span>&nbsp;<span class="op" id="2517240">[</span><span class="ident" id="2517241">sizeofPtr</span><span class="op" id="2517250">]</span><span class="builtintype" id="2517251">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517258">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517317">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517376">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517432">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517490">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2517504">n</span>&nbsp;<span class="op" id="2517506">:=</span>&nbsp;<span class="num" id="2517509">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2517512">if</span>&nbsp;<span class="ident" id="2517515">addr</span><span class="op" id="2517519">%</span><span class="ident" id="2517520">sizeofPtr</span>&nbsp;<span class="op" id="2517530">!=</span>&nbsp;<span class="num" id="2517533">0</span>&nbsp;<span class="op" id="2517535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2517539">err</span>&nbsp;<span class="op" id="2517543">=</span>&nbsp;<span class="ident" id="2517545">ptrace</span><span class="op" id="2517551">(</span><span class="ident" id="2517552">req</span><span class="op" id="2517555">,</span>&nbsp;<span class="ident" id="2517557">pid</span><span class="op" id="2517560">,</span>&nbsp;<span class="ident" id="2517562">addr</span><span class="op" id="2517566">-</span><span class="ident" id="2517567">addr</span><span class="op" id="2517571">%</span><span class="ident" id="2517572">sizeofPtr</span><span class="op" id="2517581">,</span>&nbsp;<span class="builtintype" id="2517583">uintptr</span><span class="op" id="2517590">(</span><span class="ident" id="2517591">unsafe</span><span class="op" id="2517597">.</span><span class="ident" id="2517598">Pointer</span><span class="op" id="2517605">(</span><span class="op" id="2517606">&amp;</span><span class="ident" id="2517607">buf</span><span class="op" id="2517610">[</span><span class="num" id="2517611">0</span><span class="op" id="2517612">]</span><span class="op" id="2517613">)</span><span class="op" id="2517614">)</span><span class="op" id="2517615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2517619">if</span>&nbsp;<span class="ident" id="2517622">err</span>&nbsp;<span class="op" id="2517626">!=</span>&nbsp;<span class="builtintype" id="2517629">nil</span>&nbsp;<span class="op" id="2517633">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2517638">return</span>&nbsp;<span class="num" id="2517645">0</span><span class="op" id="2517646">,</span>&nbsp;<span class="ident" id="2517648">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2517654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2517658">n</span>&nbsp;<span class="op" id="2517660">+=</span>&nbsp;<span class="builtinfunc" id="2517663">copy</span><span class="op" id="2517667">(</span><span class="ident" id="2517668">out</span><span class="op" id="2517671">,</span>&nbsp;<span class="ident" id="2517673">buf</span><span class="op" id="2517676">[</span><span class="ident" id="2517677">addr</span><span class="op" id="2517681">%</span><span class="ident" id="2517682">sizeofPtr</span><span class="op" id="2517691">:</span><span class="op" id="2517692">]</span><span class="op" id="2517693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2517697">out</span>&nbsp;<span class="op" id="2517701">=</span>&nbsp;<span class="ident" id="2517703">out</span><span class="op" id="2517706">[</span><span class="ident" id="2517707">n</span><span class="op" id="2517708">:</span><span class="op" id="2517709">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2517712">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517716">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2517731">for</span>&nbsp;<span class="builtinfunc" id="2517735">len</span><span class="op" id="2517738">(</span><span class="ident" id="2517739">out</span><span class="op" id="2517742">)</span>&nbsp;<span class="op" id="2517744">&gt;</span>&nbsp;<span class="num" id="2517746">0</span>&nbsp;<span class="op" id="2517748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517752">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517807">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2517874">err</span>&nbsp;<span class="op" id="2517878">=</span>&nbsp;<span class="ident" id="2517880">ptrace</span><span class="op" id="2517886">(</span><span class="ident" id="2517887">req</span><span class="op" id="2517890">,</span>&nbsp;<span class="ident" id="2517892">pid</span><span class="op" id="2517895">,</span>&nbsp;<span class="ident" id="2517897">addr</span><span class="op" id="2517901">+</span><span class="builtintype" id="2517902">uintptr</span><span class="op" id="2517909">(</span><span class="ident" id="2517910">n</span><span class="op" id="2517911">)</span><span class="op" id="2517912">,</span>&nbsp;<span class="builtintype" id="2517914">uintptr</span><span class="op" id="2517921">(</span><span class="ident" id="2517922">unsafe</span><span class="op" id="2517928">.</span><span class="ident" id="2517929">Pointer</span><span class="op" id="2517936">(</span><span class="op" id="2517937">&amp;</span><span class="ident" id="2517938">buf</span><span class="op" id="2517941">[</span><span class="num" id="2517942">0</span><span class="op" id="2517943">]</span><span class="op" id="2517944">)</span><span class="op" id="2517945">)</span><span class="op" id="2517946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2517950">if</span>&nbsp;<span class="ident" id="2517953">err</span>&nbsp;<span class="op" id="2517957">!=</span>&nbsp;<span class="builtintype" id="2517960">nil</span>&nbsp;<span class="op" id="2517964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2517969">return</span>&nbsp;<span class="ident" id="2517976">n</span><span class="op" id="2517977">,</span>&nbsp;<span class="ident" id="2517979">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2517985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2517989">copied</span>&nbsp;<span class="op" id="2517996">:=</span>&nbsp;<span class="builtinfunc" id="2517999">copy</span><span class="op" id="2518003">(</span><span class="ident" id="2518004">out</span><span class="op" id="2518007">,</span>&nbsp;<span class="ident" id="2518009">buf</span><span class="op" id="2518012">[</span><span class="num" id="2518013">0</span><span class="op" id="2518014">:</span><span class="op" id="2518015">]</span><span class="op" id="2518016">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2518020">n</span>&nbsp;<span class="op" id="2518022">+=</span>&nbsp;<span class="ident" id="2518025">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2518034">out</span>&nbsp;<span class="op" id="2518038">=</span>&nbsp;<span class="ident" id="2518040">out</span><span class="op" id="2518043">[</span><span class="ident" id="2518044">copied</span><span class="op" id="2518050">:</span><span class="op" id="2518051">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2518054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518058">return</span>&nbsp;<span class="ident" id="2518065">n</span><span class="op" id="2518066">,</span>&nbsp;<span class="builtintype" id="2518068">nil</span><br>
<span class="lineno">620</span><span class="op" id="2518072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2518075">func</span>&nbsp;<span class="ident" id="2518080">PtracePeekText</span><span class="op" id="2518094">(</span><span class="ident" id="2518095">pid</span>&nbsp;<span class="builtintype" id="2518099">int</span><span class="op" id="2518102">,</span>&nbsp;<span class="ident" id="2518104">addr</span>&nbsp;<span class="builtintype" id="2518109">uintptr</span><span class="op" id="2518116">,</span>&nbsp;<span class="ident" id="2518118">out</span>&nbsp;<span class="op" id="2518122">[</span><span class="op" id="2518123">]</span><span class="builtintype" id="2518124">byte</span><span class="op" id="2518128">)</span>&nbsp;<span class="op" id="2518130">(</span><span class="ident" id="2518131">count</span>&nbsp;<span class="builtintype" id="2518137">int</span><span class="op" id="2518140">,</span>&nbsp;<span class="ident" id="2518142">err</span>&nbsp;<span class="builtintype" id="2518146">error</span><span class="op" id="2518151">)</span>&nbsp;<span class="op" id="2518153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518156">return</span>&nbsp;<span class="ident" id="2518163">ptracePeek</span><span class="op" id="2518173">(</span><span class="ident" id="2518174">PTRACE_PEEKTEXT</span><span class="op" id="2518189">,</span>&nbsp;<span class="ident" id="2518191">pid</span><span class="op" id="2518194">,</span>&nbsp;<span class="ident" id="2518196">addr</span><span class="op" id="2518200">,</span>&nbsp;<span class="ident" id="2518202">out</span><span class="op" id="2518205">)</span><br>
<span class="lineno"></span><span class="op" id="2518207">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2518210">func</span>&nbsp;<span class="ident" id="2518215">PtracePeekData</span><span class="op" id="2518229">(</span><span class="ident" id="2518230">pid</span>&nbsp;<span class="builtintype" id="2518234">int</span><span class="op" id="2518237">,</span>&nbsp;<span class="ident" id="2518239">addr</span>&nbsp;<span class="builtintype" id="2518244">uintptr</span><span class="op" id="2518251">,</span>&nbsp;<span class="ident" id="2518253">out</span>&nbsp;<span class="op" id="2518257">[</span><span class="op" id="2518258">]</span><span class="builtintype" id="2518259">byte</span><span class="op" id="2518263">)</span>&nbsp;<span class="op" id="2518265">(</span><span class="ident" id="2518266">count</span>&nbsp;<span class="builtintype" id="2518272">int</span><span class="op" id="2518275">,</span>&nbsp;<span class="ident" id="2518277">err</span>&nbsp;<span class="builtintype" id="2518281">error</span><span class="op" id="2518286">)</span>&nbsp;<span class="op" id="2518288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518291">return</span>&nbsp;<span class="ident" id="2518298">ptracePeek</span><span class="op" id="2518308">(</span><span class="ident" id="2518309">PTRACE_PEEKDATA</span><span class="op" id="2518324">,</span>&nbsp;<span class="ident" id="2518326">pid</span><span class="op" id="2518329">,</span>&nbsp;<span class="ident" id="2518331">addr</span><span class="op" id="2518335">,</span>&nbsp;<span class="ident" id="2518337">out</span><span class="op" id="2518340">)</span><br>
<span class="lineno"></span><span class="op" id="2518342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2518345">func</span>&nbsp;<span class="ident" id="2518350">ptracePoke</span><span class="op" id="2518360">(</span><span class="ident" id="2518361">pokeReq</span>&nbsp;<span class="builtintype" id="2518369">int</span><span class="op" id="2518372">,</span>&nbsp;<span class="ident" id="2518374">peekReq</span>&nbsp;<span class="builtintype" id="2518382">int</span><span class="op" id="2518385">,</span>&nbsp;<span class="ident" id="2518387">pid</span>&nbsp;<span class="builtintype" id="2518391">int</span><span class="op" id="2518394">,</span>&nbsp;<span class="ident" id="2518396">addr</span>&nbsp;<span class="builtintype" id="2518401">uintptr</span><span class="op" id="2518408">,</span>&nbsp;<span class="ident" id="2518410">data</span>&nbsp;<span class="op" id="2518415">[</span><span class="op" id="2518416">]</span><span class="builtintype" id="2518417">byte</span><span class="op" id="2518421">)</span>&nbsp;<span class="op" id="2518423">(</span><span class="ident" id="2518424">count</span>&nbsp;<span class="builtintype" id="2518430">int</span><span class="op" id="2518433">,</span>&nbsp;<span class="ident" id="2518435">err</span>&nbsp;<span class="builtintype" id="2518439">error</span><span class="op" id="2518444">)</span>&nbsp;<span class="op" id="2518446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2518449">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2518510">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2518567">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2518585">n</span>&nbsp;<span class="op" id="2518587">:=</span>&nbsp;<span class="num" id="2518590">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518593">if</span>&nbsp;<span class="ident" id="2518596">addr</span><span class="op" id="2518600">%</span><span class="ident" id="2518601">sizeofPtr</span>&nbsp;<span class="op" id="2518611">!=</span>&nbsp;<span class="num" id="2518614">0</span>&nbsp;<span class="op" id="2518616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518620">var</span>&nbsp;<span class="ident" id="2518624">buf</span>&nbsp;<span class="op" id="2518628">[</span><span class="ident" id="2518629">sizeofPtr</span><span class="op" id="2518638">]</span><span class="builtintype" id="2518639">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2518646">err</span>&nbsp;<span class="op" id="2518650">=</span>&nbsp;<span class="ident" id="2518652">ptrace</span><span class="op" id="2518658">(</span><span class="ident" id="2518659">peekReq</span><span class="op" id="2518666">,</span>&nbsp;<span class="ident" id="2518668">pid</span><span class="op" id="2518671">,</span>&nbsp;<span class="ident" id="2518673">addr</span><span class="op" id="2518677">-</span><span class="ident" id="2518678">addr</span><span class="op" id="2518682">%</span><span class="ident" id="2518683">sizeofPtr</span><span class="op" id="2518692">,</span>&nbsp;<span class="builtintype" id="2518694">uintptr</span><span class="op" id="2518701">(</span><span class="ident" id="2518702">unsafe</span><span class="op" id="2518708">.</span><span class="ident" id="2518709">Pointer</span><span class="op" id="2518716">(</span><span class="op" id="2518717">&amp;</span><span class="ident" id="2518718">buf</span><span class="op" id="2518721">[</span><span class="num" id="2518722">0</span><span class="op" id="2518723">]</span><span class="op" id="2518724">)</span><span class="op" id="2518725">)</span><span class="op" id="2518726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518730">if</span>&nbsp;<span class="ident" id="2518733">err</span>&nbsp;<span class="op" id="2518737">!=</span>&nbsp;<span class="builtintype" id="2518740">nil</span>&nbsp;<span class="op" id="2518744">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518749">return</span>&nbsp;<span class="num" id="2518756">0</span><span class="op" id="2518757">,</span>&nbsp;<span class="ident" id="2518759">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2518765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2518769">n</span>&nbsp;<span class="op" id="2518771">+=</span>&nbsp;<span class="builtinfunc" id="2518774">copy</span><span class="op" id="2518778">(</span><span class="ident" id="2518779">buf</span><span class="op" id="2518782">[</span><span class="ident" id="2518783">addr</span><span class="op" id="2518787">%</span><span class="ident" id="2518788">sizeofPtr</span><span class="op" id="2518797">:</span><span class="op" id="2518798">]</span><span class="op" id="2518799">,</span>&nbsp;<span class="ident" id="2518801">data</span><span class="op" id="2518805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2518809">word</span>&nbsp;<span class="op" id="2518814">:=</span>&nbsp;<span class="op" id="2518817">*</span><span class="op" id="2518818">(</span><span class="op" id="2518819">(</span><span class="op" id="2518820">*</span><span class="builtintype" id="2518821">uintptr</span><span class="op" id="2518828">)</span><span class="op" id="2518829">(</span><span class="ident" id="2518830">unsafe</span><span class="op" id="2518836">.</span><span class="ident" id="2518837">Pointer</span><span class="op" id="2518844">(</span><span class="op" id="2518845">&amp;</span><span class="ident" id="2518846">buf</span><span class="op" id="2518849">[</span><span class="num" id="2518850">0</span><span class="op" id="2518851">]</span><span class="op" id="2518852">)</span><span class="op" id="2518853">)</span><span class="op" id="2518854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2518858">err</span>&nbsp;<span class="op" id="2518862">=</span>&nbsp;<span class="ident" id="2518864">ptrace</span><span class="op" id="2518870">(</span><span class="ident" id="2518871">pokeReq</span><span class="op" id="2518878">,</span>&nbsp;<span class="ident" id="2518880">pid</span><span class="op" id="2518883">,</span>&nbsp;<span class="ident" id="2518885">addr</span><span class="op" id="2518889">-</span><span class="ident" id="2518890">addr</span><span class="op" id="2518894">%</span><span class="ident" id="2518895">sizeofPtr</span><span class="op" id="2518904">,</span>&nbsp;<span class="ident" id="2518906">word</span><span class="op" id="2518910">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518914">if</span>&nbsp;<span class="ident" id="2518917">err</span>&nbsp;<span class="op" id="2518921">!=</span>&nbsp;<span class="builtintype" id="2518924">nil</span>&nbsp;<span class="op" id="2518928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518933">return</span>&nbsp;<span class="num" id="2518940">0</span><span class="op" id="2518941">,</span>&nbsp;<span class="ident" id="2518943">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2518949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2518953">data</span>&nbsp;<span class="op" id="2518958">=</span>&nbsp;<span class="ident" id="2518960">data</span><span class="op" id="2518964">[</span><span class="ident" id="2518965">n</span><span class="op" id="2518966">:</span><span class="op" id="2518967">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2518970">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2518974">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2518988">for</span>&nbsp;<span class="builtinfunc" id="2518992">len</span><span class="op" id="2518995">(</span><span class="ident" id="2518996">data</span><span class="op" id="2519000">)</span>&nbsp;<span class="op" id="2519002">&gt;</span>&nbsp;<span class="ident" id="2519004">sizeofPtr</span>&nbsp;<span class="op" id="2519014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2519018">word</span>&nbsp;<span class="op" id="2519023">:=</span>&nbsp;<span class="op" id="2519026">*</span><span class="op" id="2519027">(</span><span class="op" id="2519028">(</span><span class="op" id="2519029">*</span><span class="builtintype" id="2519030">uintptr</span><span class="op" id="2519037">)</span><span class="op" id="2519038">(</span><span class="ident" id="2519039">unsafe</span><span class="op" id="2519045">.</span><span class="ident" id="2519046">Pointer</span><span class="op" id="2519053">(</span><span class="op" id="2519054">&amp;</span><span class="ident" id="2519055">data</span><span class="op" id="2519059">[</span><span class="num" id="2519060">0</span><span class="op" id="2519061">]</span><span class="op" id="2519062">)</span><span class="op" id="2519063">)</span><span class="op" id="2519064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2519068">err</span>&nbsp;<span class="op" id="2519072">=</span>&nbsp;<span class="ident" id="2519074">ptrace</span><span class="op" id="2519080">(</span><span class="ident" id="2519081">pokeReq</span><span class="op" id="2519088">,</span>&nbsp;<span class="ident" id="2519090">pid</span><span class="op" id="2519093">,</span>&nbsp;<span class="ident" id="2519095">addr</span><span class="op" id="2519099">+</span><span class="builtintype" id="2519100">uintptr</span><span class="op" id="2519107">(</span><span class="ident" id="2519108">n</span><span class="op" id="2519109">)</span><span class="op" id="2519110">,</span>&nbsp;<span class="ident" id="2519112">word</span><span class="op" id="2519116">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519120">if</span>&nbsp;<span class="ident" id="2519123">err</span>&nbsp;<span class="op" id="2519127">!=</span>&nbsp;<span class="builtintype" id="2519130">nil</span>&nbsp;<span class="op" id="2519134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519139">return</span>&nbsp;<span class="ident" id="2519146">n</span><span class="op" id="2519147">,</span>&nbsp;<span class="ident" id="2519149">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2519155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2519159">n</span>&nbsp;<span class="op" id="2519161">+=</span>&nbsp;<span class="ident" id="2519164">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2519176">data</span>&nbsp;<span class="op" id="2519181">=</span>&nbsp;<span class="ident" id="2519183">data</span><span class="op" id="2519187">[</span><span class="ident" id="2519188">sizeofPtr</span><span class="op" id="2519197">:</span><span class="op" id="2519198">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2519201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2519205">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519224">if</span>&nbsp;<span class="builtinfunc" id="2519227">len</span><span class="op" id="2519230">(</span><span class="ident" id="2519231">data</span><span class="op" id="2519235">)</span>&nbsp;<span class="op" id="2519237">&gt;</span>&nbsp;<span class="num" id="2519239">0</span>&nbsp;<span class="op" id="2519241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519245">var</span>&nbsp;<span class="ident" id="2519249">buf</span>&nbsp;<span class="op" id="2519253">[</span><span class="ident" id="2519254">sizeofPtr</span><span class="op" id="2519263">]</span><span class="builtintype" id="2519264">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2519271">err</span>&nbsp;<span class="op" id="2519275">=</span>&nbsp;<span class="ident" id="2519277">ptrace</span><span class="op" id="2519283">(</span><span class="ident" id="2519284">peekReq</span><span class="op" id="2519291">,</span>&nbsp;<span class="ident" id="2519293">pid</span><span class="op" id="2519296">,</span>&nbsp;<span class="ident" id="2519298">addr</span><span class="op" id="2519302">+</span><span class="builtintype" id="2519303">uintptr</span><span class="op" id="2519310">(</span><span class="ident" id="2519311">n</span><span class="op" id="2519312">)</span><span class="op" id="2519313">,</span>&nbsp;<span class="builtintype" id="2519315">uintptr</span><span class="op" id="2519322">(</span><span class="ident" id="2519323">unsafe</span><span class="op" id="2519329">.</span><span class="ident" id="2519330">Pointer</span><span class="op" id="2519337">(</span><span class="op" id="2519338">&amp;</span><span class="ident" id="2519339">buf</span><span class="op" id="2519342">[</span><span class="num" id="2519343">0</span><span class="op" id="2519344">]</span><span class="op" id="2519345">)</span><span class="op" id="2519346">)</span><span class="op" id="2519347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519351">if</span>&nbsp;<span class="ident" id="2519354">err</span>&nbsp;<span class="op" id="2519358">!=</span>&nbsp;<span class="builtintype" id="2519361">nil</span>&nbsp;<span class="op" id="2519365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519370">return</span>&nbsp;<span class="ident" id="2519377">n</span><span class="op" id="2519378">,</span>&nbsp;<span class="ident" id="2519380">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2519386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2519390">copy</span><span class="op" id="2519394">(</span><span class="ident" id="2519395">buf</span><span class="op" id="2519398">[</span><span class="num" id="2519399">0</span><span class="op" id="2519400">:</span><span class="op" id="2519401">]</span><span class="op" id="2519402">,</span>&nbsp;<span class="ident" id="2519404">data</span><span class="op" id="2519408">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2519412">word</span>&nbsp;<span class="op" id="2519417">:=</span>&nbsp;<span class="op" id="2519420">*</span><span class="op" id="2519421">(</span><span class="op" id="2519422">(</span><span class="op" id="2519423">*</span><span class="builtintype" id="2519424">uintptr</span><span class="op" id="2519431">)</span><span class="op" id="2519432">(</span><span class="ident" id="2519433">unsafe</span><span class="op" id="2519439">.</span><span class="ident" id="2519440">Pointer</span><span class="op" id="2519447">(</span><span class="op" id="2519448">&amp;</span><span class="ident" id="2519449">buf</span><span class="op" id="2519452">[</span><span class="num" id="2519453">0</span><span class="op" id="2519454">]</span><span class="op" id="2519455">)</span><span class="op" id="2519456">)</span><span class="op" id="2519457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2519461">err</span>&nbsp;<span class="op" id="2519465">=</span>&nbsp;<span class="ident" id="2519467">ptrace</span><span class="op" id="2519473">(</span><span class="ident" id="2519474">pokeReq</span><span class="op" id="2519481">,</span>&nbsp;<span class="ident" id="2519483">pid</span><span class="op" id="2519486">,</span>&nbsp;<span class="ident" id="2519488">addr</span><span class="op" id="2519492">+</span><span class="builtintype" id="2519493">uintptr</span><span class="op" id="2519500">(</span><span class="ident" id="2519501">n</span><span class="op" id="2519502">)</span><span class="op" id="2519503">,</span>&nbsp;<span class="ident" id="2519505">word</span><span class="op" id="2519509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519513">if</span>&nbsp;<span class="ident" id="2519516">err</span>&nbsp;<span class="op" id="2519520">!=</span>&nbsp;<span class="builtintype" id="2519523">nil</span>&nbsp;<span class="op" id="2519527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519532">return</span>&nbsp;<span class="ident" id="2519539">n</span><span class="op" id="2519540">,</span>&nbsp;<span class="ident" id="2519542">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2519548">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2519552">n</span>&nbsp;<span class="op" id="2519554">+=</span>&nbsp;<span class="builtinfunc" id="2519557">len</span><span class="op" id="2519560">(</span><span class="ident" id="2519561">data</span><span class="op" id="2519565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2519568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519572">return</span>&nbsp;<span class="ident" id="2519579">n</span><span class="op" id="2519580">,</span>&nbsp;<span class="builtintype" id="2519582">nil</span><br>
<span class="lineno"></span><span class="op" id="2519586">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2519589">func</span>&nbsp;<span class="ident" id="2519594">PtracePokeText</span><span class="op" id="2519608">(</span><span class="ident" id="2519609">pid</span>&nbsp;<span class="builtintype" id="2519613">int</span><span class="op" id="2519616">,</span>&nbsp;<span class="ident" id="2519618">addr</span>&nbsp;<span class="builtintype" id="2519623">uintptr</span><span class="op" id="2519630">,</span>&nbsp;<span class="ident" id="2519632">data</span>&nbsp;<span class="op" id="2519637">[</span><span class="op" id="2519638">]</span><span class="builtintype" id="2519639">byte</span><span class="op" id="2519643">)</span>&nbsp;<span class="op" id="2519645">(</span><span class="ident" id="2519646">count</span>&nbsp;<span class="builtintype" id="2519652">int</span><span class="op" id="2519655">,</span>&nbsp;<span class="ident" id="2519657">err</span>&nbsp;<span class="builtintype" id="2519661">error</span><span class="op" id="2519666">)</span>&nbsp;<span class="op" id="2519668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519671">return</span>&nbsp;<span class="ident" id="2519678">ptracePoke</span><span class="op" id="2519688">(</span><span class="ident" id="2519689">PTRACE_POKETEXT</span><span class="op" id="2519704">,</span>&nbsp;<span class="ident" id="2519706">PTRACE_PEEKTEXT</span><span class="op" id="2519721">,</span>&nbsp;<span class="ident" id="2519723">pid</span><span class="op" id="2519726">,</span>&nbsp;<span class="ident" id="2519728">addr</span><span class="op" id="2519732">,</span>&nbsp;<span class="ident" id="2519734">data</span><span class="op" id="2519738">)</span><br>
<span class="lineno"></span><span class="op" id="2519740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2519743">func</span>&nbsp;<span class="ident" id="2519748">PtracePokeData</span><span class="op" id="2519762">(</span><span class="ident" id="2519763">pid</span>&nbsp;<span class="builtintype" id="2519767">int</span><span class="op" id="2519770">,</span>&nbsp;<span class="ident" id="2519772">addr</span>&nbsp;<span class="builtintype" id="2519777">uintptr</span><span class="op" id="2519784">,</span>&nbsp;<span class="ident" id="2519786">data</span>&nbsp;<span class="op" id="2519791">[</span><span class="op" id="2519792">]</span><span class="builtintype" id="2519793">byte</span><span class="op" id="2519797">)</span>&nbsp;<span class="op" id="2519799">(</span><span class="ident" id="2519800">count</span>&nbsp;<span class="builtintype" id="2519806">int</span><span class="op" id="2519809">,</span>&nbsp;<span class="ident" id="2519811">err</span>&nbsp;<span class="builtintype" id="2519815">error</span><span class="op" id="2519820">)</span>&nbsp;<span class="op" id="2519822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519825">return</span>&nbsp;<span class="ident" id="2519832">ptracePoke</span><span class="op" id="2519842">(</span><span class="ident" id="2519843">PTRACE_POKEDATA</span><span class="op" id="2519858">,</span>&nbsp;<span class="ident" id="2519860">PTRACE_PEEKDATA</span><span class="op" id="2519875">,</span>&nbsp;<span class="ident" id="2519877">pid</span><span class="op" id="2519880">,</span>&nbsp;<span class="ident" id="2519882">addr</span><span class="op" id="2519886">,</span>&nbsp;<span class="ident" id="2519888">data</span><span class="op" id="2519892">)</span><br>
<span class="lineno"></span><span class="op" id="2519894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2519897">func</span>&nbsp;<span class="ident" id="2519902">PtraceGetRegs</span><span class="op" id="2519915">(</span><span class="ident" id="2519916">pid</span>&nbsp;<span class="builtintype" id="2519920">int</span><span class="op" id="2519923">,</span>&nbsp;<span class="ident" id="2519925">regsout</span>&nbsp;<span class="op" id="2519933">*</span><span class="ident" id="2519934">PtraceRegs</span><span class="op" id="2519944">)</span>&nbsp;<span class="op" id="2519946">(</span><span class="ident" id="2519947">err</span>&nbsp;<span class="builtintype" id="2519951">error</span><span class="op" id="2519956">)</span>&nbsp;<span class="op" id="2519958">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2519961">return</span>&nbsp;<span class="ident" id="2519968">ptrace</span><span class="op" id="2519974">(</span><span class="ident" id="2519975">PTRACE_GETREGS</span><span class="op" id="2519989">,</span>&nbsp;<span class="ident" id="2519991">pid</span><span class="op" id="2519994">,</span>&nbsp;<span class="num" id="2519996">0</span><span class="op" id="2519997">,</span>&nbsp;<span class="builtintype" id="2519999">uintptr</span><span class="op" id="2520006">(</span><span class="ident" id="2520007">unsafe</span><span class="op" id="2520013">.</span><span class="ident" id="2520014">Pointer</span><span class="op" id="2520021">(</span><span class="ident" id="2520022">regsout</span><span class="op" id="2520029">)</span><span class="op" id="2520030">)</span><span class="op" id="2520031">)</span><br>
<span class="lineno"></span><span class="op" id="2520033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2520036">func</span>&nbsp;<span class="ident" id="2520041">PtraceSetRegs</span><span class="op" id="2520054">(</span><span class="ident" id="2520055">pid</span>&nbsp;<span class="builtintype" id="2520059">int</span><span class="op" id="2520062">,</span>&nbsp;<span class="ident" id="2520064">regs</span>&nbsp;<span class="op" id="2520069">*</span><span class="ident" id="2520070">PtraceRegs</span><span class="op" id="2520080">)</span>&nbsp;<span class="op" id="2520082">(</span><span class="ident" id="2520083">err</span>&nbsp;<span class="builtintype" id="2520087">error</span><span class="op" id="2520092">)</span>&nbsp;<span class="op" id="2520094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2520097">return</span>&nbsp;<span class="ident" id="2520104">ptrace</span><span class="op" id="2520110">(</span><span class="ident" id="2520111">PTRACE_SETREGS</span><span class="op" id="2520125">,</span>&nbsp;<span class="ident" id="2520127">pid</span><span class="op" id="2520130">,</span>&nbsp;<span class="num" id="2520132">0</span><span class="op" id="2520133">,</span>&nbsp;<span class="builtintype" id="2520135">uintptr</span><span class="op" id="2520142">(</span><span class="ident" id="2520143">unsafe</span><span class="op" id="2520149">.</span><span class="ident" id="2520150">Pointer</span><span class="op" id="2520157">(</span><span class="ident" id="2520158">regs</span><span class="op" id="2520162">)</span><span class="op" id="2520163">)</span><span class="op" id="2520164">)</span><br>
<span class="lineno">695</span><span class="op" id="2520166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2520169">func</span>&nbsp;<span class="ident" id="2520174">PtraceSetOptions</span><span class="op" id="2520190">(</span><span class="ident" id="2520191">pid</span>&nbsp;<span class="builtintype" id="2520195">int</span><span class="op" id="2520198">,</span>&nbsp;<span class="ident" id="2520200">options</span>&nbsp;<span class="builtintype" id="2520208">int</span><span class="op" id="2520211">)</span>&nbsp;<span class="op" id="2520213">(</span><span class="ident" id="2520214">err</span>&nbsp;<span class="builtintype" id="2520218">error</span><span class="op" id="2520223">)</span>&nbsp;<span class="op" id="2520225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2520228">return</span>&nbsp;<span class="ident" id="2520235">ptrace</span><span class="op" id="2520241">(</span><span class="ident" id="2520242">PTRACE_SETOPTIONS</span><span class="op" id="2520259">,</span>&nbsp;<span class="ident" id="2520261">pid</span><span class="op" id="2520264">,</span>&nbsp;<span class="num" id="2520266">0</span><span class="op" id="2520267">,</span>&nbsp;<span class="builtintype" id="2520269">uintptr</span><span class="op" id="2520276">(</span><span class="ident" id="2520277">options</span><span class="op" id="2520284">)</span><span class="op" id="2520285">)</span><br>
<span class="lineno"></span><span class="op" id="2520287">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2520290">func</span>&nbsp;<span class="ident" id="2520295">PtraceGetEventMsg</span><span class="op" id="2520312">(</span><span class="ident" id="2520313">pid</span>&nbsp;<span class="builtintype" id="2520317">int</span><span class="op" id="2520320">)</span>&nbsp;<span class="op" id="2520322">(</span><span class="ident" id="2520323">msg</span>&nbsp;<span class="builtintype" id="2520327">uint</span><span class="op" id="2520331">,</span>&nbsp;<span class="ident" id="2520333">err</span>&nbsp;<span class="builtintype" id="2520337">error</span><span class="op" id="2520342">)</span>&nbsp;<span class="op" id="2520344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2520347">var</span>&nbsp;<span class="ident" id="2520351">data</span>&nbsp;<span class="ident" id="2520356">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2520365">err</span>&nbsp;<span class="op" id="2520369">=</span>&nbsp;<span class="ident" id="2520371">ptrace</span><span class="op" id="2520377">(</span><span class="ident" id="2520378">PTRACE_GETEVENTMSG</span><span class="op" id="2520396">,</span>&nbsp;<span class="ident" id="2520398">pid</span><span class="op" id="2520401">,</span>&nbsp;<span class="num" id="2520403">0</span><span class="op" id="2520404">,</span>&nbsp;<span class="builtintype" id="2520406">uintptr</span><span class="op" id="2520413">(</span><span class="ident" id="2520414">unsafe</span><span class="op" id="2520420">.</span><span class="ident" id="2520421">Pointer</span><span class="op" id="2520428">(</span><span class="op" id="2520429">&amp;</span><span class="ident" id="2520430">data</span><span class="op" id="2520434">)</span><span class="op" id="2520435">)</span><span class="op" id="2520436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2520439">msg</span>&nbsp;<span class="op" id="2520443">=</span>&nbsp;<span class="builtintype" id="2520445">uint</span><span class="op" id="2520449">(</span><span class="ident" id="2520450">data</span><span class="op" id="2520454">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2520457">return</span><br>
<span class="lineno"></span><span class="op" id="2520464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2520467">func</span>&nbsp;<span class="ident" id="2520472">PtraceCont</span><span class="op" id="2520482">(</span><span class="ident" id="2520483">pid</span>&nbsp;<span class="builtintype" id="2520487">int</span><span class="op" id="2520490">,</span>&nbsp;<span class="ident" id="2520492">signal</span>&nbsp;<span class="builtintype" id="2520499">int</span><span class="op" id="2520502">)</span>&nbsp;<span class="op" id="2520504">(</span><span class="ident" id="2520505">err</span>&nbsp;<span class="builtintype" id="2520509">error</span><span class="op" id="2520514">)</span>&nbsp;<span class="op" id="2520516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2520519">return</span>&nbsp;<span class="ident" id="2520526">ptrace</span><span class="op" id="2520532">(</span><span class="ident" id="2520533">PTRACE_CONT</span><span class="op" id="2520544">,</span>&nbsp;<span class="ident" id="2520546">pid</span><span class="op" id="2520549">,</span>&nbsp;<span class="num" id="2520551">0</span><span class="op" id="2520552">,</span>&nbsp;<span class="builtintype" id="2520554">uintptr</span><span class="op" id="2520561">(</span><span class="ident" id="2520562">signal</span><span class="op" id="2520568">)</span><span class="op" id="2520569">)</span><br>
<span class="lineno">710</span><span class="op" id="2520571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2520574">func</span>&nbsp;<span class="ident" id="2520579">PtraceSyscall</span><span class="op" id="2520592">(</span><span class="ident" id="2520593">pid</span>&nbsp;<span class="builtintype" id="2520597">int</span><span class="op" id="2520600">,</span>&nbsp;<span class="ident" id="2520602">signal</span>&nbsp;<span class="builtintype" id="2520609">int</span><span class="op" id="2520612">)</span>&nbsp;<span class="op" id="2520614">(</span><span class="ident" id="2520615">err</span>&nbsp;<span class="builtintype" id="2520619">error</span><span class="op" id="2520624">)</span>&nbsp;<span class="op" id="2520626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2520629">return</span>&nbsp;<span class="ident" id="2520636">ptrace</span><span class="op" id="2520642">(</span><span class="ident" id="2520643">PTRACE_SYSCALL</span><span class="op" id="2520657">,</span>&nbsp;<span class="ident" id="2520659">pid</span><span class="op" id="2520662">,</span>&nbsp;<span class="num" id="2520664">0</span><span class="op" id="2520665">,</span>&nbsp;<span class="builtintype" id="2520667">uintptr</span><span class="op" id="2520674">(</span><span class="ident" id="2520675">signal</span><span class="op" id="2520681">)</span><span class="op" id="2520682">)</span><br>
<span class="lineno"></span><span class="op" id="2520684">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2520687">func</span>&nbsp;<span class="ident" id="2520692">PtraceSingleStep</span><span class="op" id="2520708">(</span><span class="ident" id="2520709">pid</span>&nbsp;<span class="builtintype" id="2520713">int</span><span class="op" id="2520716">)</span>&nbsp;<span class="op" id="2520718">(</span><span class="ident" id="2520719">err</span>&nbsp;<span class="builtintype" id="2520723">error</span><span class="op" id="2520728">)</span>&nbsp;<span class="op" id="2520730">{</span>&nbsp;<span class="keyword" id="2520732">return</span>&nbsp;<span class="ident" id="2520739">ptrace</span><span class="op" id="2520745">(</span><span class="ident" id="2520746">PTRACE_SINGLESTEP</span><span class="op" id="2520763">,</span>&nbsp;<span class="ident" id="2520765">pid</span><span class="op" id="2520768">,</span>&nbsp;<span class="num" id="2520770">0</span><span class="op" id="2520771">,</span>&nbsp;<span class="num" id="2520773">0</span><span class="op" id="2520774">)</span>&nbsp;<span class="op" id="2520776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2520779">func</span>&nbsp;<span class="ident" id="2520784">PtraceAttach</span><span class="op" id="2520796">(</span><span class="ident" id="2520797">pid</span>&nbsp;<span class="builtintype" id="2520801">int</span><span class="op" id="2520804">)</span>&nbsp;<span class="op" id="2520806">(</span><span class="ident" id="2520807">err</span>&nbsp;<span class="builtintype" id="2520811">error</span><span class="op" id="2520816">)</span>&nbsp;<span class="op" id="2520818">{</span>&nbsp;<span class="keyword" id="2520820">return</span>&nbsp;<span class="ident" id="2520827">ptrace</span><span class="op" id="2520833">(</span><span class="ident" id="2520834">PTRACE_ATTACH</span><span class="op" id="2520847">,</span>&nbsp;<span class="ident" id="2520849">pid</span><span class="op" id="2520852">,</span>&nbsp;<span class="num" id="2520854">0</span><span class="op" id="2520855">,</span>&nbsp;<span class="num" id="2520857">0</span><span class="op" id="2520858">)</span>&nbsp;<span class="op" id="2520860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2520863">func</span>&nbsp;<span class="ident" id="2520868">PtraceDetach</span><span class="op" id="2520880">(</span><span class="ident" id="2520881">pid</span>&nbsp;<span class="builtintype" id="2520885">int</span><span class="op" id="2520888">)</span>&nbsp;<span class="op" id="2520890">(</span><span class="ident" id="2520891">err</span>&nbsp;<span class="builtintype" id="2520895">error</span><span class="op" id="2520900">)</span>&nbsp;<span class="op" id="2520902">{</span>&nbsp;<span class="keyword" id="2520904">return</span>&nbsp;<span class="ident" id="2520911">ptrace</span><span class="op" id="2520917">(</span><span class="ident" id="2520918">PTRACE_DETACH</span><span class="op" id="2520931">,</span>&nbsp;<span class="ident" id="2520933">pid</span><span class="op" id="2520936">,</span>&nbsp;<span class="num" id="2520938">0</span><span class="op" id="2520939">,</span>&nbsp;<span class="num" id="2520941">0</span><span class="op" id="2520942">)</span>&nbsp;<span class="op" id="2520944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2520947">//sys&nbsp;&nbsp;&nbsp;&nbsp;reboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2521020">func</span>&nbsp;<span class="ident" id="2521025">Reboot</span><span class="op" id="2521031">(</span><span class="ident" id="2521032">cmd</span>&nbsp;<span class="builtintype" id="2521036">int</span><span class="op" id="2521039">)</span>&nbsp;<span class="op" id="2521041">(</span><span class="ident" id="2521042">err</span>&nbsp;<span class="builtintype" id="2521046">error</span><span class="op" id="2521051">)</span>&nbsp;<span class="op" id="2521053">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521056">return</span>&nbsp;<span class="ident" id="2521063">reboot</span><span class="op" id="2521069">(</span><span class="ident" id="2521070">LINUX_REBOOT_MAGIC1</span><span class="op" id="2521089">,</span>&nbsp;<span class="ident" id="2521091">LINUX_REBOOT_MAGIC2</span><span class="op" id="2521110">,</span>&nbsp;<span class="ident" id="2521112">cmd</span><span class="op" id="2521115">,</span>&nbsp;<span class="string" id="2521117">&#34;&#34;</span><span class="op" id="2521119">)</span><br>
<span class="lineno"></span><span class="op" id="2521121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2521124">func</span>&nbsp;<span class="ident" id="2521129">clen</span><span class="op" id="2521133">(</span><span class="ident" id="2521134">n</span>&nbsp;<span class="op" id="2521136">[</span><span class="op" id="2521137">]</span><span class="builtintype" id="2521138">byte</span><span class="op" id="2521142">)</span>&nbsp;<span class="builtintype" id="2521144">int</span>&nbsp;<span class="op" id="2521148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521151">for</span>&nbsp;<span class="ident" id="2521155">i</span>&nbsp;<span class="op" id="2521157">:=</span>&nbsp;<span class="num" id="2521160">0</span><span class="op" id="2521161">;</span>&nbsp;<span class="ident" id="2521163">i</span>&nbsp;<span class="op" id="2521165">&lt;</span>&nbsp;<span class="builtinfunc" id="2521167">len</span><span class="op" id="2521170">(</span><span class="ident" id="2521171">n</span><span class="op" id="2521172">)</span><span class="op" id="2521173">;</span>&nbsp;<span class="ident" id="2521175">i</span><span class="op" id="2521176">++</span>&nbsp;<span class="op" id="2521179">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521183">if</span>&nbsp;<span class="ident" id="2521186">n</span><span class="op" id="2521187">[</span><span class="ident" id="2521188">i</span><span class="op" id="2521189">]</span>&nbsp;<span class="op" id="2521191">==</span>&nbsp;<span class="num" id="2521194">0</span>&nbsp;<span class="op" id="2521196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521201">return</span>&nbsp;<span class="ident" id="2521208">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2521212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2521215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521218">return</span>&nbsp;<span class="builtinfunc" id="2521225">len</span><span class="op" id="2521228">(</span><span class="ident" id="2521229">n</span><span class="op" id="2521230">)</span><br>
<span class="lineno">735</span><span class="op" id="2521232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2521235">func</span>&nbsp;<span class="ident" id="2521240">ReadDirent</span><span class="op" id="2521250">(</span><span class="ident" id="2521251">fd</span>&nbsp;<span class="builtintype" id="2521254">int</span><span class="op" id="2521257">,</span>&nbsp;<span class="ident" id="2521259">buf</span>&nbsp;<span class="op" id="2521263">[</span><span class="op" id="2521264">]</span><span class="builtintype" id="2521265">byte</span><span class="op" id="2521269">)</span>&nbsp;<span class="op" id="2521271">(</span><span class="ident" id="2521272">n</span>&nbsp;<span class="builtintype" id="2521274">int</span><span class="op" id="2521277">,</span>&nbsp;<span class="ident" id="2521279">err</span>&nbsp;<span class="builtintype" id="2521283">error</span><span class="op" id="2521288">)</span>&nbsp;<span class="op" id="2521290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521293">return</span>&nbsp;<span class="ident" id="2521300">Getdents</span><span class="op" id="2521308">(</span><span class="ident" id="2521309">fd</span><span class="op" id="2521311">,</span>&nbsp;<span class="ident" id="2521313">buf</span><span class="op" id="2521316">)</span><br>
<span class="lineno"></span><span class="op" id="2521318">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2521321">func</span>&nbsp;<span class="ident" id="2521326">ParseDirent</span><span class="op" id="2521337">(</span><span class="ident" id="2521338">buf</span>&nbsp;<span class="op" id="2521342">[</span><span class="op" id="2521343">]</span><span class="builtintype" id="2521344">byte</span><span class="op" id="2521348">,</span>&nbsp;<span class="ident" id="2521350">max</span>&nbsp;<span class="builtintype" id="2521354">int</span><span class="op" id="2521357">,</span>&nbsp;<span class="ident" id="2521359">names</span>&nbsp;<span class="op" id="2521365">[</span><span class="op" id="2521366">]</span><span class="builtintype" id="2521367">string</span><span class="op" id="2521373">)</span>&nbsp;<span class="op" id="2521375">(</span><span class="ident" id="2521376">consumed</span>&nbsp;<span class="builtintype" id="2521385">int</span><span class="op" id="2521388">,</span>&nbsp;<span class="ident" id="2521390">count</span>&nbsp;<span class="builtintype" id="2521396">int</span><span class="op" id="2521399">,</span>&nbsp;<span class="ident" id="2521401">newnames</span>&nbsp;<span class="op" id="2521410">[</span><span class="op" id="2521411">]</span><span class="builtintype" id="2521412">string</span><span class="op" id="2521418">)</span>&nbsp;<span class="op" id="2521420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521423">origlen</span>&nbsp;<span class="op" id="2521431">:=</span>&nbsp;<span class="builtinfunc" id="2521434">len</span><span class="op" id="2521437">(</span><span class="ident" id="2521438">buf</span><span class="op" id="2521441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521444">count</span>&nbsp;<span class="op" id="2521450">=</span>&nbsp;<span class="num" id="2521452">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521455">for</span>&nbsp;<span class="ident" id="2521459">max</span>&nbsp;<span class="op" id="2521463">!=</span>&nbsp;<span class="num" id="2521466">0</span>&nbsp;<span class="op" id="2521468">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2521471">len</span><span class="op" id="2521474">(</span><span class="ident" id="2521475">buf</span><span class="op" id="2521478">)</span>&nbsp;<span class="op" id="2521480">&gt;</span>&nbsp;<span class="num" id="2521482">0</span>&nbsp;<span class="op" id="2521484">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521488">dirent</span>&nbsp;<span class="op" id="2521495">:=</span>&nbsp;<span class="op" id="2521498">(</span><span class="op" id="2521499">*</span><span class="ident" id="2521500">Dirent</span><span class="op" id="2521506">)</span><span class="op" id="2521507">(</span><span class="ident" id="2521508">unsafe</span><span class="op" id="2521514">.</span><span class="ident" id="2521515">Pointer</span><span class="op" id="2521522">(</span><span class="op" id="2521523">&amp;</span><span class="ident" id="2521524">buf</span><span class="op" id="2521527">[</span><span class="num" id="2521528">0</span><span class="op" id="2521529">]</span><span class="op" id="2521530">)</span><span class="op" id="2521531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521535">buf</span>&nbsp;<span class="op" id="2521539">=</span>&nbsp;<span class="ident" id="2521541">buf</span><span class="op" id="2521544">[</span><span class="ident" id="2521545">dirent</span><span class="op" id="2521551">.</span><span class="ident" id="2521552">Reclen</span><span class="op" id="2521558">:</span><span class="op" id="2521559">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521563">if</span>&nbsp;<span class="ident" id="2521566">dirent</span><span class="op" id="2521572">.</span><span class="ident" id="2521573">Ino</span>&nbsp;<span class="op" id="2521577">==</span>&nbsp;<span class="num" id="2521580">0</span>&nbsp;<span class="op" id="2521582">{</span>&nbsp;<span class="comment" id="2521584">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521616">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2521627">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521631">bytes</span>&nbsp;<span class="op" id="2521637">:=</span>&nbsp;<span class="op" id="2521640">(</span><span class="op" id="2521641">*</span><span class="op" id="2521642">[</span><span class="num" id="2521643">10000</span><span class="op" id="2521648">]</span><span class="builtintype" id="2521649">byte</span><span class="op" id="2521653">)</span><span class="op" id="2521654">(</span><span class="ident" id="2521655">unsafe</span><span class="op" id="2521661">.</span><span class="ident" id="2521662">Pointer</span><span class="op" id="2521669">(</span><span class="op" id="2521670">&amp;</span><span class="ident" id="2521671">dirent</span><span class="op" id="2521677">.</span><span class="ident" id="2521678">Name</span><span class="op" id="2521682">[</span><span class="num" id="2521683">0</span><span class="op" id="2521684">]</span><span class="op" id="2521685">)</span><span class="op" id="2521686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521690">var</span>&nbsp;<span class="ident" id="2521694">name</span>&nbsp;<span class="op" id="2521699">=</span>&nbsp;<span class="builtintype" id="2521701">string</span><span class="op" id="2521707">(</span><span class="ident" id="2521708">bytes</span><span class="op" id="2521713">[</span><span class="num" id="2521714">0</span><span class="op" id="2521715">:</span><span class="ident" id="2521716">clen</span><span class="op" id="2521720">(</span><span class="ident" id="2521721">bytes</span><span class="op" id="2521726">[</span><span class="op" id="2521727">:</span><span class="op" id="2521728">]</span><span class="op" id="2521729">)</span><span class="op" id="2521730">]</span><span class="op" id="2521731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521735">if</span>&nbsp;<span class="ident" id="2521738">name</span>&nbsp;<span class="op" id="2521743">==</span>&nbsp;<span class="string" id="2521746">&#34;.&#34;</span>&nbsp;<span class="op" id="2521750">||</span>&nbsp;<span class="ident" id="2521753">name</span>&nbsp;<span class="op" id="2521758">==</span>&nbsp;<span class="string" id="2521761">&#34;..&#34;</span>&nbsp;<span class="op" id="2521766">{</span>&nbsp;<span class="comment" id="2521768">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521788">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2521799">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521803">max</span><span class="op" id="2521806">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521811">count</span><span class="op" id="2521816">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521821">names</span>&nbsp;<span class="op" id="2521827">=</span>&nbsp;<span class="builtinfunc" id="2521829">append</span><span class="op" id="2521835">(</span><span class="ident" id="2521836">names</span><span class="op" id="2521841">,</span>&nbsp;<span class="ident" id="2521843">name</span><span class="op" id="2521847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2521850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521853">return</span>&nbsp;<span class="ident" id="2521860">origlen</span>&nbsp;<span class="op" id="2521868">-</span>&nbsp;<span class="builtinfunc" id="2521870">len</span><span class="op" id="2521873">(</span><span class="ident" id="2521874">buf</span><span class="op" id="2521877">)</span><span class="op" id="2521878">,</span>&nbsp;<span class="ident" id="2521880">count</span><span class="op" id="2521885">,</span>&nbsp;<span class="ident" id="2521887">names</span><br>
<span class="lineno">760</span><span class="op" id="2521893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2521896">//sys&nbsp;&nbsp;&nbsp;&nbsp;mount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2521993">func</span>&nbsp;<span class="ident" id="2521998">Mount</span><span class="op" id="2522003">(</span><span class="ident" id="2522004">source</span>&nbsp;<span class="builtintype" id="2522011">string</span><span class="op" id="2522017">,</span>&nbsp;<span class="ident" id="2522019">target</span>&nbsp;<span class="builtintype" id="2522026">string</span><span class="op" id="2522032">,</span>&nbsp;<span class="ident" id="2522034">fstype</span>&nbsp;<span class="builtintype" id="2522041">string</span><span class="op" id="2522047">,</span>&nbsp;<span class="ident" id="2522049">flags</span>&nbsp;<span class="builtintype" id="2522055">uintptr</span><span class="op" id="2522062">,</span>&nbsp;<span class="ident" id="2522064">data</span>&nbsp;<span class="builtintype" id="2522069">string</span><span class="op" id="2522075">)</span>&nbsp;<span class="op" id="2522077">(</span><span class="ident" id="2522078">err</span>&nbsp;<span class="builtintype" id="2522082">error</span><span class="op" id="2522087">)</span>&nbsp;<span class="op" id="2522089">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2522092">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2522157">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522209">if</span>&nbsp;<span class="ident" id="2522212">data</span>&nbsp;<span class="op" id="2522217">==</span>&nbsp;<span class="string" id="2522220">&#34;&#34;</span>&nbsp;<span class="op" id="2522223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522227">return</span>&nbsp;<span class="ident" id="2522234">mount</span><span class="op" id="2522239">(</span><span class="ident" id="2522240">source</span><span class="op" id="2522246">,</span>&nbsp;<span class="ident" id="2522248">target</span><span class="op" id="2522254">,</span>&nbsp;<span class="ident" id="2522256">fstype</span><span class="op" id="2522262">,</span>&nbsp;<span class="ident" id="2522264">flags</span><span class="op" id="2522269">,</span>&nbsp;<span class="builtintype" id="2522271">nil</span><span class="op" id="2522274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522277">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522280">datap</span><span class="op" id="2522285">,</span>&nbsp;<span class="ident" id="2522287">err</span>&nbsp;<span class="op" id="2522291">:=</span>&nbsp;<span class="ident" id="2522294">BytePtrFromString</span><span class="op" id="2522311">(</span><span class="ident" id="2522312">data</span><span class="op" id="2522316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522319">if</span>&nbsp;<span class="ident" id="2522322">err</span>&nbsp;<span class="op" id="2522326">!=</span>&nbsp;<span class="builtintype" id="2522329">nil</span>&nbsp;<span class="op" id="2522333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522337">return</span>&nbsp;<span class="ident" id="2522344">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522352">err</span>&nbsp;<span class="op" id="2522356">=</span>&nbsp;<span class="ident" id="2522358">mount</span><span class="op" id="2522363">(</span><span class="ident" id="2522364">source</span><span class="op" id="2522370">,</span>&nbsp;<span class="ident" id="2522372">target</span><span class="op" id="2522378">,</span>&nbsp;<span class="ident" id="2522380">fstype</span><span class="op" id="2522386">,</span>&nbsp;<span class="ident" id="2522388">flags</span><span class="op" id="2522393">,</span>&nbsp;<span class="ident" id="2522395">datap</span><span class="op" id="2522400">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522403">use</span><span class="op" id="2522406">(</span><span class="ident" id="2522407">unsafe</span><span class="op" id="2522413">.</span><span class="ident" id="2522414">Pointer</span><span class="op" id="2522421">(</span><span class="ident" id="2522422">datap</span><span class="op" id="2522427">)</span><span class="op" id="2522428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522431">return</span>&nbsp;<span class="ident" id="2522438">err</span><br>
<span class="lineno"></span><span class="op" id="2522442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2522445">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2522455">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2522467">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2522482">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2522506">//sys&nbsp;&nbsp;&nbsp;&nbsp;Access(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2522557">//sys&nbsp;&nbsp;&nbsp;&nbsp;Acct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2522593">//sys&nbsp;&nbsp;&nbsp;&nbsp;Adjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2522643">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2522680">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2522730">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2522768">//sys&nbsp;&nbsp;&nbsp;&nbsp;Close(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2522800">//sys&nbsp;&nbsp;&nbsp;&nbsp;Creat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2522858">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2522901">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2522948">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523006">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523056">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523107">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2523181">//sys&nbsp;&nbsp;&nbsp;&nbsp;EpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523257">//sys&nbsp;&nbsp;&nbsp;&nbsp;Exit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2523295">//sys&nbsp;&nbsp;&nbsp;&nbsp;Faccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523371">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523442">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2523475">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523521">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523596">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523676">//sys&nbsp;&nbsp;&nbsp;&nbsp;fcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523735">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2523771">//sys&nbsp;&nbsp;&nbsp;&nbsp;Flock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523812">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523844">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2523915">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2523962">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2523990">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2524017">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2524046">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524106">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524161">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Gettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2524188">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524262">//sys&nbsp;&nbsp;&nbsp;&nbsp;InotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524349">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524391">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524443">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2524517">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Kill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524563">//sys&nbsp;&nbsp;&nbsp;&nbsp;Klogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2524630">//sys&nbsp;&nbsp;&nbsp;&nbsp;Link(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524685">//sys&nbsp;&nbsp;&nbsp;&nbsp;Listxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524747">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2524797">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524860">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524919">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2524991">//sys&nbsp;&nbsp;&nbsp;&nbsp;Nanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525055">//sys&nbsp;&nbsp;&nbsp;&nbsp;Pause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2525081">//sys&nbsp;&nbsp;&nbsp;&nbsp;PivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2525157">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2525255">//sys&nbsp;&nbsp;&nbsp;&nbsp;read(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525303">//sys&nbsp;&nbsp;&nbsp;&nbsp;Readlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525362">//sys&nbsp;&nbsp;&nbsp;&nbsp;Removexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2525418">//sys&nbsp;&nbsp;&nbsp;&nbsp;Rename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525475">//sys&nbsp;&nbsp;&nbsp;&nbsp;Renameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525562">//sys&nbsp;&nbsp;&nbsp;&nbsp;Rmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525599">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525641">//sys&nbsp;&nbsp;&nbsp;&nbsp;Sethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2525681">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Setpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525728">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Setsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2525766">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Settimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2525813">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2525828">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2525908">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2525983">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2526054">func</span>&nbsp;<span class="ident" id="2526059">Setuid</span><span class="op" id="2526065">(</span><span class="ident" id="2526066">uid</span>&nbsp;<span class="builtintype" id="2526070">int</span><span class="op" id="2526073">)</span>&nbsp;<span class="op" id="2526075">(</span><span class="ident" id="2526076">err</span>&nbsp;<span class="builtintype" id="2526080">error</span><span class="op" id="2526085">)</span>&nbsp;<span class="op" id="2526087">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2526090">return</span>&nbsp;<span class="ident" id="2526097">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2526108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2526111">func</span>&nbsp;<span class="ident" id="2526116">Setgid</span><span class="op" id="2526122">(</span><span class="ident" id="2526123">uid</span>&nbsp;<span class="builtintype" id="2526127">int</span><span class="op" id="2526130">)</span>&nbsp;<span class="op" id="2526132">(</span><span class="ident" id="2526133">err</span>&nbsp;<span class="builtintype" id="2526137">error</span><span class="op" id="2526142">)</span>&nbsp;<span class="op" id="2526144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2526147">return</span>&nbsp;<span class="ident" id="2526154">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2526165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2526168">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526228">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526305">//sys&nbsp;&nbsp;&nbsp;&nbsp;Symlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2526363">//sys&nbsp;&nbsp;&nbsp;&nbsp;Sync()</span><br>
<span class="lineno"></span><span class="comment" id="2526376">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Sysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526421">//sys&nbsp;&nbsp;&nbsp;&nbsp;Tee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526490">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Tgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526548">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Times(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2526599">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Umask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2526637">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Uname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526677">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526715">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526766">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2526832">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526869">//sys&nbsp;&nbsp;&nbsp;&nbsp;Ustat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526917">//sys&nbsp;&nbsp;&nbsp;&nbsp;Utime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2526968">//sys&nbsp;&nbsp;&nbsp;&nbsp;write(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2527017">//sys&nbsp;&nbsp;&nbsp;&nbsp;exitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2527067">//sys&nbsp;&nbsp;&nbsp;&nbsp;readlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2527136">//sys&nbsp;&nbsp;&nbsp;&nbsp;writelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2527208">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2527264">//sys&nbsp;&nbsp;&nbsp;&nbsp;munmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2527320">var</span>&nbsp;<span class="ident" id="2527324">mapper</span>&nbsp;<span class="op" id="2527331">=</span>&nbsp;<span class="op" id="2527333">&amp;</span><span class="ident" id="2527334">mmapper</span><span class="op" id="2527341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527344">active</span><span class="op" id="2527350">:</span>&nbsp;<span class="builtinfunc" id="2527352">make</span><span class="op" id="2527356">(</span><span class="keyword" id="2527357">map</span><span class="op" id="2527360">[</span><span class="op" id="2527361">*</span><span class="builtintype" id="2527362">byte</span><span class="op" id="2527366">]</span><span class="op" id="2527367">[</span><span class="op" id="2527368">]</span><span class="builtintype" id="2527369">byte</span><span class="op" id="2527373">)</span><span class="op" id="2527374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527377">mmap</span><span class="op" id="2527381">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2527385">mmap</span><span class="op" id="2527389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527392">munmap</span><span class="op" id="2527398">:</span>&nbsp;<span class="ident" id="2527400">munmap</span><span class="op" id="2527406">,</span><br>
<span class="lineno">890</span><span class="op" id="2527408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2527411">func</span>&nbsp;<span class="ident" id="2527416">Mmap</span><span class="op" id="2527420">(</span><span class="ident" id="2527421">fd</span>&nbsp;<span class="builtintype" id="2527424">int</span><span class="op" id="2527427">,</span>&nbsp;<span class="ident" id="2527429">offset</span>&nbsp;<span class="ident" id="2527436">int64</span><span class="op" id="2527441">,</span>&nbsp;<span class="ident" id="2527443">length</span>&nbsp;<span class="builtintype" id="2527450">int</span><span class="op" id="2527453">,</span>&nbsp;<span class="ident" id="2527455">prot</span>&nbsp;<span class="builtintype" id="2527460">int</span><span class="op" id="2527463">,</span>&nbsp;<span class="ident" id="2527465">flags</span>&nbsp;<span class="builtintype" id="2527471">int</span><span class="op" id="2527474">)</span>&nbsp;<span class="op" id="2527476">(</span><span class="ident" id="2527477">data</span>&nbsp;<span class="op" id="2527482">[</span><span class="op" id="2527483">]</span><span class="builtintype" id="2527484">byte</span><span class="op" id="2527488">,</span>&nbsp;<span class="ident" id="2527490">err</span>&nbsp;<span class="builtintype" id="2527494">error</span><span class="op" id="2527499">)</span>&nbsp;<span class="op" id="2527501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527504">return</span>&nbsp;<span class="ident" id="2527511">mapper</span><span class="op" id="2527517">.</span><span class="ident" id="2527518">Mmap</span><span class="op" id="2527522">(</span><span class="ident" id="2527523">fd</span><span class="op" id="2527525">,</span>&nbsp;<span class="ident" id="2527527">offset</span><span class="op" id="2527533">,</span>&nbsp;<span class="ident" id="2527535">length</span><span class="op" id="2527541">,</span>&nbsp;<span class="ident" id="2527543">prot</span><span class="op" id="2527547">,</span>&nbsp;<span class="ident" id="2527549">flags</span><span class="op" id="2527554">)</span><br>
<span class="lineno"></span><span class="op" id="2527556">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2527559">func</span>&nbsp;<span class="ident" id="2527564">Munmap</span><span class="op" id="2527570">(</span><span class="ident" id="2527571">b</span>&nbsp;<span class="op" id="2527573">[</span><span class="op" id="2527574">]</span><span class="builtintype" id="2527575">byte</span><span class="op" id="2527579">)</span>&nbsp;<span class="op" id="2527581">(</span><span class="ident" id="2527582">err</span>&nbsp;<span class="builtintype" id="2527586">error</span><span class="op" id="2527591">)</span>&nbsp;<span class="op" id="2527593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2527596">return</span>&nbsp;<span class="ident" id="2527603">mapper</span><span class="op" id="2527609">.</span><span class="ident" id="2527610">Munmap</span><span class="op" id="2527616">(</span><span class="ident" id="2527617">b</span><span class="op" id="2527618">)</span><br>
<span class="lineno"></span><span class="op" id="2527620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2527623">//sys&nbsp;&nbsp;&nbsp;&nbsp;Madvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2527671">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2527718">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2527752">//sys&nbsp;&nbsp;&nbsp;&nbsp;Munlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2527788">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2527826">//sys&nbsp;&nbsp;&nbsp;&nbsp;Munlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2527858">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2527882">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2527892">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2527906">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2527915">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2527928">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2527935">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2527945">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2527955">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2527970">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2527986">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2528004">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2528020">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2528029">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2528045">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2528061">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2528076">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2528090">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2528106">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2528117">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2528127">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2528140">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2528153">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2528167">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2528175">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2528191">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2528204">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2528213">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2528230">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2528246">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2528263">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2528280">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2528293">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2528304">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2528316">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2528329">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2528344">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2528355">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2528367">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2528376">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2528389">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2528402">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2528415">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2528425">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2528438">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2528452">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2528469">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2528485">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2528498">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2528507">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2528523">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2528534">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2528547">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2528556">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2528569">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2528581">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2528597">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2528609">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2528619">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2528637">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2528652">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2528664">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2528674">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2528684">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2528694">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2528704">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2528714">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2528723">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2528737">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2528751">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2528766">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2528774">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2528783">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2528792">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2528804">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2528814">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2528825">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2528840">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2528852">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2528865">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2528874">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2528892">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2528906">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2528924">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2528939">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2528955">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2528972">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2528990">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2529005">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2529021">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2529039">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2529062">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2529085">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2529105">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2529122">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2529143">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2529165">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2529185">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2529202">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2529216">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2529228">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2529238">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2529248">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2529257">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2529271">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2529287">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2529304">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2529321">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2529338">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2529347">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2529357">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2529366">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2529376">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2529391">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2529403">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2529414">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2529424">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2529433">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2529448">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2529463">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2529482">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2529498">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2529514">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2529525">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2529545">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2529556">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2529567">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2529577">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2529590">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2529599">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2529610">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2529622">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2529633">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2529643">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
