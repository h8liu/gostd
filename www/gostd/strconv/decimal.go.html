<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html" class="current">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2193450">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2193505">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2193559">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2193610">//&nbsp;Multiprecision&nbsp;decimal&nbsp;numbers.</span><br>
<span class="lineno"></span><span class="comment" id="2193645">//&nbsp;For&nbsp;floating-point&nbsp;formatting&nbsp;only;&nbsp;not&nbsp;general&nbsp;purpose.</span><br>
<span class="lineno"></span><span class="comment" id="2193705">//&nbsp;Only&nbsp;operations&nbsp;are&nbsp;assign&nbsp;and&nbsp;(binary)&nbsp;left/right&nbsp;shift.</span><br>
<span class="lineno"></span><span class="comment" id="2193766">//&nbsp;Can&nbsp;do&nbsp;binary&nbsp;floating&nbsp;point&nbsp;in&nbsp;multiprecision&nbsp;decimal&nbsp;precisely</span><br>
<span class="lineno"></span><span class="comment" id="2193834">//&nbsp;because&nbsp;2&nbsp;divides&nbsp;10;&nbsp;cannot&nbsp;do&nbsp;decimal&nbsp;floating&nbsp;point</span><br>
<span class="lineno">10</span><span class="comment" id="2193892">//&nbsp;in&nbsp;multiprecision&nbsp;binary&nbsp;precisely.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2193932">package</span>&nbsp;<span class="ident" id="2193940">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2193949">type</span>&nbsp;<span class="ident" id="2193954">decimal</span>&nbsp;<span class="keyword" id="2193962">struct</span>&nbsp;<span class="op" id="2193969">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2193972">d</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2193978">[</span><span class="num" id="2193979">800</span><span class="op" id="2193982">]</span><span class="builtintype" id="2193983">byte</span>&nbsp;<span class="comment" id="2193988">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2193999">nd</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2194005">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194015">//&nbsp;number&nbsp;of&nbsp;digits&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194041">dp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2194047">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194057">//&nbsp;decimal&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194075">neg</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2194081">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194087">trunc</span>&nbsp;<span class="builtintype" id="2194093">bool</span>&nbsp;<span class="comment" id="2194098">//&nbsp;discarded&nbsp;nonzero&nbsp;digits&nbsp;beyond&nbsp;d[:nd]</span><br>
<span class="lineno">20</span><span class="op" id="2194140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2194143">func</span>&nbsp;<span class="op" id="2194148">(</span><span class="ident" id="2194149">a</span>&nbsp;<span class="op" id="2194151">*</span><span class="ident" id="2194152">decimal</span><span class="op" id="2194159">)</span>&nbsp;<span class="ident" id="2194161">String</span><span class="op" id="2194167">(</span><span class="op" id="2194168">)</span>&nbsp;<span class="builtintype" id="2194170">string</span>&nbsp;<span class="op" id="2194177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194180">n</span>&nbsp;<span class="op" id="2194182">:=</span>&nbsp;<span class="num" id="2194185">10</span>&nbsp;<span class="op" id="2194188">+</span>&nbsp;<span class="ident" id="2194190">a</span><span class="op" id="2194191">.</span><span class="ident" id="2194192">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194196">if</span>&nbsp;<span class="ident" id="2194199">a</span><span class="op" id="2194200">.</span><span class="ident" id="2194201">dp</span>&nbsp;<span class="op" id="2194204">&gt;</span>&nbsp;<span class="num" id="2194206">0</span>&nbsp;<span class="op" id="2194208">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194212">n</span>&nbsp;<span class="op" id="2194214">+=</span>&nbsp;<span class="ident" id="2194217">a</span><span class="op" id="2194218">.</span><span class="ident" id="2194219">dp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2194223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194226">if</span>&nbsp;<span class="ident" id="2194229">a</span><span class="op" id="2194230">.</span><span class="ident" id="2194231">dp</span>&nbsp;<span class="op" id="2194234">&lt;</span>&nbsp;<span class="num" id="2194236">0</span>&nbsp;<span class="op" id="2194238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194242">n</span>&nbsp;<span class="op" id="2194244">+=</span>&nbsp;<span class="op" id="2194247">-</span><span class="ident" id="2194248">a</span><span class="op" id="2194249">.</span><span class="ident" id="2194250">dp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2194254">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194258">buf</span>&nbsp;<span class="op" id="2194262">:=</span>&nbsp;<span class="builtinfunc" id="2194265">make</span><span class="op" id="2194269">(</span><span class="op" id="2194270">[</span><span class="op" id="2194271">]</span><span class="builtintype" id="2194272">byte</span><span class="op" id="2194276">,</span>&nbsp;<span class="ident" id="2194278">n</span><span class="op" id="2194279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194282">w</span>&nbsp;<span class="op" id="2194284">:=</span>&nbsp;<span class="num" id="2194287">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194290">switch</span>&nbsp;<span class="op" id="2194297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194300">case</span>&nbsp;<span class="ident" id="2194305">a</span><span class="op" id="2194306">.</span><span class="ident" id="2194307">nd</span>&nbsp;<span class="op" id="2194310">==</span>&nbsp;<span class="num" id="2194313">0</span><span class="op" id="2194314">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194318">return</span>&nbsp;<span class="string" id="2194325">&#34;0&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194331">case</span>&nbsp;<span class="ident" id="2194336">a</span><span class="op" id="2194337">.</span><span class="ident" id="2194338">dp</span>&nbsp;<span class="op" id="2194341">&lt;=</span>&nbsp;<span class="num" id="2194344">0</span><span class="op" id="2194345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2194349">//&nbsp;zeros&nbsp;fill&nbsp;space&nbsp;between&nbsp;decimal&nbsp;point&nbsp;and&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194404">buf</span><span class="op" id="2194407">[</span><span class="ident" id="2194408">w</span><span class="op" id="2194409">]</span>&nbsp;<span class="op" id="2194411">=</span>&nbsp;<span class="string" id="2194413">&#39;0&#39;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194419">w</span><span class="op" id="2194420">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194425">buf</span><span class="op" id="2194428">[</span><span class="ident" id="2194429">w</span><span class="op" id="2194430">]</span>&nbsp;<span class="op" id="2194432">=</span>&nbsp;<span class="string" id="2194434">&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194440">w</span><span class="op" id="2194441">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194446">w</span>&nbsp;<span class="op" id="2194448">+=</span>&nbsp;<span class="ident" id="2194451">digitZero</span><span class="op" id="2194460">(</span><span class="ident" id="2194461">buf</span><span class="op" id="2194464">[</span><span class="ident" id="2194465">w</span>&nbsp;<span class="op" id="2194467">:</span>&nbsp;<span class="ident" id="2194469">w</span><span class="op" id="2194470">+</span><span class="op" id="2194471">-</span><span class="ident" id="2194472">a</span><span class="op" id="2194473">.</span><span class="ident" id="2194474">dp</span><span class="op" id="2194476">]</span><span class="op" id="2194477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194481">w</span>&nbsp;<span class="op" id="2194483">+=</span>&nbsp;<span class="builtinfunc" id="2194486">copy</span><span class="op" id="2194490">(</span><span class="ident" id="2194491">buf</span><span class="op" id="2194494">[</span><span class="ident" id="2194495">w</span><span class="op" id="2194496">:</span><span class="op" id="2194497">]</span><span class="op" id="2194498">,</span>&nbsp;<span class="ident" id="2194500">a</span><span class="op" id="2194501">.</span><span class="ident" id="2194502">d</span><span class="op" id="2194503">[</span><span class="num" id="2194504">0</span><span class="op" id="2194505">:</span><span class="ident" id="2194506">a</span><span class="op" id="2194507">.</span><span class="ident" id="2194508">nd</span><span class="op" id="2194510">]</span><span class="op" id="2194511">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194515">case</span>&nbsp;<span class="ident" id="2194520">a</span><span class="op" id="2194521">.</span><span class="ident" id="2194522">dp</span>&nbsp;<span class="op" id="2194525">&lt;</span>&nbsp;<span class="ident" id="2194527">a</span><span class="op" id="2194528">.</span><span class="ident" id="2194529">nd</span><span class="op" id="2194531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2194535">//&nbsp;decimal&nbsp;point&nbsp;in&nbsp;middle&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194574">w</span>&nbsp;<span class="op" id="2194576">+=</span>&nbsp;<span class="builtinfunc" id="2194579">copy</span><span class="op" id="2194583">(</span><span class="ident" id="2194584">buf</span><span class="op" id="2194587">[</span><span class="ident" id="2194588">w</span><span class="op" id="2194589">:</span><span class="op" id="2194590">]</span><span class="op" id="2194591">,</span>&nbsp;<span class="ident" id="2194593">a</span><span class="op" id="2194594">.</span><span class="ident" id="2194595">d</span><span class="op" id="2194596">[</span><span class="num" id="2194597">0</span><span class="op" id="2194598">:</span><span class="ident" id="2194599">a</span><span class="op" id="2194600">.</span><span class="ident" id="2194601">dp</span><span class="op" id="2194603">]</span><span class="op" id="2194604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194608">buf</span><span class="op" id="2194611">[</span><span class="ident" id="2194612">w</span><span class="op" id="2194613">]</span>&nbsp;<span class="op" id="2194615">=</span>&nbsp;<span class="string" id="2194617">&#39;.&#39;</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194623">w</span><span class="op" id="2194624">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194629">w</span>&nbsp;<span class="op" id="2194631">+=</span>&nbsp;<span class="builtinfunc" id="2194634">copy</span><span class="op" id="2194638">(</span><span class="ident" id="2194639">buf</span><span class="op" id="2194642">[</span><span class="ident" id="2194643">w</span><span class="op" id="2194644">:</span><span class="op" id="2194645">]</span><span class="op" id="2194646">,</span>&nbsp;<span class="ident" id="2194648">a</span><span class="op" id="2194649">.</span><span class="ident" id="2194650">d</span><span class="op" id="2194651">[</span><span class="ident" id="2194652">a</span><span class="op" id="2194653">.</span><span class="ident" id="2194654">dp</span><span class="op" id="2194656">:</span><span class="ident" id="2194657">a</span><span class="op" id="2194658">.</span><span class="ident" id="2194659">nd</span><span class="op" id="2194661">]</span><span class="op" id="2194662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194666">default</span><span class="op" id="2194673">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2194677">//&nbsp;zeros&nbsp;fill&nbsp;space&nbsp;between&nbsp;digits&nbsp;and&nbsp;decimal&nbsp;point</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194732">w</span>&nbsp;<span class="op" id="2194734">+=</span>&nbsp;<span class="builtinfunc" id="2194737">copy</span><span class="op" id="2194741">(</span><span class="ident" id="2194742">buf</span><span class="op" id="2194745">[</span><span class="ident" id="2194746">w</span><span class="op" id="2194747">:</span><span class="op" id="2194748">]</span><span class="op" id="2194749">,</span>&nbsp;<span class="ident" id="2194751">a</span><span class="op" id="2194752">.</span><span class="ident" id="2194753">d</span><span class="op" id="2194754">[</span><span class="num" id="2194755">0</span><span class="op" id="2194756">:</span><span class="ident" id="2194757">a</span><span class="op" id="2194758">.</span><span class="ident" id="2194759">nd</span><span class="op" id="2194761">]</span><span class="op" id="2194762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194766">w</span>&nbsp;<span class="op" id="2194768">+=</span>&nbsp;<span class="ident" id="2194771">digitZero</span><span class="op" id="2194780">(</span><span class="ident" id="2194781">buf</span><span class="op" id="2194784">[</span><span class="ident" id="2194785">w</span>&nbsp;<span class="op" id="2194787">:</span>&nbsp;<span class="ident" id="2194789">w</span><span class="op" id="2194790">+</span><span class="ident" id="2194791">a</span><span class="op" id="2194792">.</span><span class="ident" id="2194793">dp</span><span class="op" id="2194795">-</span><span class="ident" id="2194796">a</span><span class="op" id="2194797">.</span><span class="ident" id="2194798">nd</span><span class="op" id="2194800">]</span><span class="op" id="2194801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2194804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194807">return</span>&nbsp;<span class="builtintype" id="2194814">string</span><span class="op" id="2194820">(</span><span class="ident" id="2194821">buf</span><span class="op" id="2194824">[</span><span class="num" id="2194825">0</span><span class="op" id="2194826">:</span><span class="ident" id="2194827">w</span><span class="op" id="2194828">]</span><span class="op" id="2194829">)</span><br>
<span class="lineno"></span><span class="op" id="2194831">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2194834">func</span>&nbsp;<span class="ident" id="2194839">digitZero</span><span class="op" id="2194848">(</span><span class="ident" id="2194849">dst</span>&nbsp;<span class="op" id="2194853">[</span><span class="op" id="2194854">]</span><span class="builtintype" id="2194855">byte</span><span class="op" id="2194859">)</span>&nbsp;<span class="builtintype" id="2194861">int</span>&nbsp;<span class="op" id="2194865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194868">for</span>&nbsp;<span class="ident" id="2194872">i</span>&nbsp;<span class="op" id="2194874">:=</span>&nbsp;<span class="keyword" id="2194877">range</span>&nbsp;<span class="ident" id="2194883">dst</span>&nbsp;<span class="op" id="2194887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2194891">dst</span><span class="op" id="2194894">[</span><span class="ident" id="2194895">i</span><span class="op" id="2194896">]</span>&nbsp;<span class="op" id="2194898">=</span>&nbsp;<span class="string" id="2194900">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2194905">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2194908">return</span>&nbsp;<span class="builtinfunc" id="2194915">len</span><span class="op" id="2194918">(</span><span class="ident" id="2194919">dst</span><span class="op" id="2194922">)</span><br>
<span class="lineno"></span><span class="op" id="2194924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2194927">//&nbsp;trim&nbsp;trailing&nbsp;zeros&nbsp;from&nbsp;number.</span><br>
<span class="lineno"></span><span class="comment" id="2194963">//&nbsp;(They&nbsp;are&nbsp;meaningless;&nbsp;the&nbsp;decimal&nbsp;point&nbsp;is&nbsp;tracked</span><br>
<span class="lineno">70</span><span class="comment" id="2195018">//&nbsp;independent&nbsp;of&nbsp;the&nbsp;number&nbsp;of&nbsp;digits.)</span><br>
<span class="lineno"></span><span class="keyword" id="2195059">func</span>&nbsp;<span class="ident" id="2195064">trim</span><span class="op" id="2195068">(</span><span class="ident" id="2195069">a</span>&nbsp;<span class="op" id="2195071">*</span><span class="ident" id="2195072">decimal</span><span class="op" id="2195079">)</span>&nbsp;<span class="op" id="2195081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2195084">for</span>&nbsp;<span class="ident" id="2195088">a</span><span class="op" id="2195089">.</span><span class="ident" id="2195090">nd</span>&nbsp;<span class="op" id="2195093">&gt;</span>&nbsp;<span class="num" id="2195095">0</span>&nbsp;<span class="op" id="2195097">&amp;&amp;</span>&nbsp;<span class="ident" id="2195100">a</span><span class="op" id="2195101">.</span><span class="ident" id="2195102">d</span><span class="op" id="2195103">[</span><span class="ident" id="2195104">a</span><span class="op" id="2195105">.</span><span class="ident" id="2195106">nd</span><span class="op" id="2195108">-</span><span class="num" id="2195109">1</span><span class="op" id="2195110">]</span>&nbsp;<span class="op" id="2195112">==</span>&nbsp;<span class="string" id="2195115">&#39;0&#39;</span>&nbsp;<span class="op" id="2195119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195123">a</span><span class="op" id="2195124">.</span><span class="ident" id="2195125">nd</span><span class="op" id="2195127">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2195131">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2195134">if</span>&nbsp;<span class="ident" id="2195137">a</span><span class="op" id="2195138">.</span><span class="ident" id="2195139">nd</span>&nbsp;<span class="op" id="2195142">==</span>&nbsp;<span class="num" id="2195145">0</span>&nbsp;<span class="op" id="2195147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195151">a</span><span class="op" id="2195152">.</span><span class="ident" id="2195153">dp</span>&nbsp;<span class="op" id="2195156">=</span>&nbsp;<span class="num" id="2195158">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2195161">}</span><br>
<span class="lineno"></span><span class="op" id="2195163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2195166">//&nbsp;Assign&nbsp;v&nbsp;to&nbsp;a.</span><br>
<span class="lineno"></span><span class="keyword" id="2195184">func</span>&nbsp;<span class="op" id="2195189">(</span><span class="ident" id="2195190">a</span>&nbsp;<span class="op" id="2195192">*</span><span class="ident" id="2195193">decimal</span><span class="op" id="2195200">)</span>&nbsp;<span class="ident" id="2195202">Assign</span><span class="op" id="2195208">(</span><span class="ident" id="2195209">v</span>&nbsp;<span class="ident" id="2195211">uint64</span><span class="op" id="2195217">)</span>&nbsp;<span class="op" id="2195219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2195222">var</span>&nbsp;<span class="ident" id="2195226">buf</span>&nbsp;<span class="op" id="2195230">[</span><span class="num" id="2195231">24</span><span class="op" id="2195233">]</span><span class="builtintype" id="2195234">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2195241">//&nbsp;Write&nbsp;reversed&nbsp;decimal&nbsp;in&nbsp;buf.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195276">n</span>&nbsp;<span class="op" id="2195278">:=</span>&nbsp;<span class="num" id="2195281">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2195284">for</span>&nbsp;<span class="ident" id="2195288">v</span>&nbsp;<span class="op" id="2195290">&gt;</span>&nbsp;<span class="num" id="2195292">0</span>&nbsp;<span class="op" id="2195294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195298">v1</span>&nbsp;<span class="op" id="2195301">:=</span>&nbsp;<span class="ident" id="2195304">v</span>&nbsp;<span class="op" id="2195306">/</span>&nbsp;<span class="num" id="2195308">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195313">v</span>&nbsp;<span class="op" id="2195315">-=</span>&nbsp;<span class="num" id="2195318">10</span>&nbsp;<span class="op" id="2195321">*</span>&nbsp;<span class="ident" id="2195323">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195328">buf</span><span class="op" id="2195331">[</span><span class="ident" id="2195332">n</span><span class="op" id="2195333">]</span>&nbsp;<span class="op" id="2195335">=</span>&nbsp;<span class="builtintype" id="2195337">byte</span><span class="op" id="2195341">(</span><span class="ident" id="2195342">v</span>&nbsp;<span class="op" id="2195344">+</span>&nbsp;<span class="string" id="2195346">&#39;0&#39;</span><span class="op" id="2195349">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195353">n</span><span class="op" id="2195354">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195359">v</span>&nbsp;<span class="op" id="2195361">=</span>&nbsp;<span class="ident" id="2195363">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2195367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2195371">//&nbsp;Reverse&nbsp;again&nbsp;to&nbsp;produce&nbsp;forward&nbsp;decimal&nbsp;in&nbsp;a.d.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195424">a</span><span class="op" id="2195425">.</span><span class="ident" id="2195426">nd</span>&nbsp;<span class="op" id="2195429">=</span>&nbsp;<span class="num" id="2195431">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2195434">for</span>&nbsp;<span class="ident" id="2195438">n</span><span class="op" id="2195439">--</span><span class="op" id="2195441">;</span>&nbsp;<span class="ident" id="2195443">n</span>&nbsp;<span class="op" id="2195445">&gt;=</span>&nbsp;<span class="num" id="2195448">0</span><span class="op" id="2195449">;</span>&nbsp;<span class="ident" id="2195451">n</span><span class="op" id="2195452">--</span>&nbsp;<span class="op" id="2195455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195459">a</span><span class="op" id="2195460">.</span><span class="ident" id="2195461">d</span><span class="op" id="2195462">[</span><span class="ident" id="2195463">a</span><span class="op" id="2195464">.</span><span class="ident" id="2195465">nd</span><span class="op" id="2195467">]</span>&nbsp;<span class="op" id="2195469">=</span>&nbsp;<span class="ident" id="2195471">buf</span><span class="op" id="2195474">[</span><span class="ident" id="2195475">n</span><span class="op" id="2195476">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195480">a</span><span class="op" id="2195481">.</span><span class="ident" id="2195482">nd</span><span class="op" id="2195484">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2195488">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195491">a</span><span class="op" id="2195492">.</span><span class="ident" id="2195493">dp</span>&nbsp;<span class="op" id="2195496">=</span>&nbsp;<span class="ident" id="2195498">a</span><span class="op" id="2195499">.</span><span class="ident" id="2195500">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195504">trim</span><span class="op" id="2195508">(</span><span class="ident" id="2195509">a</span><span class="op" id="2195510">)</span><br>
<span class="lineno"></span><span class="op" id="2195512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2195515">//&nbsp;Maximum&nbsp;shift&nbsp;that&nbsp;we&nbsp;can&nbsp;do&nbsp;in&nbsp;one&nbsp;pass&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno">105</span><span class="comment" id="2195577">//&nbsp;Signed&nbsp;int&nbsp;has&nbsp;31&nbsp;bits,&nbsp;and&nbsp;we&nbsp;have&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;accommodate&nbsp;9&lt;&lt;k.</span><br>
<span class="lineno"></span><span class="keyword" id="2195648">const</span>&nbsp;<span class="ident" id="2195654">maxShift</span>&nbsp;<span class="op" id="2195663">=</span>&nbsp;<span class="num" id="2195665">27</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2195669">//&nbsp;Binary&nbsp;shift&nbsp;right&nbsp;(*&nbsp;2)&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;maxShift&nbsp;to&nbsp;avoid&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2195742">func</span>&nbsp;<span class="ident" id="2195747">rightShift</span><span class="op" id="2195757">(</span><span class="ident" id="2195758">a</span>&nbsp;<span class="op" id="2195760">*</span><span class="ident" id="2195761">decimal</span><span class="op" id="2195768">,</span>&nbsp;<span class="ident" id="2195770">k</span>&nbsp;<span class="builtintype" id="2195772">uint</span><span class="op" id="2195776">)</span>&nbsp;<span class="op" id="2195778">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195781">r</span>&nbsp;<span class="op" id="2195783">:=</span>&nbsp;<span class="num" id="2195786">0</span>&nbsp;<span class="comment" id="2195788">//&nbsp;read&nbsp;pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195805">w</span>&nbsp;<span class="op" id="2195807">:=</span>&nbsp;<span class="num" id="2195810">0</span>&nbsp;<span class="comment" id="2195812">//&nbsp;write&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2195831">//&nbsp;Pick&nbsp;up&nbsp;enough&nbsp;leading&nbsp;digits&nbsp;to&nbsp;cover&nbsp;first&nbsp;shift.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2195887">n</span>&nbsp;<span class="op" id="2195889">:=</span>&nbsp;<span class="num" id="2195892">0</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2195895">for</span>&nbsp;<span class="op" id="2195899">;</span>&nbsp;<span class="ident" id="2195901">n</span><span class="op" id="2195902">&gt;&gt;</span><span class="ident" id="2195904">k</span>&nbsp;<span class="op" id="2195906">==</span>&nbsp;<span class="num" id="2195909">0</span><span class="op" id="2195910">;</span>&nbsp;<span class="ident" id="2195912">r</span><span class="op" id="2195913">++</span>&nbsp;<span class="op" id="2195916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2195920">if</span>&nbsp;<span class="ident" id="2195923">r</span>&nbsp;<span class="op" id="2195925">&gt;=</span>&nbsp;<span class="ident" id="2195928">a</span><span class="op" id="2195929">.</span><span class="ident" id="2195930">nd</span>&nbsp;<span class="op" id="2195933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2195938">if</span>&nbsp;<span class="ident" id="2195941">n</span>&nbsp;<span class="op" id="2195943">==</span>&nbsp;<span class="num" id="2195946">0</span>&nbsp;<span class="op" id="2195948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2195954">//&nbsp;a&nbsp;==&nbsp;0;&nbsp;shouldn&#39;t&nbsp;get&nbsp;here,&nbsp;but&nbsp;handle&nbsp;anyway.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196008">a</span><span class="op" id="2196009">.</span><span class="ident" id="2196010">nd</span>&nbsp;<span class="op" id="2196013">=</span>&nbsp;<span class="num" id="2196015">0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2196021">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2196031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2196036">for</span>&nbsp;<span class="ident" id="2196040">n</span><span class="op" id="2196041">&gt;&gt;</span><span class="ident" id="2196043">k</span>&nbsp;<span class="op" id="2196045">==</span>&nbsp;<span class="num" id="2196048">0</span>&nbsp;<span class="op" id="2196050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196056">n</span>&nbsp;<span class="op" id="2196058">=</span>&nbsp;<span class="ident" id="2196060">n</span>&nbsp;<span class="op" id="2196062">*</span>&nbsp;<span class="num" id="2196064">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196071">r</span><span class="op" id="2196072">++</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2196078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2196083">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2196091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196095">c</span>&nbsp;<span class="op" id="2196097">:=</span>&nbsp;<span class="builtintype" id="2196100">int</span><span class="op" id="2196103">(</span><span class="ident" id="2196104">a</span><span class="op" id="2196105">.</span><span class="ident" id="2196106">d</span><span class="op" id="2196107">[</span><span class="ident" id="2196108">r</span><span class="op" id="2196109">]</span><span class="op" id="2196110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196114">n</span>&nbsp;<span class="op" id="2196116">=</span>&nbsp;<span class="ident" id="2196118">n</span><span class="op" id="2196119">*</span><span class="num" id="2196120">10</span>&nbsp;<span class="op" id="2196123">+</span>&nbsp;<span class="ident" id="2196125">c</span>&nbsp;<span class="op" id="2196127">-</span>&nbsp;<span class="string" id="2196129">&#39;0&#39;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2196134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196137">a</span><span class="op" id="2196138">.</span><span class="ident" id="2196139">dp</span>&nbsp;<span class="op" id="2196142">-=</span>&nbsp;<span class="ident" id="2196145">r</span>&nbsp;<span class="op" id="2196147">-</span>&nbsp;<span class="num" id="2196149">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2196153">//&nbsp;Pick&nbsp;up&nbsp;a&nbsp;digit,&nbsp;put&nbsp;down&nbsp;a&nbsp;digit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2196192">for</span>&nbsp;<span class="op" id="2196196">;</span>&nbsp;<span class="ident" id="2196198">r</span>&nbsp;<span class="op" id="2196200">&lt;</span>&nbsp;<span class="ident" id="2196202">a</span><span class="op" id="2196203">.</span><span class="ident" id="2196204">nd</span><span class="op" id="2196206">;</span>&nbsp;<span class="ident" id="2196208">r</span><span class="op" id="2196209">++</span>&nbsp;<span class="op" id="2196212">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196216">c</span>&nbsp;<span class="op" id="2196218">:=</span>&nbsp;<span class="builtintype" id="2196221">int</span><span class="op" id="2196224">(</span><span class="ident" id="2196225">a</span><span class="op" id="2196226">.</span><span class="ident" id="2196227">d</span><span class="op" id="2196228">[</span><span class="ident" id="2196229">r</span><span class="op" id="2196230">]</span><span class="op" id="2196231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196235">dig</span>&nbsp;<span class="op" id="2196239">:=</span>&nbsp;<span class="ident" id="2196242">n</span>&nbsp;<span class="op" id="2196244">&gt;&gt;</span>&nbsp;<span class="ident" id="2196247">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196251">n</span>&nbsp;<span class="op" id="2196253">-=</span>&nbsp;<span class="ident" id="2196256">dig</span>&nbsp;<span class="op" id="2196260">&lt;&lt;</span>&nbsp;<span class="ident" id="2196263">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196267">a</span><span class="op" id="2196268">.</span><span class="ident" id="2196269">d</span><span class="op" id="2196270">[</span><span class="ident" id="2196271">w</span><span class="op" id="2196272">]</span>&nbsp;<span class="op" id="2196274">=</span>&nbsp;<span class="builtintype" id="2196276">byte</span><span class="op" id="2196280">(</span><span class="ident" id="2196281">dig</span>&nbsp;<span class="op" id="2196285">+</span>&nbsp;<span class="string" id="2196287">&#39;0&#39;</span><span class="op" id="2196290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196294">w</span><span class="op" id="2196295">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196300">n</span>&nbsp;<span class="op" id="2196302">=</span>&nbsp;<span class="ident" id="2196304">n</span><span class="op" id="2196305">*</span><span class="num" id="2196306">10</span>&nbsp;<span class="op" id="2196309">+</span>&nbsp;<span class="ident" id="2196311">c</span>&nbsp;<span class="op" id="2196313">-</span>&nbsp;<span class="string" id="2196315">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2196320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2196324">//&nbsp;Put&nbsp;down&nbsp;extra&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2196351">for</span>&nbsp;<span class="ident" id="2196355">n</span>&nbsp;<span class="op" id="2196357">&gt;</span>&nbsp;<span class="num" id="2196359">0</span>&nbsp;<span class="op" id="2196361">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196365">dig</span>&nbsp;<span class="op" id="2196369">:=</span>&nbsp;<span class="ident" id="2196372">n</span>&nbsp;<span class="op" id="2196374">&gt;&gt;</span>&nbsp;<span class="ident" id="2196377">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196381">n</span>&nbsp;<span class="op" id="2196383">-=</span>&nbsp;<span class="ident" id="2196386">dig</span>&nbsp;<span class="op" id="2196390">&lt;&lt;</span>&nbsp;<span class="ident" id="2196393">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2196397">if</span>&nbsp;<span class="ident" id="2196400">w</span>&nbsp;<span class="op" id="2196402">&lt;</span>&nbsp;<span class="builtinfunc" id="2196404">len</span><span class="op" id="2196407">(</span><span class="ident" id="2196408">a</span><span class="op" id="2196409">.</span><span class="ident" id="2196410">d</span><span class="op" id="2196411">)</span>&nbsp;<span class="op" id="2196413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196418">a</span><span class="op" id="2196419">.</span><span class="ident" id="2196420">d</span><span class="op" id="2196421">[</span><span class="ident" id="2196422">w</span><span class="op" id="2196423">]</span>&nbsp;<span class="op" id="2196425">=</span>&nbsp;<span class="builtintype" id="2196427">byte</span><span class="op" id="2196431">(</span><span class="ident" id="2196432">dig</span>&nbsp;<span class="op" id="2196436">+</span>&nbsp;<span class="string" id="2196438">&#39;0&#39;</span><span class="op" id="2196441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196446">w</span><span class="op" id="2196447">++</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2196452">}</span>&nbsp;<span class="keyword" id="2196454">else</span>&nbsp;<span class="keyword" id="2196459">if</span>&nbsp;<span class="ident" id="2196462">dig</span>&nbsp;<span class="op" id="2196466">&gt;</span>&nbsp;<span class="num" id="2196468">0</span>&nbsp;<span class="op" id="2196470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196475">a</span><span class="op" id="2196476">.</span><span class="ident" id="2196477">trunc</span>&nbsp;<span class="op" id="2196483">=</span>&nbsp;<span class="builtintype" id="2196485">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2196492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196496">n</span>&nbsp;<span class="op" id="2196498">=</span>&nbsp;<span class="ident" id="2196500">n</span>&nbsp;<span class="op" id="2196502">*</span>&nbsp;<span class="num" id="2196504">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2196508">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196512">a</span><span class="op" id="2196513">.</span><span class="ident" id="2196514">nd</span>&nbsp;<span class="op" id="2196517">=</span>&nbsp;<span class="ident" id="2196519">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196522">trim</span><span class="op" id="2196526">(</span><span class="ident" id="2196527">a</span><span class="op" id="2196528">)</span><br>
<span class="lineno"></span><span class="op" id="2196530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="2196533">//&nbsp;Cheat&nbsp;sheet&nbsp;for&nbsp;left&nbsp;shift:&nbsp;table&nbsp;indexed&nbsp;by&nbsp;shift&nbsp;count&nbsp;giving</span><br>
<span class="lineno"></span><span class="comment" id="2196600">//&nbsp;number&nbsp;of&nbsp;new&nbsp;digits&nbsp;that&nbsp;will&nbsp;be&nbsp;introduced&nbsp;by&nbsp;that&nbsp;shift.</span><br>
<span class="lineno"></span><span class="comment" id="2196663">//</span><br>
<span class="lineno"></span><span class="comment" id="2196666">//&nbsp;For&nbsp;example,&nbsp;leftcheats[4]&nbsp;=&nbsp;{2,&nbsp;&#34;625&#34;}.&nbsp;&nbsp;That&nbsp;means&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2196727">//&nbsp;if&nbsp;we&nbsp;are&nbsp;shifting&nbsp;by&nbsp;4&nbsp;(multiplying&nbsp;by&nbsp;16),&nbsp;it&nbsp;will&nbsp;add&nbsp;2&nbsp;digits</span><br>
<span class="lineno">165</span><span class="comment" id="2196796">//&nbsp;when&nbsp;the&nbsp;string&nbsp;prefix&nbsp;is&nbsp;&#34;625&#34;&nbsp;through&nbsp;&#34;999&#34;,&nbsp;and&nbsp;one&nbsp;fewer&nbsp;digit</span><br>
<span class="lineno"></span><span class="comment" id="2196866">//&nbsp;if&nbsp;the&nbsp;string&nbsp;prefix&nbsp;is&nbsp;&#34;000&#34;&nbsp;through&nbsp;&#34;624&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2196914">//</span><br>
<span class="lineno"></span><span class="comment" id="2196917">//&nbsp;Credit&nbsp;for&nbsp;this&nbsp;trick&nbsp;goes&nbsp;to&nbsp;Ken.</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="2196956">type</span>&nbsp;<span class="ident" id="2196961">leftCheat</span>&nbsp;<span class="keyword" id="2196971">struct</span>&nbsp;<span class="op" id="2196978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196981">delta</span>&nbsp;&nbsp;<span class="builtintype" id="2196988">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196995">//&nbsp;number&nbsp;of&nbsp;new&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197020">cutoff</span>&nbsp;<span class="builtintype" id="2197027">string</span>&nbsp;<span class="comment" id="2197034">//&nbsp;&nbsp;&nbsp;minus&nbsp;one&nbsp;digit&nbsp;if&nbsp;original&nbsp;&lt;&nbsp;a.</span><br>
<span class="lineno"></span><span class="op" id="2197072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="2197075">var</span>&nbsp;<span class="ident" id="2197079">leftcheats</span>&nbsp;<span class="op" id="2197090">=</span>&nbsp;<span class="op" id="2197092">[</span><span class="op" id="2197093">]</span><span class="ident" id="2197094">leftCheat</span><span class="op" id="2197103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2197106">//&nbsp;Leading&nbsp;digits&nbsp;of&nbsp;1/2^i&nbsp;=&nbsp;5^i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2197141">//&nbsp;5^23&nbsp;is&nbsp;not&nbsp;an&nbsp;exact&nbsp;64-bit&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2197196">//&nbsp;so&nbsp;have&nbsp;to&nbsp;use&nbsp;bc&nbsp;for&nbsp;the&nbsp;math.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2197232">/*<br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspseq&nbsp;27&nbsp;|&nbsp;sed&nbsp;&#39;s/^/5^/&#39;&nbsp;|&nbsp;bc&nbsp;|<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspawk&nbsp;&#39;BEGIN{&nbsp;print&nbsp;&#34;\tleftCheat{&nbsp;0,&nbsp;\&#34;\&#34;&nbsp;},&#34;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplog2&nbsp;=&nbsp;log(2)/log(10)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintf(&#34;\tleftCheat{&nbsp;%d,&nbsp;\&#34;%s\&#34;&nbsp;},\t//&nbsp;*&nbsp;%d\n&#34;,<br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspint(log2*NR+1),&nbsp;$0,&nbsp;2**NR)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}&#39;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197436">{</span><span class="num" id="2197437">0</span><span class="op" id="2197438">,</span>&nbsp;<span class="string" id="2197440">&#34;&#34;</span><span class="op" id="2197442">}</span><span class="op" id="2197443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197446">{</span><span class="num" id="2197447">1</span><span class="op" id="2197448">,</span>&nbsp;<span class="string" id="2197450">&#34;5&#34;</span><span class="op" id="2197453">}</span><span class="op" id="2197454">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197474">//&nbsp;*&nbsp;2</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197482">{</span><span class="num" id="2197483">1</span><span class="op" id="2197484">,</span>&nbsp;<span class="string" id="2197486">&#34;25&#34;</span><span class="op" id="2197490">}</span><span class="op" id="2197491">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197510">//&nbsp;*&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197518">{</span><span class="num" id="2197519">1</span><span class="op" id="2197520">,</span>&nbsp;<span class="string" id="2197522">&#34;125&#34;</span><span class="op" id="2197527">}</span><span class="op" id="2197528">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197546">//&nbsp;*&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197554">{</span><span class="num" id="2197555">2</span><span class="op" id="2197556">,</span>&nbsp;<span class="string" id="2197558">&#34;625&#34;</span><span class="op" id="2197563">}</span><span class="op" id="2197564">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197582">//&nbsp;*&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197591">{</span><span class="num" id="2197592">2</span><span class="op" id="2197593">,</span>&nbsp;<span class="string" id="2197595">&#34;3125&#34;</span><span class="op" id="2197601">}</span><span class="op" id="2197602">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197619">//&nbsp;*&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197628">{</span><span class="num" id="2197629">2</span><span class="op" id="2197630">,</span>&nbsp;<span class="string" id="2197632">&#34;15625&#34;</span><span class="op" id="2197639">}</span><span class="op" id="2197640">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197656">//&nbsp;*&nbsp;64</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197665">{</span><span class="num" id="2197666">3</span><span class="op" id="2197667">,</span>&nbsp;<span class="string" id="2197669">&#34;78125&#34;</span><span class="op" id="2197676">}</span><span class="op" id="2197677">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197693">//&nbsp;*&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197703">{</span><span class="num" id="2197704">3</span><span class="op" id="2197705">,</span>&nbsp;<span class="string" id="2197707">&#34;390625&#34;</span><span class="op" id="2197715">}</span><span class="op" id="2197716">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197731">//&nbsp;*&nbsp;256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197741">{</span><span class="num" id="2197742">3</span><span class="op" id="2197743">,</span>&nbsp;<span class="string" id="2197745">&#34;1953125&#34;</span><span class="op" id="2197754">}</span><span class="op" id="2197755">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197769">//&nbsp;*&nbsp;512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197779">{</span><span class="num" id="2197780">4</span><span class="op" id="2197781">,</span>&nbsp;<span class="string" id="2197783">&#34;9765625&#34;</span><span class="op" id="2197792">}</span><span class="op" id="2197793">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197807">//&nbsp;*&nbsp;1024</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197818">{</span><span class="num" id="2197819">4</span><span class="op" id="2197820">,</span>&nbsp;<span class="string" id="2197822">&#34;48828125&#34;</span><span class="op" id="2197832">}</span><span class="op" id="2197833">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197846">//&nbsp;*&nbsp;2048</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197857">{</span><span class="num" id="2197858">4</span><span class="op" id="2197859">,</span>&nbsp;<span class="string" id="2197861">&#34;244140625&#34;</span><span class="op" id="2197872">}</span><span class="op" id="2197873">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197885">//&nbsp;*&nbsp;4096</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197896">{</span><span class="num" id="2197897">4</span><span class="op" id="2197898">,</span>&nbsp;<span class="string" id="2197900">&#34;1220703125&#34;</span><span class="op" id="2197912">}</span><span class="op" id="2197913">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197924">//&nbsp;*&nbsp;8192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197935">{</span><span class="num" id="2197936">5</span><span class="op" id="2197937">,</span>&nbsp;<span class="string" id="2197939">&#34;6103515625&#34;</span><span class="op" id="2197951">}</span><span class="op" id="2197952">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197963">//&nbsp;*&nbsp;16384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197975">{</span><span class="num" id="2197976">5</span><span class="op" id="2197977">,</span>&nbsp;<span class="string" id="2197979">&#34;30517578125&#34;</span><span class="op" id="2197992">}</span><span class="op" id="2197993">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198003">//&nbsp;*&nbsp;32768</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198015">{</span><span class="num" id="2198016">5</span><span class="op" id="2198017">,</span>&nbsp;<span class="string" id="2198019">&#34;152587890625&#34;</span><span class="op" id="2198033">}</span><span class="op" id="2198034">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198043">//&nbsp;*&nbsp;65536</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198055">{</span><span class="num" id="2198056">6</span><span class="op" id="2198057">,</span>&nbsp;<span class="string" id="2198059">&#34;762939453125&#34;</span><span class="op" id="2198073">}</span><span class="op" id="2198074">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198083">//&nbsp;*&nbsp;131072</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198096">{</span><span class="num" id="2198097">6</span><span class="op" id="2198098">,</span>&nbsp;<span class="string" id="2198100">&#34;3814697265625&#34;</span><span class="op" id="2198115">}</span><span class="op" id="2198116">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198124">//&nbsp;*&nbsp;262144</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198137">{</span><span class="num" id="2198138">6</span><span class="op" id="2198139">,</span>&nbsp;<span class="string" id="2198141">&#34;19073486328125&#34;</span><span class="op" id="2198157">}</span><span class="op" id="2198158">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198165">//&nbsp;*&nbsp;524288</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198178">{</span><span class="num" id="2198179">7</span><span class="op" id="2198180">,</span>&nbsp;<span class="string" id="2198182">&#34;95367431640625&#34;</span><span class="op" id="2198198">}</span><span class="op" id="2198199">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198206">//&nbsp;*&nbsp;1048576</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198220">{</span><span class="num" id="2198221">7</span><span class="op" id="2198222">,</span>&nbsp;<span class="string" id="2198224">&#34;476837158203125&#34;</span><span class="op" id="2198241">}</span><span class="op" id="2198242">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198248">//&nbsp;*&nbsp;2097152</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198262">{</span><span class="num" id="2198263">7</span><span class="op" id="2198264">,</span>&nbsp;<span class="string" id="2198266">&#34;2384185791015625&#34;</span><span class="op" id="2198284">}</span><span class="op" id="2198285">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198290">//&nbsp;*&nbsp;4194304</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198304">{</span><span class="num" id="2198305">7</span><span class="op" id="2198306">,</span>&nbsp;<span class="string" id="2198308">&#34;11920928955078125&#34;</span><span class="op" id="2198327">}</span><span class="op" id="2198328">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2198332">//&nbsp;*&nbsp;8388608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198346">{</span><span class="num" id="2198347">8</span><span class="op" id="2198348">,</span>&nbsp;<span class="string" id="2198350">&#34;59604644775390625&#34;</span><span class="op" id="2198369">}</span><span class="op" id="2198370">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2198374">//&nbsp;*&nbsp;16777216</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198389">{</span><span class="num" id="2198390">8</span><span class="op" id="2198391">,</span>&nbsp;<span class="string" id="2198393">&#34;298023223876953125&#34;</span><span class="op" id="2198413">}</span><span class="op" id="2198414">,</span>&nbsp;&nbsp;<span class="comment" id="2198417">//&nbsp;*&nbsp;33554432</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198432">{</span><span class="num" id="2198433">8</span><span class="op" id="2198434">,</span>&nbsp;<span class="string" id="2198436">&#34;1490116119384765625&#34;</span><span class="op" id="2198457">}</span><span class="op" id="2198458">,</span>&nbsp;<span class="comment" id="2198460">//&nbsp;*&nbsp;67108864</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198475">{</span><span class="num" id="2198476">9</span><span class="op" id="2198477">,</span>&nbsp;<span class="string" id="2198479">&#34;7450580596923828125&#34;</span><span class="op" id="2198500">}</span><span class="op" id="2198501">,</span>&nbsp;<span class="comment" id="2198503">//&nbsp;*&nbsp;134217728</span><br>
<span class="lineno"></span><span class="op" id="2198518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2198521">//&nbsp;Is&nbsp;the&nbsp;leading&nbsp;prefix&nbsp;of&nbsp;b&nbsp;lexicographically&nbsp;less&nbsp;than&nbsp;s?</span><br>
<span class="lineno"></span><span class="keyword" id="2198582">func</span>&nbsp;<span class="ident" id="2198587">prefixIsLessThan</span><span class="op" id="2198603">(</span><span class="ident" id="2198604">b</span>&nbsp;<span class="op" id="2198606">[</span><span class="op" id="2198607">]</span><span class="builtintype" id="2198608">byte</span><span class="op" id="2198612">,</span>&nbsp;<span class="ident" id="2198614">s</span>&nbsp;<span class="builtintype" id="2198616">string</span><span class="op" id="2198622">)</span>&nbsp;<span class="builtintype" id="2198624">bool</span>&nbsp;<span class="op" id="2198629">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198632">for</span>&nbsp;<span class="ident" id="2198636">i</span>&nbsp;<span class="op" id="2198638">:=</span>&nbsp;<span class="num" id="2198641">0</span><span class="op" id="2198642">;</span>&nbsp;<span class="ident" id="2198644">i</span>&nbsp;<span class="op" id="2198646">&lt;</span>&nbsp;<span class="builtinfunc" id="2198648">len</span><span class="op" id="2198651">(</span><span class="ident" id="2198652">s</span><span class="op" id="2198653">)</span><span class="op" id="2198654">;</span>&nbsp;<span class="ident" id="2198656">i</span><span class="op" id="2198657">++</span>&nbsp;<span class="op" id="2198660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198664">if</span>&nbsp;<span class="ident" id="2198667">i</span>&nbsp;<span class="op" id="2198669">&gt;=</span>&nbsp;<span class="builtinfunc" id="2198672">len</span><span class="op" id="2198675">(</span><span class="ident" id="2198676">b</span><span class="op" id="2198677">)</span>&nbsp;<span class="op" id="2198679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198684">return</span>&nbsp;<span class="builtintype" id="2198691">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198702">if</span>&nbsp;<span class="ident" id="2198705">b</span><span class="op" id="2198706">[</span><span class="ident" id="2198707">i</span><span class="op" id="2198708">]</span>&nbsp;<span class="op" id="2198710">!=</span>&nbsp;<span class="ident" id="2198713">s</span><span class="op" id="2198714">[</span><span class="ident" id="2198715">i</span><span class="op" id="2198716">]</span>&nbsp;<span class="op" id="2198718">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198723">return</span>&nbsp;<span class="ident" id="2198730">b</span><span class="op" id="2198731">[</span><span class="ident" id="2198732">i</span><span class="op" id="2198733">]</span>&nbsp;<span class="op" id="2198735">&lt;</span>&nbsp;<span class="ident" id="2198737">s</span><span class="op" id="2198738">[</span><span class="ident" id="2198739">i</span><span class="op" id="2198740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198750">return</span>&nbsp;<span class="builtintype" id="2198757">false</span><br>
<span class="lineno"></span><span class="op" id="2198763">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2198766">//&nbsp;Binary&nbsp;shift&nbsp;left&nbsp;(/&nbsp;2)&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;maxShift&nbsp;to&nbsp;avoid&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2198838">func</span>&nbsp;<span class="ident" id="2198843">leftShift</span><span class="op" id="2198852">(</span><span class="ident" id="2198853">a</span>&nbsp;<span class="op" id="2198855">*</span><span class="ident" id="2198856">decimal</span><span class="op" id="2198863">,</span>&nbsp;<span class="ident" id="2198865">k</span>&nbsp;<span class="builtintype" id="2198867">uint</span><span class="op" id="2198871">)</span>&nbsp;<span class="op" id="2198873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198876">delta</span>&nbsp;<span class="op" id="2198882">:=</span>&nbsp;<span class="ident" id="2198885">leftcheats</span><span class="op" id="2198895">[</span><span class="ident" id="2198896">k</span><span class="op" id="2198897">]</span><span class="op" id="2198898">.</span><span class="ident" id="2198899">delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198906">if</span>&nbsp;<span class="ident" id="2198909">prefixIsLessThan</span><span class="op" id="2198925">(</span><span class="ident" id="2198926">a</span><span class="op" id="2198927">.</span><span class="ident" id="2198928">d</span><span class="op" id="2198929">[</span><span class="num" id="2198930">0</span><span class="op" id="2198931">:</span><span class="ident" id="2198932">a</span><span class="op" id="2198933">.</span><span class="ident" id="2198934">nd</span><span class="op" id="2198936">]</span><span class="op" id="2198937">,</span>&nbsp;<span class="ident" id="2198939">leftcheats</span><span class="op" id="2198949">[</span><span class="ident" id="2198950">k</span><span class="op" id="2198951">]</span><span class="op" id="2198952">.</span><span class="ident" id="2198953">cutoff</span><span class="op" id="2198959">)</span>&nbsp;<span class="op" id="2198961">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198965">delta</span><span class="op" id="2198970">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198978">r</span>&nbsp;<span class="op" id="2198980">:=</span>&nbsp;<span class="ident" id="2198983">a</span><span class="op" id="2198984">.</span><span class="ident" id="2198985">nd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198996">//&nbsp;read&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199011">w</span>&nbsp;<span class="op" id="2199013">:=</span>&nbsp;<span class="ident" id="2199016">a</span><span class="op" id="2199017">.</span><span class="ident" id="2199018">nd</span>&nbsp;<span class="op" id="2199021">+</span>&nbsp;<span class="ident" id="2199023">delta</span>&nbsp;<span class="comment" id="2199029">//&nbsp;write&nbsp;index</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199045">n</span>&nbsp;<span class="op" id="2199047">:=</span>&nbsp;<span class="num" id="2199050">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2199054">//&nbsp;Pick&nbsp;up&nbsp;a&nbsp;digit,&nbsp;put&nbsp;down&nbsp;a&nbsp;digit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199093">for</span>&nbsp;<span class="ident" id="2199097">r</span><span class="op" id="2199098">--</span><span class="op" id="2199100">;</span>&nbsp;<span class="ident" id="2199102">r</span>&nbsp;<span class="op" id="2199104">&gt;=</span>&nbsp;<span class="num" id="2199107">0</span><span class="op" id="2199108">;</span>&nbsp;<span class="ident" id="2199110">r</span><span class="op" id="2199111">--</span>&nbsp;<span class="op" id="2199114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199118">n</span>&nbsp;<span class="op" id="2199120">+=</span>&nbsp;<span class="op" id="2199123">(</span><span class="builtintype" id="2199124">int</span><span class="op" id="2199127">(</span><span class="ident" id="2199128">a</span><span class="op" id="2199129">.</span><span class="ident" id="2199130">d</span><span class="op" id="2199131">[</span><span class="ident" id="2199132">r</span><span class="op" id="2199133">]</span><span class="op" id="2199134">)</span>&nbsp;<span class="op" id="2199136">-</span>&nbsp;<span class="string" id="2199138">&#39;0&#39;</span><span class="op" id="2199141">)</span>&nbsp;<span class="op" id="2199143">&lt;&lt;</span>&nbsp;<span class="ident" id="2199146">k</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199150">quo</span>&nbsp;<span class="op" id="2199154">:=</span>&nbsp;<span class="ident" id="2199157">n</span>&nbsp;<span class="op" id="2199159">/</span>&nbsp;<span class="num" id="2199161">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199166">rem</span>&nbsp;<span class="op" id="2199170">:=</span>&nbsp;<span class="ident" id="2199173">n</span>&nbsp;<span class="op" id="2199175">-</span>&nbsp;<span class="num" id="2199177">10</span><span class="op" id="2199179">*</span><span class="ident" id="2199180">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199186">w</span><span class="op" id="2199187">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199192">if</span>&nbsp;<span class="ident" id="2199195">w</span>&nbsp;<span class="op" id="2199197">&lt;</span>&nbsp;<span class="builtinfunc" id="2199199">len</span><span class="op" id="2199202">(</span><span class="ident" id="2199203">a</span><span class="op" id="2199204">.</span><span class="ident" id="2199205">d</span><span class="op" id="2199206">)</span>&nbsp;<span class="op" id="2199208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199213">a</span><span class="op" id="2199214">.</span><span class="ident" id="2199215">d</span><span class="op" id="2199216">[</span><span class="ident" id="2199217">w</span><span class="op" id="2199218">]</span>&nbsp;<span class="op" id="2199220">=</span>&nbsp;<span class="builtintype" id="2199222">byte</span><span class="op" id="2199226">(</span><span class="ident" id="2199227">rem</span>&nbsp;<span class="op" id="2199231">+</span>&nbsp;<span class="string" id="2199233">&#39;0&#39;</span><span class="op" id="2199236">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199240">}</span>&nbsp;<span class="keyword" id="2199242">else</span>&nbsp;<span class="keyword" id="2199247">if</span>&nbsp;<span class="ident" id="2199250">rem</span>&nbsp;<span class="op" id="2199254">!=</span>&nbsp;<span class="num" id="2199257">0</span>&nbsp;<span class="op" id="2199259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199264">a</span><span class="op" id="2199265">.</span><span class="ident" id="2199266">trunc</span>&nbsp;<span class="op" id="2199272">=</span>&nbsp;<span class="builtintype" id="2199274">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199285">n</span>&nbsp;<span class="op" id="2199287">=</span>&nbsp;<span class="ident" id="2199289">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199294">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2199298">//&nbsp;Put&nbsp;down&nbsp;extra&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199325">for</span>&nbsp;<span class="ident" id="2199329">n</span>&nbsp;<span class="op" id="2199331">&gt;</span>&nbsp;<span class="num" id="2199333">0</span>&nbsp;<span class="op" id="2199335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199339">quo</span>&nbsp;<span class="op" id="2199343">:=</span>&nbsp;<span class="ident" id="2199346">n</span>&nbsp;<span class="op" id="2199348">/</span>&nbsp;<span class="num" id="2199350">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199355">rem</span>&nbsp;<span class="op" id="2199359">:=</span>&nbsp;<span class="ident" id="2199362">n</span>&nbsp;<span class="op" id="2199364">-</span>&nbsp;<span class="num" id="2199366">10</span><span class="op" id="2199368">*</span><span class="ident" id="2199369">quo</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199375">w</span><span class="op" id="2199376">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199381">if</span>&nbsp;<span class="ident" id="2199384">w</span>&nbsp;<span class="op" id="2199386">&lt;</span>&nbsp;<span class="builtinfunc" id="2199388">len</span><span class="op" id="2199391">(</span><span class="ident" id="2199392">a</span><span class="op" id="2199393">.</span><span class="ident" id="2199394">d</span><span class="op" id="2199395">)</span>&nbsp;<span class="op" id="2199397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199402">a</span><span class="op" id="2199403">.</span><span class="ident" id="2199404">d</span><span class="op" id="2199405">[</span><span class="ident" id="2199406">w</span><span class="op" id="2199407">]</span>&nbsp;<span class="op" id="2199409">=</span>&nbsp;<span class="builtintype" id="2199411">byte</span><span class="op" id="2199415">(</span><span class="ident" id="2199416">rem</span>&nbsp;<span class="op" id="2199420">+</span>&nbsp;<span class="string" id="2199422">&#39;0&#39;</span><span class="op" id="2199425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199429">}</span>&nbsp;<span class="keyword" id="2199431">else</span>&nbsp;<span class="keyword" id="2199436">if</span>&nbsp;<span class="ident" id="2199439">rem</span>&nbsp;<span class="op" id="2199443">!=</span>&nbsp;<span class="num" id="2199446">0</span>&nbsp;<span class="op" id="2199448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199453">a</span><span class="op" id="2199454">.</span><span class="ident" id="2199455">trunc</span>&nbsp;<span class="op" id="2199461">=</span>&nbsp;<span class="builtintype" id="2199463">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199474">n</span>&nbsp;<span class="op" id="2199476">=</span>&nbsp;<span class="ident" id="2199478">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199487">a</span><span class="op" id="2199488">.</span><span class="ident" id="2199489">nd</span>&nbsp;<span class="op" id="2199492">+=</span>&nbsp;<span class="ident" id="2199495">delta</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199502">if</span>&nbsp;<span class="ident" id="2199505">a</span><span class="op" id="2199506">.</span><span class="ident" id="2199507">nd</span>&nbsp;<span class="op" id="2199510">&gt;=</span>&nbsp;<span class="builtinfunc" id="2199513">len</span><span class="op" id="2199516">(</span><span class="ident" id="2199517">a</span><span class="op" id="2199518">.</span><span class="ident" id="2199519">d</span><span class="op" id="2199520">)</span>&nbsp;<span class="op" id="2199522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199526">a</span><span class="op" id="2199527">.</span><span class="ident" id="2199528">nd</span>&nbsp;<span class="op" id="2199531">=</span>&nbsp;<span class="builtinfunc" id="2199533">len</span><span class="op" id="2199536">(</span><span class="ident" id="2199537">a</span><span class="op" id="2199538">.</span><span class="ident" id="2199539">d</span><span class="op" id="2199540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199546">a</span><span class="op" id="2199547">.</span><span class="ident" id="2199548">dp</span>&nbsp;<span class="op" id="2199551">+=</span>&nbsp;<span class="ident" id="2199554">delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199561">trim</span><span class="op" id="2199565">(</span><span class="ident" id="2199566">a</span><span class="op" id="2199567">)</span><br>
<span class="lineno">275</span><span class="op" id="2199569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2199572">//&nbsp;Binary&nbsp;shift&nbsp;left&nbsp;(k&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(k&nbsp;&lt;&nbsp;0).</span><br>
<span class="lineno"></span><span class="keyword" id="2199619">func</span>&nbsp;<span class="op" id="2199624">(</span><span class="ident" id="2199625">a</span>&nbsp;<span class="op" id="2199627">*</span><span class="ident" id="2199628">decimal</span><span class="op" id="2199635">)</span>&nbsp;<span class="ident" id="2199637">Shift</span><span class="op" id="2199642">(</span><span class="ident" id="2199643">k</span>&nbsp;<span class="builtintype" id="2199645">int</span><span class="op" id="2199648">)</span>&nbsp;<span class="op" id="2199650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199653">switch</span>&nbsp;<span class="op" id="2199660">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199663">case</span>&nbsp;<span class="ident" id="2199668">a</span><span class="op" id="2199669">.</span><span class="ident" id="2199670">nd</span>&nbsp;<span class="op" id="2199673">==</span>&nbsp;<span class="num" id="2199676">0</span><span class="op" id="2199677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2199681">//&nbsp;nothing&nbsp;to&nbsp;do:&nbsp;a&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199707">case</span>&nbsp;<span class="ident" id="2199712">k</span>&nbsp;<span class="op" id="2199714">&gt;</span>&nbsp;<span class="num" id="2199716">0</span><span class="op" id="2199717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199721">for</span>&nbsp;<span class="ident" id="2199725">k</span>&nbsp;<span class="op" id="2199727">&gt;</span>&nbsp;<span class="ident" id="2199729">maxShift</span>&nbsp;<span class="op" id="2199738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199743">leftShift</span><span class="op" id="2199752">(</span><span class="ident" id="2199753">a</span><span class="op" id="2199754">,</span>&nbsp;<span class="ident" id="2199756">maxShift</span><span class="op" id="2199764">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199769">k</span>&nbsp;<span class="op" id="2199771">-=</span>&nbsp;<span class="ident" id="2199774">maxShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199789">leftShift</span><span class="op" id="2199798">(</span><span class="ident" id="2199799">a</span><span class="op" id="2199800">,</span>&nbsp;<span class="builtintype" id="2199802">uint</span><span class="op" id="2199806">(</span><span class="ident" id="2199807">k</span><span class="op" id="2199808">)</span><span class="op" id="2199809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199812">case</span>&nbsp;<span class="ident" id="2199817">k</span>&nbsp;<span class="op" id="2199819">&lt;</span>&nbsp;<span class="num" id="2199821">0</span><span class="op" id="2199822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2199826">for</span>&nbsp;<span class="ident" id="2199830">k</span>&nbsp;<span class="op" id="2199832">&lt;</span>&nbsp;<span class="op" id="2199834">-</span><span class="ident" id="2199835">maxShift</span>&nbsp;<span class="op" id="2199844">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199849">rightShift</span><span class="op" id="2199859">(</span><span class="ident" id="2199860">a</span><span class="op" id="2199861">,</span>&nbsp;<span class="ident" id="2199863">maxShift</span><span class="op" id="2199871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199876">k</span>&nbsp;<span class="op" id="2199878">+=</span>&nbsp;<span class="ident" id="2199881">maxShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2199896">rightShift</span><span class="op" id="2199906">(</span><span class="ident" id="2199907">a</span><span class="op" id="2199908">,</span>&nbsp;<span class="builtintype" id="2199910">uint</span><span class="op" id="2199914">(</span><span class="op" id="2199915">-</span><span class="ident" id="2199916">k</span><span class="op" id="2199917">)</span><span class="op" id="2199918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2199921">}</span><br>
<span class="lineno">295</span><span class="op" id="2199923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2199926">//&nbsp;If&nbsp;we&nbsp;chop&nbsp;a&nbsp;at&nbsp;nd&nbsp;digits,&nbsp;should&nbsp;we&nbsp;round&nbsp;up?</span><br>
<span class="lineno"></span><span class="keyword" id="2199976">func</span>&nbsp;<span class="ident" id="2199981">shouldRoundUp</span><span class="op" id="2199994">(</span><span class="ident" id="2199995">a</span>&nbsp;<span class="op" id="2199997">*</span><span class="ident" id="2199998">decimal</span><span class="op" id="2200005">,</span>&nbsp;<span class="ident" id="2200007">nd</span>&nbsp;<span class="builtintype" id="2200010">int</span><span class="op" id="2200013">)</span>&nbsp;<span class="builtintype" id="2200015">bool</span>&nbsp;<span class="op" id="2200020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200023">if</span>&nbsp;<span class="ident" id="2200026">nd</span>&nbsp;<span class="op" id="2200029">&lt;</span>&nbsp;<span class="num" id="2200031">0</span>&nbsp;<span class="op" id="2200033">||</span>&nbsp;<span class="ident" id="2200036">nd</span>&nbsp;<span class="op" id="2200039">&gt;=</span>&nbsp;<span class="ident" id="2200042">a</span><span class="op" id="2200043">.</span><span class="ident" id="2200044">nd</span>&nbsp;<span class="op" id="2200047">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200051">return</span>&nbsp;<span class="builtintype" id="2200058">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2200065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200068">if</span>&nbsp;<span class="ident" id="2200071">a</span><span class="op" id="2200072">.</span><span class="ident" id="2200073">d</span><span class="op" id="2200074">[</span><span class="ident" id="2200075">nd</span><span class="op" id="2200077">]</span>&nbsp;<span class="op" id="2200079">==</span>&nbsp;<span class="string" id="2200082">&#39;5&#39;</span>&nbsp;<span class="op" id="2200086">&amp;&amp;</span>&nbsp;<span class="ident" id="2200089">nd</span><span class="op" id="2200091">+</span><span class="num" id="2200092">1</span>&nbsp;<span class="op" id="2200094">==</span>&nbsp;<span class="ident" id="2200097">a</span><span class="op" id="2200098">.</span><span class="ident" id="2200099">nd</span>&nbsp;<span class="op" id="2200102">{</span>&nbsp;<span class="comment" id="2200104">//&nbsp;exactly&nbsp;halfway&nbsp;-&nbsp;round&nbsp;to&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2200141">//&nbsp;if&nbsp;we&nbsp;truncated,&nbsp;a&nbsp;little&nbsp;higher&nbsp;than&nbsp;what&#39;s&nbsp;recorded&nbsp;-&nbsp;always&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200218">if</span>&nbsp;<span class="ident" id="2200221">a</span><span class="op" id="2200222">.</span><span class="ident" id="2200223">trunc</span>&nbsp;<span class="op" id="2200229">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200234">return</span>&nbsp;<span class="builtintype" id="2200241">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2200248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200252">return</span>&nbsp;<span class="ident" id="2200259">nd</span>&nbsp;<span class="op" id="2200262">&gt;</span>&nbsp;<span class="num" id="2200264">0</span>&nbsp;<span class="op" id="2200266">&amp;&amp;</span>&nbsp;<span class="op" id="2200269">(</span><span class="ident" id="2200270">a</span><span class="op" id="2200271">.</span><span class="ident" id="2200272">d</span><span class="op" id="2200273">[</span><span class="ident" id="2200274">nd</span><span class="op" id="2200276">-</span><span class="num" id="2200277">1</span><span class="op" id="2200278">]</span><span class="op" id="2200279">-</span><span class="string" id="2200280">&#39;0&#39;</span><span class="op" id="2200283">)</span><span class="op" id="2200284">%</span><span class="num" id="2200285">2</span>&nbsp;<span class="op" id="2200287">!=</span>&nbsp;<span class="num" id="2200290">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2200293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2200296">//&nbsp;not&nbsp;halfway&nbsp;-&nbsp;digit&nbsp;tells&nbsp;all</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200330">return</span>&nbsp;<span class="ident" id="2200337">a</span><span class="op" id="2200338">.</span><span class="ident" id="2200339">d</span><span class="op" id="2200340">[</span><span class="ident" id="2200341">nd</span><span class="op" id="2200343">]</span>&nbsp;<span class="op" id="2200345">&gt;=</span>&nbsp;<span class="string" id="2200348">&#39;5&#39;</span><br>
<span class="lineno"></span><span class="op" id="2200352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2200355">//&nbsp;Round&nbsp;a&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="comment" id="2200391">//&nbsp;If&nbsp;nd&nbsp;is&nbsp;zero,&nbsp;it&nbsp;means&nbsp;we&#39;re&nbsp;rounding</span><br>
<span class="lineno">315</span><span class="comment" id="2200433">//&nbsp;just&nbsp;to&nbsp;the&nbsp;left&nbsp;of&nbsp;the&nbsp;digits,&nbsp;as&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2200474">//&nbsp;0.09&nbsp;-&gt;&nbsp;0.1.</span><br>
<span class="lineno"></span><span class="keyword" id="2200490">func</span>&nbsp;<span class="op" id="2200495">(</span><span class="ident" id="2200496">a</span>&nbsp;<span class="op" id="2200498">*</span><span class="ident" id="2200499">decimal</span><span class="op" id="2200506">)</span>&nbsp;<span class="ident" id="2200508">Round</span><span class="op" id="2200513">(</span><span class="ident" id="2200514">nd</span>&nbsp;<span class="builtintype" id="2200517">int</span><span class="op" id="2200520">)</span>&nbsp;<span class="op" id="2200522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200525">if</span>&nbsp;<span class="ident" id="2200528">nd</span>&nbsp;<span class="op" id="2200531">&lt;</span>&nbsp;<span class="num" id="2200533">0</span>&nbsp;<span class="op" id="2200535">||</span>&nbsp;<span class="ident" id="2200538">nd</span>&nbsp;<span class="op" id="2200541">&gt;=</span>&nbsp;<span class="ident" id="2200544">a</span><span class="op" id="2200545">.</span><span class="ident" id="2200546">nd</span>&nbsp;<span class="op" id="2200549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200553">return</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2200561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200564">if</span>&nbsp;<span class="ident" id="2200567">shouldRoundUp</span><span class="op" id="2200580">(</span><span class="ident" id="2200581">a</span><span class="op" id="2200582">,</span>&nbsp;<span class="ident" id="2200584">nd</span><span class="op" id="2200586">)</span>&nbsp;<span class="op" id="2200588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2200592">a</span><span class="op" id="2200593">.</span><span class="ident" id="2200594">RoundUp</span><span class="op" id="2200601">(</span><span class="ident" id="2200602">nd</span><span class="op" id="2200604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2200607">}</span>&nbsp;<span class="keyword" id="2200609">else</span>&nbsp;<span class="op" id="2200614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2200618">a</span><span class="op" id="2200619">.</span><span class="ident" id="2200620">RoundDown</span><span class="op" id="2200629">(</span><span class="ident" id="2200630">nd</span><span class="op" id="2200632">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2200635">}</span><br>
<span class="lineno"></span><span class="op" id="2200637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2200640">//&nbsp;Round&nbsp;a&nbsp;down&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="keyword" id="2200681">func</span>&nbsp;<span class="op" id="2200686">(</span><span class="ident" id="2200687">a</span>&nbsp;<span class="op" id="2200689">*</span><span class="ident" id="2200690">decimal</span><span class="op" id="2200697">)</span>&nbsp;<span class="ident" id="2200699">RoundDown</span><span class="op" id="2200708">(</span><span class="ident" id="2200709">nd</span>&nbsp;<span class="builtintype" id="2200712">int</span><span class="op" id="2200715">)</span>&nbsp;<span class="op" id="2200717">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200720">if</span>&nbsp;<span class="ident" id="2200723">nd</span>&nbsp;<span class="op" id="2200726">&lt;</span>&nbsp;<span class="num" id="2200728">0</span>&nbsp;<span class="op" id="2200730">||</span>&nbsp;<span class="ident" id="2200733">nd</span>&nbsp;<span class="op" id="2200736">&gt;=</span>&nbsp;<span class="ident" id="2200739">a</span><span class="op" id="2200740">.</span><span class="ident" id="2200741">nd</span>&nbsp;<span class="op" id="2200744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200748">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2200756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2200759">a</span><span class="op" id="2200760">.</span><span class="ident" id="2200761">nd</span>&nbsp;<span class="op" id="2200764">=</span>&nbsp;<span class="ident" id="2200766">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2200770">trim</span><span class="op" id="2200774">(</span><span class="ident" id="2200775">a</span><span class="op" id="2200776">)</span><br>
<span class="lineno">335</span><span class="op" id="2200778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2200781">//&nbsp;Round&nbsp;a&nbsp;up&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="keyword" id="2200820">func</span>&nbsp;<span class="op" id="2200825">(</span><span class="ident" id="2200826">a</span>&nbsp;<span class="op" id="2200828">*</span><span class="ident" id="2200829">decimal</span><span class="op" id="2200836">)</span>&nbsp;<span class="ident" id="2200838">RoundUp</span><span class="op" id="2200845">(</span><span class="ident" id="2200846">nd</span>&nbsp;<span class="builtintype" id="2200849">int</span><span class="op" id="2200852">)</span>&nbsp;<span class="op" id="2200854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200857">if</span>&nbsp;<span class="ident" id="2200860">nd</span>&nbsp;<span class="op" id="2200863">&lt;</span>&nbsp;<span class="num" id="2200865">0</span>&nbsp;<span class="op" id="2200867">||</span>&nbsp;<span class="ident" id="2200870">nd</span>&nbsp;<span class="op" id="2200873">&gt;=</span>&nbsp;<span class="ident" id="2200876">a</span><span class="op" id="2200877">.</span><span class="ident" id="2200878">nd</span>&nbsp;<span class="op" id="2200881">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2200893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2200897">//&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200910">for</span>&nbsp;<span class="ident" id="2200914">i</span>&nbsp;<span class="op" id="2200916">:=</span>&nbsp;<span class="ident" id="2200919">nd</span>&nbsp;<span class="op" id="2200922">-</span>&nbsp;<span class="num" id="2200924">1</span><span class="op" id="2200925">;</span>&nbsp;<span class="ident" id="2200927">i</span>&nbsp;<span class="op" id="2200929">&gt;=</span>&nbsp;<span class="num" id="2200932">0</span><span class="op" id="2200933">;</span>&nbsp;<span class="ident" id="2200935">i</span><span class="op" id="2200936">--</span>&nbsp;<span class="op" id="2200939">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2200943">c</span>&nbsp;<span class="op" id="2200945">:=</span>&nbsp;<span class="ident" id="2200948">a</span><span class="op" id="2200949">.</span><span class="ident" id="2200950">d</span><span class="op" id="2200951">[</span><span class="ident" id="2200952">i</span><span class="op" id="2200953">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2200957">if</span>&nbsp;<span class="ident" id="2200960">c</span>&nbsp;<span class="op" id="2200962">&lt;</span>&nbsp;<span class="string" id="2200964">&#39;9&#39;</span>&nbsp;<span class="op" id="2200968">{</span>&nbsp;<span class="comment" id="2200970">//&nbsp;can&nbsp;stop&nbsp;after&nbsp;this&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201002">a</span><span class="op" id="2201003">.</span><span class="ident" id="2201004">d</span><span class="op" id="2201005">[</span><span class="ident" id="2201006">i</span><span class="op" id="2201007">]</span><span class="op" id="2201008">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201014">a</span><span class="op" id="2201015">.</span><span class="ident" id="2201016">nd</span>&nbsp;<span class="op" id="2201019">=</span>&nbsp;<span class="ident" id="2201021">i</span>&nbsp;<span class="op" id="2201023">+</span>&nbsp;<span class="num" id="2201025">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2201030">return</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2201039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2201042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2201046">//&nbsp;Number&nbsp;is&nbsp;all&nbsp;9s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2201068">//&nbsp;Change&nbsp;to&nbsp;single&nbsp;1&nbsp;with&nbsp;adjusted&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201120">a</span><span class="op" id="2201121">.</span><span class="ident" id="2201122">d</span><span class="op" id="2201123">[</span><span class="num" id="2201124">0</span><span class="op" id="2201125">]</span>&nbsp;<span class="op" id="2201127">=</span>&nbsp;<span class="string" id="2201129">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201134">a</span><span class="op" id="2201135">.</span><span class="ident" id="2201136">nd</span>&nbsp;<span class="op" id="2201139">=</span>&nbsp;<span class="num" id="2201141">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201144">a</span><span class="op" id="2201145">.</span><span class="ident" id="2201146">dp</span><span class="op" id="2201148">++</span><br>
<span class="lineno"></span><span class="op" id="2201151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="2201154">//&nbsp;Extract&nbsp;integer&nbsp;part,&nbsp;rounded&nbsp;appropriately.</span><br>
<span class="lineno"></span><span class="comment" id="2201202">//&nbsp;No&nbsp;guarantees&nbsp;about&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2201235">func</span>&nbsp;<span class="op" id="2201240">(</span><span class="ident" id="2201241">a</span>&nbsp;<span class="op" id="2201243">*</span><span class="ident" id="2201244">decimal</span><span class="op" id="2201251">)</span>&nbsp;<span class="ident" id="2201253">RoundedInteger</span><span class="op" id="2201267">(</span><span class="op" id="2201268">)</span>&nbsp;<span class="ident" id="2201270">uint64</span>&nbsp;<span class="op" id="2201277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2201280">if</span>&nbsp;<span class="ident" id="2201283">a</span><span class="op" id="2201284">.</span><span class="ident" id="2201285">dp</span>&nbsp;<span class="op" id="2201288">&gt;</span>&nbsp;<span class="num" id="2201290">20</span>&nbsp;<span class="op" id="2201293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2201297">return</span>&nbsp;<span class="num" id="2201304">0xFFFFFFFFFFFFFFFF</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2201324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2201327">var</span>&nbsp;<span class="ident" id="2201331">i</span>&nbsp;<span class="builtintype" id="2201333">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201338">n</span>&nbsp;<span class="op" id="2201340">:=</span>&nbsp;<span class="ident" id="2201343">uint64</span><span class="op" id="2201349">(</span><span class="num" id="2201350">0</span><span class="op" id="2201351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2201354">for</span>&nbsp;<span class="ident" id="2201358">i</span>&nbsp;<span class="op" id="2201360">=</span>&nbsp;<span class="num" id="2201362">0</span><span class="op" id="2201363">;</span>&nbsp;<span class="ident" id="2201365">i</span>&nbsp;<span class="op" id="2201367">&lt;</span>&nbsp;<span class="ident" id="2201369">a</span><span class="op" id="2201370">.</span><span class="ident" id="2201371">dp</span>&nbsp;<span class="op" id="2201374">&amp;&amp;</span>&nbsp;<span class="ident" id="2201377">i</span>&nbsp;<span class="op" id="2201379">&lt;</span>&nbsp;<span class="ident" id="2201381">a</span><span class="op" id="2201382">.</span><span class="ident" id="2201383">nd</span><span class="op" id="2201385">;</span>&nbsp;<span class="ident" id="2201387">i</span><span class="op" id="2201388">++</span>&nbsp;<span class="op" id="2201391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201395">n</span>&nbsp;<span class="op" id="2201397">=</span>&nbsp;<span class="ident" id="2201399">n</span><span class="op" id="2201400">*</span><span class="num" id="2201401">10</span>&nbsp;<span class="op" id="2201404">+</span>&nbsp;<span class="ident" id="2201406">uint64</span><span class="op" id="2201412">(</span><span class="ident" id="2201413">a</span><span class="op" id="2201414">.</span><span class="ident" id="2201415">d</span><span class="op" id="2201416">[</span><span class="ident" id="2201417">i</span><span class="op" id="2201418">]</span><span class="op" id="2201419">-</span><span class="string" id="2201420">&#39;0&#39;</span><span class="op" id="2201423">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2201426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2201429">for</span>&nbsp;<span class="op" id="2201433">;</span>&nbsp;<span class="ident" id="2201435">i</span>&nbsp;<span class="op" id="2201437">&lt;</span>&nbsp;<span class="ident" id="2201439">a</span><span class="op" id="2201440">.</span><span class="ident" id="2201441">dp</span><span class="op" id="2201443">;</span>&nbsp;<span class="ident" id="2201445">i</span><span class="op" id="2201446">++</span>&nbsp;<span class="op" id="2201449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201453">n</span>&nbsp;<span class="op" id="2201455">*=</span>&nbsp;<span class="num" id="2201458">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2201462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2201465">if</span>&nbsp;<span class="ident" id="2201468">shouldRoundUp</span><span class="op" id="2201481">(</span><span class="ident" id="2201482">a</span><span class="op" id="2201483">,</span>&nbsp;<span class="ident" id="2201485">a</span><span class="op" id="2201486">.</span><span class="ident" id="2201487">dp</span><span class="op" id="2201489">)</span>&nbsp;<span class="op" id="2201491">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201495">n</span><span class="op" id="2201496">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2201500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2201503">return</span>&nbsp;<span class="ident" id="2201510">n</span><br>
<span class="lineno"></span><span class="op" id="2201512">}</span>
</div>
</body>
</html>
