<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8438670">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8438725">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8438779">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8438830">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8438895">package</span>&nbsp;<span class="ident" id="8438903">signal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8438911">import</span>&nbsp;<span class="op" id="8438918">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8438921">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8438929">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8438942">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8438948">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8438959">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8438970">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8438981">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8438992">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8439003">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8439010">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8439013">func</span>&nbsp;<span class="ident" id="8439018">waitSig</span><span class="op" id="8439025">(</span><span class="ident" id="8439026">t</span>&nbsp;<span class="op" id="8439028">*</span><span class="ident" id="8439029"><a href="/os/signal/signal_test.go.html#8438992">testing</a></span><span class="op" id="8439036">.</span><span class="ident" id="8439037">T</span><span class="op" id="8439038">,</span>&nbsp;<span class="ident" id="8439040">c</span>&nbsp;<span class="op" id="8439042">&lt;-</span><span class="keyword" id="8439044">chan</span>&nbsp;<span class="ident" id="8439049"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8439051">.</span><span class="ident" id="8439052">Signal</span><span class="op" id="8439058">,</span>&nbsp;<span class="ident" id="8439060">sig</span>&nbsp;<span class="ident" id="8439064"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8439066">.</span><span class="ident" id="8439067">Signal</span><span class="op" id="8439073">)</span>&nbsp;<span class="op" id="8439075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8439078">select</span>&nbsp;<span class="op" id="8439085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8439088">case</span>&nbsp;<span class="ident" id="8439093">s</span>&nbsp;<span class="op" id="8439095">:=</span>&nbsp;<span class="op" id="8439098">&lt;-</span><span class="ident" id="8439100"><a href="/os/signal/signal_test.go.html#8439040">c</a></span><span class="op" id="8439101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8439105">if</span>&nbsp;<span class="ident" id="8439108"><a href="/os/signal/signal_test.go.html#8439093">s</a></span>&nbsp;<span class="op" id="8439110">!=</span>&nbsp;<span class="ident" id="8439113"><a href="/os/signal/signal_test.go.html#8439060">sig</a></span>&nbsp;<span class="op" id="8439117">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439122"><a href="/os/signal/signal_test.go.html#8439026">t</a></span><span class="op" id="8439123">.</span><span class="ident" id="8439124">Fatalf</span><span class="op" id="8439130">(</span><span class="string" id="8439131">&#34;signal&nbsp;was&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8439155">,</span>&nbsp;<span class="ident" id="8439157"><a href="/os/signal/signal_test.go.html#8439093">s</a></span><span class="op" id="8439158">,</span>&nbsp;<span class="ident" id="8439160"><a href="/os/signal/signal_test.go.html#8439060">sig</a></span><span class="op" id="8439163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8439167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8439170">case</span>&nbsp;<span class="op" id="8439175">&lt;-</span><span class="ident" id="8439177"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8439181">.</span><span class="ident" id="8439182">After</span><span class="op" id="8439187">(</span><span class="num" id="8439188">1</span>&nbsp;<span class="op" id="8439190">*</span>&nbsp;<span class="ident" id="8439192"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8439196">.</span><span class="ident" id="8439197">Second</span><span class="op" id="8439203">)</span><span class="op" id="8439204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439208"><a href="/os/signal/signal_test.go.html#8439026">t</a></span><span class="op" id="8439209">.</span><span class="ident" id="8439210">Fatalf</span><span class="op" id="8439216">(</span><span class="string" id="8439217">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;%v&#34;</span><span class="op" id="8439241">,</span>&nbsp;<span class="ident" id="8439243"><a href="/os/signal/signal_test.go.html#8439060">sig</a></span><span class="op" id="8439246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8439249">}</span><br>
<span class="lineno">30</span><span class="op" id="8439251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8439254">//&nbsp;Test&nbsp;that&nbsp;basic&nbsp;signal&nbsp;handling&nbsp;works.</span><br>
<span class="lineno"></span><span class="keyword" id="8439296">func</span>&nbsp;<span class="ident" id="8439301">TestSignal</span><span class="op" id="8439311">(</span><span class="ident" id="8439312">t</span>&nbsp;<span class="op" id="8439314">*</span><span class="ident" id="8439315"><a href="/os/signal/signal_test.go.html#8438992">testing</a></span><span class="op" id="8439322">.</span><span class="ident" id="8439323">T</span><span class="op" id="8439324">)</span>&nbsp;<span class="op" id="8439326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8439329">//&nbsp;Ask&nbsp;for&nbsp;SIGHUP</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439348">c</span>&nbsp;<span class="op" id="8439350">:=</span>&nbsp;<span class="builtinfunc" id="8439353">make</span><span class="op" id="8439357">(</span><span class="keyword" id="8439358">chan</span>&nbsp;<span class="ident" id="8439363"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8439365">.</span><span class="ident" id="8439366">Signal</span><span class="op" id="8439372">,</span>&nbsp;<span class="num" id="8439374">1</span><span class="op" id="8439375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439378"><a href="/os/signal/signal.go.html#6217567">Notify</a></span><span class="op" id="8439384">(</span><span class="ident" id="8439385"><a href="/os/signal/signal_test.go.html#8439348">c</a></span><span class="op" id="8439386">,</span>&nbsp;<span class="ident" id="8439388"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439395">.</span><span class="ident" id="8439396">SIGHUP</span><span class="op" id="8439402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8439405">defer</span>&nbsp;<span class="ident" id="8439411"><a href="/os/signal/signal.go.html#6218387">Stop</a></span><span class="op" id="8439415">(</span><span class="ident" id="8439416"><a href="/os/signal/signal_test.go.html#8439348">c</a></span><span class="op" id="8439417">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8439421">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;a&nbsp;SIGHUP</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439452"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8439453">.</span><span class="ident" id="8439454">Logf</span><span class="op" id="8439458">(</span><span class="string" id="8439459">&#34;sighup...&#34;</span><span class="op" id="8439470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439473"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439480">.</span><span class="ident" id="8439481">Kill</span><span class="op" id="8439485">(</span><span class="ident" id="8439486"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439493">.</span><span class="ident" id="8439494">Getpid</span><span class="op" id="8439500">(</span><span class="op" id="8439501">)</span><span class="op" id="8439502">,</span>&nbsp;<span class="ident" id="8439504"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439511">.</span><span class="ident" id="8439512">SIGHUP</span><span class="op" id="8439518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439521"><a href="/os/signal/signal_test.go.html#8439018">waitSig</a></span><span class="op" id="8439528">(</span><span class="ident" id="8439529"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8439530">,</span>&nbsp;<span class="ident" id="8439532"><a href="/os/signal/signal_test.go.html#8439348">c</a></span><span class="op" id="8439533">,</span>&nbsp;<span class="ident" id="8439535"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439542">.</span><span class="ident" id="8439543">SIGHUP</span><span class="op" id="8439549">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8439553">//&nbsp;Ask&nbsp;for&nbsp;everything&nbsp;we&nbsp;can&nbsp;get.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439588">c1</span>&nbsp;<span class="op" id="8439591">:=</span>&nbsp;<span class="builtinfunc" id="8439594">make</span><span class="op" id="8439598">(</span><span class="keyword" id="8439599">chan</span>&nbsp;<span class="ident" id="8439604"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8439606">.</span><span class="ident" id="8439607">Signal</span><span class="op" id="8439613">,</span>&nbsp;<span class="num" id="8439615">1</span><span class="op" id="8439616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439619"><a href="/os/signal/signal.go.html#6217567">Notify</a></span><span class="op" id="8439625">(</span><span class="ident" id="8439626"><a href="/os/signal/signal_test.go.html#8439588">c1</a></span><span class="op" id="8439628">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8439632">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;a&nbsp;SIGWINCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439665"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8439666">.</span><span class="ident" id="8439667">Logf</span><span class="op" id="8439671">(</span><span class="string" id="8439672">&#34;sigwinch...&#34;</span><span class="op" id="8439685">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439688"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439695">.</span><span class="ident" id="8439696">Kill</span><span class="op" id="8439700">(</span><span class="ident" id="8439701"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439708">.</span><span class="ident" id="8439709">Getpid</span><span class="op" id="8439715">(</span><span class="op" id="8439716">)</span><span class="op" id="8439717">,</span>&nbsp;<span class="ident" id="8439719"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439726">.</span><span class="ident" id="8439727">SIGWINCH</span><span class="op" id="8439735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439738"><a href="/os/signal/signal_test.go.html#8439018">waitSig</a></span><span class="op" id="8439745">(</span><span class="ident" id="8439746"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8439747">,</span>&nbsp;<span class="ident" id="8439749"><a href="/os/signal/signal_test.go.html#8439588">c1</a></span><span class="op" id="8439751">,</span>&nbsp;<span class="ident" id="8439753"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439760">.</span><span class="ident" id="8439761">SIGWINCH</span><span class="op" id="8439769">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8439773">//&nbsp;Send&nbsp;two&nbsp;more&nbsp;SIGHUPs,&nbsp;to&nbsp;make&nbsp;sure&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8439818">//&nbsp;they&nbsp;get&nbsp;delivered&nbsp;on&nbsp;c1&nbsp;and&nbsp;that&nbsp;not&nbsp;reading</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8439868">//&nbsp;from&nbsp;c&nbsp;does&nbsp;not&nbsp;block&nbsp;everything.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439906"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8439907">.</span><span class="ident" id="8439908">Logf</span><span class="op" id="8439912">(</span><span class="string" id="8439913">&#34;sighup...&#34;</span><span class="op" id="8439924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439927"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439934">.</span><span class="ident" id="8439935">Kill</span><span class="op" id="8439939">(</span><span class="ident" id="8439940"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439947">.</span><span class="ident" id="8439948">Getpid</span><span class="op" id="8439954">(</span><span class="op" id="8439955">)</span><span class="op" id="8439956">,</span>&nbsp;<span class="ident" id="8439958"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439965">.</span><span class="ident" id="8439966">SIGHUP</span><span class="op" id="8439972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8439975"><a href="/os/signal/signal_test.go.html#8439018">waitSig</a></span><span class="op" id="8439982">(</span><span class="ident" id="8439983"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8439984">,</span>&nbsp;<span class="ident" id="8439986"><a href="/os/signal/signal_test.go.html#8439588">c1</a></span><span class="op" id="8439988">,</span>&nbsp;<span class="ident" id="8439990"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8439997">.</span><span class="ident" id="8439998">SIGHUP</span><span class="op" id="8440004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440007"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8440008">.</span><span class="ident" id="8440009">Logf</span><span class="op" id="8440013">(</span><span class="string" id="8440014">&#34;sighup...&#34;</span><span class="op" id="8440025">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440028"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440035">.</span><span class="ident" id="8440036">Kill</span><span class="op" id="8440040">(</span><span class="ident" id="8440041"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440048">.</span><span class="ident" id="8440049">Getpid</span><span class="op" id="8440055">(</span><span class="op" id="8440056">)</span><span class="op" id="8440057">,</span>&nbsp;<span class="ident" id="8440059"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440066">.</span><span class="ident" id="8440067">SIGHUP</span><span class="op" id="8440073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440076"><a href="/os/signal/signal_test.go.html#8439018">waitSig</a></span><span class="op" id="8440083">(</span><span class="ident" id="8440084"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8440085">,</span>&nbsp;<span class="ident" id="8440087"><a href="/os/signal/signal_test.go.html#8439588">c1</a></span><span class="op" id="8440089">,</span>&nbsp;<span class="ident" id="8440091"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440098">.</span><span class="ident" id="8440099">SIGHUP</span><span class="op" id="8440105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8440109">//&nbsp;The&nbsp;first&nbsp;SIGHUP&nbsp;should&nbsp;be&nbsp;waiting&nbsp;for&nbsp;us&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440161"><a href="/os/signal/signal_test.go.html#8439018">waitSig</a></span><span class="op" id="8440168">(</span><span class="ident" id="8440169"><a href="/os/signal/signal_test.go.html#8439312">t</a></span><span class="op" id="8440170">,</span>&nbsp;<span class="ident" id="8440172"><a href="/os/signal/signal_test.go.html#8439348">c</a></span><span class="op" id="8440173">,</span>&nbsp;<span class="ident" id="8440175"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440182">.</span><span class="ident" id="8440183">SIGHUP</span><span class="op" id="8440189">)</span><br>
<span class="lineno">65</span><span class="op" id="8440191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8440194">func</span>&nbsp;<span class="ident" id="8440199">TestStress</span><span class="op" id="8440209">(</span><span class="ident" id="8440210">t</span>&nbsp;<span class="op" id="8440212">*</span><span class="ident" id="8440213"><a href="/os/signal/signal_test.go.html#8438992">testing</a></span><span class="op" id="8440220">.</span><span class="ident" id="8440221">T</span><span class="op" id="8440222">)</span>&nbsp;<span class="op" id="8440224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440227">dur</span>&nbsp;<span class="op" id="8440231">:=</span>&nbsp;<span class="num" id="8440234">3</span>&nbsp;<span class="op" id="8440236">*</span>&nbsp;<span class="ident" id="8440238"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8440242">.</span><span class="ident" id="8440243">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440251">if</span>&nbsp;<span class="ident" id="8440254"><a href="/os/signal/signal_test.go.html#8438992">testing</a></span><span class="op" id="8440261">.</span><span class="ident" id="8440262">Short</span><span class="op" id="8440267">(</span><span class="op" id="8440268">)</span>&nbsp;<span class="op" id="8440270">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440274"><a href="/os/signal/signal_test.go.html#8440227">dur</a></span>&nbsp;<span class="op" id="8440278">=</span>&nbsp;<span class="num" id="8440280">100</span>&nbsp;<span class="op" id="8440284">*</span>&nbsp;<span class="ident" id="8440286"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8440290">.</span><span class="ident" id="8440291">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440307">defer</span>&nbsp;<span class="ident" id="8440313"><a href="/os/signal/signal_test.go.html#8438959">runtime</a></span><span class="op" id="8440320">.</span><span class="ident" id="8440321">GOMAXPROCS</span><span class="op" id="8440331">(</span><span class="ident" id="8440332"><a href="/os/signal/signal_test.go.html#8438959">runtime</a></span><span class="op" id="8440339">.</span><span class="ident" id="8440340">GOMAXPROCS</span><span class="op" id="8440350">(</span><span class="num" id="8440351">4</span><span class="op" id="8440352">)</span><span class="op" id="8440353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440356">done</span>&nbsp;<span class="op" id="8440361">:=</span>&nbsp;<span class="builtinfunc" id="8440364">make</span><span class="op" id="8440368">(</span><span class="keyword" id="8440369">chan</span>&nbsp;<span class="builtintype" id="8440374">bool</span><span class="op" id="8440378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440381">finished</span>&nbsp;<span class="op" id="8440390">:=</span>&nbsp;<span class="builtinfunc" id="8440393">make</span><span class="op" id="8440397">(</span><span class="keyword" id="8440398">chan</span>&nbsp;<span class="builtintype" id="8440403">bool</span><span class="op" id="8440407">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440410">go</span>&nbsp;<span class="keyword" id="8440413">func</span><span class="op" id="8440417">(</span><span class="op" id="8440418">)</span>&nbsp;<span class="op" id="8440420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440424">sig</span>&nbsp;<span class="op" id="8440428">:=</span>&nbsp;<span class="builtinfunc" id="8440431">make</span><span class="op" id="8440435">(</span><span class="keyword" id="8440436">chan</span>&nbsp;<span class="ident" id="8440441"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8440443">.</span><span class="ident" id="8440444">Signal</span><span class="op" id="8440450">,</span>&nbsp;<span class="num" id="8440452">1</span><span class="op" id="8440453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440457"><a href="/os/signal/signal.go.html#6217567">Notify</a></span><span class="op" id="8440463">(</span><span class="ident" id="8440464"><a href="/os/signal/signal_test.go.html#8440424">sig</a></span><span class="op" id="8440467">,</span>&nbsp;<span class="ident" id="8440469"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440476">.</span><span class="ident" id="8440477">SIGUSR1</span><span class="op" id="8440484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440488">defer</span>&nbsp;<span class="ident" id="8440494"><a href="/os/signal/signal.go.html#6218387">Stop</a></span><span class="op" id="8440498">(</span><span class="ident" id="8440499"><a href="/os/signal/signal_test.go.html#8440424">sig</a></span><span class="op" id="8440502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440505">Loop</span><span class="op" id="8440509">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440513">for</span>&nbsp;<span class="op" id="8440517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440522">select</span>&nbsp;<span class="op" id="8440529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440534">case</span>&nbsp;<span class="op" id="8440539">&lt;-</span><span class="ident" id="8440541"><a href="/os/signal/signal_test.go.html#8440424">sig</a></span><span class="op" id="8440544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440549">case</span>&nbsp;<span class="op" id="8440554">&lt;-</span><span class="ident" id="8440556"><a href="/os/signal/signal_test.go.html#8440356">done</a></span><span class="op" id="8440560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440566">break</span>&nbsp;<span class="ident" id="8440572">Loop</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440588"><a href="/os/signal/signal_test.go.html#8440381">finished</a></span>&nbsp;<span class="op" id="8440597">&lt;-</span>&nbsp;<span class="ident" id="8440600">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440606">}</span><span class="op" id="8440607">(</span><span class="op" id="8440608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440611">go</span>&nbsp;<span class="keyword" id="8440614">func</span><span class="op" id="8440618">(</span><span class="op" id="8440619">)</span>&nbsp;<span class="op" id="8440621">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440624">Loop</span><span class="op" id="8440628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440632">for</span>&nbsp;<span class="op" id="8440636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440641">select</span>&nbsp;<span class="op" id="8440648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440653">case</span>&nbsp;<span class="op" id="8440658">&lt;-</span><span class="ident" id="8440660"><a href="/os/signal/signal_test.go.html#8440356">done</a></span><span class="op" id="8440664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440670">break</span>&nbsp;<span class="ident" id="8440676">Loop</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8440684">default</span><span class="op" id="8440691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440697"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440704">.</span><span class="ident" id="8440705">Kill</span><span class="op" id="8440709">(</span><span class="ident" id="8440710"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440717">.</span><span class="ident" id="8440718">Getpid</span><span class="op" id="8440724">(</span><span class="op" id="8440725">)</span><span class="op" id="8440726">,</span>&nbsp;<span class="ident" id="8440728"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8440735">.</span><span class="ident" id="8440736">SIGUSR1</span><span class="op" id="8440743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440749"><a href="/os/signal/signal_test.go.html#8438959">runtime</a></span><span class="op" id="8440756">.</span><span class="ident" id="8440757">Gosched</span><span class="op" id="8440764">(</span><span class="op" id="8440765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440774">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440778"><a href="/os/signal/signal_test.go.html#8440381">finished</a></span>&nbsp;<span class="op" id="8440787">&lt;-</span>&nbsp;<span class="ident" id="8440790">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440796">}</span><span class="op" id="8440797">(</span><span class="op" id="8440798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8440801"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8440805">.</span><span class="ident" id="8440806">Sleep</span><span class="op" id="8440811">(</span><span class="ident" id="8440812"><a href="/os/signal/signal_test.go.html#8440227">dur</a></span><span class="op" id="8440815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8440818">close</span><span class="op" id="8440823">(</span><span class="ident" id="8440824"><a href="/os/signal/signal_test.go.html#8440356">done</a></span><span class="op" id="8440828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440831">&lt;-</span><span class="ident" id="8440833"><a href="/os/signal/signal_test.go.html#8440381">finished</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8440843">&lt;-</span><span class="ident" id="8440845"><a href="/os/signal/signal_test.go.html#8440381">finished</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8440855">//&nbsp;When&nbsp;run&nbsp;with&nbsp;&#39;go&nbsp;test&nbsp;-cpu=1,2,4&#39;&nbsp;SIGUSR1&nbsp;from&nbsp;this&nbsp;test&nbsp;can&nbsp;slip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8440926">//&nbsp;into&nbsp;subsequent&nbsp;TestSignal()&nbsp;causing&nbsp;failure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8440976">//&nbsp;Sleep&nbsp;for&nbsp;a&nbsp;while&nbsp;to&nbsp;reduce&nbsp;the&nbsp;possibility&nbsp;of&nbsp;the&nbsp;failure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441040"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8441044">.</span><span class="ident" id="8441045">Sleep</span><span class="op" id="8441050">(</span><span class="num" id="8441051">10</span>&nbsp;<span class="op" id="8441054">*</span>&nbsp;<span class="ident" id="8441056"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8441060">.</span><span class="ident" id="8441061">Millisecond</span><span class="op" id="8441072">)</span><br>
<span class="lineno">110</span><span class="op" id="8441074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8441077">var</span>&nbsp;<span class="ident" id="8441081">sendUncaughtSighup</span>&nbsp;<span class="op" id="8441100">=</span>&nbsp;<span class="ident" id="8441102"><a href="/os/signal/signal_test.go.html#8438921">flag</a></span><span class="op" id="8441106">.</span><span class="ident" id="8441107">Int</span><span class="op" id="8441110">(</span><span class="string" id="8441111">&#34;send_uncaught_sighup&#34;</span><span class="op" id="8441133">,</span>&nbsp;<span class="num" id="8441135">0</span><span class="op" id="8441136">,</span>&nbsp;<span class="string" id="8441138">&#34;send&nbsp;uncaught&nbsp;SIGHUP&nbsp;during&nbsp;TestStop&#34;</span><span class="op" id="8441176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8441179">//&nbsp;Test&nbsp;that&nbsp;Stop&nbsp;cancels&nbsp;the&nbsp;channel&#39;s&nbsp;registrations.</span><br>
<span class="lineno">115</span><span class="keyword" id="8441234">func</span>&nbsp;<span class="ident" id="8441239">TestStop</span><span class="op" id="8441247">(</span><span class="ident" id="8441248">t</span>&nbsp;<span class="op" id="8441250">*</span><span class="ident" id="8441251"><a href="/os/signal/signal_test.go.html#8438992">testing</a></span><span class="op" id="8441258">.</span><span class="ident" id="8441259">T</span><span class="op" id="8441260">)</span>&nbsp;<span class="op" id="8441262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441265">sigs</span>&nbsp;<span class="op" id="8441270">:=</span>&nbsp;<span class="op" id="8441273">[</span><span class="op" id="8441274">]</span><span class="ident" id="8441275"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8441282">.</span><span class="ident" id="8441283">Signal</span><span class="op" id="8441289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441293"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8441300">.</span><span class="ident" id="8441301">SIGWINCH</span><span class="op" id="8441309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441313"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8441320">.</span><span class="ident" id="8441321">SIGHUP</span><span class="op" id="8441327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8441330">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8441334">for</span>&nbsp;<span class="ident" id="8441338">_</span><span class="op" id="8441339">,</span>&nbsp;<span class="ident" id="8441341">sig</span>&nbsp;<span class="op" id="8441345">:=</span>&nbsp;<span class="keyword" id="8441348">range</span>&nbsp;<span class="ident" id="8441354"><a href="/os/signal/signal_test.go.html#8441265">sigs</a></span>&nbsp;<span class="op" id="8441359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8441363">//&nbsp;Send&nbsp;the&nbsp;signal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8441385">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGWINCH,&nbsp;we&nbsp;should&nbsp;not&nbsp;see&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8441430">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGHUP,&nbsp;maybe&nbsp;we&#39;ll&nbsp;die.&nbsp;Let&nbsp;the&nbsp;flag&nbsp;tell&nbsp;us&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8441501">if</span>&nbsp;<span class="ident" id="8441504"><a href="/os/signal/signal_test.go.html#8441341">sig</a></span>&nbsp;<span class="op" id="8441508">!=</span>&nbsp;<span class="ident" id="8441511"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8441518">.</span><span class="ident" id="8441519">SIGHUP</span>&nbsp;<span class="op" id="8441526">||</span>&nbsp;<span class="op" id="8441529">*</span><span class="ident" id="8441530"><a href="/os/signal/signal_test.go.html#8441081">sendUncaughtSighup</a></span>&nbsp;<span class="op" id="8441549">==</span>&nbsp;<span class="num" id="8441552">1</span>&nbsp;<span class="op" id="8441554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441559"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8441566">.</span><span class="ident" id="8441567">Kill</span><span class="op" id="8441571">(</span><span class="ident" id="8441572"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8441579">.</span><span class="ident" id="8441580">Getpid</span><span class="op" id="8441586">(</span><span class="op" id="8441587">)</span><span class="op" id="8441588">,</span>&nbsp;<span class="ident" id="8441590"><a href="/os/signal/signal_test.go.html#8441341">sig</a></span><span class="op" id="8441593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8441597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441601"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8441605">.</span><span class="ident" id="8441606">Sleep</span><span class="op" id="8441611">(</span><span class="num" id="8441612">100</span>&nbsp;<span class="op" id="8441616">*</span>&nbsp;<span class="ident" id="8441618"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8441622">.</span><span class="ident" id="8441623">Millisecond</span><span class="op" id="8441634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8441639">//&nbsp;Ask&nbsp;for&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441659">c</span>&nbsp;<span class="op" id="8441661">:=</span>&nbsp;<span class="builtinfunc" id="8441664">make</span><span class="op" id="8441668">(</span><span class="keyword" id="8441669">chan</span>&nbsp;<span class="ident" id="8441674"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8441676">.</span><span class="ident" id="8441677">Signal</span><span class="op" id="8441683">,</span>&nbsp;<span class="num" id="8441685">1</span><span class="op" id="8441686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441690"><a href="/os/signal/signal.go.html#6217567">Notify</a></span><span class="op" id="8441696">(</span><span class="ident" id="8441697"><a href="/os/signal/signal_test.go.html#8441659">c</a></span><span class="op" id="8441698">,</span>&nbsp;<span class="ident" id="8441700"><a href="/os/signal/signal_test.go.html#8441341">sig</a></span><span class="op" id="8441703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8441707">defer</span>&nbsp;<span class="ident" id="8441713"><a href="/os/signal/signal.go.html#6218387">Stop</a></span><span class="op" id="8441717">(</span><span class="ident" id="8441718"><a href="/os/signal/signal_test.go.html#8441659">c</a></span><span class="op" id="8441719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8441724">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;that&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441759"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8441766">.</span><span class="ident" id="8441767">Kill</span><span class="op" id="8441771">(</span><span class="ident" id="8441772"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8441779">.</span><span class="ident" id="8441780">Getpid</span><span class="op" id="8441786">(</span><span class="op" id="8441787">)</span><span class="op" id="8441788">,</span>&nbsp;<span class="ident" id="8441790"><a href="/os/signal/signal_test.go.html#8441341">sig</a></span><span class="op" id="8441793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441797"><a href="/os/signal/signal_test.go.html#8439018">waitSig</a></span><span class="op" id="8441804">(</span><span class="ident" id="8441805"><a href="/os/signal/signal_test.go.html#8441248">t</a></span><span class="op" id="8441806">,</span>&nbsp;<span class="ident" id="8441808"><a href="/os/signal/signal_test.go.html#8441659">c</a></span><span class="op" id="8441809">,</span>&nbsp;<span class="ident" id="8441811"><a href="/os/signal/signal_test.go.html#8441341">sig</a></span><span class="op" id="8441814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441819"><a href="/os/signal/signal.go.html#6218387">Stop</a></span><span class="op" id="8441823">(</span><span class="ident" id="8441824"><a href="/os/signal/signal_test.go.html#8441659">c</a></span><span class="op" id="8441825">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8441829">select</span>&nbsp;<span class="op" id="8441836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8441840">case</span>&nbsp;<span class="ident" id="8441845">s</span>&nbsp;<span class="op" id="8441847">:=</span>&nbsp;<span class="op" id="8441850">&lt;-</span><span class="ident" id="8441852"><a href="/os/signal/signal_test.go.html#8441659">c</a></span><span class="op" id="8441853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8441858"><a href="/os/signal/signal_test.go.html#8441248">t</a></span><span class="op" id="8441859">.</span><span class="ident" id="8441860">Fatalf</span><span class="op" id="8441866">(</span><span class="string" id="8441867">&#34;unexpected&nbsp;signal&nbsp;%v&#34;</span><span class="op" id="8441889">,</span>&nbsp;<span class="ident" id="8441891"><a href="/os/signal/signal_test.go.html#8441845">s</a></span><span class="op" id="8441892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8441896">case</span>&nbsp;<span class="op" id="8441901">&lt;-</span><span class="ident" id="8441903"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8441907">.</span><span class="ident" id="8441908">After</span><span class="op" id="8441913">(</span><span class="num" id="8441914">100</span>&nbsp;<span class="op" id="8441918">*</span>&nbsp;<span class="ident" id="8441920"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8441924">.</span><span class="ident" id="8441925">Millisecond</span><span class="op" id="8441936">)</span><span class="op" id="8441937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8441942">//&nbsp;nothing&nbsp;to&nbsp;read&nbsp;-&nbsp;good</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8441970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8441975">//&nbsp;Send&nbsp;the&nbsp;signal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8441997">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGWINCH,&nbsp;we&nbsp;should&nbsp;not&nbsp;see&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442042">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGHUP,&nbsp;maybe&nbsp;we&#39;ll&nbsp;die.&nbsp;Let&nbsp;the&nbsp;flag&nbsp;tell&nbsp;us&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8442113">if</span>&nbsp;<span class="ident" id="8442116"><a href="/os/signal/signal_test.go.html#8441341">sig</a></span>&nbsp;<span class="op" id="8442120">!=</span>&nbsp;<span class="ident" id="8442123"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8442130">.</span><span class="ident" id="8442131">SIGHUP</span>&nbsp;<span class="op" id="8442138">||</span>&nbsp;<span class="op" id="8442141">*</span><span class="ident" id="8442142"><a href="/os/signal/signal_test.go.html#8441081">sendUncaughtSighup</a></span>&nbsp;<span class="op" id="8442161">==</span>&nbsp;<span class="num" id="8442164">2</span>&nbsp;<span class="op" id="8442166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8442171"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8442178">.</span><span class="ident" id="8442179">Kill</span><span class="op" id="8442183">(</span><span class="ident" id="8442184"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8442191">.</span><span class="ident" id="8442192">Getpid</span><span class="op" id="8442198">(</span><span class="op" id="8442199">)</span><span class="op" id="8442200">,</span>&nbsp;<span class="ident" id="8442202"><a href="/os/signal/signal_test.go.html#8441341">sig</a></span><span class="op" id="8442205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8442209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8442214">select</span>&nbsp;<span class="op" id="8442221">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8442225">case</span>&nbsp;<span class="ident" id="8442230">s</span>&nbsp;<span class="op" id="8442232">:=</span>&nbsp;<span class="op" id="8442235">&lt;-</span><span class="ident" id="8442237"><a href="/os/signal/signal_test.go.html#8441659">c</a></span><span class="op" id="8442238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8442243"><a href="/os/signal/signal_test.go.html#8441248">t</a></span><span class="op" id="8442244">.</span><span class="ident" id="8442245">Fatalf</span><span class="op" id="8442251">(</span><span class="string" id="8442252">&#34;unexpected&nbsp;signal&nbsp;%v&#34;</span><span class="op" id="8442274">,</span>&nbsp;<span class="ident" id="8442276"><a href="/os/signal/signal_test.go.html#8442230">s</a></span><span class="op" id="8442277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8442281">case</span>&nbsp;<span class="op" id="8442286">&lt;-</span><span class="ident" id="8442288"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8442292">.</span><span class="ident" id="8442293">After</span><span class="op" id="8442298">(</span><span class="num" id="8442299">100</span>&nbsp;<span class="op" id="8442303">*</span>&nbsp;<span class="ident" id="8442305"><a href="/os/signal/signal_test.go.html#8439003">time</a></span><span class="op" id="8442309">.</span><span class="ident" id="8442310">Millisecond</span><span class="op" id="8442321">)</span><span class="op" id="8442322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442327">//&nbsp;nothing&nbsp;to&nbsp;read&nbsp;-&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8442355">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8442358">}</span><br>
<span class="lineno"></span><span class="op" id="8442360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8442363">//&nbsp;Test&nbsp;that&nbsp;when&nbsp;run&nbsp;under&nbsp;nohup,&nbsp;an&nbsp;uncaught&nbsp;SIGHUP&nbsp;does&nbsp;not&nbsp;kill&nbsp;the&nbsp;program,</span><br>
<span class="lineno"></span><span class="comment" id="8442444">//&nbsp;but&nbsp;a</span><br>
<span class="lineno">165</span><span class="keyword" id="8442453">func</span>&nbsp;<span class="ident" id="8442458">TestNohup</span><span class="op" id="8442467">(</span><span class="ident" id="8442468">t</span>&nbsp;<span class="op" id="8442470">*</span><span class="ident" id="8442471"><a href="/os/signal/signal_test.go.html#8438992">testing</a></span><span class="op" id="8442478">.</span><span class="ident" id="8442479">T</span><span class="op" id="8442480">)</span>&nbsp;<span class="op" id="8442482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442485">//&nbsp;Ugly:&nbsp;ask&nbsp;for&nbsp;SIGHUP&nbsp;so&nbsp;that&nbsp;child&nbsp;will&nbsp;not&nbsp;have&nbsp;no-hup&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442549">//&nbsp;even&nbsp;if&nbsp;test&nbsp;is&nbsp;running&nbsp;under&nbsp;nohup&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442602">//&nbsp;We&nbsp;have&nbsp;no&nbsp;intention&nbsp;of&nbsp;reading&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8442646">c</span>&nbsp;<span class="op" id="8442648">:=</span>&nbsp;<span class="builtinfunc" id="8442651">make</span><span class="op" id="8442655">(</span><span class="keyword" id="8442656">chan</span>&nbsp;<span class="ident" id="8442661"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8442663">.</span><span class="ident" id="8442664">Signal</span><span class="op" id="8442670">,</span>&nbsp;<span class="num" id="8442672">1</span><span class="op" id="8442673">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8442676"><a href="/os/signal/signal.go.html#6217567">Notify</a></span><span class="op" id="8442682">(</span><span class="ident" id="8442683"><a href="/os/signal/signal_test.go.html#8442646">c</a></span><span class="op" id="8442684">,</span>&nbsp;<span class="ident" id="8442686"><a href="/os/signal/signal_test.go.html#8438981">syscall</a></span><span class="op" id="8442693">.</span><span class="ident" id="8442694">SIGHUP</span><span class="op" id="8442700">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442704">//&nbsp;When&nbsp;run&nbsp;without&nbsp;nohup,&nbsp;the&nbsp;test&nbsp;should&nbsp;crash&nbsp;on&nbsp;an&nbsp;uncaught&nbsp;SIGHUP.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442777">//&nbsp;When&nbsp;run&nbsp;under&nbsp;nohup,&nbsp;the&nbsp;test&nbsp;should&nbsp;ignore&nbsp;uncaught&nbsp;SIGHUPs,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442844">//&nbsp;because&nbsp;the&nbsp;runtime&nbsp;is&nbsp;not&nbsp;supposed&nbsp;to&nbsp;be&nbsp;listening&nbsp;for&nbsp;them.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442910">//&nbsp;Either&nbsp;way,&nbsp;TestStop&nbsp;should&nbsp;still&nbsp;be&nbsp;able&nbsp;to&nbsp;catch&nbsp;them&nbsp;when&nbsp;it&nbsp;wants&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8442989">//&nbsp;and&nbsp;then&nbsp;when&nbsp;it&nbsp;stops&nbsp;wanting&nbsp;them,&nbsp;the&nbsp;original&nbsp;behavior&nbsp;should&nbsp;resume.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8443067">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8443071">//&nbsp;send_uncaught_sighup=1&nbsp;sends&nbsp;the&nbsp;SIGHUP&nbsp;before&nbsp;starting&nbsp;to&nbsp;listen&nbsp;for&nbsp;SIGHUPs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8443154">//&nbsp;send_uncaught_sighup=2&nbsp;sends&nbsp;the&nbsp;SIGHUP&nbsp;after&nbsp;no&nbsp;longer&nbsp;listening&nbsp;for&nbsp;SIGHUPs.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8443237">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8443241">//&nbsp;Both&nbsp;should&nbsp;fail&nbsp;without&nbsp;nohup&nbsp;and&nbsp;succeed&nbsp;with&nbsp;nohup.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8443301">for</span>&nbsp;<span class="ident" id="8443305">i</span>&nbsp;<span class="op" id="8443307">:=</span>&nbsp;<span class="num" id="8443310">1</span><span class="op" id="8443311">;</span>&nbsp;<span class="ident" id="8443313"><a href="/os/signal/signal_test.go.html#8443305">i</a></span>&nbsp;<span class="op" id="8443315">&lt;=</span>&nbsp;<span class="num" id="8443318">2</span><span class="op" id="8443319">;</span>&nbsp;<span class="ident" id="8443321"><a href="/os/signal/signal_test.go.html#8443305">i</a></span><span class="op" id="8443322">++</span>&nbsp;<span class="op" id="8443325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8443329">out</span><span class="op" id="8443332">,</span>&nbsp;<span class="ident" id="8443334">err</span>&nbsp;<span class="op" id="8443338">:=</span>&nbsp;<span class="ident" id="8443341"><a href="/os/signal/signal_test.go.html#8438948">exec</a></span><span class="op" id="8443345">.</span><span class="ident" id="8443346">Command</span><span class="op" id="8443353">(</span><span class="ident" id="8443354"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8443356">.</span><span class="ident" id="8443357">Args</span><span class="op" id="8443361">[</span><span class="num" id="8443362">0</span><span class="op" id="8443363">]</span><span class="op" id="8443364">,</span>&nbsp;<span class="string" id="8443366">&#34;-test.run=TestStop&#34;</span><span class="op" id="8443386">,</span>&nbsp;<span class="string" id="8443388">&#34;-send_uncaught_sighup=&#34;</span><span class="op" id="8443412">+</span><span class="ident" id="8443413"><a href="/os/signal/signal_test.go.html#8438970">strconv</a></span><span class="op" id="8443420">.</span><span class="ident" id="8443421">Itoa</span><span class="op" id="8443425">(</span><span class="ident" id="8443426"><a href="/os/signal/signal_test.go.html#8443305">i</a></span><span class="op" id="8443427">)</span><span class="op" id="8443428">)</span><span class="op" id="8443429">.</span><span class="ident" id="8443430">CombinedOutput</span><span class="op" id="8443444">(</span><span class="op" id="8443445">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8443449">if</span>&nbsp;<span class="ident" id="8443452"><a href="/os/signal/signal_test.go.html#8443334">err</a></span>&nbsp;<span class="op" id="8443456">==</span>&nbsp;<span class="ident" id="8443459">nil</span>&nbsp;<span class="op" id="8443463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8443468"><a href="/os/signal/signal_test.go.html#8442468">t</a></span><span class="op" id="8443469">.</span><span class="ident" id="8443470">Fatalf</span><span class="op" id="8443476">(</span><span class="string" id="8443477">&#34;ran&nbsp;test&nbsp;with&nbsp;-send_uncaught_sighup=%d&nbsp;and&nbsp;it&nbsp;succeeded:&nbsp;expected&nbsp;failure.\nOutput:\n%s&#34;</span><span class="op" id="8443566">,</span>&nbsp;<span class="ident" id="8443568"><a href="/os/signal/signal_test.go.html#8443305">i</a></span><span class="op" id="8443569">,</span>&nbsp;<span class="ident" id="8443571"><a href="/os/signal/signal_test.go.html#8443329">out</a></span><span class="op" id="8443574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8443578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8443581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8443585"><a href="/os/signal/signal.go.html#6218387">Stop</a></span><span class="op" id="8443589">(</span><span class="ident" id="8443590"><a href="/os/signal/signal_test.go.html#8442646">c</a></span><span class="op" id="8443591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8443595">//&nbsp;Again,&nbsp;this&nbsp;time&nbsp;with&nbsp;nohup,&nbsp;assuming&nbsp;we&nbsp;can&nbsp;find&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8443653">_</span><span class="op" id="8443654">,</span>&nbsp;<span class="ident" id="8443656">err</span>&nbsp;<span class="op" id="8443660">:=</span>&nbsp;<span class="ident" id="8443663"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8443665">.</span><span class="ident" id="8443666">Stat</span><span class="op" id="8443670">(</span><span class="string" id="8443671">&#34;/usr/bin/nohup&#34;</span><span class="op" id="8443687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8443690">if</span>&nbsp;<span class="ident" id="8443693"><a href="/os/signal/signal_test.go.html#8443656">err</a></span>&nbsp;<span class="op" id="8443697">!=</span>&nbsp;<span class="ident" id="8443700">nil</span>&nbsp;<span class="op" id="8443704">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8443708"><a href="/os/signal/signal_test.go.html#8442468">t</a></span><span class="op" id="8443709">.</span><span class="ident" id="8443710">Skip</span><span class="op" id="8443714">(</span><span class="string" id="8443715">&#34;cannot&nbsp;find&nbsp;nohup;&nbsp;skipping&nbsp;second&nbsp;half&nbsp;of&nbsp;test&#34;</span><span class="op" id="8443764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8443767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8443771">for</span>&nbsp;<span class="ident" id="8443775">i</span>&nbsp;<span class="op" id="8443777">:=</span>&nbsp;<span class="num" id="8443780">1</span><span class="op" id="8443781">;</span>&nbsp;<span class="ident" id="8443783"><a href="/os/signal/signal_test.go.html#8443775">i</a></span>&nbsp;<span class="op" id="8443785">&lt;=</span>&nbsp;<span class="num" id="8443788">2</span><span class="op" id="8443789">;</span>&nbsp;<span class="ident" id="8443791"><a href="/os/signal/signal_test.go.html#8443775">i</a></span><span class="op" id="8443792">++</span>&nbsp;<span class="op" id="8443795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8443799"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8443801">.</span><span class="ident" id="8443802">Remove</span><span class="op" id="8443808">(</span><span class="string" id="8443809">&#34;nohup.out&#34;</span><span class="op" id="8443820">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8443824">out</span><span class="op" id="8443827">,</span>&nbsp;<span class="ident" id="8443829">err</span>&nbsp;<span class="op" id="8443833">:=</span>&nbsp;<span class="ident" id="8443836"><a href="/os/signal/signal_test.go.html#8438948">exec</a></span><span class="op" id="8443840">.</span><span class="ident" id="8443841">Command</span><span class="op" id="8443848">(</span><span class="string" id="8443849">&#34;/usr/bin/nohup&#34;</span><span class="op" id="8443865">,</span>&nbsp;<span class="ident" id="8443867"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8443869">.</span><span class="ident" id="8443870">Args</span><span class="op" id="8443874">[</span><span class="num" id="8443875">0</span><span class="op" id="8443876">]</span><span class="op" id="8443877">,</span>&nbsp;<span class="string" id="8443879">&#34;-test.run=TestStop&#34;</span><span class="op" id="8443899">,</span>&nbsp;<span class="string" id="8443901">&#34;-send_uncaught_sighup=&#34;</span><span class="op" id="8443925">+</span><span class="ident" id="8443926"><a href="/os/signal/signal_test.go.html#8438970">strconv</a></span><span class="op" id="8443933">.</span><span class="ident" id="8443934">Itoa</span><span class="op" id="8443938">(</span><span class="ident" id="8443939"><a href="/os/signal/signal_test.go.html#8443775">i</a></span><span class="op" id="8443940">)</span><span class="op" id="8443941">)</span><span class="op" id="8443942">.</span><span class="ident" id="8443943">CombinedOutput</span><span class="op" id="8443957">(</span><span class="op" id="8443958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8443963">data</span><span class="op" id="8443967">,</span>&nbsp;<span class="ident" id="8443969">_</span>&nbsp;<span class="op" id="8443971">:=</span>&nbsp;<span class="ident" id="8443974"><a href="/os/signal/signal_test.go.html#8438929">ioutil</a></span><span class="op" id="8443980">.</span><span class="ident" id="8443981">ReadFile</span><span class="op" id="8443989">(</span><span class="string" id="8443990">&#34;nohup.out&#34;</span><span class="op" id="8444001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8444005"><a href="/os/signal/signal_test.go.html#8438942">os</a></span><span class="op" id="8444007">.</span><span class="ident" id="8444008">Remove</span><span class="op" id="8444014">(</span><span class="string" id="8444015">&#34;nohup.out&#34;</span><span class="op" id="8444026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8444030">if</span>&nbsp;<span class="ident" id="8444033"><a href="/os/signal/signal_test.go.html#8443829">err</a></span>&nbsp;<span class="op" id="8444037">!=</span>&nbsp;<span class="ident" id="8444040">nil</span>&nbsp;<span class="op" id="8444044">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8444049"><a href="/os/signal/signal_test.go.html#8442468">t</a></span><span class="op" id="8444050">.</span><span class="ident" id="8444051">Fatalf</span><span class="op" id="8444057">(</span><span class="string" id="8444058">&#34;ran&nbsp;test&nbsp;with&nbsp;-send_uncaught_sighup=%d&nbsp;under&nbsp;nohup&nbsp;and&nbsp;it&nbsp;failed:&nbsp;expected&nbsp;success.\nError:&nbsp;%v\nOutput:\n%s%s&#34;</span><span class="op" id="8444169">,</span>&nbsp;<span class="ident" id="8444171"><a href="/os/signal/signal_test.go.html#8443775">i</a></span><span class="op" id="8444172">,</span>&nbsp;<span class="ident" id="8444174"><a href="/os/signal/signal_test.go.html#8443829">err</a></span><span class="op" id="8444177">,</span>&nbsp;<span class="ident" id="8444179"><a href="/os/signal/signal_test.go.html#8443824">out</a></span><span class="op" id="8444182">,</span>&nbsp;<span class="ident" id="8444184"><a href="/os/signal/signal_test.go.html#8443963">data</a></span><span class="op" id="8444188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8444192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8444195">}</span><br>
<span class="lineno"></span><span class="op" id="8444197">}</span>
</div>
</body>
</html>
