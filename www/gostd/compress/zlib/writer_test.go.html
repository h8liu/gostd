<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8224655">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8224710">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8224764">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8224815">package</span>&nbsp;<span class="ident" id="8224823">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8224829">import</span>&nbsp;<span class="op" id="8224836">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224839">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224848">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224855">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224861">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224874">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224880">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8224890">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8224893">var</span>&nbsp;<span class="ident" id="8224897">filenames</span>&nbsp;<span class="op" id="8224907">=</span>&nbsp;<span class="op" id="8224909">[</span><span class="op" id="8224910">]</span><span class="builtintype" id="8224911">string</span><span class="op" id="8224917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224920">&#34;../testdata/e.txt&#34;</span><span class="op" id="8224939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224942">&#34;../testdata/pi.txt&#34;</span><span class="op" id="8224962">,</span><br>
<span class="lineno"></span><span class="op" id="8224964">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8224967">var</span>&nbsp;<span class="ident" id="8224971">data</span>&nbsp;<span class="op" id="8224976">=</span>&nbsp;<span class="op" id="8224978">[</span><span class="op" id="8224979">]</span><span class="builtintype" id="8224980">string</span><span class="op" id="8224986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8224989">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="8225044">,</span><br>
<span class="lineno"></span><span class="op" id="8225046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="8225049">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="8225159">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="8225208">func</span>&nbsp;<span class="ident" id="8225213">testFileLevelDict</span><span class="op" id="8225230">(</span><span class="ident" id="8225231">t</span>&nbsp;<span class="op" id="8225233">*</span><span class="ident" id="8225234">testing</span><span class="op" id="8225241">.</span><span class="ident" id="8225242">T</span><span class="op" id="8225243">,</span>&nbsp;<span class="ident" id="8225245">fn</span>&nbsp;<span class="builtintype" id="8225248">string</span><span class="op" id="8225254">,</span>&nbsp;<span class="ident" id="8225256">level</span>&nbsp;<span class="builtintype" id="8225262">int</span><span class="op" id="8225265">,</span>&nbsp;<span class="ident" id="8225267">d</span>&nbsp;<span class="builtintype" id="8225269">string</span><span class="op" id="8225275">)</span>&nbsp;<span class="op" id="8225277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8225280">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225317">golden</span><span class="op" id="8225323">,</span>&nbsp;<span class="ident" id="8225325">err</span>&nbsp;<span class="op" id="8225329">:=</span>&nbsp;<span class="ident" id="8225332">os</span><span class="op" id="8225334">.</span><span class="ident" id="8225335">Open</span><span class="op" id="8225339">(</span><span class="ident" id="8225340">fn</span><span class="op" id="8225342">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225345">if</span>&nbsp;<span class="ident" id="8225348">err</span>&nbsp;<span class="op" id="8225352">!=</span>&nbsp;<span class="ident" id="8225355">nil</span>&nbsp;<span class="op" id="8225359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225363">t</span><span class="op" id="8225364">.</span><span class="ident" id="8225365">Errorf</span><span class="op" id="8225371">(</span><span class="string" id="8225372">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8225400">,</span>&nbsp;<span class="ident" id="8225402">fn</span><span class="op" id="8225404">,</span>&nbsp;<span class="ident" id="8225406">level</span><span class="op" id="8225411">,</span>&nbsp;<span class="ident" id="8225413">d</span><span class="op" id="8225414">,</span>&nbsp;<span class="ident" id="8225416">err</span><span class="op" id="8225419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225423">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225434">defer</span>&nbsp;<span class="ident" id="8225440">golden</span><span class="op" id="8225446">.</span><span class="ident" id="8225447">Close</span><span class="op" id="8225452">(</span><span class="op" id="8225453">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225456">b0</span><span class="op" id="8225458">,</span>&nbsp;<span class="ident" id="8225460">err0</span>&nbsp;<span class="op" id="8225465">:=</span>&nbsp;<span class="ident" id="8225468">ioutil</span><span class="op" id="8225474">.</span><span class="ident" id="8225475">ReadAll</span><span class="op" id="8225482">(</span><span class="ident" id="8225483">golden</span><span class="op" id="8225489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225492">if</span>&nbsp;<span class="ident" id="8225495">err0</span>&nbsp;<span class="op" id="8225500">!=</span>&nbsp;<span class="ident" id="8225503">nil</span>&nbsp;<span class="op" id="8225507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225511">t</span><span class="op" id="8225512">.</span><span class="ident" id="8225513">Errorf</span><span class="op" id="8225519">(</span><span class="string" id="8225520">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8225548">,</span>&nbsp;<span class="ident" id="8225550">fn</span><span class="op" id="8225552">,</span>&nbsp;<span class="ident" id="8225554">level</span><span class="op" id="8225559">,</span>&nbsp;<span class="ident" id="8225561">d</span><span class="op" id="8225562">,</span>&nbsp;<span class="ident" id="8225564">err0</span><span class="op" id="8225568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225572">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225580">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225583">testLevelDict</span><span class="op" id="8225596">(</span><span class="ident" id="8225597">t</span><span class="op" id="8225598">,</span>&nbsp;<span class="ident" id="8225600">fn</span><span class="op" id="8225602">,</span>&nbsp;<span class="ident" id="8225604">b0</span><span class="op" id="8225606">,</span>&nbsp;<span class="ident" id="8225608">level</span><span class="op" id="8225613">,</span>&nbsp;<span class="ident" id="8225615">d</span><span class="op" id="8225616">)</span><br>
<span class="lineno"></span><span class="op" id="8225618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8225621">func</span>&nbsp;<span class="ident" id="8225626">testLevelDict</span><span class="op" id="8225639">(</span><span class="ident" id="8225640">t</span>&nbsp;<span class="op" id="8225642">*</span><span class="ident" id="8225643">testing</span><span class="op" id="8225650">.</span><span class="ident" id="8225651">T</span><span class="op" id="8225652">,</span>&nbsp;<span class="ident" id="8225654">fn</span>&nbsp;<span class="builtintype" id="8225657">string</span><span class="op" id="8225663">,</span>&nbsp;<span class="ident" id="8225665">b0</span>&nbsp;<span class="op" id="8225668">[</span><span class="op" id="8225669">]</span><span class="builtintype" id="8225670">byte</span><span class="op" id="8225674">,</span>&nbsp;<span class="ident" id="8225676">level</span>&nbsp;<span class="builtintype" id="8225682">int</span><span class="op" id="8225685">,</span>&nbsp;<span class="ident" id="8225687">d</span>&nbsp;<span class="builtintype" id="8225689">string</span><span class="op" id="8225695">)</span>&nbsp;<span class="op" id="8225697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8225700">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225731">var</span>&nbsp;<span class="ident" id="8225735">dict</span>&nbsp;<span class="op" id="8225740">[</span><span class="op" id="8225741">]</span><span class="builtintype" id="8225742">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225748">if</span>&nbsp;<span class="ident" id="8225751">d</span>&nbsp;<span class="op" id="8225753">!=</span>&nbsp;<span class="string" id="8225756">&#34;&#34;</span>&nbsp;<span class="op" id="8225759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225763">dict</span>&nbsp;<span class="op" id="8225768">=</span>&nbsp;<span class="op" id="8225770">[</span><span class="op" id="8225771">]</span><span class="builtintype" id="8225772">byte</span><span class="op" id="8225776">(</span><span class="ident" id="8225777">d</span><span class="op" id="8225778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8225781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8225785">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225882">piper</span><span class="op" id="8225887">,</span>&nbsp;<span class="ident" id="8225889">pipew</span>&nbsp;<span class="op" id="8225895">:=</span>&nbsp;<span class="ident" id="8225898">io</span><span class="op" id="8225900">.</span><span class="ident" id="8225901">Pipe</span><span class="op" id="8225905">(</span><span class="op" id="8225906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225909">defer</span>&nbsp;<span class="ident" id="8225915">piper</span><span class="op" id="8225920">.</span><span class="ident" id="8225921">Close</span><span class="op" id="8225926">(</span><span class="op" id="8225927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225930">go</span>&nbsp;<span class="keyword" id="8225933">func</span><span class="op" id="8225937">(</span><span class="op" id="8225938">)</span>&nbsp;<span class="op" id="8225940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8225944">defer</span>&nbsp;<span class="ident" id="8225950">pipew</span><span class="op" id="8225955">.</span><span class="ident" id="8225956">Close</span><span class="op" id="8225961">(</span><span class="op" id="8225962">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8225966">zlibw</span><span class="op" id="8225971">,</span>&nbsp;<span class="ident" id="8225973">err</span>&nbsp;<span class="op" id="8225977">:=</span>&nbsp;<span class="ident" id="8225980">NewWriterLevelDict</span><span class="op" id="8225998">(</span><span class="ident" id="8225999">pipew</span><span class="op" id="8226004">,</span>&nbsp;<span class="ident" id="8226006">level</span><span class="op" id="8226011">,</span>&nbsp;<span class="ident" id="8226013">dict</span><span class="op" id="8226017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226021">if</span>&nbsp;<span class="ident" id="8226024">err</span>&nbsp;<span class="op" id="8226028">!=</span>&nbsp;<span class="ident" id="8226031">nil</span>&nbsp;<span class="op" id="8226035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226040">t</span><span class="op" id="8226041">.</span><span class="ident" id="8226042">Errorf</span><span class="op" id="8226048">(</span><span class="string" id="8226049">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8226077">,</span>&nbsp;<span class="ident" id="8226079">fn</span><span class="op" id="8226081">,</span>&nbsp;<span class="ident" id="8226083">level</span><span class="op" id="8226088">,</span>&nbsp;<span class="ident" id="8226090">d</span><span class="op" id="8226091">,</span>&nbsp;<span class="ident" id="8226093">err</span><span class="op" id="8226096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226101">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226110">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226114">defer</span>&nbsp;<span class="ident" id="8226120">zlibw</span><span class="op" id="8226125">.</span><span class="ident" id="8226126">Close</span><span class="op" id="8226131">(</span><span class="op" id="8226132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226136">_</span><span class="op" id="8226137">,</span>&nbsp;<span class="ident" id="8226139">err</span>&nbsp;<span class="op" id="8226143">=</span>&nbsp;<span class="ident" id="8226145">zlibw</span><span class="op" id="8226150">.</span><span class="ident" id="8226151">Write</span><span class="op" id="8226156">(</span><span class="ident" id="8226157">b0</span><span class="op" id="8226159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226163">if</span>&nbsp;<span class="ident" id="8226166">err</span>&nbsp;<span class="op" id="8226170">!=</span>&nbsp;<span class="ident" id="8226173">nil</span>&nbsp;<span class="op" id="8226177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226182">t</span><span class="op" id="8226183">.</span><span class="ident" id="8226184">Errorf</span><span class="op" id="8226190">(</span><span class="string" id="8226191">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8226219">,</span>&nbsp;<span class="ident" id="8226221">fn</span><span class="op" id="8226223">,</span>&nbsp;<span class="ident" id="8226225">level</span><span class="op" id="8226230">,</span>&nbsp;<span class="ident" id="8226232">d</span><span class="op" id="8226233">,</span>&nbsp;<span class="ident" id="8226235">err</span><span class="op" id="8226238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226243">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226255">}</span><span class="op" id="8226256">(</span><span class="op" id="8226257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226260">zlibr</span><span class="op" id="8226265">,</span>&nbsp;<span class="ident" id="8226267">err</span>&nbsp;<span class="op" id="8226271">:=</span>&nbsp;<span class="ident" id="8226274">NewReaderDict</span><span class="op" id="8226287">(</span><span class="ident" id="8226288">piper</span><span class="op" id="8226293">,</span>&nbsp;<span class="ident" id="8226295">dict</span><span class="op" id="8226299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226302">if</span>&nbsp;<span class="ident" id="8226305">err</span>&nbsp;<span class="op" id="8226309">!=</span>&nbsp;<span class="ident" id="8226312">nil</span>&nbsp;<span class="op" id="8226316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226320">t</span><span class="op" id="8226321">.</span><span class="ident" id="8226322">Errorf</span><span class="op" id="8226328">(</span><span class="string" id="8226329">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8226357">,</span>&nbsp;<span class="ident" id="8226359">fn</span><span class="op" id="8226361">,</span>&nbsp;<span class="ident" id="8226363">level</span><span class="op" id="8226368">,</span>&nbsp;<span class="ident" id="8226370">d</span><span class="op" id="8226371">,</span>&nbsp;<span class="ident" id="8226373">err</span><span class="op" id="8226376">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226380">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226391">defer</span>&nbsp;<span class="ident" id="8226397">zlibr</span><span class="op" id="8226402">.</span><span class="ident" id="8226403">Close</span><span class="op" id="8226408">(</span><span class="op" id="8226409">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8226413">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226448">b1</span><span class="op" id="8226450">,</span>&nbsp;<span class="ident" id="8226452">err1</span>&nbsp;<span class="op" id="8226457">:=</span>&nbsp;<span class="ident" id="8226460">ioutil</span><span class="op" id="8226466">.</span><span class="ident" id="8226467">ReadAll</span><span class="op" id="8226474">(</span><span class="ident" id="8226475">zlibr</span><span class="op" id="8226480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226483">if</span>&nbsp;<span class="ident" id="8226486">err1</span>&nbsp;<span class="op" id="8226491">!=</span>&nbsp;<span class="ident" id="8226494">nil</span>&nbsp;<span class="op" id="8226498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226502">t</span><span class="op" id="8226503">.</span><span class="ident" id="8226504">Errorf</span><span class="op" id="8226510">(</span><span class="string" id="8226511">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8226539">,</span>&nbsp;<span class="ident" id="8226541">fn</span><span class="op" id="8226543">,</span>&nbsp;<span class="ident" id="8226545">level</span><span class="op" id="8226550">,</span>&nbsp;<span class="ident" id="8226552">d</span><span class="op" id="8226553">,</span>&nbsp;<span class="ident" id="8226555">err1</span><span class="op" id="8226559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226563">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226571">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226574">if</span>&nbsp;<span class="builtinfunc" id="8226577">len</span><span class="op" id="8226580">(</span><span class="ident" id="8226581">b0</span><span class="op" id="8226583">)</span>&nbsp;<span class="op" id="8226585">!=</span>&nbsp;<span class="builtinfunc" id="8226588">len</span><span class="op" id="8226591">(</span><span class="ident" id="8226592">b1</span><span class="op" id="8226594">)</span>&nbsp;<span class="op" id="8226596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226600">t</span><span class="op" id="8226601">.</span><span class="ident" id="8226602">Errorf</span><span class="op" id="8226608">(</span><span class="string" id="8226609">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="8226663">,</span>&nbsp;<span class="ident" id="8226665">fn</span><span class="op" id="8226667">,</span>&nbsp;<span class="ident" id="8226669">level</span><span class="op" id="8226674">,</span>&nbsp;<span class="ident" id="8226676">d</span><span class="op" id="8226677">,</span>&nbsp;<span class="builtinfunc" id="8226679">len</span><span class="op" id="8226682">(</span><span class="ident" id="8226683">b0</span><span class="op" id="8226685">)</span><span class="op" id="8226686">,</span>&nbsp;<span class="builtinfunc" id="8226688">len</span><span class="op" id="8226691">(</span><span class="ident" id="8226692">b1</span><span class="op" id="8226694">)</span><span class="op" id="8226695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226699">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226710">for</span>&nbsp;<span class="ident" id="8226714">i</span>&nbsp;<span class="op" id="8226716">:=</span>&nbsp;<span class="num" id="8226719">0</span><span class="op" id="8226720">;</span>&nbsp;<span class="ident" id="8226722">i</span>&nbsp;<span class="op" id="8226724">&lt;</span>&nbsp;<span class="builtinfunc" id="8226726">len</span><span class="op" id="8226729">(</span><span class="ident" id="8226730">b0</span><span class="op" id="8226732">)</span><span class="op" id="8226733">;</span>&nbsp;<span class="ident" id="8226735">i</span><span class="op" id="8226736">++</span>&nbsp;<span class="op" id="8226739">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226743">if</span>&nbsp;<span class="ident" id="8226746">b0</span><span class="op" id="8226748">[</span><span class="ident" id="8226749">i</span><span class="op" id="8226750">]</span>&nbsp;<span class="op" id="8226752">!=</span>&nbsp;<span class="ident" id="8226755">b1</span><span class="op" id="8226757">[</span><span class="ident" id="8226758">i</span><span class="op" id="8226759">]</span>&nbsp;<span class="op" id="8226761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8226766">t</span><span class="op" id="8226767">.</span><span class="ident" id="8226768">Errorf</span><span class="op" id="8226774">(</span><span class="string" id="8226775">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="8226839">,</span>&nbsp;<span class="ident" id="8226841">fn</span><span class="op" id="8226843">,</span>&nbsp;<span class="ident" id="8226845">level</span><span class="op" id="8226850">,</span>&nbsp;<span class="ident" id="8226852">d</span><span class="op" id="8226853">,</span>&nbsp;<span class="ident" id="8226855">i</span><span class="op" id="8226856">,</span>&nbsp;<span class="ident" id="8226858">b0</span><span class="op" id="8226860">[</span><span class="ident" id="8226861">i</span><span class="op" id="8226862">]</span><span class="op" id="8226863">,</span>&nbsp;<span class="ident" id="8226865">b1</span><span class="op" id="8226867">[</span><span class="ident" id="8226868">i</span><span class="op" id="8226869">]</span><span class="op" id="8226870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226875">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8226887">}</span><br>
<span class="lineno">90</span><span class="op" id="8226889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8226892">func</span>&nbsp;<span class="ident" id="8226897">testFileLevelDictReset</span><span class="op" id="8226919">(</span><span class="ident" id="8226920">t</span>&nbsp;<span class="op" id="8226922">*</span><span class="ident" id="8226923">testing</span><span class="op" id="8226930">.</span><span class="ident" id="8226931">T</span><span class="op" id="8226932">,</span>&nbsp;<span class="ident" id="8226934">fn</span>&nbsp;<span class="builtintype" id="8226937">string</span><span class="op" id="8226943">,</span>&nbsp;<span class="ident" id="8226945">level</span>&nbsp;<span class="builtintype" id="8226951">int</span><span class="op" id="8226954">,</span>&nbsp;<span class="ident" id="8226956">dict</span>&nbsp;<span class="op" id="8226961">[</span><span class="op" id="8226962">]</span><span class="builtintype" id="8226963">byte</span><span class="op" id="8226967">)</span>&nbsp;<span class="op" id="8226969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226972">var</span>&nbsp;<span class="ident" id="8226976">b0</span>&nbsp;<span class="op" id="8226979">[</span><span class="op" id="8226980">]</span><span class="builtintype" id="8226981">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8226987">var</span>&nbsp;<span class="ident" id="8226991">err</span>&nbsp;<span class="builtintype" id="8226995">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227002">if</span>&nbsp;<span class="ident" id="8227005">fn</span>&nbsp;<span class="op" id="8227008">!=</span>&nbsp;<span class="string" id="8227011">&#34;&#34;</span>&nbsp;<span class="op" id="8227014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227018">b0</span><span class="op" id="8227020">,</span>&nbsp;<span class="ident" id="8227022">err</span>&nbsp;<span class="op" id="8227026">=</span>&nbsp;<span class="ident" id="8227028">ioutil</span><span class="op" id="8227034">.</span><span class="ident" id="8227035">ReadFile</span><span class="op" id="8227043">(</span><span class="ident" id="8227044">fn</span><span class="op" id="8227046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227050">if</span>&nbsp;<span class="ident" id="8227053">err</span>&nbsp;<span class="op" id="8227057">!=</span>&nbsp;<span class="ident" id="8227060">nil</span>&nbsp;<span class="op" id="8227064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227069">t</span><span class="op" id="8227070">.</span><span class="ident" id="8227071">Errorf</span><span class="op" id="8227077">(</span><span class="string" id="8227078">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8227097">,</span>&nbsp;<span class="ident" id="8227099">fn</span><span class="op" id="8227101">,</span>&nbsp;<span class="ident" id="8227103">level</span><span class="op" id="8227108">,</span>&nbsp;<span class="ident" id="8227110">err</span><span class="op" id="8227113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227118">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8227134">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227153">buf</span>&nbsp;<span class="op" id="8227157">:=</span>&nbsp;<span class="builtinfunc" id="8227160">new</span><span class="op" id="8227163">(</span><span class="ident" id="8227164">bytes</span><span class="op" id="8227169">.</span><span class="ident" id="8227170">Buffer</span><span class="op" id="8227176">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227179">var</span>&nbsp;<span class="ident" id="8227183">zlibw</span>&nbsp;<span class="op" id="8227189">*</span><span class="ident" id="8227190">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227198">if</span>&nbsp;<span class="ident" id="8227201">dict</span>&nbsp;<span class="op" id="8227206">==</span>&nbsp;<span class="ident" id="8227209">nil</span>&nbsp;<span class="op" id="8227213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227217">zlibw</span><span class="op" id="8227222">,</span>&nbsp;<span class="ident" id="8227224">err</span>&nbsp;<span class="op" id="8227228">=</span>&nbsp;<span class="ident" id="8227230">NewWriterLevel</span><span class="op" id="8227244">(</span><span class="ident" id="8227245">buf</span><span class="op" id="8227248">,</span>&nbsp;<span class="ident" id="8227250">level</span><span class="op" id="8227255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227258">}</span>&nbsp;<span class="keyword" id="8227260">else</span>&nbsp;<span class="op" id="8227265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227269">zlibw</span><span class="op" id="8227274">,</span>&nbsp;<span class="ident" id="8227276">err</span>&nbsp;<span class="op" id="8227280">=</span>&nbsp;<span class="ident" id="8227282">NewWriterLevelDict</span><span class="op" id="8227300">(</span><span class="ident" id="8227301">buf</span><span class="op" id="8227304">,</span>&nbsp;<span class="ident" id="8227306">level</span><span class="op" id="8227311">,</span>&nbsp;<span class="ident" id="8227313">dict</span><span class="op" id="8227317">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227323">if</span>&nbsp;<span class="ident" id="8227326">err</span>&nbsp;<span class="op" id="8227330">==</span>&nbsp;<span class="ident" id="8227333">nil</span>&nbsp;<span class="op" id="8227337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227341">_</span><span class="op" id="8227342">,</span>&nbsp;<span class="ident" id="8227344">err</span>&nbsp;<span class="op" id="8227348">=</span>&nbsp;<span class="ident" id="8227350">zlibw</span><span class="op" id="8227355">.</span><span class="ident" id="8227356">Write</span><span class="op" id="8227361">(</span><span class="ident" id="8227362">b0</span><span class="op" id="8227364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227370">if</span>&nbsp;<span class="ident" id="8227373">err</span>&nbsp;<span class="op" id="8227377">==</span>&nbsp;<span class="ident" id="8227380">nil</span>&nbsp;<span class="op" id="8227384">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227388">err</span>&nbsp;<span class="op" id="8227392">=</span>&nbsp;<span class="ident" id="8227394">zlibw</span><span class="op" id="8227399">.</span><span class="ident" id="8227400">Close</span><span class="op" id="8227405">(</span><span class="op" id="8227406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227412">if</span>&nbsp;<span class="ident" id="8227415">err</span>&nbsp;<span class="op" id="8227419">!=</span>&nbsp;<span class="ident" id="8227422">nil</span>&nbsp;<span class="op" id="8227426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227430">t</span><span class="op" id="8227431">.</span><span class="ident" id="8227432">Errorf</span><span class="op" id="8227438">(</span><span class="string" id="8227439">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8227458">,</span>&nbsp;<span class="ident" id="8227460">fn</span><span class="op" id="8227462">,</span>&nbsp;<span class="ident" id="8227464">level</span><span class="op" id="8227469">,</span>&nbsp;<span class="ident" id="8227471">err</span><span class="op" id="8227474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227478">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227489">out</span>&nbsp;<span class="op" id="8227493">:=</span>&nbsp;<span class="ident" id="8227496">buf</span><span class="op" id="8227499">.</span><span class="ident" id="8227500">String</span><span class="op" id="8227506">(</span><span class="op" id="8227507">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8227511">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227541">buf2</span>&nbsp;<span class="op" id="8227546">:=</span>&nbsp;<span class="builtinfunc" id="8227549">new</span><span class="op" id="8227552">(</span><span class="ident" id="8227553">bytes</span><span class="op" id="8227558">.</span><span class="ident" id="8227559">Buffer</span><span class="op" id="8227565">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227568">zlibw</span><span class="op" id="8227573">.</span><span class="ident" id="8227574">Reset</span><span class="op" id="8227579">(</span><span class="ident" id="8227580">buf2</span><span class="op" id="8227584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227587">_</span><span class="op" id="8227588">,</span>&nbsp;<span class="ident" id="8227590">err</span>&nbsp;<span class="op" id="8227594">=</span>&nbsp;<span class="ident" id="8227596">zlibw</span><span class="op" id="8227601">.</span><span class="ident" id="8227602">Write</span><span class="op" id="8227607">(</span><span class="ident" id="8227608">b0</span><span class="op" id="8227610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227613">if</span>&nbsp;<span class="ident" id="8227616">err</span>&nbsp;<span class="op" id="8227620">==</span>&nbsp;<span class="ident" id="8227623">nil</span>&nbsp;<span class="op" id="8227627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227631">err</span>&nbsp;<span class="op" id="8227635">=</span>&nbsp;<span class="ident" id="8227637">zlibw</span><span class="op" id="8227642">.</span><span class="ident" id="8227643">Close</span><span class="op" id="8227648">(</span><span class="op" id="8227649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227652">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227655">if</span>&nbsp;<span class="ident" id="8227658">err</span>&nbsp;<span class="op" id="8227662">!=</span>&nbsp;<span class="ident" id="8227665">nil</span>&nbsp;<span class="op" id="8227669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227673">t</span><span class="op" id="8227674">.</span><span class="ident" id="8227675">Errorf</span><span class="op" id="8227681">(</span><span class="string" id="8227682">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8227701">,</span>&nbsp;<span class="ident" id="8227703">fn</span><span class="op" id="8227705">,</span>&nbsp;<span class="ident" id="8227707">level</span><span class="op" id="8227712">,</span>&nbsp;<span class="ident" id="8227714">err</span><span class="op" id="8227717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227721">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227732">out2</span>&nbsp;<span class="op" id="8227737">:=</span>&nbsp;<span class="ident" id="8227740">buf2</span><span class="op" id="8227744">.</span><span class="ident" id="8227745">String</span><span class="op" id="8227751">(</span><span class="op" id="8227752">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227756">if</span>&nbsp;<span class="ident" id="8227759">out2</span>&nbsp;<span class="op" id="8227764">!=</span>&nbsp;<span class="ident" id="8227767">out</span>&nbsp;<span class="op" id="8227771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227775">t</span><span class="op" id="8227776">.</span><span class="ident" id="8227777">Errorf</span><span class="op" id="8227783">(</span><span class="string" id="8227784">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8227856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227861">fn</span><span class="op" id="8227863">,</span>&nbsp;<span class="ident" id="8227865">level</span><span class="op" id="8227870">,</span>&nbsp;<span class="builtinfunc" id="8227872">len</span><span class="op" id="8227875">(</span><span class="ident" id="8227876">out2</span><span class="op" id="8227880">)</span><span class="op" id="8227881">,</span>&nbsp;<span class="builtinfunc" id="8227883">len</span><span class="op" id="8227886">(</span><span class="ident" id="8227887">out</span><span class="op" id="8227890">)</span><span class="op" id="8227891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8227894">}</span><br>
<span class="lineno">140</span><span class="op" id="8227896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8227899">func</span>&nbsp;<span class="ident" id="8227904">TestWriter</span><span class="op" id="8227914">(</span><span class="ident" id="8227915">t</span>&nbsp;<span class="op" id="8227917">*</span><span class="ident" id="8227918">testing</span><span class="op" id="8227925">.</span><span class="ident" id="8227926">T</span><span class="op" id="8227927">)</span>&nbsp;<span class="op" id="8227929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8227932">for</span>&nbsp;<span class="ident" id="8227936">i</span><span class="op" id="8227937">,</span>&nbsp;<span class="ident" id="8227939">s</span>&nbsp;<span class="op" id="8227941">:=</span>&nbsp;<span class="keyword" id="8227944">range</span>&nbsp;<span class="ident" id="8227950">data</span>&nbsp;<span class="op" id="8227955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227959">b</span>&nbsp;<span class="op" id="8227961">:=</span>&nbsp;<span class="op" id="8227964">[</span><span class="op" id="8227965">]</span><span class="builtintype" id="8227966">byte</span><span class="op" id="8227970">(</span><span class="ident" id="8227971">s</span><span class="op" id="8227972">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8227976">tag</span>&nbsp;<span class="op" id="8227980">:=</span>&nbsp;<span class="ident" id="8227983">fmt</span><span class="op" id="8227986">.</span><span class="ident" id="8227987">Sprintf</span><span class="op" id="8227994">(</span><span class="string" id="8227995">&#34;#%d&#34;</span><span class="op" id="8228000">,</span>&nbsp;<span class="ident" id="8228002">i</span><span class="op" id="8228003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228007">testLevelDict</span><span class="op" id="8228020">(</span><span class="ident" id="8228021">t</span><span class="op" id="8228022">,</span>&nbsp;<span class="ident" id="8228024">tag</span><span class="op" id="8228027">,</span>&nbsp;<span class="ident" id="8228029">b</span><span class="op" id="8228030">,</span>&nbsp;<span class="ident" id="8228032">DefaultCompression</span><span class="op" id="8228050">,</span>&nbsp;<span class="string" id="8228052">&#34;&#34;</span><span class="op" id="8228054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228058">testLevelDict</span><span class="op" id="8228071">(</span><span class="ident" id="8228072">t</span><span class="op" id="8228073">,</span>&nbsp;<span class="ident" id="8228075">tag</span><span class="op" id="8228078">,</span>&nbsp;<span class="ident" id="8228080">b</span><span class="op" id="8228081">,</span>&nbsp;<span class="ident" id="8228083">NoCompression</span><span class="op" id="8228096">,</span>&nbsp;<span class="string" id="8228098">&#34;&#34;</span><span class="op" id="8228100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8228104">for</span>&nbsp;<span class="ident" id="8228108">level</span>&nbsp;<span class="op" id="8228114">:=</span>&nbsp;<span class="ident" id="8228117">BestSpeed</span><span class="op" id="8228126">;</span>&nbsp;<span class="ident" id="8228128">level</span>&nbsp;<span class="op" id="8228134">&lt;=</span>&nbsp;<span class="ident" id="8228137">BestCompression</span><span class="op" id="8228152">;</span>&nbsp;<span class="ident" id="8228154">level</span><span class="op" id="8228159">++</span>&nbsp;<span class="op" id="8228162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228167">testLevelDict</span><span class="op" id="8228180">(</span><span class="ident" id="8228181">t</span><span class="op" id="8228182">,</span>&nbsp;<span class="ident" id="8228184">tag</span><span class="op" id="8228187">,</span>&nbsp;<span class="ident" id="8228189">b</span><span class="op" id="8228190">,</span>&nbsp;<span class="ident" id="8228192">level</span><span class="op" id="8228197">,</span>&nbsp;<span class="string" id="8228199">&#34;&#34;</span><span class="op" id="8228201">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228208">}</span><br>
<span class="lineno"></span><span class="op" id="8228210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8228213">func</span>&nbsp;<span class="ident" id="8228218">TestWriterBig</span><span class="op" id="8228231">(</span><span class="ident" id="8228232">t</span>&nbsp;<span class="op" id="8228234">*</span><span class="ident" id="8228235">testing</span><span class="op" id="8228242">.</span><span class="ident" id="8228243">T</span><span class="op" id="8228244">)</span>&nbsp;<span class="op" id="8228246">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8228249">for</span>&nbsp;<span class="ident" id="8228253">_</span><span class="op" id="8228254">,</span>&nbsp;<span class="ident" id="8228256">fn</span>&nbsp;<span class="op" id="8228259">:=</span>&nbsp;<span class="keyword" id="8228262">range</span>&nbsp;<span class="ident" id="8228268">filenames</span>&nbsp;<span class="op" id="8228278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228282">testFileLevelDict</span><span class="op" id="8228299">(</span><span class="ident" id="8228300">t</span><span class="op" id="8228301">,</span>&nbsp;<span class="ident" id="8228303">fn</span><span class="op" id="8228305">,</span>&nbsp;<span class="ident" id="8228307">DefaultCompression</span><span class="op" id="8228325">,</span>&nbsp;<span class="string" id="8228327">&#34;&#34;</span><span class="op" id="8228329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228333">testFileLevelDict</span><span class="op" id="8228350">(</span><span class="ident" id="8228351">t</span><span class="op" id="8228352">,</span>&nbsp;<span class="ident" id="8228354">fn</span><span class="op" id="8228356">,</span>&nbsp;<span class="ident" id="8228358">NoCompression</span><span class="op" id="8228371">,</span>&nbsp;<span class="string" id="8228373">&#34;&#34;</span><span class="op" id="8228375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8228379">for</span>&nbsp;<span class="ident" id="8228383">level</span>&nbsp;<span class="op" id="8228389">:=</span>&nbsp;<span class="ident" id="8228392">BestSpeed</span><span class="op" id="8228401">;</span>&nbsp;<span class="ident" id="8228403">level</span>&nbsp;<span class="op" id="8228409">&lt;=</span>&nbsp;<span class="ident" id="8228412">BestCompression</span><span class="op" id="8228427">;</span>&nbsp;<span class="ident" id="8228429">level</span><span class="op" id="8228434">++</span>&nbsp;<span class="op" id="8228437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228442">testFileLevelDict</span><span class="op" id="8228459">(</span><span class="ident" id="8228460">t</span><span class="op" id="8228461">,</span>&nbsp;<span class="ident" id="8228463">fn</span><span class="op" id="8228465">,</span>&nbsp;<span class="ident" id="8228467">level</span><span class="op" id="8228472">,</span>&nbsp;<span class="string" id="8228474">&#34;&#34;</span><span class="op" id="8228476">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228483">}</span><br>
<span class="lineno"></span><span class="op" id="8228485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8228488">func</span>&nbsp;<span class="ident" id="8228493">TestWriterDict</span><span class="op" id="8228507">(</span><span class="ident" id="8228508">t</span>&nbsp;<span class="op" id="8228510">*</span><span class="ident" id="8228511">testing</span><span class="op" id="8228518">.</span><span class="ident" id="8228519">T</span><span class="op" id="8228520">)</span>&nbsp;<span class="op" id="8228522">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8228525">const</span>&nbsp;<span class="ident" id="8228531">dictionary</span>&nbsp;<span class="op" id="8228542">=</span>&nbsp;<span class="string" id="8228544">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8228559">for</span>&nbsp;<span class="ident" id="8228563">_</span><span class="op" id="8228564">,</span>&nbsp;<span class="ident" id="8228566">fn</span>&nbsp;<span class="op" id="8228569">:=</span>&nbsp;<span class="keyword" id="8228572">range</span>&nbsp;<span class="ident" id="8228578">filenames</span>&nbsp;<span class="op" id="8228588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228592">testFileLevelDict</span><span class="op" id="8228609">(</span><span class="ident" id="8228610">t</span><span class="op" id="8228611">,</span>&nbsp;<span class="ident" id="8228613">fn</span><span class="op" id="8228615">,</span>&nbsp;<span class="ident" id="8228617">DefaultCompression</span><span class="op" id="8228635">,</span>&nbsp;<span class="ident" id="8228637">dictionary</span><span class="op" id="8228647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228651">testFileLevelDict</span><span class="op" id="8228668">(</span><span class="ident" id="8228669">t</span><span class="op" id="8228670">,</span>&nbsp;<span class="ident" id="8228672">fn</span><span class="op" id="8228674">,</span>&nbsp;<span class="ident" id="8228676">NoCompression</span><span class="op" id="8228689">,</span>&nbsp;<span class="ident" id="8228691">dictionary</span><span class="op" id="8228701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8228705">for</span>&nbsp;<span class="ident" id="8228709">level</span>&nbsp;<span class="op" id="8228715">:=</span>&nbsp;<span class="ident" id="8228718">BestSpeed</span><span class="op" id="8228727">;</span>&nbsp;<span class="ident" id="8228729">level</span>&nbsp;<span class="op" id="8228735">&lt;=</span>&nbsp;<span class="ident" id="8228738">BestCompression</span><span class="op" id="8228753">;</span>&nbsp;<span class="ident" id="8228755">level</span><span class="op" id="8228760">++</span>&nbsp;<span class="op" id="8228763">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228768">testFileLevelDict</span><span class="op" id="8228785">(</span><span class="ident" id="8228786">t</span><span class="op" id="8228787">,</span>&nbsp;<span class="ident" id="8228789">fn</span><span class="op" id="8228791">,</span>&nbsp;<span class="ident" id="8228793">level</span><span class="op" id="8228798">,</span>&nbsp;<span class="ident" id="8228800">dictionary</span><span class="op" id="8228810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8228817">}</span><br>
<span class="lineno"></span><span class="op" id="8228819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="8228822">func</span>&nbsp;<span class="ident" id="8228827">TestWriterReset</span><span class="op" id="8228842">(</span><span class="ident" id="8228843">t</span>&nbsp;<span class="op" id="8228845">*</span><span class="ident" id="8228846">testing</span><span class="op" id="8228853">.</span><span class="ident" id="8228854">T</span><span class="op" id="8228855">)</span>&nbsp;<span class="op" id="8228857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8228860">const</span>&nbsp;<span class="ident" id="8228866">dictionary</span>&nbsp;<span class="op" id="8228877">=</span>&nbsp;<span class="string" id="8228879">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8228894">for</span>&nbsp;<span class="ident" id="8228898">_</span><span class="op" id="8228899">,</span>&nbsp;<span class="ident" id="8228901">fn</span>&nbsp;<span class="op" id="8228904">:=</span>&nbsp;<span class="keyword" id="8228907">range</span>&nbsp;<span class="ident" id="8228913">filenames</span>&nbsp;<span class="op" id="8228923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228927">testFileLevelDictReset</span><span class="op" id="8228949">(</span><span class="ident" id="8228950">t</span><span class="op" id="8228951">,</span>&nbsp;<span class="ident" id="8228953">fn</span><span class="op" id="8228955">,</span>&nbsp;<span class="ident" id="8228957">NoCompression</span><span class="op" id="8228970">,</span>&nbsp;<span class="ident" id="8228972">nil</span><span class="op" id="8228975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8228979">testFileLevelDictReset</span><span class="op" id="8229001">(</span><span class="ident" id="8229002">t</span><span class="op" id="8229003">,</span>&nbsp;<span class="ident" id="8229005">fn</span><span class="op" id="8229007">,</span>&nbsp;<span class="ident" id="8229009">DefaultCompression</span><span class="op" id="8229027">,</span>&nbsp;<span class="ident" id="8229029">nil</span><span class="op" id="8229032">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229036">testFileLevelDictReset</span><span class="op" id="8229058">(</span><span class="ident" id="8229059">t</span><span class="op" id="8229060">,</span>&nbsp;<span class="ident" id="8229062">fn</span><span class="op" id="8229064">,</span>&nbsp;<span class="ident" id="8229066">NoCompression</span><span class="op" id="8229079">,</span>&nbsp;<span class="op" id="8229081">[</span><span class="op" id="8229082">]</span><span class="builtintype" id="8229083">byte</span><span class="op" id="8229087">(</span><span class="ident" id="8229088">dictionary</span><span class="op" id="8229098">)</span><span class="op" id="8229099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229103">testFileLevelDictReset</span><span class="op" id="8229125">(</span><span class="ident" id="8229126">t</span><span class="op" id="8229127">,</span>&nbsp;<span class="ident" id="8229129">fn</span><span class="op" id="8229131">,</span>&nbsp;<span class="ident" id="8229133">DefaultCompression</span><span class="op" id="8229151">,</span>&nbsp;<span class="op" id="8229153">[</span><span class="op" id="8229154">]</span><span class="builtintype" id="8229155">byte</span><span class="op" id="8229159">(</span><span class="ident" id="8229160">dictionary</span><span class="op" id="8229170">)</span><span class="op" id="8229171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8229175">if</span>&nbsp;<span class="op" id="8229178">!</span><span class="ident" id="8229179">testing</span><span class="op" id="8229186">.</span><span class="ident" id="8229187">Short</span><span class="op" id="8229192">(</span><span class="op" id="8229193">)</span>&nbsp;<span class="op" id="8229195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8229200">for</span>&nbsp;<span class="ident" id="8229204">level</span>&nbsp;<span class="op" id="8229210">:=</span>&nbsp;<span class="ident" id="8229213">BestSpeed</span><span class="op" id="8229222">;</span>&nbsp;<span class="ident" id="8229224">level</span>&nbsp;<span class="op" id="8229230">&lt;=</span>&nbsp;<span class="ident" id="8229233">BestCompression</span><span class="op" id="8229248">;</span>&nbsp;<span class="ident" id="8229250">level</span><span class="op" id="8229255">++</span>&nbsp;<span class="op" id="8229258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229264">testFileLevelDictReset</span><span class="op" id="8229286">(</span><span class="ident" id="8229287">t</span><span class="op" id="8229288">,</span>&nbsp;<span class="ident" id="8229290">fn</span><span class="op" id="8229292">,</span>&nbsp;<span class="ident" id="8229294">level</span><span class="op" id="8229299">,</span>&nbsp;<span class="ident" id="8229301">nil</span><span class="op" id="8229304">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229316">}</span><br>
<span class="lineno"></span><span class="op" id="8229318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="8229321">func</span>&nbsp;<span class="ident" id="8229326">TestWriterDictIsUsed</span><span class="op" id="8229346">(</span><span class="ident" id="8229347">t</span>&nbsp;<span class="op" id="8229349">*</span><span class="ident" id="8229350">testing</span><span class="op" id="8229357">.</span><span class="ident" id="8229358">T</span><span class="op" id="8229359">)</span>&nbsp;<span class="op" id="8229361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8229364">var</span>&nbsp;<span class="ident" id="8229368">input</span>&nbsp;<span class="op" id="8229374">=</span>&nbsp;<span class="op" id="8229376">[</span><span class="op" id="8229377">]</span><span class="builtintype" id="8229378">byte</span><span class="op" id="8229382">(</span><span class="string" id="8229383">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="8229509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8229512">var</span>&nbsp;<span class="ident" id="8229516">buf</span>&nbsp;<span class="ident" id="8229520">bytes</span><span class="op" id="8229525">.</span><span class="ident" id="8229526">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229534">compressor</span><span class="op" id="8229544">,</span>&nbsp;<span class="ident" id="8229546">err</span>&nbsp;<span class="op" id="8229550">:=</span>&nbsp;<span class="ident" id="8229553">NewWriterLevelDict</span><span class="op" id="8229571">(</span><span class="op" id="8229572">&amp;</span><span class="ident" id="8229573">buf</span><span class="op" id="8229576">,</span>&nbsp;<span class="ident" id="8229578">BestCompression</span><span class="op" id="8229593">,</span>&nbsp;<span class="ident" id="8229595">input</span><span class="op" id="8229600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8229603">if</span>&nbsp;<span class="ident" id="8229606">err</span>&nbsp;<span class="op" id="8229610">!=</span>&nbsp;<span class="ident" id="8229613">nil</span>&nbsp;<span class="op" id="8229617">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229621">t</span><span class="op" id="8229622">.</span><span class="ident" id="8229623">Errorf</span><span class="op" id="8229629">(</span><span class="string" id="8229630">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="8229663">,</span>&nbsp;<span class="ident" id="8229665">err</span><span class="op" id="8229668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8229672">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229683">compressor</span><span class="op" id="8229693">.</span><span class="ident" id="8229694">Write</span><span class="op" id="8229699">(</span><span class="ident" id="8229700">input</span><span class="op" id="8229705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229708">compressor</span><span class="op" id="8229718">.</span><span class="ident" id="8229719">Close</span><span class="op" id="8229724">(</span><span class="op" id="8229725">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8229728">const</span>&nbsp;<span class="ident" id="8229734">expectedMaxSize</span>&nbsp;<span class="op" id="8229750">=</span>&nbsp;<span class="num" id="8229752">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229756">output</span>&nbsp;<span class="op" id="8229763">:=</span>&nbsp;<span class="ident" id="8229766">buf</span><span class="op" id="8229769">.</span><span class="ident" id="8229770">Bytes</span><span class="op" id="8229775">(</span><span class="op" id="8229776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8229779">if</span>&nbsp;<span class="builtinfunc" id="8229782">len</span><span class="op" id="8229785">(</span><span class="ident" id="8229786">output</span><span class="op" id="8229792">)</span>&nbsp;<span class="op" id="8229794">&gt;</span>&nbsp;<span class="ident" id="8229796">expectedMaxSize</span>&nbsp;<span class="op" id="8229812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8229816">t</span><span class="op" id="8229817">.</span><span class="ident" id="8229818">Errorf</span><span class="op" id="8229824">(</span><span class="string" id="8229825">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="8229901">,</span>&nbsp;<span class="builtinfunc" id="8229903">len</span><span class="op" id="8229906">(</span><span class="ident" id="8229907">output</span><span class="op" id="8229913">)</span><span class="op" id="8229914">,</span>&nbsp;<span class="ident" id="8229916">expectedMaxSize</span><span class="op" id="8229931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8229934">}</span><br>
<span class="lineno">205</span><span class="op" id="8229936">}</span>
</div>
</body>
</html>
