<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4029708">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4029763">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4029817">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4029868">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4029928">package</span>&nbsp;<span class="ident" id="4029936">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4029942">import</span>&nbsp;<span class="op" id="4029949">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4029952">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4029961">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4029971">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4029985">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030001">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030020">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030034">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030049">_</span>&nbsp;<span class="string" id="4030051">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030068">_</span>&nbsp;<span class="string" id="4030070">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030087">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030107">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030124">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030140">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030150">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030156">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030168">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030175">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4030186">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4030193">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4030196">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4030276">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4030292">type</span>&nbsp;<span class="ident" id="4030297">pkixPublicKey</span>&nbsp;<span class="keyword" id="4030311">struct</span>&nbsp;<span class="op" id="4030318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030321">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4030331"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4030335">.</span><span class="ident" id="4030336">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030357">BitString</span>&nbsp;<span class="ident" id="4030367"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4030371">.</span><span class="ident" id="4030372">BitString</span><br>
<span class="lineno"></span><span class="op" id="4030382">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4030385">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4030457">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4030515">func</span>&nbsp;<span class="ident" id="4030520">ParsePKIXPublicKey</span><span class="op" id="4030538">(</span><span class="ident" id="4030539">derBytes</span>&nbsp;<span class="op" id="4030548">[</span><span class="op" id="4030549">]</span><span class="builtintype" id="4030550">byte</span><span class="op" id="4030554">)</span>&nbsp;<span class="op" id="4030556">(</span><span class="ident" id="4030557">pub</span>&nbsp;<span class="keyword" id="4030561">interface</span><span class="op" id="4030570">{</span><span class="op" id="4030571">}</span><span class="op" id="4030572">,</span>&nbsp;<span class="ident" id="4030574">err</span>&nbsp;<span class="builtintype" id="4030578">error</span><span class="op" id="4030583">)</span>&nbsp;<span class="op" id="4030585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030588">var</span>&nbsp;<span class="ident" id="4030592">pki</span>&nbsp;<span class="ident" id="4030596"><a href="/crypto/x509/x509.go.html#4033546">publicKeyInfo</a></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030611">if</span>&nbsp;<span class="ident" id="4030614">_</span><span class="op" id="4030615">,</span>&nbsp;<span class="ident" id="4030617"><a href="/crypto/x509/x509.go.html#4030574">err</a></span>&nbsp;<span class="op" id="4030621">=</span>&nbsp;<span class="ident" id="4030623"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4030627">.</span><span class="ident" id="4030628">Unmarshal</span><span class="op" id="4030637">(</span><span class="ident" id="4030638"><a href="/crypto/x509/x509.go.html#4030539">derBytes</a></span><span class="op" id="4030646">,</span>&nbsp;<span class="op" id="4030648">&amp;</span><span class="ident" id="4030649"><a href="/crypto/x509/x509.go.html#4030592">pki</a></span><span class="op" id="4030652">)</span><span class="op" id="4030653">;</span>&nbsp;<span class="ident" id="4030655"><a href="/crypto/x509/x509.go.html#4030574">err</a></span>&nbsp;<span class="op" id="4030659">!=</span>&nbsp;<span class="ident" id="4030662">nil</span>&nbsp;<span class="op" id="4030666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030670">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030681">algo</span>&nbsp;<span class="op" id="4030686">:=</span>&nbsp;<span class="ident" id="4030689"><a href="/crypto/x509/x509.go.html#4038569">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4030717">(</span><span class="ident" id="4030718"><a href="/crypto/x509/x509.go.html#4030592">pki</a></span><span class="op" id="4030721">.</span><span class="ident" id="4030722">Algorithm</span><span class="op" id="4030731">.</span><span class="ident" id="4030732">Algorithm</span><span class="op" id="4030741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030744">if</span>&nbsp;<span class="ident" id="4030747"><a href="/crypto/x509/x509.go.html#4030681">algo</a></span>&nbsp;<span class="op" id="4030752">==</span>&nbsp;<span class="ident" id="4030755"><a href="/crypto/x509/x509.go.html#4034052">UnknownPublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4030781">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030785">return</span>&nbsp;<span class="ident" id="4030792">nil</span><span class="op" id="4030795">,</span>&nbsp;<span class="ident" id="4030797"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4030803">.</span><span class="ident" id="4030804">New</span><span class="op" id="4030807">(</span><span class="string" id="4030808">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4030844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030850">return</span>&nbsp;<span class="ident" id="4030857"><a href="/crypto/x509/x509.go.html#4053763">parsePublicKey</a></span><span class="op" id="4030871">(</span><span class="ident" id="4030872"><a href="/crypto/x509/x509.go.html#4030681">algo</a></span><span class="op" id="4030876">,</span>&nbsp;<span class="op" id="4030878">&amp;</span><span class="ident" id="4030879"><a href="/crypto/x509/x509.go.html#4030592">pki</a></span><span class="op" id="4030882">)</span><br>
<span class="lineno"></span><span class="op" id="4030884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4030887">func</span>&nbsp;<span class="ident" id="4030892">marshalPublicKey</span><span class="op" id="4030908">(</span><span class="ident" id="4030909">pub</span>&nbsp;<span class="keyword" id="4030913">interface</span><span class="op" id="4030922">{</span><span class="op" id="4030923">}</span><span class="op" id="4030924">)</span>&nbsp;<span class="op" id="4030926">(</span><span class="ident" id="4030927">publicKeyBytes</span>&nbsp;<span class="op" id="4030942">[</span><span class="op" id="4030943">]</span><span class="builtintype" id="4030944">byte</span><span class="op" id="4030948">,</span>&nbsp;<span class="ident" id="4030950">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4030969"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4030973">.</span><span class="ident" id="4030974">AlgorithmIdentifier</span><span class="op" id="4030993">,</span>&nbsp;<span class="ident" id="4030995">err</span>&nbsp;<span class="builtintype" id="4030999">error</span><span class="op" id="4031004">)</span>&nbsp;<span class="op" id="4031006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031009">switch</span>&nbsp;<span class="ident" id="4031016">pub</span>&nbsp;<span class="op" id="4031020">:=</span>&nbsp;<span class="ident" id="4031023"><a href="/crypto/x509/x509.go.html#4030909">pub</a></span><span class="op" id="4031026">.</span><span class="op" id="4031027">(</span><span class="keyword" id="4031028">type</span><span class="op" id="4031032">)</span>&nbsp;<span class="op" id="4031034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031037">case</span>&nbsp;<span class="op" id="4031042">*</span><span class="ident" id="4031043"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4031046">.</span><span class="ident" id="4031047">PublicKey</span><span class="op" id="4031056">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031060"><a href="/crypto/x509/x509.go.html#4030927">publicKeyBytes</a></span><span class="op" id="4031074">,</span>&nbsp;<span class="ident" id="4031076"><a href="/crypto/x509/x509.go.html#4030995">err</a></span>&nbsp;<span class="op" id="4031080">=</span>&nbsp;<span class="ident" id="4031082"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4031086">.</span><span class="ident" id="4031087">Marshal</span><span class="op" id="4031094">(</span><span class="ident" id="4031095"><a href="/crypto/x509/pkcs1.go.html#4009635">rsaPublicKey</a></span><span class="op" id="4031107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031112">N</span><span class="op" id="4031113">:</span>&nbsp;<span class="ident" id="4031115"><a href="/crypto/x509/x509.go.html#4031016">pub</a></span><span class="op" id="4031118">.</span><span class="ident" id="4031119">N</span><span class="op" id="4031120">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031125">E</span><span class="op" id="4031126">:</span>&nbsp;<span class="ident" id="4031128"><a href="/crypto/x509/x509.go.html#4031016">pub</a></span><span class="op" id="4031131">.</span><span class="ident" id="4031132">E</span><span class="op" id="4031133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031137">}</span><span class="op" id="4031138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031142"><a href="/crypto/x509/x509.go.html#4030950">publicKeyAlgorithm</a></span><span class="op" id="4031160">.</span><span class="ident" id="4031161">Algorithm</span>&nbsp;<span class="op" id="4031171">=</span>&nbsp;<span class="ident" id="4031173"><a href="/crypto/x509/x509.go.html#4038357">oidPublicKeyRSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031191">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031249">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031307">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031358"><a href="/crypto/x509/x509.go.html#4030950">publicKeyAlgorithm</a></span><span class="op" id="4031376">.</span><span class="ident" id="4031377">Parameters</span>&nbsp;<span class="op" id="4031388">=</span>&nbsp;<span class="ident" id="4031390"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4031394">.</span><span class="ident" id="4031395">RawValue</span><span class="op" id="4031403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031408">Tag</span><span class="op" id="4031411">:</span>&nbsp;<span class="num" id="4031413">5</span><span class="op" id="4031414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031421">case</span>&nbsp;<span class="op" id="4031426">*</span><span class="ident" id="4031427"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4031432">.</span><span class="ident" id="4031433">PublicKey</span><span class="op" id="4031442">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031446"><a href="/crypto/x509/x509.go.html#4030927">publicKeyBytes</a></span>&nbsp;<span class="op" id="4031461">=</span>&nbsp;<span class="ident" id="4031463"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4031471">.</span><span class="ident" id="4031472">Marshal</span><span class="op" id="4031479">(</span><span class="ident" id="4031480"><a href="/crypto/x509/x509.go.html#4031016">pub</a></span><span class="op" id="4031483">.</span><span class="ident" id="4031484">Curve</span><span class="op" id="4031489">,</span>&nbsp;<span class="ident" id="4031491"><a href="/crypto/x509/x509.go.html#4031016">pub</a></span><span class="op" id="4031494">.</span><span class="ident" id="4031495">X</span><span class="op" id="4031496">,</span>&nbsp;<span class="ident" id="4031498"><a href="/crypto/x509/x509.go.html#4031016">pub</a></span><span class="op" id="4031501">.</span><span class="ident" id="4031502">Y</span><span class="op" id="4031503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031507">oid</span><span class="op" id="4031510">,</span>&nbsp;<span class="ident" id="4031512">ok</span>&nbsp;<span class="op" id="4031515">:=</span>&nbsp;<span class="ident" id="4031518"><a href="/crypto/x509/x509.go.html#4039971">oidFromNamedCurve</a></span><span class="op" id="4031535">(</span><span class="ident" id="4031536"><a href="/crypto/x509/x509.go.html#4031016">pub</a></span><span class="op" id="4031539">.</span><span class="ident" id="4031540">Curve</span><span class="op" id="4031545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031549">if</span>&nbsp;<span class="op" id="4031552">!</span><span class="ident" id="4031553"><a href="/crypto/x509/x509.go.html#4031512">ok</a></span>&nbsp;<span class="op" id="4031556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031561">return</span>&nbsp;<span class="ident" id="4031568">nil</span><span class="op" id="4031571">,</span>&nbsp;<span class="ident" id="4031573"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4031577">.</span><span class="ident" id="4031578">AlgorithmIdentifier</span><span class="op" id="4031597">{</span><span class="op" id="4031598">}</span><span class="op" id="4031599">,</span>&nbsp;<span class="ident" id="4031601"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4031607">.</span><span class="ident" id="4031608">New</span><span class="op" id="4031611">(</span><span class="string" id="4031612">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4031646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031650">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031654"><a href="/crypto/x509/x509.go.html#4030950">publicKeyAlgorithm</a></span><span class="op" id="4031672">.</span><span class="ident" id="4031673">Algorithm</span>&nbsp;<span class="op" id="4031683">=</span>&nbsp;<span class="ident" id="4031685"><a href="/crypto/x509/x509.go.html#4038495">oidPublicKeyECDSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031705">var</span>&nbsp;<span class="ident" id="4031709">paramBytes</span>&nbsp;<span class="op" id="4031720">[</span><span class="op" id="4031721">]</span><span class="builtintype" id="4031722">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031729"><a href="/crypto/x509/x509.go.html#4031709">paramBytes</a></span><span class="op" id="4031739">,</span>&nbsp;<span class="ident" id="4031741"><a href="/crypto/x509/x509.go.html#4030995">err</a></span>&nbsp;<span class="op" id="4031745">=</span>&nbsp;<span class="ident" id="4031747"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4031751">.</span><span class="ident" id="4031752">Marshal</span><span class="op" id="4031759">(</span><span class="ident" id="4031760"><a href="/crypto/x509/x509.go.html#4031507">oid</a></span><span class="op" id="4031763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031767">if</span>&nbsp;<span class="ident" id="4031770"><a href="/crypto/x509/x509.go.html#4030995">err</a></span>&nbsp;<span class="op" id="4031774">!=</span>&nbsp;<span class="ident" id="4031777">nil</span>&nbsp;<span class="op" id="4031781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031786">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031799"><a href="/crypto/x509/x509.go.html#4030950">publicKeyAlgorithm</a></span><span class="op" id="4031817">.</span><span class="ident" id="4031818">Parameters</span><span class="op" id="4031828">.</span><span class="ident" id="4031829">FullBytes</span>&nbsp;<span class="op" id="4031839">=</span>&nbsp;<span class="ident" id="4031841"><a href="/crypto/x509/x509.go.html#4031709">paramBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031853">default</span><span class="op" id="4031860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031864">return</span>&nbsp;<span class="ident" id="4031871">nil</span><span class="op" id="4031874">,</span>&nbsp;<span class="ident" id="4031876"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4031880">.</span><span class="ident" id="4031881">AlgorithmIdentifier</span><span class="op" id="4031900">{</span><span class="op" id="4031901">}</span><span class="op" id="4031902">,</span>&nbsp;<span class="ident" id="4031904"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4031910">.</span><span class="ident" id="4031911">New</span><span class="op" id="4031914">(</span><span class="string" id="4031915">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4031963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031966">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031970">return</span>&nbsp;<span class="ident" id="4031977"><a href="/crypto/x509/x509.go.html#4030927">publicKeyBytes</a></span><span class="op" id="4031991">,</span>&nbsp;<span class="ident" id="4031993"><a href="/crypto/x509/x509.go.html#4030950">publicKeyAlgorithm</a></span><span class="op" id="4032011">,</span>&nbsp;<span class="ident" id="4032013">nil</span><br>
<span class="lineno"></span><span class="op" id="4032017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4032020">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4032096">func</span>&nbsp;<span class="ident" id="4032101">MarshalPKIXPublicKey</span><span class="op" id="4032121">(</span><span class="ident" id="4032122">pub</span>&nbsp;<span class="keyword" id="4032126">interface</span><span class="op" id="4032135">{</span><span class="op" id="4032136">}</span><span class="op" id="4032137">)</span>&nbsp;<span class="op" id="4032139">(</span><span class="op" id="4032140">[</span><span class="op" id="4032141">]</span><span class="builtintype" id="4032142">byte</span><span class="op" id="4032146">,</span>&nbsp;<span class="builtintype" id="4032148">error</span><span class="op" id="4032153">)</span>&nbsp;<span class="op" id="4032155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032158">var</span>&nbsp;<span class="ident" id="4032162">publicKeyBytes</span>&nbsp;<span class="op" id="4032177">[</span><span class="op" id="4032178">]</span><span class="builtintype" id="4032179">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032185">var</span>&nbsp;<span class="ident" id="4032189">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4032208"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4032212">.</span><span class="ident" id="4032213">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032234">var</span>&nbsp;<span class="ident" id="4032238">err</span>&nbsp;<span class="builtintype" id="4032242">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032250">if</span>&nbsp;<span class="ident" id="4032253"><a href="/crypto/x509/x509.go.html#4032162">publicKeyBytes</a></span><span class="op" id="4032267">,</span>&nbsp;<span class="ident" id="4032269"><a href="/crypto/x509/x509.go.html#4032189">publicKeyAlgorithm</a></span><span class="op" id="4032287">,</span>&nbsp;<span class="ident" id="4032289"><a href="/crypto/x509/x509.go.html#4032238">err</a></span>&nbsp;<span class="op" id="4032293">=</span>&nbsp;<span class="ident" id="4032295"><a href="/crypto/x509/x509.go.html#4030892">marshalPublicKey</a></span><span class="op" id="4032311">(</span><span class="ident" id="4032312"><a href="/crypto/x509/x509.go.html#4032122">pub</a></span><span class="op" id="4032315">)</span><span class="op" id="4032316">;</span>&nbsp;<span class="ident" id="4032318"><a href="/crypto/x509/x509.go.html#4032238">err</a></span>&nbsp;<span class="op" id="4032322">!=</span>&nbsp;<span class="ident" id="4032325">nil</span>&nbsp;<span class="op" id="4032329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032333">return</span>&nbsp;<span class="ident" id="4032340">nil</span><span class="op" id="4032343">,</span>&nbsp;<span class="ident" id="4032345"><a href="/crypto/x509/x509.go.html#4032238">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032354">pkix</span>&nbsp;<span class="op" id="4032359">:=</span>&nbsp;<span class="ident" id="4032362"><a href="/crypto/x509/x509.go.html#4030297">pkixPublicKey</a></span><span class="op" id="4032375">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032379">Algo</span><span class="op" id="4032383">:</span>&nbsp;<span class="ident" id="4032385"><a href="/crypto/x509/x509.go.html#4032189">publicKeyAlgorithm</a></span><span class="op" id="4032403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032407">BitString</span><span class="op" id="4032416">:</span>&nbsp;<span class="ident" id="4032418"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4032422">.</span><span class="ident" id="4032423">BitString</span><span class="op" id="4032432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032437">Bytes</span><span class="op" id="4032442">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4032448"><a href="/crypto/x509/x509.go.html#4032162">publicKeyBytes</a></span><span class="op" id="4032462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032467">BitLength</span><span class="op" id="4032476">:</span>&nbsp;<span class="num" id="4032478">8</span>&nbsp;<span class="op" id="4032480">*</span>&nbsp;<span class="builtinfunc" id="4032482">len</span><span class="op" id="4032485">(</span><span class="ident" id="4032486"><a href="/crypto/x509/x509.go.html#4032162">publicKeyBytes</a></span><span class="op" id="4032500">)</span><span class="op" id="4032501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032505">}</span><span class="op" id="4032506">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032513">ret</span><span class="op" id="4032516">,</span>&nbsp;<span class="ident" id="4032518">_</span>&nbsp;<span class="op" id="4032520">:=</span>&nbsp;<span class="ident" id="4032523"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4032527">.</span><span class="ident" id="4032528">Marshal</span><span class="op" id="4032535">(</span><span class="ident" id="4032536"><a href="/crypto/x509/x509.go.html#4032354">pkix</a></span><span class="op" id="4032540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032543">return</span>&nbsp;<span class="ident" id="4032550"><a href="/crypto/x509/x509.go.html#4032513">ret</a></span><span class="op" id="4032553">,</span>&nbsp;<span class="ident" id="4032555">nil</span><br>
<span class="lineno"></span><span class="op" id="4032559">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4032562">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4032635">type</span>&nbsp;<span class="ident" id="4032640">certificate</span>&nbsp;<span class="keyword" id="4032652">struct</span>&nbsp;<span class="op" id="4032659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032662">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4032681"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4032685">.</span><span class="ident" id="4032686">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032698">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4032717"><a href="/crypto/x509/x509.go.html#4032820">tbsCertificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032733">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4032752"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4032756">.</span><span class="ident" id="4032757">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032778">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4032797"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4032801">.</span><span class="ident" id="4032802">BitString</span><br>
<span class="lineno"></span><span class="op" id="4032812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4032815">type</span>&nbsp;<span class="ident" id="4032820">tbsCertificate</span>&nbsp;<span class="keyword" id="4032835">struct</span>&nbsp;<span class="op" id="4032842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032845">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4032864"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4032868">.</span><span class="ident" id="4032869">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032881">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4032900">int</span>&nbsp;<span class="string" id="4032904">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032948">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4032967">*</span><span class="ident" id="4032968"><a href="/crypto/x509/x509.go.html#4030156">big</a></span><span class="op" id="4032971">.</span><span class="ident" id="4032972">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032977">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4032996"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4033000">.</span><span class="ident" id="4033001">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033022">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4033041"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4033045">.</span><span class="ident" id="4033046">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033056">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4033075"><a href="/crypto/x509/x509.go.html#4033489">validity</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033085">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4033104"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4033108">.</span><span class="ident" id="4033109">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033119">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4033138"><a href="/crypto/x509/x509.go.html#4033546">publicKeyInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033153">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4033172"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4033176">.</span><span class="ident" id="4033177">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4033189">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033214">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4033233"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4033237">.</span><span class="ident" id="4033238">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4033250">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033275">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4033294">[</span><span class="op" id="4033295">]</span><span class="ident" id="4033296"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4033300">.</span><span class="ident" id="4033301">Extension</span>&nbsp;<span class="string" id="4033311">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4033344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4033347">type</span>&nbsp;<span class="ident" id="4033352">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4033375">struct</span>&nbsp;<span class="op" id="4033382">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033385">P</span><span class="op" id="4033386">,</span>&nbsp;<span class="ident" id="4033388">Q</span><span class="op" id="4033389">,</span>&nbsp;<span class="ident" id="4033391">G</span>&nbsp;<span class="op" id="4033393">*</span><span class="ident" id="4033394"><a href="/crypto/x509/x509.go.html#4030156">big</a></span><span class="op" id="4033397">.</span><span class="ident" id="4033398">Int</span><br>
<span class="lineno"></span><span class="op" id="4033402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4033405">type</span>&nbsp;<span class="ident" id="4033410">dsaSignature</span>&nbsp;<span class="keyword" id="4033423">struct</span>&nbsp;<span class="op" id="4033430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033433">R</span><span class="op" id="4033434">,</span>&nbsp;<span class="ident" id="4033436">S</span>&nbsp;<span class="op" id="4033438">*</span><span class="ident" id="4033439"><a href="/crypto/x509/x509.go.html#4030156">big</a></span><span class="op" id="4033442">.</span><span class="ident" id="4033443">Int</span><br>
<span class="lineno">135</span><span class="op" id="4033447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4033450">type</span>&nbsp;<span class="ident" id="4033455">ecdsaSignature</span>&nbsp;<span class="ident" id="4033470"><a href="/crypto/x509/x509.go.html#4033410">dsaSignature</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4033484">type</span>&nbsp;<span class="ident" id="4033489">validity</span>&nbsp;<span class="keyword" id="4033498">struct</span>&nbsp;<span class="op" id="4033505">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033508">NotBefore</span><span class="op" id="4033517">,</span>&nbsp;<span class="ident" id="4033519">NotAfter</span>&nbsp;<span class="ident" id="4033528"><a href="/crypto/x509/x509.go.html#4030186">time</a></span><span class="op" id="4033532">.</span><span class="ident" id="4033533">Time</span><br>
<span class="lineno"></span><span class="op" id="4033538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4033541">type</span>&nbsp;<span class="ident" id="4033546">publicKeyInfo</span>&nbsp;<span class="keyword" id="4033560">struct</span>&nbsp;<span class="op" id="4033567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033570">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4033580"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4033584">.</span><span class="ident" id="4033585">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033597">Algorithm</span>&nbsp;<span class="ident" id="4033607"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4033611">.</span><span class="ident" id="4033612">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033633">PublicKey</span>&nbsp;<span class="ident" id="4033643"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4033647">.</span><span class="ident" id="4033648">BitString</span><br>
<span class="lineno"></span><span class="op" id="4033658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4033661">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4033683">type</span>&nbsp;<span class="ident" id="4033688">authKeyId</span>&nbsp;<span class="keyword" id="4033698">struct</span>&nbsp;<span class="op" id="4033705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033708">Id</span>&nbsp;<span class="op" id="4033711">[</span><span class="op" id="4033712">]</span><span class="builtintype" id="4033713">byte</span>&nbsp;<span class="string" id="4033718">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4033742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4033745">type</span>&nbsp;<span class="ident" id="4033750">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4033769">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4033774">const</span>&nbsp;<span class="op" id="4033780">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033783">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4033809"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="4033828">=</span>&nbsp;<span class="ident" id="4033830">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033836">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033848">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033860">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033873">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033888">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033903">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033918">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033931">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033946">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033961">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033978">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033995">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4034011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4034014">type</span>&nbsp;<span class="ident" id="4034019">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4034038">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4034043">const</span>&nbsp;<span class="op" id="4034049">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034052">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4034078"><a href="/crypto/x509/x509.go.html#4034019">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4034097">=</span>&nbsp;<span class="ident" id="4034099">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034105">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034110">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034115">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4034121">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4034124">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4034157">//</span><br>
<span class="lineno"></span><span class="comment" id="4034160">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4034194">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4034257">//</span><br>
<span class="lineno"></span><span class="comment" id="4034260">//</span><br>
<span class="lineno"></span><span class="comment" id="4034263">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4034306">//</span><br>
<span class="lineno"></span><span class="comment" id="4034309">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4034368">//</span><br>
<span class="lineno"></span><span class="comment" id="4034371">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4034430">//</span><br>
<span class="lineno"></span><span class="comment" id="4034433">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4034494">//</span><br>
<span class="lineno">195</span><span class="comment" id="4034497">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4034536">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4034597">//</span><br>
<span class="lineno"></span><span class="comment" id="4034600">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4034644">//</span><br>
<span class="lineno">200</span><span class="comment" id="4034647">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4034690">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4034743">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4034783">//</span><br>
<span class="lineno"></span><span class="comment" id="4034786">//</span><br>
<span class="lineno">205</span><span class="comment" id="4034789">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4034823">//</span><br>
<span class="lineno"></span><span class="comment" id="4034826">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4034889">//</span><br>
<span class="lineno"></span><span class="comment" id="4034892">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4034955">//</span><br>
<span class="lineno"></span><span class="comment" id="4034958">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4035021">//</span><br>
<span class="lineno"></span><span class="comment" id="4035024">//</span><br>
<span class="lineno"></span><span class="comment" id="4035027">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4035068">//</span><br>
<span class="lineno"></span><span class="comment" id="4035071">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4035112">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4035182">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4035233">//</span><br>
<span class="lineno">220</span><span class="comment" id="4035236">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4035278">//</span><br>
<span class="lineno"></span><span class="comment" id="4035281">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4035348">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4035417">//</span><br>
<span class="lineno">225</span><span class="comment" id="4035420">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4035487">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4035556">//</span><br>
<span class="lineno"></span><span class="comment" id="4035559">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4035626">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4035696">var</span>&nbsp;<span class="op" id="4035700">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035703">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4035731">=</span>&nbsp;<span class="ident" id="4035733"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4035737">.</span><span class="ident" id="4035738">ObjectIdentifier</span><span class="op" id="4035754">{</span><span class="num" id="4035755">1</span><span class="op" id="4035756">,</span>&nbsp;<span class="num" id="4035758">2</span><span class="op" id="4035759">,</span>&nbsp;<span class="num" id="4035761">840</span><span class="op" id="4035764">,</span>&nbsp;<span class="num" id="4035766">113549</span><span class="op" id="4035772">,</span>&nbsp;<span class="num" id="4035774">1</span><span class="op" id="4035775">,</span>&nbsp;<span class="num" id="4035777">1</span><span class="op" id="4035778">,</span>&nbsp;<span class="num" id="4035780">2</span><span class="op" id="4035781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035784">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4035812">=</span>&nbsp;<span class="ident" id="4035814"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4035818">.</span><span class="ident" id="4035819">ObjectIdentifier</span><span class="op" id="4035835">{</span><span class="num" id="4035836">1</span><span class="op" id="4035837">,</span>&nbsp;<span class="num" id="4035839">2</span><span class="op" id="4035840">,</span>&nbsp;<span class="num" id="4035842">840</span><span class="op" id="4035845">,</span>&nbsp;<span class="num" id="4035847">113549</span><span class="op" id="4035853">,</span>&nbsp;<span class="num" id="4035855">1</span><span class="op" id="4035856">,</span>&nbsp;<span class="num" id="4035858">1</span><span class="op" id="4035859">,</span>&nbsp;<span class="num" id="4035861">4</span><span class="op" id="4035862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035865">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4035893">=</span>&nbsp;<span class="ident" id="4035895"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4035899">.</span><span class="ident" id="4035900">ObjectIdentifier</span><span class="op" id="4035916">{</span><span class="num" id="4035917">1</span><span class="op" id="4035918">,</span>&nbsp;<span class="num" id="4035920">2</span><span class="op" id="4035921">,</span>&nbsp;<span class="num" id="4035923">840</span><span class="op" id="4035926">,</span>&nbsp;<span class="num" id="4035928">113549</span><span class="op" id="4035934">,</span>&nbsp;<span class="num" id="4035936">1</span><span class="op" id="4035937">,</span>&nbsp;<span class="num" id="4035939">1</span><span class="op" id="4035940">,</span>&nbsp;<span class="num" id="4035942">5</span><span class="op" id="4035943">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035946">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4035974">=</span>&nbsp;<span class="ident" id="4035976"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4035980">.</span><span class="ident" id="4035981">ObjectIdentifier</span><span class="op" id="4035997">{</span><span class="num" id="4035998">1</span><span class="op" id="4035999">,</span>&nbsp;<span class="num" id="4036001">2</span><span class="op" id="4036002">,</span>&nbsp;<span class="num" id="4036004">840</span><span class="op" id="4036007">,</span>&nbsp;<span class="num" id="4036009">113549</span><span class="op" id="4036015">,</span>&nbsp;<span class="num" id="4036017">1</span><span class="op" id="4036018">,</span>&nbsp;<span class="num" id="4036020">1</span><span class="op" id="4036021">,</span>&nbsp;<span class="num" id="4036023">11</span><span class="op" id="4036025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036028">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4036056">=</span>&nbsp;<span class="ident" id="4036058"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036062">.</span><span class="ident" id="4036063">ObjectIdentifier</span><span class="op" id="4036079">{</span><span class="num" id="4036080">1</span><span class="op" id="4036081">,</span>&nbsp;<span class="num" id="4036083">2</span><span class="op" id="4036084">,</span>&nbsp;<span class="num" id="4036086">840</span><span class="op" id="4036089">,</span>&nbsp;<span class="num" id="4036091">113549</span><span class="op" id="4036097">,</span>&nbsp;<span class="num" id="4036099">1</span><span class="op" id="4036100">,</span>&nbsp;<span class="num" id="4036102">1</span><span class="op" id="4036103">,</span>&nbsp;<span class="num" id="4036105">12</span><span class="op" id="4036107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036110">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4036138">=</span>&nbsp;<span class="ident" id="4036140"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036144">.</span><span class="ident" id="4036145">ObjectIdentifier</span><span class="op" id="4036161">{</span><span class="num" id="4036162">1</span><span class="op" id="4036163">,</span>&nbsp;<span class="num" id="4036165">2</span><span class="op" id="4036166">,</span>&nbsp;<span class="num" id="4036168">840</span><span class="op" id="4036171">,</span>&nbsp;<span class="num" id="4036173">113549</span><span class="op" id="4036179">,</span>&nbsp;<span class="num" id="4036181">1</span><span class="op" id="4036182">,</span>&nbsp;<span class="num" id="4036184">1</span><span class="op" id="4036185">,</span>&nbsp;<span class="num" id="4036187">13</span><span class="op" id="4036189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036192">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4036220">=</span>&nbsp;<span class="ident" id="4036222"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036226">.</span><span class="ident" id="4036227">ObjectIdentifier</span><span class="op" id="4036243">{</span><span class="num" id="4036244">1</span><span class="op" id="4036245">,</span>&nbsp;<span class="num" id="4036247">2</span><span class="op" id="4036248">,</span>&nbsp;<span class="num" id="4036250">840</span><span class="op" id="4036253">,</span>&nbsp;<span class="num" id="4036255">10040</span><span class="op" id="4036260">,</span>&nbsp;<span class="num" id="4036262">4</span><span class="op" id="4036263">,</span>&nbsp;<span class="num" id="4036265">3</span><span class="op" id="4036266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036269">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4036297">=</span>&nbsp;<span class="ident" id="4036299"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036303">.</span><span class="ident" id="4036304">ObjectIdentifier</span><span class="op" id="4036320">{</span><span class="num" id="4036321">2</span><span class="op" id="4036322">,</span>&nbsp;<span class="num" id="4036324">16</span><span class="op" id="4036326">,</span>&nbsp;<span class="num" id="4036328">840</span><span class="op" id="4036331">,</span>&nbsp;<span class="num" id="4036333">1</span><span class="op" id="4036334">,</span>&nbsp;<span class="num" id="4036336">101</span><span class="op" id="4036339">,</span>&nbsp;<span class="num" id="4036341">4</span><span class="op" id="4036342">,</span>&nbsp;<span class="num" id="4036344">3</span><span class="op" id="4036345">,</span>&nbsp;<span class="num" id="4036347">2</span><span class="op" id="4036348">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036351">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4036379">=</span>&nbsp;<span class="ident" id="4036381"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036385">.</span><span class="ident" id="4036386">ObjectIdentifier</span><span class="op" id="4036402">{</span><span class="num" id="4036403">1</span><span class="op" id="4036404">,</span>&nbsp;<span class="num" id="4036406">2</span><span class="op" id="4036407">,</span>&nbsp;<span class="num" id="4036409">840</span><span class="op" id="4036412">,</span>&nbsp;<span class="num" id="4036414">10045</span><span class="op" id="4036419">,</span>&nbsp;<span class="num" id="4036421">4</span><span class="op" id="4036422">,</span>&nbsp;<span class="num" id="4036424">1</span><span class="op" id="4036425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036428">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4036456">=</span>&nbsp;<span class="ident" id="4036458"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036462">.</span><span class="ident" id="4036463">ObjectIdentifier</span><span class="op" id="4036479">{</span><span class="num" id="4036480">1</span><span class="op" id="4036481">,</span>&nbsp;<span class="num" id="4036483">2</span><span class="op" id="4036484">,</span>&nbsp;<span class="num" id="4036486">840</span><span class="op" id="4036489">,</span>&nbsp;<span class="num" id="4036491">10045</span><span class="op" id="4036496">,</span>&nbsp;<span class="num" id="4036498">4</span><span class="op" id="4036499">,</span>&nbsp;<span class="num" id="4036501">3</span><span class="op" id="4036502">,</span>&nbsp;<span class="num" id="4036504">2</span><span class="op" id="4036505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036508">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4036536">=</span>&nbsp;<span class="ident" id="4036538"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036542">.</span><span class="ident" id="4036543">ObjectIdentifier</span><span class="op" id="4036559">{</span><span class="num" id="4036560">1</span><span class="op" id="4036561">,</span>&nbsp;<span class="num" id="4036563">2</span><span class="op" id="4036564">,</span>&nbsp;<span class="num" id="4036566">840</span><span class="op" id="4036569">,</span>&nbsp;<span class="num" id="4036571">10045</span><span class="op" id="4036576">,</span>&nbsp;<span class="num" id="4036578">4</span><span class="op" id="4036579">,</span>&nbsp;<span class="num" id="4036581">3</span><span class="op" id="4036582">,</span>&nbsp;<span class="num" id="4036584">3</span><span class="op" id="4036585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036588">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4036616">=</span>&nbsp;<span class="ident" id="4036618"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036622">.</span><span class="ident" id="4036623">ObjectIdentifier</span><span class="op" id="4036639">{</span><span class="num" id="4036640">1</span><span class="op" id="4036641">,</span>&nbsp;<span class="num" id="4036643">2</span><span class="op" id="4036644">,</span>&nbsp;<span class="num" id="4036646">840</span><span class="op" id="4036649">,</span>&nbsp;<span class="num" id="4036651">10045</span><span class="op" id="4036656">,</span>&nbsp;<span class="num" id="4036658">4</span><span class="op" id="4036659">,</span>&nbsp;<span class="num" id="4036661">3</span><span class="op" id="4036662">,</span>&nbsp;<span class="num" id="4036664">4</span><span class="op" id="4036665">}</span><br>
<span class="lineno"></span><span class="op" id="4036667">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4036670">var</span>&nbsp;<span class="ident" id="4036674">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4036700">=</span>&nbsp;<span class="op" id="4036702">[</span><span class="op" id="4036703">]</span><span class="keyword" id="4036704">struct</span>&nbsp;<span class="op" id="4036711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036714">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4036725"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036745">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4036756"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4036760">.</span><span class="ident" id="4036761">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036779">pubKeyAlgo</span>&nbsp;<span class="ident" id="4036790"><a href="/crypto/x509/x509.go.html#4034019">PublicKeyAlgorithm</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036810">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4036821"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4036827">.</span><span class="ident" id="4036828">Hash</span><br>
<span class="lineno"></span><span class="op" id="4036833">}</span><span class="op" id="4036834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4036837">{</span><span class="ident" id="4036838"><a href="/crypto/x509/x509.go.html#4033836">MD2WithRSA</a></span><span class="op" id="4036848">,</span>&nbsp;<span class="ident" id="4036850"><a href="/crypto/x509/x509.go.html#4035703">oidSignatureMD2WithRSA</a></span><span class="op" id="4036872">,</span>&nbsp;<span class="ident" id="4036874"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><span class="op" id="4036877">,</span>&nbsp;<span class="ident" id="4036879"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4036885">.</span><span class="ident" id="4036886">Hash</span><span class="op" id="4036890">(</span><span class="num" id="4036891">0</span><span class="op" id="4036892">)</span>&nbsp;<span class="comment" id="4036894">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4036916">}</span><span class="op" id="4036917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4036920">{</span><span class="ident" id="4036921"><a href="/crypto/x509/x509.go.html#4033848">MD5WithRSA</a></span><span class="op" id="4036931">,</span>&nbsp;<span class="ident" id="4036933"><a href="/crypto/x509/x509.go.html#4035784">oidSignatureMD5WithRSA</a></span><span class="op" id="4036955">,</span>&nbsp;<span class="ident" id="4036957"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><span class="op" id="4036960">,</span>&nbsp;<span class="ident" id="4036962"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4036968">.</span><span class="ident" id="4036969">MD5</span><span class="op" id="4036972">}</span><span class="op" id="4036973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4036976">{</span><span class="ident" id="4036977"><a href="/crypto/x509/x509.go.html#4033860">SHA1WithRSA</a></span><span class="op" id="4036988">,</span>&nbsp;<span class="ident" id="4036990"><a href="/crypto/x509/x509.go.html#4035865">oidSignatureSHA1WithRSA</a></span><span class="op" id="4037013">,</span>&nbsp;<span class="ident" id="4037015"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><span class="op" id="4037018">,</span>&nbsp;<span class="ident" id="4037020"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037026">.</span><span class="ident" id="4037027">SHA1</span><span class="op" id="4037031">}</span><span class="op" id="4037032">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037035">{</span><span class="ident" id="4037036"><a href="/crypto/x509/x509.go.html#4033873">SHA256WithRSA</a></span><span class="op" id="4037049">,</span>&nbsp;<span class="ident" id="4037051"><a href="/crypto/x509/x509.go.html#4035946">oidSignatureSHA256WithRSA</a></span><span class="op" id="4037076">,</span>&nbsp;<span class="ident" id="4037078"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><span class="op" id="4037081">,</span>&nbsp;<span class="ident" id="4037083"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037089">.</span><span class="ident" id="4037090">SHA256</span><span class="op" id="4037096">}</span><span class="op" id="4037097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037100">{</span><span class="ident" id="4037101"><a href="/crypto/x509/x509.go.html#4033888">SHA384WithRSA</a></span><span class="op" id="4037114">,</span>&nbsp;<span class="ident" id="4037116"><a href="/crypto/x509/x509.go.html#4036028">oidSignatureSHA384WithRSA</a></span><span class="op" id="4037141">,</span>&nbsp;<span class="ident" id="4037143"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><span class="op" id="4037146">,</span>&nbsp;<span class="ident" id="4037148"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037154">.</span><span class="ident" id="4037155">SHA384</span><span class="op" id="4037161">}</span><span class="op" id="4037162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037165">{</span><span class="ident" id="4037166"><a href="/crypto/x509/x509.go.html#4033903">SHA512WithRSA</a></span><span class="op" id="4037179">,</span>&nbsp;<span class="ident" id="4037181"><a href="/crypto/x509/x509.go.html#4036110">oidSignatureSHA512WithRSA</a></span><span class="op" id="4037206">,</span>&nbsp;<span class="ident" id="4037208"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><span class="op" id="4037211">,</span>&nbsp;<span class="ident" id="4037213"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037219">.</span><span class="ident" id="4037220">SHA512</span><span class="op" id="4037226">}</span><span class="op" id="4037227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037230">{</span><span class="ident" id="4037231"><a href="/crypto/x509/x509.go.html#4033918">DSAWithSHA1</a></span><span class="op" id="4037242">,</span>&nbsp;<span class="ident" id="4037244"><a href="/crypto/x509/x509.go.html#4036192">oidSignatureDSAWithSHA1</a></span><span class="op" id="4037267">,</span>&nbsp;<span class="ident" id="4037269"><a href="/crypto/x509/x509.go.html#4034110">DSA</a></span><span class="op" id="4037272">,</span>&nbsp;<span class="ident" id="4037274"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037280">.</span><span class="ident" id="4037281">SHA1</span><span class="op" id="4037285">}</span><span class="op" id="4037286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037289">{</span><span class="ident" id="4037290"><a href="/crypto/x509/x509.go.html#4033931">DSAWithSHA256</a></span><span class="op" id="4037303">,</span>&nbsp;<span class="ident" id="4037305"><a href="/crypto/x509/x509.go.html#4036269">oidSignatureDSAWithSHA256</a></span><span class="op" id="4037330">,</span>&nbsp;<span class="ident" id="4037332"><a href="/crypto/x509/x509.go.html#4034110">DSA</a></span><span class="op" id="4037335">,</span>&nbsp;<span class="ident" id="4037337"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037343">.</span><span class="ident" id="4037344">SHA256</span><span class="op" id="4037350">}</span><span class="op" id="4037351">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037354">{</span><span class="ident" id="4037355"><a href="/crypto/x509/x509.go.html#4033946">ECDSAWithSHA1</a></span><span class="op" id="4037368">,</span>&nbsp;<span class="ident" id="4037370"><a href="/crypto/x509/x509.go.html#4036351">oidSignatureECDSAWithSHA1</a></span><span class="op" id="4037395">,</span>&nbsp;<span class="ident" id="4037397"><a href="/crypto/x509/x509.go.html#4034115">ECDSA</a></span><span class="op" id="4037402">,</span>&nbsp;<span class="ident" id="4037404"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037410">.</span><span class="ident" id="4037411">SHA1</span><span class="op" id="4037415">}</span><span class="op" id="4037416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037419">{</span><span class="ident" id="4037420"><a href="/crypto/x509/x509.go.html#4033961">ECDSAWithSHA256</a></span><span class="op" id="4037435">,</span>&nbsp;<span class="ident" id="4037437"><a href="/crypto/x509/x509.go.html#4036428">oidSignatureECDSAWithSHA256</a></span><span class="op" id="4037464">,</span>&nbsp;<span class="ident" id="4037466"><a href="/crypto/x509/x509.go.html#4034115">ECDSA</a></span><span class="op" id="4037471">,</span>&nbsp;<span class="ident" id="4037473"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037479">.</span><span class="ident" id="4037480">SHA256</span><span class="op" id="4037486">}</span><span class="op" id="4037487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037490">{</span><span class="ident" id="4037491"><a href="/crypto/x509/x509.go.html#4033978">ECDSAWithSHA384</a></span><span class="op" id="4037506">,</span>&nbsp;<span class="ident" id="4037508"><a href="/crypto/x509/x509.go.html#4036508">oidSignatureECDSAWithSHA384</a></span><span class="op" id="4037535">,</span>&nbsp;<span class="ident" id="4037537"><a href="/crypto/x509/x509.go.html#4034115">ECDSA</a></span><span class="op" id="4037542">,</span>&nbsp;<span class="ident" id="4037544"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037550">.</span><span class="ident" id="4037551">SHA384</span><span class="op" id="4037557">}</span><span class="op" id="4037558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037561">{</span><span class="ident" id="4037562"><a href="/crypto/x509/x509.go.html#4033995">ECDSAWithSHA512</a></span><span class="op" id="4037577">,</span>&nbsp;<span class="ident" id="4037579"><a href="/crypto/x509/x509.go.html#4036588">oidSignatureECDSAWithSHA512</a></span><span class="op" id="4037606">,</span>&nbsp;<span class="ident" id="4037608"><a href="/crypto/x509/x509.go.html#4034115">ECDSA</a></span><span class="op" id="4037613">,</span>&nbsp;<span class="ident" id="4037615"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4037621">.</span><span class="ident" id="4037622">SHA512</span><span class="op" id="4037628">}</span><span class="op" id="4037629">,</span><br>
<span class="lineno"></span><span class="op" id="4037631">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4037634">func</span>&nbsp;<span class="ident" id="4037639">getSignatureAlgorithmFromOID</span><span class="op" id="4037667">(</span><span class="ident" id="4037668">oid</span>&nbsp;<span class="ident" id="4037672"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4037676">.</span><span class="ident" id="4037677">ObjectIdentifier</span><span class="op" id="4037693">)</span>&nbsp;<span class="ident" id="4037695"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="4037714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037717">for</span>&nbsp;<span class="ident" id="4037721">_</span><span class="op" id="4037722">,</span>&nbsp;<span class="ident" id="4037724">details</span>&nbsp;<span class="op" id="4037732">:=</span>&nbsp;<span class="keyword" id="4037735">range</span>&nbsp;<span class="ident" id="4037741"><a href="/crypto/x509/x509.go.html#4036674">signatureAlgorithmDetails</a></span>&nbsp;<span class="op" id="4037767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037771">if</span>&nbsp;<span class="ident" id="4037774"><a href="/crypto/x509/x509.go.html#4037668">oid</a></span><span class="op" id="4037777">.</span><span class="ident" id="4037778">Equal</span><span class="op" id="4037783">(</span><span class="ident" id="4037784"><a href="/crypto/x509/x509.go.html#4037724">details</a></span><span class="op" id="4037791">.</span><span class="ident" id="4037792">oid</span><span class="op" id="4037795">)</span>&nbsp;<span class="op" id="4037797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037802">return</span>&nbsp;<span class="ident" id="4037809"><a href="/crypto/x509/x509.go.html#4037724">details</a></span><span class="op" id="4037816">.</span><span class="ident" id="4037817">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037830">return</span>&nbsp;<span class="ident" id="4037837"><a href="/crypto/x509/x509.go.html#4033783">UnknownSignatureAlgorithm</a></span><br>
<span class="lineno"></span><span class="op" id="4037863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4037866">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4037905">//</span><br>
<span class="lineno"></span><span class="comment" id="4037908">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4037973">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4038006">//</span><br>
<span class="lineno">280</span><span class="comment" id="4038009">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4038063">//</span><br>
<span class="lineno"></span><span class="comment" id="4038066">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4038131">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4038162">//</span><br>
<span class="lineno">285</span><span class="comment" id="4038165">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4038233">//</span><br>
<span class="lineno"></span><span class="comment" id="4038236">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4038278">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4038350">var</span>&nbsp;<span class="op" id="4038354">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038357">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4038375">=</span>&nbsp;<span class="ident" id="4038377"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4038381">.</span><span class="ident" id="4038382">ObjectIdentifier</span><span class="op" id="4038398">{</span><span class="num" id="4038399">1</span><span class="op" id="4038400">,</span>&nbsp;<span class="num" id="4038402">2</span><span class="op" id="4038403">,</span>&nbsp;<span class="num" id="4038405">840</span><span class="op" id="4038408">,</span>&nbsp;<span class="num" id="4038410">113549</span><span class="op" id="4038416">,</span>&nbsp;<span class="num" id="4038418">1</span><span class="op" id="4038419">,</span>&nbsp;<span class="num" id="4038421">1</span><span class="op" id="4038422">,</span>&nbsp;<span class="num" id="4038424">1</span><span class="op" id="4038425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038428">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4038446">=</span>&nbsp;<span class="ident" id="4038448"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4038452">.</span><span class="ident" id="4038453">ObjectIdentifier</span><span class="op" id="4038469">{</span><span class="num" id="4038470">1</span><span class="op" id="4038471">,</span>&nbsp;<span class="num" id="4038473">2</span><span class="op" id="4038474">,</span>&nbsp;<span class="num" id="4038476">840</span><span class="op" id="4038479">,</span>&nbsp;<span class="num" id="4038481">10040</span><span class="op" id="4038486">,</span>&nbsp;<span class="num" id="4038488">4</span><span class="op" id="4038489">,</span>&nbsp;<span class="num" id="4038491">1</span><span class="op" id="4038492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038495">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4038513">=</span>&nbsp;<span class="ident" id="4038515"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4038519">.</span><span class="ident" id="4038520">ObjectIdentifier</span><span class="op" id="4038536">{</span><span class="num" id="4038537">1</span><span class="op" id="4038538">,</span>&nbsp;<span class="num" id="4038540">2</span><span class="op" id="4038541">,</span>&nbsp;<span class="num" id="4038543">840</span><span class="op" id="4038546">,</span>&nbsp;<span class="num" id="4038548">10045</span><span class="op" id="4038553">,</span>&nbsp;<span class="num" id="4038555">2</span><span class="op" id="4038556">,</span>&nbsp;<span class="num" id="4038558">1</span><span class="op" id="4038559">}</span><br>
<span class="lineno"></span><span class="op" id="4038561">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4038564">func</span>&nbsp;<span class="ident" id="4038569">getPublicKeyAlgorithmFromOID</span><span class="op" id="4038597">(</span><span class="ident" id="4038598">oid</span>&nbsp;<span class="ident" id="4038602"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4038606">.</span><span class="ident" id="4038607">ObjectIdentifier</span><span class="op" id="4038623">)</span>&nbsp;<span class="ident" id="4038625"><a href="/crypto/x509/x509.go.html#4034019">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4038644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038647">switch</span>&nbsp;<span class="op" id="4038654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038657">case</span>&nbsp;<span class="ident" id="4038662"><a href="/crypto/x509/x509.go.html#4038598">oid</a></span><span class="op" id="4038665">.</span><span class="ident" id="4038666">Equal</span><span class="op" id="4038671">(</span><span class="ident" id="4038672"><a href="/crypto/x509/x509.go.html#4038357">oidPublicKeyRSA</a></span><span class="op" id="4038687">)</span><span class="op" id="4038688">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038692">return</span>&nbsp;<span class="ident" id="4038699"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038704">case</span>&nbsp;<span class="ident" id="4038709"><a href="/crypto/x509/x509.go.html#4038598">oid</a></span><span class="op" id="4038712">.</span><span class="ident" id="4038713">Equal</span><span class="op" id="4038718">(</span><span class="ident" id="4038719"><a href="/crypto/x509/x509.go.html#4038428">oidPublicKeyDSA</a></span><span class="op" id="4038734">)</span><span class="op" id="4038735">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038739">return</span>&nbsp;<span class="ident" id="4038746"><a href="/crypto/x509/x509.go.html#4034110">DSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038751">case</span>&nbsp;<span class="ident" id="4038756"><a href="/crypto/x509/x509.go.html#4038598">oid</a></span><span class="op" id="4038759">.</span><span class="ident" id="4038760">Equal</span><span class="op" id="4038765">(</span><span class="ident" id="4038766"><a href="/crypto/x509/x509.go.html#4038495">oidPublicKeyECDSA</a></span><span class="op" id="4038783">)</span><span class="op" id="4038784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038788">return</span>&nbsp;<span class="ident" id="4038795"><a href="/crypto/x509/x509.go.html#4034115">ECDSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038805">return</span>&nbsp;<span class="ident" id="4038812"><a href="/crypto/x509/x509.go.html#4034052">UnknownPublicKeyAlgorithm</a></span><br>
<span class="lineno">305</span><span class="op" id="4038838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4038841">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4038875">//</span><br>
<span class="lineno"></span><span class="comment" id="4038878">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4038915">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4038982">//</span><br>
<span class="lineno"></span><span class="comment" id="4038985">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4039022">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4039085">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4039103">//</span><br>
<span class="lineno"></span><span class="comment" id="4039106">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4039143">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4039210">//</span><br>
<span class="lineno"></span><span class="comment" id="4039213">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4039250">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4039317">//</span><br>
<span class="lineno"></span><span class="comment" id="4039320">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4039365">var</span>&nbsp;<span class="op" id="4039369">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039372">oidNamedCurveP224</span>&nbsp;<span class="op" id="4039390">=</span>&nbsp;<span class="ident" id="4039392"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4039396">.</span><span class="ident" id="4039397">ObjectIdentifier</span><span class="op" id="4039413">{</span><span class="num" id="4039414">1</span><span class="op" id="4039415">,</span>&nbsp;<span class="num" id="4039417">3</span><span class="op" id="4039418">,</span>&nbsp;<span class="num" id="4039420">132</span><span class="op" id="4039423">,</span>&nbsp;<span class="num" id="4039425">0</span><span class="op" id="4039426">,</span>&nbsp;<span class="num" id="4039428">33</span><span class="op" id="4039430">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039433">oidNamedCurveP256</span>&nbsp;<span class="op" id="4039451">=</span>&nbsp;<span class="ident" id="4039453"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4039457">.</span><span class="ident" id="4039458">ObjectIdentifier</span><span class="op" id="4039474">{</span><span class="num" id="4039475">1</span><span class="op" id="4039476">,</span>&nbsp;<span class="num" id="4039478">2</span><span class="op" id="4039479">,</span>&nbsp;<span class="num" id="4039481">840</span><span class="op" id="4039484">,</span>&nbsp;<span class="num" id="4039486">10045</span><span class="op" id="4039491">,</span>&nbsp;<span class="num" id="4039493">3</span><span class="op" id="4039494">,</span>&nbsp;<span class="num" id="4039496">1</span><span class="op" id="4039497">,</span>&nbsp;<span class="num" id="4039499">7</span><span class="op" id="4039500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039503">oidNamedCurveP384</span>&nbsp;<span class="op" id="4039521">=</span>&nbsp;<span class="ident" id="4039523"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4039527">.</span><span class="ident" id="4039528">ObjectIdentifier</span><span class="op" id="4039544">{</span><span class="num" id="4039545">1</span><span class="op" id="4039546">,</span>&nbsp;<span class="num" id="4039548">3</span><span class="op" id="4039549">,</span>&nbsp;<span class="num" id="4039551">132</span><span class="op" id="4039554">,</span>&nbsp;<span class="num" id="4039556">0</span><span class="op" id="4039557">,</span>&nbsp;<span class="num" id="4039559">34</span><span class="op" id="4039561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039564">oidNamedCurveP521</span>&nbsp;<span class="op" id="4039582">=</span>&nbsp;<span class="ident" id="4039584"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4039588">.</span><span class="ident" id="4039589">ObjectIdentifier</span><span class="op" id="4039605">{</span><span class="num" id="4039606">1</span><span class="op" id="4039607">,</span>&nbsp;<span class="num" id="4039609">3</span><span class="op" id="4039610">,</span>&nbsp;<span class="num" id="4039612">132</span><span class="op" id="4039615">,</span>&nbsp;<span class="num" id="4039617">0</span><span class="op" id="4039618">,</span>&nbsp;<span class="num" id="4039620">35</span><span class="op" id="4039622">}</span><br>
<span class="lineno"></span><span class="op" id="4039624">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4039627">func</span>&nbsp;<span class="ident" id="4039632">namedCurveFromOID</span><span class="op" id="4039649">(</span><span class="ident" id="4039650">oid</span>&nbsp;<span class="ident" id="4039654"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4039658">.</span><span class="ident" id="4039659">ObjectIdentifier</span><span class="op" id="4039675">)</span>&nbsp;<span class="ident" id="4039677"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4039685">.</span><span class="ident" id="4039686">Curve</span>&nbsp;<span class="op" id="4039692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039695">switch</span>&nbsp;<span class="op" id="4039702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039705">case</span>&nbsp;<span class="ident" id="4039710"><a href="/crypto/x509/x509.go.html#4039650">oid</a></span><span class="op" id="4039713">.</span><span class="ident" id="4039714">Equal</span><span class="op" id="4039719">(</span><span class="ident" id="4039720"><a href="/crypto/x509/x509.go.html#4039372">oidNamedCurveP224</a></span><span class="op" id="4039737">)</span><span class="op" id="4039738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039742">return</span>&nbsp;<span class="ident" id="4039749"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4039757">.</span><span class="ident" id="4039758">P224</span><span class="op" id="4039762">(</span><span class="op" id="4039763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039766">case</span>&nbsp;<span class="ident" id="4039771"><a href="/crypto/x509/x509.go.html#4039650">oid</a></span><span class="op" id="4039774">.</span><span class="ident" id="4039775">Equal</span><span class="op" id="4039780">(</span><span class="ident" id="4039781"><a href="/crypto/x509/x509.go.html#4039433">oidNamedCurveP256</a></span><span class="op" id="4039798">)</span><span class="op" id="4039799">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039803">return</span>&nbsp;<span class="ident" id="4039810"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4039818">.</span><span class="ident" id="4039819">P256</span><span class="op" id="4039823">(</span><span class="op" id="4039824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039827">case</span>&nbsp;<span class="ident" id="4039832"><a href="/crypto/x509/x509.go.html#4039650">oid</a></span><span class="op" id="4039835">.</span><span class="ident" id="4039836">Equal</span><span class="op" id="4039841">(</span><span class="ident" id="4039842"><a href="/crypto/x509/x509.go.html#4039503">oidNamedCurveP384</a></span><span class="op" id="4039859">)</span><span class="op" id="4039860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039864">return</span>&nbsp;<span class="ident" id="4039871"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4039879">.</span><span class="ident" id="4039880">P384</span><span class="op" id="4039884">(</span><span class="op" id="4039885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039888">case</span>&nbsp;<span class="ident" id="4039893"><a href="/crypto/x509/x509.go.html#4039650">oid</a></span><span class="op" id="4039896">.</span><span class="ident" id="4039897">Equal</span><span class="op" id="4039902">(</span><span class="ident" id="4039903"><a href="/crypto/x509/x509.go.html#4039564">oidNamedCurveP521</a></span><span class="op" id="4039920">)</span><span class="op" id="4039921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039925">return</span>&nbsp;<span class="ident" id="4039932"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4039940">.</span><span class="ident" id="4039941">P521</span><span class="op" id="4039945">(</span><span class="op" id="4039946">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4039949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039952">return</span>&nbsp;<span class="ident" id="4039959">nil</span><br>
<span class="lineno"></span><span class="op" id="4039963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4039966">func</span>&nbsp;<span class="ident" id="4039971">oidFromNamedCurve</span><span class="op" id="4039988">(</span><span class="ident" id="4039989">curve</span>&nbsp;<span class="ident" id="4039995"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4040003">.</span><span class="ident" id="4040004">Curve</span><span class="op" id="4040009">)</span>&nbsp;<span class="op" id="4040011">(</span><span class="ident" id="4040012"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4040016">.</span><span class="ident" id="4040017">ObjectIdentifier</span><span class="op" id="4040033">,</span>&nbsp;<span class="builtintype" id="4040035">bool</span><span class="op" id="4040039">)</span>&nbsp;<span class="op" id="4040041">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040044">switch</span>&nbsp;<span class="ident" id="4040051"><a href="/crypto/x509/x509.go.html#4039989">curve</a></span>&nbsp;<span class="op" id="4040057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040060">case</span>&nbsp;<span class="ident" id="4040065"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4040073">.</span><span class="ident" id="4040074">P224</span><span class="op" id="4040078">(</span><span class="op" id="4040079">)</span><span class="op" id="4040080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040084">return</span>&nbsp;<span class="ident" id="4040091"><a href="/crypto/x509/x509.go.html#4039372">oidNamedCurveP224</a></span><span class="op" id="4040108">,</span>&nbsp;<span class="builtintype" id="4040110">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040116">case</span>&nbsp;<span class="ident" id="4040121"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4040129">.</span><span class="ident" id="4040130">P256</span><span class="op" id="4040134">(</span><span class="op" id="4040135">)</span><span class="op" id="4040136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040140">return</span>&nbsp;<span class="ident" id="4040147"><a href="/crypto/x509/x509.go.html#4039433">oidNamedCurveP256</a></span><span class="op" id="4040164">,</span>&nbsp;<span class="builtintype" id="4040166">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040172">case</span>&nbsp;<span class="ident" id="4040177"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4040185">.</span><span class="ident" id="4040186">P384</span><span class="op" id="4040190">(</span><span class="op" id="4040191">)</span><span class="op" id="4040192">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040196">return</span>&nbsp;<span class="ident" id="4040203"><a href="/crypto/x509/x509.go.html#4039503">oidNamedCurveP384</a></span><span class="op" id="4040220">,</span>&nbsp;<span class="builtintype" id="4040222">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040228">case</span>&nbsp;<span class="ident" id="4040233"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4040241">.</span><span class="ident" id="4040242">P521</span><span class="op" id="4040246">(</span><span class="op" id="4040247">)</span><span class="op" id="4040248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040252">return</span>&nbsp;<span class="ident" id="4040259"><a href="/crypto/x509/x509.go.html#4039564">oidNamedCurveP521</a></span><span class="op" id="4040276">,</span>&nbsp;<span class="builtintype" id="4040278">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040284">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040288">return</span>&nbsp;<span class="ident" id="4040295">nil</span><span class="op" id="4040298">,</span>&nbsp;<span class="builtintype" id="4040300">false</span><br>
<span class="lineno"></span><span class="op" id="4040306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4040309">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4040388">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4040428">type</span>&nbsp;<span class="ident" id="4040433">KeyUsage</span>&nbsp;<span class="builtintype" id="4040442">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4040447">const</span>&nbsp;<span class="op" id="4040453">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040456">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4040481"><a href="/crypto/x509/x509.go.html#4040433">KeyUsage</a></span>&nbsp;<span class="op" id="4040490">=</span>&nbsp;<span class="num" id="4040492">1</span>&nbsp;<span class="op" id="4040494">&lt;&lt;</span>&nbsp;<span class="ident" id="4040497">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040503">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040530">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040555">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040581">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040603">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040621">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040638">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040660">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4040681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4040684">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4040726">//</span><br>
<span class="lineno"></span><span class="comment" id="4040729">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4040798">//</span><br>
<span class="lineno"></span><span class="comment" id="4040801">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4040846">//</span><br>
<span class="lineno"></span><span class="comment" id="4040849">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4040915">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4040981">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4041047">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4041113">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4041179">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4041245">var</span>&nbsp;<span class="op" id="4041249">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041252">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4041293">=</span>&nbsp;<span class="ident" id="4041295"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4041299">.</span><span class="ident" id="4041300">ObjectIdentifier</span><span class="op" id="4041316">{</span><span class="num" id="4041317">2</span><span class="op" id="4041318">,</span>&nbsp;<span class="num" id="4041320">5</span><span class="op" id="4041321">,</span>&nbsp;<span class="num" id="4041323">29</span><span class="op" id="4041325">,</span>&nbsp;<span class="num" id="4041327">37</span><span class="op" id="4041329">,</span>&nbsp;<span class="num" id="4041331">0</span><span class="op" id="4041332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041335">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4041376">=</span>&nbsp;<span class="ident" id="4041378"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4041382">.</span><span class="ident" id="4041383">ObjectIdentifier</span><span class="op" id="4041399">{</span><span class="num" id="4041400">1</span><span class="op" id="4041401">,</span>&nbsp;<span class="num" id="4041403">3</span><span class="op" id="4041404">,</span>&nbsp;<span class="num" id="4041406">6</span><span class="op" id="4041407">,</span>&nbsp;<span class="num" id="4041409">1</span><span class="op" id="4041410">,</span>&nbsp;<span class="num" id="4041412">5</span><span class="op" id="4041413">,</span>&nbsp;<span class="num" id="4041415">5</span><span class="op" id="4041416">,</span>&nbsp;<span class="num" id="4041418">7</span><span class="op" id="4041419">,</span>&nbsp;<span class="num" id="4041421">3</span><span class="op" id="4041422">,</span>&nbsp;<span class="num" id="4041424">1</span><span class="op" id="4041425">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041428">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4041469">=</span>&nbsp;<span class="ident" id="4041471"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4041475">.</span><span class="ident" id="4041476">ObjectIdentifier</span><span class="op" id="4041492">{</span><span class="num" id="4041493">1</span><span class="op" id="4041494">,</span>&nbsp;<span class="num" id="4041496">3</span><span class="op" id="4041497">,</span>&nbsp;<span class="num" id="4041499">6</span><span class="op" id="4041500">,</span>&nbsp;<span class="num" id="4041502">1</span><span class="op" id="4041503">,</span>&nbsp;<span class="num" id="4041505">5</span><span class="op" id="4041506">,</span>&nbsp;<span class="num" id="4041508">5</span><span class="op" id="4041509">,</span>&nbsp;<span class="num" id="4041511">7</span><span class="op" id="4041512">,</span>&nbsp;<span class="num" id="4041514">3</span><span class="op" id="4041515">,</span>&nbsp;<span class="num" id="4041517">2</span><span class="op" id="4041518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041521">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4041562">=</span>&nbsp;<span class="ident" id="4041564"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4041568">.</span><span class="ident" id="4041569">ObjectIdentifier</span><span class="op" id="4041585">{</span><span class="num" id="4041586">1</span><span class="op" id="4041587">,</span>&nbsp;<span class="num" id="4041589">3</span><span class="op" id="4041590">,</span>&nbsp;<span class="num" id="4041592">6</span><span class="op" id="4041593">,</span>&nbsp;<span class="num" id="4041595">1</span><span class="op" id="4041596">,</span>&nbsp;<span class="num" id="4041598">5</span><span class="op" id="4041599">,</span>&nbsp;<span class="num" id="4041601">5</span><span class="op" id="4041602">,</span>&nbsp;<span class="num" id="4041604">7</span><span class="op" id="4041605">,</span>&nbsp;<span class="num" id="4041607">3</span><span class="op" id="4041608">,</span>&nbsp;<span class="num" id="4041610">3</span><span class="op" id="4041611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041614">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4041655">=</span>&nbsp;<span class="ident" id="4041657"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4041661">.</span><span class="ident" id="4041662">ObjectIdentifier</span><span class="op" id="4041678">{</span><span class="num" id="4041679">1</span><span class="op" id="4041680">,</span>&nbsp;<span class="num" id="4041682">3</span><span class="op" id="4041683">,</span>&nbsp;<span class="num" id="4041685">6</span><span class="op" id="4041686">,</span>&nbsp;<span class="num" id="4041688">1</span><span class="op" id="4041689">,</span>&nbsp;<span class="num" id="4041691">5</span><span class="op" id="4041692">,</span>&nbsp;<span class="num" id="4041694">5</span><span class="op" id="4041695">,</span>&nbsp;<span class="num" id="4041697">7</span><span class="op" id="4041698">,</span>&nbsp;<span class="num" id="4041700">3</span><span class="op" id="4041701">,</span>&nbsp;<span class="num" id="4041703">4</span><span class="op" id="4041704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041707">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4041748">=</span>&nbsp;<span class="ident" id="4041750"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4041754">.</span><span class="ident" id="4041755">ObjectIdentifier</span><span class="op" id="4041771">{</span><span class="num" id="4041772">1</span><span class="op" id="4041773">,</span>&nbsp;<span class="num" id="4041775">3</span><span class="op" id="4041776">,</span>&nbsp;<span class="num" id="4041778">6</span><span class="op" id="4041779">,</span>&nbsp;<span class="num" id="4041781">1</span><span class="op" id="4041782">,</span>&nbsp;<span class="num" id="4041784">5</span><span class="op" id="4041785">,</span>&nbsp;<span class="num" id="4041787">5</span><span class="op" id="4041788">,</span>&nbsp;<span class="num" id="4041790">7</span><span class="op" id="4041791">,</span>&nbsp;<span class="num" id="4041793">3</span><span class="op" id="4041794">,</span>&nbsp;<span class="num" id="4041796">5</span><span class="op" id="4041797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041800">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4041841">=</span>&nbsp;<span class="ident" id="4041843"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4041847">.</span><span class="ident" id="4041848">ObjectIdentifier</span><span class="op" id="4041864">{</span><span class="num" id="4041865">1</span><span class="op" id="4041866">,</span>&nbsp;<span class="num" id="4041868">3</span><span class="op" id="4041869">,</span>&nbsp;<span class="num" id="4041871">6</span><span class="op" id="4041872">,</span>&nbsp;<span class="num" id="4041874">1</span><span class="op" id="4041875">,</span>&nbsp;<span class="num" id="4041877">5</span><span class="op" id="4041878">,</span>&nbsp;<span class="num" id="4041880">5</span><span class="op" id="4041881">,</span>&nbsp;<span class="num" id="4041883">7</span><span class="op" id="4041884">,</span>&nbsp;<span class="num" id="4041886">3</span><span class="op" id="4041887">,</span>&nbsp;<span class="num" id="4041889">6</span><span class="op" id="4041890">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041893">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4041934">=</span>&nbsp;<span class="ident" id="4041936"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4041940">.</span><span class="ident" id="4041941">ObjectIdentifier</span><span class="op" id="4041957">{</span><span class="num" id="4041958">1</span><span class="op" id="4041959">,</span>&nbsp;<span class="num" id="4041961">3</span><span class="op" id="4041962">,</span>&nbsp;<span class="num" id="4041964">6</span><span class="op" id="4041965">,</span>&nbsp;<span class="num" id="4041967">1</span><span class="op" id="4041968">,</span>&nbsp;<span class="num" id="4041970">5</span><span class="op" id="4041971">,</span>&nbsp;<span class="num" id="4041973">5</span><span class="op" id="4041974">,</span>&nbsp;<span class="num" id="4041976">7</span><span class="op" id="4041977">,</span>&nbsp;<span class="num" id="4041979">3</span><span class="op" id="4041980">,</span>&nbsp;<span class="num" id="4041982">7</span><span class="op" id="4041983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4041986">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4042027">=</span>&nbsp;<span class="ident" id="4042029"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4042033">.</span><span class="ident" id="4042034">ObjectIdentifier</span><span class="op" id="4042050">{</span><span class="num" id="4042051">1</span><span class="op" id="4042052">,</span>&nbsp;<span class="num" id="4042054">3</span><span class="op" id="4042055">,</span>&nbsp;<span class="num" id="4042057">6</span><span class="op" id="4042058">,</span>&nbsp;<span class="num" id="4042060">1</span><span class="op" id="4042061">,</span>&nbsp;<span class="num" id="4042063">5</span><span class="op" id="4042064">,</span>&nbsp;<span class="num" id="4042066">5</span><span class="op" id="4042067">,</span>&nbsp;<span class="num" id="4042069">7</span><span class="op" id="4042070">,</span>&nbsp;<span class="num" id="4042072">3</span><span class="op" id="4042073">,</span>&nbsp;<span class="num" id="4042075">8</span><span class="op" id="4042076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042079">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4042120">=</span>&nbsp;<span class="ident" id="4042122"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4042126">.</span><span class="ident" id="4042127">ObjectIdentifier</span><span class="op" id="4042143">{</span><span class="num" id="4042144">1</span><span class="op" id="4042145">,</span>&nbsp;<span class="num" id="4042147">3</span><span class="op" id="4042148">,</span>&nbsp;<span class="num" id="4042150">6</span><span class="op" id="4042151">,</span>&nbsp;<span class="num" id="4042153">1</span><span class="op" id="4042154">,</span>&nbsp;<span class="num" id="4042156">5</span><span class="op" id="4042157">,</span>&nbsp;<span class="num" id="4042159">5</span><span class="op" id="4042160">,</span>&nbsp;<span class="num" id="4042162">7</span><span class="op" id="4042163">,</span>&nbsp;<span class="num" id="4042165">3</span><span class="op" id="4042166">,</span>&nbsp;<span class="num" id="4042168">9</span><span class="op" id="4042169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042172">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4042213">=</span>&nbsp;<span class="ident" id="4042215"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4042219">.</span><span class="ident" id="4042220">ObjectIdentifier</span><span class="op" id="4042236">{</span><span class="num" id="4042237">1</span><span class="op" id="4042238">,</span>&nbsp;<span class="num" id="4042240">3</span><span class="op" id="4042241">,</span>&nbsp;<span class="num" id="4042243">6</span><span class="op" id="4042244">,</span>&nbsp;<span class="num" id="4042246">1</span><span class="op" id="4042247">,</span>&nbsp;<span class="num" id="4042249">4</span><span class="op" id="4042250">,</span>&nbsp;<span class="num" id="4042252">1</span><span class="op" id="4042253">,</span>&nbsp;<span class="num" id="4042255">311</span><span class="op" id="4042258">,</span>&nbsp;<span class="num" id="4042260">10</span><span class="op" id="4042262">,</span>&nbsp;<span class="num" id="4042264">3</span><span class="op" id="4042265">,</span>&nbsp;<span class="num" id="4042267">3</span><span class="op" id="4042268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042271">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4042312">=</span>&nbsp;<span class="ident" id="4042314"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4042318">.</span><span class="ident" id="4042319">ObjectIdentifier</span><span class="op" id="4042335">{</span><span class="num" id="4042336">2</span><span class="op" id="4042337">,</span>&nbsp;<span class="num" id="4042339">16</span><span class="op" id="4042341">,</span>&nbsp;<span class="num" id="4042343">840</span><span class="op" id="4042346">,</span>&nbsp;<span class="num" id="4042348">1</span><span class="op" id="4042349">,</span>&nbsp;<span class="num" id="4042351">113730</span><span class="op" id="4042357">,</span>&nbsp;<span class="num" id="4042359">4</span><span class="op" id="4042360">,</span>&nbsp;<span class="num" id="4042362">1</span><span class="op" id="4042363">}</span><br>
<span class="lineno">400</span><span class="op" id="4042365">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4042368">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4042453">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4042515">type</span>&nbsp;<span class="ident" id="4042520">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4042532">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4042537">const</span>&nbsp;<span class="op" id="4042543">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042546">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4042561"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4042573">=</span>&nbsp;<span class="ident" id="4042575">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042581">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042604">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042627">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042651">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042679">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042706">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042730">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042752">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042777">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042801">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042840">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4042877">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4042880">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4042956">var</span>&nbsp;<span class="ident" id="4042960">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4042976">=</span>&nbsp;<span class="op" id="4042978">[</span><span class="op" id="4042979">]</span><span class="keyword" id="4042980">struct</span>&nbsp;<span class="op" id="4042987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4042990">extKeyUsage</span>&nbsp;<span class="ident" id="4043002"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4043015">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4043027"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4043031">.</span><span class="ident" id="4043032">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4043049">}</span><span class="op" id="4043050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043053">{</span><span class="ident" id="4043054"><a href="/crypto/x509/x509.go.html#4042546">ExtKeyUsageAny</a></span><span class="op" id="4043068">,</span>&nbsp;<span class="ident" id="4043070"><a href="/crypto/x509/x509.go.html#4041252">oidExtKeyUsageAny</a></span><span class="op" id="4043087">}</span><span class="op" id="4043088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043091">{</span><span class="ident" id="4043092"><a href="/crypto/x509/x509.go.html#4042581">ExtKeyUsageServerAuth</a></span><span class="op" id="4043113">,</span>&nbsp;<span class="ident" id="4043115"><a href="/crypto/x509/x509.go.html#4041335">oidExtKeyUsageServerAuth</a></span><span class="op" id="4043139">}</span><span class="op" id="4043140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043143">{</span><span class="ident" id="4043144"><a href="/crypto/x509/x509.go.html#4042604">ExtKeyUsageClientAuth</a></span><span class="op" id="4043165">,</span>&nbsp;<span class="ident" id="4043167"><a href="/crypto/x509/x509.go.html#4041428">oidExtKeyUsageClientAuth</a></span><span class="op" id="4043191">}</span><span class="op" id="4043192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043195">{</span><span class="ident" id="4043196"><a href="/crypto/x509/x509.go.html#4042627">ExtKeyUsageCodeSigning</a></span><span class="op" id="4043218">,</span>&nbsp;<span class="ident" id="4043220"><a href="/crypto/x509/x509.go.html#4041521">oidExtKeyUsageCodeSigning</a></span><span class="op" id="4043245">}</span><span class="op" id="4043246">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043249">{</span><span class="ident" id="4043250"><a href="/crypto/x509/x509.go.html#4042651">ExtKeyUsageEmailProtection</a></span><span class="op" id="4043276">,</span>&nbsp;<span class="ident" id="4043278"><a href="/crypto/x509/x509.go.html#4041614">oidExtKeyUsageEmailProtection</a></span><span class="op" id="4043307">}</span><span class="op" id="4043308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043311">{</span><span class="ident" id="4043312"><a href="/crypto/x509/x509.go.html#4042679">ExtKeyUsageIPSECEndSystem</a></span><span class="op" id="4043337">,</span>&nbsp;<span class="ident" id="4043339"><a href="/crypto/x509/x509.go.html#4041707">oidExtKeyUsageIPSECEndSystem</a></span><span class="op" id="4043367">}</span><span class="op" id="4043368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043371">{</span><span class="ident" id="4043372"><a href="/crypto/x509/x509.go.html#4042706">ExtKeyUsageIPSECTunnel</a></span><span class="op" id="4043394">,</span>&nbsp;<span class="ident" id="4043396"><a href="/crypto/x509/x509.go.html#4041800">oidExtKeyUsageIPSECTunnel</a></span><span class="op" id="4043421">}</span><span class="op" id="4043422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043425">{</span><span class="ident" id="4043426"><a href="/crypto/x509/x509.go.html#4042730">ExtKeyUsageIPSECUser</a></span><span class="op" id="4043446">,</span>&nbsp;<span class="ident" id="4043448"><a href="/crypto/x509/x509.go.html#4041893">oidExtKeyUsageIPSECUser</a></span><span class="op" id="4043471">}</span><span class="op" id="4043472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043475">{</span><span class="ident" id="4043476"><a href="/crypto/x509/x509.go.html#4042752">ExtKeyUsageTimeStamping</a></span><span class="op" id="4043499">,</span>&nbsp;<span class="ident" id="4043501"><a href="/crypto/x509/x509.go.html#4041986">oidExtKeyUsageTimeStamping</a></span><span class="op" id="4043527">}</span><span class="op" id="4043528">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043531">{</span><span class="ident" id="4043532"><a href="/crypto/x509/x509.go.html#4042777">ExtKeyUsageOCSPSigning</a></span><span class="op" id="4043554">,</span>&nbsp;<span class="ident" id="4043556"><a href="/crypto/x509/x509.go.html#4042079">oidExtKeyUsageOCSPSigning</a></span><span class="op" id="4043581">}</span><span class="op" id="4043582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043585">{</span><span class="ident" id="4043586"><a href="/crypto/x509/x509.go.html#4042801">ExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4043623">,</span>&nbsp;<span class="ident" id="4043625"><a href="/crypto/x509/x509.go.html#4042172">oidExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4043665">}</span><span class="op" id="4043666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043669">{</span><span class="ident" id="4043670"><a href="/crypto/x509/x509.go.html#4042840">ExtKeyUsageNetscapeServerGatedCrypto</a></span><span class="op" id="4043706">,</span>&nbsp;<span class="ident" id="4043708"><a href="/crypto/x509/x509.go.html#4042271">oidExtKeyUsageNetscapeServerGatedCrypto</a></span><span class="op" id="4043747">}</span><span class="op" id="4043748">,</span><br>
<span class="lineno"></span><span class="op" id="4043750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4043753">func</span>&nbsp;<span class="ident" id="4043758">extKeyUsageFromOID</span><span class="op" id="4043776">(</span><span class="ident" id="4043777">oid</span>&nbsp;<span class="ident" id="4043781"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4043785">.</span><span class="ident" id="4043786">ObjectIdentifier</span><span class="op" id="4043802">)</span>&nbsp;<span class="op" id="4043804">(</span><span class="ident" id="4043805">eku</span>&nbsp;<span class="ident" id="4043809"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span><span class="op" id="4043820">,</span>&nbsp;<span class="ident" id="4043822">ok</span>&nbsp;<span class="builtintype" id="4043825">bool</span><span class="op" id="4043829">)</span>&nbsp;<span class="op" id="4043831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043834">for</span>&nbsp;<span class="ident" id="4043838">_</span><span class="op" id="4043839">,</span>&nbsp;<span class="ident" id="4043841">pair</span>&nbsp;<span class="op" id="4043846">:=</span>&nbsp;<span class="keyword" id="4043849">range</span>&nbsp;<span class="ident" id="4043855"><a href="/crypto/x509/x509.go.html#4042960">extKeyUsageOIDs</a></span>&nbsp;<span class="op" id="4043871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043875">if</span>&nbsp;<span class="ident" id="4043878"><a href="/crypto/x509/x509.go.html#4043777">oid</a></span><span class="op" id="4043881">.</span><span class="ident" id="4043882">Equal</span><span class="op" id="4043887">(</span><span class="ident" id="4043888"><a href="/crypto/x509/x509.go.html#4043841">pair</a></span><span class="op" id="4043892">.</span><span class="ident" id="4043893">oid</span><span class="op" id="4043896">)</span>&nbsp;<span class="op" id="4043898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043903">return</span>&nbsp;<span class="ident" id="4043910"><a href="/crypto/x509/x509.go.html#4043841">pair</a></span><span class="op" id="4043914">.</span><span class="ident" id="4043915">extKeyUsage</span><span class="op" id="4043926">,</span>&nbsp;<span class="builtintype" id="4043928">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043935">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4043938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4043941">return</span><br>
<span class="lineno"></span><span class="op" id="4043948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4043951">func</span>&nbsp;<span class="ident" id="4043956">oidFromExtKeyUsage</span><span class="op" id="4043974">(</span><span class="ident" id="4043975">eku</span>&nbsp;<span class="ident" id="4043979"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span><span class="op" id="4043990">)</span>&nbsp;<span class="op" id="4043992">(</span><span class="ident" id="4043993">oid</span>&nbsp;<span class="ident" id="4043997"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4044001">.</span><span class="ident" id="4044002">ObjectIdentifier</span><span class="op" id="4044018">,</span>&nbsp;<span class="ident" id="4044020">ok</span>&nbsp;<span class="builtintype" id="4044023">bool</span><span class="op" id="4044027">)</span>&nbsp;<span class="op" id="4044029">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044032">for</span>&nbsp;<span class="ident" id="4044036">_</span><span class="op" id="4044037">,</span>&nbsp;<span class="ident" id="4044039">pair</span>&nbsp;<span class="op" id="4044044">:=</span>&nbsp;<span class="keyword" id="4044047">range</span>&nbsp;<span class="ident" id="4044053"><a href="/crypto/x509/x509.go.html#4042960">extKeyUsageOIDs</a></span>&nbsp;<span class="op" id="4044069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044073">if</span>&nbsp;<span class="ident" id="4044076"><a href="/crypto/x509/x509.go.html#4043975">eku</a></span>&nbsp;<span class="op" id="4044080">==</span>&nbsp;<span class="ident" id="4044083"><a href="/crypto/x509/x509.go.html#4044039">pair</a></span><span class="op" id="4044087">.</span><span class="ident" id="4044088">extKeyUsage</span>&nbsp;<span class="op" id="4044100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044105">return</span>&nbsp;<span class="ident" id="4044112"><a href="/crypto/x509/x509.go.html#4044039">pair</a></span><span class="op" id="4044116">.</span><span class="ident" id="4044117">oid</span><span class="op" id="4044120">,</span>&nbsp;<span class="builtintype" id="4044122">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4044132">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4044135">return</span><br>
<span class="lineno"></span><span class="op" id="4044142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4044145">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4044195">type</span>&nbsp;<span class="ident" id="4044200">Certificate</span>&nbsp;<span class="keyword" id="4044212">struct</span>&nbsp;<span class="op" id="4044219">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044222">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4044246">[</span><span class="op" id="4044247">]</span><span class="builtintype" id="4044248">byte</span>&nbsp;<span class="comment" id="4044253">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044334">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4044358">[</span><span class="op" id="4044359">]</span><span class="builtintype" id="4044360">byte</span>&nbsp;<span class="comment" id="4044365">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044412">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4044436">[</span><span class="op" id="4044437">]</span><span class="builtintype" id="4044438">byte</span>&nbsp;<span class="comment" id="4044443">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044481">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4044505">[</span><span class="op" id="4044506">]</span><span class="builtintype" id="4044507">byte</span>&nbsp;<span class="comment" id="4044512">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044536">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4044560">[</span><span class="op" id="4044561">]</span><span class="builtintype" id="4044562">byte</span>&nbsp;<span class="comment" id="4044567">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044591">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4044610">[</span><span class="op" id="4044611">]</span><span class="builtintype" id="4044612">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044618">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4044637"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044658">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4044677"><a href="/crypto/x509/x509.go.html#4034019">PublicKeyAlgorithm</a></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044697">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4044716">interface</span><span class="op" id="4044725">{</span><span class="op" id="4044726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044730">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4044750">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044755">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4044775">*</span><span class="ident" id="4044776"><a href="/crypto/x509/x509.go.html#4030156">big</a></span><span class="op" id="4044779">.</span><span class="ident" id="4044780">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044785">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4044805"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4044809">.</span><span class="ident" id="4044810">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044816">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4044836"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4044840">.</span><span class="ident" id="4044841">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044847">NotBefore</span><span class="op" id="4044856">,</span>&nbsp;<span class="ident" id="4044858">NotAfter</span>&nbsp;<span class="ident" id="4044867"><a href="/crypto/x509/x509.go.html#4030186">time</a></span><span class="op" id="4044871">.</span><span class="ident" id="4044872">Time</span>&nbsp;<span class="comment" id="4044877">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4044898">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4044918"><a href="/crypto/x509/x509.go.html#4040433">KeyUsage</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4044929">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045002">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045071">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045144">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045187">Extensions</span>&nbsp;<span class="op" id="4045198">[</span><span class="op" id="4045199">]</span><span class="ident" id="4045200"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4045204">.</span><span class="ident" id="4045205">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045217">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045285">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045355">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045428">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045498">ExtraExtensions</span>&nbsp;<span class="op" id="4045514">[</span><span class="op" id="4045515">]</span><span class="ident" id="4045516"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4045520">.</span><span class="ident" id="4045521">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045533">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4045552">[</span><span class="op" id="4045553">]</span><span class="ident" id="4045554"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4045576">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045613">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4045632">[</span><span class="op" id="4045633">]</span><span class="ident" id="4045634"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4045638">.</span><span class="ident" id="4045639">ObjectIdentifier</span>&nbsp;<span class="comment" id="4045656">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045718">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4045740">bool</span>&nbsp;<span class="comment" id="4045745">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045793">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4045815">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4045821">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4045843">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045848">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045914">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4045987">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4046057">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046076">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4046091">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046098">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4046113">[</span><span class="op" id="4046114">]</span><span class="builtintype" id="4046115">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046121">AuthorityKeyId</span>&nbsp;<span class="op" id="4046136">[</span><span class="op" id="4046137">]</span><span class="builtintype" id="4046138">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4046145">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046198">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4046220">[</span><span class="op" id="4046221">]</span><span class="builtintype" id="4046222">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046230">IssuingCertificateURL</span>&nbsp;<span class="op" id="4046252">[</span><span class="op" id="4046253">]</span><span class="builtintype" id="4046254">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4046263">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046297">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4046312">[</span><span class="op" id="4046313">]</span><span class="builtintype" id="4046314">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046322">EmailAddresses</span>&nbsp;<span class="op" id="4046337">[</span><span class="op" id="4046338">]</span><span class="builtintype" id="4046339">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046347">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4046362">[</span><span class="op" id="4046363">]</span><span class="ident" id="4046364"><a href="/crypto/x509/x509.go.html#4030168">net</a></span><span class="op" id="4046367">.</span><span class="ident" id="4046368">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4046373">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046394">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4046422">bool</span>&nbsp;<span class="comment" id="4046427">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046486">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4046514">[</span><span class="op" id="4046515">]</span><span class="builtintype" id="4046516">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4046525">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046553">CRLDistributionPoints</span>&nbsp;<span class="op" id="4046575">[</span><span class="op" id="4046576">]</span><span class="builtintype" id="4046577">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4046586">PolicyIdentifiers</span>&nbsp;<span class="op" id="4046604">[</span><span class="op" id="4046605">]</span><span class="ident" id="4046606"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4046610">.</span><span class="ident" id="4046611">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4046628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4046631">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4046711">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4046770">var</span>&nbsp;<span class="ident" id="4046774">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4046798">=</span>&nbsp;<span class="ident" id="4046800"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4046806">.</span><span class="ident" id="4046807">New</span><span class="op" id="4046810">(</span><span class="string" id="4046811">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4046867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4046870">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4046949">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4047029">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4047057">type</span>&nbsp;<span class="ident" id="4047062">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4047087">struct</span><span class="op" id="4047093">{</span><span class="op" id="4047094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4047097">func</span>&nbsp;<span class="op" id="4047102">(</span><span class="ident" id="4047103"><a href="/crypto/x509/x509.go.html#4047062">ConstraintViolationError</a></span><span class="op" id="4047127">)</span>&nbsp;<span class="ident" id="4047129">Error</span><span class="op" id="4047134">(</span><span class="op" id="4047135">)</span>&nbsp;<span class="builtintype" id="4047137">string</span>&nbsp;<span class="op" id="4047144">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047147">return</span>&nbsp;<span class="string" id="4047154">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4047237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4047240">func</span>&nbsp;<span class="op" id="4047245">(</span><span class="ident" id="4047246">c</span>&nbsp;<span class="op" id="4047248">*</span><span class="ident" id="4047249"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4047260">)</span>&nbsp;<span class="ident" id="4047262">Equal</span><span class="op" id="4047267">(</span><span class="ident" id="4047268">other</span>&nbsp;<span class="op" id="4047274">*</span><span class="ident" id="4047275"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4047286">)</span>&nbsp;<span class="builtintype" id="4047288">bool</span>&nbsp;<span class="op" id="4047293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4047296">return</span>&nbsp;<span class="ident" id="4047303"><a href="/crypto/x509/x509.go.html#4029952">bytes</a></span><span class="op" id="4047308">.</span><span class="ident" id="4047309">Equal</span><span class="op" id="4047314">(</span><span class="ident" id="4047315"><a href="/crypto/x509/x509.go.html#4047246">c</a></span><span class="op" id="4047316">.</span><span class="ident" id="4047317">Raw</span><span class="op" id="4047320">,</span>&nbsp;<span class="ident" id="4047322"><a href="/crypto/x509/x509.go.html#4047268">other</a></span><span class="op" id="4047327">.</span><span class="ident" id="4047328">Raw</span><span class="op" id="4047331">)</span><br>
<span class="lineno">540</span><span class="op" id="4047333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4047336">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4047408">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4047488">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4047510">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4047585">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4047628">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4047694">//</span><br>
<span class="lineno"></span><span class="comment" id="4047697">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4047769">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4047784">var</span>&nbsp;<span class="ident" id="4047788">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4047806">=</span>&nbsp;<span class="op" id="4047808">[</span><span class="op" id="4047809">]</span><span class="builtintype" id="4047810">byte</span><span class="op" id="4047814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4047817">0x30</span><span class="op" id="4047821">,</span>&nbsp;<span class="num" id="4047823">0x82</span><span class="op" id="4047827">,</span>&nbsp;<span class="num" id="4047829">0x01</span><span class="op" id="4047833">,</span>&nbsp;<span class="num" id="4047835">0x22</span><span class="op" id="4047839">,</span>&nbsp;<span class="num" id="4047841">0x30</span><span class="op" id="4047845">,</span>&nbsp;<span class="num" id="4047847">0x0d</span><span class="op" id="4047851">,</span>&nbsp;<span class="num" id="4047853">0x06</span><span class="op" id="4047857">,</span>&nbsp;<span class="num" id="4047859">0x09</span><span class="op" id="4047863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4047866">0x2a</span><span class="op" id="4047870">,</span>&nbsp;<span class="num" id="4047872">0x86</span><span class="op" id="4047876">,</span>&nbsp;<span class="num" id="4047878">0x48</span><span class="op" id="4047882">,</span>&nbsp;<span class="num" id="4047884">0x86</span><span class="op" id="4047888">,</span>&nbsp;<span class="num" id="4047890">0xf7</span><span class="op" id="4047894">,</span>&nbsp;<span class="num" id="4047896">0x0d</span><span class="op" id="4047900">,</span>&nbsp;<span class="num" id="4047902">0x01</span><span class="op" id="4047906">,</span>&nbsp;<span class="num" id="4047908">0x01</span><span class="op" id="4047912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4047915">0x01</span><span class="op" id="4047919">,</span>&nbsp;<span class="num" id="4047921">0x05</span><span class="op" id="4047925">,</span>&nbsp;<span class="num" id="4047927">0x00</span><span class="op" id="4047931">,</span>&nbsp;<span class="num" id="4047933">0x03</span><span class="op" id="4047937">,</span>&nbsp;<span class="num" id="4047939">0x82</span><span class="op" id="4047943">,</span>&nbsp;<span class="num" id="4047945">0x01</span><span class="op" id="4047949">,</span>&nbsp;<span class="num" id="4047951">0x0f</span><span class="op" id="4047955">,</span>&nbsp;<span class="num" id="4047957">0x00</span><span class="op" id="4047961">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4047964">0x30</span><span class="op" id="4047968">,</span>&nbsp;<span class="num" id="4047970">0x82</span><span class="op" id="4047974">,</span>&nbsp;<span class="num" id="4047976">0x01</span><span class="op" id="4047980">,</span>&nbsp;<span class="num" id="4047982">0x0a</span><span class="op" id="4047986">,</span>&nbsp;<span class="num" id="4047988">0x02</span><span class="op" id="4047992">,</span>&nbsp;<span class="num" id="4047994">0x82</span><span class="op" id="4047998">,</span>&nbsp;<span class="num" id="4048000">0x01</span><span class="op" id="4048004">,</span>&nbsp;<span class="num" id="4048006">0x01</span><span class="op" id="4048010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048013">0x00</span><span class="op" id="4048017">,</span>&nbsp;<span class="num" id="4048019">0x97</span><span class="op" id="4048023">,</span>&nbsp;<span class="num" id="4048025">0xa3</span><span class="op" id="4048029">,</span>&nbsp;<span class="num" id="4048031">0x2d</span><span class="op" id="4048035">,</span>&nbsp;<span class="num" id="4048037">0x3c</span><span class="op" id="4048041">,</span>&nbsp;<span class="num" id="4048043">0x9e</span><span class="op" id="4048047">,</span>&nbsp;<span class="num" id="4048049">0xde</span><span class="op" id="4048053">,</span>&nbsp;<span class="num" id="4048055">0x05</span><span class="op" id="4048059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048062">0xda</span><span class="op" id="4048066">,</span>&nbsp;<span class="num" id="4048068">0x13</span><span class="op" id="4048072">,</span>&nbsp;<span class="num" id="4048074">0xc2</span><span class="op" id="4048078">,</span>&nbsp;<span class="num" id="4048080">0x11</span><span class="op" id="4048084">,</span>&nbsp;<span class="num" id="4048086">0x8d</span><span class="op" id="4048090">,</span>&nbsp;<span class="num" id="4048092">0x9d</span><span class="op" id="4048096">,</span>&nbsp;<span class="num" id="4048098">0x8e</span><span class="op" id="4048102">,</span>&nbsp;<span class="num" id="4048104">0xe3</span><span class="op" id="4048108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048111">0x7f</span><span class="op" id="4048115">,</span>&nbsp;<span class="num" id="4048117">0xc7</span><span class="op" id="4048121">,</span>&nbsp;<span class="num" id="4048123">0x4b</span><span class="op" id="4048127">,</span>&nbsp;<span class="num" id="4048129">0x7e</span><span class="op" id="4048133">,</span>&nbsp;<span class="num" id="4048135">0x5a</span><span class="op" id="4048139">,</span>&nbsp;<span class="num" id="4048141">0x9f</span><span class="op" id="4048145">,</span>&nbsp;<span class="num" id="4048147">0xb3</span><span class="op" id="4048151">,</span>&nbsp;<span class="num" id="4048153">0xff</span><span class="op" id="4048157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048160">0x62</span><span class="op" id="4048164">,</span>&nbsp;<span class="num" id="4048166">0xab</span><span class="op" id="4048170">,</span>&nbsp;<span class="num" id="4048172">0x73</span><span class="op" id="4048176">,</span>&nbsp;<span class="num" id="4048178">0xc8</span><span class="op" id="4048182">,</span>&nbsp;<span class="num" id="4048184">0x28</span><span class="op" id="4048188">,</span>&nbsp;<span class="num" id="4048190">0x6b</span><span class="op" id="4048194">,</span>&nbsp;<span class="num" id="4048196">0xba</span><span class="op" id="4048200">,</span>&nbsp;<span class="num" id="4048202">0x10</span><span class="op" id="4048206">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048209">0x64</span><span class="op" id="4048213">,</span>&nbsp;<span class="num" id="4048215">0x82</span><span class="op" id="4048219">,</span>&nbsp;<span class="num" id="4048221">0x87</span><span class="op" id="4048225">,</span>&nbsp;<span class="num" id="4048227">0x13</span><span class="op" id="4048231">,</span>&nbsp;<span class="num" id="4048233">0xcd</span><span class="op" id="4048237">,</span>&nbsp;<span class="num" id="4048239">0x57</span><span class="op" id="4048243">,</span>&nbsp;<span class="num" id="4048245">0x18</span><span class="op" id="4048249">,</span>&nbsp;<span class="num" id="4048251">0xff</span><span class="op" id="4048255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048258">0x28</span><span class="op" id="4048262">,</span>&nbsp;<span class="num" id="4048264">0xce</span><span class="op" id="4048268">,</span>&nbsp;<span class="num" id="4048270">0xc0</span><span class="op" id="4048274">,</span>&nbsp;<span class="num" id="4048276">0xe6</span><span class="op" id="4048280">,</span>&nbsp;<span class="num" id="4048282">0x0e</span><span class="op" id="4048286">,</span>&nbsp;<span class="num" id="4048288">0x06</span><span class="op" id="4048292">,</span>&nbsp;<span class="num" id="4048294">0x91</span><span class="op" id="4048298">,</span>&nbsp;<span class="num" id="4048300">0x50</span><span class="op" id="4048304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048307">0x29</span><span class="op" id="4048311">,</span>&nbsp;<span class="num" id="4048313">0x83</span><span class="op" id="4048317">,</span>&nbsp;<span class="num" id="4048319">0xd1</span><span class="op" id="4048323">,</span>&nbsp;<span class="num" id="4048325">0xf2</span><span class="op" id="4048329">,</span>&nbsp;<span class="num" id="4048331">0xc3</span><span class="op" id="4048335">,</span>&nbsp;<span class="num" id="4048337">0x2a</span><span class="op" id="4048341">,</span>&nbsp;<span class="num" id="4048343">0xdb</span><span class="op" id="4048347">,</span>&nbsp;<span class="num" id="4048349">0xd8</span><span class="op" id="4048353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048356">0xdb</span><span class="op" id="4048360">,</span>&nbsp;<span class="num" id="4048362">0x4e</span><span class="op" id="4048366">,</span>&nbsp;<span class="num" id="4048368">0x04</span><span class="op" id="4048372">,</span>&nbsp;<span class="num" id="4048374">0xcc</span><span class="op" id="4048378">,</span>&nbsp;<span class="num" id="4048380">0x00</span><span class="op" id="4048384">,</span>&nbsp;<span class="num" id="4048386">0xeb</span><span class="op" id="4048390">,</span>&nbsp;<span class="num" id="4048392">0x8b</span><span class="op" id="4048396">,</span>&nbsp;<span class="num" id="4048398">0xb6</span><span class="op" id="4048402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048405">0x96</span><span class="op" id="4048409">,</span>&nbsp;<span class="num" id="4048411">0xdc</span><span class="op" id="4048415">,</span>&nbsp;<span class="num" id="4048417">0xbc</span><span class="op" id="4048421">,</span>&nbsp;<span class="num" id="4048423">0xaa</span><span class="op" id="4048427">,</span>&nbsp;<span class="num" id="4048429">0xfa</span><span class="op" id="4048433">,</span>&nbsp;<span class="num" id="4048435">0x52</span><span class="op" id="4048439">,</span>&nbsp;<span class="num" id="4048441">0x77</span><span class="op" id="4048445">,</span>&nbsp;<span class="num" id="4048447">0x04</span><span class="op" id="4048451">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048454">0xc1</span><span class="op" id="4048458">,</span>&nbsp;<span class="num" id="4048460">0xdb</span><span class="op" id="4048464">,</span>&nbsp;<span class="num" id="4048466">0x19</span><span class="op" id="4048470">,</span>&nbsp;<span class="num" id="4048472">0xe4</span><span class="op" id="4048476">,</span>&nbsp;<span class="num" id="4048478">0xae</span><span class="op" id="4048482">,</span>&nbsp;<span class="num" id="4048484">0x9c</span><span class="op" id="4048488">,</span>&nbsp;<span class="num" id="4048490">0xfd</span><span class="op" id="4048494">,</span>&nbsp;<span class="num" id="4048496">0x3c</span><span class="op" id="4048500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048503">0x8b</span><span class="op" id="4048507">,</span>&nbsp;<span class="num" id="4048509">0x03</span><span class="op" id="4048513">,</span>&nbsp;<span class="num" id="4048515">0xef</span><span class="op" id="4048519">,</span>&nbsp;<span class="num" id="4048521">0x4d</span><span class="op" id="4048525">,</span>&nbsp;<span class="num" id="4048527">0xbc</span><span class="op" id="4048531">,</span>&nbsp;<span class="num" id="4048533">0x1a</span><span class="op" id="4048537">,</span>&nbsp;<span class="num" id="4048539">0x03</span><span class="op" id="4048543">,</span>&nbsp;<span class="num" id="4048545">0x65</span><span class="op" id="4048549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048552">0xf9</span><span class="op" id="4048556">,</span>&nbsp;<span class="num" id="4048558">0xc1</span><span class="op" id="4048562">,</span>&nbsp;<span class="num" id="4048564">0xb1</span><span class="op" id="4048568">,</span>&nbsp;<span class="num" id="4048570">0x3f</span><span class="op" id="4048574">,</span>&nbsp;<span class="num" id="4048576">0x72</span><span class="op" id="4048580">,</span>&nbsp;<span class="num" id="4048582">0x86</span><span class="op" id="4048586">,</span>&nbsp;<span class="num" id="4048588">0xf2</span><span class="op" id="4048592">,</span>&nbsp;<span class="num" id="4048594">0x38</span><span class="op" id="4048598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048601">0xaa</span><span class="op" id="4048605">,</span>&nbsp;<span class="num" id="4048607">0x19</span><span class="op" id="4048611">,</span>&nbsp;<span class="num" id="4048613">0xae</span><span class="op" id="4048617">,</span>&nbsp;<span class="num" id="4048619">0x10</span><span class="op" id="4048623">,</span>&nbsp;<span class="num" id="4048625">0x88</span><span class="op" id="4048629">,</span>&nbsp;<span class="num" id="4048631">0x78</span><span class="op" id="4048635">,</span>&nbsp;<span class="num" id="4048637">0x28</span><span class="op" id="4048641">,</span>&nbsp;<span class="num" id="4048643">0xda</span><span class="op" id="4048647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048650">0x75</span><span class="op" id="4048654">,</span>&nbsp;<span class="num" id="4048656">0xc3</span><span class="op" id="4048660">,</span>&nbsp;<span class="num" id="4048662">0x3d</span><span class="op" id="4048666">,</span>&nbsp;<span class="num" id="4048668">0x02</span><span class="op" id="4048672">,</span>&nbsp;<span class="num" id="4048674">0x82</span><span class="op" id="4048678">,</span>&nbsp;<span class="num" id="4048680">0x02</span><span class="op" id="4048684">,</span>&nbsp;<span class="num" id="4048686">0x9c</span><span class="op" id="4048690">,</span>&nbsp;<span class="num" id="4048692">0xb9</span><span class="op" id="4048696">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048699">0xc1</span><span class="op" id="4048703">,</span>&nbsp;<span class="num" id="4048705">0x65</span><span class="op" id="4048709">,</span>&nbsp;<span class="num" id="4048711">0x77</span><span class="op" id="4048715">,</span>&nbsp;<span class="num" id="4048717">0x76</span><span class="op" id="4048721">,</span>&nbsp;<span class="num" id="4048723">0x24</span><span class="op" id="4048727">,</span>&nbsp;<span class="num" id="4048729">0x4c</span><span class="op" id="4048733">,</span>&nbsp;<span class="num" id="4048735">0x98</span><span class="op" id="4048739">,</span>&nbsp;<span class="num" id="4048741">0xf7</span><span class="op" id="4048745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048748">0x6d</span><span class="op" id="4048752">,</span>&nbsp;<span class="num" id="4048754">0x31</span><span class="op" id="4048758">,</span>&nbsp;<span class="num" id="4048760">0x38</span><span class="op" id="4048764">,</span>&nbsp;<span class="num" id="4048766">0xfb</span><span class="op" id="4048770">,</span>&nbsp;<span class="num" id="4048772">0xdb</span><span class="op" id="4048776">,</span>&nbsp;<span class="num" id="4048778">0xfe</span><span class="op" id="4048782">,</span>&nbsp;<span class="num" id="4048784">0xdb</span><span class="op" id="4048788">,</span>&nbsp;<span class="num" id="4048790">0x37</span><span class="op" id="4048794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048797">0x02</span><span class="op" id="4048801">,</span>&nbsp;<span class="num" id="4048803">0x76</span><span class="op" id="4048807">,</span>&nbsp;<span class="num" id="4048809">0xa1</span><span class="op" id="4048813">,</span>&nbsp;<span class="num" id="4048815">0x18</span><span class="op" id="4048819">,</span>&nbsp;<span class="num" id="4048821">0x97</span><span class="op" id="4048825">,</span>&nbsp;<span class="num" id="4048827">0xa6</span><span class="op" id="4048831">,</span>&nbsp;<span class="num" id="4048833">0xcc</span><span class="op" id="4048837">,</span>&nbsp;<span class="num" id="4048839">0xde</span><span class="op" id="4048843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048846">0x20</span><span class="op" id="4048850">,</span>&nbsp;<span class="num" id="4048852">0x09</span><span class="op" id="4048856">,</span>&nbsp;<span class="num" id="4048858">0x49</span><span class="op" id="4048862">,</span>&nbsp;<span class="num" id="4048864">0x36</span><span class="op" id="4048868">,</span>&nbsp;<span class="num" id="4048870">0x24</span><span class="op" id="4048874">,</span>&nbsp;<span class="num" id="4048876">0x69</span><span class="op" id="4048880">,</span>&nbsp;<span class="num" id="4048882">0x42</span><span class="op" id="4048886">,</span>&nbsp;<span class="num" id="4048888">0xf6</span><span class="op" id="4048892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048895">0xe4</span><span class="op" id="4048899">,</span>&nbsp;<span class="num" id="4048901">0x37</span><span class="op" id="4048905">,</span>&nbsp;<span class="num" id="4048907">0x62</span><span class="op" id="4048911">,</span>&nbsp;<span class="num" id="4048913">0xf1</span><span class="op" id="4048917">,</span>&nbsp;<span class="num" id="4048919">0x59</span><span class="op" id="4048923">,</span>&nbsp;<span class="num" id="4048925">0x6d</span><span class="op" id="4048929">,</span>&nbsp;<span class="num" id="4048931">0xa9</span><span class="op" id="4048935">,</span>&nbsp;<span class="num" id="4048937">0x3c</span><span class="op" id="4048941">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048944">0xed</span><span class="op" id="4048948">,</span>&nbsp;<span class="num" id="4048950">0x34</span><span class="op" id="4048954">,</span>&nbsp;<span class="num" id="4048956">0x9c</span><span class="op" id="4048960">,</span>&nbsp;<span class="num" id="4048962">0xa3</span><span class="op" id="4048966">,</span>&nbsp;<span class="num" id="4048968">0x8e</span><span class="op" id="4048972">,</span>&nbsp;<span class="num" id="4048974">0xdb</span><span class="op" id="4048978">,</span>&nbsp;<span class="num" id="4048980">0xdc</span><span class="op" id="4048984">,</span>&nbsp;<span class="num" id="4048986">0x3a</span><span class="op" id="4048990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4048993">0xd7</span><span class="op" id="4048997">,</span>&nbsp;<span class="num" id="4048999">0xf7</span><span class="op" id="4049003">,</span>&nbsp;<span class="num" id="4049005">0x0a</span><span class="op" id="4049009">,</span>&nbsp;<span class="num" id="4049011">0x6f</span><span class="op" id="4049015">,</span>&nbsp;<span class="num" id="4049017">0xef</span><span class="op" id="4049021">,</span>&nbsp;<span class="num" id="4049023">0x2e</span><span class="op" id="4049027">,</span>&nbsp;<span class="num" id="4049029">0xd8</span><span class="op" id="4049033">,</span>&nbsp;<span class="num" id="4049035">0xd5</span><span class="op" id="4049039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049042">0x93</span><span class="op" id="4049046">,</span>&nbsp;<span class="num" id="4049048">0x5a</span><span class="op" id="4049052">,</span>&nbsp;<span class="num" id="4049054">0x7a</span><span class="op" id="4049058">,</span>&nbsp;<span class="num" id="4049060">0xed</span><span class="op" id="4049064">,</span>&nbsp;<span class="num" id="4049066">0x08</span><span class="op" id="4049070">,</span>&nbsp;<span class="num" id="4049072">0x49</span><span class="op" id="4049076">,</span>&nbsp;<span class="num" id="4049078">0x68</span><span class="op" id="4049082">,</span>&nbsp;<span class="num" id="4049084">0xe2</span><span class="op" id="4049088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049091">0x41</span><span class="op" id="4049095">,</span>&nbsp;<span class="num" id="4049097">0xe3</span><span class="op" id="4049101">,</span>&nbsp;<span class="num" id="4049103">0x5a</span><span class="op" id="4049107">,</span>&nbsp;<span class="num" id="4049109">0x90</span><span class="op" id="4049113">,</span>&nbsp;<span class="num" id="4049115">0xc1</span><span class="op" id="4049119">,</span>&nbsp;<span class="num" id="4049121">0x86</span><span class="op" id="4049125">,</span>&nbsp;<span class="num" id="4049127">0x55</span><span class="op" id="4049131">,</span>&nbsp;<span class="num" id="4049133">0xfc</span><span class="op" id="4049137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049140">0x51</span><span class="op" id="4049144">,</span>&nbsp;<span class="num" id="4049146">0x43</span><span class="op" id="4049150">,</span>&nbsp;<span class="num" id="4049152">0x9d</span><span class="op" id="4049156">,</span>&nbsp;<span class="num" id="4049158">0xe0</span><span class="op" id="4049162">,</span>&nbsp;<span class="num" id="4049164">0xb2</span><span class="op" id="4049168">,</span>&nbsp;<span class="num" id="4049170">0xc4</span><span class="op" id="4049174">,</span>&nbsp;<span class="num" id="4049176">0x67</span><span class="op" id="4049180">,</span>&nbsp;<span class="num" id="4049182">0xb4</span><span class="op" id="4049186">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049189">0xcb</span><span class="op" id="4049193">,</span>&nbsp;<span class="num" id="4049195">0x32</span><span class="op" id="4049199">,</span>&nbsp;<span class="num" id="4049201">0x31</span><span class="op" id="4049205">,</span>&nbsp;<span class="num" id="4049207">0x25</span><span class="op" id="4049211">,</span>&nbsp;<span class="num" id="4049213">0xf0</span><span class="op" id="4049217">,</span>&nbsp;<span class="num" id="4049219">0x54</span><span class="op" id="4049223">,</span>&nbsp;<span class="num" id="4049225">0x9f</span><span class="op" id="4049229">,</span>&nbsp;<span class="num" id="4049231">0x4b</span><span class="op" id="4049235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049238">0xd1</span><span class="op" id="4049242">,</span>&nbsp;<span class="num" id="4049244">0x6f</span><span class="op" id="4049248">,</span>&nbsp;<span class="num" id="4049250">0xdb</span><span class="op" id="4049254">,</span>&nbsp;<span class="num" id="4049256">0xd4</span><span class="op" id="4049260">,</span>&nbsp;<span class="num" id="4049262">0xdd</span><span class="op" id="4049266">,</span>&nbsp;<span class="num" id="4049268">0xfc</span><span class="op" id="4049272">,</span>&nbsp;<span class="num" id="4049274">0xaf</span><span class="op" id="4049278">,</span>&nbsp;<span class="num" id="4049280">0x5e</span><span class="op" id="4049284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049287">0x6c</span><span class="op" id="4049291">,</span>&nbsp;<span class="num" id="4049293">0x78</span><span class="op" id="4049297">,</span>&nbsp;<span class="num" id="4049299">0x90</span><span class="op" id="4049303">,</span>&nbsp;<span class="num" id="4049305">0x95</span><span class="op" id="4049309">,</span>&nbsp;<span class="num" id="4049311">0xde</span><span class="op" id="4049315">,</span>&nbsp;<span class="num" id="4049317">0xca</span><span class="op" id="4049321">,</span>&nbsp;<span class="num" id="4049323">0x3a</span><span class="op" id="4049327">,</span>&nbsp;<span class="num" id="4049329">0x48</span><span class="op" id="4049333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049336">0xb9</span><span class="op" id="4049340">,</span>&nbsp;<span class="num" id="4049342">0x79</span><span class="op" id="4049346">,</span>&nbsp;<span class="num" id="4049348">0x3c</span><span class="op" id="4049352">,</span>&nbsp;<span class="num" id="4049354">0x9b</span><span class="op" id="4049358">,</span>&nbsp;<span class="num" id="4049360">0x19</span><span class="op" id="4049364">,</span>&nbsp;<span class="num" id="4049366">0xd6</span><span class="op" id="4049370">,</span>&nbsp;<span class="num" id="4049372">0x75</span><span class="op" id="4049376">,</span>&nbsp;<span class="num" id="4049378">0x05</span><span class="op" id="4049382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049385">0xa0</span><span class="op" id="4049389">,</span>&nbsp;<span class="num" id="4049391">0xf9</span><span class="op" id="4049395">,</span>&nbsp;<span class="num" id="4049397">0x88</span><span class="op" id="4049401">,</span>&nbsp;<span class="num" id="4049403">0xd7</span><span class="op" id="4049407">,</span>&nbsp;<span class="num" id="4049409">0xc1</span><span class="op" id="4049413">,</span>&nbsp;<span class="num" id="4049415">0xe8</span><span class="op" id="4049419">,</span>&nbsp;<span class="num" id="4049421">0xa5</span><span class="op" id="4049425">,</span>&nbsp;<span class="num" id="4049427">0x09</span><span class="op" id="4049431">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049434">0xe4</span><span class="op" id="4049438">,</span>&nbsp;<span class="num" id="4049440">0x1a</span><span class="op" id="4049444">,</span>&nbsp;<span class="num" id="4049446">0x15</span><span class="op" id="4049450">,</span>&nbsp;<span class="num" id="4049452">0xdc</span><span class="op" id="4049456">,</span>&nbsp;<span class="num" id="4049458">0x87</span><span class="op" id="4049462">,</span>&nbsp;<span class="num" id="4049464">0x23</span><span class="op" id="4049468">,</span>&nbsp;<span class="num" id="4049470">0xaa</span><span class="op" id="4049474">,</span>&nbsp;<span class="num" id="4049476">0xb2</span><span class="op" id="4049480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049483">0x75</span><span class="op" id="4049487">,</span>&nbsp;<span class="num" id="4049489">0x8c</span><span class="op" id="4049493">,</span>&nbsp;<span class="num" id="4049495">0x63</span><span class="op" id="4049499">,</span>&nbsp;<span class="num" id="4049501">0x25</span><span class="op" id="4049505">,</span>&nbsp;<span class="num" id="4049507">0x87</span><span class="op" id="4049511">,</span>&nbsp;<span class="num" id="4049513">0xd8</span><span class="op" id="4049517">,</span>&nbsp;<span class="num" id="4049519">0xf8</span><span class="op" id="4049523">,</span>&nbsp;<span class="num" id="4049525">0x3d</span><span class="op" id="4049529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049532">0xa6</span><span class="op" id="4049536">,</span>&nbsp;<span class="num" id="4049538">0xc2</span><span class="op" id="4049542">,</span>&nbsp;<span class="num" id="4049544">0xcc</span><span class="op" id="4049548">,</span>&nbsp;<span class="num" id="4049550">0x66</span><span class="op" id="4049554">,</span>&nbsp;<span class="num" id="4049556">0xff</span><span class="op" id="4049560">,</span>&nbsp;<span class="num" id="4049562">0xa5</span><span class="op" id="4049566">,</span>&nbsp;<span class="num" id="4049568">0x66</span><span class="op" id="4049572">,</span>&nbsp;<span class="num" id="4049574">0x68</span><span class="op" id="4049578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4049581">0x55</span><span class="op" id="4049585">,</span>&nbsp;<span class="num" id="4049587">0x02</span><span class="op" id="4049591">,</span>&nbsp;<span class="num" id="4049593">0x03</span><span class="op" id="4049597">,</span>&nbsp;<span class="num" id="4049599">0x01</span><span class="op" id="4049603">,</span>&nbsp;<span class="num" id="4049605">0x00</span><span class="op" id="4049609">,</span>&nbsp;<span class="num" id="4049611">0x01</span><span class="op" id="4049615">,</span><br>
<span class="lineno"></span><span class="op" id="4049617">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4049620">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4049696">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4049712">func</span>&nbsp;<span class="op" id="4049717">(</span><span class="ident" id="4049718">c</span>&nbsp;<span class="op" id="4049720">*</span><span class="ident" id="4049721"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4049732">)</span>&nbsp;<span class="ident" id="4049734">CheckSignatureFrom</span><span class="op" id="4049752">(</span><span class="ident" id="4049753">parent</span>&nbsp;<span class="op" id="4049760">*</span><span class="ident" id="4049761"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4049772">)</span>&nbsp;<span class="op" id="4049774">(</span><span class="ident" id="4049775">err</span>&nbsp;<span class="builtintype" id="4049779">error</span><span class="op" id="4049784">)</span>&nbsp;<span class="op" id="4049786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049789">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049812">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049882">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4049953">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4050024">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4050053">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050115">if</span>&nbsp;<span class="op" id="4050118">(</span><span class="ident" id="4050119"><a href="/crypto/x509/x509.go.html#4049753">parent</a></span><span class="op" id="4050125">.</span><span class="ident" id="4050126">Version</span>&nbsp;<span class="op" id="4050134">==</span>&nbsp;<span class="num" id="4050137">3</span>&nbsp;<span class="op" id="4050139">&amp;&amp;</span>&nbsp;<span class="op" id="4050142">!</span><span class="ident" id="4050143"><a href="/crypto/x509/x509.go.html#4049753">parent</a></span><span class="op" id="4050149">.</span><span class="ident" id="4050150">BasicConstraintsValid</span>&nbsp;<span class="op" id="4050172">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050177"><a href="/crypto/x509/x509.go.html#4049753">parent</a></span><span class="op" id="4050183">.</span><span class="ident" id="4050184">BasicConstraintsValid</span>&nbsp;<span class="op" id="4050206">&amp;&amp;</span>&nbsp;<span class="op" id="4050209">!</span><span class="ident" id="4050210"><a href="/crypto/x509/x509.go.html#4049753">parent</a></span><span class="op" id="4050216">.</span><span class="ident" id="4050217">IsCA</span><span class="op" id="4050221">)</span>&nbsp;<span class="op" id="4050223">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050228">!</span><span class="ident" id="4050229"><a href="/crypto/x509/x509.go.html#4029952">bytes</a></span><span class="op" id="4050234">.</span><span class="ident" id="4050235">Equal</span><span class="op" id="4050240">(</span><span class="ident" id="4050241"><a href="/crypto/x509/x509.go.html#4049718">c</a></span><span class="op" id="4050242">.</span><span class="ident" id="4050243">RawSubjectPublicKeyInfo</span><span class="op" id="4050266">,</span>&nbsp;<span class="ident" id="4050268"><a href="/crypto/x509/x509.go.html#4047788">entrustBrokenSPKI</a></span><span class="op" id="4050285">)</span>&nbsp;<span class="op" id="4050287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050291">return</span>&nbsp;<span class="ident" id="4050298"><a href="/crypto/x509/x509.go.html#4047062">ConstraintViolationError</a></span><span class="op" id="4050322">{</span><span class="op" id="4050323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050326">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050330">if</span>&nbsp;<span class="ident" id="4050333"><a href="/crypto/x509/x509.go.html#4049753">parent</a></span><span class="op" id="4050339">.</span><span class="ident" id="4050340">KeyUsage</span>&nbsp;<span class="op" id="4050349">!=</span>&nbsp;<span class="num" id="4050352">0</span>&nbsp;<span class="op" id="4050354">&amp;&amp;</span>&nbsp;<span class="ident" id="4050357"><a href="/crypto/x509/x509.go.html#4049753">parent</a></span><span class="op" id="4050363">.</span><span class="ident" id="4050364">KeyUsage</span><span class="op" id="4050372">&amp;</span><span class="ident" id="4050373"><a href="/crypto/x509/x509.go.html#4040603">KeyUsageCertSign</a></span>&nbsp;<span class="op" id="4050390">==</span>&nbsp;<span class="num" id="4050393">0</span>&nbsp;<span class="op" id="4050395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050399">return</span>&nbsp;<span class="ident" id="4050406"><a href="/crypto/x509/x509.go.html#4047062">ConstraintViolationError</a></span><span class="op" id="4050430">{</span><span class="op" id="4050431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050438">if</span>&nbsp;<span class="ident" id="4050441"><a href="/crypto/x509/x509.go.html#4049753">parent</a></span><span class="op" id="4050447">.</span><span class="ident" id="4050448">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4050467">==</span>&nbsp;<span class="ident" id="4050470"><a href="/crypto/x509/x509.go.html#4034052">UnknownPublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4050496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050500">return</span>&nbsp;<span class="ident" id="4050507"><a href="/crypto/x509/x509.go.html#4046774">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4050532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4050536">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050593">return</span>&nbsp;<span class="ident" id="4050600"><a href="/crypto/x509/x509.go.html#4049753">parent</a></span><span class="op" id="4050606">.</span><span class="ident" id="4050607">CheckSignature</span><span class="op" id="4050621">(</span><span class="ident" id="4050622"><a href="/crypto/x509/x509.go.html#4049718">c</a></span><span class="op" id="4050623">.</span><span class="ident" id="4050624">SignatureAlgorithm</span><span class="op" id="4050642">,</span>&nbsp;<span class="ident" id="4050644"><a href="/crypto/x509/x509.go.html#4049718">c</a></span><span class="op" id="4050645">.</span><span class="ident" id="4050646">RawTBSCertificate</span><span class="op" id="4050663">,</span>&nbsp;<span class="ident" id="4050665"><a href="/crypto/x509/x509.go.html#4049718">c</a></span><span class="op" id="4050666">.</span><span class="ident" id="4050667">Signature</span><span class="op" id="4050676">)</span><br>
<span class="lineno"></span><span class="op" id="4050678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4050681">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4050761">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4050780">func</span>&nbsp;<span class="op" id="4050785">(</span><span class="ident" id="4050786">c</span>&nbsp;<span class="op" id="4050788">*</span><span class="ident" id="4050789"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4050800">)</span>&nbsp;<span class="ident" id="4050802">CheckSignature</span><span class="op" id="4050816">(</span><span class="ident" id="4050817">algo</span>&nbsp;<span class="ident" id="4050822"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span><span class="op" id="4050840">,</span>&nbsp;<span class="ident" id="4050842">signed</span><span class="op" id="4050848">,</span>&nbsp;<span class="ident" id="4050850">signature</span>&nbsp;<span class="op" id="4050860">[</span><span class="op" id="4050861">]</span><span class="builtintype" id="4050862">byte</span><span class="op" id="4050866">)</span>&nbsp;<span class="op" id="4050868">(</span><span class="ident" id="4050869">err</span>&nbsp;<span class="builtintype" id="4050873">error</span><span class="op" id="4050878">)</span>&nbsp;<span class="op" id="4050880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050883">var</span>&nbsp;<span class="ident" id="4050887">hashType</span>&nbsp;<span class="ident" id="4050896"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4050902">.</span><span class="ident" id="4050903">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050910">switch</span>&nbsp;<span class="ident" id="4050917"><a href="/crypto/x509/x509.go.html#4050817">algo</a></span>&nbsp;<span class="op" id="4050922">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050925">case</span>&nbsp;<span class="ident" id="4050930"><a href="/crypto/x509/x509.go.html#4033860">SHA1WithRSA</a></span><span class="op" id="4050941">,</span>&nbsp;<span class="ident" id="4050943"><a href="/crypto/x509/x509.go.html#4033918">DSAWithSHA1</a></span><span class="op" id="4050954">,</span>&nbsp;<span class="ident" id="4050956"><a href="/crypto/x509/x509.go.html#4033946">ECDSAWithSHA1</a></span><span class="op" id="4050969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4050973"><a href="/crypto/x509/x509.go.html#4050887">hashType</a></span>&nbsp;<span class="op" id="4050982">=</span>&nbsp;<span class="ident" id="4050984"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4050990">.</span><span class="ident" id="4050991">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4050997">case</span>&nbsp;<span class="ident" id="4051002"><a href="/crypto/x509/x509.go.html#4033873">SHA256WithRSA</a></span><span class="op" id="4051015">,</span>&nbsp;<span class="ident" id="4051017"><a href="/crypto/x509/x509.go.html#4033931">DSAWithSHA256</a></span><span class="op" id="4051030">,</span>&nbsp;<span class="ident" id="4051032"><a href="/crypto/x509/x509.go.html#4033961">ECDSAWithSHA256</a></span><span class="op" id="4051047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051051"><a href="/crypto/x509/x509.go.html#4050887">hashType</a></span>&nbsp;<span class="op" id="4051060">=</span>&nbsp;<span class="ident" id="4051062"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4051068">.</span><span class="ident" id="4051069">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051077">case</span>&nbsp;<span class="ident" id="4051082"><a href="/crypto/x509/x509.go.html#4033888">SHA384WithRSA</a></span><span class="op" id="4051095">,</span>&nbsp;<span class="ident" id="4051097"><a href="/crypto/x509/x509.go.html#4033978">ECDSAWithSHA384</a></span><span class="op" id="4051112">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051116"><a href="/crypto/x509/x509.go.html#4050887">hashType</a></span>&nbsp;<span class="op" id="4051125">=</span>&nbsp;<span class="ident" id="4051127"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4051133">.</span><span class="ident" id="4051134">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051142">case</span>&nbsp;<span class="ident" id="4051147"><a href="/crypto/x509/x509.go.html#4033903">SHA512WithRSA</a></span><span class="op" id="4051160">,</span>&nbsp;<span class="ident" id="4051162"><a href="/crypto/x509/x509.go.html#4033995">ECDSAWithSHA512</a></span><span class="op" id="4051177">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051181"><a href="/crypto/x509/x509.go.html#4050887">hashType</a></span>&nbsp;<span class="op" id="4051190">=</span>&nbsp;<span class="ident" id="4051192"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4051198">.</span><span class="ident" id="4051199">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051207">default</span><span class="op" id="4051214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051218">return</span>&nbsp;<span class="ident" id="4051225"><a href="/crypto/x509/x509.go.html#4046774">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051254">if</span>&nbsp;<span class="op" id="4051257">!</span><span class="ident" id="4051258"><a href="/crypto/x509/x509.go.html#4050887">hashType</a></span><span class="op" id="4051266">.</span><span class="ident" id="4051267">Available</span><span class="op" id="4051276">(</span><span class="op" id="4051277">)</span>&nbsp;<span class="op" id="4051279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051283">return</span>&nbsp;<span class="ident" id="4051290"><a href="/crypto/x509/x509.go.html#4046774">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051315">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051318">h</span>&nbsp;<span class="op" id="4051320">:=</span>&nbsp;<span class="ident" id="4051323"><a href="/crypto/x509/x509.go.html#4050887">hashType</a></span><span class="op" id="4051331">.</span><span class="ident" id="4051332">New</span><span class="op" id="4051335">(</span><span class="op" id="4051336">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051340"><a href="/crypto/x509/x509.go.html#4051318">h</a></span><span class="op" id="4051341">.</span><span class="ident" id="4051342">Write</span><span class="op" id="4051347">(</span><span class="ident" id="4051348"><a href="/crypto/x509/x509.go.html#4050842">signed</a></span><span class="op" id="4051354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051357">digest</span>&nbsp;<span class="op" id="4051364">:=</span>&nbsp;<span class="ident" id="4051367"><a href="/crypto/x509/x509.go.html#4051318">h</a></span><span class="op" id="4051368">.</span><span class="ident" id="4051369">Sum</span><span class="op" id="4051372">(</span><span class="ident" id="4051373">nil</span><span class="op" id="4051376">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051380">switch</span>&nbsp;<span class="ident" id="4051387">pub</span>&nbsp;<span class="op" id="4051391">:=</span>&nbsp;<span class="ident" id="4051394"><a href="/crypto/x509/x509.go.html#4050786">c</a></span><span class="op" id="4051395">.</span><span class="ident" id="4051396">PublicKey</span><span class="op" id="4051405">.</span><span class="op" id="4051406">(</span><span class="keyword" id="4051407">type</span><span class="op" id="4051411">)</span>&nbsp;<span class="op" id="4051413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051416">case</span>&nbsp;<span class="op" id="4051421">*</span><span class="ident" id="4051422"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4051425">.</span><span class="ident" id="4051426">PublicKey</span><span class="op" id="4051435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051439">return</span>&nbsp;<span class="ident" id="4051446"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4051449">.</span><span class="ident" id="4051450">VerifyPKCS1v15</span><span class="op" id="4051464">(</span><span class="ident" id="4051465"><a href="/crypto/x509/x509.go.html#4051387">pub</a></span><span class="op" id="4051468">,</span>&nbsp;<span class="ident" id="4051470"><a href="/crypto/x509/x509.go.html#4050887">hashType</a></span><span class="op" id="4051478">,</span>&nbsp;<span class="ident" id="4051480"><a href="/crypto/x509/x509.go.html#4051357">digest</a></span><span class="op" id="4051486">,</span>&nbsp;<span class="ident" id="4051488"><a href="/crypto/x509/x509.go.html#4050850">signature</a></span><span class="op" id="4051497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051500">case</span>&nbsp;<span class="op" id="4051505">*</span><span class="ident" id="4051506"><a href="/crypto/x509/x509.go.html#4029971">dsa</a></span><span class="op" id="4051509">.</span><span class="ident" id="4051510">PublicKey</span><span class="op" id="4051519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051523">dsaSig</span>&nbsp;<span class="op" id="4051530">:=</span>&nbsp;<span class="builtinfunc" id="4051533">new</span><span class="op" id="4051536">(</span><span class="ident" id="4051537"><a href="/crypto/x509/x509.go.html#4033410">dsaSignature</a></span><span class="op" id="4051549">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051553">if</span>&nbsp;<span class="ident" id="4051556">_</span><span class="op" id="4051557">,</span>&nbsp;<span class="ident" id="4051559">err</span>&nbsp;<span class="op" id="4051563">:=</span>&nbsp;<span class="ident" id="4051566"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4051570">.</span><span class="ident" id="4051571">Unmarshal</span><span class="op" id="4051580">(</span><span class="ident" id="4051581"><a href="/crypto/x509/x509.go.html#4050850">signature</a></span><span class="op" id="4051590">,</span>&nbsp;<span class="ident" id="4051592"><a href="/crypto/x509/x509.go.html#4051523">dsaSig</a></span><span class="op" id="4051598">)</span><span class="op" id="4051599">;</span>&nbsp;<span class="ident" id="4051601"><a href="/crypto/x509/x509.go.html#4051559">err</a></span>&nbsp;<span class="op" id="4051605">!=</span>&nbsp;<span class="ident" id="4051608">nil</span>&nbsp;<span class="op" id="4051612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051617">return</span>&nbsp;<span class="ident" id="4051624"><a href="/crypto/x509/x509.go.html#4051559">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051634">if</span>&nbsp;<span class="ident" id="4051637"><a href="/crypto/x509/x509.go.html#4051523">dsaSig</a></span><span class="op" id="4051643">.</span><span class="ident" id="4051644">R</span><span class="op" id="4051645">.</span><span class="ident" id="4051646">Sign</span><span class="op" id="4051650">(</span><span class="op" id="4051651">)</span>&nbsp;<span class="op" id="4051653">&lt;=</span>&nbsp;<span class="num" id="4051656">0</span>&nbsp;<span class="op" id="4051658">||</span>&nbsp;<span class="ident" id="4051661"><a href="/crypto/x509/x509.go.html#4051523">dsaSig</a></span><span class="op" id="4051667">.</span><span class="ident" id="4051668">S</span><span class="op" id="4051669">.</span><span class="ident" id="4051670">Sign</span><span class="op" id="4051674">(</span><span class="op" id="4051675">)</span>&nbsp;<span class="op" id="4051677">&lt;=</span>&nbsp;<span class="num" id="4051680">0</span>&nbsp;<span class="op" id="4051682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051687">return</span>&nbsp;<span class="ident" id="4051694"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4051700">.</span><span class="ident" id="4051701">New</span><span class="op" id="4051704">(</span><span class="string" id="4051705">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4051760">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051768">if</span>&nbsp;<span class="op" id="4051771">!</span><span class="ident" id="4051772"><a href="/crypto/x509/x509.go.html#4029971">dsa</a></span><span class="op" id="4051775">.</span><span class="ident" id="4051776">Verify</span><span class="op" id="4051782">(</span><span class="ident" id="4051783"><a href="/crypto/x509/x509.go.html#4051387">pub</a></span><span class="op" id="4051786">,</span>&nbsp;<span class="ident" id="4051788"><a href="/crypto/x509/x509.go.html#4051357">digest</a></span><span class="op" id="4051794">,</span>&nbsp;<span class="ident" id="4051796"><a href="/crypto/x509/x509.go.html#4051523">dsaSig</a></span><span class="op" id="4051802">.</span><span class="ident" id="4051803">R</span><span class="op" id="4051804">,</span>&nbsp;<span class="ident" id="4051806"><a href="/crypto/x509/x509.go.html#4051523">dsaSig</a></span><span class="op" id="4051812">.</span><span class="ident" id="4051813">S</span><span class="op" id="4051814">)</span>&nbsp;<span class="op" id="4051816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051821">return</span>&nbsp;<span class="ident" id="4051828"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4051834">.</span><span class="ident" id="4051835">New</span><span class="op" id="4051838">(</span><span class="string" id="4051839">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4051871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4051875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051879">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051887">case</span>&nbsp;<span class="op" id="4051892">*</span><span class="ident" id="4051893"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4051898">.</span><span class="ident" id="4051899">PublicKey</span><span class="op" id="4051908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4051912">ecdsaSig</span>&nbsp;<span class="op" id="4051921">:=</span>&nbsp;<span class="builtinfunc" id="4051924">new</span><span class="op" id="4051927">(</span><span class="ident" id="4051928"><a href="/crypto/x509/x509.go.html#4033455">ecdsaSignature</a></span><span class="op" id="4051942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4051946">if</span>&nbsp;<span class="ident" id="4051949">_</span><span class="op" id="4051950">,</span>&nbsp;<span class="ident" id="4051952">err</span>&nbsp;<span class="op" id="4051956">:=</span>&nbsp;<span class="ident" id="4051959"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4051963">.</span><span class="ident" id="4051964">Unmarshal</span><span class="op" id="4051973">(</span><span class="ident" id="4051974"><a href="/crypto/x509/x509.go.html#4050850">signature</a></span><span class="op" id="4051983">,</span>&nbsp;<span class="ident" id="4051985"><a href="/crypto/x509/x509.go.html#4051912">ecdsaSig</a></span><span class="op" id="4051993">)</span><span class="op" id="4051994">;</span>&nbsp;<span class="ident" id="4051996"><a href="/crypto/x509/x509.go.html#4051952">err</a></span>&nbsp;<span class="op" id="4052000">!=</span>&nbsp;<span class="ident" id="4052003">nil</span>&nbsp;<span class="op" id="4052007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052012">return</span>&nbsp;<span class="ident" id="4052019"><a href="/crypto/x509/x509.go.html#4051952">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052025">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052029">if</span>&nbsp;<span class="ident" id="4052032"><a href="/crypto/x509/x509.go.html#4051912">ecdsaSig</a></span><span class="op" id="4052040">.</span><span class="ident" id="4052041">R</span><span class="op" id="4052042">.</span><span class="ident" id="4052043">Sign</span><span class="op" id="4052047">(</span><span class="op" id="4052048">)</span>&nbsp;<span class="op" id="4052050">&lt;=</span>&nbsp;<span class="num" id="4052053">0</span>&nbsp;<span class="op" id="4052055">||</span>&nbsp;<span class="ident" id="4052058"><a href="/crypto/x509/x509.go.html#4051912">ecdsaSig</a></span><span class="op" id="4052066">.</span><span class="ident" id="4052067">S</span><span class="op" id="4052068">.</span><span class="ident" id="4052069">Sign</span><span class="op" id="4052073">(</span><span class="op" id="4052074">)</span>&nbsp;<span class="op" id="4052076">&lt;=</span>&nbsp;<span class="num" id="4052079">0</span>&nbsp;<span class="op" id="4052081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052086">return</span>&nbsp;<span class="ident" id="4052093"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4052099">.</span><span class="ident" id="4052100">New</span><span class="op" id="4052103">(</span><span class="string" id="4052104">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4052161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052169">if</span>&nbsp;<span class="op" id="4052172">!</span><span class="ident" id="4052173"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4052178">.</span><span class="ident" id="4052179">Verify</span><span class="op" id="4052185">(</span><span class="ident" id="4052186"><a href="/crypto/x509/x509.go.html#4051387">pub</a></span><span class="op" id="4052189">,</span>&nbsp;<span class="ident" id="4052191"><a href="/crypto/x509/x509.go.html#4051357">digest</a></span><span class="op" id="4052197">,</span>&nbsp;<span class="ident" id="4052199"><a href="/crypto/x509/x509.go.html#4051912">ecdsaSig</a></span><span class="op" id="4052207">.</span><span class="ident" id="4052208">R</span><span class="op" id="4052209">,</span>&nbsp;<span class="ident" id="4052211"><a href="/crypto/x509/x509.go.html#4051912">ecdsaSig</a></span><span class="op" id="4052219">.</span><span class="ident" id="4052220">S</span><span class="op" id="4052221">)</span>&nbsp;<span class="op" id="4052223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052228">return</span>&nbsp;<span class="ident" id="4052235"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4052241">.</span><span class="ident" id="4052242">New</span><span class="op" id="4052245">(</span><span class="string" id="4052246">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4052280">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052288">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052299">return</span>&nbsp;<span class="ident" id="4052306"><a href="/crypto/x509/x509.go.html#4046774">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span><span class="op" id="4052330">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4052333">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4052398">func</span>&nbsp;<span class="op" id="4052403">(</span><span class="ident" id="4052404">c</span>&nbsp;<span class="op" id="4052406">*</span><span class="ident" id="4052407"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4052418">)</span>&nbsp;<span class="ident" id="4052420">CheckCRLSignature</span><span class="op" id="4052437">(</span><span class="ident" id="4052438">crl</span>&nbsp;<span class="op" id="4052442">*</span><span class="ident" id="4052443"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4052447">.</span><span class="ident" id="4052448">CertificateList</span><span class="op" id="4052463">)</span>&nbsp;<span class="op" id="4052465">(</span><span class="ident" id="4052466">err</span>&nbsp;<span class="builtintype" id="4052470">error</span><span class="op" id="4052475">)</span>&nbsp;<span class="op" id="4052477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052480">algo</span>&nbsp;<span class="op" id="4052485">:=</span>&nbsp;<span class="ident" id="4052488"><a href="/crypto/x509/x509.go.html#4037639">getSignatureAlgorithmFromOID</a></span><span class="op" id="4052516">(</span><span class="ident" id="4052517"><a href="/crypto/x509/x509.go.html#4052438">crl</a></span><span class="op" id="4052520">.</span><span class="ident" id="4052521">SignatureAlgorithm</span><span class="op" id="4052539">.</span><span class="ident" id="4052540">Algorithm</span><span class="op" id="4052549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052552">return</span>&nbsp;<span class="ident" id="4052559"><a href="/crypto/x509/x509.go.html#4052404">c</a></span><span class="op" id="4052560">.</span><span class="ident" id="4052561">CheckSignature</span><span class="op" id="4052575">(</span><span class="ident" id="4052576"><a href="/crypto/x509/x509.go.html#4052480">algo</a></span><span class="op" id="4052580">,</span>&nbsp;<span class="ident" id="4052582"><a href="/crypto/x509/x509.go.html#4052438">crl</a></span><span class="op" id="4052585">.</span><span class="ident" id="4052586">TBSCertList</span><span class="op" id="4052597">.</span><span class="ident" id="4052598">Raw</span><span class="op" id="4052601">,</span>&nbsp;<span class="ident" id="4052603"><a href="/crypto/x509/x509.go.html#4052438">crl</a></span><span class="op" id="4052606">.</span><span class="ident" id="4052607">SignatureValue</span><span class="op" id="4052621">.</span><span class="ident" id="4052622">RightAlign</span><span class="op" id="4052632">(</span><span class="op" id="4052633">)</span><span class="op" id="4052634">)</span><br>
<span class="lineno">680</span><span class="op" id="4052636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4052639">type</span>&nbsp;<span class="ident" id="4052644">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4052671">struct</span><span class="op" id="4052677">{</span><span class="op" id="4052678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4052681">func</span>&nbsp;<span class="op" id="4052686">(</span><span class="ident" id="4052687">h</span>&nbsp;<span class="ident" id="4052689"><a href="/crypto/x509/x509.go.html#4052644">UnhandledCriticalExtension</a></span><span class="op" id="4052715">)</span>&nbsp;<span class="ident" id="4052717">Error</span><span class="op" id="4052722">(</span><span class="op" id="4052723">)</span>&nbsp;<span class="builtintype" id="4052725">string</span>&nbsp;<span class="op" id="4052732">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052735">return</span>&nbsp;<span class="string" id="4052742">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4052779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4052782">type</span>&nbsp;<span class="ident" id="4052787">basicConstraints</span>&nbsp;<span class="keyword" id="4052804">struct</span>&nbsp;<span class="op" id="4052811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052814">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4052825">bool</span>&nbsp;<span class="string" id="4052830">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052849">MaxPathLen</span>&nbsp;<span class="builtintype" id="4052860">int</span>&nbsp;&nbsp;<span class="string" id="4052865">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4052894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4052897">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4052917">type</span>&nbsp;<span class="ident" id="4052922">policyInformation</span>&nbsp;<span class="keyword" id="4052940">struct</span>&nbsp;<span class="op" id="4052947">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052950">Policy</span>&nbsp;<span class="ident" id="4052957"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4052961">.</span><span class="ident" id="4052962">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4052980">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4053008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4053011">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4053033">type</span>&nbsp;<span class="ident" id="4053038">nameConstraints</span>&nbsp;<span class="keyword" id="4053054">struct</span>&nbsp;<span class="op" id="4053061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053064">Permitted</span>&nbsp;<span class="op" id="4053074">[</span><span class="op" id="4053075">]</span><span class="ident" id="4053076"><a href="/crypto/x509/x509.go.html#4053175">generalSubtree</a></span>&nbsp;<span class="string" id="4053091">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053116">Excluded</span>&nbsp;&nbsp;<span class="op" id="4053126">[</span><span class="op" id="4053127">]</span><span class="ident" id="4053128"><a href="/crypto/x509/x509.go.html#4053175">generalSubtree</a></span>&nbsp;<span class="string" id="4053143">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4053167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4053170">type</span>&nbsp;<span class="ident" id="4053175">generalSubtree</span>&nbsp;<span class="keyword" id="4053190">struct</span>&nbsp;<span class="op" id="4053197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053200">Name</span>&nbsp;<span class="builtintype" id="4053205">string</span>&nbsp;<span class="string" id="4053212">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4053240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4053243">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4053264">type</span>&nbsp;<span class="ident" id="4053269">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4053289">struct</span>&nbsp;<span class="op" id="4053296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053299">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4053308"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4053312">.</span><span class="ident" id="4053313">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053331">Location</span>&nbsp;<span class="ident" id="4053340"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4053344">.</span><span class="ident" id="4053345">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4053354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4053357">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4053379">type</span>&nbsp;<span class="ident" id="4053384">distributionPoint</span>&nbsp;<span class="keyword" id="4053402">struct</span>&nbsp;<span class="op" id="4053409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053412">DistributionPoint</span>&nbsp;<span class="ident" id="4053430"><a href="/crypto/x509/x509.go.html#4053614">distributionPointName</a></span>&nbsp;<span class="string" id="4053452">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053477">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053495"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4053499">.</span><span class="ident" id="4053500">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4053517">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053542">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053560"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4053564">.</span><span class="ident" id="4053565">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4053582">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4053606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4053609">type</span>&nbsp;<span class="ident" id="4053614">distributionPointName</span>&nbsp;<span class="keyword" id="4053636">struct</span>&nbsp;<span class="op" id="4053643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053646">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053659"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4053663">.</span><span class="ident" id="4053664">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4053676">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053701">RelativeName</span>&nbsp;<span class="ident" id="4053714"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4053718">.</span><span class="ident" id="4053719">RDNSequence</span>&nbsp;<span class="string" id="4053731">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4053755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4053758">func</span>&nbsp;<span class="ident" id="4053763">parsePublicKey</span><span class="op" id="4053777">(</span><span class="ident" id="4053778">algo</span>&nbsp;<span class="ident" id="4053783"><a href="/crypto/x509/x509.go.html#4034019">PublicKeyAlgorithm</a></span><span class="op" id="4053801">,</span>&nbsp;<span class="ident" id="4053803">keyData</span>&nbsp;<span class="op" id="4053811">*</span><span class="ident" id="4053812"><a href="/crypto/x509/x509.go.html#4033546">publicKeyInfo</a></span><span class="op" id="4053825">)</span>&nbsp;<span class="op" id="4053827">(</span><span class="keyword" id="4053828">interface</span><span class="op" id="4053837">{</span><span class="op" id="4053838">}</span><span class="op" id="4053839">,</span>&nbsp;<span class="builtintype" id="4053841">error</span><span class="op" id="4053846">)</span>&nbsp;<span class="op" id="4053848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053851">asn1Data</span>&nbsp;<span class="op" id="4053860">:=</span>&nbsp;<span class="ident" id="4053863"><a href="/crypto/x509/x509.go.html#4053803">keyData</a></span><span class="op" id="4053870">.</span><span class="ident" id="4053871">PublicKey</span><span class="op" id="4053880">.</span><span class="ident" id="4053881">RightAlign</span><span class="op" id="4053891">(</span><span class="op" id="4053892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4053895">switch</span>&nbsp;<span class="ident" id="4053902"><a href="/crypto/x509/x509.go.html#4053778">algo</a></span>&nbsp;<span class="op" id="4053907">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4053910">case</span>&nbsp;<span class="ident" id="4053915"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><span class="op" id="4053918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053922">p</span>&nbsp;<span class="op" id="4053924">:=</span>&nbsp;<span class="builtinfunc" id="4053927">new</span><span class="op" id="4053930">(</span><span class="ident" id="4053931"><a href="/crypto/x509/pkcs1.go.html#4009635">rsaPublicKey</a></span><span class="op" id="4053943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053947">_</span><span class="op" id="4053948">,</span>&nbsp;<span class="ident" id="4053950">err</span>&nbsp;<span class="op" id="4053954">:=</span>&nbsp;<span class="ident" id="4053957"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4053961">.</span><span class="ident" id="4053962">Unmarshal</span><span class="op" id="4053971">(</span><span class="ident" id="4053972"><a href="/crypto/x509/x509.go.html#4053851">asn1Data</a></span><span class="op" id="4053980">,</span>&nbsp;<span class="ident" id="4053982"><a href="/crypto/x509/x509.go.html#4053922">p</a></span><span class="op" id="4053983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4053987">if</span>&nbsp;<span class="ident" id="4053990"><a href="/crypto/x509/x509.go.html#4053950">err</a></span>&nbsp;<span class="op" id="4053994">!=</span>&nbsp;<span class="ident" id="4053997">nil</span>&nbsp;<span class="op" id="4054001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054006">return</span>&nbsp;<span class="ident" id="4054013">nil</span><span class="op" id="4054016">,</span>&nbsp;<span class="ident" id="4054018"><a href="/crypto/x509/x509.go.html#4053950">err</a></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054029">if</span>&nbsp;<span class="ident" id="4054032"><a href="/crypto/x509/x509.go.html#4053922">p</a></span><span class="op" id="4054033">.</span><span class="ident" id="4054034">N</span><span class="op" id="4054035">.</span><span class="ident" id="4054036">Sign</span><span class="op" id="4054040">(</span><span class="op" id="4054041">)</span>&nbsp;<span class="op" id="4054043">&lt;=</span>&nbsp;<span class="num" id="4054046">0</span>&nbsp;<span class="op" id="4054048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054053">return</span>&nbsp;<span class="ident" id="4054060">nil</span><span class="op" id="4054063">,</span>&nbsp;<span class="ident" id="4054065"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4054071">.</span><span class="ident" id="4054072">New</span><span class="op" id="4054075">(</span><span class="string" id="4054076">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4054120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054124">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054128">if</span>&nbsp;<span class="ident" id="4054131"><a href="/crypto/x509/x509.go.html#4053922">p</a></span><span class="op" id="4054132">.</span><span class="ident" id="4054133">E</span>&nbsp;<span class="op" id="4054135">&lt;=</span>&nbsp;<span class="num" id="4054138">0</span>&nbsp;<span class="op" id="4054140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054145">return</span>&nbsp;<span class="ident" id="4054152">nil</span><span class="op" id="4054155">,</span>&nbsp;<span class="ident" id="4054157"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4054163">.</span><span class="ident" id="4054164">New</span><span class="op" id="4054167">(</span><span class="string" id="4054168">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4054220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054229">pub</span>&nbsp;<span class="op" id="4054233">:=</span>&nbsp;<span class="op" id="4054236">&amp;</span><span class="ident" id="4054237"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4054240">.</span><span class="ident" id="4054241">PublicKey</span><span class="op" id="4054250">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054255">E</span><span class="op" id="4054256">:</span>&nbsp;<span class="ident" id="4054258"><a href="/crypto/x509/x509.go.html#4053922">p</a></span><span class="op" id="4054259">.</span><span class="ident" id="4054260">E</span><span class="op" id="4054261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054266">N</span><span class="op" id="4054267">:</span>&nbsp;<span class="ident" id="4054269"><a href="/crypto/x509/x509.go.html#4053922">p</a></span><span class="op" id="4054270">.</span><span class="ident" id="4054271">N</span><span class="op" id="4054272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054280">return</span>&nbsp;<span class="ident" id="4054287"><a href="/crypto/x509/x509.go.html#4054229">pub</a></span><span class="op" id="4054290">,</span>&nbsp;<span class="ident" id="4054292">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054297">case</span>&nbsp;<span class="ident" id="4054302"><a href="/crypto/x509/x509.go.html#4034110">DSA</a></span><span class="op" id="4054305">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054309">var</span>&nbsp;<span class="ident" id="4054313">p</span>&nbsp;<span class="op" id="4054315">*</span><span class="ident" id="4054316"><a href="/crypto/x509/x509.go.html#4030156">big</a></span><span class="op" id="4054319">.</span><span class="ident" id="4054320">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054326">_</span><span class="op" id="4054327">,</span>&nbsp;<span class="ident" id="4054329">err</span>&nbsp;<span class="op" id="4054333">:=</span>&nbsp;<span class="ident" id="4054336"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4054340">.</span><span class="ident" id="4054341">Unmarshal</span><span class="op" id="4054350">(</span><span class="ident" id="4054351"><a href="/crypto/x509/x509.go.html#4053851">asn1Data</a></span><span class="op" id="4054359">,</span>&nbsp;<span class="op" id="4054361">&amp;</span><span class="ident" id="4054362"><a href="/crypto/x509/x509.go.html#4054313">p</a></span><span class="op" id="4054363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054367">if</span>&nbsp;<span class="ident" id="4054370"><a href="/crypto/x509/x509.go.html#4054329">err</a></span>&nbsp;<span class="op" id="4054374">!=</span>&nbsp;<span class="ident" id="4054377">nil</span>&nbsp;<span class="op" id="4054381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054386">return</span>&nbsp;<span class="ident" id="4054393">nil</span><span class="op" id="4054396">,</span>&nbsp;<span class="ident" id="4054398"><a href="/crypto/x509/x509.go.html#4054329">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054404">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054408">paramsData</span>&nbsp;<span class="op" id="4054419">:=</span>&nbsp;<span class="ident" id="4054422"><a href="/crypto/x509/x509.go.html#4053803">keyData</a></span><span class="op" id="4054429">.</span><span class="ident" id="4054430">Algorithm</span><span class="op" id="4054439">.</span><span class="ident" id="4054440">Parameters</span><span class="op" id="4054450">.</span><span class="ident" id="4054451">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054463">params</span>&nbsp;<span class="op" id="4054470">:=</span>&nbsp;<span class="builtinfunc" id="4054473">new</span><span class="op" id="4054476">(</span><span class="ident" id="4054477"><a href="/crypto/x509/x509.go.html#4033352">dsaAlgorithmParameters</a></span><span class="op" id="4054499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054503">_</span><span class="op" id="4054504">,</span>&nbsp;<span class="ident" id="4054506"><a href="/crypto/x509/x509.go.html#4054329">err</a></span>&nbsp;<span class="op" id="4054510">=</span>&nbsp;<span class="ident" id="4054512"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4054516">.</span><span class="ident" id="4054517">Unmarshal</span><span class="op" id="4054526">(</span><span class="ident" id="4054527"><a href="/crypto/x509/x509.go.html#4054408">paramsData</a></span><span class="op" id="4054537">,</span>&nbsp;<span class="ident" id="4054539"><a href="/crypto/x509/x509.go.html#4054463">params</a></span><span class="op" id="4054545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054549">if</span>&nbsp;<span class="ident" id="4054552"><a href="/crypto/x509/x509.go.html#4054329">err</a></span>&nbsp;<span class="op" id="4054556">!=</span>&nbsp;<span class="ident" id="4054559">nil</span>&nbsp;<span class="op" id="4054563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054568">return</span>&nbsp;<span class="ident" id="4054575">nil</span><span class="op" id="4054578">,</span>&nbsp;<span class="ident" id="4054580"><a href="/crypto/x509/x509.go.html#4054329">err</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054590">if</span>&nbsp;<span class="ident" id="4054593"><a href="/crypto/x509/x509.go.html#4054313">p</a></span><span class="op" id="4054594">.</span><span class="ident" id="4054595">Sign</span><span class="op" id="4054599">(</span><span class="op" id="4054600">)</span>&nbsp;<span class="op" id="4054602">&lt;=</span>&nbsp;<span class="num" id="4054605">0</span>&nbsp;<span class="op" id="4054607">||</span>&nbsp;<span class="ident" id="4054610"><a href="/crypto/x509/x509.go.html#4054463">params</a></span><span class="op" id="4054616">.</span><span class="ident" id="4054617">P</span><span class="op" id="4054618">.</span><span class="ident" id="4054619">Sign</span><span class="op" id="4054623">(</span><span class="op" id="4054624">)</span>&nbsp;<span class="op" id="4054626">&lt;=</span>&nbsp;<span class="num" id="4054629">0</span>&nbsp;<span class="op" id="4054631">||</span>&nbsp;<span class="ident" id="4054634"><a href="/crypto/x509/x509.go.html#4054463">params</a></span><span class="op" id="4054640">.</span><span class="ident" id="4054641">Q</span><span class="op" id="4054642">.</span><span class="ident" id="4054643">Sign</span><span class="op" id="4054647">(</span><span class="op" id="4054648">)</span>&nbsp;<span class="op" id="4054650">&lt;=</span>&nbsp;<span class="num" id="4054653">0</span>&nbsp;<span class="op" id="4054655">||</span>&nbsp;<span class="ident" id="4054658"><a href="/crypto/x509/x509.go.html#4054463">params</a></span><span class="op" id="4054664">.</span><span class="ident" id="4054665">G</span><span class="op" id="4054666">.</span><span class="ident" id="4054667">Sign</span><span class="op" id="4054671">(</span><span class="op" id="4054672">)</span>&nbsp;<span class="op" id="4054674">&lt;=</span>&nbsp;<span class="num" id="4054677">0</span>&nbsp;<span class="op" id="4054679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054684">return</span>&nbsp;<span class="ident" id="4054691">nil</span><span class="op" id="4054694">,</span>&nbsp;<span class="ident" id="4054696"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4054702">.</span><span class="ident" id="4054703">New</span><span class="op" id="4054706">(</span><span class="string" id="4054707">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4054745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054753">pub</span>&nbsp;<span class="op" id="4054757">:=</span>&nbsp;<span class="op" id="4054760">&amp;</span><span class="ident" id="4054761"><a href="/crypto/x509/x509.go.html#4029971">dsa</a></span><span class="op" id="4054764">.</span><span class="ident" id="4054765">PublicKey</span><span class="op" id="4054774">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054779">Parameters</span><span class="op" id="4054789">:</span>&nbsp;<span class="ident" id="4054791"><a href="/crypto/x509/x509.go.html#4029971">dsa</a></span><span class="op" id="4054794">.</span><span class="ident" id="4054795">Parameters</span><span class="op" id="4054805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054811">P</span><span class="op" id="4054812">:</span>&nbsp;<span class="ident" id="4054814"><a href="/crypto/x509/x509.go.html#4054463">params</a></span><span class="op" id="4054820">.</span><span class="ident" id="4054821">P</span><span class="op" id="4054822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054828">Q</span><span class="op" id="4054829">:</span>&nbsp;<span class="ident" id="4054831"><a href="/crypto/x509/x509.go.html#4054463">params</a></span><span class="op" id="4054837">.</span><span class="ident" id="4054838">Q</span><span class="op" id="4054839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054845">G</span><span class="op" id="4054846">:</span>&nbsp;<span class="ident" id="4054848"><a href="/crypto/x509/x509.go.html#4054463">params</a></span><span class="op" id="4054854">.</span><span class="ident" id="4054855">G</span><span class="op" id="4054856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054861">}</span><span class="op" id="4054862">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054867">Y</span><span class="op" id="4054868">:</span>&nbsp;<span class="ident" id="4054870"><a href="/crypto/x509/x509.go.html#4054313">p</a></span><span class="op" id="4054871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054879">return</span>&nbsp;<span class="ident" id="4054886"><a href="/crypto/x509/x509.go.html#4054753">pub</a></span><span class="op" id="4054889">,</span>&nbsp;<span class="ident" id="4054891">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054896">case</span>&nbsp;<span class="ident" id="4054901"><a href="/crypto/x509/x509.go.html#4034115">ECDSA</a></span><span class="op" id="4054906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054910">paramsData</span>&nbsp;<span class="op" id="4054921">:=</span>&nbsp;<span class="ident" id="4054924"><a href="/crypto/x509/x509.go.html#4053803">keyData</a></span><span class="op" id="4054931">.</span><span class="ident" id="4054932">Algorithm</span><span class="op" id="4054941">.</span><span class="ident" id="4054942">Parameters</span><span class="op" id="4054952">.</span><span class="ident" id="4054953">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054965">namedCurveOID</span>&nbsp;<span class="op" id="4054979">:=</span>&nbsp;<span class="builtinfunc" id="4054982">new</span><span class="op" id="4054985">(</span><span class="ident" id="4054986"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4054990">.</span><span class="ident" id="4054991">ObjectIdentifier</span><span class="op" id="4055007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055011">_</span><span class="op" id="4055012">,</span>&nbsp;<span class="ident" id="4055014">err</span>&nbsp;<span class="op" id="4055018">:=</span>&nbsp;<span class="ident" id="4055021"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4055025">.</span><span class="ident" id="4055026">Unmarshal</span><span class="op" id="4055035">(</span><span class="ident" id="4055036"><a href="/crypto/x509/x509.go.html#4054910">paramsData</a></span><span class="op" id="4055046">,</span>&nbsp;<span class="ident" id="4055048"><a href="/crypto/x509/x509.go.html#4054965">namedCurveOID</a></span><span class="op" id="4055061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055065">if</span>&nbsp;<span class="ident" id="4055068"><a href="/crypto/x509/x509.go.html#4055014">err</a></span>&nbsp;<span class="op" id="4055072">!=</span>&nbsp;<span class="ident" id="4055075">nil</span>&nbsp;<span class="op" id="4055079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055084">return</span>&nbsp;<span class="ident" id="4055091">nil</span><span class="op" id="4055094">,</span>&nbsp;<span class="ident" id="4055096"><a href="/crypto/x509/x509.go.html#4055014">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055102">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055106">namedCurve</span>&nbsp;<span class="op" id="4055117">:=</span>&nbsp;<span class="ident" id="4055120"><a href="/crypto/x509/x509.go.html#4039632">namedCurveFromOID</a></span><span class="op" id="4055137">(</span><span class="op" id="4055138">*</span><span class="ident" id="4055139"><a href="/crypto/x509/x509.go.html#4054965">namedCurveOID</a></span><span class="op" id="4055152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055156">if</span>&nbsp;<span class="ident" id="4055159"><a href="/crypto/x509/x509.go.html#4055106">namedCurve</a></span>&nbsp;<span class="op" id="4055170">==</span>&nbsp;<span class="ident" id="4055173">nil</span>&nbsp;<span class="op" id="4055177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055182">return</span>&nbsp;<span class="ident" id="4055189">nil</span><span class="op" id="4055192">,</span>&nbsp;<span class="ident" id="4055194"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4055200">.</span><span class="ident" id="4055201">New</span><span class="op" id="4055204">(</span><span class="string" id="4055205">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4055239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055247">x</span><span class="op" id="4055248">,</span>&nbsp;<span class="ident" id="4055250">y</span>&nbsp;<span class="op" id="4055252">:=</span>&nbsp;<span class="ident" id="4055255"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4055263">.</span><span class="ident" id="4055264">Unmarshal</span><span class="op" id="4055273">(</span><span class="ident" id="4055274"><a href="/crypto/x509/x509.go.html#4055106">namedCurve</a></span><span class="op" id="4055284">,</span>&nbsp;<span class="ident" id="4055286"><a href="/crypto/x509/x509.go.html#4053851">asn1Data</a></span><span class="op" id="4055294">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055298">if</span>&nbsp;<span class="ident" id="4055301"><a href="/crypto/x509/x509.go.html#4055247">x</a></span>&nbsp;<span class="op" id="4055303">==</span>&nbsp;<span class="ident" id="4055306">nil</span>&nbsp;<span class="op" id="4055310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055315">return</span>&nbsp;<span class="ident" id="4055322">nil</span><span class="op" id="4055325">,</span>&nbsp;<span class="ident" id="4055327"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4055333">.</span><span class="ident" id="4055334">New</span><span class="op" id="4055337">(</span><span class="string" id="4055338">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4055386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055394">pub</span>&nbsp;<span class="op" id="4055398">:=</span>&nbsp;<span class="op" id="4055401">&amp;</span><span class="ident" id="4055402"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4055407">.</span><span class="ident" id="4055408">PublicKey</span><span class="op" id="4055417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055422">Curve</span><span class="op" id="4055427">:</span>&nbsp;<span class="ident" id="4055429"><a href="/crypto/x509/x509.go.html#4055106">namedCurve</a></span><span class="op" id="4055439">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055444">X</span><span class="op" id="4055445">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055451"><a href="/crypto/x509/x509.go.html#4055247">x</a></span><span class="op" id="4055452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055457">Y</span><span class="op" id="4055458">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055464"><a href="/crypto/x509/x509.go.html#4055250">y</a></span><span class="op" id="4055465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055473">return</span>&nbsp;<span class="ident" id="4055480"><a href="/crypto/x509/x509.go.html#4055394">pub</a></span><span class="op" id="4055483">,</span>&nbsp;<span class="ident" id="4055485">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055490">default</span><span class="op" id="4055497">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055501">return</span>&nbsp;<span class="ident" id="4055508">nil</span><span class="op" id="4055511">,</span>&nbsp;<span class="ident" id="4055513">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055518">}</span><br>
<span class="lineno"></span><span class="op" id="4055520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4055523">func</span>&nbsp;<span class="ident" id="4055528">parseSANExtension</span><span class="op" id="4055545">(</span><span class="ident" id="4055546">value</span>&nbsp;<span class="op" id="4055552">[</span><span class="op" id="4055553">]</span><span class="builtintype" id="4055554">byte</span><span class="op" id="4055558">)</span>&nbsp;<span class="op" id="4055560">(</span><span class="ident" id="4055561">dnsNames</span><span class="op" id="4055569">,</span>&nbsp;<span class="ident" id="4055571">emailAddresses</span>&nbsp;<span class="op" id="4055586">[</span><span class="op" id="4055587">]</span><span class="builtintype" id="4055588">string</span><span class="op" id="4055594">,</span>&nbsp;<span class="ident" id="4055596">ipAddresses</span>&nbsp;<span class="op" id="4055608">[</span><span class="op" id="4055609">]</span><span class="ident" id="4055610"><a href="/crypto/x509/x509.go.html#4030168">net</a></span><span class="op" id="4055613">.</span><span class="ident" id="4055614">IP</span><span class="op" id="4055616">,</span>&nbsp;<span class="ident" id="4055618">err</span>&nbsp;<span class="builtintype" id="4055622">error</span><span class="op" id="4055627">)</span>&nbsp;<span class="op" id="4055629">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055632">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055655">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055691">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055695">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055754">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055758">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055787">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055907">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055967">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4056027">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4056082">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4056145">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4056205">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4056268">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056337">var</span>&nbsp;<span class="ident" id="4056341">seq</span>&nbsp;<span class="ident" id="4056345"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4056349">.</span><span class="ident" id="4056350">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056360">if</span>&nbsp;<span class="ident" id="4056363">_</span><span class="op" id="4056364">,</span>&nbsp;<span class="ident" id="4056366"><a href="/crypto/x509/x509.go.html#4055618">err</a></span>&nbsp;<span class="op" id="4056370">=</span>&nbsp;<span class="ident" id="4056372"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4056376">.</span><span class="ident" id="4056377">Unmarshal</span><span class="op" id="4056386">(</span><span class="ident" id="4056387"><a href="/crypto/x509/x509.go.html#4055546">value</a></span><span class="op" id="4056392">,</span>&nbsp;<span class="op" id="4056394">&amp;</span><span class="ident" id="4056395"><a href="/crypto/x509/x509.go.html#4056341">seq</a></span><span class="op" id="4056398">)</span><span class="op" id="4056399">;</span>&nbsp;<span class="ident" id="4056401"><a href="/crypto/x509/x509.go.html#4055618">err</a></span>&nbsp;<span class="op" id="4056405">!=</span>&nbsp;<span class="ident" id="4056408">nil</span>&nbsp;<span class="op" id="4056412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056416">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056424">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056427">if</span>&nbsp;<span class="op" id="4056430">!</span><span class="ident" id="4056431"><a href="/crypto/x509/x509.go.html#4056341">seq</a></span><span class="op" id="4056434">.</span><span class="ident" id="4056435">IsCompound</span>&nbsp;<span class="op" id="4056446">||</span>&nbsp;<span class="ident" id="4056449"><a href="/crypto/x509/x509.go.html#4056341">seq</a></span><span class="op" id="4056452">.</span><span class="ident" id="4056453">Tag</span>&nbsp;<span class="op" id="4056457">!=</span>&nbsp;<span class="num" id="4056460">16</span>&nbsp;<span class="op" id="4056463">||</span>&nbsp;<span class="ident" id="4056466"><a href="/crypto/x509/x509.go.html#4056341">seq</a></span><span class="op" id="4056469">.</span><span class="ident" id="4056470">Class</span>&nbsp;<span class="op" id="4056476">!=</span>&nbsp;<span class="num" id="4056479">0</span>&nbsp;<span class="op" id="4056481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056485"><a href="/crypto/x509/x509.go.html#4055618">err</a></span>&nbsp;<span class="op" id="4056489">=</span>&nbsp;<span class="ident" id="4056491"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4056495">.</span><span class="ident" id="4056496">StructuralError</span><span class="op" id="4056511">{</span><span class="ident" id="4056512">Msg</span><span class="op" id="4056515">:</span>&nbsp;<span class="string" id="4056517">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4056535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056539">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056551">rest</span>&nbsp;<span class="op" id="4056556">:=</span>&nbsp;<span class="ident" id="4056559"><a href="/crypto/x509/x509.go.html#4056341">seq</a></span><span class="op" id="4056562">.</span><span class="ident" id="4056563">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056570">for</span>&nbsp;<span class="builtinfunc" id="4056574">len</span><span class="op" id="4056577">(</span><span class="ident" id="4056578"><a href="/crypto/x509/x509.go.html#4056551">rest</a></span><span class="op" id="4056582">)</span>&nbsp;<span class="op" id="4056584">&gt;</span>&nbsp;<span class="num" id="4056586">0</span>&nbsp;<span class="op" id="4056588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056592">var</span>&nbsp;<span class="ident" id="4056596">v</span>&nbsp;<span class="ident" id="4056598"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4056602">.</span><span class="ident" id="4056603">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056614"><a href="/crypto/x509/x509.go.html#4056551">rest</a></span><span class="op" id="4056618">,</span>&nbsp;<span class="ident" id="4056620"><a href="/crypto/x509/x509.go.html#4055618">err</a></span>&nbsp;<span class="op" id="4056624">=</span>&nbsp;<span class="ident" id="4056626"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4056630">.</span><span class="ident" id="4056631">Unmarshal</span><span class="op" id="4056640">(</span><span class="ident" id="4056641"><a href="/crypto/x509/x509.go.html#4056551">rest</a></span><span class="op" id="4056645">,</span>&nbsp;<span class="op" id="4056647">&amp;</span><span class="ident" id="4056648"><a href="/crypto/x509/x509.go.html#4056596">v</a></span><span class="op" id="4056649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056653">if</span>&nbsp;<span class="ident" id="4056656"><a href="/crypto/x509/x509.go.html#4055618">err</a></span>&nbsp;<span class="op" id="4056660">!=</span>&nbsp;<span class="ident" id="4056663">nil</span>&nbsp;<span class="op" id="4056667">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056672">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056685">switch</span>&nbsp;<span class="ident" id="4056692"><a href="/crypto/x509/x509.go.html#4056596">v</a></span><span class="op" id="4056693">.</span><span class="ident" id="4056694">Tag</span>&nbsp;<span class="op" id="4056698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056702">case</span>&nbsp;<span class="num" id="4056707">1</span><span class="op" id="4056708">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056713"><a href="/crypto/x509/x509.go.html#4055571">emailAddresses</a></span>&nbsp;<span class="op" id="4056728">=</span>&nbsp;<span class="builtinfunc" id="4056730">append</span><span class="op" id="4056736">(</span><span class="ident" id="4056737"><a href="/crypto/x509/x509.go.html#4055571">emailAddresses</a></span><span class="op" id="4056751">,</span>&nbsp;<span class="builtintype" id="4056753">string</span><span class="op" id="4056759">(</span><span class="ident" id="4056760"><a href="/crypto/x509/x509.go.html#4056596">v</a></span><span class="op" id="4056761">.</span><span class="ident" id="4056762">Bytes</span><span class="op" id="4056767">)</span><span class="op" id="4056768">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056772">case</span>&nbsp;<span class="num" id="4056777">2</span><span class="op" id="4056778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056783"><a href="/crypto/x509/x509.go.html#4055561">dnsNames</a></span>&nbsp;<span class="op" id="4056792">=</span>&nbsp;<span class="builtinfunc" id="4056794">append</span><span class="op" id="4056800">(</span><span class="ident" id="4056801"><a href="/crypto/x509/x509.go.html#4055561">dnsNames</a></span><span class="op" id="4056809">,</span>&nbsp;<span class="builtintype" id="4056811">string</span><span class="op" id="4056817">(</span><span class="ident" id="4056818"><a href="/crypto/x509/x509.go.html#4056596">v</a></span><span class="op" id="4056819">.</span><span class="ident" id="4056820">Bytes</span><span class="op" id="4056825">)</span><span class="op" id="4056826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056830">case</span>&nbsp;<span class="num" id="4056835">7</span><span class="op" id="4056836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056841">switch</span>&nbsp;<span class="builtinfunc" id="4056848">len</span><span class="op" id="4056851">(</span><span class="ident" id="4056852"><a href="/crypto/x509/x509.go.html#4056596">v</a></span><span class="op" id="4056853">.</span><span class="ident" id="4056854">Bytes</span><span class="op" id="4056859">)</span>&nbsp;<span class="op" id="4056861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056866">case</span>&nbsp;<span class="ident" id="4056871"><a href="/crypto/x509/x509.go.html#4030168">net</a></span><span class="op" id="4056874">.</span><span class="ident" id="4056875">IPv4len</span><span class="op" id="4056882">,</span>&nbsp;<span class="ident" id="4056884"><a href="/crypto/x509/x509.go.html#4030168">net</a></span><span class="op" id="4056887">.</span><span class="ident" id="4056888">IPv6len</span><span class="op" id="4056895">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056901"><a href="/crypto/x509/x509.go.html#4055596">ipAddresses</a></span>&nbsp;<span class="op" id="4056913">=</span>&nbsp;<span class="builtinfunc" id="4056915">append</span><span class="op" id="4056921">(</span><span class="ident" id="4056922"><a href="/crypto/x509/x509.go.html#4055596">ipAddresses</a></span><span class="op" id="4056933">,</span>&nbsp;<span class="ident" id="4056935"><a href="/crypto/x509/x509.go.html#4056596">v</a></span><span class="op" id="4056936">.</span><span class="ident" id="4056937">Bytes</span><span class="op" id="4056942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056947">default</span><span class="op" id="4056954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056960"><a href="/crypto/x509/x509.go.html#4055618">err</a></span>&nbsp;<span class="op" id="4056964">=</span>&nbsp;<span class="ident" id="4056966"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4056972">.</span><span class="ident" id="4056973">New</span><span class="op" id="4056976">(</span><span class="string" id="4056977">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4057029">+</span>&nbsp;<span class="ident" id="4057031"><a href="/crypto/x509/x509.go.html#4030175">strconv</a></span><span class="op" id="4057038">.</span><span class="ident" id="4057039">Itoa</span><span class="op" id="4057043">(</span><span class="builtinfunc" id="4057044">len</span><span class="op" id="4057047">(</span><span class="ident" id="4057048"><a href="/crypto/x509/x509.go.html#4056596">v</a></span><span class="op" id="4057049">.</span><span class="ident" id="4057050">Bytes</span><span class="op" id="4057055">)</span><span class="op" id="4057056">)</span><span class="op" id="4057057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057063">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4057073">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4057077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4057080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057084">return</span><br>
<span class="lineno"></span><span class="op" id="4057091">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4057094">func</span>&nbsp;<span class="ident" id="4057099">parseCertificate</span><span class="op" id="4057115">(</span><span class="ident" id="4057116">in</span>&nbsp;<span class="op" id="4057119">*</span><span class="ident" id="4057120"><a href="/crypto/x509/x509.go.html#4032640">certificate</a></span><span class="op" id="4057131">)</span>&nbsp;<span class="op" id="4057133">(</span><span class="op" id="4057134">*</span><span class="ident" id="4057135"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4057146">,</span>&nbsp;<span class="builtintype" id="4057148">error</span><span class="op" id="4057153">)</span>&nbsp;<span class="op" id="4057155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057158">out</span>&nbsp;<span class="op" id="4057162">:=</span>&nbsp;<span class="builtinfunc" id="4057165">new</span><span class="op" id="4057168">(</span><span class="ident" id="4057169"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4057180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057183"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057186">.</span><span class="ident" id="4057187">Raw</span>&nbsp;<span class="op" id="4057191">=</span>&nbsp;<span class="ident" id="4057193"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057195">.</span><span class="ident" id="4057196">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057201"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057204">.</span><span class="ident" id="4057205">RawTBSCertificate</span>&nbsp;<span class="op" id="4057223">=</span>&nbsp;<span class="ident" id="4057225"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057227">.</span><span class="ident" id="4057228">TBSCertificate</span><span class="op" id="4057242">.</span><span class="ident" id="4057243">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057248"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057251">.</span><span class="ident" id="4057252">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4057276">=</span>&nbsp;<span class="ident" id="4057278"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057280">.</span><span class="ident" id="4057281">TBSCertificate</span><span class="op" id="4057295">.</span><span class="ident" id="4057296">PublicKey</span><span class="op" id="4057305">.</span><span class="ident" id="4057306">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057311"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057314">.</span><span class="ident" id="4057315">RawSubject</span>&nbsp;<span class="op" id="4057326">=</span>&nbsp;<span class="ident" id="4057328"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057330">.</span><span class="ident" id="4057331">TBSCertificate</span><span class="op" id="4057345">.</span><span class="ident" id="4057346">Subject</span><span class="op" id="4057353">.</span><span class="ident" id="4057354">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057365"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057368">.</span><span class="ident" id="4057369">RawIssuer</span>&nbsp;<span class="op" id="4057379">=</span>&nbsp;<span class="ident" id="4057381"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057383">.</span><span class="ident" id="4057384">TBSCertificate</span><span class="op" id="4057398">.</span><span class="ident" id="4057399">Issuer</span><span class="op" id="4057405">.</span><span class="ident" id="4057406">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057418"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057421">.</span><span class="ident" id="4057422">Signature</span>&nbsp;<span class="op" id="4057432">=</span>&nbsp;<span class="ident" id="4057434"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057436">.</span><span class="ident" id="4057437">SignatureValue</span><span class="op" id="4057451">.</span><span class="ident" id="4057452">RightAlign</span><span class="op" id="4057462">(</span><span class="op" id="4057463">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057466"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057469">.</span><span class="ident" id="4057470">SignatureAlgorithm</span>&nbsp;<span class="op" id="4057489">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057493"><a href="/crypto/x509/x509.go.html#4037639">getSignatureAlgorithmFromOID</a></span><span class="op" id="4057521">(</span><span class="ident" id="4057522"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057524">.</span><span class="ident" id="4057525">TBSCertificate</span><span class="op" id="4057539">.</span><span class="ident" id="4057540">SignatureAlgorithm</span><span class="op" id="4057558">.</span><span class="ident" id="4057559">Algorithm</span><span class="op" id="4057568">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057572"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057575">.</span><span class="ident" id="4057576">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4057595">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057599"><a href="/crypto/x509/x509.go.html#4038569">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4057627">(</span><span class="ident" id="4057628"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057630">.</span><span class="ident" id="4057631">TBSCertificate</span><span class="op" id="4057645">.</span><span class="ident" id="4057646">PublicKey</span><span class="op" id="4057655">.</span><span class="ident" id="4057656">Algorithm</span><span class="op" id="4057665">.</span><span class="ident" id="4057666">Algorithm</span><span class="op" id="4057675">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057678">var</span>&nbsp;<span class="ident" id="4057682">err</span>&nbsp;<span class="builtintype" id="4057686">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057693"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057696">.</span><span class="ident" id="4057697">PublicKey</span><span class="op" id="4057706">,</span>&nbsp;<span class="ident" id="4057708"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4057712">=</span>&nbsp;<span class="ident" id="4057714"><a href="/crypto/x509/x509.go.html#4053763">parsePublicKey</a></span><span class="op" id="4057728">(</span><span class="ident" id="4057729"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057732">.</span><span class="ident" id="4057733">PublicKeyAlgorithm</span><span class="op" id="4057751">,</span>&nbsp;<span class="op" id="4057753">&amp;</span><span class="ident" id="4057754"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057756">.</span><span class="ident" id="4057757">TBSCertificate</span><span class="op" id="4057771">.</span><span class="ident" id="4057772">PublicKey</span><span class="op" id="4057781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057784">if</span>&nbsp;<span class="ident" id="4057787"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4057791">!=</span>&nbsp;<span class="ident" id="4057794">nil</span>&nbsp;<span class="op" id="4057798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057802">return</span>&nbsp;<span class="ident" id="4057809">nil</span><span class="op" id="4057812">,</span>&nbsp;<span class="ident" id="4057814"><a href="/crypto/x509/x509.go.html#4057682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4057819">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057823">if</span>&nbsp;<span class="ident" id="4057826"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057828">.</span><span class="ident" id="4057829">TBSCertificate</span><span class="op" id="4057843">.</span><span class="ident" id="4057844">SerialNumber</span><span class="op" id="4057856">.</span><span class="ident" id="4057857">Sign</span><span class="op" id="4057861">(</span><span class="op" id="4057862">)</span>&nbsp;<span class="op" id="4057864">&lt;</span>&nbsp;<span class="num" id="4057866">0</span>&nbsp;<span class="op" id="4057868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057872">return</span>&nbsp;<span class="ident" id="4057879">nil</span><span class="op" id="4057882">,</span>&nbsp;<span class="ident" id="4057884"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4057890">.</span><span class="ident" id="4057891">New</span><span class="op" id="4057894">(</span><span class="string" id="4057895">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4057925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4057928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057932"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057935">.</span><span class="ident" id="4057936">Version</span>&nbsp;<span class="op" id="4057944">=</span>&nbsp;<span class="ident" id="4057946"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057948">.</span><span class="ident" id="4057949">TBSCertificate</span><span class="op" id="4057963">.</span><span class="ident" id="4057964">Version</span>&nbsp;<span class="op" id="4057972">+</span>&nbsp;<span class="num" id="4057974">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057977"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4057980">.</span><span class="ident" id="4057981">SerialNumber</span>&nbsp;<span class="op" id="4057994">=</span>&nbsp;<span class="ident" id="4057996"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4057998">.</span><span class="ident" id="4057999">TBSCertificate</span><span class="op" id="4058013">.</span><span class="ident" id="4058014">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058029">var</span>&nbsp;<span class="ident" id="4058033">issuer</span><span class="op" id="4058039">,</span>&nbsp;<span class="ident" id="4058041">subject</span>&nbsp;<span class="ident" id="4058049"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4058053">.</span><span class="ident" id="4058054">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058067">if</span>&nbsp;<span class="ident" id="4058070">_</span><span class="op" id="4058071">,</span>&nbsp;<span class="ident" id="4058073">err</span>&nbsp;<span class="op" id="4058077">:=</span>&nbsp;<span class="ident" id="4058080"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4058084">.</span><span class="ident" id="4058085">Unmarshal</span><span class="op" id="4058094">(</span><span class="ident" id="4058095"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4058097">.</span><span class="ident" id="4058098">TBSCertificate</span><span class="op" id="4058112">.</span><span class="ident" id="4058113">Subject</span><span class="op" id="4058120">.</span><span class="ident" id="4058121">FullBytes</span><span class="op" id="4058130">,</span>&nbsp;<span class="op" id="4058132">&amp;</span><span class="ident" id="4058133"><a href="/crypto/x509/x509.go.html#4058041">subject</a></span><span class="op" id="4058140">)</span><span class="op" id="4058141">;</span>&nbsp;<span class="ident" id="4058143"><a href="/crypto/x509/x509.go.html#4058073">err</a></span>&nbsp;<span class="op" id="4058147">!=</span>&nbsp;<span class="ident" id="4058150">nil</span>&nbsp;<span class="op" id="4058154">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058158">return</span>&nbsp;<span class="ident" id="4058165">nil</span><span class="op" id="4058168">,</span>&nbsp;<span class="ident" id="4058170"><a href="/crypto/x509/x509.go.html#4058073">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4058175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058178">if</span>&nbsp;<span class="ident" id="4058181">_</span><span class="op" id="4058182">,</span>&nbsp;<span class="ident" id="4058184">err</span>&nbsp;<span class="op" id="4058188">:=</span>&nbsp;<span class="ident" id="4058191"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4058195">.</span><span class="ident" id="4058196">Unmarshal</span><span class="op" id="4058205">(</span><span class="ident" id="4058206"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4058208">.</span><span class="ident" id="4058209">TBSCertificate</span><span class="op" id="4058223">.</span><span class="ident" id="4058224">Issuer</span><span class="op" id="4058230">.</span><span class="ident" id="4058231">FullBytes</span><span class="op" id="4058240">,</span>&nbsp;<span class="op" id="4058242">&amp;</span><span class="ident" id="4058243"><a href="/crypto/x509/x509.go.html#4058033">issuer</a></span><span class="op" id="4058249">)</span><span class="op" id="4058250">;</span>&nbsp;<span class="ident" id="4058252"><a href="/crypto/x509/x509.go.html#4058184">err</a></span>&nbsp;<span class="op" id="4058256">!=</span>&nbsp;<span class="ident" id="4058259">nil</span>&nbsp;<span class="op" id="4058263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058267">return</span>&nbsp;<span class="ident" id="4058274">nil</span><span class="op" id="4058277">,</span>&nbsp;<span class="ident" id="4058279"><a href="/crypto/x509/x509.go.html#4058184">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4058284">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058288"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4058291">.</span><span class="ident" id="4058292">Issuer</span><span class="op" id="4058298">.</span><span class="ident" id="4058299">FillFromRDNSequence</span><span class="op" id="4058318">(</span><span class="op" id="4058319">&amp;</span><span class="ident" id="4058320"><a href="/crypto/x509/x509.go.html#4058033">issuer</a></span><span class="op" id="4058326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058329"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4058332">.</span><span class="ident" id="4058333">Subject</span><span class="op" id="4058340">.</span><span class="ident" id="4058341">FillFromRDNSequence</span><span class="op" id="4058360">(</span><span class="op" id="4058361">&amp;</span><span class="ident" id="4058362"><a href="/crypto/x509/x509.go.html#4058041">subject</a></span><span class="op" id="4058369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058373"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4058376">.</span><span class="ident" id="4058377">NotBefore</span>&nbsp;<span class="op" id="4058387">=</span>&nbsp;<span class="ident" id="4058389"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4058391">.</span><span class="ident" id="4058392">TBSCertificate</span><span class="op" id="4058406">.</span><span class="ident" id="4058407">Validity</span><span class="op" id="4058415">.</span><span class="ident" id="4058416">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058427"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4058430">.</span><span class="ident" id="4058431">NotAfter</span>&nbsp;<span class="op" id="4058440">=</span>&nbsp;<span class="ident" id="4058442"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4058444">.</span><span class="ident" id="4058445">TBSCertificate</span><span class="op" id="4058459">.</span><span class="ident" id="4058460">Validity</span><span class="op" id="4058468">.</span><span class="ident" id="4058469">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058480">for</span>&nbsp;<span class="ident" id="4058484">_</span><span class="op" id="4058485">,</span>&nbsp;<span class="ident" id="4058487">e</span>&nbsp;<span class="op" id="4058489">:=</span>&nbsp;<span class="keyword" id="4058492">range</span>&nbsp;<span class="ident" id="4058498"><a href="/crypto/x509/x509.go.html#4057116">in</a></span><span class="op" id="4058500">.</span><span class="ident" id="4058501">TBSCertificate</span><span class="op" id="4058515">.</span><span class="ident" id="4058516">Extensions</span>&nbsp;<span class="op" id="4058527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058531"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4058534">.</span><span class="ident" id="4058535">Extensions</span>&nbsp;<span class="op" id="4058546">=</span>&nbsp;<span class="builtinfunc" id="4058548">append</span><span class="op" id="4058554">(</span><span class="ident" id="4058555"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4058558">.</span><span class="ident" id="4058559">Extensions</span><span class="op" id="4058569">,</span>&nbsp;<span class="ident" id="4058571"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4058572">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058577">if</span>&nbsp;<span class="builtinfunc" id="4058580">len</span><span class="op" id="4058583">(</span><span class="ident" id="4058584"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4058585">.</span><span class="ident" id="4058586">Id</span><span class="op" id="4058588">)</span>&nbsp;<span class="op" id="4058590">==</span>&nbsp;<span class="num" id="4058593">4</span>&nbsp;<span class="op" id="4058595">&amp;&amp;</span>&nbsp;<span class="ident" id="4058598"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4058599">.</span><span class="ident" id="4058600">Id</span><span class="op" id="4058602">[</span><span class="num" id="4058603">0</span><span class="op" id="4058604">]</span>&nbsp;<span class="op" id="4058606">==</span>&nbsp;<span class="num" id="4058609">2</span>&nbsp;<span class="op" id="4058611">&amp;&amp;</span>&nbsp;<span class="ident" id="4058614"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4058615">.</span><span class="ident" id="4058616">Id</span><span class="op" id="4058618">[</span><span class="num" id="4058619">1</span><span class="op" id="4058620">]</span>&nbsp;<span class="op" id="4058622">==</span>&nbsp;<span class="num" id="4058625">5</span>&nbsp;<span class="op" id="4058627">&amp;&amp;</span>&nbsp;<span class="ident" id="4058630"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4058631">.</span><span class="ident" id="4058632">Id</span><span class="op" id="4058634">[</span><span class="num" id="4058635">2</span><span class="op" id="4058636">]</span>&nbsp;<span class="op" id="4058638">==</span>&nbsp;<span class="num" id="4058641">29</span>&nbsp;<span class="op" id="4058644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058649">switch</span>&nbsp;<span class="ident" id="4058656"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4058657">.</span><span class="ident" id="4058658">Id</span><span class="op" id="4058660">[</span><span class="num" id="4058661">3</span><span class="op" id="4058662">]</span>&nbsp;<span class="op" id="4058664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058669">case</span>&nbsp;<span class="num" id="4058674">15</span><span class="op" id="4058676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4058682">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058707">var</span>&nbsp;<span class="ident" id="4058711">usageBits</span>&nbsp;<span class="ident" id="4058721"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4058725">.</span><span class="ident" id="4058726">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058740">_</span><span class="op" id="4058741">,</span>&nbsp;<span class="ident" id="4058743">err</span>&nbsp;<span class="op" id="4058747">:=</span>&nbsp;<span class="ident" id="4058750"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4058754">.</span><span class="ident" id="4058755">Unmarshal</span><span class="op" id="4058764">(</span><span class="ident" id="4058765"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4058766">.</span><span class="ident" id="4058767">Value</span><span class="op" id="4058772">,</span>&nbsp;<span class="op" id="4058774">&amp;</span><span class="ident" id="4058775"><a href="/crypto/x509/x509.go.html#4058711">usageBits</a></span><span class="op" id="4058784">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058791">if</span>&nbsp;<span class="ident" id="4058794"><a href="/crypto/x509/x509.go.html#4058743">err</a></span>&nbsp;<span class="op" id="4058798">==</span>&nbsp;<span class="ident" id="4058801">nil</span>&nbsp;<span class="op" id="4058805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058812">var</span>&nbsp;<span class="ident" id="4058816">usage</span>&nbsp;<span class="builtintype" id="4058822">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058831">for</span>&nbsp;<span class="ident" id="4058835">i</span>&nbsp;<span class="op" id="4058837">:=</span>&nbsp;<span class="num" id="4058840">0</span><span class="op" id="4058841">;</span>&nbsp;<span class="ident" id="4058843"><a href="/crypto/x509/x509.go.html#4058835">i</a></span>&nbsp;<span class="op" id="4058845">&lt;</span>&nbsp;<span class="num" id="4058847">9</span><span class="op" id="4058848">;</span>&nbsp;<span class="ident" id="4058850"><a href="/crypto/x509/x509.go.html#4058835">i</a></span><span class="op" id="4058851">++</span>&nbsp;<span class="op" id="4058854">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058862">if</span>&nbsp;<span class="ident" id="4058865"><a href="/crypto/x509/x509.go.html#4058711">usageBits</a></span><span class="op" id="4058874">.</span><span class="ident" id="4058875">At</span><span class="op" id="4058877">(</span><span class="ident" id="4058878"><a href="/crypto/x509/x509.go.html#4058835">i</a></span><span class="op" id="4058879">)</span>&nbsp;<span class="op" id="4058881">!=</span>&nbsp;<span class="num" id="4058884">0</span>&nbsp;<span class="op" id="4058886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058895"><a href="/crypto/x509/x509.go.html#4058816">usage</a></span>&nbsp;<span class="op" id="4058901">|=</span>&nbsp;<span class="num" id="4058904">1</span>&nbsp;<span class="op" id="4058906">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4058909">uint</span><span class="op" id="4058913">(</span><span class="ident" id="4058914"><a href="/crypto/x509/x509.go.html#4058835">i</a></span><span class="op" id="4058915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4058923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4058930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4058937"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4058940">.</span><span class="ident" id="4058941">KeyUsage</span>&nbsp;<span class="op" id="4058950">=</span>&nbsp;<span class="ident" id="4058952"><a href="/crypto/x509/x509.go.html#4040433">KeyUsage</a></span><span class="op" id="4058960">(</span><span class="ident" id="4058961"><a href="/crypto/x509/x509.go.html#4058816">usage</a></span><span class="op" id="4058966">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058973">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4058986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4058991">case</span>&nbsp;<span class="num" id="4058996">19</span><span class="op" id="4058998">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059004">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059029">var</span>&nbsp;<span class="ident" id="4059033">constraints</span>&nbsp;<span class="ident" id="4059045"><a href="/crypto/x509/x509.go.html#4052787">basicConstraints</a></span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059066">_</span><span class="op" id="4059067">,</span>&nbsp;<span class="ident" id="4059069">err</span>&nbsp;<span class="op" id="4059073">:=</span>&nbsp;<span class="ident" id="4059076"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4059080">.</span><span class="ident" id="4059081">Unmarshal</span><span class="op" id="4059090">(</span><span class="ident" id="4059091"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4059092">.</span><span class="ident" id="4059093">Value</span><span class="op" id="4059098">,</span>&nbsp;<span class="op" id="4059100">&amp;</span><span class="ident" id="4059101"><a href="/crypto/x509/x509.go.html#4059033">constraints</a></span><span class="op" id="4059112">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059119">if</span>&nbsp;<span class="ident" id="4059122"><a href="/crypto/x509/x509.go.html#4059069">err</a></span>&nbsp;<span class="op" id="4059126">==</span>&nbsp;<span class="ident" id="4059129">nil</span>&nbsp;<span class="op" id="4059133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059140"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059143">.</span><span class="ident" id="4059144">BasicConstraintsValid</span>&nbsp;<span class="op" id="4059166">=</span>&nbsp;<span class="builtintype" id="4059168">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059178"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059181">.</span><span class="ident" id="4059182">IsCA</span>&nbsp;<span class="op" id="4059187">=</span>&nbsp;<span class="ident" id="4059189"><a href="/crypto/x509/x509.go.html#4059033">constraints</a></span><span class="op" id="4059200">.</span><span class="ident" id="4059201">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059211"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059214">.</span><span class="ident" id="4059215">MaxPathLen</span>&nbsp;<span class="op" id="4059226">=</span>&nbsp;<span class="ident" id="4059228"><a href="/crypto/x509/x509.go.html#4059033">constraints</a></span><span class="op" id="4059239">.</span><span class="ident" id="4059240">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059256"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059259">.</span><span class="ident" id="4059260">MaxPathLenZero</span>&nbsp;<span class="op" id="4059275">=</span>&nbsp;<span class="ident" id="4059277"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059280">.</span><span class="ident" id="4059281">MaxPathLen</span>&nbsp;<span class="op" id="4059292">==</span>&nbsp;<span class="num" id="4059295">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059302">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4059315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059320">case</span>&nbsp;<span class="num" id="4059325">17</span><span class="op" id="4059327">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4059333"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059336">.</span><span class="ident" id="4059337">DNSNames</span><span class="op" id="4059345">,</span>&nbsp;<span class="ident" id="4059347"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059350">.</span><span class="ident" id="4059351">EmailAddresses</span><span class="op" id="4059365">,</span>&nbsp;<span class="ident" id="4059367"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059370">.</span><span class="ident" id="4059371">IPAddresses</span><span class="op" id="4059382">,</span>&nbsp;<span class="ident" id="4059384"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4059388">=</span>&nbsp;<span class="ident" id="4059390"><a href="/crypto/x509/x509.go.html#4055528">parseSANExtension</a></span><span class="op" id="4059407">(</span><span class="ident" id="4059408"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4059409">.</span><span class="ident" id="4059410">Value</span><span class="op" id="4059415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059421">if</span>&nbsp;<span class="ident" id="4059424"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4059428">!=</span>&nbsp;<span class="ident" id="4059431">nil</span>&nbsp;<span class="op" id="4059435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059442">return</span>&nbsp;<span class="ident" id="4059449">nil</span><span class="op" id="4059452">,</span>&nbsp;<span class="ident" id="4059454"><a href="/crypto/x509/x509.go.html#4057682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4059462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059469">if</span>&nbsp;<span class="builtinfunc" id="4059472">len</span><span class="op" id="4059475">(</span><span class="ident" id="4059476"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059479">.</span><span class="ident" id="4059480">DNSNames</span><span class="op" id="4059488">)</span>&nbsp;<span class="op" id="4059490">&gt;</span>&nbsp;<span class="num" id="4059492">0</span>&nbsp;<span class="op" id="4059494">||</span>&nbsp;<span class="builtinfunc" id="4059497">len</span><span class="op" id="4059500">(</span><span class="ident" id="4059501"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059504">.</span><span class="ident" id="4059505">EmailAddresses</span><span class="op" id="4059519">)</span>&nbsp;<span class="op" id="4059521">&gt;</span>&nbsp;<span class="num" id="4059523">0</span>&nbsp;<span class="op" id="4059525">||</span>&nbsp;<span class="builtinfunc" id="4059528">len</span><span class="op" id="4059531">(</span><span class="ident" id="4059532"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4059535">.</span><span class="ident" id="4059536">IPAddresses</span><span class="op" id="4059547">)</span>&nbsp;<span class="op" id="4059549">&gt;</span>&nbsp;<span class="num" id="4059551">0</span>&nbsp;<span class="op" id="4059553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059560">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4059573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059579">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059630">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4059679">case</span>&nbsp;<span class="num" id="4059684">30</span><span class="op" id="4059686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059692">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059719">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059757">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059827">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059898">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059905">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059973">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4059980">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060017">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060066">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060126">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060186">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060193">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060235">var</span>&nbsp;<span class="ident" id="4060239">constraints</span>&nbsp;<span class="ident" id="4060251"><a href="/crypto/x509/x509.go.html#4053038">nameConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060271">_</span><span class="op" id="4060272">,</span>&nbsp;<span class="ident" id="4060274">err</span>&nbsp;<span class="op" id="4060278">:=</span>&nbsp;<span class="ident" id="4060281"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4060285">.</span><span class="ident" id="4060286">Unmarshal</span><span class="op" id="4060295">(</span><span class="ident" id="4060296"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4060297">.</span><span class="ident" id="4060298">Value</span><span class="op" id="4060303">,</span>&nbsp;<span class="op" id="4060305">&amp;</span><span class="ident" id="4060306"><a href="/crypto/x509/x509.go.html#4060239">constraints</a></span><span class="op" id="4060317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060323">if</span>&nbsp;<span class="ident" id="4060326"><a href="/crypto/x509/x509.go.html#4060274">err</a></span>&nbsp;<span class="op" id="4060330">!=</span>&nbsp;<span class="ident" id="4060333">nil</span>&nbsp;<span class="op" id="4060337">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060344">return</span>&nbsp;<span class="ident" id="4060351">nil</span><span class="op" id="4060354">,</span>&nbsp;<span class="ident" id="4060356"><a href="/crypto/x509/x509.go.html#4060274">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4060364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060371">if</span>&nbsp;<span class="builtinfunc" id="4060374">len</span><span class="op" id="4060377">(</span><span class="ident" id="4060378"><a href="/crypto/x509/x509.go.html#4060239">constraints</a></span><span class="op" id="4060389">.</span><span class="ident" id="4060390">Excluded</span><span class="op" id="4060398">)</span>&nbsp;<span class="op" id="4060400">&gt;</span>&nbsp;<span class="num" id="4060402">0</span>&nbsp;<span class="op" id="4060404">&amp;&amp;</span>&nbsp;<span class="ident" id="4060407"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4060408">.</span><span class="ident" id="4060409">Critical</span>&nbsp;<span class="op" id="4060418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060425">return</span>&nbsp;<span class="ident" id="4060432"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4060435">,</span>&nbsp;<span class="ident" id="4060437"><a href="/crypto/x509/x509.go.html#4052644">UnhandledCriticalExtension</a></span><span class="op" id="4060463">{</span><span class="op" id="4060464">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4060470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060477">for</span>&nbsp;<span class="ident" id="4060481">_</span><span class="op" id="4060482">,</span>&nbsp;<span class="ident" id="4060484">subtree</span>&nbsp;<span class="op" id="4060492">:=</span>&nbsp;<span class="keyword" id="4060495">range</span>&nbsp;<span class="ident" id="4060501"><a href="/crypto/x509/x509.go.html#4060239">constraints</a></span><span class="op" id="4060512">.</span><span class="ident" id="4060513">Permitted</span>&nbsp;<span class="op" id="4060523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060530">if</span>&nbsp;<span class="builtinfunc" id="4060533">len</span><span class="op" id="4060536">(</span><span class="ident" id="4060537"><a href="/crypto/x509/x509.go.html#4060484">subtree</a></span><span class="op" id="4060544">.</span><span class="ident" id="4060545">Name</span><span class="op" id="4060549">)</span>&nbsp;<span class="op" id="4060551">==</span>&nbsp;<span class="num" id="4060554">0</span>&nbsp;<span class="op" id="4060556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060564">if</span>&nbsp;<span class="ident" id="4060567"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4060568">.</span><span class="ident" id="4060569">Critical</span>&nbsp;<span class="op" id="4060578">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060587">return</span>&nbsp;<span class="ident" id="4060594"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4060597">,</span>&nbsp;<span class="ident" id="4060599"><a href="/crypto/x509/x509.go.html#4052644">UnhandledCriticalExtension</a></span><span class="op" id="4060625">{</span><span class="op" id="4060626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4060634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060642">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4060656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060663"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4060666">.</span><span class="ident" id="4060667">PermittedDNSDomains</span>&nbsp;<span class="op" id="4060687">=</span>&nbsp;<span class="builtinfunc" id="4060689">append</span><span class="op" id="4060695">(</span><span class="ident" id="4060696"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4060699">.</span><span class="ident" id="4060700">PermittedDNSDomains</span><span class="op" id="4060719">,</span>&nbsp;<span class="ident" id="4060721"><a href="/crypto/x509/x509.go.html#4060484">subtree</a></span><span class="op" id="4060728">.</span><span class="ident" id="4060729">Name</span><span class="op" id="4060733">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4060739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060745">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060758">case</span>&nbsp;<span class="num" id="4060763">31</span><span class="op" id="4060765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060771">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060798">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060875">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060882">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060922">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4060997">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061062">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061129">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061136">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061178">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061235">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061307">var</span>&nbsp;<span class="ident" id="4061311">cdp</span>&nbsp;<span class="op" id="4061315">[</span><span class="op" id="4061316">]</span><span class="ident" id="4061317"><a href="/crypto/x509/x509.go.html#4053384">distributionPoint</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061339">_</span><span class="op" id="4061340">,</span>&nbsp;<span class="ident" id="4061342">err</span>&nbsp;<span class="op" id="4061346">:=</span>&nbsp;<span class="ident" id="4061349"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4061353">.</span><span class="ident" id="4061354">Unmarshal</span><span class="op" id="4061363">(</span><span class="ident" id="4061364"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4061365">.</span><span class="ident" id="4061366">Value</span><span class="op" id="4061371">,</span>&nbsp;<span class="op" id="4061373">&amp;</span><span class="ident" id="4061374"><a href="/crypto/x509/x509.go.html#4061311">cdp</a></span><span class="op" id="4061377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061383">if</span>&nbsp;<span class="ident" id="4061386"><a href="/crypto/x509/x509.go.html#4061342">err</a></span>&nbsp;<span class="op" id="4061390">!=</span>&nbsp;<span class="ident" id="4061393">nil</span>&nbsp;<span class="op" id="4061397">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061404">return</span>&nbsp;<span class="ident" id="4061411">nil</span><span class="op" id="4061414">,</span>&nbsp;<span class="ident" id="4061416"><a href="/crypto/x509/x509.go.html#4061342">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061431">for</span>&nbsp;<span class="ident" id="4061435">_</span><span class="op" id="4061436">,</span>&nbsp;<span class="ident" id="4061438">dp</span>&nbsp;<span class="op" id="4061441">:=</span>&nbsp;<span class="keyword" id="4061444">range</span>&nbsp;<span class="ident" id="4061450"><a href="/crypto/x509/x509.go.html#4061311">cdp</a></span>&nbsp;<span class="op" id="4061454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061461">var</span>&nbsp;<span class="ident" id="4061465">n</span>&nbsp;<span class="ident" id="4061467"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4061471">.</span><span class="ident" id="4061472">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061486">_</span><span class="op" id="4061487">,</span>&nbsp;<span class="ident" id="4061489"><a href="/crypto/x509/x509.go.html#4061342">err</a></span>&nbsp;<span class="op" id="4061493">=</span>&nbsp;<span class="ident" id="4061495"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4061499">.</span><span class="ident" id="4061500">Unmarshal</span><span class="op" id="4061509">(</span><span class="ident" id="4061510"><a href="/crypto/x509/x509.go.html#4061438">dp</a></span><span class="op" id="4061512">.</span><span class="ident" id="4061513">DistributionPoint</span><span class="op" id="4061530">.</span><span class="ident" id="4061531">FullName</span><span class="op" id="4061539">.</span><span class="ident" id="4061540">Bytes</span><span class="op" id="4061545">,</span>&nbsp;<span class="op" id="4061547">&amp;</span><span class="ident" id="4061548"><a href="/crypto/x509/x509.go.html#4061465">n</a></span><span class="op" id="4061549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061556">if</span>&nbsp;<span class="ident" id="4061559"><a href="/crypto/x509/x509.go.html#4061342">err</a></span>&nbsp;<span class="op" id="4061563">!=</span>&nbsp;<span class="ident" id="4061566">nil</span>&nbsp;<span class="op" id="4061570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061578">return</span>&nbsp;<span class="ident" id="4061585">nil</span><span class="op" id="4061588">,</span>&nbsp;<span class="ident" id="4061590"><a href="/crypto/x509/x509.go.html#4061342">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061607">if</span>&nbsp;<span class="ident" id="4061610"><a href="/crypto/x509/x509.go.html#4061465">n</a></span><span class="op" id="4061611">.</span><span class="ident" id="4061612">Tag</span>&nbsp;<span class="op" id="4061616">==</span>&nbsp;<span class="num" id="4061619">6</span>&nbsp;<span class="op" id="4061621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061629"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4061632">.</span><span class="ident" id="4061633">CRLDistributionPoints</span>&nbsp;<span class="op" id="4061655">=</span>&nbsp;<span class="builtinfunc" id="4061657">append</span><span class="op" id="4061663">(</span><span class="ident" id="4061664"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4061667">.</span><span class="ident" id="4061668">CRLDistributionPoints</span><span class="op" id="4061689">,</span>&nbsp;<span class="builtintype" id="4061691">string</span><span class="op" id="4061697">(</span><span class="ident" id="4061698"><a href="/crypto/x509/x509.go.html#4061465">n</a></span><span class="op" id="4061699">.</span><span class="ident" id="4061700">Bytes</span><span class="op" id="4061705">)</span><span class="op" id="4061706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061725">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061738">case</span>&nbsp;<span class="num" id="4061743">35</span><span class="op" id="4061745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061751">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061776">var</span>&nbsp;<span class="ident" id="4061780">a</span>&nbsp;<span class="ident" id="4061782"><a href="/crypto/x509/x509.go.html#4033688">authKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061796">_</span><span class="op" id="4061797">,</span>&nbsp;<span class="ident" id="4061799"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4061803">=</span>&nbsp;<span class="ident" id="4061805"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4061809">.</span><span class="ident" id="4061810">Unmarshal</span><span class="op" id="4061819">(</span><span class="ident" id="4061820"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4061821">.</span><span class="ident" id="4061822">Value</span><span class="op" id="4061827">,</span>&nbsp;<span class="op" id="4061829">&amp;</span><span class="ident" id="4061830"><a href="/crypto/x509/x509.go.html#4061780">a</a></span><span class="op" id="4061831">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061837">if</span>&nbsp;<span class="ident" id="4061840"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4061844">!=</span>&nbsp;<span class="ident" id="4061847">nil</span>&nbsp;<span class="op" id="4061851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061858">return</span>&nbsp;<span class="ident" id="4061865">nil</span><span class="op" id="4061868">,</span>&nbsp;<span class="ident" id="4061870"><a href="/crypto/x509/x509.go.html#4057682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061884"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4061887">.</span><span class="ident" id="4061888">AuthorityKeyId</span>&nbsp;<span class="op" id="4061903">=</span>&nbsp;<span class="ident" id="4061905"><a href="/crypto/x509/x509.go.html#4061780">a</a></span><span class="op" id="4061906">.</span><span class="ident" id="4061907">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061914">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061927">case</span>&nbsp;<span class="num" id="4061932">37</span><span class="op" id="4061934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061940">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061988">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062048">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062055">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062123">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062130">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062173">var</span>&nbsp;<span class="ident" id="4062177">keyUsage</span>&nbsp;<span class="op" id="4062186">[</span><span class="op" id="4062187">]</span><span class="ident" id="4062188"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4062192">.</span><span class="ident" id="4062193">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062214">_</span><span class="op" id="4062215">,</span>&nbsp;<span class="ident" id="4062217"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4062221">=</span>&nbsp;<span class="ident" id="4062223"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4062227">.</span><span class="ident" id="4062228">Unmarshal</span><span class="op" id="4062237">(</span><span class="ident" id="4062238"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4062239">.</span><span class="ident" id="4062240">Value</span><span class="op" id="4062245">,</span>&nbsp;<span class="op" id="4062247">&amp;</span><span class="ident" id="4062248"><a href="/crypto/x509/x509.go.html#4062177">keyUsage</a></span><span class="op" id="4062256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062262">if</span>&nbsp;<span class="ident" id="4062265"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4062269">!=</span>&nbsp;<span class="ident" id="4062272">nil</span>&nbsp;<span class="op" id="4062276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062283">return</span>&nbsp;<span class="ident" id="4062290">nil</span><span class="op" id="4062293">,</span>&nbsp;<span class="ident" id="4062295"><a href="/crypto/x509/x509.go.html#4057682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062303">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062310">for</span>&nbsp;<span class="ident" id="4062314">_</span><span class="op" id="4062315">,</span>&nbsp;<span class="ident" id="4062317">u</span>&nbsp;<span class="op" id="4062319">:=</span>&nbsp;<span class="keyword" id="4062322">range</span>&nbsp;<span class="ident" id="4062328"><a href="/crypto/x509/x509.go.html#4062177">keyUsage</a></span>&nbsp;<span class="op" id="4062337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062344">if</span>&nbsp;<span class="ident" id="4062347">extKeyUsage</span><span class="op" id="4062358">,</span>&nbsp;<span class="ident" id="4062360">ok</span>&nbsp;<span class="op" id="4062363">:=</span>&nbsp;<span class="ident" id="4062366"><a href="/crypto/x509/x509.go.html#4043758">extKeyUsageFromOID</a></span><span class="op" id="4062384">(</span><span class="ident" id="4062385"><a href="/crypto/x509/x509.go.html#4062317">u</a></span><span class="op" id="4062386">)</span><span class="op" id="4062387">;</span>&nbsp;<span class="ident" id="4062389"><a href="/crypto/x509/x509.go.html#4062360">ok</a></span>&nbsp;<span class="op" id="4062392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062400"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4062403">.</span><span class="ident" id="4062404">ExtKeyUsage</span>&nbsp;<span class="op" id="4062416">=</span>&nbsp;<span class="builtinfunc" id="4062418">append</span><span class="op" id="4062424">(</span><span class="ident" id="4062425"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4062428">.</span><span class="ident" id="4062429">ExtKeyUsage</span><span class="op" id="4062440">,</span>&nbsp;<span class="ident" id="4062442"><a href="/crypto/x509/x509.go.html#4062347">extKeyUsage</a></span><span class="op" id="4062453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062460">}</span>&nbsp;<span class="keyword" id="4062462">else</span>&nbsp;<span class="op" id="4062467">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062475"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4062478">.</span><span class="ident" id="4062479">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4062498">=</span>&nbsp;<span class="builtinfunc" id="4062500">append</span><span class="op" id="4062506">(</span><span class="ident" id="4062507"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4062510">.</span><span class="ident" id="4062511">UnknownExtKeyUsage</span><span class="op" id="4062529">,</span>&nbsp;<span class="ident" id="4062531"><a href="/crypto/x509/x509.go.html#4062317">u</a></span><span class="op" id="4062532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062552">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062565">case</span>&nbsp;<span class="num" id="4062570">14</span><span class="op" id="4062572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062578">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062603">var</span>&nbsp;<span class="ident" id="4062607">keyid</span>&nbsp;<span class="op" id="4062613">[</span><span class="op" id="4062614">]</span><span class="builtintype" id="4062615">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062624">_</span><span class="op" id="4062625">,</span>&nbsp;<span class="ident" id="4062627"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4062631">=</span>&nbsp;<span class="ident" id="4062633"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4062637">.</span><span class="ident" id="4062638">Unmarshal</span><span class="op" id="4062647">(</span><span class="ident" id="4062648"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4062649">.</span><span class="ident" id="4062650">Value</span><span class="op" id="4062655">,</span>&nbsp;<span class="op" id="4062657">&amp;</span><span class="ident" id="4062658"><a href="/crypto/x509/x509.go.html#4062607">keyid</a></span><span class="op" id="4062663">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062669">if</span>&nbsp;<span class="ident" id="4062672"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4062676">!=</span>&nbsp;<span class="ident" id="4062679">nil</span>&nbsp;<span class="op" id="4062683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062690">return</span>&nbsp;<span class="ident" id="4062697">nil</span><span class="op" id="4062700">,</span>&nbsp;<span class="ident" id="4062702"><a href="/crypto/x509/x509.go.html#4057682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062716"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4062719">.</span><span class="ident" id="4062720">SubjectKeyId</span>&nbsp;<span class="op" id="4062733">=</span>&nbsp;<span class="ident" id="4062735"><a href="/crypto/x509/x509.go.html#4062607">keyid</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062745">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062758">case</span>&nbsp;<span class="num" id="4062763">32</span><span class="op" id="4062765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062771">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062817">var</span>&nbsp;<span class="ident" id="4062821">policies</span>&nbsp;<span class="op" id="4062830">[</span><span class="op" id="4062831">]</span><span class="ident" id="4062832"><a href="/crypto/x509/x509.go.html#4052922">policyInformation</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062854">if</span>&nbsp;<span class="ident" id="4062857">_</span><span class="op" id="4062858">,</span>&nbsp;<span class="ident" id="4062860"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4062864">=</span>&nbsp;<span class="ident" id="4062866"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4062870">.</span><span class="ident" id="4062871">Unmarshal</span><span class="op" id="4062880">(</span><span class="ident" id="4062881"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4062882">.</span><span class="ident" id="4062883">Value</span><span class="op" id="4062888">,</span>&nbsp;<span class="op" id="4062890">&amp;</span><span class="ident" id="4062891"><a href="/crypto/x509/x509.go.html#4062821">policies</a></span><span class="op" id="4062899">)</span><span class="op" id="4062900">;</span>&nbsp;<span class="ident" id="4062902"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4062906">!=</span>&nbsp;<span class="ident" id="4062909">nil</span>&nbsp;<span class="op" id="4062913">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062920">return</span>&nbsp;<span class="ident" id="4062927">nil</span><span class="op" id="4062930">,</span>&nbsp;<span class="ident" id="4062932"><a href="/crypto/x509/x509.go.html#4057682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062946"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4062949">.</span><span class="ident" id="4062950">PolicyIdentifiers</span>&nbsp;<span class="op" id="4062968">=</span>&nbsp;<span class="builtinfunc" id="4062970">make</span><span class="op" id="4062974">(</span><span class="op" id="4062975">[</span><span class="op" id="4062976">]</span><span class="ident" id="4062977"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4062981">.</span><span class="ident" id="4062982">ObjectIdentifier</span><span class="op" id="4062998">,</span>&nbsp;<span class="builtinfunc" id="4063000">len</span><span class="op" id="4063003">(</span><span class="ident" id="4063004"><a href="/crypto/x509/x509.go.html#4062821">policies</a></span><span class="op" id="4063012">)</span><span class="op" id="4063013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063019">for</span>&nbsp;<span class="ident" id="4063023">i</span><span class="op" id="4063024">,</span>&nbsp;<span class="ident" id="4063026">policy</span>&nbsp;<span class="op" id="4063033">:=</span>&nbsp;<span class="keyword" id="4063036">range</span>&nbsp;<span class="ident" id="4063042"><a href="/crypto/x509/x509.go.html#4062821">policies</a></span>&nbsp;<span class="op" id="4063051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063058"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4063061">.</span><span class="ident" id="4063062">PolicyIdentifiers</span><span class="op" id="4063079">[</span><span class="ident" id="4063080"><a href="/crypto/x509/x509.go.html#4063023">i</a></span><span class="op" id="4063081">]</span>&nbsp;<span class="op" id="4063083">=</span>&nbsp;<span class="ident" id="4063085"><a href="/crypto/x509/x509.go.html#4063026">policy</a></span><span class="op" id="4063091">.</span><span class="ident" id="4063092">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063112">}</span>&nbsp;<span class="keyword" id="4063114">else</span>&nbsp;<span class="keyword" id="4063119">if</span>&nbsp;<span class="ident" id="4063122"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4063123">.</span><span class="ident" id="4063124">Id</span><span class="op" id="4063126">.</span><span class="ident" id="4063127">Equal</span><span class="op" id="4063132">(</span><span class="ident" id="4063133"><a href="/crypto/x509/x509.go.html#4065482">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="4063164">)</span>&nbsp;<span class="op" id="4063166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4063171">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063224">var</span>&nbsp;<span class="ident" id="4063228">aia</span>&nbsp;<span class="op" id="4063232">[</span><span class="op" id="4063233">]</span><span class="ident" id="4063234"><a href="/crypto/x509/x509.go.html#4053269">authorityInfoAccess</a></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063257">if</span>&nbsp;<span class="ident" id="4063260">_</span><span class="op" id="4063261">,</span>&nbsp;<span class="ident" id="4063263"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4063267">=</span>&nbsp;<span class="ident" id="4063269"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4063273">.</span><span class="ident" id="4063274">Unmarshal</span><span class="op" id="4063283">(</span><span class="ident" id="4063284"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4063285">.</span><span class="ident" id="4063286">Value</span><span class="op" id="4063291">,</span>&nbsp;<span class="op" id="4063293">&amp;</span><span class="ident" id="4063294"><a href="/crypto/x509/x509.go.html#4063228">aia</a></span><span class="op" id="4063297">)</span><span class="op" id="4063298">;</span>&nbsp;<span class="ident" id="4063300"><a href="/crypto/x509/x509.go.html#4057682">err</a></span>&nbsp;<span class="op" id="4063304">!=</span>&nbsp;<span class="ident" id="4063307">nil</span>&nbsp;<span class="op" id="4063311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063317">return</span>&nbsp;<span class="ident" id="4063324">nil</span><span class="op" id="4063327">,</span>&nbsp;<span class="ident" id="4063329"><a href="/crypto/x509/x509.go.html#4057682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063342">for</span>&nbsp;<span class="ident" id="4063346">_</span><span class="op" id="4063347">,</span>&nbsp;<span class="ident" id="4063349">v</span>&nbsp;<span class="op" id="4063351">:=</span>&nbsp;<span class="keyword" id="4063354">range</span>&nbsp;<span class="ident" id="4063360"><a href="/crypto/x509/x509.go.html#4063228">aia</a></span>&nbsp;<span class="op" id="4063364">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4063370">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063430">if</span>&nbsp;<span class="ident" id="4063433"><a href="/crypto/x509/x509.go.html#4063349">v</a></span><span class="op" id="4063434">.</span><span class="ident" id="4063435">Location</span><span class="op" id="4063443">.</span><span class="ident" id="4063444">Tag</span>&nbsp;<span class="op" id="4063448">!=</span>&nbsp;<span class="num" id="4063451">6</span>&nbsp;<span class="op" id="4063453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063460">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063479">if</span>&nbsp;<span class="ident" id="4063482"><a href="/crypto/x509/x509.go.html#4063349">v</a></span><span class="op" id="4063483">.</span><span class="ident" id="4063484">Method</span><span class="op" id="4063490">.</span><span class="ident" id="4063491">Equal</span><span class="op" id="4063496">(</span><span class="ident" id="4063497"><a href="/crypto/x509/x509.go.html#4065561">oidAuthorityInfoAccessOcsp</a></span><span class="op" id="4063523">)</span>&nbsp;<span class="op" id="4063525">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063532"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4063535">.</span><span class="ident" id="4063536">OCSPServer</span>&nbsp;<span class="op" id="4063547">=</span>&nbsp;<span class="builtinfunc" id="4063549">append</span><span class="op" id="4063555">(</span><span class="ident" id="4063556"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4063559">.</span><span class="ident" id="4063560">OCSPServer</span><span class="op" id="4063570">,</span>&nbsp;<span class="builtintype" id="4063572">string</span><span class="op" id="4063578">(</span><span class="ident" id="4063579"><a href="/crypto/x509/x509.go.html#4063349">v</a></span><span class="op" id="4063580">.</span><span class="ident" id="4063581">Location</span><span class="op" id="4063589">.</span><span class="ident" id="4063590">Bytes</span><span class="op" id="4063595">)</span><span class="op" id="4063596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063602">}</span>&nbsp;<span class="keyword" id="4063604">else</span>&nbsp;<span class="keyword" id="4063609">if</span>&nbsp;<span class="ident" id="4063612"><a href="/crypto/x509/x509.go.html#4063349">v</a></span><span class="op" id="4063613">.</span><span class="ident" id="4063614">Method</span><span class="op" id="4063620">.</span><span class="ident" id="4063621">Equal</span><span class="op" id="4063626">(</span><span class="ident" id="4063627"><a href="/crypto/x509/x509.go.html#4065644">oidAuthorityInfoAccessIssuers</a></span><span class="op" id="4063656">)</span>&nbsp;<span class="op" id="4063658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063665"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4063668">.</span><span class="ident" id="4063669">IssuingCertificateURL</span>&nbsp;<span class="op" id="4063691">=</span>&nbsp;<span class="builtinfunc" id="4063693">append</span><span class="op" id="4063699">(</span><span class="ident" id="4063700"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4063703">.</span><span class="ident" id="4063704">IssuingCertificateURL</span><span class="op" id="4063725">,</span>&nbsp;<span class="builtintype" id="4063727">string</span><span class="op" id="4063733">(</span><span class="ident" id="4063734"><a href="/crypto/x509/x509.go.html#4063349">v</a></span><span class="op" id="4063735">.</span><span class="ident" id="4063736">Location</span><span class="op" id="4063744">.</span><span class="ident" id="4063745">Bytes</span><span class="op" id="4063750">)</span><span class="op" id="4063751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063762">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063771">if</span>&nbsp;<span class="ident" id="4063774"><a href="/crypto/x509/x509.go.html#4058487">e</a></span><span class="op" id="4063775">.</span><span class="ident" id="4063776">Critical</span>&nbsp;<span class="op" id="4063785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063790">return</span>&nbsp;<span class="ident" id="4063797"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4063800">,</span>&nbsp;<span class="ident" id="4063802"><a href="/crypto/x509/x509.go.html#4052644">UnhandledCriticalExtension</a></span><span class="op" id="4063828">{</span><span class="op" id="4063829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063833">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063840">return</span>&nbsp;<span class="ident" id="4063847"><a href="/crypto/x509/x509.go.html#4057158">out</a></span><span class="op" id="4063850">,</span>&nbsp;<span class="ident" id="4063852">nil</span><br>
<span class="lineno"></span><span class="op" id="4063856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4063859">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4063938">func</span>&nbsp;<span class="ident" id="4063943">ParseCertificate</span><span class="op" id="4063959">(</span><span class="ident" id="4063960">asn1Data</span>&nbsp;<span class="op" id="4063969">[</span><span class="op" id="4063970">]</span><span class="builtintype" id="4063971">byte</span><span class="op" id="4063975">)</span>&nbsp;<span class="op" id="4063977">(</span><span class="op" id="4063978">*</span><span class="ident" id="4063979"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4063990">,</span>&nbsp;<span class="builtintype" id="4063992">error</span><span class="op" id="4063997">)</span>&nbsp;<span class="op" id="4063999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064002">var</span>&nbsp;<span class="ident" id="4064006">cert</span>&nbsp;<span class="ident" id="4064011"><a href="/crypto/x509/x509.go.html#4032640">certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064024">rest</span><span class="op" id="4064028">,</span>&nbsp;<span class="ident" id="4064030">err</span>&nbsp;<span class="op" id="4064034">:=</span>&nbsp;<span class="ident" id="4064037"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4064041">.</span><span class="ident" id="4064042">Unmarshal</span><span class="op" id="4064051">(</span><span class="ident" id="4064052"><a href="/crypto/x509/x509.go.html#4063960">asn1Data</a></span><span class="op" id="4064060">,</span>&nbsp;<span class="op" id="4064062">&amp;</span><span class="ident" id="4064063"><a href="/crypto/x509/x509.go.html#4064006">cert</a></span><span class="op" id="4064067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064070">if</span>&nbsp;<span class="ident" id="4064073"><a href="/crypto/x509/x509.go.html#4064030">err</a></span>&nbsp;<span class="op" id="4064077">!=</span>&nbsp;<span class="ident" id="4064080">nil</span>&nbsp;<span class="op" id="4064084">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064088">return</span>&nbsp;<span class="ident" id="4064095">nil</span><span class="op" id="4064098">,</span>&nbsp;<span class="ident" id="4064100"><a href="/crypto/x509/x509.go.html#4064030">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064108">if</span>&nbsp;<span class="builtinfunc" id="4064111">len</span><span class="op" id="4064114">(</span><span class="ident" id="4064115"><a href="/crypto/x509/x509.go.html#4064024">rest</a></span><span class="op" id="4064119">)</span>&nbsp;<span class="op" id="4064121">&gt;</span>&nbsp;<span class="num" id="4064123">0</span>&nbsp;<span class="op" id="4064125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064129">return</span>&nbsp;<span class="ident" id="4064136">nil</span><span class="op" id="4064139">,</span>&nbsp;<span class="ident" id="4064141"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4064145">.</span><span class="ident" id="4064146">SyntaxError</span><span class="op" id="4064157">{</span><span class="ident" id="4064158">Msg</span><span class="op" id="4064161">:</span>&nbsp;<span class="string" id="4064163">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4064178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064181">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064185">return</span>&nbsp;<span class="ident" id="4064192"><a href="/crypto/x509/x509.go.html#4057099">parseCertificate</a></span><span class="op" id="4064208">(</span><span class="op" id="4064209">&amp;</span><span class="ident" id="4064210"><a href="/crypto/x509/x509.go.html#4064006">cert</a></span><span class="op" id="4064214">)</span><br>
<span class="lineno"></span><span class="op" id="4064216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4064219">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4064297">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4064374">func</span>&nbsp;<span class="ident" id="4064379">ParseCertificates</span><span class="op" id="4064396">(</span><span class="ident" id="4064397">asn1Data</span>&nbsp;<span class="op" id="4064406">[</span><span class="op" id="4064407">]</span><span class="builtintype" id="4064408">byte</span><span class="op" id="4064412">)</span>&nbsp;<span class="op" id="4064414">(</span><span class="op" id="4064415">[</span><span class="op" id="4064416">]</span><span class="op" id="4064417">*</span><span class="ident" id="4064418"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4064429">,</span>&nbsp;<span class="builtintype" id="4064431">error</span><span class="op" id="4064436">)</span>&nbsp;<span class="op" id="4064438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064441">var</span>&nbsp;<span class="ident" id="4064445">v</span>&nbsp;<span class="op" id="4064447">[</span><span class="op" id="4064448">]</span><span class="op" id="4064449">*</span><span class="ident" id="4064450"><a href="/crypto/x509/x509.go.html#4032640">certificate</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064464">for</span>&nbsp;<span class="builtinfunc" id="4064468">len</span><span class="op" id="4064471">(</span><span class="ident" id="4064472"><a href="/crypto/x509/x509.go.html#4064397">asn1Data</a></span><span class="op" id="4064480">)</span>&nbsp;<span class="op" id="4064482">&gt;</span>&nbsp;<span class="num" id="4064484">0</span>&nbsp;<span class="op" id="4064486">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064490">cert</span>&nbsp;<span class="op" id="4064495">:=</span>&nbsp;<span class="builtinfunc" id="4064498">new</span><span class="op" id="4064501">(</span><span class="ident" id="4064502"><a href="/crypto/x509/x509.go.html#4032640">certificate</a></span><span class="op" id="4064513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064517">var</span>&nbsp;<span class="ident" id="4064521">err</span>&nbsp;<span class="builtintype" id="4064525">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064533"><a href="/crypto/x509/x509.go.html#4064397">asn1Data</a></span><span class="op" id="4064541">,</span>&nbsp;<span class="ident" id="4064543"><a href="/crypto/x509/x509.go.html#4064521">err</a></span>&nbsp;<span class="op" id="4064547">=</span>&nbsp;<span class="ident" id="4064549"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4064553">.</span><span class="ident" id="4064554">Unmarshal</span><span class="op" id="4064563">(</span><span class="ident" id="4064564"><a href="/crypto/x509/x509.go.html#4064397">asn1Data</a></span><span class="op" id="4064572">,</span>&nbsp;<span class="ident" id="4064574"><a href="/crypto/x509/x509.go.html#4064490">cert</a></span><span class="op" id="4064578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064582">if</span>&nbsp;<span class="ident" id="4064585"><a href="/crypto/x509/x509.go.html#4064521">err</a></span>&nbsp;<span class="op" id="4064589">!=</span>&nbsp;<span class="ident" id="4064592">nil</span>&nbsp;<span class="op" id="4064596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064601">return</span>&nbsp;<span class="ident" id="4064608">nil</span><span class="op" id="4064611">,</span>&nbsp;<span class="ident" id="4064613"><a href="/crypto/x509/x509.go.html#4064521">err</a></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064623"><a href="/crypto/x509/x509.go.html#4064445">v</a></span>&nbsp;<span class="op" id="4064625">=</span>&nbsp;<span class="builtinfunc" id="4064627">append</span><span class="op" id="4064633">(</span><span class="ident" id="4064634"><a href="/crypto/x509/x509.go.html#4064445">v</a></span><span class="op" id="4064635">,</span>&nbsp;<span class="ident" id="4064637"><a href="/crypto/x509/x509.go.html#4064490">cert</a></span><span class="op" id="4064641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064648">ret</span>&nbsp;<span class="op" id="4064652">:=</span>&nbsp;<span class="builtinfunc" id="4064655">make</span><span class="op" id="4064659">(</span><span class="op" id="4064660">[</span><span class="op" id="4064661">]</span><span class="op" id="4064662">*</span><span class="ident" id="4064663"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4064674">,</span>&nbsp;<span class="builtinfunc" id="4064676">len</span><span class="op" id="4064679">(</span><span class="ident" id="4064680"><a href="/crypto/x509/x509.go.html#4064445">v</a></span><span class="op" id="4064681">)</span><span class="op" id="4064682">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064685">for</span>&nbsp;<span class="ident" id="4064689">i</span><span class="op" id="4064690">,</span>&nbsp;<span class="ident" id="4064692">ci</span>&nbsp;<span class="op" id="4064695">:=</span>&nbsp;<span class="keyword" id="4064698">range</span>&nbsp;<span class="ident" id="4064704"><a href="/crypto/x509/x509.go.html#4064445">v</a></span>&nbsp;<span class="op" id="4064706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064710">cert</span><span class="op" id="4064714">,</span>&nbsp;<span class="ident" id="4064716">err</span>&nbsp;<span class="op" id="4064720">:=</span>&nbsp;<span class="ident" id="4064723"><a href="/crypto/x509/x509.go.html#4057099">parseCertificate</a></span><span class="op" id="4064739">(</span><span class="ident" id="4064740"><a href="/crypto/x509/x509.go.html#4064692">ci</a></span><span class="op" id="4064742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064746">if</span>&nbsp;<span class="ident" id="4064749"><a href="/crypto/x509/x509.go.html#4064716">err</a></span>&nbsp;<span class="op" id="4064753">!=</span>&nbsp;<span class="ident" id="4064756">nil</span>&nbsp;<span class="op" id="4064760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064765">return</span>&nbsp;<span class="ident" id="4064772">nil</span><span class="op" id="4064775">,</span>&nbsp;<span class="ident" id="4064777"><a href="/crypto/x509/x509.go.html#4064716">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064783">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064787"><a href="/crypto/x509/x509.go.html#4064648">ret</a></span><span class="op" id="4064790">[</span><span class="ident" id="4064791"><a href="/crypto/x509/x509.go.html#4064689">i</a></span><span class="op" id="4064792">]</span>&nbsp;<span class="op" id="4064794">=</span>&nbsp;<span class="ident" id="4064796"><a href="/crypto/x509/x509.go.html#4064710">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4064802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064806">return</span>&nbsp;<span class="ident" id="4064813"><a href="/crypto/x509/x509.go.html#4064648">ret</a></span><span class="op" id="4064816">,</span>&nbsp;<span class="ident" id="4064818">nil</span><br>
<span class="lineno"></span><span class="op" id="4064822">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4064825">func</span>&nbsp;<span class="ident" id="4064830">reverseBitsInAByte</span><span class="op" id="4064848">(</span><span class="ident" id="4064849">in</span>&nbsp;<span class="builtintype" id="4064852">byte</span><span class="op" id="4064856">)</span>&nbsp;<span class="builtintype" id="4064858">byte</span>&nbsp;<span class="op" id="4064863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064866">b1</span>&nbsp;<span class="op" id="4064869">:=</span>&nbsp;<span class="ident" id="4064872"><a href="/crypto/x509/x509.go.html#4064849">in</a></span><span class="op" id="4064874">&gt;&gt;</span><span class="num" id="4064876">4</span>&nbsp;<span class="op" id="4064878">|</span>&nbsp;<span class="ident" id="4064880"><a href="/crypto/x509/x509.go.html#4064849">in</a></span><span class="op" id="4064882">&lt;&lt;</span><span class="num" id="4064884">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064887">b2</span>&nbsp;<span class="op" id="4064890">:=</span>&nbsp;<span class="ident" id="4064893"><a href="/crypto/x509/x509.go.html#4064866">b1</a></span><span class="op" id="4064895">&gt;&gt;</span><span class="num" id="4064897">2</span><span class="op" id="4064898">&amp;</span><span class="num" id="4064899">0x33</span>&nbsp;<span class="op" id="4064904">|</span>&nbsp;<span class="ident" id="4064906"><a href="/crypto/x509/x509.go.html#4064866">b1</a></span><span class="op" id="4064908">&lt;&lt;</span><span class="num" id="4064910">2</span><span class="op" id="4064911">&amp;</span><span class="num" id="4064912">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064918">b3</span>&nbsp;<span class="op" id="4064921">:=</span>&nbsp;<span class="ident" id="4064924"><a href="/crypto/x509/x509.go.html#4064887">b2</a></span><span class="op" id="4064926">&gt;&gt;</span><span class="num" id="4064928">1</span><span class="op" id="4064929">&amp;</span><span class="num" id="4064930">0x55</span>&nbsp;<span class="op" id="4064935">|</span>&nbsp;<span class="ident" id="4064937"><a href="/crypto/x509/x509.go.html#4064887">b2</a></span><span class="op" id="4064939">&lt;&lt;</span><span class="num" id="4064941">1</span><span class="op" id="4064942">&amp;</span><span class="num" id="4064943">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4064949">return</span>&nbsp;<span class="ident" id="4064956"><a href="/crypto/x509/x509.go.html#4064918">b3</a></span><br>
<span class="lineno"></span><span class="op" id="4064959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4064962">var</span>&nbsp;<span class="op" id="4064966">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4064969">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065003">=</span>&nbsp;<span class="op" id="4065005">[</span><span class="op" id="4065006">]</span><span class="builtintype" id="4065007">int</span><span class="op" id="4065010">{</span><span class="num" id="4065011">2</span><span class="op" id="4065012">,</span>&nbsp;<span class="num" id="4065014">5</span><span class="op" id="4065015">,</span>&nbsp;<span class="num" id="4065017">29</span><span class="op" id="4065019">,</span>&nbsp;<span class="num" id="4065021">14</span><span class="op" id="4065023">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065026">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065060">=</span>&nbsp;<span class="op" id="4065062">[</span><span class="op" id="4065063">]</span><span class="builtintype" id="4065064">int</span><span class="op" id="4065067">{</span><span class="num" id="4065068">2</span><span class="op" id="4065069">,</span>&nbsp;<span class="num" id="4065071">5</span><span class="op" id="4065072">,</span>&nbsp;<span class="num" id="4065074">29</span><span class="op" id="4065076">,</span>&nbsp;<span class="num" id="4065078">15</span><span class="op" id="4065080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065083">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065117">=</span>&nbsp;<span class="op" id="4065119">[</span><span class="op" id="4065120">]</span><span class="builtintype" id="4065121">int</span><span class="op" id="4065124">{</span><span class="num" id="4065125">2</span><span class="op" id="4065126">,</span>&nbsp;<span class="num" id="4065128">5</span><span class="op" id="4065129">,</span>&nbsp;<span class="num" id="4065131">29</span><span class="op" id="4065133">,</span>&nbsp;<span class="num" id="4065135">37</span><span class="op" id="4065137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065140">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065174">=</span>&nbsp;<span class="op" id="4065176">[</span><span class="op" id="4065177">]</span><span class="builtintype" id="4065178">int</span><span class="op" id="4065181">{</span><span class="num" id="4065182">2</span><span class="op" id="4065183">,</span>&nbsp;<span class="num" id="4065185">5</span><span class="op" id="4065186">,</span>&nbsp;<span class="num" id="4065188">29</span><span class="op" id="4065190">,</span>&nbsp;<span class="num" id="4065192">35</span><span class="op" id="4065194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065197">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065231">=</span>&nbsp;<span class="op" id="4065233">[</span><span class="op" id="4065234">]</span><span class="builtintype" id="4065235">int</span><span class="op" id="4065238">{</span><span class="num" id="4065239">2</span><span class="op" id="4065240">,</span>&nbsp;<span class="num" id="4065242">5</span><span class="op" id="4065243">,</span>&nbsp;<span class="num" id="4065245">29</span><span class="op" id="4065247">,</span>&nbsp;<span class="num" id="4065249">19</span><span class="op" id="4065251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065254">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065288">=</span>&nbsp;<span class="op" id="4065290">[</span><span class="op" id="4065291">]</span><span class="builtintype" id="4065292">int</span><span class="op" id="4065295">{</span><span class="num" id="4065296">2</span><span class="op" id="4065297">,</span>&nbsp;<span class="num" id="4065299">5</span><span class="op" id="4065300">,</span>&nbsp;<span class="num" id="4065302">29</span><span class="op" id="4065304">,</span>&nbsp;<span class="num" id="4065306">17</span><span class="op" id="4065308">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065311">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4065345">=</span>&nbsp;<span class="op" id="4065347">[</span><span class="op" id="4065348">]</span><span class="builtintype" id="4065349">int</span><span class="op" id="4065352">{</span><span class="num" id="4065353">2</span><span class="op" id="4065354">,</span>&nbsp;<span class="num" id="4065356">5</span><span class="op" id="4065357">,</span>&nbsp;<span class="num" id="4065359">29</span><span class="op" id="4065361">,</span>&nbsp;<span class="num" id="4065363">32</span><span class="op" id="4065365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065368">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065402">=</span>&nbsp;<span class="op" id="4065404">[</span><span class="op" id="4065405">]</span><span class="builtintype" id="4065406">int</span><span class="op" id="4065409">{</span><span class="num" id="4065410">2</span><span class="op" id="4065411">,</span>&nbsp;<span class="num" id="4065413">5</span><span class="op" id="4065414">,</span>&nbsp;<span class="num" id="4065416">29</span><span class="op" id="4065418">,</span>&nbsp;<span class="num" id="4065420">30</span><span class="op" id="4065422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065425">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4065459">=</span>&nbsp;<span class="op" id="4065461">[</span><span class="op" id="4065462">]</span><span class="builtintype" id="4065463">int</span><span class="op" id="4065466">{</span><span class="num" id="4065467">2</span><span class="op" id="4065468">,</span>&nbsp;<span class="num" id="4065470">5</span><span class="op" id="4065471">,</span>&nbsp;<span class="num" id="4065473">29</span><span class="op" id="4065475">,</span>&nbsp;<span class="num" id="4065477">31</span><span class="op" id="4065479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065482">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4065516">=</span>&nbsp;<span class="op" id="4065518">[</span><span class="op" id="4065519">]</span><span class="builtintype" id="4065520">int</span><span class="op" id="4065523">{</span><span class="num" id="4065524">1</span><span class="op" id="4065525">,</span>&nbsp;<span class="num" id="4065527">3</span><span class="op" id="4065528">,</span>&nbsp;<span class="num" id="4065530">6</span><span class="op" id="4065531">,</span>&nbsp;<span class="num" id="4065533">1</span><span class="op" id="4065534">,</span>&nbsp;<span class="num" id="4065536">5</span><span class="op" id="4065537">,</span>&nbsp;<span class="num" id="4065539">5</span><span class="op" id="4065540">,</span>&nbsp;<span class="num" id="4065542">7</span><span class="op" id="4065543">,</span>&nbsp;<span class="num" id="4065545">1</span><span class="op" id="4065546">,</span>&nbsp;<span class="num" id="4065548">1</span><span class="op" id="4065549">}</span><br>
<span class="lineno"></span><span class="op" id="4065551">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4065554">var</span>&nbsp;<span class="op" id="4065558">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065561">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065591">=</span>&nbsp;<span class="ident" id="4065593"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4065597">.</span><span class="ident" id="4065598">ObjectIdentifier</span><span class="op" id="4065614">{</span><span class="num" id="4065615">1</span><span class="op" id="4065616">,</span>&nbsp;<span class="num" id="4065618">3</span><span class="op" id="4065619">,</span>&nbsp;<span class="num" id="4065621">6</span><span class="op" id="4065622">,</span>&nbsp;<span class="num" id="4065624">1</span><span class="op" id="4065625">,</span>&nbsp;<span class="num" id="4065627">5</span><span class="op" id="4065628">,</span>&nbsp;<span class="num" id="4065630">5</span><span class="op" id="4065631">,</span>&nbsp;<span class="num" id="4065633">7</span><span class="op" id="4065634">,</span>&nbsp;<span class="num" id="4065636">48</span><span class="op" id="4065638">,</span>&nbsp;<span class="num" id="4065640">1</span><span class="op" id="4065641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4065644">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4065674">=</span>&nbsp;<span class="ident" id="4065676"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4065680">.</span><span class="ident" id="4065681">ObjectIdentifier</span><span class="op" id="4065697">{</span><span class="num" id="4065698">1</span><span class="op" id="4065699">,</span>&nbsp;<span class="num" id="4065701">3</span><span class="op" id="4065702">,</span>&nbsp;<span class="num" id="4065704">6</span><span class="op" id="4065705">,</span>&nbsp;<span class="num" id="4065707">1</span><span class="op" id="4065708">,</span>&nbsp;<span class="num" id="4065710">5</span><span class="op" id="4065711">,</span>&nbsp;<span class="num" id="4065713">5</span><span class="op" id="4065714">,</span>&nbsp;<span class="num" id="4065716">7</span><span class="op" id="4065717">,</span>&nbsp;<span class="num" id="4065719">48</span><span class="op" id="4065721">,</span>&nbsp;<span class="num" id="4065723">2</span><span class="op" id="4065724">}</span><br>
<span class="lineno"></span><span class="op" id="4065726">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4065729">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4065809">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4065824">func</span>&nbsp;<span class="ident" id="4065829">oidInExtensions</span><span class="op" id="4065844">(</span><span class="ident" id="4065845">oid</span>&nbsp;<span class="ident" id="4065849"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4065853">.</span><span class="ident" id="4065854">ObjectIdentifier</span><span class="op" id="4065870">,</span>&nbsp;<span class="ident" id="4065872">extensions</span>&nbsp;<span class="op" id="4065883">[</span><span class="op" id="4065884">]</span><span class="ident" id="4065885"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4065889">.</span><span class="ident" id="4065890">Extension</span><span class="op" id="4065899">)</span>&nbsp;<span class="builtintype" id="4065901">bool</span>&nbsp;<span class="op" id="4065906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4065909">for</span>&nbsp;<span class="ident" id="4065913">_</span><span class="op" id="4065914">,</span>&nbsp;<span class="ident" id="4065916">e</span>&nbsp;<span class="op" id="4065918">:=</span>&nbsp;<span class="keyword" id="4065921">range</span>&nbsp;<span class="ident" id="4065927"><a href="/crypto/x509/x509.go.html#4065872">extensions</a></span>&nbsp;<span class="op" id="4065938">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4065942">if</span>&nbsp;<span class="ident" id="4065945"><a href="/crypto/x509/x509.go.html#4065916">e</a></span><span class="op" id="4065946">.</span><span class="ident" id="4065947">Id</span><span class="op" id="4065949">.</span><span class="ident" id="4065950">Equal</span><span class="op" id="4065955">(</span><span class="ident" id="4065956"><a href="/crypto/x509/x509.go.html#4065845">oid</a></span><span class="op" id="4065959">)</span>&nbsp;<span class="op" id="4065961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4065966">return</span>&nbsp;<span class="builtintype" id="4065973">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4065980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4065983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4065986">return</span>&nbsp;<span class="builtintype" id="4065993">false</span><br>
<span class="lineno">1165</span><span class="op" id="4065999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4066002">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4066078">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4066115">func</span>&nbsp;<span class="ident" id="4066120">marshalSANs</span><span class="op" id="4066131">(</span><span class="ident" id="4066132">dnsNames</span><span class="op" id="4066140">,</span>&nbsp;<span class="ident" id="4066142">emailAddresses</span>&nbsp;<span class="op" id="4066157">[</span><span class="op" id="4066158">]</span><span class="builtintype" id="4066159">string</span><span class="op" id="4066165">,</span>&nbsp;<span class="ident" id="4066167">ipAddresses</span>&nbsp;<span class="op" id="4066179">[</span><span class="op" id="4066180">]</span><span class="ident" id="4066181"><a href="/crypto/x509/x509.go.html#4030168">net</a></span><span class="op" id="4066184">.</span><span class="ident" id="4066185">IP</span><span class="op" id="4066187">)</span>&nbsp;<span class="op" id="4066189">(</span><span class="ident" id="4066190">derBytes</span>&nbsp;<span class="op" id="4066199">[</span><span class="op" id="4066200">]</span><span class="builtintype" id="4066201">byte</span><span class="op" id="4066205">,</span>&nbsp;<span class="ident" id="4066207">err</span>&nbsp;<span class="builtintype" id="4066211">error</span><span class="op" id="4066216">)</span>&nbsp;<span class="op" id="4066218">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066221">var</span>&nbsp;<span class="ident" id="4066225">rawValues</span>&nbsp;<span class="op" id="4066235">[</span><span class="op" id="4066236">]</span><span class="ident" id="4066237"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4066241">.</span><span class="ident" id="4066242">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066252">for</span>&nbsp;<span class="ident" id="4066256">_</span><span class="op" id="4066257">,</span>&nbsp;<span class="ident" id="4066259">name</span>&nbsp;<span class="op" id="4066264">:=</span>&nbsp;<span class="keyword" id="4066267">range</span>&nbsp;<span class="ident" id="4066273"><a href="/crypto/x509/x509.go.html#4066132">dnsNames</a></span>&nbsp;<span class="op" id="4066282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066286"><a href="/crypto/x509/x509.go.html#4066225">rawValues</a></span>&nbsp;<span class="op" id="4066296">=</span>&nbsp;<span class="builtinfunc" id="4066298">append</span><span class="op" id="4066304">(</span><span class="ident" id="4066305"><a href="/crypto/x509/x509.go.html#4066225">rawValues</a></span><span class="op" id="4066314">,</span>&nbsp;<span class="ident" id="4066316"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4066320">.</span><span class="ident" id="4066321">RawValue</span><span class="op" id="4066329">{</span><span class="ident" id="4066330">Tag</span><span class="op" id="4066333">:</span>&nbsp;<span class="num" id="4066335">2</span><span class="op" id="4066336">,</span>&nbsp;<span class="ident" id="4066338">Class</span><span class="op" id="4066343">:</span>&nbsp;<span class="num" id="4066345">2</span><span class="op" id="4066346">,</span>&nbsp;<span class="ident" id="4066348">Bytes</span><span class="op" id="4066353">:</span>&nbsp;<span class="op" id="4066355">[</span><span class="op" id="4066356">]</span><span class="builtintype" id="4066357">byte</span><span class="op" id="4066361">(</span><span class="ident" id="4066362"><a href="/crypto/x509/x509.go.html#4066259">name</a></span><span class="op" id="4066366">)</span><span class="op" id="4066367">}</span><span class="op" id="4066368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4066371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066374">for</span>&nbsp;<span class="ident" id="4066378">_</span><span class="op" id="4066379">,</span>&nbsp;<span class="ident" id="4066381">email</span>&nbsp;<span class="op" id="4066387">:=</span>&nbsp;<span class="keyword" id="4066390">range</span>&nbsp;<span class="ident" id="4066396"><a href="/crypto/x509/x509.go.html#4066142">emailAddresses</a></span>&nbsp;<span class="op" id="4066411">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066415"><a href="/crypto/x509/x509.go.html#4066225">rawValues</a></span>&nbsp;<span class="op" id="4066425">=</span>&nbsp;<span class="builtinfunc" id="4066427">append</span><span class="op" id="4066433">(</span><span class="ident" id="4066434"><a href="/crypto/x509/x509.go.html#4066225">rawValues</a></span><span class="op" id="4066443">,</span>&nbsp;<span class="ident" id="4066445"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4066449">.</span><span class="ident" id="4066450">RawValue</span><span class="op" id="4066458">{</span><span class="ident" id="4066459">Tag</span><span class="op" id="4066462">:</span>&nbsp;<span class="num" id="4066464">1</span><span class="op" id="4066465">,</span>&nbsp;<span class="ident" id="4066467">Class</span><span class="op" id="4066472">:</span>&nbsp;<span class="num" id="4066474">2</span><span class="op" id="4066475">,</span>&nbsp;<span class="ident" id="4066477">Bytes</span><span class="op" id="4066482">:</span>&nbsp;<span class="op" id="4066484">[</span><span class="op" id="4066485">]</span><span class="builtintype" id="4066486">byte</span><span class="op" id="4066490">(</span><span class="ident" id="4066491"><a href="/crypto/x509/x509.go.html#4066381">email</a></span><span class="op" id="4066496">)</span><span class="op" id="4066497">}</span><span class="op" id="4066498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4066501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066504">for</span>&nbsp;<span class="ident" id="4066508">_</span><span class="op" id="4066509">,</span>&nbsp;<span class="ident" id="4066511">rawIP</span>&nbsp;<span class="op" id="4066517">:=</span>&nbsp;<span class="keyword" id="4066520">range</span>&nbsp;<span class="ident" id="4066526"><a href="/crypto/x509/x509.go.html#4066167">ipAddresses</a></span>&nbsp;<span class="op" id="4066538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066542">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066612">ip</span>&nbsp;<span class="op" id="4066615">:=</span>&nbsp;<span class="ident" id="4066618"><a href="/crypto/x509/x509.go.html#4066511">rawIP</a></span><span class="op" id="4066623">.</span><span class="ident" id="4066624">To4</span><span class="op" id="4066627">(</span><span class="op" id="4066628">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066632">if</span>&nbsp;<span class="ident" id="4066635"><a href="/crypto/x509/x509.go.html#4066612">ip</a></span>&nbsp;<span class="op" id="4066638">==</span>&nbsp;<span class="ident" id="4066641">nil</span>&nbsp;<span class="op" id="4066645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066650"><a href="/crypto/x509/x509.go.html#4066612">ip</a></span>&nbsp;<span class="op" id="4066653">=</span>&nbsp;<span class="ident" id="4066655"><a href="/crypto/x509/x509.go.html#4066511">rawIP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4066663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066667"><a href="/crypto/x509/x509.go.html#4066225">rawValues</a></span>&nbsp;<span class="op" id="4066677">=</span>&nbsp;<span class="builtinfunc" id="4066679">append</span><span class="op" id="4066685">(</span><span class="ident" id="4066686"><a href="/crypto/x509/x509.go.html#4066225">rawValues</a></span><span class="op" id="4066695">,</span>&nbsp;<span class="ident" id="4066697"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4066701">.</span><span class="ident" id="4066702">RawValue</span><span class="op" id="4066710">{</span><span class="ident" id="4066711">Tag</span><span class="op" id="4066714">:</span>&nbsp;<span class="num" id="4066716">7</span><span class="op" id="4066717">,</span>&nbsp;<span class="ident" id="4066719">Class</span><span class="op" id="4066724">:</span>&nbsp;<span class="num" id="4066726">2</span><span class="op" id="4066727">,</span>&nbsp;<span class="ident" id="4066729">Bytes</span><span class="op" id="4066734">:</span>&nbsp;<span class="ident" id="4066736"><a href="/crypto/x509/x509.go.html#4066612">ip</a></span><span class="op" id="4066738">}</span><span class="op" id="4066739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4066742">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066745">return</span>&nbsp;<span class="ident" id="4066752"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4066756">.</span><span class="ident" id="4066757">Marshal</span><span class="op" id="4066764">(</span><span class="ident" id="4066765"><a href="/crypto/x509/x509.go.html#4066225">rawValues</a></span><span class="op" id="4066774">)</span><br>
<span class="lineno"></span><span class="op" id="4066776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4066779">func</span>&nbsp;<span class="ident" id="4066784">buildExtensions</span><span class="op" id="4066799">(</span><span class="ident" id="4066800">template</span>&nbsp;<span class="op" id="4066809">*</span><span class="ident" id="4066810"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4066821">)</span>&nbsp;<span class="op" id="4066823">(</span><span class="ident" id="4066824">ret</span>&nbsp;<span class="op" id="4066828">[</span><span class="op" id="4066829">]</span><span class="ident" id="4066830"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4066834">.</span><span class="ident" id="4066835">Extension</span><span class="op" id="4066844">,</span>&nbsp;<span class="ident" id="4066846">err</span>&nbsp;<span class="builtintype" id="4066850">error</span><span class="op" id="4066855">)</span>&nbsp;<span class="op" id="4066857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066860"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span>&nbsp;<span class="op" id="4066864">=</span>&nbsp;<span class="builtinfunc" id="4066866">make</span><span class="op" id="4066870">(</span><span class="op" id="4066871">[</span><span class="op" id="4066872">]</span><span class="ident" id="4066873"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4066877">.</span><span class="ident" id="4066878">Extension</span><span class="op" id="4066887">,</span>&nbsp;<span class="num" id="4066889">10</span>&nbsp;<span class="comment" id="4066892">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4066925">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066928">n</span>&nbsp;<span class="op" id="4066930">:=</span>&nbsp;<span class="num" id="4066933">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4066937">if</span>&nbsp;<span class="ident" id="4066940"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4066948">.</span><span class="ident" id="4066949">KeyUsage</span>&nbsp;<span class="op" id="4066958">!=</span>&nbsp;<span class="num" id="4066961">0</span>&nbsp;<span class="op" id="4066963">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4066968">!</span><span class="ident" id="4066969"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4066984">(</span><span class="ident" id="4066985"><a href="/crypto/x509/x509.go.html#4065026">oidExtensionKeyUsage</a></span><span class="op" id="4067005">,</span>&nbsp;<span class="ident" id="4067007"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067015">.</span><span class="ident" id="4067016">ExtraExtensions</span><span class="op" id="4067031">)</span>&nbsp;<span class="op" id="4067033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067037"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4067040">[</span><span class="ident" id="4067041"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4067042">]</span><span class="op" id="4067043">.</span><span class="ident" id="4067044">Id</span>&nbsp;<span class="op" id="4067047">=</span>&nbsp;<span class="ident" id="4067049"><a href="/crypto/x509/x509.go.html#4065026">oidExtensionKeyUsage</a></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067072"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4067075">[</span><span class="ident" id="4067076"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4067077">]</span><span class="op" id="4067078">.</span><span class="ident" id="4067079">Critical</span>&nbsp;<span class="op" id="4067088">=</span>&nbsp;<span class="builtintype" id="4067090">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067098">var</span>&nbsp;<span class="ident" id="4067102">a</span>&nbsp;<span class="op" id="4067104">[</span><span class="num" id="4067105">2</span><span class="op" id="4067106">]</span><span class="builtintype" id="4067107">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067114"><a href="/crypto/x509/x509.go.html#4067102">a</a></span><span class="op" id="4067115">[</span><span class="num" id="4067116">0</span><span class="op" id="4067117">]</span>&nbsp;<span class="op" id="4067119">=</span>&nbsp;<span class="ident" id="4067121"><a href="/crypto/x509/x509.go.html#4064830">reverseBitsInAByte</a></span><span class="op" id="4067139">(</span><span class="builtintype" id="4067140">byte</span><span class="op" id="4067144">(</span><span class="ident" id="4067145"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067153">.</span><span class="ident" id="4067154">KeyUsage</span><span class="op" id="4067162">)</span><span class="op" id="4067163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067167"><a href="/crypto/x509/x509.go.html#4067102">a</a></span><span class="op" id="4067168">[</span><span class="num" id="4067169">1</span><span class="op" id="4067170">]</span>&nbsp;<span class="op" id="4067172">=</span>&nbsp;<span class="ident" id="4067174"><a href="/crypto/x509/x509.go.html#4064830">reverseBitsInAByte</a></span><span class="op" id="4067192">(</span><span class="builtintype" id="4067193">byte</span><span class="op" id="4067197">(</span><span class="ident" id="4067198"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067206">.</span><span class="ident" id="4067207">KeyUsage</span>&nbsp;<span class="op" id="4067216">&gt;&gt;</span>&nbsp;<span class="num" id="4067219">8</span><span class="op" id="4067220">)</span><span class="op" id="4067221">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067226">l</span>&nbsp;<span class="op" id="4067228">:=</span>&nbsp;<span class="num" id="4067231">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067235">if</span>&nbsp;<span class="ident" id="4067238"><a href="/crypto/x509/x509.go.html#4067102">a</a></span><span class="op" id="4067239">[</span><span class="num" id="4067240">1</span><span class="op" id="4067241">]</span>&nbsp;<span class="op" id="4067243">!=</span>&nbsp;<span class="num" id="4067246">0</span>&nbsp;<span class="op" id="4067248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067253"><a href="/crypto/x509/x509.go.html#4067226">l</a></span>&nbsp;<span class="op" id="4067255">=</span>&nbsp;<span class="num" id="4067257">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067261">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067266"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4067269">[</span><span class="ident" id="4067270"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4067271">]</span><span class="op" id="4067272">.</span><span class="ident" id="4067273">Value</span><span class="op" id="4067278">,</span>&nbsp;<span class="ident" id="4067280"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4067284">=</span>&nbsp;<span class="ident" id="4067286"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4067290">.</span><span class="ident" id="4067291">Marshal</span><span class="op" id="4067298">(</span><span class="ident" id="4067299"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4067303">.</span><span class="ident" id="4067304">BitString</span><span class="op" id="4067313">{</span><span class="ident" id="4067314">Bytes</span><span class="op" id="4067319">:</span>&nbsp;<span class="ident" id="4067321"><a href="/crypto/x509/x509.go.html#4067102">a</a></span><span class="op" id="4067322">[</span><span class="num" id="4067323">0</span><span class="op" id="4067324">:</span><span class="ident" id="4067325"><a href="/crypto/x509/x509.go.html#4067226">l</a></span><span class="op" id="4067326">]</span><span class="op" id="4067327">,</span>&nbsp;<span class="ident" id="4067329">BitLength</span><span class="op" id="4067338">:</span>&nbsp;<span class="ident" id="4067340"><a href="/crypto/x509/x509.go.html#4067226">l</a></span>&nbsp;<span class="op" id="4067342">*</span>&nbsp;<span class="num" id="4067344">8</span><span class="op" id="4067345">}</span><span class="op" id="4067346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067350">if</span>&nbsp;<span class="ident" id="4067353"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4067357">!=</span>&nbsp;<span class="ident" id="4067360">nil</span>&nbsp;<span class="op" id="4067364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067369">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067378">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067382"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4067383">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067391">if</span>&nbsp;<span class="op" id="4067394">(</span><span class="builtinfunc" id="4067395">len</span><span class="op" id="4067398">(</span><span class="ident" id="4067399"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067407">.</span><span class="ident" id="4067408">ExtKeyUsage</span><span class="op" id="4067419">)</span>&nbsp;<span class="op" id="4067421">&gt;</span>&nbsp;<span class="num" id="4067423">0</span>&nbsp;<span class="op" id="4067425">||</span>&nbsp;<span class="builtinfunc" id="4067428">len</span><span class="op" id="4067431">(</span><span class="ident" id="4067432"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067440">.</span><span class="ident" id="4067441">UnknownExtKeyUsage</span><span class="op" id="4067459">)</span>&nbsp;<span class="op" id="4067461">&gt;</span>&nbsp;<span class="num" id="4067463">0</span><span class="op" id="4067464">)</span>&nbsp;<span class="op" id="4067466">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067471">!</span><span class="ident" id="4067472"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4067487">(</span><span class="ident" id="4067488"><a href="/crypto/x509/x509.go.html#4065083">oidExtensionExtendedKeyUsage</a></span><span class="op" id="4067516">,</span>&nbsp;<span class="ident" id="4067518"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067526">.</span><span class="ident" id="4067527">ExtraExtensions</span><span class="op" id="4067542">)</span>&nbsp;<span class="op" id="4067544">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067548"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4067551">[</span><span class="ident" id="4067552"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4067553">]</span><span class="op" id="4067554">.</span><span class="ident" id="4067555">Id</span>&nbsp;<span class="op" id="4067558">=</span>&nbsp;<span class="ident" id="4067560"><a href="/crypto/x509/x509.go.html#4065083">oidExtensionExtendedKeyUsage</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067592">var</span>&nbsp;<span class="ident" id="4067596">oids</span>&nbsp;<span class="op" id="4067601">[</span><span class="op" id="4067602">]</span><span class="ident" id="4067603"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4067607">.</span><span class="ident" id="4067608">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067627">for</span>&nbsp;<span class="ident" id="4067631">_</span><span class="op" id="4067632">,</span>&nbsp;<span class="ident" id="4067634">u</span>&nbsp;<span class="op" id="4067636">:=</span>&nbsp;<span class="keyword" id="4067639">range</span>&nbsp;<span class="ident" id="4067645"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067653">.</span><span class="ident" id="4067654">ExtKeyUsage</span>&nbsp;<span class="op" id="4067666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067671">if</span>&nbsp;<span class="ident" id="4067674">oid</span><span class="op" id="4067677">,</span>&nbsp;<span class="ident" id="4067679">ok</span>&nbsp;<span class="op" id="4067682">:=</span>&nbsp;<span class="ident" id="4067685"><a href="/crypto/x509/x509.go.html#4043956">oidFromExtKeyUsage</a></span><span class="op" id="4067703">(</span><span class="ident" id="4067704"><a href="/crypto/x509/x509.go.html#4067634">u</a></span><span class="op" id="4067705">)</span><span class="op" id="4067706">;</span>&nbsp;<span class="ident" id="4067708"><a href="/crypto/x509/x509.go.html#4067679">ok</a></span>&nbsp;<span class="op" id="4067711">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067717"><a href="/crypto/x509/x509.go.html#4067596">oids</a></span>&nbsp;<span class="op" id="4067722">=</span>&nbsp;<span class="builtinfunc" id="4067724">append</span><span class="op" id="4067730">(</span><span class="ident" id="4067731"><a href="/crypto/x509/x509.go.html#4067596">oids</a></span><span class="op" id="4067735">,</span>&nbsp;<span class="ident" id="4067737"><a href="/crypto/x509/x509.go.html#4067674">oid</a></span><span class="op" id="4067740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067745">}</span>&nbsp;<span class="keyword" id="4067747">else</span>&nbsp;<span class="op" id="4067752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4067758">panic</span><span class="op" id="4067763">(</span><span class="string" id="4067764">&#34;internal&nbsp;error&#34;</span><span class="op" id="4067780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067789">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067794"><a href="/crypto/x509/x509.go.html#4067596">oids</a></span>&nbsp;<span class="op" id="4067799">=</span>&nbsp;<span class="builtinfunc" id="4067801">append</span><span class="op" id="4067807">(</span><span class="ident" id="4067808"><a href="/crypto/x509/x509.go.html#4067596">oids</a></span><span class="op" id="4067812">,</span>&nbsp;<span class="ident" id="4067814"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067822">.</span><span class="ident" id="4067823">UnknownExtKeyUsage</span><span class="op" id="4067841">...</span><span class="op" id="4067844">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067849"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4067852">[</span><span class="ident" id="4067853"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4067854">]</span><span class="op" id="4067855">.</span><span class="ident" id="4067856">Value</span><span class="op" id="4067861">,</span>&nbsp;<span class="ident" id="4067863"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4067867">=</span>&nbsp;<span class="ident" id="4067869"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4067873">.</span><span class="ident" id="4067874">Marshal</span><span class="op" id="4067881">(</span><span class="ident" id="4067882"><a href="/crypto/x509/x509.go.html#4067596">oids</a></span><span class="op" id="4067886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067890">if</span>&nbsp;<span class="ident" id="4067893"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4067897">!=</span>&nbsp;<span class="ident" id="4067900">nil</span>&nbsp;<span class="op" id="4067904">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067909">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067922"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4067923">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4067927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067931">if</span>&nbsp;<span class="ident" id="4067934"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4067942">.</span><span class="ident" id="4067943">BasicConstraintsValid</span>&nbsp;<span class="op" id="4067965">&amp;&amp;</span>&nbsp;<span class="op" id="4067968">!</span><span class="ident" id="4067969"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4067984">(</span><span class="ident" id="4067985"><a href="/crypto/x509/x509.go.html#4065197">oidExtensionBasicConstraints</a></span><span class="op" id="4068013">,</span>&nbsp;<span class="ident" id="4068015"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068023">.</span><span class="ident" id="4068024">ExtraExtensions</span><span class="op" id="4068039">)</span>&nbsp;<span class="op" id="4068041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4068045">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4068108">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4068173">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068232">maxPathLen</span>&nbsp;<span class="op" id="4068243">:=</span>&nbsp;<span class="ident" id="4068246"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068254">.</span><span class="ident" id="4068255">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068268">if</span>&nbsp;<span class="ident" id="4068271"><a href="/crypto/x509/x509.go.html#4068232">maxPathLen</a></span>&nbsp;<span class="op" id="4068282">==</span>&nbsp;<span class="num" id="4068285">0</span>&nbsp;<span class="op" id="4068287">&amp;&amp;</span>&nbsp;<span class="op" id="4068290">!</span><span class="ident" id="4068291"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068299">.</span><span class="ident" id="4068300">MaxPathLenZero</span>&nbsp;<span class="op" id="4068315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068320"><a href="/crypto/x509/x509.go.html#4068232">maxPathLen</a></span>&nbsp;<span class="op" id="4068331">=</span>&nbsp;<span class="op" id="4068333">-</span><span class="num" id="4068334">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068342"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4068345">[</span><span class="ident" id="4068346"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068347">]</span><span class="op" id="4068348">.</span><span class="ident" id="4068349">Id</span>&nbsp;<span class="op" id="4068352">=</span>&nbsp;<span class="ident" id="4068354"><a href="/crypto/x509/x509.go.html#4065197">oidExtensionBasicConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068385"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4068388">[</span><span class="ident" id="4068389"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068390">]</span><span class="op" id="4068391">.</span><span class="ident" id="4068392">Value</span><span class="op" id="4068397">,</span>&nbsp;<span class="ident" id="4068399"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4068403">=</span>&nbsp;<span class="ident" id="4068405"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4068409">.</span><span class="ident" id="4068410">Marshal</span><span class="op" id="4068417">(</span><span class="ident" id="4068418"><a href="/crypto/x509/x509.go.html#4052787">basicConstraints</a></span><span class="op" id="4068434">{</span><span class="ident" id="4068435"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068443">.</span><span class="ident" id="4068444">IsCA</span><span class="op" id="4068448">,</span>&nbsp;<span class="ident" id="4068450"><a href="/crypto/x509/x509.go.html#4068232">maxPathLen</a></span><span class="op" id="4068460">}</span><span class="op" id="4068461">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068465"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4068468">[</span><span class="ident" id="4068469"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068470">]</span><span class="op" id="4068471">.</span><span class="ident" id="4068472">Critical</span>&nbsp;<span class="op" id="4068481">=</span>&nbsp;<span class="builtintype" id="4068483">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068490">if</span>&nbsp;<span class="ident" id="4068493"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4068497">!=</span>&nbsp;<span class="ident" id="4068500">nil</span>&nbsp;<span class="op" id="4068504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068509">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068522"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068523">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068531">if</span>&nbsp;<span class="builtinfunc" id="4068534">len</span><span class="op" id="4068537">(</span><span class="ident" id="4068538"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068546">.</span><span class="ident" id="4068547">SubjectKeyId</span><span class="op" id="4068559">)</span>&nbsp;<span class="op" id="4068561">&gt;</span>&nbsp;<span class="num" id="4068563">0</span>&nbsp;<span class="op" id="4068565">&amp;&amp;</span>&nbsp;<span class="op" id="4068568">!</span><span class="ident" id="4068569"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4068584">(</span><span class="ident" id="4068585"><a href="/crypto/x509/x509.go.html#4064969">oidExtensionSubjectKeyId</a></span><span class="op" id="4068609">,</span>&nbsp;<span class="ident" id="4068611"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068619">.</span><span class="ident" id="4068620">ExtraExtensions</span><span class="op" id="4068635">)</span>&nbsp;<span class="op" id="4068637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068641"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4068644">[</span><span class="ident" id="4068645"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068646">]</span><span class="op" id="4068647">.</span><span class="ident" id="4068648">Id</span>&nbsp;<span class="op" id="4068651">=</span>&nbsp;<span class="ident" id="4068653"><a href="/crypto/x509/x509.go.html#4064969">oidExtensionSubjectKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068680"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4068683">[</span><span class="ident" id="4068684"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068685">]</span><span class="op" id="4068686">.</span><span class="ident" id="4068687">Value</span><span class="op" id="4068692">,</span>&nbsp;<span class="ident" id="4068694"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4068698">=</span>&nbsp;<span class="ident" id="4068700"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4068704">.</span><span class="ident" id="4068705">Marshal</span><span class="op" id="4068712">(</span><span class="ident" id="4068713"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068721">.</span><span class="ident" id="4068722">SubjectKeyId</span><span class="op" id="4068734">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068738">if</span>&nbsp;<span class="ident" id="4068741"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4068745">!=</span>&nbsp;<span class="ident" id="4068748">nil</span>&nbsp;<span class="op" id="4068752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068757">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068770"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068771">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068775">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068779">if</span>&nbsp;<span class="builtinfunc" id="4068782">len</span><span class="op" id="4068785">(</span><span class="ident" id="4068786"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068794">.</span><span class="ident" id="4068795">AuthorityKeyId</span><span class="op" id="4068809">)</span>&nbsp;<span class="op" id="4068811">&gt;</span>&nbsp;<span class="num" id="4068813">0</span>&nbsp;<span class="op" id="4068815">&amp;&amp;</span>&nbsp;<span class="op" id="4068818">!</span><span class="ident" id="4068819"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4068834">(</span><span class="ident" id="4068835"><a href="/crypto/x509/x509.go.html#4065140">oidExtensionAuthorityKeyId</a></span><span class="op" id="4068861">,</span>&nbsp;<span class="ident" id="4068863"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068871">.</span><span class="ident" id="4068872">ExtraExtensions</span><span class="op" id="4068887">)</span>&nbsp;<span class="op" id="4068889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068893"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4068896">[</span><span class="ident" id="4068897"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068898">]</span><span class="op" id="4068899">.</span><span class="ident" id="4068900">Id</span>&nbsp;<span class="op" id="4068903">=</span>&nbsp;<span class="ident" id="4068905"><a href="/crypto/x509/x509.go.html#4065140">oidExtensionAuthorityKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068934"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4068937">[</span><span class="ident" id="4068938"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4068939">]</span><span class="op" id="4068940">.</span><span class="ident" id="4068941">Value</span><span class="op" id="4068946">,</span>&nbsp;<span class="ident" id="4068948"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4068952">=</span>&nbsp;<span class="ident" id="4068954"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4068958">.</span><span class="ident" id="4068959">Marshal</span><span class="op" id="4068966">(</span><span class="ident" id="4068967"><a href="/crypto/x509/x509.go.html#4033688">authKeyId</a></span><span class="op" id="4068976">{</span><span class="ident" id="4068977"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4068985">.</span><span class="ident" id="4068986">AuthorityKeyId</span><span class="op" id="4069000">}</span><span class="op" id="4069001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069005">if</span>&nbsp;<span class="ident" id="4069008"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4069012">!=</span>&nbsp;<span class="ident" id="4069015">nil</span>&nbsp;<span class="op" id="4069019">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069024">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069037"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4069038">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069046">if</span>&nbsp;<span class="op" id="4069049">(</span><span class="builtinfunc" id="4069050">len</span><span class="op" id="4069053">(</span><span class="ident" id="4069054"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069062">.</span><span class="ident" id="4069063">OCSPServer</span><span class="op" id="4069073">)</span>&nbsp;<span class="op" id="4069075">&gt;</span>&nbsp;<span class="num" id="4069077">0</span>&nbsp;<span class="op" id="4069079">||</span>&nbsp;<span class="builtinfunc" id="4069082">len</span><span class="op" id="4069085">(</span><span class="ident" id="4069086"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069094">.</span><span class="ident" id="4069095">IssuingCertificateURL</span><span class="op" id="4069116">)</span>&nbsp;<span class="op" id="4069118">&gt;</span>&nbsp;<span class="num" id="4069120">0</span><span class="op" id="4069121">)</span>&nbsp;<span class="op" id="4069123">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069128">!</span><span class="ident" id="4069129"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4069144">(</span><span class="ident" id="4069145"><a href="/crypto/x509/x509.go.html#4065482">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="4069176">,</span>&nbsp;<span class="ident" id="4069178"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069186">.</span><span class="ident" id="4069187">ExtraExtensions</span><span class="op" id="4069202">)</span>&nbsp;<span class="op" id="4069204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069208"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4069211">[</span><span class="ident" id="4069212"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4069213">]</span><span class="op" id="4069214">.</span><span class="ident" id="4069215">Id</span>&nbsp;<span class="op" id="4069218">=</span>&nbsp;<span class="ident" id="4069220"><a href="/crypto/x509/x509.go.html#4065482">oidExtensionAuthorityInfoAccess</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069254">var</span>&nbsp;<span class="ident" id="4069258">aiaValues</span>&nbsp;<span class="op" id="4069268">[</span><span class="op" id="4069269">]</span><span class="ident" id="4069270"><a href="/crypto/x509/x509.go.html#4053269">authorityInfoAccess</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069292">for</span>&nbsp;<span class="ident" id="4069296">_</span><span class="op" id="4069297">,</span>&nbsp;<span class="ident" id="4069299">name</span>&nbsp;<span class="op" id="4069304">:=</span>&nbsp;<span class="keyword" id="4069307">range</span>&nbsp;<span class="ident" id="4069313"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069321">.</span><span class="ident" id="4069322">OCSPServer</span>&nbsp;<span class="op" id="4069333">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069338"><a href="/crypto/x509/x509.go.html#4069258">aiaValues</a></span>&nbsp;<span class="op" id="4069348">=</span>&nbsp;<span class="builtinfunc" id="4069350">append</span><span class="op" id="4069356">(</span><span class="ident" id="4069357"><a href="/crypto/x509/x509.go.html#4069258">aiaValues</a></span><span class="op" id="4069366">,</span>&nbsp;<span class="ident" id="4069368"><a href="/crypto/x509/x509.go.html#4053269">authorityInfoAccess</a></span><span class="op" id="4069387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069393">Method</span><span class="op" id="4069399">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4069403"><a href="/crypto/x509/x509.go.html#4065561">oidAuthorityInfoAccessOcsp</a></span><span class="op" id="4069429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069435">Location</span><span class="op" id="4069443">:</span>&nbsp;<span class="ident" id="4069445"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4069449">.</span><span class="ident" id="4069450">RawValue</span><span class="op" id="4069458">{</span><span class="ident" id="4069459">Tag</span><span class="op" id="4069462">:</span>&nbsp;<span class="num" id="4069464">6</span><span class="op" id="4069465">,</span>&nbsp;<span class="ident" id="4069467">Class</span><span class="op" id="4069472">:</span>&nbsp;<span class="num" id="4069474">2</span><span class="op" id="4069475">,</span>&nbsp;<span class="ident" id="4069477">Bytes</span><span class="op" id="4069482">:</span>&nbsp;<span class="op" id="4069484">[</span><span class="op" id="4069485">]</span><span class="builtintype" id="4069486">byte</span><span class="op" id="4069490">(</span><span class="ident" id="4069491"><a href="/crypto/x509/x509.go.html#4069299">name</a></span><span class="op" id="4069495">)</span><span class="op" id="4069496">}</span><span class="op" id="4069497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069502">}</span><span class="op" id="4069503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069507">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069511">for</span>&nbsp;<span class="ident" id="4069515">_</span><span class="op" id="4069516">,</span>&nbsp;<span class="ident" id="4069518">name</span>&nbsp;<span class="op" id="4069523">:=</span>&nbsp;<span class="keyword" id="4069526">range</span>&nbsp;<span class="ident" id="4069532"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069540">.</span><span class="ident" id="4069541">IssuingCertificateURL</span>&nbsp;<span class="op" id="4069563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069568"><a href="/crypto/x509/x509.go.html#4069258">aiaValues</a></span>&nbsp;<span class="op" id="4069578">=</span>&nbsp;<span class="builtinfunc" id="4069580">append</span><span class="op" id="4069586">(</span><span class="ident" id="4069587"><a href="/crypto/x509/x509.go.html#4069258">aiaValues</a></span><span class="op" id="4069596">,</span>&nbsp;<span class="ident" id="4069598"><a href="/crypto/x509/x509.go.html#4053269">authorityInfoAccess</a></span><span class="op" id="4069617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069623">Method</span><span class="op" id="4069629">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4069633"><a href="/crypto/x509/x509.go.html#4065644">oidAuthorityInfoAccessIssuers</a></span><span class="op" id="4069662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069668">Location</span><span class="op" id="4069676">:</span>&nbsp;<span class="ident" id="4069678"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4069682">.</span><span class="ident" id="4069683">RawValue</span><span class="op" id="4069691">{</span><span class="ident" id="4069692">Tag</span><span class="op" id="4069695">:</span>&nbsp;<span class="num" id="4069697">6</span><span class="op" id="4069698">,</span>&nbsp;<span class="ident" id="4069700">Class</span><span class="op" id="4069705">:</span>&nbsp;<span class="num" id="4069707">2</span><span class="op" id="4069708">,</span>&nbsp;<span class="ident" id="4069710">Bytes</span><span class="op" id="4069715">:</span>&nbsp;<span class="op" id="4069717">[</span><span class="op" id="4069718">]</span><span class="builtintype" id="4069719">byte</span><span class="op" id="4069723">(</span><span class="ident" id="4069724"><a href="/crypto/x509/x509.go.html#4069518">name</a></span><span class="op" id="4069728">)</span><span class="op" id="4069729">}</span><span class="op" id="4069730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069735">}</span><span class="op" id="4069736">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069744"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4069747">[</span><span class="ident" id="4069748"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4069749">]</span><span class="op" id="4069750">.</span><span class="ident" id="4069751">Value</span><span class="op" id="4069756">,</span>&nbsp;<span class="ident" id="4069758"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4069762">=</span>&nbsp;<span class="ident" id="4069764"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4069768">.</span><span class="ident" id="4069769">Marshal</span><span class="op" id="4069776">(</span><span class="ident" id="4069777"><a href="/crypto/x509/x509.go.html#4069258">aiaValues</a></span><span class="op" id="4069786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069790">if</span>&nbsp;<span class="ident" id="4069793"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4069797">!=</span>&nbsp;<span class="ident" id="4069800">nil</span>&nbsp;<span class="op" id="4069804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069809">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069818">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069822"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4069823">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4069831">if</span>&nbsp;<span class="op" id="4069834">(</span><span class="builtinfunc" id="4069835">len</span><span class="op" id="4069838">(</span><span class="ident" id="4069839"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069847">.</span><span class="ident" id="4069848">DNSNames</span><span class="op" id="4069856">)</span>&nbsp;<span class="op" id="4069858">&gt;</span>&nbsp;<span class="num" id="4069860">0</span>&nbsp;<span class="op" id="4069862">||</span>&nbsp;<span class="builtinfunc" id="4069865">len</span><span class="op" id="4069868">(</span><span class="ident" id="4069869"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069877">.</span><span class="ident" id="4069878">EmailAddresses</span><span class="op" id="4069892">)</span>&nbsp;<span class="op" id="4069894">&gt;</span>&nbsp;<span class="num" id="4069896">0</span>&nbsp;<span class="op" id="4069898">||</span>&nbsp;<span class="builtinfunc" id="4069901">len</span><span class="op" id="4069904">(</span><span class="ident" id="4069905"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069913">.</span><span class="ident" id="4069914">IPAddresses</span><span class="op" id="4069925">)</span>&nbsp;<span class="op" id="4069927">&gt;</span>&nbsp;<span class="num" id="4069929">0</span><span class="op" id="4069930">)</span>&nbsp;<span class="op" id="4069932">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4069937">!</span><span class="ident" id="4069938"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4069953">(</span><span class="ident" id="4069954"><a href="/crypto/x509/x509.go.html#4065254">oidExtensionSubjectAltName</a></span><span class="op" id="4069980">,</span>&nbsp;<span class="ident" id="4069982"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4069990">.</span><span class="ident" id="4069991">ExtraExtensions</span><span class="op" id="4070006">)</span>&nbsp;<span class="op" id="4070008">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070012"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4070015">[</span><span class="ident" id="4070016"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4070017">]</span><span class="op" id="4070018">.</span><span class="ident" id="4070019">Id</span>&nbsp;<span class="op" id="4070022">=</span>&nbsp;<span class="ident" id="4070024"><a href="/crypto/x509/x509.go.html#4065254">oidExtensionSubjectAltName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070053"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4070056">[</span><span class="ident" id="4070057"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4070058">]</span><span class="op" id="4070059">.</span><span class="ident" id="4070060">Value</span><span class="op" id="4070065">,</span>&nbsp;<span class="ident" id="4070067"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4070071">=</span>&nbsp;<span class="ident" id="4070073"><a href="/crypto/x509/x509.go.html#4066120">marshalSANs</a></span><span class="op" id="4070084">(</span><span class="ident" id="4070085"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070093">.</span><span class="ident" id="4070094">DNSNames</span><span class="op" id="4070102">,</span>&nbsp;<span class="ident" id="4070104"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070112">.</span><span class="ident" id="4070113">EmailAddresses</span><span class="op" id="4070127">,</span>&nbsp;<span class="ident" id="4070129"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070137">.</span><span class="ident" id="4070138">IPAddresses</span><span class="op" id="4070149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070153">if</span>&nbsp;<span class="ident" id="4070156"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4070160">!=</span>&nbsp;<span class="ident" id="4070163">nil</span>&nbsp;<span class="op" id="4070167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070172">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070181">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070185"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4070186">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070194">if</span>&nbsp;<span class="builtinfunc" id="4070197">len</span><span class="op" id="4070200">(</span><span class="ident" id="4070201"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070209">.</span><span class="ident" id="4070210">PolicyIdentifiers</span><span class="op" id="4070227">)</span>&nbsp;<span class="op" id="4070229">&gt;</span>&nbsp;<span class="num" id="4070231">0</span>&nbsp;<span class="op" id="4070233">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070238">!</span><span class="ident" id="4070239"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4070254">(</span><span class="ident" id="4070255"><a href="/crypto/x509/x509.go.html#4065311">oidExtensionCertificatePolicies</a></span><span class="op" id="4070286">,</span>&nbsp;<span class="ident" id="4070288"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070296">.</span><span class="ident" id="4070297">ExtraExtensions</span><span class="op" id="4070312">)</span>&nbsp;<span class="op" id="4070314">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070318"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4070321">[</span><span class="ident" id="4070322"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4070323">]</span><span class="op" id="4070324">.</span><span class="ident" id="4070325">Id</span>&nbsp;<span class="op" id="4070328">=</span>&nbsp;<span class="ident" id="4070330"><a href="/crypto/x509/x509.go.html#4065311">oidExtensionCertificatePolicies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070364">policies</span>&nbsp;<span class="op" id="4070373">:=</span>&nbsp;<span class="builtinfunc" id="4070376">make</span><span class="op" id="4070380">(</span><span class="op" id="4070381">[</span><span class="op" id="4070382">]</span><span class="ident" id="4070383"><a href="/crypto/x509/x509.go.html#4052922">policyInformation</a></span><span class="op" id="4070400">,</span>&nbsp;<span class="builtinfunc" id="4070402">len</span><span class="op" id="4070405">(</span><span class="ident" id="4070406"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070414">.</span><span class="ident" id="4070415">PolicyIdentifiers</span><span class="op" id="4070432">)</span><span class="op" id="4070433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070437">for</span>&nbsp;<span class="ident" id="4070441">i</span><span class="op" id="4070442">,</span>&nbsp;<span class="ident" id="4070444">policy</span>&nbsp;<span class="op" id="4070451">:=</span>&nbsp;<span class="keyword" id="4070454">range</span>&nbsp;<span class="ident" id="4070460"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070468">.</span><span class="ident" id="4070469">PolicyIdentifiers</span>&nbsp;<span class="op" id="4070487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070492"><a href="/crypto/x509/x509.go.html#4070364">policies</a></span><span class="op" id="4070500">[</span><span class="ident" id="4070501"><a href="/crypto/x509/x509.go.html#4070441">i</a></span><span class="op" id="4070502">]</span><span class="op" id="4070503">.</span><span class="ident" id="4070504">Policy</span>&nbsp;<span class="op" id="4070511">=</span>&nbsp;<span class="ident" id="4070513"><a href="/crypto/x509/x509.go.html#4070444">policy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070522">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070526"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4070529">[</span><span class="ident" id="4070530"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4070531">]</span><span class="op" id="4070532">.</span><span class="ident" id="4070533">Value</span><span class="op" id="4070538">,</span>&nbsp;<span class="ident" id="4070540"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4070544">=</span>&nbsp;<span class="ident" id="4070546"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4070550">.</span><span class="ident" id="4070551">Marshal</span><span class="op" id="4070558">(</span><span class="ident" id="4070559"><a href="/crypto/x509/x509.go.html#4070364">policies</a></span><span class="op" id="4070567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070571">if</span>&nbsp;<span class="ident" id="4070574"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4070578">!=</span>&nbsp;<span class="ident" id="4070581">nil</span>&nbsp;<span class="op" id="4070585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070590">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070603"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4070604">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070612">if</span>&nbsp;<span class="builtinfunc" id="4070615">len</span><span class="op" id="4070618">(</span><span class="ident" id="4070619"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070627">.</span><span class="ident" id="4070628">PermittedDNSDomains</span><span class="op" id="4070647">)</span>&nbsp;<span class="op" id="4070649">&gt;</span>&nbsp;<span class="num" id="4070651">0</span>&nbsp;<span class="op" id="4070653">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070658">!</span><span class="ident" id="4070659"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4070674">(</span><span class="ident" id="4070675"><a href="/crypto/x509/x509.go.html#4065368">oidExtensionNameConstraints</a></span><span class="op" id="4070702">,</span>&nbsp;<span class="ident" id="4070704"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070712">.</span><span class="ident" id="4070713">ExtraExtensions</span><span class="op" id="4070728">)</span>&nbsp;<span class="op" id="4070730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070734"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4070737">[</span><span class="ident" id="4070738"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4070739">]</span><span class="op" id="4070740">.</span><span class="ident" id="4070741">Id</span>&nbsp;<span class="op" id="4070744">=</span>&nbsp;<span class="ident" id="4070746"><a href="/crypto/x509/x509.go.html#4065368">oidExtensionNameConstraints</a></span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070776"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4070779">[</span><span class="ident" id="4070780"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4070781">]</span><span class="op" id="4070782">.</span><span class="ident" id="4070783">Critical</span>&nbsp;<span class="op" id="4070792">=</span>&nbsp;<span class="ident" id="4070794"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070802">.</span><span class="ident" id="4070803">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070834">var</span>&nbsp;<span class="ident" id="4070838">out</span>&nbsp;<span class="ident" id="4070842"><a href="/crypto/x509/x509.go.html#4053038">nameConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070860"><a href="/crypto/x509/x509.go.html#4070838">out</a></span><span class="op" id="4070863">.</span><span class="ident" id="4070864">Permitted</span>&nbsp;<span class="op" id="4070874">=</span>&nbsp;<span class="builtinfunc" id="4070876">make</span><span class="op" id="4070880">(</span><span class="op" id="4070881">[</span><span class="op" id="4070882">]</span><span class="ident" id="4070883"><a href="/crypto/x509/x509.go.html#4053175">generalSubtree</a></span><span class="op" id="4070897">,</span>&nbsp;<span class="builtinfunc" id="4070899">len</span><span class="op" id="4070902">(</span><span class="ident" id="4070903"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070911">.</span><span class="ident" id="4070912">PermittedDNSDomains</span><span class="op" id="4070931">)</span><span class="op" id="4070932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070936">for</span>&nbsp;<span class="ident" id="4070940">i</span><span class="op" id="4070941">,</span>&nbsp;<span class="ident" id="4070943">permitted</span>&nbsp;<span class="op" id="4070953">:=</span>&nbsp;<span class="keyword" id="4070956">range</span>&nbsp;<span class="ident" id="4070962"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4070970">.</span><span class="ident" id="4070971">PermittedDNSDomains</span>&nbsp;<span class="op" id="4070991">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070996"><a href="/crypto/x509/x509.go.html#4070838">out</a></span><span class="op" id="4070999">.</span><span class="ident" id="4071000">Permitted</span><span class="op" id="4071009">[</span><span class="ident" id="4071010"><a href="/crypto/x509/x509.go.html#4070940">i</a></span><span class="op" id="4071011">]</span>&nbsp;<span class="op" id="4071013">=</span>&nbsp;<span class="ident" id="4071015"><a href="/crypto/x509/x509.go.html#4053175">generalSubtree</a></span><span class="op" id="4071029">{</span><span class="ident" id="4071030">Name</span><span class="op" id="4071034">:</span>&nbsp;<span class="ident" id="4071036"><a href="/crypto/x509/x509.go.html#4070943">permitted</a></span><span class="op" id="4071045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071053"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4071056">[</span><span class="ident" id="4071057"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4071058">]</span><span class="op" id="4071059">.</span><span class="ident" id="4071060">Value</span><span class="op" id="4071065">,</span>&nbsp;<span class="ident" id="4071067"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4071071">=</span>&nbsp;<span class="ident" id="4071073"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4071077">.</span><span class="ident" id="4071078">Marshal</span><span class="op" id="4071085">(</span><span class="ident" id="4071086"><a href="/crypto/x509/x509.go.html#4070838">out</a></span><span class="op" id="4071089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071093">if</span>&nbsp;<span class="ident" id="4071096"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4071100">!=</span>&nbsp;<span class="ident" id="4071103">nil</span>&nbsp;<span class="op" id="4071107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071112">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071125"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4071126">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071134">if</span>&nbsp;<span class="builtinfunc" id="4071137">len</span><span class="op" id="4071140">(</span><span class="ident" id="4071141"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4071149">.</span><span class="ident" id="4071150">CRLDistributionPoints</span><span class="op" id="4071171">)</span>&nbsp;<span class="op" id="4071173">&gt;</span>&nbsp;<span class="num" id="4071175">0</span>&nbsp;<span class="op" id="4071177">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071182">!</span><span class="ident" id="4071183"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4071198">(</span><span class="ident" id="4071199"><a href="/crypto/x509/x509.go.html#4065425">oidExtensionCRLDistributionPoints</a></span><span class="op" id="4071232">,</span>&nbsp;<span class="ident" id="4071234"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4071242">.</span><span class="ident" id="4071243">ExtraExtensions</span><span class="op" id="4071258">)</span>&nbsp;<span class="op" id="4071260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071264"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4071267">[</span><span class="ident" id="4071268"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4071269">]</span><span class="op" id="4071270">.</span><span class="ident" id="4071271">Id</span>&nbsp;<span class="op" id="4071274">=</span>&nbsp;<span class="ident" id="4071276"><a href="/crypto/x509/x509.go.html#4065425">oidExtensionCRLDistributionPoints</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071313">var</span>&nbsp;<span class="ident" id="4071317">crlDp</span>&nbsp;<span class="op" id="4071323">[</span><span class="op" id="4071324">]</span><span class="ident" id="4071325"><a href="/crypto/x509/x509.go.html#4053384">distributionPoint</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071345">for</span>&nbsp;<span class="ident" id="4071349">_</span><span class="op" id="4071350">,</span>&nbsp;<span class="ident" id="4071352">name</span>&nbsp;<span class="op" id="4071357">:=</span>&nbsp;<span class="keyword" id="4071360">range</span>&nbsp;<span class="ident" id="4071366"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4071374">.</span><span class="ident" id="4071375">CRLDistributionPoints</span>&nbsp;<span class="op" id="4071397">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071402">rawFullName</span><span class="op" id="4071413">,</span>&nbsp;<span class="ident" id="4071415">_</span>&nbsp;<span class="op" id="4071417">:=</span>&nbsp;<span class="ident" id="4071420"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4071424">.</span><span class="ident" id="4071425">Marshal</span><span class="op" id="4071432">(</span><span class="ident" id="4071433"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4071437">.</span><span class="ident" id="4071438">RawValue</span><span class="op" id="4071446">{</span><span class="ident" id="4071447">Tag</span><span class="op" id="4071450">:</span>&nbsp;<span class="num" id="4071452">6</span><span class="op" id="4071453">,</span>&nbsp;<span class="ident" id="4071455">Class</span><span class="op" id="4071460">:</span>&nbsp;<span class="num" id="4071462">2</span><span class="op" id="4071463">,</span>&nbsp;<span class="ident" id="4071465">Bytes</span><span class="op" id="4071470">:</span>&nbsp;<span class="op" id="4071472">[</span><span class="op" id="4071473">]</span><span class="builtintype" id="4071474">byte</span><span class="op" id="4071478">(</span><span class="ident" id="4071479"><a href="/crypto/x509/x509.go.html#4071352">name</a></span><span class="op" id="4071483">)</span><span class="op" id="4071484">}</span><span class="op" id="4071485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071491">dp</span>&nbsp;<span class="op" id="4071494">:=</span>&nbsp;<span class="ident" id="4071497"><a href="/crypto/x509/x509.go.html#4053384">distributionPoint</a></span><span class="op" id="4071514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071520">DistributionPoint</span><span class="op" id="4071537">:</span>&nbsp;<span class="ident" id="4071539"><a href="/crypto/x509/x509.go.html#4053614">distributionPointName</a></span><span class="op" id="4071560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071567">FullName</span><span class="op" id="4071575">:</span>&nbsp;<span class="ident" id="4071577"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4071581">.</span><span class="ident" id="4071582">RawValue</span><span class="op" id="4071590">{</span><span class="ident" id="4071591">Tag</span><span class="op" id="4071594">:</span>&nbsp;<span class="num" id="4071596">0</span><span class="op" id="4071597">,</span>&nbsp;<span class="ident" id="4071599">Class</span><span class="op" id="4071604">:</span>&nbsp;<span class="num" id="4071606">2</span><span class="op" id="4071607">,</span>&nbsp;<span class="ident" id="4071609">IsCompound</span><span class="op" id="4071619">:</span>&nbsp;<span class="builtintype" id="4071621">true</span><span class="op" id="4071625">,</span>&nbsp;<span class="ident" id="4071627">Bytes</span><span class="op" id="4071632">:</span>&nbsp;<span class="ident" id="4071634"><a href="/crypto/x509/x509.go.html#4071402">rawFullName</a></span><span class="op" id="4071645">}</span><span class="op" id="4071646">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071652">}</span><span class="op" id="4071653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071663"><a href="/crypto/x509/x509.go.html#4071317">crlDp</a></span>&nbsp;<span class="op" id="4071669">=</span>&nbsp;<span class="builtinfunc" id="4071671">append</span><span class="op" id="4071677">(</span><span class="ident" id="4071678"><a href="/crypto/x509/x509.go.html#4071317">crlDp</a></span><span class="op" id="4071683">,</span>&nbsp;<span class="ident" id="4071685"><a href="/crypto/x509/x509.go.html#4071491">dp</a></span><span class="op" id="4071687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071696"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4071699">[</span><span class="ident" id="4071700"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4071701">]</span><span class="op" id="4071702">.</span><span class="ident" id="4071703">Value</span><span class="op" id="4071708">,</span>&nbsp;<span class="ident" id="4071710"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4071714">=</span>&nbsp;<span class="ident" id="4071716"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4071720">.</span><span class="ident" id="4071721">Marshal</span><span class="op" id="4071728">(</span><span class="ident" id="4071729"><a href="/crypto/x509/x509.go.html#4071317">crlDp</a></span><span class="op" id="4071734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071738">if</span>&nbsp;<span class="ident" id="4071741"><a href="/crypto/x509/x509.go.html#4066846">err</a></span>&nbsp;<span class="op" id="4071745">!=</span>&nbsp;<span class="ident" id="4071748">nil</span>&nbsp;<span class="op" id="4071752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071757">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071770"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4071771">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071779">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071852">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071911">return</span>&nbsp;<span class="builtinfunc" id="4071918">append</span><span class="op" id="4071924">(</span><span class="ident" id="4071925"><a href="/crypto/x509/x509.go.html#4066824">ret</a></span><span class="op" id="4071928">[</span><span class="op" id="4071929">:</span><span class="ident" id="4071930"><a href="/crypto/x509/x509.go.html#4066928">n</a></span><span class="op" id="4071931">]</span><span class="op" id="4071932">,</span>&nbsp;<span class="ident" id="4071934"><a href="/crypto/x509/x509.go.html#4066800">template</a></span><span class="op" id="4071942">.</span><span class="ident" id="4071943">ExtraExtensions</span><span class="op" id="4071958">...</span><span class="op" id="4071961">)</span><span class="op" id="4071962">,</span>&nbsp;<span class="ident" id="4071964">nil</span><br>
<span class="lineno"></span><span class="op" id="4071968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4071971">func</span>&nbsp;<span class="ident" id="4071976">subjectBytes</span><span class="op" id="4071988">(</span><span class="ident" id="4071989">cert</span>&nbsp;<span class="op" id="4071994">*</span><span class="ident" id="4071995"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4072006">)</span>&nbsp;<span class="op" id="4072008">(</span><span class="op" id="4072009">[</span><span class="op" id="4072010">]</span><span class="builtintype" id="4072011">byte</span><span class="op" id="4072015">,</span>&nbsp;<span class="builtintype" id="4072017">error</span><span class="op" id="4072022">)</span>&nbsp;<span class="op" id="4072024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072027">if</span>&nbsp;<span class="builtinfunc" id="4072030">len</span><span class="op" id="4072033">(</span><span class="ident" id="4072034"><a href="/crypto/x509/x509.go.html#4071989">cert</a></span><span class="op" id="4072038">.</span><span class="ident" id="4072039">RawSubject</span><span class="op" id="4072049">)</span>&nbsp;<span class="op" id="4072051">&gt;</span>&nbsp;<span class="num" id="4072053">0</span>&nbsp;<span class="op" id="4072055">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072059">return</span>&nbsp;<span class="ident" id="4072066"><a href="/crypto/x509/x509.go.html#4071989">cert</a></span><span class="op" id="4072070">.</span><span class="ident" id="4072071">RawSubject</span><span class="op" id="4072081">,</span>&nbsp;<span class="ident" id="4072083">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072092">return</span>&nbsp;<span class="ident" id="4072099"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4072103">.</span><span class="ident" id="4072104">Marshal</span><span class="op" id="4072111">(</span><span class="ident" id="4072112"><a href="/crypto/x509/x509.go.html#4071989">cert</a></span><span class="op" id="4072116">.</span><span class="ident" id="4072117">Subject</span><span class="op" id="4072124">.</span><span class="ident" id="4072125">ToRDNSequence</span><span class="op" id="4072138">(</span><span class="op" id="4072139">)</span><span class="op" id="4072140">)</span><br>
<span class="lineno"></span><span class="op" id="4072142">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4072145">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4072222">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4072293">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4072317">func</span>&nbsp;<span class="ident" id="4072322">signingParamsForPrivateKey</span><span class="op" id="4072348">(</span><span class="ident" id="4072349">priv</span>&nbsp;<span class="keyword" id="4072354">interface</span><span class="op" id="4072363">{</span><span class="op" id="4072364">}</span><span class="op" id="4072365">,</span>&nbsp;<span class="ident" id="4072367">requestedSigAlgo</span>&nbsp;<span class="ident" id="4072384"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span><span class="op" id="4072402">)</span>&nbsp;<span class="op" id="4072404">(</span><span class="ident" id="4072405">hashFunc</span>&nbsp;<span class="ident" id="4072414"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4072420">.</span><span class="ident" id="4072421">Hash</span><span class="op" id="4072425">,</span>&nbsp;<span class="ident" id="4072427">sigAlgo</span>&nbsp;<span class="ident" id="4072435"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4072439">.</span><span class="ident" id="4072440">AlgorithmIdentifier</span><span class="op" id="4072459">,</span>&nbsp;<span class="ident" id="4072461">err</span>&nbsp;<span class="builtintype" id="4072465">error</span><span class="op" id="4072470">)</span>&nbsp;<span class="op" id="4072472">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072475">var</span>&nbsp;<span class="ident" id="4072479">pubType</span>&nbsp;<span class="ident" id="4072487"><a href="/crypto/x509/x509.go.html#4034019">PublicKeyAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072508">switch</span>&nbsp;<span class="ident" id="4072515">priv</span>&nbsp;<span class="op" id="4072520">:=</span>&nbsp;<span class="ident" id="4072523"><a href="/crypto/x509/x509.go.html#4072349">priv</a></span><span class="op" id="4072527">.</span><span class="op" id="4072528">(</span><span class="keyword" id="4072529">type</span><span class="op" id="4072533">)</span>&nbsp;<span class="op" id="4072535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072538">case</span>&nbsp;<span class="op" id="4072543">*</span><span class="ident" id="4072544"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4072547">.</span><span class="ident" id="4072548">PrivateKey</span><span class="op" id="4072558">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072562"><a href="/crypto/x509/x509.go.html#4072479">pubType</a></span>&nbsp;<span class="op" id="4072570">=</span>&nbsp;<span class="ident" id="4072572"><a href="/crypto/x509/x509.go.html#4034105">RSA</a></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072578"><a href="/crypto/x509/x509.go.html#4072427">sigAlgo</a></span><span class="op" id="4072585">.</span><span class="ident" id="4072586">Algorithm</span>&nbsp;<span class="op" id="4072596">=</span>&nbsp;<span class="ident" id="4072598"><a href="/crypto/x509/x509.go.html#4035946">oidSignatureSHA256WithRSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072626"><a href="/crypto/x509/x509.go.html#4072405">hashFunc</a></span>&nbsp;<span class="op" id="4072635">=</span>&nbsp;<span class="ident" id="4072637"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4072643">.</span><span class="ident" id="4072644">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072653">case</span>&nbsp;<span class="op" id="4072658">*</span><span class="ident" id="4072659"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4072664">.</span><span class="ident" id="4072665">PrivateKey</span><span class="op" id="4072675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072679"><a href="/crypto/x509/x509.go.html#4072479">pubType</a></span>&nbsp;<span class="op" id="4072687">=</span>&nbsp;<span class="ident" id="4072689"><a href="/crypto/x509/x509.go.html#4034115">ECDSA</a></span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072698">switch</span>&nbsp;<span class="ident" id="4072705"><a href="/crypto/x509/x509.go.html#4072515">priv</a></span><span class="op" id="4072709">.</span><span class="ident" id="4072710">Curve</span>&nbsp;<span class="op" id="4072716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072720">case</span>&nbsp;<span class="ident" id="4072725"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4072733">.</span><span class="ident" id="4072734">P224</span><span class="op" id="4072738">(</span><span class="op" id="4072739">)</span><span class="op" id="4072740">,</span>&nbsp;<span class="ident" id="4072742"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4072750">.</span><span class="ident" id="4072751">P256</span><span class="op" id="4072755">(</span><span class="op" id="4072756">)</span><span class="op" id="4072757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072762"><a href="/crypto/x509/x509.go.html#4072405">hashFunc</a></span>&nbsp;<span class="op" id="4072771">=</span>&nbsp;<span class="ident" id="4072773"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4072779">.</span><span class="ident" id="4072780">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072790"><a href="/crypto/x509/x509.go.html#4072427">sigAlgo</a></span><span class="op" id="4072797">.</span><span class="ident" id="4072798">Algorithm</span>&nbsp;<span class="op" id="4072808">=</span>&nbsp;<span class="ident" id="4072810"><a href="/crypto/x509/x509.go.html#4036428">oidSignatureECDSAWithSHA256</a></span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072840">case</span>&nbsp;<span class="ident" id="4072845"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4072853">.</span><span class="ident" id="4072854">P384</span><span class="op" id="4072858">(</span><span class="op" id="4072859">)</span><span class="op" id="4072860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072865"><a href="/crypto/x509/x509.go.html#4072405">hashFunc</a></span>&nbsp;<span class="op" id="4072874">=</span>&nbsp;<span class="ident" id="4072876"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4072882">.</span><span class="ident" id="4072883">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072893"><a href="/crypto/x509/x509.go.html#4072427">sigAlgo</a></span><span class="op" id="4072900">.</span><span class="ident" id="4072901">Algorithm</span>&nbsp;<span class="op" id="4072911">=</span>&nbsp;<span class="ident" id="4072913"><a href="/crypto/x509/x509.go.html#4036508">oidSignatureECDSAWithSHA384</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072943">case</span>&nbsp;<span class="ident" id="4072948"><a href="/crypto/x509/x509.go.html#4030001">elliptic</a></span><span class="op" id="4072956">.</span><span class="ident" id="4072957">P521</span><span class="op" id="4072961">(</span><span class="op" id="4072962">)</span><span class="op" id="4072963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072968"><a href="/crypto/x509/x509.go.html#4072405">hashFunc</a></span>&nbsp;<span class="op" id="4072977">=</span>&nbsp;<span class="ident" id="4072979"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4072985">.</span><span class="ident" id="4072986">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072996"><a href="/crypto/x509/x509.go.html#4072427">sigAlgo</a></span><span class="op" id="4073003">.</span><span class="ident" id="4073004">Algorithm</span>&nbsp;<span class="op" id="4073014">=</span>&nbsp;<span class="ident" id="4073016"><a href="/crypto/x509/x509.go.html#4036588">oidSignatureECDSAWithSHA512</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073046">default</span><span class="op" id="4073053">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073058"><a href="/crypto/x509/x509.go.html#4072461">err</a></span>&nbsp;<span class="op" id="4073062">=</span>&nbsp;<span class="ident" id="4073064"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4073070">.</span><span class="ident" id="4073071">New</span><span class="op" id="4073074">(</span><span class="string" id="4073075">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4073105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073113">default</span><span class="op" id="4073120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073124"><a href="/crypto/x509/x509.go.html#4072461">err</a></span>&nbsp;<span class="op" id="4073128">=</span>&nbsp;<span class="ident" id="4073130"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4073136">.</span><span class="ident" id="4073137">New</span><span class="op" id="4073140">(</span><span class="string" id="4073141">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4073190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073197">if</span>&nbsp;<span class="ident" id="4073200"><a href="/crypto/x509/x509.go.html#4072461">err</a></span>&nbsp;<span class="op" id="4073204">!=</span>&nbsp;<span class="ident" id="4073207">nil</span>&nbsp;<span class="op" id="4073211">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073215">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073227">if</span>&nbsp;<span class="ident" id="4073230"><a href="/crypto/x509/x509.go.html#4072367">requestedSigAlgo</a></span>&nbsp;<span class="op" id="4073247">==</span>&nbsp;<span class="num" id="4073250">0</span>&nbsp;<span class="op" id="4073252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073256">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073268">found</span>&nbsp;<span class="op" id="4073274">:=</span>&nbsp;<span class="builtintype" id="4073277">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073284">for</span>&nbsp;<span class="ident" id="4073288">_</span><span class="op" id="4073289">,</span>&nbsp;<span class="ident" id="4073291">details</span>&nbsp;<span class="op" id="4073299">:=</span>&nbsp;<span class="keyword" id="4073302">range</span>&nbsp;<span class="ident" id="4073308"><a href="/crypto/x509/x509.go.html#4036674">signatureAlgorithmDetails</a></span>&nbsp;<span class="op" id="4073334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073338">if</span>&nbsp;<span class="ident" id="4073341"><a href="/crypto/x509/x509.go.html#4073291">details</a></span><span class="op" id="4073348">.</span><span class="ident" id="4073349">algo</span>&nbsp;<span class="op" id="4073354">==</span>&nbsp;<span class="ident" id="4073357"><a href="/crypto/x509/x509.go.html#4072367">requestedSigAlgo</a></span>&nbsp;<span class="op" id="4073374">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073379">if</span>&nbsp;<span class="ident" id="4073382"><a href="/crypto/x509/x509.go.html#4073291">details</a></span><span class="op" id="4073389">.</span><span class="ident" id="4073390">pubKeyAlgo</span>&nbsp;<span class="op" id="4073401">!=</span>&nbsp;<span class="ident" id="4073404"><a href="/crypto/x509/x509.go.html#4072479">pubType</a></span>&nbsp;<span class="op" id="4073412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073418"><a href="/crypto/x509/x509.go.html#4072461">err</a></span>&nbsp;<span class="op" id="4073422">=</span>&nbsp;<span class="ident" id="4073424"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4073430">.</span><span class="ident" id="4073431">New</span><span class="op" id="4073434">(</span><span class="string" id="4073435">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4073503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073509">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073524"><a href="/crypto/x509/x509.go.html#4072427">sigAlgo</a></span><span class="op" id="4073531">.</span><span class="ident" id="4073532">Algorithm</span><span class="op" id="4073541">,</span>&nbsp;<span class="ident" id="4073543"><a href="/crypto/x509/x509.go.html#4072405">hashFunc</a></span>&nbsp;<span class="op" id="4073552">=</span>&nbsp;<span class="ident" id="4073554"><a href="/crypto/x509/x509.go.html#4073291">details</a></span><span class="op" id="4073561">.</span><span class="ident" id="4073562">oid</span><span class="op" id="4073565">,</span>&nbsp;<span class="ident" id="4073567"><a href="/crypto/x509/x509.go.html#4073291">details</a></span><span class="op" id="4073574">.</span><span class="ident" id="4073575">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073583">if</span>&nbsp;<span class="ident" id="4073586"><a href="/crypto/x509/x509.go.html#4072405">hashFunc</a></span>&nbsp;<span class="op" id="4073595">==</span>&nbsp;<span class="num" id="4073598">0</span>&nbsp;<span class="op" id="4073600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073606"><a href="/crypto/x509/x509.go.html#4072461">err</a></span>&nbsp;<span class="op" id="4073610">=</span>&nbsp;<span class="ident" id="4073612"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4073618">.</span><span class="ident" id="4073619">New</span><span class="op" id="4073622">(</span><span class="string" id="4073623">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4073671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073677">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073692"><a href="/crypto/x509/x509.go.html#4073268">found</a></span>&nbsp;<span class="op" id="4073698">=</span>&nbsp;<span class="builtintype" id="4073700">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073708">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073723">if</span>&nbsp;<span class="op" id="4073726">!</span><span class="ident" id="4073727"><a href="/crypto/x509/x509.go.html#4073268">found</a></span>&nbsp;<span class="op" id="4073733">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073737"><a href="/crypto/x509/x509.go.html#4072461">err</a></span>&nbsp;<span class="op" id="4073741">=</span>&nbsp;<span class="ident" id="4073743"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4073749">.</span><span class="ident" id="4073750">New</span><span class="op" id="4073753">(</span><span class="string" id="4073754">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4073788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073795">return</span><br>
<span class="lineno"></span><span class="op" id="4073802">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4073805">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4073877">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4073954">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4074033">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4074107">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4074151">//</span><br>
<span class="lineno"></span><span class="comment" id="4074154">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4074234">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4074308">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4074361">//</span><br>
<span class="lineno"></span><span class="comment" id="4074364">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4074422">//</span><br>
<span class="lineno"></span><span class="comment" id="4074425">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4074494">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4074571">func</span>&nbsp;<span class="ident" id="4074576">CreateCertificate</span><span class="op" id="4074593">(</span><span class="ident" id="4074594">rand</span>&nbsp;<span class="ident" id="4074599"><a href="/crypto/x509/x509.go.html#4030150">io</a></span><span class="op" id="4074601">.</span><span class="ident" id="4074602">Reader</span><span class="op" id="4074608">,</span>&nbsp;<span class="ident" id="4074610">template</span><span class="op" id="4074618">,</span>&nbsp;<span class="ident" id="4074620">parent</span>&nbsp;<span class="op" id="4074627">*</span><span class="ident" id="4074628"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4074639">,</span>&nbsp;<span class="ident" id="4074641">pub</span>&nbsp;<span class="keyword" id="4074645">interface</span><span class="op" id="4074654">{</span><span class="op" id="4074655">}</span><span class="op" id="4074656">,</span>&nbsp;<span class="ident" id="4074658">priv</span>&nbsp;<span class="keyword" id="4074663">interface</span><span class="op" id="4074672">{</span><span class="op" id="4074673">}</span><span class="op" id="4074674">)</span>&nbsp;<span class="op" id="4074676">(</span><span class="ident" id="4074677">cert</span>&nbsp;<span class="op" id="4074682">[</span><span class="op" id="4074683">]</span><span class="builtintype" id="4074684">byte</span><span class="op" id="4074688">,</span>&nbsp;<span class="ident" id="4074690">err</span>&nbsp;<span class="builtintype" id="4074694">error</span><span class="op" id="4074699">)</span>&nbsp;<span class="op" id="4074701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074704">hashFunc</span><span class="op" id="4074712">,</span>&nbsp;<span class="ident" id="4074714">signatureAlgorithm</span><span class="op" id="4074732">,</span>&nbsp;<span class="ident" id="4074734"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4074738">:=</span>&nbsp;<span class="ident" id="4074741"><a href="/crypto/x509/x509.go.html#4072322">signingParamsForPrivateKey</a></span><span class="op" id="4074767">(</span><span class="ident" id="4074768"><a href="/crypto/x509/x509.go.html#4074658">priv</a></span><span class="op" id="4074772">,</span>&nbsp;<span class="ident" id="4074774"><a href="/crypto/x509/x509.go.html#4074610">template</a></span><span class="op" id="4074782">.</span><span class="ident" id="4074783">SignatureAlgorithm</span><span class="op" id="4074801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074804">if</span>&nbsp;<span class="ident" id="4074807"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4074811">!=</span>&nbsp;<span class="ident" id="4074814">nil</span>&nbsp;<span class="op" id="4074818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074822">return</span>&nbsp;<span class="ident" id="4074829">nil</span><span class="op" id="4074832">,</span>&nbsp;<span class="ident" id="4074834"><a href="/crypto/x509/x509.go.html#4074690">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074839">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074843">publicKeyBytes</span><span class="op" id="4074857">,</span>&nbsp;<span class="ident" id="4074859">publicKeyAlgorithm</span><span class="op" id="4074877">,</span>&nbsp;<span class="ident" id="4074879"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4074883">:=</span>&nbsp;<span class="ident" id="4074886"><a href="/crypto/x509/x509.go.html#4030892">marshalPublicKey</a></span><span class="op" id="4074902">(</span><span class="ident" id="4074903"><a href="/crypto/x509/x509.go.html#4074641">pub</a></span><span class="op" id="4074906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074909">if</span>&nbsp;<span class="ident" id="4074912"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4074916">!=</span>&nbsp;<span class="ident" id="4074919">nil</span>&nbsp;<span class="op" id="4074923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074927">return</span>&nbsp;<span class="ident" id="4074934">nil</span><span class="op" id="4074937">,</span>&nbsp;<span class="ident" id="4074939"><a href="/crypto/x509/x509.go.html#4074690">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074944">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074948">if</span>&nbsp;<span class="ident" id="4074951"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4074955">!=</span>&nbsp;<span class="ident" id="4074958">nil</span>&nbsp;<span class="op" id="4074962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074966">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074978">if</span>&nbsp;<span class="builtinfunc" id="4074981">len</span><span class="op" id="4074984">(</span><span class="ident" id="4074985"><a href="/crypto/x509/x509.go.html#4074620">parent</a></span><span class="op" id="4074991">.</span><span class="ident" id="4074992">SubjectKeyId</span><span class="op" id="4075004">)</span>&nbsp;<span class="op" id="4075006">&gt;</span>&nbsp;<span class="num" id="4075008">0</span>&nbsp;<span class="op" id="4075010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075014"><a href="/crypto/x509/x509.go.html#4074610">template</a></span><span class="op" id="4075022">.</span><span class="ident" id="4075023">AuthorityKeyId</span>&nbsp;<span class="op" id="4075038">=</span>&nbsp;<span class="ident" id="4075040"><a href="/crypto/x509/x509.go.html#4074620">parent</a></span><span class="op" id="4075046">.</span><span class="ident" id="4075047">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075065">extensions</span><span class="op" id="4075075">,</span>&nbsp;<span class="ident" id="4075077"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4075081">:=</span>&nbsp;<span class="ident" id="4075084"><a href="/crypto/x509/x509.go.html#4066784">buildExtensions</a></span><span class="op" id="4075099">(</span><span class="ident" id="4075100"><a href="/crypto/x509/x509.go.html#4074610">template</a></span><span class="op" id="4075108">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075111">if</span>&nbsp;<span class="ident" id="4075114"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4075118">!=</span>&nbsp;<span class="ident" id="4075121">nil</span>&nbsp;<span class="op" id="4075125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075129">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075141">asn1Issuer</span><span class="op" id="4075151">,</span>&nbsp;<span class="ident" id="4075153"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4075157">:=</span>&nbsp;<span class="ident" id="4075160"><a href="/crypto/x509/x509.go.html#4071976">subjectBytes</a></span><span class="op" id="4075172">(</span><span class="ident" id="4075173"><a href="/crypto/x509/x509.go.html#4074620">parent</a></span><span class="op" id="4075179">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075182">if</span>&nbsp;<span class="ident" id="4075185"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4075189">!=</span>&nbsp;<span class="ident" id="4075192">nil</span>&nbsp;<span class="op" id="4075196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075200">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075212">asn1Subject</span><span class="op" id="4075223">,</span>&nbsp;<span class="ident" id="4075225"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4075229">:=</span>&nbsp;<span class="ident" id="4075232"><a href="/crypto/x509/x509.go.html#4071976">subjectBytes</a></span><span class="op" id="4075244">(</span><span class="ident" id="4075245"><a href="/crypto/x509/x509.go.html#4074610">template</a></span><span class="op" id="4075253">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075256">if</span>&nbsp;<span class="ident" id="4075259"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4075263">!=</span>&nbsp;<span class="ident" id="4075266">nil</span>&nbsp;<span class="op" id="4075270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075274">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075286">encodedPublicKey</span>&nbsp;<span class="op" id="4075303">:=</span>&nbsp;<span class="ident" id="4075306"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4075310">.</span><span class="ident" id="4075311">BitString</span><span class="op" id="4075320">{</span><span class="ident" id="4075321">BitLength</span><span class="op" id="4075330">:</span>&nbsp;<span class="builtinfunc" id="4075332">len</span><span class="op" id="4075335">(</span><span class="ident" id="4075336"><a href="/crypto/x509/x509.go.html#4074843">publicKeyBytes</a></span><span class="op" id="4075350">)</span>&nbsp;<span class="op" id="4075352">*</span>&nbsp;<span class="num" id="4075354">8</span><span class="op" id="4075355">,</span>&nbsp;<span class="ident" id="4075357">Bytes</span><span class="op" id="4075362">:</span>&nbsp;<span class="ident" id="4075364"><a href="/crypto/x509/x509.go.html#4074843">publicKeyBytes</a></span><span class="op" id="4075378">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075381">c</span>&nbsp;<span class="op" id="4075383">:=</span>&nbsp;<span class="ident" id="4075386"><a href="/crypto/x509/x509.go.html#4032820">tbsCertificate</a></span><span class="op" id="4075400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075404">Version</span><span class="op" id="4075411">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4075424">2</span><span class="op" id="4075425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075429">SerialNumber</span><span class="op" id="4075441">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075449"><a href="/crypto/x509/x509.go.html#4074610">template</a></span><span class="op" id="4075457">.</span><span class="ident" id="4075458">SerialNumber</span><span class="op" id="4075470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075474">SignatureAlgorithm</span><span class="op" id="4075492">:</span>&nbsp;<span class="ident" id="4075494"><a href="/crypto/x509/x509.go.html#4074714">signatureAlgorithm</a></span><span class="op" id="4075512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075516">Issuer</span><span class="op" id="4075522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075536"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4075540">.</span><span class="ident" id="4075541">RawValue</span><span class="op" id="4075549">{</span><span class="ident" id="4075550">FullBytes</span><span class="op" id="4075559">:</span>&nbsp;<span class="ident" id="4075561"><a href="/crypto/x509/x509.go.html#4075141">asn1Issuer</a></span><span class="op" id="4075571">}</span><span class="op" id="4075572">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075576">Validity</span><span class="op" id="4075584">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075596"><a href="/crypto/x509/x509.go.html#4033489">validity</a></span><span class="op" id="4075604">{</span><span class="ident" id="4075605"><a href="/crypto/x509/x509.go.html#4074610">template</a></span><span class="op" id="4075613">.</span><span class="ident" id="4075614">NotBefore</span><span class="op" id="4075623">.</span><span class="ident" id="4075624">UTC</span><span class="op" id="4075627">(</span><span class="op" id="4075628">)</span><span class="op" id="4075629">,</span>&nbsp;<span class="ident" id="4075631"><a href="/crypto/x509/x509.go.html#4074610">template</a></span><span class="op" id="4075639">.</span><span class="ident" id="4075640">NotAfter</span><span class="op" id="4075648">.</span><span class="ident" id="4075649">UTC</span><span class="op" id="4075652">(</span><span class="op" id="4075653">)</span><span class="op" id="4075654">}</span><span class="op" id="4075655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075659">Subject</span><span class="op" id="4075666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075679"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4075683">.</span><span class="ident" id="4075684">RawValue</span><span class="op" id="4075692">{</span><span class="ident" id="4075693">FullBytes</span><span class="op" id="4075702">:</span>&nbsp;<span class="ident" id="4075704"><a href="/crypto/x509/x509.go.html#4075212">asn1Subject</a></span><span class="op" id="4075715">}</span><span class="op" id="4075716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075720">PublicKey</span><span class="op" id="4075729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075740"><a href="/crypto/x509/x509.go.html#4033546">publicKeyInfo</a></span><span class="op" id="4075753">{</span><span class="ident" id="4075754">nil</span><span class="op" id="4075757">,</span>&nbsp;<span class="ident" id="4075759"><a href="/crypto/x509/x509.go.html#4074859">publicKeyAlgorithm</a></span><span class="op" id="4075777">,</span>&nbsp;<span class="ident" id="4075779"><a href="/crypto/x509/x509.go.html#4075286">encodedPublicKey</a></span><span class="op" id="4075795">}</span><span class="op" id="4075796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075800">Extensions</span><span class="op" id="4075810">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075820"><a href="/crypto/x509/x509.go.html#4075065">extensions</a></span><span class="op" id="4075830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075833">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075837">tbsCertContents</span><span class="op" id="4075852">,</span>&nbsp;<span class="ident" id="4075854"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4075858">:=</span>&nbsp;<span class="ident" id="4075861"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4075865">.</span><span class="ident" id="4075866">Marshal</span><span class="op" id="4075873">(</span><span class="ident" id="4075874"><a href="/crypto/x509/x509.go.html#4075381">c</a></span><span class="op" id="4075875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075878">if</span>&nbsp;<span class="ident" id="4075881"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4075885">!=</span>&nbsp;<span class="ident" id="4075888">nil</span>&nbsp;<span class="op" id="4075892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075896">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075904">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075908"><a href="/crypto/x509/x509.go.html#4075381">c</a></span><span class="op" id="4075909">.</span><span class="ident" id="4075910">Raw</span>&nbsp;<span class="op" id="4075914">=</span>&nbsp;<span class="ident" id="4075916"><a href="/crypto/x509/x509.go.html#4075837">tbsCertContents</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075934">h</span>&nbsp;<span class="op" id="4075936">:=</span>&nbsp;<span class="ident" id="4075939"><a href="/crypto/x509/x509.go.html#4074704">hashFunc</a></span><span class="op" id="4075947">.</span><span class="ident" id="4075948">New</span><span class="op" id="4075951">(</span><span class="op" id="4075952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075955"><a href="/crypto/x509/x509.go.html#4075934">h</a></span><span class="op" id="4075956">.</span><span class="ident" id="4075957">Write</span><span class="op" id="4075962">(</span><span class="ident" id="4075963"><a href="/crypto/x509/x509.go.html#4075837">tbsCertContents</a></span><span class="op" id="4075978">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075981">digest</span>&nbsp;<span class="op" id="4075988">:=</span>&nbsp;<span class="ident" id="4075991"><a href="/crypto/x509/x509.go.html#4075934">h</a></span><span class="op" id="4075992">.</span><span class="ident" id="4075993">Sum</span><span class="op" id="4075996">(</span><span class="ident" id="4075997">nil</span><span class="op" id="4076000">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076004">var</span>&nbsp;<span class="ident" id="4076008">signature</span>&nbsp;<span class="op" id="4076018">[</span><span class="op" id="4076019">]</span><span class="builtintype" id="4076020">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076027">switch</span>&nbsp;<span class="ident" id="4076034">priv</span>&nbsp;<span class="op" id="4076039">:=</span>&nbsp;<span class="ident" id="4076042"><a href="/crypto/x509/x509.go.html#4074658">priv</a></span><span class="op" id="4076046">.</span><span class="op" id="4076047">(</span><span class="keyword" id="4076048">type</span><span class="op" id="4076052">)</span>&nbsp;<span class="op" id="4076054">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076057">case</span>&nbsp;<span class="op" id="4076062">*</span><span class="ident" id="4076063"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4076066">.</span><span class="ident" id="4076067">PrivateKey</span><span class="op" id="4076077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076081"><a href="/crypto/x509/x509.go.html#4076008">signature</a></span><span class="op" id="4076090">,</span>&nbsp;<span class="ident" id="4076092"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4076096">=</span>&nbsp;<span class="ident" id="4076098"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4076101">.</span><span class="ident" id="4076102">SignPKCS1v15</span><span class="op" id="4076114">(</span><span class="ident" id="4076115"><a href="/crypto/x509/x509.go.html#4074594">rand</a></span><span class="op" id="4076119">,</span>&nbsp;<span class="ident" id="4076121"><a href="/crypto/x509/x509.go.html#4076034">priv</a></span><span class="op" id="4076125">,</span>&nbsp;<span class="ident" id="4076127"><a href="/crypto/x509/x509.go.html#4074704">hashFunc</a></span><span class="op" id="4076135">,</span>&nbsp;<span class="ident" id="4076137"><a href="/crypto/x509/x509.go.html#4075981">digest</a></span><span class="op" id="4076143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076146">case</span>&nbsp;<span class="op" id="4076151">*</span><span class="ident" id="4076152"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4076157">.</span><span class="ident" id="4076158">PrivateKey</span><span class="op" id="4076168">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076172">var</span>&nbsp;<span class="ident" id="4076176">r</span><span class="op" id="4076177">,</span>&nbsp;<span class="ident" id="4076179">s</span>&nbsp;<span class="op" id="4076181">*</span><span class="ident" id="4076182"><a href="/crypto/x509/x509.go.html#4030156">big</a></span><span class="op" id="4076185">.</span><span class="ident" id="4076186">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076192">if</span>&nbsp;<span class="ident" id="4076195"><a href="/crypto/x509/x509.go.html#4076176">r</a></span><span class="op" id="4076196">,</span>&nbsp;<span class="ident" id="4076198"><a href="/crypto/x509/x509.go.html#4076179">s</a></span><span class="op" id="4076199">,</span>&nbsp;<span class="ident" id="4076201"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4076205">=</span>&nbsp;<span class="ident" id="4076207"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4076212">.</span><span class="ident" id="4076213">Sign</span><span class="op" id="4076217">(</span><span class="ident" id="4076218"><a href="/crypto/x509/x509.go.html#4074594">rand</a></span><span class="op" id="4076222">,</span>&nbsp;<span class="ident" id="4076224"><a href="/crypto/x509/x509.go.html#4076034">priv</a></span><span class="op" id="4076228">,</span>&nbsp;<span class="ident" id="4076230"><a href="/crypto/x509/x509.go.html#4075981">digest</a></span><span class="op" id="4076236">)</span><span class="op" id="4076237">;</span>&nbsp;<span class="ident" id="4076239"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4076243">==</span>&nbsp;<span class="ident" id="4076246">nil</span>&nbsp;<span class="op" id="4076250">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076255"><a href="/crypto/x509/x509.go.html#4076008">signature</a></span><span class="op" id="4076264">,</span>&nbsp;<span class="ident" id="4076266"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4076270">=</span>&nbsp;<span class="ident" id="4076272"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4076276">.</span><span class="ident" id="4076277">Marshal</span><span class="op" id="4076284">(</span><span class="ident" id="4076285"><a href="/crypto/x509/x509.go.html#4033455">ecdsaSignature</a></span><span class="op" id="4076299">{</span><span class="ident" id="4076300"><a href="/crypto/x509/x509.go.html#4076176">r</a></span><span class="op" id="4076301">,</span>&nbsp;<span class="ident" id="4076303"><a href="/crypto/x509/x509.go.html#4076179">s</a></span><span class="op" id="4076304">}</span><span class="op" id="4076305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076312">default</span><span class="op" id="4076319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4076323">panic</span><span class="op" id="4076328">(</span><span class="string" id="4076329">&#34;internal&nbsp;error&#34;</span><span class="op" id="4076345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076348">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076352">if</span>&nbsp;<span class="ident" id="4076355"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4076359">!=</span>&nbsp;<span class="ident" id="4076362">nil</span>&nbsp;<span class="op" id="4076366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076370">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076382"><a href="/crypto/x509/x509.go.html#4074677">cert</a></span><span class="op" id="4076386">,</span>&nbsp;<span class="ident" id="4076388"><a href="/crypto/x509/x509.go.html#4074690">err</a></span>&nbsp;<span class="op" id="4076392">=</span>&nbsp;<span class="ident" id="4076394"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4076398">.</span><span class="ident" id="4076399">Marshal</span><span class="op" id="4076406">(</span><span class="ident" id="4076407"><a href="/crypto/x509/x509.go.html#4032640">certificate</a></span><span class="op" id="4076418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076422">nil</span><span class="op" id="4076425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076429"><a href="/crypto/x509/x509.go.html#4075381">c</a></span><span class="op" id="4076430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076434"><a href="/crypto/x509/x509.go.html#4074714">signatureAlgorithm</a></span><span class="op" id="4076452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076456"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4076460">.</span><span class="ident" id="4076461">BitString</span><span class="op" id="4076470">{</span><span class="ident" id="4076471">Bytes</span><span class="op" id="4076476">:</span>&nbsp;<span class="ident" id="4076478"><a href="/crypto/x509/x509.go.html#4076008">signature</a></span><span class="op" id="4076487">,</span>&nbsp;<span class="ident" id="4076489">BitLength</span><span class="op" id="4076498">:</span>&nbsp;<span class="builtinfunc" id="4076500">len</span><span class="op" id="4076503">(</span><span class="ident" id="4076504"><a href="/crypto/x509/x509.go.html#4076008">signature</a></span><span class="op" id="4076513">)</span>&nbsp;<span class="op" id="4076515">*</span>&nbsp;<span class="num" id="4076517">8</span><span class="op" id="4076518">}</span><span class="op" id="4076519">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076522">}</span><span class="op" id="4076523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076526">return</span><br>
<span class="lineno"></span><span class="op" id="4076533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4076536">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4076614">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4076622">var</span>&nbsp;<span class="ident" id="4076626">pemCRLPrefix</span>&nbsp;<span class="op" id="4076639">=</span>&nbsp;<span class="op" id="4076641">[</span><span class="op" id="4076642">]</span><span class="builtintype" id="4076643">byte</span><span class="op" id="4076647">(</span><span class="string" id="4076648">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4076669">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4076672">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4076717">var</span>&nbsp;<span class="ident" id="4076721">pemType</span>&nbsp;<span class="op" id="4076729">=</span>&nbsp;<span class="string" id="4076731">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4076743">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4076819">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4076898">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4076975">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4076987">func</span>&nbsp;<span class="ident" id="4076992">ParseCRL</span><span class="op" id="4077000">(</span><span class="ident" id="4077001">crlBytes</span>&nbsp;<span class="op" id="4077010">[</span><span class="op" id="4077011">]</span><span class="builtintype" id="4077012">byte</span><span class="op" id="4077016">)</span>&nbsp;<span class="op" id="4077018">(</span><span class="ident" id="4077019">certList</span>&nbsp;<span class="op" id="4077028">*</span><span class="ident" id="4077029"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4077033">.</span><span class="ident" id="4077034">CertificateList</span><span class="op" id="4077049">,</span>&nbsp;<span class="ident" id="4077051">err</span>&nbsp;<span class="builtintype" id="4077055">error</span><span class="op" id="4077060">)</span>&nbsp;<span class="op" id="4077062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077065">if</span>&nbsp;<span class="ident" id="4077068"><a href="/crypto/x509/x509.go.html#4029952">bytes</a></span><span class="op" id="4077073">.</span><span class="ident" id="4077074">HasPrefix</span><span class="op" id="4077083">(</span><span class="ident" id="4077084"><a href="/crypto/x509/x509.go.html#4077001">crlBytes</a></span><span class="op" id="4077092">,</span>&nbsp;<span class="ident" id="4077094"><a href="/crypto/x509/x509.go.html#4076626">pemCRLPrefix</a></span><span class="op" id="4077106">)</span>&nbsp;<span class="op" id="4077108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077112">block</span><span class="op" id="4077117">,</span>&nbsp;<span class="ident" id="4077119">_</span>&nbsp;<span class="op" id="4077121">:=</span>&nbsp;<span class="ident" id="4077124"><a href="/crypto/x509/x509.go.html#4030124">pem</a></span><span class="op" id="4077127">.</span><span class="ident" id="4077128">Decode</span><span class="op" id="4077134">(</span><span class="ident" id="4077135"><a href="/crypto/x509/x509.go.html#4077001">crlBytes</a></span><span class="op" id="4077143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077147">if</span>&nbsp;<span class="ident" id="4077150"><a href="/crypto/x509/x509.go.html#4077112">block</a></span>&nbsp;<span class="op" id="4077156">!=</span>&nbsp;<span class="ident" id="4077159">nil</span>&nbsp;<span class="op" id="4077163">&amp;&amp;</span>&nbsp;<span class="ident" id="4077166"><a href="/crypto/x509/x509.go.html#4077112">block</a></span><span class="op" id="4077171">.</span><span class="ident" id="4077172">Type</span>&nbsp;<span class="op" id="4077177">==</span>&nbsp;<span class="ident" id="4077180"><a href="/crypto/x509/x509.go.html#4076721">pemType</a></span>&nbsp;<span class="op" id="4077188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077193"><a href="/crypto/x509/x509.go.html#4077001">crlBytes</a></span>&nbsp;<span class="op" id="4077202">=</span>&nbsp;<span class="ident" id="4077204"><a href="/crypto/x509/x509.go.html#4077112">block</a></span><span class="op" id="4077209">.</span><span class="ident" id="4077210">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077224">return</span>&nbsp;<span class="ident" id="4077231"><a href="/crypto/x509/x509.go.html#4077323">ParseDERCRL</a></span><span class="op" id="4077242">(</span><span class="ident" id="4077243"><a href="/crypto/x509/x509.go.html#4077001">crlBytes</a></span><span class="op" id="4077251">)</span><br>
<span class="lineno"></span><span class="op" id="4077253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4077256">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4077318">func</span>&nbsp;<span class="ident" id="4077323">ParseDERCRL</span><span class="op" id="4077334">(</span><span class="ident" id="4077335">derBytes</span>&nbsp;<span class="op" id="4077344">[</span><span class="op" id="4077345">]</span><span class="builtintype" id="4077346">byte</span><span class="op" id="4077350">)</span>&nbsp;<span class="op" id="4077352">(</span><span class="ident" id="4077353">certList</span>&nbsp;<span class="op" id="4077362">*</span><span class="ident" id="4077363"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4077367">.</span><span class="ident" id="4077368">CertificateList</span><span class="op" id="4077383">,</span>&nbsp;<span class="ident" id="4077385">err</span>&nbsp;<span class="builtintype" id="4077389">error</span><span class="op" id="4077394">)</span>&nbsp;<span class="op" id="4077396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077399"><a href="/crypto/x509/x509.go.html#4077353">certList</a></span>&nbsp;<span class="op" id="4077408">=</span>&nbsp;<span class="builtinfunc" id="4077410">new</span><span class="op" id="4077413">(</span><span class="ident" id="4077414"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4077418">.</span><span class="ident" id="4077419">CertificateList</span><span class="op" id="4077434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077437">_</span><span class="op" id="4077438">,</span>&nbsp;<span class="ident" id="4077440"><a href="/crypto/x509/x509.go.html#4077385">err</a></span>&nbsp;<span class="op" id="4077444">=</span>&nbsp;<span class="ident" id="4077446"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4077450">.</span><span class="ident" id="4077451">Unmarshal</span><span class="op" id="4077460">(</span><span class="ident" id="4077461"><a href="/crypto/x509/x509.go.html#4077335">derBytes</a></span><span class="op" id="4077469">,</span>&nbsp;<span class="ident" id="4077471"><a href="/crypto/x509/x509.go.html#4077353">certList</a></span><span class="op" id="4077479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077482">if</span>&nbsp;<span class="ident" id="4077485"><a href="/crypto/x509/x509.go.html#4077385">err</a></span>&nbsp;<span class="op" id="4077489">!=</span>&nbsp;<span class="ident" id="4077492">nil</span>&nbsp;<span class="op" id="4077496">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077500"><a href="/crypto/x509/x509.go.html#4077353">certList</a></span>&nbsp;<span class="op" id="4077509">=</span>&nbsp;<span class="ident" id="4077511">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077519">return</span><br>
<span class="lineno"></span><span class="op" id="4077526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4077529">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4077602">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4077654">//</span><br>
<span class="lineno"></span><span class="comment" id="4077657">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4077723">func</span>&nbsp;<span class="op" id="4077728">(</span><span class="ident" id="4077729">c</span>&nbsp;<span class="op" id="4077731">*</span><span class="ident" id="4077732"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="4077743">)</span>&nbsp;<span class="ident" id="4077745">CreateCRL</span><span class="op" id="4077754">(</span><span class="ident" id="4077755">rand</span>&nbsp;<span class="ident" id="4077760"><a href="/crypto/x509/x509.go.html#4030150">io</a></span><span class="op" id="4077762">.</span><span class="ident" id="4077763">Reader</span><span class="op" id="4077769">,</span>&nbsp;<span class="ident" id="4077771">priv</span>&nbsp;<span class="keyword" id="4077776">interface</span><span class="op" id="4077785">{</span><span class="op" id="4077786">}</span><span class="op" id="4077787">,</span>&nbsp;<span class="ident" id="4077789">revokedCerts</span>&nbsp;<span class="op" id="4077802">[</span><span class="op" id="4077803">]</span><span class="ident" id="4077804"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4077808">.</span><span class="ident" id="4077809">RevokedCertificate</span><span class="op" id="4077827">,</span>&nbsp;<span class="ident" id="4077829">now</span><span class="op" id="4077832">,</span>&nbsp;<span class="ident" id="4077834">expiry</span>&nbsp;<span class="ident" id="4077841"><a href="/crypto/x509/x509.go.html#4030186">time</a></span><span class="op" id="4077845">.</span><span class="ident" id="4077846">Time</span><span class="op" id="4077850">)</span>&nbsp;<span class="op" id="4077852">(</span><span class="ident" id="4077853">crlBytes</span>&nbsp;<span class="op" id="4077862">[</span><span class="op" id="4077863">]</span><span class="builtintype" id="4077864">byte</span><span class="op" id="4077868">,</span>&nbsp;<span class="ident" id="4077870">err</span>&nbsp;<span class="builtintype" id="4077874">error</span><span class="op" id="4077879">)</span>&nbsp;<span class="op" id="4077881">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077884">rsaPriv</span><span class="op" id="4077891">,</span>&nbsp;<span class="ident" id="4077893">ok</span>&nbsp;<span class="op" id="4077896">:=</span>&nbsp;<span class="ident" id="4077899"><a href="/crypto/x509/x509.go.html#4077771">priv</a></span><span class="op" id="4077903">.</span><span class="op" id="4077904">(</span><span class="op" id="4077905">*</span><span class="ident" id="4077906"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4077909">.</span><span class="ident" id="4077910">PrivateKey</span><span class="op" id="4077920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077923">if</span>&nbsp;<span class="op" id="4077926">!</span><span class="ident" id="4077927"><a href="/crypto/x509/x509.go.html#4077893">ok</a></span>&nbsp;<span class="op" id="4077930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077934">return</span>&nbsp;<span class="ident" id="4077941">nil</span><span class="op" id="4077944">,</span>&nbsp;<span class="ident" id="4077946"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4077952">.</span><span class="ident" id="4077953">New</span><span class="op" id="4077956">(</span><span class="string" id="4077957">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4077999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078005">tbsCertList</span>&nbsp;<span class="op" id="4078017">:=</span>&nbsp;<span class="ident" id="4078020"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4078024">.</span><span class="ident" id="4078025">TBSCertificateList</span><span class="op" id="4078043">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078047">Version</span><span class="op" id="4078054">:</span>&nbsp;<span class="num" id="4078056">2</span><span class="op" id="4078057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078061">Signature</span><span class="op" id="4078070">:</span>&nbsp;<span class="ident" id="4078072"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4078076">.</span><span class="ident" id="4078077">AlgorithmIdentifier</span><span class="op" id="4078096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078101">Algorithm</span><span class="op" id="4078110">:</span>&nbsp;<span class="ident" id="4078112"><a href="/crypto/x509/x509.go.html#4035865">oidSignatureSHA1WithRSA</a></span><span class="op" id="4078135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078139">}</span><span class="op" id="4078140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078144">Issuer</span><span class="op" id="4078150">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4078165"><a href="/crypto/x509/x509.go.html#4077729">c</a></span><span class="op" id="4078166">.</span><span class="ident" id="4078167">Subject</span><span class="op" id="4078174">.</span><span class="ident" id="4078175">ToRDNSequence</span><span class="op" id="4078188">(</span><span class="op" id="4078189">)</span><span class="op" id="4078190">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078194">ThisUpdate</span><span class="op" id="4078204">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4078215"><a href="/crypto/x509/x509.go.html#4077829">now</a></span><span class="op" id="4078218">.</span><span class="ident" id="4078219">UTC</span><span class="op" id="4078222">(</span><span class="op" id="4078223">)</span><span class="op" id="4078224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078228">NextUpdate</span><span class="op" id="4078238">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4078249"><a href="/crypto/x509/x509.go.html#4077834">expiry</a></span><span class="op" id="4078255">.</span><span class="ident" id="4078256">UTC</span><span class="op" id="4078259">(</span><span class="op" id="4078260">)</span><span class="op" id="4078261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078265">RevokedCertificates</span><span class="op" id="4078284">:</span>&nbsp;<span class="ident" id="4078286"><a href="/crypto/x509/x509.go.html#4077789">revokedCerts</a></span><span class="op" id="4078298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078305">tbsCertListContents</span><span class="op" id="4078324">,</span>&nbsp;<span class="ident" id="4078326"><a href="/crypto/x509/x509.go.html#4077870">err</a></span>&nbsp;<span class="op" id="4078330">:=</span>&nbsp;<span class="ident" id="4078333"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4078337">.</span><span class="ident" id="4078338">Marshal</span><span class="op" id="4078345">(</span><span class="ident" id="4078346"><a href="/crypto/x509/x509.go.html#4078005">tbsCertList</a></span><span class="op" id="4078357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078360">if</span>&nbsp;<span class="ident" id="4078363"><a href="/crypto/x509/x509.go.html#4077870">err</a></span>&nbsp;<span class="op" id="4078367">!=</span>&nbsp;<span class="ident" id="4078370">nil</span>&nbsp;<span class="op" id="4078374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078378">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078390">h</span>&nbsp;<span class="op" id="4078392">:=</span>&nbsp;<span class="ident" id="4078395"><a href="/crypto/x509/x509.go.html#4030034">sha1</a></span><span class="op" id="4078399">.</span><span class="ident" id="4078400">New</span><span class="op" id="4078403">(</span><span class="op" id="4078404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078407"><a href="/crypto/x509/x509.go.html#4078390">h</a></span><span class="op" id="4078408">.</span><span class="ident" id="4078409">Write</span><span class="op" id="4078414">(</span><span class="ident" id="4078415"><a href="/crypto/x509/x509.go.html#4078305">tbsCertListContents</a></span><span class="op" id="4078434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078437">digest</span>&nbsp;<span class="op" id="4078444">:=</span>&nbsp;<span class="ident" id="4078447"><a href="/crypto/x509/x509.go.html#4078390">h</a></span><span class="op" id="4078448">.</span><span class="ident" id="4078449">Sum</span><span class="op" id="4078452">(</span><span class="ident" id="4078453">nil</span><span class="op" id="4078456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078460">signature</span><span class="op" id="4078469">,</span>&nbsp;<span class="ident" id="4078471"><a href="/crypto/x509/x509.go.html#4077870">err</a></span>&nbsp;<span class="op" id="4078475">:=</span>&nbsp;<span class="ident" id="4078478"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4078481">.</span><span class="ident" id="4078482">SignPKCS1v15</span><span class="op" id="4078494">(</span><span class="ident" id="4078495"><a href="/crypto/x509/x509.go.html#4077755">rand</a></span><span class="op" id="4078499">,</span>&nbsp;<span class="ident" id="4078501"><a href="/crypto/x509/x509.go.html#4077884">rsaPriv</a></span><span class="op" id="4078508">,</span>&nbsp;<span class="ident" id="4078510"><a href="/crypto/x509/x509.go.html#4029961">crypto</a></span><span class="op" id="4078516">.</span><span class="ident" id="4078517">SHA1</span><span class="op" id="4078521">,</span>&nbsp;<span class="ident" id="4078523"><a href="/crypto/x509/x509.go.html#4078437">digest</a></span><span class="op" id="4078529">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078532">if</span>&nbsp;<span class="ident" id="4078535"><a href="/crypto/x509/x509.go.html#4077870">err</a></span>&nbsp;<span class="op" id="4078539">!=</span>&nbsp;<span class="ident" id="4078542">nil</span>&nbsp;<span class="op" id="4078546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078550">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078562">return</span>&nbsp;<span class="ident" id="4078569"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4078573">.</span><span class="ident" id="4078574">Marshal</span><span class="op" id="4078581">(</span><span class="ident" id="4078582"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4078586">.</span><span class="ident" id="4078587">CertificateList</span><span class="op" id="4078602">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078606">TBSCertList</span><span class="op" id="4078617">:</span>&nbsp;<span class="ident" id="4078619"><a href="/crypto/x509/x509.go.html#4078005">tbsCertList</a></span><span class="op" id="4078630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078634">SignatureAlgorithm</span><span class="op" id="4078652">:</span>&nbsp;<span class="ident" id="4078654"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4078658">.</span><span class="ident" id="4078659">AlgorithmIdentifier</span><span class="op" id="4078678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078683">Algorithm</span><span class="op" id="4078692">:</span>&nbsp;<span class="ident" id="4078694"><a href="/crypto/x509/x509.go.html#4035865">oidSignatureSHA1WithRSA</a></span><span class="op" id="4078717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078721">}</span><span class="op" id="4078722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078726">SignatureValue</span><span class="op" id="4078740">:</span>&nbsp;<span class="ident" id="4078742"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4078746">.</span><span class="ident" id="4078747">BitString</span><span class="op" id="4078756">{</span><span class="ident" id="4078757">Bytes</span><span class="op" id="4078762">:</span>&nbsp;<span class="ident" id="4078764"><a href="/crypto/x509/x509.go.html#4078460">signature</a></span><span class="op" id="4078773">,</span>&nbsp;<span class="ident" id="4078775">BitLength</span><span class="op" id="4078784">:</span>&nbsp;<span class="builtinfunc" id="4078786">len</span><span class="op" id="4078789">(</span><span class="ident" id="4078790"><a href="/crypto/x509/x509.go.html#4078460">signature</a></span><span class="op" id="4078799">)</span>&nbsp;<span class="op" id="4078801">*</span>&nbsp;<span class="num" id="4078803">8</span><span class="op" id="4078804">}</span><span class="op" id="4078805">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078808">}</span><span class="op" id="4078809">)</span><br>
<span class="lineno"></span><span class="op" id="4078811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4078814">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4078890">type</span>&nbsp;<span class="ident" id="4078895">CertificateRequest</span>&nbsp;<span class="keyword" id="4078914">struct</span>&nbsp;<span class="op" id="4078921">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078924">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078949">[</span><span class="op" id="4078950">]</span><span class="builtintype" id="4078951">byte</span>&nbsp;<span class="comment" id="4078956">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079029">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4079054">[</span><span class="op" id="4079055">]</span><span class="builtintype" id="4079056">byte</span>&nbsp;<span class="comment" id="4079061">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079121">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4079146">[</span><span class="op" id="4079147">]</span><span class="builtintype" id="4079148">byte</span>&nbsp;<span class="comment" id="4079153">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079191">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079216">[</span><span class="op" id="4079217">]</span><span class="builtintype" id="4079218">byte</span>&nbsp;<span class="comment" id="4079223">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079249">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4079268">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079273">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079292">[</span><span class="op" id="4079293">]</span><span class="builtintype" id="4079294">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079300">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4079319"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079340">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4079359"><a href="/crypto/x509/x509.go.html#4034019">PublicKeyAlgorithm</a></span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079379">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079398">interface</span><span class="op" id="4079407">{</span><span class="op" id="4079408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079412">Subject</span>&nbsp;<span class="ident" id="4079420"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4079424">.</span><span class="ident" id="4079425">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079432">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079487">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079552">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079582">Attributes</span>&nbsp;<span class="op" id="4079593">[</span><span class="op" id="4079594">]</span><span class="ident" id="4079595"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4079599">.</span><span class="ident" id="4079600">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079627">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079697">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079763">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079776">Extensions</span>&nbsp;<span class="op" id="4079787">[</span><span class="op" id="4079788">]</span><span class="ident" id="4079789"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4079793">.</span><span class="ident" id="4079794">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079806">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079874">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4079945">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4080013">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4080053">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4080057">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4080127">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080143">ExtraExtensions</span>&nbsp;<span class="op" id="4080159">[</span><span class="op" id="4080160">]</span><span class="ident" id="4080161"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4080165">.</span><span class="ident" id="4080166">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4080178">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080213">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080228">[</span><span class="op" id="4080229">]</span><span class="builtintype" id="4080230">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080238">EmailAddresses</span>&nbsp;<span class="op" id="4080253">[</span><span class="op" id="4080254">]</span><span class="builtintype" id="4080255">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080263">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080278">[</span><span class="op" id="4080279">]</span><span class="ident" id="4080280"><a href="/crypto/x509/x509.go.html#4030168">net</a></span><span class="op" id="4080283">.</span><span class="ident" id="4080284">IP</span><br>
<span class="lineno"></span><span class="op" id="4080287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4080290">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4080359">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4080398">type</span>&nbsp;<span class="ident" id="4080403">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4080425">struct</span>&nbsp;<span class="op" id="4080432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080435">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080446"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4080450">.</span><span class="ident" id="4080451">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080463">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4080474">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080479">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080490"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4080494">.</span><span class="ident" id="4080495">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080505">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4080516"><a href="/crypto/x509/x509.go.html#4033546">publicKeyInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080531">Attributes</span>&nbsp;<span class="op" id="4080542">[</span><span class="op" id="4080543">]</span><span class="ident" id="4080544"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4080548">.</span><span class="ident" id="4080549">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4080574">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4080589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4080592">type</span>&nbsp;<span class="ident" id="4080597">certificateRequest</span>&nbsp;<span class="keyword" id="4080616">struct</span>&nbsp;<span class="op" id="4080623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080626">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080645"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4080649">.</span><span class="ident" id="4080650">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080662">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080681"><a href="/crypto/x509/x509.go.html#4080403">tbsCertificateRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080704">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4080723"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4080727">.</span><span class="ident" id="4080728">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080749">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080768"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4080772">.</span><span class="ident" id="4080773">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4080783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4080786">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4080864">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4080888">var</span>&nbsp;<span class="ident" id="4080892">oidExtensionRequest</span>&nbsp;<span class="op" id="4080912">=</span>&nbsp;<span class="ident" id="4080914"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4080918">.</span><span class="ident" id="4080919">ObjectIdentifier</span><span class="op" id="4080935">{</span><span class="num" id="4080936">1</span><span class="op" id="4080937">,</span>&nbsp;<span class="num" id="4080939">2</span><span class="op" id="4080940">,</span>&nbsp;<span class="num" id="4080942">840</span><span class="op" id="4080945">,</span>&nbsp;<span class="num" id="4080947">113549</span><span class="op" id="4080953">,</span>&nbsp;<span class="num" id="4080955">1</span><span class="op" id="4080956">,</span>&nbsp;<span class="num" id="4080958">9</span><span class="op" id="4080959">,</span>&nbsp;<span class="num" id="4080961">14</span><span class="op" id="4080963">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4080966">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4081045">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4081109">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4081187">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4081240">//</span><br>
<span class="lineno"></span><span class="comment" id="4081243">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4081309">//</span><br>
<span class="lineno"></span><span class="comment" id="4081312">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4081380">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4081404">func</span>&nbsp;<span class="ident" id="4081409">CreateCertificateRequest</span><span class="op" id="4081433">(</span><span class="ident" id="4081434">rand</span>&nbsp;<span class="ident" id="4081439"><a href="/crypto/x509/x509.go.html#4030150">io</a></span><span class="op" id="4081441">.</span><span class="ident" id="4081442">Reader</span><span class="op" id="4081448">,</span>&nbsp;<span class="ident" id="4081450">template</span>&nbsp;<span class="op" id="4081459">*</span><span class="ident" id="4081460"><a href="/crypto/x509/x509.go.html#4078895">CertificateRequest</a></span><span class="op" id="4081478">,</span>&nbsp;<span class="ident" id="4081480">priv</span>&nbsp;<span class="keyword" id="4081485">interface</span><span class="op" id="4081494">{</span><span class="op" id="4081495">}</span><span class="op" id="4081496">)</span>&nbsp;<span class="op" id="4081498">(</span><span class="ident" id="4081499">csr</span>&nbsp;<span class="op" id="4081503">[</span><span class="op" id="4081504">]</span><span class="builtintype" id="4081505">byte</span><span class="op" id="4081509">,</span>&nbsp;<span class="ident" id="4081511">err</span>&nbsp;<span class="builtintype" id="4081515">error</span><span class="op" id="4081520">)</span>&nbsp;<span class="op" id="4081522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081525">hashFunc</span><span class="op" id="4081533">,</span>&nbsp;<span class="ident" id="4081535">sigAlgo</span><span class="op" id="4081542">,</span>&nbsp;<span class="ident" id="4081544"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4081548">:=</span>&nbsp;<span class="ident" id="4081551"><a href="/crypto/x509/x509.go.html#4072322">signingParamsForPrivateKey</a></span><span class="op" id="4081577">(</span><span class="ident" id="4081578"><a href="/crypto/x509/x509.go.html#4081480">priv</a></span><span class="op" id="4081582">,</span>&nbsp;<span class="ident" id="4081584"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4081592">.</span><span class="ident" id="4081593">SignatureAlgorithm</span><span class="op" id="4081611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081614">if</span>&nbsp;<span class="ident" id="4081617"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4081621">!=</span>&nbsp;<span class="ident" id="4081624">nil</span>&nbsp;<span class="op" id="4081628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081632">return</span>&nbsp;<span class="ident" id="4081639">nil</span><span class="op" id="4081642">,</span>&nbsp;<span class="ident" id="4081644"><a href="/crypto/x509/x509.go.html#4081511">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081649">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081653">var</span>&nbsp;<span class="ident" id="4081657">publicKeyBytes</span>&nbsp;<span class="op" id="4081672">[</span><span class="op" id="4081673">]</span><span class="builtintype" id="4081674">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081680">var</span>&nbsp;<span class="ident" id="4081684">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4081703"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4081707">.</span><span class="ident" id="4081708">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081730">switch</span>&nbsp;<span class="ident" id="4081737">priv</span>&nbsp;<span class="op" id="4081742">:=</span>&nbsp;<span class="ident" id="4081745"><a href="/crypto/x509/x509.go.html#4081480">priv</a></span><span class="op" id="4081749">.</span><span class="op" id="4081750">(</span><span class="keyword" id="4081751">type</span><span class="op" id="4081755">)</span>&nbsp;<span class="op" id="4081757">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081760">case</span>&nbsp;<span class="op" id="4081765">*</span><span class="ident" id="4081766"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4081769">.</span><span class="ident" id="4081770">PrivateKey</span><span class="op" id="4081780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081784"><a href="/crypto/x509/x509.go.html#4081657">publicKeyBytes</a></span><span class="op" id="4081798">,</span>&nbsp;<span class="ident" id="4081800"><a href="/crypto/x509/x509.go.html#4081684">publicKeyAlgorithm</a></span><span class="op" id="4081818">,</span>&nbsp;<span class="ident" id="4081820"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4081824">=</span>&nbsp;<span class="ident" id="4081826"><a href="/crypto/x509/x509.go.html#4030892">marshalPublicKey</a></span><span class="op" id="4081842">(</span><span class="op" id="4081843">&amp;</span><span class="ident" id="4081844"><a href="/crypto/x509/x509.go.html#4081737">priv</a></span><span class="op" id="4081848">.</span><span class="ident" id="4081849">PublicKey</span><span class="op" id="4081858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081861">case</span>&nbsp;<span class="op" id="4081866">*</span><span class="ident" id="4081867"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4081872">.</span><span class="ident" id="4081873">PrivateKey</span><span class="op" id="4081883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081887"><a href="/crypto/x509/x509.go.html#4081657">publicKeyBytes</a></span><span class="op" id="4081901">,</span>&nbsp;<span class="ident" id="4081903"><a href="/crypto/x509/x509.go.html#4081684">publicKeyAlgorithm</a></span><span class="op" id="4081921">,</span>&nbsp;<span class="ident" id="4081923"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4081927">=</span>&nbsp;<span class="ident" id="4081929"><a href="/crypto/x509/x509.go.html#4030892">marshalPublicKey</a></span><span class="op" id="4081945">(</span><span class="op" id="4081946">&amp;</span><span class="ident" id="4081947"><a href="/crypto/x509/x509.go.html#4081737">priv</a></span><span class="op" id="4081951">.</span><span class="ident" id="4081952">PublicKey</span><span class="op" id="4081961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081964">default</span><span class="op" id="4081971">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4081975">panic</span><span class="op" id="4081980">(</span><span class="string" id="4081981">&#34;internal&nbsp;error&#34;</span><span class="op" id="4081997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082004">if</span>&nbsp;<span class="ident" id="4082007"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4082011">!=</span>&nbsp;<span class="ident" id="4082014">nil</span>&nbsp;<span class="op" id="4082018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082022">return</span>&nbsp;<span class="ident" id="4082029">nil</span><span class="op" id="4082032">,</span>&nbsp;<span class="ident" id="4082034"><a href="/crypto/x509/x509.go.html#4081511">err</a></span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082043">var</span>&nbsp;<span class="ident" id="4082047">extensions</span>&nbsp;<span class="op" id="4082058">[</span><span class="op" id="4082059">]</span><span class="ident" id="4082060"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4082064">.</span><span class="ident" id="4082065">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082077">if</span>&nbsp;<span class="op" id="4082080">(</span><span class="builtinfunc" id="4082081">len</span><span class="op" id="4082084">(</span><span class="ident" id="4082085"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082093">.</span><span class="ident" id="4082094">DNSNames</span><span class="op" id="4082102">)</span>&nbsp;<span class="op" id="4082104">&gt;</span>&nbsp;<span class="num" id="4082106">0</span>&nbsp;<span class="op" id="4082108">||</span>&nbsp;<span class="builtinfunc" id="4082111">len</span><span class="op" id="4082114">(</span><span class="ident" id="4082115"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082123">.</span><span class="ident" id="4082124">EmailAddresses</span><span class="op" id="4082138">)</span>&nbsp;<span class="op" id="4082140">&gt;</span>&nbsp;<span class="num" id="4082142">0</span>&nbsp;<span class="op" id="4082144">||</span>&nbsp;<span class="builtinfunc" id="4082147">len</span><span class="op" id="4082150">(</span><span class="ident" id="4082151"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082159">.</span><span class="ident" id="4082160">IPAddresses</span><span class="op" id="4082171">)</span>&nbsp;<span class="op" id="4082173">&gt;</span>&nbsp;<span class="num" id="4082175">0</span><span class="op" id="4082176">)</span>&nbsp;<span class="op" id="4082178">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082183">!</span><span class="ident" id="4082184"><a href="/crypto/x509/x509.go.html#4065829">oidInExtensions</a></span><span class="op" id="4082199">(</span><span class="ident" id="4082200"><a href="/crypto/x509/x509.go.html#4065254">oidExtensionSubjectAltName</a></span><span class="op" id="4082226">,</span>&nbsp;<span class="ident" id="4082228"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082236">.</span><span class="ident" id="4082237">ExtraExtensions</span><span class="op" id="4082252">)</span>&nbsp;<span class="op" id="4082254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082258">sanBytes</span><span class="op" id="4082266">,</span>&nbsp;<span class="ident" id="4082268">err</span>&nbsp;<span class="op" id="4082272">:=</span>&nbsp;<span class="ident" id="4082275"><a href="/crypto/x509/x509.go.html#4066120">marshalSANs</a></span><span class="op" id="4082286">(</span><span class="ident" id="4082287"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082295">.</span><span class="ident" id="4082296">DNSNames</span><span class="op" id="4082304">,</span>&nbsp;<span class="ident" id="4082306"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082314">.</span><span class="ident" id="4082315">EmailAddresses</span><span class="op" id="4082329">,</span>&nbsp;<span class="ident" id="4082331"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082339">.</span><span class="ident" id="4082340">IPAddresses</span><span class="op" id="4082351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082355">if</span>&nbsp;<span class="ident" id="4082358"><a href="/crypto/x509/x509.go.html#4082268">err</a></span>&nbsp;<span class="op" id="4082362">!=</span>&nbsp;<span class="ident" id="4082365">nil</span>&nbsp;<span class="op" id="4082369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082374">return</span>&nbsp;<span class="ident" id="4082381">nil</span><span class="op" id="4082384">,</span>&nbsp;<span class="ident" id="4082386"><a href="/crypto/x509/x509.go.html#4082268">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082392">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082397"><a href="/crypto/x509/x509.go.html#4082047">extensions</a></span>&nbsp;<span class="op" id="4082408">=</span>&nbsp;<span class="builtinfunc" id="4082410">append</span><span class="op" id="4082416">(</span><span class="ident" id="4082417"><a href="/crypto/x509/x509.go.html#4082047">extensions</a></span><span class="op" id="4082427">,</span>&nbsp;<span class="ident" id="4082429"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4082433">.</span><span class="ident" id="4082434">Extension</span><span class="op" id="4082443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082448">Id</span><span class="op" id="4082450">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082455"><a href="/crypto/x509/x509.go.html#4065254">oidExtensionSubjectAltName</a></span><span class="op" id="4082481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082486">Value</span><span class="op" id="4082491">:</span>&nbsp;<span class="ident" id="4082493"><a href="/crypto/x509/x509.go.html#4082258">sanBytes</a></span><span class="op" id="4082501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082505">}</span><span class="op" id="4082506">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082513"><a href="/crypto/x509/x509.go.html#4082047">extensions</a></span>&nbsp;<span class="op" id="4082524">=</span>&nbsp;<span class="builtinfunc" id="4082526">append</span><span class="op" id="4082532">(</span><span class="ident" id="4082533"><a href="/crypto/x509/x509.go.html#4082047">extensions</a></span><span class="op" id="4082543">,</span>&nbsp;<span class="ident" id="4082545"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082553">.</span><span class="ident" id="4082554">ExtraExtensions</span><span class="op" id="4082569">...</span><span class="op" id="4082572">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082576">var</span>&nbsp;<span class="ident" id="4082580">attributes</span>&nbsp;<span class="op" id="4082591">[</span><span class="op" id="4082592">]</span><span class="ident" id="4082593"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4082597">.</span><span class="ident" id="4082598">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082624"><a href="/crypto/x509/x509.go.html#4082580">attributes</a></span>&nbsp;<span class="op" id="4082635">=</span>&nbsp;<span class="builtinfunc" id="4082637">append</span><span class="op" id="4082643">(</span><span class="ident" id="4082644"><a href="/crypto/x509/x509.go.html#4082580">attributes</a></span><span class="op" id="4082654">,</span>&nbsp;<span class="ident" id="4082656"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082664">.</span><span class="ident" id="4082665">Attributes</span><span class="op" id="4082675">...</span><span class="op" id="4082678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082682">if</span>&nbsp;<span class="builtinfunc" id="4082685">len</span><span class="op" id="4082688">(</span><span class="ident" id="4082689"><a href="/crypto/x509/x509.go.html#4082047">extensions</a></span><span class="op" id="4082699">)</span>&nbsp;<span class="op" id="4082701">&gt;</span>&nbsp;<span class="num" id="4082703">0</span>&nbsp;<span class="op" id="4082705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4082709">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4082770">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082816">specifiedExtensions</span>&nbsp;<span class="op" id="4082836">:=</span>&nbsp;<span class="builtinfunc" id="4082839">make</span><span class="op" id="4082843">(</span><span class="keyword" id="4082844">map</span><span class="op" id="4082847">[</span><span class="builtintype" id="4082848">string</span><span class="op" id="4082854">]</span><span class="builtintype" id="4082855">bool</span><span class="op" id="4082859">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082864">for</span>&nbsp;<span class="ident" id="4082868">_</span><span class="op" id="4082869">,</span>&nbsp;<span class="ident" id="4082871">atvSet</span>&nbsp;<span class="op" id="4082878">:=</span>&nbsp;<span class="keyword" id="4082881">range</span>&nbsp;<span class="ident" id="4082887"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4082895">.</span><span class="ident" id="4082896">Attributes</span>&nbsp;<span class="op" id="4082907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082912">if</span>&nbsp;<span class="op" id="4082915">!</span><span class="ident" id="4082916"><a href="/crypto/x509/x509.go.html#4082871">atvSet</a></span><span class="op" id="4082922">.</span><span class="ident" id="4082923">Type</span><span class="op" id="4082927">.</span><span class="ident" id="4082928">Equal</span><span class="op" id="4082933">(</span><span class="ident" id="4082934"><a href="/crypto/x509/x509.go.html#4080892">oidExtensionRequest</a></span><span class="op" id="4082953">)</span>&nbsp;<span class="op" id="4082955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082961">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082979">for</span>&nbsp;<span class="ident" id="4082983">_</span><span class="op" id="4082984">,</span>&nbsp;<span class="ident" id="4082986">atvs</span>&nbsp;<span class="op" id="4082991">:=</span>&nbsp;<span class="keyword" id="4082994">range</span>&nbsp;<span class="ident" id="4083000"><a href="/crypto/x509/x509.go.html#4082871">atvSet</a></span><span class="op" id="4083006">.</span><span class="ident" id="4083007">Value</span>&nbsp;<span class="op" id="4083013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083019">for</span>&nbsp;<span class="ident" id="4083023">_</span><span class="op" id="4083024">,</span>&nbsp;<span class="ident" id="4083026">atv</span>&nbsp;<span class="op" id="4083030">:=</span>&nbsp;<span class="keyword" id="4083033">range</span>&nbsp;<span class="ident" id="4083039"><a href="/crypto/x509/x509.go.html#4082986">atvs</a></span>&nbsp;<span class="op" id="4083044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083051"><a href="/crypto/x509/x509.go.html#4082816">specifiedExtensions</a></span><span class="op" id="4083070">[</span><span class="ident" id="4083071"><a href="/crypto/x509/x509.go.html#4083026">atv</a></span><span class="op" id="4083074">.</span><span class="ident" id="4083075">Type</span><span class="op" id="4083079">.</span><span class="ident" id="4083080">String</span><span class="op" id="4083086">(</span><span class="op" id="4083087">)</span><span class="op" id="4083088">]</span>&nbsp;<span class="op" id="4083090">=</span>&nbsp;<span class="builtintype" id="4083092">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083115">atvs</span>&nbsp;<span class="op" id="4083120">:=</span>&nbsp;<span class="builtinfunc" id="4083123">make</span><span class="op" id="4083127">(</span><span class="op" id="4083128">[</span><span class="op" id="4083129">]</span><span class="ident" id="4083130"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4083134">.</span><span class="ident" id="4083135">AttributeTypeAndValue</span><span class="op" id="4083156">,</span>&nbsp;<span class="num" id="4083158">0</span><span class="op" id="4083159">,</span>&nbsp;<span class="builtinfunc" id="4083161">len</span><span class="op" id="4083164">(</span><span class="ident" id="4083165"><a href="/crypto/x509/x509.go.html#4082047">extensions</a></span><span class="op" id="4083175">)</span><span class="op" id="4083176">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083180">for</span>&nbsp;<span class="ident" id="4083184">_</span><span class="op" id="4083185">,</span>&nbsp;<span class="ident" id="4083187">e</span>&nbsp;<span class="op" id="4083189">:=</span>&nbsp;<span class="keyword" id="4083192">range</span>&nbsp;<span class="ident" id="4083198"><a href="/crypto/x509/x509.go.html#4082047">extensions</a></span>&nbsp;<span class="op" id="4083209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083214">if</span>&nbsp;<span class="ident" id="4083217"><a href="/crypto/x509/x509.go.html#4082816">specifiedExtensions</a></span><span class="op" id="4083236">[</span><span class="ident" id="4083237"><a href="/crypto/x509/x509.go.html#4083187">e</a></span><span class="op" id="4083238">.</span><span class="ident" id="4083239">Id</span><span class="op" id="4083241">.</span><span class="ident" id="4083242">String</span><span class="op" id="4083248">(</span><span class="op" id="4083249">)</span><span class="op" id="4083250">]</span>&nbsp;<span class="op" id="4083252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083258">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083306">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083351">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083369"><a href="/crypto/x509/x509.go.html#4083115">atvs</a></span>&nbsp;<span class="op" id="4083374">=</span>&nbsp;<span class="builtinfunc" id="4083376">append</span><span class="op" id="4083382">(</span><span class="ident" id="4083383"><a href="/crypto/x509/x509.go.html#4083115">atvs</a></span><span class="op" id="4083387">,</span>&nbsp;<span class="ident" id="4083389"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4083393">.</span><span class="ident" id="4083394">AttributeTypeAndValue</span><span class="op" id="4083415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083421">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083478">Type</span><span class="op" id="4083482">:</span>&nbsp;&nbsp;<span class="ident" id="4083485"><a href="/crypto/x509/x509.go.html#4083187">e</a></span><span class="op" id="4083486">.</span><span class="ident" id="4083487">Id</span><span class="op" id="4083489">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083495">Value</span><span class="op" id="4083500">:</span>&nbsp;<span class="ident" id="4083502"><a href="/crypto/x509/x509.go.html#4083187">e</a></span><span class="op" id="4083503">.</span><span class="ident" id="4083504">Value</span><span class="op" id="4083509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083514">}</span><span class="op" id="4083515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083524">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083589">appended</span>&nbsp;<span class="op" id="4083598">:=</span>&nbsp;<span class="builtintype" id="4083601">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083609">for</span>&nbsp;<span class="ident" id="4083613">_</span><span class="op" id="4083614">,</span>&nbsp;<span class="ident" id="4083616">atvSet</span>&nbsp;<span class="op" id="4083623">:=</span>&nbsp;<span class="keyword" id="4083626">range</span>&nbsp;<span class="ident" id="4083632"><a href="/crypto/x509/x509.go.html#4082580">attributes</a></span>&nbsp;<span class="op" id="4083643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083648">if</span>&nbsp;<span class="op" id="4083651">!</span><span class="ident" id="4083652"><a href="/crypto/x509/x509.go.html#4083616">atvSet</a></span><span class="op" id="4083658">.</span><span class="ident" id="4083659">Type</span><span class="op" id="4083663">.</span><span class="ident" id="4083664">Equal</span><span class="op" id="4083669">(</span><span class="ident" id="4083670"><a href="/crypto/x509/x509.go.html#4080892">oidExtensionRequest</a></span><span class="op" id="4083689">)</span>&nbsp;<span class="op" id="4083691">||</span>&nbsp;<span class="builtinfunc" id="4083694">len</span><span class="op" id="4083697">(</span><span class="ident" id="4083698"><a href="/crypto/x509/x509.go.html#4083616">atvSet</a></span><span class="op" id="4083704">.</span><span class="ident" id="4083705">Value</span><span class="op" id="4083710">)</span>&nbsp;<span class="op" id="4083712">==</span>&nbsp;<span class="num" id="4083715">0</span>&nbsp;<span class="op" id="4083717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083723">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083735">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083741"><a href="/crypto/x509/x509.go.html#4083616">atvSet</a></span><span class="op" id="4083747">.</span><span class="ident" id="4083748">Value</span><span class="op" id="4083753">[</span><span class="num" id="4083754">0</span><span class="op" id="4083755">]</span>&nbsp;<span class="op" id="4083757">=</span>&nbsp;<span class="builtinfunc" id="4083759">append</span><span class="op" id="4083765">(</span><span class="ident" id="4083766"><a href="/crypto/x509/x509.go.html#4083616">atvSet</a></span><span class="op" id="4083772">.</span><span class="ident" id="4083773">Value</span><span class="op" id="4083778">[</span><span class="num" id="4083779">0</span><span class="op" id="4083780">]</span><span class="op" id="4083781">,</span>&nbsp;<span class="ident" id="4083783"><a href="/crypto/x509/x509.go.html#4083115">atvs</a></span><span class="op" id="4083787">...</span><span class="op" id="4083790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083795"><a href="/crypto/x509/x509.go.html#4083589">appended</a></span>&nbsp;<span class="op" id="4083804">=</span>&nbsp;<span class="builtintype" id="4083806">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083814">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083822">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083827">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083883">if</span>&nbsp;<span class="op" id="4083886">!</span><span class="ident" id="4083887"><a href="/crypto/x509/x509.go.html#4083589">appended</a></span>&nbsp;<span class="op" id="4083896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083901"><a href="/crypto/x509/x509.go.html#4082580">attributes</a></span>&nbsp;<span class="op" id="4083912">=</span>&nbsp;<span class="builtinfunc" id="4083914">append</span><span class="op" id="4083920">(</span><span class="ident" id="4083921"><a href="/crypto/x509/x509.go.html#4082580">attributes</a></span><span class="op" id="4083931">,</span>&nbsp;<span class="ident" id="4083933"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4083937">.</span><span class="ident" id="4083938">AttributeTypeAndValueSET</span><span class="op" id="4083962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083968">Type</span><span class="op" id="4083972">:</span>&nbsp;<span class="ident" id="4083974"><a href="/crypto/x509/x509.go.html#4080892">oidExtensionRequest</a></span><span class="op" id="4083993">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083999">Value</span><span class="op" id="4084004">:</span>&nbsp;<span class="op" id="4084006">[</span><span class="op" id="4084007">]</span><span class="op" id="4084008">[</span><span class="op" id="4084009">]</span><span class="ident" id="4084010"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4084014">.</span><span class="ident" id="4084015">AttributeTypeAndValue</span><span class="op" id="4084036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084043"><a href="/crypto/x509/x509.go.html#4083115">atvs</a></span><span class="op" id="4084047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084053">}</span><span class="op" id="4084054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084059">}</span><span class="op" id="4084060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084064">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084071">asn1Subject</span>&nbsp;<span class="op" id="4084083">:=</span>&nbsp;<span class="ident" id="4084086"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4084094">.</span><span class="ident" id="4084095">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084107">if</span>&nbsp;<span class="builtinfunc" id="4084110">len</span><span class="op" id="4084113">(</span><span class="ident" id="4084114"><a href="/crypto/x509/x509.go.html#4084071">asn1Subject</a></span><span class="op" id="4084125">)</span>&nbsp;<span class="op" id="4084127">==</span>&nbsp;<span class="num" id="4084130">0</span>&nbsp;<span class="op" id="4084132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084136"><a href="/crypto/x509/x509.go.html#4084071">asn1Subject</a></span><span class="op" id="4084147">,</span>&nbsp;<span class="ident" id="4084149"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4084153">=</span>&nbsp;<span class="ident" id="4084155"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4084159">.</span><span class="ident" id="4084160">Marshal</span><span class="op" id="4084167">(</span><span class="ident" id="4084168"><a href="/crypto/x509/x509.go.html#4081450">template</a></span><span class="op" id="4084176">.</span><span class="ident" id="4084177">Subject</span><span class="op" id="4084184">.</span><span class="ident" id="4084185">ToRDNSequence</span><span class="op" id="4084198">(</span><span class="op" id="4084199">)</span><span class="op" id="4084200">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084204">if</span>&nbsp;<span class="ident" id="4084207"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4084211">!=</span>&nbsp;<span class="ident" id="4084214">nil</span>&nbsp;<span class="op" id="4084218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084223">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084239">tbsCSR</span>&nbsp;<span class="op" id="4084246">:=</span>&nbsp;<span class="ident" id="4084249"><a href="/crypto/x509/x509.go.html#4080403">tbsCertificateRequest</a></span><span class="op" id="4084270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084274">Version</span><span class="op" id="4084281">:</span>&nbsp;<span class="num" id="4084283">0</span><span class="op" id="4084284">,</span>&nbsp;<span class="comment" id="4084286">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084310">Subject</span><span class="op" id="4084317">:</span>&nbsp;<span class="ident" id="4084319"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4084323">.</span><span class="ident" id="4084324">RawValue</span><span class="op" id="4084332">{</span><span class="ident" id="4084333">FullBytes</span><span class="op" id="4084342">:</span>&nbsp;<span class="ident" id="4084344"><a href="/crypto/x509/x509.go.html#4084071">asn1Subject</a></span><span class="op" id="4084355">}</span><span class="op" id="4084356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084360">PublicKey</span><span class="op" id="4084369">:</span>&nbsp;<span class="ident" id="4084371"><a href="/crypto/x509/x509.go.html#4033546">publicKeyInfo</a></span><span class="op" id="4084384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084389">Algorithm</span><span class="op" id="4084398">:</span>&nbsp;<span class="ident" id="4084400"><a href="/crypto/x509/x509.go.html#4081684">publicKeyAlgorithm</a></span><span class="op" id="4084418">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084423">PublicKey</span><span class="op" id="4084432">:</span>&nbsp;<span class="ident" id="4084434"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4084438">.</span><span class="ident" id="4084439">BitString</span><span class="op" id="4084448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084454">Bytes</span><span class="op" id="4084459">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084465"><a href="/crypto/x509/x509.go.html#4081657">publicKeyBytes</a></span><span class="op" id="4084479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084485">BitLength</span><span class="op" id="4084494">:</span>&nbsp;<span class="builtinfunc" id="4084496">len</span><span class="op" id="4084499">(</span><span class="ident" id="4084500"><a href="/crypto/x509/x509.go.html#4081657">publicKeyBytes</a></span><span class="op" id="4084514">)</span>&nbsp;<span class="op" id="4084516">*</span>&nbsp;<span class="num" id="4084518">8</span><span class="op" id="4084519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084524">}</span><span class="op" id="4084525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084529">}</span><span class="op" id="4084530">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084534">Attributes</span><span class="op" id="4084544">:</span>&nbsp;<span class="ident" id="4084546"><a href="/crypto/x509/x509.go.html#4082580">attributes</a></span><span class="op" id="4084556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084563">tbsCSRContents</span><span class="op" id="4084577">,</span>&nbsp;<span class="ident" id="4084579"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4084583">:=</span>&nbsp;<span class="ident" id="4084586"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4084590">.</span><span class="ident" id="4084591">Marshal</span><span class="op" id="4084598">(</span><span class="ident" id="4084599"><a href="/crypto/x509/x509.go.html#4084239">tbsCSR</a></span><span class="op" id="4084605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084608">if</span>&nbsp;<span class="ident" id="4084611"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4084615">!=</span>&nbsp;<span class="ident" id="4084618">nil</span>&nbsp;<span class="op" id="4084622">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084626">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084637"><a href="/crypto/x509/x509.go.html#4084239">tbsCSR</a></span><span class="op" id="4084643">.</span><span class="ident" id="4084644">Raw</span>&nbsp;<span class="op" id="4084648">=</span>&nbsp;<span class="ident" id="4084650"><a href="/crypto/x509/x509.go.html#4084563">tbsCSRContents</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084667">h</span>&nbsp;<span class="op" id="4084669">:=</span>&nbsp;<span class="ident" id="4084672"><a href="/crypto/x509/x509.go.html#4081525">hashFunc</a></span><span class="op" id="4084680">.</span><span class="ident" id="4084681">New</span><span class="op" id="4084684">(</span><span class="op" id="4084685">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084688"><a href="/crypto/x509/x509.go.html#4084667">h</a></span><span class="op" id="4084689">.</span><span class="ident" id="4084690">Write</span><span class="op" id="4084695">(</span><span class="ident" id="4084696"><a href="/crypto/x509/x509.go.html#4084563">tbsCSRContents</a></span><span class="op" id="4084710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084713">digest</span>&nbsp;<span class="op" id="4084720">:=</span>&nbsp;<span class="ident" id="4084723"><a href="/crypto/x509/x509.go.html#4084667">h</a></span><span class="op" id="4084724">.</span><span class="ident" id="4084725">Sum</span><span class="op" id="4084728">(</span><span class="ident" id="4084729">nil</span><span class="op" id="4084732">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084736">var</span>&nbsp;<span class="ident" id="4084740">signature</span>&nbsp;<span class="op" id="4084750">[</span><span class="op" id="4084751">]</span><span class="builtintype" id="4084752">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084758">switch</span>&nbsp;<span class="ident" id="4084765">priv</span>&nbsp;<span class="op" id="4084770">:=</span>&nbsp;<span class="ident" id="4084773"><a href="/crypto/x509/x509.go.html#4081480">priv</a></span><span class="op" id="4084777">.</span><span class="op" id="4084778">(</span><span class="keyword" id="4084779">type</span><span class="op" id="4084783">)</span>&nbsp;<span class="op" id="4084785">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084788">case</span>&nbsp;<span class="op" id="4084793">*</span><span class="ident" id="4084794"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4084797">.</span><span class="ident" id="4084798">PrivateKey</span><span class="op" id="4084808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084812"><a href="/crypto/x509/x509.go.html#4084740">signature</a></span><span class="op" id="4084821">,</span>&nbsp;<span class="ident" id="4084823"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4084827">=</span>&nbsp;<span class="ident" id="4084829"><a href="/crypto/x509/x509.go.html#4030020">rsa</a></span><span class="op" id="4084832">.</span><span class="ident" id="4084833">SignPKCS1v15</span><span class="op" id="4084845">(</span><span class="ident" id="4084846"><a href="/crypto/x509/x509.go.html#4081434">rand</a></span><span class="op" id="4084850">,</span>&nbsp;<span class="ident" id="4084852"><a href="/crypto/x509/x509.go.html#4084765">priv</a></span><span class="op" id="4084856">,</span>&nbsp;<span class="ident" id="4084858"><a href="/crypto/x509/x509.go.html#4081525">hashFunc</a></span><span class="op" id="4084866">,</span>&nbsp;<span class="ident" id="4084868"><a href="/crypto/x509/x509.go.html#4084713">digest</a></span><span class="op" id="4084874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084877">case</span>&nbsp;<span class="op" id="4084882">*</span><span class="ident" id="4084883"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4084888">.</span><span class="ident" id="4084889">PrivateKey</span><span class="op" id="4084899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084903">var</span>&nbsp;<span class="ident" id="4084907">r</span><span class="op" id="4084908">,</span>&nbsp;<span class="ident" id="4084910">s</span>&nbsp;<span class="op" id="4084912">*</span><span class="ident" id="4084913"><a href="/crypto/x509/x509.go.html#4030156">big</a></span><span class="op" id="4084916">.</span><span class="ident" id="4084917">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084923">if</span>&nbsp;<span class="ident" id="4084926"><a href="/crypto/x509/x509.go.html#4084907">r</a></span><span class="op" id="4084927">,</span>&nbsp;<span class="ident" id="4084929"><a href="/crypto/x509/x509.go.html#4084910">s</a></span><span class="op" id="4084930">,</span>&nbsp;<span class="ident" id="4084932"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4084936">=</span>&nbsp;<span class="ident" id="4084938"><a href="/crypto/x509/x509.go.html#4029985">ecdsa</a></span><span class="op" id="4084943">.</span><span class="ident" id="4084944">Sign</span><span class="op" id="4084948">(</span><span class="ident" id="4084949"><a href="/crypto/x509/x509.go.html#4081434">rand</a></span><span class="op" id="4084953">,</span>&nbsp;<span class="ident" id="4084955"><a href="/crypto/x509/x509.go.html#4084765">priv</a></span><span class="op" id="4084959">,</span>&nbsp;<span class="ident" id="4084961"><a href="/crypto/x509/x509.go.html#4084713">digest</a></span><span class="op" id="4084967">)</span><span class="op" id="4084968">;</span>&nbsp;<span class="ident" id="4084970"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4084974">==</span>&nbsp;<span class="ident" id="4084977">nil</span>&nbsp;<span class="op" id="4084981">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084986"><a href="/crypto/x509/x509.go.html#4084740">signature</a></span><span class="op" id="4084995">,</span>&nbsp;<span class="ident" id="4084997"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4085001">=</span>&nbsp;<span class="ident" id="4085003"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4085007">.</span><span class="ident" id="4085008">Marshal</span><span class="op" id="4085015">(</span><span class="ident" id="4085016"><a href="/crypto/x509/x509.go.html#4033455">ecdsaSignature</a></span><span class="op" id="4085030">{</span><span class="ident" id="4085031"><a href="/crypto/x509/x509.go.html#4084907">r</a></span><span class="op" id="4085032">,</span>&nbsp;<span class="ident" id="4085034"><a href="/crypto/x509/x509.go.html#4084910">s</a></span><span class="op" id="4085035">}</span><span class="op" id="4085036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085043">default</span><span class="op" id="4085050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4085054">panic</span><span class="op" id="4085059">(</span><span class="string" id="4085060">&#34;internal&nbsp;error&#34;</span><span class="op" id="4085076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085079">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085083">if</span>&nbsp;<span class="ident" id="4085086"><a href="/crypto/x509/x509.go.html#4081511">err</a></span>&nbsp;<span class="op" id="4085090">!=</span>&nbsp;<span class="ident" id="4085093">nil</span>&nbsp;<span class="op" id="4085097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085101">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085113">return</span>&nbsp;<span class="ident" id="4085120"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4085124">.</span><span class="ident" id="4085125">Marshal</span><span class="op" id="4085132">(</span><span class="ident" id="4085133"><a href="/crypto/x509/x509.go.html#4080597">certificateRequest</a></span><span class="op" id="4085151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085155">TBSCSR</span><span class="op" id="4085161">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085175"><a href="/crypto/x509/x509.go.html#4084239">tbsCSR</a></span><span class="op" id="4085181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085185">SignatureAlgorithm</span><span class="op" id="4085203">:</span>&nbsp;<span class="ident" id="4085205"><a href="/crypto/x509/x509.go.html#4081535">sigAlgo</a></span><span class="op" id="4085212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085216">SignatureValue</span><span class="op" id="4085230">:</span>&nbsp;<span class="ident" id="4085232"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4085236">.</span><span class="ident" id="4085237">BitString</span><span class="op" id="4085246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085251">Bytes</span><span class="op" id="4085256">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085262"><a href="/crypto/x509/x509.go.html#4084740">signature</a></span><span class="op" id="4085271">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085276">BitLength</span><span class="op" id="4085285">:</span>&nbsp;<span class="builtinfunc" id="4085287">len</span><span class="op" id="4085290">(</span><span class="ident" id="4085291"><a href="/crypto/x509/x509.go.html#4084740">signature</a></span><span class="op" id="4085300">)</span>&nbsp;<span class="op" id="4085302">*</span>&nbsp;<span class="num" id="4085304">8</span><span class="op" id="4085305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085309">}</span><span class="op" id="4085310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085313">}</span><span class="op" id="4085314">)</span><br>
<span class="lineno"></span><span class="op" id="4085316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4085319">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4085391">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4085416">func</span>&nbsp;<span class="ident" id="4085421">ParseCertificateRequest</span><span class="op" id="4085444">(</span><span class="ident" id="4085445">asn1Data</span>&nbsp;<span class="op" id="4085454">[</span><span class="op" id="4085455">]</span><span class="builtintype" id="4085456">byte</span><span class="op" id="4085460">)</span>&nbsp;<span class="op" id="4085462">(</span><span class="op" id="4085463">*</span><span class="ident" id="4085464"><a href="/crypto/x509/x509.go.html#4078895">CertificateRequest</a></span><span class="op" id="4085482">,</span>&nbsp;<span class="builtintype" id="4085484">error</span><span class="op" id="4085489">)</span>&nbsp;<span class="op" id="4085491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085494">var</span>&nbsp;<span class="ident" id="4085498">csr</span>&nbsp;<span class="ident" id="4085502"><a href="/crypto/x509/x509.go.html#4080597">certificateRequest</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085523">rest</span><span class="op" id="4085527">,</span>&nbsp;<span class="ident" id="4085529">err</span>&nbsp;<span class="op" id="4085533">:=</span>&nbsp;<span class="ident" id="4085536"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4085540">.</span><span class="ident" id="4085541">Unmarshal</span><span class="op" id="4085550">(</span><span class="ident" id="4085551"><a href="/crypto/x509/x509.go.html#4085445">asn1Data</a></span><span class="op" id="4085559">,</span>&nbsp;<span class="op" id="4085561">&amp;</span><span class="ident" id="4085562"><a href="/crypto/x509/x509.go.html#4085498">csr</a></span><span class="op" id="4085565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085568">if</span>&nbsp;<span class="ident" id="4085571"><a href="/crypto/x509/x509.go.html#4085529">err</a></span>&nbsp;<span class="op" id="4085575">!=</span>&nbsp;<span class="ident" id="4085578">nil</span>&nbsp;<span class="op" id="4085582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085586">return</span>&nbsp;<span class="ident" id="4085593">nil</span><span class="op" id="4085596">,</span>&nbsp;<span class="ident" id="4085598"><a href="/crypto/x509/x509.go.html#4085529">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085603">}</span>&nbsp;<span class="keyword" id="4085605">else</span>&nbsp;<span class="keyword" id="4085610">if</span>&nbsp;<span class="builtinfunc" id="4085613">len</span><span class="op" id="4085616">(</span><span class="ident" id="4085617"><a href="/crypto/x509/x509.go.html#4085523">rest</a></span><span class="op" id="4085621">)</span>&nbsp;<span class="op" id="4085623">!=</span>&nbsp;<span class="num" id="4085626">0</span>&nbsp;<span class="op" id="4085628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085632">return</span>&nbsp;<span class="ident" id="4085639">nil</span><span class="op" id="4085642">,</span>&nbsp;<span class="ident" id="4085644"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4085648">.</span><span class="ident" id="4085649">SyntaxError</span><span class="op" id="4085660">{</span><span class="ident" id="4085661">Msg</span><span class="op" id="4085664">:</span>&nbsp;<span class="string" id="4085666">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4085681">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085688">return</span>&nbsp;<span class="ident" id="4085695"><a href="/crypto/x509/x509.go.html#4085733">parseCertificateRequest</a></span><span class="op" id="4085718">(</span><span class="op" id="4085719">&amp;</span><span class="ident" id="4085720"><a href="/crypto/x509/x509.go.html#4085498">csr</a></span><span class="op" id="4085723">)</span><br>
<span class="lineno"></span><span class="op" id="4085725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4085728">func</span>&nbsp;<span class="ident" id="4085733">parseCertificateRequest</span><span class="op" id="4085756">(</span><span class="ident" id="4085757">in</span>&nbsp;<span class="op" id="4085760">*</span><span class="ident" id="4085761"><a href="/crypto/x509/x509.go.html#4080597">certificateRequest</a></span><span class="op" id="4085779">)</span>&nbsp;<span class="op" id="4085781">(</span><span class="op" id="4085782">*</span><span class="ident" id="4085783"><a href="/crypto/x509/x509.go.html#4078895">CertificateRequest</a></span><span class="op" id="4085801">,</span>&nbsp;<span class="builtintype" id="4085803">error</span><span class="op" id="4085808">)</span>&nbsp;<span class="op" id="4085810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085813">out</span>&nbsp;<span class="op" id="4085817">:=</span>&nbsp;<span class="op" id="4085820">&amp;</span><span class="ident" id="4085821"><a href="/crypto/x509/x509.go.html#4078895">CertificateRequest</a></span><span class="op" id="4085839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085843">Raw</span><span class="op" id="4085846">:</span>&nbsp;<span class="ident" id="4085848"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4085850">.</span><span class="ident" id="4085851">Raw</span><span class="op" id="4085854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085858">RawTBSCertificateRequest</span><span class="op" id="4085882">:</span>&nbsp;<span class="ident" id="4085884"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4085886">.</span><span class="ident" id="4085887">TBSCSR</span><span class="op" id="4085893">.</span><span class="ident" id="4085894">Raw</span><span class="op" id="4085897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085901">RawSubjectPublicKeyInfo</span><span class="op" id="4085924">:</span>&nbsp;&nbsp;<span class="ident" id="4085927"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4085929">.</span><span class="ident" id="4085930">TBSCSR</span><span class="op" id="4085936">.</span><span class="ident" id="4085937">PublicKey</span><span class="op" id="4085946">.</span><span class="ident" id="4085947">Raw</span><span class="op" id="4085950">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085954">RawSubject</span><span class="op" id="4085964">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085980"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4085982">.</span><span class="ident" id="4085983">TBSCSR</span><span class="op" id="4085989">.</span><span class="ident" id="4085990">Subject</span><span class="op" id="4085997">.</span><span class="ident" id="4085998">FullBytes</span><span class="op" id="4086007">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086012">Signature</span><span class="op" id="4086021">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086032"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4086034">.</span><span class="ident" id="4086035">SignatureValue</span><span class="op" id="4086049">.</span><span class="ident" id="4086050">RightAlign</span><span class="op" id="4086060">(</span><span class="op" id="4086061">)</span><span class="op" id="4086062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086066">SignatureAlgorithm</span><span class="op" id="4086084">:</span>&nbsp;<span class="ident" id="4086086"><a href="/crypto/x509/x509.go.html#4037639">getSignatureAlgorithmFromOID</a></span><span class="op" id="4086114">(</span><span class="ident" id="4086115"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4086117">.</span><span class="ident" id="4086118">SignatureAlgorithm</span><span class="op" id="4086136">.</span><span class="ident" id="4086137">Algorithm</span><span class="op" id="4086146">)</span><span class="op" id="4086147">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086152">PublicKeyAlgorithm</span><span class="op" id="4086170">:</span>&nbsp;<span class="ident" id="4086172"><a href="/crypto/x509/x509.go.html#4038569">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4086200">(</span><span class="ident" id="4086201"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4086203">.</span><span class="ident" id="4086204">TBSCSR</span><span class="op" id="4086210">.</span><span class="ident" id="4086211">PublicKey</span><span class="op" id="4086220">.</span><span class="ident" id="4086221">Algorithm</span><span class="op" id="4086230">.</span><span class="ident" id="4086231">Algorithm</span><span class="op" id="4086240">)</span><span class="op" id="4086241">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086246">Version</span><span class="op" id="4086253">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086258"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4086260">.</span><span class="ident" id="4086261">TBSCSR</span><span class="op" id="4086267">.</span><span class="ident" id="4086268">Version</span><span class="op" id="4086275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086279">Attributes</span><span class="op" id="4086289">:</span>&nbsp;<span class="ident" id="4086291"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4086293">.</span><span class="ident" id="4086294">TBSCSR</span><span class="op" id="4086300">.</span><span class="ident" id="4086301">Attributes</span><span class="op" id="4086311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086314">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086318">var</span>&nbsp;<span class="ident" id="4086322">err</span>&nbsp;<span class="builtintype" id="4086326">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086333"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4086336">.</span><span class="ident" id="4086337">PublicKey</span><span class="op" id="4086346">,</span>&nbsp;<span class="ident" id="4086348"><a href="/crypto/x509/x509.go.html#4086322">err</a></span>&nbsp;<span class="op" id="4086352">=</span>&nbsp;<span class="ident" id="4086354"><a href="/crypto/x509/x509.go.html#4053763">parsePublicKey</a></span><span class="op" id="4086368">(</span><span class="ident" id="4086369"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4086372">.</span><span class="ident" id="4086373">PublicKeyAlgorithm</span><span class="op" id="4086391">,</span>&nbsp;<span class="op" id="4086393">&amp;</span><span class="ident" id="4086394"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4086396">.</span><span class="ident" id="4086397">TBSCSR</span><span class="op" id="4086403">.</span><span class="ident" id="4086404">PublicKey</span><span class="op" id="4086413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086416">if</span>&nbsp;<span class="ident" id="4086419"><a href="/crypto/x509/x509.go.html#4086322">err</a></span>&nbsp;<span class="op" id="4086423">!=</span>&nbsp;<span class="ident" id="4086426">nil</span>&nbsp;<span class="op" id="4086430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086434">return</span>&nbsp;<span class="ident" id="4086441">nil</span><span class="op" id="4086444">,</span>&nbsp;<span class="ident" id="4086446"><a href="/crypto/x509/x509.go.html#4086322">err</a></span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086455">var</span>&nbsp;<span class="ident" id="4086459">subject</span>&nbsp;<span class="ident" id="4086467"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4086471">.</span><span class="ident" id="4086472">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086485">if</span>&nbsp;<span class="ident" id="4086488">_</span><span class="op" id="4086489">,</span>&nbsp;<span class="ident" id="4086491">err</span>&nbsp;<span class="op" id="4086495">:=</span>&nbsp;<span class="ident" id="4086498"><a href="/crypto/x509/x509.go.html#4030107">asn1</a></span><span class="op" id="4086502">.</span><span class="ident" id="4086503">Unmarshal</span><span class="op" id="4086512">(</span><span class="ident" id="4086513"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4086515">.</span><span class="ident" id="4086516">TBSCSR</span><span class="op" id="4086522">.</span><span class="ident" id="4086523">Subject</span><span class="op" id="4086530">.</span><span class="ident" id="4086531">FullBytes</span><span class="op" id="4086540">,</span>&nbsp;<span class="op" id="4086542">&amp;</span><span class="ident" id="4086543"><a href="/crypto/x509/x509.go.html#4086459">subject</a></span><span class="op" id="4086550">)</span><span class="op" id="4086551">;</span>&nbsp;<span class="ident" id="4086553"><a href="/crypto/x509/x509.go.html#4086491">err</a></span>&nbsp;<span class="op" id="4086557">!=</span>&nbsp;<span class="ident" id="4086560">nil</span>&nbsp;<span class="op" id="4086564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086568">return</span>&nbsp;<span class="ident" id="4086575">nil</span><span class="op" id="4086578">,</span>&nbsp;<span class="ident" id="4086580"><a href="/crypto/x509/x509.go.html#4086491">err</a></span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086589"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4086592">.</span><span class="ident" id="4086593">Subject</span><span class="op" id="4086600">.</span><span class="ident" id="4086601">FillFromRDNSequence</span><span class="op" id="4086620">(</span><span class="op" id="4086621">&amp;</span><span class="ident" id="4086622"><a href="/crypto/x509/x509.go.html#4086459">subject</a></span><span class="op" id="4086629">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086633">var</span>&nbsp;<span class="ident" id="4086637">extensions</span>&nbsp;<span class="op" id="4086648">[</span><span class="op" id="4086649">]</span><span class="ident" id="4086650"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4086654">.</span><span class="ident" id="4086655">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086679">for</span>&nbsp;<span class="ident" id="4086683">_</span><span class="op" id="4086684">,</span>&nbsp;<span class="ident" id="4086686">atvSet</span>&nbsp;<span class="op" id="4086693">:=</span>&nbsp;<span class="keyword" id="4086696">range</span>&nbsp;<span class="ident" id="4086702"><a href="/crypto/x509/x509.go.html#4085757">in</a></span><span class="op" id="4086704">.</span><span class="ident" id="4086705">TBSCSR</span><span class="op" id="4086711">.</span><span class="ident" id="4086712">Attributes</span>&nbsp;<span class="op" id="4086723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086727">if</span>&nbsp;<span class="op" id="4086730">!</span><span class="ident" id="4086731"><a href="/crypto/x509/x509.go.html#4086686">atvSet</a></span><span class="op" id="4086737">.</span><span class="ident" id="4086738">Type</span><span class="op" id="4086742">.</span><span class="ident" id="4086743">Equal</span><span class="op" id="4086748">(</span><span class="ident" id="4086749"><a href="/crypto/x509/x509.go.html#4080892">oidExtensionRequest</a></span><span class="op" id="4086768">)</span>&nbsp;<span class="op" id="4086770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086775">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086786">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086791">for</span>&nbsp;<span class="ident" id="4086795">_</span><span class="op" id="4086796">,</span>&nbsp;<span class="ident" id="4086798">atvs</span>&nbsp;<span class="op" id="4086803">:=</span>&nbsp;<span class="keyword" id="4086806">range</span>&nbsp;<span class="ident" id="4086812"><a href="/crypto/x509/x509.go.html#4086686">atvSet</a></span><span class="op" id="4086818">.</span><span class="ident" id="4086819">Value</span>&nbsp;<span class="op" id="4086825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086830"><a href="/crypto/x509/x509.go.html#4086637">extensions</a></span>&nbsp;<span class="op" id="4086841">=</span>&nbsp;<span class="builtinfunc" id="4086843">append</span><span class="op" id="4086849">(</span><span class="ident" id="4086850"><a href="/crypto/x509/x509.go.html#4086637">extensions</a></span><span class="op" id="4086860">,</span>&nbsp;<span class="ident" id="4086862"><a href="/crypto/x509/x509.go.html#4086798">atvs</a></span><span class="op" id="4086866">...</span><span class="op" id="4086869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086876">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086880"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4086883">.</span><span class="ident" id="4086884">Extensions</span>&nbsp;<span class="op" id="4086895">=</span>&nbsp;<span class="builtinfunc" id="4086897">make</span><span class="op" id="4086901">(</span><span class="op" id="4086902">[</span><span class="op" id="4086903">]</span><span class="ident" id="4086904"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4086908">.</span><span class="ident" id="4086909">Extension</span><span class="op" id="4086918">,</span>&nbsp;<span class="num" id="4086920">0</span><span class="op" id="4086921">,</span>&nbsp;<span class="builtinfunc" id="4086923">len</span><span class="op" id="4086926">(</span><span class="ident" id="4086927"><a href="/crypto/x509/x509.go.html#4086637">extensions</a></span><span class="op" id="4086937">)</span><span class="op" id="4086938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086942">for</span>&nbsp;<span class="ident" id="4086946">_</span><span class="op" id="4086947">,</span>&nbsp;<span class="ident" id="4086949">e</span>&nbsp;<span class="op" id="4086951">:=</span>&nbsp;<span class="keyword" id="4086954">range</span>&nbsp;<span class="ident" id="4086960"><a href="/crypto/x509/x509.go.html#4086637">extensions</a></span>&nbsp;<span class="op" id="4086971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086975">value</span><span class="op" id="4086980">,</span>&nbsp;<span class="ident" id="4086982">ok</span>&nbsp;<span class="op" id="4086985">:=</span>&nbsp;<span class="ident" id="4086988"><a href="/crypto/x509/x509.go.html#4086949">e</a></span><span class="op" id="4086989">.</span><span class="ident" id="4086990">Value</span><span class="op" id="4086995">.</span><span class="op" id="4086996">(</span><span class="op" id="4086997">[</span><span class="op" id="4086998">]</span><span class="builtintype" id="4086999">byte</span><span class="op" id="4087003">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087007">if</span>&nbsp;<span class="op" id="4087010">!</span><span class="ident" id="4087011"><a href="/crypto/x509/x509.go.html#4086982">ok</a></span>&nbsp;<span class="op" id="4087014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087019">return</span>&nbsp;<span class="ident" id="4087026">nil</span><span class="op" id="4087029">,</span>&nbsp;<span class="ident" id="4087031"><a href="/crypto/x509/x509.go.html#4030140">errors</a></span><span class="op" id="4087037">.</span><span class="ident" id="4087038">New</span><span class="op" id="4087041">(</span><span class="string" id="4087042">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4087101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087110"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4087113">.</span><span class="ident" id="4087114">Extensions</span>&nbsp;<span class="op" id="4087125">=</span>&nbsp;<span class="builtinfunc" id="4087127">append</span><span class="op" id="4087133">(</span><span class="ident" id="4087134"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4087137">.</span><span class="ident" id="4087138">Extensions</span><span class="op" id="4087148">,</span>&nbsp;<span class="ident" id="4087150"><a href="/crypto/x509/x509.go.html#4030087">pkix</a></span><span class="op" id="4087154">.</span><span class="ident" id="4087155">Extension</span><span class="op" id="4087164">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087169">Id</span><span class="op" id="4087171">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087176"><a href="/crypto/x509/x509.go.html#4086949">e</a></span><span class="op" id="4087177">.</span><span class="ident" id="4087178">Type</span><span class="op" id="4087182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087187">Value</span><span class="op" id="4087192">:</span>&nbsp;<span class="ident" id="4087194"><a href="/crypto/x509/x509.go.html#4086975">value</a></span><span class="op" id="4087199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087203">}</span><span class="op" id="4087204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087209">if</span>&nbsp;<span class="builtinfunc" id="4087212">len</span><span class="op" id="4087215">(</span><span class="ident" id="4087216"><a href="/crypto/x509/x509.go.html#4086949">e</a></span><span class="op" id="4087217">.</span><span class="ident" id="4087218">Type</span><span class="op" id="4087222">)</span>&nbsp;<span class="op" id="4087224">==</span>&nbsp;<span class="num" id="4087227">4</span>&nbsp;<span class="op" id="4087229">&amp;&amp;</span>&nbsp;<span class="ident" id="4087232"><a href="/crypto/x509/x509.go.html#4086949">e</a></span><span class="op" id="4087233">.</span><span class="ident" id="4087234">Type</span><span class="op" id="4087238">[</span><span class="num" id="4087239">0</span><span class="op" id="4087240">]</span>&nbsp;<span class="op" id="4087242">==</span>&nbsp;<span class="num" id="4087245">2</span>&nbsp;<span class="op" id="4087247">&amp;&amp;</span>&nbsp;<span class="ident" id="4087250"><a href="/crypto/x509/x509.go.html#4086949">e</a></span><span class="op" id="4087251">.</span><span class="ident" id="4087252">Type</span><span class="op" id="4087256">[</span><span class="num" id="4087257">1</span><span class="op" id="4087258">]</span>&nbsp;<span class="op" id="4087260">==</span>&nbsp;<span class="num" id="4087263">5</span>&nbsp;<span class="op" id="4087265">&amp;&amp;</span>&nbsp;<span class="ident" id="4087268"><a href="/crypto/x509/x509.go.html#4086949">e</a></span><span class="op" id="4087269">.</span><span class="ident" id="4087270">Type</span><span class="op" id="4087274">[</span><span class="num" id="4087275">2</span><span class="op" id="4087276">]</span>&nbsp;<span class="op" id="4087278">==</span>&nbsp;<span class="num" id="4087281">29</span>&nbsp;<span class="op" id="4087284">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087289">switch</span>&nbsp;<span class="ident" id="4087296"><a href="/crypto/x509/x509.go.html#4086949">e</a></span><span class="op" id="4087297">.</span><span class="ident" id="4087298">Type</span><span class="op" id="4087302">[</span><span class="num" id="4087303">3</span><span class="op" id="4087304">]</span>&nbsp;<span class="op" id="4087306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087311">case</span>&nbsp;<span class="num" id="4087316">17</span><span class="op" id="4087318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087324"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4087327">.</span><span class="ident" id="4087328">DNSNames</span><span class="op" id="4087336">,</span>&nbsp;<span class="ident" id="4087338"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4087341">.</span><span class="ident" id="4087342">EmailAddresses</span><span class="op" id="4087356">,</span>&nbsp;<span class="ident" id="4087358"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4087361">.</span><span class="ident" id="4087362">IPAddresses</span><span class="op" id="4087373">,</span>&nbsp;<span class="ident" id="4087375"><a href="/crypto/x509/x509.go.html#4086322">err</a></span>&nbsp;<span class="op" id="4087379">=</span>&nbsp;<span class="ident" id="4087381"><a href="/crypto/x509/x509.go.html#4055528">parseSANExtension</a></span><span class="op" id="4087398">(</span><span class="ident" id="4087399"><a href="/crypto/x509/x509.go.html#4086975">value</a></span><span class="op" id="4087404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087410">if</span>&nbsp;<span class="ident" id="4087413"><a href="/crypto/x509/x509.go.html#4086322">err</a></span>&nbsp;<span class="op" id="4087417">!=</span>&nbsp;<span class="ident" id="4087420">nil</span>&nbsp;<span class="op" id="4087424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087431">return</span>&nbsp;<span class="ident" id="4087438">nil</span><span class="op" id="4087441">,</span>&nbsp;<span class="ident" id="4087443"><a href="/crypto/x509/x509.go.html#4086322">err</a></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087467">return</span>&nbsp;<span class="ident" id="4087474"><a href="/crypto/x509/x509.go.html#4085813">out</a></span><span class="op" id="4087477">,</span>&nbsp;<span class="ident" id="4087479">nil</span><br>
<span class="lineno"></span><span class="op" id="4087483">}</span>
</div>
</body>
</html>
