<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8358654">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8358710">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8358764">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8358815">package</span>&nbsp;<span class="ident" id="8358823">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8358829">import</span>&nbsp;<span class="op" id="8358836">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8358839">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8358848">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8358858">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8358865">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8358871">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8358884">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8358895">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8358906">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8358916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8358919">type</span>&nbsp;<span class="ident" id="8358924">reqWriteTest</span>&nbsp;<span class="keyword" id="8358937">struct</span>&nbsp;<span class="op" id="8358944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8358947">Req</span>&nbsp;&nbsp;<span class="ident" id="8358952">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8358961">Body</span>&nbsp;<span class="keyword" id="8358966">interface</span><span class="op" id="8358975">{</span><span class="op" id="8358976">}</span>&nbsp;<span class="comment" id="8358978">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8359044">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359099">WantWrite</span>&nbsp;<span class="builtintype" id="8359109">string</span>&nbsp;<span class="comment" id="8359116">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359134">WantProxy</span>&nbsp;<span class="builtintype" id="8359144">string</span>&nbsp;<span class="comment" id="8359151">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359175">WantError</span>&nbsp;<span class="builtintype" id="8359185">error</span>&nbsp;<span class="comment" id="8359191">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="8359226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8359229">var</span>&nbsp;<span class="ident" id="8359233">reqWriteTests</span>&nbsp;<span class="op" id="8359247">=</span>&nbsp;<span class="op" id="8359249">[</span><span class="op" id="8359250">]</span><span class="ident" id="8359251">reqWriteTest</span><span class="op" id="8359263">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8359266">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8359318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359322">Req</span><span class="op" id="8359325">:</span>&nbsp;<span class="ident" id="8359327">Request</span><span class="op" id="8359334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359339">Method</span><span class="op" id="8359345">:</span>&nbsp;<span class="string" id="8359347">&#34;GET&#34;</span><span class="op" id="8359352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359357">URL</span><span class="op" id="8359360">:</span>&nbsp;<span class="op" id="8359362">&amp;</span><span class="ident" id="8359363">url</span><span class="op" id="8359366">.</span><span class="ident" id="8359367">URL</span><span class="op" id="8359370">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359376">Scheme</span><span class="op" id="8359382">:</span>&nbsp;<span class="string" id="8359384">&#34;http&#34;</span><span class="op" id="8359390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359396">Host</span><span class="op" id="8359400">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8359404">&#34;www.techcrunch.com&#34;</span><span class="op" id="8359424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359430">Path</span><span class="op" id="8359434">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8359438">&#34;/&#34;</span><span class="op" id="8359441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8359446">}</span><span class="op" id="8359447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359452">Proto</span><span class="op" id="8359457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8359464">&#34;HTTP/1.1&#34;</span><span class="op" id="8359474">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359479">ProtoMajor</span><span class="op" id="8359489">:</span>&nbsp;<span class="num" id="8359491">1</span><span class="op" id="8359492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359497">ProtoMinor</span><span class="op" id="8359507">:</span>&nbsp;<span class="num" id="8359509">1</span><span class="op" id="8359510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359515">Header</span><span class="op" id="8359521">:</span>&nbsp;<span class="ident" id="8359523">Header</span><span class="op" id="8359529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8359535">&#34;Accept&#34;</span><span class="op" id="8359543">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8359555">{</span><span class="string" id="8359556">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="8359621">}</span><span class="op" id="8359622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8359628">&#34;Accept-Charset&#34;</span><span class="op" id="8359644">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8359648">{</span><span class="string" id="8359649">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="8359681">}</span><span class="op" id="8359682">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8359688">&#34;Accept-Encoding&#34;</span><span class="op" id="8359705">:</span>&nbsp;&nbsp;<span class="op" id="8359708">{</span><span class="string" id="8359709">&#34;gzip,deflate&#34;</span><span class="op" id="8359723">}</span><span class="op" id="8359724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8359730">&#34;Accept-Language&#34;</span><span class="op" id="8359747">:</span>&nbsp;&nbsp;<span class="op" id="8359750">{</span><span class="string" id="8359751">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="8359767">}</span><span class="op" id="8359768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8359774">&#34;Keep-Alive&#34;</span><span class="op" id="8359786">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8359794">{</span><span class="string" id="8359795">&#34;300&#34;</span><span class="op" id="8359800">}</span><span class="op" id="8359801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8359807">&#34;Proxy-Connection&#34;</span><span class="op" id="8359825">:</span>&nbsp;<span class="op" id="8359827">{</span><span class="string" id="8359828">&#34;keep-alive&#34;</span><span class="op" id="8359840">}</span><span class="op" id="8359841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8359847">&#34;User-Agent&#34;</span><span class="op" id="8359859">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8359867">{</span><span class="string" id="8359868">&#34;Fake&#34;</span><span class="op" id="8359874">}</span><span class="op" id="8359875">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8359880">}</span><span class="op" id="8359881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359886">Body</span><span class="op" id="8359890">:</span>&nbsp;&nbsp;<span class="ident" id="8359893">nil</span><span class="op" id="8359896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359901">Close</span><span class="op" id="8359906">:</span>&nbsp;<span class="builtintype" id="8359908">false</span><span class="op" id="8359913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359918">Host</span><span class="op" id="8359922">:</span>&nbsp;&nbsp;<span class="string" id="8359925">&#34;www.techcrunch.com&#34;</span><span class="op" id="8359945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359950">Form</span><span class="op" id="8359954">:</span>&nbsp;&nbsp;<span class="keyword" id="8359957">map</span><span class="op" id="8359960">[</span><span class="builtintype" id="8359961">string</span><span class="op" id="8359967">]</span><span class="op" id="8359968">[</span><span class="op" id="8359969">]</span><span class="builtintype" id="8359970">string</span><span class="op" id="8359976">{</span><span class="op" id="8359977">}</span><span class="op" id="8359978">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8359982">}</span><span class="op" id="8359983">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8359988">WantWrite</span><span class="op" id="8359997">:</span>&nbsp;<span class="string" id="8359999">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8360020">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360025">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="8360056">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360061">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="8360084">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360089">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="8360167">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360172">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="8360225">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360230">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="8360266">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360271">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="8360309">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360314">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="8360336">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360341">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="8360379">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8360384">WantProxy</span><span class="op" id="8360393">:</span>&nbsp;<span class="string" id="8360395">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8360441">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360446">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="8360477">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360482">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="8360505">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360510">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="8360588">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360593">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="8360646">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360651">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="8360687">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360692">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="8360730">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360735">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="8360757">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8360762">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="8360800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8360803">}</span><span class="op" id="8360804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8360807">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8360859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8360863">Req</span><span class="op" id="8360866">:</span>&nbsp;<span class="ident" id="8360868">Request</span><span class="op" id="8360875">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8360880">Method</span><span class="op" id="8360886">:</span>&nbsp;<span class="string" id="8360888">&#34;GET&#34;</span><span class="op" id="8360893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8360898">URL</span><span class="op" id="8360901">:</span>&nbsp;<span class="op" id="8360903">&amp;</span><span class="ident" id="8360904">url</span><span class="op" id="8360907">.</span><span class="ident" id="8360908">URL</span><span class="op" id="8360911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8360917">Scheme</span><span class="op" id="8360923">:</span>&nbsp;<span class="string" id="8360925">&#34;http&#34;</span><span class="op" id="8360931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8360937">Host</span><span class="op" id="8360941">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8360945">&#34;www.google.com&#34;</span><span class="op" id="8360961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8360967">Path</span><span class="op" id="8360971">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8360975">&#34;/search&#34;</span><span class="op" id="8360984">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8360989">}</span><span class="op" id="8360990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8360995">ProtoMajor</span><span class="op" id="8361005">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8361013">1</span><span class="op" id="8361014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361019">ProtoMinor</span><span class="op" id="8361029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8361037">1</span><span class="op" id="8361038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361043">Header</span><span class="op" id="8361049">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8361061">Header</span><span class="op" id="8361067">{</span><span class="op" id="8361068">}</span><span class="op" id="8361069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361074">TransferEncoding</span><span class="op" id="8361090">:</span>&nbsp;<span class="op" id="8361092">[</span><span class="op" id="8361093">]</span><span class="builtintype" id="8361094">string</span><span class="op" id="8361100">{</span><span class="string" id="8361101">&#34;chunked&#34;</span><span class="op" id="8361110">}</span><span class="op" id="8361111">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361115">}</span><span class="op" id="8361116">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361121">Body</span><span class="op" id="8361125">:</span>&nbsp;<span class="op" id="8361127">[</span><span class="op" id="8361128">]</span><span class="builtintype" id="8361129">byte</span><span class="op" id="8361133">(</span><span class="string" id="8361134">&#34;abcdef&#34;</span><span class="op" id="8361142">)</span><span class="op" id="8361143">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361148">WantWrite</span><span class="op" id="8361157">:</span>&nbsp;<span class="string" id="8361159">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8361186">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8361191">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8361218">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8361223">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8361261">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8361266">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8361303">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361308">chunk</span><span class="op" id="8361313">(</span><span class="string" id="8361314">&#34;abcdef&#34;</span><span class="op" id="8361322">)</span>&nbsp;<span class="op" id="8361324">+</span>&nbsp;<span class="ident" id="8361326">chunk</span><span class="op" id="8361331">(</span><span class="string" id="8361332">&#34;&#34;</span><span class="op" id="8361334">)</span><span class="op" id="8361335">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361340">WantProxy</span><span class="op" id="8361349">:</span>&nbsp;<span class="string" id="8361351">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8361399">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8361404">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8361431">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8361436">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8361474">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8361479">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8361516">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361521">chunk</span><span class="op" id="8361526">(</span><span class="string" id="8361527">&#34;abcdef&#34;</span><span class="op" id="8361535">)</span>&nbsp;<span class="op" id="8361537">+</span>&nbsp;<span class="ident" id="8361539">chunk</span><span class="op" id="8361544">(</span><span class="string" id="8361545">&#34;&#34;</span><span class="op" id="8361547">)</span><span class="op" id="8361548">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361551">}</span><span class="op" id="8361552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8361555">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361616">Req</span><span class="op" id="8361619">:</span>&nbsp;<span class="ident" id="8361621">Request</span><span class="op" id="8361628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361633">Method</span><span class="op" id="8361639">:</span>&nbsp;<span class="string" id="8361641">&#34;POST&#34;</span><span class="op" id="8361647">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361652">URL</span><span class="op" id="8361655">:</span>&nbsp;<span class="op" id="8361657">&amp;</span><span class="ident" id="8361658">url</span><span class="op" id="8361661">.</span><span class="ident" id="8361662">URL</span><span class="op" id="8361665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361671">Scheme</span><span class="op" id="8361677">:</span>&nbsp;<span class="string" id="8361679">&#34;http&#34;</span><span class="op" id="8361685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361691">Host</span><span class="op" id="8361695">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8361699">&#34;www.google.com&#34;</span><span class="op" id="8361715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361721">Path</span><span class="op" id="8361725">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8361729">&#34;/search&#34;</span><span class="op" id="8361738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361743">}</span><span class="op" id="8361744">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361749">ProtoMajor</span><span class="op" id="8361759">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8361767">1</span><span class="op" id="8361768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361773">ProtoMinor</span><span class="op" id="8361783">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8361791">1</span><span class="op" id="8361792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361797">Header</span><span class="op" id="8361803">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8361815">Header</span><span class="op" id="8361821">{</span><span class="op" id="8361822">}</span><span class="op" id="8361823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361828">Close</span><span class="op" id="8361833">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8361846">true</span><span class="op" id="8361850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361855">TransferEncoding</span><span class="op" id="8361871">:</span>&nbsp;<span class="op" id="8361873">[</span><span class="op" id="8361874">]</span><span class="builtintype" id="8361875">string</span><span class="op" id="8361881">{</span><span class="string" id="8361882">&#34;chunked&#34;</span><span class="op" id="8361891">}</span><span class="op" id="8361892">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8361896">}</span><span class="op" id="8361897">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361902">Body</span><span class="op" id="8361906">:</span>&nbsp;<span class="op" id="8361908">[</span><span class="op" id="8361909">]</span><span class="builtintype" id="8361910">byte</span><span class="op" id="8361914">(</span><span class="string" id="8361915">&#34;abcdef&#34;</span><span class="op" id="8361923">)</span><span class="op" id="8361924">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8361929">WantWrite</span><span class="op" id="8361938">:</span>&nbsp;<span class="string" id="8361940">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8361968">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8361973">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8362000">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362005">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8362043">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362048">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8362072">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362077">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8362114">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362119">chunk</span><span class="op" id="8362124">(</span><span class="string" id="8362125">&#34;abcdef&#34;</span><span class="op" id="8362133">)</span>&nbsp;<span class="op" id="8362135">+</span>&nbsp;<span class="ident" id="8362137">chunk</span><span class="op" id="8362142">(</span><span class="string" id="8362143">&#34;&#34;</span><span class="op" id="8362145">)</span><span class="op" id="8362146">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362151">WantProxy</span><span class="op" id="8362160">:</span>&nbsp;<span class="string" id="8362162">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8362211">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362216">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8362243">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362248">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8362286">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362291">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8362315">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362320">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8362357">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362362">chunk</span><span class="op" id="8362367">(</span><span class="string" id="8362368">&#34;abcdef&#34;</span><span class="op" id="8362376">)</span>&nbsp;<span class="op" id="8362378">+</span>&nbsp;<span class="ident" id="8362380">chunk</span><span class="op" id="8362385">(</span><span class="string" id="8362386">&#34;&#34;</span><span class="op" id="8362388">)</span><span class="op" id="8362389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362392">}</span><span class="op" id="8362393">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8362397">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362452">Req</span><span class="op" id="8362455">:</span>&nbsp;<span class="ident" id="8362457">Request</span><span class="op" id="8362464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362469">Method</span><span class="op" id="8362475">:</span>&nbsp;<span class="string" id="8362477">&#34;POST&#34;</span><span class="op" id="8362483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362488">URL</span><span class="op" id="8362491">:</span>&nbsp;<span class="op" id="8362493">&amp;</span><span class="ident" id="8362494">url</span><span class="op" id="8362497">.</span><span class="ident" id="8362498">URL</span><span class="op" id="8362501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362507">Scheme</span><span class="op" id="8362513">:</span>&nbsp;<span class="string" id="8362515">&#34;http&#34;</span><span class="op" id="8362521">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362527">Host</span><span class="op" id="8362531">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8362535">&#34;www.google.com&#34;</span><span class="op" id="8362551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362557">Path</span><span class="op" id="8362561">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8362565">&#34;/search&#34;</span><span class="op" id="8362574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362579">}</span><span class="op" id="8362580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362585">ProtoMajor</span><span class="op" id="8362595">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8362600">1</span><span class="op" id="8362601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362606">ProtoMinor</span><span class="op" id="8362616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8362621">1</span><span class="op" id="8362622">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362627">Header</span><span class="op" id="8362633">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8362642">Header</span><span class="op" id="8362648">{</span><span class="op" id="8362649">}</span><span class="op" id="8362650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362655">Close</span><span class="op" id="8362660">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8362670">true</span><span class="op" id="8362674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362679">ContentLength</span><span class="op" id="8362692">:</span>&nbsp;<span class="num" id="8362694">6</span><span class="op" id="8362695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8362699">}</span><span class="op" id="8362700">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362705">Body</span><span class="op" id="8362709">:</span>&nbsp;<span class="op" id="8362711">[</span><span class="op" id="8362712">]</span><span class="builtintype" id="8362713">byte</span><span class="op" id="8362717">(</span><span class="string" id="8362718">&#34;abcdef&#34;</span><span class="op" id="8362726">)</span><span class="op" id="8362727">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362732">WantWrite</span><span class="op" id="8362741">:</span>&nbsp;<span class="string" id="8362743">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8362771">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362776">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8362803">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362808">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8362846">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362851">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8362875">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362880">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8362904">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362909">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8362916">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362921">&#34;abcdef&#34;</span><span class="op" id="8362929">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8362934">WantProxy</span><span class="op" id="8362943">:</span>&nbsp;<span class="string" id="8362945">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8362994">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8362999">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8363026">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363031">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8363069">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363074">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8363098">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363103">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8363127">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363132">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8363139">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363144">&#34;abcdef&#34;</span><span class="op" id="8363152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363155">}</span><span class="op" id="8363156">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8363160">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363213">Req</span><span class="op" id="8363216">:</span>&nbsp;<span class="ident" id="8363218">Request</span><span class="op" id="8363225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363230">Method</span><span class="op" id="8363236">:</span>&nbsp;<span class="string" id="8363238">&#34;POST&#34;</span><span class="op" id="8363244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363249">URL</span><span class="op" id="8363252">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8363257">mustParseURL</span><span class="op" id="8363269">(</span><span class="string" id="8363270">&#34;http://example.com/&#34;</span><span class="op" id="8363291">)</span><span class="op" id="8363292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363297">Host</span><span class="op" id="8363301">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8363305">&#34;example.com&#34;</span><span class="op" id="8363318">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363323">Header</span><span class="op" id="8363329">:</span>&nbsp;<span class="ident" id="8363331">Header</span><span class="op" id="8363337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363343">&#34;Content-Length&#34;</span><span class="op" id="8363359">:</span>&nbsp;<span class="op" id="8363361">[</span><span class="op" id="8363362">]</span><span class="builtintype" id="8363363">string</span><span class="op" id="8363369">{</span><span class="string" id="8363370">&#34;10&#34;</span><span class="op" id="8363374">}</span><span class="op" id="8363375">,</span>&nbsp;<span class="comment" id="8363377">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363391">}</span><span class="op" id="8363392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363397">ContentLength</span><span class="op" id="8363410">:</span>&nbsp;<span class="num" id="8363412">6</span><span class="op" id="8363413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363417">}</span><span class="op" id="8363418">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363423">Body</span><span class="op" id="8363427">:</span>&nbsp;<span class="op" id="8363429">[</span><span class="op" id="8363430">]</span><span class="builtintype" id="8363431">byte</span><span class="op" id="8363435">(</span><span class="string" id="8363436">&#34;abcdef&#34;</span><span class="op" id="8363444">)</span><span class="op" id="8363445">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363450">WantWrite</span><span class="op" id="8363459">:</span>&nbsp;<span class="string" id="8363461">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8363483">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363488">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8363512">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363517">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8363555">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363560">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8363584">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363589">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8363596">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363601">&#34;abcdef&#34;</span><span class="op" id="8363609">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363614">WantProxy</span><span class="op" id="8363623">:</span>&nbsp;<span class="string" id="8363625">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8363665">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363670">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8363694">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363699">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8363737">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363742">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8363766">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363771">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8363778">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363783">&#34;abcdef&#34;</span><span class="op" id="8363791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363794">}</span><span class="op" id="8363795">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8363799">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363823">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363827">Req</span><span class="op" id="8363830">:</span>&nbsp;<span class="ident" id="8363832">Request</span><span class="op" id="8363839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363844">Method</span><span class="op" id="8363850">:</span>&nbsp;<span class="string" id="8363852">&#34;GET&#34;</span><span class="op" id="8363857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363862">URL</span><span class="op" id="8363865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8363870">mustParseURL</span><span class="op" id="8363882">(</span><span class="string" id="8363883">&#34;/search&#34;</span><span class="op" id="8363892">)</span><span class="op" id="8363893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363898">Host</span><span class="op" id="8363902">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8363906">&#34;www.google.com&#34;</span><span class="op" id="8363922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8363926">}</span><span class="op" id="8363927">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8363932">WantWrite</span><span class="op" id="8363941">:</span>&nbsp;<span class="string" id="8363943">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8363970">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8363975">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8364002">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364007">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8364045">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364050">&#34;\r\n&#34;</span><span class="op" id="8364056">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364059">}</span><span class="op" id="8364060">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8364064">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364122">Req</span><span class="op" id="8364125">:</span>&nbsp;<span class="ident" id="8364127">Request</span><span class="op" id="8364134">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364139">Method</span><span class="op" id="8364145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8364154">&#34;POST&#34;</span><span class="op" id="8364160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364165">URL</span><span class="op" id="8364168">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8364180">mustParseURL</span><span class="op" id="8364192">(</span><span class="string" id="8364193">&#34;/&#34;</span><span class="op" id="8364196">)</span><span class="op" id="8364197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364202">Host</span><span class="op" id="8364206">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8364217">&#34;example.com&#34;</span><span class="op" id="8364230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364235">ProtoMajor</span><span class="op" id="8364245">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8364250">1</span><span class="op" id="8364251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364256">ProtoMinor</span><span class="op" id="8364266">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8364271">1</span><span class="op" id="8364272">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364277">ContentLength</span><span class="op" id="8364290">:</span>&nbsp;<span class="num" id="8364292">0</span><span class="op" id="8364293">,</span>&nbsp;<span class="comment" id="8364295">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364320">}</span><span class="op" id="8364321">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364326">Body</span><span class="op" id="8364330">:</span>&nbsp;<span class="keyword" id="8364332">func</span><span class="op" id="8364336">(</span><span class="op" id="8364337">)</span>&nbsp;<span class="ident" id="8364339">io</span><span class="op" id="8364341">.</span><span class="ident" id="8364342">ReadCloser</span>&nbsp;<span class="op" id="8364353">{</span>&nbsp;<span class="keyword" id="8364355">return</span>&nbsp;<span class="ident" id="8364362">ioutil</span><span class="op" id="8364368">.</span><span class="ident" id="8364369">NopCloser</span><span class="op" id="8364378">(</span><span class="ident" id="8364379">io</span><span class="op" id="8364381">.</span><span class="ident" id="8364382">LimitReader</span><span class="op" id="8364393">(</span><span class="ident" id="8364394">strings</span><span class="op" id="8364401">.</span><span class="ident" id="8364402">NewReader</span><span class="op" id="8364411">(</span><span class="string" id="8364412">&#34;xx&#34;</span><span class="op" id="8364416">)</span><span class="op" id="8364417">,</span>&nbsp;<span class="num" id="8364419">0</span><span class="op" id="8364420">)</span><span class="op" id="8364421">)</span>&nbsp;<span class="op" id="8364423">}</span><span class="op" id="8364424">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8364429">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8364497">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8364551">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364597">WantWrite</span><span class="op" id="8364606">:</span>&nbsp;<span class="string" id="8364608">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8364630">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364635">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8364659">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364664">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8364702">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364707">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8364731">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364736">&#34;\r\n&#34;</span><span class="op" id="8364742">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364747">WantProxy</span><span class="op" id="8364756">:</span>&nbsp;<span class="string" id="8364758">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8364780">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364785">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8364809">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364814">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8364852">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364857">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8364881">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8364886">&#34;\r\n&#34;</span><span class="op" id="8364892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364895">}</span><span class="op" id="8364896">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8364900">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8364954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364958">Req</span><span class="op" id="8364961">:</span>&nbsp;<span class="ident" id="8364963">Request</span><span class="op" id="8364970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8364975">Method</span><span class="op" id="8364981">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8364990">&#34;POST&#34;</span><span class="op" id="8364996">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365001">URL</span><span class="op" id="8365004">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8365016">mustParseURL</span><span class="op" id="8365028">(</span><span class="string" id="8365029">&#34;/&#34;</span><span class="op" id="8365032">)</span><span class="op" id="8365033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365038">Host</span><span class="op" id="8365042">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8365053">&#34;example.com&#34;</span><span class="op" id="8365066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365071">ProtoMajor</span><span class="op" id="8365081">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8365086">1</span><span class="op" id="8365087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365092">ProtoMinor</span><span class="op" id="8365102">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8365107">1</span><span class="op" id="8365108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365113">ContentLength</span><span class="op" id="8365126">:</span>&nbsp;<span class="num" id="8365128">0</span><span class="op" id="8365129">,</span>&nbsp;<span class="comment" id="8365131">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365156">}</span><span class="op" id="8365157">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365162">Body</span><span class="op" id="8365166">:</span>&nbsp;<span class="keyword" id="8365168">func</span><span class="op" id="8365172">(</span><span class="op" id="8365173">)</span>&nbsp;<span class="ident" id="8365175">io</span><span class="op" id="8365177">.</span><span class="ident" id="8365178">ReadCloser</span>&nbsp;<span class="op" id="8365189">{</span>&nbsp;<span class="keyword" id="8365191">return</span>&nbsp;<span class="ident" id="8365198">ioutil</span><span class="op" id="8365204">.</span><span class="ident" id="8365205">NopCloser</span><span class="op" id="8365214">(</span><span class="ident" id="8365215">io</span><span class="op" id="8365217">.</span><span class="ident" id="8365218">LimitReader</span><span class="op" id="8365229">(</span><span class="ident" id="8365230">strings</span><span class="op" id="8365237">.</span><span class="ident" id="8365238">NewReader</span><span class="op" id="8365247">(</span><span class="string" id="8365248">&#34;xx&#34;</span><span class="op" id="8365252">)</span><span class="op" id="8365253">,</span>&nbsp;<span class="num" id="8365255">1</span><span class="op" id="8365256">)</span><span class="op" id="8365257">)</span>&nbsp;<span class="op" id="8365259">}</span><span class="op" id="8365260">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365265">WantWrite</span><span class="op" id="8365274">:</span>&nbsp;<span class="string" id="8365276">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8365298">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8365303">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8365327">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8365332">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8365370">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8365375">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8365412">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365417">chunk</span><span class="op" id="8365422">(</span><span class="string" id="8365423">&#34;x&#34;</span><span class="op" id="8365426">)</span>&nbsp;<span class="op" id="8365428">+</span>&nbsp;<span class="ident" id="8365430">chunk</span><span class="op" id="8365435">(</span><span class="string" id="8365436">&#34;&#34;</span><span class="op" id="8365438">)</span><span class="op" id="8365439">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365444">WantProxy</span><span class="op" id="8365453">:</span>&nbsp;<span class="string" id="8365455">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8365477">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8365482">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8365506">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8365511">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8365549">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8365554">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8365591">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365596">chunk</span><span class="op" id="8365601">(</span><span class="string" id="8365602">&#34;x&#34;</span><span class="op" id="8365605">)</span>&nbsp;<span class="op" id="8365607">+</span>&nbsp;<span class="ident" id="8365609">chunk</span><span class="op" id="8365614">(</span><span class="string" id="8365615">&#34;&#34;</span><span class="op" id="8365617">)</span><span class="op" id="8365618">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365621">}</span><span class="op" id="8365622">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8365626">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365688">Req</span><span class="op" id="8365691">:</span>&nbsp;<span class="ident" id="8365693">Request</span><span class="op" id="8365700">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365705">Method</span><span class="op" id="8365711">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8365720">&#34;POST&#34;</span><span class="op" id="8365726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365731">URL</span><span class="op" id="8365734">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8365746">mustParseURL</span><span class="op" id="8365758">(</span><span class="string" id="8365759">&#34;/&#34;</span><span class="op" id="8365762">)</span><span class="op" id="8365763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365768">Host</span><span class="op" id="8365772">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8365783">&#34;example.com&#34;</span><span class="op" id="8365796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365801">ProtoMajor</span><span class="op" id="8365811">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8365816">1</span><span class="op" id="8365817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365822">ProtoMinor</span><span class="op" id="8365832">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8365837">1</span><span class="op" id="8365838">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365843">ContentLength</span><span class="op" id="8365856">:</span>&nbsp;<span class="num" id="8365858">10</span><span class="op" id="8365860">,</span>&nbsp;<span class="comment" id="8365862">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8365904">}</span><span class="op" id="8365905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365909">Body</span><span class="op" id="8365913">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8365920">[</span><span class="op" id="8365921">]</span><span class="builtintype" id="8365922">byte</span><span class="op" id="8365926">(</span><span class="string" id="8365927">&#34;12345&#34;</span><span class="op" id="8365934">)</span><span class="op" id="8365935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8365939">WantError</span><span class="op" id="8365948">:</span>&nbsp;<span class="ident" id="8365950">errors</span><span class="op" id="8365956">.</span><span class="ident" id="8365957">New</span><span class="op" id="8365960">(</span><span class="string" id="8365961">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="8366004">)</span><span class="op" id="8366005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366008">}</span><span class="op" id="8366009">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8366013">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366075">Req</span><span class="op" id="8366078">:</span>&nbsp;<span class="ident" id="8366080">Request</span><span class="op" id="8366087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366092">Method</span><span class="op" id="8366098">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8366107">&#34;POST&#34;</span><span class="op" id="8366113">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366118">URL</span><span class="op" id="8366121">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8366133">mustParseURL</span><span class="op" id="8366145">(</span><span class="string" id="8366146">&#34;/&#34;</span><span class="op" id="8366149">)</span><span class="op" id="8366150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366155">Host</span><span class="op" id="8366159">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8366170">&#34;example.com&#34;</span><span class="op" id="8366183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366188">ProtoMajor</span><span class="op" id="8366198">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8366203">1</span><span class="op" id="8366204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366209">ProtoMinor</span><span class="op" id="8366219">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8366224">1</span><span class="op" id="8366225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366230">ContentLength</span><span class="op" id="8366243">:</span>&nbsp;<span class="num" id="8366245">4</span><span class="op" id="8366246">,</span>&nbsp;<span class="comment" id="8366248">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366292">}</span><span class="op" id="8366293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366297">Body</span><span class="op" id="8366301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8366308">[</span><span class="op" id="8366309">]</span><span class="builtintype" id="8366310">byte</span><span class="op" id="8366314">(</span><span class="string" id="8366315">&#34;12345678&#34;</span><span class="op" id="8366325">)</span><span class="op" id="8366326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366330">WantError</span><span class="op" id="8366339">:</span>&nbsp;<span class="ident" id="8366341">errors</span><span class="op" id="8366347">.</span><span class="ident" id="8366348">New</span><span class="op" id="8366351">(</span><span class="string" id="8366352">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="8366394">)</span><span class="op" id="8366395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366398">}</span><span class="op" id="8366399">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8366403">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366456">Req</span><span class="op" id="8366459">:</span>&nbsp;<span class="ident" id="8366461">Request</span><span class="op" id="8366468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366473">Method</span><span class="op" id="8366479">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8366488">&#34;POST&#34;</span><span class="op" id="8366494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366499">URL</span><span class="op" id="8366502">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8366514">mustParseURL</span><span class="op" id="8366526">(</span><span class="string" id="8366527">&#34;/&#34;</span><span class="op" id="8366530">)</span><span class="op" id="8366531">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366536">Host</span><span class="op" id="8366540">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8366551">&#34;example.com&#34;</span><span class="op" id="8366564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366569">ProtoMajor</span><span class="op" id="8366579">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8366584">1</span><span class="op" id="8366585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366590">ProtoMinor</span><span class="op" id="8366600">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8366605">1</span><span class="op" id="8366606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366611">ContentLength</span><span class="op" id="8366624">:</span>&nbsp;<span class="num" id="8366626">5</span><span class="op" id="8366627">,</span>&nbsp;<span class="comment" id="8366629">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366658">}</span><span class="op" id="8366659">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366663">WantError</span><span class="op" id="8366672">:</span>&nbsp;<span class="ident" id="8366674">errors</span><span class="op" id="8366680">.</span><span class="ident" id="8366681">New</span><span class="op" id="8366684">(</span><span class="string" id="8366685">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="8366730">)</span><span class="op" id="8366731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366734">}</span><span class="op" id="8366735">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8366739">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8366819">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366823">Req</span><span class="op" id="8366826">:</span>&nbsp;<span class="ident" id="8366828">Request</span><span class="op" id="8366835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366840">Method</span><span class="op" id="8366846">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8366855">&#34;POST&#34;</span><span class="op" id="8366861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366866">URL</span><span class="op" id="8366869">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8366881">mustParseURL</span><span class="op" id="8366893">(</span><span class="string" id="8366894">&#34;/&#34;</span><span class="op" id="8366897">)</span><span class="op" id="8366898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366903">Host</span><span class="op" id="8366907">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8366918">&#34;example.com&#34;</span><span class="op" id="8366931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366936">ProtoMajor</span><span class="op" id="8366946">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8366951">1</span><span class="op" id="8366952">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366957">ProtoMinor</span><span class="op" id="8366967">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8366972">1</span><span class="op" id="8366973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8366978">ContentLength</span><span class="op" id="8366991">:</span>&nbsp;<span class="num" id="8366993">0</span><span class="op" id="8366994">,</span>&nbsp;<span class="comment" id="8366996">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367021">}</span><span class="op" id="8367022">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367027">Body</span><span class="op" id="8367031">:</span>&nbsp;<span class="keyword" id="8367033">func</span><span class="op" id="8367037">(</span><span class="op" id="8367038">)</span>&nbsp;<span class="ident" id="8367040">io</span><span class="op" id="8367042">.</span><span class="ident" id="8367043">ReadCloser</span>&nbsp;<span class="op" id="8367054">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367059">err</span>&nbsp;<span class="op" id="8367063">:=</span>&nbsp;<span class="ident" id="8367066">errors</span><span class="op" id="8367072">.</span><span class="ident" id="8367073">New</span><span class="op" id="8367076">(</span><span class="string" id="8367077">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8367098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367103">errReader</span>&nbsp;<span class="op" id="8367113">:=</span>&nbsp;<span class="op" id="8367116">&amp;</span><span class="ident" id="8367117">errorReader</span><span class="op" id="8367128">{</span><span class="ident" id="8367129">err</span><span class="op" id="8367132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367137">return</span>&nbsp;<span class="ident" id="8367144">ioutil</span><span class="op" id="8367150">.</span><span class="ident" id="8367151">NopCloser</span><span class="op" id="8367160">(</span><span class="ident" id="8367161">io</span><span class="op" id="8367163">.</span><span class="ident" id="8367164">MultiReader</span><span class="op" id="8367175">(</span><span class="ident" id="8367176">strings</span><span class="op" id="8367183">.</span><span class="ident" id="8367184">NewReader</span><span class="op" id="8367193">(</span><span class="string" id="8367194">&#34;x&#34;</span><span class="op" id="8367197">)</span><span class="op" id="8367198">,</span>&nbsp;<span class="ident" id="8367200">errReader</span><span class="op" id="8367209">)</span><span class="op" id="8367210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367214">}</span><span class="op" id="8367215">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367220">WantError</span><span class="op" id="8367229">:</span>&nbsp;<span class="ident" id="8367231">errors</span><span class="op" id="8367237">.</span><span class="ident" id="8367238">New</span><span class="op" id="8367241">(</span><span class="string" id="8367242">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8367263">)</span><span class="op" id="8367264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367267">}</span><span class="op" id="8367268">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8367272">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367348">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367352">Req</span><span class="op" id="8367355">:</span>&nbsp;<span class="ident" id="8367357">Request</span><span class="op" id="8367364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367369">Method</span><span class="op" id="8367375">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8367384">&#34;POST&#34;</span><span class="op" id="8367390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367395">URL</span><span class="op" id="8367398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8367410">mustParseURL</span><span class="op" id="8367422">(</span><span class="string" id="8367423">&#34;/&#34;</span><span class="op" id="8367426">)</span><span class="op" id="8367427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367432">Host</span><span class="op" id="8367436">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8367447">&#34;example.com&#34;</span><span class="op" id="8367460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367465">ProtoMajor</span><span class="op" id="8367475">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8367480">1</span><span class="op" id="8367481">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367486">ProtoMinor</span><span class="op" id="8367496">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8367501">1</span><span class="op" id="8367502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367507">ContentLength</span><span class="op" id="8367520">:</span>&nbsp;<span class="num" id="8367522">0</span><span class="op" id="8367523">,</span>&nbsp;<span class="comment" id="8367525">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367550">}</span><span class="op" id="8367551">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367556">Body</span><span class="op" id="8367560">:</span>&nbsp;<span class="keyword" id="8367562">func</span><span class="op" id="8367566">(</span><span class="op" id="8367567">)</span>&nbsp;<span class="ident" id="8367569">io</span><span class="op" id="8367571">.</span><span class="ident" id="8367572">ReadCloser</span>&nbsp;<span class="op" id="8367583">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367588">err</span>&nbsp;<span class="op" id="8367592">:=</span>&nbsp;<span class="ident" id="8367595">errors</span><span class="op" id="8367601">.</span><span class="ident" id="8367602">New</span><span class="op" id="8367605">(</span><span class="string" id="8367606">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8367627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367632">errReader</span>&nbsp;<span class="op" id="8367642">:=</span>&nbsp;<span class="op" id="8367645">&amp;</span><span class="ident" id="8367646">errorReader</span><span class="op" id="8367657">{</span><span class="ident" id="8367658">err</span><span class="op" id="8367661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8367666">return</span>&nbsp;<span class="ident" id="8367673">ioutil</span><span class="op" id="8367679">.</span><span class="ident" id="8367680">NopCloser</span><span class="op" id="8367689">(</span><span class="ident" id="8367690">errReader</span><span class="op" id="8367699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367703">}</span><span class="op" id="8367704">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367709">WantError</span><span class="op" id="8367718">:</span>&nbsp;<span class="ident" id="8367720">errors</span><span class="op" id="8367726">.</span><span class="ident" id="8367727">New</span><span class="op" id="8367730">(</span><span class="string" id="8367731">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8367752">)</span><span class="op" id="8367753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367756">}</span><span class="op" id="8367757">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8367761">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8367844">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8367878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367882">Req</span><span class="op" id="8367885">:</span>&nbsp;<span class="ident" id="8367887">Request</span><span class="op" id="8367894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367899">Method</span><span class="op" id="8367905">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8367911">&#34;GET&#34;</span><span class="op" id="8367916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367921">URL</span><span class="op" id="8367924">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8367933">mustParseURL</span><span class="op" id="8367945">(</span><span class="string" id="8367946">&#34;/foo&#34;</span><span class="op" id="8367952">)</span><span class="op" id="8367953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367958">ProtoMajor</span><span class="op" id="8367968">:</span>&nbsp;<span class="num" id="8367970">1</span><span class="op" id="8367971">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367976">ProtoMinor</span><span class="op" id="8367986">:</span>&nbsp;<span class="num" id="8367988">0</span><span class="op" id="8367989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8367994">Header</span><span class="op" id="8368000">:</span>&nbsp;<span class="ident" id="8368002">Header</span><span class="op" id="8368008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8368014">&#34;X-Foo&#34;</span><span class="op" id="8368021">:</span>&nbsp;<span class="op" id="8368023">[</span><span class="op" id="8368024">]</span><span class="builtintype" id="8368025">string</span><span class="op" id="8368031">{</span><span class="string" id="8368032">&#34;X-Bar&#34;</span><span class="op" id="8368039">}</span><span class="op" id="8368040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368045">}</span><span class="op" id="8368046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368050">}</span><span class="op" id="8368051">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368056">WantWrite</span><span class="op" id="8368065">:</span>&nbsp;<span class="string" id="8368067">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8368091">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8368096">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="8368109">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8368114">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8368152">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8368157">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="8368179">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368182">}</span><span class="op" id="8368183">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8368187">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8368243">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8368283">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8368337">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368378">Req</span><span class="op" id="8368381">:</span>&nbsp;<span class="ident" id="8368383">Request</span><span class="op" id="8368390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368395">Method</span><span class="op" id="8368401">:</span>&nbsp;<span class="string" id="8368403">&#34;GET&#34;</span><span class="op" id="8368408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368413">Host</span><span class="op" id="8368417">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8368421">&#34;&#34;</span><span class="op" id="8368423">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368428">URL</span><span class="op" id="8368431">:</span>&nbsp;<span class="op" id="8368433">&amp;</span><span class="ident" id="8368434">url</span><span class="op" id="8368437">.</span><span class="ident" id="8368438">URL</span><span class="op" id="8368441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368447">Scheme</span><span class="op" id="8368453">:</span>&nbsp;<span class="string" id="8368455">&#34;http&#34;</span><span class="op" id="8368461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368467">Host</span><span class="op" id="8368471">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8368475">&#34;&#34;</span><span class="op" id="8368477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368483">Path</span><span class="op" id="8368487">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8368491">&#34;/search&#34;</span><span class="op" id="8368500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368505">}</span><span class="op" id="8368506">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368511">ProtoMajor</span><span class="op" id="8368521">:</span>&nbsp;<span class="num" id="8368523">1</span><span class="op" id="8368524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368529">ProtoMinor</span><span class="op" id="8368539">:</span>&nbsp;<span class="num" id="8368541">1</span><span class="op" id="8368542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368547">Header</span><span class="op" id="8368553">:</span>&nbsp;<span class="ident" id="8368555">Header</span><span class="op" id="8368561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8368567">&#34;Host&#34;</span><span class="op" id="8368573">:</span>&nbsp;<span class="op" id="8368575">[</span><span class="op" id="8368576">]</span><span class="builtintype" id="8368577">string</span><span class="op" id="8368583">{</span><span class="string" id="8368584">&#34;bad.example.com&#34;</span><span class="op" id="8368601">}</span><span class="op" id="8368602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368607">}</span><span class="op" id="8368608">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368612">}</span><span class="op" id="8368613">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368618">WantWrite</span><span class="op" id="8368627">:</span>&nbsp;<span class="string" id="8368629">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8368656">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8368661">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="8368674">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8368679">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8368720">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368723">}</span><span class="op" id="8368724">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8368728">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368778">Req</span><span class="op" id="8368781">:</span>&nbsp;<span class="ident" id="8368783">Request</span><span class="op" id="8368790">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368795">Method</span><span class="op" id="8368801">:</span>&nbsp;<span class="string" id="8368803">&#34;GET&#34;</span><span class="op" id="8368808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368813">URL</span><span class="op" id="8368816">:</span>&nbsp;<span class="op" id="8368818">&amp;</span><span class="ident" id="8368819">url</span><span class="op" id="8368822">.</span><span class="ident" id="8368823">URL</span><span class="op" id="8368826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368832">Scheme</span><span class="op" id="8368838">:</span>&nbsp;<span class="string" id="8368840">&#34;http&#34;</span><span class="op" id="8368846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368852">Host</span><span class="op" id="8368856">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8368860">&#34;www.google.com&#34;</span><span class="op" id="8368876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368882">Opaque</span><span class="op" id="8368888">:</span>&nbsp;<span class="string" id="8368890">&#34;/%2F/%2F/&#34;</span><span class="op" id="8368901">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368906">}</span><span class="op" id="8368907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368912">ProtoMajor</span><span class="op" id="8368922">:</span>&nbsp;<span class="num" id="8368924">1</span><span class="op" id="8368925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368930">ProtoMinor</span><span class="op" id="8368940">:</span>&nbsp;<span class="num" id="8368942">1</span><span class="op" id="8368943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368948">Header</span><span class="op" id="8368954">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8368960">Header</span><span class="op" id="8368966">{</span><span class="op" id="8368967">}</span><span class="op" id="8368968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8368972">}</span><span class="op" id="8368973">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8368978">WantWrite</span><span class="op" id="8368987">:</span>&nbsp;<span class="string" id="8368989">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8369018">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369023">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8369050">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369055">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8369096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369099">}</span><span class="op" id="8369100">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8369104">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369154">Req</span><span class="op" id="8369157">:</span>&nbsp;<span class="ident" id="8369159">Request</span><span class="op" id="8369166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369171">Method</span><span class="op" id="8369177">:</span>&nbsp;<span class="string" id="8369179">&#34;GET&#34;</span><span class="op" id="8369184">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369189">URL</span><span class="op" id="8369192">:</span>&nbsp;<span class="op" id="8369194">&amp;</span><span class="ident" id="8369195">url</span><span class="op" id="8369198">.</span><span class="ident" id="8369199">URL</span><span class="op" id="8369202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369208">Scheme</span><span class="op" id="8369214">:</span>&nbsp;<span class="string" id="8369216">&#34;http&#34;</span><span class="op" id="8369222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369228">Host</span><span class="op" id="8369232">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8369236">&#34;x.google.com&#34;</span><span class="op" id="8369250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369256">Opaque</span><span class="op" id="8369262">:</span>&nbsp;<span class="string" id="8369264">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="8369289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369294">}</span><span class="op" id="8369295">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369300">ProtoMajor</span><span class="op" id="8369310">:</span>&nbsp;<span class="num" id="8369312">1</span><span class="op" id="8369313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369318">ProtoMinor</span><span class="op" id="8369328">:</span>&nbsp;<span class="num" id="8369330">1</span><span class="op" id="8369331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369336">Header</span><span class="op" id="8369342">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8369348">Header</span><span class="op" id="8369354">{</span><span class="op" id="8369355">}</span><span class="op" id="8369356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369360">}</span><span class="op" id="8369361">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369366">WantWrite</span><span class="op" id="8369375">:</span>&nbsp;<span class="string" id="8369377">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8369425">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369430">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8369455">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369460">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8369501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369504">}</span><span class="op" id="8369505">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8369509">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369565">Req</span><span class="op" id="8369568">:</span>&nbsp;<span class="ident" id="8369570">Request</span><span class="op" id="8369577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369582">Method</span><span class="op" id="8369588">:</span>&nbsp;<span class="string" id="8369590">&#34;GET&#34;</span><span class="op" id="8369595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369600">URL</span><span class="op" id="8369603">:</span>&nbsp;<span class="op" id="8369605">&amp;</span><span class="ident" id="8369606">url</span><span class="op" id="8369609">.</span><span class="ident" id="8369610">URL</span><span class="op" id="8369613">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369619">Scheme</span><span class="op" id="8369625">:</span>&nbsp;<span class="string" id="8369627">&#34;http&#34;</span><span class="op" id="8369633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369639">Host</span><span class="op" id="8369643">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8369647">&#34;www.google.com&#34;</span><span class="op" id="8369663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369669">Path</span><span class="op" id="8369673">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8369677">&#34;/&#34;</span><span class="op" id="8369680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369685">}</span><span class="op" id="8369686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369691">Proto</span><span class="op" id="8369696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8369703">&#34;HTTP/1.1&#34;</span><span class="op" id="8369713">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369718">ProtoMajor</span><span class="op" id="8369728">:</span>&nbsp;<span class="num" id="8369730">1</span><span class="op" id="8369731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369736">ProtoMinor</span><span class="op" id="8369746">:</span>&nbsp;<span class="num" id="8369748">1</span><span class="op" id="8369749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369754">Header</span><span class="op" id="8369760">:</span>&nbsp;<span class="ident" id="8369762">Header</span><span class="op" id="8369768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369774">&#34;ALL-CAPS&#34;</span><span class="op" id="8369784">:</span>&nbsp;<span class="op" id="8369786">{</span><span class="string" id="8369787">&#34;x&#34;</span><span class="op" id="8369790">}</span><span class="op" id="8369791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369796">}</span><span class="op" id="8369797">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369801">}</span><span class="op" id="8369802">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8369807">WantWrite</span><span class="op" id="8369816">:</span>&nbsp;<span class="string" id="8369818">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8369839">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369844">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8369871">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369876">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8369914">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369919">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="8369937">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8369942">&#34;\r\n&#34;</span><span class="op" id="8369948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8369951">}</span><span class="op" id="8369952">,</span><br>
<span class="lineno"></span><span class="op" id="8369954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="8369957">func</span>&nbsp;<span class="ident" id="8369962">TestRequestWrite</span><span class="op" id="8369978">(</span><span class="ident" id="8369979">t</span>&nbsp;<span class="op" id="8369981">*</span><span class="ident" id="8369982">testing</span><span class="op" id="8369989">.</span><span class="ident" id="8369990">T</span><span class="op" id="8369991">)</span>&nbsp;<span class="op" id="8369993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8369996">for</span>&nbsp;<span class="ident" id="8370000">i</span>&nbsp;<span class="op" id="8370002">:=</span>&nbsp;<span class="keyword" id="8370005">range</span>&nbsp;<span class="ident" id="8370011">reqWriteTests</span>&nbsp;<span class="op" id="8370025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370029">tt</span>&nbsp;<span class="op" id="8370032">:=</span>&nbsp;<span class="op" id="8370035">&amp;</span><span class="ident" id="8370036">reqWriteTests</span><span class="op" id="8370049">[</span><span class="ident" id="8370050">i</span><span class="op" id="8370051">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370056">setBody</span>&nbsp;<span class="op" id="8370064">:=</span>&nbsp;<span class="keyword" id="8370067">func</span><span class="op" id="8370071">(</span><span class="op" id="8370072">)</span>&nbsp;<span class="op" id="8370074">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370079">if</span>&nbsp;<span class="ident" id="8370082">tt</span><span class="op" id="8370084">.</span><span class="ident" id="8370085">Body</span>&nbsp;<span class="op" id="8370090">==</span>&nbsp;<span class="ident" id="8370093">nil</span>&nbsp;<span class="op" id="8370097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370103">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370118">switch</span>&nbsp;<span class="ident" id="8370125">b</span>&nbsp;<span class="op" id="8370127">:=</span>&nbsp;<span class="ident" id="8370130">tt</span><span class="op" id="8370132">.</span><span class="ident" id="8370133">Body</span><span class="op" id="8370137">.</span><span class="op" id="8370138">(</span><span class="keyword" id="8370139">type</span><span class="op" id="8370143">)</span>&nbsp;<span class="op" id="8370145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370150">case</span>&nbsp;<span class="op" id="8370155">[</span><span class="op" id="8370156">]</span><span class="builtintype" id="8370157">byte</span><span class="op" id="8370161">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370167">tt</span><span class="op" id="8370169">.</span><span class="ident" id="8370170">Req</span><span class="op" id="8370173">.</span><span class="ident" id="8370174">Body</span>&nbsp;<span class="op" id="8370179">=</span>&nbsp;<span class="ident" id="8370181">ioutil</span><span class="op" id="8370187">.</span><span class="ident" id="8370188">NopCloser</span><span class="op" id="8370197">(</span><span class="ident" id="8370198">bytes</span><span class="op" id="8370203">.</span><span class="ident" id="8370204">NewReader</span><span class="op" id="8370213">(</span><span class="ident" id="8370214">b</span><span class="op" id="8370215">)</span><span class="op" id="8370216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370221">case</span>&nbsp;<span class="keyword" id="8370226">func</span><span class="op" id="8370230">(</span><span class="op" id="8370231">)</span>&nbsp;<span class="ident" id="8370233">io</span><span class="op" id="8370235">.</span><span class="ident" id="8370236">ReadCloser</span><span class="op" id="8370246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370252">tt</span><span class="op" id="8370254">.</span><span class="ident" id="8370255">Req</span><span class="op" id="8370258">.</span><span class="ident" id="8370259">Body</span>&nbsp;<span class="op" id="8370264">=</span>&nbsp;<span class="ident" id="8370266">b</span><span class="op" id="8370267">(</span><span class="op" id="8370268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370277">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370281">setBody</span><span class="op" id="8370288">(</span><span class="op" id="8370289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370293">if</span>&nbsp;<span class="ident" id="8370296">tt</span><span class="op" id="8370298">.</span><span class="ident" id="8370299">Req</span><span class="op" id="8370302">.</span><span class="ident" id="8370303">Header</span>&nbsp;<span class="op" id="8370310">==</span>&nbsp;<span class="ident" id="8370313">nil</span>&nbsp;<span class="op" id="8370317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370322">tt</span><span class="op" id="8370324">.</span><span class="ident" id="8370325">Req</span><span class="op" id="8370328">.</span><span class="ident" id="8370329">Header</span>&nbsp;<span class="op" id="8370336">=</span>&nbsp;<span class="builtinfunc" id="8370338">make</span><span class="op" id="8370342">(</span><span class="ident" id="8370343">Header</span><span class="op" id="8370349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370358">var</span>&nbsp;<span class="ident" id="8370362">braw</span>&nbsp;<span class="ident" id="8370367">bytes</span><span class="op" id="8370372">.</span><span class="ident" id="8370373">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370382">err</span>&nbsp;<span class="op" id="8370386">:=</span>&nbsp;<span class="ident" id="8370389">tt</span><span class="op" id="8370391">.</span><span class="ident" id="8370392">Req</span><span class="op" id="8370395">.</span><span class="ident" id="8370396">Write</span><span class="op" id="8370401">(</span><span class="op" id="8370402">&amp;</span><span class="ident" id="8370403">braw</span><span class="op" id="8370407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370411">if</span>&nbsp;<span class="ident" id="8370414">g</span><span class="op" id="8370415">,</span>&nbsp;<span class="ident" id="8370417">e</span>&nbsp;<span class="op" id="8370419">:=</span>&nbsp;<span class="ident" id="8370422">fmt</span><span class="op" id="8370425">.</span><span class="ident" id="8370426">Sprintf</span><span class="op" id="8370433">(</span><span class="string" id="8370434">&#34;%v&#34;</span><span class="op" id="8370438">,</span>&nbsp;<span class="ident" id="8370440">err</span><span class="op" id="8370443">)</span><span class="op" id="8370444">,</span>&nbsp;<span class="ident" id="8370446">fmt</span><span class="op" id="8370449">.</span><span class="ident" id="8370450">Sprintf</span><span class="op" id="8370457">(</span><span class="string" id="8370458">&#34;%v&#34;</span><span class="op" id="8370462">,</span>&nbsp;<span class="ident" id="8370464">tt</span><span class="op" id="8370466">.</span><span class="ident" id="8370467">WantError</span><span class="op" id="8370476">)</span><span class="op" id="8370477">;</span>&nbsp;<span class="ident" id="8370479">g</span>&nbsp;<span class="op" id="8370481">!=</span>&nbsp;<span class="ident" id="8370484">e</span>&nbsp;<span class="op" id="8370486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370491">t</span><span class="op" id="8370492">.</span><span class="ident" id="8370493">Errorf</span><span class="op" id="8370499">(</span><span class="string" id="8370500">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8370532">,</span>&nbsp;<span class="ident" id="8370534">i</span><span class="op" id="8370535">,</span>&nbsp;<span class="ident" id="8370537">g</span><span class="op" id="8370538">,</span>&nbsp;<span class="ident" id="8370540">e</span><span class="op" id="8370541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370546">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370561">if</span>&nbsp;<span class="ident" id="8370564">err</span>&nbsp;<span class="op" id="8370568">!=</span>&nbsp;<span class="ident" id="8370571">nil</span>&nbsp;<span class="op" id="8370575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370580">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370596">if</span>&nbsp;<span class="ident" id="8370599">tt</span><span class="op" id="8370601">.</span><span class="ident" id="8370602">WantWrite</span>&nbsp;<span class="op" id="8370612">!=</span>&nbsp;<span class="string" id="8370615">&#34;&#34;</span>&nbsp;<span class="op" id="8370618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370623">sraw</span>&nbsp;<span class="op" id="8370628">:=</span>&nbsp;<span class="ident" id="8370631">braw</span><span class="op" id="8370635">.</span><span class="ident" id="8370636">String</span><span class="op" id="8370642">(</span><span class="op" id="8370643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370648">if</span>&nbsp;<span class="ident" id="8370651">sraw</span>&nbsp;<span class="op" id="8370656">!=</span>&nbsp;<span class="ident" id="8370659">tt</span><span class="op" id="8370661">.</span><span class="ident" id="8370662">WantWrite</span>&nbsp;<span class="op" id="8370672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370678">t</span><span class="op" id="8370679">.</span><span class="ident" id="8370680">Errorf</span><span class="op" id="8370686">(</span><span class="string" id="8370687">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8370724">,</span>&nbsp;<span class="ident" id="8370726">i</span><span class="op" id="8370727">,</span>&nbsp;<span class="ident" id="8370729">tt</span><span class="op" id="8370731">.</span><span class="ident" id="8370732">WantWrite</span><span class="op" id="8370741">,</span>&nbsp;<span class="ident" id="8370743">sraw</span><span class="op" id="8370747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370753">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370774">if</span>&nbsp;<span class="ident" id="8370777">tt</span><span class="op" id="8370779">.</span><span class="ident" id="8370780">WantProxy</span>&nbsp;<span class="op" id="8370790">!=</span>&nbsp;<span class="string" id="8370793">&#34;&#34;</span>&nbsp;<span class="op" id="8370796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370801">setBody</span><span class="op" id="8370808">(</span><span class="op" id="8370809">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370814">var</span>&nbsp;<span class="ident" id="8370818">praw</span>&nbsp;<span class="ident" id="8370823">bytes</span><span class="op" id="8370828">.</span><span class="ident" id="8370829">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370839">err</span>&nbsp;<span class="op" id="8370843">=</span>&nbsp;<span class="ident" id="8370845">tt</span><span class="op" id="8370847">.</span><span class="ident" id="8370848">Req</span><span class="op" id="8370851">.</span><span class="ident" id="8370852">WriteProxy</span><span class="op" id="8370862">(</span><span class="op" id="8370863">&amp;</span><span class="ident" id="8370864">praw</span><span class="op" id="8370868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370873">if</span>&nbsp;<span class="ident" id="8370876">err</span>&nbsp;<span class="op" id="8370880">!=</span>&nbsp;<span class="ident" id="8370883">nil</span>&nbsp;<span class="op" id="8370887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370893">t</span><span class="op" id="8370894">.</span><span class="ident" id="8370895">Errorf</span><span class="op" id="8370901">(</span><span class="string" id="8370902">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8370922">,</span>&nbsp;<span class="ident" id="8370924">i</span><span class="op" id="8370925">,</span>&nbsp;<span class="ident" id="8370927">err</span><span class="op" id="8370930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370936">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8370948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8370953">sraw</span>&nbsp;<span class="op" id="8370958">:=</span>&nbsp;<span class="ident" id="8370961">praw</span><span class="op" id="8370965">.</span><span class="ident" id="8370966">String</span><span class="op" id="8370972">(</span><span class="op" id="8370973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8370978">if</span>&nbsp;<span class="ident" id="8370981">sraw</span>&nbsp;<span class="op" id="8370986">!=</span>&nbsp;<span class="ident" id="8370989">tt</span><span class="op" id="8370991">.</span><span class="ident" id="8370992">WantProxy</span>&nbsp;<span class="op" id="8371002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371008">t</span><span class="op" id="8371009">.</span><span class="ident" id="8371010">Errorf</span><span class="op" id="8371016">(</span><span class="string" id="8371017">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8371060">,</span>&nbsp;<span class="ident" id="8371062">i</span><span class="op" id="8371063">,</span>&nbsp;<span class="ident" id="8371065">tt</span><span class="op" id="8371067">.</span><span class="ident" id="8371068">WantProxy</span><span class="op" id="8371077">,</span>&nbsp;<span class="ident" id="8371079">sraw</span><span class="op" id="8371083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8371089">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8371101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8371105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8371108">}</span><br>
<span class="lineno"></span><span class="op" id="8371110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="8371113">type</span>&nbsp;<span class="ident" id="8371118">closeChecker</span>&nbsp;<span class="keyword" id="8371131">struct</span>&nbsp;<span class="op" id="8371138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371141">io</span><span class="op" id="8371143">.</span><span class="ident" id="8371144">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371152">closed</span>&nbsp;<span class="builtintype" id="8371159">bool</span><br>
<span class="lineno"></span><span class="op" id="8371164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="8371167">func</span>&nbsp;<span class="op" id="8371172">(</span><span class="ident" id="8371173">rc</span>&nbsp;<span class="op" id="8371176">*</span><span class="ident" id="8371177">closeChecker</span><span class="op" id="8371189">)</span>&nbsp;<span class="ident" id="8371191">Close</span><span class="op" id="8371196">(</span><span class="op" id="8371197">)</span>&nbsp;<span class="builtintype" id="8371199">error</span>&nbsp;<span class="op" id="8371205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371208">rc</span><span class="op" id="8371210">.</span><span class="ident" id="8371211">closed</span>&nbsp;<span class="op" id="8371218">=</span>&nbsp;<span class="builtintype" id="8371220">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8371226">return</span>&nbsp;<span class="ident" id="8371233">nil</span><br>
<span class="lineno"></span><span class="op" id="8371237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="8371240">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="8371324">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="8371407">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="8371467">func</span>&nbsp;<span class="ident" id="8371472">TestRequestWriteClosesBody</span><span class="op" id="8371498">(</span><span class="ident" id="8371499">t</span>&nbsp;<span class="op" id="8371501">*</span><span class="ident" id="8371502">testing</span><span class="op" id="8371509">.</span><span class="ident" id="8371510">T</span><span class="op" id="8371511">)</span>&nbsp;<span class="op" id="8371513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371516">rc</span>&nbsp;<span class="op" id="8371519">:=</span>&nbsp;<span class="op" id="8371522">&amp;</span><span class="ident" id="8371523">closeChecker</span><span class="op" id="8371535">{</span><span class="ident" id="8371536">Reader</span><span class="op" id="8371542">:</span>&nbsp;<span class="ident" id="8371544">strings</span><span class="op" id="8371551">.</span><span class="ident" id="8371552">NewReader</span><span class="op" id="8371561">(</span><span class="string" id="8371562">&#34;my&nbsp;body&#34;</span><span class="op" id="8371571">)</span><span class="op" id="8371572">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371575">req</span><span class="op" id="8371578">,</span>&nbsp;<span class="ident" id="8371580">_</span>&nbsp;<span class="op" id="8371582">:=</span>&nbsp;<span class="ident" id="8371585">NewRequest</span><span class="op" id="8371595">(</span><span class="string" id="8371596">&#34;POST&#34;</span><span class="op" id="8371602">,</span>&nbsp;<span class="string" id="8371604">&#34;http://foo.com/&#34;</span><span class="op" id="8371621">,</span>&nbsp;<span class="ident" id="8371623">rc</span><span class="op" id="8371625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8371628">if</span>&nbsp;<span class="ident" id="8371631">req</span><span class="op" id="8371634">.</span><span class="ident" id="8371635">ContentLength</span>&nbsp;<span class="op" id="8371649">!=</span>&nbsp;<span class="num" id="8371652">0</span>&nbsp;<span class="op" id="8371654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371658">t</span><span class="op" id="8371659">.</span><span class="ident" id="8371660">Errorf</span><span class="op" id="8371666">(</span><span class="string" id="8371667">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="8371701">,</span>&nbsp;<span class="ident" id="8371703">req</span><span class="op" id="8371706">.</span><span class="ident" id="8371707">ContentLength</span><span class="op" id="8371720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8371723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371726">buf</span>&nbsp;<span class="op" id="8371730">:=</span>&nbsp;<span class="builtinfunc" id="8371733">new</span><span class="op" id="8371736">(</span><span class="ident" id="8371737">bytes</span><span class="op" id="8371742">.</span><span class="ident" id="8371743">Buffer</span><span class="op" id="8371749">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371752">req</span><span class="op" id="8371755">.</span><span class="ident" id="8371756">Write</span><span class="op" id="8371761">(</span><span class="ident" id="8371762">buf</span><span class="op" id="8371765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8371768">if</span>&nbsp;<span class="op" id="8371771">!</span><span class="ident" id="8371772">rc</span><span class="op" id="8371774">.</span><span class="ident" id="8371775">closed</span>&nbsp;<span class="op" id="8371782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371786">t</span><span class="op" id="8371787">.</span><span class="ident" id="8371788">Error</span><span class="op" id="8371793">(</span><span class="string" id="8371794">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="8371823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8371826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8371829">expected</span>&nbsp;<span class="op" id="8371838">:=</span>&nbsp;<span class="string" id="8371841">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8371863">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8371867">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="8371887">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8371891">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8371929">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8371933">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8371970">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8371974">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8372040">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8372110">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8372181">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8372238">chunk</span><span class="op" id="8372243">(</span><span class="string" id="8372244">&#34;m&#34;</span><span class="op" id="8372247">)</span>&nbsp;<span class="op" id="8372249">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8372253">chunk</span><span class="op" id="8372258">(</span><span class="string" id="8372259">&#34;y&nbsp;body&#34;</span><span class="op" id="8372267">)</span>&nbsp;<span class="op" id="8372269">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8372273">chunk</span><span class="op" id="8372278">(</span><span class="string" id="8372279">&#34;&#34;</span><span class="op" id="8372281">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8372284">if</span>&nbsp;<span class="ident" id="8372287">buf</span><span class="op" id="8372290">.</span><span class="ident" id="8372291">String</span><span class="op" id="8372297">(</span><span class="op" id="8372298">)</span>&nbsp;<span class="op" id="8372300">!=</span>&nbsp;<span class="ident" id="8372303">expected</span>&nbsp;<span class="op" id="8372312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8372316">t</span><span class="op" id="8372317">.</span><span class="ident" id="8372318">Errorf</span><span class="op" id="8372324">(</span><span class="string" id="8372325">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="8372353">,</span>&nbsp;<span class="ident" id="8372355">buf</span><span class="op" id="8372358">.</span><span class="ident" id="8372359">String</span><span class="op" id="8372365">(</span><span class="op" id="8372366">)</span><span class="op" id="8372367">,</span>&nbsp;<span class="ident" id="8372369">expected</span><span class="op" id="8372377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8372380">}</span><br>
<span class="lineno"></span><span class="op" id="8372382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="8372385">func</span>&nbsp;<span class="ident" id="8372390">chunk</span><span class="op" id="8372395">(</span><span class="ident" id="8372396">s</span>&nbsp;<span class="builtintype" id="8372398">string</span><span class="op" id="8372404">)</span>&nbsp;<span class="builtintype" id="8372406">string</span>&nbsp;<span class="op" id="8372413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8372416">return</span>&nbsp;<span class="ident" id="8372423">fmt</span><span class="op" id="8372426">.</span><span class="ident" id="8372427">Sprintf</span><span class="op" id="8372434">(</span><span class="string" id="8372435">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="8372449">,</span>&nbsp;<span class="builtinfunc" id="8372451">len</span><span class="op" id="8372454">(</span><span class="ident" id="8372455">s</span><span class="op" id="8372456">)</span><span class="op" id="8372457">,</span>&nbsp;<span class="ident" id="8372459">s</span><span class="op" id="8372460">)</span><br>
<span class="lineno"></span><span class="op" id="8372462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8372465">func</span>&nbsp;<span class="ident" id="8372470">mustParseURL</span><span class="op" id="8372482">(</span><span class="ident" id="8372483">s</span>&nbsp;<span class="builtintype" id="8372485">string</span><span class="op" id="8372491">)</span>&nbsp;<span class="op" id="8372493">*</span><span class="ident" id="8372494">url</span><span class="op" id="8372497">.</span><span class="ident" id="8372498">URL</span>&nbsp;<span class="op" id="8372502">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8372505">u</span><span class="op" id="8372506">,</span>&nbsp;<span class="ident" id="8372508">err</span>&nbsp;<span class="op" id="8372512">:=</span>&nbsp;<span class="ident" id="8372515">url</span><span class="op" id="8372518">.</span><span class="ident" id="8372519">Parse</span><span class="op" id="8372524">(</span><span class="ident" id="8372525">s</span><span class="op" id="8372526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8372529">if</span>&nbsp;<span class="ident" id="8372532">err</span>&nbsp;<span class="op" id="8372536">!=</span>&nbsp;<span class="ident" id="8372539">nil</span>&nbsp;<span class="op" id="8372543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8372547">panic</span><span class="op" id="8372552">(</span><span class="ident" id="8372553">fmt</span><span class="op" id="8372556">.</span><span class="ident" id="8372557">Sprintf</span><span class="op" id="8372564">(</span><span class="string" id="8372565">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8372591">,</span>&nbsp;<span class="ident" id="8372593">s</span><span class="op" id="8372594">,</span>&nbsp;<span class="ident" id="8372596">err</span><span class="op" id="8372599">)</span><span class="op" id="8372600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8372603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8372606">return</span>&nbsp;<span class="ident" id="8372613">u</span><br>
<span class="lineno">565</span><span class="op" id="8372615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8372618">type</span>&nbsp;<span class="ident" id="8372623">writerFunc</span>&nbsp;<span class="keyword" id="8372634">func</span><span class="op" id="8372638">(</span><span class="op" id="8372639">[</span><span class="op" id="8372640">]</span><span class="builtintype" id="8372641">byte</span><span class="op" id="8372645">)</span>&nbsp;<span class="op" id="8372647">(</span><span class="builtintype" id="8372648">int</span><span class="op" id="8372651">,</span>&nbsp;<span class="builtintype" id="8372653">error</span><span class="op" id="8372658">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8372661">func</span>&nbsp;<span class="op" id="8372666">(</span><span class="ident" id="8372667">f</span>&nbsp;<span class="ident" id="8372669">writerFunc</span><span class="op" id="8372679">)</span>&nbsp;<span class="ident" id="8372681">Write</span><span class="op" id="8372686">(</span><span class="ident" id="8372687">p</span>&nbsp;<span class="op" id="8372689">[</span><span class="op" id="8372690">]</span><span class="builtintype" id="8372691">byte</span><span class="op" id="8372695">)</span>&nbsp;<span class="op" id="8372697">(</span><span class="builtintype" id="8372698">int</span><span class="op" id="8372701">,</span>&nbsp;<span class="builtintype" id="8372703">error</span><span class="op" id="8372708">)</span>&nbsp;<span class="op" id="8372710">{</span>&nbsp;<span class="keyword" id="8372712">return</span>&nbsp;<span class="ident" id="8372719">f</span><span class="op" id="8372720">(</span><span class="ident" id="8372721">p</span><span class="op" id="8372722">)</span>&nbsp;<span class="op" id="8372724">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="8372727">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="8372807">func</span>&nbsp;<span class="ident" id="8372812">TestRequestWriteError</span><span class="op" id="8372833">(</span><span class="ident" id="8372834">t</span>&nbsp;<span class="op" id="8372836">*</span><span class="ident" id="8372837">testing</span><span class="op" id="8372844">.</span><span class="ident" id="8372845">T</span><span class="op" id="8372846">)</span>&nbsp;<span class="op" id="8372848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8372851">failAfter</span><span class="op" id="8372860">,</span>&nbsp;<span class="ident" id="8372862">writeCount</span>&nbsp;<span class="op" id="8372873">:=</span>&nbsp;<span class="num" id="8372876">0</span><span class="op" id="8372877">,</span>&nbsp;<span class="num" id="8372879">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8372882">errFail</span>&nbsp;<span class="op" id="8372890">:=</span>&nbsp;<span class="ident" id="8372893">errors</span><span class="op" id="8372899">.</span><span class="ident" id="8372900">New</span><span class="op" id="8372903">(</span><span class="string" id="8372904">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="8372924">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8372928">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8372989">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8373052">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8373105">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373121">w</span>&nbsp;<span class="op" id="8373123">:=</span>&nbsp;<span class="keyword" id="8373126">struct</span>&nbsp;<span class="op" id="8373133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373137">io</span><span class="op" id="8373139">.</span><span class="ident" id="8373140">ByteWriter</span>&nbsp;<span class="comment" id="8373151">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373197">io</span><span class="op" id="8373199">.</span><span class="ident" id="8373200">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373208">}</span><span class="op" id="8373209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373213">nil</span><span class="op" id="8373216">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373220">writerFunc</span><span class="op" id="8373230">(</span><span class="keyword" id="8373231">func</span><span class="op" id="8373235">(</span><span class="ident" id="8373236">p</span>&nbsp;<span class="op" id="8373238">[</span><span class="op" id="8373239">]</span><span class="builtintype" id="8373240">byte</span><span class="op" id="8373244">)</span>&nbsp;<span class="op" id="8373246">(</span><span class="ident" id="8373247">n</span>&nbsp;<span class="builtintype" id="8373249">int</span><span class="op" id="8373252">,</span>&nbsp;<span class="ident" id="8373254">err</span>&nbsp;<span class="builtintype" id="8373258">error</span><span class="op" id="8373263">)</span>&nbsp;<span class="op" id="8373265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373270">writeCount</span><span class="op" id="8373280">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373286">if</span>&nbsp;<span class="ident" id="8373289">failAfter</span>&nbsp;<span class="op" id="8373299">==</span>&nbsp;<span class="num" id="8373302">0</span>&nbsp;<span class="op" id="8373304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373310">err</span>&nbsp;<span class="op" id="8373314">=</span>&nbsp;<span class="ident" id="8373316">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373327">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373332">failAfter</span><span class="op" id="8373341">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373347">return</span>&nbsp;<span class="builtinfunc" id="8373354">len</span><span class="op" id="8373357">(</span><span class="ident" id="8373358">p</span><span class="op" id="8373359">)</span><span class="op" id="8373360">,</span>&nbsp;<span class="ident" id="8373362">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373368">}</span><span class="op" id="8373369">)</span><span class="op" id="8373370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373377">req</span><span class="op" id="8373380">,</span>&nbsp;<span class="ident" id="8373382">_</span>&nbsp;<span class="op" id="8373384">:=</span>&nbsp;<span class="ident" id="8373387">NewRequest</span><span class="op" id="8373397">(</span><span class="string" id="8373398">&#34;GET&#34;</span><span class="op" id="8373403">,</span>&nbsp;<span class="string" id="8373405">&#34;http://example.com/&#34;</span><span class="op" id="8373426">,</span>&nbsp;<span class="ident" id="8373428">nil</span><span class="op" id="8373431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373434">const</span>&nbsp;<span class="ident" id="8373440">writeCalls</span>&nbsp;<span class="op" id="8373451">=</span>&nbsp;<span class="num" id="8373453">4</span>&nbsp;<span class="comment" id="8373455">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373507">sawGood</span>&nbsp;<span class="op" id="8373515">:=</span>&nbsp;<span class="builtintype" id="8373518">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373525">for</span>&nbsp;<span class="ident" id="8373529">n</span>&nbsp;<span class="op" id="8373531">:=</span>&nbsp;<span class="num" id="8373534">0</span><span class="op" id="8373535">;</span>&nbsp;<span class="ident" id="8373537">n</span>&nbsp;<span class="op" id="8373539">&lt;=</span>&nbsp;<span class="ident" id="8373542">writeCalls</span><span class="op" id="8373552">+</span><span class="num" id="8373553">2</span><span class="op" id="8373554">;</span>&nbsp;<span class="ident" id="8373556">n</span><span class="op" id="8373557">++</span>&nbsp;<span class="op" id="8373560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373564">failAfter</span>&nbsp;<span class="op" id="8373574">=</span>&nbsp;<span class="ident" id="8373576">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373580">writeCount</span>&nbsp;<span class="op" id="8373591">=</span>&nbsp;<span class="num" id="8373593">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373597">err</span>&nbsp;<span class="op" id="8373601">:=</span>&nbsp;<span class="ident" id="8373604">req</span><span class="op" id="8373607">.</span><span class="ident" id="8373608">Write</span><span class="op" id="8373613">(</span><span class="ident" id="8373614">w</span><span class="op" id="8373615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373619">var</span>&nbsp;<span class="ident" id="8373623">wantErr</span>&nbsp;<span class="builtintype" id="8373631">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373639">if</span>&nbsp;<span class="ident" id="8373642">n</span>&nbsp;<span class="op" id="8373644">&lt;</span>&nbsp;<span class="ident" id="8373646">writeCalls</span>&nbsp;<span class="op" id="8373657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373662">wantErr</span>&nbsp;<span class="op" id="8373670">=</span>&nbsp;<span class="ident" id="8373672">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373686">if</span>&nbsp;<span class="ident" id="8373689">err</span>&nbsp;<span class="op" id="8373693">!=</span>&nbsp;<span class="ident" id="8373696">wantErr</span>&nbsp;<span class="op" id="8373704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373709">t</span><span class="op" id="8373710">.</span><span class="ident" id="8373711">Errorf</span><span class="op" id="8373717">(</span><span class="string" id="8373718">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8373763">,</span>&nbsp;<span class="ident" id="8373765">n</span><span class="op" id="8373766">,</span>&nbsp;<span class="ident" id="8373768">err</span><span class="op" id="8373771">,</span>&nbsp;<span class="ident" id="8373773">wantErr</span><span class="op" id="8373780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373785">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373796">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373800">if</span>&nbsp;<span class="ident" id="8373803">err</span>&nbsp;<span class="op" id="8373807">==</span>&nbsp;<span class="ident" id="8373810">nil</span>&nbsp;<span class="op" id="8373814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373819">sawGood</span>&nbsp;<span class="op" id="8373827">=</span>&nbsp;<span class="builtintype" id="8373829">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373837">if</span>&nbsp;<span class="ident" id="8373840">writeCount</span>&nbsp;<span class="op" id="8373851">!=</span>&nbsp;<span class="ident" id="8373854">writeCalls</span>&nbsp;<span class="op" id="8373865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373871">t</span><span class="op" id="8373872">.</span><span class="ident" id="8373873">Fatalf</span><span class="op" id="8373879">(</span><span class="string" id="8373880">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="8373921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373926">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373934">if</span>&nbsp;<span class="ident" id="8373937">writeCount</span>&nbsp;<span class="op" id="8373948">&gt;</span>&nbsp;<span class="ident" id="8373950">writeCalls</span>&nbsp;<span class="op" id="8373961">||</span>&nbsp;<span class="ident" id="8373964">writeCount</span>&nbsp;<span class="op" id="8373975">&gt;</span>&nbsp;<span class="ident" id="8373977">n</span><span class="op" id="8373978">+</span><span class="num" id="8373979">1</span>&nbsp;<span class="op" id="8373981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373986">t</span><span class="op" id="8373987">.</span><span class="ident" id="8373988">Errorf</span><span class="op" id="8373994">(</span><span class="string" id="8373995">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="8374054">,</span>&nbsp;<span class="ident" id="8374056">n</span><span class="op" id="8374057">,</span>&nbsp;<span class="ident" id="8374059">writeCount</span><span class="op" id="8374069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374076">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374079">if</span>&nbsp;<span class="op" id="8374082">!</span><span class="ident" id="8374083">sawGood</span>&nbsp;<span class="op" id="8374091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374095">t</span><span class="op" id="8374096">.</span><span class="ident" id="8374097">Fatalf</span><span class="op" id="8374103">(</span><span class="string" id="8374104">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="8374145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374148">}</span><br>
<span class="lineno"></span><span class="op" id="8374150">}</span>
</div>
</body>
</html>
