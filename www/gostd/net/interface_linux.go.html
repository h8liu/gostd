<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html" class="current">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4081111">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4081167">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4081221">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4081272">package</span>&nbsp;<span class="ident" id="4081280">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4081285">import</span>&nbsp;<span class="op" id="4081292">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4081295">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4081301">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4081312">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="4081321">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4081324">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4081390">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="4081459">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4081473">func</span>&nbsp;<span class="ident" id="4081478">interfaceTable</span><span class="op" id="4081492">(</span><span class="ident" id="4081493">ifindex</span>&nbsp;<span class="builtintype" id="4081501">int</span><span class="op" id="4081504">)</span>&nbsp;<span class="op" id="4081506">(</span><span class="op" id="4081507">[</span><span class="op" id="4081508">]</span><span class="ident" id="4081509">Interface</span><span class="op" id="4081518">,</span>&nbsp;<span class="builtintype" id="4081520">error</span><span class="op" id="4081525">)</span>&nbsp;<span class="op" id="4081527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081530">tab</span><span class="op" id="4081533">,</span>&nbsp;<span class="ident" id="4081535">err</span>&nbsp;<span class="op" id="4081539">:=</span>&nbsp;<span class="ident" id="4081542">syscall</span><span class="op" id="4081549">.</span><span class="ident" id="4081550">NetlinkRIB</span><span class="op" id="4081560">(</span><span class="ident" id="4081561">syscall</span><span class="op" id="4081568">.</span><span class="ident" id="4081569">RTM_GETLINK</span><span class="op" id="4081580">,</span>&nbsp;<span class="ident" id="4081582">syscall</span><span class="op" id="4081589">.</span><span class="ident" id="4081590">AF_UNSPEC</span><span class="op" id="4081599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081602">if</span>&nbsp;<span class="ident" id="4081605">err</span>&nbsp;<span class="op" id="4081609">!=</span>&nbsp;<span class="ident" id="4081612">nil</span>&nbsp;<span class="op" id="4081616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081620">return</span>&nbsp;<span class="ident" id="4081627">nil</span><span class="op" id="4081630">,</span>&nbsp;<span class="ident" id="4081632">os</span><span class="op" id="4081634">.</span><span class="ident" id="4081635">NewSyscallError</span><span class="op" id="4081650">(</span><span class="string" id="4081651">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="4081664">,</span>&nbsp;<span class="ident" id="4081666">err</span><span class="op" id="4081669">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081675">msgs</span><span class="op" id="4081679">,</span>&nbsp;<span class="ident" id="4081681">err</span>&nbsp;<span class="op" id="4081685">:=</span>&nbsp;<span class="ident" id="4081688">syscall</span><span class="op" id="4081695">.</span><span class="ident" id="4081696">ParseNetlinkMessage</span><span class="op" id="4081715">(</span><span class="ident" id="4081716">tab</span><span class="op" id="4081719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081722">if</span>&nbsp;<span class="ident" id="4081725">err</span>&nbsp;<span class="op" id="4081729">!=</span>&nbsp;<span class="ident" id="4081732">nil</span>&nbsp;<span class="op" id="4081736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081740">return</span>&nbsp;<span class="ident" id="4081747">nil</span><span class="op" id="4081750">,</span>&nbsp;<span class="ident" id="4081752">os</span><span class="op" id="4081754">.</span><span class="ident" id="4081755">NewSyscallError</span><span class="op" id="4081770">(</span><span class="string" id="4081771">&#34;netlink&nbsp;message&#34;</span><span class="op" id="4081788">,</span>&nbsp;<span class="ident" id="4081790">err</span><span class="op" id="4081793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081796">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081799">var</span>&nbsp;<span class="ident" id="4081803">ift</span>&nbsp;<span class="op" id="4081807">[</span><span class="op" id="4081808">]</span><span class="ident" id="4081809">Interface</span><br>
<span class="lineno"></span><span class="ident" id="4081819">loop</span><span class="op" id="4081823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081826">for</span>&nbsp;<span class="ident" id="4081830">_</span><span class="op" id="4081831">,</span>&nbsp;<span class="ident" id="4081833">m</span>&nbsp;<span class="op" id="4081835">:=</span>&nbsp;<span class="keyword" id="4081838">range</span>&nbsp;<span class="ident" id="4081844">msgs</span>&nbsp;<span class="op" id="4081849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081853">switch</span>&nbsp;<span class="ident" id="4081860">m</span><span class="op" id="4081861">.</span><span class="ident" id="4081862">Header</span><span class="op" id="4081868">.</span><span class="ident" id="4081869">Type</span>&nbsp;<span class="op" id="4081874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081878">case</span>&nbsp;<span class="ident" id="4081883">syscall</span><span class="op" id="4081890">.</span><span class="ident" id="4081891">NLMSG_DONE</span><span class="op" id="4081901">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081906">break</span>&nbsp;<span class="ident" id="4081912">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081919">case</span>&nbsp;<span class="ident" id="4081924">syscall</span><span class="op" id="4081931">.</span><span class="ident" id="4081932">RTM_NEWLINK</span><span class="op" id="4081943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081948">ifim</span>&nbsp;<span class="op" id="4081953">:=</span>&nbsp;<span class="op" id="4081956">(</span><span class="op" id="4081957">*</span><span class="ident" id="4081958">syscall</span><span class="op" id="4081965">.</span><span class="ident" id="4081966">IfInfomsg</span><span class="op" id="4081975">)</span><span class="op" id="4081976">(</span><span class="ident" id="4081977">unsafe</span><span class="op" id="4081983">.</span><span class="ident" id="4081984">Pointer</span><span class="op" id="4081991">(</span><span class="op" id="4081992">&amp;</span><span class="ident" id="4081993">m</span><span class="op" id="4081994">.</span><span class="ident" id="4081995">Data</span><span class="op" id="4081999">[</span><span class="num" id="4082000">0</span><span class="op" id="4082001">]</span><span class="op" id="4082002">)</span><span class="op" id="4082003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082008">if</span>&nbsp;<span class="ident" id="4082011">ifindex</span>&nbsp;<span class="op" id="4082019">==</span>&nbsp;<span class="num" id="4082022">0</span>&nbsp;<span class="op" id="4082024">||</span>&nbsp;<span class="ident" id="4082027">ifindex</span>&nbsp;<span class="op" id="4082035">==</span>&nbsp;<span class="builtintype" id="4082038">int</span><span class="op" id="4082041">(</span><span class="ident" id="4082042">ifim</span><span class="op" id="4082046">.</span><span class="ident" id="4082047">Index</span><span class="op" id="4082052">)</span>&nbsp;<span class="op" id="4082054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082060">attrs</span><span class="op" id="4082065">,</span>&nbsp;<span class="ident" id="4082067">err</span>&nbsp;<span class="op" id="4082071">:=</span>&nbsp;<span class="ident" id="4082074">syscall</span><span class="op" id="4082081">.</span><span class="ident" id="4082082">ParseNetlinkRouteAttr</span><span class="op" id="4082103">(</span><span class="op" id="4082104">&amp;</span><span class="ident" id="4082105">m</span><span class="op" id="4082106">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082112">if</span>&nbsp;<span class="ident" id="4082115">err</span>&nbsp;<span class="op" id="4082119">!=</span>&nbsp;<span class="ident" id="4082122">nil</span>&nbsp;<span class="op" id="4082126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082133">return</span>&nbsp;<span class="ident" id="4082140">nil</span><span class="op" id="4082143">,</span>&nbsp;<span class="ident" id="4082145">os</span><span class="op" id="4082147">.</span><span class="ident" id="4082148">NewSyscallError</span><span class="op" id="4082163">(</span><span class="string" id="4082164">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="4082183">,</span>&nbsp;<span class="ident" id="4082185">err</span><span class="op" id="4082188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082200">ift</span>&nbsp;<span class="op" id="4082204">=</span>&nbsp;<span class="builtinfunc" id="4082206">append</span><span class="op" id="4082212">(</span><span class="ident" id="4082213">ift</span><span class="op" id="4082216">,</span>&nbsp;<span class="op" id="4082218">*</span><span class="ident" id="4082219">newLink</span><span class="op" id="4082226">(</span><span class="ident" id="4082227">ifim</span><span class="op" id="4082231">,</span>&nbsp;<span class="ident" id="4082233">attrs</span><span class="op" id="4082238">)</span><span class="op" id="4082239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082245">if</span>&nbsp;<span class="ident" id="4082248">ifindex</span>&nbsp;<span class="op" id="4082256">==</span>&nbsp;<span class="builtintype" id="4082259">int</span><span class="op" id="4082262">(</span><span class="ident" id="4082263">ifim</span><span class="op" id="4082267">.</span><span class="ident" id="4082268">Index</span><span class="op" id="4082273">)</span>&nbsp;<span class="op" id="4082275">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082282">break</span>&nbsp;<span class="ident" id="4082288">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082309">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082312">return</span>&nbsp;<span class="ident" id="4082319">ift</span><span class="op" id="4082322">,</span>&nbsp;<span class="ident" id="4082324">nil</span><br>
<span class="lineno"></span><span class="op" id="4082328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082331">const</span>&nbsp;<span class="op" id="4082337">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4082340">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4082364">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082426">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="4082449">=</span>&nbsp;<span class="num" id="4082451">768</span>&nbsp;<span class="comment" id="4082455">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082484">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="4082507">=</span>&nbsp;<span class="num" id="4082509">769</span>&nbsp;<span class="comment" id="4082513">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082542">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="4082565">=</span>&nbsp;<span class="num" id="4082567">776</span>&nbsp;<span class="comment" id="4082571">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082600">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="4082623">=</span>&nbsp;<span class="num" id="4082625">778</span>&nbsp;<span class="comment" id="4082629">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082666">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="4082689">=</span>&nbsp;<span class="num" id="4082691">823</span>&nbsp;<span class="comment" id="4082695">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="4082731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082734">func</span>&nbsp;<span class="ident" id="4082739">newLink</span><span class="op" id="4082746">(</span><span class="ident" id="4082747">ifim</span>&nbsp;<span class="op" id="4082752">*</span><span class="ident" id="4082753">syscall</span><span class="op" id="4082760">.</span><span class="ident" id="4082761">IfInfomsg</span><span class="op" id="4082770">,</span>&nbsp;<span class="ident" id="4082772">attrs</span>&nbsp;<span class="op" id="4082778">[</span><span class="op" id="4082779">]</span><span class="ident" id="4082780">syscall</span><span class="op" id="4082787">.</span><span class="ident" id="4082788">NetlinkRouteAttr</span><span class="op" id="4082804">)</span>&nbsp;<span class="op" id="4082806">*</span><span class="ident" id="4082807">Interface</span>&nbsp;<span class="op" id="4082817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082820">ifi</span>&nbsp;<span class="op" id="4082824">:=</span>&nbsp;<span class="op" id="4082827">&amp;</span><span class="ident" id="4082828">Interface</span><span class="op" id="4082837">{</span><span class="ident" id="4082838">Index</span><span class="op" id="4082843">:</span>&nbsp;<span class="builtintype" id="4082845">int</span><span class="op" id="4082848">(</span><span class="ident" id="4082849">ifim</span><span class="op" id="4082853">.</span><span class="ident" id="4082854">Index</span><span class="op" id="4082859">)</span><span class="op" id="4082860">,</span>&nbsp;<span class="ident" id="4082862">Flags</span><span class="op" id="4082867">:</span>&nbsp;<span class="ident" id="4082869">linkFlags</span><span class="op" id="4082878">(</span><span class="ident" id="4082879">ifim</span><span class="op" id="4082883">.</span><span class="ident" id="4082884">Flags</span><span class="op" id="4082889">)</span><span class="op" id="4082890">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082893">for</span>&nbsp;<span class="ident" id="4082897">_</span><span class="op" id="4082898">,</span>&nbsp;<span class="ident" id="4082900">a</span>&nbsp;<span class="op" id="4082902">:=</span>&nbsp;<span class="keyword" id="4082905">range</span>&nbsp;<span class="ident" id="4082911">attrs</span>&nbsp;<span class="op" id="4082917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082921">switch</span>&nbsp;<span class="ident" id="4082928">a</span><span class="op" id="4082929">.</span><span class="ident" id="4082930">Attr</span><span class="op" id="4082934">.</span><span class="ident" id="4082935">Type</span>&nbsp;<span class="op" id="4082940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082944">case</span>&nbsp;<span class="ident" id="4082949">syscall</span><span class="op" id="4082956">.</span><span class="ident" id="4082957">IFLA_ADDRESS</span><span class="op" id="4082969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4082974">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083023">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083070">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083094">switch</span>&nbsp;<span class="builtinfunc" id="4083101">len</span><span class="op" id="4083104">(</span><span class="ident" id="4083105">a</span><span class="op" id="4083106">.</span><span class="ident" id="4083107">Value</span><span class="op" id="4083112">)</span>&nbsp;<span class="op" id="4083114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083119">case</span>&nbsp;<span class="ident" id="4083124">IPv4len</span><span class="op" id="4083131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083137">switch</span>&nbsp;<span class="ident" id="4083144">ifim</span><span class="op" id="4083148">.</span><span class="ident" id="4083149">Type</span>&nbsp;<span class="op" id="4083154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083160">case</span>&nbsp;<span class="ident" id="4083165">sysARPHardwareIPv4IPv4</span><span class="op" id="4083187">,</span>&nbsp;<span class="ident" id="4083189">sysARPHardwareGREIPv4</span><span class="op" id="4083210">,</span>&nbsp;<span class="ident" id="4083212">sysARPHardwareIPv6IPv4</span><span class="op" id="4083234">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083241">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083259">case</span>&nbsp;<span class="ident" id="4083264">IPv6len</span><span class="op" id="4083271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083277">switch</span>&nbsp;<span class="ident" id="4083284">ifim</span><span class="op" id="4083288">.</span><span class="ident" id="4083289">Type</span>&nbsp;<span class="op" id="4083294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083300">case</span>&nbsp;<span class="ident" id="4083305">sysARPHardwareIPv6IPv6</span><span class="op" id="4083327">,</span>&nbsp;<span class="ident" id="4083329">sysARPHardwareGREIPv6</span><span class="op" id="4083350">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083357">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083380">var</span>&nbsp;<span class="ident" id="4083384">nonzero</span>&nbsp;<span class="builtintype" id="4083392">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083400">for</span>&nbsp;<span class="ident" id="4083404">_</span><span class="op" id="4083405">,</span>&nbsp;<span class="ident" id="4083407">b</span>&nbsp;<span class="op" id="4083409">:=</span>&nbsp;<span class="keyword" id="4083412">range</span>&nbsp;<span class="ident" id="4083418">a</span><span class="op" id="4083419">.</span><span class="ident" id="4083420">Value</span>&nbsp;<span class="op" id="4083426">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083432">if</span>&nbsp;<span class="ident" id="4083435">b</span>&nbsp;<span class="op" id="4083437">!=</span>&nbsp;<span class="num" id="4083440">0</span>&nbsp;<span class="op" id="4083442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083449">nonzero</span>&nbsp;<span class="op" id="4083457">=</span>&nbsp;<span class="builtintype" id="4083459">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083469">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083484">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083489">if</span>&nbsp;<span class="ident" id="4083492">nonzero</span>&nbsp;<span class="op" id="4083500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083506">ifi</span><span class="op" id="4083509">.</span><span class="ident" id="4083510">HardwareAddr</span>&nbsp;<span class="op" id="4083523">=</span>&nbsp;<span class="ident" id="4083525">a</span><span class="op" id="4083526">.</span><span class="ident" id="4083527">Value</span><span class="op" id="4083532">[</span><span class="op" id="4083533">:</span><span class="op" id="4083534">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083543">case</span>&nbsp;<span class="ident" id="4083548">syscall</span><span class="op" id="4083555">.</span><span class="ident" id="4083556">IFLA_IFNAME</span><span class="op" id="4083567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083572">ifi</span><span class="op" id="4083575">.</span><span class="ident" id="4083576">Name</span>&nbsp;<span class="op" id="4083581">=</span>&nbsp;<span class="builtintype" id="4083583">string</span><span class="op" id="4083589">(</span><span class="ident" id="4083590">a</span><span class="op" id="4083591">.</span><span class="ident" id="4083592">Value</span><span class="op" id="4083597">[</span><span class="op" id="4083598">:</span><span class="builtinfunc" id="4083599">len</span><span class="op" id="4083602">(</span><span class="ident" id="4083603">a</span><span class="op" id="4083604">.</span><span class="ident" id="4083605">Value</span><span class="op" id="4083610">)</span><span class="op" id="4083611">-</span><span class="num" id="4083612">1</span><span class="op" id="4083613">]</span><span class="op" id="4083614">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083618">case</span>&nbsp;<span class="ident" id="4083623">syscall</span><span class="op" id="4083630">.</span><span class="ident" id="4083631">IFLA_MTU</span><span class="op" id="4083639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083644">ifi</span><span class="op" id="4083647">.</span><span class="ident" id="4083648">MTU</span>&nbsp;<span class="op" id="4083652">=</span>&nbsp;<span class="builtintype" id="4083654">int</span><span class="op" id="4083657">(</span><span class="op" id="4083658">*</span><span class="op" id="4083659">(</span><span class="op" id="4083660">*</span><span class="builtintype" id="4083661">uint32</span><span class="op" id="4083667">)</span><span class="op" id="4083668">(</span><span class="ident" id="4083669">unsafe</span><span class="op" id="4083675">.</span><span class="ident" id="4083676">Pointer</span><span class="op" id="4083683">(</span><span class="op" id="4083684">&amp;</span><span class="ident" id="4083685">a</span><span class="op" id="4083686">.</span><span class="ident" id="4083687">Value</span><span class="op" id="4083692">[</span><span class="op" id="4083693">:</span><span class="num" id="4083694">4</span><span class="op" id="4083695">]</span><span class="op" id="4083696">[</span><span class="num" id="4083697">0</span><span class="op" id="4083698">]</span><span class="op" id="4083699">)</span><span class="op" id="4083700">)</span><span class="op" id="4083701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083711">return</span>&nbsp;<span class="ident" id="4083718">ifi</span><br>
<span class="lineno">95</span><span class="op" id="4083722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4083725">func</span>&nbsp;<span class="ident" id="4083730">linkFlags</span><span class="op" id="4083739">(</span><span class="ident" id="4083740">rawFlags</span>&nbsp;<span class="builtintype" id="4083749">uint32</span><span class="op" id="4083755">)</span>&nbsp;<span class="ident" id="4083757">Flags</span>&nbsp;<span class="op" id="4083763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083766">var</span>&nbsp;<span class="ident" id="4083770">f</span>&nbsp;<span class="ident" id="4083772">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083779">if</span>&nbsp;<span class="ident" id="4083782">rawFlags</span><span class="op" id="4083790">&amp;</span><span class="ident" id="4083791">syscall</span><span class="op" id="4083798">.</span><span class="ident" id="4083799">IFF_UP</span>&nbsp;<span class="op" id="4083806">!=</span>&nbsp;<span class="num" id="4083809">0</span>&nbsp;<span class="op" id="4083811">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083815">f</span>&nbsp;<span class="op" id="4083817">|=</span>&nbsp;<span class="ident" id="4083820">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083831">if</span>&nbsp;<span class="ident" id="4083834">rawFlags</span><span class="op" id="4083842">&amp;</span><span class="ident" id="4083843">syscall</span><span class="op" id="4083850">.</span><span class="ident" id="4083851">IFF_BROADCAST</span>&nbsp;<span class="op" id="4083865">!=</span>&nbsp;<span class="num" id="4083868">0</span>&nbsp;<span class="op" id="4083870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083874">f</span>&nbsp;<span class="op" id="4083876">|=</span>&nbsp;<span class="ident" id="4083879">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083894">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083897">if</span>&nbsp;<span class="ident" id="4083900">rawFlags</span><span class="op" id="4083908">&amp;</span><span class="ident" id="4083909">syscall</span><span class="op" id="4083916">.</span><span class="ident" id="4083917">IFF_LOOPBACK</span>&nbsp;<span class="op" id="4083930">!=</span>&nbsp;<span class="num" id="4083933">0</span>&nbsp;<span class="op" id="4083935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083939">f</span>&nbsp;<span class="op" id="4083941">|=</span>&nbsp;<span class="ident" id="4083944">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083961">if</span>&nbsp;<span class="ident" id="4083964">rawFlags</span><span class="op" id="4083972">&amp;</span><span class="ident" id="4083973">syscall</span><span class="op" id="4083980">.</span><span class="ident" id="4083981">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="4083997">!=</span>&nbsp;<span class="num" id="4084000">0</span>&nbsp;<span class="op" id="4084002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084006">f</span>&nbsp;<span class="op" id="4084008">|=</span>&nbsp;<span class="ident" id="4084011">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084032">if</span>&nbsp;<span class="ident" id="4084035">rawFlags</span><span class="op" id="4084043">&amp;</span><span class="ident" id="4084044">syscall</span><span class="op" id="4084051">.</span><span class="ident" id="4084052">IFF_MULTICAST</span>&nbsp;<span class="op" id="4084066">!=</span>&nbsp;<span class="num" id="4084069">0</span>&nbsp;<span class="op" id="4084071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084075">f</span>&nbsp;<span class="op" id="4084077">|=</span>&nbsp;<span class="ident" id="4084080">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084098">return</span>&nbsp;<span class="ident" id="4084105">f</span><br>
<span class="lineno">115</span><span class="op" id="4084107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4084110">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4084177">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="4084247">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="4084261">func</span>&nbsp;<span class="ident" id="4084266">interfaceAddrTable</span><span class="op" id="4084284">(</span><span class="ident" id="4084285">ifi</span>&nbsp;<span class="op" id="4084289">*</span><span class="ident" id="4084290">Interface</span><span class="op" id="4084299">)</span>&nbsp;<span class="op" id="4084301">(</span><span class="op" id="4084302">[</span><span class="op" id="4084303">]</span><span class="ident" id="4084304">Addr</span><span class="op" id="4084308">,</span>&nbsp;<span class="builtintype" id="4084310">error</span><span class="op" id="4084315">)</span>&nbsp;<span class="op" id="4084317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084320">tab</span><span class="op" id="4084323">,</span>&nbsp;<span class="ident" id="4084325">err</span>&nbsp;<span class="op" id="4084329">:=</span>&nbsp;<span class="ident" id="4084332">syscall</span><span class="op" id="4084339">.</span><span class="ident" id="4084340">NetlinkRIB</span><span class="op" id="4084350">(</span><span class="ident" id="4084351">syscall</span><span class="op" id="4084358">.</span><span class="ident" id="4084359">RTM_GETADDR</span><span class="op" id="4084370">,</span>&nbsp;<span class="ident" id="4084372">syscall</span><span class="op" id="4084379">.</span><span class="ident" id="4084380">AF_UNSPEC</span><span class="op" id="4084389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084392">if</span>&nbsp;<span class="ident" id="4084395">err</span>&nbsp;<span class="op" id="4084399">!=</span>&nbsp;<span class="ident" id="4084402">nil</span>&nbsp;<span class="op" id="4084406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084410">return</span>&nbsp;<span class="ident" id="4084417">nil</span><span class="op" id="4084420">,</span>&nbsp;<span class="ident" id="4084422">os</span><span class="op" id="4084424">.</span><span class="ident" id="4084425">NewSyscallError</span><span class="op" id="4084440">(</span><span class="string" id="4084441">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="4084454">,</span>&nbsp;<span class="ident" id="4084456">err</span><span class="op" id="4084459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084462">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084465">msgs</span><span class="op" id="4084469">,</span>&nbsp;<span class="ident" id="4084471">err</span>&nbsp;<span class="op" id="4084475">:=</span>&nbsp;<span class="ident" id="4084478">syscall</span><span class="op" id="4084485">.</span><span class="ident" id="4084486">ParseNetlinkMessage</span><span class="op" id="4084505">(</span><span class="ident" id="4084506">tab</span><span class="op" id="4084509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084512">if</span>&nbsp;<span class="ident" id="4084515">err</span>&nbsp;<span class="op" id="4084519">!=</span>&nbsp;<span class="ident" id="4084522">nil</span>&nbsp;<span class="op" id="4084526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084530">return</span>&nbsp;<span class="ident" id="4084537">nil</span><span class="op" id="4084540">,</span>&nbsp;<span class="ident" id="4084542">os</span><span class="op" id="4084544">.</span><span class="ident" id="4084545">NewSyscallError</span><span class="op" id="4084560">(</span><span class="string" id="4084561">&#34;netlink&nbsp;message&#34;</span><span class="op" id="4084578">,</span>&nbsp;<span class="ident" id="4084580">err</span><span class="op" id="4084583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084589">var</span>&nbsp;<span class="ident" id="4084593">ift</span>&nbsp;<span class="op" id="4084597">[</span><span class="op" id="4084598">]</span><span class="ident" id="4084599">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084610">if</span>&nbsp;<span class="ident" id="4084613">ifi</span>&nbsp;<span class="op" id="4084617">==</span>&nbsp;<span class="ident" id="4084620">nil</span>&nbsp;<span class="op" id="4084624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084628">var</span>&nbsp;<span class="ident" id="4084632">err</span>&nbsp;<span class="builtintype" id="4084636">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084644">ift</span><span class="op" id="4084647">,</span>&nbsp;<span class="ident" id="4084649">err</span>&nbsp;<span class="op" id="4084653">=</span>&nbsp;<span class="ident" id="4084655">interfaceTable</span><span class="op" id="4084669">(</span><span class="num" id="4084670">0</span><span class="op" id="4084671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084675">if</span>&nbsp;<span class="ident" id="4084678">err</span>&nbsp;<span class="op" id="4084682">!=</span>&nbsp;<span class="ident" id="4084685">nil</span>&nbsp;<span class="op" id="4084689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084694">return</span>&nbsp;<span class="ident" id="4084701">nil</span><span class="op" id="4084704">,</span>&nbsp;<span class="ident" id="4084706">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084718">ifat</span><span class="op" id="4084722">,</span>&nbsp;<span class="ident" id="4084724">err</span>&nbsp;<span class="op" id="4084728">:=</span>&nbsp;<span class="ident" id="4084731">addrTable</span><span class="op" id="4084740">(</span><span class="ident" id="4084741">ift</span><span class="op" id="4084744">,</span>&nbsp;<span class="ident" id="4084746">ifi</span><span class="op" id="4084749">,</span>&nbsp;<span class="ident" id="4084751">msgs</span><span class="op" id="4084755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084758">if</span>&nbsp;<span class="ident" id="4084761">err</span>&nbsp;<span class="op" id="4084765">!=</span>&nbsp;<span class="ident" id="4084768">nil</span>&nbsp;<span class="op" id="4084772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084776">return</span>&nbsp;<span class="ident" id="4084783">nil</span><span class="op" id="4084786">,</span>&nbsp;<span class="ident" id="4084788">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084796">return</span>&nbsp;<span class="ident" id="4084803">ifat</span><span class="op" id="4084807">,</span>&nbsp;<span class="ident" id="4084809">nil</span><br>
<span class="lineno"></span><span class="op" id="4084813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4084816">func</span>&nbsp;<span class="ident" id="4084821">addrTable</span><span class="op" id="4084830">(</span><span class="ident" id="4084831">ift</span>&nbsp;<span class="op" id="4084835">[</span><span class="op" id="4084836">]</span><span class="ident" id="4084837">Interface</span><span class="op" id="4084846">,</span>&nbsp;<span class="ident" id="4084848">ifi</span>&nbsp;<span class="op" id="4084852">*</span><span class="ident" id="4084853">Interface</span><span class="op" id="4084862">,</span>&nbsp;<span class="ident" id="4084864">msgs</span>&nbsp;<span class="op" id="4084869">[</span><span class="op" id="4084870">]</span><span class="ident" id="4084871">syscall</span><span class="op" id="4084878">.</span><span class="ident" id="4084879">NetlinkMessage</span><span class="op" id="4084893">)</span>&nbsp;<span class="op" id="4084895">(</span><span class="op" id="4084896">[</span><span class="op" id="4084897">]</span><span class="ident" id="4084898">Addr</span><span class="op" id="4084902">,</span>&nbsp;<span class="builtintype" id="4084904">error</span><span class="op" id="4084909">)</span>&nbsp;<span class="op" id="4084911">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084914">var</span>&nbsp;<span class="ident" id="4084918">ifat</span>&nbsp;<span class="op" id="4084923">[</span><span class="op" id="4084924">]</span><span class="ident" id="4084925">Addr</span><br>
<span class="lineno"></span><span class="ident" id="4084930">loop</span><span class="op" id="4084934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084937">for</span>&nbsp;<span class="ident" id="4084941">_</span><span class="op" id="4084942">,</span>&nbsp;<span class="ident" id="4084944">m</span>&nbsp;<span class="op" id="4084946">:=</span>&nbsp;<span class="keyword" id="4084949">range</span>&nbsp;<span class="ident" id="4084955">msgs</span>&nbsp;<span class="op" id="4084960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084964">switch</span>&nbsp;<span class="ident" id="4084971">m</span><span class="op" id="4084972">.</span><span class="ident" id="4084973">Header</span><span class="op" id="4084979">.</span><span class="ident" id="4084980">Type</span>&nbsp;<span class="op" id="4084985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084989">case</span>&nbsp;<span class="ident" id="4084994">syscall</span><span class="op" id="4085001">.</span><span class="ident" id="4085002">NLMSG_DONE</span><span class="op" id="4085012">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085017">break</span>&nbsp;<span class="ident" id="4085023">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085030">case</span>&nbsp;<span class="ident" id="4085035">syscall</span><span class="op" id="4085042">.</span><span class="ident" id="4085043">RTM_NEWADDR</span><span class="op" id="4085054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085059">ifam</span>&nbsp;<span class="op" id="4085064">:=</span>&nbsp;<span class="op" id="4085067">(</span><span class="op" id="4085068">*</span><span class="ident" id="4085069">syscall</span><span class="op" id="4085076">.</span><span class="ident" id="4085077">IfAddrmsg</span><span class="op" id="4085086">)</span><span class="op" id="4085087">(</span><span class="ident" id="4085088">unsafe</span><span class="op" id="4085094">.</span><span class="ident" id="4085095">Pointer</span><span class="op" id="4085102">(</span><span class="op" id="4085103">&amp;</span><span class="ident" id="4085104">m</span><span class="op" id="4085105">.</span><span class="ident" id="4085106">Data</span><span class="op" id="4085110">[</span><span class="num" id="4085111">0</span><span class="op" id="4085112">]</span><span class="op" id="4085113">)</span><span class="op" id="4085114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085119">if</span>&nbsp;<span class="builtinfunc" id="4085122">len</span><span class="op" id="4085125">(</span><span class="ident" id="4085126">ift</span><span class="op" id="4085129">)</span>&nbsp;<span class="op" id="4085131">!=</span>&nbsp;<span class="num" id="4085134">0</span>&nbsp;<span class="op" id="4085136">||</span>&nbsp;<span class="ident" id="4085139">ifi</span><span class="op" id="4085142">.</span><span class="ident" id="4085143">Index</span>&nbsp;<span class="op" id="4085149">==</span>&nbsp;<span class="builtintype" id="4085152">int</span><span class="op" id="4085155">(</span><span class="ident" id="4085156">ifam</span><span class="op" id="4085160">.</span><span class="ident" id="4085161">Index</span><span class="op" id="4085166">)</span>&nbsp;<span class="op" id="4085168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085174">if</span>&nbsp;<span class="builtinfunc" id="4085177">len</span><span class="op" id="4085180">(</span><span class="ident" id="4085181">ift</span><span class="op" id="4085184">)</span>&nbsp;<span class="op" id="4085186">!=</span>&nbsp;<span class="num" id="4085189">0</span>&nbsp;<span class="op" id="4085191">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085198">var</span>&nbsp;<span class="ident" id="4085202">err</span>&nbsp;<span class="builtintype" id="4085206">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085217">ifi</span><span class="op" id="4085220">,</span>&nbsp;<span class="ident" id="4085222">err</span>&nbsp;<span class="op" id="4085226">=</span>&nbsp;<span class="ident" id="4085228">interfaceByIndex</span><span class="op" id="4085244">(</span><span class="ident" id="4085245">ift</span><span class="op" id="4085248">,</span>&nbsp;<span class="builtintype" id="4085250">int</span><span class="op" id="4085253">(</span><span class="ident" id="4085254">ifam</span><span class="op" id="4085258">.</span><span class="ident" id="4085259">Index</span><span class="op" id="4085264">)</span><span class="op" id="4085265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085272">if</span>&nbsp;<span class="ident" id="4085275">err</span>&nbsp;<span class="op" id="4085279">!=</span>&nbsp;<span class="ident" id="4085282">nil</span>&nbsp;<span class="op" id="4085286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085294">return</span>&nbsp;<span class="ident" id="4085301">nil</span><span class="op" id="4085304">,</span>&nbsp;<span class="ident" id="4085306">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085315">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085327">attrs</span><span class="op" id="4085332">,</span>&nbsp;<span class="ident" id="4085334">err</span>&nbsp;<span class="op" id="4085338">:=</span>&nbsp;<span class="ident" id="4085341">syscall</span><span class="op" id="4085348">.</span><span class="ident" id="4085349">ParseNetlinkRouteAttr</span><span class="op" id="4085370">(</span><span class="op" id="4085371">&amp;</span><span class="ident" id="4085372">m</span><span class="op" id="4085373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085379">if</span>&nbsp;<span class="ident" id="4085382">err</span>&nbsp;<span class="op" id="4085386">!=</span>&nbsp;<span class="ident" id="4085389">nil</span>&nbsp;<span class="op" id="4085393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085400">return</span>&nbsp;<span class="ident" id="4085407">nil</span><span class="op" id="4085410">,</span>&nbsp;<span class="ident" id="4085412">os</span><span class="op" id="4085414">.</span><span class="ident" id="4085415">NewSyscallError</span><span class="op" id="4085430">(</span><span class="string" id="4085431">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="4085450">,</span>&nbsp;<span class="ident" id="4085452">err</span><span class="op" id="4085455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085461">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085467">ifa</span>&nbsp;<span class="op" id="4085471">:=</span>&nbsp;<span class="ident" id="4085474">newAddr</span><span class="op" id="4085481">(</span><span class="ident" id="4085482">ifi</span><span class="op" id="4085485">,</span>&nbsp;<span class="ident" id="4085487">ifam</span><span class="op" id="4085491">,</span>&nbsp;<span class="ident" id="4085493">attrs</span><span class="op" id="4085498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085504">if</span>&nbsp;<span class="ident" id="4085507">ifa</span>&nbsp;<span class="op" id="4085511">!=</span>&nbsp;<span class="ident" id="4085514">nil</span>&nbsp;<span class="op" id="4085518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085525">ifat</span>&nbsp;<span class="op" id="4085530">=</span>&nbsp;<span class="builtinfunc" id="4085532">append</span><span class="op" id="4085538">(</span><span class="ident" id="4085539">ifat</span><span class="op" id="4085543">,</span>&nbsp;<span class="ident" id="4085545">ifa</span><span class="op" id="4085548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085559">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085569">return</span>&nbsp;<span class="ident" id="4085576">ifat</span><span class="op" id="4085580">,</span>&nbsp;<span class="ident" id="4085582">nil</span><br>
<span class="lineno"></span><span class="op" id="4085586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="4085589">func</span>&nbsp;<span class="ident" id="4085594">newAddr</span><span class="op" id="4085601">(</span><span class="ident" id="4085602">ifi</span>&nbsp;<span class="op" id="4085606">*</span><span class="ident" id="4085607">Interface</span><span class="op" id="4085616">,</span>&nbsp;<span class="ident" id="4085618">ifam</span>&nbsp;<span class="op" id="4085623">*</span><span class="ident" id="4085624">syscall</span><span class="op" id="4085631">.</span><span class="ident" id="4085632">IfAddrmsg</span><span class="op" id="4085641">,</span>&nbsp;<span class="ident" id="4085643">attrs</span>&nbsp;<span class="op" id="4085649">[</span><span class="op" id="4085650">]</span><span class="ident" id="4085651">syscall</span><span class="op" id="4085658">.</span><span class="ident" id="4085659">NetlinkRouteAttr</span><span class="op" id="4085675">)</span>&nbsp;<span class="ident" id="4085677">Addr</span>&nbsp;<span class="op" id="4085682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085685">var</span>&nbsp;<span class="ident" id="4085689">ipPointToPoint</span>&nbsp;<span class="builtintype" id="4085704">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4085710">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4085771">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4085834">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085889">if</span>&nbsp;<span class="ident" id="4085892">ifi</span><span class="op" id="4085895">.</span><span class="ident" id="4085896">Flags</span><span class="op" id="4085901">&amp;</span><span class="ident" id="4085902">FlagPointToPoint</span>&nbsp;<span class="op" id="4085919">!=</span>&nbsp;<span class="num" id="4085922">0</span>&nbsp;<span class="op" id="4085924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085928">for</span>&nbsp;<span class="ident" id="4085932">_</span><span class="op" id="4085933">,</span>&nbsp;<span class="ident" id="4085935">a</span>&nbsp;<span class="op" id="4085937">:=</span>&nbsp;<span class="keyword" id="4085940">range</span>&nbsp;<span class="ident" id="4085946">attrs</span>&nbsp;<span class="op" id="4085952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085957">if</span>&nbsp;<span class="ident" id="4085960">a</span><span class="op" id="4085961">.</span><span class="ident" id="4085962">Attr</span><span class="op" id="4085966">.</span><span class="ident" id="4085967">Type</span>&nbsp;<span class="op" id="4085972">==</span>&nbsp;<span class="ident" id="4085975">syscall</span><span class="op" id="4085982">.</span><span class="ident" id="4085983">IFA_LOCAL</span>&nbsp;<span class="op" id="4085993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085999">ipPointToPoint</span>&nbsp;<span class="op" id="4086014">=</span>&nbsp;<span class="builtintype" id="4086016">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086025">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086044">for</span>&nbsp;<span class="ident" id="4086048">_</span><span class="op" id="4086049">,</span>&nbsp;<span class="ident" id="4086051">a</span>&nbsp;<span class="op" id="4086053">:=</span>&nbsp;<span class="keyword" id="4086056">range</span>&nbsp;<span class="ident" id="4086062">attrs</span>&nbsp;<span class="op" id="4086068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086072">if</span>&nbsp;<span class="ident" id="4086075">ipPointToPoint</span>&nbsp;<span class="op" id="4086090">&amp;&amp;</span>&nbsp;<span class="ident" id="4086093">a</span><span class="op" id="4086094">.</span><span class="ident" id="4086095">Attr</span><span class="op" id="4086099">.</span><span class="ident" id="4086100">Type</span>&nbsp;<span class="op" id="4086105">==</span>&nbsp;<span class="ident" id="4086108">syscall</span><span class="op" id="4086115">.</span><span class="ident" id="4086116">IFA_ADDRESS</span>&nbsp;<span class="op" id="4086128">||</span>&nbsp;<span class="op" id="4086131">!</span><span class="ident" id="4086132">ipPointToPoint</span>&nbsp;<span class="op" id="4086147">&amp;&amp;</span>&nbsp;<span class="ident" id="4086150">a</span><span class="op" id="4086151">.</span><span class="ident" id="4086152">Attr</span><span class="op" id="4086156">.</span><span class="ident" id="4086157">Type</span>&nbsp;<span class="op" id="4086162">==</span>&nbsp;<span class="ident" id="4086165">syscall</span><span class="op" id="4086172">.</span><span class="ident" id="4086173">IFA_LOCAL</span>&nbsp;<span class="op" id="4086183">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086188">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086203">switch</span>&nbsp;<span class="ident" id="4086210">ifam</span><span class="op" id="4086214">.</span><span class="ident" id="4086215">Family</span>&nbsp;<span class="op" id="4086222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086226">case</span>&nbsp;<span class="ident" id="4086231">syscall</span><span class="op" id="4086238">.</span><span class="ident" id="4086239">AF_INET</span><span class="op" id="4086246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086251">return</span>&nbsp;<span class="op" id="4086258">&amp;</span><span class="ident" id="4086259">IPNet</span><span class="op" id="4086264">{</span><span class="ident" id="4086265">IP</span><span class="op" id="4086267">:</span>&nbsp;<span class="ident" id="4086269">IPv4</span><span class="op" id="4086273">(</span><span class="ident" id="4086274">a</span><span class="op" id="4086275">.</span><span class="ident" id="4086276">Value</span><span class="op" id="4086281">[</span><span class="num" id="4086282">0</span><span class="op" id="4086283">]</span><span class="op" id="4086284">,</span>&nbsp;<span class="ident" id="4086286">a</span><span class="op" id="4086287">.</span><span class="ident" id="4086288">Value</span><span class="op" id="4086293">[</span><span class="num" id="4086294">1</span><span class="op" id="4086295">]</span><span class="op" id="4086296">,</span>&nbsp;<span class="ident" id="4086298">a</span><span class="op" id="4086299">.</span><span class="ident" id="4086300">Value</span><span class="op" id="4086305">[</span><span class="num" id="4086306">2</span><span class="op" id="4086307">]</span><span class="op" id="4086308">,</span>&nbsp;<span class="ident" id="4086310">a</span><span class="op" id="4086311">.</span><span class="ident" id="4086312">Value</span><span class="op" id="4086317">[</span><span class="num" id="4086318">3</span><span class="op" id="4086319">]</span><span class="op" id="4086320">)</span><span class="op" id="4086321">,</span>&nbsp;<span class="ident" id="4086323">Mask</span><span class="op" id="4086327">:</span>&nbsp;<span class="ident" id="4086329">CIDRMask</span><span class="op" id="4086337">(</span><span class="builtintype" id="4086338">int</span><span class="op" id="4086341">(</span><span class="ident" id="4086342">ifam</span><span class="op" id="4086346">.</span><span class="ident" id="4086347">Prefixlen</span><span class="op" id="4086356">)</span><span class="op" id="4086357">,</span>&nbsp;<span class="num" id="4086359">8</span><span class="op" id="4086360">*</span><span class="ident" id="4086361">IPv4len</span><span class="op" id="4086368">)</span><span class="op" id="4086369">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086373">case</span>&nbsp;<span class="ident" id="4086378">syscall</span><span class="op" id="4086385">.</span><span class="ident" id="4086386">AF_INET6</span><span class="op" id="4086394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086399">ifa</span>&nbsp;<span class="op" id="4086403">:=</span>&nbsp;<span class="op" id="4086406">&amp;</span><span class="ident" id="4086407">IPNet</span><span class="op" id="4086412">{</span><span class="ident" id="4086413">IP</span><span class="op" id="4086415">:</span>&nbsp;<span class="builtinfunc" id="4086417">make</span><span class="op" id="4086421">(</span><span class="ident" id="4086422">IP</span><span class="op" id="4086424">,</span>&nbsp;<span class="ident" id="4086426">IPv6len</span><span class="op" id="4086433">)</span><span class="op" id="4086434">,</span>&nbsp;<span class="ident" id="4086436">Mask</span><span class="op" id="4086440">:</span>&nbsp;<span class="ident" id="4086442">CIDRMask</span><span class="op" id="4086450">(</span><span class="builtintype" id="4086451">int</span><span class="op" id="4086454">(</span><span class="ident" id="4086455">ifam</span><span class="op" id="4086459">.</span><span class="ident" id="4086460">Prefixlen</span><span class="op" id="4086469">)</span><span class="op" id="4086470">,</span>&nbsp;<span class="num" id="4086472">8</span><span class="op" id="4086473">*</span><span class="ident" id="4086474">IPv6len</span><span class="op" id="4086481">)</span><span class="op" id="4086482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4086487">copy</span><span class="op" id="4086491">(</span><span class="ident" id="4086492">ifa</span><span class="op" id="4086495">.</span><span class="ident" id="4086496">IP</span><span class="op" id="4086498">,</span>&nbsp;<span class="ident" id="4086500">a</span><span class="op" id="4086501">.</span><span class="ident" id="4086502">Value</span><span class="op" id="4086507">[</span><span class="op" id="4086508">:</span><span class="op" id="4086509">]</span><span class="op" id="4086510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086515">return</span>&nbsp;<span class="ident" id="4086522">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086528">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086534">return</span>&nbsp;<span class="ident" id="4086541">nil</span><br>
<span class="lineno"></span><span class="op" id="4086545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4086548">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="4086612">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4086626">func</span>&nbsp;<span class="ident" id="4086631">interfaceMulticastAddrTable</span><span class="op" id="4086658">(</span><span class="ident" id="4086659">ifi</span>&nbsp;<span class="op" id="4086663">*</span><span class="ident" id="4086664">Interface</span><span class="op" id="4086673">)</span>&nbsp;<span class="op" id="4086675">(</span><span class="op" id="4086676">[</span><span class="op" id="4086677">]</span><span class="ident" id="4086678">Addr</span><span class="op" id="4086682">,</span>&nbsp;<span class="builtintype" id="4086684">error</span><span class="op" id="4086689">)</span>&nbsp;<span class="op" id="4086691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086694">ifmat4</span>&nbsp;<span class="op" id="4086701">:=</span>&nbsp;<span class="ident" id="4086704">parseProcNetIGMP</span><span class="op" id="4086720">(</span><span class="string" id="4086721">&#34;/proc/net/igmp&#34;</span><span class="op" id="4086737">,</span>&nbsp;<span class="ident" id="4086739">ifi</span><span class="op" id="4086742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086745">ifmat6</span>&nbsp;<span class="op" id="4086752">:=</span>&nbsp;<span class="ident" id="4086755">parseProcNetIGMP6</span><span class="op" id="4086772">(</span><span class="string" id="4086773">&#34;/proc/net/igmp6&#34;</span><span class="op" id="4086790">,</span>&nbsp;<span class="ident" id="4086792">ifi</span><span class="op" id="4086795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086798">return</span>&nbsp;<span class="builtinfunc" id="4086805">append</span><span class="op" id="4086811">(</span><span class="ident" id="4086812">ifmat4</span><span class="op" id="4086818">,</span>&nbsp;<span class="ident" id="4086820">ifmat6</span><span class="op" id="4086826">...</span><span class="op" id="4086829">)</span><span class="op" id="4086830">,</span>&nbsp;<span class="ident" id="4086832">nil</span><br>
<span class="lineno">210</span><span class="op" id="4086836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4086839">func</span>&nbsp;<span class="ident" id="4086844">parseProcNetIGMP</span><span class="op" id="4086860">(</span><span class="ident" id="4086861">path</span>&nbsp;<span class="builtintype" id="4086866">string</span><span class="op" id="4086872">,</span>&nbsp;<span class="ident" id="4086874">ifi</span>&nbsp;<span class="op" id="4086878">*</span><span class="ident" id="4086879">Interface</span><span class="op" id="4086888">)</span>&nbsp;<span class="op" id="4086890">[</span><span class="op" id="4086891">]</span><span class="ident" id="4086892">Addr</span>&nbsp;<span class="op" id="4086897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086900">fd</span><span class="op" id="4086902">,</span>&nbsp;<span class="ident" id="4086904">err</span>&nbsp;<span class="op" id="4086908">:=</span>&nbsp;<span class="ident" id="4086911">open</span><span class="op" id="4086915">(</span><span class="ident" id="4086916">path</span><span class="op" id="4086920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086923">if</span>&nbsp;<span class="ident" id="4086926">err</span>&nbsp;<span class="op" id="4086930">!=</span>&nbsp;<span class="ident" id="4086933">nil</span>&nbsp;<span class="op" id="4086937">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086941">return</span>&nbsp;<span class="ident" id="4086948">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086956">defer</span>&nbsp;<span class="ident" id="4086962">fd</span><span class="op" id="4086964">.</span><span class="builtinfunc" id="4086965">close</span><span class="op" id="4086970">(</span><span class="op" id="4086971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086974">var</span>&nbsp;<span class="op" id="4086978">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086982">ifmat</span>&nbsp;<span class="op" id="4086988">[</span><span class="op" id="4086989">]</span><span class="ident" id="4086990">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086997">name</span>&nbsp;&nbsp;<span class="builtintype" id="4087003">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087014">fd</span><span class="op" id="4087016">.</span><span class="ident" id="4087017">readLine</span><span class="op" id="4087025">(</span><span class="op" id="4087026">)</span>&nbsp;<span class="comment" id="4087028">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087048">b</span>&nbsp;<span class="op" id="4087050">:=</span>&nbsp;<span class="builtinfunc" id="4087053">make</span><span class="op" id="4087057">(</span><span class="op" id="4087058">[</span><span class="op" id="4087059">]</span><span class="builtintype" id="4087060">byte</span><span class="op" id="4087064">,</span>&nbsp;<span class="ident" id="4087066">IPv4len</span><span class="op" id="4087073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087076">for</span>&nbsp;<span class="ident" id="4087080">l</span><span class="op" id="4087081">,</span>&nbsp;<span class="ident" id="4087083">ok</span>&nbsp;<span class="op" id="4087086">:=</span>&nbsp;<span class="ident" id="4087089">fd</span><span class="op" id="4087091">.</span><span class="ident" id="4087092">readLine</span><span class="op" id="4087100">(</span><span class="op" id="4087101">)</span><span class="op" id="4087102">;</span>&nbsp;<span class="ident" id="4087104">ok</span><span class="op" id="4087106">;</span>&nbsp;<span class="ident" id="4087108">l</span><span class="op" id="4087109">,</span>&nbsp;<span class="ident" id="4087111">ok</span>&nbsp;<span class="op" id="4087114">=</span>&nbsp;<span class="ident" id="4087116">fd</span><span class="op" id="4087118">.</span><span class="ident" id="4087119">readLine</span><span class="op" id="4087127">(</span><span class="op" id="4087128">)</span>&nbsp;<span class="op" id="4087130">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087134">f</span>&nbsp;<span class="op" id="4087136">:=</span>&nbsp;<span class="ident" id="4087139">splitAtBytes</span><span class="op" id="4087151">(</span><span class="ident" id="4087152">l</span><span class="op" id="4087153">,</span>&nbsp;<span class="string" id="4087155">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="4087165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087169">if</span>&nbsp;<span class="builtinfunc" id="4087172">len</span><span class="op" id="4087175">(</span><span class="ident" id="4087176">f</span><span class="op" id="4087177">)</span>&nbsp;<span class="op" id="4087179">&lt;</span>&nbsp;<span class="num" id="4087181">4</span>&nbsp;<span class="op" id="4087183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087188">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087203">switch</span>&nbsp;<span class="op" id="4087210">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087214">case</span>&nbsp;<span class="ident" id="4087219">l</span><span class="op" id="4087220">[</span><span class="num" id="4087221">0</span><span class="op" id="4087222">]</span>&nbsp;<span class="op" id="4087224">!=</span>&nbsp;<span class="string" id="4087227">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4087231">&amp;&amp;</span>&nbsp;<span class="ident" id="4087234">l</span><span class="op" id="4087235">[</span><span class="num" id="4087236">0</span><span class="op" id="4087237">]</span>&nbsp;<span class="op" id="4087239">!=</span>&nbsp;<span class="string" id="4087242">&#39;\t&#39;</span><span class="op" id="4087246">:</span>&nbsp;<span class="comment" id="4087248">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087273">name</span>&nbsp;<span class="op" id="4087278">=</span>&nbsp;<span class="ident" id="4087280">f</span><span class="op" id="4087281">[</span><span class="num" id="4087282">1</span><span class="op" id="4087283">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087287">case</span>&nbsp;<span class="builtinfunc" id="4087292">len</span><span class="op" id="4087295">(</span><span class="ident" id="4087296">f</span><span class="op" id="4087297">[</span><span class="num" id="4087298">0</span><span class="op" id="4087299">]</span><span class="op" id="4087300">)</span>&nbsp;<span class="op" id="4087302">==</span>&nbsp;<span class="num" id="4087305">8</span><span class="op" id="4087306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087311">if</span>&nbsp;<span class="ident" id="4087314">ifi</span>&nbsp;<span class="op" id="4087318">==</span>&nbsp;<span class="ident" id="4087321">nil</span>&nbsp;<span class="op" id="4087325">||</span>&nbsp;<span class="ident" id="4087328">name</span>&nbsp;<span class="op" id="4087333">==</span>&nbsp;<span class="ident" id="4087336">ifi</span><span class="op" id="4087339">.</span><span class="ident" id="4087340">Name</span>&nbsp;<span class="op" id="4087345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4087351">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4087387">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4087430">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087449">for</span>&nbsp;<span class="ident" id="4087453">i</span>&nbsp;<span class="op" id="4087455">:=</span>&nbsp;<span class="num" id="4087458">0</span><span class="op" id="4087459">;</span>&nbsp;<span class="ident" id="4087461">i</span><span class="op" id="4087462">+</span><span class="num" id="4087463">1</span>&nbsp;<span class="op" id="4087465">&lt;</span>&nbsp;<span class="builtinfunc" id="4087467">len</span><span class="op" id="4087470">(</span><span class="ident" id="4087471">f</span><span class="op" id="4087472">[</span><span class="num" id="4087473">0</span><span class="op" id="4087474">]</span><span class="op" id="4087475">)</span><span class="op" id="4087476">;</span>&nbsp;<span class="ident" id="4087478">i</span>&nbsp;<span class="op" id="4087480">+=</span>&nbsp;<span class="num" id="4087483">2</span>&nbsp;<span class="op" id="4087485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087492">b</span><span class="op" id="4087493">[</span><span class="ident" id="4087494">i</span><span class="op" id="4087495">/</span><span class="num" id="4087496">2</span><span class="op" id="4087497">]</span><span class="op" id="4087498">,</span>&nbsp;<span class="ident" id="4087500">_</span>&nbsp;<span class="op" id="4087502">=</span>&nbsp;<span class="ident" id="4087504">xtoi2</span><span class="op" id="4087509">(</span><span class="ident" id="4087510">f</span><span class="op" id="4087511">[</span><span class="num" id="4087512">0</span><span class="op" id="4087513">]</span><span class="op" id="4087514">[</span><span class="ident" id="4087515">i</span><span class="op" id="4087516">:</span><span class="ident" id="4087517">i</span><span class="op" id="4087518">+</span><span class="num" id="4087519">2</span><span class="op" id="4087520">]</span><span class="op" id="4087521">,</span>&nbsp;<span class="num" id="4087523">0</span><span class="op" id="4087524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087530">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087536">i</span>&nbsp;<span class="op" id="4087538">:=</span>&nbsp;<span class="op" id="4087541">*</span><span class="op" id="4087542">(</span><span class="op" id="4087543">*</span><span class="builtintype" id="4087544">uint32</span><span class="op" id="4087550">)</span><span class="op" id="4087551">(</span><span class="ident" id="4087552">unsafe</span><span class="op" id="4087558">.</span><span class="ident" id="4087559">Pointer</span><span class="op" id="4087566">(</span><span class="op" id="4087567">&amp;</span><span class="ident" id="4087568">b</span><span class="op" id="4087569">[</span><span class="op" id="4087570">:</span><span class="num" id="4087571">4</span><span class="op" id="4087572">]</span><span class="op" id="4087573">[</span><span class="num" id="4087574">0</span><span class="op" id="4087575">]</span><span class="op" id="4087576">)</span><span class="op" id="4087577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087583">ifma</span>&nbsp;<span class="op" id="4087588">:=</span>&nbsp;<span class="ident" id="4087591">IPAddr</span><span class="op" id="4087597">{</span><span class="ident" id="4087598">IP</span><span class="op" id="4087600">:</span>&nbsp;<span class="ident" id="4087602">IPv4</span><span class="op" id="4087606">(</span><span class="builtintype" id="4087607">byte</span><span class="op" id="4087611">(</span><span class="ident" id="4087612">i</span><span class="op" id="4087613">&gt;&gt;</span><span class="num" id="4087615">24</span><span class="op" id="4087617">)</span><span class="op" id="4087618">,</span>&nbsp;<span class="builtintype" id="4087620">byte</span><span class="op" id="4087624">(</span><span class="ident" id="4087625">i</span><span class="op" id="4087626">&gt;&gt;</span><span class="num" id="4087628">16</span><span class="op" id="4087630">)</span><span class="op" id="4087631">,</span>&nbsp;<span class="builtintype" id="4087633">byte</span><span class="op" id="4087637">(</span><span class="ident" id="4087638">i</span><span class="op" id="4087639">&gt;&gt;</span><span class="num" id="4087641">8</span><span class="op" id="4087642">)</span><span class="op" id="4087643">,</span>&nbsp;<span class="builtintype" id="4087645">byte</span><span class="op" id="4087649">(</span><span class="ident" id="4087650">i</span><span class="op" id="4087651">)</span><span class="op" id="4087652">)</span><span class="op" id="4087653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087659">ifmat</span>&nbsp;<span class="op" id="4087665">=</span>&nbsp;<span class="builtinfunc" id="4087667">append</span><span class="op" id="4087673">(</span><span class="ident" id="4087674">ifmat</span><span class="op" id="4087679">,</span>&nbsp;<span class="ident" id="4087681">ifma</span><span class="op" id="4087685">.</span><span class="ident" id="4087686">toAddr</span><span class="op" id="4087692">(</span><span class="op" id="4087693">)</span><span class="op" id="4087694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087703">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087709">return</span>&nbsp;<span class="ident" id="4087716">ifmat</span><br>
<span class="lineno"></span><span class="op" id="4087722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4087725">func</span>&nbsp;<span class="ident" id="4087730">parseProcNetIGMP6</span><span class="op" id="4087747">(</span><span class="ident" id="4087748">path</span>&nbsp;<span class="builtintype" id="4087753">string</span><span class="op" id="4087759">,</span>&nbsp;<span class="ident" id="4087761">ifi</span>&nbsp;<span class="op" id="4087765">*</span><span class="ident" id="4087766">Interface</span><span class="op" id="4087775">)</span>&nbsp;<span class="op" id="4087777">[</span><span class="op" id="4087778">]</span><span class="ident" id="4087779">Addr</span>&nbsp;<span class="op" id="4087784">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087787">fd</span><span class="op" id="4087789">,</span>&nbsp;<span class="ident" id="4087791">err</span>&nbsp;<span class="op" id="4087795">:=</span>&nbsp;<span class="ident" id="4087798">open</span><span class="op" id="4087802">(</span><span class="ident" id="4087803">path</span><span class="op" id="4087807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087810">if</span>&nbsp;<span class="ident" id="4087813">err</span>&nbsp;<span class="op" id="4087817">!=</span>&nbsp;<span class="ident" id="4087820">nil</span>&nbsp;<span class="op" id="4087824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087828">return</span>&nbsp;<span class="ident" id="4087835">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087843">defer</span>&nbsp;<span class="ident" id="4087849">fd</span><span class="op" id="4087851">.</span><span class="builtinfunc" id="4087852">close</span><span class="op" id="4087857">(</span><span class="op" id="4087858">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087861">var</span>&nbsp;<span class="ident" id="4087865">ifmat</span>&nbsp;<span class="op" id="4087871">[</span><span class="op" id="4087872">]</span><span class="ident" id="4087873">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087879">b</span>&nbsp;<span class="op" id="4087881">:=</span>&nbsp;<span class="builtinfunc" id="4087884">make</span><span class="op" id="4087888">(</span><span class="op" id="4087889">[</span><span class="op" id="4087890">]</span><span class="builtintype" id="4087891">byte</span><span class="op" id="4087895">,</span>&nbsp;<span class="ident" id="4087897">IPv6len</span><span class="op" id="4087904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087907">for</span>&nbsp;<span class="ident" id="4087911">l</span><span class="op" id="4087912">,</span>&nbsp;<span class="ident" id="4087914">ok</span>&nbsp;<span class="op" id="4087917">:=</span>&nbsp;<span class="ident" id="4087920">fd</span><span class="op" id="4087922">.</span><span class="ident" id="4087923">readLine</span><span class="op" id="4087931">(</span><span class="op" id="4087932">)</span><span class="op" id="4087933">;</span>&nbsp;<span class="ident" id="4087935">ok</span><span class="op" id="4087937">;</span>&nbsp;<span class="ident" id="4087939">l</span><span class="op" id="4087940">,</span>&nbsp;<span class="ident" id="4087942">ok</span>&nbsp;<span class="op" id="4087945">=</span>&nbsp;<span class="ident" id="4087947">fd</span><span class="op" id="4087949">.</span><span class="ident" id="4087950">readLine</span><span class="op" id="4087958">(</span><span class="op" id="4087959">)</span>&nbsp;<span class="op" id="4087961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087965">f</span>&nbsp;<span class="op" id="4087967">:=</span>&nbsp;<span class="ident" id="4087970">splitAtBytes</span><span class="op" id="4087982">(</span><span class="ident" id="4087983">l</span><span class="op" id="4087984">,</span>&nbsp;<span class="string" id="4087986">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="4087995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087999">if</span>&nbsp;<span class="builtinfunc" id="4088002">len</span><span class="op" id="4088005">(</span><span class="ident" id="4088006">f</span><span class="op" id="4088007">)</span>&nbsp;<span class="op" id="4088009">&lt;</span>&nbsp;<span class="num" id="4088011">6</span>&nbsp;<span class="op" id="4088013">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088018">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088033">if</span>&nbsp;<span class="ident" id="4088036">ifi</span>&nbsp;<span class="op" id="4088040">==</span>&nbsp;<span class="ident" id="4088043">nil</span>&nbsp;<span class="op" id="4088047">||</span>&nbsp;<span class="ident" id="4088050">f</span><span class="op" id="4088051">[</span><span class="num" id="4088052">1</span><span class="op" id="4088053">]</span>&nbsp;<span class="op" id="4088055">==</span>&nbsp;<span class="ident" id="4088058">ifi</span><span class="op" id="4088061">.</span><span class="ident" id="4088062">Name</span>&nbsp;<span class="op" id="4088067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088072">for</span>&nbsp;<span class="ident" id="4088076">i</span>&nbsp;<span class="op" id="4088078">:=</span>&nbsp;<span class="num" id="4088081">0</span><span class="op" id="4088082">;</span>&nbsp;<span class="ident" id="4088084">i</span><span class="op" id="4088085">+</span><span class="num" id="4088086">1</span>&nbsp;<span class="op" id="4088088">&lt;</span>&nbsp;<span class="builtinfunc" id="4088090">len</span><span class="op" id="4088093">(</span><span class="ident" id="4088094">f</span><span class="op" id="4088095">[</span><span class="num" id="4088096">2</span><span class="op" id="4088097">]</span><span class="op" id="4088098">)</span><span class="op" id="4088099">;</span>&nbsp;<span class="ident" id="4088101">i</span>&nbsp;<span class="op" id="4088103">+=</span>&nbsp;<span class="num" id="4088106">2</span>&nbsp;<span class="op" id="4088108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088114">b</span><span class="op" id="4088115">[</span><span class="ident" id="4088116">i</span><span class="op" id="4088117">/</span><span class="num" id="4088118">2</span><span class="op" id="4088119">]</span><span class="op" id="4088120">,</span>&nbsp;<span class="ident" id="4088122">_</span>&nbsp;<span class="op" id="4088124">=</span>&nbsp;<span class="ident" id="4088126">xtoi2</span><span class="op" id="4088131">(</span><span class="ident" id="4088132">f</span><span class="op" id="4088133">[</span><span class="num" id="4088134">2</span><span class="op" id="4088135">]</span><span class="op" id="4088136">[</span><span class="ident" id="4088137">i</span><span class="op" id="4088138">:</span><span class="ident" id="4088139">i</span><span class="op" id="4088140">+</span><span class="num" id="4088141">2</span><span class="op" id="4088142">]</span><span class="op" id="4088143">,</span>&nbsp;<span class="num" id="4088145">0</span><span class="op" id="4088146">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088156">ifma</span>&nbsp;<span class="op" id="4088161">:=</span>&nbsp;<span class="ident" id="4088164">IPAddr</span><span class="op" id="4088170">{</span><span class="ident" id="4088171">IP</span><span class="op" id="4088173">:</span>&nbsp;<span class="ident" id="4088175">IP</span><span class="op" id="4088177">{</span><span class="ident" id="4088178">b</span><span class="op" id="4088179">[</span><span class="num" id="4088180">0</span><span class="op" id="4088181">]</span><span class="op" id="4088182">,</span>&nbsp;<span class="ident" id="4088184">b</span><span class="op" id="4088185">[</span><span class="num" id="4088186">1</span><span class="op" id="4088187">]</span><span class="op" id="4088188">,</span>&nbsp;<span class="ident" id="4088190">b</span><span class="op" id="4088191">[</span><span class="num" id="4088192">2</span><span class="op" id="4088193">]</span><span class="op" id="4088194">,</span>&nbsp;<span class="ident" id="4088196">b</span><span class="op" id="4088197">[</span><span class="num" id="4088198">3</span><span class="op" id="4088199">]</span><span class="op" id="4088200">,</span>&nbsp;<span class="ident" id="4088202">b</span><span class="op" id="4088203">[</span><span class="num" id="4088204">4</span><span class="op" id="4088205">]</span><span class="op" id="4088206">,</span>&nbsp;<span class="ident" id="4088208">b</span><span class="op" id="4088209">[</span><span class="num" id="4088210">5</span><span class="op" id="4088211">]</span><span class="op" id="4088212">,</span>&nbsp;<span class="ident" id="4088214">b</span><span class="op" id="4088215">[</span><span class="num" id="4088216">6</span><span class="op" id="4088217">]</span><span class="op" id="4088218">,</span>&nbsp;<span class="ident" id="4088220">b</span><span class="op" id="4088221">[</span><span class="num" id="4088222">7</span><span class="op" id="4088223">]</span><span class="op" id="4088224">,</span>&nbsp;<span class="ident" id="4088226">b</span><span class="op" id="4088227">[</span><span class="num" id="4088228">8</span><span class="op" id="4088229">]</span><span class="op" id="4088230">,</span>&nbsp;<span class="ident" id="4088232">b</span><span class="op" id="4088233">[</span><span class="num" id="4088234">9</span><span class="op" id="4088235">]</span><span class="op" id="4088236">,</span>&nbsp;<span class="ident" id="4088238">b</span><span class="op" id="4088239">[</span><span class="num" id="4088240">10</span><span class="op" id="4088242">]</span><span class="op" id="4088243">,</span>&nbsp;<span class="ident" id="4088245">b</span><span class="op" id="4088246">[</span><span class="num" id="4088247">11</span><span class="op" id="4088249">]</span><span class="op" id="4088250">,</span>&nbsp;<span class="ident" id="4088252">b</span><span class="op" id="4088253">[</span><span class="num" id="4088254">12</span><span class="op" id="4088256">]</span><span class="op" id="4088257">,</span>&nbsp;<span class="ident" id="4088259">b</span><span class="op" id="4088260">[</span><span class="num" id="4088261">13</span><span class="op" id="4088263">]</span><span class="op" id="4088264">,</span>&nbsp;<span class="ident" id="4088266">b</span><span class="op" id="4088267">[</span><span class="num" id="4088268">14</span><span class="op" id="4088270">]</span><span class="op" id="4088271">,</span>&nbsp;<span class="ident" id="4088273">b</span><span class="op" id="4088274">[</span><span class="num" id="4088275">15</span><span class="op" id="4088277">]</span><span class="op" id="4088278">}</span><span class="op" id="4088279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088284">ifmat</span>&nbsp;<span class="op" id="4088290">=</span>&nbsp;<span class="builtinfunc" id="4088292">append</span><span class="op" id="4088298">(</span><span class="ident" id="4088299">ifmat</span><span class="op" id="4088304">,</span>&nbsp;<span class="ident" id="4088306">ifma</span><span class="op" id="4088310">.</span><span class="ident" id="4088311">toAddr</span><span class="op" id="4088317">(</span><span class="op" id="4088318">)</span><span class="op" id="4088319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088326">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088329">return</span>&nbsp;<span class="ident" id="4088336">ifmat</span><br>
<span class="lineno"></span><span class="op" id="4088342">}</span>
</div>
</body>
</html>
