<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html" class="current">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4068495">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4068550">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4068604">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4068655">package</span>&nbsp;<span class="ident" id="4068663">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4068669">import</span>&nbsp;<span class="op" id="4068676">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4068679">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4068686">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4068691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4068694">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="4068760">type</span>&nbsp;<span class="ident" id="4068765">fileTransport</span>&nbsp;<span class="keyword" id="4068779">struct</span>&nbsp;<span class="op" id="4068786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068789">fh</span>&nbsp;<span class="ident" id="4068792">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="4068804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4068807">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="4068876">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="4068945">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="4069007">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="4069019">//</span><br>
<span class="lineno"></span><span class="comment" id="4069022">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4069093">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="4069130">//</span><br>
<span class="lineno">25</span><span class="comment" id="4069133">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="4069161">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="4069231">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="4069268">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="4069313">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="4069322">func</span>&nbsp;<span class="ident" id="4069327">NewFileTransport</span><span class="op" id="4069343">(</span><span class="ident" id="4069344">fs</span>&nbsp;<span class="ident" id="4069347">FileSystem</span><span class="op" id="4069357">)</span>&nbsp;<span class="ident" id="4069359">RoundTripper</span>&nbsp;<span class="op" id="4069372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069375">return</span>&nbsp;<span class="ident" id="4069382">fileTransport</span><span class="op" id="4069395">{</span><span class="ident" id="4069396">fileHandler</span><span class="op" id="4069407">{</span><span class="ident" id="4069408">fs</span><span class="op" id="4069410">}</span><span class="op" id="4069411">}</span><br>
<span class="lineno"></span><span class="op" id="4069413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4069416">func</span>&nbsp;<span class="op" id="4069421">(</span><span class="ident" id="4069422">t</span>&nbsp;<span class="ident" id="4069424">fileTransport</span><span class="op" id="4069437">)</span>&nbsp;<span class="ident" id="4069439">RoundTrip</span><span class="op" id="4069448">(</span><span class="ident" id="4069449">req</span>&nbsp;<span class="op" id="4069453">*</span><span class="ident" id="4069454">Request</span><span class="op" id="4069461">)</span>&nbsp;<span class="op" id="4069463">(</span><span class="ident" id="4069464">resp</span>&nbsp;<span class="op" id="4069469">*</span><span class="ident" id="4069470">Response</span><span class="op" id="4069478">,</span>&nbsp;<span class="ident" id="4069480">err</span>&nbsp;<span class="builtintype" id="4069484">error</span><span class="op" id="4069489">)</span>&nbsp;<span class="op" id="4069491">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4069494">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4069555">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4069617">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4069679">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4069742">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4069796">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069833">rw</span><span class="op" id="4069835">,</span>&nbsp;<span class="ident" id="4069837">resc</span>&nbsp;<span class="op" id="4069842">:=</span>&nbsp;<span class="ident" id="4069845">newPopulateResponseWriter</span><span class="op" id="4069870">(</span><span class="op" id="4069871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069874">go</span>&nbsp;<span class="keyword" id="4069877">func</span><span class="op" id="4069881">(</span><span class="op" id="4069882">)</span>&nbsp;<span class="op" id="4069884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069888">t</span><span class="op" id="4069889">.</span><span class="ident" id="4069890">fh</span><span class="op" id="4069892">.</span><span class="ident" id="4069893">ServeHTTP</span><span class="op" id="4069902">(</span><span class="ident" id="4069903">rw</span><span class="op" id="4069905">,</span>&nbsp;<span class="ident" id="4069907">req</span><span class="op" id="4069910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069914">rw</span><span class="op" id="4069916">.</span><span class="ident" id="4069917">finish</span><span class="op" id="4069923">(</span><span class="op" id="4069924">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4069927">}</span><span class="op" id="4069928">(</span><span class="op" id="4069929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069932">return</span>&nbsp;<span class="op" id="4069939">&lt;-</span><span class="ident" id="4069941">resc</span><span class="op" id="4069945">,</span>&nbsp;<span class="builtintype" id="4069947">nil</span><br>
<span class="lineno"></span><span class="op" id="4069951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4069954">func</span>&nbsp;<span class="ident" id="4069959">newPopulateResponseWriter</span><span class="op" id="4069984">(</span><span class="op" id="4069985">)</span>&nbsp;<span class="op" id="4069987">(</span><span class="op" id="4069988">*</span><span class="ident" id="4069989">populateResponse</span><span class="op" id="4070005">,</span>&nbsp;<span class="op" id="4070007">&lt;-</span><span class="keyword" id="4070009">chan</span>&nbsp;<span class="op" id="4070014">*</span><span class="ident" id="4070015">Response</span><span class="op" id="4070023">)</span>&nbsp;<span class="op" id="4070025">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070028">pr</span><span class="op" id="4070030">,</span>&nbsp;<span class="ident" id="4070032">pw</span>&nbsp;<span class="op" id="4070035">:=</span>&nbsp;<span class="ident" id="4070038">io</span><span class="op" id="4070040">.</span><span class="ident" id="4070041">Pipe</span><span class="op" id="4070045">(</span><span class="op" id="4070046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070049">rw</span>&nbsp;<span class="op" id="4070052">:=</span>&nbsp;<span class="op" id="4070055">&amp;</span><span class="ident" id="4070056">populateResponse</span><span class="op" id="4070072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070076">ch</span><span class="op" id="4070078">:</span>&nbsp;<span class="builtinfunc" id="4070080">make</span><span class="op" id="4070084">(</span><span class="keyword" id="4070085">chan</span>&nbsp;<span class="op" id="4070090">*</span><span class="ident" id="4070091">Response</span><span class="op" id="4070099">)</span><span class="op" id="4070100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070104">pw</span><span class="op" id="4070106">:</span>&nbsp;<span class="ident" id="4070108">pw</span><span class="op" id="4070110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070114">res</span><span class="op" id="4070117">:</span>&nbsp;<span class="op" id="4070119">&amp;</span><span class="ident" id="4070120">Response</span><span class="op" id="4070128">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070133">Proto</span><span class="op" id="4070138">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4070145">&#34;HTTP/1.0&#34;</span><span class="op" id="4070155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070160">ProtoMajor</span><span class="op" id="4070170">:</span>&nbsp;<span class="num" id="4070172">1</span><span class="op" id="4070173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070178">Header</span><span class="op" id="4070184">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4070190">make</span><span class="op" id="4070194">(</span><span class="ident" id="4070195">Header</span><span class="op" id="4070201">)</span><span class="op" id="4070202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070207">Close</span><span class="op" id="4070212">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4070219">true</span><span class="op" id="4070223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070228">Body</span><span class="op" id="4070232">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070240">pr</span><span class="op" id="4070242">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070246">}</span><span class="op" id="4070247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070253">return</span>&nbsp;<span class="ident" id="4070260">rw</span><span class="op" id="4070262">,</span>&nbsp;<span class="ident" id="4070264">rw</span><span class="op" id="4070266">.</span><span class="ident" id="4070267">ch</span><br>
<span class="lineno"></span><span class="op" id="4070270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="4070273">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="4070342">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="4070409">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="4070480">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="4070490">type</span>&nbsp;<span class="ident" id="4070495">populateResponse</span>&nbsp;<span class="keyword" id="4070512">struct</span>&nbsp;<span class="op" id="4070519">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070522">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070535">*</span><span class="ident" id="4070536">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070546">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070559">chan</span>&nbsp;<span class="op" id="4070564">*</span><span class="ident" id="4070565">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070575">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="4070588">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070594">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4070607">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070613">sentResponse</span>&nbsp;<span class="builtintype" id="4070626">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070632">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070645">*</span><span class="ident" id="4070646">io</span><span class="op" id="4070648">.</span><span class="ident" id="4070649">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="4070660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4070663">func</span>&nbsp;<span class="op" id="4070668">(</span><span class="ident" id="4070669">pr</span>&nbsp;<span class="op" id="4070672">*</span><span class="ident" id="4070673">populateResponse</span><span class="op" id="4070689">)</span>&nbsp;<span class="ident" id="4070691">finish</span><span class="op" id="4070697">(</span><span class="op" id="4070698">)</span>&nbsp;<span class="op" id="4070700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070703">if</span>&nbsp;<span class="op" id="4070706">!</span><span class="ident" id="4070707">pr</span><span class="op" id="4070709">.</span><span class="ident" id="4070710">wroteHeader</span>&nbsp;<span class="op" id="4070722">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070726">pr</span><span class="op" id="4070728">.</span><span class="ident" id="4070729">WriteHeader</span><span class="op" id="4070740">(</span><span class="num" id="4070741">500</span><span class="op" id="4070744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070750">if</span>&nbsp;<span class="op" id="4070753">!</span><span class="ident" id="4070754">pr</span><span class="op" id="4070756">.</span><span class="ident" id="4070757">sentResponse</span>&nbsp;<span class="op" id="4070770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070774">pr</span><span class="op" id="4070776">.</span><span class="ident" id="4070777">sendResponse</span><span class="op" id="4070789">(</span><span class="op" id="4070790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070793">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070796">pr</span><span class="op" id="4070798">.</span><span class="ident" id="4070799">pw</span><span class="op" id="4070801">.</span><span class="ident" id="4070802">Close</span><span class="op" id="4070807">(</span><span class="op" id="4070808">)</span><br>
<span class="lineno"></span><span class="op" id="4070810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4070813">func</span>&nbsp;<span class="op" id="4070818">(</span><span class="ident" id="4070819">pr</span>&nbsp;<span class="op" id="4070822">*</span><span class="ident" id="4070823">populateResponse</span><span class="op" id="4070839">)</span>&nbsp;<span class="ident" id="4070841">sendResponse</span><span class="op" id="4070853">(</span><span class="op" id="4070854">)</span>&nbsp;<span class="op" id="4070856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070859">if</span>&nbsp;<span class="ident" id="4070862">pr</span><span class="op" id="4070864">.</span><span class="ident" id="4070865">sentResponse</span>&nbsp;<span class="op" id="4070878">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070882">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070893">pr</span><span class="op" id="4070895">.</span><span class="ident" id="4070896">sentResponse</span>&nbsp;<span class="op" id="4070909">=</span>&nbsp;<span class="builtintype" id="4070911">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070918">if</span>&nbsp;<span class="ident" id="4070921">pr</span><span class="op" id="4070923">.</span><span class="ident" id="4070924">hasContent</span>&nbsp;<span class="op" id="4070935">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070939">pr</span><span class="op" id="4070941">.</span><span class="ident" id="4070942">res</span><span class="op" id="4070945">.</span><span class="ident" id="4070946">ContentLength</span>&nbsp;<span class="op" id="4070960">=</span>&nbsp;<span class="op" id="4070962">-</span><span class="num" id="4070963">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070969">pr</span><span class="op" id="4070971">.</span><span class="ident" id="4070972">ch</span>&nbsp;<span class="op" id="4070975">&lt;-</span>&nbsp;<span class="ident" id="4070978">pr</span><span class="op" id="4070980">.</span><span class="ident" id="4070981">res</span><br>
<span class="lineno"></span><span class="op" id="4070985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4070988">func</span>&nbsp;<span class="op" id="4070993">(</span><span class="ident" id="4070994">pr</span>&nbsp;<span class="op" id="4070997">*</span><span class="ident" id="4070998">populateResponse</span><span class="op" id="4071014">)</span>&nbsp;<span class="ident" id="4071016">Header</span><span class="op" id="4071022">(</span><span class="op" id="4071023">)</span>&nbsp;<span class="ident" id="4071025">Header</span>&nbsp;<span class="op" id="4071032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071035">return</span>&nbsp;<span class="ident" id="4071042">pr</span><span class="op" id="4071044">.</span><span class="ident" id="4071045">res</span><span class="op" id="4071048">.</span><span class="ident" id="4071049">Header</span><br>
<span class="lineno"></span><span class="op" id="4071056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4071059">func</span>&nbsp;<span class="op" id="4071064">(</span><span class="ident" id="4071065">pr</span>&nbsp;<span class="op" id="4071068">*</span><span class="ident" id="4071069">populateResponse</span><span class="op" id="4071085">)</span>&nbsp;<span class="ident" id="4071087">WriteHeader</span><span class="op" id="4071098">(</span><span class="ident" id="4071099">code</span>&nbsp;<span class="builtintype" id="4071104">int</span><span class="op" id="4071107">)</span>&nbsp;<span class="op" id="4071109">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071112">if</span>&nbsp;<span class="ident" id="4071115">pr</span><span class="op" id="4071117">.</span><span class="ident" id="4071118">wroteHeader</span>&nbsp;<span class="op" id="4071130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071134">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4071142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071145">pr</span><span class="op" id="4071147">.</span><span class="ident" id="4071148">wroteHeader</span>&nbsp;<span class="op" id="4071160">=</span>&nbsp;<span class="builtintype" id="4071162">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071169">pr</span><span class="op" id="4071171">.</span><span class="ident" id="4071172">res</span><span class="op" id="4071175">.</span><span class="ident" id="4071176">StatusCode</span>&nbsp;<span class="op" id="4071187">=</span>&nbsp;<span class="ident" id="4071189">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071195">pr</span><span class="op" id="4071197">.</span><span class="ident" id="4071198">res</span><span class="op" id="4071201">.</span><span class="ident" id="4071202">Status</span>&nbsp;<span class="op" id="4071209">=</span>&nbsp;<span class="ident" id="4071211">fmt</span><span class="op" id="4071214">.</span><span class="ident" id="4071215">Sprintf</span><span class="op" id="4071222">(</span><span class="string" id="4071223">&#34;%d&nbsp;%s&#34;</span><span class="op" id="4071230">,</span>&nbsp;<span class="ident" id="4071232">code</span><span class="op" id="4071236">,</span>&nbsp;<span class="ident" id="4071238">StatusText</span><span class="op" id="4071248">(</span><span class="ident" id="4071249">code</span><span class="op" id="4071253">)</span><span class="op" id="4071254">)</span><br>
<span class="lineno"></span><span class="op" id="4071256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4071259">func</span>&nbsp;<span class="op" id="4071264">(</span><span class="ident" id="4071265">pr</span>&nbsp;<span class="op" id="4071268">*</span><span class="ident" id="4071269">populateResponse</span><span class="op" id="4071285">)</span>&nbsp;<span class="ident" id="4071287">Write</span><span class="op" id="4071292">(</span><span class="ident" id="4071293">p</span>&nbsp;<span class="op" id="4071295">[</span><span class="op" id="4071296">]</span><span class="builtintype" id="4071297">byte</span><span class="op" id="4071301">)</span>&nbsp;<span class="op" id="4071303">(</span><span class="ident" id="4071304">n</span>&nbsp;<span class="builtintype" id="4071306">int</span><span class="op" id="4071309">,</span>&nbsp;<span class="ident" id="4071311">err</span>&nbsp;<span class="builtintype" id="4071315">error</span><span class="op" id="4071320">)</span>&nbsp;<span class="op" id="4071322">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071325">if</span>&nbsp;<span class="op" id="4071328">!</span><span class="ident" id="4071329">pr</span><span class="op" id="4071331">.</span><span class="ident" id="4071332">wroteHeader</span>&nbsp;<span class="op" id="4071344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071348">pr</span><span class="op" id="4071350">.</span><span class="ident" id="4071351">WriteHeader</span><span class="op" id="4071362">(</span><span class="ident" id="4071363">StatusOK</span><span class="op" id="4071371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4071374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071377">pr</span><span class="op" id="4071379">.</span><span class="ident" id="4071380">hasContent</span>&nbsp;<span class="op" id="4071391">=</span>&nbsp;<span class="builtintype" id="4071393">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071399">if</span>&nbsp;<span class="op" id="4071402">!</span><span class="ident" id="4071403">pr</span><span class="op" id="4071405">.</span><span class="ident" id="4071406">sentResponse</span>&nbsp;<span class="op" id="4071419">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071423">pr</span><span class="op" id="4071425">.</span><span class="ident" id="4071426">sendResponse</span><span class="op" id="4071438">(</span><span class="op" id="4071439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4071442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071445">return</span>&nbsp;<span class="ident" id="4071452">pr</span><span class="op" id="4071454">.</span><span class="ident" id="4071455">pw</span><span class="op" id="4071457">.</span><span class="ident" id="4071458">Write</span><span class="op" id="4071463">(</span><span class="ident" id="4071464">p</span><span class="op" id="4071465">)</span><br>
<span class="lineno"></span><span class="op" id="4071467">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
