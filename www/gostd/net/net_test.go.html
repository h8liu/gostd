<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html" class="current">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6737227">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6737282">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6737336">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6737387">package</span>&nbsp;<span class="ident" id="6737395">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6737400">import</span>&nbsp;<span class="op" id="6737407">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737410">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737416">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737429">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737435">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737446">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737457">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6737464">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6737467">func</span>&nbsp;<span class="ident" id="6737472">TestShutdown</span><span class="op" id="6737484">(</span><span class="ident" id="6737485">t</span>&nbsp;<span class="op" id="6737487">*</span><span class="ident" id="6737488">testing</span><span class="op" id="6737495">.</span><span class="ident" id="6737496">T</span><span class="op" id="6737497">)</span>&nbsp;<span class="op" id="6737499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737502">if</span>&nbsp;<span class="ident" id="6737505">runtime</span><span class="op" id="6737512">.</span><span class="ident" id="6737513">GOOS</span>&nbsp;<span class="op" id="6737518">==</span>&nbsp;<span class="string" id="6737521">&#34;plan9&#34;</span>&nbsp;<span class="op" id="6737529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737533">t</span><span class="op" id="6737534">.</span><span class="ident" id="6737535">Skipf</span><span class="op" id="6737540">(</span><span class="string" id="6737541">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6737562">,</span>&nbsp;<span class="ident" id="6737564">runtime</span><span class="op" id="6737571">.</span><span class="ident" id="6737572">GOOS</span><span class="op" id="6737576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6737579">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737582">ln</span><span class="op" id="6737584">,</span>&nbsp;<span class="ident" id="6737586">err</span>&nbsp;<span class="op" id="6737590">:=</span>&nbsp;<span class="ident" id="6737593">Listen</span><span class="op" id="6737599">(</span><span class="string" id="6737600">&#34;tcp&#34;</span><span class="op" id="6737605">,</span>&nbsp;<span class="string" id="6737607">&#34;127.0.0.1:0&#34;</span><span class="op" id="6737620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737623">if</span>&nbsp;<span class="ident" id="6737626">err</span>&nbsp;<span class="op" id="6737630">!=</span>&nbsp;<span class="builtintype" id="6737633">nil</span>&nbsp;<span class="op" id="6737637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737641">if</span>&nbsp;<span class="ident" id="6737644">ln</span><span class="op" id="6737646">,</span>&nbsp;<span class="ident" id="6737648">err</span>&nbsp;<span class="op" id="6737652">=</span>&nbsp;<span class="ident" id="6737654">Listen</span><span class="op" id="6737660">(</span><span class="string" id="6737661">&#34;tcp6&#34;</span><span class="op" id="6737667">,</span>&nbsp;<span class="string" id="6737669">&#34;[::1]:0&#34;</span><span class="op" id="6737678">)</span><span class="op" id="6737679">;</span>&nbsp;<span class="ident" id="6737681">err</span>&nbsp;<span class="op" id="6737685">!=</span>&nbsp;<span class="builtintype" id="6737688">nil</span>&nbsp;<span class="op" id="6737692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737697">t</span><span class="op" id="6737698">.</span><span class="ident" id="6737699">Fatalf</span><span class="op" id="6737705">(</span><span class="string" id="6737706">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="6737727">,</span>&nbsp;<span class="ident" id="6737729">err</span><span class="op" id="6737732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6737736">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6737739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737743">go</span>&nbsp;<span class="keyword" id="6737746">func</span><span class="op" id="6737750">(</span><span class="op" id="6737751">)</span>&nbsp;<span class="op" id="6737753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737757">defer</span>&nbsp;<span class="ident" id="6737763">ln</span><span class="op" id="6737765">.</span><span class="ident" id="6737766">Close</span><span class="op" id="6737771">(</span><span class="op" id="6737772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737776">c</span><span class="op" id="6737777">,</span>&nbsp;<span class="ident" id="6737779">err</span>&nbsp;<span class="op" id="6737783">:=</span>&nbsp;<span class="ident" id="6737786">ln</span><span class="op" id="6737788">.</span><span class="ident" id="6737789">Accept</span><span class="op" id="6737795">(</span><span class="op" id="6737796">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737800">if</span>&nbsp;<span class="ident" id="6737803">err</span>&nbsp;<span class="op" id="6737807">!=</span>&nbsp;<span class="builtintype" id="6737810">nil</span>&nbsp;<span class="op" id="6737814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737819">t</span><span class="op" id="6737820">.</span><span class="ident" id="6737821">Errorf</span><span class="op" id="6737827">(</span><span class="string" id="6737828">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6737840">,</span>&nbsp;<span class="ident" id="6737842">err</span><span class="op" id="6737845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737850">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6737859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737863">var</span>&nbsp;<span class="ident" id="6737867">buf</span>&nbsp;<span class="op" id="6737871">[</span><span class="num" id="6737872">10</span><span class="op" id="6737874">]</span><span class="builtintype" id="6737875">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737882">n</span><span class="op" id="6737883">,</span>&nbsp;<span class="ident" id="6737885">err</span>&nbsp;<span class="op" id="6737889">:=</span>&nbsp;<span class="ident" id="6737892">c</span><span class="op" id="6737893">.</span><span class="ident" id="6737894">Read</span><span class="op" id="6737898">(</span><span class="ident" id="6737899">buf</span><span class="op" id="6737902">[</span><span class="op" id="6737903">:</span><span class="op" id="6737904">]</span><span class="op" id="6737905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737909">if</span>&nbsp;<span class="ident" id="6737912">n</span>&nbsp;<span class="op" id="6737914">!=</span>&nbsp;<span class="num" id="6737917">0</span>&nbsp;<span class="op" id="6737919">||</span>&nbsp;<span class="ident" id="6737922">err</span>&nbsp;<span class="op" id="6737926">!=</span>&nbsp;<span class="ident" id="6737929">io</span><span class="op" id="6737931">.</span><span class="ident" id="6737932">EOF</span>&nbsp;<span class="op" id="6737936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737941">t</span><span class="op" id="6737942">.</span><span class="ident" id="6737943">Errorf</span><span class="op" id="6737949">(</span><span class="string" id="6737950">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6737988">,</span>&nbsp;<span class="ident" id="6737990">n</span><span class="op" id="6737991">,</span>&nbsp;<span class="ident" id="6737993">err</span><span class="op" id="6737996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738001">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738010">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738014">c</span><span class="op" id="6738015">.</span><span class="ident" id="6738016">Write</span><span class="op" id="6738021">(</span><span class="op" id="6738022">[</span><span class="op" id="6738023">]</span><span class="builtintype" id="6738024">byte</span><span class="op" id="6738028">(</span><span class="string" id="6738029">&#34;response&#34;</span><span class="op" id="6738039">)</span><span class="op" id="6738040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738044">c</span><span class="op" id="6738045">.</span><span class="ident" id="6738046">Close</span><span class="op" id="6738051">(</span><span class="op" id="6738052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738055">}</span><span class="op" id="6738056">(</span><span class="op" id="6738057">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738061">c</span><span class="op" id="6738062">,</span>&nbsp;<span class="ident" id="6738064">err</span>&nbsp;<span class="op" id="6738068">:=</span>&nbsp;<span class="ident" id="6738071">Dial</span><span class="op" id="6738075">(</span><span class="string" id="6738076">&#34;tcp&#34;</span><span class="op" id="6738081">,</span>&nbsp;<span class="ident" id="6738083">ln</span><span class="op" id="6738085">.</span><span class="ident" id="6738086">Addr</span><span class="op" id="6738090">(</span><span class="op" id="6738091">)</span><span class="op" id="6738092">.</span><span class="ident" id="6738093">String</span><span class="op" id="6738099">(</span><span class="op" id="6738100">)</span><span class="op" id="6738101">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738104">if</span>&nbsp;<span class="ident" id="6738107">err</span>&nbsp;<span class="op" id="6738111">!=</span>&nbsp;<span class="builtintype" id="6738114">nil</span>&nbsp;<span class="op" id="6738118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738122">t</span><span class="op" id="6738123">.</span><span class="ident" id="6738124">Fatalf</span><span class="op" id="6738130">(</span><span class="string" id="6738131">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6738141">,</span>&nbsp;<span class="ident" id="6738143">err</span><span class="op" id="6738146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738152">defer</span>&nbsp;<span class="ident" id="6738158">c</span><span class="op" id="6738159">.</span><span class="ident" id="6738160">Close</span><span class="op" id="6738165">(</span><span class="op" id="6738166">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738170">err</span>&nbsp;<span class="op" id="6738174">=</span>&nbsp;<span class="ident" id="6738176">c</span><span class="op" id="6738177">.</span><span class="op" id="6738178">(</span><span class="op" id="6738179">*</span><span class="ident" id="6738180">TCPConn</span><span class="op" id="6738187">)</span><span class="op" id="6738188">.</span><span class="ident" id="6738189">CloseWrite</span><span class="op" id="6738199">(</span><span class="op" id="6738200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738203">if</span>&nbsp;<span class="ident" id="6738206">err</span>&nbsp;<span class="op" id="6738210">!=</span>&nbsp;<span class="builtintype" id="6738213">nil</span>&nbsp;<span class="op" id="6738217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738221">t</span><span class="op" id="6738222">.</span><span class="ident" id="6738223">Fatalf</span><span class="op" id="6738229">(</span><span class="string" id="6738230">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6738246">,</span>&nbsp;<span class="ident" id="6738248">err</span><span class="op" id="6738251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738257">var</span>&nbsp;<span class="ident" id="6738261">buf</span>&nbsp;<span class="op" id="6738265">[</span><span class="num" id="6738266">10</span><span class="op" id="6738268">]</span><span class="builtintype" id="6738269">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738275">n</span><span class="op" id="6738276">,</span>&nbsp;<span class="ident" id="6738278">err</span>&nbsp;<span class="op" id="6738282">:=</span>&nbsp;<span class="ident" id="6738285">c</span><span class="op" id="6738286">.</span><span class="ident" id="6738287">Read</span><span class="op" id="6738291">(</span><span class="ident" id="6738292">buf</span><span class="op" id="6738295">[</span><span class="op" id="6738296">:</span><span class="op" id="6738297">]</span><span class="op" id="6738298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738301">if</span>&nbsp;<span class="ident" id="6738304">err</span>&nbsp;<span class="op" id="6738308">!=</span>&nbsp;<span class="builtintype" id="6738311">nil</span>&nbsp;<span class="op" id="6738315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738319">t</span><span class="op" id="6738320">.</span><span class="ident" id="6738321">Fatalf</span><span class="op" id="6738327">(</span><span class="string" id="6738328">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6738349">,</span>&nbsp;<span class="ident" id="6738351">n</span><span class="op" id="6738352">,</span>&nbsp;<span class="ident" id="6738354">err</span><span class="op" id="6738357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738363">got</span>&nbsp;<span class="op" id="6738367">:=</span>&nbsp;<span class="builtintype" id="6738370">string</span><span class="op" id="6738376">(</span><span class="ident" id="6738377">buf</span><span class="op" id="6738380">[</span><span class="op" id="6738381">:</span><span class="ident" id="6738382">n</span><span class="op" id="6738383">]</span><span class="op" id="6738384">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738387">if</span>&nbsp;<span class="ident" id="6738390">got</span>&nbsp;<span class="op" id="6738394">!=</span>&nbsp;<span class="string" id="6738397">&#34;response&#34;</span>&nbsp;<span class="op" id="6738408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738412">t</span><span class="op" id="6738413">.</span><span class="ident" id="6738414">Errorf</span><span class="op" id="6738420">(</span><span class="string" id="6738421">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6738451">,</span>&nbsp;<span class="ident" id="6738453">got</span><span class="op" id="6738456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738459">}</span><br>
<span class="lineno"></span><span class="op" id="6738461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6738464">func</span>&nbsp;<span class="ident" id="6738469">TestShutdownUnix</span><span class="op" id="6738485">(</span><span class="ident" id="6738486">t</span>&nbsp;<span class="op" id="6738488">*</span><span class="ident" id="6738489">testing</span><span class="op" id="6738496">.</span><span class="ident" id="6738497">T</span><span class="op" id="6738498">)</span>&nbsp;<span class="op" id="6738500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738503">switch</span>&nbsp;<span class="ident" id="6738510">runtime</span><span class="op" id="6738517">.</span><span class="ident" id="6738518">GOOS</span>&nbsp;<span class="op" id="6738523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738526">case</span>&nbsp;<span class="string" id="6738531">&#34;nacl&#34;</span><span class="op" id="6738537">,</span>&nbsp;<span class="string" id="6738539">&#34;plan9&#34;</span><span class="op" id="6738546">,</span>&nbsp;<span class="string" id="6738548">&#34;windows&#34;</span><span class="op" id="6738557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738561">t</span><span class="op" id="6738562">.</span><span class="ident" id="6738563">Skipf</span><span class="op" id="6738568">(</span><span class="string" id="6738569">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6738590">,</span>&nbsp;<span class="ident" id="6738592">runtime</span><span class="op" id="6738599">.</span><span class="ident" id="6738600">GOOS</span><span class="op" id="6738604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738607">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738610">f</span><span class="op" id="6738611">,</span>&nbsp;<span class="ident" id="6738613">err</span>&nbsp;<span class="op" id="6738617">:=</span>&nbsp;<span class="ident" id="6738620">ioutil</span><span class="op" id="6738626">.</span><span class="ident" id="6738627">TempFile</span><span class="op" id="6738635">(</span><span class="string" id="6738636">&#34;&#34;</span><span class="op" id="6738638">,</span>&nbsp;<span class="string" id="6738640">&#34;go_net_unixtest&#34;</span><span class="op" id="6738657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738660">if</span>&nbsp;<span class="ident" id="6738663">err</span>&nbsp;<span class="op" id="6738667">!=</span>&nbsp;<span class="builtintype" id="6738670">nil</span>&nbsp;<span class="op" id="6738674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738678">t</span><span class="op" id="6738679">.</span><span class="ident" id="6738680">Fatalf</span><span class="op" id="6738686">(</span><span class="string" id="6738687">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="6738701">,</span>&nbsp;<span class="ident" id="6738703">err</span><span class="op" id="6738706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738712">f</span><span class="op" id="6738713">.</span><span class="ident" id="6738714">Close</span><span class="op" id="6738719">(</span><span class="op" id="6738720">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738723">tmpname</span>&nbsp;<span class="op" id="6738731">:=</span>&nbsp;<span class="ident" id="6738734">f</span><span class="op" id="6738735">.</span><span class="ident" id="6738736">Name</span><span class="op" id="6738740">(</span><span class="op" id="6738741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738744">os</span><span class="op" id="6738746">.</span><span class="ident" id="6738747">Remove</span><span class="op" id="6738753">(</span><span class="ident" id="6738754">tmpname</span><span class="op" id="6738761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738764">ln</span><span class="op" id="6738766">,</span>&nbsp;<span class="ident" id="6738768">err</span>&nbsp;<span class="op" id="6738772">:=</span>&nbsp;<span class="ident" id="6738775">Listen</span><span class="op" id="6738781">(</span><span class="string" id="6738782">&#34;unix&#34;</span><span class="op" id="6738788">,</span>&nbsp;<span class="ident" id="6738790">tmpname</span><span class="op" id="6738797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738800">if</span>&nbsp;<span class="ident" id="6738803">err</span>&nbsp;<span class="op" id="6738807">!=</span>&nbsp;<span class="builtintype" id="6738810">nil</span>&nbsp;<span class="op" id="6738814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738818">t</span><span class="op" id="6738819">.</span><span class="ident" id="6738820">Fatalf</span><span class="op" id="6738826">(</span><span class="string" id="6738827">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="6738849">,</span>&nbsp;<span class="ident" id="6738851">tmpname</span><span class="op" id="6738858">,</span>&nbsp;<span class="ident" id="6738860">err</span><span class="op" id="6738863">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738869">defer</span>&nbsp;<span class="keyword" id="6738875">func</span><span class="op" id="6738879">(</span><span class="op" id="6738880">)</span>&nbsp;<span class="op" id="6738882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738886">ln</span><span class="op" id="6738888">.</span><span class="ident" id="6738889">Close</span><span class="op" id="6738894">(</span><span class="op" id="6738895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738899">os</span><span class="op" id="6738901">.</span><span class="ident" id="6738902">Remove</span><span class="op" id="6738908">(</span><span class="ident" id="6738909">tmpname</span><span class="op" id="6738916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738919">}</span><span class="op" id="6738920">(</span><span class="op" id="6738921">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738925">go</span>&nbsp;<span class="keyword" id="6738928">func</span><span class="op" id="6738932">(</span><span class="op" id="6738933">)</span>&nbsp;<span class="op" id="6738935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738939">c</span><span class="op" id="6738940">,</span>&nbsp;<span class="ident" id="6738942">err</span>&nbsp;<span class="op" id="6738946">:=</span>&nbsp;<span class="ident" id="6738949">ln</span><span class="op" id="6738951">.</span><span class="ident" id="6738952">Accept</span><span class="op" id="6738958">(</span><span class="op" id="6738959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738963">if</span>&nbsp;<span class="ident" id="6738966">err</span>&nbsp;<span class="op" id="6738970">!=</span>&nbsp;<span class="builtintype" id="6738973">nil</span>&nbsp;<span class="op" id="6738977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738982">t</span><span class="op" id="6738983">.</span><span class="ident" id="6738984">Errorf</span><span class="op" id="6738990">(</span><span class="string" id="6738991">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6739003">,</span>&nbsp;<span class="ident" id="6739005">err</span><span class="op" id="6739008">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739013">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739026">var</span>&nbsp;<span class="ident" id="6739030">buf</span>&nbsp;<span class="op" id="6739034">[</span><span class="num" id="6739035">10</span><span class="op" id="6739037">]</span><span class="builtintype" id="6739038">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739045">n</span><span class="op" id="6739046">,</span>&nbsp;<span class="ident" id="6739048">err</span>&nbsp;<span class="op" id="6739052">:=</span>&nbsp;<span class="ident" id="6739055">c</span><span class="op" id="6739056">.</span><span class="ident" id="6739057">Read</span><span class="op" id="6739061">(</span><span class="ident" id="6739062">buf</span><span class="op" id="6739065">[</span><span class="op" id="6739066">:</span><span class="op" id="6739067">]</span><span class="op" id="6739068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739072">if</span>&nbsp;<span class="ident" id="6739075">n</span>&nbsp;<span class="op" id="6739077">!=</span>&nbsp;<span class="num" id="6739080">0</span>&nbsp;<span class="op" id="6739082">||</span>&nbsp;<span class="ident" id="6739085">err</span>&nbsp;<span class="op" id="6739089">!=</span>&nbsp;<span class="ident" id="6739092">io</span><span class="op" id="6739094">.</span><span class="ident" id="6739095">EOF</span>&nbsp;<span class="op" id="6739099">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739104">t</span><span class="op" id="6739105">.</span><span class="ident" id="6739106">Errorf</span><span class="op" id="6739112">(</span><span class="string" id="6739113">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6739151">,</span>&nbsp;<span class="ident" id="6739153">n</span><span class="op" id="6739154">,</span>&nbsp;<span class="ident" id="6739156">err</span><span class="op" id="6739159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739164">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739177">c</span><span class="op" id="6739178">.</span><span class="ident" id="6739179">Write</span><span class="op" id="6739184">(</span><span class="op" id="6739185">[</span><span class="op" id="6739186">]</span><span class="builtintype" id="6739187">byte</span><span class="op" id="6739191">(</span><span class="string" id="6739192">&#34;response&#34;</span><span class="op" id="6739202">)</span><span class="op" id="6739203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739207">c</span><span class="op" id="6739208">.</span><span class="ident" id="6739209">Close</span><span class="op" id="6739214">(</span><span class="op" id="6739215">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739218">}</span><span class="op" id="6739219">(</span><span class="op" id="6739220">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739224">c</span><span class="op" id="6739225">,</span>&nbsp;<span class="ident" id="6739227">err</span>&nbsp;<span class="op" id="6739231">:=</span>&nbsp;<span class="ident" id="6739234">Dial</span><span class="op" id="6739238">(</span><span class="string" id="6739239">&#34;unix&#34;</span><span class="op" id="6739245">,</span>&nbsp;<span class="ident" id="6739247">tmpname</span><span class="op" id="6739254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739257">if</span>&nbsp;<span class="ident" id="6739260">err</span>&nbsp;<span class="op" id="6739264">!=</span>&nbsp;<span class="builtintype" id="6739267">nil</span>&nbsp;<span class="op" id="6739271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739275">t</span><span class="op" id="6739276">.</span><span class="ident" id="6739277">Fatalf</span><span class="op" id="6739283">(</span><span class="string" id="6739284">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6739294">,</span>&nbsp;<span class="ident" id="6739296">err</span><span class="op" id="6739299">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739305">defer</span>&nbsp;<span class="ident" id="6739311">c</span><span class="op" id="6739312">.</span><span class="ident" id="6739313">Close</span><span class="op" id="6739318">(</span><span class="op" id="6739319">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739323">err</span>&nbsp;<span class="op" id="6739327">=</span>&nbsp;<span class="ident" id="6739329">c</span><span class="op" id="6739330">.</span><span class="op" id="6739331">(</span><span class="op" id="6739332">*</span><span class="ident" id="6739333">UnixConn</span><span class="op" id="6739341">)</span><span class="op" id="6739342">.</span><span class="ident" id="6739343">CloseWrite</span><span class="op" id="6739353">(</span><span class="op" id="6739354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739357">if</span>&nbsp;<span class="ident" id="6739360">err</span>&nbsp;<span class="op" id="6739364">!=</span>&nbsp;<span class="builtintype" id="6739367">nil</span>&nbsp;<span class="op" id="6739371">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739375">t</span><span class="op" id="6739376">.</span><span class="ident" id="6739377">Fatalf</span><span class="op" id="6739383">(</span><span class="string" id="6739384">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6739400">,</span>&nbsp;<span class="ident" id="6739402">err</span><span class="op" id="6739405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739411">var</span>&nbsp;<span class="ident" id="6739415">buf</span>&nbsp;<span class="op" id="6739419">[</span><span class="num" id="6739420">10</span><span class="op" id="6739422">]</span><span class="builtintype" id="6739423">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739429">n</span><span class="op" id="6739430">,</span>&nbsp;<span class="ident" id="6739432">err</span>&nbsp;<span class="op" id="6739436">:=</span>&nbsp;<span class="ident" id="6739439">c</span><span class="op" id="6739440">.</span><span class="ident" id="6739441">Read</span><span class="op" id="6739445">(</span><span class="ident" id="6739446">buf</span><span class="op" id="6739449">[</span><span class="op" id="6739450">:</span><span class="op" id="6739451">]</span><span class="op" id="6739452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739455">if</span>&nbsp;<span class="ident" id="6739458">err</span>&nbsp;<span class="op" id="6739462">!=</span>&nbsp;<span class="builtintype" id="6739465">nil</span>&nbsp;<span class="op" id="6739469">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739473">t</span><span class="op" id="6739474">.</span><span class="ident" id="6739475">Fatalf</span><span class="op" id="6739481">(</span><span class="string" id="6739482">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6739503">,</span>&nbsp;<span class="ident" id="6739505">n</span><span class="op" id="6739506">,</span>&nbsp;<span class="ident" id="6739508">err</span><span class="op" id="6739511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739517">got</span>&nbsp;<span class="op" id="6739521">:=</span>&nbsp;<span class="builtintype" id="6739524">string</span><span class="op" id="6739530">(</span><span class="ident" id="6739531">buf</span><span class="op" id="6739534">[</span><span class="op" id="6739535">:</span><span class="ident" id="6739536">n</span><span class="op" id="6739537">]</span><span class="op" id="6739538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739541">if</span>&nbsp;<span class="ident" id="6739544">got</span>&nbsp;<span class="op" id="6739548">!=</span>&nbsp;<span class="string" id="6739551">&#34;response&#34;</span>&nbsp;<span class="op" id="6739562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739566">t</span><span class="op" id="6739567">.</span><span class="ident" id="6739568">Errorf</span><span class="op" id="6739574">(</span><span class="string" id="6739575">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6739605">,</span>&nbsp;<span class="ident" id="6739607">got</span><span class="op" id="6739610">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739613">}</span><br>
<span class="lineno"></span><span class="op" id="6739615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6739618">func</span>&nbsp;<span class="ident" id="6739623">TestTCPListenClose</span><span class="op" id="6739641">(</span><span class="ident" id="6739642">t</span>&nbsp;<span class="op" id="6739644">*</span><span class="ident" id="6739645">testing</span><span class="op" id="6739652">.</span><span class="ident" id="6739653">T</span><span class="op" id="6739654">)</span>&nbsp;<span class="op" id="6739656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739659">ln</span><span class="op" id="6739661">,</span>&nbsp;<span class="ident" id="6739663">err</span>&nbsp;<span class="op" id="6739667">:=</span>&nbsp;<span class="ident" id="6739670">Listen</span><span class="op" id="6739676">(</span><span class="string" id="6739677">&#34;tcp&#34;</span><span class="op" id="6739682">,</span>&nbsp;<span class="string" id="6739684">&#34;127.0.0.1:0&#34;</span><span class="op" id="6739697">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739700">if</span>&nbsp;<span class="ident" id="6739703">err</span>&nbsp;<span class="op" id="6739707">!=</span>&nbsp;<span class="builtintype" id="6739710">nil</span>&nbsp;<span class="op" id="6739714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739718">t</span><span class="op" id="6739719">.</span><span class="ident" id="6739720">Fatalf</span><span class="op" id="6739726">(</span><span class="string" id="6739727">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6739746">,</span>&nbsp;<span class="ident" id="6739748">err</span><span class="op" id="6739751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739758">done</span>&nbsp;<span class="op" id="6739763">:=</span>&nbsp;<span class="builtinfunc" id="6739766">make</span><span class="op" id="6739770">(</span><span class="keyword" id="6739771">chan</span>&nbsp;<span class="builtintype" id="6739776">bool</span><span class="op" id="6739780">,</span>&nbsp;<span class="num" id="6739782">1</span><span class="op" id="6739783">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739786">go</span>&nbsp;<span class="keyword" id="6739789">func</span><span class="op" id="6739793">(</span><span class="op" id="6739794">)</span>&nbsp;<span class="op" id="6739796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739800">time</span><span class="op" id="6739804">.</span><span class="ident" id="6739805">Sleep</span><span class="op" id="6739810">(</span><span class="num" id="6739811">100</span>&nbsp;<span class="op" id="6739815">*</span>&nbsp;<span class="ident" id="6739817">time</span><span class="op" id="6739821">.</span><span class="ident" id="6739822">Millisecond</span><span class="op" id="6739833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739837">ln</span><span class="op" id="6739839">.</span><span class="ident" id="6739840">Close</span><span class="op" id="6739845">(</span><span class="op" id="6739846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739849">}</span><span class="op" id="6739850">(</span><span class="op" id="6739851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739854">go</span>&nbsp;<span class="keyword" id="6739857">func</span><span class="op" id="6739861">(</span><span class="op" id="6739862">)</span>&nbsp;<span class="op" id="6739864">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739868">c</span><span class="op" id="6739869">,</span>&nbsp;<span class="ident" id="6739871">err</span>&nbsp;<span class="op" id="6739875">:=</span>&nbsp;<span class="ident" id="6739878">ln</span><span class="op" id="6739880">.</span><span class="ident" id="6739881">Accept</span><span class="op" id="6739887">(</span><span class="op" id="6739888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739892">if</span>&nbsp;<span class="ident" id="6739895">err</span>&nbsp;<span class="op" id="6739899">==</span>&nbsp;<span class="builtintype" id="6739902">nil</span>&nbsp;<span class="op" id="6739906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739911">c</span><span class="op" id="6739912">.</span><span class="ident" id="6739913">Close</span><span class="op" id="6739918">(</span><span class="op" id="6739919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739924">t</span><span class="op" id="6739925">.</span><span class="ident" id="6739926">Error</span><span class="op" id="6739931">(</span><span class="string" id="6739932">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="6739950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739954">}</span>&nbsp;<span class="keyword" id="6739956">else</span>&nbsp;<span class="op" id="6739961">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739966">t</span><span class="op" id="6739967">.</span><span class="ident" id="6739968">Logf</span><span class="op" id="6739972">(</span><span class="string" id="6739973">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6740019">,</span>&nbsp;<span class="ident" id="6740021">err</span><span class="op" id="6740024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740032">done</span>&nbsp;<span class="op" id="6740037">&lt;-</span>&nbsp;<span class="builtintype" id="6740040">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740046">}</span><span class="op" id="6740047">(</span><span class="op" id="6740048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740051">select</span>&nbsp;<span class="op" id="6740058">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740061">case</span>&nbsp;<span class="op" id="6740066">&lt;-</span><span class="ident" id="6740068">done</span><span class="op" id="6740072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740075">case</span>&nbsp;<span class="op" id="6740080">&lt;-</span><span class="ident" id="6740082">time</span><span class="op" id="6740086">.</span><span class="ident" id="6740087">After</span><span class="op" id="6740092">(</span><span class="num" id="6740093">2</span>&nbsp;<span class="op" id="6740095">*</span>&nbsp;<span class="ident" id="6740097">time</span><span class="op" id="6740101">.</span><span class="ident" id="6740102">Second</span><span class="op" id="6740108">)</span><span class="op" id="6740109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740113">t</span><span class="op" id="6740114">.</span><span class="ident" id="6740115">Fatal</span><span class="op" id="6740120">(</span><span class="string" id="6740121">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="6740152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740155">}</span><br>
<span class="lineno"></span><span class="op" id="6740157">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6740160">func</span>&nbsp;<span class="ident" id="6740165">TestUDPListenClose</span><span class="op" id="6740183">(</span><span class="ident" id="6740184">t</span>&nbsp;<span class="op" id="6740186">*</span><span class="ident" id="6740187">testing</span><span class="op" id="6740194">.</span><span class="ident" id="6740195">T</span><span class="op" id="6740196">)</span>&nbsp;<span class="op" id="6740198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740201">switch</span>&nbsp;<span class="ident" id="6740208">runtime</span><span class="op" id="6740215">.</span><span class="ident" id="6740216">GOOS</span>&nbsp;<span class="op" id="6740221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740224">case</span>&nbsp;<span class="string" id="6740229">&#34;plan9&#34;</span><span class="op" id="6740236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740240">t</span><span class="op" id="6740241">.</span><span class="ident" id="6740242">Skipf</span><span class="op" id="6740247">(</span><span class="string" id="6740248">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6740269">,</span>&nbsp;<span class="ident" id="6740271">runtime</span><span class="op" id="6740278">.</span><span class="ident" id="6740279">GOOS</span><span class="op" id="6740283">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740289">ln</span><span class="op" id="6740291">,</span>&nbsp;<span class="ident" id="6740293">err</span>&nbsp;<span class="op" id="6740297">:=</span>&nbsp;<span class="ident" id="6740300">ListenPacket</span><span class="op" id="6740312">(</span><span class="string" id="6740313">&#34;udp&#34;</span><span class="op" id="6740318">,</span>&nbsp;<span class="string" id="6740320">&#34;127.0.0.1:0&#34;</span><span class="op" id="6740333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740336">if</span>&nbsp;<span class="ident" id="6740339">err</span>&nbsp;<span class="op" id="6740343">!=</span>&nbsp;<span class="builtintype" id="6740346">nil</span>&nbsp;<span class="op" id="6740350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740354">t</span><span class="op" id="6740355">.</span><span class="ident" id="6740356">Fatalf</span><span class="op" id="6740362">(</span><span class="string" id="6740363">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6740382">,</span>&nbsp;<span class="ident" id="6740384">err</span><span class="op" id="6740387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740390">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740394">buf</span>&nbsp;<span class="op" id="6740398">:=</span>&nbsp;<span class="builtinfunc" id="6740401">make</span><span class="op" id="6740405">(</span><span class="op" id="6740406">[</span><span class="op" id="6740407">]</span><span class="builtintype" id="6740408">byte</span><span class="op" id="6740412">,</span>&nbsp;<span class="num" id="6740414">1000</span><span class="op" id="6740418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740421">done</span>&nbsp;<span class="op" id="6740426">:=</span>&nbsp;<span class="builtinfunc" id="6740429">make</span><span class="op" id="6740433">(</span><span class="keyword" id="6740434">chan</span>&nbsp;<span class="builtintype" id="6740439">bool</span><span class="op" id="6740443">,</span>&nbsp;<span class="num" id="6740445">1</span><span class="op" id="6740446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740449">go</span>&nbsp;<span class="keyword" id="6740452">func</span><span class="op" id="6740456">(</span><span class="op" id="6740457">)</span>&nbsp;<span class="op" id="6740459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740463">time</span><span class="op" id="6740467">.</span><span class="ident" id="6740468">Sleep</span><span class="op" id="6740473">(</span><span class="num" id="6740474">100</span>&nbsp;<span class="op" id="6740478">*</span>&nbsp;<span class="ident" id="6740480">time</span><span class="op" id="6740484">.</span><span class="ident" id="6740485">Millisecond</span><span class="op" id="6740496">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740500">ln</span><span class="op" id="6740502">.</span><span class="ident" id="6740503">Close</span><span class="op" id="6740508">(</span><span class="op" id="6740509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740512">}</span><span class="op" id="6740513">(</span><span class="op" id="6740514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740517">go</span>&nbsp;<span class="keyword" id="6740520">func</span><span class="op" id="6740524">(</span><span class="op" id="6740525">)</span>&nbsp;<span class="op" id="6740527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740531">_</span><span class="op" id="6740532">,</span>&nbsp;<span class="ident" id="6740534">_</span><span class="op" id="6740535">,</span>&nbsp;<span class="ident" id="6740537">err</span>&nbsp;<span class="op" id="6740541">=</span>&nbsp;<span class="ident" id="6740543">ln</span><span class="op" id="6740545">.</span><span class="ident" id="6740546">ReadFrom</span><span class="op" id="6740554">(</span><span class="ident" id="6740555">buf</span><span class="op" id="6740558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740562">if</span>&nbsp;<span class="ident" id="6740565">err</span>&nbsp;<span class="op" id="6740569">==</span>&nbsp;<span class="builtintype" id="6740572">nil</span>&nbsp;<span class="op" id="6740576">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740581">t</span><span class="op" id="6740582">.</span><span class="ident" id="6740583">Error</span><span class="op" id="6740588">(</span><span class="string" id="6740589">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="6740609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740613">}</span>&nbsp;<span class="keyword" id="6740615">else</span>&nbsp;<span class="op" id="6740620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740625">t</span><span class="op" id="6740626">.</span><span class="ident" id="6740627">Logf</span><span class="op" id="6740631">(</span><span class="string" id="6740632">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6740680">,</span>&nbsp;<span class="ident" id="6740682">err</span><span class="op" id="6740685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740693">done</span>&nbsp;<span class="op" id="6740698">&lt;-</span>&nbsp;<span class="builtintype" id="6740701">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740707">}</span><span class="op" id="6740708">(</span><span class="op" id="6740709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740712">select</span>&nbsp;<span class="op" id="6740719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740722">case</span>&nbsp;<span class="op" id="6740727">&lt;-</span><span class="ident" id="6740729">done</span><span class="op" id="6740733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740736">case</span>&nbsp;<span class="op" id="6740741">&lt;-</span><span class="ident" id="6740743">time</span><span class="op" id="6740747">.</span><span class="ident" id="6740748">After</span><span class="op" id="6740753">(</span><span class="num" id="6740754">2</span>&nbsp;<span class="op" id="6740756">*</span>&nbsp;<span class="ident" id="6740758">time</span><span class="op" id="6740762">.</span><span class="ident" id="6740763">Second</span><span class="op" id="6740769">)</span><span class="op" id="6740770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740774">t</span><span class="op" id="6740775">.</span><span class="ident" id="6740776">Fatal</span><span class="op" id="6740781">(</span><span class="string" id="6740782">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="6740813">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740816">}</span><br>
<span class="lineno"></span><span class="op" id="6740818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6740821">func</span>&nbsp;<span class="ident" id="6740826">TestTCPClose</span><span class="op" id="6740838">(</span><span class="ident" id="6740839">t</span>&nbsp;<span class="op" id="6740841">*</span><span class="ident" id="6740842">testing</span><span class="op" id="6740849">.</span><span class="ident" id="6740850">T</span><span class="op" id="6740851">)</span>&nbsp;<span class="op" id="6740853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740856">switch</span>&nbsp;<span class="ident" id="6740863">runtime</span><span class="op" id="6740870">.</span><span class="ident" id="6740871">GOOS</span>&nbsp;<span class="op" id="6740876">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740879">case</span>&nbsp;<span class="string" id="6740884">&#34;plan9&#34;</span><span class="op" id="6740891">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740895">t</span><span class="op" id="6740896">.</span><span class="ident" id="6740897">Skipf</span><span class="op" id="6740902">(</span><span class="string" id="6740903">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6740924">,</span>&nbsp;<span class="ident" id="6740926">runtime</span><span class="op" id="6740933">.</span><span class="ident" id="6740934">GOOS</span><span class="op" id="6740938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740944">l</span><span class="op" id="6740945">,</span>&nbsp;<span class="ident" id="6740947">err</span>&nbsp;<span class="op" id="6740951">:=</span>&nbsp;<span class="ident" id="6740954">Listen</span><span class="op" id="6740960">(</span><span class="string" id="6740961">&#34;tcp&#34;</span><span class="op" id="6740966">,</span>&nbsp;<span class="string" id="6740968">&#34;127.0.0.1:0&#34;</span><span class="op" id="6740981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740984">if</span>&nbsp;<span class="ident" id="6740987">err</span>&nbsp;<span class="op" id="6740991">!=</span>&nbsp;<span class="builtintype" id="6740994">nil</span>&nbsp;<span class="op" id="6740998">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741002">t</span><span class="op" id="6741003">.</span><span class="ident" id="6741004">Fatal</span><span class="op" id="6741009">(</span><span class="ident" id="6741010">err</span><span class="op" id="6741013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741019">defer</span>&nbsp;<span class="ident" id="6741025">l</span><span class="op" id="6741026">.</span><span class="ident" id="6741027">Close</span><span class="op" id="6741032">(</span><span class="op" id="6741033">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741037">read</span>&nbsp;<span class="op" id="6741042">:=</span>&nbsp;<span class="keyword" id="6741045">func</span><span class="op" id="6741049">(</span><span class="ident" id="6741050">r</span>&nbsp;<span class="ident" id="6741052">io</span><span class="op" id="6741054">.</span><span class="ident" id="6741055">Reader</span><span class="op" id="6741061">)</span>&nbsp;<span class="builtintype" id="6741063">error</span>&nbsp;<span class="op" id="6741069">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741073">var</span>&nbsp;<span class="ident" id="6741077">m</span>&nbsp;<span class="op" id="6741079">[</span><span class="num" id="6741080">1</span><span class="op" id="6741081">]</span><span class="builtintype" id="6741082">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741089">_</span><span class="op" id="6741090">,</span>&nbsp;<span class="ident" id="6741092">err</span>&nbsp;<span class="op" id="6741096">:=</span>&nbsp;<span class="ident" id="6741099">r</span><span class="op" id="6741100">.</span><span class="ident" id="6741101">Read</span><span class="op" id="6741105">(</span><span class="ident" id="6741106">m</span><span class="op" id="6741107">[</span><span class="op" id="6741108">:</span><span class="op" id="6741109">]</span><span class="op" id="6741110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741114">return</span>&nbsp;<span class="ident" id="6741121">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741130">go</span>&nbsp;<span class="keyword" id="6741133">func</span><span class="op" id="6741137">(</span><span class="op" id="6741138">)</span>&nbsp;<span class="op" id="6741140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741144">c</span><span class="op" id="6741145">,</span>&nbsp;<span class="ident" id="6741147">err</span>&nbsp;<span class="op" id="6741151">:=</span>&nbsp;<span class="ident" id="6741154">Dial</span><span class="op" id="6741158">(</span><span class="string" id="6741159">&#34;tcp&#34;</span><span class="op" id="6741164">,</span>&nbsp;<span class="ident" id="6741166">l</span><span class="op" id="6741167">.</span><span class="ident" id="6741168">Addr</span><span class="op" id="6741172">(</span><span class="op" id="6741173">)</span><span class="op" id="6741174">.</span><span class="ident" id="6741175">String</span><span class="op" id="6741181">(</span><span class="op" id="6741182">)</span><span class="op" id="6741183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741187">if</span>&nbsp;<span class="ident" id="6741190">err</span>&nbsp;<span class="op" id="6741194">!=</span>&nbsp;<span class="builtintype" id="6741197">nil</span>&nbsp;<span class="op" id="6741201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741206">t</span><span class="op" id="6741207">.</span><span class="ident" id="6741208">Errorf</span><span class="op" id="6741214">(</span><span class="string" id="6741215">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6741225">,</span>&nbsp;<span class="ident" id="6741227">err</span><span class="op" id="6741230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741235">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741249">go</span>&nbsp;<span class="ident" id="6741252">read</span><span class="op" id="6741256">(</span><span class="ident" id="6741257">c</span><span class="op" id="6741258">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741263">time</span><span class="op" id="6741267">.</span><span class="ident" id="6741268">Sleep</span><span class="op" id="6741273">(</span><span class="num" id="6741274">10</span>&nbsp;<span class="op" id="6741277">*</span>&nbsp;<span class="ident" id="6741279">time</span><span class="op" id="6741283">.</span><span class="ident" id="6741284">Millisecond</span><span class="op" id="6741295">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741299">c</span><span class="op" id="6741300">.</span><span class="ident" id="6741301">Close</span><span class="op" id="6741306">(</span><span class="op" id="6741307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741310">}</span><span class="op" id="6741311">(</span><span class="op" id="6741312">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741316">c</span><span class="op" id="6741317">,</span>&nbsp;<span class="ident" id="6741319">err</span>&nbsp;<span class="op" id="6741323">:=</span>&nbsp;<span class="ident" id="6741326">l</span><span class="op" id="6741327">.</span><span class="ident" id="6741328">Accept</span><span class="op" id="6741334">(</span><span class="op" id="6741335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741338">if</span>&nbsp;<span class="ident" id="6741341">err</span>&nbsp;<span class="op" id="6741345">!=</span>&nbsp;<span class="builtintype" id="6741348">nil</span>&nbsp;<span class="op" id="6741352">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741356">t</span><span class="op" id="6741357">.</span><span class="ident" id="6741358">Fatal</span><span class="op" id="6741363">(</span><span class="ident" id="6741364">err</span><span class="op" id="6741367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741373">defer</span>&nbsp;<span class="ident" id="6741379">c</span><span class="op" id="6741380">.</span><span class="ident" id="6741381">Close</span><span class="op" id="6741386">(</span><span class="op" id="6741387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741391">for</span>&nbsp;<span class="ident" id="6741395">err</span>&nbsp;<span class="op" id="6741399">==</span>&nbsp;<span class="builtintype" id="6741402">nil</span>&nbsp;<span class="op" id="6741406">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741410">err</span>&nbsp;<span class="op" id="6741414">=</span>&nbsp;<span class="ident" id="6741416">read</span><span class="op" id="6741420">(</span><span class="ident" id="6741421">c</span><span class="op" id="6741422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741428">if</span>&nbsp;<span class="ident" id="6741431">err</span>&nbsp;<span class="op" id="6741435">!=</span>&nbsp;<span class="builtintype" id="6741438">nil</span>&nbsp;<span class="op" id="6741442">&amp;&amp;</span>&nbsp;<span class="ident" id="6741445">err</span>&nbsp;<span class="op" id="6741449">!=</span>&nbsp;<span class="ident" id="6741452">io</span><span class="op" id="6741454">.</span><span class="ident" id="6741455">EOF</span>&nbsp;<span class="op" id="6741459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741463">t</span><span class="op" id="6741464">.</span><span class="ident" id="6741465">Fatal</span><span class="op" id="6741470">(</span><span class="ident" id="6741471">err</span><span class="op" id="6741474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741477">}</span><br>
<span class="lineno">225</span><span class="op" id="6741479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6741482">func</span>&nbsp;<span class="ident" id="6741487">TestErrorNil</span><span class="op" id="6741499">(</span><span class="ident" id="6741500">t</span>&nbsp;<span class="op" id="6741502">*</span><span class="ident" id="6741503">testing</span><span class="op" id="6741510">.</span><span class="ident" id="6741511">T</span><span class="op" id="6741512">)</span>&nbsp;<span class="op" id="6741514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741517">c</span><span class="op" id="6741518">,</span>&nbsp;<span class="ident" id="6741520">err</span>&nbsp;<span class="op" id="6741524">:=</span>&nbsp;<span class="ident" id="6741527">Dial</span><span class="op" id="6741531">(</span><span class="string" id="6741532">&#34;tcp&#34;</span><span class="op" id="6741537">,</span>&nbsp;<span class="string" id="6741539">&#34;127.0.0.1:65535&#34;</span><span class="op" id="6741556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741559">if</span>&nbsp;<span class="ident" id="6741562">err</span>&nbsp;<span class="op" id="6741566">==</span>&nbsp;<span class="builtintype" id="6741569">nil</span>&nbsp;<span class="op" id="6741573">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741577">t</span><span class="op" id="6741578">.</span><span class="ident" id="6741579">Fatal</span><span class="op" id="6741584">(</span><span class="string" id="6741585">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="6741617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741623">if</span>&nbsp;<span class="ident" id="6741626">c</span>&nbsp;<span class="op" id="6741628">!=</span>&nbsp;<span class="builtintype" id="6741631">nil</span>&nbsp;<span class="op" id="6741635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741639">t</span><span class="op" id="6741640">.</span><span class="ident" id="6741641">Fatalf</span><span class="op" id="6741647">(</span><span class="string" id="6741648">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6741704">,</span>&nbsp;<span class="ident" id="6741706">c</span><span class="op" id="6741707">,</span>&nbsp;<span class="ident" id="6741709">c</span><span class="op" id="6741710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741713">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6741717">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741774">l</span><span class="op" id="6741775">,</span>&nbsp;<span class="ident" id="6741777">err</span>&nbsp;<span class="op" id="6741781">:=</span>&nbsp;<span class="ident" id="6741784">Listen</span><span class="op" id="6741790">(</span><span class="string" id="6741791">&#34;tcp&#34;</span><span class="op" id="6741796">,</span>&nbsp;<span class="string" id="6741798">&#34;127.0.0.1:0&#34;</span><span class="op" id="6741811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741814">if</span>&nbsp;<span class="ident" id="6741817">err</span>&nbsp;<span class="op" id="6741821">!=</span>&nbsp;<span class="builtintype" id="6741824">nil</span>&nbsp;<span class="op" id="6741828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741832">t</span><span class="op" id="6741833">.</span><span class="ident" id="6741834">Fatalf</span><span class="op" id="6741840">(</span><span class="string" id="6741841">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6741865">,</span>&nbsp;<span class="ident" id="6741867">err</span><span class="op" id="6741870">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741876">defer</span>&nbsp;<span class="ident" id="6741882">l</span><span class="op" id="6741883">.</span><span class="ident" id="6741884">Close</span><span class="op" id="6741889">(</span><span class="op" id="6741890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741893">l1</span><span class="op" id="6741895">,</span>&nbsp;<span class="ident" id="6741897">err</span>&nbsp;<span class="op" id="6741901">:=</span>&nbsp;<span class="ident" id="6741904">Listen</span><span class="op" id="6741910">(</span><span class="string" id="6741911">&#34;tcp&#34;</span><span class="op" id="6741916">,</span>&nbsp;<span class="ident" id="6741918">l</span><span class="op" id="6741919">.</span><span class="ident" id="6741920">Addr</span><span class="op" id="6741924">(</span><span class="op" id="6741925">)</span><span class="op" id="6741926">.</span><span class="ident" id="6741927">String</span><span class="op" id="6741933">(</span><span class="op" id="6741934">)</span><span class="op" id="6741935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741938">if</span>&nbsp;<span class="ident" id="6741941">err</span>&nbsp;<span class="op" id="6741945">==</span>&nbsp;<span class="builtintype" id="6741948">nil</span>&nbsp;<span class="op" id="6741952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741956">t</span><span class="op" id="6741957">.</span><span class="ident" id="6741958">Fatalf</span><span class="op" id="6741964">(</span><span class="string" id="6741965">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6741987">,</span>&nbsp;<span class="ident" id="6741989">l</span><span class="op" id="6741990">.</span><span class="ident" id="6741991">Addr</span><span class="op" id="6741995">(</span><span class="op" id="6741996">)</span><span class="op" id="6741997">,</span>&nbsp;<span class="ident" id="6741999">err</span><span class="op" id="6742002">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742008">if</span>&nbsp;<span class="ident" id="6742011">l1</span>&nbsp;<span class="op" id="6742014">!=</span>&nbsp;<span class="builtintype" id="6742017">nil</span>&nbsp;<span class="op" id="6742021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742025">t</span><span class="op" id="6742026">.</span><span class="ident" id="6742027">Fatalf</span><span class="op" id="6742033">(</span><span class="string" id="6742034">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6742092">,</span>&nbsp;<span class="ident" id="6742094">l1</span><span class="op" id="6742096">,</span>&nbsp;<span class="ident" id="6742098">l1</span><span class="op" id="6742100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6742107">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742170">lp</span><span class="op" id="6742172">,</span>&nbsp;<span class="ident" id="6742174">err</span>&nbsp;<span class="op" id="6742178">:=</span>&nbsp;<span class="ident" id="6742181">ListenPacket</span><span class="op" id="6742193">(</span><span class="string" id="6742194">&#34;udp&#34;</span><span class="op" id="6742199">,</span>&nbsp;<span class="string" id="6742201">&#34;127.0.0.1:0&#34;</span><span class="op" id="6742214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742217">if</span>&nbsp;<span class="ident" id="6742220">err</span>&nbsp;<span class="op" id="6742224">!=</span>&nbsp;<span class="builtintype" id="6742227">nil</span>&nbsp;<span class="op" id="6742231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742235">t</span><span class="op" id="6742236">.</span><span class="ident" id="6742237">Fatalf</span><span class="op" id="6742243">(</span><span class="string" id="6742244">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6742268">,</span>&nbsp;<span class="ident" id="6742270">err</span><span class="op" id="6742273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742276">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742279">defer</span>&nbsp;<span class="ident" id="6742285">lp</span><span class="op" id="6742287">.</span><span class="ident" id="6742288">Close</span><span class="op" id="6742293">(</span><span class="op" id="6742294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742297">lp1</span><span class="op" id="6742300">,</span>&nbsp;<span class="ident" id="6742302">err</span>&nbsp;<span class="op" id="6742306">:=</span>&nbsp;<span class="ident" id="6742309">ListenPacket</span><span class="op" id="6742321">(</span><span class="string" id="6742322">&#34;udp&#34;</span><span class="op" id="6742327">,</span>&nbsp;<span class="ident" id="6742329">lp</span><span class="op" id="6742331">.</span><span class="ident" id="6742332">LocalAddr</span><span class="op" id="6742341">(</span><span class="op" id="6742342">)</span><span class="op" id="6742343">.</span><span class="ident" id="6742344">String</span><span class="op" id="6742350">(</span><span class="op" id="6742351">)</span><span class="op" id="6742352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742355">if</span>&nbsp;<span class="ident" id="6742358">err</span>&nbsp;<span class="op" id="6742362">==</span>&nbsp;<span class="builtintype" id="6742365">nil</span>&nbsp;<span class="op" id="6742369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742373">t</span><span class="op" id="6742374">.</span><span class="ident" id="6742375">Fatalf</span><span class="op" id="6742381">(</span><span class="string" id="6742382">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6742404">,</span>&nbsp;<span class="ident" id="6742406">lp</span><span class="op" id="6742408">.</span><span class="ident" id="6742409">LocalAddr</span><span class="op" id="6742418">(</span><span class="op" id="6742419">)</span><span class="op" id="6742420">,</span>&nbsp;<span class="ident" id="6742422">err</span><span class="op" id="6742425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742428">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742431">if</span>&nbsp;<span class="ident" id="6742434">lp1</span>&nbsp;<span class="op" id="6742438">!=</span>&nbsp;<span class="builtintype" id="6742441">nil</span>&nbsp;<span class="op" id="6742445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742449">t</span><span class="op" id="6742450">.</span><span class="ident" id="6742451">Fatalf</span><span class="op" id="6742457">(</span><span class="string" id="6742458">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6742522">,</span>&nbsp;<span class="ident" id="6742524">lp1</span><span class="op" id="6742527">,</span>&nbsp;<span class="ident" id="6742529">lp1</span><span class="op" id="6742532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742535">}</span><br>
<span class="lineno"></span><span class="op" id="6742537">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
