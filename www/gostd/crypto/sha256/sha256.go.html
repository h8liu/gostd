<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4536534">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4536589">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4536643">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4536694">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4536772">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4536790">package</span>&nbsp;<span class="ident" id="4536798">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4536806">import</span>&nbsp;<span class="op" id="4536813">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4536816">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4536826">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4536833">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4536836">func</span>&nbsp;<span class="ident" id="4536841">init</span><span class="op" id="4536845">(</span><span class="op" id="4536846">)</span>&nbsp;<span class="op" id="4536848">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536851">crypto</span><span class="op" id="4536857">.</span><span class="ident" id="4536858">RegisterHash</span><span class="op" id="4536870">(</span><span class="ident" id="4536871">crypto</span><span class="op" id="4536877">.</span><span class="ident" id="4536878">SHA224</span><span class="op" id="4536884">,</span>&nbsp;<span class="ident" id="4536886">New224</span><span class="op" id="4536892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536895">crypto</span><span class="op" id="4536901">.</span><span class="ident" id="4536902">RegisterHash</span><span class="op" id="4536914">(</span><span class="ident" id="4536915">crypto</span><span class="op" id="4536921">.</span><span class="ident" id="4536922">SHA256</span><span class="op" id="4536928">,</span>&nbsp;<span class="ident" id="4536930">New</span><span class="op" id="4536933">)</span><br>
<span class="lineno"></span><span class="op" id="4536935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4536938">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4536981">const</span>&nbsp;<span class="ident" id="4536987">Size</span>&nbsp;<span class="op" id="4536992">=</span>&nbsp;<span class="num" id="4536994">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4536998">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4537041">const</span>&nbsp;<span class="ident" id="4537047">Size224</span>&nbsp;<span class="op" id="4537055">=</span>&nbsp;<span class="num" id="4537057">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4537061">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4537109">const</span>&nbsp;<span class="ident" id="4537115">BlockSize</span>&nbsp;<span class="op" id="4537125">=</span>&nbsp;<span class="num" id="4537127">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4537131">const</span>&nbsp;<span class="op" id="4537137">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537140">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537150">=</span>&nbsp;<span class="num" id="4537152">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537156">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537166">=</span>&nbsp;<span class="num" id="4537168">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537180">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537190">=</span>&nbsp;<span class="num" id="4537192">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537204">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537214">=</span>&nbsp;<span class="num" id="4537216">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537228">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537238">=</span>&nbsp;<span class="num" id="4537240">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537252">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537262">=</span>&nbsp;<span class="num" id="4537264">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537276">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537286">=</span>&nbsp;<span class="num" id="4537288">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537300">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537310">=</span>&nbsp;<span class="num" id="4537312">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537324">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537334">=</span>&nbsp;<span class="num" id="4537336">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537348">init0_224</span>&nbsp;<span class="op" id="4537358">=</span>&nbsp;<span class="num" id="4537360">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537372">init1_224</span>&nbsp;<span class="op" id="4537382">=</span>&nbsp;<span class="num" id="4537384">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537396">init2_224</span>&nbsp;<span class="op" id="4537406">=</span>&nbsp;<span class="num" id="4537408">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537420">init3_224</span>&nbsp;<span class="op" id="4537430">=</span>&nbsp;<span class="num" id="4537432">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537444">init4_224</span>&nbsp;<span class="op" id="4537454">=</span>&nbsp;<span class="num" id="4537456">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537468">init5_224</span>&nbsp;<span class="op" id="4537478">=</span>&nbsp;<span class="num" id="4537480">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537492">init6_224</span>&nbsp;<span class="op" id="4537502">=</span>&nbsp;<span class="num" id="4537504">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537516">init7_224</span>&nbsp;<span class="op" id="4537526">=</span>&nbsp;<span class="num" id="4537528">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4537539">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4537542">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4537601">type</span>&nbsp;<span class="ident" id="4537606">digest</span>&nbsp;<span class="keyword" id="4537613">struct</span>&nbsp;<span class="op" id="4537620">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537623">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537629">[</span><span class="num" id="4537630">8</span><span class="op" id="4537631">]</span><span class="builtintype" id="4537632">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537640">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4537646">[</span><span class="ident" id="4537647">chunk</span><span class="op" id="4537652">]</span><span class="builtintype" id="4537653">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537659">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4537665">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4537670">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4537676">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537684">is224</span>&nbsp;<span class="builtintype" id="4537690">bool</span>&nbsp;<span class="comment" id="4537695">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4537729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4537732">func</span>&nbsp;<span class="op" id="4537737">(</span><span class="ident" id="4537738">d</span>&nbsp;<span class="op" id="4537740">*</span><span class="ident" id="4537741">digest</span><span class="op" id="4537747">)</span>&nbsp;<span class="ident" id="4537749">Reset</span><span class="op" id="4537754">(</span><span class="op" id="4537755">)</span>&nbsp;<span class="op" id="4537757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537760">if</span>&nbsp;<span class="op" id="4537763">!</span><span class="ident" id="4537764">d</span><span class="op" id="4537765">.</span><span class="ident" id="4537766">is224</span>&nbsp;<span class="op" id="4537772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537776">d</span><span class="op" id="4537777">.</span><span class="ident" id="4537778">h</span><span class="op" id="4537779">[</span><span class="num" id="4537780">0</span><span class="op" id="4537781">]</span>&nbsp;<span class="op" id="4537783">=</span>&nbsp;<span class="ident" id="4537785">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537793">d</span><span class="op" id="4537794">.</span><span class="ident" id="4537795">h</span><span class="op" id="4537796">[</span><span class="num" id="4537797">1</span><span class="op" id="4537798">]</span>&nbsp;<span class="op" id="4537800">=</span>&nbsp;<span class="ident" id="4537802">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537810">d</span><span class="op" id="4537811">.</span><span class="ident" id="4537812">h</span><span class="op" id="4537813">[</span><span class="num" id="4537814">2</span><span class="op" id="4537815">]</span>&nbsp;<span class="op" id="4537817">=</span>&nbsp;<span class="ident" id="4537819">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537827">d</span><span class="op" id="4537828">.</span><span class="ident" id="4537829">h</span><span class="op" id="4537830">[</span><span class="num" id="4537831">3</span><span class="op" id="4537832">]</span>&nbsp;<span class="op" id="4537834">=</span>&nbsp;<span class="ident" id="4537836">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537844">d</span><span class="op" id="4537845">.</span><span class="ident" id="4537846">h</span><span class="op" id="4537847">[</span><span class="num" id="4537848">4</span><span class="op" id="4537849">]</span>&nbsp;<span class="op" id="4537851">=</span>&nbsp;<span class="ident" id="4537853">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537861">d</span><span class="op" id="4537862">.</span><span class="ident" id="4537863">h</span><span class="op" id="4537864">[</span><span class="num" id="4537865">5</span><span class="op" id="4537866">]</span>&nbsp;<span class="op" id="4537868">=</span>&nbsp;<span class="ident" id="4537870">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537878">d</span><span class="op" id="4537879">.</span><span class="ident" id="4537880">h</span><span class="op" id="4537881">[</span><span class="num" id="4537882">6</span><span class="op" id="4537883">]</span>&nbsp;<span class="op" id="4537885">=</span>&nbsp;<span class="ident" id="4537887">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537895">d</span><span class="op" id="4537896">.</span><span class="ident" id="4537897">h</span><span class="op" id="4537898">[</span><span class="num" id="4537899">7</span><span class="op" id="4537900">]</span>&nbsp;<span class="op" id="4537902">=</span>&nbsp;<span class="ident" id="4537904">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537911">}</span>&nbsp;<span class="keyword" id="4537913">else</span>&nbsp;<span class="op" id="4537918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537922">d</span><span class="op" id="4537923">.</span><span class="ident" id="4537924">h</span><span class="op" id="4537925">[</span><span class="num" id="4537926">0</span><span class="op" id="4537927">]</span>&nbsp;<span class="op" id="4537929">=</span>&nbsp;<span class="ident" id="4537931">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537943">d</span><span class="op" id="4537944">.</span><span class="ident" id="4537945">h</span><span class="op" id="4537946">[</span><span class="num" id="4537947">1</span><span class="op" id="4537948">]</span>&nbsp;<span class="op" id="4537950">=</span>&nbsp;<span class="ident" id="4537952">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537964">d</span><span class="op" id="4537965">.</span><span class="ident" id="4537966">h</span><span class="op" id="4537967">[</span><span class="num" id="4537968">2</span><span class="op" id="4537969">]</span>&nbsp;<span class="op" id="4537971">=</span>&nbsp;<span class="ident" id="4537973">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537985">d</span><span class="op" id="4537986">.</span><span class="ident" id="4537987">h</span><span class="op" id="4537988">[</span><span class="num" id="4537989">3</span><span class="op" id="4537990">]</span>&nbsp;<span class="op" id="4537992">=</span>&nbsp;<span class="ident" id="4537994">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538006">d</span><span class="op" id="4538007">.</span><span class="ident" id="4538008">h</span><span class="op" id="4538009">[</span><span class="num" id="4538010">4</span><span class="op" id="4538011">]</span>&nbsp;<span class="op" id="4538013">=</span>&nbsp;<span class="ident" id="4538015">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538027">d</span><span class="op" id="4538028">.</span><span class="ident" id="4538029">h</span><span class="op" id="4538030">[</span><span class="num" id="4538031">5</span><span class="op" id="4538032">]</span>&nbsp;<span class="op" id="4538034">=</span>&nbsp;<span class="ident" id="4538036">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538048">d</span><span class="op" id="4538049">.</span><span class="ident" id="4538050">h</span><span class="op" id="4538051">[</span><span class="num" id="4538052">6</span><span class="op" id="4538053">]</span>&nbsp;<span class="op" id="4538055">=</span>&nbsp;<span class="ident" id="4538057">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538069">d</span><span class="op" id="4538070">.</span><span class="ident" id="4538071">h</span><span class="op" id="4538072">[</span><span class="num" id="4538073">7</span><span class="op" id="4538074">]</span>&nbsp;<span class="op" id="4538076">=</span>&nbsp;<span class="ident" id="4538078">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538092">d</span><span class="op" id="4538093">.</span><span class="ident" id="4538094">nx</span>&nbsp;<span class="op" id="4538097">=</span>&nbsp;<span class="num" id="4538099">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538102">d</span><span class="op" id="4538103">.</span><span class="builtinfunc" id="4538104">len</span>&nbsp;<span class="op" id="4538108">=</span>&nbsp;<span class="num" id="4538110">0</span><br>
<span class="lineno"></span><span class="op" id="4538112">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4538115">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4538177">func</span>&nbsp;<span class="ident" id="4538182">New</span><span class="op" id="4538185">(</span><span class="op" id="4538186">)</span>&nbsp;<span class="ident" id="4538188">hash</span><span class="op" id="4538192">.</span><span class="ident" id="4538193">Hash</span>&nbsp;<span class="op" id="4538198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538201">d</span>&nbsp;<span class="op" id="4538203">:=</span>&nbsp;<span class="builtinfunc" id="4538206">new</span><span class="op" id="4538209">(</span><span class="ident" id="4538210">digest</span><span class="op" id="4538216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538219">d</span><span class="op" id="4538220">.</span><span class="ident" id="4538221">Reset</span><span class="op" id="4538226">(</span><span class="op" id="4538227">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538230">return</span>&nbsp;<span class="ident" id="4538237">d</span><br>
<span class="lineno"></span><span class="op" id="4538239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4538242">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4538307">func</span>&nbsp;<span class="ident" id="4538312">New224</span><span class="op" id="4538318">(</span><span class="op" id="4538319">)</span>&nbsp;<span class="ident" id="4538321">hash</span><span class="op" id="4538325">.</span><span class="ident" id="4538326">Hash</span>&nbsp;<span class="op" id="4538331">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538334">d</span>&nbsp;<span class="op" id="4538336">:=</span>&nbsp;<span class="builtinfunc" id="4538339">new</span><span class="op" id="4538342">(</span><span class="ident" id="4538343">digest</span><span class="op" id="4538349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538352">d</span><span class="op" id="4538353">.</span><span class="ident" id="4538354">is224</span>&nbsp;<span class="op" id="4538360">=</span>&nbsp;<span class="builtintype" id="4538362">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538368">d</span><span class="op" id="4538369">.</span><span class="ident" id="4538370">Reset</span><span class="op" id="4538375">(</span><span class="op" id="4538376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538379">return</span>&nbsp;<span class="ident" id="4538386">d</span><br>
<span class="lineno"></span><span class="op" id="4538388">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4538391">func</span>&nbsp;<span class="op" id="4538396">(</span><span class="ident" id="4538397">d</span>&nbsp;<span class="op" id="4538399">*</span><span class="ident" id="4538400">digest</span><span class="op" id="4538406">)</span>&nbsp;<span class="ident" id="4538408">Size</span><span class="op" id="4538412">(</span><span class="op" id="4538413">)</span>&nbsp;<span class="builtintype" id="4538415">int</span>&nbsp;<span class="op" id="4538419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538422">if</span>&nbsp;<span class="op" id="4538425">!</span><span class="ident" id="4538426">d</span><span class="op" id="4538427">.</span><span class="ident" id="4538428">is224</span>&nbsp;<span class="op" id="4538434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538438">return</span>&nbsp;<span class="ident" id="4538445">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538451">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538454">return</span>&nbsp;<span class="ident" id="4538461">Size224</span><br>
<span class="lineno"></span><span class="op" id="4538469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4538472">func</span>&nbsp;<span class="op" id="4538477">(</span><span class="ident" id="4538478">d</span>&nbsp;<span class="op" id="4538480">*</span><span class="ident" id="4538481">digest</span><span class="op" id="4538487">)</span>&nbsp;<span class="ident" id="4538489">BlockSize</span><span class="op" id="4538498">(</span><span class="op" id="4538499">)</span>&nbsp;<span class="builtintype" id="4538501">int</span>&nbsp;<span class="op" id="4538505">{</span>&nbsp;<span class="keyword" id="4538507">return</span>&nbsp;<span class="ident" id="4538514">BlockSize</span>&nbsp;<span class="op" id="4538524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4538527">func</span>&nbsp;<span class="op" id="4538532">(</span><span class="ident" id="4538533">d</span>&nbsp;<span class="op" id="4538535">*</span><span class="ident" id="4538536">digest</span><span class="op" id="4538542">)</span>&nbsp;<span class="ident" id="4538544">Write</span><span class="op" id="4538549">(</span><span class="ident" id="4538550">p</span>&nbsp;<span class="op" id="4538552">[</span><span class="op" id="4538553">]</span><span class="builtintype" id="4538554">byte</span><span class="op" id="4538558">)</span>&nbsp;<span class="op" id="4538560">(</span><span class="ident" id="4538561">nn</span>&nbsp;<span class="builtintype" id="4538564">int</span><span class="op" id="4538567">,</span>&nbsp;<span class="ident" id="4538569">err</span>&nbsp;<span class="builtintype" id="4538573">error</span><span class="op" id="4538578">)</span>&nbsp;<span class="op" id="4538580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538583">nn</span>&nbsp;<span class="op" id="4538586">=</span>&nbsp;<span class="builtinfunc" id="4538588">len</span><span class="op" id="4538591">(</span><span class="ident" id="4538592">p</span><span class="op" id="4538593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538596">d</span><span class="op" id="4538597">.</span><span class="builtinfunc" id="4538598">len</span>&nbsp;<span class="op" id="4538602">+=</span>&nbsp;<span class="ident" id="4538605">uint64</span><span class="op" id="4538611">(</span><span class="ident" id="4538612">nn</span><span class="op" id="4538614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538617">if</span>&nbsp;<span class="ident" id="4538620">d</span><span class="op" id="4538621">.</span><span class="ident" id="4538622">nx</span>&nbsp;<span class="op" id="4538625">&gt;</span>&nbsp;<span class="num" id="4538627">0</span>&nbsp;<span class="op" id="4538629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538633">n</span>&nbsp;<span class="op" id="4538635">:=</span>&nbsp;<span class="builtinfunc" id="4538638">copy</span><span class="op" id="4538642">(</span><span class="ident" id="4538643">d</span><span class="op" id="4538644">.</span><span class="ident" id="4538645">x</span><span class="op" id="4538646">[</span><span class="ident" id="4538647">d</span><span class="op" id="4538648">.</span><span class="ident" id="4538649">nx</span><span class="op" id="4538651">:</span><span class="op" id="4538652">]</span><span class="op" id="4538653">,</span>&nbsp;<span class="ident" id="4538655">p</span><span class="op" id="4538656">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538660">d</span><span class="op" id="4538661">.</span><span class="ident" id="4538662">nx</span>&nbsp;<span class="op" id="4538665">+=</span>&nbsp;<span class="ident" id="4538668">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538672">if</span>&nbsp;<span class="ident" id="4538675">d</span><span class="op" id="4538676">.</span><span class="ident" id="4538677">nx</span>&nbsp;<span class="op" id="4538680">==</span>&nbsp;<span class="ident" id="4538683">chunk</span>&nbsp;<span class="op" id="4538689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538694">block</span><span class="op" id="4538699">(</span><span class="ident" id="4538700">d</span><span class="op" id="4538701">,</span>&nbsp;<span class="ident" id="4538703">d</span><span class="op" id="4538704">.</span><span class="ident" id="4538705">x</span><span class="op" id="4538706">[</span><span class="op" id="4538707">:</span><span class="op" id="4538708">]</span><span class="op" id="4538709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538714">d</span><span class="op" id="4538715">.</span><span class="ident" id="4538716">nx</span>&nbsp;<span class="op" id="4538719">=</span>&nbsp;<span class="num" id="4538721">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538725">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538729">p</span>&nbsp;<span class="op" id="4538731">=</span>&nbsp;<span class="ident" id="4538733">p</span><span class="op" id="4538734">[</span><span class="ident" id="4538735">n</span><span class="op" id="4538736">:</span><span class="op" id="4538737">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538743">if</span>&nbsp;<span class="builtinfunc" id="4538746">len</span><span class="op" id="4538749">(</span><span class="ident" id="4538750">p</span><span class="op" id="4538751">)</span>&nbsp;<span class="op" id="4538753">&gt;=</span>&nbsp;<span class="ident" id="4538756">chunk</span>&nbsp;<span class="op" id="4538762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538766">n</span>&nbsp;<span class="op" id="4538768">:=</span>&nbsp;<span class="builtinfunc" id="4538771">len</span><span class="op" id="4538774">(</span><span class="ident" id="4538775">p</span><span class="op" id="4538776">)</span>&nbsp;<span class="op" id="4538778">&amp;^</span>&nbsp;<span class="op" id="4538781">(</span><span class="ident" id="4538782">chunk</span>&nbsp;<span class="op" id="4538788">-</span>&nbsp;<span class="num" id="4538790">1</span><span class="op" id="4538791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538795">block</span><span class="op" id="4538800">(</span><span class="ident" id="4538801">d</span><span class="op" id="4538802">,</span>&nbsp;<span class="ident" id="4538804">p</span><span class="op" id="4538805">[</span><span class="op" id="4538806">:</span><span class="ident" id="4538807">n</span><span class="op" id="4538808">]</span><span class="op" id="4538809">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538813">p</span>&nbsp;<span class="op" id="4538815">=</span>&nbsp;<span class="ident" id="4538817">p</span><span class="op" id="4538818">[</span><span class="ident" id="4538819">n</span><span class="op" id="4538820">:</span><span class="op" id="4538821">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538827">if</span>&nbsp;<span class="builtinfunc" id="4538830">len</span><span class="op" id="4538833">(</span><span class="ident" id="4538834">p</span><span class="op" id="4538835">)</span>&nbsp;<span class="op" id="4538837">&gt;</span>&nbsp;<span class="num" id="4538839">0</span>&nbsp;<span class="op" id="4538841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538845">d</span><span class="op" id="4538846">.</span><span class="ident" id="4538847">nx</span>&nbsp;<span class="op" id="4538850">=</span>&nbsp;<span class="builtinfunc" id="4538852">copy</span><span class="op" id="4538856">(</span><span class="ident" id="4538857">d</span><span class="op" id="4538858">.</span><span class="ident" id="4538859">x</span><span class="op" id="4538860">[</span><span class="op" id="4538861">:</span><span class="op" id="4538862">]</span><span class="op" id="4538863">,</span>&nbsp;<span class="ident" id="4538865">p</span><span class="op" id="4538866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538869">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538872">return</span><br>
<span class="lineno"></span><span class="op" id="4538879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4538882">func</span>&nbsp;<span class="op" id="4538887">(</span><span class="ident" id="4538888">d0</span>&nbsp;<span class="op" id="4538891">*</span><span class="ident" id="4538892">digest</span><span class="op" id="4538898">)</span>&nbsp;<span class="ident" id="4538900">Sum</span><span class="op" id="4538903">(</span><span class="ident" id="4538904">in</span>&nbsp;<span class="op" id="4538907">[</span><span class="op" id="4538908">]</span><span class="builtintype" id="4538909">byte</span><span class="op" id="4538913">)</span>&nbsp;<span class="op" id="4538915">[</span><span class="op" id="4538916">]</span><span class="builtintype" id="4538917">byte</span>&nbsp;<span class="op" id="4538922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4538925">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538992">d</span>&nbsp;<span class="op" id="4538994">:=</span>&nbsp;<span class="op" id="4538997">*</span><span class="ident" id="4538998">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539002">hash</span>&nbsp;<span class="op" id="4539007">:=</span>&nbsp;<span class="ident" id="4539010">d</span><span class="op" id="4539011">.</span><span class="ident" id="4539012">checkSum</span><span class="op" id="4539020">(</span><span class="op" id="4539021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539024">if</span>&nbsp;<span class="ident" id="4539027">d</span><span class="op" id="4539028">.</span><span class="ident" id="4539029">is224</span>&nbsp;<span class="op" id="4539035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539039">return</span>&nbsp;<span class="builtinfunc" id="4539046">append</span><span class="op" id="4539052">(</span><span class="ident" id="4539053">in</span><span class="op" id="4539055">,</span>&nbsp;<span class="ident" id="4539057">hash</span><span class="op" id="4539061">[</span><span class="op" id="4539062">:</span><span class="ident" id="4539063">Size224</span><span class="op" id="4539070">]</span><span class="op" id="4539071">...</span><span class="op" id="4539074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539077">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539080">return</span>&nbsp;<span class="builtinfunc" id="4539087">append</span><span class="op" id="4539093">(</span><span class="ident" id="4539094">in</span><span class="op" id="4539096">,</span>&nbsp;<span class="ident" id="4539098">hash</span><span class="op" id="4539102">[</span><span class="op" id="4539103">:</span><span class="op" id="4539104">]</span><span class="op" id="4539105">...</span><span class="op" id="4539108">)</span><br>
<span class="lineno"></span><span class="op" id="4539110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4539113">func</span>&nbsp;<span class="op" id="4539118">(</span><span class="ident" id="4539119">d</span>&nbsp;<span class="op" id="4539121">*</span><span class="ident" id="4539122">digest</span><span class="op" id="4539128">)</span>&nbsp;<span class="ident" id="4539130">checkSum</span><span class="op" id="4539138">(</span><span class="op" id="4539139">)</span>&nbsp;<span class="op" id="4539141">[</span><span class="ident" id="4539142">Size</span><span class="op" id="4539146">]</span><span class="builtintype" id="4539147">byte</span>&nbsp;<span class="op" id="4539152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4539155">len</span>&nbsp;<span class="op" id="4539159">:=</span>&nbsp;<span class="ident" id="4539162">d</span><span class="op" id="4539163">.</span><span class="builtinfunc" id="4539164">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4539169">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539229">var</span>&nbsp;<span class="ident" id="4539233">tmp</span>&nbsp;<span class="op" id="4539237">[</span><span class="num" id="4539238">64</span><span class="op" id="4539240">]</span><span class="builtintype" id="4539241">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539247">tmp</span><span class="op" id="4539250">[</span><span class="num" id="4539251">0</span><span class="op" id="4539252">]</span>&nbsp;<span class="op" id="4539254">=</span>&nbsp;<span class="num" id="4539256">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539262">if</span>&nbsp;<span class="builtinfunc" id="4539265">len</span><span class="op" id="4539268">%</span><span class="num" id="4539269">64</span>&nbsp;<span class="op" id="4539272">&lt;</span>&nbsp;<span class="num" id="4539274">56</span>&nbsp;<span class="op" id="4539277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539281">d</span><span class="op" id="4539282">.</span><span class="ident" id="4539283">Write</span><span class="op" id="4539288">(</span><span class="ident" id="4539289">tmp</span><span class="op" id="4539292">[</span><span class="num" id="4539293">0</span>&nbsp;<span class="op" id="4539295">:</span>&nbsp;<span class="num" id="4539297">56</span><span class="op" id="4539299">-</span><span class="builtinfunc" id="4539300">len</span><span class="op" id="4539303">%</span><span class="num" id="4539304">64</span><span class="op" id="4539306">]</span><span class="op" id="4539307">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539310">}</span>&nbsp;<span class="keyword" id="4539312">else</span>&nbsp;<span class="op" id="4539317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539321">d</span><span class="op" id="4539322">.</span><span class="ident" id="4539323">Write</span><span class="op" id="4539328">(</span><span class="ident" id="4539329">tmp</span><span class="op" id="4539332">[</span><span class="num" id="4539333">0</span>&nbsp;<span class="op" id="4539335">:</span>&nbsp;<span class="num" id="4539337">64</span><span class="op" id="4539339">+</span><span class="num" id="4539340">56</span><span class="op" id="4539342">-</span><span class="builtinfunc" id="4539343">len</span><span class="op" id="4539346">%</span><span class="num" id="4539347">64</span><span class="op" id="4539349">]</span><span class="op" id="4539350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4539357">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4539377">len</span>&nbsp;<span class="op" id="4539381">&lt;&lt;=</span>&nbsp;<span class="num" id="4539385">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539388">for</span>&nbsp;<span class="ident" id="4539392">i</span>&nbsp;<span class="op" id="4539394">:=</span>&nbsp;<span class="builtintype" id="4539397">uint</span><span class="op" id="4539401">(</span><span class="num" id="4539402">0</span><span class="op" id="4539403">)</span><span class="op" id="4539404">;</span>&nbsp;<span class="ident" id="4539406">i</span>&nbsp;<span class="op" id="4539408">&lt;</span>&nbsp;<span class="num" id="4539410">8</span><span class="op" id="4539411">;</span>&nbsp;<span class="ident" id="4539413">i</span><span class="op" id="4539414">++</span>&nbsp;<span class="op" id="4539417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539421">tmp</span><span class="op" id="4539424">[</span><span class="ident" id="4539425">i</span><span class="op" id="4539426">]</span>&nbsp;<span class="op" id="4539428">=</span>&nbsp;<span class="builtintype" id="4539430">byte</span><span class="op" id="4539434">(</span><span class="builtinfunc" id="4539435">len</span>&nbsp;<span class="op" id="4539439">&gt;&gt;</span>&nbsp;<span class="op" id="4539442">(</span><span class="num" id="4539443">56</span>&nbsp;<span class="op" id="4539446">-</span>&nbsp;<span class="num" id="4539448">8</span><span class="op" id="4539449">*</span><span class="ident" id="4539450">i</span><span class="op" id="4539451">)</span><span class="op" id="4539452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539458">d</span><span class="op" id="4539459">.</span><span class="ident" id="4539460">Write</span><span class="op" id="4539465">(</span><span class="ident" id="4539466">tmp</span><span class="op" id="4539469">[</span><span class="num" id="4539470">0</span><span class="op" id="4539471">:</span><span class="num" id="4539472">8</span><span class="op" id="4539473">]</span><span class="op" id="4539474">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539478">if</span>&nbsp;<span class="ident" id="4539481">d</span><span class="op" id="4539482">.</span><span class="ident" id="4539483">nx</span>&nbsp;<span class="op" id="4539486">!=</span>&nbsp;<span class="num" id="4539489">0</span>&nbsp;<span class="op" id="4539491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4539495">panic</span><span class="op" id="4539500">(</span><span class="string" id="4539501">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4539512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539519">h</span>&nbsp;<span class="op" id="4539521">:=</span>&nbsp;<span class="ident" id="4539524">d</span><span class="op" id="4539525">.</span><span class="ident" id="4539526">h</span><span class="op" id="4539527">[</span><span class="op" id="4539528">:</span><span class="op" id="4539529">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539532">if</span>&nbsp;<span class="ident" id="4539535">d</span><span class="op" id="4539536">.</span><span class="ident" id="4539537">is224</span>&nbsp;<span class="op" id="4539543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539547">h</span>&nbsp;<span class="op" id="4539549">=</span>&nbsp;<span class="ident" id="4539551">d</span><span class="op" id="4539552">.</span><span class="ident" id="4539553">h</span><span class="op" id="4539554">[</span><span class="op" id="4539555">:</span><span class="num" id="4539556">7</span><span class="op" id="4539557">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539564">var</span>&nbsp;<span class="ident" id="4539568">digest</span>&nbsp;<span class="op" id="4539575">[</span><span class="ident" id="4539576">Size</span><span class="op" id="4539580">]</span><span class="builtintype" id="4539581">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539587">for</span>&nbsp;<span class="ident" id="4539591">i</span><span class="op" id="4539592">,</span>&nbsp;<span class="ident" id="4539594">s</span>&nbsp;<span class="op" id="4539596">:=</span>&nbsp;<span class="keyword" id="4539599">range</span>&nbsp;<span class="ident" id="4539605">h</span>&nbsp;<span class="op" id="4539607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539611">digest</span><span class="op" id="4539617">[</span><span class="ident" id="4539618">i</span><span class="op" id="4539619">*</span><span class="num" id="4539620">4</span><span class="op" id="4539621">]</span>&nbsp;<span class="op" id="4539623">=</span>&nbsp;<span class="builtintype" id="4539625">byte</span><span class="op" id="4539629">(</span><span class="ident" id="4539630">s</span>&nbsp;<span class="op" id="4539632">&gt;&gt;</span>&nbsp;<span class="num" id="4539635">24</span><span class="op" id="4539637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539641">digest</span><span class="op" id="4539647">[</span><span class="ident" id="4539648">i</span><span class="op" id="4539649">*</span><span class="num" id="4539650">4</span><span class="op" id="4539651">+</span><span class="num" id="4539652">1</span><span class="op" id="4539653">]</span>&nbsp;<span class="op" id="4539655">=</span>&nbsp;<span class="builtintype" id="4539657">byte</span><span class="op" id="4539661">(</span><span class="ident" id="4539662">s</span>&nbsp;<span class="op" id="4539664">&gt;&gt;</span>&nbsp;<span class="num" id="4539667">16</span><span class="op" id="4539669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539673">digest</span><span class="op" id="4539679">[</span><span class="ident" id="4539680">i</span><span class="op" id="4539681">*</span><span class="num" id="4539682">4</span><span class="op" id="4539683">+</span><span class="num" id="4539684">2</span><span class="op" id="4539685">]</span>&nbsp;<span class="op" id="4539687">=</span>&nbsp;<span class="builtintype" id="4539689">byte</span><span class="op" id="4539693">(</span><span class="ident" id="4539694">s</span>&nbsp;<span class="op" id="4539696">&gt;&gt;</span>&nbsp;<span class="num" id="4539699">8</span><span class="op" id="4539700">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539704">digest</span><span class="op" id="4539710">[</span><span class="ident" id="4539711">i</span><span class="op" id="4539712">*</span><span class="num" id="4539713">4</span><span class="op" id="4539714">+</span><span class="num" id="4539715">3</span><span class="op" id="4539716">]</span>&nbsp;<span class="op" id="4539718">=</span>&nbsp;<span class="builtintype" id="4539720">byte</span><span class="op" id="4539724">(</span><span class="ident" id="4539725">s</span><span class="op" id="4539726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539733">return</span>&nbsp;<span class="ident" id="4539740">digest</span><br>
<span class="lineno"></span><span class="op" id="4539747">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4539750">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4539801">func</span>&nbsp;<span class="ident" id="4539806">Sum256</span><span class="op" id="4539812">(</span><span class="ident" id="4539813">data</span>&nbsp;<span class="op" id="4539818">[</span><span class="op" id="4539819">]</span><span class="builtintype" id="4539820">byte</span><span class="op" id="4539824">)</span>&nbsp;<span class="op" id="4539826">[</span><span class="ident" id="4539827">Size</span><span class="op" id="4539831">]</span><span class="builtintype" id="4539832">byte</span>&nbsp;<span class="op" id="4539837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539840">var</span>&nbsp;<span class="ident" id="4539844">d</span>&nbsp;<span class="ident" id="4539846">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539854">d</span><span class="op" id="4539855">.</span><span class="ident" id="4539856">Reset</span><span class="op" id="4539861">(</span><span class="op" id="4539862">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539865">d</span><span class="op" id="4539866">.</span><span class="ident" id="4539867">Write</span><span class="op" id="4539872">(</span><span class="ident" id="4539873">data</span><span class="op" id="4539877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539880">return</span>&nbsp;<span class="ident" id="4539887">d</span><span class="op" id="4539888">.</span><span class="ident" id="4539889">checkSum</span><span class="op" id="4539897">(</span><span class="op" id="4539898">)</span><br>
<span class="lineno"></span><span class="op" id="4539900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4539903">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4539954">func</span>&nbsp;<span class="ident" id="4539959">Sum224</span><span class="op" id="4539965">(</span><span class="ident" id="4539966">data</span>&nbsp;<span class="op" id="4539971">[</span><span class="op" id="4539972">]</span><span class="builtintype" id="4539973">byte</span><span class="op" id="4539977">)</span>&nbsp;<span class="op" id="4539979">(</span><span class="ident" id="4539980">sum224</span>&nbsp;<span class="op" id="4539987">[</span><span class="ident" id="4539988">Size224</span><span class="op" id="4539995">]</span><span class="builtintype" id="4539996">byte</span><span class="op" id="4540000">)</span>&nbsp;<span class="op" id="4540002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540005">var</span>&nbsp;<span class="ident" id="4540009">d</span>&nbsp;<span class="ident" id="4540011">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540019">d</span><span class="op" id="4540020">.</span><span class="ident" id="4540021">is224</span>&nbsp;<span class="op" id="4540027">=</span>&nbsp;<span class="builtintype" id="4540029">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540035">d</span><span class="op" id="4540036">.</span><span class="ident" id="4540037">Reset</span><span class="op" id="4540042">(</span><span class="op" id="4540043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540046">d</span><span class="op" id="4540047">.</span><span class="ident" id="4540048">Write</span><span class="op" id="4540053">(</span><span class="ident" id="4540054">data</span><span class="op" id="4540058">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540061">sum</span>&nbsp;<span class="op" id="4540065">:=</span>&nbsp;<span class="ident" id="4540068">d</span><span class="op" id="4540069">.</span><span class="ident" id="4540070">checkSum</span><span class="op" id="4540078">(</span><span class="op" id="4540079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4540082">copy</span><span class="op" id="4540086">(</span><span class="ident" id="4540087">sum224</span><span class="op" id="4540093">[</span><span class="op" id="4540094">:</span><span class="op" id="4540095">]</span><span class="op" id="4540096">,</span>&nbsp;<span class="ident" id="4540098">sum</span><span class="op" id="4540101">[</span><span class="op" id="4540102">:</span><span class="ident" id="4540103">Size224</span><span class="op" id="4540110">]</span><span class="op" id="4540111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540114">return</span><br>
<span class="lineno"></span><span class="op" id="4540121">}</span>
</div>
</body>
</html>
