<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html" class="current">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4317149">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4317204">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4317258">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4317309">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4317387">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4317405">package</span>&nbsp;<span class="ident" id="4317413">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4317421">import</span>&nbsp;<span class="op" id="4317428">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4317431">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4317441">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4317448">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4317451">func</span>&nbsp;<span class="ident" id="4317456">init</span><span class="op" id="4317460">(</span><span class="op" id="4317461">)</span>&nbsp;<span class="op" id="4317463">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317466">crypto</span><span class="op" id="4317472">.</span><span class="ident" id="4317473">RegisterHash</span><span class="op" id="4317485">(</span><span class="ident" id="4317486">crypto</span><span class="op" id="4317492">.</span><span class="ident" id="4317493">SHA224</span><span class="op" id="4317499">,</span>&nbsp;<span class="ident" id="4317501">New224</span><span class="op" id="4317507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317510">crypto</span><span class="op" id="4317516">.</span><span class="ident" id="4317517">RegisterHash</span><span class="op" id="4317529">(</span><span class="ident" id="4317530">crypto</span><span class="op" id="4317536">.</span><span class="ident" id="4317537">SHA256</span><span class="op" id="4317543">,</span>&nbsp;<span class="ident" id="4317545">New</span><span class="op" id="4317548">)</span><br>
<span class="lineno"></span><span class="op" id="4317550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4317553">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4317596">const</span>&nbsp;<span class="ident" id="4317602">Size</span>&nbsp;<span class="op" id="4317607">=</span>&nbsp;<span class="num" id="4317609">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4317613">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4317656">const</span>&nbsp;<span class="ident" id="4317662">Size224</span>&nbsp;<span class="op" id="4317670">=</span>&nbsp;<span class="num" id="4317672">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4317676">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4317724">const</span>&nbsp;<span class="ident" id="4317730">BlockSize</span>&nbsp;<span class="op" id="4317740">=</span>&nbsp;<span class="num" id="4317742">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4317746">const</span>&nbsp;<span class="op" id="4317752">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317755">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317765">=</span>&nbsp;<span class="num" id="4317767">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317771">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317781">=</span>&nbsp;<span class="num" id="4317783">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317795">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317805">=</span>&nbsp;<span class="num" id="4317807">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317819">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317829">=</span>&nbsp;<span class="num" id="4317831">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317843">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317853">=</span>&nbsp;<span class="num" id="4317855">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317867">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317877">=</span>&nbsp;<span class="num" id="4317879">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317891">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317901">=</span>&nbsp;<span class="num" id="4317903">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317915">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317925">=</span>&nbsp;<span class="num" id="4317927">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317939">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317949">=</span>&nbsp;<span class="num" id="4317951">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317963">init0_224</span>&nbsp;<span class="op" id="4317973">=</span>&nbsp;<span class="num" id="4317975">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317987">init1_224</span>&nbsp;<span class="op" id="4317997">=</span>&nbsp;<span class="num" id="4317999">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318011">init2_224</span>&nbsp;<span class="op" id="4318021">=</span>&nbsp;<span class="num" id="4318023">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318035">init3_224</span>&nbsp;<span class="op" id="4318045">=</span>&nbsp;<span class="num" id="4318047">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318059">init4_224</span>&nbsp;<span class="op" id="4318069">=</span>&nbsp;<span class="num" id="4318071">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318083">init5_224</span>&nbsp;<span class="op" id="4318093">=</span>&nbsp;<span class="num" id="4318095">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318107">init6_224</span>&nbsp;<span class="op" id="4318117">=</span>&nbsp;<span class="num" id="4318119">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318131">init7_224</span>&nbsp;<span class="op" id="4318141">=</span>&nbsp;<span class="num" id="4318143">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4318154">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4318157">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4318216">type</span>&nbsp;<span class="ident" id="4318221">digest</span>&nbsp;<span class="keyword" id="4318228">struct</span>&nbsp;<span class="op" id="4318235">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318238">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318244">[</span><span class="num" id="4318245">8</span><span class="op" id="4318246">]</span><span class="builtintype" id="4318247">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318255">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318261">[</span><span class="ident" id="4318262">chunk</span><span class="op" id="4318267">]</span><span class="builtintype" id="4318268">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318274">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4318280">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4318285">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4318291">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318299">is224</span>&nbsp;<span class="builtintype" id="4318305">bool</span>&nbsp;<span class="comment" id="4318310">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4318344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4318347">func</span>&nbsp;<span class="op" id="4318352">(</span><span class="ident" id="4318353">d</span>&nbsp;<span class="op" id="4318355">*</span><span class="ident" id="4318356">digest</span><span class="op" id="4318362">)</span>&nbsp;<span class="ident" id="4318364">Reset</span><span class="op" id="4318369">(</span><span class="op" id="4318370">)</span>&nbsp;<span class="op" id="4318372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318375">if</span>&nbsp;<span class="op" id="4318378">!</span><span class="ident" id="4318379">d</span><span class="op" id="4318380">.</span><span class="ident" id="4318381">is224</span>&nbsp;<span class="op" id="4318387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318391">d</span><span class="op" id="4318392">.</span><span class="ident" id="4318393">h</span><span class="op" id="4318394">[</span><span class="num" id="4318395">0</span><span class="op" id="4318396">]</span>&nbsp;<span class="op" id="4318398">=</span>&nbsp;<span class="ident" id="4318400">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318408">d</span><span class="op" id="4318409">.</span><span class="ident" id="4318410">h</span><span class="op" id="4318411">[</span><span class="num" id="4318412">1</span><span class="op" id="4318413">]</span>&nbsp;<span class="op" id="4318415">=</span>&nbsp;<span class="ident" id="4318417">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318425">d</span><span class="op" id="4318426">.</span><span class="ident" id="4318427">h</span><span class="op" id="4318428">[</span><span class="num" id="4318429">2</span><span class="op" id="4318430">]</span>&nbsp;<span class="op" id="4318432">=</span>&nbsp;<span class="ident" id="4318434">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318442">d</span><span class="op" id="4318443">.</span><span class="ident" id="4318444">h</span><span class="op" id="4318445">[</span><span class="num" id="4318446">3</span><span class="op" id="4318447">]</span>&nbsp;<span class="op" id="4318449">=</span>&nbsp;<span class="ident" id="4318451">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318459">d</span><span class="op" id="4318460">.</span><span class="ident" id="4318461">h</span><span class="op" id="4318462">[</span><span class="num" id="4318463">4</span><span class="op" id="4318464">]</span>&nbsp;<span class="op" id="4318466">=</span>&nbsp;<span class="ident" id="4318468">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318476">d</span><span class="op" id="4318477">.</span><span class="ident" id="4318478">h</span><span class="op" id="4318479">[</span><span class="num" id="4318480">5</span><span class="op" id="4318481">]</span>&nbsp;<span class="op" id="4318483">=</span>&nbsp;<span class="ident" id="4318485">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318493">d</span><span class="op" id="4318494">.</span><span class="ident" id="4318495">h</span><span class="op" id="4318496">[</span><span class="num" id="4318497">6</span><span class="op" id="4318498">]</span>&nbsp;<span class="op" id="4318500">=</span>&nbsp;<span class="ident" id="4318502">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318510">d</span><span class="op" id="4318511">.</span><span class="ident" id="4318512">h</span><span class="op" id="4318513">[</span><span class="num" id="4318514">7</span><span class="op" id="4318515">]</span>&nbsp;<span class="op" id="4318517">=</span>&nbsp;<span class="ident" id="4318519">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318526">}</span>&nbsp;<span class="keyword" id="4318528">else</span>&nbsp;<span class="op" id="4318533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318537">d</span><span class="op" id="4318538">.</span><span class="ident" id="4318539">h</span><span class="op" id="4318540">[</span><span class="num" id="4318541">0</span><span class="op" id="4318542">]</span>&nbsp;<span class="op" id="4318544">=</span>&nbsp;<span class="ident" id="4318546">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318558">d</span><span class="op" id="4318559">.</span><span class="ident" id="4318560">h</span><span class="op" id="4318561">[</span><span class="num" id="4318562">1</span><span class="op" id="4318563">]</span>&nbsp;<span class="op" id="4318565">=</span>&nbsp;<span class="ident" id="4318567">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318579">d</span><span class="op" id="4318580">.</span><span class="ident" id="4318581">h</span><span class="op" id="4318582">[</span><span class="num" id="4318583">2</span><span class="op" id="4318584">]</span>&nbsp;<span class="op" id="4318586">=</span>&nbsp;<span class="ident" id="4318588">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318600">d</span><span class="op" id="4318601">.</span><span class="ident" id="4318602">h</span><span class="op" id="4318603">[</span><span class="num" id="4318604">3</span><span class="op" id="4318605">]</span>&nbsp;<span class="op" id="4318607">=</span>&nbsp;<span class="ident" id="4318609">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318621">d</span><span class="op" id="4318622">.</span><span class="ident" id="4318623">h</span><span class="op" id="4318624">[</span><span class="num" id="4318625">4</span><span class="op" id="4318626">]</span>&nbsp;<span class="op" id="4318628">=</span>&nbsp;<span class="ident" id="4318630">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318642">d</span><span class="op" id="4318643">.</span><span class="ident" id="4318644">h</span><span class="op" id="4318645">[</span><span class="num" id="4318646">5</span><span class="op" id="4318647">]</span>&nbsp;<span class="op" id="4318649">=</span>&nbsp;<span class="ident" id="4318651">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318663">d</span><span class="op" id="4318664">.</span><span class="ident" id="4318665">h</span><span class="op" id="4318666">[</span><span class="num" id="4318667">6</span><span class="op" id="4318668">]</span>&nbsp;<span class="op" id="4318670">=</span>&nbsp;<span class="ident" id="4318672">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318684">d</span><span class="op" id="4318685">.</span><span class="ident" id="4318686">h</span><span class="op" id="4318687">[</span><span class="num" id="4318688">7</span><span class="op" id="4318689">]</span>&nbsp;<span class="op" id="4318691">=</span>&nbsp;<span class="ident" id="4318693">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318707">d</span><span class="op" id="4318708">.</span><span class="ident" id="4318709">nx</span>&nbsp;<span class="op" id="4318712">=</span>&nbsp;<span class="num" id="4318714">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318717">d</span><span class="op" id="4318718">.</span><span class="builtinfunc" id="4318719">len</span>&nbsp;<span class="op" id="4318723">=</span>&nbsp;<span class="num" id="4318725">0</span><br>
<span class="lineno"></span><span class="op" id="4318727">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4318730">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4318792">func</span>&nbsp;<span class="ident" id="4318797">New</span><span class="op" id="4318800">(</span><span class="op" id="4318801">)</span>&nbsp;<span class="ident" id="4318803">hash</span><span class="op" id="4318807">.</span><span class="ident" id="4318808">Hash</span>&nbsp;<span class="op" id="4318813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318816">d</span>&nbsp;<span class="op" id="4318818">:=</span>&nbsp;<span class="builtinfunc" id="4318821">new</span><span class="op" id="4318824">(</span><span class="ident" id="4318825">digest</span><span class="op" id="4318831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318834">d</span><span class="op" id="4318835">.</span><span class="ident" id="4318836">Reset</span><span class="op" id="4318841">(</span><span class="op" id="4318842">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318845">return</span>&nbsp;<span class="ident" id="4318852">d</span><br>
<span class="lineno"></span><span class="op" id="4318854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4318857">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4318922">func</span>&nbsp;<span class="ident" id="4318927">New224</span><span class="op" id="4318933">(</span><span class="op" id="4318934">)</span>&nbsp;<span class="ident" id="4318936">hash</span><span class="op" id="4318940">.</span><span class="ident" id="4318941">Hash</span>&nbsp;<span class="op" id="4318946">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318949">d</span>&nbsp;<span class="op" id="4318951">:=</span>&nbsp;<span class="builtinfunc" id="4318954">new</span><span class="op" id="4318957">(</span><span class="ident" id="4318958">digest</span><span class="op" id="4318964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318967">d</span><span class="op" id="4318968">.</span><span class="ident" id="4318969">is224</span>&nbsp;<span class="op" id="4318975">=</span>&nbsp;<span class="builtintype" id="4318977">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318983">d</span><span class="op" id="4318984">.</span><span class="ident" id="4318985">Reset</span><span class="op" id="4318990">(</span><span class="op" id="4318991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318994">return</span>&nbsp;<span class="ident" id="4319001">d</span><br>
<span class="lineno"></span><span class="op" id="4319003">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4319006">func</span>&nbsp;<span class="op" id="4319011">(</span><span class="ident" id="4319012">d</span>&nbsp;<span class="op" id="4319014">*</span><span class="ident" id="4319015">digest</span><span class="op" id="4319021">)</span>&nbsp;<span class="ident" id="4319023">Size</span><span class="op" id="4319027">(</span><span class="op" id="4319028">)</span>&nbsp;<span class="builtintype" id="4319030">int</span>&nbsp;<span class="op" id="4319034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319037">if</span>&nbsp;<span class="op" id="4319040">!</span><span class="ident" id="4319041">d</span><span class="op" id="4319042">.</span><span class="ident" id="4319043">is224</span>&nbsp;<span class="op" id="4319049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319053">return</span>&nbsp;<span class="ident" id="4319060">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319066">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319069">return</span>&nbsp;<span class="ident" id="4319076">Size224</span><br>
<span class="lineno"></span><span class="op" id="4319084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4319087">func</span>&nbsp;<span class="op" id="4319092">(</span><span class="ident" id="4319093">d</span>&nbsp;<span class="op" id="4319095">*</span><span class="ident" id="4319096">digest</span><span class="op" id="4319102">)</span>&nbsp;<span class="ident" id="4319104">BlockSize</span><span class="op" id="4319113">(</span><span class="op" id="4319114">)</span>&nbsp;<span class="builtintype" id="4319116">int</span>&nbsp;<span class="op" id="4319120">{</span>&nbsp;<span class="keyword" id="4319122">return</span>&nbsp;<span class="ident" id="4319129">BlockSize</span>&nbsp;<span class="op" id="4319139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4319142">func</span>&nbsp;<span class="op" id="4319147">(</span><span class="ident" id="4319148">d</span>&nbsp;<span class="op" id="4319150">*</span><span class="ident" id="4319151">digest</span><span class="op" id="4319157">)</span>&nbsp;<span class="ident" id="4319159">Write</span><span class="op" id="4319164">(</span><span class="ident" id="4319165">p</span>&nbsp;<span class="op" id="4319167">[</span><span class="op" id="4319168">]</span><span class="builtintype" id="4319169">byte</span><span class="op" id="4319173">)</span>&nbsp;<span class="op" id="4319175">(</span><span class="ident" id="4319176">nn</span>&nbsp;<span class="builtintype" id="4319179">int</span><span class="op" id="4319182">,</span>&nbsp;<span class="ident" id="4319184">err</span>&nbsp;<span class="builtintype" id="4319188">error</span><span class="op" id="4319193">)</span>&nbsp;<span class="op" id="4319195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319198">nn</span>&nbsp;<span class="op" id="4319201">=</span>&nbsp;<span class="builtinfunc" id="4319203">len</span><span class="op" id="4319206">(</span><span class="ident" id="4319207">p</span><span class="op" id="4319208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319211">d</span><span class="op" id="4319212">.</span><span class="builtinfunc" id="4319213">len</span>&nbsp;<span class="op" id="4319217">+=</span>&nbsp;<span class="ident" id="4319220">uint64</span><span class="op" id="4319226">(</span><span class="ident" id="4319227">nn</span><span class="op" id="4319229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319232">if</span>&nbsp;<span class="ident" id="4319235">d</span><span class="op" id="4319236">.</span><span class="ident" id="4319237">nx</span>&nbsp;<span class="op" id="4319240">&gt;</span>&nbsp;<span class="num" id="4319242">0</span>&nbsp;<span class="op" id="4319244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319248">n</span>&nbsp;<span class="op" id="4319250">:=</span>&nbsp;<span class="builtinfunc" id="4319253">copy</span><span class="op" id="4319257">(</span><span class="ident" id="4319258">d</span><span class="op" id="4319259">.</span><span class="ident" id="4319260">x</span><span class="op" id="4319261">[</span><span class="ident" id="4319262">d</span><span class="op" id="4319263">.</span><span class="ident" id="4319264">nx</span><span class="op" id="4319266">:</span><span class="op" id="4319267">]</span><span class="op" id="4319268">,</span>&nbsp;<span class="ident" id="4319270">p</span><span class="op" id="4319271">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319275">d</span><span class="op" id="4319276">.</span><span class="ident" id="4319277">nx</span>&nbsp;<span class="op" id="4319280">+=</span>&nbsp;<span class="ident" id="4319283">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319287">if</span>&nbsp;<span class="ident" id="4319290">d</span><span class="op" id="4319291">.</span><span class="ident" id="4319292">nx</span>&nbsp;<span class="op" id="4319295">==</span>&nbsp;<span class="ident" id="4319298">chunk</span>&nbsp;<span class="op" id="4319304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319309">block</span><span class="op" id="4319314">(</span><span class="ident" id="4319315">d</span><span class="op" id="4319316">,</span>&nbsp;<span class="ident" id="4319318">d</span><span class="op" id="4319319">.</span><span class="ident" id="4319320">x</span><span class="op" id="4319321">[</span><span class="op" id="4319322">:</span><span class="op" id="4319323">]</span><span class="op" id="4319324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319329">d</span><span class="op" id="4319330">.</span><span class="ident" id="4319331">nx</span>&nbsp;<span class="op" id="4319334">=</span>&nbsp;<span class="num" id="4319336">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319340">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319344">p</span>&nbsp;<span class="op" id="4319346">=</span>&nbsp;<span class="ident" id="4319348">p</span><span class="op" id="4319349">[</span><span class="ident" id="4319350">n</span><span class="op" id="4319351">:</span><span class="op" id="4319352">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319358">if</span>&nbsp;<span class="builtinfunc" id="4319361">len</span><span class="op" id="4319364">(</span><span class="ident" id="4319365">p</span><span class="op" id="4319366">)</span>&nbsp;<span class="op" id="4319368">&gt;=</span>&nbsp;<span class="ident" id="4319371">chunk</span>&nbsp;<span class="op" id="4319377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319381">n</span>&nbsp;<span class="op" id="4319383">:=</span>&nbsp;<span class="builtinfunc" id="4319386">len</span><span class="op" id="4319389">(</span><span class="ident" id="4319390">p</span><span class="op" id="4319391">)</span>&nbsp;<span class="op" id="4319393">&amp;^</span>&nbsp;<span class="op" id="4319396">(</span><span class="ident" id="4319397">chunk</span>&nbsp;<span class="op" id="4319403">-</span>&nbsp;<span class="num" id="4319405">1</span><span class="op" id="4319406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319410">block</span><span class="op" id="4319415">(</span><span class="ident" id="4319416">d</span><span class="op" id="4319417">,</span>&nbsp;<span class="ident" id="4319419">p</span><span class="op" id="4319420">[</span><span class="op" id="4319421">:</span><span class="ident" id="4319422">n</span><span class="op" id="4319423">]</span><span class="op" id="4319424">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319428">p</span>&nbsp;<span class="op" id="4319430">=</span>&nbsp;<span class="ident" id="4319432">p</span><span class="op" id="4319433">[</span><span class="ident" id="4319434">n</span><span class="op" id="4319435">:</span><span class="op" id="4319436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319442">if</span>&nbsp;<span class="builtinfunc" id="4319445">len</span><span class="op" id="4319448">(</span><span class="ident" id="4319449">p</span><span class="op" id="4319450">)</span>&nbsp;<span class="op" id="4319452">&gt;</span>&nbsp;<span class="num" id="4319454">0</span>&nbsp;<span class="op" id="4319456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319460">d</span><span class="op" id="4319461">.</span><span class="ident" id="4319462">nx</span>&nbsp;<span class="op" id="4319465">=</span>&nbsp;<span class="builtinfunc" id="4319467">copy</span><span class="op" id="4319471">(</span><span class="ident" id="4319472">d</span><span class="op" id="4319473">.</span><span class="ident" id="4319474">x</span><span class="op" id="4319475">[</span><span class="op" id="4319476">:</span><span class="op" id="4319477">]</span><span class="op" id="4319478">,</span>&nbsp;<span class="ident" id="4319480">p</span><span class="op" id="4319481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319484">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319487">return</span><br>
<span class="lineno"></span><span class="op" id="4319494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4319497">func</span>&nbsp;<span class="op" id="4319502">(</span><span class="ident" id="4319503">d0</span>&nbsp;<span class="op" id="4319506">*</span><span class="ident" id="4319507">digest</span><span class="op" id="4319513">)</span>&nbsp;<span class="ident" id="4319515">Sum</span><span class="op" id="4319518">(</span><span class="ident" id="4319519">in</span>&nbsp;<span class="op" id="4319522">[</span><span class="op" id="4319523">]</span><span class="builtintype" id="4319524">byte</span><span class="op" id="4319528">)</span>&nbsp;<span class="op" id="4319530">[</span><span class="op" id="4319531">]</span><span class="builtintype" id="4319532">byte</span>&nbsp;<span class="op" id="4319537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319540">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319607">d</span>&nbsp;<span class="op" id="4319609">:=</span>&nbsp;<span class="op" id="4319612">*</span><span class="ident" id="4319613">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319617">hash</span>&nbsp;<span class="op" id="4319622">:=</span>&nbsp;<span class="ident" id="4319625">d</span><span class="op" id="4319626">.</span><span class="ident" id="4319627">checkSum</span><span class="op" id="4319635">(</span><span class="op" id="4319636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319639">if</span>&nbsp;<span class="ident" id="4319642">d</span><span class="op" id="4319643">.</span><span class="ident" id="4319644">is224</span>&nbsp;<span class="op" id="4319650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319654">return</span>&nbsp;<span class="builtinfunc" id="4319661">append</span><span class="op" id="4319667">(</span><span class="ident" id="4319668">in</span><span class="op" id="4319670">,</span>&nbsp;<span class="ident" id="4319672">hash</span><span class="op" id="4319676">[</span><span class="op" id="4319677">:</span><span class="ident" id="4319678">Size224</span><span class="op" id="4319685">]</span><span class="op" id="4319686">...</span><span class="op" id="4319689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319692">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319695">return</span>&nbsp;<span class="builtinfunc" id="4319702">append</span><span class="op" id="4319708">(</span><span class="ident" id="4319709">in</span><span class="op" id="4319711">,</span>&nbsp;<span class="ident" id="4319713">hash</span><span class="op" id="4319717">[</span><span class="op" id="4319718">:</span><span class="op" id="4319719">]</span><span class="op" id="4319720">...</span><span class="op" id="4319723">)</span><br>
<span class="lineno"></span><span class="op" id="4319725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4319728">func</span>&nbsp;<span class="op" id="4319733">(</span><span class="ident" id="4319734">d</span>&nbsp;<span class="op" id="4319736">*</span><span class="ident" id="4319737">digest</span><span class="op" id="4319743">)</span>&nbsp;<span class="ident" id="4319745">checkSum</span><span class="op" id="4319753">(</span><span class="op" id="4319754">)</span>&nbsp;<span class="op" id="4319756">[</span><span class="ident" id="4319757">Size</span><span class="op" id="4319761">]</span><span class="builtintype" id="4319762">byte</span>&nbsp;<span class="op" id="4319767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4319770">len</span>&nbsp;<span class="op" id="4319774">:=</span>&nbsp;<span class="ident" id="4319777">d</span><span class="op" id="4319778">.</span><span class="builtinfunc" id="4319779">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319784">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319844">var</span>&nbsp;<span class="ident" id="4319848">tmp</span>&nbsp;<span class="op" id="4319852">[</span><span class="num" id="4319853">64</span><span class="op" id="4319855">]</span><span class="builtintype" id="4319856">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319862">tmp</span><span class="op" id="4319865">[</span><span class="num" id="4319866">0</span><span class="op" id="4319867">]</span>&nbsp;<span class="op" id="4319869">=</span>&nbsp;<span class="num" id="4319871">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319877">if</span>&nbsp;<span class="builtinfunc" id="4319880">len</span><span class="op" id="4319883">%</span><span class="num" id="4319884">64</span>&nbsp;<span class="op" id="4319887">&lt;</span>&nbsp;<span class="num" id="4319889">56</span>&nbsp;<span class="op" id="4319892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319896">d</span><span class="op" id="4319897">.</span><span class="ident" id="4319898">Write</span><span class="op" id="4319903">(</span><span class="ident" id="4319904">tmp</span><span class="op" id="4319907">[</span><span class="num" id="4319908">0</span>&nbsp;<span class="op" id="4319910">:</span>&nbsp;<span class="num" id="4319912">56</span><span class="op" id="4319914">-</span><span class="builtinfunc" id="4319915">len</span><span class="op" id="4319918">%</span><span class="num" id="4319919">64</span><span class="op" id="4319921">]</span><span class="op" id="4319922">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319925">}</span>&nbsp;<span class="keyword" id="4319927">else</span>&nbsp;<span class="op" id="4319932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319936">d</span><span class="op" id="4319937">.</span><span class="ident" id="4319938">Write</span><span class="op" id="4319943">(</span><span class="ident" id="4319944">tmp</span><span class="op" id="4319947">[</span><span class="num" id="4319948">0</span>&nbsp;<span class="op" id="4319950">:</span>&nbsp;<span class="num" id="4319952">64</span><span class="op" id="4319954">+</span><span class="num" id="4319955">56</span><span class="op" id="4319957">-</span><span class="builtinfunc" id="4319958">len</span><span class="op" id="4319961">%</span><span class="num" id="4319962">64</span><span class="op" id="4319964">]</span><span class="op" id="4319965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319972">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4319992">len</span>&nbsp;<span class="op" id="4319996">&lt;&lt;=</span>&nbsp;<span class="num" id="4320000">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320003">for</span>&nbsp;<span class="ident" id="4320007">i</span>&nbsp;<span class="op" id="4320009">:=</span>&nbsp;<span class="builtintype" id="4320012">uint</span><span class="op" id="4320016">(</span><span class="num" id="4320017">0</span><span class="op" id="4320018">)</span><span class="op" id="4320019">;</span>&nbsp;<span class="ident" id="4320021">i</span>&nbsp;<span class="op" id="4320023">&lt;</span>&nbsp;<span class="num" id="4320025">8</span><span class="op" id="4320026">;</span>&nbsp;<span class="ident" id="4320028">i</span><span class="op" id="4320029">++</span>&nbsp;<span class="op" id="4320032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320036">tmp</span><span class="op" id="4320039">[</span><span class="ident" id="4320040">i</span><span class="op" id="4320041">]</span>&nbsp;<span class="op" id="4320043">=</span>&nbsp;<span class="builtintype" id="4320045">byte</span><span class="op" id="4320049">(</span><span class="builtinfunc" id="4320050">len</span>&nbsp;<span class="op" id="4320054">&gt;&gt;</span>&nbsp;<span class="op" id="4320057">(</span><span class="num" id="4320058">56</span>&nbsp;<span class="op" id="4320061">-</span>&nbsp;<span class="num" id="4320063">8</span><span class="op" id="4320064">*</span><span class="ident" id="4320065">i</span><span class="op" id="4320066">)</span><span class="op" id="4320067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320073">d</span><span class="op" id="4320074">.</span><span class="ident" id="4320075">Write</span><span class="op" id="4320080">(</span><span class="ident" id="4320081">tmp</span><span class="op" id="4320084">[</span><span class="num" id="4320085">0</span><span class="op" id="4320086">:</span><span class="num" id="4320087">8</span><span class="op" id="4320088">]</span><span class="op" id="4320089">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320093">if</span>&nbsp;<span class="ident" id="4320096">d</span><span class="op" id="4320097">.</span><span class="ident" id="4320098">nx</span>&nbsp;<span class="op" id="4320101">!=</span>&nbsp;<span class="num" id="4320104">0</span>&nbsp;<span class="op" id="4320106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4320110">panic</span><span class="op" id="4320115">(</span><span class="string" id="4320116">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4320127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320134">h</span>&nbsp;<span class="op" id="4320136">:=</span>&nbsp;<span class="ident" id="4320139">d</span><span class="op" id="4320140">.</span><span class="ident" id="4320141">h</span><span class="op" id="4320142">[</span><span class="op" id="4320143">:</span><span class="op" id="4320144">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320147">if</span>&nbsp;<span class="ident" id="4320150">d</span><span class="op" id="4320151">.</span><span class="ident" id="4320152">is224</span>&nbsp;<span class="op" id="4320158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320162">h</span>&nbsp;<span class="op" id="4320164">=</span>&nbsp;<span class="ident" id="4320166">d</span><span class="op" id="4320167">.</span><span class="ident" id="4320168">h</span><span class="op" id="4320169">[</span><span class="op" id="4320170">:</span><span class="num" id="4320171">7</span><span class="op" id="4320172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320179">var</span>&nbsp;<span class="ident" id="4320183">digest</span>&nbsp;<span class="op" id="4320190">[</span><span class="ident" id="4320191">Size</span><span class="op" id="4320195">]</span><span class="builtintype" id="4320196">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320202">for</span>&nbsp;<span class="ident" id="4320206">i</span><span class="op" id="4320207">,</span>&nbsp;<span class="ident" id="4320209">s</span>&nbsp;<span class="op" id="4320211">:=</span>&nbsp;<span class="keyword" id="4320214">range</span>&nbsp;<span class="ident" id="4320220">h</span>&nbsp;<span class="op" id="4320222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320226">digest</span><span class="op" id="4320232">[</span><span class="ident" id="4320233">i</span><span class="op" id="4320234">*</span><span class="num" id="4320235">4</span><span class="op" id="4320236">]</span>&nbsp;<span class="op" id="4320238">=</span>&nbsp;<span class="builtintype" id="4320240">byte</span><span class="op" id="4320244">(</span><span class="ident" id="4320245">s</span>&nbsp;<span class="op" id="4320247">&gt;&gt;</span>&nbsp;<span class="num" id="4320250">24</span><span class="op" id="4320252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320256">digest</span><span class="op" id="4320262">[</span><span class="ident" id="4320263">i</span><span class="op" id="4320264">*</span><span class="num" id="4320265">4</span><span class="op" id="4320266">+</span><span class="num" id="4320267">1</span><span class="op" id="4320268">]</span>&nbsp;<span class="op" id="4320270">=</span>&nbsp;<span class="builtintype" id="4320272">byte</span><span class="op" id="4320276">(</span><span class="ident" id="4320277">s</span>&nbsp;<span class="op" id="4320279">&gt;&gt;</span>&nbsp;<span class="num" id="4320282">16</span><span class="op" id="4320284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320288">digest</span><span class="op" id="4320294">[</span><span class="ident" id="4320295">i</span><span class="op" id="4320296">*</span><span class="num" id="4320297">4</span><span class="op" id="4320298">+</span><span class="num" id="4320299">2</span><span class="op" id="4320300">]</span>&nbsp;<span class="op" id="4320302">=</span>&nbsp;<span class="builtintype" id="4320304">byte</span><span class="op" id="4320308">(</span><span class="ident" id="4320309">s</span>&nbsp;<span class="op" id="4320311">&gt;&gt;</span>&nbsp;<span class="num" id="4320314">8</span><span class="op" id="4320315">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320319">digest</span><span class="op" id="4320325">[</span><span class="ident" id="4320326">i</span><span class="op" id="4320327">*</span><span class="num" id="4320328">4</span><span class="op" id="4320329">+</span><span class="num" id="4320330">3</span><span class="op" id="4320331">]</span>&nbsp;<span class="op" id="4320333">=</span>&nbsp;<span class="builtintype" id="4320335">byte</span><span class="op" id="4320339">(</span><span class="ident" id="4320340">s</span><span class="op" id="4320341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320348">return</span>&nbsp;<span class="ident" id="4320355">digest</span><br>
<span class="lineno"></span><span class="op" id="4320362">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4320365">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4320416">func</span>&nbsp;<span class="ident" id="4320421">Sum256</span><span class="op" id="4320427">(</span><span class="ident" id="4320428">data</span>&nbsp;<span class="op" id="4320433">[</span><span class="op" id="4320434">]</span><span class="builtintype" id="4320435">byte</span><span class="op" id="4320439">)</span>&nbsp;<span class="op" id="4320441">[</span><span class="ident" id="4320442">Size</span><span class="op" id="4320446">]</span><span class="builtintype" id="4320447">byte</span>&nbsp;<span class="op" id="4320452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320455">var</span>&nbsp;<span class="ident" id="4320459">d</span>&nbsp;<span class="ident" id="4320461">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320469">d</span><span class="op" id="4320470">.</span><span class="ident" id="4320471">Reset</span><span class="op" id="4320476">(</span><span class="op" id="4320477">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320480">d</span><span class="op" id="4320481">.</span><span class="ident" id="4320482">Write</span><span class="op" id="4320487">(</span><span class="ident" id="4320488">data</span><span class="op" id="4320492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320495">return</span>&nbsp;<span class="ident" id="4320502">d</span><span class="op" id="4320503">.</span><span class="ident" id="4320504">checkSum</span><span class="op" id="4320512">(</span><span class="op" id="4320513">)</span><br>
<span class="lineno"></span><span class="op" id="4320515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4320518">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4320569">func</span>&nbsp;<span class="ident" id="4320574">Sum224</span><span class="op" id="4320580">(</span><span class="ident" id="4320581">data</span>&nbsp;<span class="op" id="4320586">[</span><span class="op" id="4320587">]</span><span class="builtintype" id="4320588">byte</span><span class="op" id="4320592">)</span>&nbsp;<span class="op" id="4320594">(</span><span class="ident" id="4320595">sum224</span>&nbsp;<span class="op" id="4320602">[</span><span class="ident" id="4320603">Size224</span><span class="op" id="4320610">]</span><span class="builtintype" id="4320611">byte</span><span class="op" id="4320615">)</span>&nbsp;<span class="op" id="4320617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320620">var</span>&nbsp;<span class="ident" id="4320624">d</span>&nbsp;<span class="ident" id="4320626">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320634">d</span><span class="op" id="4320635">.</span><span class="ident" id="4320636">is224</span>&nbsp;<span class="op" id="4320642">=</span>&nbsp;<span class="builtintype" id="4320644">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320650">d</span><span class="op" id="4320651">.</span><span class="ident" id="4320652">Reset</span><span class="op" id="4320657">(</span><span class="op" id="4320658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320661">d</span><span class="op" id="4320662">.</span><span class="ident" id="4320663">Write</span><span class="op" id="4320668">(</span><span class="ident" id="4320669">data</span><span class="op" id="4320673">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320676">sum</span>&nbsp;<span class="op" id="4320680">:=</span>&nbsp;<span class="ident" id="4320683">d</span><span class="op" id="4320684">.</span><span class="ident" id="4320685">checkSum</span><span class="op" id="4320693">(</span><span class="op" id="4320694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4320697">copy</span><span class="op" id="4320701">(</span><span class="ident" id="4320702">sum224</span><span class="op" id="4320708">[</span><span class="op" id="4320709">:</span><span class="op" id="4320710">]</span><span class="op" id="4320711">,</span>&nbsp;<span class="ident" id="4320713">sum</span><span class="op" id="4320716">[</span><span class="op" id="4320717">:</span><span class="ident" id="4320718">Size224</span><span class="op" id="4320725">]</span><span class="op" id="4320726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320729">return</span><br>
<span class="lineno"></span><span class="op" id="4320736">}</span>
</div>
</body>
</html>
