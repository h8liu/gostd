<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2457199">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2457254">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2457308">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2457359">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2457437">package</span>&nbsp;<span class="ident" id="2457445">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2457449">import</span>&nbsp;<span class="op" id="2457456">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2457459">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="2457469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2457472">//&nbsp;The&nbsp;only&nbsp;signal&nbsp;values&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;present&nbsp;on&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span><span class="comment" id="2457538">//&nbsp;are&nbsp;Interrupt&nbsp;(send&nbsp;the&nbsp;process&nbsp;an&nbsp;interrupt)&nbsp;and&nbsp;Kill&nbsp;(force</span><br>
<span class="lineno">15</span><span class="comment" id="2457603">//&nbsp;the&nbsp;process&nbsp;to&nbsp;exit).</span><br>
<span class="lineno"></span><span class="keyword" id="2457628">var</span>&nbsp;<span class="op" id="2457632">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457635">Interrupt</span>&nbsp;<span class="ident" id="2457645">Signal</span>&nbsp;<span class="op" id="2457652">=</span>&nbsp;<span class="ident" id="2457654">syscall</span><span class="op" id="2457661">.</span><span class="ident" id="2457662">SIGINT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457670">Kill</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457680">Signal</span>&nbsp;<span class="op" id="2457687">=</span>&nbsp;<span class="ident" id="2457689">syscall</span><span class="op" id="2457696">.</span><span class="ident" id="2457697">SIGKILL</span><br>
<span class="lineno"></span><span class="op" id="2457705">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2457708">func</span>&nbsp;<span class="ident" id="2457713">startProcess</span><span class="op" id="2457725">(</span><span class="ident" id="2457726">name</span>&nbsp;<span class="builtintype" id="2457731">string</span><span class="op" id="2457737">,</span>&nbsp;<span class="ident" id="2457739">argv</span>&nbsp;<span class="op" id="2457744">[</span><span class="op" id="2457745">]</span><span class="builtintype" id="2457746">string</span><span class="op" id="2457752">,</span>&nbsp;<span class="ident" id="2457754">attr</span>&nbsp;<span class="op" id="2457759">*</span><span class="ident" id="2457760">ProcAttr</span><span class="op" id="2457768">)</span>&nbsp;<span class="op" id="2457770">(</span><span class="ident" id="2457771">p</span>&nbsp;<span class="op" id="2457773">*</span><span class="ident" id="2457774">Process</span><span class="op" id="2457781">,</span>&nbsp;<span class="ident" id="2457783">err</span>&nbsp;<span class="builtintype" id="2457787">error</span><span class="op" id="2457792">)</span>&nbsp;<span class="op" id="2457794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457797">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;SysProcAttr&nbsp;(ie.&nbsp;no&nbsp;Chroot&nbsp;or&nbsp;changed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457854">//&nbsp;UID/GID),&nbsp;double-check&nbsp;existence&nbsp;of&nbsp;the&nbsp;directory&nbsp;we&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457916">//&nbsp;to&nbsp;chdir&nbsp;into.&nbsp;&nbsp;We&nbsp;can&nbsp;make&nbsp;the&nbsp;error&nbsp;clearer&nbsp;this&nbsp;way.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457976">if</span>&nbsp;<span class="ident" id="2457979">attr</span>&nbsp;<span class="op" id="2457984">!=</span>&nbsp;<span class="ident" id="2457987">nil</span>&nbsp;<span class="op" id="2457991">&amp;&amp;</span>&nbsp;<span class="ident" id="2457994">attr</span><span class="op" id="2457998">.</span><span class="ident" id="2457999">Sys</span>&nbsp;<span class="op" id="2458003">==</span>&nbsp;<span class="ident" id="2458006">nil</span>&nbsp;<span class="op" id="2458010">&amp;&amp;</span>&nbsp;<span class="ident" id="2458013">attr</span><span class="op" id="2458017">.</span><span class="ident" id="2458018">Dir</span>&nbsp;<span class="op" id="2458022">!=</span>&nbsp;<span class="string" id="2458025">&#34;&#34;</span>&nbsp;<span class="op" id="2458028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458032">if</span>&nbsp;<span class="ident" id="2458035">_</span><span class="op" id="2458036">,</span>&nbsp;<span class="ident" id="2458038">err</span>&nbsp;<span class="op" id="2458042">:=</span>&nbsp;<span class="ident" id="2458045">Stat</span><span class="op" id="2458049">(</span><span class="ident" id="2458050">attr</span><span class="op" id="2458054">.</span><span class="ident" id="2458055">Dir</span><span class="op" id="2458058">)</span><span class="op" id="2458059">;</span>&nbsp;<span class="ident" id="2458061">err</span>&nbsp;<span class="op" id="2458065">!=</span>&nbsp;<span class="ident" id="2458068">nil</span>&nbsp;<span class="op" id="2458072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458077">pe</span>&nbsp;<span class="op" id="2458080">:=</span>&nbsp;<span class="ident" id="2458083">err</span><span class="op" id="2458086">.</span><span class="op" id="2458087">(</span><span class="op" id="2458088">*</span><span class="ident" id="2458089">PathError</span><span class="op" id="2458098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458103">pe</span><span class="op" id="2458105">.</span><span class="ident" id="2458106">Op</span>&nbsp;<span class="op" id="2458109">=</span>&nbsp;<span class="string" id="2458111">&#34;chdir&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458122">return</span>&nbsp;<span class="ident" id="2458129">nil</span><span class="op" id="2458132">,</span>&nbsp;<span class="ident" id="2458134">pe</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458146">sysattr</span>&nbsp;<span class="op" id="2458154">:=</span>&nbsp;<span class="op" id="2458157">&amp;</span><span class="ident" id="2458158">syscall</span><span class="op" id="2458165">.</span><span class="ident" id="2458166">ProcAttr</span><span class="op" id="2458174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458178">Dir</span><span class="op" id="2458181">:</span>&nbsp;<span class="ident" id="2458183">attr</span><span class="op" id="2458187">.</span><span class="ident" id="2458188">Dir</span><span class="op" id="2458191">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458195">Env</span><span class="op" id="2458198">:</span>&nbsp;<span class="ident" id="2458200">attr</span><span class="op" id="2458204">.</span><span class="ident" id="2458205">Env</span><span class="op" id="2458208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458212">Sys</span><span class="op" id="2458215">:</span>&nbsp;<span class="ident" id="2458217">attr</span><span class="op" id="2458221">.</span><span class="ident" id="2458222">Sys</span><span class="op" id="2458225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458231">if</span>&nbsp;<span class="ident" id="2458234">sysattr</span><span class="op" id="2458241">.</span><span class="ident" id="2458242">Env</span>&nbsp;<span class="op" id="2458246">==</span>&nbsp;<span class="ident" id="2458249">nil</span>&nbsp;<span class="op" id="2458253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458257">sysattr</span><span class="op" id="2458264">.</span><span class="ident" id="2458265">Env</span>&nbsp;<span class="op" id="2458269">=</span>&nbsp;<span class="ident" id="2458271">Environ</span><span class="op" id="2458278">(</span><span class="op" id="2458279">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458285">for</span>&nbsp;<span class="ident" id="2458289">_</span><span class="op" id="2458290">,</span>&nbsp;<span class="ident" id="2458292">f</span>&nbsp;<span class="op" id="2458294">:=</span>&nbsp;<span class="keyword" id="2458297">range</span>&nbsp;<span class="ident" id="2458303">attr</span><span class="op" id="2458307">.</span><span class="ident" id="2458308">Files</span>&nbsp;<span class="op" id="2458314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458318">sysattr</span><span class="op" id="2458325">.</span><span class="ident" id="2458326">Files</span>&nbsp;<span class="op" id="2458332">=</span>&nbsp;<span class="builtinfunc" id="2458334">append</span><span class="op" id="2458340">(</span><span class="ident" id="2458341">sysattr</span><span class="op" id="2458348">.</span><span class="ident" id="2458349">Files</span><span class="op" id="2458354">,</span>&nbsp;<span class="ident" id="2458356">f</span><span class="op" id="2458357">.</span><span class="ident" id="2458358">Fd</span><span class="op" id="2458360">(</span><span class="op" id="2458361">)</span><span class="op" id="2458362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458369">pid</span><span class="op" id="2458372">,</span>&nbsp;<span class="ident" id="2458374">h</span><span class="op" id="2458375">,</span>&nbsp;<span class="ident" id="2458377">e</span>&nbsp;<span class="op" id="2458379">:=</span>&nbsp;<span class="ident" id="2458382">syscall</span><span class="op" id="2458389">.</span><span class="ident" id="2458390">StartProcess</span><span class="op" id="2458402">(</span><span class="ident" id="2458403">name</span><span class="op" id="2458407">,</span>&nbsp;<span class="ident" id="2458409">argv</span><span class="op" id="2458413">,</span>&nbsp;<span class="ident" id="2458415">sysattr</span><span class="op" id="2458422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458425">if</span>&nbsp;<span class="ident" id="2458428">e</span>&nbsp;<span class="op" id="2458430">!=</span>&nbsp;<span class="ident" id="2458433">nil</span>&nbsp;<span class="op" id="2458437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458441">return</span>&nbsp;<span class="ident" id="2458448">nil</span><span class="op" id="2458451">,</span>&nbsp;<span class="op" id="2458453">&amp;</span><span class="ident" id="2458454">PathError</span><span class="op" id="2458463">{</span><span class="string" id="2458464">&#34;fork/exec&#34;</span><span class="op" id="2458475">,</span>&nbsp;<span class="ident" id="2458477">name</span><span class="op" id="2458481">,</span>&nbsp;<span class="ident" id="2458483">e</span><span class="op" id="2458484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458490">return</span>&nbsp;<span class="ident" id="2458497">newProcess</span><span class="op" id="2458507">(</span><span class="ident" id="2458508">pid</span><span class="op" id="2458511">,</span>&nbsp;<span class="ident" id="2458513">h</span><span class="op" id="2458514">)</span><span class="op" id="2458515">,</span>&nbsp;<span class="ident" id="2458517">nil</span><br>
<span class="lineno">50</span><span class="op" id="2458521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2458524">func</span>&nbsp;<span class="op" id="2458529">(</span><span class="ident" id="2458530">p</span>&nbsp;<span class="op" id="2458532">*</span><span class="ident" id="2458533">Process</span><span class="op" id="2458540">)</span>&nbsp;<span class="ident" id="2458542">kill</span><span class="op" id="2458546">(</span><span class="op" id="2458547">)</span>&nbsp;<span class="builtintype" id="2458549">error</span>&nbsp;<span class="op" id="2458555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458558">return</span>&nbsp;<span class="ident" id="2458565">p</span><span class="op" id="2458566">.</span><span class="ident" id="2458567">Signal</span><span class="op" id="2458573">(</span><span class="ident" id="2458574">Kill</span><span class="op" id="2458578">)</span><br>
<span class="lineno"></span><span class="op" id="2458580">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2458583">//&nbsp;ProcessState&nbsp;stores&nbsp;information&nbsp;about&nbsp;a&nbsp;process,&nbsp;as&nbsp;reported&nbsp;by&nbsp;Wait.</span><br>
<span class="lineno"></span><span class="keyword" id="2458656">type</span>&nbsp;<span class="ident" id="2458661">ProcessState</span>&nbsp;<span class="keyword" id="2458674">struct</span>&nbsp;<span class="op" id="2458681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458684">pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2458691">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2458710">//&nbsp;The&nbsp;process&#39;s&nbsp;id.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458732">status</span>&nbsp;<span class="ident" id="2458739">syscall</span><span class="op" id="2458746">.</span><span class="ident" id="2458747">WaitStatus</span>&nbsp;<span class="comment" id="2458758">//&nbsp;System-dependent&nbsp;status&nbsp;info.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458792">rusage</span>&nbsp;<span class="op" id="2458799">*</span><span class="ident" id="2458800">syscall</span><span class="op" id="2458807">.</span><span class="ident" id="2458808">Rusage</span><br>
<span class="lineno"></span><span class="op" id="2458815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2458818">//&nbsp;Pid&nbsp;returns&nbsp;the&nbsp;process&nbsp;id&nbsp;of&nbsp;the&nbsp;exited&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="2458871">func</span>&nbsp;<span class="op" id="2458876">(</span><span class="ident" id="2458877">p</span>&nbsp;<span class="op" id="2458879">*</span><span class="ident" id="2458880">ProcessState</span><span class="op" id="2458892">)</span>&nbsp;<span class="ident" id="2458894">Pid</span><span class="op" id="2458897">(</span><span class="op" id="2458898">)</span>&nbsp;<span class="builtintype" id="2458900">int</span>&nbsp;<span class="op" id="2458904">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458907">return</span>&nbsp;<span class="ident" id="2458914">p</span><span class="op" id="2458915">.</span><span class="ident" id="2458916">pid</span><br>
<span class="lineno"></span><span class="op" id="2458920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2458923">func</span>&nbsp;<span class="op" id="2458928">(</span><span class="ident" id="2458929">p</span>&nbsp;<span class="op" id="2458931">*</span><span class="ident" id="2458932">ProcessState</span><span class="op" id="2458944">)</span>&nbsp;<span class="ident" id="2458946">exited</span><span class="op" id="2458952">(</span><span class="op" id="2458953">)</span>&nbsp;<span class="builtintype" id="2458955">bool</span>&nbsp;<span class="op" id="2458960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458963">return</span>&nbsp;<span class="ident" id="2458970">p</span><span class="op" id="2458971">.</span><span class="ident" id="2458972">status</span><span class="op" id="2458978">.</span><span class="ident" id="2458979">Exited</span><span class="op" id="2458985">(</span><span class="op" id="2458986">)</span><br>
<span class="lineno">70</span><span class="op" id="2458988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2458991">func</span>&nbsp;<span class="op" id="2458996">(</span><span class="ident" id="2458997">p</span>&nbsp;<span class="op" id="2458999">*</span><span class="ident" id="2459000">ProcessState</span><span class="op" id="2459012">)</span>&nbsp;<span class="ident" id="2459014">success</span><span class="op" id="2459021">(</span><span class="op" id="2459022">)</span>&nbsp;<span class="builtintype" id="2459024">bool</span>&nbsp;<span class="op" id="2459029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459032">return</span>&nbsp;<span class="ident" id="2459039">p</span><span class="op" id="2459040">.</span><span class="ident" id="2459041">status</span><span class="op" id="2459047">.</span><span class="ident" id="2459048">ExitStatus</span><span class="op" id="2459058">(</span><span class="op" id="2459059">)</span>&nbsp;<span class="op" id="2459061">==</span>&nbsp;<span class="num" id="2459064">0</span><br>
<span class="lineno"></span><span class="op" id="2459066">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="2459069">func</span>&nbsp;<span class="op" id="2459074">(</span><span class="ident" id="2459075">p</span>&nbsp;<span class="op" id="2459077">*</span><span class="ident" id="2459078">ProcessState</span><span class="op" id="2459090">)</span>&nbsp;<span class="ident" id="2459092">sys</span><span class="op" id="2459095">(</span><span class="op" id="2459096">)</span>&nbsp;<span class="keyword" id="2459098">interface</span><span class="op" id="2459107">{</span><span class="op" id="2459108">}</span>&nbsp;<span class="op" id="2459110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459113">return</span>&nbsp;<span class="ident" id="2459120">p</span><span class="op" id="2459121">.</span><span class="ident" id="2459122">status</span><br>
<span class="lineno"></span><span class="op" id="2459129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="2459132">func</span>&nbsp;<span class="op" id="2459137">(</span><span class="ident" id="2459138">p</span>&nbsp;<span class="op" id="2459140">*</span><span class="ident" id="2459141">ProcessState</span><span class="op" id="2459153">)</span>&nbsp;<span class="ident" id="2459155">sysUsage</span><span class="op" id="2459163">(</span><span class="op" id="2459164">)</span>&nbsp;<span class="keyword" id="2459166">interface</span><span class="op" id="2459175">{</span><span class="op" id="2459176">}</span>&nbsp;<span class="op" id="2459178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459181">return</span>&nbsp;<span class="ident" id="2459188">p</span><span class="op" id="2459189">.</span><span class="ident" id="2459190">rusage</span><br>
<span class="lineno"></span><span class="op" id="2459197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459200">//&nbsp;Convert&nbsp;i&nbsp;to&nbsp;decimal&nbsp;string.</span><br>
<span class="lineno">85</span><span class="keyword" id="2459232">func</span>&nbsp;<span class="ident" id="2459237">itod</span><span class="op" id="2459241">(</span><span class="ident" id="2459242">i</span>&nbsp;<span class="builtintype" id="2459244">int</span><span class="op" id="2459247">)</span>&nbsp;<span class="builtintype" id="2459249">string</span>&nbsp;<span class="op" id="2459256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459259">if</span>&nbsp;<span class="ident" id="2459262">i</span>&nbsp;<span class="op" id="2459264">==</span>&nbsp;<span class="num" id="2459267">0</span>&nbsp;<span class="op" id="2459269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459273">return</span>&nbsp;<span class="string" id="2459280">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459289">u</span>&nbsp;<span class="op" id="2459291">:=</span>&nbsp;<span class="ident" id="2459294">uint64</span><span class="op" id="2459300">(</span><span class="ident" id="2459301">i</span><span class="op" id="2459302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459305">if</span>&nbsp;<span class="ident" id="2459308">i</span>&nbsp;<span class="op" id="2459310">&lt;</span>&nbsp;<span class="num" id="2459312">0</span>&nbsp;<span class="op" id="2459314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459318">u</span>&nbsp;<span class="op" id="2459320">=</span>&nbsp;<span class="op" id="2459322">-</span><span class="ident" id="2459323">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2459330">//&nbsp;Assemble&nbsp;decimal&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459369">var</span>&nbsp;<span class="ident" id="2459373">b</span>&nbsp;<span class="op" id="2459375">[</span><span class="num" id="2459376">32</span><span class="op" id="2459378">]</span><span class="builtintype" id="2459379">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459385">bp</span>&nbsp;<span class="op" id="2459388">:=</span>&nbsp;<span class="builtinfunc" id="2459391">len</span><span class="op" id="2459394">(</span><span class="ident" id="2459395">b</span><span class="op" id="2459396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459399">for</span>&nbsp;<span class="op" id="2459403">;</span>&nbsp;<span class="ident" id="2459405">u</span>&nbsp;<span class="op" id="2459407">&gt;</span>&nbsp;<span class="num" id="2459409">0</span><span class="op" id="2459410">;</span>&nbsp;<span class="ident" id="2459412">u</span>&nbsp;<span class="op" id="2459414">/=</span>&nbsp;<span class="num" id="2459417">10</span>&nbsp;<span class="op" id="2459420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459424">bp</span><span class="op" id="2459426">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459431">b</span><span class="op" id="2459432">[</span><span class="ident" id="2459433">bp</span><span class="op" id="2459435">]</span>&nbsp;<span class="op" id="2459437">=</span>&nbsp;<span class="builtintype" id="2459439">byte</span><span class="op" id="2459443">(</span><span class="ident" id="2459444">u</span><span class="op" id="2459445">%</span><span class="num" id="2459446">10</span><span class="op" id="2459448">)</span>&nbsp;<span class="op" id="2459450">+</span>&nbsp;<span class="string" id="2459452">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459461">if</span>&nbsp;<span class="ident" id="2459464">i</span>&nbsp;<span class="op" id="2459466">&lt;</span>&nbsp;<span class="num" id="2459468">0</span>&nbsp;<span class="op" id="2459470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459474">bp</span><span class="op" id="2459476">--</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459481">b</span><span class="op" id="2459482">[</span><span class="ident" id="2459483">bp</span><span class="op" id="2459485">]</span>&nbsp;<span class="op" id="2459487">=</span>&nbsp;<span class="string" id="2459489">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459498">return</span>&nbsp;<span class="builtintype" id="2459505">string</span><span class="op" id="2459511">(</span><span class="ident" id="2459512">b</span><span class="op" id="2459513">[</span><span class="ident" id="2459514">bp</span><span class="op" id="2459516">:</span><span class="op" id="2459517">]</span><span class="op" id="2459518">)</span><br>
<span class="lineno"></span><span class="op" id="2459520">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="2459523">func</span>&nbsp;<span class="op" id="2459528">(</span><span class="ident" id="2459529">p</span>&nbsp;<span class="op" id="2459531">*</span><span class="ident" id="2459532">ProcessState</span><span class="op" id="2459544">)</span>&nbsp;<span class="ident" id="2459546">String</span><span class="op" id="2459552">(</span><span class="op" id="2459553">)</span>&nbsp;<span class="builtintype" id="2459555">string</span>&nbsp;<span class="op" id="2459562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459565">if</span>&nbsp;<span class="ident" id="2459568">p</span>&nbsp;<span class="op" id="2459570">==</span>&nbsp;<span class="ident" id="2459573">nil</span>&nbsp;<span class="op" id="2459577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459581">return</span>&nbsp;<span class="string" id="2459588">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459597">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459600">status</span>&nbsp;<span class="op" id="2459607">:=</span>&nbsp;<span class="ident" id="2459610">p</span><span class="op" id="2459611">.</span><span class="ident" id="2459612">Sys</span><span class="op" id="2459615">(</span><span class="op" id="2459616">)</span><span class="op" id="2459617">.</span><span class="op" id="2459618">(</span><span class="ident" id="2459619">syscall</span><span class="op" id="2459626">.</span><span class="ident" id="2459627">WaitStatus</span><span class="op" id="2459637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459640">res</span>&nbsp;<span class="op" id="2459644">:=</span>&nbsp;<span class="string" id="2459647">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459651">switch</span>&nbsp;<span class="op" id="2459658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459661">case</span>&nbsp;<span class="ident" id="2459666">status</span><span class="op" id="2459672">.</span><span class="ident" id="2459673">Exited</span><span class="op" id="2459679">(</span><span class="op" id="2459680">)</span><span class="op" id="2459681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459685">res</span>&nbsp;<span class="op" id="2459689">=</span>&nbsp;<span class="string" id="2459691">&#34;exit&nbsp;status&nbsp;&#34;</span>&nbsp;<span class="op" id="2459706">+</span>&nbsp;<span class="ident" id="2459708">itod</span><span class="op" id="2459712">(</span><span class="ident" id="2459713">status</span><span class="op" id="2459719">.</span><span class="ident" id="2459720">ExitStatus</span><span class="op" id="2459730">(</span><span class="op" id="2459731">)</span><span class="op" id="2459732">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459735">case</span>&nbsp;<span class="ident" id="2459740">status</span><span class="op" id="2459746">.</span><span class="ident" id="2459747">Signaled</span><span class="op" id="2459755">(</span><span class="op" id="2459756">)</span><span class="op" id="2459757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459761">res</span>&nbsp;<span class="op" id="2459765">=</span>&nbsp;<span class="string" id="2459767">&#34;signal:&nbsp;&#34;</span>&nbsp;<span class="op" id="2459778">+</span>&nbsp;<span class="ident" id="2459780">status</span><span class="op" id="2459786">.</span><span class="ident" id="2459787">Signal</span><span class="op" id="2459793">(</span><span class="op" id="2459794">)</span><span class="op" id="2459795">.</span><span class="ident" id="2459796">String</span><span class="op" id="2459802">(</span><span class="op" id="2459803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459806">case</span>&nbsp;<span class="ident" id="2459811">status</span><span class="op" id="2459817">.</span><span class="ident" id="2459818">Stopped</span><span class="op" id="2459825">(</span><span class="op" id="2459826">)</span><span class="op" id="2459827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459831">res</span>&nbsp;<span class="op" id="2459835">=</span>&nbsp;<span class="string" id="2459837">&#34;stop&nbsp;signal:&nbsp;&#34;</span>&nbsp;<span class="op" id="2459853">+</span>&nbsp;<span class="ident" id="2459855">status</span><span class="op" id="2459861">.</span><span class="ident" id="2459862">StopSignal</span><span class="op" id="2459872">(</span><span class="op" id="2459873">)</span><span class="op" id="2459874">.</span><span class="ident" id="2459875">String</span><span class="op" id="2459881">(</span><span class="op" id="2459882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459886">if</span>&nbsp;<span class="ident" id="2459889">status</span><span class="op" id="2459895">.</span><span class="ident" id="2459896">StopSignal</span><span class="op" id="2459906">(</span><span class="op" id="2459907">)</span>&nbsp;<span class="op" id="2459909">==</span>&nbsp;<span class="ident" id="2459912">syscall</span><span class="op" id="2459919">.</span><span class="ident" id="2459920">SIGTRAP</span>&nbsp;<span class="op" id="2459928">&amp;&amp;</span>&nbsp;<span class="ident" id="2459931">status</span><span class="op" id="2459937">.</span><span class="ident" id="2459938">TrapCause</span><span class="op" id="2459947">(</span><span class="op" id="2459948">)</span>&nbsp;<span class="op" id="2459950">!=</span>&nbsp;<span class="num" id="2459953">0</span>&nbsp;<span class="op" id="2459955">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459960">res</span>&nbsp;<span class="op" id="2459964">+=</span>&nbsp;<span class="string" id="2459967">&#34;&nbsp;(trap&nbsp;&#34;</span>&nbsp;<span class="op" id="2459977">+</span>&nbsp;<span class="ident" id="2459979">itod</span><span class="op" id="2459983">(</span><span class="ident" id="2459984">status</span><span class="op" id="2459990">.</span><span class="ident" id="2459991">TrapCause</span><span class="op" id="2460000">(</span><span class="op" id="2460001">)</span><span class="op" id="2460002">)</span>&nbsp;<span class="op" id="2460004">+</span>&nbsp;<span class="string" id="2460006">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460015">case</span>&nbsp;<span class="ident" id="2460020">status</span><span class="op" id="2460026">.</span><span class="ident" id="2460027">Continued</span><span class="op" id="2460036">(</span><span class="op" id="2460037">)</span><span class="op" id="2460038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460042">res</span>&nbsp;<span class="op" id="2460046">=</span>&nbsp;<span class="string" id="2460048">&#34;continued&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460061">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460064">if</span>&nbsp;<span class="ident" id="2460067">status</span><span class="op" id="2460073">.</span><span class="ident" id="2460074">CoreDump</span><span class="op" id="2460082">(</span><span class="op" id="2460083">)</span>&nbsp;<span class="op" id="2460085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460089">res</span>&nbsp;<span class="op" id="2460093">+=</span>&nbsp;<span class="string" id="2460096">&#34;&nbsp;(core&nbsp;dumped)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460117">return</span>&nbsp;<span class="ident" id="2460124">res</span><br>
<span class="lineno"></span><span class="op" id="2460128">}</span>
</div>
</body>
</html>
