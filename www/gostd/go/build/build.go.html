<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5757386">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5757442">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5757496">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5757547">package</span>&nbsp;<span class="ident" id="5757555">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5757562">import</span>&nbsp;<span class="op" id="5757569">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757572">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757581">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757591">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757598">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757608">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757618">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757631">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757643">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757649">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757662">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757669">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5757675">pathpkg</span>&nbsp;<span class="string" id="5757683">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757691">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757708">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757719">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757727">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757738">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757749">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5757760">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5757775">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5757778">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="5757837">type</span>&nbsp;<span class="ident" id="5757842">Context</span>&nbsp;<span class="keyword" id="5757850">struct</span>&nbsp;<span class="op" id="5757857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5757860">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5757872">string</span>&nbsp;<span class="comment" id="5757879">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5757903">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5757915">string</span>&nbsp;<span class="comment" id="5757922">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5757950">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5757962">string</span>&nbsp;<span class="comment" id="5757969">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5757981">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5757993">string</span>&nbsp;<span class="comment" id="5758000">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5758012">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="5758024">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5758031">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5758059">UseAllFiles</span>&nbsp;<span class="builtintype" id="5758071">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5758078">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5758131">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5758143">string</span>&nbsp;<span class="comment" id="5758150">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758202">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758259">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758329">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758395">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758471">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758557">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758625">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5758687">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5758699">[</span><span class="op" id="5758700">]</span><span class="builtintype" id="5758701">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5758709">ReleaseTags</span>&nbsp;<span class="op" id="5758721">[</span><span class="op" id="5758722">]</span><span class="builtintype" id="5758723">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758732">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758813">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758888">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5758965">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759041">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759115">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5759170">InstallSuffix</span>&nbsp;<span class="builtintype" id="5759184">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759193">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759262">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759326">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759394">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759465">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759521">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759591">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5759642">JoinPath</span>&nbsp;<span class="keyword" id="5759651">func</span><span class="op" id="5759655">(</span><span class="ident" id="5759656">elem</span>&nbsp;<span class="op" id="5759661">...</span><span class="builtintype" id="5759664">string</span><span class="op" id="5759670">)</span>&nbsp;<span class="builtintype" id="5759672">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759681">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759754">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5759815">SplitPathList</span>&nbsp;<span class="keyword" id="5759829">func</span><span class="op" id="5759833">(</span><span class="ident" id="5759834">list</span>&nbsp;<span class="builtintype" id="5759839">string</span><span class="op" id="5759845">)</span>&nbsp;<span class="op" id="5759847">[</span><span class="op" id="5759848">]</span><span class="builtintype" id="5759849">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759858">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5759914">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5759967">IsAbsPath</span>&nbsp;<span class="keyword" id="5759977">func</span><span class="op" id="5759981">(</span><span class="ident" id="5759982">path</span>&nbsp;<span class="builtintype" id="5759987">string</span><span class="op" id="5759993">)</span>&nbsp;<span class="builtintype" id="5759995">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760002">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760056">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5760134">IsDir</span>&nbsp;<span class="keyword" id="5760140">func</span><span class="op" id="5760144">(</span><span class="ident" id="5760145">path</span>&nbsp;<span class="builtintype" id="5760150">string</span><span class="op" id="5760156">)</span>&nbsp;<span class="builtintype" id="5760158">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760165">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760220">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760262">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760323">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760386">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760450">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5760477">HasSubdir</span>&nbsp;<span class="keyword" id="5760487">func</span><span class="op" id="5760491">(</span><span class="ident" id="5760492">root</span><span class="op" id="5760496">,</span>&nbsp;<span class="ident" id="5760498">dir</span>&nbsp;<span class="builtintype" id="5760502">string</span><span class="op" id="5760508">)</span>&nbsp;<span class="op" id="5760510">(</span><span class="ident" id="5760511">rel</span>&nbsp;<span class="builtintype" id="5760515">string</span><span class="op" id="5760521">,</span>&nbsp;<span class="ident" id="5760523">ok</span>&nbsp;<span class="builtintype" id="5760526">bool</span><span class="op" id="5760530">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760534">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760594">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760645">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5760696">ReadDir</span>&nbsp;<span class="keyword" id="5760704">func</span><span class="op" id="5760708">(</span><span class="ident" id="5760709">dir</span>&nbsp;<span class="builtintype" id="5760713">string</span><span class="op" id="5760719">)</span>&nbsp;<span class="op" id="5760721">(</span><span class="ident" id="5760722">fi</span>&nbsp;<span class="op" id="5760725">[</span><span class="op" id="5760726">]</span><span class="ident" id="5760727">os</span><span class="op" id="5760729">.</span><span class="ident" id="5760730">FileInfo</span><span class="op" id="5760738">,</span>&nbsp;<span class="ident" id="5760740">err</span>&nbsp;<span class="builtintype" id="5760744">error</span><span class="op" id="5760749">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760753">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5760810">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5760855">OpenFile</span>&nbsp;<span class="keyword" id="5760864">func</span><span class="op" id="5760868">(</span><span class="ident" id="5760869">path</span>&nbsp;<span class="builtintype" id="5760874">string</span><span class="op" id="5760880">)</span>&nbsp;<span class="op" id="5760882">(</span><span class="ident" id="5760883">r</span>&nbsp;<span class="ident" id="5760885">io</span><span class="op" id="5760887">.</span><span class="ident" id="5760888">ReadCloser</span><span class="op" id="5760898">,</span>&nbsp;<span class="ident" id="5760900">err</span>&nbsp;<span class="builtintype" id="5760904">error</span><span class="op" id="5760909">)</span><br>
<span class="lineno">95</span><span class="op" id="5760911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5760914">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="5760982">func</span>&nbsp;<span class="op" id="5760987">(</span><span class="ident" id="5760988">ctxt</span>&nbsp;<span class="op" id="5760993">*</span><span class="ident" id="5760994">Context</span><span class="op" id="5761001">)</span>&nbsp;<span class="ident" id="5761003">joinPath</span><span class="op" id="5761011">(</span><span class="ident" id="5761012">elem</span>&nbsp;<span class="op" id="5761017">...</span><span class="builtintype" id="5761020">string</span><span class="op" id="5761026">)</span>&nbsp;<span class="builtintype" id="5761028">string</span>&nbsp;<span class="op" id="5761035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761038">if</span>&nbsp;<span class="ident" id="5761041">f</span>&nbsp;<span class="op" id="5761043">:=</span>&nbsp;<span class="ident" id="5761046">ctxt</span><span class="op" id="5761050">.</span><span class="ident" id="5761051">JoinPath</span><span class="op" id="5761059">;</span>&nbsp;<span class="ident" id="5761061">f</span>&nbsp;<span class="op" id="5761063">!=</span>&nbsp;<span class="ident" id="5761066">nil</span>&nbsp;<span class="op" id="5761070">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761074">return</span>&nbsp;<span class="ident" id="5761081">f</span><span class="op" id="5761082">(</span><span class="ident" id="5761083">elem</span><span class="op" id="5761087">...</span><span class="op" id="5761090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5761093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761096">return</span>&nbsp;<span class="ident" id="5761103">filepath</span><span class="op" id="5761111">.</span><span class="ident" id="5761112">Join</span><span class="op" id="5761116">(</span><span class="ident" id="5761117">elem</span><span class="op" id="5761121">...</span><span class="op" id="5761124">)</span><br>
<span class="lineno"></span><span class="op" id="5761126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="5761129">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="5761212">func</span>&nbsp;<span class="op" id="5761217">(</span><span class="ident" id="5761218">ctxt</span>&nbsp;<span class="op" id="5761223">*</span><span class="ident" id="5761224">Context</span><span class="op" id="5761231">)</span>&nbsp;<span class="ident" id="5761233">splitPathList</span><span class="op" id="5761246">(</span><span class="ident" id="5761247">s</span>&nbsp;<span class="builtintype" id="5761249">string</span><span class="op" id="5761255">)</span>&nbsp;<span class="op" id="5761257">[</span><span class="op" id="5761258">]</span><span class="builtintype" id="5761259">string</span>&nbsp;<span class="op" id="5761266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761269">if</span>&nbsp;<span class="ident" id="5761272">f</span>&nbsp;<span class="op" id="5761274">:=</span>&nbsp;<span class="ident" id="5761277">ctxt</span><span class="op" id="5761281">.</span><span class="ident" id="5761282">SplitPathList</span><span class="op" id="5761295">;</span>&nbsp;<span class="ident" id="5761297">f</span>&nbsp;<span class="op" id="5761299">!=</span>&nbsp;<span class="ident" id="5761302">nil</span>&nbsp;<span class="op" id="5761306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761310">return</span>&nbsp;<span class="ident" id="5761317">f</span><span class="op" id="5761318">(</span><span class="ident" id="5761319">s</span><span class="op" id="5761320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5761323">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761326">return</span>&nbsp;<span class="ident" id="5761333">filepath</span><span class="op" id="5761341">.</span><span class="ident" id="5761342">SplitList</span><span class="op" id="5761351">(</span><span class="ident" id="5761352">s</span><span class="op" id="5761353">)</span><br>
<span class="lineno"></span><span class="op" id="5761355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5761358">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="5761430">func</span>&nbsp;<span class="op" id="5761435">(</span><span class="ident" id="5761436">ctxt</span>&nbsp;<span class="op" id="5761441">*</span><span class="ident" id="5761442">Context</span><span class="op" id="5761449">)</span>&nbsp;<span class="ident" id="5761451">isAbsPath</span><span class="op" id="5761460">(</span><span class="ident" id="5761461">path</span>&nbsp;<span class="builtintype" id="5761466">string</span><span class="op" id="5761472">)</span>&nbsp;<span class="builtintype" id="5761474">bool</span>&nbsp;<span class="op" id="5761479">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761482">if</span>&nbsp;<span class="ident" id="5761485">f</span>&nbsp;<span class="op" id="5761487">:=</span>&nbsp;<span class="ident" id="5761490">ctxt</span><span class="op" id="5761494">.</span><span class="ident" id="5761495">IsAbsPath</span><span class="op" id="5761504">;</span>&nbsp;<span class="ident" id="5761506">f</span>&nbsp;<span class="op" id="5761508">!=</span>&nbsp;<span class="ident" id="5761511">nil</span>&nbsp;<span class="op" id="5761515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761519">return</span>&nbsp;<span class="ident" id="5761526">f</span><span class="op" id="5761527">(</span><span class="ident" id="5761528">path</span><span class="op" id="5761532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5761535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761538">return</span>&nbsp;<span class="ident" id="5761545">filepath</span><span class="op" id="5761553">.</span><span class="ident" id="5761554">IsAbs</span><span class="op" id="5761559">(</span><span class="ident" id="5761560">path</span><span class="op" id="5761564">)</span><br>
<span class="lineno"></span><span class="op" id="5761566">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="5761569">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="5761630">func</span>&nbsp;<span class="op" id="5761635">(</span><span class="ident" id="5761636">ctxt</span>&nbsp;<span class="op" id="5761641">*</span><span class="ident" id="5761642">Context</span><span class="op" id="5761649">)</span>&nbsp;<span class="ident" id="5761651">isDir</span><span class="op" id="5761656">(</span><span class="ident" id="5761657">path</span>&nbsp;<span class="builtintype" id="5761662">string</span><span class="op" id="5761668">)</span>&nbsp;<span class="builtintype" id="5761670">bool</span>&nbsp;<span class="op" id="5761675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761678">if</span>&nbsp;<span class="ident" id="5761681">f</span>&nbsp;<span class="op" id="5761683">:=</span>&nbsp;<span class="ident" id="5761686">ctxt</span><span class="op" id="5761690">.</span><span class="ident" id="5761691">IsDir</span><span class="op" id="5761696">;</span>&nbsp;<span class="ident" id="5761698">f</span>&nbsp;<span class="op" id="5761700">!=</span>&nbsp;<span class="ident" id="5761703">nil</span>&nbsp;<span class="op" id="5761707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761711">return</span>&nbsp;<span class="ident" id="5761718">f</span><span class="op" id="5761719">(</span><span class="ident" id="5761720">path</span><span class="op" id="5761724">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5761727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5761730">fi</span><span class="op" id="5761732">,</span>&nbsp;<span class="ident" id="5761734">err</span>&nbsp;<span class="op" id="5761738">:=</span>&nbsp;<span class="ident" id="5761741">os</span><span class="op" id="5761743">.</span><span class="ident" id="5761744">Stat</span><span class="op" id="5761748">(</span><span class="ident" id="5761749">path</span><span class="op" id="5761753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761756">return</span>&nbsp;<span class="ident" id="5761763">err</span>&nbsp;<span class="op" id="5761767">==</span>&nbsp;<span class="ident" id="5761770">nil</span>&nbsp;<span class="op" id="5761774">&amp;&amp;</span>&nbsp;<span class="ident" id="5761777">fi</span><span class="op" id="5761779">.</span><span class="ident" id="5761780">IsDir</span><span class="op" id="5761785">(</span><span class="op" id="5761786">)</span><br>
<span class="lineno"></span><span class="op" id="5761788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5761791">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5761851">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="5761900">func</span>&nbsp;<span class="op" id="5761905">(</span><span class="ident" id="5761906">ctxt</span>&nbsp;<span class="op" id="5761911">*</span><span class="ident" id="5761912">Context</span><span class="op" id="5761919">)</span>&nbsp;<span class="ident" id="5761921">hasSubdir</span><span class="op" id="5761930">(</span><span class="ident" id="5761931">root</span><span class="op" id="5761935">,</span>&nbsp;<span class="ident" id="5761937">dir</span>&nbsp;<span class="builtintype" id="5761941">string</span><span class="op" id="5761947">)</span>&nbsp;<span class="op" id="5761949">(</span><span class="ident" id="5761950">rel</span>&nbsp;<span class="builtintype" id="5761954">string</span><span class="op" id="5761960">,</span>&nbsp;<span class="ident" id="5761962">ok</span>&nbsp;<span class="builtintype" id="5761965">bool</span><span class="op" id="5761969">)</span>&nbsp;<span class="op" id="5761971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5761974">if</span>&nbsp;<span class="ident" id="5761977">f</span>&nbsp;<span class="op" id="5761979">:=</span>&nbsp;<span class="ident" id="5761982">ctxt</span><span class="op" id="5761986">.</span><span class="ident" id="5761987">HasSubdir</span><span class="op" id="5761996">;</span>&nbsp;<span class="ident" id="5761998">f</span>&nbsp;<span class="op" id="5762000">!=</span>&nbsp;<span class="ident" id="5762003">nil</span>&nbsp;<span class="op" id="5762007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762011">return</span>&nbsp;<span class="ident" id="5762018">f</span><span class="op" id="5762019">(</span><span class="ident" id="5762020">root</span><span class="op" id="5762024">,</span>&nbsp;<span class="ident" id="5762026">dir</span><span class="op" id="5762029">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5762032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5762036">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762069">if</span>&nbsp;<span class="ident" id="5762072">rel</span><span class="op" id="5762075">,</span>&nbsp;<span class="ident" id="5762077">ok</span>&nbsp;<span class="op" id="5762080">=</span>&nbsp;<span class="ident" id="5762082">hasSubdir</span><span class="op" id="5762091">(</span><span class="ident" id="5762092">root</span><span class="op" id="5762096">,</span>&nbsp;<span class="ident" id="5762098">dir</span><span class="op" id="5762101">)</span><span class="op" id="5762102">;</span>&nbsp;<span class="ident" id="5762104">ok</span>&nbsp;<span class="op" id="5762107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762111">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5762119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5762123">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5762164">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5762200">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762231">rootSym</span><span class="op" id="5762238">,</span>&nbsp;<span class="ident" id="5762240">_</span>&nbsp;<span class="op" id="5762242">:=</span>&nbsp;<span class="ident" id="5762245">filepath</span><span class="op" id="5762253">.</span><span class="ident" id="5762254">EvalSymlinks</span><span class="op" id="5762266">(</span><span class="ident" id="5762267">root</span><span class="op" id="5762271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762274">dirSym</span><span class="op" id="5762280">,</span>&nbsp;<span class="ident" id="5762282">_</span>&nbsp;<span class="op" id="5762284">:=</span>&nbsp;<span class="ident" id="5762287">filepath</span><span class="op" id="5762295">.</span><span class="ident" id="5762296">EvalSymlinks</span><span class="op" id="5762308">(</span><span class="ident" id="5762309">dir</span><span class="op" id="5762312">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762316">if</span>&nbsp;<span class="ident" id="5762319">rel</span><span class="op" id="5762322">,</span>&nbsp;<span class="ident" id="5762324">ok</span>&nbsp;<span class="op" id="5762327">=</span>&nbsp;<span class="ident" id="5762329">hasSubdir</span><span class="op" id="5762338">(</span><span class="ident" id="5762339">rootSym</span><span class="op" id="5762346">,</span>&nbsp;<span class="ident" id="5762348">dir</span><span class="op" id="5762351">)</span><span class="op" id="5762352">;</span>&nbsp;<span class="ident" id="5762354">ok</span>&nbsp;<span class="op" id="5762357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762361">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5762369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762372">if</span>&nbsp;<span class="ident" id="5762375">rel</span><span class="op" id="5762378">,</span>&nbsp;<span class="ident" id="5762380">ok</span>&nbsp;<span class="op" id="5762383">=</span>&nbsp;<span class="ident" id="5762385">hasSubdir</span><span class="op" id="5762394">(</span><span class="ident" id="5762395">root</span><span class="op" id="5762399">,</span>&nbsp;<span class="ident" id="5762401">dirSym</span><span class="op" id="5762407">)</span><span class="op" id="5762408">;</span>&nbsp;<span class="ident" id="5762410">ok</span>&nbsp;<span class="op" id="5762413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762417">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5762425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762428">return</span>&nbsp;<span class="ident" id="5762435">hasSubdir</span><span class="op" id="5762444">(</span><span class="ident" id="5762445">rootSym</span><span class="op" id="5762452">,</span>&nbsp;<span class="ident" id="5762454">dirSym</span><span class="op" id="5762460">)</span><br>
<span class="lineno">155</span><span class="op" id="5762462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5762465">func</span>&nbsp;<span class="ident" id="5762470">hasSubdir</span><span class="op" id="5762479">(</span><span class="ident" id="5762480">root</span><span class="op" id="5762484">,</span>&nbsp;<span class="ident" id="5762486">dir</span>&nbsp;<span class="builtintype" id="5762490">string</span><span class="op" id="5762496">)</span>&nbsp;<span class="op" id="5762498">(</span><span class="ident" id="5762499">rel</span>&nbsp;<span class="builtintype" id="5762503">string</span><span class="op" id="5762509">,</span>&nbsp;<span class="ident" id="5762511">ok</span>&nbsp;<span class="builtintype" id="5762514">bool</span><span class="op" id="5762518">)</span>&nbsp;<span class="op" id="5762520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762523">const</span>&nbsp;<span class="ident" id="5762529">sep</span>&nbsp;<span class="op" id="5762533">=</span>&nbsp;<span class="builtintype" id="5762535">string</span><span class="op" id="5762541">(</span><span class="ident" id="5762542">filepath</span><span class="op" id="5762550">.</span><span class="ident" id="5762551">Separator</span><span class="op" id="5762560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762563">root</span>&nbsp;<span class="op" id="5762568">=</span>&nbsp;<span class="ident" id="5762570">filepath</span><span class="op" id="5762578">.</span><span class="ident" id="5762579">Clean</span><span class="op" id="5762584">(</span><span class="ident" id="5762585">root</span><span class="op" id="5762589">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762592">if</span>&nbsp;<span class="op" id="5762595">!</span><span class="ident" id="5762596">strings</span><span class="op" id="5762603">.</span><span class="ident" id="5762604">HasSuffix</span><span class="op" id="5762613">(</span><span class="ident" id="5762614">root</span><span class="op" id="5762618">,</span>&nbsp;<span class="ident" id="5762620">sep</span><span class="op" id="5762623">)</span>&nbsp;<span class="op" id="5762625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762629">root</span>&nbsp;<span class="op" id="5762634">+=</span>&nbsp;<span class="ident" id="5762637">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5762642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762645">dir</span>&nbsp;<span class="op" id="5762649">=</span>&nbsp;<span class="ident" id="5762651">filepath</span><span class="op" id="5762659">.</span><span class="ident" id="5762660">Clean</span><span class="op" id="5762665">(</span><span class="ident" id="5762666">dir</span><span class="op" id="5762669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762672">if</span>&nbsp;<span class="op" id="5762675">!</span><span class="ident" id="5762676">strings</span><span class="op" id="5762683">.</span><span class="ident" id="5762684">HasPrefix</span><span class="op" id="5762693">(</span><span class="ident" id="5762694">dir</span><span class="op" id="5762697">,</span>&nbsp;<span class="ident" id="5762699">root</span><span class="op" id="5762703">)</span>&nbsp;<span class="op" id="5762705">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762709">return</span>&nbsp;<span class="string" id="5762716">&#34;&#34;</span><span class="op" id="5762718">,</span>&nbsp;<span class="builtintype" id="5762720">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5762727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762730">return</span>&nbsp;<span class="ident" id="5762737">filepath</span><span class="op" id="5762745">.</span><span class="ident" id="5762746">ToSlash</span><span class="op" id="5762753">(</span><span class="ident" id="5762754">dir</span><span class="op" id="5762757">[</span><span class="builtinfunc" id="5762758">len</span><span class="op" id="5762761">(</span><span class="ident" id="5762762">root</span><span class="op" id="5762766">)</span><span class="op" id="5762767">:</span><span class="op" id="5762768">]</span><span class="op" id="5762769">)</span><span class="op" id="5762770">,</span>&nbsp;<span class="builtintype" id="5762772">true</span><br>
<span class="lineno"></span><span class="op" id="5762777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5762780">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="5762847">func</span>&nbsp;<span class="op" id="5762852">(</span><span class="ident" id="5762853">ctxt</span>&nbsp;<span class="op" id="5762858">*</span><span class="ident" id="5762859">Context</span><span class="op" id="5762866">)</span>&nbsp;<span class="ident" id="5762868">readDir</span><span class="op" id="5762875">(</span><span class="ident" id="5762876">path</span>&nbsp;<span class="builtintype" id="5762881">string</span><span class="op" id="5762887">)</span>&nbsp;<span class="op" id="5762889">(</span><span class="op" id="5762890">[</span><span class="op" id="5762891">]</span><span class="ident" id="5762892">os</span><span class="op" id="5762894">.</span><span class="ident" id="5762895">FileInfo</span><span class="op" id="5762903">,</span>&nbsp;<span class="builtintype" id="5762905">error</span><span class="op" id="5762910">)</span>&nbsp;<span class="op" id="5762912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762915">if</span>&nbsp;<span class="ident" id="5762918">f</span>&nbsp;<span class="op" id="5762920">:=</span>&nbsp;<span class="ident" id="5762923">ctxt</span><span class="op" id="5762927">.</span><span class="ident" id="5762928">ReadDir</span><span class="op" id="5762935">;</span>&nbsp;<span class="ident" id="5762937">f</span>&nbsp;<span class="op" id="5762939">!=</span>&nbsp;<span class="ident" id="5762942">nil</span>&nbsp;<span class="op" id="5762946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762950">return</span>&nbsp;<span class="ident" id="5762957">f</span><span class="op" id="5762958">(</span><span class="ident" id="5762959">path</span><span class="op" id="5762963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5762966">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5762969">return</span>&nbsp;<span class="ident" id="5762976">ioutil</span><span class="op" id="5762982">.</span><span class="ident" id="5762983">ReadDir</span><span class="op" id="5762990">(</span><span class="ident" id="5762991">path</span><span class="op" id="5762995">)</span><br>
<span class="lineno"></span><span class="op" id="5762997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5763000">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="5763062">func</span>&nbsp;<span class="op" id="5763067">(</span><span class="ident" id="5763068">ctxt</span>&nbsp;<span class="op" id="5763073">*</span><span class="ident" id="5763074">Context</span><span class="op" id="5763081">)</span>&nbsp;<span class="ident" id="5763083">openFile</span><span class="op" id="5763091">(</span><span class="ident" id="5763092">path</span>&nbsp;<span class="builtintype" id="5763097">string</span><span class="op" id="5763103">)</span>&nbsp;<span class="op" id="5763105">(</span><span class="ident" id="5763106">io</span><span class="op" id="5763108">.</span><span class="ident" id="5763109">ReadCloser</span><span class="op" id="5763119">,</span>&nbsp;<span class="builtintype" id="5763121">error</span><span class="op" id="5763126">)</span>&nbsp;<span class="op" id="5763128">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763131">if</span>&nbsp;<span class="ident" id="5763134">fn</span>&nbsp;<span class="op" id="5763137">:=</span>&nbsp;<span class="ident" id="5763140">ctxt</span><span class="op" id="5763144">.</span><span class="ident" id="5763145">OpenFile</span><span class="op" id="5763153">;</span>&nbsp;<span class="ident" id="5763155">fn</span>&nbsp;<span class="op" id="5763158">!=</span>&nbsp;<span class="ident" id="5763161">nil</span>&nbsp;<span class="op" id="5763165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763169">return</span>&nbsp;<span class="ident" id="5763176">fn</span><span class="op" id="5763178">(</span><span class="ident" id="5763179">path</span><span class="op" id="5763183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763190">f</span><span class="op" id="5763191">,</span>&nbsp;<span class="ident" id="5763193">err</span>&nbsp;<span class="op" id="5763197">:=</span>&nbsp;<span class="ident" id="5763200">os</span><span class="op" id="5763202">.</span><span class="ident" id="5763203">Open</span><span class="op" id="5763207">(</span><span class="ident" id="5763208">path</span><span class="op" id="5763212">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763215">if</span>&nbsp;<span class="ident" id="5763218">err</span>&nbsp;<span class="op" id="5763222">!=</span>&nbsp;<span class="ident" id="5763225">nil</span>&nbsp;<span class="op" id="5763229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763233">return</span>&nbsp;<span class="ident" id="5763240">nil</span><span class="op" id="5763243">,</span>&nbsp;<span class="ident" id="5763245">err</span>&nbsp;<span class="comment" id="5763249">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763270">return</span>&nbsp;<span class="ident" id="5763277">f</span><span class="op" id="5763278">,</span>&nbsp;<span class="ident" id="5763280">nil</span><br>
<span class="lineno"></span><span class="op" id="5763284">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5763287">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5763353">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5763417">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="5763437">func</span>&nbsp;<span class="op" id="5763442">(</span><span class="ident" id="5763443">ctxt</span>&nbsp;<span class="op" id="5763448">*</span><span class="ident" id="5763449">Context</span><span class="op" id="5763456">)</span>&nbsp;<span class="ident" id="5763458">isFile</span><span class="op" id="5763464">(</span><span class="ident" id="5763465">path</span>&nbsp;<span class="builtintype" id="5763470">string</span><span class="op" id="5763476">)</span>&nbsp;<span class="builtintype" id="5763478">bool</span>&nbsp;<span class="op" id="5763483">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763486">f</span><span class="op" id="5763487">,</span>&nbsp;<span class="ident" id="5763489">err</span>&nbsp;<span class="op" id="5763493">:=</span>&nbsp;<span class="ident" id="5763496">ctxt</span><span class="op" id="5763500">.</span><span class="ident" id="5763501">openFile</span><span class="op" id="5763509">(</span><span class="ident" id="5763510">path</span><span class="op" id="5763514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763517">if</span>&nbsp;<span class="ident" id="5763520">err</span>&nbsp;<span class="op" id="5763524">!=</span>&nbsp;<span class="ident" id="5763527">nil</span>&nbsp;<span class="op" id="5763531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763535">return</span>&nbsp;<span class="builtintype" id="5763542">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763552">f</span><span class="op" id="5763553">.</span><span class="ident" id="5763554">Close</span><span class="op" id="5763559">(</span><span class="op" id="5763560">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763563">return</span>&nbsp;<span class="builtintype" id="5763570">true</span><br>
<span class="lineno"></span><span class="op" id="5763575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5763578">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="5763629">func</span>&nbsp;<span class="op" id="5763634">(</span><span class="ident" id="5763635">ctxt</span>&nbsp;<span class="op" id="5763640">*</span><span class="ident" id="5763641">Context</span><span class="op" id="5763648">)</span>&nbsp;<span class="ident" id="5763650">gopath</span><span class="op" id="5763656">(</span><span class="op" id="5763657">)</span>&nbsp;<span class="op" id="5763659">[</span><span class="op" id="5763660">]</span><span class="builtintype" id="5763661">string</span>&nbsp;<span class="op" id="5763668">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763671">var</span>&nbsp;<span class="ident" id="5763675">all</span>&nbsp;<span class="op" id="5763679">[</span><span class="op" id="5763680">]</span><span class="builtintype" id="5763681">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763689">for</span>&nbsp;<span class="ident" id="5763693">_</span><span class="op" id="5763694">,</span>&nbsp;<span class="ident" id="5763696">p</span>&nbsp;<span class="op" id="5763698">:=</span>&nbsp;<span class="keyword" id="5763701">range</span>&nbsp;<span class="ident" id="5763707">ctxt</span><span class="op" id="5763711">.</span><span class="ident" id="5763712">splitPathList</span><span class="op" id="5763725">(</span><span class="ident" id="5763726">ctxt</span><span class="op" id="5763730">.</span><span class="ident" id="5763731">GOPATH</span><span class="op" id="5763737">)</span>&nbsp;<span class="op" id="5763739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763743">if</span>&nbsp;<span class="ident" id="5763746">p</span>&nbsp;<span class="op" id="5763748">==</span>&nbsp;<span class="string" id="5763751">&#34;&#34;</span>&nbsp;<span class="op" id="5763754">||</span>&nbsp;<span class="ident" id="5763757">p</span>&nbsp;<span class="op" id="5763759">==</span>&nbsp;<span class="ident" id="5763762">ctxt</span><span class="op" id="5763766">.</span><span class="ident" id="5763767">GOROOT</span>&nbsp;<span class="op" id="5763774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5763779">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5763816">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5763860">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5763903">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763953">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763968">if</span>&nbsp;<span class="ident" id="5763971">strings</span><span class="op" id="5763978">.</span><span class="ident" id="5763979">HasPrefix</span><span class="op" id="5763988">(</span><span class="ident" id="5763989">p</span><span class="op" id="5763990">,</span>&nbsp;<span class="string" id="5763992">&#34;~&#34;</span><span class="op" id="5763995">)</span>&nbsp;<span class="op" id="5763997">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764002">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764064">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764128">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764173">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764233">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764291">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764358">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764421">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764487">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764546">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764566">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764630">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764658">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5764669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764673">all</span>&nbsp;<span class="op" id="5764677">=</span>&nbsp;<span class="builtinfunc" id="5764679">append</span><span class="op" id="5764685">(</span><span class="ident" id="5764686">all</span><span class="op" id="5764689">,</span>&nbsp;<span class="ident" id="5764691">p</span><span class="op" id="5764692">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5764695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764698">return</span>&nbsp;<span class="ident" id="5764705">all</span><br>
<span class="lineno"></span><span class="op" id="5764709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5764712">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="5764774">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="5764845">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="5764867">func</span>&nbsp;<span class="op" id="5764872">(</span><span class="ident" id="5764873">ctxt</span>&nbsp;<span class="op" id="5764878">*</span><span class="ident" id="5764879">Context</span><span class="op" id="5764886">)</span>&nbsp;<span class="ident" id="5764888">SrcDirs</span><span class="op" id="5764895">(</span><span class="op" id="5764896">)</span>&nbsp;<span class="op" id="5764898">[</span><span class="op" id="5764899">]</span><span class="builtintype" id="5764900">string</span>&nbsp;<span class="op" id="5764907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764910">var</span>&nbsp;<span class="ident" id="5764914">all</span>&nbsp;<span class="op" id="5764918">[</span><span class="op" id="5764919">]</span><span class="builtintype" id="5764920">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764928">if</span>&nbsp;<span class="ident" id="5764931">ctxt</span><span class="op" id="5764935">.</span><span class="ident" id="5764936">GOROOT</span>&nbsp;<span class="op" id="5764943">!=</span>&nbsp;<span class="string" id="5764946">&#34;&#34;</span>&nbsp;<span class="op" id="5764949">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764953">dir</span>&nbsp;<span class="op" id="5764957">:=</span>&nbsp;<span class="ident" id="5764960">ctxt</span><span class="op" id="5764964">.</span><span class="ident" id="5764965">joinPath</span><span class="op" id="5764973">(</span><span class="ident" id="5764974">ctxt</span><span class="op" id="5764978">.</span><span class="ident" id="5764979">GOROOT</span><span class="op" id="5764985">,</span>&nbsp;<span class="string" id="5764987">&#34;src&#34;</span><span class="op" id="5764992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764996">if</span>&nbsp;<span class="ident" id="5764999">ctxt</span><span class="op" id="5765003">.</span><span class="ident" id="5765004">isDir</span><span class="op" id="5765009">(</span><span class="ident" id="5765010">dir</span><span class="op" id="5765013">)</span>&nbsp;<span class="op" id="5765015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765020">all</span>&nbsp;<span class="op" id="5765024">=</span>&nbsp;<span class="builtinfunc" id="5765026">append</span><span class="op" id="5765032">(</span><span class="ident" id="5765033">all</span><span class="op" id="5765036">,</span>&nbsp;<span class="ident" id="5765038">dir</span><span class="op" id="5765041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765048">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765051">for</span>&nbsp;<span class="ident" id="5765055">_</span><span class="op" id="5765056">,</span>&nbsp;<span class="ident" id="5765058">p</span>&nbsp;<span class="op" id="5765060">:=</span>&nbsp;<span class="keyword" id="5765063">range</span>&nbsp;<span class="ident" id="5765069">ctxt</span><span class="op" id="5765073">.</span><span class="ident" id="5765074">gopath</span><span class="op" id="5765080">(</span><span class="op" id="5765081">)</span>&nbsp;<span class="op" id="5765083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765087">dir</span>&nbsp;<span class="op" id="5765091">:=</span>&nbsp;<span class="ident" id="5765094">ctxt</span><span class="op" id="5765098">.</span><span class="ident" id="5765099">joinPath</span><span class="op" id="5765107">(</span><span class="ident" id="5765108">p</span><span class="op" id="5765109">,</span>&nbsp;<span class="string" id="5765111">&#34;src&#34;</span><span class="op" id="5765116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765120">if</span>&nbsp;<span class="ident" id="5765123">ctxt</span><span class="op" id="5765127">.</span><span class="ident" id="5765128">isDir</span><span class="op" id="5765133">(</span><span class="ident" id="5765134">dir</span><span class="op" id="5765137">)</span>&nbsp;<span class="op" id="5765139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765144">all</span>&nbsp;<span class="op" id="5765148">=</span>&nbsp;<span class="builtinfunc" id="5765150">append</span><span class="op" id="5765156">(</span><span class="ident" id="5765157">all</span><span class="op" id="5765160">,</span>&nbsp;<span class="ident" id="5765162">dir</span><span class="op" id="5765165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765169">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765175">return</span>&nbsp;<span class="ident" id="5765182">all</span><br>
<span class="lineno"></span><span class="op" id="5765186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5765189">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="5765235">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="5765305">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="5765370">var</span>&nbsp;<span class="ident" id="5765374">Default</span>&nbsp;<span class="ident" id="5765382">Context</span>&nbsp;<span class="op" id="5765390">=</span>&nbsp;<span class="ident" id="5765392">defaultContext</span><span class="op" id="5765406">(</span><span class="op" id="5765407">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5765410">var</span>&nbsp;<span class="ident" id="5765414">cgoEnabled</span>&nbsp;<span class="op" id="5765425">=</span>&nbsp;<span class="keyword" id="5765427">map</span><span class="op" id="5765430">[</span><span class="builtintype" id="5765431">string</span><span class="op" id="5765437">]</span><span class="builtintype" id="5765438">bool</span><span class="op" id="5765442">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765445">&#34;darwin/386&#34;</span><span class="op" id="5765457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765464">true</span><span class="op" id="5765468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765471">&#34;darwin/amd64&#34;</span><span class="op" id="5765485">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765490">true</span><span class="op" id="5765494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765497">&#34;dragonfly/386&#34;</span><span class="op" id="5765512">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765516">true</span><span class="op" id="5765520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765523">&#34;dragonfly/amd64&#34;</span><span class="op" id="5765540">:</span>&nbsp;<span class="builtintype" id="5765542">true</span><span class="op" id="5765546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765549">&#34;freebsd/386&#34;</span><span class="op" id="5765562">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765568">true</span><span class="op" id="5765572">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765575">&#34;freebsd/amd64&#34;</span><span class="op" id="5765590">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765594">true</span><span class="op" id="5765598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765601">&#34;freebsd/arm&#34;</span><span class="op" id="5765614">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765620">true</span><span class="op" id="5765624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765627">&#34;linux/386&#34;</span><span class="op" id="5765638">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765646">true</span><span class="op" id="5765650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765653">&#34;linux/amd64&#34;</span><span class="op" id="5765666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765672">true</span><span class="op" id="5765676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765679">&#34;linux/arm&#34;</span><span class="op" id="5765690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765698">true</span><span class="op" id="5765702">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765705">&#34;android/386&#34;</span><span class="op" id="5765718">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765724">true</span><span class="op" id="5765728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765731">&#34;android/amd64&#34;</span><span class="op" id="5765746">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765750">true</span><span class="op" id="5765754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765757">&#34;android/arm&#34;</span><span class="op" id="5765770">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765776">true</span><span class="op" id="5765780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765783">&#34;netbsd/386&#34;</span><span class="op" id="5765795">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765802">true</span><span class="op" id="5765806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765809">&#34;netbsd/amd64&#34;</span><span class="op" id="5765823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765828">true</span><span class="op" id="5765832">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765835">&#34;netbsd/arm&#34;</span><span class="op" id="5765847">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765854">true</span><span class="op" id="5765858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765861">&#34;openbsd/386&#34;</span><span class="op" id="5765874">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765880">true</span><span class="op" id="5765884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765887">&#34;openbsd/amd64&#34;</span><span class="op" id="5765902">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765906">true</span><span class="op" id="5765910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765913">&#34;windows/386&#34;</span><span class="op" id="5765926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765932">true</span><span class="op" id="5765936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5765939">&#34;windows/amd64&#34;</span><span class="op" id="5765954">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5765958">true</span><span class="op" id="5765962">,</span><br>
<span class="lineno">280</span><span class="op" id="5765964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5765967">func</span>&nbsp;<span class="ident" id="5765972">defaultContext</span><span class="op" id="5765986">(</span><span class="op" id="5765987">)</span>&nbsp;<span class="ident" id="5765989">Context</span>&nbsp;<span class="op" id="5765997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766000">var</span>&nbsp;<span class="ident" id="5766004">c</span>&nbsp;<span class="ident" id="5766006">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766016">c</span><span class="op" id="5766017">.</span><span class="ident" id="5766018">GOARCH</span>&nbsp;<span class="op" id="5766025">=</span>&nbsp;<span class="ident" id="5766027">envOr</span><span class="op" id="5766032">(</span><span class="string" id="5766033">&#34;GOARCH&#34;</span><span class="op" id="5766041">,</span>&nbsp;<span class="ident" id="5766043">runtime</span><span class="op" id="5766050">.</span><span class="ident" id="5766051">GOARCH</span><span class="op" id="5766057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766060">c</span><span class="op" id="5766061">.</span><span class="ident" id="5766062">GOOS</span>&nbsp;<span class="op" id="5766067">=</span>&nbsp;<span class="ident" id="5766069">envOr</span><span class="op" id="5766074">(</span><span class="string" id="5766075">&#34;GOOS&#34;</span><span class="op" id="5766081">,</span>&nbsp;<span class="ident" id="5766083">runtime</span><span class="op" id="5766090">.</span><span class="ident" id="5766091">GOOS</span><span class="op" id="5766095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766098">c</span><span class="op" id="5766099">.</span><span class="ident" id="5766100">GOROOT</span>&nbsp;<span class="op" id="5766107">=</span>&nbsp;<span class="ident" id="5766109">runtime</span><span class="op" id="5766116">.</span><span class="ident" id="5766117">GOROOT</span><span class="op" id="5766123">(</span><span class="op" id="5766124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766127">c</span><span class="op" id="5766128">.</span><span class="ident" id="5766129">GOPATH</span>&nbsp;<span class="op" id="5766136">=</span>&nbsp;<span class="ident" id="5766138">envOr</span><span class="op" id="5766143">(</span><span class="string" id="5766144">&#34;GOPATH&#34;</span><span class="op" id="5766152">,</span>&nbsp;<span class="string" id="5766154">&#34;&#34;</span><span class="op" id="5766156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766159">c</span><span class="op" id="5766160">.</span><span class="ident" id="5766161">Compiler</span>&nbsp;<span class="op" id="5766170">=</span>&nbsp;<span class="ident" id="5766172">runtime</span><span class="op" id="5766179">.</span><span class="ident" id="5766180">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766191">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766261">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766331">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766404">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766477">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766554">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766558">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766602">//&nbsp;&nbsp;&nbsp;&nbspc.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766676">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766691">c</span><span class="op" id="5766692">.</span><span class="ident" id="5766693">ReleaseTags</span>&nbsp;<span class="op" id="5766705">=</span>&nbsp;<span class="op" id="5766707">[</span><span class="op" id="5766708">]</span><span class="builtintype" id="5766709">string</span><span class="op" id="5766715">{</span><span class="string" id="5766716">&#34;go1.1&#34;</span><span class="op" id="5766723">,</span>&nbsp;<span class="string" id="5766725">&#34;go1.2&#34;</span><span class="op" id="5766732">,</span>&nbsp;<span class="string" id="5766734">&#34;go1.3&#34;</span><span class="op" id="5766741">,</span>&nbsp;<span class="string" id="5766743">&#34;go1.4&#34;</span><span class="op" id="5766750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766754">switch</span>&nbsp;<span class="ident" id="5766761">os</span><span class="op" id="5766763">.</span><span class="ident" id="5766764">Getenv</span><span class="op" id="5766770">(</span><span class="string" id="5766771">&#34;CGO_ENABLED&#34;</span><span class="op" id="5766784">)</span>&nbsp;<span class="op" id="5766786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766789">case</span>&nbsp;<span class="string" id="5766794">&#34;1&#34;</span><span class="op" id="5766797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766801">c</span><span class="op" id="5766802">.</span><span class="ident" id="5766803">CgoEnabled</span>&nbsp;<span class="op" id="5766814">=</span>&nbsp;<span class="builtintype" id="5766816">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766822">case</span>&nbsp;<span class="string" id="5766827">&#34;0&#34;</span><span class="op" id="5766830">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766834">c</span><span class="op" id="5766835">.</span><span class="ident" id="5766836">CgoEnabled</span>&nbsp;<span class="op" id="5766847">=</span>&nbsp;<span class="builtintype" id="5766849">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766856">default</span><span class="op" id="5766863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766867">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766932">if</span>&nbsp;<span class="ident" id="5766935">runtime</span><span class="op" id="5766942">.</span><span class="ident" id="5766943">GOARCH</span>&nbsp;<span class="op" id="5766950">==</span>&nbsp;<span class="ident" id="5766953">c</span><span class="op" id="5766954">.</span><span class="ident" id="5766955">GOARCH</span>&nbsp;<span class="op" id="5766962">&amp;&amp;</span>&nbsp;<span class="ident" id="5766965">runtime</span><span class="op" id="5766972">.</span><span class="ident" id="5766973">GOOS</span>&nbsp;<span class="op" id="5766978">==</span>&nbsp;<span class="ident" id="5766981">c</span><span class="op" id="5766982">.</span><span class="ident" id="5766983">GOOS</span>&nbsp;<span class="op" id="5766988">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766993">c</span><span class="op" id="5766994">.</span><span class="ident" id="5766995">CgoEnabled</span>&nbsp;<span class="op" id="5767006">=</span>&nbsp;<span class="ident" id="5767008">cgoEnabled</span><span class="op" id="5767018">[</span><span class="ident" id="5767019">c</span><span class="op" id="5767020">.</span><span class="ident" id="5767021">GOOS</span><span class="op" id="5767025">+</span><span class="string" id="5767026">&#34;/&#34;</span><span class="op" id="5767029">+</span><span class="ident" id="5767030">c</span><span class="op" id="5767031">.</span><span class="ident" id="5767032">GOARCH</span><span class="op" id="5767038">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767043">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767055">c</span><span class="op" id="5767056">.</span><span class="ident" id="5767057">CgoEnabled</span>&nbsp;<span class="op" id="5767068">=</span>&nbsp;<span class="builtintype" id="5767070">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767077">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767081">return</span>&nbsp;<span class="ident" id="5767088">c</span><br>
<span class="lineno"></span><span class="op" id="5767090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5767093">func</span>&nbsp;<span class="ident" id="5767098">envOr</span><span class="op" id="5767103">(</span><span class="ident" id="5767104">name</span><span class="op" id="5767108">,</span>&nbsp;<span class="ident" id="5767110">def</span>&nbsp;<span class="builtintype" id="5767114">string</span><span class="op" id="5767120">)</span>&nbsp;<span class="builtintype" id="5767122">string</span>&nbsp;<span class="op" id="5767129">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767132">s</span>&nbsp;<span class="op" id="5767134">:=</span>&nbsp;<span class="ident" id="5767137">os</span><span class="op" id="5767139">.</span><span class="ident" id="5767140">Getenv</span><span class="op" id="5767146">(</span><span class="ident" id="5767147">name</span><span class="op" id="5767151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767154">if</span>&nbsp;<span class="ident" id="5767157">s</span>&nbsp;<span class="op" id="5767159">==</span>&nbsp;<span class="string" id="5767162">&#34;&#34;</span>&nbsp;<span class="op" id="5767165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767169">return</span>&nbsp;<span class="ident" id="5767176">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767184">return</span>&nbsp;<span class="ident" id="5767191">s</span><br>
<span class="lineno">325</span><span class="op" id="5767193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5767196">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="5767257">type</span>&nbsp;<span class="ident" id="5767262">ImportMode</span>&nbsp;<span class="builtintype" id="5767273">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="5767279">const</span>&nbsp;<span class="op" id="5767285">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767288">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767354">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767418">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767455">FindOnly</span>&nbsp;<span class="ident" id="5767464">ImportMode</span>&nbsp;<span class="op" id="5767475">=</span>&nbsp;<span class="num" id="5767477">1</span>&nbsp;<span class="op" id="5767479">&lt;&lt;</span>&nbsp;<span class="ident" id="5767482">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767489">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767554">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767604">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767618">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767692">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767763">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767823">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767883">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="5767897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5767900">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="5767960">type</span>&nbsp;<span class="ident" id="5767965">Package</span>&nbsp;<span class="keyword" id="5767973">struct</span>&nbsp;<span class="op" id="5767980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767983">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5767997">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768006">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768047">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768061">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768070">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768087">ImportComment</span>&nbsp;<span class="builtintype" id="5768101">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768110">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768158">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768172">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768181">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768208">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768222">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768231">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768274">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768288">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768297">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768342">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768356">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768365">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768415">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768429">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768438">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768489">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768503">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768512">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768558">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768572">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5768581">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768610">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768624">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768633">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768655">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5768669">[</span><span class="op" id="5768670">]</span><span class="builtintype" id="5768671">string</span>&nbsp;<span class="comment" id="5768678">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768739">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5768753">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5768762">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5768805">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768822">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5768837">[</span><span class="op" id="5768838">]</span><span class="builtintype" id="5768839">string</span>&nbsp;<span class="comment" id="5768846">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768915">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5768930">[</span><span class="op" id="5768931">]</span><span class="builtintype" id="5768932">string</span>&nbsp;<span class="comment" id="5768939">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768976">IgnoredGoFiles</span>&nbsp;<span class="op" id="5768991">[</span><span class="op" id="5768992">]</span><span class="builtintype" id="5768993">string</span>&nbsp;<span class="comment" id="5769000">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769044">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769059">[</span><span class="op" id="5769060">]</span><span class="builtintype" id="5769061">string</span>&nbsp;<span class="comment" id="5769068">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769088">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769103">[</span><span class="op" id="5769104">]</span><span class="builtintype" id="5769105">string</span>&nbsp;<span class="comment" id="5769112">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769148">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769163">[</span><span class="op" id="5769164">]</span><span class="builtintype" id="5769165">string</span>&nbsp;<span class="comment" id="5769172">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769206">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769221">[</span><span class="op" id="5769222">]</span><span class="builtintype" id="5769223">string</span>&nbsp;<span class="comment" id="5769230">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769270">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769285">[</span><span class="op" id="5769286">]</span><span class="builtintype" id="5769287">string</span>&nbsp;<span class="comment" id="5769294">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769314">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769329">[</span><span class="op" id="5769330">]</span><span class="builtintype" id="5769331">string</span>&nbsp;<span class="comment" id="5769338">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769354">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5769369">[</span><span class="op" id="5769370">]</span><span class="builtintype" id="5769371">string</span>&nbsp;<span class="comment" id="5769378">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769397">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769412">[</span><span class="op" id="5769413">]</span><span class="builtintype" id="5769414">string</span>&nbsp;<span class="comment" id="5769421">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5769470">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769489">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769502">[</span><span class="op" id="5769503">]</span><span class="builtintype" id="5769504">string</span>&nbsp;<span class="comment" id="5769511">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769537">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="5769550">[</span><span class="op" id="5769551">]</span><span class="builtintype" id="5769552">string</span>&nbsp;<span class="comment" id="5769559">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769587">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="5769600">[</span><span class="op" id="5769601">]</span><span class="builtintype" id="5769602">string</span>&nbsp;<span class="comment" id="5769609">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769637">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5769650">[</span><span class="op" id="5769651">]</span><span class="builtintype" id="5769652">string</span>&nbsp;<span class="comment" id="5769659">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769686">CgoPkgConfig</span>&nbsp;<span class="op" id="5769699">[</span><span class="op" id="5769700">]</span><span class="builtintype" id="5769701">string</span>&nbsp;<span class="comment" id="5769708">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5769739">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769766">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5769776">[</span><span class="op" id="5769777">]</span><span class="builtintype" id="5769778">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5769804">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769839">ImportPos</span>&nbsp;<span class="keyword" id="5769849">map</span><span class="op" id="5769852">[</span><span class="builtintype" id="5769853">string</span><span class="op" id="5769859">]</span><span class="op" id="5769860">[</span><span class="op" id="5769861">]</span><span class="ident" id="5769862">token</span><span class="op" id="5769867">.</span><span class="ident" id="5769868">Position</span>&nbsp;<span class="comment" id="5769877">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5769911">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769932">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5769947">[</span><span class="op" id="5769948">]</span><span class="builtintype" id="5769949">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5769975">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770005">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5770020">[</span><span class="op" id="5770021">]</span><span class="builtintype" id="5770022">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5770048">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770077">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="5770092">map</span><span class="op" id="5770095">[</span><span class="builtintype" id="5770096">string</span><span class="op" id="5770102">]</span><span class="op" id="5770103">[</span><span class="op" id="5770104">]</span><span class="ident" id="5770105">token</span><span class="op" id="5770110">.</span><span class="ident" id="5770111">Position</span>&nbsp;<span class="comment" id="5770120">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770157">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5770172">[</span><span class="op" id="5770173">]</span><span class="builtintype" id="5770174">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5770200">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770235">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5770250">[</span><span class="op" id="5770251">]</span><span class="builtintype" id="5770252">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5770278">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770308">XTestImportPos</span>&nbsp;<span class="keyword" id="5770323">map</span><span class="op" id="5770326">[</span><span class="builtintype" id="5770327">string</span><span class="op" id="5770333">]</span><span class="op" id="5770334">[</span><span class="op" id="5770335">]</span><span class="ident" id="5770336">token</span><span class="op" id="5770341">.</span><span class="ident" id="5770342">Position</span>&nbsp;<span class="comment" id="5770351">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="5770388">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5770391">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5770448">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="5770497">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="5770547">func</span>&nbsp;<span class="op" id="5770552">(</span><span class="ident" id="5770553">p</span>&nbsp;<span class="op" id="5770555">*</span><span class="ident" id="5770556">Package</span><span class="op" id="5770563">)</span>&nbsp;<span class="ident" id="5770565">IsCommand</span><span class="op" id="5770574">(</span><span class="op" id="5770575">)</span>&nbsp;<span class="builtintype" id="5770577">bool</span>&nbsp;<span class="op" id="5770582">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5770585">return</span>&nbsp;<span class="ident" id="5770592">p</span><span class="op" id="5770593">.</span><span class="ident" id="5770594">Name</span>&nbsp;<span class="op" id="5770599">==</span>&nbsp;<span class="string" id="5770602">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="5770609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5770612">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5770678">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="5770702">func</span>&nbsp;<span class="op" id="5770707">(</span><span class="ident" id="5770708">ctxt</span>&nbsp;<span class="op" id="5770713">*</span><span class="ident" id="5770714">Context</span><span class="op" id="5770721">)</span>&nbsp;<span class="ident" id="5770723">ImportDir</span><span class="op" id="5770732">(</span><span class="ident" id="5770733">dir</span>&nbsp;<span class="builtintype" id="5770737">string</span><span class="op" id="5770743">,</span>&nbsp;<span class="ident" id="5770745">mode</span>&nbsp;<span class="ident" id="5770750">ImportMode</span><span class="op" id="5770760">)</span>&nbsp;<span class="op" id="5770762">(</span><span class="op" id="5770763">*</span><span class="ident" id="5770764">Package</span><span class="op" id="5770771">,</span>&nbsp;<span class="builtintype" id="5770773">error</span><span class="op" id="5770778">)</span>&nbsp;<span class="op" id="5770780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5770783">return</span>&nbsp;<span class="ident" id="5770790">ctxt</span><span class="op" id="5770794">.</span><span class="ident" id="5770795">Import</span><span class="op" id="5770801">(</span><span class="string" id="5770802">&#34;.&#34;</span><span class="op" id="5770805">,</span>&nbsp;<span class="ident" id="5770807">dir</span><span class="op" id="5770810">,</span>&nbsp;<span class="ident" id="5770812">mode</span><span class="op" id="5770816">)</span><br>
<span class="lineno"></span><span class="op" id="5770818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5770821">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="5770886">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5770952">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="5771007">type</span>&nbsp;<span class="ident" id="5771012">NoGoError</span>&nbsp;<span class="keyword" id="5771022">struct</span>&nbsp;<span class="op" id="5771029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771032">Dir</span>&nbsp;<span class="builtintype" id="5771036">string</span><br>
<span class="lineno"></span><span class="op" id="5771043">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="5771046">func</span>&nbsp;<span class="op" id="5771051">(</span><span class="ident" id="5771052">e</span>&nbsp;<span class="op" id="5771054">*</span><span class="ident" id="5771055">NoGoError</span><span class="op" id="5771064">)</span>&nbsp;<span class="ident" id="5771066">Error</span><span class="op" id="5771071">(</span><span class="op" id="5771072">)</span>&nbsp;<span class="builtintype" id="5771074">string</span>&nbsp;<span class="op" id="5771081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771084">return</span>&nbsp;<span class="string" id="5771091">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="5771126">+</span>&nbsp;<span class="ident" id="5771128">e</span><span class="op" id="5771129">.</span><span class="ident" id="5771130">Dir</span><br>
<span class="lineno"></span><span class="op" id="5771134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="5771137">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="5771194">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="5771255">type</span>&nbsp;<span class="ident" id="5771260">MultiplePackageError</span>&nbsp;<span class="keyword" id="5771281">struct</span>&nbsp;<span class="op" id="5771288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771291">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5771300">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5771309">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771340">Packages</span>&nbsp;<span class="op" id="5771349">[</span><span class="op" id="5771350">]</span><span class="builtintype" id="5771351">string</span>&nbsp;<span class="comment" id="5771358">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771382">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5771391">[</span><span class="op" id="5771392">]</span><span class="builtintype" id="5771393">string</span>&nbsp;<span class="comment" id="5771400">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="5771462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5771465">func</span>&nbsp;<span class="op" id="5771470">(</span><span class="ident" id="5771471">e</span>&nbsp;<span class="op" id="5771473">*</span><span class="ident" id="5771474">MultiplePackageError</span><span class="op" id="5771494">)</span>&nbsp;<span class="ident" id="5771496">Error</span><span class="op" id="5771501">(</span><span class="op" id="5771502">)</span>&nbsp;<span class="builtintype" id="5771504">string</span>&nbsp;<span class="op" id="5771511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5771514">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771573">return</span>&nbsp;<span class="ident" id="5771580">fmt</span><span class="op" id="5771583">.</span><span class="ident" id="5771584">Sprintf</span><span class="op" id="5771591">(</span><span class="string" id="5771592">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="5771634">,</span>&nbsp;<span class="ident" id="5771636">e</span><span class="op" id="5771637">.</span><span class="ident" id="5771638">Packages</span><span class="op" id="5771646">[</span><span class="num" id="5771647">0</span><span class="op" id="5771648">]</span><span class="op" id="5771649">,</span>&nbsp;<span class="ident" id="5771651">e</span><span class="op" id="5771652">.</span><span class="ident" id="5771653">Files</span><span class="op" id="5771658">[</span><span class="num" id="5771659">0</span><span class="op" id="5771660">]</span><span class="op" id="5771661">,</span>&nbsp;<span class="ident" id="5771663">e</span><span class="op" id="5771664">.</span><span class="ident" id="5771665">Packages</span><span class="op" id="5771673">[</span><span class="num" id="5771674">1</span><span class="op" id="5771675">]</span><span class="op" id="5771676">,</span>&nbsp;<span class="ident" id="5771678">e</span><span class="op" id="5771679">.</span><span class="ident" id="5771680">Files</span><span class="op" id="5771685">[</span><span class="num" id="5771686">1</span><span class="op" id="5771687">]</span><span class="op" id="5771688">,</span>&nbsp;<span class="ident" id="5771690">e</span><span class="op" id="5771691">.</span><span class="ident" id="5771692">Dir</span><span class="op" id="5771695">)</span><br>
<span class="lineno"></span><span class="op" id="5771697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5771700">func</span>&nbsp;<span class="ident" id="5771705">nameExt</span><span class="op" id="5771712">(</span><span class="ident" id="5771713">name</span>&nbsp;<span class="builtintype" id="5771718">string</span><span class="op" id="5771724">)</span>&nbsp;<span class="builtintype" id="5771726">string</span>&nbsp;<span class="op" id="5771733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771736">i</span>&nbsp;<span class="op" id="5771738">:=</span>&nbsp;<span class="ident" id="5771741">strings</span><span class="op" id="5771748">.</span><span class="ident" id="5771749">LastIndex</span><span class="op" id="5771758">(</span><span class="ident" id="5771759">name</span><span class="op" id="5771763">,</span>&nbsp;<span class="string" id="5771765">&#34;.&#34;</span><span class="op" id="5771768">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771771">if</span>&nbsp;<span class="ident" id="5771774">i</span>&nbsp;<span class="op" id="5771776">&lt;</span>&nbsp;<span class="num" id="5771778">0</span>&nbsp;<span class="op" id="5771780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771784">return</span>&nbsp;<span class="string" id="5771791">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5771795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771798">return</span>&nbsp;<span class="ident" id="5771805">name</span><span class="op" id="5771809">[</span><span class="ident" id="5771810">i</span><span class="op" id="5771811">:</span><span class="op" id="5771812">]</span><br>
<span class="lineno"></span><span class="op" id="5771814">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="5771817">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="5771890">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5771959">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="5772035">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="5772111">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="5772128">//</span><br>
<span class="lineno"></span><span class="comment" id="5772131">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="5772205">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="5772251">//</span><br>
<span class="lineno">450</span><span class="comment" id="5772254">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="5772294">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="5772358">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="5772421">//</span><br>
<span class="lineno"></span><span class="comment" id="5772424">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="5772492">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="5772536">//</span><br>
<span class="lineno"></span><span class="keyword" id="5772539">func</span>&nbsp;<span class="op" id="5772544">(</span><span class="ident" id="5772545">ctxt</span>&nbsp;<span class="op" id="5772550">*</span><span class="ident" id="5772551">Context</span><span class="op" id="5772558">)</span>&nbsp;<span class="ident" id="5772560">Import</span><span class="op" id="5772566">(</span><span class="ident" id="5772567">path</span>&nbsp;<span class="builtintype" id="5772572">string</span><span class="op" id="5772578">,</span>&nbsp;<span class="ident" id="5772580">srcDir</span>&nbsp;<span class="builtintype" id="5772587">string</span><span class="op" id="5772593">,</span>&nbsp;<span class="ident" id="5772595">mode</span>&nbsp;<span class="ident" id="5772600">ImportMode</span><span class="op" id="5772610">)</span>&nbsp;<span class="op" id="5772612">(</span><span class="op" id="5772613">*</span><span class="ident" id="5772614">Package</span><span class="op" id="5772621">,</span>&nbsp;<span class="builtintype" id="5772623">error</span><span class="op" id="5772628">)</span>&nbsp;<span class="op" id="5772630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5772633">p</span>&nbsp;<span class="op" id="5772635">:=</span>&nbsp;<span class="op" id="5772638">&amp;</span><span class="ident" id="5772639">Package</span><span class="op" id="5772646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5772650">ImportPath</span><span class="op" id="5772660">:</span>&nbsp;<span class="ident" id="5772662">path</span><span class="op" id="5772666">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5772669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772672">if</span>&nbsp;<span class="ident" id="5772675">path</span>&nbsp;<span class="op" id="5772680">==</span>&nbsp;<span class="string" id="5772683">&#34;&#34;</span>&nbsp;<span class="op" id="5772686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772690">return</span>&nbsp;<span class="ident" id="5772697">p</span><span class="op" id="5772698">,</span>&nbsp;<span class="ident" id="5772700">fmt</span><span class="op" id="5772703">.</span><span class="ident" id="5772704">Errorf</span><span class="op" id="5772710">(</span><span class="string" id="5772711">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="5772743">,</span>&nbsp;<span class="ident" id="5772745">path</span><span class="op" id="5772749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5772752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772756">var</span>&nbsp;<span class="ident" id="5772760">pkga</span>&nbsp;<span class="builtintype" id="5772765">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772773">var</span>&nbsp;<span class="ident" id="5772777">pkgerr</span>&nbsp;<span class="builtintype" id="5772784">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772791">switch</span>&nbsp;<span class="ident" id="5772798">ctxt</span><span class="op" id="5772802">.</span><span class="ident" id="5772803">Compiler</span>&nbsp;<span class="op" id="5772812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772815">case</span>&nbsp;<span class="string" id="5772820">&#34;gccgo&#34;</span><span class="op" id="5772827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5772831">dir</span><span class="op" id="5772834">,</span>&nbsp;<span class="ident" id="5772836">elem</span>&nbsp;<span class="op" id="5772841">:=</span>&nbsp;<span class="ident" id="5772844">pathpkg</span><span class="op" id="5772851">.</span><span class="ident" id="5772852">Split</span><span class="op" id="5772857">(</span><span class="ident" id="5772858">p</span><span class="op" id="5772859">.</span><span class="ident" id="5772860">ImportPath</span><span class="op" id="5772870">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5772874">pkga</span>&nbsp;<span class="op" id="5772879">=</span>&nbsp;<span class="string" id="5772881">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="5772894">+</span>&nbsp;<span class="ident" id="5772896">ctxt</span><span class="op" id="5772900">.</span><span class="ident" id="5772901">GOOS</span>&nbsp;<span class="op" id="5772906">+</span>&nbsp;<span class="string" id="5772908">&#34;_&#34;</span>&nbsp;<span class="op" id="5772912">+</span>&nbsp;<span class="ident" id="5772914">ctxt</span><span class="op" id="5772918">.</span><span class="ident" id="5772919">GOARCH</span>&nbsp;<span class="op" id="5772926">+</span>&nbsp;<span class="string" id="5772928">&#34;/&#34;</span>&nbsp;<span class="op" id="5772932">+</span>&nbsp;<span class="ident" id="5772934">dir</span>&nbsp;<span class="op" id="5772938">+</span>&nbsp;<span class="string" id="5772940">&#34;lib&#34;</span>&nbsp;<span class="op" id="5772946">+</span>&nbsp;<span class="ident" id="5772948">elem</span>&nbsp;<span class="op" id="5772953">+</span>&nbsp;<span class="string" id="5772955">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772961">case</span>&nbsp;<span class="string" id="5772966">&#34;gc&#34;</span><span class="op" id="5772970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5772974">suffix</span>&nbsp;<span class="op" id="5772981">:=</span>&nbsp;<span class="string" id="5772984">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772989">if</span>&nbsp;<span class="ident" id="5772992">ctxt</span><span class="op" id="5772996">.</span><span class="ident" id="5772997">InstallSuffix</span>&nbsp;<span class="op" id="5773011">!=</span>&nbsp;<span class="string" id="5773014">&#34;&#34;</span>&nbsp;<span class="op" id="5773017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773022">suffix</span>&nbsp;<span class="op" id="5773029">=</span>&nbsp;<span class="string" id="5773031">&#34;_&#34;</span>&nbsp;<span class="op" id="5773035">+</span>&nbsp;<span class="ident" id="5773037">ctxt</span><span class="op" id="5773041">.</span><span class="ident" id="5773042">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5773058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773062">pkga</span>&nbsp;<span class="op" id="5773067">=</span>&nbsp;<span class="string" id="5773069">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="5773076">+</span>&nbsp;<span class="ident" id="5773078">ctxt</span><span class="op" id="5773082">.</span><span class="ident" id="5773083">GOOS</span>&nbsp;<span class="op" id="5773088">+</span>&nbsp;<span class="string" id="5773090">&#34;_&#34;</span>&nbsp;<span class="op" id="5773094">+</span>&nbsp;<span class="ident" id="5773096">ctxt</span><span class="op" id="5773100">.</span><span class="ident" id="5773101">GOARCH</span>&nbsp;<span class="op" id="5773108">+</span>&nbsp;<span class="ident" id="5773110">suffix</span>&nbsp;<span class="op" id="5773117">+</span>&nbsp;<span class="string" id="5773119">&#34;/&#34;</span>&nbsp;<span class="op" id="5773123">+</span>&nbsp;<span class="ident" id="5773125">p</span><span class="op" id="5773126">.</span><span class="ident" id="5773127">ImportPath</span>&nbsp;<span class="op" id="5773138">+</span>&nbsp;<span class="string" id="5773140">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773146">default</span><span class="op" id="5773153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5773157">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773194">pkgerr</span>&nbsp;<span class="op" id="5773201">=</span>&nbsp;<span class="ident" id="5773203">fmt</span><span class="op" id="5773206">.</span><span class="ident" id="5773207">Errorf</span><span class="op" id="5773213">(</span><span class="string" id="5773214">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="5773246">,</span>&nbsp;<span class="ident" id="5773248">path</span><span class="op" id="5773252">,</span>&nbsp;<span class="ident" id="5773254">ctxt</span><span class="op" id="5773258">.</span><span class="ident" id="5773259">Compiler</span><span class="op" id="5773267">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5773270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773274">binaryOnly</span>&nbsp;<span class="op" id="5773285">:=</span>&nbsp;<span class="builtintype" id="5773288">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773295">if</span>&nbsp;<span class="ident" id="5773298">IsLocalImport</span><span class="op" id="5773311">(</span><span class="ident" id="5773312">path</span><span class="op" id="5773316">)</span>&nbsp;<span class="op" id="5773318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773322">pkga</span>&nbsp;<span class="op" id="5773327">=</span>&nbsp;<span class="string" id="5773329">&#34;&#34;</span>&nbsp;<span class="comment" id="5773332">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773374">if</span>&nbsp;<span class="ident" id="5773377">srcDir</span>&nbsp;<span class="op" id="5773384">==</span>&nbsp;<span class="string" id="5773387">&#34;&#34;</span>&nbsp;<span class="op" id="5773390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773395">return</span>&nbsp;<span class="ident" id="5773402">p</span><span class="op" id="5773403">,</span>&nbsp;<span class="ident" id="5773405">fmt</span><span class="op" id="5773408">.</span><span class="ident" id="5773409">Errorf</span><span class="op" id="5773415">(</span><span class="string" id="5773416">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="5773465">,</span>&nbsp;<span class="ident" id="5773467">path</span><span class="op" id="5773471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5773475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773479">if</span>&nbsp;<span class="op" id="5773482">!</span><span class="ident" id="5773483">ctxt</span><span class="op" id="5773487">.</span><span class="ident" id="5773488">isAbsPath</span><span class="op" id="5773497">(</span><span class="ident" id="5773498">path</span><span class="op" id="5773502">)</span>&nbsp;<span class="op" id="5773504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773509">p</span><span class="op" id="5773510">.</span><span class="ident" id="5773511">Dir</span>&nbsp;<span class="op" id="5773515">=</span>&nbsp;<span class="ident" id="5773517">ctxt</span><span class="op" id="5773521">.</span><span class="ident" id="5773522">joinPath</span><span class="op" id="5773530">(</span><span class="ident" id="5773531">srcDir</span><span class="op" id="5773537">,</span>&nbsp;<span class="ident" id="5773539">path</span><span class="op" id="5773543">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5773547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5773551">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773597">if</span>&nbsp;<span class="ident" id="5773600">ctxt</span><span class="op" id="5773604">.</span><span class="ident" id="5773605">GOROOT</span>&nbsp;<span class="op" id="5773612">!=</span>&nbsp;<span class="string" id="5773615">&#34;&#34;</span>&nbsp;<span class="op" id="5773618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773623">root</span>&nbsp;<span class="op" id="5773628">:=</span>&nbsp;<span class="ident" id="5773631">ctxt</span><span class="op" id="5773635">.</span><span class="ident" id="5773636">joinPath</span><span class="op" id="5773644">(</span><span class="ident" id="5773645">ctxt</span><span class="op" id="5773649">.</span><span class="ident" id="5773650">GOROOT</span><span class="op" id="5773656">,</span>&nbsp;<span class="string" id="5773658">&#34;src&#34;</span><span class="op" id="5773663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773668">if</span>&nbsp;<span class="ident" id="5773671">sub</span><span class="op" id="5773674">,</span>&nbsp;<span class="ident" id="5773676">ok</span>&nbsp;<span class="op" id="5773679">:=</span>&nbsp;<span class="ident" id="5773682">ctxt</span><span class="op" id="5773686">.</span><span class="ident" id="5773687">hasSubdir</span><span class="op" id="5773696">(</span><span class="ident" id="5773697">root</span><span class="op" id="5773701">,</span>&nbsp;<span class="ident" id="5773703">p</span><span class="op" id="5773704">.</span><span class="ident" id="5773705">Dir</span><span class="op" id="5773708">)</span><span class="op" id="5773709">;</span>&nbsp;<span class="ident" id="5773711">ok</span>&nbsp;<span class="op" id="5773714">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773720">p</span><span class="op" id="5773721">.</span><span class="ident" id="5773722">Goroot</span>&nbsp;<span class="op" id="5773729">=</span>&nbsp;<span class="builtintype" id="5773731">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773740">p</span><span class="op" id="5773741">.</span><span class="ident" id="5773742">ImportPath</span>&nbsp;<span class="op" id="5773753">=</span>&nbsp;<span class="ident" id="5773755">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773763">p</span><span class="op" id="5773764">.</span><span class="ident" id="5773765">Root</span>&nbsp;<span class="op" id="5773770">=</span>&nbsp;<span class="ident" id="5773772">ctxt</span><span class="op" id="5773776">.</span><span class="ident" id="5773777">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773788">goto</span>&nbsp;<span class="ident" id="5773793">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5773802">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5773806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773810">all</span>&nbsp;<span class="op" id="5773814">:=</span>&nbsp;<span class="ident" id="5773817">ctxt</span><span class="op" id="5773821">.</span><span class="ident" id="5773822">gopath</span><span class="op" id="5773828">(</span><span class="op" id="5773829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773833">for</span>&nbsp;<span class="ident" id="5773837">i</span><span class="op" id="5773838">,</span>&nbsp;<span class="ident" id="5773840">root</span>&nbsp;<span class="op" id="5773845">:=</span>&nbsp;<span class="keyword" id="5773848">range</span>&nbsp;<span class="ident" id="5773854">all</span>&nbsp;<span class="op" id="5773858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5773863">rootsrc</span>&nbsp;<span class="op" id="5773871">:=</span>&nbsp;<span class="ident" id="5773874">ctxt</span><span class="op" id="5773878">.</span><span class="ident" id="5773879">joinPath</span><span class="op" id="5773887">(</span><span class="ident" id="5773888">root</span><span class="op" id="5773892">,</span>&nbsp;<span class="string" id="5773894">&#34;src&#34;</span><span class="op" id="5773899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5773904">if</span>&nbsp;<span class="ident" id="5773907">sub</span><span class="op" id="5773910">,</span>&nbsp;<span class="ident" id="5773912">ok</span>&nbsp;<span class="op" id="5773915">:=</span>&nbsp;<span class="ident" id="5773918">ctxt</span><span class="op" id="5773922">.</span><span class="ident" id="5773923">hasSubdir</span><span class="op" id="5773932">(</span><span class="ident" id="5773933">rootsrc</span><span class="op" id="5773940">,</span>&nbsp;<span class="ident" id="5773942">p</span><span class="op" id="5773943">.</span><span class="ident" id="5773944">Dir</span><span class="op" id="5773947">)</span><span class="op" id="5773948">;</span>&nbsp;<span class="ident" id="5773950">ok</span>&nbsp;<span class="op" id="5773953">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5773959">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5774008">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5774063">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774082">if</span>&nbsp;<span class="ident" id="5774085">ctxt</span><span class="op" id="5774089">.</span><span class="ident" id="5774090">GOROOT</span>&nbsp;<span class="op" id="5774097">!=</span>&nbsp;<span class="string" id="5774100">&#34;&#34;</span>&nbsp;<span class="op" id="5774103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774110">if</span>&nbsp;<span class="ident" id="5774113">dir</span>&nbsp;<span class="op" id="5774117">:=</span>&nbsp;<span class="ident" id="5774120">ctxt</span><span class="op" id="5774124">.</span><span class="ident" id="5774125">joinPath</span><span class="op" id="5774133">(</span><span class="ident" id="5774134">ctxt</span><span class="op" id="5774138">.</span><span class="ident" id="5774139">GOROOT</span><span class="op" id="5774145">,</span>&nbsp;<span class="string" id="5774147">&#34;src&#34;</span><span class="op" id="5774152">,</span>&nbsp;<span class="ident" id="5774154">sub</span><span class="op" id="5774157">)</span><span class="op" id="5774158">;</span>&nbsp;<span class="ident" id="5774160">ctxt</span><span class="op" id="5774164">.</span><span class="ident" id="5774165">isDir</span><span class="op" id="5774170">(</span><span class="ident" id="5774171">dir</span><span class="op" id="5774174">)</span>&nbsp;<span class="op" id="5774176">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5774184">p</span><span class="op" id="5774185">.</span><span class="ident" id="5774186">ConflictDir</span>&nbsp;<span class="op" id="5774198">=</span>&nbsp;<span class="ident" id="5774200">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774210">goto</span>&nbsp;<span class="ident" id="5774215">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774238">for</span>&nbsp;<span class="ident" id="5774242">_</span><span class="op" id="5774243">,</span>&nbsp;<span class="ident" id="5774245">earlyRoot</span>&nbsp;<span class="op" id="5774255">:=</span>&nbsp;<span class="keyword" id="5774258">range</span>&nbsp;<span class="ident" id="5774264">all</span><span class="op" id="5774267">[</span><span class="op" id="5774268">:</span><span class="ident" id="5774269">i</span><span class="op" id="5774270">]</span>&nbsp;<span class="op" id="5774272">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774279">if</span>&nbsp;<span class="ident" id="5774282">dir</span>&nbsp;<span class="op" id="5774286">:=</span>&nbsp;<span class="ident" id="5774289">ctxt</span><span class="op" id="5774293">.</span><span class="ident" id="5774294">joinPath</span><span class="op" id="5774302">(</span><span class="ident" id="5774303">earlyRoot</span><span class="op" id="5774312">,</span>&nbsp;<span class="string" id="5774314">&#34;src&#34;</span><span class="op" id="5774319">,</span>&nbsp;<span class="ident" id="5774321">sub</span><span class="op" id="5774324">)</span><span class="op" id="5774325">;</span>&nbsp;<span class="ident" id="5774327">ctxt</span><span class="op" id="5774331">.</span><span class="ident" id="5774332">isDir</span><span class="op" id="5774337">(</span><span class="ident" id="5774338">dir</span><span class="op" id="5774341">)</span>&nbsp;<span class="op" id="5774343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5774351">p</span><span class="op" id="5774352">.</span><span class="ident" id="5774353">ConflictDir</span>&nbsp;<span class="op" id="5774365">=</span>&nbsp;<span class="ident" id="5774367">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774377">goto</span>&nbsp;<span class="ident" id="5774382">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774399">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5774406">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5774474">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5774492">p</span><span class="op" id="5774493">.</span><span class="ident" id="5774494">ImportPath</span>&nbsp;<span class="op" id="5774505">=</span>&nbsp;<span class="ident" id="5774507">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5774515">p</span><span class="op" id="5774516">.</span><span class="ident" id="5774517">Root</span>&nbsp;<span class="op" id="5774522">=</span>&nbsp;<span class="ident" id="5774524">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774533">goto</span>&nbsp;<span class="ident" id="5774538">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5774555">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5774613">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774658">}</span>&nbsp;<span class="keyword" id="5774660">else</span>&nbsp;<span class="op" id="5774665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774669">if</span>&nbsp;<span class="ident" id="5774672">strings</span><span class="op" id="5774679">.</span><span class="ident" id="5774680">HasPrefix</span><span class="op" id="5774689">(</span><span class="ident" id="5774690">path</span><span class="op" id="5774694">,</span>&nbsp;<span class="string" id="5774696">&#34;/&#34;</span><span class="op" id="5774699">)</span>&nbsp;<span class="op" id="5774701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774706">return</span>&nbsp;<span class="ident" id="5774713">p</span><span class="op" id="5774714">,</span>&nbsp;<span class="ident" id="5774716">fmt</span><span class="op" id="5774719">.</span><span class="ident" id="5774720">Errorf</span><span class="op" id="5774726">(</span><span class="string" id="5774727">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="5774767">,</span>&nbsp;<span class="ident" id="5774769">path</span><span class="op" id="5774773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5774782">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774846">var</span>&nbsp;<span class="ident" id="5774850">tried</span>&nbsp;<span class="keyword" id="5774856">struct</span>&nbsp;<span class="op" id="5774863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5774868">goroot</span>&nbsp;<span class="builtintype" id="5774875">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5774885">gopath</span>&nbsp;<span class="op" id="5774892">[</span><span class="op" id="5774893">]</span><span class="builtintype" id="5774894">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5774903">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5774908">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5774951">if</span>&nbsp;<span class="ident" id="5774954">ctxt</span><span class="op" id="5774958">.</span><span class="ident" id="5774959">GOROOT</span>&nbsp;<span class="op" id="5774966">!=</span>&nbsp;<span class="string" id="5774969">&#34;&#34;</span>&nbsp;<span class="op" id="5774972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5774977">dir</span>&nbsp;<span class="op" id="5774981">:=</span>&nbsp;<span class="ident" id="5774984">ctxt</span><span class="op" id="5774988">.</span><span class="ident" id="5774989">joinPath</span><span class="op" id="5774997">(</span><span class="ident" id="5774998">ctxt</span><span class="op" id="5775002">.</span><span class="ident" id="5775003">GOROOT</span><span class="op" id="5775009">,</span>&nbsp;<span class="string" id="5775011">&#34;src&#34;</span><span class="op" id="5775016">,</span>&nbsp;<span class="ident" id="5775018">path</span><span class="op" id="5775022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775027">isDir</span>&nbsp;<span class="op" id="5775033">:=</span>&nbsp;<span class="ident" id="5775036">ctxt</span><span class="op" id="5775040">.</span><span class="ident" id="5775041">isDir</span><span class="op" id="5775046">(</span><span class="ident" id="5775047">dir</span><span class="op" id="5775050">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775055">binaryOnly</span>&nbsp;<span class="op" id="5775066">=</span>&nbsp;<span class="op" id="5775068">!</span><span class="ident" id="5775069">isDir</span>&nbsp;<span class="op" id="5775075">&amp;&amp;</span>&nbsp;<span class="ident" id="5775078">mode</span><span class="op" id="5775082">&amp;</span><span class="ident" id="5775083">AllowBinary</span>&nbsp;<span class="op" id="5775095">!=</span>&nbsp;<span class="num" id="5775098">0</span>&nbsp;<span class="op" id="5775100">&amp;&amp;</span>&nbsp;<span class="ident" id="5775103">pkga</span>&nbsp;<span class="op" id="5775108">!=</span>&nbsp;<span class="string" id="5775111">&#34;&#34;</span>&nbsp;<span class="op" id="5775114">&amp;&amp;</span>&nbsp;<span class="ident" id="5775117">ctxt</span><span class="op" id="5775121">.</span><span class="ident" id="5775122">isFile</span><span class="op" id="5775128">(</span><span class="ident" id="5775129">ctxt</span><span class="op" id="5775133">.</span><span class="ident" id="5775134">joinPath</span><span class="op" id="5775142">(</span><span class="ident" id="5775143">ctxt</span><span class="op" id="5775147">.</span><span class="ident" id="5775148">GOROOT</span><span class="op" id="5775154">,</span>&nbsp;<span class="ident" id="5775156">pkga</span><span class="op" id="5775160">)</span><span class="op" id="5775161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775166">if</span>&nbsp;<span class="ident" id="5775169">isDir</span>&nbsp;<span class="op" id="5775175">||</span>&nbsp;<span class="ident" id="5775178">binaryOnly</span>&nbsp;<span class="op" id="5775189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775195">p</span><span class="op" id="5775196">.</span><span class="ident" id="5775197">Dir</span>&nbsp;<span class="op" id="5775201">=</span>&nbsp;<span class="ident" id="5775203">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775211">p</span><span class="op" id="5775212">.</span><span class="ident" id="5775213">Goroot</span>&nbsp;<span class="op" id="5775220">=</span>&nbsp;<span class="builtintype" id="5775222">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775231">p</span><span class="op" id="5775232">.</span><span class="ident" id="5775233">Root</span>&nbsp;<span class="op" id="5775238">=</span>&nbsp;<span class="ident" id="5775240">ctxt</span><span class="op" id="5775244">.</span><span class="ident" id="5775245">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775256">goto</span>&nbsp;<span class="ident" id="5775261">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5775270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775275">tried</span><span class="op" id="5775280">.</span><span class="ident" id="5775281">goroot</span>&nbsp;<span class="op" id="5775288">=</span>&nbsp;<span class="ident" id="5775290">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5775296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775300">for</span>&nbsp;<span class="ident" id="5775304">_</span><span class="op" id="5775305">,</span>&nbsp;<span class="ident" id="5775307">root</span>&nbsp;<span class="op" id="5775312">:=</span>&nbsp;<span class="keyword" id="5775315">range</span>&nbsp;<span class="ident" id="5775321">ctxt</span><span class="op" id="5775325">.</span><span class="ident" id="5775326">gopath</span><span class="op" id="5775332">(</span><span class="op" id="5775333">)</span>&nbsp;<span class="op" id="5775335">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775340">dir</span>&nbsp;<span class="op" id="5775344">:=</span>&nbsp;<span class="ident" id="5775347">ctxt</span><span class="op" id="5775351">.</span><span class="ident" id="5775352">joinPath</span><span class="op" id="5775360">(</span><span class="ident" id="5775361">root</span><span class="op" id="5775365">,</span>&nbsp;<span class="string" id="5775367">&#34;src&#34;</span><span class="op" id="5775372">,</span>&nbsp;<span class="ident" id="5775374">path</span><span class="op" id="5775378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775383">isDir</span>&nbsp;<span class="op" id="5775389">:=</span>&nbsp;<span class="ident" id="5775392">ctxt</span><span class="op" id="5775396">.</span><span class="ident" id="5775397">isDir</span><span class="op" id="5775402">(</span><span class="ident" id="5775403">dir</span><span class="op" id="5775406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775411">binaryOnly</span>&nbsp;<span class="op" id="5775422">=</span>&nbsp;<span class="op" id="5775424">!</span><span class="ident" id="5775425">isDir</span>&nbsp;<span class="op" id="5775431">&amp;&amp;</span>&nbsp;<span class="ident" id="5775434">mode</span><span class="op" id="5775438">&amp;</span><span class="ident" id="5775439">AllowBinary</span>&nbsp;<span class="op" id="5775451">!=</span>&nbsp;<span class="num" id="5775454">0</span>&nbsp;<span class="op" id="5775456">&amp;&amp;</span>&nbsp;<span class="ident" id="5775459">pkga</span>&nbsp;<span class="op" id="5775464">!=</span>&nbsp;<span class="string" id="5775467">&#34;&#34;</span>&nbsp;<span class="op" id="5775470">&amp;&amp;</span>&nbsp;<span class="ident" id="5775473">ctxt</span><span class="op" id="5775477">.</span><span class="ident" id="5775478">isFile</span><span class="op" id="5775484">(</span><span class="ident" id="5775485">ctxt</span><span class="op" id="5775489">.</span><span class="ident" id="5775490">joinPath</span><span class="op" id="5775498">(</span><span class="ident" id="5775499">root</span><span class="op" id="5775503">,</span>&nbsp;<span class="ident" id="5775505">pkga</span><span class="op" id="5775509">)</span><span class="op" id="5775510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775515">if</span>&nbsp;<span class="ident" id="5775518">isDir</span>&nbsp;<span class="op" id="5775524">||</span>&nbsp;<span class="ident" id="5775527">binaryOnly</span>&nbsp;<span class="op" id="5775538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775544">p</span><span class="op" id="5775545">.</span><span class="ident" id="5775546">Dir</span>&nbsp;<span class="op" id="5775550">=</span>&nbsp;<span class="ident" id="5775552">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775560">p</span><span class="op" id="5775561">.</span><span class="ident" id="5775562">Root</span>&nbsp;<span class="op" id="5775567">=</span>&nbsp;<span class="ident" id="5775569">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775578">goto</span>&nbsp;<span class="ident" id="5775583">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5775592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775597">tried</span><span class="op" id="5775602">.</span><span class="ident" id="5775603">gopath</span>&nbsp;<span class="op" id="5775610">=</span>&nbsp;<span class="builtinfunc" id="5775612">append</span><span class="op" id="5775618">(</span><span class="ident" id="5775619">tried</span><span class="op" id="5775624">.</span><span class="ident" id="5775625">gopath</span><span class="op" id="5775631">,</span>&nbsp;<span class="ident" id="5775633">dir</span><span class="op" id="5775636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5775640">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5775645">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775672">var</span>&nbsp;<span class="ident" id="5775676">paths</span>&nbsp;<span class="op" id="5775682">[</span><span class="op" id="5775683">]</span><span class="builtintype" id="5775684">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775693">if</span>&nbsp;<span class="ident" id="5775696">tried</span><span class="op" id="5775701">.</span><span class="ident" id="5775702">goroot</span>&nbsp;<span class="op" id="5775709">!=</span>&nbsp;<span class="string" id="5775712">&#34;&#34;</span>&nbsp;<span class="op" id="5775715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775720">paths</span>&nbsp;<span class="op" id="5775726">=</span>&nbsp;<span class="builtinfunc" id="5775728">append</span><span class="op" id="5775734">(</span><span class="ident" id="5775735">paths</span><span class="op" id="5775740">,</span>&nbsp;<span class="ident" id="5775742">fmt</span><span class="op" id="5775745">.</span><span class="ident" id="5775746">Sprintf</span><span class="op" id="5775753">(</span><span class="string" id="5775754">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="5775775">,</span>&nbsp;<span class="ident" id="5775777">tried</span><span class="op" id="5775782">.</span><span class="ident" id="5775783">goroot</span><span class="op" id="5775789">)</span><span class="op" id="5775790">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5775794">}</span>&nbsp;<span class="keyword" id="5775796">else</span>&nbsp;<span class="op" id="5775801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775806">paths</span>&nbsp;<span class="op" id="5775812">=</span>&nbsp;<span class="builtinfunc" id="5775814">append</span><span class="op" id="5775820">(</span><span class="ident" id="5775821">paths</span><span class="op" id="5775826">,</span>&nbsp;<span class="string" id="5775828">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="5775849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5775853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775857">var</span>&nbsp;<span class="ident" id="5775861">i</span>&nbsp;<span class="builtintype" id="5775863">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775869">var</span>&nbsp;<span class="ident" id="5775873">format</span>&nbsp;<span class="op" id="5775880">=</span>&nbsp;<span class="string" id="5775882">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775906">for</span>&nbsp;<span class="op" id="5775910">;</span>&nbsp;<span class="ident" id="5775912">i</span>&nbsp;<span class="op" id="5775914">&lt;</span>&nbsp;<span class="builtinfunc" id="5775916">len</span><span class="op" id="5775919">(</span><span class="ident" id="5775920">tried</span><span class="op" id="5775925">.</span><span class="ident" id="5775926">gopath</span><span class="op" id="5775932">)</span><span class="op" id="5775933">;</span>&nbsp;<span class="ident" id="5775935">i</span><span class="op" id="5775936">++</span>&nbsp;<span class="op" id="5775939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5775944">if</span>&nbsp;<span class="ident" id="5775947">i</span>&nbsp;<span class="op" id="5775949">&gt;</span>&nbsp;<span class="num" id="5775951">0</span>&nbsp;<span class="op" id="5775953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775959">format</span>&nbsp;<span class="op" id="5775966">=</span>&nbsp;<span class="string" id="5775968">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5775978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5775983">paths</span>&nbsp;<span class="op" id="5775989">=</span>&nbsp;<span class="builtinfunc" id="5775991">append</span><span class="op" id="5775997">(</span><span class="ident" id="5775998">paths</span><span class="op" id="5776003">,</span>&nbsp;<span class="ident" id="5776005">fmt</span><span class="op" id="5776008">.</span><span class="ident" id="5776009">Sprintf</span><span class="op" id="5776016">(</span><span class="ident" id="5776017">format</span><span class="op" id="5776023">,</span>&nbsp;<span class="ident" id="5776025">tried</span><span class="op" id="5776030">.</span><span class="ident" id="5776031">gopath</span><span class="op" id="5776037">[</span><span class="ident" id="5776038">i</span><span class="op" id="5776039">]</span><span class="op" id="5776040">)</span><span class="op" id="5776041">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776049">if</span>&nbsp;<span class="ident" id="5776052">i</span>&nbsp;<span class="op" id="5776054">==</span>&nbsp;<span class="num" id="5776057">0</span>&nbsp;<span class="op" id="5776059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776064">paths</span>&nbsp;<span class="op" id="5776070">=</span>&nbsp;<span class="builtinfunc" id="5776072">append</span><span class="op" id="5776078">(</span><span class="ident" id="5776079">paths</span><span class="op" id="5776084">,</span>&nbsp;<span class="string" id="5776086">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="5776107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776115">return</span>&nbsp;<span class="ident" id="5776122">p</span><span class="op" id="5776123">,</span>&nbsp;<span class="ident" id="5776125">fmt</span><span class="op" id="5776128">.</span><span class="ident" id="5776129">Errorf</span><span class="op" id="5776135">(</span><span class="string" id="5776136">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="5776175">,</span>&nbsp;<span class="ident" id="5776177">path</span><span class="op" id="5776181">,</span>&nbsp;<span class="ident" id="5776183">strings</span><span class="op" id="5776190">.</span><span class="ident" id="5776191">Join</span><span class="op" id="5776195">(</span><span class="ident" id="5776196">paths</span><span class="op" id="5776201">,</span>&nbsp;<span class="string" id="5776203">&#34;\n&#34;</span><span class="op" id="5776207">)</span><span class="op" id="5776208">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5776214">Found</span><span class="op" id="5776219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776222">if</span>&nbsp;<span class="ident" id="5776225">p</span><span class="op" id="5776226">.</span><span class="ident" id="5776227">Root</span>&nbsp;<span class="op" id="5776232">!=</span>&nbsp;<span class="string" id="5776235">&#34;&#34;</span>&nbsp;<span class="op" id="5776238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776242">p</span><span class="op" id="5776243">.</span><span class="ident" id="5776244">SrcRoot</span>&nbsp;<span class="op" id="5776252">=</span>&nbsp;<span class="ident" id="5776254">ctxt</span><span class="op" id="5776258">.</span><span class="ident" id="5776259">joinPath</span><span class="op" id="5776267">(</span><span class="ident" id="5776268">p</span><span class="op" id="5776269">.</span><span class="ident" id="5776270">Root</span><span class="op" id="5776274">,</span>&nbsp;<span class="string" id="5776276">&#34;src&#34;</span><span class="op" id="5776281">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776285">p</span><span class="op" id="5776286">.</span><span class="ident" id="5776287">PkgRoot</span>&nbsp;<span class="op" id="5776295">=</span>&nbsp;<span class="ident" id="5776297">ctxt</span><span class="op" id="5776301">.</span><span class="ident" id="5776302">joinPath</span><span class="op" id="5776310">(</span><span class="ident" id="5776311">p</span><span class="op" id="5776312">.</span><span class="ident" id="5776313">Root</span><span class="op" id="5776317">,</span>&nbsp;<span class="string" id="5776319">&#34;pkg&#34;</span><span class="op" id="5776324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776328">p</span><span class="op" id="5776329">.</span><span class="ident" id="5776330">BinDir</span>&nbsp;<span class="op" id="5776337">=</span>&nbsp;<span class="ident" id="5776339">ctxt</span><span class="op" id="5776343">.</span><span class="ident" id="5776344">joinPath</span><span class="op" id="5776352">(</span><span class="ident" id="5776353">p</span><span class="op" id="5776354">.</span><span class="ident" id="5776355">Root</span><span class="op" id="5776359">,</span>&nbsp;<span class="string" id="5776361">&#34;bin&#34;</span><span class="op" id="5776366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776370">if</span>&nbsp;<span class="ident" id="5776373">pkga</span>&nbsp;<span class="op" id="5776378">!=</span>&nbsp;<span class="string" id="5776381">&#34;&#34;</span>&nbsp;<span class="op" id="5776384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776389">p</span><span class="op" id="5776390">.</span><span class="ident" id="5776391">PkgObj</span>&nbsp;<span class="op" id="5776398">=</span>&nbsp;<span class="ident" id="5776400">ctxt</span><span class="op" id="5776404">.</span><span class="ident" id="5776405">joinPath</span><span class="op" id="5776413">(</span><span class="ident" id="5776414">p</span><span class="op" id="5776415">.</span><span class="ident" id="5776416">Root</span><span class="op" id="5776420">,</span>&nbsp;<span class="ident" id="5776422">pkga</span><span class="op" id="5776426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776430">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776437">if</span>&nbsp;<span class="ident" id="5776440">mode</span><span class="op" id="5776444">&amp;</span><span class="ident" id="5776445">FindOnly</span>&nbsp;<span class="op" id="5776454">!=</span>&nbsp;<span class="num" id="5776457">0</span>&nbsp;<span class="op" id="5776459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776463">return</span>&nbsp;<span class="ident" id="5776470">p</span><span class="op" id="5776471">,</span>&nbsp;<span class="ident" id="5776473">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776481">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776484">if</span>&nbsp;<span class="ident" id="5776487">binaryOnly</span>&nbsp;<span class="op" id="5776498">&amp;&amp;</span>&nbsp;<span class="op" id="5776501">(</span><span class="ident" id="5776502">mode</span><span class="op" id="5776506">&amp;</span><span class="ident" id="5776507">AllowBinary</span><span class="op" id="5776518">)</span>&nbsp;<span class="op" id="5776520">!=</span>&nbsp;<span class="num" id="5776523">0</span>&nbsp;<span class="op" id="5776525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776529">return</span>&nbsp;<span class="ident" id="5776536">p</span><span class="op" id="5776537">,</span>&nbsp;<span class="ident" id="5776539">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776551">dirs</span><span class="op" id="5776555">,</span>&nbsp;<span class="ident" id="5776557">err</span>&nbsp;<span class="op" id="5776561">:=</span>&nbsp;<span class="ident" id="5776564">ctxt</span><span class="op" id="5776568">.</span><span class="ident" id="5776569">readDir</span><span class="op" id="5776576">(</span><span class="ident" id="5776577">p</span><span class="op" id="5776578">.</span><span class="ident" id="5776579">Dir</span><span class="op" id="5776582">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776585">if</span>&nbsp;<span class="ident" id="5776588">err</span>&nbsp;<span class="op" id="5776592">!=</span>&nbsp;<span class="ident" id="5776595">nil</span>&nbsp;<span class="op" id="5776599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776603">return</span>&nbsp;<span class="ident" id="5776610">p</span><span class="op" id="5776611">,</span>&nbsp;<span class="ident" id="5776613">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776622">var</span>&nbsp;<span class="ident" id="5776626">Sfiles</span>&nbsp;<span class="op" id="5776633">[</span><span class="op" id="5776634">]</span><span class="builtintype" id="5776635">string</span>&nbsp;<span class="comment" id="5776642">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776674">var</span>&nbsp;<span class="ident" id="5776678">firstFile</span><span class="op" id="5776687">,</span>&nbsp;<span class="ident" id="5776689">firstCommentFile</span>&nbsp;<span class="builtintype" id="5776706">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776714">imported</span>&nbsp;<span class="op" id="5776723">:=</span>&nbsp;<span class="builtinfunc" id="5776726">make</span><span class="op" id="5776730">(</span><span class="keyword" id="5776731">map</span><span class="op" id="5776734">[</span><span class="builtintype" id="5776735">string</span><span class="op" id="5776741">]</span><span class="op" id="5776742">[</span><span class="op" id="5776743">]</span><span class="ident" id="5776744">token</span><span class="op" id="5776749">.</span><span class="ident" id="5776750">Position</span><span class="op" id="5776758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776761">testImported</span>&nbsp;<span class="op" id="5776774">:=</span>&nbsp;<span class="builtinfunc" id="5776777">make</span><span class="op" id="5776781">(</span><span class="keyword" id="5776782">map</span><span class="op" id="5776785">[</span><span class="builtintype" id="5776786">string</span><span class="op" id="5776792">]</span><span class="op" id="5776793">[</span><span class="op" id="5776794">]</span><span class="ident" id="5776795">token</span><span class="op" id="5776800">.</span><span class="ident" id="5776801">Position</span><span class="op" id="5776809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776812">xTestImported</span>&nbsp;<span class="op" id="5776826">:=</span>&nbsp;<span class="builtinfunc" id="5776829">make</span><span class="op" id="5776833">(</span><span class="keyword" id="5776834">map</span><span class="op" id="5776837">[</span><span class="builtintype" id="5776838">string</span><span class="op" id="5776844">]</span><span class="op" id="5776845">[</span><span class="op" id="5776846">]</span><span class="ident" id="5776847">token</span><span class="op" id="5776852">.</span><span class="ident" id="5776853">Position</span><span class="op" id="5776861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776864">allTags</span>&nbsp;<span class="op" id="5776872">:=</span>&nbsp;<span class="builtinfunc" id="5776875">make</span><span class="op" id="5776879">(</span><span class="keyword" id="5776880">map</span><span class="op" id="5776883">[</span><span class="builtintype" id="5776884">string</span><span class="op" id="5776890">]</span><span class="builtintype" id="5776891">bool</span><span class="op" id="5776895">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776898">fset</span>&nbsp;<span class="op" id="5776903">:=</span>&nbsp;<span class="ident" id="5776906">token</span><span class="op" id="5776911">.</span><span class="ident" id="5776912">NewFileSet</span><span class="op" id="5776922">(</span><span class="op" id="5776923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776926">for</span>&nbsp;<span class="ident" id="5776930">_</span><span class="op" id="5776931">,</span>&nbsp;<span class="ident" id="5776933">d</span>&nbsp;<span class="op" id="5776935">:=</span>&nbsp;<span class="keyword" id="5776938">range</span>&nbsp;<span class="ident" id="5776944">dirs</span>&nbsp;<span class="op" id="5776949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776953">if</span>&nbsp;<span class="ident" id="5776956">d</span><span class="op" id="5776957">.</span><span class="ident" id="5776958">IsDir</span><span class="op" id="5776963">(</span><span class="op" id="5776964">)</span>&nbsp;<span class="op" id="5776966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5776971">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5776982">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5776987">name</span>&nbsp;<span class="op" id="5776992">:=</span>&nbsp;<span class="ident" id="5776995">d</span><span class="op" id="5776996">.</span><span class="ident" id="5776997">Name</span><span class="op" id="5777001">(</span><span class="op" id="5777002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777006">ext</span>&nbsp;<span class="op" id="5777010">:=</span>&nbsp;<span class="ident" id="5777013">nameExt</span><span class="op" id="5777020">(</span><span class="ident" id="5777021">name</span><span class="op" id="5777025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777030">match</span><span class="op" id="5777035">,</span>&nbsp;<span class="ident" id="5777037">data</span><span class="op" id="5777041">,</span>&nbsp;<span class="ident" id="5777043">filename</span><span class="op" id="5777051">,</span>&nbsp;<span class="ident" id="5777053">err</span>&nbsp;<span class="op" id="5777057">:=</span>&nbsp;<span class="ident" id="5777060">ctxt</span><span class="op" id="5777064">.</span><span class="ident" id="5777065">matchFile</span><span class="op" id="5777074">(</span><span class="ident" id="5777075">p</span><span class="op" id="5777076">.</span><span class="ident" id="5777077">Dir</span><span class="op" id="5777080">,</span>&nbsp;<span class="ident" id="5777082">name</span><span class="op" id="5777086">,</span>&nbsp;<span class="builtintype" id="5777088">true</span><span class="op" id="5777092">,</span>&nbsp;<span class="ident" id="5777094">allTags</span><span class="op" id="5777101">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777105">if</span>&nbsp;<span class="ident" id="5777108">err</span>&nbsp;<span class="op" id="5777112">!=</span>&nbsp;<span class="ident" id="5777115">nil</span>&nbsp;<span class="op" id="5777119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777124">return</span>&nbsp;<span class="ident" id="5777131">p</span><span class="op" id="5777132">,</span>&nbsp;<span class="ident" id="5777134">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5777140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777144">if</span>&nbsp;<span class="op" id="5777147">!</span><span class="ident" id="5777148">match</span>&nbsp;<span class="op" id="5777154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777159">if</span>&nbsp;<span class="ident" id="5777162">ext</span>&nbsp;<span class="op" id="5777166">==</span>&nbsp;<span class="string" id="5777169">&#34;.go&#34;</span>&nbsp;<span class="op" id="5777175">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777181">p</span><span class="op" id="5777182">.</span><span class="ident" id="5777183">IgnoredGoFiles</span>&nbsp;<span class="op" id="5777198">=</span>&nbsp;<span class="builtinfunc" id="5777200">append</span><span class="op" id="5777206">(</span><span class="ident" id="5777207">p</span><span class="op" id="5777208">.</span><span class="ident" id="5777209">IgnoredGoFiles</span><span class="op" id="5777223">,</span>&nbsp;<span class="ident" id="5777225">name</span><span class="op" id="5777229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5777234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777239">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5777250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5777255">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777318">switch</span>&nbsp;<span class="ident" id="5777325">ext</span>&nbsp;<span class="op" id="5777329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777333">case</span>&nbsp;<span class="string" id="5777338">&#34;.c&#34;</span><span class="op" id="5777342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777347">p</span><span class="op" id="5777348">.</span><span class="ident" id="5777349">CFiles</span>&nbsp;<span class="op" id="5777356">=</span>&nbsp;<span class="builtinfunc" id="5777358">append</span><span class="op" id="5777364">(</span><span class="ident" id="5777365">p</span><span class="op" id="5777366">.</span><span class="ident" id="5777367">CFiles</span><span class="op" id="5777373">,</span>&nbsp;<span class="ident" id="5777375">name</span><span class="op" id="5777379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777384">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777395">case</span>&nbsp;<span class="string" id="5777400">&#34;.cc&#34;</span><span class="op" id="5777405">,</span>&nbsp;<span class="string" id="5777407">&#34;.cpp&#34;</span><span class="op" id="5777413">,</span>&nbsp;<span class="string" id="5777415">&#34;.cxx&#34;</span><span class="op" id="5777421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777426">p</span><span class="op" id="5777427">.</span><span class="ident" id="5777428">CXXFiles</span>&nbsp;<span class="op" id="5777437">=</span>&nbsp;<span class="builtinfunc" id="5777439">append</span><span class="op" id="5777445">(</span><span class="ident" id="5777446">p</span><span class="op" id="5777447">.</span><span class="ident" id="5777448">CXXFiles</span><span class="op" id="5777456">,</span>&nbsp;<span class="ident" id="5777458">name</span><span class="op" id="5777462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777467">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777478">case</span>&nbsp;<span class="string" id="5777483">&#34;.m&#34;</span><span class="op" id="5777487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777492">p</span><span class="op" id="5777493">.</span><span class="ident" id="5777494">MFiles</span>&nbsp;<span class="op" id="5777501">=</span>&nbsp;<span class="builtinfunc" id="5777503">append</span><span class="op" id="5777509">(</span><span class="ident" id="5777510">p</span><span class="op" id="5777511">.</span><span class="ident" id="5777512">MFiles</span><span class="op" id="5777518">,</span>&nbsp;<span class="ident" id="5777520">name</span><span class="op" id="5777524">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777529">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777540">case</span>&nbsp;<span class="string" id="5777545">&#34;.h&#34;</span><span class="op" id="5777549">,</span>&nbsp;<span class="string" id="5777551">&#34;.hh&#34;</span><span class="op" id="5777556">,</span>&nbsp;<span class="string" id="5777558">&#34;.hpp&#34;</span><span class="op" id="5777564">,</span>&nbsp;<span class="string" id="5777566">&#34;.hxx&#34;</span><span class="op" id="5777572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777577">p</span><span class="op" id="5777578">.</span><span class="ident" id="5777579">HFiles</span>&nbsp;<span class="op" id="5777586">=</span>&nbsp;<span class="builtinfunc" id="5777588">append</span><span class="op" id="5777594">(</span><span class="ident" id="5777595">p</span><span class="op" id="5777596">.</span><span class="ident" id="5777597">HFiles</span><span class="op" id="5777603">,</span>&nbsp;<span class="ident" id="5777605">name</span><span class="op" id="5777609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777614">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777625">case</span>&nbsp;<span class="string" id="5777630">&#34;.s&#34;</span><span class="op" id="5777634">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777639">p</span><span class="op" id="5777640">.</span><span class="ident" id="5777641">SFiles</span>&nbsp;<span class="op" id="5777648">=</span>&nbsp;<span class="builtinfunc" id="5777650">append</span><span class="op" id="5777656">(</span><span class="ident" id="5777657">p</span><span class="op" id="5777658">.</span><span class="ident" id="5777659">SFiles</span><span class="op" id="5777665">,</span>&nbsp;<span class="ident" id="5777667">name</span><span class="op" id="5777671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777676">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777687">case</span>&nbsp;<span class="string" id="5777692">&#34;.S&#34;</span><span class="op" id="5777696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777701">Sfiles</span>&nbsp;<span class="op" id="5777708">=</span>&nbsp;<span class="builtinfunc" id="5777710">append</span><span class="op" id="5777716">(</span><span class="ident" id="5777717">Sfiles</span><span class="op" id="5777723">,</span>&nbsp;<span class="ident" id="5777725">name</span><span class="op" id="5777729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777734">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777745">case</span>&nbsp;<span class="string" id="5777750">&#34;.swig&#34;</span><span class="op" id="5777757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777762">p</span><span class="op" id="5777763">.</span><span class="ident" id="5777764">SwigFiles</span>&nbsp;<span class="op" id="5777774">=</span>&nbsp;<span class="builtinfunc" id="5777776">append</span><span class="op" id="5777782">(</span><span class="ident" id="5777783">p</span><span class="op" id="5777784">.</span><span class="ident" id="5777785">SwigFiles</span><span class="op" id="5777794">,</span>&nbsp;<span class="ident" id="5777796">name</span><span class="op" id="5777800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777805">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777816">case</span>&nbsp;<span class="string" id="5777821">&#34;.swigcxx&#34;</span><span class="op" id="5777831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777836">p</span><span class="op" id="5777837">.</span><span class="ident" id="5777838">SwigCXXFiles</span>&nbsp;<span class="op" id="5777851">=</span>&nbsp;<span class="builtinfunc" id="5777853">append</span><span class="op" id="5777859">(</span><span class="ident" id="5777860">p</span><span class="op" id="5777861">.</span><span class="ident" id="5777862">SwigCXXFiles</span><span class="op" id="5777874">,</span>&nbsp;<span class="ident" id="5777876">name</span><span class="op" id="5777880">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777885">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5777896">case</span>&nbsp;<span class="string" id="5777901">&#34;.syso&#34;</span><span class="op" id="5777908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5777913">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5777960">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778007">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778060">p</span><span class="op" id="5778061">.</span><span class="ident" id="5778062">SysoFiles</span>&nbsp;<span class="op" id="5778072">=</span>&nbsp;<span class="builtinfunc" id="5778074">append</span><span class="op" id="5778080">(</span><span class="ident" id="5778081">p</span><span class="op" id="5778082">.</span><span class="ident" id="5778083">SysoFiles</span><span class="op" id="5778092">,</span>&nbsp;<span class="ident" id="5778094">name</span><span class="op" id="5778098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778103">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5778114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778119">pf</span><span class="op" id="5778121">,</span>&nbsp;<span class="ident" id="5778123">err</span>&nbsp;<span class="op" id="5778127">:=</span>&nbsp;<span class="ident" id="5778130">parser</span><span class="op" id="5778136">.</span><span class="ident" id="5778137">ParseFile</span><span class="op" id="5778146">(</span><span class="ident" id="5778147">fset</span><span class="op" id="5778151">,</span>&nbsp;<span class="ident" id="5778153">filename</span><span class="op" id="5778161">,</span>&nbsp;<span class="ident" id="5778163">data</span><span class="op" id="5778167">,</span>&nbsp;<span class="ident" id="5778169">parser</span><span class="op" id="5778175">.</span><span class="ident" id="5778176">ImportsOnly</span><span class="op" id="5778187">|</span><span class="ident" id="5778188">parser</span><span class="op" id="5778194">.</span><span class="ident" id="5778195">ParseComments</span><span class="op" id="5778208">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778212">if</span>&nbsp;<span class="ident" id="5778215">err</span>&nbsp;<span class="op" id="5778219">!=</span>&nbsp;<span class="ident" id="5778222">nil</span>&nbsp;<span class="op" id="5778226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778231">return</span>&nbsp;<span class="ident" id="5778238">p</span><span class="op" id="5778239">,</span>&nbsp;<span class="ident" id="5778241">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5778247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778252">pkg</span>&nbsp;<span class="op" id="5778256">:=</span>&nbsp;<span class="ident" id="5778259">pf</span><span class="op" id="5778261">.</span><span class="ident" id="5778262">Name</span><span class="op" id="5778266">.</span><span class="ident" id="5778267">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778274">if</span>&nbsp;<span class="ident" id="5778277">pkg</span>&nbsp;<span class="op" id="5778281">==</span>&nbsp;<span class="string" id="5778284">&#34;documentation&#34;</span>&nbsp;<span class="op" id="5778300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778305">p</span><span class="op" id="5778306">.</span><span class="ident" id="5778307">IgnoredGoFiles</span>&nbsp;<span class="op" id="5778322">=</span>&nbsp;<span class="builtinfunc" id="5778324">append</span><span class="op" id="5778330">(</span><span class="ident" id="5778331">p</span><span class="op" id="5778332">.</span><span class="ident" id="5778333">IgnoredGoFiles</span><span class="op" id="5778347">,</span>&nbsp;<span class="ident" id="5778349">name</span><span class="op" id="5778353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778358">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5778369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778374">isTest</span>&nbsp;<span class="op" id="5778381">:=</span>&nbsp;<span class="ident" id="5778384">strings</span><span class="op" id="5778391">.</span><span class="ident" id="5778392">HasSuffix</span><span class="op" id="5778401">(</span><span class="ident" id="5778402">name</span><span class="op" id="5778406">,</span>&nbsp;<span class="string" id="5778408">&#34;_test.go&#34;</span><span class="op" id="5778418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778422">isXTest</span>&nbsp;<span class="op" id="5778430">:=</span>&nbsp;<span class="builtintype" id="5778433">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778441">if</span>&nbsp;<span class="ident" id="5778444">isTest</span>&nbsp;<span class="op" id="5778451">&amp;&amp;</span>&nbsp;<span class="ident" id="5778454">strings</span><span class="op" id="5778461">.</span><span class="ident" id="5778462">HasSuffix</span><span class="op" id="5778471">(</span><span class="ident" id="5778472">pkg</span><span class="op" id="5778475">,</span>&nbsp;<span class="string" id="5778477">&#34;_test&#34;</span><span class="op" id="5778484">)</span>&nbsp;<span class="op" id="5778486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778491">isXTest</span>&nbsp;<span class="op" id="5778499">=</span>&nbsp;<span class="builtintype" id="5778501">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778509">pkg</span>&nbsp;<span class="op" id="5778513">=</span>&nbsp;<span class="ident" id="5778515">pkg</span><span class="op" id="5778518">[</span><span class="op" id="5778519">:</span><span class="builtinfunc" id="5778520">len</span><span class="op" id="5778523">(</span><span class="ident" id="5778524">pkg</span><span class="op" id="5778527">)</span><span class="op" id="5778528">-</span><span class="builtinfunc" id="5778529">len</span><span class="op" id="5778532">(</span><span class="string" id="5778533">&#34;_test&#34;</span><span class="op" id="5778540">)</span><span class="op" id="5778541">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5778545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778550">if</span>&nbsp;<span class="ident" id="5778553">p</span><span class="op" id="5778554">.</span><span class="ident" id="5778555">Name</span>&nbsp;<span class="op" id="5778560">==</span>&nbsp;<span class="string" id="5778563">&#34;&#34;</span>&nbsp;<span class="op" id="5778566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778571">p</span><span class="op" id="5778572">.</span><span class="ident" id="5778573">Name</span>&nbsp;<span class="op" id="5778578">=</span>&nbsp;<span class="ident" id="5778580">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778587">firstFile</span>&nbsp;<span class="op" id="5778597">=</span>&nbsp;<span class="ident" id="5778599">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5778606">}</span>&nbsp;<span class="keyword" id="5778608">else</span>&nbsp;<span class="keyword" id="5778613">if</span>&nbsp;<span class="ident" id="5778616">pkg</span>&nbsp;<span class="op" id="5778620">!=</span>&nbsp;<span class="ident" id="5778623">p</span><span class="op" id="5778624">.</span><span class="ident" id="5778625">Name</span>&nbsp;<span class="op" id="5778630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778635">return</span>&nbsp;<span class="ident" id="5778642">p</span><span class="op" id="5778643">,</span>&nbsp;<span class="op" id="5778645">&amp;</span><span class="ident" id="5778646">MultiplePackageError</span><span class="op" id="5778666">{</span><span class="ident" id="5778667">p</span><span class="op" id="5778668">.</span><span class="ident" id="5778669">Dir</span><span class="op" id="5778672">,</span>&nbsp;<span class="op" id="5778674">[</span><span class="op" id="5778675">]</span><span class="builtintype" id="5778676">string</span><span class="op" id="5778682">{</span><span class="ident" id="5778683">firstFile</span><span class="op" id="5778692">,</span>&nbsp;<span class="ident" id="5778694">name</span><span class="op" id="5778698">}</span><span class="op" id="5778699">,</span>&nbsp;<span class="op" id="5778701">[</span><span class="op" id="5778702">]</span><span class="builtintype" id="5778703">string</span><span class="op" id="5778709">{</span><span class="ident" id="5778710">p</span><span class="op" id="5778711">.</span><span class="ident" id="5778712">Name</span><span class="op" id="5778716">,</span>&nbsp;<span class="ident" id="5778718">pkg</span><span class="op" id="5778721">}</span><span class="op" id="5778722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5778726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778730">if</span>&nbsp;<span class="ident" id="5778733">pf</span><span class="op" id="5778735">.</span><span class="ident" id="5778736">Doc</span>&nbsp;<span class="op" id="5778740">!=</span>&nbsp;<span class="ident" id="5778743">nil</span>&nbsp;<span class="op" id="5778747">&amp;&amp;</span>&nbsp;<span class="ident" id="5778750">p</span><span class="op" id="5778751">.</span><span class="ident" id="5778752">Doc</span>&nbsp;<span class="op" id="5778756">==</span>&nbsp;<span class="string" id="5778759">&#34;&#34;</span>&nbsp;<span class="op" id="5778762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778767">p</span><span class="op" id="5778768">.</span><span class="ident" id="5778769">Doc</span>&nbsp;<span class="op" id="5778773">=</span>&nbsp;<span class="ident" id="5778775">doc</span><span class="op" id="5778778">.</span><span class="ident" id="5778779">Synopsis</span><span class="op" id="5778787">(</span><span class="ident" id="5778788">pf</span><span class="op" id="5778790">.</span><span class="ident" id="5778791">Doc</span><span class="op" id="5778794">.</span><span class="ident" id="5778795">Text</span><span class="op" id="5778799">(</span><span class="op" id="5778800">)</span><span class="op" id="5778801">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5778805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778810">if</span>&nbsp;<span class="ident" id="5778813">mode</span><span class="op" id="5778817">&amp;</span><span class="ident" id="5778818">ImportComment</span>&nbsp;<span class="op" id="5778832">!=</span>&nbsp;<span class="num" id="5778835">0</span>&nbsp;<span class="op" id="5778837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778842">qcom</span><span class="op" id="5778846">,</span>&nbsp;<span class="ident" id="5778848">line</span>&nbsp;<span class="op" id="5778853">:=</span>&nbsp;<span class="ident" id="5778856">findImportComment</span><span class="op" id="5778873">(</span><span class="ident" id="5778874">data</span><span class="op" id="5778878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778883">if</span>&nbsp;<span class="ident" id="5778886">line</span>&nbsp;<span class="op" id="5778891">!=</span>&nbsp;<span class="num" id="5778894">0</span>&nbsp;<span class="op" id="5778896">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778902">com</span><span class="op" id="5778905">,</span>&nbsp;<span class="ident" id="5778907">err</span>&nbsp;<span class="op" id="5778911">:=</span>&nbsp;<span class="ident" id="5778914">strconv</span><span class="op" id="5778921">.</span><span class="ident" id="5778922">Unquote</span><span class="op" id="5778929">(</span><span class="ident" id="5778930">qcom</span><span class="op" id="5778934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778940">if</span>&nbsp;<span class="ident" id="5778943">err</span>&nbsp;<span class="op" id="5778947">!=</span>&nbsp;<span class="ident" id="5778950">nil</span>&nbsp;<span class="op" id="5778954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5778961">return</span>&nbsp;<span class="ident" id="5778968">p</span><span class="op" id="5778969">,</span>&nbsp;<span class="ident" id="5778971">fmt</span><span class="op" id="5778974">.</span><span class="ident" id="5778975">Errorf</span><span class="op" id="5778981">(</span><span class="string" id="5778982">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="5779018">,</span>&nbsp;<span class="ident" id="5779020">filename</span><span class="op" id="5779028">,</span>&nbsp;<span class="ident" id="5779030">line</span><span class="op" id="5779034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779046">if</span>&nbsp;<span class="ident" id="5779049">p</span><span class="op" id="5779050">.</span><span class="ident" id="5779051">ImportComment</span>&nbsp;<span class="op" id="5779065">==</span>&nbsp;<span class="string" id="5779068">&#34;&#34;</span>&nbsp;<span class="op" id="5779071">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779078">p</span><span class="op" id="5779079">.</span><span class="ident" id="5779080">ImportComment</span>&nbsp;<span class="op" id="5779094">=</span>&nbsp;<span class="ident" id="5779096">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779105">firstCommentFile</span>&nbsp;<span class="op" id="5779122">=</span>&nbsp;<span class="ident" id="5779124">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779133">}</span>&nbsp;<span class="keyword" id="5779135">else</span>&nbsp;<span class="keyword" id="5779140">if</span>&nbsp;<span class="ident" id="5779143">p</span><span class="op" id="5779144">.</span><span class="ident" id="5779145">ImportComment</span>&nbsp;<span class="op" id="5779159">!=</span>&nbsp;<span class="ident" id="5779162">com</span>&nbsp;<span class="op" id="5779166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779173">return</span>&nbsp;<span class="ident" id="5779180">p</span><span class="op" id="5779181">,</span>&nbsp;<span class="ident" id="5779183">fmt</span><span class="op" id="5779186">.</span><span class="ident" id="5779187">Errorf</span><span class="op" id="5779193">(</span><span class="string" id="5779194">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="5779243">,</span>&nbsp;<span class="ident" id="5779245">p</span><span class="op" id="5779246">.</span><span class="ident" id="5779247">ImportComment</span><span class="op" id="5779260">,</span>&nbsp;<span class="ident" id="5779262">firstCommentFile</span><span class="op" id="5779278">,</span>&nbsp;<span class="ident" id="5779280">com</span><span class="op" id="5779283">,</span>&nbsp;<span class="ident" id="5779285">name</span><span class="op" id="5779289">,</span>&nbsp;<span class="ident" id="5779291">p</span><span class="op" id="5779292">.</span><span class="ident" id="5779293">Dir</span><span class="op" id="5779296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779302">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779316">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779363">isCgo</span>&nbsp;<span class="op" id="5779369">:=</span>&nbsp;<span class="builtintype" id="5779372">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779380">for</span>&nbsp;<span class="ident" id="5779384">_</span><span class="op" id="5779385">,</span>&nbsp;<span class="ident" id="5779387">decl</span>&nbsp;<span class="op" id="5779392">:=</span>&nbsp;<span class="keyword" id="5779395">range</span>&nbsp;<span class="ident" id="5779401">pf</span><span class="op" id="5779403">.</span><span class="ident" id="5779404">Decls</span>&nbsp;<span class="op" id="5779410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779415">d</span><span class="op" id="5779416">,</span>&nbsp;<span class="ident" id="5779418">ok</span>&nbsp;<span class="op" id="5779421">:=</span>&nbsp;<span class="ident" id="5779424">decl</span><span class="op" id="5779428">.</span><span class="op" id="5779429">(</span><span class="op" id="5779430">*</span><span class="ident" id="5779431">ast</span><span class="op" id="5779434">.</span><span class="ident" id="5779435">GenDecl</span><span class="op" id="5779442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779447">if</span>&nbsp;<span class="op" id="5779450">!</span><span class="ident" id="5779451">ok</span>&nbsp;<span class="op" id="5779454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779460">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779472">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779477">for</span>&nbsp;<span class="ident" id="5779481">_</span><span class="op" id="5779482">,</span>&nbsp;<span class="ident" id="5779484">dspec</span>&nbsp;<span class="op" id="5779490">:=</span>&nbsp;<span class="keyword" id="5779493">range</span>&nbsp;<span class="ident" id="5779499">d</span><span class="op" id="5779500">.</span><span class="ident" id="5779501">Specs</span>&nbsp;<span class="op" id="5779507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779513">spec</span><span class="op" id="5779517">,</span>&nbsp;<span class="ident" id="5779519">ok</span>&nbsp;<span class="op" id="5779522">:=</span>&nbsp;<span class="ident" id="5779525">dspec</span><span class="op" id="5779530">.</span><span class="op" id="5779531">(</span><span class="op" id="5779532">*</span><span class="ident" id="5779533">ast</span><span class="op" id="5779536">.</span><span class="ident" id="5779537">ImportSpec</span><span class="op" id="5779547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779553">if</span>&nbsp;<span class="op" id="5779556">!</span><span class="ident" id="5779557">ok</span>&nbsp;<span class="op" id="5779560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779567">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779580">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779586">quoted</span>&nbsp;<span class="op" id="5779593">:=</span>&nbsp;<span class="ident" id="5779596">spec</span><span class="op" id="5779600">.</span><span class="ident" id="5779601">Path</span><span class="op" id="5779605">.</span><span class="ident" id="5779606">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779616">path</span><span class="op" id="5779620">,</span>&nbsp;<span class="ident" id="5779622">err</span>&nbsp;<span class="op" id="5779626">:=</span>&nbsp;<span class="ident" id="5779629">strconv</span><span class="op" id="5779636">.</span><span class="ident" id="5779637">Unquote</span><span class="op" id="5779644">(</span><span class="ident" id="5779645">quoted</span><span class="op" id="5779651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779657">if</span>&nbsp;<span class="ident" id="5779660">err</span>&nbsp;<span class="op" id="5779664">!=</span>&nbsp;<span class="ident" id="5779667">nil</span>&nbsp;<span class="op" id="5779671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779678">log</span><span class="op" id="5779681">.</span><span class="ident" id="5779682">Panicf</span><span class="op" id="5779688">(</span><span class="string" id="5779689">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="5779738">,</span>&nbsp;<span class="ident" id="5779740">filename</span><span class="op" id="5779748">,</span>&nbsp;<span class="ident" id="5779750">quoted</span><span class="op" id="5779756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779762">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5779768">if</span>&nbsp;<span class="ident" id="5779771">isXTest</span>&nbsp;<span class="op" id="5779779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779786">xTestImported</span><span class="op" id="5779799">[</span><span class="ident" id="5779800">path</span><span class="op" id="5779804">]</span>&nbsp;<span class="op" id="5779806">=</span>&nbsp;<span class="builtinfunc" id="5779808">append</span><span class="op" id="5779814">(</span><span class="ident" id="5779815">xTestImported</span><span class="op" id="5779828">[</span><span class="ident" id="5779829">path</span><span class="op" id="5779833">]</span><span class="op" id="5779834">,</span>&nbsp;<span class="ident" id="5779836">fset</span><span class="op" id="5779840">.</span><span class="ident" id="5779841">Position</span><span class="op" id="5779849">(</span><span class="ident" id="5779850">spec</span><span class="op" id="5779854">.</span><span class="ident" id="5779855">Pos</span><span class="op" id="5779858">(</span><span class="op" id="5779859">)</span><span class="op" id="5779860">)</span><span class="op" id="5779861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779867">}</span>&nbsp;<span class="keyword" id="5779869">else</span>&nbsp;<span class="keyword" id="5779874">if</span>&nbsp;<span class="ident" id="5779877">isTest</span>&nbsp;<span class="op" id="5779884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779891">testImported</span><span class="op" id="5779903">[</span><span class="ident" id="5779904">path</span><span class="op" id="5779908">]</span>&nbsp;<span class="op" id="5779910">=</span>&nbsp;<span class="builtinfunc" id="5779912">append</span><span class="op" id="5779918">(</span><span class="ident" id="5779919">testImported</span><span class="op" id="5779931">[</span><span class="ident" id="5779932">path</span><span class="op" id="5779936">]</span><span class="op" id="5779937">,</span>&nbsp;<span class="ident" id="5779939">fset</span><span class="op" id="5779943">.</span><span class="ident" id="5779944">Position</span><span class="op" id="5779952">(</span><span class="ident" id="5779953">spec</span><span class="op" id="5779957">.</span><span class="ident" id="5779958">Pos</span><span class="op" id="5779961">(</span><span class="op" id="5779962">)</span><span class="op" id="5779963">)</span><span class="op" id="5779964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5779970">}</span>&nbsp;<span class="keyword" id="5779972">else</span>&nbsp;<span class="op" id="5779977">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779984">imported</span><span class="op" id="5779992">[</span><span class="ident" id="5779993">path</span><span class="op" id="5779997">]</span>&nbsp;<span class="op" id="5779999">=</span>&nbsp;<span class="builtinfunc" id="5780001">append</span><span class="op" id="5780007">(</span><span class="ident" id="5780008">imported</span><span class="op" id="5780016">[</span><span class="ident" id="5780017">path</span><span class="op" id="5780021">]</span><span class="op" id="5780022">,</span>&nbsp;<span class="ident" id="5780024">fset</span><span class="op" id="5780028">.</span><span class="ident" id="5780029">Position</span><span class="op" id="5780037">(</span><span class="ident" id="5780038">spec</span><span class="op" id="5780042">.</span><span class="ident" id="5780043">Pos</span><span class="op" id="5780046">(</span><span class="op" id="5780047">)</span><span class="op" id="5780048">)</span><span class="op" id="5780049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780061">if</span>&nbsp;<span class="ident" id="5780064">path</span>&nbsp;<span class="op" id="5780069">==</span>&nbsp;<span class="string" id="5780072">&#34;C&#34;</span>&nbsp;<span class="op" id="5780076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780083">if</span>&nbsp;<span class="ident" id="5780086">isTest</span>&nbsp;<span class="op" id="5780093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780101">return</span>&nbsp;<span class="ident" id="5780108">p</span><span class="op" id="5780109">,</span>&nbsp;<span class="ident" id="5780111">fmt</span><span class="op" id="5780114">.</span><span class="ident" id="5780115">Errorf</span><span class="op" id="5780121">(</span><span class="string" id="5780122">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="5780159">,</span>&nbsp;<span class="ident" id="5780161">filename</span><span class="op" id="5780169">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780183">cg</span>&nbsp;<span class="op" id="5780186">:=</span>&nbsp;<span class="ident" id="5780189">spec</span><span class="op" id="5780193">.</span><span class="ident" id="5780194">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780203">if</span>&nbsp;<span class="ident" id="5780206">cg</span>&nbsp;<span class="op" id="5780209">==</span>&nbsp;<span class="ident" id="5780212">nil</span>&nbsp;<span class="op" id="5780216">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5780219">len</span><span class="op" id="5780222">(</span><span class="ident" id="5780223">d</span><span class="op" id="5780224">.</span><span class="ident" id="5780225">Specs</span><span class="op" id="5780230">)</span>&nbsp;<span class="op" id="5780232">==</span>&nbsp;<span class="num" id="5780235">1</span>&nbsp;<span class="op" id="5780237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780245">cg</span>&nbsp;<span class="op" id="5780248">=</span>&nbsp;<span class="ident" id="5780250">d</span><span class="op" id="5780251">.</span><span class="ident" id="5780252">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780261">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780268">if</span>&nbsp;<span class="ident" id="5780271">cg</span>&nbsp;<span class="op" id="5780274">!=</span>&nbsp;<span class="ident" id="5780277">nil</span>&nbsp;<span class="op" id="5780281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780289">if</span>&nbsp;<span class="ident" id="5780292">err</span>&nbsp;<span class="op" id="5780296">:=</span>&nbsp;<span class="ident" id="5780299">ctxt</span><span class="op" id="5780303">.</span><span class="ident" id="5780304">saveCgo</span><span class="op" id="5780311">(</span><span class="ident" id="5780312">filename</span><span class="op" id="5780320">,</span>&nbsp;<span class="ident" id="5780322">p</span><span class="op" id="5780323">,</span>&nbsp;<span class="ident" id="5780325">cg</span><span class="op" id="5780327">)</span><span class="op" id="5780328">;</span>&nbsp;<span class="ident" id="5780330">err</span>&nbsp;<span class="op" id="5780334">!=</span>&nbsp;<span class="ident" id="5780337">nil</span>&nbsp;<span class="op" id="5780341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780350">return</span>&nbsp;<span class="ident" id="5780357">p</span><span class="op" id="5780358">,</span>&nbsp;<span class="ident" id="5780360">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780377">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780384">isCgo</span>&nbsp;<span class="op" id="5780390">=</span>&nbsp;<span class="builtintype" id="5780392">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780414">if</span>&nbsp;<span class="ident" id="5780417">isCgo</span>&nbsp;<span class="op" id="5780423">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780428">allTags</span><span class="op" id="5780435">[</span><span class="string" id="5780436">&#34;cgo&#34;</span><span class="op" id="5780441">]</span>&nbsp;<span class="op" id="5780443">=</span>&nbsp;<span class="builtintype" id="5780445">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780453">if</span>&nbsp;<span class="ident" id="5780456">ctxt</span><span class="op" id="5780460">.</span><span class="ident" id="5780461">CgoEnabled</span>&nbsp;<span class="op" id="5780472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780478">p</span><span class="op" id="5780479">.</span><span class="ident" id="5780480">CgoFiles</span>&nbsp;<span class="op" id="5780489">=</span>&nbsp;<span class="builtinfunc" id="5780491">append</span><span class="op" id="5780497">(</span><span class="ident" id="5780498">p</span><span class="op" id="5780499">.</span><span class="ident" id="5780500">CgoFiles</span><span class="op" id="5780508">,</span>&nbsp;<span class="ident" id="5780510">name</span><span class="op" id="5780514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780519">}</span>&nbsp;<span class="keyword" id="5780521">else</span>&nbsp;<span class="op" id="5780526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780532">p</span><span class="op" id="5780533">.</span><span class="ident" id="5780534">IgnoredGoFiles</span>&nbsp;<span class="op" id="5780549">=</span>&nbsp;<span class="builtinfunc" id="5780551">append</span><span class="op" id="5780557">(</span><span class="ident" id="5780558">p</span><span class="op" id="5780559">.</span><span class="ident" id="5780560">IgnoredGoFiles</span><span class="op" id="5780574">,</span>&nbsp;<span class="ident" id="5780576">name</span><span class="op" id="5780580">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780589">}</span>&nbsp;<span class="keyword" id="5780591">else</span>&nbsp;<span class="keyword" id="5780596">if</span>&nbsp;<span class="ident" id="5780599">isXTest</span>&nbsp;<span class="op" id="5780607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780612">p</span><span class="op" id="5780613">.</span><span class="ident" id="5780614">XTestGoFiles</span>&nbsp;<span class="op" id="5780627">=</span>&nbsp;<span class="builtinfunc" id="5780629">append</span><span class="op" id="5780635">(</span><span class="ident" id="5780636">p</span><span class="op" id="5780637">.</span><span class="ident" id="5780638">XTestGoFiles</span><span class="op" id="5780650">,</span>&nbsp;<span class="ident" id="5780652">name</span><span class="op" id="5780656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780660">}</span>&nbsp;<span class="keyword" id="5780662">else</span>&nbsp;<span class="keyword" id="5780667">if</span>&nbsp;<span class="ident" id="5780670">isTest</span>&nbsp;<span class="op" id="5780677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780682">p</span><span class="op" id="5780683">.</span><span class="ident" id="5780684">TestGoFiles</span>&nbsp;<span class="op" id="5780696">=</span>&nbsp;<span class="builtinfunc" id="5780698">append</span><span class="op" id="5780704">(</span><span class="ident" id="5780705">p</span><span class="op" id="5780706">.</span><span class="ident" id="5780707">TestGoFiles</span><span class="op" id="5780718">,</span>&nbsp;<span class="ident" id="5780720">name</span><span class="op" id="5780724">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780728">}</span>&nbsp;<span class="keyword" id="5780730">else</span>&nbsp;<span class="op" id="5780735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780740">p</span><span class="op" id="5780741">.</span><span class="ident" id="5780742">GoFiles</span>&nbsp;<span class="op" id="5780750">=</span>&nbsp;<span class="builtinfunc" id="5780752">append</span><span class="op" id="5780758">(</span><span class="ident" id="5780759">p</span><span class="op" id="5780760">.</span><span class="ident" id="5780761">GoFiles</span><span class="op" id="5780768">,</span>&nbsp;<span class="ident" id="5780770">name</span><span class="op" id="5780774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780784">if</span>&nbsp;<span class="builtinfunc" id="5780787">len</span><span class="op" id="5780790">(</span><span class="ident" id="5780791">p</span><span class="op" id="5780792">.</span><span class="ident" id="5780793">GoFiles</span><span class="op" id="5780800">)</span><span class="op" id="5780801">+</span><span class="builtinfunc" id="5780802">len</span><span class="op" id="5780805">(</span><span class="ident" id="5780806">p</span><span class="op" id="5780807">.</span><span class="ident" id="5780808">CgoFiles</span><span class="op" id="5780816">)</span><span class="op" id="5780817">+</span><span class="builtinfunc" id="5780818">len</span><span class="op" id="5780821">(</span><span class="ident" id="5780822">p</span><span class="op" id="5780823">.</span><span class="ident" id="5780824">TestGoFiles</span><span class="op" id="5780835">)</span><span class="op" id="5780836">+</span><span class="builtinfunc" id="5780837">len</span><span class="op" id="5780840">(</span><span class="ident" id="5780841">p</span><span class="op" id="5780842">.</span><span class="ident" id="5780843">XTestGoFiles</span><span class="op" id="5780855">)</span>&nbsp;<span class="op" id="5780857">==</span>&nbsp;<span class="num" id="5780860">0</span>&nbsp;<span class="op" id="5780862">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780866">return</span>&nbsp;<span class="ident" id="5780873">p</span><span class="op" id="5780874">,</span>&nbsp;<span class="op" id="5780876">&amp;</span><span class="ident" id="5780877">NoGoError</span><span class="op" id="5780886">{</span><span class="ident" id="5780887">p</span><span class="op" id="5780888">.</span><span class="ident" id="5780889">Dir</span><span class="op" id="5780892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5780899">for</span>&nbsp;<span class="ident" id="5780903">tag</span>&nbsp;<span class="op" id="5780907">:=</span>&nbsp;<span class="keyword" id="5780910">range</span>&nbsp;<span class="ident" id="5780916">allTags</span>&nbsp;<span class="op" id="5780924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780928">p</span><span class="op" id="5780929">.</span><span class="ident" id="5780930">AllTags</span>&nbsp;<span class="op" id="5780938">=</span>&nbsp;<span class="builtinfunc" id="5780940">append</span><span class="op" id="5780946">(</span><span class="ident" id="5780947">p</span><span class="op" id="5780948">.</span><span class="ident" id="5780949">AllTags</span><span class="op" id="5780956">,</span>&nbsp;<span class="ident" id="5780958">tag</span><span class="op" id="5780961">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5780964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780967">sort</span><span class="op" id="5780971">.</span><span class="ident" id="5780972">Strings</span><span class="op" id="5780979">(</span><span class="ident" id="5780980">p</span><span class="op" id="5780981">.</span><span class="ident" id="5780982">AllTags</span><span class="op" id="5780989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780993">p</span><span class="op" id="5780994">.</span><span class="ident" id="5780995">Imports</span><span class="op" id="5781002">,</span>&nbsp;<span class="ident" id="5781004">p</span><span class="op" id="5781005">.</span><span class="ident" id="5781006">ImportPos</span>&nbsp;<span class="op" id="5781016">=</span>&nbsp;<span class="ident" id="5781018">cleanImports</span><span class="op" id="5781030">(</span><span class="ident" id="5781031">imported</span><span class="op" id="5781039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781042">p</span><span class="op" id="5781043">.</span><span class="ident" id="5781044">TestImports</span><span class="op" id="5781055">,</span>&nbsp;<span class="ident" id="5781057">p</span><span class="op" id="5781058">.</span><span class="ident" id="5781059">TestImportPos</span>&nbsp;<span class="op" id="5781073">=</span>&nbsp;<span class="ident" id="5781075">cleanImports</span><span class="op" id="5781087">(</span><span class="ident" id="5781088">testImported</span><span class="op" id="5781100">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781103">p</span><span class="op" id="5781104">.</span><span class="ident" id="5781105">XTestImports</span><span class="op" id="5781117">,</span>&nbsp;<span class="ident" id="5781119">p</span><span class="op" id="5781120">.</span><span class="ident" id="5781121">XTestImportPos</span>&nbsp;<span class="op" id="5781136">=</span>&nbsp;<span class="ident" id="5781138">cleanImports</span><span class="op" id="5781150">(</span><span class="ident" id="5781151">xTestImported</span><span class="op" id="5781164">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5781168">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5781214">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5781255">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781300">if</span>&nbsp;<span class="builtinfunc" id="5781303">len</span><span class="op" id="5781306">(</span><span class="ident" id="5781307">p</span><span class="op" id="5781308">.</span><span class="ident" id="5781309">CgoFiles</span><span class="op" id="5781317">)</span>&nbsp;<span class="op" id="5781319">&gt;</span>&nbsp;<span class="num" id="5781321">0</span>&nbsp;<span class="op" id="5781323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781327">p</span><span class="op" id="5781328">.</span><span class="ident" id="5781329">SFiles</span>&nbsp;<span class="op" id="5781336">=</span>&nbsp;<span class="builtinfunc" id="5781338">append</span><span class="op" id="5781344">(</span><span class="ident" id="5781345">p</span><span class="op" id="5781346">.</span><span class="ident" id="5781347">SFiles</span><span class="op" id="5781353">,</span>&nbsp;<span class="ident" id="5781355">Sfiles</span><span class="op" id="5781361">...</span><span class="op" id="5781364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781368">sort</span><span class="op" id="5781372">.</span><span class="ident" id="5781373">Strings</span><span class="op" id="5781380">(</span><span class="ident" id="5781381">p</span><span class="op" id="5781382">.</span><span class="ident" id="5781383">SFiles</span><span class="op" id="5781389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5781392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781396">return</span>&nbsp;<span class="ident" id="5781403">p</span><span class="op" id="5781404">,</span>&nbsp;<span class="ident" id="5781406">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="5781413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5781416">func</span>&nbsp;<span class="ident" id="5781421">findImportComment</span><span class="op" id="5781438">(</span><span class="ident" id="5781439">data</span>&nbsp;<span class="op" id="5781444">[</span><span class="op" id="5781445">]</span><span class="builtintype" id="5781446">byte</span><span class="op" id="5781450">)</span>&nbsp;<span class="op" id="5781452">(</span><span class="ident" id="5781453">s</span>&nbsp;<span class="builtintype" id="5781455">string</span><span class="op" id="5781461">,</span>&nbsp;<span class="ident" id="5781463">line</span>&nbsp;<span class="builtintype" id="5781468">int</span><span class="op" id="5781471">)</span>&nbsp;<span class="op" id="5781473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5781476">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781503">word</span><span class="op" id="5781507">,</span>&nbsp;<span class="ident" id="5781509">data</span>&nbsp;<span class="op" id="5781514">:=</span>&nbsp;<span class="ident" id="5781517">parseWord</span><span class="op" id="5781526">(</span><span class="ident" id="5781527">data</span><span class="op" id="5781531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781534">if</span>&nbsp;<span class="builtintype" id="5781537">string</span><span class="op" id="5781543">(</span><span class="ident" id="5781544">word</span><span class="op" id="5781548">)</span>&nbsp;<span class="op" id="5781550">!=</span>&nbsp;<span class="string" id="5781553">&#34;package&#34;</span>&nbsp;<span class="op" id="5781563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781567">return</span>&nbsp;<span class="string" id="5781574">&#34;&#34;</span><span class="op" id="5781576">,</span>&nbsp;<span class="num" id="5781578">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5781581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5781585">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781609">_</span><span class="op" id="5781610">,</span>&nbsp;<span class="ident" id="5781612">data</span>&nbsp;<span class="op" id="5781617">=</span>&nbsp;<span class="ident" id="5781619">parseWord</span><span class="op" id="5781628">(</span><span class="ident" id="5781629">data</span><span class="op" id="5781633">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5781637">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5781693">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781739">for</span>&nbsp;<span class="builtinfunc" id="5781743">len</span><span class="op" id="5781746">(</span><span class="ident" id="5781747">data</span><span class="op" id="5781751">)</span>&nbsp;<span class="op" id="5781753">&gt;</span>&nbsp;<span class="num" id="5781755">0</span>&nbsp;<span class="op" id="5781757">&amp;&amp;</span>&nbsp;<span class="op" id="5781760">(</span><span class="ident" id="5781761">data</span><span class="op" id="5781765">[</span><span class="num" id="5781766">0</span><span class="op" id="5781767">]</span>&nbsp;<span class="op" id="5781769">==</span>&nbsp;<span class="string" id="5781772">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5781776">||</span>&nbsp;<span class="ident" id="5781779">data</span><span class="op" id="5781783">[</span><span class="num" id="5781784">0</span><span class="op" id="5781785">]</span>&nbsp;<span class="op" id="5781787">==</span>&nbsp;<span class="string" id="5781790">&#39;\t&#39;</span>&nbsp;<span class="op" id="5781795">||</span>&nbsp;<span class="ident" id="5781798">data</span><span class="op" id="5781802">[</span><span class="num" id="5781803">0</span><span class="op" id="5781804">]</span>&nbsp;<span class="op" id="5781806">==</span>&nbsp;<span class="string" id="5781809">&#39;\r&#39;</span><span class="op" id="5781813">)</span>&nbsp;<span class="op" id="5781815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781819">data</span>&nbsp;<span class="op" id="5781824">=</span>&nbsp;<span class="ident" id="5781826">data</span><span class="op" id="5781830">[</span><span class="num" id="5781831">1</span><span class="op" id="5781832">:</span><span class="op" id="5781833">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5781836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781840">var</span>&nbsp;<span class="ident" id="5781844">comment</span>&nbsp;<span class="op" id="5781852">[</span><span class="op" id="5781853">]</span><span class="builtintype" id="5781854">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781860">switch</span>&nbsp;<span class="op" id="5781867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781870">case</span>&nbsp;<span class="ident" id="5781875">bytes</span><span class="op" id="5781880">.</span><span class="ident" id="5781881">HasPrefix</span><span class="op" id="5781890">(</span><span class="ident" id="5781891">data</span><span class="op" id="5781895">,</span>&nbsp;<span class="ident" id="5781897">slashSlash</span><span class="op" id="5781907">)</span><span class="op" id="5781908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781912">i</span>&nbsp;<span class="op" id="5781914">:=</span>&nbsp;<span class="ident" id="5781917">bytes</span><span class="op" id="5781922">.</span><span class="ident" id="5781923">Index</span><span class="op" id="5781928">(</span><span class="ident" id="5781929">data</span><span class="op" id="5781933">,</span>&nbsp;<span class="ident" id="5781935">newline</span><span class="op" id="5781942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781946">if</span>&nbsp;<span class="ident" id="5781949">i</span>&nbsp;<span class="op" id="5781951">&lt;</span>&nbsp;<span class="num" id="5781953">0</span>&nbsp;<span class="op" id="5781955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781960">i</span>&nbsp;<span class="op" id="5781962">=</span>&nbsp;<span class="builtinfunc" id="5781964">len</span><span class="op" id="5781967">(</span><span class="ident" id="5781968">data</span><span class="op" id="5781972">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5781976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781980">comment</span>&nbsp;<span class="op" id="5781988">=</span>&nbsp;<span class="ident" id="5781990">data</span><span class="op" id="5781994">[</span><span class="num" id="5781995">2</span><span class="op" id="5781996">:</span><span class="ident" id="5781997">i</span><span class="op" id="5781998">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782001">case</span>&nbsp;<span class="ident" id="5782006">bytes</span><span class="op" id="5782011">.</span><span class="ident" id="5782012">HasPrefix</span><span class="op" id="5782021">(</span><span class="ident" id="5782022">data</span><span class="op" id="5782026">,</span>&nbsp;<span class="ident" id="5782028">slashStar</span><span class="op" id="5782037">)</span><span class="op" id="5782038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782042">data</span>&nbsp;<span class="op" id="5782047">=</span>&nbsp;<span class="ident" id="5782049">data</span><span class="op" id="5782053">[</span><span class="num" id="5782054">2</span><span class="op" id="5782055">:</span><span class="op" id="5782056">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782060">i</span>&nbsp;<span class="op" id="5782062">:=</span>&nbsp;<span class="ident" id="5782065">bytes</span><span class="op" id="5782070">.</span><span class="ident" id="5782071">Index</span><span class="op" id="5782076">(</span><span class="ident" id="5782077">data</span><span class="op" id="5782081">,</span>&nbsp;<span class="ident" id="5782083">starSlash</span><span class="op" id="5782092">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782096">if</span>&nbsp;<span class="ident" id="5782099">i</span>&nbsp;<span class="op" id="5782101">&lt;</span>&nbsp;<span class="num" id="5782103">0</span>&nbsp;<span class="op" id="5782105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5782110">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782134">return</span>&nbsp;<span class="string" id="5782141">&#34;&#34;</span><span class="op" id="5782143">,</span>&nbsp;<span class="num" id="5782145">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782153">comment</span>&nbsp;<span class="op" id="5782161">=</span>&nbsp;<span class="ident" id="5782163">data</span><span class="op" id="5782167">[</span><span class="op" id="5782168">:</span><span class="ident" id="5782169">i</span><span class="op" id="5782170">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782174">if</span>&nbsp;<span class="ident" id="5782177">bytes</span><span class="op" id="5782182">.</span><span class="ident" id="5782183">Contains</span><span class="op" id="5782191">(</span><span class="ident" id="5782192">comment</span><span class="op" id="5782199">,</span>&nbsp;<span class="ident" id="5782201">newline</span><span class="op" id="5782208">)</span>&nbsp;<span class="op" id="5782210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782215">return</span>&nbsp;<span class="string" id="5782222">&#34;&#34;</span><span class="op" id="5782224">,</span>&nbsp;<span class="num" id="5782226">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782236">comment</span>&nbsp;<span class="op" id="5782244">=</span>&nbsp;<span class="ident" id="5782246">bytes</span><span class="op" id="5782251">.</span><span class="ident" id="5782252">TrimSpace</span><span class="op" id="5782261">(</span><span class="ident" id="5782262">comment</span><span class="op" id="5782269">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5782273">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782314">word</span><span class="op" id="5782318">,</span>&nbsp;<span class="ident" id="5782320">arg</span>&nbsp;<span class="op" id="5782324">:=</span>&nbsp;<span class="ident" id="5782327">parseWord</span><span class="op" id="5782336">(</span><span class="ident" id="5782337">comment</span><span class="op" id="5782344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782347">if</span>&nbsp;<span class="builtintype" id="5782350">string</span><span class="op" id="5782356">(</span><span class="ident" id="5782357">word</span><span class="op" id="5782361">)</span>&nbsp;<span class="op" id="5782363">!=</span>&nbsp;<span class="string" id="5782366">&#34;import&#34;</span>&nbsp;<span class="op" id="5782375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782379">return</span>&nbsp;<span class="string" id="5782386">&#34;&#34;</span><span class="op" id="5782388">,</span>&nbsp;<span class="num" id="5782390">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782397">line</span>&nbsp;<span class="op" id="5782402">=</span>&nbsp;<span class="num" id="5782404">1</span>&nbsp;<span class="op" id="5782406">+</span>&nbsp;<span class="ident" id="5782408">bytes</span><span class="op" id="5782413">.</span><span class="ident" id="5782414">Count</span><span class="op" id="5782419">(</span><span class="ident" id="5782420">data</span><span class="op" id="5782424">[</span><span class="op" id="5782425">:</span><span class="builtinfunc" id="5782426">cap</span><span class="op" id="5782429">(</span><span class="ident" id="5782430">data</span><span class="op" id="5782434">)</span><span class="op" id="5782435">-</span><span class="builtinfunc" id="5782436">cap</span><span class="op" id="5782439">(</span><span class="ident" id="5782440">arg</span><span class="op" id="5782443">)</span><span class="op" id="5782444">]</span><span class="op" id="5782445">,</span>&nbsp;<span class="ident" id="5782447">newline</span><span class="op" id="5782454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782457">return</span>&nbsp;<span class="ident" id="5782464">strings</span><span class="op" id="5782471">.</span><span class="ident" id="5782472">TrimSpace</span><span class="op" id="5782481">(</span><span class="builtintype" id="5782482">string</span><span class="op" id="5782488">(</span><span class="ident" id="5782489">arg</span><span class="op" id="5782492">)</span><span class="op" id="5782493">)</span><span class="op" id="5782494">,</span>&nbsp;<span class="ident" id="5782496">line</span><br>
<span class="lineno"></span><span class="op" id="5782501">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="5782504">var</span>&nbsp;<span class="op" id="5782508">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782511">slashSlash</span>&nbsp;<span class="op" id="5782522">=</span>&nbsp;<span class="op" id="5782524">[</span><span class="op" id="5782525">]</span><span class="builtintype" id="5782526">byte</span><span class="op" id="5782530">(</span><span class="string" id="5782531">&#34;//&#34;</span><span class="op" id="5782535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782538">slashStar</span>&nbsp;&nbsp;<span class="op" id="5782549">=</span>&nbsp;<span class="op" id="5782551">[</span><span class="op" id="5782552">]</span><span class="builtintype" id="5782553">byte</span><span class="op" id="5782557">(</span><span class="string" id="5782558">&#34;/*&#34;</span><span class="op" id="5782562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782565">starSlash</span>&nbsp;&nbsp;<span class="op" id="5782576">=</span>&nbsp;<span class="op" id="5782578">[</span><span class="op" id="5782579">]</span><span class="builtintype" id="5782580">byte</span><span class="op" id="5782584">(</span><span class="string" id="5782585">&#34;*/&#34;</span><span class="op" id="5782589">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782592">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5782603">=</span>&nbsp;<span class="op" id="5782605">[</span><span class="op" id="5782606">]</span><span class="builtintype" id="5782607">byte</span><span class="op" id="5782611">(</span><span class="string" id="5782612">&#34;\n&#34;</span><span class="op" id="5782616">)</span><br>
<span class="lineno"></span><span class="op" id="5782618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5782621">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="5782701">func</span>&nbsp;<span class="ident" id="5782706">skipSpaceOrComment</span><span class="op" id="5782724">(</span><span class="ident" id="5782725">data</span>&nbsp;<span class="op" id="5782730">[</span><span class="op" id="5782731">]</span><span class="builtintype" id="5782732">byte</span><span class="op" id="5782736">)</span>&nbsp;<span class="op" id="5782738">[</span><span class="op" id="5782739">]</span><span class="builtintype" id="5782740">byte</span>&nbsp;<span class="op" id="5782745">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782748">for</span>&nbsp;<span class="builtinfunc" id="5782752">len</span><span class="op" id="5782755">(</span><span class="ident" id="5782756">data</span><span class="op" id="5782760">)</span>&nbsp;<span class="op" id="5782762">&gt;</span>&nbsp;<span class="num" id="5782764">0</span>&nbsp;<span class="op" id="5782766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782770">switch</span>&nbsp;<span class="ident" id="5782777">data</span><span class="op" id="5782781">[</span><span class="num" id="5782782">0</span><span class="op" id="5782783">]</span>&nbsp;<span class="op" id="5782785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782789">case</span>&nbsp;<span class="string" id="5782794">&#39;&nbsp;&#39;</span><span class="op" id="5782797">,</span>&nbsp;<span class="string" id="5782799">&#39;\t&#39;</span><span class="op" id="5782803">,</span>&nbsp;<span class="string" id="5782805">&#39;\r&#39;</span><span class="op" id="5782809">,</span>&nbsp;<span class="string" id="5782811">&#39;\n&#39;</span><span class="op" id="5782815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782820">data</span>&nbsp;<span class="op" id="5782825">=</span>&nbsp;<span class="ident" id="5782827">data</span><span class="op" id="5782831">[</span><span class="num" id="5782832">1</span><span class="op" id="5782833">:</span><span class="op" id="5782834">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782839">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782850">case</span>&nbsp;<span class="string" id="5782855">&#39;/&#39;</span><span class="op" id="5782858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782863">if</span>&nbsp;<span class="ident" id="5782866">bytes</span><span class="op" id="5782871">.</span><span class="ident" id="5782872">HasPrefix</span><span class="op" id="5782881">(</span><span class="ident" id="5782882">data</span><span class="op" id="5782886">,</span>&nbsp;<span class="ident" id="5782888">slashSlash</span><span class="op" id="5782898">)</span>&nbsp;<span class="op" id="5782900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782906">i</span>&nbsp;<span class="op" id="5782908">:=</span>&nbsp;<span class="ident" id="5782911">bytes</span><span class="op" id="5782916">.</span><span class="ident" id="5782917">Index</span><span class="op" id="5782922">(</span><span class="ident" id="5782923">data</span><span class="op" id="5782927">,</span>&nbsp;<span class="ident" id="5782929">newline</span><span class="op" id="5782936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782942">if</span>&nbsp;<span class="ident" id="5782945">i</span>&nbsp;<span class="op" id="5782947">&lt;</span>&nbsp;<span class="num" id="5782949">0</span>&nbsp;<span class="op" id="5782951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782958">return</span>&nbsp;<span class="ident" id="5782965">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782979">data</span>&nbsp;<span class="op" id="5782984">=</span>&nbsp;<span class="ident" id="5782986">data</span><span class="op" id="5782990">[</span><span class="ident" id="5782991">i</span><span class="op" id="5782992">+</span><span class="num" id="5782993">1</span><span class="op" id="5782994">:</span><span class="op" id="5782995">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783001">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783018">if</span>&nbsp;<span class="ident" id="5783021">bytes</span><span class="op" id="5783026">.</span><span class="ident" id="5783027">HasPrefix</span><span class="op" id="5783036">(</span><span class="ident" id="5783037">data</span><span class="op" id="5783041">,</span>&nbsp;<span class="ident" id="5783043">slashStar</span><span class="op" id="5783052">)</span>&nbsp;<span class="op" id="5783054">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783060">data</span>&nbsp;<span class="op" id="5783065">=</span>&nbsp;<span class="ident" id="5783067">data</span><span class="op" id="5783071">[</span><span class="num" id="5783072">2</span><span class="op" id="5783073">:</span><span class="op" id="5783074">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783080">i</span>&nbsp;<span class="op" id="5783082">:=</span>&nbsp;<span class="ident" id="5783085">bytes</span><span class="op" id="5783090">.</span><span class="ident" id="5783091">Index</span><span class="op" id="5783096">(</span><span class="ident" id="5783097">data</span><span class="op" id="5783101">,</span>&nbsp;<span class="ident" id="5783103">starSlash</span><span class="op" id="5783112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783118">if</span>&nbsp;<span class="ident" id="5783121">i</span>&nbsp;<span class="op" id="5783123">&lt;</span>&nbsp;<span class="num" id="5783125">0</span>&nbsp;<span class="op" id="5783127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783134">return</span>&nbsp;<span class="ident" id="5783141">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783149">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783155">data</span>&nbsp;<span class="op" id="5783160">=</span>&nbsp;<span class="ident" id="5783162">data</span><span class="op" id="5783166">[</span><span class="ident" id="5783167">i</span><span class="op" id="5783168">+</span><span class="num" id="5783169">2</span><span class="op" id="5783170">:</span><span class="op" id="5783171">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783177">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783197">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783207">return</span>&nbsp;<span class="ident" id="5783214">data</span><br>
<span class="lineno"></span><span class="op" id="5783219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5783222">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="5783280">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="5783350">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="5783406">func</span>&nbsp;<span class="ident" id="5783411">parseWord</span><span class="op" id="5783420">(</span><span class="ident" id="5783421">data</span>&nbsp;<span class="op" id="5783426">[</span><span class="op" id="5783427">]</span><span class="builtintype" id="5783428">byte</span><span class="op" id="5783432">)</span>&nbsp;<span class="op" id="5783434">(</span><span class="ident" id="5783435">word</span><span class="op" id="5783439">,</span>&nbsp;<span class="ident" id="5783441">rest</span>&nbsp;<span class="op" id="5783446">[</span><span class="op" id="5783447">]</span><span class="builtintype" id="5783448">byte</span><span class="op" id="5783452">)</span>&nbsp;<span class="op" id="5783454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783457">data</span>&nbsp;<span class="op" id="5783462">=</span>&nbsp;<span class="ident" id="5783464">skipSpaceOrComment</span><span class="op" id="5783482">(</span><span class="ident" id="5783483">data</span><span class="op" id="5783487">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5783491">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783531">rest</span>&nbsp;<span class="op" id="5783536">=</span>&nbsp;<span class="ident" id="5783538">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783544">for</span>&nbsp;<span class="op" id="5783548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783552">r</span><span class="op" id="5783553">,</span>&nbsp;<span class="ident" id="5783555">size</span>&nbsp;<span class="op" id="5783560">:=</span>&nbsp;<span class="ident" id="5783563">utf8</span><span class="op" id="5783567">.</span><span class="ident" id="5783568">DecodeRune</span><span class="op" id="5783578">(</span><span class="ident" id="5783579">rest</span><span class="op" id="5783583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783587">if</span>&nbsp;<span class="ident" id="5783590">unicode</span><span class="op" id="5783597">.</span><span class="ident" id="5783598">IsLetter</span><span class="op" id="5783606">(</span><span class="ident" id="5783607">r</span><span class="op" id="5783608">)</span>&nbsp;<span class="op" id="5783610">||</span>&nbsp;<span class="string" id="5783613">&#39;0&#39;</span>&nbsp;<span class="op" id="5783617">&lt;=</span>&nbsp;<span class="ident" id="5783620">r</span>&nbsp;<span class="op" id="5783622">&amp;&amp;</span>&nbsp;<span class="ident" id="5783625">r</span>&nbsp;<span class="op" id="5783627">&lt;=</span>&nbsp;<span class="string" id="5783630">&#39;9&#39;</span>&nbsp;<span class="op" id="5783634">||</span>&nbsp;<span class="ident" id="5783637">r</span>&nbsp;<span class="op" id="5783639">==</span>&nbsp;<span class="string" id="5783642">&#39;_&#39;</span>&nbsp;<span class="op" id="5783646">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783651">rest</span>&nbsp;<span class="op" id="5783656">=</span>&nbsp;<span class="ident" id="5783658">rest</span><span class="op" id="5783662">[</span><span class="ident" id="5783663">size</span><span class="op" id="5783667">:</span><span class="op" id="5783668">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783673">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783688">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783695">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783699">word</span>&nbsp;<span class="op" id="5783704">=</span>&nbsp;<span class="ident" id="5783706">data</span><span class="op" id="5783710">[</span><span class="op" id="5783711">:</span><span class="builtinfunc" id="5783712">len</span><span class="op" id="5783715">(</span><span class="ident" id="5783716">data</span><span class="op" id="5783720">)</span><span class="op" id="5783721">-</span><span class="builtinfunc" id="5783722">len</span><span class="op" id="5783725">(</span><span class="ident" id="5783726">rest</span><span class="op" id="5783730">)</span><span class="op" id="5783731">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783734">if</span>&nbsp;<span class="builtinfunc" id="5783737">len</span><span class="op" id="5783740">(</span><span class="ident" id="5783741">word</span><span class="op" id="5783745">)</span>&nbsp;<span class="op" id="5783747">==</span>&nbsp;<span class="num" id="5783750">0</span>&nbsp;<span class="op" id="5783752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783756">return</span>&nbsp;<span class="ident" id="5783763">nil</span><span class="op" id="5783766">,</span>&nbsp;<span class="ident" id="5783768">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783773">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783777">return</span>&nbsp;<span class="ident" id="5783784">word</span><span class="op" id="5783788">,</span>&nbsp;<span class="ident" id="5783790">rest</span><br>
<span class="lineno"></span><span class="op" id="5783795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5783798">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="5783879">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="5783958">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5783980">//</span><br>
<span class="lineno"></span><span class="comment" id="5783983">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5784056">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="5784099">func</span>&nbsp;<span class="op" id="5784104">(</span><span class="ident" id="5784105">ctxt</span>&nbsp;<span class="op" id="5784110">*</span><span class="ident" id="5784111">Context</span><span class="op" id="5784118">)</span>&nbsp;<span class="ident" id="5784120">MatchFile</span><span class="op" id="5784129">(</span><span class="ident" id="5784130">dir</span><span class="op" id="5784133">,</span>&nbsp;<span class="ident" id="5784135">name</span>&nbsp;<span class="builtintype" id="5784140">string</span><span class="op" id="5784146">)</span>&nbsp;<span class="op" id="5784148">(</span><span class="ident" id="5784149">match</span>&nbsp;<span class="builtintype" id="5784155">bool</span><span class="op" id="5784159">,</span>&nbsp;<span class="ident" id="5784161">err</span>&nbsp;<span class="builtintype" id="5784165">error</span><span class="op" id="5784170">)</span>&nbsp;<span class="op" id="5784172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5784175">match</span><span class="op" id="5784180">,</span>&nbsp;<span class="ident" id="5784182">_</span><span class="op" id="5784183">,</span>&nbsp;<span class="ident" id="5784185">_</span><span class="op" id="5784186">,</span>&nbsp;<span class="ident" id="5784188">err</span>&nbsp;<span class="op" id="5784192">=</span>&nbsp;<span class="ident" id="5784194">ctxt</span><span class="op" id="5784198">.</span><span class="ident" id="5784199">matchFile</span><span class="op" id="5784208">(</span><span class="ident" id="5784209">dir</span><span class="op" id="5784212">,</span>&nbsp;<span class="ident" id="5784214">name</span><span class="op" id="5784218">,</span>&nbsp;<span class="builtintype" id="5784220">false</span><span class="op" id="5784225">,</span>&nbsp;<span class="ident" id="5784227">nil</span><span class="op" id="5784230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784233">return</span><br>
<span class="lineno"></span><span class="op" id="5784240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="5784243">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="5784327">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="5784383">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5784426">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="5784501">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="5784577">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="5784624">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="5784694">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="5784729">func</span>&nbsp;<span class="op" id="5784734">(</span><span class="ident" id="5784735">ctxt</span>&nbsp;<span class="op" id="5784740">*</span><span class="ident" id="5784741">Context</span><span class="op" id="5784748">)</span>&nbsp;<span class="ident" id="5784750">matchFile</span><span class="op" id="5784759">(</span><span class="ident" id="5784760">dir</span><span class="op" id="5784763">,</span>&nbsp;<span class="ident" id="5784765">name</span>&nbsp;<span class="builtintype" id="5784770">string</span><span class="op" id="5784776">,</span>&nbsp;<span class="ident" id="5784778">returnImports</span>&nbsp;<span class="builtintype" id="5784792">bool</span><span class="op" id="5784796">,</span>&nbsp;<span class="ident" id="5784798">allTags</span>&nbsp;<span class="keyword" id="5784806">map</span><span class="op" id="5784809">[</span><span class="builtintype" id="5784810">string</span><span class="op" id="5784816">]</span><span class="builtintype" id="5784817">bool</span><span class="op" id="5784821">)</span>&nbsp;<span class="op" id="5784823">(</span><span class="ident" id="5784824">match</span>&nbsp;<span class="builtintype" id="5784830">bool</span><span class="op" id="5784834">,</span>&nbsp;<span class="ident" id="5784836">data</span>&nbsp;<span class="op" id="5784841">[</span><span class="op" id="5784842">]</span><span class="builtintype" id="5784843">byte</span><span class="op" id="5784847">,</span>&nbsp;<span class="ident" id="5784849">filename</span>&nbsp;<span class="builtintype" id="5784858">string</span><span class="op" id="5784864">,</span>&nbsp;<span class="ident" id="5784866">err</span>&nbsp;<span class="builtintype" id="5784870">error</span><span class="op" id="5784875">)</span>&nbsp;<span class="op" id="5784877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784880">if</span>&nbsp;<span class="ident" id="5784883">strings</span><span class="op" id="5784890">.</span><span class="ident" id="5784891">HasPrefix</span><span class="op" id="5784900">(</span><span class="ident" id="5784901">name</span><span class="op" id="5784905">,</span>&nbsp;<span class="string" id="5784907">&#34;_&#34;</span><span class="op" id="5784910">)</span>&nbsp;<span class="op" id="5784912">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5784917">strings</span><span class="op" id="5784924">.</span><span class="ident" id="5784925">HasPrefix</span><span class="op" id="5784934">(</span><span class="ident" id="5784935">name</span><span class="op" id="5784939">,</span>&nbsp;<span class="string" id="5784941">&#34;.&#34;</span><span class="op" id="5784944">)</span>&nbsp;<span class="op" id="5784946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784950">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5784958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5784962">i</span>&nbsp;<span class="op" id="5784964">:=</span>&nbsp;<span class="ident" id="5784967">strings</span><span class="op" id="5784974">.</span><span class="ident" id="5784975">LastIndex</span><span class="op" id="5784984">(</span><span class="ident" id="5784985">name</span><span class="op" id="5784989">,</span>&nbsp;<span class="string" id="5784991">&#34;.&#34;</span><span class="op" id="5784994">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784997">if</span>&nbsp;<span class="ident" id="5785000">i</span>&nbsp;<span class="op" id="5785002">&lt;</span>&nbsp;<span class="num" id="5785004">0</span>&nbsp;<span class="op" id="5785006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785010">i</span>&nbsp;<span class="op" id="5785012">=</span>&nbsp;<span class="builtinfunc" id="5785014">len</span><span class="op" id="5785017">(</span><span class="ident" id="5785018">name</span><span class="op" id="5785022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785028">ext</span>&nbsp;<span class="op" id="5785032">:=</span>&nbsp;<span class="ident" id="5785035">name</span><span class="op" id="5785039">[</span><span class="ident" id="5785040">i</span><span class="op" id="5785041">:</span><span class="op" id="5785042">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785046">if</span>&nbsp;<span class="op" id="5785049">!</span><span class="ident" id="5785050">ctxt</span><span class="op" id="5785054">.</span><span class="ident" id="5785055">goodOSArchFile</span><span class="op" id="5785069">(</span><span class="ident" id="5785070">name</span><span class="op" id="5785074">,</span>&nbsp;<span class="ident" id="5785076">allTags</span><span class="op" id="5785083">)</span>&nbsp;<span class="op" id="5785085">&amp;&amp;</span>&nbsp;<span class="op" id="5785088">!</span><span class="ident" id="5785089">ctxt</span><span class="op" id="5785093">.</span><span class="ident" id="5785094">UseAllFiles</span>&nbsp;<span class="op" id="5785106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785110">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785122">switch</span>&nbsp;<span class="ident" id="5785129">ext</span>&nbsp;<span class="op" id="5785133">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785136">case</span>&nbsp;<span class="string" id="5785141">&#34;.go&#34;</span><span class="op" id="5785146">,</span>&nbsp;<span class="string" id="5785148">&#34;.c&#34;</span><span class="op" id="5785152">,</span>&nbsp;<span class="string" id="5785154">&#34;.cc&#34;</span><span class="op" id="5785159">,</span>&nbsp;<span class="string" id="5785161">&#34;.cxx&#34;</span><span class="op" id="5785167">,</span>&nbsp;<span class="string" id="5785169">&#34;.cpp&#34;</span><span class="op" id="5785175">,</span>&nbsp;<span class="string" id="5785177">&#34;.m&#34;</span><span class="op" id="5785181">,</span>&nbsp;<span class="string" id="5785183">&#34;.s&#34;</span><span class="op" id="5785187">,</span>&nbsp;<span class="string" id="5785189">&#34;.h&#34;</span><span class="op" id="5785193">,</span>&nbsp;<span class="string" id="5785195">&#34;.hh&#34;</span><span class="op" id="5785200">,</span>&nbsp;<span class="string" id="5785202">&#34;.hpp&#34;</span><span class="op" id="5785208">,</span>&nbsp;<span class="string" id="5785210">&#34;.hxx&#34;</span><span class="op" id="5785216">,</span>&nbsp;<span class="string" id="5785218">&#34;.S&#34;</span><span class="op" id="5785222">,</span>&nbsp;<span class="string" id="5785224">&#34;.swig&#34;</span><span class="op" id="5785231">,</span>&nbsp;<span class="string" id="5785233">&#34;.swigcxx&#34;</span><span class="op" id="5785243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5785247">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785288">case</span>&nbsp;<span class="string" id="5785293">&#34;.syso&#34;</span><span class="op" id="5785300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5785304">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785328">match</span>&nbsp;<span class="op" id="5785334">=</span>&nbsp;<span class="builtintype" id="5785336">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785343">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785351">default</span><span class="op" id="5785358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5785362">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785372">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785380">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785384">filename</span>&nbsp;<span class="op" id="5785393">=</span>&nbsp;<span class="ident" id="5785395">ctxt</span><span class="op" id="5785399">.</span><span class="ident" id="5785400">joinPath</span><span class="op" id="5785408">(</span><span class="ident" id="5785409">dir</span><span class="op" id="5785412">,</span>&nbsp;<span class="ident" id="5785414">name</span><span class="op" id="5785418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785421">f</span><span class="op" id="5785422">,</span>&nbsp;<span class="ident" id="5785424">err</span>&nbsp;<span class="op" id="5785428">:=</span>&nbsp;<span class="ident" id="5785431">ctxt</span><span class="op" id="5785435">.</span><span class="ident" id="5785436">openFile</span><span class="op" id="5785444">(</span><span class="ident" id="5785445">filename</span><span class="op" id="5785453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785456">if</span>&nbsp;<span class="ident" id="5785459">err</span>&nbsp;<span class="op" id="5785463">!=</span>&nbsp;<span class="ident" id="5785466">nil</span>&nbsp;<span class="op" id="5785470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785474">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785486">if</span>&nbsp;<span class="ident" id="5785489">strings</span><span class="op" id="5785496">.</span><span class="ident" id="5785497">HasSuffix</span><span class="op" id="5785506">(</span><span class="ident" id="5785507">filename</span><span class="op" id="5785515">,</span>&nbsp;<span class="string" id="5785517">&#34;.go&#34;</span><span class="op" id="5785522">)</span>&nbsp;<span class="op" id="5785524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785528">data</span><span class="op" id="5785532">,</span>&nbsp;<span class="ident" id="5785534">err</span>&nbsp;<span class="op" id="5785538">=</span>&nbsp;<span class="ident" id="5785540">readImports</span><span class="op" id="5785551">(</span><span class="ident" id="5785552">f</span><span class="op" id="5785553">,</span>&nbsp;<span class="builtintype" id="5785555">false</span><span class="op" id="5785560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785563">}</span>&nbsp;<span class="keyword" id="5785565">else</span>&nbsp;<span class="op" id="5785570">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785574">data</span><span class="op" id="5785578">,</span>&nbsp;<span class="ident" id="5785580">err</span>&nbsp;<span class="op" id="5785584">=</span>&nbsp;<span class="ident" id="5785586">readComments</span><span class="op" id="5785598">(</span><span class="ident" id="5785599">f</span><span class="op" id="5785600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785606">f</span><span class="op" id="5785607">.</span><span class="ident" id="5785608">Close</span><span class="op" id="5785613">(</span><span class="op" id="5785614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785617">if</span>&nbsp;<span class="ident" id="5785620">err</span>&nbsp;<span class="op" id="5785624">!=</span>&nbsp;<span class="ident" id="5785627">nil</span>&nbsp;<span class="op" id="5785631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785635">err</span>&nbsp;<span class="op" id="5785639">=</span>&nbsp;<span class="ident" id="5785641">fmt</span><span class="op" id="5785644">.</span><span class="ident" id="5785645">Errorf</span><span class="op" id="5785651">(</span><span class="string" id="5785652">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="5785665">,</span>&nbsp;<span class="ident" id="5785667">filename</span><span class="op" id="5785675">,</span>&nbsp;<span class="ident" id="5785677">err</span><span class="op" id="5785680">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785684">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5785696">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785755">if</span>&nbsp;<span class="op" id="5785758">!</span><span class="ident" id="5785759">ctxt</span><span class="op" id="5785763">.</span><span class="ident" id="5785764">shouldBuild</span><span class="op" id="5785775">(</span><span class="ident" id="5785776">data</span><span class="op" id="5785780">,</span>&nbsp;<span class="ident" id="5785782">allTags</span><span class="op" id="5785789">)</span>&nbsp;<span class="op" id="5785791">&amp;&amp;</span>&nbsp;<span class="op" id="5785794">!</span><span class="ident" id="5785795">ctxt</span><span class="op" id="5785799">.</span><span class="ident" id="5785800">UseAllFiles</span>&nbsp;<span class="op" id="5785812">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785816">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785828">match</span>&nbsp;<span class="op" id="5785834">=</span>&nbsp;<span class="builtintype" id="5785836">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785842">return</span><br>
<span class="lineno">975</span><span class="op" id="5785849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5785852">func</span>&nbsp;<span class="ident" id="5785857">cleanImports</span><span class="op" id="5785869">(</span><span class="ident" id="5785870">m</span>&nbsp;<span class="keyword" id="5785872">map</span><span class="op" id="5785875">[</span><span class="builtintype" id="5785876">string</span><span class="op" id="5785882">]</span><span class="op" id="5785883">[</span><span class="op" id="5785884">]</span><span class="ident" id="5785885">token</span><span class="op" id="5785890">.</span><span class="ident" id="5785891">Position</span><span class="op" id="5785899">)</span>&nbsp;<span class="op" id="5785901">(</span><span class="op" id="5785902">[</span><span class="op" id="5785903">]</span><span class="builtintype" id="5785904">string</span><span class="op" id="5785910">,</span>&nbsp;<span class="keyword" id="5785912">map</span><span class="op" id="5785915">[</span><span class="builtintype" id="5785916">string</span><span class="op" id="5785922">]</span><span class="op" id="5785923">[</span><span class="op" id="5785924">]</span><span class="ident" id="5785925">token</span><span class="op" id="5785930">.</span><span class="ident" id="5785931">Position</span><span class="op" id="5785939">)</span>&nbsp;<span class="op" id="5785941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785944">all</span>&nbsp;<span class="op" id="5785948">:=</span>&nbsp;<span class="builtinfunc" id="5785951">make</span><span class="op" id="5785955">(</span><span class="op" id="5785956">[</span><span class="op" id="5785957">]</span><span class="builtintype" id="5785958">string</span><span class="op" id="5785964">,</span>&nbsp;<span class="num" id="5785966">0</span><span class="op" id="5785967">,</span>&nbsp;<span class="builtinfunc" id="5785969">len</span><span class="op" id="5785972">(</span><span class="ident" id="5785973">m</span><span class="op" id="5785974">)</span><span class="op" id="5785975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785978">for</span>&nbsp;<span class="ident" id="5785982">path</span>&nbsp;<span class="op" id="5785987">:=</span>&nbsp;<span class="keyword" id="5785990">range</span>&nbsp;<span class="ident" id="5785996">m</span>&nbsp;<span class="op" id="5785998">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786002">all</span>&nbsp;<span class="op" id="5786006">=</span>&nbsp;<span class="builtinfunc" id="5786008">append</span><span class="op" id="5786014">(</span><span class="ident" id="5786015">all</span><span class="op" id="5786018">,</span>&nbsp;<span class="ident" id="5786020">path</span><span class="op" id="5786024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5786027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786030">sort</span><span class="op" id="5786034">.</span><span class="ident" id="5786035">Strings</span><span class="op" id="5786042">(</span><span class="ident" id="5786043">all</span><span class="op" id="5786046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786049">return</span>&nbsp;<span class="ident" id="5786056">all</span><span class="op" id="5786059">,</span>&nbsp;<span class="ident" id="5786061">m</span><br>
<span class="lineno"></span><span class="op" id="5786063">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="5786066">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="5786109">func</span>&nbsp;<span class="ident" id="5786114">Import</span><span class="op" id="5786120">(</span><span class="ident" id="5786121">path</span><span class="op" id="5786125">,</span>&nbsp;<span class="ident" id="5786127">srcDir</span>&nbsp;<span class="builtintype" id="5786134">string</span><span class="op" id="5786140">,</span>&nbsp;<span class="ident" id="5786142">mode</span>&nbsp;<span class="ident" id="5786147">ImportMode</span><span class="op" id="5786157">)</span>&nbsp;<span class="op" id="5786159">(</span><span class="op" id="5786160">*</span><span class="ident" id="5786161">Package</span><span class="op" id="5786168">,</span>&nbsp;<span class="builtintype" id="5786170">error</span><span class="op" id="5786175">)</span>&nbsp;<span class="op" id="5786177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786180">return</span>&nbsp;<span class="ident" id="5786187">Default</span><span class="op" id="5786194">.</span><span class="ident" id="5786195">Import</span><span class="op" id="5786201">(</span><span class="ident" id="5786202">path</span><span class="op" id="5786206">,</span>&nbsp;<span class="ident" id="5786208">srcDir</span><span class="op" id="5786214">,</span>&nbsp;<span class="ident" id="5786216">mode</span><span class="op" id="5786220">)</span><br>
<span class="lineno"></span><span class="op" id="5786222">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="5786225">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="5786274">func</span>&nbsp;<span class="ident" id="5786279">ImportDir</span><span class="op" id="5786288">(</span><span class="ident" id="5786289">dir</span>&nbsp;<span class="builtintype" id="5786293">string</span><span class="op" id="5786299">,</span>&nbsp;<span class="ident" id="5786301">mode</span>&nbsp;<span class="ident" id="5786306">ImportMode</span><span class="op" id="5786316">)</span>&nbsp;<span class="op" id="5786318">(</span><span class="op" id="5786319">*</span><span class="ident" id="5786320">Package</span><span class="op" id="5786327">,</span>&nbsp;<span class="builtintype" id="5786329">error</span><span class="op" id="5786334">)</span>&nbsp;<span class="op" id="5786336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786339">return</span>&nbsp;<span class="ident" id="5786346">Default</span><span class="op" id="5786353">.</span><span class="ident" id="5786354">ImportDir</span><span class="op" id="5786363">(</span><span class="ident" id="5786364">dir</span><span class="op" id="5786367">,</span>&nbsp;<span class="ident" id="5786369">mode</span><span class="op" id="5786373">)</span><br>
<span class="lineno"></span><span class="op" id="5786375">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="5786378">var</span>&nbsp;<span class="ident" id="5786382">slashslash</span>&nbsp;<span class="op" id="5786393">=</span>&nbsp;<span class="op" id="5786395">[</span><span class="op" id="5786396">]</span><span class="builtintype" id="5786397">byte</span><span class="op" id="5786401">(</span><span class="string" id="5786402">&#34;//&#34;</span><span class="op" id="5786406">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5786409">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="5786469">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="5786530">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="5786589">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="5786646">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="5786713">//</span><br>
<span class="lineno"></span><span class="comment" id="5786716">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="5786779">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="5786815">//</span><br>
<span class="lineno"></span><span class="comment" id="5786818">//&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="5786845">//</span><br>
<span class="lineno"></span><span class="comment" id="5786848">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="5786907">//</span><br>
<span class="lineno"></span><span class="keyword" id="5786910">func</span>&nbsp;<span class="op" id="5786915">(</span><span class="ident" id="5786916">ctxt</span>&nbsp;<span class="op" id="5786921">*</span><span class="ident" id="5786922">Context</span><span class="op" id="5786929">)</span>&nbsp;<span class="ident" id="5786931">shouldBuild</span><span class="op" id="5786942">(</span><span class="ident" id="5786943">content</span>&nbsp;<span class="op" id="5786951">[</span><span class="op" id="5786952">]</span><span class="builtintype" id="5786953">byte</span><span class="op" id="5786957">,</span>&nbsp;<span class="ident" id="5786959">allTags</span>&nbsp;<span class="keyword" id="5786967">map</span><span class="op" id="5786970">[</span><span class="builtintype" id="5786971">string</span><span class="op" id="5786977">]</span><span class="builtintype" id="5786978">bool</span><span class="op" id="5786982">)</span>&nbsp;<span class="builtintype" id="5786984">bool</span>&nbsp;<span class="op" id="5786989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786992">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787057">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787101">end</span>&nbsp;<span class="op" id="5787105">:=</span>&nbsp;<span class="num" id="5787108">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787111">p</span>&nbsp;<span class="op" id="5787113">:=</span>&nbsp;<span class="ident" id="5787116">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787125">for</span>&nbsp;<span class="builtinfunc" id="5787129">len</span><span class="op" id="5787132">(</span><span class="ident" id="5787133">p</span><span class="op" id="5787134">)</span>&nbsp;<span class="op" id="5787136">&gt;</span>&nbsp;<span class="num" id="5787138">0</span>&nbsp;<span class="op" id="5787140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787144">line</span>&nbsp;<span class="op" id="5787149">:=</span>&nbsp;<span class="ident" id="5787152">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787156">if</span>&nbsp;<span class="ident" id="5787159">i</span>&nbsp;<span class="op" id="5787161">:=</span>&nbsp;<span class="ident" id="5787164">bytes</span><span class="op" id="5787169">.</span><span class="ident" id="5787170">IndexByte</span><span class="op" id="5787179">(</span><span class="ident" id="5787180">line</span><span class="op" id="5787184">,</span>&nbsp;<span class="string" id="5787186">&#39;\n&#39;</span><span class="op" id="5787190">)</span><span class="op" id="5787191">;</span>&nbsp;<span class="ident" id="5787193">i</span>&nbsp;<span class="op" id="5787195">&gt;=</span>&nbsp;<span class="num" id="5787198">0</span>&nbsp;<span class="op" id="5787200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787205">line</span><span class="op" id="5787209">,</span>&nbsp;<span class="ident" id="5787211">p</span>&nbsp;<span class="op" id="5787213">=</span>&nbsp;<span class="ident" id="5787215">line</span><span class="op" id="5787219">[</span><span class="op" id="5787220">:</span><span class="ident" id="5787221">i</span><span class="op" id="5787222">]</span><span class="op" id="5787223">,</span>&nbsp;<span class="ident" id="5787225">p</span><span class="op" id="5787226">[</span><span class="ident" id="5787227">i</span><span class="op" id="5787228">+</span><span class="num" id="5787229">1</span><span class="op" id="5787230">:</span><span class="op" id="5787231">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787235">}</span>&nbsp;<span class="keyword" id="5787237">else</span>&nbsp;<span class="op" id="5787242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787247">p</span>&nbsp;<span class="op" id="5787249">=</span>&nbsp;<span class="ident" id="5787251">p</span><span class="op" id="5787252">[</span><span class="builtinfunc" id="5787253">len</span><span class="op" id="5787256">(</span><span class="ident" id="5787257">p</span><span class="op" id="5787258">)</span><span class="op" id="5787259">:</span><span class="op" id="5787260">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787268">line</span>&nbsp;<span class="op" id="5787273">=</span>&nbsp;<span class="ident" id="5787275">bytes</span><span class="op" id="5787280">.</span><span class="ident" id="5787281">TrimSpace</span><span class="op" id="5787290">(</span><span class="ident" id="5787291">line</span><span class="op" id="5787295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787299">if</span>&nbsp;<span class="builtinfunc" id="5787302">len</span><span class="op" id="5787305">(</span><span class="ident" id="5787306">line</span><span class="op" id="5787310">)</span>&nbsp;<span class="op" id="5787312">==</span>&nbsp;<span class="num" id="5787315">0</span>&nbsp;<span class="op" id="5787317">{</span>&nbsp;<span class="comment" id="5787319">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787336">end</span>&nbsp;<span class="op" id="5787340">=</span>&nbsp;<span class="builtinfunc" id="5787342">len</span><span class="op" id="5787345">(</span><span class="ident" id="5787346">content</span><span class="op" id="5787353">)</span>&nbsp;<span class="op" id="5787355">-</span>&nbsp;<span class="builtinfunc" id="5787357">len</span><span class="op" id="5787360">(</span><span class="ident" id="5787361">p</span><span class="op" id="5787362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787367">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787382">if</span>&nbsp;<span class="op" id="5787385">!</span><span class="ident" id="5787386">bytes</span><span class="op" id="5787391">.</span><span class="ident" id="5787392">HasPrefix</span><span class="op" id="5787401">(</span><span class="ident" id="5787402">line</span><span class="op" id="5787406">,</span>&nbsp;<span class="ident" id="5787408">slashslash</span><span class="op" id="5787418">)</span>&nbsp;<span class="op" id="5787420">{</span>&nbsp;<span class="comment" id="5787422">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787445">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787459">content</span>&nbsp;<span class="op" id="5787467">=</span>&nbsp;<span class="ident" id="5787469">content</span><span class="op" id="5787476">[</span><span class="op" id="5787477">:</span><span class="ident" id="5787478">end</span><span class="op" id="5787481">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787485">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787528">p</span>&nbsp;<span class="op" id="5787530">=</span>&nbsp;<span class="ident" id="5787532">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787541">allok</span>&nbsp;<span class="op" id="5787547">:=</span>&nbsp;<span class="builtintype" id="5787550">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787556">for</span>&nbsp;<span class="builtinfunc" id="5787560">len</span><span class="op" id="5787563">(</span><span class="ident" id="5787564">p</span><span class="op" id="5787565">)</span>&nbsp;<span class="op" id="5787567">&gt;</span>&nbsp;<span class="num" id="5787569">0</span>&nbsp;<span class="op" id="5787571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787575">line</span>&nbsp;<span class="op" id="5787580">:=</span>&nbsp;<span class="ident" id="5787583">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787587">if</span>&nbsp;<span class="ident" id="5787590">i</span>&nbsp;<span class="op" id="5787592">:=</span>&nbsp;<span class="ident" id="5787595">bytes</span><span class="op" id="5787600">.</span><span class="ident" id="5787601">IndexByte</span><span class="op" id="5787610">(</span><span class="ident" id="5787611">line</span><span class="op" id="5787615">,</span>&nbsp;<span class="string" id="5787617">&#39;\n&#39;</span><span class="op" id="5787621">)</span><span class="op" id="5787622">;</span>&nbsp;<span class="ident" id="5787624">i</span>&nbsp;<span class="op" id="5787626">&gt;=</span>&nbsp;<span class="num" id="5787629">0</span>&nbsp;<span class="op" id="5787631">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787636">line</span><span class="op" id="5787640">,</span>&nbsp;<span class="ident" id="5787642">p</span>&nbsp;<span class="op" id="5787644">=</span>&nbsp;<span class="ident" id="5787646">line</span><span class="op" id="5787650">[</span><span class="op" id="5787651">:</span><span class="ident" id="5787652">i</span><span class="op" id="5787653">]</span><span class="op" id="5787654">,</span>&nbsp;<span class="ident" id="5787656">p</span><span class="op" id="5787657">[</span><span class="ident" id="5787658">i</span><span class="op" id="5787659">+</span><span class="num" id="5787660">1</span><span class="op" id="5787661">:</span><span class="op" id="5787662">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787666">}</span>&nbsp;<span class="keyword" id="5787668">else</span>&nbsp;<span class="op" id="5787673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787678">p</span>&nbsp;<span class="op" id="5787680">=</span>&nbsp;<span class="ident" id="5787682">p</span><span class="op" id="5787683">[</span><span class="builtinfunc" id="5787684">len</span><span class="op" id="5787687">(</span><span class="ident" id="5787688">p</span><span class="op" id="5787689">)</span><span class="op" id="5787690">:</span><span class="op" id="5787691">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787699">line</span>&nbsp;<span class="op" id="5787704">=</span>&nbsp;<span class="ident" id="5787706">bytes</span><span class="op" id="5787711">.</span><span class="ident" id="5787712">TrimSpace</span><span class="op" id="5787721">(</span><span class="ident" id="5787722">line</span><span class="op" id="5787726">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787730">if</span>&nbsp;<span class="ident" id="5787733">bytes</span><span class="op" id="5787738">.</span><span class="ident" id="5787739">HasPrefix</span><span class="op" id="5787748">(</span><span class="ident" id="5787749">line</span><span class="op" id="5787753">,</span>&nbsp;<span class="ident" id="5787755">slashslash</span><span class="op" id="5787765">)</span>&nbsp;<span class="op" id="5787767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787772">line</span>&nbsp;<span class="op" id="5787777">=</span>&nbsp;<span class="ident" id="5787779">bytes</span><span class="op" id="5787784">.</span><span class="ident" id="5787785">TrimSpace</span><span class="op" id="5787794">(</span><span class="ident" id="5787795">line</span><span class="op" id="5787799">[</span><span class="builtinfunc" id="5787800">len</span><span class="op" id="5787803">(</span><span class="ident" id="5787804">slashslash</span><span class="op" id="5787814">)</span><span class="op" id="5787815">:</span><span class="op" id="5787816">]</span><span class="op" id="5787817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787822">if</span>&nbsp;<span class="builtinfunc" id="5787825">len</span><span class="op" id="5787828">(</span><span class="ident" id="5787829">line</span><span class="op" id="5787833">)</span>&nbsp;<span class="op" id="5787835">&gt;</span>&nbsp;<span class="num" id="5787837">0</span>&nbsp;<span class="op" id="5787839">&amp;&amp;</span>&nbsp;<span class="ident" id="5787842">line</span><span class="op" id="5787846">[</span><span class="num" id="5787847">0</span><span class="op" id="5787848">]</span>&nbsp;<span class="op" id="5787850">==</span>&nbsp;<span class="string" id="5787853">&#39;+&#39;</span>&nbsp;<span class="op" id="5787857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787863">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787898">f</span>&nbsp;<span class="op" id="5787900">:=</span>&nbsp;<span class="ident" id="5787903">strings</span><span class="op" id="5787910">.</span><span class="ident" id="5787911">Fields</span><span class="op" id="5787917">(</span><span class="builtintype" id="5787918">string</span><span class="op" id="5787924">(</span><span class="ident" id="5787925">line</span><span class="op" id="5787929">)</span><span class="op" id="5787930">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787936">if</span>&nbsp;<span class="ident" id="5787939">f</span><span class="op" id="5787940">[</span><span class="num" id="5787941">0</span><span class="op" id="5787942">]</span>&nbsp;<span class="op" id="5787944">==</span>&nbsp;<span class="string" id="5787947">&#34;+build&#34;</span>&nbsp;<span class="op" id="5787956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787963">ok</span>&nbsp;<span class="op" id="5787966">:=</span>&nbsp;<span class="builtintype" id="5787969">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787980">for</span>&nbsp;<span class="ident" id="5787984">_</span><span class="op" id="5787985">,</span>&nbsp;<span class="ident" id="5787987">tok</span>&nbsp;<span class="op" id="5787991">:=</span>&nbsp;<span class="keyword" id="5787994">range</span>&nbsp;<span class="ident" id="5788000">f</span><span class="op" id="5788001">[</span><span class="num" id="5788002">1</span><span class="op" id="5788003">:</span><span class="op" id="5788004">]</span>&nbsp;<span class="op" id="5788006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788014">if</span>&nbsp;<span class="ident" id="5788017">ctxt</span><span class="op" id="5788021">.</span><span class="ident" id="5788022">match</span><span class="op" id="5788027">(</span><span class="ident" id="5788028">tok</span><span class="op" id="5788031">,</span>&nbsp;<span class="ident" id="5788033">allTags</span><span class="op" id="5788040">)</span>&nbsp;<span class="op" id="5788042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788051">ok</span>&nbsp;<span class="op" id="5788054">=</span>&nbsp;<span class="builtintype" id="5788056">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788081">if</span>&nbsp;<span class="op" id="5788084">!</span><span class="ident" id="5788085">ok</span>&nbsp;<span class="op" id="5788088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788096">allok</span>&nbsp;<span class="op" id="5788102">=</span>&nbsp;<span class="builtintype" id="5788104">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788115">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788137">return</span>&nbsp;<span class="ident" id="5788144">allok</span><br>
<span class="lineno"></span><span class="op" id="5788150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5788153">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5788233">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="5788317">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="5788363">//</span><br>
<span class="lineno"></span><span class="comment" id="5788366">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="5788409">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="5788462">func</span>&nbsp;<span class="op" id="5788467">(</span><span class="ident" id="5788468">ctxt</span>&nbsp;<span class="op" id="5788473">*</span><span class="ident" id="5788474">Context</span><span class="op" id="5788481">)</span>&nbsp;<span class="ident" id="5788483">saveCgo</span><span class="op" id="5788490">(</span><span class="ident" id="5788491">filename</span>&nbsp;<span class="builtintype" id="5788500">string</span><span class="op" id="5788506">,</span>&nbsp;<span class="ident" id="5788508">di</span>&nbsp;<span class="op" id="5788511">*</span><span class="ident" id="5788512">Package</span><span class="op" id="5788519">,</span>&nbsp;<span class="ident" id="5788521">cg</span>&nbsp;<span class="op" id="5788524">*</span><span class="ident" id="5788525">ast</span><span class="op" id="5788528">.</span><span class="ident" id="5788529">CommentGroup</span><span class="op" id="5788541">)</span>&nbsp;<span class="builtintype" id="5788543">error</span>&nbsp;<span class="op" id="5788549">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788552">text</span>&nbsp;<span class="op" id="5788557">:=</span>&nbsp;<span class="ident" id="5788560">cg</span><span class="op" id="5788562">.</span><span class="ident" id="5788563">Text</span><span class="op" id="5788567">(</span><span class="op" id="5788568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788571">for</span>&nbsp;<span class="ident" id="5788575">_</span><span class="op" id="5788576">,</span>&nbsp;<span class="ident" id="5788578">line</span>&nbsp;<span class="op" id="5788583">:=</span>&nbsp;<span class="keyword" id="5788586">range</span>&nbsp;<span class="ident" id="5788592">strings</span><span class="op" id="5788599">.</span><span class="ident" id="5788600">Split</span><span class="op" id="5788605">(</span><span class="ident" id="5788606">text</span><span class="op" id="5788610">,</span>&nbsp;<span class="string" id="5788612">&#34;\n&#34;</span><span class="op" id="5788616">)</span>&nbsp;<span class="op" id="5788618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788622">orig</span>&nbsp;<span class="op" id="5788627">:=</span>&nbsp;<span class="ident" id="5788630">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5788638">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5788651">//&nbsp;&nbsp;&nbsp;&nbsp#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5788693">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788698">line</span>&nbsp;<span class="op" id="5788703">=</span>&nbsp;<span class="ident" id="5788705">strings</span><span class="op" id="5788712">.</span><span class="ident" id="5788713">TrimSpace</span><span class="op" id="5788722">(</span><span class="ident" id="5788723">line</span><span class="op" id="5788727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788731">if</span>&nbsp;<span class="builtinfunc" id="5788734">len</span><span class="op" id="5788737">(</span><span class="ident" id="5788738">line</span><span class="op" id="5788742">)</span>&nbsp;<span class="op" id="5788744">&lt;</span>&nbsp;<span class="num" id="5788746">5</span>&nbsp;<span class="op" id="5788748">||</span>&nbsp;<span class="ident" id="5788751">line</span><span class="op" id="5788755">[</span><span class="op" id="5788756">:</span><span class="num" id="5788757">4</span><span class="op" id="5788758">]</span>&nbsp;<span class="op" id="5788760">!=</span>&nbsp;<span class="string" id="5788763">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="5788770">||</span>&nbsp;<span class="op" id="5788773">(</span><span class="ident" id="5788774">line</span><span class="op" id="5788778">[</span><span class="num" id="5788779">4</span><span class="op" id="5788780">]</span>&nbsp;<span class="op" id="5788782">!=</span>&nbsp;<span class="string" id="5788785">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5788789">&amp;&amp;</span>&nbsp;<span class="ident" id="5788792">line</span><span class="op" id="5788796">[</span><span class="num" id="5788797">4</span><span class="op" id="5788798">]</span>&nbsp;<span class="op" id="5788800">!=</span>&nbsp;<span class="string" id="5788803">&#39;\t&#39;</span><span class="op" id="5788807">)</span>&nbsp;<span class="op" id="5788809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788814">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5788830">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788851">line</span>&nbsp;<span class="op" id="5788856">=</span>&nbsp;<span class="ident" id="5788858">strings</span><span class="op" id="5788865">.</span><span class="ident" id="5788866">TrimSpace</span><span class="op" id="5788875">(</span><span class="ident" id="5788876">line</span><span class="op" id="5788880">[</span><span class="num" id="5788881">4</span><span class="op" id="5788882">:</span><span class="op" id="5788883">]</span><span class="op" id="5788884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788888">i</span>&nbsp;<span class="op" id="5788890">:=</span>&nbsp;<span class="ident" id="5788893">strings</span><span class="op" id="5788900">.</span><span class="ident" id="5788901">Index</span><span class="op" id="5788906">(</span><span class="ident" id="5788907">line</span><span class="op" id="5788911">,</span>&nbsp;<span class="string" id="5788913">&#34;:&#34;</span><span class="op" id="5788916">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788920">if</span>&nbsp;<span class="ident" id="5788923">i</span>&nbsp;<span class="op" id="5788925">&lt;</span>&nbsp;<span class="num" id="5788927">0</span>&nbsp;<span class="op" id="5788929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788934">return</span>&nbsp;<span class="ident" id="5788941">fmt</span><span class="op" id="5788944">.</span><span class="ident" id="5788945">Errorf</span><span class="op" id="5788951">(</span><span class="string" id="5788952">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5788979">,</span>&nbsp;<span class="ident" id="5788981">filename</span><span class="op" id="5788989">,</span>&nbsp;<span class="ident" id="5788991">orig</span><span class="op" id="5788995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789003">line</span><span class="op" id="5789007">,</span>&nbsp;<span class="ident" id="5789009">argstr</span>&nbsp;<span class="op" id="5789016">:=</span>&nbsp;<span class="ident" id="5789019">line</span><span class="op" id="5789023">[</span><span class="op" id="5789024">:</span><span class="ident" id="5789025">i</span><span class="op" id="5789026">]</span><span class="op" id="5789027">,</span>&nbsp;<span class="ident" id="5789029">line</span><span class="op" id="5789033">[</span><span class="ident" id="5789034">i</span><span class="op" id="5789035">+</span><span class="num" id="5789036">1</span><span class="op" id="5789037">:</span><span class="op" id="5789038">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5789043">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789073">f</span>&nbsp;<span class="op" id="5789075">:=</span>&nbsp;<span class="ident" id="5789078">strings</span><span class="op" id="5789085">.</span><span class="ident" id="5789086">Fields</span><span class="op" id="5789092">(</span><span class="ident" id="5789093">line</span><span class="op" id="5789097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789101">if</span>&nbsp;<span class="builtinfunc" id="5789104">len</span><span class="op" id="5789107">(</span><span class="ident" id="5789108">f</span><span class="op" id="5789109">)</span>&nbsp;<span class="op" id="5789111">&lt;</span>&nbsp;<span class="num" id="5789113">1</span>&nbsp;<span class="op" id="5789115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789120">return</span>&nbsp;<span class="ident" id="5789127">fmt</span><span class="op" id="5789130">.</span><span class="ident" id="5789131">Errorf</span><span class="op" id="5789137">(</span><span class="string" id="5789138">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5789165">,</span>&nbsp;<span class="ident" id="5789167">filename</span><span class="op" id="5789175">,</span>&nbsp;<span class="ident" id="5789177">orig</span><span class="op" id="5789181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789185">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789190">cond</span><span class="op" id="5789194">,</span>&nbsp;<span class="ident" id="5789196">verb</span>&nbsp;<span class="op" id="5789201">:=</span>&nbsp;<span class="ident" id="5789204">f</span><span class="op" id="5789205">[</span><span class="op" id="5789206">:</span><span class="builtinfunc" id="5789207">len</span><span class="op" id="5789210">(</span><span class="ident" id="5789211">f</span><span class="op" id="5789212">)</span><span class="op" id="5789213">-</span><span class="num" id="5789214">1</span><span class="op" id="5789215">]</span><span class="op" id="5789216">,</span>&nbsp;<span class="ident" id="5789218">f</span><span class="op" id="5789219">[</span><span class="builtinfunc" id="5789220">len</span><span class="op" id="5789223">(</span><span class="ident" id="5789224">f</span><span class="op" id="5789225">)</span><span class="op" id="5789226">-</span><span class="num" id="5789227">1</span><span class="op" id="5789228">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789232">if</span>&nbsp;<span class="builtinfunc" id="5789235">len</span><span class="op" id="5789238">(</span><span class="ident" id="5789239">cond</span><span class="op" id="5789243">)</span>&nbsp;<span class="op" id="5789245">&gt;</span>&nbsp;<span class="num" id="5789247">0</span>&nbsp;<span class="op" id="5789249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789254">ok</span>&nbsp;<span class="op" id="5789257">:=</span>&nbsp;<span class="builtintype" id="5789260">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789269">for</span>&nbsp;<span class="ident" id="5789273">_</span><span class="op" id="5789274">,</span>&nbsp;<span class="ident" id="5789276">c</span>&nbsp;<span class="op" id="5789278">:=</span>&nbsp;<span class="keyword" id="5789281">range</span>&nbsp;<span class="ident" id="5789287">cond</span>&nbsp;<span class="op" id="5789292">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789298">if</span>&nbsp;<span class="ident" id="5789301">ctxt</span><span class="op" id="5789305">.</span><span class="ident" id="5789306">match</span><span class="op" id="5789311">(</span><span class="ident" id="5789312">c</span><span class="op" id="5789313">,</span>&nbsp;<span class="ident" id="5789315">nil</span><span class="op" id="5789318">)</span>&nbsp;<span class="op" id="5789320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789327">ok</span>&nbsp;<span class="op" id="5789330">=</span>&nbsp;<span class="builtintype" id="5789332">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789342">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789357">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789362">if</span>&nbsp;<span class="op" id="5789365">!</span><span class="ident" id="5789366">ok</span>&nbsp;<span class="op" id="5789369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789375">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789396">args</span><span class="op" id="5789400">,</span>&nbsp;<span class="ident" id="5789402">err</span>&nbsp;<span class="op" id="5789406">:=</span>&nbsp;<span class="ident" id="5789409">splitQuoted</span><span class="op" id="5789420">(</span><span class="ident" id="5789421">argstr</span><span class="op" id="5789427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789431">if</span>&nbsp;<span class="ident" id="5789434">err</span>&nbsp;<span class="op" id="5789438">!=</span>&nbsp;<span class="ident" id="5789441">nil</span>&nbsp;<span class="op" id="5789445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789450">return</span>&nbsp;<span class="ident" id="5789457">fmt</span><span class="op" id="5789460">.</span><span class="ident" id="5789461">Errorf</span><span class="op" id="5789467">(</span><span class="string" id="5789468">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5789495">,</span>&nbsp;<span class="ident" id="5789497">filename</span><span class="op" id="5789505">,</span>&nbsp;<span class="ident" id="5789507">orig</span><span class="op" id="5789511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789519">for</span>&nbsp;<span class="ident" id="5789523">_</span><span class="op" id="5789524">,</span>&nbsp;<span class="ident" id="5789526">arg</span>&nbsp;<span class="op" id="5789530">:=</span>&nbsp;<span class="keyword" id="5789533">range</span>&nbsp;<span class="ident" id="5789539">args</span>&nbsp;<span class="op" id="5789544">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789549">if</span>&nbsp;<span class="op" id="5789552">!</span><span class="ident" id="5789553">safeCgoName</span><span class="op" id="5789564">(</span><span class="ident" id="5789565">arg</span><span class="op" id="5789568">)</span>&nbsp;<span class="op" id="5789570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789576">return</span>&nbsp;<span class="ident" id="5789583">fmt</span><span class="op" id="5789586">.</span><span class="ident" id="5789587">Errorf</span><span class="op" id="5789593">(</span><span class="string" id="5789594">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="5789627">,</span>&nbsp;<span class="ident" id="5789629">filename</span><span class="op" id="5789637">,</span>&nbsp;<span class="ident" id="5789639">arg</span><span class="op" id="5789642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789656">switch</span>&nbsp;<span class="ident" id="5789663">verb</span>&nbsp;<span class="op" id="5789668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789672">case</span>&nbsp;<span class="string" id="5789677">&#34;CFLAGS&#34;</span><span class="op" id="5789685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789690">di</span><span class="op" id="5789692">.</span><span class="ident" id="5789693">CgoCFLAGS</span>&nbsp;<span class="op" id="5789703">=</span>&nbsp;<span class="builtinfunc" id="5789705">append</span><span class="op" id="5789711">(</span><span class="ident" id="5789712">di</span><span class="op" id="5789714">.</span><span class="ident" id="5789715">CgoCFLAGS</span><span class="op" id="5789724">,</span>&nbsp;<span class="ident" id="5789726">args</span><span class="op" id="5789730">...</span><span class="op" id="5789733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789737">case</span>&nbsp;<span class="string" id="5789742">&#34;CPPFLAGS&#34;</span><span class="op" id="5789752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789757">di</span><span class="op" id="5789759">.</span><span class="ident" id="5789760">CgoCPPFLAGS</span>&nbsp;<span class="op" id="5789772">=</span>&nbsp;<span class="builtinfunc" id="5789774">append</span><span class="op" id="5789780">(</span><span class="ident" id="5789781">di</span><span class="op" id="5789783">.</span><span class="ident" id="5789784">CgoCPPFLAGS</span><span class="op" id="5789795">,</span>&nbsp;<span class="ident" id="5789797">args</span><span class="op" id="5789801">...</span><span class="op" id="5789804">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789808">case</span>&nbsp;<span class="string" id="5789813">&#34;CXXFLAGS&#34;</span><span class="op" id="5789823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789828">di</span><span class="op" id="5789830">.</span><span class="ident" id="5789831">CgoCXXFLAGS</span>&nbsp;<span class="op" id="5789843">=</span>&nbsp;<span class="builtinfunc" id="5789845">append</span><span class="op" id="5789851">(</span><span class="ident" id="5789852">di</span><span class="op" id="5789854">.</span><span class="ident" id="5789855">CgoCXXFLAGS</span><span class="op" id="5789866">,</span>&nbsp;<span class="ident" id="5789868">args</span><span class="op" id="5789872">...</span><span class="op" id="5789875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789879">case</span>&nbsp;<span class="string" id="5789884">&#34;LDFLAGS&#34;</span><span class="op" id="5789893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789898">di</span><span class="op" id="5789900">.</span><span class="ident" id="5789901">CgoLDFLAGS</span>&nbsp;<span class="op" id="5789912">=</span>&nbsp;<span class="builtinfunc" id="5789914">append</span><span class="op" id="5789920">(</span><span class="ident" id="5789921">di</span><span class="op" id="5789923">.</span><span class="ident" id="5789924">CgoLDFLAGS</span><span class="op" id="5789934">,</span>&nbsp;<span class="ident" id="5789936">args</span><span class="op" id="5789940">...</span><span class="op" id="5789943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789947">case</span>&nbsp;<span class="string" id="5789952">&#34;pkg-config&#34;</span><span class="op" id="5789964">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789969">di</span><span class="op" id="5789971">.</span><span class="ident" id="5789972">CgoPkgConfig</span>&nbsp;<span class="op" id="5789985">=</span>&nbsp;<span class="builtinfunc" id="5789987">append</span><span class="op" id="5789993">(</span><span class="ident" id="5789994">di</span><span class="op" id="5789996">.</span><span class="ident" id="5789997">CgoPkgConfig</span><span class="op" id="5790009">,</span>&nbsp;<span class="ident" id="5790011">args</span><span class="op" id="5790015">...</span><span class="op" id="5790018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790022">default</span><span class="op" id="5790029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790034">return</span>&nbsp;<span class="ident" id="5790041">fmt</span><span class="op" id="5790044">.</span><span class="ident" id="5790045">Errorf</span><span class="op" id="5790051">(</span><span class="string" id="5790052">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="5790079">,</span>&nbsp;<span class="ident" id="5790081">filename</span><span class="op" id="5790089">,</span>&nbsp;<span class="ident" id="5790091">orig</span><span class="op" id="5790095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5790099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5790102">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790105">return</span>&nbsp;<span class="ident" id="5790112">nil</span><br>
<span class="lineno"></span><span class="op" id="5790116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5790119">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="5790224">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="5790334">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="5790364">var</span>&nbsp;<span class="ident" id="5790368">safeBytes</span>&nbsp;<span class="op" id="5790378">=</span>&nbsp;<span class="op" id="5790380">[</span><span class="op" id="5790381">]</span><span class="builtintype" id="5790382">byte</span><span class="op" id="5790386">(</span><span class="string" id="5790387">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="5790460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5790463">func</span>&nbsp;<span class="ident" id="5790468">safeCgoName</span><span class="op" id="5790479">(</span><span class="ident" id="5790480">s</span>&nbsp;<span class="builtintype" id="5790482">string</span><span class="op" id="5790488">)</span>&nbsp;<span class="builtintype" id="5790490">bool</span>&nbsp;<span class="op" id="5790495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790498">if</span>&nbsp;<span class="ident" id="5790501">s</span>&nbsp;<span class="op" id="5790503">==</span>&nbsp;<span class="string" id="5790506">&#34;&#34;</span>&nbsp;<span class="op" id="5790509">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790513">return</span>&nbsp;<span class="builtintype" id="5790520">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5790527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790530">for</span>&nbsp;<span class="ident" id="5790534">i</span>&nbsp;<span class="op" id="5790536">:=</span>&nbsp;<span class="num" id="5790539">0</span><span class="op" id="5790540">;</span>&nbsp;<span class="ident" id="5790542">i</span>&nbsp;<span class="op" id="5790544">&lt;</span>&nbsp;<span class="builtinfunc" id="5790546">len</span><span class="op" id="5790549">(</span><span class="ident" id="5790550">s</span><span class="op" id="5790551">)</span><span class="op" id="5790552">;</span>&nbsp;<span class="ident" id="5790554">i</span><span class="op" id="5790555">++</span>&nbsp;<span class="op" id="5790558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790562">if</span>&nbsp;<span class="ident" id="5790565">c</span>&nbsp;<span class="op" id="5790567">:=</span>&nbsp;<span class="ident" id="5790570">s</span><span class="op" id="5790571">[</span><span class="ident" id="5790572">i</span><span class="op" id="5790573">]</span><span class="op" id="5790574">;</span>&nbsp;<span class="ident" id="5790576">c</span>&nbsp;<span class="op" id="5790578">&lt;</span>&nbsp;<span class="num" id="5790580">0x80</span>&nbsp;<span class="op" id="5790585">&amp;&amp;</span>&nbsp;<span class="ident" id="5790588">bytes</span><span class="op" id="5790593">.</span><span class="ident" id="5790594">IndexByte</span><span class="op" id="5790603">(</span><span class="ident" id="5790604">safeBytes</span><span class="op" id="5790613">,</span>&nbsp;<span class="ident" id="5790615">c</span><span class="op" id="5790616">)</span>&nbsp;<span class="op" id="5790618">&lt;</span>&nbsp;<span class="num" id="5790620">0</span>&nbsp;<span class="op" id="5790622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790627">return</span>&nbsp;<span class="builtintype" id="5790634">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5790642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5790645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790648">return</span>&nbsp;<span class="builtintype" id="5790655">true</span><br>
<span class="lineno"></span><span class="op" id="5790660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="5790663">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="5790746">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5790823">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="5790911">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5790993">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="5791074">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5791151">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="5791205">//</span><br>
<span class="lineno"></span><span class="comment" id="5791208">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="5791246">//</span><br>
<span class="lineno">1170</span><span class="comment" id="5791249">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5791280">//</span><br>
<span class="lineno"></span><span class="comment" id="5791283">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="5791306">//</span><br>
<span class="lineno"></span><span class="comment" id="5791309">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="5791351">//</span><br>
<span class="lineno"></span><span class="keyword" id="5791354">func</span>&nbsp;<span class="ident" id="5791359">splitQuoted</span><span class="op" id="5791370">(</span><span class="ident" id="5791371">s</span>&nbsp;<span class="builtintype" id="5791373">string</span><span class="op" id="5791379">)</span>&nbsp;<span class="op" id="5791381">(</span><span class="ident" id="5791382">r</span>&nbsp;<span class="op" id="5791384">[</span><span class="op" id="5791385">]</span><span class="builtintype" id="5791386">string</span><span class="op" id="5791392">,</span>&nbsp;<span class="ident" id="5791394">err</span>&nbsp;<span class="builtintype" id="5791398">error</span><span class="op" id="5791403">)</span>&nbsp;<span class="op" id="5791405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791408">var</span>&nbsp;<span class="ident" id="5791412">args</span>&nbsp;<span class="op" id="5791417">[</span><span class="op" id="5791418">]</span><span class="builtintype" id="5791419">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791427">arg</span>&nbsp;<span class="op" id="5791431">:=</span>&nbsp;<span class="builtinfunc" id="5791434">make</span><span class="op" id="5791438">(</span><span class="op" id="5791439">[</span><span class="op" id="5791440">]</span><span class="builtintype" id="5791441">rune</span><span class="op" id="5791445">,</span>&nbsp;<span class="builtinfunc" id="5791447">len</span><span class="op" id="5791450">(</span><span class="ident" id="5791451">s</span><span class="op" id="5791452">)</span><span class="op" id="5791453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791456">escaped</span>&nbsp;<span class="op" id="5791464">:=</span>&nbsp;<span class="builtintype" id="5791467">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791474">quoted</span>&nbsp;<span class="op" id="5791481">:=</span>&nbsp;<span class="builtintype" id="5791484">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791491">quote</span>&nbsp;<span class="op" id="5791497">:=</span>&nbsp;<span class="string" id="5791500">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791508">i</span>&nbsp;<span class="op" id="5791510">:=</span>&nbsp;<span class="num" id="5791513">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791516">for</span>&nbsp;<span class="ident" id="5791520">_</span><span class="op" id="5791521">,</span>&nbsp;<span class="builtintype" id="5791523">rune</span>&nbsp;<span class="op" id="5791528">:=</span>&nbsp;<span class="keyword" id="5791531">range</span>&nbsp;<span class="ident" id="5791537">s</span>&nbsp;<span class="op" id="5791539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791543">switch</span>&nbsp;<span class="op" id="5791550">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791554">case</span>&nbsp;<span class="ident" id="5791559">escaped</span><span class="op" id="5791566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791571">escaped</span>&nbsp;<span class="op" id="5791579">=</span>&nbsp;<span class="builtintype" id="5791581">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791589">case</span>&nbsp;<span class="builtintype" id="5791594">rune</span>&nbsp;<span class="op" id="5791599">==</span>&nbsp;<span class="string" id="5791602">&#39;\\&#39;</span><span class="op" id="5791606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791611">escaped</span>&nbsp;<span class="op" id="5791619">=</span>&nbsp;<span class="builtintype" id="5791621">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791629">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791640">case</span>&nbsp;<span class="ident" id="5791645">quote</span>&nbsp;<span class="op" id="5791651">!=</span>&nbsp;<span class="string" id="5791654">&#39;\x00&#39;</span><span class="op" id="5791660">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791665">if</span>&nbsp;<span class="builtintype" id="5791668">rune</span>&nbsp;<span class="op" id="5791673">==</span>&nbsp;<span class="ident" id="5791676">quote</span>&nbsp;<span class="op" id="5791682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791688">quote</span>&nbsp;<span class="op" id="5791694">=</span>&nbsp;<span class="string" id="5791696">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791707">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791719">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791723">case</span>&nbsp;<span class="builtintype" id="5791728">rune</span>&nbsp;<span class="op" id="5791733">==</span>&nbsp;<span class="string" id="5791736">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5791740">||</span>&nbsp;<span class="builtintype" id="5791743">rune</span>&nbsp;<span class="op" id="5791748">==</span>&nbsp;<span class="string" id="5791751">&#39;\&#39;&#39;</span><span class="op" id="5791755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791760">quoted</span>&nbsp;<span class="op" id="5791767">=</span>&nbsp;<span class="builtintype" id="5791769">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791777">quote</span>&nbsp;<span class="op" id="5791783">=</span>&nbsp;<span class="builtintype" id="5791785">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791793">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791804">case</span>&nbsp;<span class="ident" id="5791809">unicode</span><span class="op" id="5791816">.</span><span class="ident" id="5791817">IsSpace</span><span class="op" id="5791824">(</span><span class="builtintype" id="5791825">rune</span><span class="op" id="5791829">)</span><span class="op" id="5791830">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791835">if</span>&nbsp;<span class="ident" id="5791838">quoted</span>&nbsp;<span class="op" id="5791845">||</span>&nbsp;<span class="ident" id="5791848">i</span>&nbsp;<span class="op" id="5791850">&gt;</span>&nbsp;<span class="num" id="5791852">0</span>&nbsp;<span class="op" id="5791854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791860">quoted</span>&nbsp;<span class="op" id="5791867">=</span>&nbsp;<span class="builtintype" id="5791869">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791879">args</span>&nbsp;<span class="op" id="5791884">=</span>&nbsp;<span class="builtinfunc" id="5791886">append</span><span class="op" id="5791892">(</span><span class="ident" id="5791893">args</span><span class="op" id="5791897">,</span>&nbsp;<span class="builtintype" id="5791899">string</span><span class="op" id="5791905">(</span><span class="ident" id="5791906">arg</span><span class="op" id="5791909">[</span><span class="op" id="5791910">:</span><span class="ident" id="5791911">i</span><span class="op" id="5791912">]</span><span class="op" id="5791913">)</span><span class="op" id="5791914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791920">i</span>&nbsp;<span class="op" id="5791922">=</span>&nbsp;<span class="num" id="5791924">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791929">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791934">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791949">arg</span><span class="op" id="5791952">[</span><span class="ident" id="5791953">i</span><span class="op" id="5791954">]</span>&nbsp;<span class="op" id="5791956">=</span>&nbsp;<span class="builtintype" id="5791958">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791965">i</span><span class="op" id="5791966">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791970">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791973">if</span>&nbsp;<span class="ident" id="5791976">quoted</span>&nbsp;<span class="op" id="5791983">||</span>&nbsp;<span class="ident" id="5791986">i</span>&nbsp;<span class="op" id="5791988">&gt;</span>&nbsp;<span class="num" id="5791990">0</span>&nbsp;<span class="op" id="5791992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791996">args</span>&nbsp;<span class="op" id="5792001">=</span>&nbsp;<span class="builtinfunc" id="5792003">append</span><span class="op" id="5792009">(</span><span class="ident" id="5792010">args</span><span class="op" id="5792014">,</span>&nbsp;<span class="builtintype" id="5792016">string</span><span class="op" id="5792022">(</span><span class="ident" id="5792023">arg</span><span class="op" id="5792026">[</span><span class="op" id="5792027">:</span><span class="ident" id="5792028">i</span><span class="op" id="5792029">]</span><span class="op" id="5792030">)</span><span class="op" id="5792031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792037">if</span>&nbsp;<span class="ident" id="5792040">quote</span>&nbsp;<span class="op" id="5792046">!=</span>&nbsp;<span class="num" id="5792049">0</span>&nbsp;<span class="op" id="5792051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792055">err</span>&nbsp;<span class="op" id="5792059">=</span>&nbsp;<span class="ident" id="5792061">errors</span><span class="op" id="5792067">.</span><span class="ident" id="5792068">New</span><span class="op" id="5792071">(</span><span class="string" id="5792072">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="5792088">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792091">}</span>&nbsp;<span class="keyword" id="5792093">else</span>&nbsp;<span class="keyword" id="5792098">if</span>&nbsp;<span class="ident" id="5792101">escaped</span>&nbsp;<span class="op" id="5792109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792113">err</span>&nbsp;<span class="op" id="5792117">=</span>&nbsp;<span class="ident" id="5792119">errors</span><span class="op" id="5792125">.</span><span class="ident" id="5792126">New</span><span class="op" id="5792129">(</span><span class="string" id="5792130">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="5792151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792157">return</span>&nbsp;<span class="ident" id="5792164">args</span><span class="op" id="5792168">,</span>&nbsp;<span class="ident" id="5792170">err</span><br>
<span class="lineno"></span><span class="op" id="5792174">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="5792177">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="5792222">//</span><br>
<span class="lineno"></span><span class="comment" id="5792225">//&nbsp;&nbsp;&nbsp;&nbsp$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="5792234">//&nbsp;&nbsp;&nbsp;&nbsp$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="5792245">//&nbsp;&nbsp;&nbsp;&nbspcgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="5792272">//&nbsp;&nbsp;&nbsp;&nbsp!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="5792301">//&nbsp;&nbsp;&nbsp;&nbspctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="5792318">//&nbsp;&nbsp;&nbsp;&nbsp!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="5792336">//&nbsp;&nbsp;&nbsp;&nbsptag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="5792400">//&nbsp;&nbsp;&nbsp;&nbsp!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="5792469">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="5792511">//</span><br>
<span class="lineno"></span><span class="keyword" id="5792514">func</span>&nbsp;<span class="op" id="5792519">(</span><span class="ident" id="5792520">ctxt</span>&nbsp;<span class="op" id="5792525">*</span><span class="ident" id="5792526">Context</span><span class="op" id="5792533">)</span>&nbsp;<span class="ident" id="5792535">match</span><span class="op" id="5792540">(</span><span class="ident" id="5792541">name</span>&nbsp;<span class="builtintype" id="5792546">string</span><span class="op" id="5792552">,</span>&nbsp;<span class="ident" id="5792554">allTags</span>&nbsp;<span class="keyword" id="5792562">map</span><span class="op" id="5792565">[</span><span class="builtintype" id="5792566">string</span><span class="op" id="5792572">]</span><span class="builtintype" id="5792573">bool</span><span class="op" id="5792577">)</span>&nbsp;<span class="builtintype" id="5792579">bool</span>&nbsp;<span class="op" id="5792584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792587">if</span>&nbsp;<span class="ident" id="5792590">name</span>&nbsp;<span class="op" id="5792595">==</span>&nbsp;<span class="string" id="5792598">&#34;&#34;</span>&nbsp;<span class="op" id="5792601">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792605">if</span>&nbsp;<span class="ident" id="5792608">allTags</span>&nbsp;<span class="op" id="5792616">!=</span>&nbsp;<span class="ident" id="5792619">nil</span>&nbsp;<span class="op" id="5792623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792628">allTags</span><span class="op" id="5792635">[</span><span class="ident" id="5792636">name</span><span class="op" id="5792640">]</span>&nbsp;<span class="op" id="5792642">=</span>&nbsp;<span class="builtintype" id="5792644">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792655">return</span>&nbsp;<span class="builtintype" id="5792662">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792669">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792672">if</span>&nbsp;<span class="ident" id="5792675">i</span>&nbsp;<span class="op" id="5792677">:=</span>&nbsp;<span class="ident" id="5792680">strings</span><span class="op" id="5792687">.</span><span class="ident" id="5792688">Index</span><span class="op" id="5792693">(</span><span class="ident" id="5792694">name</span><span class="op" id="5792698">,</span>&nbsp;<span class="string" id="5792700">&#34;,&#34;</span><span class="op" id="5792703">)</span><span class="op" id="5792704">;</span>&nbsp;<span class="ident" id="5792706">i</span>&nbsp;<span class="op" id="5792708">&gt;=</span>&nbsp;<span class="num" id="5792711">0</span>&nbsp;<span class="op" id="5792713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5792717">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792743">ok1</span>&nbsp;<span class="op" id="5792747">:=</span>&nbsp;<span class="ident" id="5792750">ctxt</span><span class="op" id="5792754">.</span><span class="ident" id="5792755">match</span><span class="op" id="5792760">(</span><span class="ident" id="5792761">name</span><span class="op" id="5792765">[</span><span class="op" id="5792766">:</span><span class="ident" id="5792767">i</span><span class="op" id="5792768">]</span><span class="op" id="5792769">,</span>&nbsp;<span class="ident" id="5792771">allTags</span><span class="op" id="5792778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792782">ok2</span>&nbsp;<span class="op" id="5792786">:=</span>&nbsp;<span class="ident" id="5792789">ctxt</span><span class="op" id="5792793">.</span><span class="ident" id="5792794">match</span><span class="op" id="5792799">(</span><span class="ident" id="5792800">name</span><span class="op" id="5792804">[</span><span class="ident" id="5792805">i</span><span class="op" id="5792806">+</span><span class="num" id="5792807">1</span><span class="op" id="5792808">:</span><span class="op" id="5792809">]</span><span class="op" id="5792810">,</span>&nbsp;<span class="ident" id="5792812">allTags</span><span class="op" id="5792819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792823">return</span>&nbsp;<span class="ident" id="5792830">ok1</span>&nbsp;<span class="op" id="5792834">&amp;&amp;</span>&nbsp;<span class="ident" id="5792837">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792845">if</span>&nbsp;<span class="ident" id="5792848">strings</span><span class="op" id="5792855">.</span><span class="ident" id="5792856">HasPrefix</span><span class="op" id="5792865">(</span><span class="ident" id="5792866">name</span><span class="op" id="5792870">,</span>&nbsp;<span class="string" id="5792872">&#34;!!&#34;</span><span class="op" id="5792876">)</span>&nbsp;<span class="op" id="5792878">{</span>&nbsp;<span class="comment" id="5792880">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792911">return</span>&nbsp;<span class="builtintype" id="5792918">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792928">if</span>&nbsp;<span class="ident" id="5792931">strings</span><span class="op" id="5792938">.</span><span class="ident" id="5792939">HasPrefix</span><span class="op" id="5792948">(</span><span class="ident" id="5792949">name</span><span class="op" id="5792953">,</span>&nbsp;<span class="string" id="5792955">&#34;!&#34;</span><span class="op" id="5792958">)</span>&nbsp;<span class="op" id="5792960">{</span>&nbsp;<span class="comment" id="5792962">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792976">return</span>&nbsp;<span class="builtinfunc" id="5792983">len</span><span class="op" id="5792986">(</span><span class="ident" id="5792987">name</span><span class="op" id="5792991">)</span>&nbsp;<span class="op" id="5792993">&gt;</span>&nbsp;<span class="num" id="5792995">1</span>&nbsp;<span class="op" id="5792997">&amp;&amp;</span>&nbsp;<span class="op" id="5793000">!</span><span class="ident" id="5793001">ctxt</span><span class="op" id="5793005">.</span><span class="ident" id="5793006">match</span><span class="op" id="5793011">(</span><span class="ident" id="5793012">name</span><span class="op" id="5793016">[</span><span class="num" id="5793017">1</span><span class="op" id="5793018">:</span><span class="op" id="5793019">]</span><span class="op" id="5793020">,</span>&nbsp;<span class="ident" id="5793022">allTags</span><span class="op" id="5793029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793036">if</span>&nbsp;<span class="ident" id="5793039">allTags</span>&nbsp;<span class="op" id="5793047">!=</span>&nbsp;<span class="ident" id="5793050">nil</span>&nbsp;<span class="op" id="5793054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793058">allTags</span><span class="op" id="5793065">[</span><span class="ident" id="5793066">name</span><span class="op" id="5793070">]</span>&nbsp;<span class="op" id="5793072">=</span>&nbsp;<span class="builtintype" id="5793074">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5793084">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5793139">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793204">for</span>&nbsp;<span class="ident" id="5793208">_</span><span class="op" id="5793209">,</span>&nbsp;<span class="ident" id="5793211">c</span>&nbsp;<span class="op" id="5793213">:=</span>&nbsp;<span class="keyword" id="5793216">range</span>&nbsp;<span class="ident" id="5793222">name</span>&nbsp;<span class="op" id="5793227">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793231">if</span>&nbsp;<span class="op" id="5793234">!</span><span class="ident" id="5793235">unicode</span><span class="op" id="5793242">.</span><span class="ident" id="5793243">IsLetter</span><span class="op" id="5793251">(</span><span class="ident" id="5793252">c</span><span class="op" id="5793253">)</span>&nbsp;<span class="op" id="5793255">&amp;&amp;</span>&nbsp;<span class="op" id="5793258">!</span><span class="ident" id="5793259">unicode</span><span class="op" id="5793266">.</span><span class="ident" id="5793267">IsDigit</span><span class="op" id="5793274">(</span><span class="ident" id="5793275">c</span><span class="op" id="5793276">)</span>&nbsp;<span class="op" id="5793278">&amp;&amp;</span>&nbsp;<span class="ident" id="5793281">c</span>&nbsp;<span class="op" id="5793283">!=</span>&nbsp;<span class="string" id="5793286">&#39;_&#39;</span>&nbsp;<span class="op" id="5793290">&amp;&amp;</span>&nbsp;<span class="ident" id="5793293">c</span>&nbsp;<span class="op" id="5793295">!=</span>&nbsp;<span class="string" id="5793298">&#39;.&#39;</span>&nbsp;<span class="op" id="5793302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793307">return</span>&nbsp;<span class="builtintype" id="5793314">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5793329">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793346">if</span>&nbsp;<span class="ident" id="5793349">ctxt</span><span class="op" id="5793353">.</span><span class="ident" id="5793354">CgoEnabled</span>&nbsp;<span class="op" id="5793365">&amp;&amp;</span>&nbsp;<span class="ident" id="5793368">name</span>&nbsp;<span class="op" id="5793373">==</span>&nbsp;<span class="string" id="5793376">&#34;cgo&#34;</span>&nbsp;<span class="op" id="5793382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793386">return</span>&nbsp;<span class="builtintype" id="5793393">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793402">if</span>&nbsp;<span class="ident" id="5793405">name</span>&nbsp;<span class="op" id="5793410">==</span>&nbsp;<span class="ident" id="5793413">ctxt</span><span class="op" id="5793417">.</span><span class="ident" id="5793418">GOOS</span>&nbsp;<span class="op" id="5793423">||</span>&nbsp;<span class="ident" id="5793426">name</span>&nbsp;<span class="op" id="5793431">==</span>&nbsp;<span class="ident" id="5793434">ctxt</span><span class="op" id="5793438">.</span><span class="ident" id="5793439">GOARCH</span>&nbsp;<span class="op" id="5793446">||</span>&nbsp;<span class="ident" id="5793449">name</span>&nbsp;<span class="op" id="5793454">==</span>&nbsp;<span class="ident" id="5793457">ctxt</span><span class="op" id="5793461">.</span><span class="ident" id="5793462">Compiler</span>&nbsp;<span class="op" id="5793471">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793475">return</span>&nbsp;<span class="builtintype" id="5793482">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793491">if</span>&nbsp;<span class="ident" id="5793494">ctxt</span><span class="op" id="5793498">.</span><span class="ident" id="5793499">GOOS</span>&nbsp;<span class="op" id="5793504">==</span>&nbsp;<span class="string" id="5793507">&#34;android&#34;</span>&nbsp;<span class="op" id="5793517">&amp;&amp;</span>&nbsp;<span class="ident" id="5793520">name</span>&nbsp;<span class="op" id="5793525">==</span>&nbsp;<span class="string" id="5793528">&#34;linux&#34;</span>&nbsp;<span class="op" id="5793536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793540">return</span>&nbsp;<span class="builtintype" id="5793547">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793553">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5793557">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793572">for</span>&nbsp;<span class="ident" id="5793576">_</span><span class="op" id="5793577">,</span>&nbsp;<span class="ident" id="5793579">tag</span>&nbsp;<span class="op" id="5793583">:=</span>&nbsp;<span class="keyword" id="5793586">range</span>&nbsp;<span class="ident" id="5793592">ctxt</span><span class="op" id="5793596">.</span><span class="ident" id="5793597">BuildTags</span>&nbsp;<span class="op" id="5793607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793611">if</span>&nbsp;<span class="ident" id="5793614">tag</span>&nbsp;<span class="op" id="5793618">==</span>&nbsp;<span class="ident" id="5793621">name</span>&nbsp;<span class="op" id="5793626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793631">return</span>&nbsp;<span class="builtintype" id="5793638">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793651">for</span>&nbsp;<span class="ident" id="5793655">_</span><span class="op" id="5793656">,</span>&nbsp;<span class="ident" id="5793658">tag</span>&nbsp;<span class="op" id="5793662">:=</span>&nbsp;<span class="keyword" id="5793665">range</span>&nbsp;<span class="ident" id="5793671">ctxt</span><span class="op" id="5793675">.</span><span class="ident" id="5793676">ReleaseTags</span>&nbsp;<span class="op" id="5793688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793692">if</span>&nbsp;<span class="ident" id="5793695">tag</span>&nbsp;<span class="op" id="5793699">==</span>&nbsp;<span class="ident" id="5793702">name</span>&nbsp;<span class="op" id="5793707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793712">return</span>&nbsp;<span class="builtintype" id="5793719">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793733">return</span>&nbsp;<span class="builtintype" id="5793740">false</span><br>
<span class="lineno"></span><span class="op" id="5793746">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="5793749">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="5793821">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="5793872">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="5793908">//</span><br>
<span class="lineno">1295</span><span class="comment" id="5793911">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="5793933">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="5793957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="5793989">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="5794016">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="5794045">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="5794082">//</span><br>
<span class="lineno"></span><span class="comment" id="5794085">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="5794164">func</span>&nbsp;<span class="op" id="5794169">(</span><span class="ident" id="5794170">ctxt</span>&nbsp;<span class="op" id="5794175">*</span><span class="ident" id="5794176">Context</span><span class="op" id="5794183">)</span>&nbsp;<span class="ident" id="5794185">goodOSArchFile</span><span class="op" id="5794199">(</span><span class="ident" id="5794200">name</span>&nbsp;<span class="builtintype" id="5794205">string</span><span class="op" id="5794211">,</span>&nbsp;<span class="ident" id="5794213">allTags</span>&nbsp;<span class="keyword" id="5794221">map</span><span class="op" id="5794224">[</span><span class="builtintype" id="5794225">string</span><span class="op" id="5794231">]</span><span class="builtintype" id="5794232">bool</span><span class="op" id="5794236">)</span>&nbsp;<span class="builtintype" id="5794238">bool</span>&nbsp;<span class="op" id="5794243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794246">if</span>&nbsp;<span class="ident" id="5794249">dot</span>&nbsp;<span class="op" id="5794253">:=</span>&nbsp;<span class="ident" id="5794256">strings</span><span class="op" id="5794263">.</span><span class="ident" id="5794264">Index</span><span class="op" id="5794269">(</span><span class="ident" id="5794270">name</span><span class="op" id="5794274">,</span>&nbsp;<span class="string" id="5794276">&#34;.&#34;</span><span class="op" id="5794279">)</span><span class="op" id="5794280">;</span>&nbsp;<span class="ident" id="5794282">dot</span>&nbsp;<span class="op" id="5794286">!=</span>&nbsp;<span class="op" id="5794289">-</span><span class="num" id="5794290">1</span>&nbsp;<span class="op" id="5794292">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794296">name</span>&nbsp;<span class="op" id="5794301">=</span>&nbsp;<span class="ident" id="5794303">name</span><span class="op" id="5794307">[</span><span class="op" id="5794308">:</span><span class="ident" id="5794309">dot</span><span class="op" id="5794312">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794319">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794395">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794470">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794538">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794616">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794691">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794766">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794804">i</span>&nbsp;<span class="op" id="5794806">:=</span>&nbsp;<span class="ident" id="5794809">strings</span><span class="op" id="5794816">.</span><span class="ident" id="5794817">Index</span><span class="op" id="5794822">(</span><span class="ident" id="5794823">name</span><span class="op" id="5794827">,</span>&nbsp;<span class="string" id="5794829">&#34;_&#34;</span><span class="op" id="5794832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794835">if</span>&nbsp;<span class="ident" id="5794838">i</span>&nbsp;<span class="op" id="5794840">&lt;</span>&nbsp;<span class="num" id="5794842">0</span>&nbsp;<span class="op" id="5794844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794848">return</span>&nbsp;<span class="builtintype" id="5794855">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794864">name</span>&nbsp;<span class="op" id="5794869">=</span>&nbsp;<span class="ident" id="5794871">name</span><span class="op" id="5794875">[</span><span class="ident" id="5794876">i</span><span class="op" id="5794877">:</span><span class="op" id="5794878">]</span>&nbsp;<span class="comment" id="5794880">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794918">l</span>&nbsp;<span class="op" id="5794920">:=</span>&nbsp;<span class="ident" id="5794923">strings</span><span class="op" id="5794930">.</span><span class="ident" id="5794931">Split</span><span class="op" id="5794936">(</span><span class="ident" id="5794937">name</span><span class="op" id="5794941">,</span>&nbsp;<span class="string" id="5794943">&#34;_&#34;</span><span class="op" id="5794946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794949">if</span>&nbsp;<span class="ident" id="5794952">n</span>&nbsp;<span class="op" id="5794954">:=</span>&nbsp;<span class="builtinfunc" id="5794957">len</span><span class="op" id="5794960">(</span><span class="ident" id="5794961">l</span><span class="op" id="5794962">)</span><span class="op" id="5794963">;</span>&nbsp;<span class="ident" id="5794965">n</span>&nbsp;<span class="op" id="5794967">&gt;</span>&nbsp;<span class="num" id="5794969">0</span>&nbsp;<span class="op" id="5794971">&amp;&amp;</span>&nbsp;<span class="ident" id="5794974">l</span><span class="op" id="5794975">[</span><span class="ident" id="5794976">n</span><span class="op" id="5794977">-</span><span class="num" id="5794978">1</span><span class="op" id="5794979">]</span>&nbsp;<span class="op" id="5794981">==</span>&nbsp;<span class="string" id="5794984">&#34;test&#34;</span>&nbsp;<span class="op" id="5794991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794995">l</span>&nbsp;<span class="op" id="5794997">=</span>&nbsp;<span class="ident" id="5794999">l</span><span class="op" id="5795000">[</span><span class="op" id="5795001">:</span><span class="ident" id="5795002">n</span><span class="op" id="5795003">-</span><span class="num" id="5795004">1</span><span class="op" id="5795005">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795008">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795011">n</span>&nbsp;<span class="op" id="5795013">:=</span>&nbsp;<span class="builtinfunc" id="5795016">len</span><span class="op" id="5795019">(</span><span class="ident" id="5795020">l</span><span class="op" id="5795021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795024">if</span>&nbsp;<span class="ident" id="5795027">n</span>&nbsp;<span class="op" id="5795029">&gt;=</span>&nbsp;<span class="num" id="5795032">2</span>&nbsp;<span class="op" id="5795034">&amp;&amp;</span>&nbsp;<span class="ident" id="5795037">knownOS</span><span class="op" id="5795044">[</span><span class="ident" id="5795045">l</span><span class="op" id="5795046">[</span><span class="ident" id="5795047">n</span><span class="op" id="5795048">-</span><span class="num" id="5795049">2</span><span class="op" id="5795050">]</span><span class="op" id="5795051">]</span>&nbsp;<span class="op" id="5795053">&amp;&amp;</span>&nbsp;<span class="ident" id="5795056">knownArch</span><span class="op" id="5795065">[</span><span class="ident" id="5795066">l</span><span class="op" id="5795067">[</span><span class="ident" id="5795068">n</span><span class="op" id="5795069">-</span><span class="num" id="5795070">1</span><span class="op" id="5795071">]</span><span class="op" id="5795072">]</span>&nbsp;<span class="op" id="5795074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795078">if</span>&nbsp;<span class="ident" id="5795081">allTags</span>&nbsp;<span class="op" id="5795089">!=</span>&nbsp;<span class="ident" id="5795092">nil</span>&nbsp;<span class="op" id="5795096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795101">allTags</span><span class="op" id="5795108">[</span><span class="ident" id="5795109">l</span><span class="op" id="5795110">[</span><span class="ident" id="5795111">n</span><span class="op" id="5795112">-</span><span class="num" id="5795113">2</span><span class="op" id="5795114">]</span><span class="op" id="5795115">]</span>&nbsp;<span class="op" id="5795117">=</span>&nbsp;<span class="builtintype" id="5795119">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795127">allTags</span><span class="op" id="5795134">[</span><span class="ident" id="5795135">l</span><span class="op" id="5795136">[</span><span class="ident" id="5795137">n</span><span class="op" id="5795138">-</span><span class="num" id="5795139">1</span><span class="op" id="5795140">]</span><span class="op" id="5795141">]</span>&nbsp;<span class="op" id="5795143">=</span>&nbsp;<span class="builtintype" id="5795145">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795156">if</span>&nbsp;<span class="ident" id="5795159">l</span><span class="op" id="5795160">[</span><span class="ident" id="5795161">n</span><span class="op" id="5795162">-</span><span class="num" id="5795163">1</span><span class="op" id="5795164">]</span>&nbsp;<span class="op" id="5795166">!=</span>&nbsp;<span class="ident" id="5795169">ctxt</span><span class="op" id="5795173">.</span><span class="ident" id="5795174">GOARCH</span>&nbsp;<span class="op" id="5795181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795186">return</span>&nbsp;<span class="builtintype" id="5795193">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795205">if</span>&nbsp;<span class="ident" id="5795208">ctxt</span><span class="op" id="5795212">.</span><span class="ident" id="5795213">GOOS</span>&nbsp;<span class="op" id="5795218">==</span>&nbsp;<span class="string" id="5795221">&#34;android&#34;</span>&nbsp;<span class="op" id="5795231">&amp;&amp;</span>&nbsp;<span class="ident" id="5795234">l</span><span class="op" id="5795235">[</span><span class="ident" id="5795236">n</span><span class="op" id="5795237">-</span><span class="num" id="5795238">2</span><span class="op" id="5795239">]</span>&nbsp;<span class="op" id="5795241">==</span>&nbsp;<span class="string" id="5795244">&#34;linux&#34;</span>&nbsp;<span class="op" id="5795252">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795257">return</span>&nbsp;<span class="builtintype" id="5795264">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795275">return</span>&nbsp;<span class="ident" id="5795282">l</span><span class="op" id="5795283">[</span><span class="ident" id="5795284">n</span><span class="op" id="5795285">-</span><span class="num" id="5795286">2</span><span class="op" id="5795287">]</span>&nbsp;<span class="op" id="5795289">==</span>&nbsp;<span class="ident" id="5795292">ctxt</span><span class="op" id="5795296">.</span><span class="ident" id="5795297">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795306">if</span>&nbsp;<span class="ident" id="5795309">n</span>&nbsp;<span class="op" id="5795311">&gt;=</span>&nbsp;<span class="num" id="5795314">1</span>&nbsp;<span class="op" id="5795316">&amp;&amp;</span>&nbsp;<span class="ident" id="5795319">knownOS</span><span class="op" id="5795326">[</span><span class="ident" id="5795327">l</span><span class="op" id="5795328">[</span><span class="ident" id="5795329">n</span><span class="op" id="5795330">-</span><span class="num" id="5795331">1</span><span class="op" id="5795332">]</span><span class="op" id="5795333">]</span>&nbsp;<span class="op" id="5795335">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795339">if</span>&nbsp;<span class="ident" id="5795342">allTags</span>&nbsp;<span class="op" id="5795350">!=</span>&nbsp;<span class="ident" id="5795353">nil</span>&nbsp;<span class="op" id="5795357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795362">allTags</span><span class="op" id="5795369">[</span><span class="ident" id="5795370">l</span><span class="op" id="5795371">[</span><span class="ident" id="5795372">n</span><span class="op" id="5795373">-</span><span class="num" id="5795374">1</span><span class="op" id="5795375">]</span><span class="op" id="5795376">]</span>&nbsp;<span class="op" id="5795378">=</span>&nbsp;<span class="builtintype" id="5795380">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795391">if</span>&nbsp;<span class="ident" id="5795394">ctxt</span><span class="op" id="5795398">.</span><span class="ident" id="5795399">GOOS</span>&nbsp;<span class="op" id="5795404">==</span>&nbsp;<span class="string" id="5795407">&#34;android&#34;</span>&nbsp;<span class="op" id="5795417">&amp;&amp;</span>&nbsp;<span class="ident" id="5795420">l</span><span class="op" id="5795421">[</span><span class="ident" id="5795422">n</span><span class="op" id="5795423">-</span><span class="num" id="5795424">1</span><span class="op" id="5795425">]</span>&nbsp;<span class="op" id="5795427">==</span>&nbsp;<span class="string" id="5795430">&#34;linux&#34;</span>&nbsp;<span class="op" id="5795438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795443">return</span>&nbsp;<span class="builtintype" id="5795450">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795461">return</span>&nbsp;<span class="ident" id="5795468">l</span><span class="op" id="5795469">[</span><span class="ident" id="5795470">n</span><span class="op" id="5795471">-</span><span class="num" id="5795472">1</span><span class="op" id="5795473">]</span>&nbsp;<span class="op" id="5795475">==</span>&nbsp;<span class="ident" id="5795478">ctxt</span><span class="op" id="5795482">.</span><span class="ident" id="5795483">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795492">if</span>&nbsp;<span class="ident" id="5795495">n</span>&nbsp;<span class="op" id="5795497">&gt;=</span>&nbsp;<span class="num" id="5795500">1</span>&nbsp;<span class="op" id="5795502">&amp;&amp;</span>&nbsp;<span class="ident" id="5795505">knownArch</span><span class="op" id="5795514">[</span><span class="ident" id="5795515">l</span><span class="op" id="5795516">[</span><span class="ident" id="5795517">n</span><span class="op" id="5795518">-</span><span class="num" id="5795519">1</span><span class="op" id="5795520">]</span><span class="op" id="5795521">]</span>&nbsp;<span class="op" id="5795523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795527">if</span>&nbsp;<span class="ident" id="5795530">allTags</span>&nbsp;<span class="op" id="5795538">!=</span>&nbsp;<span class="ident" id="5795541">nil</span>&nbsp;<span class="op" id="5795545">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795550">allTags</span><span class="op" id="5795557">[</span><span class="ident" id="5795558">l</span><span class="op" id="5795559">[</span><span class="ident" id="5795560">n</span><span class="op" id="5795561">-</span><span class="num" id="5795562">1</span><span class="op" id="5795563">]</span><span class="op" id="5795564">]</span>&nbsp;<span class="op" id="5795566">=</span>&nbsp;<span class="builtintype" id="5795568">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795579">return</span>&nbsp;<span class="ident" id="5795586">l</span><span class="op" id="5795587">[</span><span class="ident" id="5795588">n</span><span class="op" id="5795589">-</span><span class="num" id="5795590">1</span><span class="op" id="5795591">]</span>&nbsp;<span class="op" id="5795593">==</span>&nbsp;<span class="ident" id="5795596">ctxt</span><span class="op" id="5795600">.</span><span class="ident" id="5795601">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795612">return</span>&nbsp;<span class="builtintype" id="5795619">true</span><br>
<span class="lineno">1355</span><span class="op" id="5795624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5795627">var</span>&nbsp;<span class="ident" id="5795631">knownOS</span>&nbsp;<span class="op" id="5795639">=</span>&nbsp;<span class="builtinfunc" id="5795641">make</span><span class="op" id="5795645">(</span><span class="keyword" id="5795646">map</span><span class="op" id="5795649">[</span><span class="builtintype" id="5795650">string</span><span class="op" id="5795656">]</span><span class="builtintype" id="5795657">bool</span><span class="op" id="5795661">)</span><br>
<span class="lineno"></span><span class="keyword" id="5795663">var</span>&nbsp;<span class="ident" id="5795667">knownArch</span>&nbsp;<span class="op" id="5795677">=</span>&nbsp;<span class="builtinfunc" id="5795679">make</span><span class="op" id="5795683">(</span><span class="keyword" id="5795684">map</span><span class="op" id="5795687">[</span><span class="builtintype" id="5795688">string</span><span class="op" id="5795694">]</span><span class="builtintype" id="5795695">bool</span><span class="op" id="5795699">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="5795702">func</span>&nbsp;<span class="ident" id="5795707">init</span><span class="op" id="5795711">(</span><span class="op" id="5795712">)</span>&nbsp;<span class="op" id="5795714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795717">for</span>&nbsp;<span class="ident" id="5795721">_</span><span class="op" id="5795722">,</span>&nbsp;<span class="ident" id="5795724">v</span>&nbsp;<span class="op" id="5795726">:=</span>&nbsp;<span class="keyword" id="5795729">range</span>&nbsp;<span class="ident" id="5795735">strings</span><span class="op" id="5795742">.</span><span class="ident" id="5795743">Fields</span><span class="op" id="5795749">(</span><span class="ident" id="5795750">goosList</span><span class="op" id="5795758">)</span>&nbsp;<span class="op" id="5795760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795764">knownOS</span><span class="op" id="5795771">[</span><span class="ident" id="5795772">v</span><span class="op" id="5795773">]</span>&nbsp;<span class="op" id="5795775">=</span>&nbsp;<span class="builtintype" id="5795777">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795786">for</span>&nbsp;<span class="ident" id="5795790">_</span><span class="op" id="5795791">,</span>&nbsp;<span class="ident" id="5795793">v</span>&nbsp;<span class="op" id="5795795">:=</span>&nbsp;<span class="keyword" id="5795798">range</span>&nbsp;<span class="ident" id="5795804">strings</span><span class="op" id="5795811">.</span><span class="ident" id="5795812">Fields</span><span class="op" id="5795818">(</span><span class="ident" id="5795819">goarchList</span><span class="op" id="5795829">)</span>&nbsp;<span class="op" id="5795831">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795835">knownArch</span><span class="op" id="5795844">[</span><span class="ident" id="5795845">v</span><span class="op" id="5795846">]</span>&nbsp;<span class="op" id="5795848">=</span>&nbsp;<span class="builtintype" id="5795850">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795856">}</span><br>
<span class="lineno"></span><span class="op" id="5795858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5795861">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="5795913">var</span>&nbsp;<span class="ident" id="5795917">ToolDir</span>&nbsp;<span class="op" id="5795925">=</span>&nbsp;<span class="ident" id="5795927">filepath</span><span class="op" id="5795935">.</span><span class="ident" id="5795936">Join</span><span class="op" id="5795940">(</span><span class="ident" id="5795941">runtime</span><span class="op" id="5795948">.</span><span class="ident" id="5795949">GOROOT</span><span class="op" id="5795955">(</span><span class="op" id="5795956">)</span><span class="op" id="5795957">,</span>&nbsp;<span class="string" id="5795959">&#34;pkg/tool/&#34;</span><span class="op" id="5795970">+</span><span class="ident" id="5795971">runtime</span><span class="op" id="5795978">.</span><span class="ident" id="5795979">GOOS</span><span class="op" id="5795983">+</span><span class="string" id="5795984">&#34;_&#34;</span><span class="op" id="5795987">+</span><span class="ident" id="5795988">runtime</span><span class="op" id="5795995">.</span><span class="ident" id="5795996">GOARCH</span><span class="op" id="5796002">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5796005">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5796057">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5796119">func</span>&nbsp;<span class="ident" id="5796124">IsLocalImport</span><span class="op" id="5796137">(</span><span class="ident" id="5796138">path</span>&nbsp;<span class="builtintype" id="5796143">string</span><span class="op" id="5796149">)</span>&nbsp;<span class="builtintype" id="5796151">bool</span>&nbsp;<span class="op" id="5796156">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796159">return</span>&nbsp;<span class="ident" id="5796166">path</span>&nbsp;<span class="op" id="5796171">==</span>&nbsp;<span class="string" id="5796174">&#34;.&#34;</span>&nbsp;<span class="op" id="5796178">||</span>&nbsp;<span class="ident" id="5796181">path</span>&nbsp;<span class="op" id="5796186">==</span>&nbsp;<span class="string" id="5796189">&#34;..&#34;</span>&nbsp;<span class="op" id="5796194">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796199">strings</span><span class="op" id="5796206">.</span><span class="ident" id="5796207">HasPrefix</span><span class="op" id="5796216">(</span><span class="ident" id="5796217">path</span><span class="op" id="5796221">,</span>&nbsp;<span class="string" id="5796223">&#34;./&#34;</span><span class="op" id="5796227">)</span>&nbsp;<span class="op" id="5796229">||</span>&nbsp;<span class="ident" id="5796232">strings</span><span class="op" id="5796239">.</span><span class="ident" id="5796240">HasPrefix</span><span class="op" id="5796249">(</span><span class="ident" id="5796250">path</span><span class="op" id="5796254">,</span>&nbsp;<span class="string" id="5796256">&#34;../&#34;</span><span class="op" id="5796261">)</span><br>
<span class="lineno"></span><span class="op" id="5796263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5796266">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="5796335">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5796382">func</span>&nbsp;<span class="ident" id="5796387">ArchChar</span><span class="op" id="5796395">(</span><span class="ident" id="5796396">goarch</span>&nbsp;<span class="builtintype" id="5796403">string</span><span class="op" id="5796409">)</span>&nbsp;<span class="op" id="5796411">(</span><span class="builtintype" id="5796412">string</span><span class="op" id="5796418">,</span>&nbsp;<span class="builtintype" id="5796420">error</span><span class="op" id="5796425">)</span>&nbsp;<span class="op" id="5796427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796430">switch</span>&nbsp;<span class="ident" id="5796437">goarch</span>&nbsp;<span class="op" id="5796444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796447">case</span>&nbsp;<span class="string" id="5796452">&#34;386&#34;</span><span class="op" id="5796457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796461">return</span>&nbsp;<span class="string" id="5796468">&#34;8&#34;</span><span class="op" id="5796471">,</span>&nbsp;<span class="ident" id="5796473">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796478">case</span>&nbsp;<span class="string" id="5796483">&#34;amd64&#34;</span><span class="op" id="5796490">,</span>&nbsp;<span class="string" id="5796492">&#34;amd64p32&#34;</span><span class="op" id="5796502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796506">return</span>&nbsp;<span class="string" id="5796513">&#34;6&#34;</span><span class="op" id="5796516">,</span>&nbsp;<span class="ident" id="5796518">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796523">case</span>&nbsp;<span class="string" id="5796528">&#34;arm&#34;</span><span class="op" id="5796533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796537">return</span>&nbsp;<span class="string" id="5796544">&#34;5&#34;</span><span class="op" id="5796547">,</span>&nbsp;<span class="ident" id="5796549">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796554">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796557">return</span>&nbsp;<span class="string" id="5796564">&#34;&#34;</span><span class="op" id="5796566">,</span>&nbsp;<span class="ident" id="5796568">errors</span><span class="op" id="5796574">.</span><span class="ident" id="5796575">New</span><span class="op" id="5796578">(</span><span class="string" id="5796579">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="5796601">+</span>&nbsp;<span class="ident" id="5796603">goarch</span><span class="op" id="5796609">)</span><br>
<span class="lineno"></span><span class="op" id="5796611">}</span>
</div>
</body>
</html>
