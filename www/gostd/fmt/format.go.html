<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1444634">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1444689">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1444743">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1444794">package</span>&nbsp;<span class="ident" id="1444802">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1444807">import</span>&nbsp;<span class="op" id="1444814">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1444817">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1444825">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1444836">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1444851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1444854">const</span>&nbsp;<span class="op" id="1444860">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444863">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444896">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444943">nByte</span>&nbsp;<span class="op" id="1444949">=</span>&nbsp;<span class="num" id="1444951">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444956">ldigits</span>&nbsp;<span class="op" id="1444964">=</span>&nbsp;<span class="string" id="1444966">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444986">udigits</span>&nbsp;<span class="op" id="1444994">=</span>&nbsp;<span class="string" id="1444996">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="1445015">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1445018">const</span>&nbsp;<span class="op" id="1445024">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445027">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1445036">=</span>&nbsp;<span class="builtintype" id="1445038">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445044">unsigned</span>&nbsp;<span class="op" id="1445053">=</span>&nbsp;<span class="builtintype" id="1445055">false</span><br>
<span class="lineno">25</span><span class="op" id="1445061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1445064">var</span>&nbsp;<span class="ident" id="1445068">padZeroBytes</span>&nbsp;<span class="op" id="1445081">=</span>&nbsp;<span class="builtinfunc" id="1445083">make</span><span class="op" id="1445087">(</span><span class="op" id="1445088">[</span><span class="op" id="1445089">]</span><span class="builtintype" id="1445090">byte</span><span class="op" id="1445094">,</span>&nbsp;<span class="ident" id="1445096">nByte</span><span class="op" id="1445101">)</span><br>
<span class="lineno"></span><span class="keyword" id="1445103">var</span>&nbsp;<span class="ident" id="1445107">padSpaceBytes</span>&nbsp;<span class="op" id="1445121">=</span>&nbsp;<span class="builtinfunc" id="1445123">make</span><span class="op" id="1445127">(</span><span class="op" id="1445128">[</span><span class="op" id="1445129">]</span><span class="builtintype" id="1445130">byte</span><span class="op" id="1445134">,</span>&nbsp;<span class="ident" id="1445136">nByte</span><span class="op" id="1445141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="1445144">func</span>&nbsp;<span class="ident" id="1445149">init</span><span class="op" id="1445153">(</span><span class="op" id="1445154">)</span>&nbsp;<span class="op" id="1445156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445159">for</span>&nbsp;<span class="ident" id="1445163">i</span>&nbsp;<span class="op" id="1445165">:=</span>&nbsp;<span class="num" id="1445168">0</span><span class="op" id="1445169">;</span>&nbsp;<span class="ident" id="1445171">i</span>&nbsp;<span class="op" id="1445173">&lt;</span>&nbsp;<span class="ident" id="1445175">nByte</span><span class="op" id="1445180">;</span>&nbsp;<span class="ident" id="1445182">i</span><span class="op" id="1445183">++</span>&nbsp;<span class="op" id="1445186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445190">padZeroBytes</span><span class="op" id="1445202">[</span><span class="ident" id="1445203">i</span><span class="op" id="1445204">]</span>&nbsp;<span class="op" id="1445206">=</span>&nbsp;<span class="string" id="1445208">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445214">padSpaceBytes</span><span class="op" id="1445227">[</span><span class="ident" id="1445228">i</span><span class="op" id="1445229">]</span>&nbsp;<span class="op" id="1445231">=</span>&nbsp;<span class="string" id="1445233">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445238">}</span><br>
<span class="lineno">35</span><span class="op" id="1445240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1445243">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="1445299">type</span>&nbsp;<span class="ident" id="1445304">fmtFlags</span>&nbsp;<span class="keyword" id="1445313">struct</span>&nbsp;<span class="op" id="1445320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445323">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="1445335">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445341">precPresent</span>&nbsp;<span class="builtintype" id="1445353">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445359">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1445371">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445377">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1445389">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445395">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1445407">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445413">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1445425">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445431">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1445443">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445449">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1445461">bool</span>&nbsp;<span class="comment" id="1445466">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445507">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1445519">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1445526">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1445585">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1445652">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445706">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="1445713">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445719">sharpV</span>&nbsp;<span class="builtintype" id="1445726">bool</span><br>
<span class="lineno"></span><span class="op" id="1445731">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="1445734">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="1445784">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="1445843">type</span>&nbsp;<span class="ident" id="1445848">fmt</span>&nbsp;<span class="keyword" id="1445852">struct</span>&nbsp;<span class="op" id="1445859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445862">intbuf</span>&nbsp;<span class="op" id="1445869">[</span><span class="ident" id="1445870">nByte</span><span class="op" id="1445875">]</span><span class="builtintype" id="1445876">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445882">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1445889">*</span><span class="ident" id="1445890">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1445898">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445919">wid</span>&nbsp;&nbsp;<span class="builtintype" id="1445924">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445929">prec</span>&nbsp;<span class="builtintype" id="1445934">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445939">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="1445948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1445951">func</span>&nbsp;<span class="op" id="1445956">(</span><span class="ident" id="1445957">f</span>&nbsp;<span class="op" id="1445959">*</span><span class="ident" id="1445960">fmt</span><span class="op" id="1445963">)</span>&nbsp;<span class="ident" id="1445965">clearflags</span><span class="op" id="1445975">(</span><span class="op" id="1445976">)</span>&nbsp;<span class="op" id="1445978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445981">f</span><span class="op" id="1445982">.</span><span class="ident" id="1445983">fmtFlags</span>&nbsp;<span class="op" id="1445992">=</span>&nbsp;<span class="ident" id="1445994">fmtFlags</span><span class="op" id="1446002">{</span><span class="op" id="1446003">}</span><br>
<span class="lineno"></span><span class="op" id="1446005">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="1446008">func</span>&nbsp;<span class="op" id="1446013">(</span><span class="ident" id="1446014">f</span>&nbsp;<span class="op" id="1446016">*</span><span class="ident" id="1446017">fmt</span><span class="op" id="1446020">)</span>&nbsp;<span class="ident" id="1446022">init</span><span class="op" id="1446026">(</span><span class="ident" id="1446027">buf</span>&nbsp;<span class="op" id="1446031">*</span><span class="ident" id="1446032">buffer</span><span class="op" id="1446038">)</span>&nbsp;<span class="op" id="1446040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446043">f</span><span class="op" id="1446044">.</span><span class="ident" id="1446045">buf</span>&nbsp;<span class="op" id="1446049">=</span>&nbsp;<span class="ident" id="1446051">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446056">f</span><span class="op" id="1446057">.</span><span class="ident" id="1446058">clearflags</span><span class="op" id="1446068">(</span><span class="op" id="1446069">)</span><br>
<span class="lineno"></span><span class="op" id="1446071">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="1446074">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="1446160">func</span>&nbsp;<span class="op" id="1446165">(</span><span class="ident" id="1446166">f</span>&nbsp;<span class="op" id="1446168">*</span><span class="ident" id="1446169">fmt</span><span class="op" id="1446172">)</span>&nbsp;<span class="ident" id="1446174">computePadding</span><span class="op" id="1446188">(</span><span class="ident" id="1446189">width</span>&nbsp;<span class="builtintype" id="1446195">int</span><span class="op" id="1446198">)</span>&nbsp;<span class="op" id="1446200">(</span><span class="ident" id="1446201">padding</span>&nbsp;<span class="op" id="1446209">[</span><span class="op" id="1446210">]</span><span class="builtintype" id="1446211">byte</span><span class="op" id="1446215">,</span>&nbsp;<span class="ident" id="1446217">leftWidth</span><span class="op" id="1446226">,</span>&nbsp;<span class="ident" id="1446228">rightWidth</span>&nbsp;<span class="builtintype" id="1446239">int</span><span class="op" id="1446242">)</span>&nbsp;<span class="op" id="1446244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446247">left</span>&nbsp;<span class="op" id="1446252">:=</span>&nbsp;<span class="op" id="1446255">!</span><span class="ident" id="1446256">f</span><span class="op" id="1446257">.</span><span class="ident" id="1446258">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446265">w</span>&nbsp;<span class="op" id="1446267">:=</span>&nbsp;<span class="ident" id="1446270">f</span><span class="op" id="1446271">.</span><span class="ident" id="1446272">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446277">if</span>&nbsp;<span class="ident" id="1446280">w</span>&nbsp;<span class="op" id="1446282">&lt;</span>&nbsp;<span class="num" id="1446284">0</span>&nbsp;<span class="op" id="1446286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446290">left</span>&nbsp;<span class="op" id="1446295">=</span>&nbsp;<span class="builtintype" id="1446297">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446305">w</span>&nbsp;<span class="op" id="1446307">=</span>&nbsp;<span class="op" id="1446309">-</span><span class="ident" id="1446310">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446316">w</span>&nbsp;<span class="op" id="1446318">-=</span>&nbsp;<span class="ident" id="1446321">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446328">if</span>&nbsp;<span class="ident" id="1446331">w</span>&nbsp;<span class="op" id="1446333">&gt;</span>&nbsp;<span class="num" id="1446335">0</span>&nbsp;<span class="op" id="1446337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446341">if</span>&nbsp;<span class="ident" id="1446344">left</span>&nbsp;<span class="op" id="1446349">&amp;&amp;</span>&nbsp;<span class="ident" id="1446352">f</span><span class="op" id="1446353">.</span><span class="ident" id="1446354">zero</span>&nbsp;<span class="op" id="1446359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446364">return</span>&nbsp;<span class="ident" id="1446371">padZeroBytes</span><span class="op" id="1446383">,</span>&nbsp;<span class="ident" id="1446385">w</span><span class="op" id="1446386">,</span>&nbsp;<span class="num" id="1446388">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446396">if</span>&nbsp;<span class="ident" id="1446399">left</span>&nbsp;<span class="op" id="1446404">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446409">return</span>&nbsp;<span class="ident" id="1446416">padSpaceBytes</span><span class="op" id="1446429">,</span>&nbsp;<span class="ident" id="1446431">w</span><span class="op" id="1446432">,</span>&nbsp;<span class="num" id="1446434">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446438">}</span>&nbsp;<span class="keyword" id="1446440">else</span>&nbsp;<span class="op" id="1446445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1446450">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446491">return</span>&nbsp;<span class="ident" id="1446498">padSpaceBytes</span><span class="op" id="1446511">,</span>&nbsp;<span class="num" id="1446513">0</span><span class="op" id="1446514">,</span>&nbsp;<span class="ident" id="1446516">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446520">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446526">return</span><br>
<span class="lineno"></span><span class="op" id="1446533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1446536">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="1446582">func</span>&nbsp;<span class="op" id="1446587">(</span><span class="ident" id="1446588">f</span>&nbsp;<span class="op" id="1446590">*</span><span class="ident" id="1446591">fmt</span><span class="op" id="1446594">)</span>&nbsp;<span class="ident" id="1446596">writePadding</span><span class="op" id="1446608">(</span><span class="ident" id="1446609">n</span>&nbsp;<span class="builtintype" id="1446611">int</span><span class="op" id="1446614">,</span>&nbsp;<span class="ident" id="1446616">padding</span>&nbsp;<span class="op" id="1446624">[</span><span class="op" id="1446625">]</span><span class="builtintype" id="1446626">byte</span><span class="op" id="1446630">)</span>&nbsp;<span class="op" id="1446632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446635">for</span>&nbsp;<span class="ident" id="1446639">n</span>&nbsp;<span class="op" id="1446641">&gt;</span>&nbsp;<span class="num" id="1446643">0</span>&nbsp;<span class="op" id="1446645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446649">m</span>&nbsp;<span class="op" id="1446651">:=</span>&nbsp;<span class="ident" id="1446654">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446658">if</span>&nbsp;<span class="ident" id="1446661">m</span>&nbsp;<span class="op" id="1446663">&gt;</span>&nbsp;<span class="ident" id="1446665">nByte</span>&nbsp;<span class="op" id="1446671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446676">m</span>&nbsp;<span class="op" id="1446678">=</span>&nbsp;<span class="ident" id="1446680">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446692">f</span><span class="op" id="1446693">.</span><span class="ident" id="1446694">buf</span><span class="op" id="1446697">.</span><span class="ident" id="1446698">Write</span><span class="op" id="1446703">(</span><span class="ident" id="1446704">padding</span><span class="op" id="1446711">[</span><span class="num" id="1446712">0</span><span class="op" id="1446713">:</span><span class="ident" id="1446714">m</span><span class="op" id="1446715">]</span><span class="op" id="1446716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446720">n</span>&nbsp;<span class="op" id="1446722">-=</span>&nbsp;<span class="ident" id="1446725">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446728">}</span><br>
<span class="lineno"></span><span class="op" id="1446730">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="1446733">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="1446812">func</span>&nbsp;<span class="op" id="1446817">(</span><span class="ident" id="1446818">f</span>&nbsp;<span class="op" id="1446820">*</span><span class="ident" id="1446821">fmt</span><span class="op" id="1446824">)</span>&nbsp;<span class="ident" id="1446826">pad</span><span class="op" id="1446829">(</span><span class="ident" id="1446830">b</span>&nbsp;<span class="op" id="1446832">[</span><span class="op" id="1446833">]</span><span class="builtintype" id="1446834">byte</span><span class="op" id="1446838">)</span>&nbsp;<span class="op" id="1446840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446843">if</span>&nbsp;<span class="op" id="1446846">!</span><span class="ident" id="1446847">f</span><span class="op" id="1446848">.</span><span class="ident" id="1446849">widPresent</span>&nbsp;<span class="op" id="1446860">||</span>&nbsp;<span class="ident" id="1446863">f</span><span class="op" id="1446864">.</span><span class="ident" id="1446865">wid</span>&nbsp;<span class="op" id="1446869">==</span>&nbsp;<span class="num" id="1446872">0</span>&nbsp;<span class="op" id="1446874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446878">f</span><span class="op" id="1446879">.</span><span class="ident" id="1446880">buf</span><span class="op" id="1446883">.</span><span class="ident" id="1446884">Write</span><span class="op" id="1446889">(</span><span class="ident" id="1446890">b</span><span class="op" id="1446891">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446895">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446906">padding</span><span class="op" id="1446913">,</span>&nbsp;<span class="ident" id="1446915">left</span><span class="op" id="1446919">,</span>&nbsp;<span class="ident" id="1446921">right</span>&nbsp;<span class="op" id="1446927">:=</span>&nbsp;<span class="ident" id="1446930">f</span><span class="op" id="1446931">.</span><span class="ident" id="1446932">computePadding</span><span class="op" id="1446946">(</span><span class="ident" id="1446947">utf8</span><span class="op" id="1446951">.</span><span class="ident" id="1446952">RuneCount</span><span class="op" id="1446961">(</span><span class="ident" id="1446962">b</span><span class="op" id="1446963">)</span><span class="op" id="1446964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446967">if</span>&nbsp;<span class="ident" id="1446970">left</span>&nbsp;<span class="op" id="1446975">&gt;</span>&nbsp;<span class="num" id="1446977">0</span>&nbsp;<span class="op" id="1446979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446983">f</span><span class="op" id="1446984">.</span><span class="ident" id="1446985">writePadding</span><span class="op" id="1446997">(</span><span class="ident" id="1446998">left</span><span class="op" id="1447002">,</span>&nbsp;<span class="ident" id="1447004">padding</span><span class="op" id="1447011">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447017">f</span><span class="op" id="1447018">.</span><span class="ident" id="1447019">buf</span><span class="op" id="1447022">.</span><span class="ident" id="1447023">Write</span><span class="op" id="1447028">(</span><span class="ident" id="1447029">b</span><span class="op" id="1447030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447033">if</span>&nbsp;<span class="ident" id="1447036">right</span>&nbsp;<span class="op" id="1447042">&gt;</span>&nbsp;<span class="num" id="1447044">0</span>&nbsp;<span class="op" id="1447046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447050">f</span><span class="op" id="1447051">.</span><span class="ident" id="1447052">writePadding</span><span class="op" id="1447064">(</span><span class="ident" id="1447065">right</span><span class="op" id="1447070">,</span>&nbsp;<span class="ident" id="1447072">padding</span><span class="op" id="1447079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447082">}</span><br>
<span class="lineno">125</span><span class="op" id="1447084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1447087">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="1447170">func</span>&nbsp;<span class="op" id="1447175">(</span><span class="ident" id="1447176">f</span>&nbsp;<span class="op" id="1447178">*</span><span class="ident" id="1447179">fmt</span><span class="op" id="1447182">)</span>&nbsp;<span class="ident" id="1447184">padString</span><span class="op" id="1447193">(</span><span class="ident" id="1447194">s</span>&nbsp;<span class="builtintype" id="1447196">string</span><span class="op" id="1447202">)</span>&nbsp;<span class="op" id="1447204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447207">if</span>&nbsp;<span class="op" id="1447210">!</span><span class="ident" id="1447211">f</span><span class="op" id="1447212">.</span><span class="ident" id="1447213">widPresent</span>&nbsp;<span class="op" id="1447224">||</span>&nbsp;<span class="ident" id="1447227">f</span><span class="op" id="1447228">.</span><span class="ident" id="1447229">wid</span>&nbsp;<span class="op" id="1447233">==</span>&nbsp;<span class="num" id="1447236">0</span>&nbsp;<span class="op" id="1447238">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447242">f</span><span class="op" id="1447243">.</span><span class="ident" id="1447244">buf</span><span class="op" id="1447247">.</span><span class="ident" id="1447248">WriteString</span><span class="op" id="1447259">(</span><span class="ident" id="1447260">s</span><span class="op" id="1447261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447265">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447276">padding</span><span class="op" id="1447283">,</span>&nbsp;<span class="ident" id="1447285">left</span><span class="op" id="1447289">,</span>&nbsp;<span class="ident" id="1447291">right</span>&nbsp;<span class="op" id="1447297">:=</span>&nbsp;<span class="ident" id="1447300">f</span><span class="op" id="1447301">.</span><span class="ident" id="1447302">computePadding</span><span class="op" id="1447316">(</span><span class="ident" id="1447317">utf8</span><span class="op" id="1447321">.</span><span class="ident" id="1447322">RuneCountInString</span><span class="op" id="1447339">(</span><span class="ident" id="1447340">s</span><span class="op" id="1447341">)</span><span class="op" id="1447342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447345">if</span>&nbsp;<span class="ident" id="1447348">left</span>&nbsp;<span class="op" id="1447353">&gt;</span>&nbsp;<span class="num" id="1447355">0</span>&nbsp;<span class="op" id="1447357">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447361">f</span><span class="op" id="1447362">.</span><span class="ident" id="1447363">writePadding</span><span class="op" id="1447375">(</span><span class="ident" id="1447376">left</span><span class="op" id="1447380">,</span>&nbsp;<span class="ident" id="1447382">padding</span><span class="op" id="1447389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447395">f</span><span class="op" id="1447396">.</span><span class="ident" id="1447397">buf</span><span class="op" id="1447400">.</span><span class="ident" id="1447401">WriteString</span><span class="op" id="1447412">(</span><span class="ident" id="1447413">s</span><span class="op" id="1447414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447417">if</span>&nbsp;<span class="ident" id="1447420">right</span>&nbsp;<span class="op" id="1447426">&gt;</span>&nbsp;<span class="num" id="1447428">0</span>&nbsp;<span class="op" id="1447430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447434">f</span><span class="op" id="1447435">.</span><span class="ident" id="1447436">writePadding</span><span class="op" id="1447448">(</span><span class="ident" id="1447449">right</span><span class="op" id="1447454">,</span>&nbsp;<span class="ident" id="1447456">padding</span><span class="op" id="1447463">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447466">}</span><br>
<span class="lineno"></span><span class="op" id="1447468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1447471">var</span>&nbsp;<span class="op" id="1447475">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447478">trueBytes</span>&nbsp;&nbsp;<span class="op" id="1447489">=</span>&nbsp;<span class="op" id="1447491">[</span><span class="op" id="1447492">]</span><span class="builtintype" id="1447493">byte</span><span class="op" id="1447497">(</span><span class="string" id="1447498">&#34;true&#34;</span><span class="op" id="1447504">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447507">falseBytes</span>&nbsp;<span class="op" id="1447518">=</span>&nbsp;<span class="op" id="1447520">[</span><span class="op" id="1447521">]</span><span class="builtintype" id="1447522">byte</span><span class="op" id="1447526">(</span><span class="string" id="1447527">&#34;false&#34;</span><span class="op" id="1447534">)</span><br>
<span class="lineno"></span><span class="op" id="1447536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1447539">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="1447573">func</span>&nbsp;<span class="op" id="1447578">(</span><span class="ident" id="1447579">f</span>&nbsp;<span class="op" id="1447581">*</span><span class="ident" id="1447582">fmt</span><span class="op" id="1447585">)</span>&nbsp;<span class="ident" id="1447587">fmt_boolean</span><span class="op" id="1447598">(</span><span class="ident" id="1447599">v</span>&nbsp;<span class="builtintype" id="1447601">bool</span><span class="op" id="1447605">)</span>&nbsp;<span class="op" id="1447607">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447610">if</span>&nbsp;<span class="ident" id="1447613">v</span>&nbsp;<span class="op" id="1447615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447619">f</span><span class="op" id="1447620">.</span><span class="ident" id="1447621">pad</span><span class="op" id="1447624">(</span><span class="ident" id="1447625">trueBytes</span><span class="op" id="1447634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447637">}</span>&nbsp;<span class="keyword" id="1447639">else</span>&nbsp;<span class="op" id="1447644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447648">f</span><span class="op" id="1447649">.</span><span class="ident" id="1447650">pad</span><span class="op" id="1447653">(</span><span class="ident" id="1447654">falseBytes</span><span class="op" id="1447664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447667">}</span><br>
<span class="lineno">155</span><span class="op" id="1447669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1447672">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="1447754">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="1447785">func</span>&nbsp;<span class="op" id="1447790">(</span><span class="ident" id="1447791">f</span>&nbsp;<span class="op" id="1447793">*</span><span class="ident" id="1447794">fmt</span><span class="op" id="1447797">)</span>&nbsp;<span class="ident" id="1447799">integer</span><span class="op" id="1447806">(</span><span class="ident" id="1447807">a</span>&nbsp;<span class="ident" id="1447809">int64</span><span class="op" id="1447814">,</span>&nbsp;<span class="ident" id="1447816">base</span>&nbsp;<span class="ident" id="1447821">uint64</span><span class="op" id="1447827">,</span>&nbsp;<span class="ident" id="1447829">signedness</span>&nbsp;<span class="builtintype" id="1447840">bool</span><span class="op" id="1447844">,</span>&nbsp;<span class="ident" id="1447846">digits</span>&nbsp;<span class="builtintype" id="1447853">string</span><span class="op" id="1447859">)</span>&nbsp;<span class="op" id="1447861">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1447864">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447920">if</span>&nbsp;<span class="ident" id="1447923">f</span><span class="op" id="1447924">.</span><span class="ident" id="1447925">precPresent</span>&nbsp;<span class="op" id="1447937">&amp;&amp;</span>&nbsp;<span class="ident" id="1447940">f</span><span class="op" id="1447941">.</span><span class="ident" id="1447942">prec</span>&nbsp;<span class="op" id="1447947">==</span>&nbsp;<span class="num" id="1447950">0</span>&nbsp;<span class="op" id="1447952">&amp;&amp;</span>&nbsp;<span class="ident" id="1447955">a</span>&nbsp;<span class="op" id="1447957">==</span>&nbsp;<span class="num" id="1447960">0</span>&nbsp;<span class="op" id="1447962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447966">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447978">var</span>&nbsp;<span class="ident" id="1447982">buf</span>&nbsp;<span class="op" id="1447986">[</span><span class="op" id="1447987">]</span><span class="builtintype" id="1447988">byte</span>&nbsp;<span class="op" id="1447993">=</span>&nbsp;<span class="ident" id="1447995">f</span><span class="op" id="1447996">.</span><span class="ident" id="1447997">intbuf</span><span class="op" id="1448003">[</span><span class="num" id="1448004">0</span><span class="op" id="1448005">:</span><span class="op" id="1448006">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448009">if</span>&nbsp;<span class="ident" id="1448012">f</span><span class="op" id="1448013">.</span><span class="ident" id="1448014">widPresent</span>&nbsp;<span class="op" id="1448025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448029">width</span>&nbsp;<span class="op" id="1448035">:=</span>&nbsp;<span class="ident" id="1448038">f</span><span class="op" id="1448039">.</span><span class="ident" id="1448040">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448046">if</span>&nbsp;<span class="ident" id="1448049">base</span>&nbsp;<span class="op" id="1448054">==</span>&nbsp;<span class="num" id="1448057">16</span>&nbsp;<span class="op" id="1448060">&amp;&amp;</span>&nbsp;<span class="ident" id="1448063">f</span><span class="op" id="1448064">.</span><span class="ident" id="1448065">sharp</span>&nbsp;<span class="op" id="1448071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448076">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448098">width</span>&nbsp;<span class="op" id="1448104">+=</span>&nbsp;<span class="num" id="1448107">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448115">if</span>&nbsp;<span class="ident" id="1448118">width</span>&nbsp;<span class="op" id="1448124">&gt;</span>&nbsp;<span class="ident" id="1448126">nByte</span>&nbsp;<span class="op" id="1448132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448137">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448178">buf</span>&nbsp;<span class="op" id="1448182">=</span>&nbsp;<span class="builtinfunc" id="1448184">make</span><span class="op" id="1448188">(</span><span class="op" id="1448189">[</span><span class="op" id="1448190">]</span><span class="builtintype" id="1448191">byte</span><span class="op" id="1448195">,</span>&nbsp;<span class="ident" id="1448197">width</span><span class="op" id="1448202">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448213">negative</span>&nbsp;<span class="op" id="1448222">:=</span>&nbsp;<span class="ident" id="1448225">signedness</span>&nbsp;<span class="op" id="1448236">==</span>&nbsp;<span class="ident" id="1448239">signed</span>&nbsp;<span class="op" id="1448246">&amp;&amp;</span>&nbsp;<span class="ident" id="1448249">a</span>&nbsp;<span class="op" id="1448251">&lt;</span>&nbsp;<span class="num" id="1448253">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448256">if</span>&nbsp;<span class="ident" id="1448259">negative</span>&nbsp;<span class="op" id="1448268">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448272">a</span>&nbsp;<span class="op" id="1448274">=</span>&nbsp;<span class="op" id="1448276">-</span><span class="ident" id="1448277">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448284">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448349">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448394">prec</span>&nbsp;<span class="op" id="1448399">:=</span>&nbsp;<span class="num" id="1448402">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448405">if</span>&nbsp;<span class="ident" id="1448408">f</span><span class="op" id="1448409">.</span><span class="ident" id="1448410">precPresent</span>&nbsp;<span class="op" id="1448422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448426">prec</span>&nbsp;<span class="op" id="1448431">=</span>&nbsp;<span class="ident" id="1448433">f</span><span class="op" id="1448434">.</span><span class="ident" id="1448435">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448442">f</span><span class="op" id="1448443">.</span><span class="ident" id="1448444">zero</span>&nbsp;<span class="op" id="1448449">=</span>&nbsp;<span class="builtintype" id="1448451">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448458">}</span>&nbsp;<span class="keyword" id="1448460">else</span>&nbsp;<span class="keyword" id="1448465">if</span>&nbsp;<span class="ident" id="1448468">f</span><span class="op" id="1448469">.</span><span class="ident" id="1448470">zero</span>&nbsp;<span class="op" id="1448475">&amp;&amp;</span>&nbsp;<span class="ident" id="1448478">f</span><span class="op" id="1448479">.</span><span class="ident" id="1448480">widPresent</span>&nbsp;<span class="op" id="1448491">&amp;&amp;</span>&nbsp;<span class="op" id="1448494">!</span><span class="ident" id="1448495">f</span><span class="op" id="1448496">.</span><span class="ident" id="1448497">minus</span>&nbsp;<span class="op" id="1448503">&amp;&amp;</span>&nbsp;<span class="ident" id="1448506">f</span><span class="op" id="1448507">.</span><span class="ident" id="1448508">wid</span>&nbsp;<span class="op" id="1448512">&gt;</span>&nbsp;<span class="num" id="1448514">0</span>&nbsp;<span class="op" id="1448516">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448520">prec</span>&nbsp;<span class="op" id="1448525">=</span>&nbsp;<span class="ident" id="1448527">f</span><span class="op" id="1448528">.</span><span class="ident" id="1448529">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448535">if</span>&nbsp;<span class="ident" id="1448538">negative</span>&nbsp;<span class="op" id="1448547">||</span>&nbsp;<span class="ident" id="1448550">f</span><span class="op" id="1448551">.</span><span class="ident" id="1448552">plus</span>&nbsp;<span class="op" id="1448557">||</span>&nbsp;<span class="ident" id="1448560">f</span><span class="op" id="1448561">.</span><span class="ident" id="1448562">space</span>&nbsp;<span class="op" id="1448568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448573">prec</span><span class="op" id="1448577">--</span>&nbsp;<span class="comment" id="1448580">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448608">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448612">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448690">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448744">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448815">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448880">i</span>&nbsp;<span class="op" id="1448882">:=</span>&nbsp;<span class="builtinfunc" id="1448885">len</span><span class="op" id="1448888">(</span><span class="ident" id="1448889">buf</span><span class="op" id="1448892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448895">ua</span>&nbsp;<span class="op" id="1448898">:=</span>&nbsp;<span class="ident" id="1448901">uint64</span><span class="op" id="1448907">(</span><span class="ident" id="1448908">a</span><span class="op" id="1448909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448912">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1448983">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449023">switch</span>&nbsp;<span class="ident" id="1449030">base</span>&nbsp;<span class="op" id="1449035">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449038">case</span>&nbsp;<span class="num" id="1449043">10</span><span class="op" id="1449045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449049">for</span>&nbsp;<span class="ident" id="1449053">ua</span>&nbsp;<span class="op" id="1449056">&gt;=</span>&nbsp;<span class="num" id="1449059">10</span>&nbsp;<span class="op" id="1449062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449067">i</span><span class="op" id="1449068">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449074">next</span>&nbsp;<span class="op" id="1449079">:=</span>&nbsp;<span class="ident" id="1449082">ua</span>&nbsp;<span class="op" id="1449085">/</span>&nbsp;<span class="num" id="1449087">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449093">buf</span><span class="op" id="1449096">[</span><span class="ident" id="1449097">i</span><span class="op" id="1449098">]</span>&nbsp;<span class="op" id="1449100">=</span>&nbsp;<span class="builtintype" id="1449102">byte</span><span class="op" id="1449106">(</span><span class="string" id="1449107">&#39;0&#39;</span>&nbsp;<span class="op" id="1449111">+</span>&nbsp;<span class="ident" id="1449113">ua</span>&nbsp;<span class="op" id="1449116">-</span>&nbsp;<span class="ident" id="1449118">next</span><span class="op" id="1449122">*</span><span class="num" id="1449123">10</span><span class="op" id="1449125">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449130">ua</span>&nbsp;<span class="op" id="1449133">=</span>&nbsp;<span class="ident" id="1449135">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449145">case</span>&nbsp;<span class="num" id="1449150">16</span><span class="op" id="1449152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449156">for</span>&nbsp;<span class="ident" id="1449160">ua</span>&nbsp;<span class="op" id="1449163">&gt;=</span>&nbsp;<span class="num" id="1449166">16</span>&nbsp;<span class="op" id="1449169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449174">i</span><span class="op" id="1449175">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449181">buf</span><span class="op" id="1449184">[</span><span class="ident" id="1449185">i</span><span class="op" id="1449186">]</span>&nbsp;<span class="op" id="1449188">=</span>&nbsp;<span class="ident" id="1449190">digits</span><span class="op" id="1449196">[</span><span class="ident" id="1449197">ua</span><span class="op" id="1449199">&amp;</span><span class="num" id="1449200">0xF</span><span class="op" id="1449203">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449208">ua</span>&nbsp;<span class="op" id="1449211">&gt;&gt;=</span>&nbsp;<span class="num" id="1449215">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449222">case</span>&nbsp;<span class="num" id="1449227">8</span><span class="op" id="1449228">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449232">for</span>&nbsp;<span class="ident" id="1449236">ua</span>&nbsp;<span class="op" id="1449239">&gt;=</span>&nbsp;<span class="num" id="1449242">8</span>&nbsp;<span class="op" id="1449244">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449249">i</span><span class="op" id="1449250">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449256">buf</span><span class="op" id="1449259">[</span><span class="ident" id="1449260">i</span><span class="op" id="1449261">]</span>&nbsp;<span class="op" id="1449263">=</span>&nbsp;<span class="builtintype" id="1449265">byte</span><span class="op" id="1449269">(</span><span class="string" id="1449270">&#39;0&#39;</span>&nbsp;<span class="op" id="1449274">+</span>&nbsp;<span class="ident" id="1449276">ua</span><span class="op" id="1449278">&amp;</span><span class="num" id="1449279">7</span><span class="op" id="1449280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449285">ua</span>&nbsp;<span class="op" id="1449288">&gt;&gt;=</span>&nbsp;<span class="num" id="1449292">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449299">case</span>&nbsp;<span class="num" id="1449304">2</span><span class="op" id="1449305">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449309">for</span>&nbsp;<span class="ident" id="1449313">ua</span>&nbsp;<span class="op" id="1449316">&gt;=</span>&nbsp;<span class="num" id="1449319">2</span>&nbsp;<span class="op" id="1449321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449326">i</span><span class="op" id="1449327">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449333">buf</span><span class="op" id="1449336">[</span><span class="ident" id="1449337">i</span><span class="op" id="1449338">]</span>&nbsp;<span class="op" id="1449340">=</span>&nbsp;<span class="builtintype" id="1449342">byte</span><span class="op" id="1449346">(</span><span class="string" id="1449347">&#39;0&#39;</span>&nbsp;<span class="op" id="1449351">+</span>&nbsp;<span class="ident" id="1449353">ua</span><span class="op" id="1449355">&amp;</span><span class="num" id="1449356">1</span><span class="op" id="1449357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449362">ua</span>&nbsp;<span class="op" id="1449365">&gt;&gt;=</span>&nbsp;<span class="num" id="1449369">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449373">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449376">default</span><span class="op" id="1449383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1449387">panic</span><span class="op" id="1449392">(</span><span class="string" id="1449393">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="1449426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449432">i</span><span class="op" id="1449433">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449437">buf</span><span class="op" id="1449440">[</span><span class="ident" id="1449441">i</span><span class="op" id="1449442">]</span>&nbsp;<span class="op" id="1449444">=</span>&nbsp;<span class="ident" id="1449446">digits</span><span class="op" id="1449452">[</span><span class="ident" id="1449453">ua</span><span class="op" id="1449455">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449458">for</span>&nbsp;<span class="ident" id="1449462">i</span>&nbsp;<span class="op" id="1449464">&gt;</span>&nbsp;<span class="num" id="1449466">0</span>&nbsp;<span class="op" id="1449468">&amp;&amp;</span>&nbsp;<span class="ident" id="1449471">prec</span>&nbsp;<span class="op" id="1449476">&gt;</span>&nbsp;<span class="builtinfunc" id="1449478">len</span><span class="op" id="1449481">(</span><span class="ident" id="1449482">buf</span><span class="op" id="1449485">)</span><span class="op" id="1449486">-</span><span class="ident" id="1449487">i</span>&nbsp;<span class="op" id="1449489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449493">i</span><span class="op" id="1449494">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449499">buf</span><span class="op" id="1449502">[</span><span class="ident" id="1449503">i</span><span class="op" id="1449504">]</span>&nbsp;<span class="op" id="1449506">=</span>&nbsp;<span class="string" id="1449508">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1449517">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449551">if</span>&nbsp;<span class="ident" id="1449554">f</span><span class="op" id="1449555">.</span><span class="ident" id="1449556">sharp</span>&nbsp;<span class="op" id="1449562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449566">switch</span>&nbsp;<span class="ident" id="1449573">base</span>&nbsp;<span class="op" id="1449578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449582">case</span>&nbsp;<span class="num" id="1449587">8</span><span class="op" id="1449588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449593">if</span>&nbsp;<span class="ident" id="1449596">buf</span><span class="op" id="1449599">[</span><span class="ident" id="1449600">i</span><span class="op" id="1449601">]</span>&nbsp;<span class="op" id="1449603">!=</span>&nbsp;<span class="string" id="1449606">&#39;0&#39;</span>&nbsp;<span class="op" id="1449610">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449616">i</span><span class="op" id="1449617">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449624">buf</span><span class="op" id="1449627">[</span><span class="ident" id="1449628">i</span><span class="op" id="1449629">]</span>&nbsp;<span class="op" id="1449631">=</span>&nbsp;<span class="string" id="1449633">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449644">case</span>&nbsp;<span class="num" id="1449649">16</span><span class="op" id="1449651">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449656">i</span><span class="op" id="1449657">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449663">buf</span><span class="op" id="1449666">[</span><span class="ident" id="1449667">i</span><span class="op" id="1449668">]</span>&nbsp;<span class="op" id="1449670">=</span>&nbsp;<span class="string" id="1449672">&#39;x&#39;</span>&nbsp;<span class="op" id="1449676">+</span>&nbsp;<span class="ident" id="1449678">digits</span><span class="op" id="1449684">[</span><span class="num" id="1449685">10</span><span class="op" id="1449687">]</span>&nbsp;<span class="op" id="1449689">-</span>&nbsp;<span class="string" id="1449691">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449698">i</span><span class="op" id="1449699">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449705">buf</span><span class="op" id="1449708">[</span><span class="ident" id="1449709">i</span><span class="op" id="1449710">]</span>&nbsp;<span class="op" id="1449712">=</span>&nbsp;<span class="string" id="1449714">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449723">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449726">if</span>&nbsp;<span class="ident" id="1449729">f</span><span class="op" id="1449730">.</span><span class="ident" id="1449731">unicode</span>&nbsp;<span class="op" id="1449739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449743">i</span><span class="op" id="1449744">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449749">buf</span><span class="op" id="1449752">[</span><span class="ident" id="1449753">i</span><span class="op" id="1449754">]</span>&nbsp;<span class="op" id="1449756">=</span>&nbsp;<span class="string" id="1449758">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449764">i</span><span class="op" id="1449765">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449770">buf</span><span class="op" id="1449773">[</span><span class="ident" id="1449774">i</span><span class="op" id="1449775">]</span>&nbsp;<span class="op" id="1449777">=</span>&nbsp;<span class="string" id="1449779">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449788">if</span>&nbsp;<span class="ident" id="1449791">negative</span>&nbsp;<span class="op" id="1449800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449804">i</span><span class="op" id="1449805">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449810">buf</span><span class="op" id="1449813">[</span><span class="ident" id="1449814">i</span><span class="op" id="1449815">]</span>&nbsp;<span class="op" id="1449817">=</span>&nbsp;<span class="string" id="1449819">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449824">}</span>&nbsp;<span class="keyword" id="1449826">else</span>&nbsp;<span class="keyword" id="1449831">if</span>&nbsp;<span class="ident" id="1449834">f</span><span class="op" id="1449835">.</span><span class="ident" id="1449836">plus</span>&nbsp;<span class="op" id="1449841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449845">i</span><span class="op" id="1449846">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449851">buf</span><span class="op" id="1449854">[</span><span class="ident" id="1449855">i</span><span class="op" id="1449856">]</span>&nbsp;<span class="op" id="1449858">=</span>&nbsp;<span class="string" id="1449860">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449865">}</span>&nbsp;<span class="keyword" id="1449867">else</span>&nbsp;<span class="keyword" id="1449872">if</span>&nbsp;<span class="ident" id="1449875">f</span><span class="op" id="1449876">.</span><span class="ident" id="1449877">space</span>&nbsp;<span class="op" id="1449883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449887">i</span><span class="op" id="1449888">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1449893">buf</span><span class="op" id="1449896">[</span><span class="ident" id="1449897">i</span><span class="op" id="1449898">]</span>&nbsp;<span class="op" id="1449900">=</span>&nbsp;<span class="string" id="1449902">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1449907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1449911">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1449980">if</span>&nbsp;<span class="ident" id="1449983">f</span><span class="op" id="1449984">.</span><span class="ident" id="1449985">unicode</span>&nbsp;<span class="op" id="1449993">&amp;&amp;</span>&nbsp;<span class="ident" id="1449996">f</span><span class="op" id="1449997">.</span><span class="ident" id="1449998">uniQuote</span>&nbsp;<span class="op" id="1450007">&amp;&amp;</span>&nbsp;<span class="ident" id="1450010">a</span>&nbsp;<span class="op" id="1450012">&gt;=</span>&nbsp;<span class="num" id="1450015">0</span>&nbsp;<span class="op" id="1450017">&amp;&amp;</span>&nbsp;<span class="ident" id="1450020">a</span>&nbsp;<span class="op" id="1450022">&lt;=</span>&nbsp;<span class="ident" id="1450025">utf8</span><span class="op" id="1450029">.</span><span class="ident" id="1450030">MaxRune</span>&nbsp;<span class="op" id="1450038">&amp;&amp;</span>&nbsp;<span class="ident" id="1450041">strconv</span><span class="op" id="1450048">.</span><span class="ident" id="1450049">IsPrint</span><span class="op" id="1450056">(</span><span class="builtintype" id="1450057">rune</span><span class="op" id="1450061">(</span><span class="ident" id="1450062">a</span><span class="op" id="1450063">)</span><span class="op" id="1450064">)</span>&nbsp;<span class="op" id="1450066">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450070">runeWidth</span>&nbsp;<span class="op" id="1450080">:=</span>&nbsp;<span class="ident" id="1450083">utf8</span><span class="op" id="1450087">.</span><span class="ident" id="1450088">RuneLen</span><span class="op" id="1450095">(</span><span class="builtintype" id="1450096">rune</span><span class="op" id="1450100">(</span><span class="ident" id="1450101">a</span><span class="op" id="1450102">)</span><span class="op" id="1450103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450107">width</span>&nbsp;<span class="op" id="1450113">:=</span>&nbsp;<span class="num" id="1450116">1</span>&nbsp;<span class="op" id="1450118">+</span>&nbsp;<span class="num" id="1450120">1</span>&nbsp;<span class="op" id="1450122">+</span>&nbsp;<span class="ident" id="1450124">runeWidth</span>&nbsp;<span class="op" id="1450134">+</span>&nbsp;<span class="num" id="1450136">1</span>&nbsp;<span class="comment" id="1450138">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1450169">copy</span><span class="op" id="1450173">(</span><span class="ident" id="1450174">buf</span><span class="op" id="1450177">[</span><span class="ident" id="1450178">i</span><span class="op" id="1450179">-</span><span class="ident" id="1450180">width</span><span class="op" id="1450185">:</span><span class="op" id="1450186">]</span><span class="op" id="1450187">,</span>&nbsp;<span class="ident" id="1450189">buf</span><span class="op" id="1450192">[</span><span class="ident" id="1450193">i</span><span class="op" id="1450194">:</span><span class="op" id="1450195">]</span><span class="op" id="1450196">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1450200">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450237">i</span>&nbsp;<span class="op" id="1450239">-=</span>&nbsp;<span class="ident" id="1450242">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1450250">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450282">j</span>&nbsp;<span class="op" id="1450284">:=</span>&nbsp;<span class="builtinfunc" id="1450287">len</span><span class="op" id="1450290">(</span><span class="ident" id="1450291">buf</span><span class="op" id="1450294">)</span>&nbsp;<span class="op" id="1450296">-</span>&nbsp;<span class="ident" id="1450298">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450306">buf</span><span class="op" id="1450309">[</span><span class="ident" id="1450310">j</span><span class="op" id="1450311">]</span>&nbsp;<span class="op" id="1450313">=</span>&nbsp;<span class="string" id="1450315">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450321">j</span><span class="op" id="1450322">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450327">buf</span><span class="op" id="1450330">[</span><span class="ident" id="1450331">j</span><span class="op" id="1450332">]</span>&nbsp;<span class="op" id="1450334">=</span>&nbsp;<span class="string" id="1450336">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450343">j</span><span class="op" id="1450344">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450349">utf8</span><span class="op" id="1450353">.</span><span class="ident" id="1450354">EncodeRune</span><span class="op" id="1450364">(</span><span class="ident" id="1450365">buf</span><span class="op" id="1450368">[</span><span class="ident" id="1450369">j</span><span class="op" id="1450370">:</span><span class="op" id="1450371">]</span><span class="op" id="1450372">,</span>&nbsp;<span class="builtintype" id="1450374">rune</span><span class="op" id="1450378">(</span><span class="ident" id="1450379">a</span><span class="op" id="1450380">)</span><span class="op" id="1450381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450385">j</span>&nbsp;<span class="op" id="1450387">+=</span>&nbsp;<span class="ident" id="1450390">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450402">buf</span><span class="op" id="1450405">[</span><span class="ident" id="1450406">j</span><span class="op" id="1450407">]</span>&nbsp;<span class="op" id="1450409">=</span>&nbsp;<span class="string" id="1450411">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1450417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450421">f</span><span class="op" id="1450422">.</span><span class="ident" id="1450423">pad</span><span class="op" id="1450426">(</span><span class="ident" id="1450427">buf</span><span class="op" id="1450430">[</span><span class="ident" id="1450431">i</span><span class="op" id="1450432">:</span><span class="op" id="1450433">]</span><span class="op" id="1450434">)</span><br>
<span class="lineno"></span><span class="op" id="1450436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1450439">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="1450512">func</span>&nbsp;<span class="op" id="1450517">(</span><span class="ident" id="1450518">f</span>&nbsp;<span class="op" id="1450520">*</span><span class="ident" id="1450521">fmt</span><span class="op" id="1450524">)</span>&nbsp;<span class="ident" id="1450526">truncate</span><span class="op" id="1450534">(</span><span class="ident" id="1450535">s</span>&nbsp;<span class="builtintype" id="1450537">string</span><span class="op" id="1450543">)</span>&nbsp;<span class="builtintype" id="1450545">string</span>&nbsp;<span class="op" id="1450552">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450555">if</span>&nbsp;<span class="ident" id="1450558">f</span><span class="op" id="1450559">.</span><span class="ident" id="1450560">precPresent</span>&nbsp;<span class="op" id="1450572">&amp;&amp;</span>&nbsp;<span class="ident" id="1450575">f</span><span class="op" id="1450576">.</span><span class="ident" id="1450577">prec</span>&nbsp;<span class="op" id="1450582">&lt;</span>&nbsp;<span class="ident" id="1450584">utf8</span><span class="op" id="1450588">.</span><span class="ident" id="1450589">RuneCountInString</span><span class="op" id="1450606">(</span><span class="ident" id="1450607">s</span><span class="op" id="1450608">)</span>&nbsp;<span class="op" id="1450610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450614">n</span>&nbsp;<span class="op" id="1450616">:=</span>&nbsp;<span class="ident" id="1450619">f</span><span class="op" id="1450620">.</span><span class="ident" id="1450621">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450628">for</span>&nbsp;<span class="ident" id="1450632">i</span>&nbsp;<span class="op" id="1450634">:=</span>&nbsp;<span class="keyword" id="1450637">range</span>&nbsp;<span class="ident" id="1450643">s</span>&nbsp;<span class="op" id="1450645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450650">if</span>&nbsp;<span class="ident" id="1450653">n</span>&nbsp;<span class="op" id="1450655">==</span>&nbsp;<span class="num" id="1450658">0</span>&nbsp;<span class="op" id="1450660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450666">s</span>&nbsp;<span class="op" id="1450668">=</span>&nbsp;<span class="ident" id="1450670">s</span><span class="op" id="1450671">[</span><span class="op" id="1450672">:</span><span class="ident" id="1450673">i</span><span class="op" id="1450674">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450680">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1450689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450694">n</span><span class="op" id="1450695">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1450700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1450703">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450706">return</span>&nbsp;<span class="ident" id="1450713">s</span><br>
<span class="lineno"></span><span class="op" id="1450715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1450718">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1450745">func</span>&nbsp;<span class="op" id="1450750">(</span><span class="ident" id="1450751">f</span>&nbsp;<span class="op" id="1450753">*</span><span class="ident" id="1450754">fmt</span><span class="op" id="1450757">)</span>&nbsp;<span class="ident" id="1450759">fmt_s</span><span class="op" id="1450764">(</span><span class="ident" id="1450765">s</span>&nbsp;<span class="builtintype" id="1450767">string</span><span class="op" id="1450773">)</span>&nbsp;<span class="op" id="1450775">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450778">s</span>&nbsp;<span class="op" id="1450780">=</span>&nbsp;<span class="ident" id="1450782">f</span><span class="op" id="1450783">.</span><span class="ident" id="1450784">truncate</span><span class="op" id="1450792">(</span><span class="ident" id="1450793">s</span><span class="op" id="1450794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450797">f</span><span class="op" id="1450798">.</span><span class="ident" id="1450799">padString</span><span class="op" id="1450808">(</span><span class="ident" id="1450809">s</span><span class="op" id="1450810">)</span><br>
<span class="lineno"></span><span class="op" id="1450812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1450815">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="1450897">func</span>&nbsp;<span class="op" id="1450902">(</span><span class="ident" id="1450903">f</span>&nbsp;<span class="op" id="1450905">*</span><span class="ident" id="1450906">fmt</span><span class="op" id="1450909">)</span>&nbsp;<span class="ident" id="1450911">fmt_sbx</span><span class="op" id="1450918">(</span><span class="ident" id="1450919">s</span>&nbsp;<span class="builtintype" id="1450921">string</span><span class="op" id="1450927">,</span>&nbsp;<span class="ident" id="1450929">b</span>&nbsp;<span class="op" id="1450931">[</span><span class="op" id="1450932">]</span><span class="builtintype" id="1450933">byte</span><span class="op" id="1450937">,</span>&nbsp;<span class="ident" id="1450939">digits</span>&nbsp;<span class="builtintype" id="1450946">string</span><span class="op" id="1450952">)</span>&nbsp;<span class="op" id="1450954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450957">n</span>&nbsp;<span class="op" id="1450959">:=</span>&nbsp;<span class="builtinfunc" id="1450962">len</span><span class="op" id="1450965">(</span><span class="ident" id="1450966">b</span><span class="op" id="1450967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1450970">if</span>&nbsp;<span class="ident" id="1450973">b</span>&nbsp;<span class="op" id="1450975">==</span>&nbsp;<span class="ident" id="1450978">nil</span>&nbsp;<span class="op" id="1450982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1450986">n</span>&nbsp;<span class="op" id="1450988">=</span>&nbsp;<span class="builtinfunc" id="1450990">len</span><span class="op" id="1450993">(</span><span class="ident" id="1450994">s</span><span class="op" id="1450995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1450998">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451001">x</span>&nbsp;<span class="op" id="1451003">:=</span>&nbsp;<span class="ident" id="1451006">digits</span><span class="op" id="1451012">[</span><span class="num" id="1451013">10</span><span class="op" id="1451015">]</span>&nbsp;<span class="op" id="1451017">-</span>&nbsp;<span class="string" id="1451019">&#39;a&#39;</span>&nbsp;<span class="op" id="1451023">+</span>&nbsp;<span class="string" id="1451025">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1451030">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451069">var</span>&nbsp;<span class="ident" id="1451073">buf</span>&nbsp;<span class="op" id="1451077">[</span><span class="op" id="1451078">]</span><span class="builtintype" id="1451079">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451085">for</span>&nbsp;<span class="ident" id="1451089">i</span>&nbsp;<span class="op" id="1451091">:=</span>&nbsp;<span class="num" id="1451094">0</span><span class="op" id="1451095">;</span>&nbsp;<span class="ident" id="1451097">i</span>&nbsp;<span class="op" id="1451099">&lt;</span>&nbsp;<span class="ident" id="1451101">n</span><span class="op" id="1451102">;</span>&nbsp;<span class="ident" id="1451104">i</span><span class="op" id="1451105">++</span>&nbsp;<span class="op" id="1451108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451112">if</span>&nbsp;<span class="ident" id="1451115">i</span>&nbsp;<span class="op" id="1451117">&gt;</span>&nbsp;<span class="num" id="1451119">0</span>&nbsp;<span class="op" id="1451121">&amp;&amp;</span>&nbsp;<span class="ident" id="1451124">f</span><span class="op" id="1451125">.</span><span class="ident" id="1451126">space</span>&nbsp;<span class="op" id="1451132">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451137">buf</span>&nbsp;<span class="op" id="1451141">=</span>&nbsp;<span class="builtinfunc" id="1451143">append</span><span class="op" id="1451149">(</span><span class="ident" id="1451150">buf</span><span class="op" id="1451153">,</span>&nbsp;<span class="string" id="1451155">&#39;&nbsp;&#39;</span><span class="op" id="1451158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1451162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451166">if</span>&nbsp;<span class="ident" id="1451169">f</span><span class="op" id="1451170">.</span><span class="ident" id="1451171">sharp</span>&nbsp;<span class="op" id="1451177">&amp;&amp;</span>&nbsp;<span class="op" id="1451180">(</span><span class="ident" id="1451181">f</span><span class="op" id="1451182">.</span><span class="ident" id="1451183">space</span>&nbsp;<span class="op" id="1451189">||</span>&nbsp;<span class="ident" id="1451192">i</span>&nbsp;<span class="op" id="1451194">==</span>&nbsp;<span class="num" id="1451197">0</span><span class="op" id="1451198">)</span>&nbsp;<span class="op" id="1451200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451205">buf</span>&nbsp;<span class="op" id="1451209">=</span>&nbsp;<span class="builtinfunc" id="1451211">append</span><span class="op" id="1451217">(</span><span class="ident" id="1451218">buf</span><span class="op" id="1451221">,</span>&nbsp;<span class="string" id="1451223">&#39;0&#39;</span><span class="op" id="1451226">,</span>&nbsp;<span class="ident" id="1451228">x</span><span class="op" id="1451229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1451233">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451237">var</span>&nbsp;<span class="ident" id="1451241">c</span>&nbsp;<span class="builtintype" id="1451243">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451250">if</span>&nbsp;<span class="ident" id="1451253">b</span>&nbsp;<span class="op" id="1451255">==</span>&nbsp;<span class="ident" id="1451258">nil</span>&nbsp;<span class="op" id="1451262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451267">c</span>&nbsp;<span class="op" id="1451269">=</span>&nbsp;<span class="ident" id="1451271">s</span><span class="op" id="1451272">[</span><span class="ident" id="1451273">i</span><span class="op" id="1451274">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1451278">}</span>&nbsp;<span class="keyword" id="1451280">else</span>&nbsp;<span class="op" id="1451285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451290">c</span>&nbsp;<span class="op" id="1451292">=</span>&nbsp;<span class="ident" id="1451294">b</span><span class="op" id="1451295">[</span><span class="ident" id="1451296">i</span><span class="op" id="1451297">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1451301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451305">buf</span>&nbsp;<span class="op" id="1451309">=</span>&nbsp;<span class="builtinfunc" id="1451311">append</span><span class="op" id="1451317">(</span><span class="ident" id="1451318">buf</span><span class="op" id="1451321">,</span>&nbsp;<span class="ident" id="1451323">digits</span><span class="op" id="1451329">[</span><span class="ident" id="1451330">c</span><span class="op" id="1451331">&gt;&gt;</span><span class="num" id="1451333">4</span><span class="op" id="1451334">]</span><span class="op" id="1451335">,</span>&nbsp;<span class="ident" id="1451337">digits</span><span class="op" id="1451343">[</span><span class="ident" id="1451344">c</span><span class="op" id="1451345">&amp;</span><span class="num" id="1451346">0xF</span><span class="op" id="1451349">]</span><span class="op" id="1451350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1451353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451356">f</span><span class="op" id="1451357">.</span><span class="ident" id="1451358">pad</span><span class="op" id="1451361">(</span><span class="ident" id="1451362">buf</span><span class="op" id="1451365">)</span><br>
<span class="lineno"></span><span class="op" id="1451367">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="1451370">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1451437">func</span>&nbsp;<span class="op" id="1451442">(</span><span class="ident" id="1451443">f</span>&nbsp;<span class="op" id="1451445">*</span><span class="ident" id="1451446">fmt</span><span class="op" id="1451449">)</span>&nbsp;<span class="ident" id="1451451">fmt_sx</span><span class="op" id="1451457">(</span><span class="ident" id="1451458">s</span><span class="op" id="1451459">,</span>&nbsp;<span class="ident" id="1451461">digits</span>&nbsp;<span class="builtintype" id="1451468">string</span><span class="op" id="1451474">)</span>&nbsp;<span class="op" id="1451476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451479">if</span>&nbsp;<span class="ident" id="1451482">f</span><span class="op" id="1451483">.</span><span class="ident" id="1451484">precPresent</span>&nbsp;<span class="op" id="1451496">&amp;&amp;</span>&nbsp;<span class="ident" id="1451499">f</span><span class="op" id="1451500">.</span><span class="ident" id="1451501">prec</span>&nbsp;<span class="op" id="1451506">&lt;</span>&nbsp;<span class="builtinfunc" id="1451508">len</span><span class="op" id="1451511">(</span><span class="ident" id="1451512">s</span><span class="op" id="1451513">)</span>&nbsp;<span class="op" id="1451515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451519">s</span>&nbsp;<span class="op" id="1451521">=</span>&nbsp;<span class="ident" id="1451523">s</span><span class="op" id="1451524">[</span><span class="op" id="1451525">:</span><span class="ident" id="1451526">f</span><span class="op" id="1451527">.</span><span class="ident" id="1451528">prec</span><span class="op" id="1451532">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1451535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451538">f</span><span class="op" id="1451539">.</span><span class="ident" id="1451540">fmt_sbx</span><span class="op" id="1451547">(</span><span class="ident" id="1451548">s</span><span class="op" id="1451549">,</span>&nbsp;<span class="ident" id="1451551">nil</span><span class="op" id="1451554">,</span>&nbsp;<span class="ident" id="1451556">digits</span><span class="op" id="1451562">)</span><br>
<span class="lineno"></span><span class="op" id="1451564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1451567">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="1451638">func</span>&nbsp;<span class="op" id="1451643">(</span><span class="ident" id="1451644">f</span>&nbsp;<span class="op" id="1451646">*</span><span class="ident" id="1451647">fmt</span><span class="op" id="1451650">)</span>&nbsp;<span class="ident" id="1451652">fmt_bx</span><span class="op" id="1451658">(</span><span class="ident" id="1451659">b</span>&nbsp;<span class="op" id="1451661">[</span><span class="op" id="1451662">]</span><span class="builtintype" id="1451663">byte</span><span class="op" id="1451667">,</span>&nbsp;<span class="ident" id="1451669">digits</span>&nbsp;<span class="builtintype" id="1451676">string</span><span class="op" id="1451682">)</span>&nbsp;<span class="op" id="1451684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451687">if</span>&nbsp;<span class="ident" id="1451690">f</span><span class="op" id="1451691">.</span><span class="ident" id="1451692">precPresent</span>&nbsp;<span class="op" id="1451704">&amp;&amp;</span>&nbsp;<span class="ident" id="1451707">f</span><span class="op" id="1451708">.</span><span class="ident" id="1451709">prec</span>&nbsp;<span class="op" id="1451714">&lt;</span>&nbsp;<span class="builtinfunc" id="1451716">len</span><span class="op" id="1451719">(</span><span class="ident" id="1451720">b</span><span class="op" id="1451721">)</span>&nbsp;<span class="op" id="1451723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451727">b</span>&nbsp;<span class="op" id="1451729">=</span>&nbsp;<span class="ident" id="1451731">b</span><span class="op" id="1451732">[</span><span class="op" id="1451733">:</span><span class="ident" id="1451734">f</span><span class="op" id="1451735">.</span><span class="ident" id="1451736">prec</span><span class="op" id="1451740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1451743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451746">f</span><span class="op" id="1451747">.</span><span class="ident" id="1451748">fmt_sbx</span><span class="op" id="1451755">(</span><span class="string" id="1451756">&#34;&#34;</span><span class="op" id="1451758">,</span>&nbsp;<span class="ident" id="1451760">b</span><span class="op" id="1451761">,</span>&nbsp;<span class="ident" id="1451763">digits</span><span class="op" id="1451769">)</span><br>
<span class="lineno">355</span><span class="op" id="1451771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1451774">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="1451848">func</span>&nbsp;<span class="op" id="1451853">(</span><span class="ident" id="1451854">f</span>&nbsp;<span class="op" id="1451856">*</span><span class="ident" id="1451857">fmt</span><span class="op" id="1451860">)</span>&nbsp;<span class="ident" id="1451862">fmt_q</span><span class="op" id="1451867">(</span><span class="ident" id="1451868">s</span>&nbsp;<span class="builtintype" id="1451870">string</span><span class="op" id="1451876">)</span>&nbsp;<span class="op" id="1451878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451881">s</span>&nbsp;<span class="op" id="1451883">=</span>&nbsp;<span class="ident" id="1451885">f</span><span class="op" id="1451886">.</span><span class="ident" id="1451887">truncate</span><span class="op" id="1451895">(</span><span class="ident" id="1451896">s</span><span class="op" id="1451897">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451900">var</span>&nbsp;<span class="ident" id="1451904">quoted</span>&nbsp;<span class="builtintype" id="1451911">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451919">if</span>&nbsp;<span class="ident" id="1451922">f</span><span class="op" id="1451923">.</span><span class="ident" id="1451924">sharp</span>&nbsp;<span class="op" id="1451930">&amp;&amp;</span>&nbsp;<span class="ident" id="1451933">strconv</span><span class="op" id="1451940">.</span><span class="ident" id="1451941">CanBackquote</span><span class="op" id="1451953">(</span><span class="ident" id="1451954">s</span><span class="op" id="1451955">)</span>&nbsp;<span class="op" id="1451957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1451961">quoted</span>&nbsp;<span class="op" id="1451968">=</span>&nbsp;<span class="string" id="1451970">&#34;`&#34;</span>&nbsp;<span class="op" id="1451974">+</span>&nbsp;<span class="ident" id="1451976">s</span>&nbsp;<span class="op" id="1451978">+</span>&nbsp;<span class="string" id="1451980">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1451985">}</span>&nbsp;<span class="keyword" id="1451987">else</span>&nbsp;<span class="op" id="1451992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1451996">if</span>&nbsp;<span class="ident" id="1451999">f</span><span class="op" id="1452000">.</span><span class="ident" id="1452001">plus</span>&nbsp;<span class="op" id="1452006">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452011">quoted</span>&nbsp;<span class="op" id="1452018">=</span>&nbsp;<span class="ident" id="1452020">strconv</span><span class="op" id="1452027">.</span><span class="ident" id="1452028">QuoteToASCII</span><span class="op" id="1452040">(</span><span class="ident" id="1452041">s</span><span class="op" id="1452042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1452046">}</span>&nbsp;<span class="keyword" id="1452048">else</span>&nbsp;<span class="op" id="1452053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452058">quoted</span>&nbsp;<span class="op" id="1452065">=</span>&nbsp;<span class="ident" id="1452067">strconv</span><span class="op" id="1452074">.</span><span class="ident" id="1452075">Quote</span><span class="op" id="1452080">(</span><span class="ident" id="1452081">s</span><span class="op" id="1452082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1452086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1452089">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452092">f</span><span class="op" id="1452093">.</span><span class="ident" id="1452094">padString</span><span class="op" id="1452103">(</span><span class="ident" id="1452104">quoted</span><span class="op" id="1452110">)</span><br>
<span class="lineno"></span><span class="op" id="1452112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1452115">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="1452196">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="1452262">func</span>&nbsp;<span class="op" id="1452267">(</span><span class="ident" id="1452268">f</span>&nbsp;<span class="op" id="1452270">*</span><span class="ident" id="1452271">fmt</span><span class="op" id="1452274">)</span>&nbsp;<span class="ident" id="1452276">fmt_qc</span><span class="op" id="1452282">(</span><span class="ident" id="1452283">c</span>&nbsp;<span class="ident" id="1452285">int64</span><span class="op" id="1452290">)</span>&nbsp;<span class="op" id="1452292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1452295">var</span>&nbsp;<span class="ident" id="1452299">quoted</span>&nbsp;<span class="op" id="1452306">[</span><span class="op" id="1452307">]</span><span class="builtintype" id="1452308">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1452314">if</span>&nbsp;<span class="ident" id="1452317">f</span><span class="op" id="1452318">.</span><span class="ident" id="1452319">plus</span>&nbsp;<span class="op" id="1452324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452328">quoted</span>&nbsp;<span class="op" id="1452335">=</span>&nbsp;<span class="ident" id="1452337">strconv</span><span class="op" id="1452344">.</span><span class="ident" id="1452345">AppendQuoteRuneToASCII</span><span class="op" id="1452367">(</span><span class="ident" id="1452368">f</span><span class="op" id="1452369">.</span><span class="ident" id="1452370">intbuf</span><span class="op" id="1452376">[</span><span class="num" id="1452377">0</span><span class="op" id="1452378">:</span><span class="num" id="1452379">0</span><span class="op" id="1452380">]</span><span class="op" id="1452381">,</span>&nbsp;<span class="builtintype" id="1452383">rune</span><span class="op" id="1452387">(</span><span class="ident" id="1452388">c</span><span class="op" id="1452389">)</span><span class="op" id="1452390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1452393">}</span>&nbsp;<span class="keyword" id="1452395">else</span>&nbsp;<span class="op" id="1452400">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452404">quoted</span>&nbsp;<span class="op" id="1452411">=</span>&nbsp;<span class="ident" id="1452413">strconv</span><span class="op" id="1452420">.</span><span class="ident" id="1452421">AppendQuoteRune</span><span class="op" id="1452436">(</span><span class="ident" id="1452437">f</span><span class="op" id="1452438">.</span><span class="ident" id="1452439">intbuf</span><span class="op" id="1452445">[</span><span class="num" id="1452446">0</span><span class="op" id="1452447">:</span><span class="num" id="1452448">0</span><span class="op" id="1452449">]</span><span class="op" id="1452450">,</span>&nbsp;<span class="builtintype" id="1452452">rune</span><span class="op" id="1452456">(</span><span class="ident" id="1452457">c</span><span class="op" id="1452458">)</span><span class="op" id="1452459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1452462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452465">f</span><span class="op" id="1452466">.</span><span class="ident" id="1452467">pad</span><span class="op" id="1452470">(</span><span class="ident" id="1452471">quoted</span><span class="op" id="1452477">)</span><br>
<span class="lineno"></span><span class="op" id="1452479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="1452482">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1452501">func</span>&nbsp;<span class="ident" id="1452506">doPrec</span><span class="op" id="1452512">(</span><span class="ident" id="1452513">f</span>&nbsp;<span class="op" id="1452515">*</span><span class="ident" id="1452516">fmt</span><span class="op" id="1452519">,</span>&nbsp;<span class="ident" id="1452521">def</span>&nbsp;<span class="builtintype" id="1452525">int</span><span class="op" id="1452528">)</span>&nbsp;<span class="builtintype" id="1452530">int</span>&nbsp;<span class="op" id="1452534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1452537">if</span>&nbsp;<span class="ident" id="1452540">f</span><span class="op" id="1452541">.</span><span class="ident" id="1452542">precPresent</span>&nbsp;<span class="op" id="1452554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1452558">return</span>&nbsp;<span class="ident" id="1452565">f</span><span class="op" id="1452566">.</span><span class="ident" id="1452567">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1452573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1452576">return</span>&nbsp;<span class="ident" id="1452583">def</span><br>
<span class="lineno"></span><span class="op" id="1452587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1452590">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="1452691">func</span>&nbsp;<span class="op" id="1452696">(</span><span class="ident" id="1452697">f</span>&nbsp;<span class="op" id="1452699">*</span><span class="ident" id="1452700">fmt</span><span class="op" id="1452703">)</span>&nbsp;<span class="ident" id="1452705">formatFloat</span><span class="op" id="1452716">(</span><span class="ident" id="1452717">v</span>&nbsp;<span class="builtintype" id="1452719">float64</span><span class="op" id="1452726">,</span>&nbsp;<span class="ident" id="1452728">verb</span>&nbsp;<span class="builtintype" id="1452733">byte</span><span class="op" id="1452737">,</span>&nbsp;<span class="ident" id="1452739">prec</span><span class="op" id="1452743">,</span>&nbsp;<span class="ident" id="1452745">n</span>&nbsp;<span class="builtintype" id="1452747">int</span><span class="op" id="1452750">)</span>&nbsp;<span class="op" id="1452752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1452755">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452820">num</span>&nbsp;<span class="op" id="1452824">:=</span>&nbsp;<span class="ident" id="1452827">strconv</span><span class="op" id="1452834">.</span><span class="ident" id="1452835">AppendFloat</span><span class="op" id="1452846">(</span><span class="ident" id="1452847">f</span><span class="op" id="1452848">.</span><span class="ident" id="1452849">intbuf</span><span class="op" id="1452855">[</span><span class="num" id="1452856">0</span><span class="op" id="1452857">:</span><span class="num" id="1452858">1</span><span class="op" id="1452859">]</span><span class="op" id="1452860">,</span>&nbsp;<span class="ident" id="1452862">v</span><span class="op" id="1452863">,</span>&nbsp;<span class="ident" id="1452865">verb</span><span class="op" id="1452869">,</span>&nbsp;<span class="ident" id="1452871">prec</span><span class="op" id="1452875">,</span>&nbsp;<span class="ident" id="1452877">n</span><span class="op" id="1452878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1452881">if</span>&nbsp;<span class="ident" id="1452884">num</span><span class="op" id="1452887">[</span><span class="num" id="1452888">1</span><span class="op" id="1452889">]</span>&nbsp;<span class="op" id="1452891">==</span>&nbsp;<span class="string" id="1452894">&#39;-&#39;</span>&nbsp;<span class="op" id="1452898">||</span>&nbsp;<span class="ident" id="1452901">num</span><span class="op" id="1452904">[</span><span class="num" id="1452905">1</span><span class="op" id="1452906">]</span>&nbsp;<span class="op" id="1452908">==</span>&nbsp;<span class="string" id="1452911">&#39;+&#39;</span>&nbsp;<span class="op" id="1452915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452919">num</span>&nbsp;<span class="op" id="1452923">=</span>&nbsp;<span class="ident" id="1452925">num</span><span class="op" id="1452928">[</span><span class="num" id="1452929">1</span><span class="op" id="1452930">:</span><span class="op" id="1452931">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1452934">}</span>&nbsp;<span class="keyword" id="1452936">else</span>&nbsp;<span class="op" id="1452941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1452945">num</span><span class="op" id="1452948">[</span><span class="num" id="1452949">0</span><span class="op" id="1452950">]</span>&nbsp;<span class="op" id="1452952">=</span>&nbsp;<span class="string" id="1452954">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1452959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1452962">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453065">if</span>&nbsp;<span class="ident" id="1453068">math</span><span class="op" id="1453072">.</span><span class="ident" id="1453073">IsInf</span><span class="op" id="1453078">(</span><span class="ident" id="1453079">v</span><span class="op" id="1453080">,</span>&nbsp;<span class="num" id="1453082">0</span><span class="op" id="1453083">)</span>&nbsp;<span class="op" id="1453085">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453089">if</span>&nbsp;<span class="ident" id="1453092">f</span><span class="op" id="1453093">.</span><span class="ident" id="1453094">zero</span>&nbsp;<span class="op" id="1453099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453104">defer</span>&nbsp;<span class="keyword" id="1453110">func</span><span class="op" id="1453114">(</span><span class="op" id="1453115">)</span>&nbsp;<span class="op" id="1453117">{</span>&nbsp;<span class="ident" id="1453119">f</span><span class="op" id="1453120">.</span><span class="ident" id="1453121">zero</span>&nbsp;<span class="op" id="1453126">=</span>&nbsp;<span class="builtintype" id="1453128">true</span>&nbsp;<span class="op" id="1453133">}</span><span class="op" id="1453134">(</span><span class="op" id="1453135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453140">f</span><span class="op" id="1453141">.</span><span class="ident" id="1453142">zero</span>&nbsp;<span class="op" id="1453147">=</span>&nbsp;<span class="builtintype" id="1453149">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1453157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1453160">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1453163">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1453210">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1453277">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453356">if</span>&nbsp;<span class="ident" id="1453359">f</span><span class="op" id="1453360">.</span><span class="ident" id="1453361">zero</span>&nbsp;<span class="op" id="1453366">&amp;&amp;</span>&nbsp;<span class="ident" id="1453369">f</span><span class="op" id="1453370">.</span><span class="ident" id="1453371">widPresent</span>&nbsp;<span class="op" id="1453382">&amp;&amp;</span>&nbsp;<span class="ident" id="1453385">f</span><span class="op" id="1453386">.</span><span class="ident" id="1453387">wid</span>&nbsp;<span class="op" id="1453391">&gt;</span>&nbsp;<span class="builtinfunc" id="1453393">len</span><span class="op" id="1453396">(</span><span class="ident" id="1453397">num</span><span class="op" id="1453400">)</span>&nbsp;<span class="op" id="1453402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453406">if</span>&nbsp;<span class="ident" id="1453409">f</span><span class="op" id="1453410">.</span><span class="ident" id="1453411">space</span>&nbsp;<span class="op" id="1453417">&amp;&amp;</span>&nbsp;<span class="ident" id="1453420">v</span>&nbsp;<span class="op" id="1453422">&gt;=</span>&nbsp;<span class="num" id="1453425">0</span>&nbsp;<span class="op" id="1453427">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453432">f</span><span class="op" id="1453433">.</span><span class="ident" id="1453434">buf</span><span class="op" id="1453437">.</span><span class="ident" id="1453438">WriteByte</span><span class="op" id="1453447">(</span><span class="string" id="1453448">&#39;&nbsp;&#39;</span><span class="op" id="1453451">)</span>&nbsp;<span class="comment" id="1453453">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453517">f</span><span class="op" id="1453518">.</span><span class="ident" id="1453519">wid</span><span class="op" id="1453522">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1453527">}</span>&nbsp;<span class="keyword" id="1453529">else</span>&nbsp;<span class="keyword" id="1453534">if</span>&nbsp;<span class="ident" id="1453537">f</span><span class="op" id="1453538">.</span><span class="ident" id="1453539">plus</span>&nbsp;<span class="op" id="1453544">||</span>&nbsp;<span class="ident" id="1453547">v</span>&nbsp;<span class="op" id="1453549">&lt;</span>&nbsp;<span class="num" id="1453551">0</span>&nbsp;<span class="op" id="1453553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453558">f</span><span class="op" id="1453559">.</span><span class="ident" id="1453560">buf</span><span class="op" id="1453563">.</span><span class="ident" id="1453564">WriteByte</span><span class="op" id="1453573">(</span><span class="ident" id="1453574">num</span><span class="op" id="1453577">[</span><span class="num" id="1453578">0</span><span class="op" id="1453579">]</span><span class="op" id="1453580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453585">f</span><span class="op" id="1453586">.</span><span class="ident" id="1453587">wid</span><span class="op" id="1453590">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1453595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453599">f</span><span class="op" id="1453600">.</span><span class="ident" id="1453601">pad</span><span class="op" id="1453604">(</span><span class="ident" id="1453605">num</span><span class="op" id="1453608">[</span><span class="num" id="1453609">1</span><span class="op" id="1453610">:</span><span class="op" id="1453611">]</span><span class="op" id="1453612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453616">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1453624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1453627">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453681">if</span>&nbsp;<span class="ident" id="1453684">f</span><span class="op" id="1453685">.</span><span class="ident" id="1453686">space</span>&nbsp;<span class="op" id="1453692">&amp;&amp;</span>&nbsp;<span class="ident" id="1453695">num</span><span class="op" id="1453698">[</span><span class="num" id="1453699">0</span><span class="op" id="1453700">]</span>&nbsp;<span class="op" id="1453702">==</span>&nbsp;<span class="string" id="1453705">&#39;+&#39;</span>&nbsp;<span class="op" id="1453709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453713">num</span><span class="op" id="1453716">[</span><span class="num" id="1453717">0</span><span class="op" id="1453718">]</span>&nbsp;<span class="op" id="1453720">=</span>&nbsp;<span class="string" id="1453722">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453728">f</span><span class="op" id="1453729">.</span><span class="ident" id="1453730">pad</span><span class="op" id="1453733">(</span><span class="ident" id="1453734">num</span><span class="op" id="1453737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453741">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1453749">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1453752">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1453832">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453920">if</span>&nbsp;<span class="ident" id="1453923">f</span><span class="op" id="1453924">.</span><span class="ident" id="1453925">plus</span>&nbsp;<span class="op" id="1453930">||</span>&nbsp;<span class="ident" id="1453933">num</span><span class="op" id="1453936">[</span><span class="num" id="1453937">0</span><span class="op" id="1453938">]</span>&nbsp;<span class="op" id="1453940">==</span>&nbsp;<span class="string" id="1453943">&#39;-&#39;</span>&nbsp;<span class="op" id="1453947">||</span>&nbsp;<span class="ident" id="1453950">math</span><span class="op" id="1453954">.</span><span class="ident" id="1453955">IsInf</span><span class="op" id="1453960">(</span><span class="ident" id="1453961">v</span><span class="op" id="1453962">,</span>&nbsp;<span class="num" id="1453964">0</span><span class="op" id="1453965">)</span>&nbsp;<span class="op" id="1453967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1453971">f</span><span class="op" id="1453972">.</span><span class="ident" id="1453973">pad</span><span class="op" id="1453976">(</span><span class="ident" id="1453977">num</span><span class="op" id="1453980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1453984">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1453992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1453995">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1454075">f</span><span class="op" id="1454076">.</span><span class="ident" id="1454077">pad</span><span class="op" id="1454080">(</span><span class="ident" id="1454081">num</span><span class="op" id="1454084">[</span><span class="num" id="1454085">1</span><span class="op" id="1454086">:</span><span class="op" id="1454087">]</span><span class="op" id="1454088">)</span><br>
<span class="lineno"></span><span class="op" id="1454090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="1454093">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="1454145">func</span>&nbsp;<span class="op" id="1454150">(</span><span class="ident" id="1454151">f</span>&nbsp;<span class="op" id="1454153">*</span><span class="ident" id="1454154">fmt</span><span class="op" id="1454157">)</span>&nbsp;<span class="ident" id="1454159">fmt_e64</span><span class="op" id="1454166">(</span><span class="ident" id="1454167">v</span>&nbsp;<span class="builtintype" id="1454169">float64</span><span class="op" id="1454176">)</span>&nbsp;<span class="op" id="1454178">{</span>&nbsp;<span class="ident" id="1454180">f</span><span class="op" id="1454181">.</span><span class="ident" id="1454182">formatFloat</span><span class="op" id="1454193">(</span><span class="ident" id="1454194">v</span><span class="op" id="1454195">,</span>&nbsp;<span class="string" id="1454197">&#39;e&#39;</span><span class="op" id="1454200">,</span>&nbsp;<span class="ident" id="1454202">doPrec</span><span class="op" id="1454208">(</span><span class="ident" id="1454209">f</span><span class="op" id="1454210">,</span>&nbsp;<span class="num" id="1454212">6</span><span class="op" id="1454213">)</span><span class="op" id="1454214">,</span>&nbsp;<span class="num" id="1454216">64</span><span class="op" id="1454218">)</span>&nbsp;<span class="op" id="1454220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1454223">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="1454275">func</span>&nbsp;<span class="op" id="1454280">(</span><span class="ident" id="1454281">f</span>&nbsp;<span class="op" id="1454283">*</span><span class="ident" id="1454284">fmt</span><span class="op" id="1454287">)</span>&nbsp;<span class="ident" id="1454289">fmt_E64</span><span class="op" id="1454296">(</span><span class="ident" id="1454297">v</span>&nbsp;<span class="builtintype" id="1454299">float64</span><span class="op" id="1454306">)</span>&nbsp;<span class="op" id="1454308">{</span>&nbsp;<span class="ident" id="1454310">f</span><span class="op" id="1454311">.</span><span class="ident" id="1454312">formatFloat</span><span class="op" id="1454323">(</span><span class="ident" id="1454324">v</span><span class="op" id="1454325">,</span>&nbsp;<span class="string" id="1454327">&#39;E&#39;</span><span class="op" id="1454330">,</span>&nbsp;<span class="ident" id="1454332">doPrec</span><span class="op" id="1454338">(</span><span class="ident" id="1454339">f</span><span class="op" id="1454340">,</span>&nbsp;<span class="num" id="1454342">6</span><span class="op" id="1454343">)</span><span class="op" id="1454344">,</span>&nbsp;<span class="num" id="1454346">64</span><span class="op" id="1454348">)</span>&nbsp;<span class="op" id="1454350">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="1454353">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="1454401">func</span>&nbsp;<span class="op" id="1454406">(</span><span class="ident" id="1454407">f</span>&nbsp;<span class="op" id="1454409">*</span><span class="ident" id="1454410">fmt</span><span class="op" id="1454413">)</span>&nbsp;<span class="ident" id="1454415">fmt_f64</span><span class="op" id="1454422">(</span><span class="ident" id="1454423">v</span>&nbsp;<span class="builtintype" id="1454425">float64</span><span class="op" id="1454432">)</span>&nbsp;<span class="op" id="1454434">{</span>&nbsp;<span class="ident" id="1454436">f</span><span class="op" id="1454437">.</span><span class="ident" id="1454438">formatFloat</span><span class="op" id="1454449">(</span><span class="ident" id="1454450">v</span><span class="op" id="1454451">,</span>&nbsp;<span class="string" id="1454453">&#39;f&#39;</span><span class="op" id="1454456">,</span>&nbsp;<span class="ident" id="1454458">doPrec</span><span class="op" id="1454464">(</span><span class="ident" id="1454465">f</span><span class="op" id="1454466">,</span>&nbsp;<span class="num" id="1454468">6</span><span class="op" id="1454469">)</span><span class="op" id="1454470">,</span>&nbsp;<span class="num" id="1454472">64</span><span class="op" id="1454474">)</span>&nbsp;<span class="op" id="1454476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1454479">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="1454550">func</span>&nbsp;<span class="op" id="1454555">(</span><span class="ident" id="1454556">f</span>&nbsp;<span class="op" id="1454558">*</span><span class="ident" id="1454559">fmt</span><span class="op" id="1454562">)</span>&nbsp;<span class="ident" id="1454564">fmt_g64</span><span class="op" id="1454571">(</span><span class="ident" id="1454572">v</span>&nbsp;<span class="builtintype" id="1454574">float64</span><span class="op" id="1454581">)</span>&nbsp;<span class="op" id="1454583">{</span>&nbsp;<span class="ident" id="1454585">f</span><span class="op" id="1454586">.</span><span class="ident" id="1454587">formatFloat</span><span class="op" id="1454598">(</span><span class="ident" id="1454599">v</span><span class="op" id="1454600">,</span>&nbsp;<span class="string" id="1454602">&#39;g&#39;</span><span class="op" id="1454605">,</span>&nbsp;<span class="ident" id="1454607">doPrec</span><span class="op" id="1454613">(</span><span class="ident" id="1454614">f</span><span class="op" id="1454615">,</span>&nbsp;<span class="op" id="1454617">-</span><span class="num" id="1454618">1</span><span class="op" id="1454619">)</span><span class="op" id="1454620">,</span>&nbsp;<span class="num" id="1454622">64</span><span class="op" id="1454624">)</span>&nbsp;<span class="op" id="1454626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1454629">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="1454700">func</span>&nbsp;<span class="op" id="1454705">(</span><span class="ident" id="1454706">f</span>&nbsp;<span class="op" id="1454708">*</span><span class="ident" id="1454709">fmt</span><span class="op" id="1454712">)</span>&nbsp;<span class="ident" id="1454714">fmt_G64</span><span class="op" id="1454721">(</span><span class="ident" id="1454722">v</span>&nbsp;<span class="builtintype" id="1454724">float64</span><span class="op" id="1454731">)</span>&nbsp;<span class="op" id="1454733">{</span>&nbsp;<span class="ident" id="1454735">f</span><span class="op" id="1454736">.</span><span class="ident" id="1454737">formatFloat</span><span class="op" id="1454748">(</span><span class="ident" id="1454749">v</span><span class="op" id="1454750">,</span>&nbsp;<span class="string" id="1454752">&#39;G&#39;</span><span class="op" id="1454755">,</span>&nbsp;<span class="ident" id="1454757">doPrec</span><span class="op" id="1454763">(</span><span class="ident" id="1454764">f</span><span class="op" id="1454765">,</span>&nbsp;<span class="op" id="1454767">-</span><span class="num" id="1454768">1</span><span class="op" id="1454769">)</span><span class="op" id="1454770">,</span>&nbsp;<span class="num" id="1454772">64</span><span class="op" id="1454774">)</span>&nbsp;<span class="op" id="1454776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="1454779">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="1454854">func</span>&nbsp;<span class="op" id="1454859">(</span><span class="ident" id="1454860">f</span>&nbsp;<span class="op" id="1454862">*</span><span class="ident" id="1454863">fmt</span><span class="op" id="1454866">)</span>&nbsp;<span class="ident" id="1454868">fmt_fb64</span><span class="op" id="1454876">(</span><span class="ident" id="1454877">v</span>&nbsp;<span class="builtintype" id="1454879">float64</span><span class="op" id="1454886">)</span>&nbsp;<span class="op" id="1454888">{</span>&nbsp;<span class="ident" id="1454890">f</span><span class="op" id="1454891">.</span><span class="ident" id="1454892">formatFloat</span><span class="op" id="1454903">(</span><span class="ident" id="1454904">v</span><span class="op" id="1454905">,</span>&nbsp;<span class="string" id="1454907">&#39;b&#39;</span><span class="op" id="1454910">,</span>&nbsp;<span class="num" id="1454912">0</span><span class="op" id="1454913">,</span>&nbsp;<span class="num" id="1454915">64</span><span class="op" id="1454917">)</span>&nbsp;<span class="op" id="1454919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1454922">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="1454933">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="1454969">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1455025">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="1455077">func</span>&nbsp;<span class="op" id="1455082">(</span><span class="ident" id="1455083">f</span>&nbsp;<span class="op" id="1455085">*</span><span class="ident" id="1455086">fmt</span><span class="op" id="1455089">)</span>&nbsp;<span class="ident" id="1455091">fmt_e32</span><span class="op" id="1455098">(</span><span class="ident" id="1455099">v</span>&nbsp;<span class="builtintype" id="1455101">float32</span><span class="op" id="1455108">)</span>&nbsp;<span class="op" id="1455110">{</span>&nbsp;<span class="ident" id="1455112">f</span><span class="op" id="1455113">.</span><span class="ident" id="1455114">formatFloat</span><span class="op" id="1455125">(</span><span class="builtintype" id="1455126">float64</span><span class="op" id="1455133">(</span><span class="ident" id="1455134">v</span><span class="op" id="1455135">)</span><span class="op" id="1455136">,</span>&nbsp;<span class="string" id="1455138">&#39;e&#39;</span><span class="op" id="1455141">,</span>&nbsp;<span class="ident" id="1455143">doPrec</span><span class="op" id="1455149">(</span><span class="ident" id="1455150">f</span><span class="op" id="1455151">,</span>&nbsp;<span class="num" id="1455153">6</span><span class="op" id="1455154">)</span><span class="op" id="1455155">,</span>&nbsp;<span class="num" id="1455157">32</span><span class="op" id="1455159">)</span>&nbsp;<span class="op" id="1455161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="1455164">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="1455216">func</span>&nbsp;<span class="op" id="1455221">(</span><span class="ident" id="1455222">f</span>&nbsp;<span class="op" id="1455224">*</span><span class="ident" id="1455225">fmt</span><span class="op" id="1455228">)</span>&nbsp;<span class="ident" id="1455230">fmt_E32</span><span class="op" id="1455237">(</span><span class="ident" id="1455238">v</span>&nbsp;<span class="builtintype" id="1455240">float32</span><span class="op" id="1455247">)</span>&nbsp;<span class="op" id="1455249">{</span>&nbsp;<span class="ident" id="1455251">f</span><span class="op" id="1455252">.</span><span class="ident" id="1455253">formatFloat</span><span class="op" id="1455264">(</span><span class="builtintype" id="1455265">float64</span><span class="op" id="1455272">(</span><span class="ident" id="1455273">v</span><span class="op" id="1455274">)</span><span class="op" id="1455275">,</span>&nbsp;<span class="string" id="1455277">&#39;E&#39;</span><span class="op" id="1455280">,</span>&nbsp;<span class="ident" id="1455282">doPrec</span><span class="op" id="1455288">(</span><span class="ident" id="1455289">f</span><span class="op" id="1455290">,</span>&nbsp;<span class="num" id="1455292">6</span><span class="op" id="1455293">)</span><span class="op" id="1455294">,</span>&nbsp;<span class="num" id="1455296">32</span><span class="op" id="1455298">)</span>&nbsp;<span class="op" id="1455300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1455303">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="1455351">func</span>&nbsp;<span class="op" id="1455356">(</span><span class="ident" id="1455357">f</span>&nbsp;<span class="op" id="1455359">*</span><span class="ident" id="1455360">fmt</span><span class="op" id="1455363">)</span>&nbsp;<span class="ident" id="1455365">fmt_f32</span><span class="op" id="1455372">(</span><span class="ident" id="1455373">v</span>&nbsp;<span class="builtintype" id="1455375">float32</span><span class="op" id="1455382">)</span>&nbsp;<span class="op" id="1455384">{</span>&nbsp;<span class="ident" id="1455386">f</span><span class="op" id="1455387">.</span><span class="ident" id="1455388">formatFloat</span><span class="op" id="1455399">(</span><span class="builtintype" id="1455400">float64</span><span class="op" id="1455407">(</span><span class="ident" id="1455408">v</span><span class="op" id="1455409">)</span><span class="op" id="1455410">,</span>&nbsp;<span class="string" id="1455412">&#39;f&#39;</span><span class="op" id="1455415">,</span>&nbsp;<span class="ident" id="1455417">doPrec</span><span class="op" id="1455423">(</span><span class="ident" id="1455424">f</span><span class="op" id="1455425">,</span>&nbsp;<span class="num" id="1455427">6</span><span class="op" id="1455428">)</span><span class="op" id="1455429">,</span>&nbsp;<span class="num" id="1455431">32</span><span class="op" id="1455433">)</span>&nbsp;<span class="op" id="1455435">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="1455438">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="1455509">func</span>&nbsp;<span class="op" id="1455514">(</span><span class="ident" id="1455515">f</span>&nbsp;<span class="op" id="1455517">*</span><span class="ident" id="1455518">fmt</span><span class="op" id="1455521">)</span>&nbsp;<span class="ident" id="1455523">fmt_g32</span><span class="op" id="1455530">(</span><span class="ident" id="1455531">v</span>&nbsp;<span class="builtintype" id="1455533">float32</span><span class="op" id="1455540">)</span>&nbsp;<span class="op" id="1455542">{</span>&nbsp;<span class="ident" id="1455544">f</span><span class="op" id="1455545">.</span><span class="ident" id="1455546">formatFloat</span><span class="op" id="1455557">(</span><span class="builtintype" id="1455558">float64</span><span class="op" id="1455565">(</span><span class="ident" id="1455566">v</span><span class="op" id="1455567">)</span><span class="op" id="1455568">,</span>&nbsp;<span class="string" id="1455570">&#39;g&#39;</span><span class="op" id="1455573">,</span>&nbsp;<span class="ident" id="1455575">doPrec</span><span class="op" id="1455581">(</span><span class="ident" id="1455582">f</span><span class="op" id="1455583">,</span>&nbsp;<span class="op" id="1455585">-</span><span class="num" id="1455586">1</span><span class="op" id="1455587">)</span><span class="op" id="1455588">,</span>&nbsp;<span class="num" id="1455590">32</span><span class="op" id="1455592">)</span>&nbsp;<span class="op" id="1455594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1455597">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="1455668">func</span>&nbsp;<span class="op" id="1455673">(</span><span class="ident" id="1455674">f</span>&nbsp;<span class="op" id="1455676">*</span><span class="ident" id="1455677">fmt</span><span class="op" id="1455680">)</span>&nbsp;<span class="ident" id="1455682">fmt_G32</span><span class="op" id="1455689">(</span><span class="ident" id="1455690">v</span>&nbsp;<span class="builtintype" id="1455692">float32</span><span class="op" id="1455699">)</span>&nbsp;<span class="op" id="1455701">{</span>&nbsp;<span class="ident" id="1455703">f</span><span class="op" id="1455704">.</span><span class="ident" id="1455705">formatFloat</span><span class="op" id="1455716">(</span><span class="builtintype" id="1455717">float64</span><span class="op" id="1455724">(</span><span class="ident" id="1455725">v</span><span class="op" id="1455726">)</span><span class="op" id="1455727">,</span>&nbsp;<span class="string" id="1455729">&#39;G&#39;</span><span class="op" id="1455732">,</span>&nbsp;<span class="ident" id="1455734">doPrec</span><span class="op" id="1455740">(</span><span class="ident" id="1455741">f</span><span class="op" id="1455742">,</span>&nbsp;<span class="op" id="1455744">-</span><span class="num" id="1455745">1</span><span class="op" id="1455746">)</span><span class="op" id="1455747">,</span>&nbsp;<span class="num" id="1455749">32</span><span class="op" id="1455751">)</span>&nbsp;<span class="op" id="1455753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1455756">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="1455831">func</span>&nbsp;<span class="op" id="1455836">(</span><span class="ident" id="1455837">f</span>&nbsp;<span class="op" id="1455839">*</span><span class="ident" id="1455840">fmt</span><span class="op" id="1455843">)</span>&nbsp;<span class="ident" id="1455845">fmt_fb32</span><span class="op" id="1455853">(</span><span class="ident" id="1455854">v</span>&nbsp;<span class="builtintype" id="1455856">float32</span><span class="op" id="1455863">)</span>&nbsp;<span class="op" id="1455865">{</span>&nbsp;<span class="ident" id="1455867">f</span><span class="op" id="1455868">.</span><span class="ident" id="1455869">formatFloat</span><span class="op" id="1455880">(</span><span class="builtintype" id="1455881">float64</span><span class="op" id="1455888">(</span><span class="ident" id="1455889">v</span><span class="op" id="1455890">)</span><span class="op" id="1455891">,</span>&nbsp;<span class="string" id="1455893">&#39;b&#39;</span><span class="op" id="1455896">,</span>&nbsp;<span class="num" id="1455898">0</span><span class="op" id="1455899">,</span>&nbsp;<span class="num" id="1455901">32</span><span class="op" id="1455903">)</span>&nbsp;<span class="op" id="1455905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1455908">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="1455962">func</span>&nbsp;<span class="op" id="1455967">(</span><span class="ident" id="1455968">f</span>&nbsp;<span class="op" id="1455970">*</span><span class="ident" id="1455971">fmt</span><span class="op" id="1455974">)</span>&nbsp;<span class="ident" id="1455976">fmt_c64</span><span class="op" id="1455983">(</span><span class="ident" id="1455984">v</span>&nbsp;<span class="builtintype" id="1455986">complex64</span><span class="op" id="1455995">,</span>&nbsp;<span class="ident" id="1455997">verb</span>&nbsp;<span class="builtintype" id="1456002">rune</span><span class="op" id="1456006">)</span>&nbsp;<span class="op" id="1456008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456011">f</span><span class="op" id="1456012">.</span><span class="ident" id="1456013">fmt_complex</span><span class="op" id="1456024">(</span><span class="builtintype" id="1456025">float64</span><span class="op" id="1456032">(</span><span class="builtinfunc" id="1456033">real</span><span class="op" id="1456037">(</span><span class="ident" id="1456038">v</span><span class="op" id="1456039">)</span><span class="op" id="1456040">)</span><span class="op" id="1456041">,</span>&nbsp;<span class="builtintype" id="1456043">float64</span><span class="op" id="1456050">(</span><span class="builtinfunc" id="1456051">imag</span><span class="op" id="1456055">(</span><span class="ident" id="1456056">v</span><span class="op" id="1456057">)</span><span class="op" id="1456058">)</span><span class="op" id="1456059">,</span>&nbsp;<span class="num" id="1456061">32</span><span class="op" id="1456063">,</span>&nbsp;<span class="ident" id="1456065">verb</span><span class="op" id="1456069">)</span><br>
<span class="lineno"></span><span class="op" id="1456071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="1456074">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="1456130">func</span>&nbsp;<span class="op" id="1456135">(</span><span class="ident" id="1456136">f</span>&nbsp;<span class="op" id="1456138">*</span><span class="ident" id="1456139">fmt</span><span class="op" id="1456142">)</span>&nbsp;<span class="ident" id="1456144">fmt_c128</span><span class="op" id="1456152">(</span><span class="ident" id="1456153">v</span>&nbsp;<span class="builtintype" id="1456155">complex128</span><span class="op" id="1456165">,</span>&nbsp;<span class="ident" id="1456167">verb</span>&nbsp;<span class="builtintype" id="1456172">rune</span><span class="op" id="1456176">)</span>&nbsp;<span class="op" id="1456178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456181">f</span><span class="op" id="1456182">.</span><span class="ident" id="1456183">fmt_complex</span><span class="op" id="1456194">(</span><span class="builtinfunc" id="1456195">real</span><span class="op" id="1456199">(</span><span class="ident" id="1456200">v</span><span class="op" id="1456201">)</span><span class="op" id="1456202">,</span>&nbsp;<span class="builtinfunc" id="1456204">imag</span><span class="op" id="1456208">(</span><span class="ident" id="1456209">v</span><span class="op" id="1456210">)</span><span class="op" id="1456211">,</span>&nbsp;<span class="num" id="1456213">64</span><span class="op" id="1456215">,</span>&nbsp;<span class="ident" id="1456217">verb</span><span class="op" id="1456221">)</span><br>
<span class="lineno"></span><span class="op" id="1456223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="1456226">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="1456277">func</span>&nbsp;<span class="op" id="1456282">(</span><span class="ident" id="1456283">f</span>&nbsp;<span class="op" id="1456285">*</span><span class="ident" id="1456286">fmt</span><span class="op" id="1456289">)</span>&nbsp;<span class="ident" id="1456291">fmt_complex</span><span class="op" id="1456302">(</span><span class="ident" id="1456303">r</span><span class="op" id="1456304">,</span>&nbsp;<span class="ident" id="1456306">j</span>&nbsp;<span class="builtintype" id="1456308">float64</span><span class="op" id="1456315">,</span>&nbsp;<span class="ident" id="1456317">size</span>&nbsp;<span class="builtintype" id="1456322">int</span><span class="op" id="1456325">,</span>&nbsp;<span class="ident" id="1456327">verb</span>&nbsp;<span class="builtintype" id="1456332">rune</span><span class="op" id="1456336">)</span>&nbsp;<span class="op" id="1456338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456341">f</span><span class="op" id="1456342">.</span><span class="ident" id="1456343">buf</span><span class="op" id="1456346">.</span><span class="ident" id="1456347">WriteByte</span><span class="op" id="1456356">(</span><span class="string" id="1456357">&#39;(&#39;</span><span class="op" id="1456360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456363">oldPlus</span>&nbsp;<span class="op" id="1456371">:=</span>&nbsp;<span class="ident" id="1456374">f</span><span class="op" id="1456375">.</span><span class="ident" id="1456376">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456382">oldSpace</span>&nbsp;<span class="op" id="1456391">:=</span>&nbsp;<span class="ident" id="1456394">f</span><span class="op" id="1456395">.</span><span class="ident" id="1456396">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456403">oldWid</span>&nbsp;<span class="op" id="1456410">:=</span>&nbsp;<span class="ident" id="1456413">f</span><span class="op" id="1456414">.</span><span class="ident" id="1456415">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456420">for</span>&nbsp;<span class="ident" id="1456424">i</span>&nbsp;<span class="op" id="1456426">:=</span>&nbsp;<span class="num" id="1456429">0</span><span class="op" id="1456430">;</span>&nbsp;<span class="op" id="1456432">;</span>&nbsp;<span class="ident" id="1456434">i</span><span class="op" id="1456435">++</span>&nbsp;<span class="op" id="1456438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456442">switch</span>&nbsp;<span class="ident" id="1456449">verb</span>&nbsp;<span class="op" id="1456454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456458">case</span>&nbsp;<span class="string" id="1456463">&#39;b&#39;</span><span class="op" id="1456466">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456471">f</span><span class="op" id="1456472">.</span><span class="ident" id="1456473">formatFloat</span><span class="op" id="1456484">(</span><span class="ident" id="1456485">r</span><span class="op" id="1456486">,</span>&nbsp;<span class="string" id="1456488">&#39;b&#39;</span><span class="op" id="1456491">,</span>&nbsp;<span class="num" id="1456493">0</span><span class="op" id="1456494">,</span>&nbsp;<span class="ident" id="1456496">size</span><span class="op" id="1456500">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456504">case</span>&nbsp;<span class="string" id="1456509">&#39;e&#39;</span><span class="op" id="1456512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456517">f</span><span class="op" id="1456518">.</span><span class="ident" id="1456519">formatFloat</span><span class="op" id="1456530">(</span><span class="ident" id="1456531">r</span><span class="op" id="1456532">,</span>&nbsp;<span class="string" id="1456534">&#39;e&#39;</span><span class="op" id="1456537">,</span>&nbsp;<span class="ident" id="1456539">doPrec</span><span class="op" id="1456545">(</span><span class="ident" id="1456546">f</span><span class="op" id="1456547">,</span>&nbsp;<span class="num" id="1456549">6</span><span class="op" id="1456550">)</span><span class="op" id="1456551">,</span>&nbsp;<span class="ident" id="1456553">size</span><span class="op" id="1456557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456561">case</span>&nbsp;<span class="string" id="1456566">&#39;E&#39;</span><span class="op" id="1456569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456574">f</span><span class="op" id="1456575">.</span><span class="ident" id="1456576">formatFloat</span><span class="op" id="1456587">(</span><span class="ident" id="1456588">r</span><span class="op" id="1456589">,</span>&nbsp;<span class="string" id="1456591">&#39;E&#39;</span><span class="op" id="1456594">,</span>&nbsp;<span class="ident" id="1456596">doPrec</span><span class="op" id="1456602">(</span><span class="ident" id="1456603">f</span><span class="op" id="1456604">,</span>&nbsp;<span class="num" id="1456606">6</span><span class="op" id="1456607">)</span><span class="op" id="1456608">,</span>&nbsp;<span class="ident" id="1456610">size</span><span class="op" id="1456614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456618">case</span>&nbsp;<span class="string" id="1456623">&#39;f&#39;</span><span class="op" id="1456626">,</span>&nbsp;<span class="string" id="1456628">&#39;F&#39;</span><span class="op" id="1456631">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456636">f</span><span class="op" id="1456637">.</span><span class="ident" id="1456638">formatFloat</span><span class="op" id="1456649">(</span><span class="ident" id="1456650">r</span><span class="op" id="1456651">,</span>&nbsp;<span class="string" id="1456653">&#39;f&#39;</span><span class="op" id="1456656">,</span>&nbsp;<span class="ident" id="1456658">doPrec</span><span class="op" id="1456664">(</span><span class="ident" id="1456665">f</span><span class="op" id="1456666">,</span>&nbsp;<span class="num" id="1456668">6</span><span class="op" id="1456669">)</span><span class="op" id="1456670">,</span>&nbsp;<span class="ident" id="1456672">size</span><span class="op" id="1456676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456680">case</span>&nbsp;<span class="string" id="1456685">&#39;g&#39;</span><span class="op" id="1456688">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456693">f</span><span class="op" id="1456694">.</span><span class="ident" id="1456695">formatFloat</span><span class="op" id="1456706">(</span><span class="ident" id="1456707">r</span><span class="op" id="1456708">,</span>&nbsp;<span class="string" id="1456710">&#39;g&#39;</span><span class="op" id="1456713">,</span>&nbsp;<span class="ident" id="1456715">doPrec</span><span class="op" id="1456721">(</span><span class="ident" id="1456722">f</span><span class="op" id="1456723">,</span>&nbsp;<span class="op" id="1456725">-</span><span class="num" id="1456726">1</span><span class="op" id="1456727">)</span><span class="op" id="1456728">,</span>&nbsp;<span class="ident" id="1456730">size</span><span class="op" id="1456734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456738">case</span>&nbsp;<span class="string" id="1456743">&#39;G&#39;</span><span class="op" id="1456746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456751">f</span><span class="op" id="1456752">.</span><span class="ident" id="1456753">formatFloat</span><span class="op" id="1456764">(</span><span class="ident" id="1456765">r</span><span class="op" id="1456766">,</span>&nbsp;<span class="string" id="1456768">&#39;G&#39;</span><span class="op" id="1456771">,</span>&nbsp;<span class="ident" id="1456773">doPrec</span><span class="op" id="1456779">(</span><span class="ident" id="1456780">f</span><span class="op" id="1456781">,</span>&nbsp;<span class="op" id="1456783">-</span><span class="num" id="1456784">1</span><span class="op" id="1456785">)</span><span class="op" id="1456786">,</span>&nbsp;<span class="ident" id="1456788">size</span><span class="op" id="1456792">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1456796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456800">if</span>&nbsp;<span class="ident" id="1456803">i</span>&nbsp;<span class="op" id="1456805">!=</span>&nbsp;<span class="num" id="1456808">0</span>&nbsp;<span class="op" id="1456810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1456815">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1456823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1456827">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456866">f</span><span class="op" id="1456867">.</span><span class="ident" id="1456868">plus</span>&nbsp;<span class="op" id="1456873">=</span>&nbsp;<span class="builtintype" id="1456875">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456882">f</span><span class="op" id="1456883">.</span><span class="ident" id="1456884">space</span>&nbsp;<span class="op" id="1456890">=</span>&nbsp;<span class="builtintype" id="1456892">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456900">f</span><span class="op" id="1456901">.</span><span class="ident" id="1456902">wid</span>&nbsp;<span class="op" id="1456906">=</span>&nbsp;<span class="ident" id="1456908">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456917">r</span>&nbsp;<span class="op" id="1456919">=</span>&nbsp;<span class="ident" id="1456921">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1456924">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456927">f</span><span class="op" id="1456928">.</span><span class="ident" id="1456929">space</span>&nbsp;<span class="op" id="1456935">=</span>&nbsp;<span class="ident" id="1456937">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456947">f</span><span class="op" id="1456948">.</span><span class="ident" id="1456949">plus</span>&nbsp;<span class="op" id="1456954">=</span>&nbsp;<span class="ident" id="1456956">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456965">f</span><span class="op" id="1456966">.</span><span class="ident" id="1456967">wid</span>&nbsp;<span class="op" id="1456971">=</span>&nbsp;<span class="ident" id="1456973">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456981">f</span><span class="op" id="1456982">.</span><span class="ident" id="1456983">buf</span><span class="op" id="1456986">.</span><span class="ident" id="1456987">Write</span><span class="op" id="1456992">(</span><span class="ident" id="1456993">irparenBytes</span><span class="op" id="1457005">)</span><br>
<span class="lineno"></span><span class="op" id="1457007">}</span>
</div>
</body>
</html>
