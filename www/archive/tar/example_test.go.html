<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="56">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="110">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="161">package</span>&nbsp;<span class="ident" id="169">tar_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="179">import</span>&nbsp;<span class="op" id="186">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="189">&#34;archive/tar&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="204">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="213">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="220">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="226">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="233">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="238">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="241">func</span>&nbsp;<span class="ident" id="246">Example</span><span class="op" id="253">(</span><span class="op" id="254">)</span>&nbsp;<span class="op" id="256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="259">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;to&nbsp;write&nbsp;our&nbsp;archive&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="304">buf</span>&nbsp;<span class="op" id="308">:=</span>&nbsp;<span class="builtinfunc" id="311">new</span><span class="op" id="314">(</span><span class="ident" id="315"><a href="/archive/tar/example_test.go.html#204">bytes</a></span><span class="op" id="320">.</span><span class="ident" id="321">Buffer</span><span class="op" id="327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="331">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="361">tw</span>&nbsp;<span class="op" id="364">:=</span>&nbsp;<span class="ident" id="367"><a href="/archive/tar/example_test.go.html#189">tar</a></span><span class="op" id="370">.</span><span class="ident" id="371">NewWriter</span><span class="op" id="380">(</span><span class="ident" id="381"><a href="/archive/tar/example_test.go.html#304">buf</a></span><span class="op" id="384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="388">//&nbsp;Add&nbsp;some&nbsp;files&nbsp;to&nbsp;the&nbsp;archive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="423">var</span>&nbsp;<span class="ident" id="427">files</span>&nbsp;<span class="op" id="433">=</span>&nbsp;<span class="op" id="435">[</span><span class="op" id="436">]</span><span class="keyword" id="437">struct</span>&nbsp;<span class="op" id="444">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="448">Name</span><span class="op" id="452">,</span>&nbsp;<span class="ident" id="454">Body</span>&nbsp;<span class="builtintype" id="459">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="467">}</span><span class="op" id="468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="472">{</span><span class="string" id="473">&#34;readme.txt&#34;</span><span class="op" id="485">,</span>&nbsp;<span class="string" id="487">&#34;This&nbsp;archive&nbsp;contains&nbsp;some&nbsp;text&nbsp;files.&#34;</span><span class="op" id="527">}</span><span class="op" id="528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="532">{</span><span class="string" id="533">&#34;gopher.txt&#34;</span><span class="op" id="545">,</span>&nbsp;<span class="string" id="547">&#34;Gopher&nbsp;names:\nGeorge\nGeoffrey\nGonzo&#34;</span><span class="op" id="587">}</span><span class="op" id="588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="592">{</span><span class="string" id="593">&#34;todo.txt&#34;</span><span class="op" id="603">,</span>&nbsp;<span class="string" id="605">&#34;Get&nbsp;animal&nbsp;handling&nbsp;licence.&#34;</span><span class="op" id="635">}</span><span class="op" id="636">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="642">for</span>&nbsp;<span class="ident" id="646">_</span><span class="op" id="647">,</span>&nbsp;<span class="ident" id="649">file</span>&nbsp;<span class="op" id="654">:=</span>&nbsp;<span class="keyword" id="657">range</span>&nbsp;<span class="ident" id="663"><a href="/archive/tar/example_test.go.html#427">files</a></span>&nbsp;<span class="op" id="669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673">hdr</span>&nbsp;<span class="op" id="677">:=</span>&nbsp;<span class="op" id="680">&amp;</span><span class="ident" id="681"><a href="/archive/tar/example_test.go.html#189">tar</a></span><span class="op" id="684">.</span><span class="ident" id="685">Header</span><span class="op" id="691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="696">Name</span><span class="op" id="700">:</span>&nbsp;<span class="ident" id="702"><a href="/archive/tar/example_test.go.html#649">file</a></span><span class="op" id="706">.</span><span class="ident" id="707">Name</span><span class="op" id="711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="716">Size</span><span class="op" id="720">:</span>&nbsp;<span class="ident" id="722">int64</span><span class="op" id="727">(</span><span class="builtinfunc" id="728">len</span><span class="op" id="731">(</span><span class="ident" id="732"><a href="/archive/tar/example_test.go.html#649">file</a></span><span class="op" id="736">.</span><span class="ident" id="737">Body</span><span class="op" id="741">)</span><span class="op" id="742">)</span><span class="op" id="743">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="751">if</span>&nbsp;<span class="ident" id="754">err</span>&nbsp;<span class="op" id="758">:=</span>&nbsp;<span class="ident" id="761"><a href="/archive/tar/example_test.go.html#361">tw</a></span><span class="op" id="763">.</span><span class="ident" id="764">WriteHeader</span><span class="op" id="775">(</span><span class="ident" id="776"><a href="/archive/tar/example_test.go.html#673">hdr</a></span><span class="op" id="779">)</span><span class="op" id="780">;</span>&nbsp;<span class="ident" id="782"><a href="/archive/tar/example_test.go.html#754">err</a></span>&nbsp;<span class="op" id="786">!=</span>&nbsp;<span class="ident" id="789">nil</span>&nbsp;<span class="op" id="793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="798"><a href="/archive/tar/example_test.go.html#226">log</a></span><span class="op" id="801">.</span><span class="ident" id="802">Fatalln</span><span class="op" id="809">(</span><span class="ident" id="810"><a href="/archive/tar/example_test.go.html#754">err</a></span><span class="op" id="813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="821">if</span>&nbsp;<span class="ident" id="824">_</span><span class="op" id="825">,</span>&nbsp;<span class="ident" id="827">err</span>&nbsp;<span class="op" id="831">:=</span>&nbsp;<span class="ident" id="834"><a href="/archive/tar/example_test.go.html#361">tw</a></span><span class="op" id="836">.</span><span class="ident" id="837">Write</span><span class="op" id="842">(</span><span class="op" id="843">[</span><span class="op" id="844">]</span><span class="builtintype" id="845">byte</span><span class="op" id="849">(</span><span class="ident" id="850"><a href="/archive/tar/example_test.go.html#649">file</a></span><span class="op" id="854">.</span><span class="ident" id="855">Body</span><span class="op" id="859">)</span><span class="op" id="860">)</span><span class="op" id="861">;</span>&nbsp;<span class="ident" id="863"><a href="/archive/tar/example_test.go.html#827">err</a></span>&nbsp;<span class="op" id="867">!=</span>&nbsp;<span class="ident" id="870">nil</span>&nbsp;<span class="op" id="874">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="879"><a href="/archive/tar/example_test.go.html#226">log</a></span><span class="op" id="882">.</span><span class="ident" id="883">Fatalln</span><span class="op" id="890">(</span><span class="ident" id="891"><a href="/archive/tar/example_test.go.html#827">err</a></span><span class="op" id="894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="904">//&nbsp;Make&nbsp;sure&nbsp;to&nbsp;check&nbsp;the&nbsp;error&nbsp;on&nbsp;Close.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="947">if</span>&nbsp;<span class="ident" id="950">err</span>&nbsp;<span class="op" id="954">:=</span>&nbsp;<span class="ident" id="957"><a href="/archive/tar/example_test.go.html#361">tw</a></span><span class="op" id="959">.</span><span class="ident" id="960">Close</span><span class="op" id="965">(</span><span class="op" id="966">)</span><span class="op" id="967">;</span>&nbsp;<span class="ident" id="969"><a href="/archive/tar/example_test.go.html#950">err</a></span>&nbsp;<span class="op" id="973">!=</span>&nbsp;<span class="ident" id="976">nil</span>&nbsp;<span class="op" id="980">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="984"><a href="/archive/tar/example_test.go.html#226">log</a></span><span class="op" id="987">.</span><span class="ident" id="988">Fatalln</span><span class="op" id="995">(</span><span class="ident" id="996"><a href="/archive/tar/example_test.go.html#950">err</a></span><span class="op" id="999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1006">//&nbsp;Open&nbsp;the&nbsp;tar&nbsp;archive&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1044">r</span>&nbsp;<span class="op" id="1046">:=</span>&nbsp;<span class="ident" id="1049"><a href="/archive/tar/example_test.go.html#204">bytes</a></span><span class="op" id="1054">.</span><span class="ident" id="1055">NewReader</span><span class="op" id="1064">(</span><span class="ident" id="1065"><a href="/archive/tar/example_test.go.html#304">buf</a></span><span class="op" id="1068">.</span><span class="ident" id="1069">Bytes</span><span class="op" id="1074">(</span><span class="op" id="1075">)</span><span class="op" id="1076">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1079">tr</span>&nbsp;<span class="op" id="1082">:=</span>&nbsp;<span class="ident" id="1085"><a href="/archive/tar/example_test.go.html#189">tar</a></span><span class="op" id="1088">.</span><span class="ident" id="1089">NewReader</span><span class="op" id="1098">(</span><span class="ident" id="1099"><a href="/archive/tar/example_test.go.html#1044">r</a></span><span class="op" id="1100">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1104">//&nbsp;Iterate&nbsp;through&nbsp;the&nbsp;files&nbsp;in&nbsp;the&nbsp;archive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1150">for</span>&nbsp;<span class="op" id="1154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1158">hdr</span><span class="op" id="1161">,</span>&nbsp;<span class="ident" id="1163">err</span>&nbsp;<span class="op" id="1167">:=</span>&nbsp;<span class="ident" id="1170"><a href="/archive/tar/example_test.go.html#1079">tr</a></span><span class="op" id="1172">.</span><span class="ident" id="1173">Next</span><span class="op" id="1177">(</span><span class="op" id="1178">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1182">if</span>&nbsp;<span class="ident" id="1185"><a href="/archive/tar/example_test.go.html#1163">err</a></span>&nbsp;<span class="op" id="1189">==</span>&nbsp;<span class="ident" id="1192"><a href="/archive/tar/example_test.go.html#220">io</a></span><span class="op" id="1194">.</span><span class="ident" id="1195">EOF</span>&nbsp;<span class="op" id="1199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1204">//&nbsp;end&nbsp;of&nbsp;tar&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1229">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1241">if</span>&nbsp;<span class="ident" id="1244"><a href="/archive/tar/example_test.go.html#1163">err</a></span>&nbsp;<span class="op" id="1248">!=</span>&nbsp;<span class="ident" id="1251">nil</span>&nbsp;<span class="op" id="1255">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1260"><a href="/archive/tar/example_test.go.html#226">log</a></span><span class="op" id="1263">.</span><span class="ident" id="1264">Fatalln</span><span class="op" id="1271">(</span><span class="ident" id="1272"><a href="/archive/tar/example_test.go.html#1163">err</a></span><span class="op" id="1275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1283"><a href="/archive/tar/example_test.go.html#213">fmt</a></span><span class="op" id="1286">.</span><span class="ident" id="1287">Printf</span><span class="op" id="1293">(</span><span class="string" id="1294">&#34;Contents&nbsp;of&nbsp;%s:\n&#34;</span><span class="op" id="1313">,</span>&nbsp;<span class="ident" id="1315"><a href="/archive/tar/example_test.go.html#1158">hdr</a></span><span class="op" id="1318">.</span><span class="ident" id="1319">Name</span><span class="op" id="1323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1327">if</span>&nbsp;<span class="ident" id="1330">_</span><span class="op" id="1331">,</span>&nbsp;<span class="ident" id="1333">err</span>&nbsp;<span class="op" id="1337">:=</span>&nbsp;<span class="ident" id="1340"><a href="/archive/tar/example_test.go.html#220">io</a></span><span class="op" id="1342">.</span><span class="ident" id="1343">Copy</span><span class="op" id="1347">(</span><span class="ident" id="1348"><a href="/archive/tar/example_test.go.html#233">os</a></span><span class="op" id="1350">.</span><span class="ident" id="1351">Stdout</span><span class="op" id="1357">,</span>&nbsp;<span class="ident" id="1359"><a href="/archive/tar/example_test.go.html#1079">tr</a></span><span class="op" id="1361">)</span><span class="op" id="1362">;</span>&nbsp;<span class="ident" id="1364"><a href="/archive/tar/example_test.go.html#1333">err</a></span>&nbsp;<span class="op" id="1368">!=</span>&nbsp;<span class="ident" id="1371">nil</span>&nbsp;<span class="op" id="1375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1380"><a href="/archive/tar/example_test.go.html#226">log</a></span><span class="op" id="1383">.</span><span class="ident" id="1384">Fatalln</span><span class="op" id="1391">(</span><span class="ident" id="1392"><a href="/archive/tar/example_test.go.html#1333">err</a></span><span class="op" id="1395">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403"><a href="/archive/tar/example_test.go.html#213">fmt</a></span><span class="op" id="1406">.</span><span class="ident" id="1407">Println</span><span class="op" id="1414">(</span><span class="op" id="1415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1422">//&nbsp;Output:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1434">//&nbsp;Contents&nbsp;of&nbsp;readme.txt:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1462">//&nbsp;This&nbsp;archive&nbsp;contains&nbsp;some&nbsp;text&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1505">//&nbsp;Contents&nbsp;of&nbsp;gopher.txt:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1533">//&nbsp;Gopher&nbsp;names:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1551">//&nbsp;George</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1562">//&nbsp;Geoffrey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1575">//&nbsp;Gonzo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1585">//&nbsp;Contents&nbsp;of&nbsp;todo.txt:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1611">//&nbsp;Get&nbsp;animal&nbsp;handling&nbsp;licence.</span><br>
<span class="lineno"></span><span class="op" id="1643">}</span>
</div>
</body>
</html>
