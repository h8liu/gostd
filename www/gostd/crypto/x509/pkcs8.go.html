<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html" class="current">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4690663">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4690718">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4690772">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4690823">package</span>&nbsp;<span class="ident" id="4690831">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4690837">import</span>&nbsp;<span class="op" id="4690844">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4690847">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4690867">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4690884">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4690894">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4690900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4690903">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="4690954">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="4691014">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4691030">type</span>&nbsp;<span class="ident" id="4691035">pkcs8</span>&nbsp;<span class="keyword" id="4691041">struct</span>&nbsp;<span class="op" id="4691048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691051">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4691062">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691067">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691078">pkix</span><span class="op" id="4691082">.</span><span class="ident" id="4691083">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691104">PrivateKey</span>&nbsp;<span class="op" id="4691115">[</span><span class="op" id="4691116">]</span><span class="builtintype" id="4691117">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4691123">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="4691155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4691158">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="4691229">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4691289">func</span>&nbsp;<span class="ident" id="4691294">ParsePKCS8PrivateKey</span><span class="op" id="4691314">(</span><span class="ident" id="4691315">der</span>&nbsp;<span class="op" id="4691319">[</span><span class="op" id="4691320">]</span><span class="builtintype" id="4691321">byte</span><span class="op" id="4691325">)</span>&nbsp;<span class="op" id="4691327">(</span><span class="ident" id="4691328">key</span>&nbsp;<span class="keyword" id="4691332">interface</span><span class="op" id="4691341">{</span><span class="op" id="4691342">}</span><span class="op" id="4691343">,</span>&nbsp;<span class="ident" id="4691345">err</span>&nbsp;<span class="builtintype" id="4691349">error</span><span class="op" id="4691354">)</span>&nbsp;<span class="op" id="4691356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691359">var</span>&nbsp;<span class="ident" id="4691363">privKey</span>&nbsp;<span class="ident" id="4691371">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691378">if</span>&nbsp;<span class="ident" id="4691381">_</span><span class="op" id="4691382">,</span>&nbsp;<span class="ident" id="4691384">err</span>&nbsp;<span class="op" id="4691388">:=</span>&nbsp;<span class="ident" id="4691391">asn1</span><span class="op" id="4691395">.</span><span class="ident" id="4691396">Unmarshal</span><span class="op" id="4691405">(</span><span class="ident" id="4691406">der</span><span class="op" id="4691409">,</span>&nbsp;<span class="op" id="4691411">&amp;</span><span class="ident" id="4691412">privKey</span><span class="op" id="4691419">)</span><span class="op" id="4691420">;</span>&nbsp;<span class="ident" id="4691422">err</span>&nbsp;<span class="op" id="4691426">!=</span>&nbsp;<span class="ident" id="4691429">nil</span>&nbsp;<span class="op" id="4691433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691437">return</span>&nbsp;<span class="ident" id="4691444">nil</span><span class="op" id="4691447">,</span>&nbsp;<span class="ident" id="4691449">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4691454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691457">switch</span>&nbsp;<span class="op" id="4691464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691467">case</span>&nbsp;<span class="ident" id="4691472">privKey</span><span class="op" id="4691479">.</span><span class="ident" id="4691480">Algo</span><span class="op" id="4691484">.</span><span class="ident" id="4691485">Algorithm</span><span class="op" id="4691494">.</span><span class="ident" id="4691495">Equal</span><span class="op" id="4691500">(</span><span class="ident" id="4691501">oidPublicKeyRSA</span><span class="op" id="4691516">)</span><span class="op" id="4691517">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691521">key</span><span class="op" id="4691524">,</span>&nbsp;<span class="ident" id="4691526">err</span>&nbsp;<span class="op" id="4691530">=</span>&nbsp;<span class="ident" id="4691532">ParsePKCS1PrivateKey</span><span class="op" id="4691552">(</span><span class="ident" id="4691553">privKey</span><span class="op" id="4691560">.</span><span class="ident" id="4691561">PrivateKey</span><span class="op" id="4691571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691575">if</span>&nbsp;<span class="ident" id="4691578">err</span>&nbsp;<span class="op" id="4691582">!=</span>&nbsp;<span class="ident" id="4691585">nil</span>&nbsp;<span class="op" id="4691589">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691594">return</span>&nbsp;<span class="ident" id="4691601">nil</span><span class="op" id="4691604">,</span>&nbsp;<span class="ident" id="4691606">errors</span><span class="op" id="4691612">.</span><span class="ident" id="4691613">New</span><span class="op" id="4691616">(</span><span class="string" id="4691617">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4691678">+</span>&nbsp;<span class="ident" id="4691680">err</span><span class="op" id="4691683">.</span><span class="ident" id="4691684">Error</span><span class="op" id="4691689">(</span><span class="op" id="4691690">)</span><span class="op" id="4691691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4691695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691699">return</span>&nbsp;<span class="ident" id="4691706">key</span><span class="op" id="4691709">,</span>&nbsp;<span class="ident" id="4691711">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691717">case</span>&nbsp;<span class="ident" id="4691722">privKey</span><span class="op" id="4691729">.</span><span class="ident" id="4691730">Algo</span><span class="op" id="4691734">.</span><span class="ident" id="4691735">Algorithm</span><span class="op" id="4691744">.</span><span class="ident" id="4691745">Equal</span><span class="op" id="4691750">(</span><span class="ident" id="4691751">oidPublicKeyECDSA</span><span class="op" id="4691768">)</span><span class="op" id="4691769">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691773">bytes</span>&nbsp;<span class="op" id="4691779">:=</span>&nbsp;<span class="ident" id="4691782">privKey</span><span class="op" id="4691789">.</span><span class="ident" id="4691790">Algo</span><span class="op" id="4691794">.</span><span class="ident" id="4691795">Parameters</span><span class="op" id="4691805">.</span><span class="ident" id="4691806">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691818">namedCurveOID</span>&nbsp;<span class="op" id="4691832">:=</span>&nbsp;<span class="builtinfunc" id="4691835">new</span><span class="op" id="4691838">(</span><span class="ident" id="4691839">asn1</span><span class="op" id="4691843">.</span><span class="ident" id="4691844">ObjectIdentifier</span><span class="op" id="4691860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4691864">if</span>&nbsp;<span class="ident" id="4691867">_</span><span class="op" id="4691868">,</span>&nbsp;<span class="ident" id="4691870">err</span>&nbsp;<span class="op" id="4691874">:=</span>&nbsp;<span class="ident" id="4691877">asn1</span><span class="op" id="4691881">.</span><span class="ident" id="4691882">Unmarshal</span><span class="op" id="4691891">(</span><span class="ident" id="4691892">bytes</span><span class="op" id="4691897">,</span>&nbsp;<span class="ident" id="4691899">namedCurveOID</span><span class="op" id="4691912">)</span><span class="op" id="4691913">;</span>&nbsp;<span class="ident" id="4691915">err</span>&nbsp;<span class="op" id="4691919">!=</span>&nbsp;<span class="ident" id="4691922">nil</span>&nbsp;<span class="op" id="4691926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691931">namedCurveOID</span>&nbsp;<span class="op" id="4691945">=</span>&nbsp;<span class="ident" id="4691947">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4691953">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4691957">key</span><span class="op" id="4691960">,</span>&nbsp;<span class="ident" id="4691962">err</span>&nbsp;<span class="op" id="4691966">=</span>&nbsp;<span class="ident" id="4691968">parseECPrivateKey</span><span class="op" id="4691985">(</span><span class="ident" id="4691986">namedCurveOID</span><span class="op" id="4691999">,</span>&nbsp;<span class="ident" id="4692001">privKey</span><span class="op" id="4692008">.</span><span class="ident" id="4692009">PrivateKey</span><span class="op" id="4692019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692023">if</span>&nbsp;<span class="ident" id="4692026">err</span>&nbsp;<span class="op" id="4692030">!=</span>&nbsp;<span class="ident" id="4692033">nil</span>&nbsp;<span class="op" id="4692037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692042">return</span>&nbsp;<span class="ident" id="4692049">nil</span><span class="op" id="4692052">,</span>&nbsp;<span class="ident" id="4692054">errors</span><span class="op" id="4692060">.</span><span class="ident" id="4692061">New</span><span class="op" id="4692064">(</span><span class="string" id="4692065">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4692125">+</span>&nbsp;<span class="ident" id="4692127">err</span><span class="op" id="4692130">.</span><span class="ident" id="4692131">Error</span><span class="op" id="4692136">(</span><span class="op" id="4692137">)</span><span class="op" id="4692138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4692142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692146">return</span>&nbsp;<span class="ident" id="4692153">key</span><span class="op" id="4692156">,</span>&nbsp;<span class="ident" id="4692158">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692164">default</span><span class="op" id="4692171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4692175">return</span>&nbsp;<span class="ident" id="4692182">nil</span><span class="op" id="4692185">,</span>&nbsp;<span class="ident" id="4692187">fmt</span><span class="op" id="4692190">.</span><span class="ident" id="4692191">Errorf</span><span class="op" id="4692197">(</span><span class="string" id="4692198">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="4692270">,</span>&nbsp;<span class="ident" id="4692272">privKey</span><span class="op" id="4692279">.</span><span class="ident" id="4692280">Algo</span><span class="op" id="4692284">.</span><span class="ident" id="4692285">Algorithm</span><span class="op" id="4692294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4692297">}</span><br>
<span class="lineno"></span><span class="op" id="4692299">}</span>
</div>
</body>
</html>
