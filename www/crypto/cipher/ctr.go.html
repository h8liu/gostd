<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3842173">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3842228">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3842282">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3842333">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3842357">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3842412">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3842465">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3842521">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3842555">package</span>&nbsp;<span class="ident" id="3842563">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3842571">type</span>&nbsp;<span class="ident" id="3842576">ctr</span>&nbsp;<span class="keyword" id="3842580">struct</span>&nbsp;<span class="op" id="3842587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842590">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3842598">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842605">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842613">[</span><span class="op" id="3842614">]</span><span class="builtintype" id="3842615">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842621">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842629">[</span><span class="op" id="3842630">]</span><span class="builtintype" id="3842631">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842637">outUsed</span>&nbsp;<span class="builtintype" id="3842645">int</span><br>
<span class="lineno">20</span><span class="op" id="3842649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3842652">const</span>&nbsp;<span class="ident" id="3842658">streamBufferSize</span>&nbsp;<span class="op" id="3842675">=</span>&nbsp;<span class="num" id="3842677">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3842682">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3842758">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3842836">func</span>&nbsp;<span class="ident" id="3842841">NewCTR</span><span class="op" id="3842847">(</span><span class="ident" id="3842848">block</span>&nbsp;<span class="ident" id="3842854">Block</span><span class="op" id="3842859">,</span>&nbsp;<span class="ident" id="3842861">iv</span>&nbsp;<span class="op" id="3842864">[</span><span class="op" id="3842865">]</span><span class="builtintype" id="3842866">byte</span><span class="op" id="3842870">)</span>&nbsp;<span class="ident" id="3842872">Stream</span>&nbsp;<span class="op" id="3842879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3842882">if</span>&nbsp;<span class="builtinfunc" id="3842885">len</span><span class="op" id="3842888">(</span><span class="ident" id="3842889">iv</span><span class="op" id="3842891">)</span>&nbsp;<span class="op" id="3842893">!=</span>&nbsp;<span class="ident" id="3842896">block</span><span class="op" id="3842901">.</span><span class="ident" id="3842902">BlockSize</span><span class="op" id="3842911">(</span><span class="op" id="3842912">)</span>&nbsp;<span class="op" id="3842914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3842918">panic</span><span class="op" id="3842923">(</span><span class="string" id="3842924">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3842972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3842975">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842978">bufSize</span>&nbsp;<span class="op" id="3842986">:=</span>&nbsp;<span class="ident" id="3842989">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843007">if</span>&nbsp;<span class="ident" id="3843010">bufSize</span>&nbsp;<span class="op" id="3843018">&lt;</span>&nbsp;<span class="ident" id="3843020">block</span><span class="op" id="3843025">.</span><span class="ident" id="3843026">BlockSize</span><span class="op" id="3843035">(</span><span class="op" id="3843036">)</span>&nbsp;<span class="op" id="3843038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843042">bufSize</span>&nbsp;<span class="op" id="3843050">=</span>&nbsp;<span class="ident" id="3843052">block</span><span class="op" id="3843057">.</span><span class="ident" id="3843058">BlockSize</span><span class="op" id="3843067">(</span><span class="op" id="3843068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843074">return</span>&nbsp;<span class="op" id="3843081">&amp;</span><span class="ident" id="3843082">ctr</span><span class="op" id="3843085">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843089">b</span><span class="op" id="3843090">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843098">block</span><span class="op" id="3843103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843107">ctr</span><span class="op" id="3843110">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843116">dup</span><span class="op" id="3843119">(</span><span class="ident" id="3843120">iv</span><span class="op" id="3843122">)</span><span class="op" id="3843123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843127">out</span><span class="op" id="3843130">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3843136">make</span><span class="op" id="3843140">(</span><span class="op" id="3843141">[</span><span class="op" id="3843142">]</span><span class="builtintype" id="3843143">byte</span><span class="op" id="3843147">,</span>&nbsp;<span class="num" id="3843149">0</span><span class="op" id="3843150">,</span>&nbsp;<span class="ident" id="3843152">bufSize</span><span class="op" id="3843159">)</span><span class="op" id="3843160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843164">outUsed</span><span class="op" id="3843171">:</span>&nbsp;<span class="num" id="3843173">0</span><span class="op" id="3843174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843177">}</span><br>
<span class="lineno">40</span><span class="op" id="3843179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3843182">func</span>&nbsp;<span class="op" id="3843187">(</span><span class="ident" id="3843188">x</span>&nbsp;<span class="op" id="3843190">*</span><span class="ident" id="3843191">ctr</span><span class="op" id="3843194">)</span>&nbsp;<span class="ident" id="3843196">refill</span><span class="op" id="3843202">(</span><span class="op" id="3843203">)</span>&nbsp;<span class="op" id="3843205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843208">remain</span>&nbsp;<span class="op" id="3843215">:=</span>&nbsp;<span class="builtinfunc" id="3843218">len</span><span class="op" id="3843221">(</span><span class="ident" id="3843222">x</span><span class="op" id="3843223">.</span><span class="ident" id="3843224">out</span><span class="op" id="3843227">)</span>&nbsp;<span class="op" id="3843229">-</span>&nbsp;<span class="ident" id="3843231">x</span><span class="op" id="3843232">.</span><span class="ident" id="3843233">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843242">if</span>&nbsp;<span class="ident" id="3843245">remain</span>&nbsp;<span class="op" id="3843252">&gt;</span>&nbsp;<span class="ident" id="3843254">x</span><span class="op" id="3843255">.</span><span class="ident" id="3843256">outUsed</span>&nbsp;<span class="op" id="3843264">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843268">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3843279">copy</span><span class="op" id="3843283">(</span><span class="ident" id="3843284">x</span><span class="op" id="3843285">.</span><span class="ident" id="3843286">out</span><span class="op" id="3843289">,</span>&nbsp;<span class="ident" id="3843291">x</span><span class="op" id="3843292">.</span><span class="ident" id="3843293">out</span><span class="op" id="3843296">[</span><span class="ident" id="3843297">x</span><span class="op" id="3843298">.</span><span class="ident" id="3843299">outUsed</span><span class="op" id="3843306">:</span><span class="op" id="3843307">]</span><span class="op" id="3843308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843311">x</span><span class="op" id="3843312">.</span><span class="ident" id="3843313">out</span>&nbsp;<span class="op" id="3843317">=</span>&nbsp;<span class="ident" id="3843319">x</span><span class="op" id="3843320">.</span><span class="ident" id="3843321">out</span><span class="op" id="3843324">[</span><span class="op" id="3843325">:</span><span class="builtinfunc" id="3843326">cap</span><span class="op" id="3843329">(</span><span class="ident" id="3843330">x</span><span class="op" id="3843331">.</span><span class="ident" id="3843332">out</span><span class="op" id="3843335">)</span><span class="op" id="3843336">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843339">bs</span>&nbsp;<span class="op" id="3843342">:=</span>&nbsp;<span class="ident" id="3843345">x</span><span class="op" id="3843346">.</span><span class="ident" id="3843347">b</span><span class="op" id="3843348">.</span><span class="ident" id="3843349">BlockSize</span><span class="op" id="3843358">(</span><span class="op" id="3843359">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843362">for</span>&nbsp;<span class="ident" id="3843366">remain</span>&nbsp;<span class="op" id="3843373">&lt;</span>&nbsp;<span class="builtinfunc" id="3843375">len</span><span class="op" id="3843378">(</span><span class="ident" id="3843379">x</span><span class="op" id="3843380">.</span><span class="ident" id="3843381">out</span><span class="op" id="3843384">)</span><span class="op" id="3843385">-</span><span class="ident" id="3843386">bs</span>&nbsp;<span class="op" id="3843389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843393">x</span><span class="op" id="3843394">.</span><span class="ident" id="3843395">b</span><span class="op" id="3843396">.</span><span class="ident" id="3843397">Encrypt</span><span class="op" id="3843404">(</span><span class="ident" id="3843405">x</span><span class="op" id="3843406">.</span><span class="ident" id="3843407">out</span><span class="op" id="3843410">[</span><span class="ident" id="3843411">remain</span><span class="op" id="3843417">:</span><span class="op" id="3843418">]</span><span class="op" id="3843419">,</span>&nbsp;<span class="ident" id="3843421">x</span><span class="op" id="3843422">.</span><span class="ident" id="3843423">ctr</span><span class="op" id="3843426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843430">remain</span>&nbsp;<span class="op" id="3843437">+=</span>&nbsp;<span class="ident" id="3843440">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3843446">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843469">for</span>&nbsp;<span class="ident" id="3843473">i</span>&nbsp;<span class="op" id="3843475">:=</span>&nbsp;<span class="builtinfunc" id="3843478">len</span><span class="op" id="3843481">(</span><span class="ident" id="3843482">x</span><span class="op" id="3843483">.</span><span class="ident" id="3843484">ctr</span><span class="op" id="3843487">)</span>&nbsp;<span class="op" id="3843489">-</span>&nbsp;<span class="num" id="3843491">1</span><span class="op" id="3843492">;</span>&nbsp;<span class="ident" id="3843494">i</span>&nbsp;<span class="op" id="3843496">&gt;=</span>&nbsp;<span class="num" id="3843499">0</span><span class="op" id="3843500">;</span>&nbsp;<span class="ident" id="3843502">i</span><span class="op" id="3843503">--</span>&nbsp;<span class="op" id="3843506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843511">x</span><span class="op" id="3843512">.</span><span class="ident" id="3843513">ctr</span><span class="op" id="3843516">[</span><span class="ident" id="3843517">i</span><span class="op" id="3843518">]</span><span class="op" id="3843519">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843525">if</span>&nbsp;<span class="ident" id="3843528">x</span><span class="op" id="3843529">.</span><span class="ident" id="3843530">ctr</span><span class="op" id="3843533">[</span><span class="ident" id="3843534">i</span><span class="op" id="3843535">]</span>&nbsp;<span class="op" id="3843537">!=</span>&nbsp;<span class="num" id="3843540">0</span>&nbsp;<span class="op" id="3843542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843548">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843557">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843567">x</span><span class="op" id="3843568">.</span><span class="ident" id="3843569">out</span>&nbsp;<span class="op" id="3843573">=</span>&nbsp;<span class="ident" id="3843575">x</span><span class="op" id="3843576">.</span><span class="ident" id="3843577">out</span><span class="op" id="3843580">[</span><span class="op" id="3843581">:</span><span class="ident" id="3843582">remain</span><span class="op" id="3843588">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843591">x</span><span class="op" id="3843592">.</span><span class="ident" id="3843593">outUsed</span>&nbsp;<span class="op" id="3843601">=</span>&nbsp;<span class="num" id="3843603">0</span><br>
<span class="lineno"></span><span class="op" id="3843605">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3843608">func</span>&nbsp;<span class="op" id="3843613">(</span><span class="ident" id="3843614">x</span>&nbsp;<span class="op" id="3843616">*</span><span class="ident" id="3843617">ctr</span><span class="op" id="3843620">)</span>&nbsp;<span class="ident" id="3843622">XORKeyStream</span><span class="op" id="3843634">(</span><span class="ident" id="3843635">dst</span><span class="op" id="3843638">,</span>&nbsp;<span class="ident" id="3843640">src</span>&nbsp;<span class="op" id="3843644">[</span><span class="op" id="3843645">]</span><span class="builtintype" id="3843646">byte</span><span class="op" id="3843650">)</span>&nbsp;<span class="op" id="3843652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843655">for</span>&nbsp;<span class="builtinfunc" id="3843659">len</span><span class="op" id="3843662">(</span><span class="ident" id="3843663">src</span><span class="op" id="3843666">)</span>&nbsp;<span class="op" id="3843668">&gt;</span>&nbsp;<span class="num" id="3843670">0</span>&nbsp;<span class="op" id="3843672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843676">if</span>&nbsp;<span class="ident" id="3843679">x</span><span class="op" id="3843680">.</span><span class="ident" id="3843681">outUsed</span>&nbsp;<span class="op" id="3843689">&gt;=</span>&nbsp;<span class="builtinfunc" id="3843692">len</span><span class="op" id="3843695">(</span><span class="ident" id="3843696">x</span><span class="op" id="3843697">.</span><span class="ident" id="3843698">out</span><span class="op" id="3843701">)</span><span class="op" id="3843702">-</span><span class="ident" id="3843703">x</span><span class="op" id="3843704">.</span><span class="ident" id="3843705">b</span><span class="op" id="3843706">.</span><span class="ident" id="3843707">BlockSize</span><span class="op" id="3843716">(</span><span class="op" id="3843717">)</span>&nbsp;<span class="op" id="3843719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843724">x</span><span class="op" id="3843725">.</span><span class="ident" id="3843726">refill</span><span class="op" id="3843732">(</span><span class="op" id="3843733">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843741">n</span>&nbsp;<span class="op" id="3843743">:=</span>&nbsp;<span class="ident" id="3843746">xorBytes</span><span class="op" id="3843754">(</span><span class="ident" id="3843755">dst</span><span class="op" id="3843758">,</span>&nbsp;<span class="ident" id="3843760">src</span><span class="op" id="3843763">,</span>&nbsp;<span class="ident" id="3843765">x</span><span class="op" id="3843766">.</span><span class="ident" id="3843767">out</span><span class="op" id="3843770">[</span><span class="ident" id="3843771">x</span><span class="op" id="3843772">.</span><span class="ident" id="3843773">outUsed</span><span class="op" id="3843780">:</span><span class="op" id="3843781">]</span><span class="op" id="3843782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843786">dst</span>&nbsp;<span class="op" id="3843790">=</span>&nbsp;<span class="ident" id="3843792">dst</span><span class="op" id="3843795">[</span><span class="ident" id="3843796">n</span><span class="op" id="3843797">:</span><span class="op" id="3843798">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843802">src</span>&nbsp;<span class="op" id="3843806">=</span>&nbsp;<span class="ident" id="3843808">src</span><span class="op" id="3843811">[</span><span class="ident" id="3843812">n</span><span class="op" id="3843813">:</span><span class="op" id="3843814">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843818">x</span><span class="op" id="3843819">.</span><span class="ident" id="3843820">outUsed</span>&nbsp;<span class="op" id="3843828">+=</span>&nbsp;<span class="ident" id="3843831">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843834">}</span><br>
<span class="lineno"></span><span class="op" id="3843836">}</span>
</div>
</body>
</html>
