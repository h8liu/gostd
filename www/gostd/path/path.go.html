<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3745255">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3745310">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3745364">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3745415">//&nbsp;Package&nbsp;path&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;slash-separated</span><br>
<span class="lineno"></span><span class="comment" id="3745492">//&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="3745502">package</span>&nbsp;<span class="ident" id="3745510">path</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3745516">import</span>&nbsp;<span class="op" id="3745523">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3745526">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3745536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3745539">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="3745589">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno">15</span><span class="comment" id="3745647">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="3745713">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3745770">type</span>&nbsp;<span class="ident" id="3745775">lazybuf</span>&nbsp;<span class="keyword" id="3745783">struct</span>&nbsp;<span class="op" id="3745790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745793">s</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3745797">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745805">buf</span>&nbsp;<span class="op" id="3745809">[</span><span class="op" id="3745810">]</span><span class="builtintype" id="3745811">byte</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3745817">w</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3745821">int</span><br>
<span class="lineno"></span><span class="op" id="3745825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3745828">func</span>&nbsp;<span class="op" id="3745833">(</span><span class="ident" id="3745834">b</span>&nbsp;<span class="op" id="3745836">*</span><span class="ident" id="3745837">lazybuf</span><span class="op" id="3745844">)</span>&nbsp;<span class="ident" id="3745846">index</span><span class="op" id="3745851">(</span><span class="ident" id="3745852">i</span>&nbsp;<span class="builtintype" id="3745854">int</span><span class="op" id="3745857">)</span>&nbsp;<span class="builtintype" id="3745859">byte</span>&nbsp;<span class="op" id="3745864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745867">if</span>&nbsp;<span class="ident" id="3745870">b</span><span class="op" id="3745871">.</span><span class="ident" id="3745872">buf</span>&nbsp;<span class="op" id="3745876">!=</span>&nbsp;<span class="ident" id="3745879">nil</span>&nbsp;<span class="op" id="3745883">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745887">return</span>&nbsp;<span class="ident" id="3745894">b</span><span class="op" id="3745895">.</span><span class="ident" id="3745896">buf</span><span class="op" id="3745899">[</span><span class="ident" id="3745900">i</span><span class="op" id="3745901">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3745904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745907">return</span>&nbsp;<span class="ident" id="3745914">b</span><span class="op" id="3745915">.</span><span class="ident" id="3745916">s</span><span class="op" id="3745917">[</span><span class="ident" id="3745918">i</span><span class="op" id="3745919">]</span><br>
<span class="lineno"></span><span class="op" id="3745921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3745924">func</span>&nbsp;<span class="op" id="3745929">(</span><span class="ident" id="3745930">b</span>&nbsp;<span class="op" id="3745932">*</span><span class="ident" id="3745933">lazybuf</span><span class="op" id="3745940">)</span>&nbsp;<span class="builtinfunc" id="3745942">append</span><span class="op" id="3745948">(</span><span class="ident" id="3745949">c</span>&nbsp;<span class="builtintype" id="3745951">byte</span><span class="op" id="3745955">)</span>&nbsp;<span class="op" id="3745957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745960">if</span>&nbsp;<span class="ident" id="3745963">b</span><span class="op" id="3745964">.</span><span class="ident" id="3745965">buf</span>&nbsp;<span class="op" id="3745969">==</span>&nbsp;<span class="ident" id="3745972">nil</span>&nbsp;<span class="op" id="3745976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3745980">if</span>&nbsp;<span class="ident" id="3745983">b</span><span class="op" id="3745984">.</span><span class="ident" id="3745985">w</span>&nbsp;<span class="op" id="3745987">&lt;</span>&nbsp;<span class="builtinfunc" id="3745989">len</span><span class="op" id="3745992">(</span><span class="ident" id="3745993">b</span><span class="op" id="3745994">.</span><span class="ident" id="3745995">s</span><span class="op" id="3745996">)</span>&nbsp;<span class="op" id="3745998">&amp;&amp;</span>&nbsp;<span class="ident" id="3746001">b</span><span class="op" id="3746002">.</span><span class="ident" id="3746003">s</span><span class="op" id="3746004">[</span><span class="ident" id="3746005">b</span><span class="op" id="3746006">.</span><span class="ident" id="3746007">w</span><span class="op" id="3746008">]</span>&nbsp;<span class="op" id="3746010">==</span>&nbsp;<span class="ident" id="3746013">c</span>&nbsp;<span class="op" id="3746015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746020">b</span><span class="op" id="3746021">.</span><span class="ident" id="3746022">w</span><span class="op" id="3746023">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746029">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746042">b</span><span class="op" id="3746043">.</span><span class="ident" id="3746044">buf</span>&nbsp;<span class="op" id="3746048">=</span>&nbsp;<span class="builtinfunc" id="3746050">make</span><span class="op" id="3746054">(</span><span class="op" id="3746055">[</span><span class="op" id="3746056">]</span><span class="builtintype" id="3746057">byte</span><span class="op" id="3746061">,</span>&nbsp;<span class="builtinfunc" id="3746063">len</span><span class="op" id="3746066">(</span><span class="ident" id="3746067">b</span><span class="op" id="3746068">.</span><span class="ident" id="3746069">s</span><span class="op" id="3746070">)</span><span class="op" id="3746071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3746075">copy</span><span class="op" id="3746079">(</span><span class="ident" id="3746080">b</span><span class="op" id="3746081">.</span><span class="ident" id="3746082">buf</span><span class="op" id="3746085">,</span>&nbsp;<span class="ident" id="3746087">b</span><span class="op" id="3746088">.</span><span class="ident" id="3746089">s</span><span class="op" id="3746090">[</span><span class="op" id="3746091">:</span><span class="ident" id="3746092">b</span><span class="op" id="3746093">.</span><span class="ident" id="3746094">w</span><span class="op" id="3746095">]</span><span class="op" id="3746096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746102">b</span><span class="op" id="3746103">.</span><span class="ident" id="3746104">buf</span><span class="op" id="3746107">[</span><span class="ident" id="3746108">b</span><span class="op" id="3746109">.</span><span class="ident" id="3746110">w</span><span class="op" id="3746111">]</span>&nbsp;<span class="op" id="3746113">=</span>&nbsp;<span class="ident" id="3746115">c</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3746118">b</span><span class="op" id="3746119">.</span><span class="ident" id="3746120">w</span><span class="op" id="3746121">++</span><br>
<span class="lineno"></span><span class="op" id="3746124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3746127">func</span>&nbsp;<span class="op" id="3746132">(</span><span class="ident" id="3746133">b</span>&nbsp;<span class="op" id="3746135">*</span><span class="ident" id="3746136">lazybuf</span><span class="op" id="3746143">)</span>&nbsp;<span class="builtintype" id="3746145">string</span><span class="op" id="3746151">(</span><span class="op" id="3746152">)</span>&nbsp;<span class="builtintype" id="3746154">string</span>&nbsp;<span class="op" id="3746161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746164">if</span>&nbsp;<span class="ident" id="3746167">b</span><span class="op" id="3746168">.</span><span class="ident" id="3746169">buf</span>&nbsp;<span class="op" id="3746173">==</span>&nbsp;<span class="ident" id="3746176">nil</span>&nbsp;<span class="op" id="3746180">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746184">return</span>&nbsp;<span class="ident" id="3746191">b</span><span class="op" id="3746192">.</span><span class="ident" id="3746193">s</span><span class="op" id="3746194">[</span><span class="op" id="3746195">:</span><span class="ident" id="3746196">b</span><span class="op" id="3746197">.</span><span class="ident" id="3746198">w</span><span class="op" id="3746199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3746202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3746205">return</span>&nbsp;<span class="builtintype" id="3746212">string</span><span class="op" id="3746218">(</span><span class="ident" id="3746219">b</span><span class="op" id="3746220">.</span><span class="ident" id="3746221">buf</span><span class="op" id="3746224">[</span><span class="op" id="3746225">:</span><span class="ident" id="3746226">b</span><span class="op" id="3746227">.</span><span class="ident" id="3746228">w</span><span class="op" id="3746229">]</span><span class="op" id="3746230">)</span><br>
<span class="lineno"></span><span class="op" id="3746232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3746235">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="3746294">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="3746359">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="3746415">//</span><br>
<span class="lineno"></span><span class="comment" id="3746418">//&nbsp;&nbsp;&nbsp;&nbsp1.&nbsp;Replace&nbsp;multiple&nbsp;slashes&nbsp;with&nbsp;a&nbsp;single&nbsp;slash.</span><br>
<span class="lineno">55</span><span class="comment" id="3746470">//&nbsp;&nbsp;&nbsp;&nbsp2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="3746536">//&nbsp;&nbsp;&nbsp;&nbsp3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="3746607">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3746661">//&nbsp;&nbsp;&nbsp;&nbsp4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="3746715">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path.</span><br>
<span class="lineno">60</span><span class="comment" id="3746779">//</span><br>
<span class="lineno"></span><span class="comment" id="3746782">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3746847">//</span><br>
<span class="lineno"></span><span class="comment" id="3746850">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="3746909">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">65</span><span class="comment" id="3746936">//</span><br>
<span class="lineno"></span><span class="comment" id="3746939">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3746995">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3747023">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="3747075">func</span>&nbsp;<span class="ident" id="3747080">Clean</span><span class="op" id="3747085">(</span><span class="ident" id="3747086">path</span>&nbsp;<span class="builtintype" id="3747091">string</span><span class="op" id="3747097">)</span>&nbsp;<span class="builtintype" id="3747099">string</span>&nbsp;<span class="op" id="3747106">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747109">if</span>&nbsp;<span class="ident" id="3747112">path</span>&nbsp;<span class="op" id="3747117">==</span>&nbsp;<span class="string" id="3747120">&#34;&#34;</span>&nbsp;<span class="op" id="3747123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747127">return</span>&nbsp;<span class="string" id="3747134">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747143">rooted</span>&nbsp;<span class="op" id="3747150">:=</span>&nbsp;<span class="ident" id="3747153">path</span><span class="op" id="3747157">[</span><span class="num" id="3747158">0</span><span class="op" id="3747159">]</span>&nbsp;<span class="op" id="3747161">==</span>&nbsp;<span class="string" id="3747164">&#39;/&#39;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747169">n</span>&nbsp;<span class="op" id="3747171">:=</span>&nbsp;<span class="builtinfunc" id="3747174">len</span><span class="op" id="3747177">(</span><span class="ident" id="3747178">path</span><span class="op" id="3747182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747186">//&nbsp;Invariants:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747202">//&nbsp;&nbsp;&nbsp;&nbspreading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747261">//&nbsp;&nbsp;&nbsp;&nbspwriting&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747315">//&nbsp;&nbsp;&nbsp;&nbspdotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747377">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspit&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747442">out</span>&nbsp;<span class="op" id="3747446">:=</span>&nbsp;<span class="ident" id="3747449">lazybuf</span><span class="op" id="3747456">{</span><span class="ident" id="3747457">s</span><span class="op" id="3747458">:</span>&nbsp;<span class="ident" id="3747460">path</span><span class="op" id="3747464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747467">r</span><span class="op" id="3747468">,</span>&nbsp;<span class="ident" id="3747470">dotdot</span>&nbsp;<span class="op" id="3747477">:=</span>&nbsp;<span class="num" id="3747480">0</span><span class="op" id="3747481">,</span>&nbsp;<span class="num" id="3747483">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747486">if</span>&nbsp;<span class="ident" id="3747489">rooted</span>&nbsp;<span class="op" id="3747496">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747500">out</span><span class="op" id="3747503">.</span><span class="builtinfunc" id="3747504">append</span><span class="op" id="3747510">(</span><span class="string" id="3747511">&#39;/&#39;</span><span class="op" id="3747514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747518">r</span><span class="op" id="3747519">,</span>&nbsp;<span class="ident" id="3747521">dotdot</span>&nbsp;<span class="op" id="3747528">=</span>&nbsp;<span class="num" id="3747530">1</span><span class="op" id="3747531">,</span>&nbsp;<span class="num" id="3747533">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747540">for</span>&nbsp;<span class="ident" id="3747544">r</span>&nbsp;<span class="op" id="3747546">&lt;</span>&nbsp;<span class="ident" id="3747548">n</span>&nbsp;<span class="op" id="3747550">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747554">switch</span>&nbsp;<span class="op" id="3747561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747565">case</span>&nbsp;<span class="ident" id="3747570">path</span><span class="op" id="3747574">[</span><span class="ident" id="3747575">r</span><span class="op" id="3747576">]</span>&nbsp;<span class="op" id="3747578">==</span>&nbsp;<span class="string" id="3747581">&#39;/&#39;</span><span class="op" id="3747584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747589">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747614">r</span><span class="op" id="3747615">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747620">case</span>&nbsp;<span class="ident" id="3747625">path</span><span class="op" id="3747629">[</span><span class="ident" id="3747630">r</span><span class="op" id="3747631">]</span>&nbsp;<span class="op" id="3747633">==</span>&nbsp;<span class="string" id="3747636">&#39;.&#39;</span>&nbsp;<span class="op" id="3747640">&amp;&amp;</span>&nbsp;<span class="op" id="3747643">(</span><span class="ident" id="3747644">r</span><span class="op" id="3747645">+</span><span class="num" id="3747646">1</span>&nbsp;<span class="op" id="3747648">==</span>&nbsp;<span class="ident" id="3747651">n</span>&nbsp;<span class="op" id="3747653">||</span>&nbsp;<span class="ident" id="3747656">path</span><span class="op" id="3747660">[</span><span class="ident" id="3747661">r</span><span class="op" id="3747662">+</span><span class="num" id="3747663">1</span><span class="op" id="3747664">]</span>&nbsp;<span class="op" id="3747666">==</span>&nbsp;<span class="string" id="3747669">&#39;/&#39;</span><span class="op" id="3747672">)</span><span class="op" id="3747673">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747678">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747694">r</span><span class="op" id="3747695">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747700">case</span>&nbsp;<span class="ident" id="3747705">path</span><span class="op" id="3747709">[</span><span class="ident" id="3747710">r</span><span class="op" id="3747711">]</span>&nbsp;<span class="op" id="3747713">==</span>&nbsp;<span class="string" id="3747716">&#39;.&#39;</span>&nbsp;<span class="op" id="3747720">&amp;&amp;</span>&nbsp;<span class="ident" id="3747723">path</span><span class="op" id="3747727">[</span><span class="ident" id="3747728">r</span><span class="op" id="3747729">+</span><span class="num" id="3747730">1</span><span class="op" id="3747731">]</span>&nbsp;<span class="op" id="3747733">==</span>&nbsp;<span class="string" id="3747736">&#39;.&#39;</span>&nbsp;<span class="op" id="3747740">&amp;&amp;</span>&nbsp;<span class="op" id="3747743">(</span><span class="ident" id="3747744">r</span><span class="op" id="3747745">+</span><span class="num" id="3747746">2</span>&nbsp;<span class="op" id="3747748">==</span>&nbsp;<span class="ident" id="3747751">n</span>&nbsp;<span class="op" id="3747753">||</span>&nbsp;<span class="ident" id="3747756">path</span><span class="op" id="3747760">[</span><span class="ident" id="3747761">r</span><span class="op" id="3747762">+</span><span class="num" id="3747763">2</span><span class="op" id="3747764">]</span>&nbsp;<span class="op" id="3747766">==</span>&nbsp;<span class="string" id="3747769">&#39;/&#39;</span><span class="op" id="3747772">)</span><span class="op" id="3747773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747778">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747813">r</span>&nbsp;<span class="op" id="3747815">+=</span>&nbsp;<span class="num" id="3747818">2</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747823">switch</span>&nbsp;<span class="op" id="3747830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747835">case</span>&nbsp;<span class="ident" id="3747840">out</span><span class="op" id="3747843">.</span><span class="ident" id="3747844">w</span>&nbsp;<span class="op" id="3747846">&gt;</span>&nbsp;<span class="ident" id="3747848">dotdot</span><span class="op" id="3747854">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747860">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747881">out</span><span class="op" id="3747884">.</span><span class="ident" id="3747885">w</span><span class="op" id="3747886">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747893">for</span>&nbsp;<span class="ident" id="3747897">out</span><span class="op" id="3747900">.</span><span class="ident" id="3747901">w</span>&nbsp;<span class="op" id="3747903">&gt;</span>&nbsp;<span class="ident" id="3747905">dotdot</span>&nbsp;<span class="op" id="3747912">&amp;&amp;</span>&nbsp;<span class="ident" id="3747915">out</span><span class="op" id="3747918">.</span><span class="ident" id="3747919">index</span><span class="op" id="3747924">(</span><span class="ident" id="3747925">out</span><span class="op" id="3747928">.</span><span class="ident" id="3747929">w</span><span class="op" id="3747930">)</span>&nbsp;<span class="op" id="3747932">!=</span>&nbsp;<span class="string" id="3747935">&#39;/&#39;</span>&nbsp;<span class="op" id="3747939">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3747946">out</span><span class="op" id="3747949">.</span><span class="ident" id="3747950">w</span><span class="op" id="3747951">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747963">case</span>&nbsp;<span class="op" id="3747968">!</span><span class="ident" id="3747969">rooted</span><span class="op" id="3747975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3747981">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748044">if</span>&nbsp;<span class="ident" id="3748047">out</span><span class="op" id="3748050">.</span><span class="ident" id="3748051">w</span>&nbsp;<span class="op" id="3748053">&gt;</span>&nbsp;<span class="num" id="3748055">0</span>&nbsp;<span class="op" id="3748057">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748064">out</span><span class="op" id="3748067">.</span><span class="builtinfunc" id="3748068">append</span><span class="op" id="3748074">(</span><span class="string" id="3748075">&#39;/&#39;</span><span class="op" id="3748078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748090">out</span><span class="op" id="3748093">.</span><span class="builtinfunc" id="3748094">append</span><span class="op" id="3748100">(</span><span class="string" id="3748101">&#39;.&#39;</span><span class="op" id="3748104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748110">out</span><span class="op" id="3748113">.</span><span class="builtinfunc" id="3748114">append</span><span class="op" id="3748120">(</span><span class="string" id="3748121">&#39;.&#39;</span><span class="op" id="3748124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748130">dotdot</span>&nbsp;<span class="op" id="3748137">=</span>&nbsp;<span class="ident" id="3748139">out</span><span class="op" id="3748142">.</span><span class="ident" id="3748143">w</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748152">default</span><span class="op" id="3748159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3748164">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3748189">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748215">if</span>&nbsp;<span class="ident" id="3748218">rooted</span>&nbsp;<span class="op" id="3748225">&amp;&amp;</span>&nbsp;<span class="ident" id="3748228">out</span><span class="op" id="3748231">.</span><span class="ident" id="3748232">w</span>&nbsp;<span class="op" id="3748234">!=</span>&nbsp;<span class="num" id="3748237">1</span>&nbsp;<span class="op" id="3748239">||</span>&nbsp;<span class="op" id="3748242">!</span><span class="ident" id="3748243">rooted</span>&nbsp;<span class="op" id="3748250">&amp;&amp;</span>&nbsp;<span class="ident" id="3748253">out</span><span class="op" id="3748256">.</span><span class="ident" id="3748257">w</span>&nbsp;<span class="op" id="3748259">!=</span>&nbsp;<span class="num" id="3748262">0</span>&nbsp;<span class="op" id="3748264">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748270">out</span><span class="op" id="3748273">.</span><span class="builtinfunc" id="3748274">append</span><span class="op" id="3748280">(</span><span class="string" id="3748281">&#39;/&#39;</span><span class="op" id="3748284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3748294">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748313">for</span>&nbsp;<span class="op" id="3748317">;</span>&nbsp;<span class="ident" id="3748319">r</span>&nbsp;<span class="op" id="3748321">&lt;</span>&nbsp;<span class="ident" id="3748323">n</span>&nbsp;<span class="op" id="3748325">&amp;&amp;</span>&nbsp;<span class="ident" id="3748328">path</span><span class="op" id="3748332">[</span><span class="ident" id="3748333">r</span><span class="op" id="3748334">]</span>&nbsp;<span class="op" id="3748336">!=</span>&nbsp;<span class="string" id="3748339">&#39;/&#39;</span><span class="op" id="3748342">;</span>&nbsp;<span class="ident" id="3748344">r</span><span class="op" id="3748345">++</span>&nbsp;<span class="op" id="3748348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748354">out</span><span class="op" id="3748357">.</span><span class="builtinfunc" id="3748358">append</span><span class="op" id="3748364">(</span><span class="ident" id="3748365">path</span><span class="op" id="3748369">[</span><span class="ident" id="3748370">r</span><span class="op" id="3748371">]</span><span class="op" id="3748372">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3748388">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748419">if</span>&nbsp;<span class="ident" id="3748422">out</span><span class="op" id="3748425">.</span><span class="ident" id="3748426">w</span>&nbsp;<span class="op" id="3748428">==</span>&nbsp;<span class="num" id="3748431">0</span>&nbsp;<span class="op" id="3748433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748437">return</span>&nbsp;<span class="string" id="3748444">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748453">return</span>&nbsp;<span class="ident" id="3748460">out</span><span class="op" id="3748463">.</span><span class="builtintype" id="3748464">string</span><span class="op" id="3748470">(</span><span class="op" id="3748471">)</span><br>
<span class="lineno">135</span><span class="op" id="3748473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3748476">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;slash.</span><br>
<span class="lineno"></span><span class="comment" id="3748536">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="3748595">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;slash&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir&nbsp;and</span><br>
<span class="lineno">140</span><span class="comment" id="3748656">//&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3748677">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="3748740">func</span>&nbsp;<span class="ident" id="3748745">Split</span><span class="op" id="3748750">(</span><span class="ident" id="3748751">path</span>&nbsp;<span class="builtintype" id="3748756">string</span><span class="op" id="3748762">)</span>&nbsp;<span class="op" id="3748764">(</span><span class="ident" id="3748765">dir</span><span class="op" id="3748768">,</span>&nbsp;<span class="ident" id="3748770">file</span>&nbsp;<span class="builtintype" id="3748775">string</span><span class="op" id="3748781">)</span>&nbsp;<span class="op" id="3748783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748786">i</span>&nbsp;<span class="op" id="3748788">:=</span>&nbsp;<span class="ident" id="3748791">strings</span><span class="op" id="3748798">.</span><span class="ident" id="3748799">LastIndex</span><span class="op" id="3748808">(</span><span class="ident" id="3748809">path</span><span class="op" id="3748813">,</span>&nbsp;<span class="string" id="3748815">&#34;/&#34;</span><span class="op" id="3748818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748821">return</span>&nbsp;<span class="ident" id="3748828">path</span><span class="op" id="3748832">[</span><span class="op" id="3748833">:</span><span class="ident" id="3748834">i</span><span class="op" id="3748835">+</span><span class="num" id="3748836">1</span><span class="op" id="3748837">]</span><span class="op" id="3748838">,</span>&nbsp;<span class="ident" id="3748840">path</span><span class="op" id="3748844">[</span><span class="ident" id="3748845">i</span><span class="op" id="3748846">+</span><span class="num" id="3748847">1</span><span class="op" id="3748848">:</span><span class="op" id="3748849">]</span><br>
<span class="lineno">145</span><span class="op" id="3748851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3748854">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3748925">//&nbsp;separating&nbsp;slash&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned;&nbsp;in&nbsp;particular,</span><br>
<span class="lineno"></span><span class="comment" id="3748997">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">150</span><span class="keyword" id="3749031">func</span>&nbsp;<span class="ident" id="3749036">Join</span><span class="op" id="3749040">(</span><span class="ident" id="3749041">elem</span>&nbsp;<span class="op" id="3749046">...</span><span class="builtintype" id="3749049">string</span><span class="op" id="3749055">)</span>&nbsp;<span class="builtintype" id="3749057">string</span>&nbsp;<span class="op" id="3749064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749067">for</span>&nbsp;<span class="ident" id="3749071">i</span><span class="op" id="3749072">,</span>&nbsp;<span class="ident" id="3749074">e</span>&nbsp;<span class="op" id="3749076">:=</span>&nbsp;<span class="keyword" id="3749079">range</span>&nbsp;<span class="ident" id="3749085">elem</span>&nbsp;<span class="op" id="3749090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749094">if</span>&nbsp;<span class="ident" id="3749097">e</span>&nbsp;<span class="op" id="3749099">!=</span>&nbsp;<span class="string" id="3749102">&#34;&#34;</span>&nbsp;<span class="op" id="3749105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749110">return</span>&nbsp;<span class="ident" id="3749117">Clean</span><span class="op" id="3749122">(</span><span class="ident" id="3749123">strings</span><span class="op" id="3749130">.</span><span class="ident" id="3749131">Join</span><span class="op" id="3749135">(</span><span class="ident" id="3749136">elem</span><span class="op" id="3749140">[</span><span class="ident" id="3749141">i</span><span class="op" id="3749142">:</span><span class="op" id="3749143">]</span><span class="op" id="3749144">,</span>&nbsp;<span class="string" id="3749146">&#34;/&#34;</span><span class="op" id="3749149">)</span><span class="op" id="3749150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749154">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749160">return</span>&nbsp;<span class="string" id="3749167">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3749170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3749173">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno">160</span><span class="comment" id="3749226">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno"></span><span class="comment" id="3749284">//&nbsp;in&nbsp;the&nbsp;final&nbsp;slash-separated&nbsp;element&nbsp;of&nbsp;path;</span><br>
<span class="lineno"></span><span class="comment" id="3749333">//&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3749368">func</span>&nbsp;<span class="ident" id="3749373">Ext</span><span class="op" id="3749376">(</span><span class="ident" id="3749377">path</span>&nbsp;<span class="builtintype" id="3749382">string</span><span class="op" id="3749388">)</span>&nbsp;<span class="builtintype" id="3749390">string</span>&nbsp;<span class="op" id="3749397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749400">for</span>&nbsp;<span class="ident" id="3749404">i</span>&nbsp;<span class="op" id="3749406">:=</span>&nbsp;<span class="builtinfunc" id="3749409">len</span><span class="op" id="3749412">(</span><span class="ident" id="3749413">path</span><span class="op" id="3749417">)</span>&nbsp;<span class="op" id="3749419">-</span>&nbsp;<span class="num" id="3749421">1</span><span class="op" id="3749422">;</span>&nbsp;<span class="ident" id="3749424">i</span>&nbsp;<span class="op" id="3749426">&gt;=</span>&nbsp;<span class="num" id="3749429">0</span>&nbsp;<span class="op" id="3749431">&amp;&amp;</span>&nbsp;<span class="ident" id="3749434">path</span><span class="op" id="3749438">[</span><span class="ident" id="3749439">i</span><span class="op" id="3749440">]</span>&nbsp;<span class="op" id="3749442">!=</span>&nbsp;<span class="string" id="3749445">&#39;/&#39;</span><span class="op" id="3749448">;</span>&nbsp;<span class="ident" id="3749450">i</span><span class="op" id="3749451">--</span>&nbsp;<span class="op" id="3749454">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749458">if</span>&nbsp;<span class="ident" id="3749461">path</span><span class="op" id="3749465">[</span><span class="ident" id="3749466">i</span><span class="op" id="3749467">]</span>&nbsp;<span class="op" id="3749469">==</span>&nbsp;<span class="string" id="3749472">&#39;.&#39;</span>&nbsp;<span class="op" id="3749476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749481">return</span>&nbsp;<span class="ident" id="3749488">path</span><span class="op" id="3749492">[</span><span class="ident" id="3749493">i</span><span class="op" id="3749494">:</span><span class="op" id="3749495">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749505">return</span>&nbsp;<span class="string" id="3749512">&#34;&#34;</span><br>
<span class="lineno">170</span><span class="op" id="3749515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3749518">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3749560">//&nbsp;Trailing&nbsp;slashes&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="3749628">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">175</span><span class="comment" id="3749671">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes,&nbsp;Base&nbsp;returns&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3749734">func</span>&nbsp;<span class="ident" id="3749739">Base</span><span class="op" id="3749743">(</span><span class="ident" id="3749744">path</span>&nbsp;<span class="builtintype" id="3749749">string</span><span class="op" id="3749755">)</span>&nbsp;<span class="builtintype" id="3749757">string</span>&nbsp;<span class="op" id="3749764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749767">if</span>&nbsp;<span class="ident" id="3749770">path</span>&nbsp;<span class="op" id="3749775">==</span>&nbsp;<span class="string" id="3749778">&#34;&#34;</span>&nbsp;<span class="op" id="3749781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749785">return</span>&nbsp;<span class="string" id="3749792">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749797">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3749800">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749828">for</span>&nbsp;<span class="builtinfunc" id="3749832">len</span><span class="op" id="3749835">(</span><span class="ident" id="3749836">path</span><span class="op" id="3749840">)</span>&nbsp;<span class="op" id="3749842">&gt;</span>&nbsp;<span class="num" id="3749844">0</span>&nbsp;<span class="op" id="3749846">&amp;&amp;</span>&nbsp;<span class="ident" id="3749849">path</span><span class="op" id="3749853">[</span><span class="builtinfunc" id="3749854">len</span><span class="op" id="3749857">(</span><span class="ident" id="3749858">path</span><span class="op" id="3749862">)</span><span class="op" id="3749863">-</span><span class="num" id="3749864">1</span><span class="op" id="3749865">]</span>&nbsp;<span class="op" id="3749867">==</span>&nbsp;<span class="string" id="3749870">&#39;/&#39;</span>&nbsp;<span class="op" id="3749874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3749878">path</span>&nbsp;<span class="op" id="3749883">=</span>&nbsp;<span class="ident" id="3749885">path</span><span class="op" id="3749889">[</span><span class="num" id="3749890">0</span>&nbsp;<span class="op" id="3749892">:</span>&nbsp;<span class="builtinfunc" id="3749894">len</span><span class="op" id="3749897">(</span><span class="ident" id="3749898">path</span><span class="op" id="3749902">)</span><span class="op" id="3749903">-</span><span class="num" id="3749904">1</span><span class="op" id="3749905">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3749911">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749937">if</span>&nbsp;<span class="ident" id="3749940">i</span>&nbsp;<span class="op" id="3749942">:=</span>&nbsp;<span class="ident" id="3749945">strings</span><span class="op" id="3749952">.</span><span class="ident" id="3749953">LastIndex</span><span class="op" id="3749962">(</span><span class="ident" id="3749963">path</span><span class="op" id="3749967">,</span>&nbsp;<span class="string" id="3749969">&#34;/&#34;</span><span class="op" id="3749972">)</span><span class="op" id="3749973">;</span>&nbsp;<span class="ident" id="3749975">i</span>&nbsp;<span class="op" id="3749977">&gt;=</span>&nbsp;<span class="num" id="3749980">0</span>&nbsp;<span class="op" id="3749982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3749986">path</span>&nbsp;<span class="op" id="3749991">=</span>&nbsp;<span class="ident" id="3749993">path</span><span class="op" id="3749997">[</span><span class="ident" id="3749998">i</span><span class="op" id="3749999">+</span><span class="num" id="3750000">1</span><span class="op" id="3750001">:</span><span class="op" id="3750002">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3750008">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750047">if</span>&nbsp;<span class="ident" id="3750050">path</span>&nbsp;<span class="op" id="3750055">==</span>&nbsp;<span class="string" id="3750058">&#34;&#34;</span>&nbsp;<span class="op" id="3750061">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750065">return</span>&nbsp;<span class="string" id="3750072">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750080">return</span>&nbsp;<span class="ident" id="3750087">path</span><br>
<span class="lineno"></span><span class="op" id="3750092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="3750095">//&nbsp;IsAbs&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;path&nbsp;is&nbsp;absolute.</span><br>
<span class="lineno"></span><span class="keyword" id="3750142">func</span>&nbsp;<span class="ident" id="3750147">IsAbs</span><span class="op" id="3750152">(</span><span class="ident" id="3750153">path</span>&nbsp;<span class="builtintype" id="3750158">string</span><span class="op" id="3750164">)</span>&nbsp;<span class="builtintype" id="3750166">bool</span>&nbsp;<span class="op" id="3750171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750174">return</span>&nbsp;<span class="builtinfunc" id="3750181">len</span><span class="op" id="3750184">(</span><span class="ident" id="3750185">path</span><span class="op" id="3750189">)</span>&nbsp;<span class="op" id="3750191">&gt;</span>&nbsp;<span class="num" id="3750193">0</span>&nbsp;<span class="op" id="3750195">&amp;&amp;</span>&nbsp;<span class="ident" id="3750198">path</span><span class="op" id="3750202">[</span><span class="num" id="3750203">0</span><span class="op" id="3750204">]</span>&nbsp;<span class="op" id="3750206">==</span>&nbsp;<span class="string" id="3750209">&#39;/&#39;</span><br>
<span class="lineno"></span><span class="op" id="3750213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="3750216">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="3750297">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element&nbsp;using&nbsp;Split,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="3750379">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="3750403">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3750445">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes&nbsp;followed&nbsp;by&nbsp;non-slash&nbsp;bytes,&nbsp;Dir</span><br>
<span class="lineno">205</span><span class="comment" id="3750522">//&nbsp;returns&nbsp;a&nbsp;single&nbsp;slash.&nbsp;In&nbsp;any&nbsp;other&nbsp;case,&nbsp;the&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3750604">//&nbsp;slash.</span><br>
<span class="lineno"></span><span class="keyword" id="3750614">func</span>&nbsp;<span class="ident" id="3750619">Dir</span><span class="op" id="3750622">(</span><span class="ident" id="3750623">path</span>&nbsp;<span class="builtintype" id="3750628">string</span><span class="op" id="3750634">)</span>&nbsp;<span class="builtintype" id="3750636">string</span>&nbsp;<span class="op" id="3750643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750646">dir</span><span class="op" id="3750649">,</span>&nbsp;<span class="ident" id="3750651">_</span>&nbsp;<span class="op" id="3750653">:=</span>&nbsp;<span class="ident" id="3750656">Split</span><span class="op" id="3750661">(</span><span class="ident" id="3750662">path</span><span class="op" id="3750666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750669">return</span>&nbsp;<span class="ident" id="3750676">Clean</span><span class="op" id="3750681">(</span><span class="ident" id="3750682">dir</span><span class="op" id="3750685">)</span><br>
<span class="lineno">210</span><span class="op" id="3750687">}</span>
</div>
</body>
</html>
