<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1987595">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1987650">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1987704">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1987755">package</span>&nbsp;<span class="ident" id="1987763">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1987772">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="1987843">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1987906">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="1987978">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="1988002">type</span>&nbsp;<span class="ident" id="1988007">extFloat</span>&nbsp;<span class="keyword" id="1988016">struct</span>&nbsp;<span class="op" id="1988023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988026">mant</span>&nbsp;<span class="ident" id="1988031">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988039">exp</span>&nbsp;&nbsp;<span class="builtintype" id="1988044">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988049">neg</span>&nbsp;&nbsp;<span class="builtintype" id="1988054">bool</span><br>
<span class="lineno">15</span><span class="op" id="1988059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1988062">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="1988117">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="1988164">const</span>&nbsp;<span class="op" id="1988170">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988173">firstPowerOfTen</span>&nbsp;<span class="op" id="1988189">=</span>&nbsp;<span class="op" id="1988191">-</span><span class="num" id="1988192">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988197">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="1988213">=</span>&nbsp;<span class="num" id="1988215">8</span><br>
<span class="lineno"></span><span class="op" id="1988217">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1988220">var</span>&nbsp;<span class="ident" id="1988224">smallPowersOfTen</span>&nbsp;<span class="op" id="1988241">=</span>&nbsp;<span class="op" id="1988243">[</span><span class="op" id="1988244">...</span><span class="op" id="1988247">]</span><span class="ident" id="1988248">extFloat</span><span class="op" id="1988256">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988259">{</span><span class="num" id="1988260">1</span>&nbsp;<span class="op" id="1988262">&lt;&lt;</span>&nbsp;<span class="num" id="1988265">63</span><span class="op" id="1988267">,</span>&nbsp;<span class="op" id="1988269">-</span><span class="num" id="1988270">63</span><span class="op" id="1988272">,</span>&nbsp;<span class="builtintype" id="1988274">false</span><span class="op" id="1988279">}</span><span class="op" id="1988280">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1988289">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988295">{</span><span class="num" id="1988296">0xa</span>&nbsp;<span class="op" id="1988300">&lt;&lt;</span>&nbsp;<span class="num" id="1988303">60</span><span class="op" id="1988305">,</span>&nbsp;<span class="op" id="1988307">-</span><span class="num" id="1988308">60</span><span class="op" id="1988310">,</span>&nbsp;<span class="builtintype" id="1988312">false</span><span class="op" id="1988317">}</span><span class="op" id="1988318">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1988325">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988333">{</span><span class="num" id="1988334">0x64</span>&nbsp;<span class="op" id="1988339">&lt;&lt;</span>&nbsp;<span class="num" id="1988342">57</span><span class="op" id="1988344">,</span>&nbsp;<span class="op" id="1988346">-</span><span class="num" id="1988347">57</span><span class="op" id="1988349">,</span>&nbsp;<span class="builtintype" id="1988351">false</span><span class="op" id="1988356">}</span><span class="op" id="1988357">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1988363">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988371">{</span><span class="num" id="1988372">0x3e8</span>&nbsp;<span class="op" id="1988378">&lt;&lt;</span>&nbsp;<span class="num" id="1988381">54</span><span class="op" id="1988383">,</span>&nbsp;<span class="op" id="1988385">-</span><span class="num" id="1988386">54</span><span class="op" id="1988388">,</span>&nbsp;<span class="builtintype" id="1988390">false</span><span class="op" id="1988395">}</span><span class="op" id="1988396">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1988401">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988409">{</span><span class="num" id="1988410">0x2710</span>&nbsp;<span class="op" id="1988417">&lt;&lt;</span>&nbsp;<span class="num" id="1988420">50</span><span class="op" id="1988422">,</span>&nbsp;<span class="op" id="1988424">-</span><span class="num" id="1988425">50</span><span class="op" id="1988427">,</span>&nbsp;<span class="builtintype" id="1988429">false</span><span class="op" id="1988434">}</span><span class="op" id="1988435">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1988439">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988447">{</span><span class="num" id="1988448">0x186a0</span>&nbsp;<span class="op" id="1988456">&lt;&lt;</span>&nbsp;<span class="num" id="1988459">47</span><span class="op" id="1988461">,</span>&nbsp;<span class="op" id="1988463">-</span><span class="num" id="1988464">47</span><span class="op" id="1988466">,</span>&nbsp;<span class="builtintype" id="1988468">false</span><span class="op" id="1988473">}</span><span class="op" id="1988474">,</span>&nbsp;&nbsp;<span class="comment" id="1988477">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988485">{</span><span class="num" id="1988486">0xf4240</span>&nbsp;<span class="op" id="1988494">&lt;&lt;</span>&nbsp;<span class="num" id="1988497">44</span><span class="op" id="1988499">,</span>&nbsp;<span class="op" id="1988501">-</span><span class="num" id="1988502">44</span><span class="op" id="1988504">,</span>&nbsp;<span class="builtintype" id="1988506">false</span><span class="op" id="1988511">}</span><span class="op" id="1988512">,</span>&nbsp;&nbsp;<span class="comment" id="1988515">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988523">{</span><span class="num" id="1988524">0x989680</span>&nbsp;<span class="op" id="1988533">&lt;&lt;</span>&nbsp;<span class="num" id="1988536">40</span><span class="op" id="1988538">,</span>&nbsp;<span class="op" id="1988540">-</span><span class="num" id="1988541">40</span><span class="op" id="1988543">,</span>&nbsp;<span class="builtintype" id="1988545">false</span><span class="op" id="1988550">}</span><span class="op" id="1988551">,</span>&nbsp;<span class="comment" id="1988553">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="1988560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="1988563">var</span>&nbsp;<span class="ident" id="1988567">powersOfTen</span>&nbsp;<span class="op" id="1988579">=</span>&nbsp;<span class="op" id="1988581">[</span><span class="op" id="1988582">...</span><span class="op" id="1988585">]</span><span class="ident" id="1988586">extFloat</span><span class="op" id="1988594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988597">{</span><span class="num" id="1988598">0xfa8fd5a0081c0288</span><span class="op" id="1988616">,</span>&nbsp;<span class="op" id="1988618">-</span><span class="num" id="1988619">1220</span><span class="op" id="1988623">,</span>&nbsp;<span class="builtintype" id="1988625">false</span><span class="op" id="1988630">}</span><span class="op" id="1988631">,</span>&nbsp;<span class="comment" id="1988633">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988645">{</span><span class="num" id="1988646">0xbaaee17fa23ebf76</span><span class="op" id="1988664">,</span>&nbsp;<span class="op" id="1988666">-</span><span class="num" id="1988667">1193</span><span class="op" id="1988671">,</span>&nbsp;<span class="builtintype" id="1988673">false</span><span class="op" id="1988678">}</span><span class="op" id="1988679">,</span>&nbsp;<span class="comment" id="1988681">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988693">{</span><span class="num" id="1988694">0x8b16fb203055ac76</span><span class="op" id="1988712">,</span>&nbsp;<span class="op" id="1988714">-</span><span class="num" id="1988715">1166</span><span class="op" id="1988719">,</span>&nbsp;<span class="builtintype" id="1988721">false</span><span class="op" id="1988726">}</span><span class="op" id="1988727">,</span>&nbsp;<span class="comment" id="1988729">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988741">{</span><span class="num" id="1988742">0xcf42894a5dce35ea</span><span class="op" id="1988760">,</span>&nbsp;<span class="op" id="1988762">-</span><span class="num" id="1988763">1140</span><span class="op" id="1988767">,</span>&nbsp;<span class="builtintype" id="1988769">false</span><span class="op" id="1988774">}</span><span class="op" id="1988775">,</span>&nbsp;<span class="comment" id="1988777">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988789">{</span><span class="num" id="1988790">0x9a6bb0aa55653b2d</span><span class="op" id="1988808">,</span>&nbsp;<span class="op" id="1988810">-</span><span class="num" id="1988811">1113</span><span class="op" id="1988815">,</span>&nbsp;<span class="builtintype" id="1988817">false</span><span class="op" id="1988822">}</span><span class="op" id="1988823">,</span>&nbsp;<span class="comment" id="1988825">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988837">{</span><span class="num" id="1988838">0xe61acf033d1a45df</span><span class="op" id="1988856">,</span>&nbsp;<span class="op" id="1988858">-</span><span class="num" id="1988859">1087</span><span class="op" id="1988863">,</span>&nbsp;<span class="builtintype" id="1988865">false</span><span class="op" id="1988870">}</span><span class="op" id="1988871">,</span>&nbsp;<span class="comment" id="1988873">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988885">{</span><span class="num" id="1988886">0xab70fe17c79ac6ca</span><span class="op" id="1988904">,</span>&nbsp;<span class="op" id="1988906">-</span><span class="num" id="1988907">1060</span><span class="op" id="1988911">,</span>&nbsp;<span class="builtintype" id="1988913">false</span><span class="op" id="1988918">}</span><span class="op" id="1988919">,</span>&nbsp;<span class="comment" id="1988921">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988933">{</span><span class="num" id="1988934">0xff77b1fcbebcdc4f</span><span class="op" id="1988952">,</span>&nbsp;<span class="op" id="1988954">-</span><span class="num" id="1988955">1034</span><span class="op" id="1988959">,</span>&nbsp;<span class="builtintype" id="1988961">false</span><span class="op" id="1988966">}</span><span class="op" id="1988967">,</span>&nbsp;<span class="comment" id="1988969">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988981">{</span><span class="num" id="1988982">0xbe5691ef416bd60c</span><span class="op" id="1989000">,</span>&nbsp;<span class="op" id="1989002">-</span><span class="num" id="1989003">1007</span><span class="op" id="1989007">,</span>&nbsp;<span class="builtintype" id="1989009">false</span><span class="op" id="1989014">}</span><span class="op" id="1989015">,</span>&nbsp;<span class="comment" id="1989017">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989029">{</span><span class="num" id="1989030">0x8dd01fad907ffc3c</span><span class="op" id="1989048">,</span>&nbsp;<span class="op" id="1989050">-</span><span class="num" id="1989051">980</span><span class="op" id="1989054">,</span>&nbsp;<span class="builtintype" id="1989056">false</span><span class="op" id="1989061">}</span><span class="op" id="1989062">,</span>&nbsp;&nbsp;<span class="comment" id="1989065">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989077">{</span><span class="num" id="1989078">0xd3515c2831559a83</span><span class="op" id="1989096">,</span>&nbsp;<span class="op" id="1989098">-</span><span class="num" id="1989099">954</span><span class="op" id="1989102">,</span>&nbsp;<span class="builtintype" id="1989104">false</span><span class="op" id="1989109">}</span><span class="op" id="1989110">,</span>&nbsp;&nbsp;<span class="comment" id="1989113">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989125">{</span><span class="num" id="1989126">0x9d71ac8fada6c9b5</span><span class="op" id="1989144">,</span>&nbsp;<span class="op" id="1989146">-</span><span class="num" id="1989147">927</span><span class="op" id="1989150">,</span>&nbsp;<span class="builtintype" id="1989152">false</span><span class="op" id="1989157">}</span><span class="op" id="1989158">,</span>&nbsp;&nbsp;<span class="comment" id="1989161">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989173">{</span><span class="num" id="1989174">0xea9c227723ee8bcb</span><span class="op" id="1989192">,</span>&nbsp;<span class="op" id="1989194">-</span><span class="num" id="1989195">901</span><span class="op" id="1989198">,</span>&nbsp;<span class="builtintype" id="1989200">false</span><span class="op" id="1989205">}</span><span class="op" id="1989206">,</span>&nbsp;&nbsp;<span class="comment" id="1989209">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989221">{</span><span class="num" id="1989222">0xaecc49914078536d</span><span class="op" id="1989240">,</span>&nbsp;<span class="op" id="1989242">-</span><span class="num" id="1989243">874</span><span class="op" id="1989246">,</span>&nbsp;<span class="builtintype" id="1989248">false</span><span class="op" id="1989253">}</span><span class="op" id="1989254">,</span>&nbsp;&nbsp;<span class="comment" id="1989257">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989269">{</span><span class="num" id="1989270">0x823c12795db6ce57</span><span class="op" id="1989288">,</span>&nbsp;<span class="op" id="1989290">-</span><span class="num" id="1989291">847</span><span class="op" id="1989294">,</span>&nbsp;<span class="builtintype" id="1989296">false</span><span class="op" id="1989301">}</span><span class="op" id="1989302">,</span>&nbsp;&nbsp;<span class="comment" id="1989305">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989317">{</span><span class="num" id="1989318">0xc21094364dfb5637</span><span class="op" id="1989336">,</span>&nbsp;<span class="op" id="1989338">-</span><span class="num" id="1989339">821</span><span class="op" id="1989342">,</span>&nbsp;<span class="builtintype" id="1989344">false</span><span class="op" id="1989349">}</span><span class="op" id="1989350">,</span>&nbsp;&nbsp;<span class="comment" id="1989353">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989365">{</span><span class="num" id="1989366">0x9096ea6f3848984f</span><span class="op" id="1989384">,</span>&nbsp;<span class="op" id="1989386">-</span><span class="num" id="1989387">794</span><span class="op" id="1989390">,</span>&nbsp;<span class="builtintype" id="1989392">false</span><span class="op" id="1989397">}</span><span class="op" id="1989398">,</span>&nbsp;&nbsp;<span class="comment" id="1989401">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989413">{</span><span class="num" id="1989414">0xd77485cb25823ac7</span><span class="op" id="1989432">,</span>&nbsp;<span class="op" id="1989434">-</span><span class="num" id="1989435">768</span><span class="op" id="1989438">,</span>&nbsp;<span class="builtintype" id="1989440">false</span><span class="op" id="1989445">}</span><span class="op" id="1989446">,</span>&nbsp;&nbsp;<span class="comment" id="1989449">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989461">{</span><span class="num" id="1989462">0xa086cfcd97bf97f4</span><span class="op" id="1989480">,</span>&nbsp;<span class="op" id="1989482">-</span><span class="num" id="1989483">741</span><span class="op" id="1989486">,</span>&nbsp;<span class="builtintype" id="1989488">false</span><span class="op" id="1989493">}</span><span class="op" id="1989494">,</span>&nbsp;&nbsp;<span class="comment" id="1989497">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989509">{</span><span class="num" id="1989510">0xef340a98172aace5</span><span class="op" id="1989528">,</span>&nbsp;<span class="op" id="1989530">-</span><span class="num" id="1989531">715</span><span class="op" id="1989534">,</span>&nbsp;<span class="builtintype" id="1989536">false</span><span class="op" id="1989541">}</span><span class="op" id="1989542">,</span>&nbsp;&nbsp;<span class="comment" id="1989545">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989557">{</span><span class="num" id="1989558">0xb23867fb2a35b28e</span><span class="op" id="1989576">,</span>&nbsp;<span class="op" id="1989578">-</span><span class="num" id="1989579">688</span><span class="op" id="1989582">,</span>&nbsp;<span class="builtintype" id="1989584">false</span><span class="op" id="1989589">}</span><span class="op" id="1989590">,</span>&nbsp;&nbsp;<span class="comment" id="1989593">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989605">{</span><span class="num" id="1989606">0x84c8d4dfd2c63f3b</span><span class="op" id="1989624">,</span>&nbsp;<span class="op" id="1989626">-</span><span class="num" id="1989627">661</span><span class="op" id="1989630">,</span>&nbsp;<span class="builtintype" id="1989632">false</span><span class="op" id="1989637">}</span><span class="op" id="1989638">,</span>&nbsp;&nbsp;<span class="comment" id="1989641">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989653">{</span><span class="num" id="1989654">0xc5dd44271ad3cdba</span><span class="op" id="1989672">,</span>&nbsp;<span class="op" id="1989674">-</span><span class="num" id="1989675">635</span><span class="op" id="1989678">,</span>&nbsp;<span class="builtintype" id="1989680">false</span><span class="op" id="1989685">}</span><span class="op" id="1989686">,</span>&nbsp;&nbsp;<span class="comment" id="1989689">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989701">{</span><span class="num" id="1989702">0x936b9fcebb25c996</span><span class="op" id="1989720">,</span>&nbsp;<span class="op" id="1989722">-</span><span class="num" id="1989723">608</span><span class="op" id="1989726">,</span>&nbsp;<span class="builtintype" id="1989728">false</span><span class="op" id="1989733">}</span><span class="op" id="1989734">,</span>&nbsp;&nbsp;<span class="comment" id="1989737">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989749">{</span><span class="num" id="1989750">0xdbac6c247d62a584</span><span class="op" id="1989768">,</span>&nbsp;<span class="op" id="1989770">-</span><span class="num" id="1989771">582</span><span class="op" id="1989774">,</span>&nbsp;<span class="builtintype" id="1989776">false</span><span class="op" id="1989781">}</span><span class="op" id="1989782">,</span>&nbsp;&nbsp;<span class="comment" id="1989785">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989797">{</span><span class="num" id="1989798">0xa3ab66580d5fdaf6</span><span class="op" id="1989816">,</span>&nbsp;<span class="op" id="1989818">-</span><span class="num" id="1989819">555</span><span class="op" id="1989822">,</span>&nbsp;<span class="builtintype" id="1989824">false</span><span class="op" id="1989829">}</span><span class="op" id="1989830">,</span>&nbsp;&nbsp;<span class="comment" id="1989833">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989845">{</span><span class="num" id="1989846">0xf3e2f893dec3f126</span><span class="op" id="1989864">,</span>&nbsp;<span class="op" id="1989866">-</span><span class="num" id="1989867">529</span><span class="op" id="1989870">,</span>&nbsp;<span class="builtintype" id="1989872">false</span><span class="op" id="1989877">}</span><span class="op" id="1989878">,</span>&nbsp;&nbsp;<span class="comment" id="1989881">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989893">{</span><span class="num" id="1989894">0xb5b5ada8aaff80b8</span><span class="op" id="1989912">,</span>&nbsp;<span class="op" id="1989914">-</span><span class="num" id="1989915">502</span><span class="op" id="1989918">,</span>&nbsp;<span class="builtintype" id="1989920">false</span><span class="op" id="1989925">}</span><span class="op" id="1989926">,</span>&nbsp;&nbsp;<span class="comment" id="1989929">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989941">{</span><span class="num" id="1989942">0x87625f056c7c4a8b</span><span class="op" id="1989960">,</span>&nbsp;<span class="op" id="1989962">-</span><span class="num" id="1989963">475</span><span class="op" id="1989966">,</span>&nbsp;<span class="builtintype" id="1989968">false</span><span class="op" id="1989973">}</span><span class="op" id="1989974">,</span>&nbsp;&nbsp;<span class="comment" id="1989977">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989989">{</span><span class="num" id="1989990">0xc9bcff6034c13053</span><span class="op" id="1990008">,</span>&nbsp;<span class="op" id="1990010">-</span><span class="num" id="1990011">449</span><span class="op" id="1990014">,</span>&nbsp;<span class="builtintype" id="1990016">false</span><span class="op" id="1990021">}</span><span class="op" id="1990022">,</span>&nbsp;&nbsp;<span class="comment" id="1990025">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990037">{</span><span class="num" id="1990038">0x964e858c91ba2655</span><span class="op" id="1990056">,</span>&nbsp;<span class="op" id="1990058">-</span><span class="num" id="1990059">422</span><span class="op" id="1990062">,</span>&nbsp;<span class="builtintype" id="1990064">false</span><span class="op" id="1990069">}</span><span class="op" id="1990070">,</span>&nbsp;&nbsp;<span class="comment" id="1990073">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990085">{</span><span class="num" id="1990086">0xdff9772470297ebd</span><span class="op" id="1990104">,</span>&nbsp;<span class="op" id="1990106">-</span><span class="num" id="1990107">396</span><span class="op" id="1990110">,</span>&nbsp;<span class="builtintype" id="1990112">false</span><span class="op" id="1990117">}</span><span class="op" id="1990118">,</span>&nbsp;&nbsp;<span class="comment" id="1990121">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990133">{</span><span class="num" id="1990134">0xa6dfbd9fb8e5b88f</span><span class="op" id="1990152">,</span>&nbsp;<span class="op" id="1990154">-</span><span class="num" id="1990155">369</span><span class="op" id="1990158">,</span>&nbsp;<span class="builtintype" id="1990160">false</span><span class="op" id="1990165">}</span><span class="op" id="1990166">,</span>&nbsp;&nbsp;<span class="comment" id="1990169">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990180">{</span><span class="num" id="1990181">0xf8a95fcf88747d94</span><span class="op" id="1990199">,</span>&nbsp;<span class="op" id="1990201">-</span><span class="num" id="1990202">343</span><span class="op" id="1990205">,</span>&nbsp;<span class="builtintype" id="1990207">false</span><span class="op" id="1990212">}</span><span class="op" id="1990213">,</span>&nbsp;&nbsp;<span class="comment" id="1990216">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990227">{</span><span class="num" id="1990228">0xb94470938fa89bcf</span><span class="op" id="1990246">,</span>&nbsp;<span class="op" id="1990248">-</span><span class="num" id="1990249">316</span><span class="op" id="1990252">,</span>&nbsp;<span class="builtintype" id="1990254">false</span><span class="op" id="1990259">}</span><span class="op" id="1990260">,</span>&nbsp;&nbsp;<span class="comment" id="1990263">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990274">{</span><span class="num" id="1990275">0x8a08f0f8bf0f156b</span><span class="op" id="1990293">,</span>&nbsp;<span class="op" id="1990295">-</span><span class="num" id="1990296">289</span><span class="op" id="1990299">,</span>&nbsp;<span class="builtintype" id="1990301">false</span><span class="op" id="1990306">}</span><span class="op" id="1990307">,</span>&nbsp;&nbsp;<span class="comment" id="1990310">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990321">{</span><span class="num" id="1990322">0xcdb02555653131b6</span><span class="op" id="1990340">,</span>&nbsp;<span class="op" id="1990342">-</span><span class="num" id="1990343">263</span><span class="op" id="1990346">,</span>&nbsp;<span class="builtintype" id="1990348">false</span><span class="op" id="1990353">}</span><span class="op" id="1990354">,</span>&nbsp;&nbsp;<span class="comment" id="1990357">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990368">{</span><span class="num" id="1990369">0x993fe2c6d07b7fac</span><span class="op" id="1990387">,</span>&nbsp;<span class="op" id="1990389">-</span><span class="num" id="1990390">236</span><span class="op" id="1990393">,</span>&nbsp;<span class="builtintype" id="1990395">false</span><span class="op" id="1990400">}</span><span class="op" id="1990401">,</span>&nbsp;&nbsp;<span class="comment" id="1990404">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990415">{</span><span class="num" id="1990416">0xe45c10c42a2b3b06</span><span class="op" id="1990434">,</span>&nbsp;<span class="op" id="1990436">-</span><span class="num" id="1990437">210</span><span class="op" id="1990440">,</span>&nbsp;<span class="builtintype" id="1990442">false</span><span class="op" id="1990447">}</span><span class="op" id="1990448">,</span>&nbsp;&nbsp;<span class="comment" id="1990451">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990462">{</span><span class="num" id="1990463">0xaa242499697392d3</span><span class="op" id="1990481">,</span>&nbsp;<span class="op" id="1990483">-</span><span class="num" id="1990484">183</span><span class="op" id="1990487">,</span>&nbsp;<span class="builtintype" id="1990489">false</span><span class="op" id="1990494">}</span><span class="op" id="1990495">,</span>&nbsp;&nbsp;<span class="comment" id="1990498">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990509">{</span><span class="num" id="1990510">0xfd87b5f28300ca0e</span><span class="op" id="1990528">,</span>&nbsp;<span class="op" id="1990530">-</span><span class="num" id="1990531">157</span><span class="op" id="1990534">,</span>&nbsp;<span class="builtintype" id="1990536">false</span><span class="op" id="1990541">}</span><span class="op" id="1990542">,</span>&nbsp;&nbsp;<span class="comment" id="1990545">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990556">{</span><span class="num" id="1990557">0xbce5086492111aeb</span><span class="op" id="1990575">,</span>&nbsp;<span class="op" id="1990577">-</span><span class="num" id="1990578">130</span><span class="op" id="1990581">,</span>&nbsp;<span class="builtintype" id="1990583">false</span><span class="op" id="1990588">}</span><span class="op" id="1990589">,</span>&nbsp;&nbsp;<span class="comment" id="1990592">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990603">{</span><span class="num" id="1990604">0x8cbccc096f5088cc</span><span class="op" id="1990622">,</span>&nbsp;<span class="op" id="1990624">-</span><span class="num" id="1990625">103</span><span class="op" id="1990628">,</span>&nbsp;<span class="builtintype" id="1990630">false</span><span class="op" id="1990635">}</span><span class="op" id="1990636">,</span>&nbsp;&nbsp;<span class="comment" id="1990639">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990650">{</span><span class="num" id="1990651">0xd1b71758e219652c</span><span class="op" id="1990669">,</span>&nbsp;<span class="op" id="1990671">-</span><span class="num" id="1990672">77</span><span class="op" id="1990674">,</span>&nbsp;<span class="builtintype" id="1990676">false</span><span class="op" id="1990681">}</span><span class="op" id="1990682">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1990686">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990696">{</span><span class="num" id="1990697">0x9c40000000000000</span><span class="op" id="1990715">,</span>&nbsp;<span class="op" id="1990717">-</span><span class="num" id="1990718">50</span><span class="op" id="1990720">,</span>&nbsp;<span class="builtintype" id="1990722">false</span><span class="op" id="1990727">}</span><span class="op" id="1990728">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1990732">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990741">{</span><span class="num" id="1990742">0xe8d4a51000000000</span><span class="op" id="1990760">,</span>&nbsp;<span class="op" id="1990762">-</span><span class="num" id="1990763">24</span><span class="op" id="1990765">,</span>&nbsp;<span class="builtintype" id="1990767">false</span><span class="op" id="1990772">}</span><span class="op" id="1990773">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1990777">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990787">{</span><span class="num" id="1990788">0xad78ebc5ac620000</span><span class="op" id="1990806">,</span>&nbsp;<span class="num" id="1990808">3</span><span class="op" id="1990809">,</span>&nbsp;<span class="builtintype" id="1990811">false</span><span class="op" id="1990816">}</span><span class="op" id="1990817">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1990823">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990833">{</span><span class="num" id="1990834">0x813f3978f8940984</span><span class="op" id="1990852">,</span>&nbsp;<span class="num" id="1990854">30</span><span class="op" id="1990856">,</span>&nbsp;<span class="builtintype" id="1990858">false</span><span class="op" id="1990863">}</span><span class="op" id="1990864">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1990869">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990879">{</span><span class="num" id="1990880">0xc097ce7bc90715b3</span><span class="op" id="1990898">,</span>&nbsp;<span class="num" id="1990900">56</span><span class="op" id="1990902">,</span>&nbsp;<span class="builtintype" id="1990904">false</span><span class="op" id="1990909">}</span><span class="op" id="1990910">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1990915">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990925">{</span><span class="num" id="1990926">0x8f7e32ce7bea5c70</span><span class="op" id="1990944">,</span>&nbsp;<span class="num" id="1990946">83</span><span class="op" id="1990948">,</span>&nbsp;<span class="builtintype" id="1990950">false</span><span class="op" id="1990955">}</span><span class="op" id="1990956">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1990961">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990971">{</span><span class="num" id="1990972">0xd5d238a4abe98068</span><span class="op" id="1990990">,</span>&nbsp;<span class="num" id="1990992">109</span><span class="op" id="1990995">,</span>&nbsp;<span class="builtintype" id="1990997">false</span><span class="op" id="1991002">}</span><span class="op" id="1991003">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991007">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991017">{</span><span class="num" id="1991018">0x9f4f2726179a2245</span><span class="op" id="1991036">,</span>&nbsp;<span class="num" id="1991038">136</span><span class="op" id="1991041">,</span>&nbsp;<span class="builtintype" id="1991043">false</span><span class="op" id="1991048">}</span><span class="op" id="1991049">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991053">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991063">{</span><span class="num" id="1991064">0xed63a231d4c4fb27</span><span class="op" id="1991082">,</span>&nbsp;<span class="num" id="1991084">162</span><span class="op" id="1991087">,</span>&nbsp;<span class="builtintype" id="1991089">false</span><span class="op" id="1991094">}</span><span class="op" id="1991095">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991099">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991109">{</span><span class="num" id="1991110">0xb0de65388cc8ada8</span><span class="op" id="1991128">,</span>&nbsp;<span class="num" id="1991130">189</span><span class="op" id="1991133">,</span>&nbsp;<span class="builtintype" id="1991135">false</span><span class="op" id="1991140">}</span><span class="op" id="1991141">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991145">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991155">{</span><span class="num" id="1991156">0x83c7088e1aab65db</span><span class="op" id="1991174">,</span>&nbsp;<span class="num" id="1991176">216</span><span class="op" id="1991179">,</span>&nbsp;<span class="builtintype" id="1991181">false</span><span class="op" id="1991186">}</span><span class="op" id="1991187">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991191">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991201">{</span><span class="num" id="1991202">0xc45d1df942711d9a</span><span class="op" id="1991220">,</span>&nbsp;<span class="num" id="1991222">242</span><span class="op" id="1991225">,</span>&nbsp;<span class="builtintype" id="1991227">false</span><span class="op" id="1991232">}</span><span class="op" id="1991233">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991237">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991247">{</span><span class="num" id="1991248">0x924d692ca61be758</span><span class="op" id="1991266">,</span>&nbsp;<span class="num" id="1991268">269</span><span class="op" id="1991271">,</span>&nbsp;<span class="builtintype" id="1991273">false</span><span class="op" id="1991278">}</span><span class="op" id="1991279">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991283">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991294">{</span><span class="num" id="1991295">0xda01ee641a708dea</span><span class="op" id="1991313">,</span>&nbsp;<span class="num" id="1991315">295</span><span class="op" id="1991318">,</span>&nbsp;<span class="builtintype" id="1991320">false</span><span class="op" id="1991325">}</span><span class="op" id="1991326">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991330">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991341">{</span><span class="num" id="1991342">0xa26da3999aef774a</span><span class="op" id="1991360">,</span>&nbsp;<span class="num" id="1991362">322</span><span class="op" id="1991365">,</span>&nbsp;<span class="builtintype" id="1991367">false</span><span class="op" id="1991372">}</span><span class="op" id="1991373">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991377">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991388">{</span><span class="num" id="1991389">0xf209787bb47d6b85</span><span class="op" id="1991407">,</span>&nbsp;<span class="num" id="1991409">348</span><span class="op" id="1991412">,</span>&nbsp;<span class="builtintype" id="1991414">false</span><span class="op" id="1991419">}</span><span class="op" id="1991420">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991424">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991435">{</span><span class="num" id="1991436">0xb454e4a179dd1877</span><span class="op" id="1991454">,</span>&nbsp;<span class="num" id="1991456">375</span><span class="op" id="1991459">,</span>&nbsp;<span class="builtintype" id="1991461">false</span><span class="op" id="1991466">}</span><span class="op" id="1991467">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991471">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991482">{</span><span class="num" id="1991483">0x865b86925b9bc5c2</span><span class="op" id="1991501">,</span>&nbsp;<span class="num" id="1991503">402</span><span class="op" id="1991506">,</span>&nbsp;<span class="builtintype" id="1991508">false</span><span class="op" id="1991513">}</span><span class="op" id="1991514">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991518">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991529">{</span><span class="num" id="1991530">0xc83553c5c8965d3d</span><span class="op" id="1991548">,</span>&nbsp;<span class="num" id="1991550">428</span><span class="op" id="1991553">,</span>&nbsp;<span class="builtintype" id="1991555">false</span><span class="op" id="1991560">}</span><span class="op" id="1991561">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991565">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991576">{</span><span class="num" id="1991577">0x952ab45cfa97a0b3</span><span class="op" id="1991595">,</span>&nbsp;<span class="num" id="1991597">455</span><span class="op" id="1991600">,</span>&nbsp;<span class="builtintype" id="1991602">false</span><span class="op" id="1991607">}</span><span class="op" id="1991608">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991612">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991623">{</span><span class="num" id="1991624">0xde469fbd99a05fe3</span><span class="op" id="1991642">,</span>&nbsp;<span class="num" id="1991644">481</span><span class="op" id="1991647">,</span>&nbsp;<span class="builtintype" id="1991649">false</span><span class="op" id="1991654">}</span><span class="op" id="1991655">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991659">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991670">{</span><span class="num" id="1991671">0xa59bc234db398c25</span><span class="op" id="1991689">,</span>&nbsp;<span class="num" id="1991691">508</span><span class="op" id="1991694">,</span>&nbsp;<span class="builtintype" id="1991696">false</span><span class="op" id="1991701">}</span><span class="op" id="1991702">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991706">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991717">{</span><span class="num" id="1991718">0xf6c69a72a3989f5c</span><span class="op" id="1991736">,</span>&nbsp;<span class="num" id="1991738">534</span><span class="op" id="1991741">,</span>&nbsp;<span class="builtintype" id="1991743">false</span><span class="op" id="1991748">}</span><span class="op" id="1991749">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991753">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991764">{</span><span class="num" id="1991765">0xb7dcbf5354e9bece</span><span class="op" id="1991783">,</span>&nbsp;<span class="num" id="1991785">561</span><span class="op" id="1991788">,</span>&nbsp;<span class="builtintype" id="1991790">false</span><span class="op" id="1991795">}</span><span class="op" id="1991796">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991800">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991811">{</span><span class="num" id="1991812">0x88fcf317f22241e2</span><span class="op" id="1991830">,</span>&nbsp;<span class="num" id="1991832">588</span><span class="op" id="1991835">,</span>&nbsp;<span class="builtintype" id="1991837">false</span><span class="op" id="1991842">}</span><span class="op" id="1991843">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991847">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991858">{</span><span class="num" id="1991859">0xcc20ce9bd35c78a5</span><span class="op" id="1991877">,</span>&nbsp;<span class="num" id="1991879">614</span><span class="op" id="1991882">,</span>&nbsp;<span class="builtintype" id="1991884">false</span><span class="op" id="1991889">}</span><span class="op" id="1991890">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991894">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991905">{</span><span class="num" id="1991906">0x98165af37b2153df</span><span class="op" id="1991924">,</span>&nbsp;<span class="num" id="1991926">641</span><span class="op" id="1991929">,</span>&nbsp;<span class="builtintype" id="1991931">false</span><span class="op" id="1991936">}</span><span class="op" id="1991937">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991941">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991952">{</span><span class="num" id="1991953">0xe2a0b5dc971f303a</span><span class="op" id="1991971">,</span>&nbsp;<span class="num" id="1991973">667</span><span class="op" id="1991976">,</span>&nbsp;<span class="builtintype" id="1991978">false</span><span class="op" id="1991983">}</span><span class="op" id="1991984">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1991988">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991999">{</span><span class="num" id="1992000">0xa8d9d1535ce3b396</span><span class="op" id="1992018">,</span>&nbsp;<span class="num" id="1992020">694</span><span class="op" id="1992023">,</span>&nbsp;<span class="builtintype" id="1992025">false</span><span class="op" id="1992030">}</span><span class="op" id="1992031">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992035">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992046">{</span><span class="num" id="1992047">0xfb9b7cd9a4a7443c</span><span class="op" id="1992065">,</span>&nbsp;<span class="num" id="1992067">720</span><span class="op" id="1992070">,</span>&nbsp;<span class="builtintype" id="1992072">false</span><span class="op" id="1992077">}</span><span class="op" id="1992078">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992082">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992093">{</span><span class="num" id="1992094">0xbb764c4ca7a44410</span><span class="op" id="1992112">,</span>&nbsp;<span class="num" id="1992114">747</span><span class="op" id="1992117">,</span>&nbsp;<span class="builtintype" id="1992119">false</span><span class="op" id="1992124">}</span><span class="op" id="1992125">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992129">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992140">{</span><span class="num" id="1992141">0x8bab8eefb6409c1a</span><span class="op" id="1992159">,</span>&nbsp;<span class="num" id="1992161">774</span><span class="op" id="1992164">,</span>&nbsp;<span class="builtintype" id="1992166">false</span><span class="op" id="1992171">}</span><span class="op" id="1992172">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992176">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992187">{</span><span class="num" id="1992188">0xd01fef10a657842c</span><span class="op" id="1992206">,</span>&nbsp;<span class="num" id="1992208">800</span><span class="op" id="1992211">,</span>&nbsp;<span class="builtintype" id="1992213">false</span><span class="op" id="1992218">}</span><span class="op" id="1992219">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992223">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992234">{</span><span class="num" id="1992235">0x9b10a4e5e9913129</span><span class="op" id="1992253">,</span>&nbsp;<span class="num" id="1992255">827</span><span class="op" id="1992258">,</span>&nbsp;<span class="builtintype" id="1992260">false</span><span class="op" id="1992265">}</span><span class="op" id="1992266">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992270">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992281">{</span><span class="num" id="1992282">0xe7109bfba19c0c9d</span><span class="op" id="1992300">,</span>&nbsp;<span class="num" id="1992302">853</span><span class="op" id="1992305">,</span>&nbsp;<span class="builtintype" id="1992307">false</span><span class="op" id="1992312">}</span><span class="op" id="1992313">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992317">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992328">{</span><span class="num" id="1992329">0xac2820d9623bf429</span><span class="op" id="1992347">,</span>&nbsp;<span class="num" id="1992349">880</span><span class="op" id="1992352">,</span>&nbsp;<span class="builtintype" id="1992354">false</span><span class="op" id="1992359">}</span><span class="op" id="1992360">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992364">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992375">{</span><span class="num" id="1992376">0x80444b5e7aa7cf85</span><span class="op" id="1992394">,</span>&nbsp;<span class="num" id="1992396">907</span><span class="op" id="1992399">,</span>&nbsp;<span class="builtintype" id="1992401">false</span><span class="op" id="1992406">}</span><span class="op" id="1992407">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992411">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992422">{</span><span class="num" id="1992423">0xbf21e44003acdd2d</span><span class="op" id="1992441">,</span>&nbsp;<span class="num" id="1992443">933</span><span class="op" id="1992446">,</span>&nbsp;<span class="builtintype" id="1992448">false</span><span class="op" id="1992453">}</span><span class="op" id="1992454">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992458">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992469">{</span><span class="num" id="1992470">0x8e679c2f5e44ff8f</span><span class="op" id="1992488">,</span>&nbsp;<span class="num" id="1992490">960</span><span class="op" id="1992493">,</span>&nbsp;<span class="builtintype" id="1992495">false</span><span class="op" id="1992500">}</span><span class="op" id="1992501">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992505">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992516">{</span><span class="num" id="1992517">0xd433179d9c8cb841</span><span class="op" id="1992535">,</span>&nbsp;<span class="num" id="1992537">986</span><span class="op" id="1992540">,</span>&nbsp;<span class="builtintype" id="1992542">false</span><span class="op" id="1992547">}</span><span class="op" id="1992548">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1992552">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992563">{</span><span class="num" id="1992564">0x9e19db92b4e31ba9</span><span class="op" id="1992582">,</span>&nbsp;<span class="num" id="1992584">1013</span><span class="op" id="1992588">,</span>&nbsp;<span class="builtintype" id="1992590">false</span><span class="op" id="1992595">}</span><span class="op" id="1992596">,</span>&nbsp;&nbsp;<span class="comment" id="1992599">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992610">{</span><span class="num" id="1992611">0xeb96bf6ebadf77d9</span><span class="op" id="1992629">,</span>&nbsp;<span class="num" id="1992631">1039</span><span class="op" id="1992635">,</span>&nbsp;<span class="builtintype" id="1992637">false</span><span class="op" id="1992642">}</span><span class="op" id="1992643">,</span>&nbsp;&nbsp;<span class="comment" id="1992646">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992657">{</span><span class="num" id="1992658">0xaf87023b9bf0ee6b</span><span class="op" id="1992676">,</span>&nbsp;<span class="num" id="1992678">1066</span><span class="op" id="1992682">,</span>&nbsp;<span class="builtintype" id="1992684">false</span><span class="op" id="1992689">}</span><span class="op" id="1992690">,</span>&nbsp;&nbsp;<span class="comment" id="1992693">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="1992703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1992706">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="1992774">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1992837">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;±Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="1992872">func</span>&nbsp;<span class="op" id="1992877">(</span><span class="ident" id="1992878">f</span>&nbsp;<span class="op" id="1992880">*</span><span class="ident" id="1992881">extFloat</span><span class="op" id="1992889">)</span>&nbsp;<span class="ident" id="1992891">floatBits</span><span class="op" id="1992900">(</span><span class="ident" id="1992901">flt</span>&nbsp;<span class="op" id="1992905">*</span><span class="ident" id="1992906">floatInfo</span><span class="op" id="1992915">)</span>&nbsp;<span class="op" id="1992917">(</span><span class="ident" id="1992918">bits</span>&nbsp;<span class="ident" id="1992923">uint64</span><span class="op" id="1992929">,</span>&nbsp;<span class="ident" id="1992931">overflow</span>&nbsp;<span class="builtintype" id="1992940">bool</span><span class="op" id="1992944">)</span>&nbsp;<span class="op" id="1992946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992949">f</span><span class="op" id="1992950">.</span><span class="ident" id="1992951">Normalize</span><span class="op" id="1992960">(</span><span class="op" id="1992961">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992965">exp</span>&nbsp;<span class="op" id="1992969">:=</span>&nbsp;<span class="ident" id="1992972">f</span><span class="op" id="1992973">.</span><span class="ident" id="1992974">exp</span>&nbsp;<span class="op" id="1992978">+</span>&nbsp;<span class="num" id="1992980">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1992985">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993009">if</span>&nbsp;<span class="ident" id="1993012">exp</span>&nbsp;<span class="op" id="1993016">&lt;</span>&nbsp;<span class="ident" id="1993018">flt</span><span class="op" id="1993021">.</span><span class="ident" id="1993022">bias</span><span class="op" id="1993026">+</span><span class="num" id="1993027">1</span>&nbsp;<span class="op" id="1993029">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993033">n</span>&nbsp;<span class="op" id="1993035">:=</span>&nbsp;<span class="ident" id="1993038">flt</span><span class="op" id="1993041">.</span><span class="ident" id="1993042">bias</span>&nbsp;<span class="op" id="1993047">+</span>&nbsp;<span class="num" id="1993049">1</span>&nbsp;<span class="op" id="1993051">-</span>&nbsp;<span class="ident" id="1993053">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993059">f</span><span class="op" id="1993060">.</span><span class="ident" id="1993061">mant</span>&nbsp;<span class="op" id="1993066">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="1993070">uint</span><span class="op" id="1993074">(</span><span class="ident" id="1993075">n</span><span class="op" id="1993076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993080">exp</span>&nbsp;<span class="op" id="1993084">+=</span>&nbsp;<span class="ident" id="1993087">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1993094">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993152">mant</span>&nbsp;<span class="op" id="1993157">:=</span>&nbsp;<span class="ident" id="1993160">f</span><span class="op" id="1993161">.</span><span class="ident" id="1993162">mant</span>&nbsp;<span class="op" id="1993167">&gt;&gt;</span>&nbsp;<span class="op" id="1993170">(</span><span class="num" id="1993171">63</span>&nbsp;<span class="op" id="1993174">-</span>&nbsp;<span class="ident" id="1993176">flt</span><span class="op" id="1993179">.</span><span class="ident" id="1993180">mantbits</span><span class="op" id="1993188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993191">if</span>&nbsp;<span class="ident" id="1993194">f</span><span class="op" id="1993195">.</span><span class="ident" id="1993196">mant</span><span class="op" id="1993200">&amp;</span><span class="op" id="1993201">(</span><span class="num" id="1993202">1</span><span class="op" id="1993203">&lt;&lt;</span><span class="op" id="1993205">(</span><span class="num" id="1993206">62</span><span class="op" id="1993208">-</span><span class="ident" id="1993209">flt</span><span class="op" id="1993212">.</span><span class="ident" id="1993213">mantbits</span><span class="op" id="1993221">)</span><span class="op" id="1993222">)</span>&nbsp;<span class="op" id="1993224">!=</span>&nbsp;<span class="num" id="1993227">0</span>&nbsp;<span class="op" id="1993229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1993233">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993248">mant</span>&nbsp;<span class="op" id="1993253">+=</span>&nbsp;<span class="num" id="1993256">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1993263">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993312">if</span>&nbsp;<span class="ident" id="1993315">mant</span>&nbsp;<span class="op" id="1993320">==</span>&nbsp;<span class="num" id="1993323">2</span><span class="op" id="1993324">&lt;&lt;</span><span class="ident" id="1993326">flt</span><span class="op" id="1993329">.</span><span class="ident" id="1993330">mantbits</span>&nbsp;<span class="op" id="1993339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993343">mant</span>&nbsp;<span class="op" id="1993348">&gt;&gt;=</span>&nbsp;<span class="num" id="1993352">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993356">exp</span><span class="op" id="1993359">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1993367">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993383">if</span>&nbsp;<span class="ident" id="1993386">exp</span><span class="op" id="1993389">-</span><span class="ident" id="1993390">flt</span><span class="op" id="1993393">.</span><span class="ident" id="1993394">bias</span>&nbsp;<span class="op" id="1993399">&gt;=</span>&nbsp;<span class="num" id="1993402">1</span><span class="op" id="1993403">&lt;&lt;</span><span class="ident" id="1993405">flt</span><span class="op" id="1993408">.</span><span class="ident" id="1993409">expbits</span><span class="op" id="1993416">-</span><span class="num" id="1993417">1</span>&nbsp;<span class="op" id="1993419">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1993423">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993434">mant</span>&nbsp;<span class="op" id="1993439">=</span>&nbsp;<span class="num" id="1993441">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993445">exp</span>&nbsp;<span class="op" id="1993449">=</span>&nbsp;<span class="num" id="1993451">1</span><span class="op" id="1993452">&lt;&lt;</span><span class="ident" id="1993454">flt</span><span class="op" id="1993457">.</span><span class="ident" id="1993458">expbits</span>&nbsp;<span class="op" id="1993466">-</span>&nbsp;<span class="num" id="1993468">1</span>&nbsp;<span class="op" id="1993470">+</span>&nbsp;<span class="ident" id="1993472">flt</span><span class="op" id="1993475">.</span><span class="ident" id="1993476">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993483">overflow</span>&nbsp;<span class="op" id="1993492">=</span>&nbsp;<span class="builtintype" id="1993494">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993500">}</span>&nbsp;<span class="keyword" id="1993502">else</span>&nbsp;<span class="keyword" id="1993507">if</span>&nbsp;<span class="ident" id="1993510">mant</span><span class="op" id="1993514">&amp;</span><span class="op" id="1993515">(</span><span class="num" id="1993516">1</span><span class="op" id="1993517">&lt;&lt;</span><span class="ident" id="1993519">flt</span><span class="op" id="1993522">.</span><span class="ident" id="1993523">mantbits</span><span class="op" id="1993531">)</span>&nbsp;<span class="op" id="1993533">==</span>&nbsp;<span class="num" id="1993536">0</span>&nbsp;<span class="op" id="1993538">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1993542">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993561">exp</span>&nbsp;<span class="op" id="1993565">=</span>&nbsp;<span class="ident" id="1993567">flt</span><span class="op" id="1993570">.</span><span class="ident" id="1993571">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1993580">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993599">bits</span>&nbsp;<span class="op" id="1993604">=</span>&nbsp;<span class="ident" id="1993606">mant</span>&nbsp;<span class="op" id="1993611">&amp;</span>&nbsp;<span class="op" id="1993613">(</span><span class="ident" id="1993614">uint64</span><span class="op" id="1993620">(</span><span class="num" id="1993621">1</span><span class="op" id="1993622">)</span><span class="op" id="1993623">&lt;&lt;</span><span class="ident" id="1993625">flt</span><span class="op" id="1993628">.</span><span class="ident" id="1993629">mantbits</span>&nbsp;<span class="op" id="1993638">-</span>&nbsp;<span class="num" id="1993640">1</span><span class="op" id="1993641">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993644">bits</span>&nbsp;<span class="op" id="1993649">|=</span>&nbsp;<span class="ident" id="1993652">uint64</span><span class="op" id="1993658">(</span><span class="op" id="1993659">(</span><span class="ident" id="1993660">exp</span><span class="op" id="1993663">-</span><span class="ident" id="1993664">flt</span><span class="op" id="1993667">.</span><span class="ident" id="1993668">bias</span><span class="op" id="1993672">)</span><span class="op" id="1993673">&amp;</span><span class="op" id="1993674">(</span><span class="num" id="1993675">1</span><span class="op" id="1993676">&lt;&lt;</span><span class="ident" id="1993678">flt</span><span class="op" id="1993681">.</span><span class="ident" id="1993682">expbits</span><span class="op" id="1993689">-</span><span class="num" id="1993690">1</span><span class="op" id="1993691">)</span><span class="op" id="1993692">)</span>&nbsp;<span class="op" id="1993694">&lt;&lt;</span>&nbsp;<span class="ident" id="1993697">flt</span><span class="op" id="1993700">.</span><span class="ident" id="1993701">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993711">if</span>&nbsp;<span class="ident" id="1993714">f</span><span class="op" id="1993715">.</span><span class="ident" id="1993716">neg</span>&nbsp;<span class="op" id="1993720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993724">bits</span>&nbsp;<span class="op" id="1993729">|=</span>&nbsp;<span class="num" id="1993732">1</span>&nbsp;<span class="op" id="1993734">&lt;&lt;</span>&nbsp;<span class="op" id="1993737">(</span><span class="ident" id="1993738">flt</span><span class="op" id="1993741">.</span><span class="ident" id="1993742">mantbits</span>&nbsp;<span class="op" id="1993751">+</span>&nbsp;<span class="ident" id="1993753">flt</span><span class="op" id="1993756">.</span><span class="ident" id="1993757">expbits</span><span class="op" id="1993764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993770">return</span><br>
<span class="lineno">170</span><span class="op" id="1993777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1993780">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="1993838">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="1993901">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="1993961">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="1994032">func</span>&nbsp;<span class="op" id="1994037">(</span><span class="ident" id="1994038">f</span>&nbsp;<span class="op" id="1994040">*</span><span class="ident" id="1994041">extFloat</span><span class="op" id="1994049">)</span>&nbsp;<span class="ident" id="1994051">AssignComputeBounds</span><span class="op" id="1994070">(</span><span class="ident" id="1994071">mant</span>&nbsp;<span class="ident" id="1994076">uint64</span><span class="op" id="1994082">,</span>&nbsp;<span class="ident" id="1994084">exp</span>&nbsp;<span class="builtintype" id="1994088">int</span><span class="op" id="1994091">,</span>&nbsp;<span class="ident" id="1994093">neg</span>&nbsp;<span class="builtintype" id="1994097">bool</span><span class="op" id="1994101">,</span>&nbsp;<span class="ident" id="1994103">flt</span>&nbsp;<span class="op" id="1994107">*</span><span class="ident" id="1994108">floatInfo</span><span class="op" id="1994117">)</span>&nbsp;<span class="op" id="1994119">(</span><span class="ident" id="1994120">lower</span><span class="op" id="1994125">,</span>&nbsp;<span class="ident" id="1994127">upper</span>&nbsp;<span class="ident" id="1994133">extFloat</span><span class="op" id="1994141">)</span>&nbsp;<span class="op" id="1994143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994146">f</span><span class="op" id="1994147">.</span><span class="ident" id="1994148">mant</span>&nbsp;<span class="op" id="1994153">=</span>&nbsp;<span class="ident" id="1994155">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994161">f</span><span class="op" id="1994162">.</span><span class="ident" id="1994163">exp</span>&nbsp;<span class="op" id="1994167">=</span>&nbsp;<span class="ident" id="1994169">exp</span>&nbsp;<span class="op" id="1994173">-</span>&nbsp;<span class="builtintype" id="1994175">int</span><span class="op" id="1994178">(</span><span class="ident" id="1994179">flt</span><span class="op" id="1994182">.</span><span class="ident" id="1994183">mantbits</span><span class="op" id="1994191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994194">f</span><span class="op" id="1994195">.</span><span class="ident" id="1994196">neg</span>&nbsp;<span class="op" id="1994200">=</span>&nbsp;<span class="ident" id="1994202">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994207">if</span>&nbsp;<span class="ident" id="1994210">f</span><span class="op" id="1994211">.</span><span class="ident" id="1994212">exp</span>&nbsp;<span class="op" id="1994216">&lt;=</span>&nbsp;<span class="num" id="1994219">0</span>&nbsp;<span class="op" id="1994221">&amp;&amp;</span>&nbsp;<span class="ident" id="1994224">mant</span>&nbsp;<span class="op" id="1994229">==</span>&nbsp;<span class="op" id="1994232">(</span><span class="ident" id="1994233">mant</span><span class="op" id="1994237">&gt;&gt;</span><span class="builtintype" id="1994239">uint</span><span class="op" id="1994243">(</span><span class="op" id="1994244">-</span><span class="ident" id="1994245">f</span><span class="op" id="1994246">.</span><span class="ident" id="1994247">exp</span><span class="op" id="1994250">)</span><span class="op" id="1994251">)</span><span class="op" id="1994252">&lt;&lt;</span><span class="builtintype" id="1994254">uint</span><span class="op" id="1994258">(</span><span class="op" id="1994259">-</span><span class="ident" id="1994260">f</span><span class="op" id="1994261">.</span><span class="ident" id="1994262">exp</span><span class="op" id="1994265">)</span>&nbsp;<span class="op" id="1994267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994271">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994293">f</span><span class="op" id="1994294">.</span><span class="ident" id="1994295">mant</span>&nbsp;<span class="op" id="1994300">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="1994304">uint</span><span class="op" id="1994308">(</span><span class="op" id="1994309">-</span><span class="ident" id="1994310">f</span><span class="op" id="1994311">.</span><span class="ident" id="1994312">exp</span><span class="op" id="1994315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994319">f</span><span class="op" id="1994320">.</span><span class="ident" id="1994321">exp</span>&nbsp;<span class="op" id="1994325">=</span>&nbsp;<span class="num" id="1994327">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994331">return</span>&nbsp;<span class="op" id="1994338">*</span><span class="ident" id="1994339">f</span><span class="op" id="1994340">,</span>&nbsp;<span class="op" id="1994342">*</span><span class="ident" id="1994343">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994349">expBiased</span>&nbsp;<span class="op" id="1994359">:=</span>&nbsp;<span class="ident" id="1994362">exp</span>&nbsp;<span class="op" id="1994366">-</span>&nbsp;<span class="ident" id="1994368">flt</span><span class="op" id="1994371">.</span><span class="ident" id="1994372">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994379">upper</span>&nbsp;<span class="op" id="1994385">=</span>&nbsp;<span class="ident" id="1994387">extFloat</span><span class="op" id="1994395">{</span><span class="ident" id="1994396">mant</span><span class="op" id="1994400">:</span>&nbsp;<span class="num" id="1994402">2</span><span class="op" id="1994403">*</span><span class="ident" id="1994404">f</span><span class="op" id="1994405">.</span><span class="ident" id="1994406">mant</span>&nbsp;<span class="op" id="1994411">+</span>&nbsp;<span class="num" id="1994413">1</span><span class="op" id="1994414">,</span>&nbsp;<span class="ident" id="1994416">exp</span><span class="op" id="1994419">:</span>&nbsp;<span class="ident" id="1994421">f</span><span class="op" id="1994422">.</span><span class="ident" id="1994423">exp</span>&nbsp;<span class="op" id="1994427">-</span>&nbsp;<span class="num" id="1994429">1</span><span class="op" id="1994430">,</span>&nbsp;<span class="ident" id="1994432">neg</span><span class="op" id="1994435">:</span>&nbsp;<span class="ident" id="1994437">f</span><span class="op" id="1994438">.</span><span class="ident" id="1994439">neg</span><span class="op" id="1994442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994445">if</span>&nbsp;<span class="ident" id="1994448">mant</span>&nbsp;<span class="op" id="1994453">!=</span>&nbsp;<span class="num" id="1994456">1</span><span class="op" id="1994457">&lt;&lt;</span><span class="ident" id="1994459">flt</span><span class="op" id="1994462">.</span><span class="ident" id="1994463">mantbits</span>&nbsp;<span class="op" id="1994472">||</span>&nbsp;<span class="ident" id="1994475">expBiased</span>&nbsp;<span class="op" id="1994485">==</span>&nbsp;<span class="num" id="1994488">1</span>&nbsp;<span class="op" id="1994490">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994494">lower</span>&nbsp;<span class="op" id="1994500">=</span>&nbsp;<span class="ident" id="1994502">extFloat</span><span class="op" id="1994510">{</span><span class="ident" id="1994511">mant</span><span class="op" id="1994515">:</span>&nbsp;<span class="num" id="1994517">2</span><span class="op" id="1994518">*</span><span class="ident" id="1994519">f</span><span class="op" id="1994520">.</span><span class="ident" id="1994521">mant</span>&nbsp;<span class="op" id="1994526">-</span>&nbsp;<span class="num" id="1994528">1</span><span class="op" id="1994529">,</span>&nbsp;<span class="ident" id="1994531">exp</span><span class="op" id="1994534">:</span>&nbsp;<span class="ident" id="1994536">f</span><span class="op" id="1994537">.</span><span class="ident" id="1994538">exp</span>&nbsp;<span class="op" id="1994542">-</span>&nbsp;<span class="num" id="1994544">1</span><span class="op" id="1994545">,</span>&nbsp;<span class="ident" id="1994547">neg</span><span class="op" id="1994550">:</span>&nbsp;<span class="ident" id="1994552">f</span><span class="op" id="1994553">.</span><span class="ident" id="1994554">neg</span><span class="op" id="1994557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994560">}</span>&nbsp;<span class="keyword" id="1994562">else</span>&nbsp;<span class="op" id="1994567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994571">lower</span>&nbsp;<span class="op" id="1994577">=</span>&nbsp;<span class="ident" id="1994579">extFloat</span><span class="op" id="1994587">{</span><span class="ident" id="1994588">mant</span><span class="op" id="1994592">:</span>&nbsp;<span class="num" id="1994594">4</span><span class="op" id="1994595">*</span><span class="ident" id="1994596">f</span><span class="op" id="1994597">.</span><span class="ident" id="1994598">mant</span>&nbsp;<span class="op" id="1994603">-</span>&nbsp;<span class="num" id="1994605">1</span><span class="op" id="1994606">,</span>&nbsp;<span class="ident" id="1994608">exp</span><span class="op" id="1994611">:</span>&nbsp;<span class="ident" id="1994613">f</span><span class="op" id="1994614">.</span><span class="ident" id="1994615">exp</span>&nbsp;<span class="op" id="1994619">-</span>&nbsp;<span class="num" id="1994621">2</span><span class="op" id="1994622">,</span>&nbsp;<span class="ident" id="1994624">neg</span><span class="op" id="1994627">:</span>&nbsp;<span class="ident" id="1994629">f</span><span class="op" id="1994630">.</span><span class="ident" id="1994631">neg</span><span class="op" id="1994634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994640">return</span><br>
<span class="lineno">195</span><span class="op" id="1994647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1994650">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1994719">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="1994790">func</span>&nbsp;<span class="op" id="1994795">(</span><span class="ident" id="1994796">f</span>&nbsp;<span class="op" id="1994798">*</span><span class="ident" id="1994799">extFloat</span><span class="op" id="1994807">)</span>&nbsp;<span class="ident" id="1994809">Normalize</span><span class="op" id="1994818">(</span><span class="op" id="1994819">)</span>&nbsp;<span class="op" id="1994821">(</span><span class="ident" id="1994822">shift</span>&nbsp;<span class="builtintype" id="1994828">uint</span><span class="op" id="1994832">)</span>&nbsp;<span class="op" id="1994834">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994837">mant</span><span class="op" id="1994841">,</span>&nbsp;<span class="ident" id="1994843">exp</span>&nbsp;<span class="op" id="1994847">:=</span>&nbsp;<span class="ident" id="1994850">f</span><span class="op" id="1994851">.</span><span class="ident" id="1994852">mant</span><span class="op" id="1994856">,</span>&nbsp;<span class="ident" id="1994858">f</span><span class="op" id="1994859">.</span><span class="ident" id="1994860">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994865">if</span>&nbsp;<span class="ident" id="1994868">mant</span>&nbsp;<span class="op" id="1994873">==</span>&nbsp;<span class="num" id="1994876">0</span>&nbsp;<span class="op" id="1994878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994882">return</span>&nbsp;<span class="num" id="1994889">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994895">if</span>&nbsp;<span class="ident" id="1994898">mant</span><span class="op" id="1994902">&gt;&gt;</span><span class="op" id="1994904">(</span><span class="num" id="1994905">64</span><span class="op" id="1994907">-</span><span class="num" id="1994908">32</span><span class="op" id="1994910">)</span>&nbsp;<span class="op" id="1994912">==</span>&nbsp;<span class="num" id="1994915">0</span>&nbsp;<span class="op" id="1994917">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994921">mant</span>&nbsp;<span class="op" id="1994926">&lt;&lt;=</span>&nbsp;<span class="num" id="1994930">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994935">exp</span>&nbsp;<span class="op" id="1994939">-=</span>&nbsp;<span class="num" id="1994942">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994949">if</span>&nbsp;<span class="ident" id="1994952">mant</span><span class="op" id="1994956">&gt;&gt;</span><span class="op" id="1994958">(</span><span class="num" id="1994959">64</span><span class="op" id="1994961">-</span><span class="num" id="1994962">16</span><span class="op" id="1994964">)</span>&nbsp;<span class="op" id="1994966">==</span>&nbsp;<span class="num" id="1994969">0</span>&nbsp;<span class="op" id="1994971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994975">mant</span>&nbsp;<span class="op" id="1994980">&lt;&lt;=</span>&nbsp;<span class="num" id="1994984">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994989">exp</span>&nbsp;<span class="op" id="1994993">-=</span>&nbsp;<span class="num" id="1994996">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995003">if</span>&nbsp;<span class="ident" id="1995006">mant</span><span class="op" id="1995010">&gt;&gt;</span><span class="op" id="1995012">(</span><span class="num" id="1995013">64</span><span class="op" id="1995015">-</span><span class="num" id="1995016">8</span><span class="op" id="1995017">)</span>&nbsp;<span class="op" id="1995019">==</span>&nbsp;<span class="num" id="1995022">0</span>&nbsp;<span class="op" id="1995024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995028">mant</span>&nbsp;<span class="op" id="1995033">&lt;&lt;=</span>&nbsp;<span class="num" id="1995037">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995041">exp</span>&nbsp;<span class="op" id="1995045">-=</span>&nbsp;<span class="num" id="1995048">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995054">if</span>&nbsp;<span class="ident" id="1995057">mant</span><span class="op" id="1995061">&gt;&gt;</span><span class="op" id="1995063">(</span><span class="num" id="1995064">64</span><span class="op" id="1995066">-</span><span class="num" id="1995067">4</span><span class="op" id="1995068">)</span>&nbsp;<span class="op" id="1995070">==</span>&nbsp;<span class="num" id="1995073">0</span>&nbsp;<span class="op" id="1995075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995079">mant</span>&nbsp;<span class="op" id="1995084">&lt;&lt;=</span>&nbsp;<span class="num" id="1995088">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995092">exp</span>&nbsp;<span class="op" id="1995096">-=</span>&nbsp;<span class="num" id="1995099">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995102">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995105">if</span>&nbsp;<span class="ident" id="1995108">mant</span><span class="op" id="1995112">&gt;&gt;</span><span class="op" id="1995114">(</span><span class="num" id="1995115">64</span><span class="op" id="1995117">-</span><span class="num" id="1995118">2</span><span class="op" id="1995119">)</span>&nbsp;<span class="op" id="1995121">==</span>&nbsp;<span class="num" id="1995124">0</span>&nbsp;<span class="op" id="1995126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995130">mant</span>&nbsp;<span class="op" id="1995135">&lt;&lt;=</span>&nbsp;<span class="num" id="1995139">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995143">exp</span>&nbsp;<span class="op" id="1995147">-=</span>&nbsp;<span class="num" id="1995150">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995156">if</span>&nbsp;<span class="ident" id="1995159">mant</span><span class="op" id="1995163">&gt;&gt;</span><span class="op" id="1995165">(</span><span class="num" id="1995166">64</span><span class="op" id="1995168">-</span><span class="num" id="1995169">1</span><span class="op" id="1995170">)</span>&nbsp;<span class="op" id="1995172">==</span>&nbsp;<span class="num" id="1995175">0</span>&nbsp;<span class="op" id="1995177">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995181">mant</span>&nbsp;<span class="op" id="1995186">&lt;&lt;=</span>&nbsp;<span class="num" id="1995190">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995194">exp</span>&nbsp;<span class="op" id="1995198">-=</span>&nbsp;<span class="num" id="1995201">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995207">shift</span>&nbsp;<span class="op" id="1995213">=</span>&nbsp;<span class="builtintype" id="1995215">uint</span><span class="op" id="1995219">(</span><span class="ident" id="1995220">f</span><span class="op" id="1995221">.</span><span class="ident" id="1995222">exp</span>&nbsp;<span class="op" id="1995226">-</span>&nbsp;<span class="ident" id="1995228">exp</span><span class="op" id="1995231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995234">f</span><span class="op" id="1995235">.</span><span class="ident" id="1995236">mant</span><span class="op" id="1995240">,</span>&nbsp;<span class="ident" id="1995242">f</span><span class="op" id="1995243">.</span><span class="ident" id="1995244">exp</span>&nbsp;<span class="op" id="1995248">=</span>&nbsp;<span class="ident" id="1995250">mant</span><span class="op" id="1995254">,</span>&nbsp;<span class="ident" id="1995256">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995261">return</span><br>
<span class="lineno"></span><span class="op" id="1995268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1995271">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="1995343">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="1995366">func</span>&nbsp;<span class="op" id="1995371">(</span><span class="ident" id="1995372">f</span>&nbsp;<span class="op" id="1995374">*</span><span class="ident" id="1995375">extFloat</span><span class="op" id="1995383">)</span>&nbsp;<span class="ident" id="1995385">Multiply</span><span class="op" id="1995393">(</span><span class="ident" id="1995394">g</span>&nbsp;<span class="ident" id="1995396">extFloat</span><span class="op" id="1995404">)</span>&nbsp;<span class="op" id="1995406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995409">fhi</span><span class="op" id="1995412">,</span>&nbsp;<span class="ident" id="1995414">flo</span>&nbsp;<span class="op" id="1995418">:=</span>&nbsp;<span class="ident" id="1995421">f</span><span class="op" id="1995422">.</span><span class="ident" id="1995423">mant</span><span class="op" id="1995427">&gt;&gt;</span><span class="num" id="1995429">32</span><span class="op" id="1995431">,</span>&nbsp;<span class="ident" id="1995433">uint64</span><span class="op" id="1995439">(</span><span class="builtintype" id="1995440">uint32</span><span class="op" id="1995446">(</span><span class="ident" id="1995447">f</span><span class="op" id="1995448">.</span><span class="ident" id="1995449">mant</span><span class="op" id="1995453">)</span><span class="op" id="1995454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995457">ghi</span><span class="op" id="1995460">,</span>&nbsp;<span class="ident" id="1995462">glo</span>&nbsp;<span class="op" id="1995466">:=</span>&nbsp;<span class="ident" id="1995469">g</span><span class="op" id="1995470">.</span><span class="ident" id="1995471">mant</span><span class="op" id="1995475">&gt;&gt;</span><span class="num" id="1995477">32</span><span class="op" id="1995479">,</span>&nbsp;<span class="ident" id="1995481">uint64</span><span class="op" id="1995487">(</span><span class="builtintype" id="1995488">uint32</span><span class="op" id="1995494">(</span><span class="ident" id="1995495">g</span><span class="op" id="1995496">.</span><span class="ident" id="1995497">mant</span><span class="op" id="1995501">)</span><span class="op" id="1995502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995506">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995526">cross1</span>&nbsp;<span class="op" id="1995533">:=</span>&nbsp;<span class="ident" id="1995536">fhi</span>&nbsp;<span class="op" id="1995540">*</span>&nbsp;<span class="ident" id="1995542">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995547">cross2</span>&nbsp;<span class="op" id="1995554">:=</span>&nbsp;<span class="ident" id="1995557">flo</span>&nbsp;<span class="op" id="1995561">*</span>&nbsp;<span class="ident" id="1995563">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995569">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995638">f</span><span class="op" id="1995639">.</span><span class="ident" id="1995640">mant</span>&nbsp;<span class="op" id="1995645">=</span>&nbsp;<span class="ident" id="1995647">fhi</span><span class="op" id="1995650">*</span><span class="ident" id="1995651">ghi</span>&nbsp;<span class="op" id="1995655">+</span>&nbsp;<span class="op" id="1995657">(</span><span class="ident" id="1995658">cross1</span>&nbsp;<span class="op" id="1995665">&gt;&gt;</span>&nbsp;<span class="num" id="1995668">32</span><span class="op" id="1995670">)</span>&nbsp;<span class="op" id="1995672">+</span>&nbsp;<span class="op" id="1995674">(</span><span class="ident" id="1995675">cross2</span>&nbsp;<span class="op" id="1995682">&gt;&gt;</span>&nbsp;<span class="num" id="1995685">32</span><span class="op" id="1995687">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995690">rem</span>&nbsp;<span class="op" id="1995694">:=</span>&nbsp;<span class="ident" id="1995697">uint64</span><span class="op" id="1995703">(</span><span class="builtintype" id="1995704">uint32</span><span class="op" id="1995710">(</span><span class="ident" id="1995711">cross1</span><span class="op" id="1995717">)</span><span class="op" id="1995718">)</span>&nbsp;<span class="op" id="1995720">+</span>&nbsp;<span class="ident" id="1995722">uint64</span><span class="op" id="1995728">(</span><span class="builtintype" id="1995729">uint32</span><span class="op" id="1995735">(</span><span class="ident" id="1995736">cross2</span><span class="op" id="1995742">)</span><span class="op" id="1995743">)</span>&nbsp;<span class="op" id="1995745">+</span>&nbsp;<span class="op" id="1995747">(</span><span class="op" id="1995748">(</span><span class="ident" id="1995749">flo</span>&nbsp;<span class="op" id="1995753">*</span>&nbsp;<span class="ident" id="1995755">glo</span><span class="op" id="1995758">)</span>&nbsp;<span class="op" id="1995760">&gt;&gt;</span>&nbsp;<span class="num" id="1995763">32</span><span class="op" id="1995765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995768">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995782">rem</span>&nbsp;<span class="op" id="1995786">+=</span>&nbsp;<span class="op" id="1995789">(</span><span class="num" id="1995790">1</span>&nbsp;<span class="op" id="1995792">&lt;&lt;</span>&nbsp;<span class="num" id="1995795">31</span><span class="op" id="1995797">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995801">f</span><span class="op" id="1995802">.</span><span class="ident" id="1995803">mant</span>&nbsp;<span class="op" id="1995808">+=</span>&nbsp;<span class="op" id="1995811">(</span><span class="ident" id="1995812">rem</span>&nbsp;<span class="op" id="1995816">&gt;&gt;</span>&nbsp;<span class="num" id="1995819">32</span><span class="op" id="1995821">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995824">f</span><span class="op" id="1995825">.</span><span class="ident" id="1995826">exp</span>&nbsp;<span class="op" id="1995830">=</span>&nbsp;<span class="ident" id="1995832">f</span><span class="op" id="1995833">.</span><span class="ident" id="1995834">exp</span>&nbsp;<span class="op" id="1995838">+</span>&nbsp;<span class="ident" id="1995840">g</span><span class="op" id="1995841">.</span><span class="ident" id="1995842">exp</span>&nbsp;<span class="op" id="1995846">+</span>&nbsp;<span class="num" id="1995848">64</span><br>
<span class="lineno"></span><span class="op" id="1995851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1995854">var</span>&nbsp;<span class="ident" id="1995858">uint64pow10</span>&nbsp;<span class="op" id="1995870">=</span>&nbsp;<span class="op" id="1995872">[</span><span class="op" id="1995873">...</span><span class="op" id="1995876">]</span><span class="ident" id="1995877">uint64</span><span class="op" id="1995883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1995886">1</span><span class="op" id="1995887">,</span>&nbsp;<span class="num" id="1995889">1e1</span><span class="op" id="1995892">,</span>&nbsp;<span class="num" id="1995894">1e2</span><span class="op" id="1995897">,</span>&nbsp;<span class="num" id="1995899">1e3</span><span class="op" id="1995902">,</span>&nbsp;<span class="num" id="1995904">1e4</span><span class="op" id="1995907">,</span>&nbsp;<span class="num" id="1995909">1e5</span><span class="op" id="1995912">,</span>&nbsp;<span class="num" id="1995914">1e6</span><span class="op" id="1995917">,</span>&nbsp;<span class="num" id="1995919">1e7</span><span class="op" id="1995922">,</span>&nbsp;<span class="num" id="1995924">1e8</span><span class="op" id="1995927">,</span>&nbsp;<span class="num" id="1995929">1e9</span><span class="op" id="1995932">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1995935">1e10</span><span class="op" id="1995939">,</span>&nbsp;<span class="num" id="1995941">1e11</span><span class="op" id="1995945">,</span>&nbsp;<span class="num" id="1995947">1e12</span><span class="op" id="1995951">,</span>&nbsp;<span class="num" id="1995953">1e13</span><span class="op" id="1995957">,</span>&nbsp;<span class="num" id="1995959">1e14</span><span class="op" id="1995963">,</span>&nbsp;<span class="num" id="1995965">1e15</span><span class="op" id="1995969">,</span>&nbsp;<span class="num" id="1995971">1e16</span><span class="op" id="1995975">,</span>&nbsp;<span class="num" id="1995977">1e17</span><span class="op" id="1995981">,</span>&nbsp;<span class="num" id="1995983">1e18</span><span class="op" id="1995987">,</span>&nbsp;<span class="num" id="1995989">1e19</span><span class="op" id="1995993">,</span><br>
<span class="lineno"></span><span class="op" id="1995995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1995998">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1996066">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1996136">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1996199">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="1996228">func</span>&nbsp;<span class="op" id="1996233">(</span><span class="ident" id="1996234">f</span>&nbsp;<span class="op" id="1996236">*</span><span class="ident" id="1996237">extFloat</span><span class="op" id="1996245">)</span>&nbsp;<span class="ident" id="1996247">AssignDecimal</span><span class="op" id="1996260">(</span><span class="ident" id="1996261">mantissa</span>&nbsp;<span class="ident" id="1996270">uint64</span><span class="op" id="1996276">,</span>&nbsp;<span class="ident" id="1996278">exp10</span>&nbsp;<span class="builtintype" id="1996284">int</span><span class="op" id="1996287">,</span>&nbsp;<span class="ident" id="1996289">neg</span>&nbsp;<span class="builtintype" id="1996293">bool</span><span class="op" id="1996297">,</span>&nbsp;<span class="ident" id="1996299">trunc</span>&nbsp;<span class="builtintype" id="1996305">bool</span><span class="op" id="1996309">,</span>&nbsp;<span class="ident" id="1996311">flt</span>&nbsp;<span class="op" id="1996315">*</span><span class="ident" id="1996316">floatInfo</span><span class="op" id="1996325">)</span>&nbsp;<span class="op" id="1996327">(</span><span class="ident" id="1996328">ok</span>&nbsp;<span class="builtintype" id="1996331">bool</span><span class="op" id="1996335">)</span>&nbsp;<span class="op" id="1996337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996340">const</span>&nbsp;<span class="ident" id="1996346">uint64digits</span>&nbsp;<span class="op" id="1996359">=</span>&nbsp;<span class="num" id="1996361">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996365">const</span>&nbsp;<span class="ident" id="1996371">errorscale</span>&nbsp;<span class="op" id="1996382">=</span>&nbsp;<span class="num" id="1996384">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996387">errors</span>&nbsp;<span class="op" id="1996394">:=</span>&nbsp;<span class="num" id="1996397">0</span>&nbsp;<span class="comment" id="1996399">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996457">if</span>&nbsp;<span class="ident" id="1996460">trunc</span>&nbsp;<span class="op" id="1996466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996470">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996509">errors</span>&nbsp;<span class="op" id="1996516">+=</span>&nbsp;<span class="ident" id="1996519">errorscale</span>&nbsp;<span class="op" id="1996530">/</span>&nbsp;<span class="num" id="1996532">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996535">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996539">f</span><span class="op" id="1996540">.</span><span class="ident" id="1996541">mant</span>&nbsp;<span class="op" id="1996546">=</span>&nbsp;<span class="ident" id="1996548">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996558">f</span><span class="op" id="1996559">.</span><span class="ident" id="1996560">exp</span>&nbsp;<span class="op" id="1996564">=</span>&nbsp;<span class="num" id="1996566">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996569">f</span><span class="op" id="1996570">.</span><span class="ident" id="1996571">neg</span>&nbsp;<span class="op" id="1996575">=</span>&nbsp;<span class="ident" id="1996577">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996583">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996614">i</span>&nbsp;<span class="op" id="1996616">:=</span>&nbsp;<span class="op" id="1996619">(</span><span class="ident" id="1996620">exp10</span>&nbsp;<span class="op" id="1996626">-</span>&nbsp;<span class="ident" id="1996628">firstPowerOfTen</span><span class="op" id="1996643">)</span>&nbsp;<span class="op" id="1996645">/</span>&nbsp;<span class="ident" id="1996647">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996663">if</span>&nbsp;<span class="ident" id="1996666">exp10</span>&nbsp;<span class="op" id="1996672">&lt;</span>&nbsp;<span class="ident" id="1996674">firstPowerOfTen</span>&nbsp;<span class="op" id="1996690">||</span>&nbsp;<span class="ident" id="1996693">i</span>&nbsp;<span class="op" id="1996695">&gt;=</span>&nbsp;<span class="builtinfunc" id="1996698">len</span><span class="op" id="1996701">(</span><span class="ident" id="1996702">powersOfTen</span><span class="op" id="1996713">)</span>&nbsp;<span class="op" id="1996715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996719">return</span>&nbsp;<span class="builtintype" id="1996726">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996733">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996736">adjExp</span>&nbsp;<span class="op" id="1996743">:=</span>&nbsp;<span class="op" id="1996746">(</span><span class="ident" id="1996747">exp10</span>&nbsp;<span class="op" id="1996753">-</span>&nbsp;<span class="ident" id="1996755">firstPowerOfTen</span><span class="op" id="1996770">)</span>&nbsp;<span class="op" id="1996772">%</span>&nbsp;<span class="ident" id="1996774">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996791">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996819">if</span>&nbsp;<span class="ident" id="1996822">adjExp</span>&nbsp;<span class="op" id="1996829">&lt;</span>&nbsp;<span class="ident" id="1996831">uint64digits</span>&nbsp;<span class="op" id="1996844">&amp;&amp;</span>&nbsp;<span class="ident" id="1996847">mantissa</span>&nbsp;<span class="op" id="1996856">&lt;</span>&nbsp;<span class="ident" id="1996858">uint64pow10</span><span class="op" id="1996869">[</span><span class="ident" id="1996870">uint64digits</span><span class="op" id="1996882">-</span><span class="ident" id="1996883">adjExp</span><span class="op" id="1996889">]</span>&nbsp;<span class="op" id="1996891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996895">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996938">f</span><span class="op" id="1996939">.</span><span class="ident" id="1996940">mant</span>&nbsp;<span class="op" id="1996945">*=</span>&nbsp;<span class="ident" id="1996948">uint64pow10</span><span class="op" id="1996959">[</span><span class="ident" id="1996960">adjExp</span><span class="op" id="1996966">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996970">f</span><span class="op" id="1996971">.</span><span class="ident" id="1996972">Normalize</span><span class="op" id="1996981">(</span><span class="op" id="1996982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996985">}</span>&nbsp;<span class="keyword" id="1996987">else</span>&nbsp;<span class="op" id="1996992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996996">f</span><span class="op" id="1996997">.</span><span class="ident" id="1996998">Normalize</span><span class="op" id="1997007">(</span><span class="op" id="1997008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997012">f</span><span class="op" id="1997013">.</span><span class="ident" id="1997014">Multiply</span><span class="op" id="1997022">(</span><span class="ident" id="1997023">smallPowersOfTen</span><span class="op" id="1997039">[</span><span class="ident" id="1997040">adjExp</span><span class="op" id="1997046">]</span><span class="op" id="1997047">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997051">errors</span>&nbsp;<span class="op" id="1997058">+=</span>&nbsp;<span class="ident" id="1997061">errorscale</span>&nbsp;<span class="op" id="1997072">/</span>&nbsp;<span class="num" id="1997074">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997081">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997126">f</span><span class="op" id="1997127">.</span><span class="ident" id="1997128">Multiply</span><span class="op" id="1997136">(</span><span class="ident" id="1997137">powersOfTen</span><span class="op" id="1997148">[</span><span class="ident" id="1997149">i</span><span class="op" id="1997150">]</span><span class="op" id="1997151">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997154">if</span>&nbsp;<span class="ident" id="1997157">errors</span>&nbsp;<span class="op" id="1997164">&gt;</span>&nbsp;<span class="num" id="1997166">0</span>&nbsp;<span class="op" id="1997168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997172">errors</span>&nbsp;<span class="op" id="1997179">+=</span>&nbsp;<span class="num" id="1997182">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997188">errors</span>&nbsp;<span class="op" id="1997195">+=</span>&nbsp;<span class="ident" id="1997198">errorscale</span>&nbsp;<span class="op" id="1997209">/</span>&nbsp;<span class="num" id="1997211">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997215">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997229">shift</span>&nbsp;<span class="op" id="1997235">:=</span>&nbsp;<span class="ident" id="1997238">f</span><span class="op" id="1997239">.</span><span class="ident" id="1997240">Normalize</span><span class="op" id="1997249">(</span><span class="op" id="1997250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997253">errors</span>&nbsp;<span class="op" id="1997260">&lt;&lt;=</span>&nbsp;<span class="ident" id="1997264">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997272">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997322">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997389">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997457">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997526">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997530">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997587">denormalExp</span>&nbsp;<span class="op" id="1997599">:=</span>&nbsp;<span class="ident" id="1997602">flt</span><span class="op" id="1997605">.</span><span class="ident" id="1997606">bias</span>&nbsp;<span class="op" id="1997611">-</span>&nbsp;<span class="num" id="1997613">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997617">var</span>&nbsp;<span class="ident" id="1997621">extrabits</span>&nbsp;<span class="builtintype" id="1997631">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997637">if</span>&nbsp;<span class="ident" id="1997640">f</span><span class="op" id="1997641">.</span><span class="ident" id="1997642">exp</span>&nbsp;<span class="op" id="1997646">&lt;=</span>&nbsp;<span class="ident" id="1997649">denormalExp</span>&nbsp;<span class="op" id="1997661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997665">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997719">extrabits</span>&nbsp;<span class="op" id="1997729">=</span>&nbsp;<span class="builtintype" id="1997731">uint</span><span class="op" id="1997735">(</span><span class="num" id="1997736">63</span>&nbsp;<span class="op" id="1997739">-</span>&nbsp;<span class="ident" id="1997741">flt</span><span class="op" id="1997744">.</span><span class="ident" id="1997745">mantbits</span>&nbsp;<span class="op" id="1997754">+</span>&nbsp;<span class="num" id="1997756">1</span>&nbsp;<span class="op" id="1997758">+</span>&nbsp;<span class="builtintype" id="1997760">uint</span><span class="op" id="1997764">(</span><span class="ident" id="1997765">denormalExp</span><span class="op" id="1997776">-</span><span class="ident" id="1997777">f</span><span class="op" id="1997778">.</span><span class="ident" id="1997779">exp</span><span class="op" id="1997782">)</span><span class="op" id="1997783">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997786">}</span>&nbsp;<span class="keyword" id="1997788">else</span>&nbsp;<span class="op" id="1997793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997797">extrabits</span>&nbsp;<span class="op" id="1997807">=</span>&nbsp;<span class="builtintype" id="1997809">uint</span><span class="op" id="1997813">(</span><span class="num" id="1997814">63</span>&nbsp;<span class="op" id="1997817">-</span>&nbsp;<span class="ident" id="1997819">flt</span><span class="op" id="1997822">.</span><span class="ident" id="1997823">mantbits</span><span class="op" id="1997831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997838">halfway</span>&nbsp;<span class="op" id="1997846">:=</span>&nbsp;<span class="ident" id="1997849">uint64</span><span class="op" id="1997855">(</span><span class="num" id="1997856">1</span><span class="op" id="1997857">)</span>&nbsp;<span class="op" id="1997859">&lt;&lt;</span>&nbsp;<span class="op" id="1997862">(</span><span class="ident" id="1997863">extrabits</span>&nbsp;<span class="op" id="1997873">-</span>&nbsp;<span class="num" id="1997875">1</span><span class="op" id="1997876">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997879">mant_extra</span>&nbsp;<span class="op" id="1997890">:=</span>&nbsp;<span class="ident" id="1997893">f</span><span class="op" id="1997894">.</span><span class="ident" id="1997895">mant</span>&nbsp;<span class="op" id="1997900">&amp;</span>&nbsp;<span class="op" id="1997902">(</span><span class="num" id="1997903">1</span><span class="op" id="1997904">&lt;&lt;</span><span class="ident" id="1997906">extrabits</span>&nbsp;<span class="op" id="1997916">-</span>&nbsp;<span class="num" id="1997918">1</span><span class="op" id="1997919">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997923">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997989">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998054">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998096">if</span>&nbsp;<span class="ident" id="1998099">int64</span><span class="op" id="1998104">(</span><span class="ident" id="1998105">halfway</span><span class="op" id="1998112">)</span><span class="op" id="1998113">-</span><span class="ident" id="1998114">int64</span><span class="op" id="1998119">(</span><span class="ident" id="1998120">errors</span><span class="op" id="1998126">)</span>&nbsp;<span class="op" id="1998128">&lt;</span>&nbsp;<span class="ident" id="1998130">int64</span><span class="op" id="1998135">(</span><span class="ident" id="1998136">mant_extra</span><span class="op" id="1998146">)</span>&nbsp;<span class="op" id="1998148">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998153">int64</span><span class="op" id="1998158">(</span><span class="ident" id="1998159">mant_extra</span><span class="op" id="1998169">)</span>&nbsp;<span class="op" id="1998171">&lt;</span>&nbsp;<span class="ident" id="1998173">int64</span><span class="op" id="1998178">(</span><span class="ident" id="1998179">halfway</span><span class="op" id="1998186">)</span><span class="op" id="1998187">+</span><span class="ident" id="1998188">int64</span><span class="op" id="1998193">(</span><span class="ident" id="1998194">errors</span><span class="op" id="1998200">)</span>&nbsp;<span class="op" id="1998202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998206">return</span>&nbsp;<span class="builtintype" id="1998213">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998223">return</span>&nbsp;<span class="builtintype" id="1998230">true</span><br>
<span class="lineno">330</span><span class="op" id="1998235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1998238">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="1998308">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="1998375">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="1998441">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="1998502">func</span>&nbsp;<span class="op" id="1998507">(</span><span class="ident" id="1998508">f</span>&nbsp;<span class="op" id="1998510">*</span><span class="ident" id="1998511">extFloat</span><span class="op" id="1998519">)</span>&nbsp;<span class="ident" id="1998521">frexp10</span><span class="op" id="1998528">(</span><span class="op" id="1998529">)</span>&nbsp;<span class="op" id="1998531">(</span><span class="ident" id="1998532">exp10</span><span class="op" id="1998537">,</span>&nbsp;<span class="ident" id="1998539">index</span>&nbsp;<span class="builtintype" id="1998545">int</span><span class="op" id="1998548">)</span>&nbsp;<span class="op" id="1998550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998553">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998622">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998692">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998761">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998834">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998845">const</span>&nbsp;<span class="ident" id="1998851">expMin</span>&nbsp;<span class="op" id="1998858">=</span>&nbsp;<span class="op" id="1998860">-</span><span class="num" id="1998861">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998865">const</span>&nbsp;<span class="ident" id="1998871">expMax</span>&nbsp;<span class="op" id="1998878">=</span>&nbsp;<span class="op" id="1998880">-</span><span class="num" id="1998881">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998885">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998948">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998979">approxExp10</span>&nbsp;<span class="op" id="1998991">:=</span>&nbsp;<span class="op" id="1998994">(</span><span class="op" id="1998995">(</span><span class="ident" id="1998996">expMin</span><span class="op" id="1999002">+</span><span class="ident" id="1999003">expMax</span><span class="op" id="1999009">)</span><span class="op" id="1999010">/</span><span class="num" id="1999011">2</span>&nbsp;<span class="op" id="1999013">-</span>&nbsp;<span class="ident" id="1999015">f</span><span class="op" id="1999016">.</span><span class="ident" id="1999017">exp</span><span class="op" id="1999020">)</span>&nbsp;<span class="op" id="1999022">*</span>&nbsp;<span class="num" id="1999024">28</span>&nbsp;<span class="op" id="1999027">/</span>&nbsp;<span class="num" id="1999029">93</span>&nbsp;<span class="comment" id="1999032">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999070">i</span>&nbsp;<span class="op" id="1999072">:=</span>&nbsp;<span class="op" id="1999075">(</span><span class="ident" id="1999076">approxExp10</span>&nbsp;<span class="op" id="1999088">-</span>&nbsp;<span class="ident" id="1999090">firstPowerOfTen</span><span class="op" id="1999105">)</span>&nbsp;<span class="op" id="1999107">/</span>&nbsp;<span class="ident" id="1999109">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="1999124">Loop</span><span class="op" id="1999128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999131">for</span>&nbsp;<span class="op" id="1999135">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999139">exp</span>&nbsp;<span class="op" id="1999143">:=</span>&nbsp;<span class="ident" id="1999146">f</span><span class="op" id="1999147">.</span><span class="ident" id="1999148">exp</span>&nbsp;<span class="op" id="1999152">+</span>&nbsp;<span class="ident" id="1999154">powersOfTen</span><span class="op" id="1999165">[</span><span class="ident" id="1999166">i</span><span class="op" id="1999167">]</span><span class="op" id="1999168">.</span><span class="ident" id="1999169">exp</span>&nbsp;<span class="op" id="1999173">+</span>&nbsp;<span class="num" id="1999175">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999180">switch</span>&nbsp;<span class="op" id="1999187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999191">case</span>&nbsp;<span class="ident" id="1999196">exp</span>&nbsp;<span class="op" id="1999200">&lt;</span>&nbsp;<span class="ident" id="1999202">expMin</span><span class="op" id="1999208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999213">i</span><span class="op" id="1999214">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999219">case</span>&nbsp;<span class="ident" id="1999224">exp</span>&nbsp;<span class="op" id="1999228">&gt;</span>&nbsp;<span class="ident" id="1999230">expMax</span><span class="op" id="1999236">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999241">i</span><span class="op" id="1999242">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999247">default</span><span class="op" id="1999254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999259">break</span>&nbsp;<span class="ident" id="1999265">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999275">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999278">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1999342">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999405">f</span><span class="op" id="1999406">.</span><span class="ident" id="1999407">Multiply</span><span class="op" id="1999415">(</span><span class="ident" id="1999416">powersOfTen</span><span class="op" id="1999427">[</span><span class="ident" id="1999428">i</span><span class="op" id="1999429">]</span><span class="op" id="1999430">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999434">return</span>&nbsp;<span class="op" id="1999441">-</span><span class="op" id="1999442">(</span><span class="ident" id="1999443">firstPowerOfTen</span>&nbsp;<span class="op" id="1999459">+</span>&nbsp;<span class="ident" id="1999461">i</span><span class="op" id="1999462">*</span><span class="ident" id="1999463">stepPowerOfTen</span><span class="op" id="1999477">)</span><span class="op" id="1999478">,</span>&nbsp;<span class="ident" id="1999480">i</span><br>
<span class="lineno">365</span><span class="op" id="1999482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1999485">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="1999553">func</span>&nbsp;<span class="ident" id="1999558">frexp10Many</span><span class="op" id="1999569">(</span><span class="ident" id="1999570">a</span><span class="op" id="1999571">,</span>&nbsp;<span class="ident" id="1999573">b</span><span class="op" id="1999574">,</span>&nbsp;<span class="ident" id="1999576">c</span>&nbsp;<span class="op" id="1999578">*</span><span class="ident" id="1999579">extFloat</span><span class="op" id="1999587">)</span>&nbsp;<span class="op" id="1999589">(</span><span class="ident" id="1999590">exp10</span>&nbsp;<span class="builtintype" id="1999596">int</span><span class="op" id="1999599">)</span>&nbsp;<span class="op" id="1999601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999604">exp10</span><span class="op" id="1999609">,</span>&nbsp;<span class="ident" id="1999611">i</span>&nbsp;<span class="op" id="1999613">:=</span>&nbsp;<span class="ident" id="1999616">c</span><span class="op" id="1999617">.</span><span class="ident" id="1999618">frexp10</span><span class="op" id="1999625">(</span><span class="op" id="1999626">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999629">a</span><span class="op" id="1999630">.</span><span class="ident" id="1999631">Multiply</span><span class="op" id="1999639">(</span><span class="ident" id="1999640">powersOfTen</span><span class="op" id="1999651">[</span><span class="ident" id="1999652">i</span><span class="op" id="1999653">]</span><span class="op" id="1999654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999657">b</span><span class="op" id="1999658">.</span><span class="ident" id="1999659">Multiply</span><span class="op" id="1999667">(</span><span class="ident" id="1999668">powersOfTen</span><span class="op" id="1999679">[</span><span class="ident" id="1999680">i</span><span class="op" id="1999681">]</span><span class="op" id="1999682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999685">return</span><br>
<span class="lineno"></span><span class="op" id="1999692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="1999695">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="1999754">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="1999810">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="1999849">func</span>&nbsp;<span class="op" id="1999854">(</span><span class="ident" id="1999855">f</span>&nbsp;<span class="op" id="1999857">*</span><span class="ident" id="1999858">extFloat</span><span class="op" id="1999866">)</span>&nbsp;<span class="ident" id="1999868">FixedDecimal</span><span class="op" id="1999880">(</span><span class="ident" id="1999881">d</span>&nbsp;<span class="op" id="1999883">*</span><span class="ident" id="1999884">decimalSlice</span><span class="op" id="1999896">,</span>&nbsp;<span class="ident" id="1999898">n</span>&nbsp;<span class="builtintype" id="1999900">int</span><span class="op" id="1999903">)</span>&nbsp;<span class="builtintype" id="1999905">bool</span>&nbsp;<span class="op" id="1999910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999913">if</span>&nbsp;<span class="ident" id="1999916">f</span><span class="op" id="1999917">.</span><span class="ident" id="1999918">mant</span>&nbsp;<span class="op" id="1999923">==</span>&nbsp;<span class="num" id="1999926">0</span>&nbsp;<span class="op" id="1999928">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999932">d</span><span class="op" id="1999933">.</span><span class="ident" id="1999934">nd</span>&nbsp;<span class="op" id="1999937">=</span>&nbsp;<span class="num" id="1999939">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999943">d</span><span class="op" id="1999944">.</span><span class="ident" id="1999945">dp</span>&nbsp;<span class="op" id="1999948">=</span>&nbsp;<span class="num" id="1999950">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999954">d</span><span class="op" id="1999955">.</span><span class="ident" id="1999956">neg</span>&nbsp;<span class="op" id="1999960">=</span>&nbsp;<span class="ident" id="1999962">f</span><span class="op" id="1999963">.</span><span class="ident" id="1999964">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999970">return</span>&nbsp;<span class="builtintype" id="1999977">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999983">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999986">if</span>&nbsp;<span class="ident" id="1999989">n</span>&nbsp;<span class="op" id="1999991">==</span>&nbsp;<span class="num" id="1999994">0</span>&nbsp;<span class="op" id="1999996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2000000">panic</span><span class="op" id="2000005">(</span><span class="string" id="2000006">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="2000073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000079">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000144">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000167">f</span><span class="op" id="2000168">.</span><span class="ident" id="2000169">Normalize</span><span class="op" id="2000178">(</span><span class="op" id="2000179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000182">exp10</span><span class="op" id="2000187">,</span>&nbsp;<span class="ident" id="2000189">_</span>&nbsp;<span class="op" id="2000191">:=</span>&nbsp;<span class="ident" id="2000194">f</span><span class="op" id="2000195">.</span><span class="ident" id="2000196">frexp10</span><span class="op" id="2000203">(</span><span class="op" id="2000204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000208">shift</span>&nbsp;<span class="op" id="2000214">:=</span>&nbsp;<span class="builtintype" id="2000217">uint</span><span class="op" id="2000221">(</span><span class="op" id="2000222">-</span><span class="ident" id="2000223">f</span><span class="op" id="2000224">.</span><span class="ident" id="2000225">exp</span><span class="op" id="2000228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000231">integer</span>&nbsp;<span class="op" id="2000239">:=</span>&nbsp;<span class="builtintype" id="2000242">uint32</span><span class="op" id="2000248">(</span><span class="ident" id="2000249">f</span><span class="op" id="2000250">.</span><span class="ident" id="2000251">mant</span>&nbsp;<span class="op" id="2000256">&gt;&gt;</span>&nbsp;<span class="ident" id="2000259">shift</span><span class="op" id="2000264">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000267">fraction</span>&nbsp;<span class="op" id="2000276">:=</span>&nbsp;<span class="ident" id="2000279">f</span><span class="op" id="2000280">.</span><span class="ident" id="2000281">mant</span>&nbsp;<span class="op" id="2000286">-</span>&nbsp;<span class="op" id="2000288">(</span><span class="ident" id="2000289">uint64</span><span class="op" id="2000295">(</span><span class="ident" id="2000296">integer</span><span class="op" id="2000303">)</span>&nbsp;<span class="op" id="2000305">&lt;&lt;</span>&nbsp;<span class="ident" id="2000308">shift</span><span class="op" id="2000313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000316">ε</span>&nbsp;<span class="op" id="2000319">:=</span>&nbsp;<span class="ident" id="2000322">uint64</span><span class="op" id="2000328">(</span><span class="num" id="2000329">1</span><span class="op" id="2000330">)</span>&nbsp;<span class="comment" id="2000332">//&nbsp;ε&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000389">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000422">needed</span>&nbsp;<span class="op" id="2000429">:=</span>&nbsp;<span class="ident" id="2000432">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2000441">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000480">integerDigits</span>&nbsp;<span class="op" id="2000494">:=</span>&nbsp;<span class="num" id="2000497">0</span>&nbsp;<span class="comment" id="2000499">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000544">pow10</span>&nbsp;<span class="op" id="2000550">:=</span>&nbsp;<span class="ident" id="2000553">uint64</span><span class="op" id="2000559">(</span><span class="num" id="2000560">1</span><span class="op" id="2000561">)</span>&nbsp;<span class="comment" id="2000563">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000607">for</span>&nbsp;<span class="ident" id="2000611">i</span><span class="op" id="2000612">,</span>&nbsp;<span class="ident" id="2000614">pow</span>&nbsp;<span class="op" id="2000618">:=</span>&nbsp;<span class="num" id="2000621">0</span><span class="op" id="2000622">,</span>&nbsp;<span class="ident" id="2000624">uint64</span><span class="op" id="2000630">(</span><span class="num" id="2000631">1</span><span class="op" id="2000632">)</span><span class="op" id="2000633">;</span>&nbsp;<span class="ident" id="2000635">i</span>&nbsp;<span class="op" id="2000637">&lt;</span>&nbsp;<span class="num" id="2000639">20</span><span class="op" id="2000641">;</span>&nbsp;<span class="ident" id="2000643">i</span><span class="op" id="2000644">++</span>&nbsp;<span class="op" id="2000647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000651">if</span>&nbsp;<span class="ident" id="2000654">pow</span>&nbsp;<span class="op" id="2000658">&gt;</span>&nbsp;<span class="ident" id="2000660">uint64</span><span class="op" id="2000666">(</span><span class="ident" id="2000667">integer</span><span class="op" id="2000674">)</span>&nbsp;<span class="op" id="2000676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000681">integerDigits</span>&nbsp;<span class="op" id="2000695">=</span>&nbsp;<span class="ident" id="2000697">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000702">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000714">pow</span>&nbsp;<span class="op" id="2000718">*=</span>&nbsp;<span class="num" id="2000721">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000728">rest</span>&nbsp;<span class="op" id="2000733">:=</span>&nbsp;<span class="ident" id="2000736">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000745">if</span>&nbsp;<span class="ident" id="2000748">integerDigits</span>&nbsp;<span class="op" id="2000762">&gt;</span>&nbsp;<span class="ident" id="2000764">needed</span>&nbsp;<span class="op" id="2000771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000775">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000838">pow10</span>&nbsp;<span class="op" id="2000844">=</span>&nbsp;<span class="ident" id="2000846">uint64pow10</span><span class="op" id="2000857">[</span><span class="ident" id="2000858">integerDigits</span><span class="op" id="2000871">-</span><span class="ident" id="2000872">needed</span><span class="op" id="2000878">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000882">integer</span>&nbsp;<span class="op" id="2000890">/=</span>&nbsp;<span class="builtintype" id="2000893">uint32</span><span class="op" id="2000899">(</span><span class="ident" id="2000900">pow10</span><span class="op" id="2000905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000909">rest</span>&nbsp;<span class="op" id="2000914">-=</span>&nbsp;<span class="ident" id="2000917">integer</span>&nbsp;<span class="op" id="2000925">*</span>&nbsp;<span class="builtintype" id="2000927">uint32</span><span class="op" id="2000933">(</span><span class="ident" id="2000934">pow10</span><span class="op" id="2000939">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000942">}</span>&nbsp;<span class="keyword" id="2000944">else</span>&nbsp;<span class="op" id="2000949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000953">rest</span>&nbsp;<span class="op" id="2000958">=</span>&nbsp;<span class="num" id="2000960">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2000967">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001032">var</span>&nbsp;<span class="ident" id="2001036">buf</span>&nbsp;<span class="op" id="2001040">[</span><span class="num" id="2001041">32</span><span class="op" id="2001043">]</span><span class="builtintype" id="2001044">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001050">pos</span>&nbsp;<span class="op" id="2001054">:=</span>&nbsp;<span class="builtinfunc" id="2001057">len</span><span class="op" id="2001060">(</span><span class="ident" id="2001061">buf</span><span class="op" id="2001064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001067">for</span>&nbsp;<span class="ident" id="2001071">v</span>&nbsp;<span class="op" id="2001073">:=</span>&nbsp;<span class="ident" id="2001076">integer</span><span class="op" id="2001083">;</span>&nbsp;<span class="ident" id="2001085">v</span>&nbsp;<span class="op" id="2001087">&gt;</span>&nbsp;<span class="num" id="2001089">0</span><span class="op" id="2001090">;</span>&nbsp;<span class="op" id="2001092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001096">v1</span>&nbsp;<span class="op" id="2001099">:=</span>&nbsp;<span class="ident" id="2001102">v</span>&nbsp;<span class="op" id="2001104">/</span>&nbsp;<span class="num" id="2001106">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001111">v</span>&nbsp;<span class="op" id="2001113">-=</span>&nbsp;<span class="num" id="2001116">10</span>&nbsp;<span class="op" id="2001119">*</span>&nbsp;<span class="ident" id="2001121">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001126">pos</span><span class="op" id="2001129">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001134">buf</span><span class="op" id="2001137">[</span><span class="ident" id="2001138">pos</span><span class="op" id="2001141">]</span>&nbsp;<span class="op" id="2001143">=</span>&nbsp;<span class="builtintype" id="2001145">byte</span><span class="op" id="2001149">(</span><span class="ident" id="2001150">v</span>&nbsp;<span class="op" id="2001152">+</span>&nbsp;<span class="string" id="2001154">&#39;0&#39;</span><span class="op" id="2001157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001161">v</span>&nbsp;<span class="op" id="2001163">=</span>&nbsp;<span class="ident" id="2001165">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001172">for</span>&nbsp;<span class="ident" id="2001176">i</span>&nbsp;<span class="op" id="2001178">:=</span>&nbsp;<span class="ident" id="2001181">pos</span><span class="op" id="2001184">;</span>&nbsp;<span class="ident" id="2001186">i</span>&nbsp;<span class="op" id="2001188">&lt;</span>&nbsp;<span class="builtinfunc" id="2001190">len</span><span class="op" id="2001193">(</span><span class="ident" id="2001194">buf</span><span class="op" id="2001197">)</span><span class="op" id="2001198">;</span>&nbsp;<span class="ident" id="2001200">i</span><span class="op" id="2001201">++</span>&nbsp;<span class="op" id="2001204">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001208">d</span><span class="op" id="2001209">.</span><span class="ident" id="2001210">d</span><span class="op" id="2001211">[</span><span class="ident" id="2001212">i</span><span class="op" id="2001213">-</span><span class="ident" id="2001214">pos</span><span class="op" id="2001217">]</span>&nbsp;<span class="op" id="2001219">=</span>&nbsp;<span class="ident" id="2001221">buf</span><span class="op" id="2001224">[</span><span class="ident" id="2001225">i</span><span class="op" id="2001226">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001232">nd</span>&nbsp;<span class="op" id="2001235">:=</span>&nbsp;<span class="builtinfunc" id="2001238">len</span><span class="op" id="2001241">(</span><span class="ident" id="2001242">buf</span><span class="op" id="2001245">)</span>&nbsp;<span class="op" id="2001247">-</span>&nbsp;<span class="ident" id="2001249">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001254">d</span><span class="op" id="2001255">.</span><span class="ident" id="2001256">nd</span>&nbsp;<span class="op" id="2001259">=</span>&nbsp;<span class="ident" id="2001261">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001265">d</span><span class="op" id="2001266">.</span><span class="ident" id="2001267">dp</span>&nbsp;<span class="op" id="2001270">=</span>&nbsp;<span class="ident" id="2001272">integerDigits</span>&nbsp;<span class="op" id="2001286">+</span>&nbsp;<span class="ident" id="2001288">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001295">needed</span>&nbsp;<span class="op" id="2001302">-=</span>&nbsp;<span class="ident" id="2001305">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001310">if</span>&nbsp;<span class="ident" id="2001313">needed</span>&nbsp;<span class="op" id="2001320">&gt;</span>&nbsp;<span class="num" id="2001322">0</span>&nbsp;<span class="op" id="2001324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001328">if</span>&nbsp;<span class="ident" id="2001331">rest</span>&nbsp;<span class="op" id="2001336">!=</span>&nbsp;<span class="num" id="2001339">0</span>&nbsp;<span class="op" id="2001341">||</span>&nbsp;<span class="ident" id="2001344">pow10</span>&nbsp;<span class="op" id="2001350">!=</span>&nbsp;<span class="num" id="2001353">1</span>&nbsp;<span class="op" id="2001355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2001360">panic</span><span class="op" id="2001365">(</span><span class="string" id="2001366">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="2001417">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001425">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001490">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001530">for</span>&nbsp;<span class="ident" id="2001534">needed</span>&nbsp;<span class="op" id="2001541">&gt;</span>&nbsp;<span class="num" id="2001543">0</span>&nbsp;<span class="op" id="2001545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001550">fraction</span>&nbsp;<span class="op" id="2001559">*=</span>&nbsp;<span class="num" id="2001562">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001568">ε</span>&nbsp;<span class="op" id="2001571">*=</span>&nbsp;<span class="num" id="2001574">10</span>&nbsp;<span class="comment" id="2001577">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001629">if</span>&nbsp;<span class="num" id="2001632">2</span><span class="op" id="2001633">*</span><span class="ident" id="2001634">ε</span>&nbsp;<span class="op" id="2001637">&gt;</span>&nbsp;<span class="num" id="2001639">1</span><span class="op" id="2001640">&lt;&lt;</span><span class="ident" id="2001642">shift</span>&nbsp;<span class="op" id="2001648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001654">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001728">return</span>&nbsp;<span class="builtintype" id="2001735">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001744">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001749">digit</span>&nbsp;<span class="op" id="2001755">:=</span>&nbsp;<span class="ident" id="2001758">fraction</span>&nbsp;<span class="op" id="2001767">&gt;&gt;</span>&nbsp;<span class="ident" id="2001770">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001779">d</span><span class="op" id="2001780">.</span><span class="ident" id="2001781">d</span><span class="op" id="2001782">[</span><span class="ident" id="2001783">nd</span><span class="op" id="2001785">]</span>&nbsp;<span class="op" id="2001787">=</span>&nbsp;<span class="builtintype" id="2001789">byte</span><span class="op" id="2001793">(</span><span class="ident" id="2001794">digit</span>&nbsp;<span class="op" id="2001800">+</span>&nbsp;<span class="string" id="2001802">&#39;0&#39;</span><span class="op" id="2001805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001810">fraction</span>&nbsp;<span class="op" id="2001819">-=</span>&nbsp;<span class="ident" id="2001822">digit</span>&nbsp;<span class="op" id="2001828">&lt;&lt;</span>&nbsp;<span class="ident" id="2001831">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001840">nd</span><span class="op" id="2001842">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001848">needed</span><span class="op" id="2001854">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001863">d</span><span class="op" id="2001864">.</span><span class="ident" id="2001865">nd</span>&nbsp;<span class="op" id="2001868">=</span>&nbsp;<span class="ident" id="2001870">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001878">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001960">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002044">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002059">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002063">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002095">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002146">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002199">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002285">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002289">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002335">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002366">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002419">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002423">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2002493">ok</span>&nbsp;<span class="op" id="2002496">:=</span>&nbsp;<span class="ident" id="2002499">adjustLastDigitFixed</span><span class="op" id="2002519">(</span><span class="ident" id="2002520">d</span><span class="op" id="2002521">,</span>&nbsp;<span class="ident" id="2002523">uint64</span><span class="op" id="2002529">(</span><span class="ident" id="2002530">rest</span><span class="op" id="2002534">)</span><span class="op" id="2002535">&lt;&lt;</span><span class="ident" id="2002537">shift</span><span class="op" id="2002542">|</span><span class="ident" id="2002543">fraction</span><span class="op" id="2002551">,</span>&nbsp;<span class="ident" id="2002553">pow10</span><span class="op" id="2002558">,</span>&nbsp;<span class="ident" id="2002560">shift</span><span class="op" id="2002565">,</span>&nbsp;<span class="ident" id="2002567">ε</span><span class="op" id="2002569">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002572">if</span>&nbsp;<span class="op" id="2002575">!</span><span class="ident" id="2002576">ok</span>&nbsp;<span class="op" id="2002579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002583">return</span>&nbsp;<span class="builtintype" id="2002590">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2002597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2002600">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002625">for</span>&nbsp;<span class="ident" id="2002629">i</span>&nbsp;<span class="op" id="2002631">:=</span>&nbsp;<span class="ident" id="2002634">d</span><span class="op" id="2002635">.</span><span class="ident" id="2002636">nd</span>&nbsp;<span class="op" id="2002639">-</span>&nbsp;<span class="num" id="2002641">1</span><span class="op" id="2002642">;</span>&nbsp;<span class="ident" id="2002644">i</span>&nbsp;<span class="op" id="2002646">&gt;=</span>&nbsp;<span class="num" id="2002649">0</span><span class="op" id="2002650">;</span>&nbsp;<span class="ident" id="2002652">i</span><span class="op" id="2002653">--</span>&nbsp;<span class="op" id="2002656">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002660">if</span>&nbsp;<span class="ident" id="2002663">d</span><span class="op" id="2002664">.</span><span class="ident" id="2002665">d</span><span class="op" id="2002666">[</span><span class="ident" id="2002667">i</span><span class="op" id="2002668">]</span>&nbsp;<span class="op" id="2002670">!=</span>&nbsp;<span class="string" id="2002673">&#39;0&#39;</span>&nbsp;<span class="op" id="2002677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2002682">d</span><span class="op" id="2002683">.</span><span class="ident" id="2002684">nd</span>&nbsp;<span class="op" id="2002687">=</span>&nbsp;<span class="ident" id="2002689">i</span>&nbsp;<span class="op" id="2002691">+</span>&nbsp;<span class="num" id="2002693">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002698">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2002706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2002709">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2002712">return</span>&nbsp;<span class="builtintype" id="2002719">true</span><br>
<span class="lineno"></span><span class="op" id="2002724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2002727">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="2002810">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="2002890">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;ε,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2002968">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="2002989">//</span><br>
<span class="lineno"></span><span class="comment" id="2002992">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="2003077">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;ε&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="2003162">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="2003202">func</span>&nbsp;<span class="ident" id="2003207">adjustLastDigitFixed</span><span class="op" id="2003227">(</span><span class="ident" id="2003228">d</span>&nbsp;<span class="op" id="2003230">*</span><span class="ident" id="2003231">decimalSlice</span><span class="op" id="2003243">,</span>&nbsp;<span class="ident" id="2003245">num</span><span class="op" id="2003248">,</span>&nbsp;<span class="ident" id="2003250">den</span>&nbsp;<span class="ident" id="2003254">uint64</span><span class="op" id="2003260">,</span>&nbsp;<span class="ident" id="2003262">shift</span>&nbsp;<span class="builtintype" id="2003268">uint</span><span class="op" id="2003272">,</span>&nbsp;<span class="ident" id="2003274">ε</span>&nbsp;<span class="ident" id="2003277">uint64</span><span class="op" id="2003283">)</span>&nbsp;<span class="builtintype" id="2003285">bool</span>&nbsp;<span class="op" id="2003290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003293">if</span>&nbsp;<span class="ident" id="2003296">num</span>&nbsp;<span class="op" id="2003300">&gt;</span>&nbsp;<span class="ident" id="2003302">den</span><span class="op" id="2003305">&lt;&lt;</span><span class="ident" id="2003307">shift</span>&nbsp;<span class="op" id="2003313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2003317">panic</span><span class="op" id="2003322">(</span><span class="string" id="2003323">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="2003374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003377">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003380">if</span>&nbsp;<span class="num" id="2003383">2</span><span class="op" id="2003384">*</span><span class="ident" id="2003385">ε</span>&nbsp;<span class="op" id="2003388">&gt;</span>&nbsp;<span class="ident" id="2003390">den</span><span class="op" id="2003393">&lt;&lt;</span><span class="ident" id="2003395">shift</span>&nbsp;<span class="op" id="2003401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2003405">panic</span><span class="op" id="2003410">(</span><span class="string" id="2003411">&#34;strconv:&nbsp;ε&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="2003441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003447">if</span>&nbsp;<span class="num" id="2003450">2</span><span class="op" id="2003451">*</span><span class="op" id="2003452">(</span><span class="ident" id="2003453">num</span><span class="op" id="2003456">+</span><span class="ident" id="2003457">ε</span><span class="op" id="2003459">)</span>&nbsp;<span class="op" id="2003461">&lt;</span>&nbsp;<span class="ident" id="2003463">den</span><span class="op" id="2003466">&lt;&lt;</span><span class="ident" id="2003468">shift</span>&nbsp;<span class="op" id="2003474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003478">return</span>&nbsp;<span class="builtintype" id="2003485">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003494">if</span>&nbsp;<span class="num" id="2003497">2</span><span class="op" id="2003498">*</span><span class="op" id="2003499">(</span><span class="ident" id="2003500">num</span><span class="op" id="2003503">-</span><span class="ident" id="2003504">ε</span><span class="op" id="2003506">)</span>&nbsp;<span class="op" id="2003508">&gt;</span>&nbsp;<span class="ident" id="2003510">den</span><span class="op" id="2003513">&lt;&lt;</span><span class="ident" id="2003515">shift</span>&nbsp;<span class="op" id="2003521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2003525">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003548">i</span>&nbsp;<span class="op" id="2003550">:=</span>&nbsp;<span class="ident" id="2003553">d</span><span class="op" id="2003554">.</span><span class="ident" id="2003555">nd</span>&nbsp;<span class="op" id="2003558">-</span>&nbsp;<span class="num" id="2003560">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003564">for</span>&nbsp;<span class="op" id="2003568">;</span>&nbsp;<span class="ident" id="2003570">i</span>&nbsp;<span class="op" id="2003572">&gt;=</span>&nbsp;<span class="num" id="2003575">0</span><span class="op" id="2003576">;</span>&nbsp;<span class="ident" id="2003578">i</span><span class="op" id="2003579">--</span>&nbsp;<span class="op" id="2003582">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003587">if</span>&nbsp;<span class="ident" id="2003590">d</span><span class="op" id="2003591">.</span><span class="ident" id="2003592">d</span><span class="op" id="2003593">[</span><span class="ident" id="2003594">i</span><span class="op" id="2003595">]</span>&nbsp;<span class="op" id="2003597">==</span>&nbsp;<span class="string" id="2003600">&#39;9&#39;</span>&nbsp;<span class="op" id="2003604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003610">d</span><span class="op" id="2003611">.</span><span class="ident" id="2003612">nd</span><span class="op" id="2003614">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003620">}</span>&nbsp;<span class="keyword" id="2003622">else</span>&nbsp;<span class="op" id="2003627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003633">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003642">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003650">if</span>&nbsp;<span class="ident" id="2003653">i</span>&nbsp;<span class="op" id="2003655">&lt;</span>&nbsp;<span class="num" id="2003657">0</span>&nbsp;<span class="op" id="2003659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003664">d</span><span class="op" id="2003665">.</span><span class="ident" id="2003666">d</span><span class="op" id="2003667">[</span><span class="num" id="2003668">0</span><span class="op" id="2003669">]</span>&nbsp;<span class="op" id="2003671">=</span>&nbsp;<span class="string" id="2003673">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003680">d</span><span class="op" id="2003681">.</span><span class="ident" id="2003682">nd</span>&nbsp;<span class="op" id="2003685">=</span>&nbsp;<span class="num" id="2003687">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003692">d</span><span class="op" id="2003693">.</span><span class="ident" id="2003694">dp</span><span class="op" id="2003696">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003701">}</span>&nbsp;<span class="keyword" id="2003703">else</span>&nbsp;<span class="op" id="2003708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2003713">d</span><span class="op" id="2003714">.</span><span class="ident" id="2003715">d</span><span class="op" id="2003716">[</span><span class="ident" id="2003717">i</span><span class="op" id="2003718">]</span><span class="op" id="2003719">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003728">return</span>&nbsp;<span class="builtintype" id="2003735">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2003741">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2003744">return</span>&nbsp;<span class="builtintype" id="2003751">false</span><br>
<span class="lineno"></span><span class="op" id="2003757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2003760">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2003832">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="2003906">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2003984">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2004014">func</span>&nbsp;<span class="op" id="2004019">(</span><span class="ident" id="2004020">f</span>&nbsp;<span class="op" id="2004022">*</span><span class="ident" id="2004023">extFloat</span><span class="op" id="2004031">)</span>&nbsp;<span class="ident" id="2004033">ShortestDecimal</span><span class="op" id="2004048">(</span><span class="ident" id="2004049">d</span>&nbsp;<span class="op" id="2004051">*</span><span class="ident" id="2004052">decimalSlice</span><span class="op" id="2004064">,</span>&nbsp;<span class="ident" id="2004066">lower</span><span class="op" id="2004071">,</span>&nbsp;<span class="ident" id="2004073">upper</span>&nbsp;<span class="op" id="2004079">*</span><span class="ident" id="2004080">extFloat</span><span class="op" id="2004088">)</span>&nbsp;<span class="builtintype" id="2004090">bool</span>&nbsp;<span class="op" id="2004095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004098">if</span>&nbsp;<span class="ident" id="2004101">f</span><span class="op" id="2004102">.</span><span class="ident" id="2004103">mant</span>&nbsp;<span class="op" id="2004108">==</span>&nbsp;<span class="num" id="2004111">0</span>&nbsp;<span class="op" id="2004113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004117">d</span><span class="op" id="2004118">.</span><span class="ident" id="2004119">nd</span>&nbsp;<span class="op" id="2004122">=</span>&nbsp;<span class="num" id="2004124">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004128">d</span><span class="op" id="2004129">.</span><span class="ident" id="2004130">dp</span>&nbsp;<span class="op" id="2004133">=</span>&nbsp;<span class="num" id="2004135">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004139">d</span><span class="op" id="2004140">.</span><span class="ident" id="2004141">neg</span>&nbsp;<span class="op" id="2004145">=</span>&nbsp;<span class="ident" id="2004147">f</span><span class="op" id="2004148">.</span><span class="ident" id="2004149">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004155">return</span>&nbsp;<span class="builtintype" id="2004162">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004171">if</span>&nbsp;<span class="ident" id="2004174">f</span><span class="op" id="2004175">.</span><span class="ident" id="2004176">exp</span>&nbsp;<span class="op" id="2004180">==</span>&nbsp;<span class="num" id="2004183">0</span>&nbsp;<span class="op" id="2004185">&amp;&amp;</span>&nbsp;<span class="op" id="2004188">*</span><span class="ident" id="2004189">lower</span>&nbsp;<span class="op" id="2004195">==</span>&nbsp;<span class="op" id="2004198">*</span><span class="ident" id="2004199">f</span>&nbsp;<span class="op" id="2004201">&amp;&amp;</span>&nbsp;<span class="op" id="2004204">*</span><span class="ident" id="2004205">lower</span>&nbsp;<span class="op" id="2004211">==</span>&nbsp;<span class="op" id="2004214">*</span><span class="ident" id="2004215">upper</span>&nbsp;<span class="op" id="2004221">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004225">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004248">var</span>&nbsp;<span class="ident" id="2004252">buf</span>&nbsp;<span class="op" id="2004256">[</span><span class="num" id="2004257">24</span><span class="op" id="2004259">]</span><span class="builtintype" id="2004260">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004267">n</span>&nbsp;<span class="op" id="2004269">:=</span>&nbsp;<span class="builtinfunc" id="2004272">len</span><span class="op" id="2004275">(</span><span class="ident" id="2004276">buf</span><span class="op" id="2004279">)</span>&nbsp;<span class="op" id="2004281">-</span>&nbsp;<span class="num" id="2004283">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004287">for</span>&nbsp;<span class="ident" id="2004291">v</span>&nbsp;<span class="op" id="2004293">:=</span>&nbsp;<span class="ident" id="2004296">f</span><span class="op" id="2004297">.</span><span class="ident" id="2004298">mant</span><span class="op" id="2004302">;</span>&nbsp;<span class="ident" id="2004304">v</span>&nbsp;<span class="op" id="2004306">&gt;</span>&nbsp;<span class="num" id="2004308">0</span><span class="op" id="2004309">;</span>&nbsp;<span class="op" id="2004311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004316">v1</span>&nbsp;<span class="op" id="2004319">:=</span>&nbsp;<span class="ident" id="2004322">v</span>&nbsp;<span class="op" id="2004324">/</span>&nbsp;<span class="num" id="2004326">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004332">v</span>&nbsp;<span class="op" id="2004334">-=</span>&nbsp;<span class="num" id="2004337">10</span>&nbsp;<span class="op" id="2004340">*</span>&nbsp;<span class="ident" id="2004342">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004348">buf</span><span class="op" id="2004351">[</span><span class="ident" id="2004352">n</span><span class="op" id="2004353">]</span>&nbsp;<span class="op" id="2004355">=</span>&nbsp;<span class="builtintype" id="2004357">byte</span><span class="op" id="2004361">(</span><span class="ident" id="2004362">v</span>&nbsp;<span class="op" id="2004364">+</span>&nbsp;<span class="string" id="2004366">&#39;0&#39;</span><span class="op" id="2004369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004374">n</span><span class="op" id="2004375">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004381">v</span>&nbsp;<span class="op" id="2004383">=</span>&nbsp;<span class="ident" id="2004385">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004390">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004394">nd</span>&nbsp;<span class="op" id="2004397">:=</span>&nbsp;<span class="builtinfunc" id="2004400">len</span><span class="op" id="2004403">(</span><span class="ident" id="2004404">buf</span><span class="op" id="2004407">)</span>&nbsp;<span class="op" id="2004409">-</span>&nbsp;<span class="ident" id="2004411">n</span>&nbsp;<span class="op" id="2004413">-</span>&nbsp;<span class="num" id="2004415">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004419">for</span>&nbsp;<span class="ident" id="2004423">i</span>&nbsp;<span class="op" id="2004425">:=</span>&nbsp;<span class="num" id="2004428">0</span><span class="op" id="2004429">;</span>&nbsp;<span class="ident" id="2004431">i</span>&nbsp;<span class="op" id="2004433">&lt;</span>&nbsp;<span class="ident" id="2004435">nd</span><span class="op" id="2004437">;</span>&nbsp;<span class="ident" id="2004439">i</span><span class="op" id="2004440">++</span>&nbsp;<span class="op" id="2004443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004448">d</span><span class="op" id="2004449">.</span><span class="ident" id="2004450">d</span><span class="op" id="2004451">[</span><span class="ident" id="2004452">i</span><span class="op" id="2004453">]</span>&nbsp;<span class="op" id="2004455">=</span>&nbsp;<span class="ident" id="2004457">buf</span><span class="op" id="2004460">[</span><span class="ident" id="2004461">n</span><span class="op" id="2004462">+</span><span class="num" id="2004463">1</span><span class="op" id="2004464">+</span><span class="ident" id="2004465">i</span><span class="op" id="2004466">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004474">d</span><span class="op" id="2004475">.</span><span class="ident" id="2004476">nd</span><span class="op" id="2004478">,</span>&nbsp;<span class="ident" id="2004480">d</span><span class="op" id="2004481">.</span><span class="ident" id="2004482">dp</span>&nbsp;<span class="op" id="2004485">=</span>&nbsp;<span class="ident" id="2004487">nd</span><span class="op" id="2004489">,</span>&nbsp;<span class="ident" id="2004491">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004496">for</span>&nbsp;<span class="ident" id="2004500">d</span><span class="op" id="2004501">.</span><span class="ident" id="2004502">nd</span>&nbsp;<span class="op" id="2004505">&gt;</span>&nbsp;<span class="num" id="2004507">0</span>&nbsp;<span class="op" id="2004509">&amp;&amp;</span>&nbsp;<span class="ident" id="2004512">d</span><span class="op" id="2004513">.</span><span class="ident" id="2004514">d</span><span class="op" id="2004515">[</span><span class="ident" id="2004516">d</span><span class="op" id="2004517">.</span><span class="ident" id="2004518">nd</span><span class="op" id="2004520">-</span><span class="num" id="2004521">1</span><span class="op" id="2004522">]</span>&nbsp;<span class="op" id="2004524">==</span>&nbsp;<span class="string" id="2004527">&#39;0&#39;</span>&nbsp;<span class="op" id="2004531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004536">d</span><span class="op" id="2004537">.</span><span class="ident" id="2004538">nd</span><span class="op" id="2004540">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004549">if</span>&nbsp;<span class="ident" id="2004552">d</span><span class="op" id="2004553">.</span><span class="ident" id="2004554">nd</span>&nbsp;<span class="op" id="2004557">==</span>&nbsp;<span class="num" id="2004560">0</span>&nbsp;<span class="op" id="2004562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004567">d</span><span class="op" id="2004568">.</span><span class="ident" id="2004569">dp</span>&nbsp;<span class="op" id="2004572">=</span>&nbsp;<span class="num" id="2004574">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004582">d</span><span class="op" id="2004583">.</span><span class="ident" id="2004584">neg</span>&nbsp;<span class="op" id="2004588">=</span>&nbsp;<span class="ident" id="2004590">f</span><span class="op" id="2004591">.</span><span class="ident" id="2004592">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004598">return</span>&nbsp;<span class="builtintype" id="2004605">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004614">upper</span><span class="op" id="2004619">.</span><span class="ident" id="2004620">Normalize</span><span class="op" id="2004629">(</span><span class="op" id="2004630">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004633">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004659">if</span>&nbsp;<span class="ident" id="2004662">f</span><span class="op" id="2004663">.</span><span class="ident" id="2004664">exp</span>&nbsp;<span class="op" id="2004668">&gt;</span>&nbsp;<span class="ident" id="2004670">upper</span><span class="op" id="2004675">.</span><span class="ident" id="2004676">exp</span>&nbsp;<span class="op" id="2004680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004684">f</span><span class="op" id="2004685">.</span><span class="ident" id="2004686">mant</span>&nbsp;<span class="op" id="2004691">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2004695">uint</span><span class="op" id="2004699">(</span><span class="ident" id="2004700">f</span><span class="op" id="2004701">.</span><span class="ident" id="2004702">exp</span>&nbsp;<span class="op" id="2004706">-</span>&nbsp;<span class="ident" id="2004708">upper</span><span class="op" id="2004713">.</span><span class="ident" id="2004714">exp</span><span class="op" id="2004717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004721">f</span><span class="op" id="2004722">.</span><span class="ident" id="2004723">exp</span>&nbsp;<span class="op" id="2004727">=</span>&nbsp;<span class="ident" id="2004729">upper</span><span class="op" id="2004734">.</span><span class="ident" id="2004735">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004740">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2004743">if</span>&nbsp;<span class="ident" id="2004746">lower</span><span class="op" id="2004751">.</span><span class="ident" id="2004752">exp</span>&nbsp;<span class="op" id="2004756">&gt;</span>&nbsp;<span class="ident" id="2004758">upper</span><span class="op" id="2004763">.</span><span class="ident" id="2004764">exp</span>&nbsp;<span class="op" id="2004768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004772">lower</span><span class="op" id="2004777">.</span><span class="ident" id="2004778">mant</span>&nbsp;<span class="op" id="2004783">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2004787">uint</span><span class="op" id="2004791">(</span><span class="ident" id="2004792">lower</span><span class="op" id="2004797">.</span><span class="ident" id="2004798">exp</span>&nbsp;<span class="op" id="2004802">-</span>&nbsp;<span class="ident" id="2004804">upper</span><span class="op" id="2004809">.</span><span class="ident" id="2004810">exp</span><span class="op" id="2004813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004817">lower</span><span class="op" id="2004822">.</span><span class="ident" id="2004823">exp</span>&nbsp;<span class="op" id="2004827">=</span>&nbsp;<span class="ident" id="2004829">upper</span><span class="op" id="2004834">.</span><span class="ident" id="2004835">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2004840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004844">exp10</span>&nbsp;<span class="op" id="2004850">:=</span>&nbsp;<span class="ident" id="2004853">frexp10Many</span><span class="op" id="2004864">(</span><span class="ident" id="2004865">lower</span><span class="op" id="2004870">,</span>&nbsp;<span class="ident" id="2004872">f</span><span class="op" id="2004873">,</span>&nbsp;<span class="ident" id="2004875">upper</span><span class="op" id="2004880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004883">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004963">upper</span><span class="op" id="2004968">.</span><span class="ident" id="2004969">mant</span><span class="op" id="2004973">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2004977">lower</span><span class="op" id="2004982">.</span><span class="ident" id="2004983">mant</span><span class="op" id="2004987">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2004992">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005063">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005109">shift</span>&nbsp;<span class="op" id="2005115">:=</span>&nbsp;<span class="builtintype" id="2005118">uint</span><span class="op" id="2005122">(</span><span class="op" id="2005123">-</span><span class="ident" id="2005124">upper</span><span class="op" id="2005129">.</span><span class="ident" id="2005130">exp</span><span class="op" id="2005133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005136">integer</span>&nbsp;<span class="op" id="2005144">:=</span>&nbsp;<span class="builtintype" id="2005147">uint32</span><span class="op" id="2005153">(</span><span class="ident" id="2005154">upper</span><span class="op" id="2005159">.</span><span class="ident" id="2005160">mant</span>&nbsp;<span class="op" id="2005165">&gt;&gt;</span>&nbsp;<span class="ident" id="2005168">shift</span><span class="op" id="2005173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005176">fraction</span>&nbsp;<span class="op" id="2005185">:=</span>&nbsp;<span class="ident" id="2005188">upper</span><span class="op" id="2005193">.</span><span class="ident" id="2005194">mant</span>&nbsp;<span class="op" id="2005199">-</span>&nbsp;<span class="op" id="2005201">(</span><span class="ident" id="2005202">uint64</span><span class="op" id="2005208">(</span><span class="ident" id="2005209">integer</span><span class="op" id="2005216">)</span>&nbsp;<span class="op" id="2005218">&lt;&lt;</span>&nbsp;<span class="ident" id="2005221">shift</span><span class="op" id="2005226">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005230">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005295">allowance</span>&nbsp;<span class="op" id="2005305">:=</span>&nbsp;<span class="ident" id="2005308">upper</span><span class="op" id="2005313">.</span><span class="ident" id="2005314">mant</span>&nbsp;<span class="op" id="2005319">-</span>&nbsp;<span class="ident" id="2005321">lower</span><span class="op" id="2005326">.</span><span class="ident" id="2005327">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005333">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005388">targetDiff</span>&nbsp;<span class="op" id="2005399">:=</span>&nbsp;<span class="ident" id="2005402">upper</span><span class="op" id="2005407">.</span><span class="ident" id="2005408">mant</span>&nbsp;<span class="op" id="2005413">-</span>&nbsp;<span class="ident" id="2005415">f</span><span class="op" id="2005416">.</span><span class="ident" id="2005417">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005424">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2005473">var</span>&nbsp;<span class="ident" id="2005477">integerDigits</span>&nbsp;<span class="builtintype" id="2005491">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2005496">for</span>&nbsp;<span class="ident" id="2005500">i</span><span class="op" id="2005501">,</span>&nbsp;<span class="ident" id="2005503">pow</span>&nbsp;<span class="op" id="2005507">:=</span>&nbsp;<span class="num" id="2005510">0</span><span class="op" id="2005511">,</span>&nbsp;<span class="ident" id="2005513">uint64</span><span class="op" id="2005519">(</span><span class="num" id="2005520">1</span><span class="op" id="2005521">)</span><span class="op" id="2005522">;</span>&nbsp;<span class="ident" id="2005524">i</span>&nbsp;<span class="op" id="2005526">&lt;</span>&nbsp;<span class="num" id="2005528">20</span><span class="op" id="2005530">;</span>&nbsp;<span class="ident" id="2005532">i</span><span class="op" id="2005533">++</span>&nbsp;<span class="op" id="2005536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2005540">if</span>&nbsp;<span class="ident" id="2005543">pow</span>&nbsp;<span class="op" id="2005547">&gt;</span>&nbsp;<span class="ident" id="2005549">uint64</span><span class="op" id="2005555">(</span><span class="ident" id="2005556">integer</span><span class="op" id="2005563">)</span>&nbsp;<span class="op" id="2005565">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005570">integerDigits</span>&nbsp;<span class="op" id="2005584">=</span>&nbsp;<span class="ident" id="2005586">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2005591">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2005599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005603">pow</span>&nbsp;<span class="op" id="2005607">*=</span>&nbsp;<span class="num" id="2005610">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2005614">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2005617">for</span>&nbsp;<span class="ident" id="2005621">i</span>&nbsp;<span class="op" id="2005623">:=</span>&nbsp;<span class="num" id="2005626">0</span><span class="op" id="2005627">;</span>&nbsp;<span class="ident" id="2005629">i</span>&nbsp;<span class="op" id="2005631">&lt;</span>&nbsp;<span class="ident" id="2005633">integerDigits</span><span class="op" id="2005646">;</span>&nbsp;<span class="ident" id="2005648">i</span><span class="op" id="2005649">++</span>&nbsp;<span class="op" id="2005652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005656">pow</span>&nbsp;<span class="op" id="2005660">:=</span>&nbsp;<span class="ident" id="2005663">uint64pow10</span><span class="op" id="2005674">[</span><span class="ident" id="2005675">integerDigits</span><span class="op" id="2005688">-</span><span class="ident" id="2005689">i</span><span class="op" id="2005690">-</span><span class="num" id="2005691">1</span><span class="op" id="2005692">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005696">digit</span>&nbsp;<span class="op" id="2005702">:=</span>&nbsp;<span class="ident" id="2005705">integer</span>&nbsp;<span class="op" id="2005713">/</span>&nbsp;<span class="builtintype" id="2005715">uint32</span><span class="op" id="2005721">(</span><span class="ident" id="2005722">pow</span><span class="op" id="2005725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005729">d</span><span class="op" id="2005730">.</span><span class="ident" id="2005731">d</span><span class="op" id="2005732">[</span><span class="ident" id="2005733">i</span><span class="op" id="2005734">]</span>&nbsp;<span class="op" id="2005736">=</span>&nbsp;<span class="builtintype" id="2005738">byte</span><span class="op" id="2005742">(</span><span class="ident" id="2005743">digit</span>&nbsp;<span class="op" id="2005749">+</span>&nbsp;<span class="string" id="2005751">&#39;0&#39;</span><span class="op" id="2005754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005758">integer</span>&nbsp;<span class="op" id="2005766">-=</span>&nbsp;<span class="ident" id="2005769">digit</span>&nbsp;<span class="op" id="2005775">*</span>&nbsp;<span class="builtintype" id="2005777">uint32</span><span class="op" id="2005783">(</span><span class="ident" id="2005784">pow</span><span class="op" id="2005787">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005791">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2005829">if</span>&nbsp;<span class="ident" id="2005832">currentDiff</span>&nbsp;<span class="op" id="2005844">:=</span>&nbsp;<span class="ident" id="2005847">uint64</span><span class="op" id="2005853">(</span><span class="ident" id="2005854">integer</span><span class="op" id="2005861">)</span><span class="op" id="2005862">&lt;&lt;</span><span class="ident" id="2005864">shift</span>&nbsp;<span class="op" id="2005870">+</span>&nbsp;<span class="ident" id="2005872">fraction</span><span class="op" id="2005880">;</span>&nbsp;<span class="ident" id="2005882">currentDiff</span>&nbsp;<span class="op" id="2005894">&lt;</span>&nbsp;<span class="ident" id="2005896">allowance</span>&nbsp;<span class="op" id="2005906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005911">d</span><span class="op" id="2005912">.</span><span class="ident" id="2005913">nd</span>&nbsp;<span class="op" id="2005916">=</span>&nbsp;<span class="ident" id="2005918">i</span>&nbsp;<span class="op" id="2005920">+</span>&nbsp;<span class="num" id="2005922">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005927">d</span><span class="op" id="2005928">.</span><span class="ident" id="2005929">dp</span>&nbsp;<span class="op" id="2005932">=</span>&nbsp;<span class="ident" id="2005934">integerDigits</span>&nbsp;<span class="op" id="2005948">+</span>&nbsp;<span class="ident" id="2005950">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2005959">d</span><span class="op" id="2005960">.</span><span class="ident" id="2005961">neg</span>&nbsp;<span class="op" id="2005965">=</span>&nbsp;<span class="ident" id="2005967">f</span><span class="op" id="2005968">.</span><span class="ident" id="2005969">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2005976">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006046">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2006084">return</span>&nbsp;<span class="ident" id="2006091">adjustLastDigit</span><span class="op" id="2006106">(</span><span class="ident" id="2006107">d</span><span class="op" id="2006108">,</span>&nbsp;<span class="ident" id="2006110">currentDiff</span><span class="op" id="2006121">,</span>&nbsp;<span class="ident" id="2006123">targetDiff</span><span class="op" id="2006133">,</span>&nbsp;<span class="ident" id="2006135">allowance</span><span class="op" id="2006144">,</span>&nbsp;<span class="ident" id="2006146">pow</span><span class="op" id="2006149">&lt;&lt;</span><span class="ident" id="2006151">shift</span><span class="op" id="2006156">,</span>&nbsp;<span class="num" id="2006158">2</span><span class="op" id="2006159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2006163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2006166">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006169">d</span><span class="op" id="2006170">.</span><span class="ident" id="2006171">nd</span>&nbsp;<span class="op" id="2006174">=</span>&nbsp;<span class="ident" id="2006176">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006191">d</span><span class="op" id="2006192">.</span><span class="ident" id="2006193">dp</span>&nbsp;<span class="op" id="2006196">=</span>&nbsp;<span class="ident" id="2006198">d</span><span class="op" id="2006199">.</span><span class="ident" id="2006200">nd</span>&nbsp;<span class="op" id="2006203">+</span>&nbsp;<span class="ident" id="2006205">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006212">d</span><span class="op" id="2006213">.</span><span class="ident" id="2006214">neg</span>&nbsp;<span class="op" id="2006218">=</span>&nbsp;<span class="ident" id="2006220">f</span><span class="op" id="2006221">.</span><span class="ident" id="2006222">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006228">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006302">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2006378">var</span>&nbsp;<span class="ident" id="2006382">digit</span>&nbsp;<span class="builtintype" id="2006388">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006393">multiplier</span>&nbsp;<span class="op" id="2006404">:=</span>&nbsp;<span class="ident" id="2006407">uint64</span><span class="op" id="2006413">(</span><span class="num" id="2006414">1</span><span class="op" id="2006415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2006418">for</span>&nbsp;<span class="op" id="2006422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006426">fraction</span>&nbsp;<span class="op" id="2006435">*=</span>&nbsp;<span class="num" id="2006438">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006443">multiplier</span>&nbsp;<span class="op" id="2006454">*=</span>&nbsp;<span class="num" id="2006457">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006462">digit</span>&nbsp;<span class="op" id="2006468">=</span>&nbsp;<span class="builtintype" id="2006470">int</span><span class="op" id="2006473">(</span><span class="ident" id="2006474">fraction</span>&nbsp;<span class="op" id="2006483">&gt;&gt;</span>&nbsp;<span class="ident" id="2006486">shift</span><span class="op" id="2006491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006495">d</span><span class="op" id="2006496">.</span><span class="ident" id="2006497">d</span><span class="op" id="2006498">[</span><span class="ident" id="2006499">d</span><span class="op" id="2006500">.</span><span class="ident" id="2006501">nd</span><span class="op" id="2006503">]</span>&nbsp;<span class="op" id="2006505">=</span>&nbsp;<span class="builtintype" id="2006507">byte</span><span class="op" id="2006511">(</span><span class="ident" id="2006512">digit</span>&nbsp;<span class="op" id="2006518">+</span>&nbsp;<span class="string" id="2006520">&#39;0&#39;</span><span class="op" id="2006523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006527">d</span><span class="op" id="2006528">.</span><span class="ident" id="2006529">nd</span><span class="op" id="2006531">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006536">fraction</span>&nbsp;<span class="op" id="2006545">-=</span>&nbsp;<span class="ident" id="2006548">uint64</span><span class="op" id="2006554">(</span><span class="ident" id="2006555">digit</span><span class="op" id="2006560">)</span>&nbsp;<span class="op" id="2006562">&lt;&lt;</span>&nbsp;<span class="ident" id="2006565">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2006573">if</span>&nbsp;<span class="ident" id="2006576">fraction</span>&nbsp;<span class="op" id="2006585">&lt;</span>&nbsp;<span class="ident" id="2006587">allowance</span><span class="op" id="2006596">*</span><span class="ident" id="2006597">multiplier</span>&nbsp;<span class="op" id="2006608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006613">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006686">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006763">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2006812">return</span>&nbsp;<span class="ident" id="2006819">adjustLastDigit</span><span class="op" id="2006834">(</span><span class="ident" id="2006835">d</span><span class="op" id="2006836">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006842">fraction</span><span class="op" id="2006850">,</span>&nbsp;<span class="ident" id="2006852">targetDiff</span><span class="op" id="2006862">*</span><span class="ident" id="2006863">multiplier</span><span class="op" id="2006873">,</span>&nbsp;<span class="ident" id="2006875">allowance</span><span class="op" id="2006884">*</span><span class="ident" id="2006885">multiplier</span><span class="op" id="2006895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2006901">1</span><span class="op" id="2006902">&lt;&lt;</span><span class="ident" id="2006904">shift</span><span class="op" id="2006909">,</span>&nbsp;<span class="ident" id="2006911">multiplier</span><span class="op" id="2006921">*</span><span class="num" id="2006922">2</span><span class="op" id="2006923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2006927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2006930">}</span><br>
<span class="lineno"></span><span class="op" id="2006932">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2006935">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*ε,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2007003">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*ε,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*ε.</span><br>
<span class="lineno"></span><span class="comment" id="2007071">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*ε,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2007139">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*ε.</span><br>
<span class="lineno">645</span><span class="keyword" id="2007199">func</span>&nbsp;<span class="ident" id="2007204">adjustLastDigit</span><span class="op" id="2007219">(</span><span class="ident" id="2007220">d</span>&nbsp;<span class="op" id="2007222">*</span><span class="ident" id="2007223">decimalSlice</span><span class="op" id="2007235">,</span>&nbsp;<span class="ident" id="2007237">currentDiff</span><span class="op" id="2007248">,</span>&nbsp;<span class="ident" id="2007250">targetDiff</span><span class="op" id="2007260">,</span>&nbsp;<span class="ident" id="2007262">maxDiff</span><span class="op" id="2007269">,</span>&nbsp;<span class="ident" id="2007271">ulpDecimal</span><span class="op" id="2007281">,</span>&nbsp;<span class="ident" id="2007283">ulpBinary</span>&nbsp;<span class="ident" id="2007293">uint64</span><span class="op" id="2007299">)</span>&nbsp;<span class="builtintype" id="2007301">bool</span>&nbsp;<span class="op" id="2007306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007309">if</span>&nbsp;<span class="ident" id="2007312">ulpDecimal</span>&nbsp;<span class="op" id="2007323">&lt;</span>&nbsp;<span class="num" id="2007325">2</span><span class="op" id="2007326">*</span><span class="ident" id="2007327">ulpBinary</span>&nbsp;<span class="op" id="2007337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007341">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007373">return</span>&nbsp;<span class="builtintype" id="2007380">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2007387">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007390">for</span>&nbsp;<span class="ident" id="2007394">currentDiff</span><span class="op" id="2007405">+</span><span class="ident" id="2007406">ulpDecimal</span><span class="op" id="2007416">/</span><span class="num" id="2007417">2</span><span class="op" id="2007418">+</span><span class="ident" id="2007419">ulpBinary</span>&nbsp;<span class="op" id="2007429">&lt;</span>&nbsp;<span class="ident" id="2007431">targetDiff</span>&nbsp;<span class="op" id="2007442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007446">d</span><span class="op" id="2007447">.</span><span class="ident" id="2007448">d</span><span class="op" id="2007449">[</span><span class="ident" id="2007450">d</span><span class="op" id="2007451">.</span><span class="ident" id="2007452">nd</span><span class="op" id="2007454">-</span><span class="num" id="2007455">1</span><span class="op" id="2007456">]</span><span class="op" id="2007457">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007462">currentDiff</span>&nbsp;<span class="op" id="2007474">+=</span>&nbsp;<span class="ident" id="2007477">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2007489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007492">if</span>&nbsp;<span class="ident" id="2007495">currentDiff</span><span class="op" id="2007506">+</span><span class="ident" id="2007507">ulpDecimal</span>&nbsp;<span class="op" id="2007518">&lt;=</span>&nbsp;<span class="ident" id="2007521">targetDiff</span><span class="op" id="2007531">+</span><span class="ident" id="2007532">ulpDecimal</span><span class="op" id="2007542">/</span><span class="num" id="2007543">2</span><span class="op" id="2007544">+</span><span class="ident" id="2007545">ulpBinary</span>&nbsp;<span class="op" id="2007555">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007559">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007612">return</span>&nbsp;<span class="builtintype" id="2007619">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2007626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007629">if</span>&nbsp;<span class="ident" id="2007632">currentDiff</span>&nbsp;<span class="op" id="2007644">&lt;</span>&nbsp;<span class="ident" id="2007646">ulpBinary</span>&nbsp;<span class="op" id="2007656">||</span>&nbsp;<span class="ident" id="2007659">currentDiff</span>&nbsp;<span class="op" id="2007671">&gt;</span>&nbsp;<span class="ident" id="2007673">maxDiff</span><span class="op" id="2007680">-</span><span class="ident" id="2007681">ulpBinary</span>&nbsp;<span class="op" id="2007691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007695">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007716">return</span>&nbsp;<span class="builtintype" id="2007723">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2007730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007733">if</span>&nbsp;<span class="ident" id="2007736">d</span><span class="op" id="2007737">.</span><span class="ident" id="2007738">nd</span>&nbsp;<span class="op" id="2007741">==</span>&nbsp;<span class="num" id="2007744">1</span>&nbsp;<span class="op" id="2007746">&amp;&amp;</span>&nbsp;<span class="ident" id="2007749">d</span><span class="op" id="2007750">.</span><span class="ident" id="2007751">d</span><span class="op" id="2007752">[</span><span class="num" id="2007753">0</span><span class="op" id="2007754">]</span>&nbsp;<span class="op" id="2007756">==</span>&nbsp;<span class="string" id="2007759">&#39;0&#39;</span>&nbsp;<span class="op" id="2007763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007767">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007810">d</span><span class="op" id="2007811">.</span><span class="ident" id="2007812">nd</span>&nbsp;<span class="op" id="2007815">=</span>&nbsp;<span class="num" id="2007817">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007821">d</span><span class="op" id="2007822">.</span><span class="ident" id="2007823">dp</span>&nbsp;<span class="op" id="2007826">=</span>&nbsp;<span class="num" id="2007828">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2007831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2007834">return</span>&nbsp;<span class="builtintype" id="2007841">true</span><br>
<span class="lineno"></span><span class="op" id="2007846">}</span>
</div>
</body>
</html>
