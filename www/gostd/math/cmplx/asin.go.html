<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html" class="current">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6246651">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6246706">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6246760">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6246811">package</span>&nbsp;<span class="ident" id="6246819">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6246826">import</span>&nbsp;<span class="string" id="6246833">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6246841">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6246901">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6246971">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6247029">//</span><br>
<span class="lineno"></span><span class="comment" id="6247032">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6247080">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6247144">//</span><br>
<span class="lineno"></span><span class="comment" id="6247147">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6247208">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6247278">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6247353">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6247420">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6247493">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6247565">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6247579">//</span><br>
<span class="lineno"></span><span class="comment" id="6247582">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6247648">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6247714">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6247727">//</span><br>
<span class="lineno"></span><span class="comment" id="6247730">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6247754">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6247784">//&nbsp;Complex&nbsp;circular&nbsp;arc&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="6247813">//</span><br>
<span class="lineno"></span><span class="comment" id="6247816">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6247832">//</span><br>
<span class="lineno">35</span><span class="comment" id="6247835">//&nbsp;Inverse&nbsp;complex&nbsp;sine:</span><br>
<span class="lineno"></span><span class="comment" id="6247860">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="6247895">//&nbsp;w&nbsp;=&nbsp;-i&nbsp;clog(&nbsp;iz&nbsp;+&nbsp;csqrt(&nbsp;1&nbsp;-&nbsp;z&nbsp;)&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="6247934">//</span><br>
<span class="lineno"></span><span class="comment" id="6247937">//&nbsp;casin(z)&nbsp;=&nbsp;-i&nbsp;casinh(iz)</span><br>
<span class="lineno">40</span><span class="comment" id="6247965">//</span><br>
<span class="lineno"></span><span class="comment" id="6247968">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6247981">//</span><br>
<span class="lineno"></span><span class="comment" id="6247984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6248024">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">45</span><span class="comment" id="6248082">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.4e-16</span><br>
<span class="lineno"></span><span class="comment" id="6248142">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.7e-15</span><br>
<span class="lineno"></span><span class="comment" id="6248202">//&nbsp;Larger&nbsp;relative&nbsp;error&nbsp;can&nbsp;be&nbsp;observed&nbsp;for&nbsp;z&nbsp;near&nbsp;zero.</span><br>
<span class="lineno"></span><span class="comment" id="6248260">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;csin(casin(z))&nbsp;=&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="6248299">//&nbsp;Asin&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;sine&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6248338">func</span>&nbsp;<span class="ident" id="6248343">Asin</span><span class="op" id="6248347">(</span><span class="ident" id="6248348">x</span>&nbsp;<span class="builtintype" id="6248350">complex128</span><span class="op" id="6248360">)</span>&nbsp;<span class="builtintype" id="6248362">complex128</span>&nbsp;<span class="op" id="6248373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248376">if</span>&nbsp;<span class="builtinfunc" id="6248379">imag</span><span class="op" id="6248383">(</span><span class="ident" id="6248384">x</span><span class="op" id="6248385">)</span>&nbsp;<span class="op" id="6248387">==</span>&nbsp;<span class="num" id="6248390">0</span>&nbsp;<span class="op" id="6248392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248396">if</span>&nbsp;<span class="ident" id="6248399">math</span><span class="op" id="6248403">.</span><span class="ident" id="6248404">Abs</span><span class="op" id="6248407">(</span><span class="builtinfunc" id="6248408">real</span><span class="op" id="6248412">(</span><span class="ident" id="6248413">x</span><span class="op" id="6248414">)</span><span class="op" id="6248415">)</span>&nbsp;<span class="op" id="6248417">&gt;</span>&nbsp;<span class="num" id="6248419">1</span>&nbsp;<span class="op" id="6248421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248426">return</span>&nbsp;<span class="builtinfunc" id="6248433">complex</span><span class="op" id="6248440">(</span><span class="ident" id="6248441">math</span><span class="op" id="6248445">.</span><span class="ident" id="6248446">Pi</span><span class="op" id="6248448">/</span><span class="num" id="6248449">2</span><span class="op" id="6248450">,</span>&nbsp;<span class="num" id="6248452">0</span><span class="op" id="6248453">)</span>&nbsp;<span class="comment" id="6248455">//&nbsp;DOMAIN&nbsp;error</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248477">return</span>&nbsp;<span class="builtinfunc" id="6248484">complex</span><span class="op" id="6248491">(</span><span class="ident" id="6248492">math</span><span class="op" id="6248496">.</span><span class="ident" id="6248497">Asin</span><span class="op" id="6248501">(</span><span class="builtinfunc" id="6248502">real</span><span class="op" id="6248506">(</span><span class="ident" id="6248507">x</span><span class="op" id="6248508">)</span><span class="op" id="6248509">)</span><span class="op" id="6248510">,</span>&nbsp;<span class="num" id="6248512">0</span><span class="op" id="6248513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248519">ct</span>&nbsp;<span class="op" id="6248522">:=</span>&nbsp;<span class="builtinfunc" id="6248525">complex</span><span class="op" id="6248532">(</span><span class="op" id="6248533">-</span><span class="builtinfunc" id="6248534">imag</span><span class="op" id="6248538">(</span><span class="ident" id="6248539">x</span><span class="op" id="6248540">)</span><span class="op" id="6248541">,</span>&nbsp;<span class="builtinfunc" id="6248543">real</span><span class="op" id="6248547">(</span><span class="ident" id="6248548">x</span><span class="op" id="6248549">)</span><span class="op" id="6248550">)</span>&nbsp;<span class="comment" id="6248552">//&nbsp;i&nbsp;*&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248562">xx</span>&nbsp;<span class="op" id="6248565">:=</span>&nbsp;<span class="ident" id="6248568">x</span>&nbsp;<span class="op" id="6248570">*</span>&nbsp;<span class="ident" id="6248572">x</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248575">x1</span>&nbsp;<span class="op" id="6248578">:=</span>&nbsp;<span class="builtinfunc" id="6248581">complex</span><span class="op" id="6248588">(</span><span class="num" id="6248589">1</span><span class="op" id="6248590">-</span><span class="builtinfunc" id="6248591">real</span><span class="op" id="6248595">(</span><span class="ident" id="6248596">xx</span><span class="op" id="6248598">)</span><span class="op" id="6248599">,</span>&nbsp;<span class="op" id="6248601">-</span><span class="builtinfunc" id="6248602">imag</span><span class="op" id="6248606">(</span><span class="ident" id="6248607">xx</span><span class="op" id="6248609">)</span><span class="op" id="6248610">)</span>&nbsp;<span class="comment" id="6248612">//&nbsp;1&nbsp;-&nbsp;x*x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248624">x2</span>&nbsp;<span class="op" id="6248627">:=</span>&nbsp;<span class="ident" id="6248630">Sqrt</span><span class="op" id="6248634">(</span><span class="ident" id="6248635">x1</span><span class="op" id="6248637">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6248661">//&nbsp;x2&nbsp;=&nbsp;sqrt(1&nbsp;-&nbsp;x*x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248684">w</span>&nbsp;<span class="op" id="6248686">:=</span>&nbsp;<span class="ident" id="6248689">Log</span><span class="op" id="6248692">(</span><span class="ident" id="6248693">ct</span>&nbsp;<span class="op" id="6248696">+</span>&nbsp;<span class="ident" id="6248698">x2</span><span class="op" id="6248700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248703">return</span>&nbsp;<span class="builtinfunc" id="6248710">complex</span><span class="op" id="6248717">(</span><span class="builtinfunc" id="6248718">imag</span><span class="op" id="6248722">(</span><span class="ident" id="6248723">w</span><span class="op" id="6248724">)</span><span class="op" id="6248725">,</span>&nbsp;<span class="op" id="6248727">-</span><span class="builtinfunc" id="6248728">real</span><span class="op" id="6248732">(</span><span class="ident" id="6248733">w</span><span class="op" id="6248734">)</span><span class="op" id="6248735">)</span>&nbsp;<span class="comment" id="6248737">//&nbsp;-i&nbsp;*&nbsp;w</span><br>
<span class="lineno"></span><span class="op" id="6248747">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="6248750">//&nbsp;Asinh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;sine&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6248801">func</span>&nbsp;<span class="ident" id="6248806">Asinh</span><span class="op" id="6248811">(</span><span class="ident" id="6248812">x</span>&nbsp;<span class="builtintype" id="6248814">complex128</span><span class="op" id="6248824">)</span>&nbsp;<span class="builtintype" id="6248826">complex128</span>&nbsp;<span class="op" id="6248837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248840">//&nbsp;TODO&nbsp;check&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248861">if</span>&nbsp;<span class="builtinfunc" id="6248864">imag</span><span class="op" id="6248868">(</span><span class="ident" id="6248869">x</span><span class="op" id="6248870">)</span>&nbsp;<span class="op" id="6248872">==</span>&nbsp;<span class="num" id="6248875">0</span>&nbsp;<span class="op" id="6248877">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248881">if</span>&nbsp;<span class="ident" id="6248884">math</span><span class="op" id="6248888">.</span><span class="ident" id="6248889">Abs</span><span class="op" id="6248892">(</span><span class="builtinfunc" id="6248893">real</span><span class="op" id="6248897">(</span><span class="ident" id="6248898">x</span><span class="op" id="6248899">)</span><span class="op" id="6248900">)</span>&nbsp;<span class="op" id="6248902">&gt;</span>&nbsp;<span class="num" id="6248904">1</span>&nbsp;<span class="op" id="6248906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248911">return</span>&nbsp;<span class="builtinfunc" id="6248918">complex</span><span class="op" id="6248925">(</span><span class="ident" id="6248926">math</span><span class="op" id="6248930">.</span><span class="ident" id="6248931">Pi</span><span class="op" id="6248933">/</span><span class="num" id="6248934">2</span><span class="op" id="6248935">,</span>&nbsp;<span class="num" id="6248937">0</span><span class="op" id="6248938">)</span>&nbsp;<span class="comment" id="6248940">//&nbsp;DOMAIN&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248962">return</span>&nbsp;<span class="builtinfunc" id="6248969">complex</span><span class="op" id="6248976">(</span><span class="ident" id="6248977">math</span><span class="op" id="6248981">.</span><span class="ident" id="6248982">Asinh</span><span class="op" id="6248987">(</span><span class="builtinfunc" id="6248988">real</span><span class="op" id="6248992">(</span><span class="ident" id="6248993">x</span><span class="op" id="6248994">)</span><span class="op" id="6248995">)</span><span class="op" id="6248996">,</span>&nbsp;<span class="num" id="6248998">0</span><span class="op" id="6248999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6249002">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249005">xx</span>&nbsp;<span class="op" id="6249008">:=</span>&nbsp;<span class="ident" id="6249011">x</span>&nbsp;<span class="op" id="6249013">*</span>&nbsp;<span class="ident" id="6249015">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249018">x1</span>&nbsp;<span class="op" id="6249021">:=</span>&nbsp;<span class="builtinfunc" id="6249024">complex</span><span class="op" id="6249031">(</span><span class="num" id="6249032">1</span><span class="op" id="6249033">+</span><span class="builtinfunc" id="6249034">real</span><span class="op" id="6249038">(</span><span class="ident" id="6249039">xx</span><span class="op" id="6249041">)</span><span class="op" id="6249042">,</span>&nbsp;<span class="builtinfunc" id="6249044">imag</span><span class="op" id="6249048">(</span><span class="ident" id="6249049">xx</span><span class="op" id="6249051">)</span><span class="op" id="6249052">)</span>&nbsp;<span class="comment" id="6249054">//&nbsp;1&nbsp;+&nbsp;x*x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249066">return</span>&nbsp;<span class="ident" id="6249073">Log</span><span class="op" id="6249076">(</span><span class="ident" id="6249077">x</span>&nbsp;<span class="op" id="6249079">+</span>&nbsp;<span class="ident" id="6249081">Sqrt</span><span class="op" id="6249085">(</span><span class="ident" id="6249086">x1</span><span class="op" id="6249088">)</span><span class="op" id="6249089">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6249102">//&nbsp;log(x&nbsp;+&nbsp;sqrt(1&nbsp;+&nbsp;x*x))</span><br>
<span class="lineno"></span><span class="op" id="6249128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="6249131">//&nbsp;Complex&nbsp;circular&nbsp;arc&nbsp;cosine</span><br>
<span class="lineno"></span><span class="comment" id="6249162">//</span><br>
<span class="lineno"></span><span class="comment" id="6249165">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6249181">//</span><br>
<span class="lineno"></span><span class="comment" id="6249184">//&nbsp;w&nbsp;=&nbsp;arccos&nbsp;z&nbsp;&nbsp;=&nbsp;&nbsp;PI/2&nbsp;-&nbsp;arcsin&nbsp;z.</span><br>
<span class="lineno">85</span><span class="comment" id="6249221">//</span><br>
<span class="lineno"></span><span class="comment" id="6249224">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6249237">//</span><br>
<span class="lineno"></span><span class="comment" id="6249240">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6249280">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">90</span><span class="comment" id="6249338">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.8e-16</span><br>
<span class="lineno"></span><span class="comment" id="6249398">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.8e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6249459">//&nbsp;Acos&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;cosine&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6249500">func</span>&nbsp;<span class="ident" id="6249505">Acos</span><span class="op" id="6249509">(</span><span class="ident" id="6249510">x</span>&nbsp;<span class="builtintype" id="6249512">complex128</span><span class="op" id="6249522">)</span>&nbsp;<span class="builtintype" id="6249524">complex128</span>&nbsp;<span class="op" id="6249535">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249538">w</span>&nbsp;<span class="op" id="6249540">:=</span>&nbsp;<span class="ident" id="6249543">Asin</span><span class="op" id="6249547">(</span><span class="ident" id="6249548">x</span><span class="op" id="6249549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249552">return</span>&nbsp;<span class="builtinfunc" id="6249559">complex</span><span class="op" id="6249566">(</span><span class="ident" id="6249567">math</span><span class="op" id="6249571">.</span><span class="ident" id="6249572">Pi</span><span class="op" id="6249574">/</span><span class="num" id="6249575">2</span><span class="op" id="6249576">-</span><span class="builtinfunc" id="6249577">real</span><span class="op" id="6249581">(</span><span class="ident" id="6249582">w</span><span class="op" id="6249583">)</span><span class="op" id="6249584">,</span>&nbsp;<span class="op" id="6249586">-</span><span class="builtinfunc" id="6249587">imag</span><span class="op" id="6249591">(</span><span class="ident" id="6249592">w</span><span class="op" id="6249593">)</span><span class="op" id="6249594">)</span><br>
<span class="lineno"></span><span class="op" id="6249596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6249599">//&nbsp;Acosh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;cosine&nbsp;of&nbsp;x.</span><br>
<span class="lineno">100</span><span class="keyword" id="6249652">func</span>&nbsp;<span class="ident" id="6249657">Acosh</span><span class="op" id="6249662">(</span><span class="ident" id="6249663">x</span>&nbsp;<span class="builtintype" id="6249665">complex128</span><span class="op" id="6249675">)</span>&nbsp;<span class="builtintype" id="6249677">complex128</span>&nbsp;<span class="op" id="6249688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249691">w</span>&nbsp;<span class="op" id="6249693">:=</span>&nbsp;<span class="ident" id="6249696">Acos</span><span class="op" id="6249700">(</span><span class="ident" id="6249701">x</span><span class="op" id="6249702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249705">if</span>&nbsp;<span class="builtinfunc" id="6249708">imag</span><span class="op" id="6249712">(</span><span class="ident" id="6249713">w</span><span class="op" id="6249714">)</span>&nbsp;<span class="op" id="6249716">&lt;=</span>&nbsp;<span class="num" id="6249719">0</span>&nbsp;<span class="op" id="6249721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249725">return</span>&nbsp;<span class="builtinfunc" id="6249732">complex</span><span class="op" id="6249739">(</span><span class="op" id="6249740">-</span><span class="builtinfunc" id="6249741">imag</span><span class="op" id="6249745">(</span><span class="ident" id="6249746">w</span><span class="op" id="6249747">)</span><span class="op" id="6249748">,</span>&nbsp;<span class="builtinfunc" id="6249750">real</span><span class="op" id="6249754">(</span><span class="ident" id="6249755">w</span><span class="op" id="6249756">)</span><span class="op" id="6249757">)</span>&nbsp;<span class="comment" id="6249759">//&nbsp;i&nbsp;*&nbsp;w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6249769">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249772">return</span>&nbsp;<span class="builtinfunc" id="6249779">complex</span><span class="op" id="6249786">(</span><span class="builtinfunc" id="6249787">imag</span><span class="op" id="6249791">(</span><span class="ident" id="6249792">w</span><span class="op" id="6249793">)</span><span class="op" id="6249794">,</span>&nbsp;<span class="op" id="6249796">-</span><span class="builtinfunc" id="6249797">real</span><span class="op" id="6249801">(</span><span class="ident" id="6249802">w</span><span class="op" id="6249803">)</span><span class="op" id="6249804">)</span>&nbsp;<span class="comment" id="6249806">//&nbsp;-i&nbsp;*&nbsp;w</span><br>
<span class="lineno"></span><span class="op" id="6249816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6249819">//&nbsp;Complex&nbsp;circular&nbsp;arc&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6249851">//</span><br>
<span class="lineno">110</span><span class="comment" id="6249854">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6249870">//</span><br>
<span class="lineno"></span><span class="comment" id="6249873">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6249879">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="6249898">//</span><br>
<span class="lineno">115</span><span class="comment" id="6249901">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6249909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;2x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="6249943">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;-&nbsp;arctan(-----------)&nbsp;&nbsp;+&nbsp;&nbsp;k&nbsp;PI</span><br>
<span class="lineno"></span><span class="comment" id="6249986">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;2)</span><br>
<span class="lineno"></span><span class="comment" id="6250020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1&nbsp;-&nbsp;x&nbsp;&nbsp;-&nbsp;y&nbsp;)</span><br>
<span class="lineno">120</span><span class="comment" id="6250054">//</span><br>
<span class="lineno"></span><span class="comment" id="6250057">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2)</span><br>
<span class="lineno"></span><span class="comment" id="6250089">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;(x&nbsp;&nbsp;+&nbsp;&nbsp;(y+1)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="6250121">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;-&nbsp;log(------------)</span><br>
<span class="lineno"></span><span class="comment" id="6250153">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2)</span><br>
<span class="lineno">125</span><span class="comment" id="6250185">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x&nbsp;&nbsp;+&nbsp;&nbsp;(y-1)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="6250217">//</span><br>
<span class="lineno"></span><span class="comment" id="6250220">//&nbsp;Where&nbsp;k&nbsp;is&nbsp;an&nbsp;arbitrary&nbsp;integer.</span><br>
<span class="lineno"></span><span class="comment" id="6250256">//</span><br>
<span class="lineno"></span><span class="comment" id="6250259">//&nbsp;catan(z)&nbsp;=&nbsp;-i&nbsp;catanh(iz).</span><br>
<span class="lineno">130</span><span class="comment" id="6250288">//</span><br>
<span class="lineno"></span><span class="comment" id="6250291">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6250304">//</span><br>
<span class="lineno"></span><span class="comment" id="6250307">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6250347">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">135</span><span class="comment" id="6250405">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5900&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="6250465">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="6250525">//&nbsp;The&nbsp;check&nbsp;catan(&nbsp;ctan(z)&nbsp;)&nbsp;&nbsp;=&nbsp;&nbsp;z,&nbsp;with&nbsp;|x|&nbsp;and&nbsp;|y|&nbsp;&lt;&nbsp;PI/2,</span><br>
<span class="lineno"></span><span class="comment" id="6250587">//&nbsp;had&nbsp;peak&nbsp;relative&nbsp;error&nbsp;1.5e-16,&nbsp;rms&nbsp;relative&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6250642">//&nbsp;2.9e-17.&nbsp;&nbsp;See&nbsp;also&nbsp;clog().</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="6250673">//&nbsp;Atan&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6250715">func</span>&nbsp;<span class="ident" id="6250720">Atan</span><span class="op" id="6250724">(</span><span class="ident" id="6250725">x</span>&nbsp;<span class="builtintype" id="6250727">complex128</span><span class="op" id="6250737">)</span>&nbsp;<span class="builtintype" id="6250739">complex128</span>&nbsp;<span class="op" id="6250750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250753">if</span>&nbsp;<span class="builtinfunc" id="6250756">real</span><span class="op" id="6250760">(</span><span class="ident" id="6250761">x</span><span class="op" id="6250762">)</span>&nbsp;<span class="op" id="6250764">==</span>&nbsp;<span class="num" id="6250767">0</span>&nbsp;<span class="op" id="6250769">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6250772">imag</span><span class="op" id="6250776">(</span><span class="ident" id="6250777">x</span><span class="op" id="6250778">)</span>&nbsp;<span class="op" id="6250780">&gt;</span>&nbsp;<span class="num" id="6250782">1</span>&nbsp;<span class="op" id="6250784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250788">return</span>&nbsp;<span class="ident" id="6250795">NaN</span><span class="op" id="6250798">(</span><span class="op" id="6250799">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250806">x2</span>&nbsp;<span class="op" id="6250809">:=</span>&nbsp;<span class="builtinfunc" id="6250812">real</span><span class="op" id="6250816">(</span><span class="ident" id="6250817">x</span><span class="op" id="6250818">)</span>&nbsp;<span class="op" id="6250820">*</span>&nbsp;<span class="builtinfunc" id="6250822">real</span><span class="op" id="6250826">(</span><span class="ident" id="6250827">x</span><span class="op" id="6250828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250831">a</span>&nbsp;<span class="op" id="6250833">:=</span>&nbsp;<span class="num" id="6250836">1</span>&nbsp;<span class="op" id="6250838">-</span>&nbsp;<span class="ident" id="6250840">x2</span>&nbsp;<span class="op" id="6250843">-</span>&nbsp;<span class="builtinfunc" id="6250845">imag</span><span class="op" id="6250849">(</span><span class="ident" id="6250850">x</span><span class="op" id="6250851">)</span><span class="op" id="6250852">*</span><span class="builtinfunc" id="6250853">imag</span><span class="op" id="6250857">(</span><span class="ident" id="6250858">x</span><span class="op" id="6250859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250862">if</span>&nbsp;<span class="ident" id="6250865">a</span>&nbsp;<span class="op" id="6250867">==</span>&nbsp;<span class="num" id="6250870">0</span>&nbsp;<span class="op" id="6250872">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250876">return</span>&nbsp;<span class="ident" id="6250883">NaN</span><span class="op" id="6250886">(</span><span class="op" id="6250887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250893">t</span>&nbsp;<span class="op" id="6250895">:=</span>&nbsp;<span class="num" id="6250898">0.5</span>&nbsp;<span class="op" id="6250902">*</span>&nbsp;<span class="ident" id="6250904">math</span><span class="op" id="6250908">.</span><span class="ident" id="6250909">Atan2</span><span class="op" id="6250914">(</span><span class="num" id="6250915">2</span><span class="op" id="6250916">*</span><span class="builtinfunc" id="6250917">real</span><span class="op" id="6250921">(</span><span class="ident" id="6250922">x</span><span class="op" id="6250923">)</span><span class="op" id="6250924">,</span>&nbsp;<span class="ident" id="6250926">a</span><span class="op" id="6250927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250930">w</span>&nbsp;<span class="op" id="6250932">:=</span>&nbsp;<span class="ident" id="6250935">reducePi</span><span class="op" id="6250943">(</span><span class="ident" id="6250944">t</span><span class="op" id="6250945">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250949">t</span>&nbsp;<span class="op" id="6250951">=</span>&nbsp;<span class="builtinfunc" id="6250953">imag</span><span class="op" id="6250957">(</span><span class="ident" id="6250958">x</span><span class="op" id="6250959">)</span>&nbsp;<span class="op" id="6250961">-</span>&nbsp;<span class="num" id="6250963">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250966">b</span>&nbsp;<span class="op" id="6250968">:=</span>&nbsp;<span class="ident" id="6250971">x2</span>&nbsp;<span class="op" id="6250974">+</span>&nbsp;<span class="ident" id="6250976">t</span><span class="op" id="6250977">*</span><span class="ident" id="6250978">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250981">if</span>&nbsp;<span class="ident" id="6250984">b</span>&nbsp;<span class="op" id="6250986">==</span>&nbsp;<span class="num" id="6250989">0</span>&nbsp;<span class="op" id="6250991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250995">return</span>&nbsp;<span class="ident" id="6251002">NaN</span><span class="op" id="6251005">(</span><span class="op" id="6251006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251009">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251012">t</span>&nbsp;<span class="op" id="6251014">=</span>&nbsp;<span class="builtinfunc" id="6251016">imag</span><span class="op" id="6251020">(</span><span class="ident" id="6251021">x</span><span class="op" id="6251022">)</span>&nbsp;<span class="op" id="6251024">+</span>&nbsp;<span class="num" id="6251026">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251029">c</span>&nbsp;<span class="op" id="6251031">:=</span>&nbsp;<span class="op" id="6251034">(</span><span class="ident" id="6251035">x2</span>&nbsp;<span class="op" id="6251038">+</span>&nbsp;<span class="ident" id="6251040">t</span><span class="op" id="6251041">*</span><span class="ident" id="6251042">t</span><span class="op" id="6251043">)</span>&nbsp;<span class="op" id="6251045">/</span>&nbsp;<span class="ident" id="6251047">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251050">return</span>&nbsp;<span class="builtinfunc" id="6251057">complex</span><span class="op" id="6251064">(</span><span class="ident" id="6251065">w</span><span class="op" id="6251066">,</span>&nbsp;<span class="num" id="6251068">0.25</span><span class="op" id="6251072">*</span><span class="ident" id="6251073">math</span><span class="op" id="6251077">.</span><span class="ident" id="6251078">Log</span><span class="op" id="6251081">(</span><span class="ident" id="6251082">c</span><span class="op" id="6251083">)</span><span class="op" id="6251084">)</span><br>
<span class="lineno"></span><span class="op" id="6251086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="6251089">//&nbsp;Atanh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6251143">func</span>&nbsp;<span class="ident" id="6251148">Atanh</span><span class="op" id="6251153">(</span><span class="ident" id="6251154">x</span>&nbsp;<span class="builtintype" id="6251156">complex128</span><span class="op" id="6251166">)</span>&nbsp;<span class="builtintype" id="6251168">complex128</span>&nbsp;<span class="op" id="6251179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251182">z</span>&nbsp;<span class="op" id="6251184">:=</span>&nbsp;<span class="builtinfunc" id="6251187">complex</span><span class="op" id="6251194">(</span><span class="op" id="6251195">-</span><span class="builtinfunc" id="6251196">imag</span><span class="op" id="6251200">(</span><span class="ident" id="6251201">x</span><span class="op" id="6251202">)</span><span class="op" id="6251203">,</span>&nbsp;<span class="builtinfunc" id="6251205">real</span><span class="op" id="6251209">(</span><span class="ident" id="6251210">x</span><span class="op" id="6251211">)</span><span class="op" id="6251212">)</span>&nbsp;<span class="comment" id="6251214">//&nbsp;z&nbsp;=&nbsp;i&nbsp;*&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251228">z</span>&nbsp;<span class="op" id="6251230">=</span>&nbsp;<span class="ident" id="6251232">Atan</span><span class="op" id="6251236">(</span><span class="ident" id="6251237">z</span><span class="op" id="6251238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251241">return</span>&nbsp;<span class="builtinfunc" id="6251248">complex</span><span class="op" id="6251255">(</span><span class="builtinfunc" id="6251256">imag</span><span class="op" id="6251260">(</span><span class="ident" id="6251261">z</span><span class="op" id="6251262">)</span><span class="op" id="6251263">,</span>&nbsp;<span class="op" id="6251265">-</span><span class="builtinfunc" id="6251266">real</span><span class="op" id="6251270">(</span><span class="ident" id="6251271">z</span><span class="op" id="6251272">)</span><span class="op" id="6251273">)</span>&nbsp;<span class="comment" id="6251275">//&nbsp;z&nbsp;=&nbsp;-i&nbsp;*&nbsp;z</span><br>
<span class="lineno">170</span><span class="op" id="6251289">}</span>
</div>
</body>
</html>
