<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html" class="current">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7308779">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7308834">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7308888">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7308939">package</span>&nbsp;<span class="ident" id="7308947">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7308952">import</span>&nbsp;<span class="op" id="7308959">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7308962">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7308971">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7308980">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7308998">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7309008">_</span>&nbsp;<span class="string" id="7309010">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7309024">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7309039">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7309054">_</span>&nbsp;<span class="string" id="7309056">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7309073">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7309089">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7309101">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7309107">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7309118">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7309129">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7309139">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7309142">func</span>&nbsp;<span class="ident" id="7309147">TestEMSAPSS</span><span class="op" id="7309158">(</span><span class="ident" id="7309159">t</span>&nbsp;<span class="op" id="7309161">*</span><span class="ident" id="7309162">testing</span><span class="op" id="7309169">.</span><span class="ident" id="7309170">T</span><span class="op" id="7309171">)</span>&nbsp;<span class="op" id="7309173">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7309176">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7309279">msg</span>&nbsp;<span class="op" id="7309283">:=</span>&nbsp;<span class="op" id="7309286">[</span><span class="op" id="7309287">]</span><span class="builtintype" id="7309288">byte</span><span class="op" id="7309292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309296">0x85</span><span class="op" id="7309300">,</span>&nbsp;<span class="num" id="7309302">0x9e</span><span class="op" id="7309306">,</span>&nbsp;<span class="num" id="7309308">0xef</span><span class="op" id="7309312">,</span>&nbsp;<span class="num" id="7309314">0x2f</span><span class="op" id="7309318">,</span>&nbsp;<span class="num" id="7309320">0xd7</span><span class="op" id="7309324">,</span>&nbsp;<span class="num" id="7309326">0x8a</span><span class="op" id="7309330">,</span>&nbsp;<span class="num" id="7309332">0xca</span><span class="op" id="7309336">,</span>&nbsp;<span class="num" id="7309338">0x00</span><span class="op" id="7309342">,</span>&nbsp;<span class="num" id="7309344">0x30</span><span class="op" id="7309348">,</span>&nbsp;<span class="num" id="7309350">0x8b</span><span class="op" id="7309354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309358">0xdc</span><span class="op" id="7309362">,</span>&nbsp;<span class="num" id="7309364">0x47</span><span class="op" id="7309368">,</span>&nbsp;<span class="num" id="7309370">0x11</span><span class="op" id="7309374">,</span>&nbsp;<span class="num" id="7309376">0x93</span><span class="op" id="7309380">,</span>&nbsp;<span class="num" id="7309382">0xbf</span><span class="op" id="7309386">,</span>&nbsp;<span class="num" id="7309388">0x55</span><span class="op" id="7309392">,</span>&nbsp;<span class="num" id="7309394">0xbf</span><span class="op" id="7309398">,</span>&nbsp;<span class="num" id="7309400">0x9d</span><span class="op" id="7309404">,</span>&nbsp;<span class="num" id="7309406">0x78</span><span class="op" id="7309410">,</span>&nbsp;<span class="num" id="7309412">0xdb</span><span class="op" id="7309416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309420">0x8f</span><span class="op" id="7309424">,</span>&nbsp;<span class="num" id="7309426">0x8a</span><span class="op" id="7309430">,</span>&nbsp;<span class="num" id="7309432">0x67</span><span class="op" id="7309436">,</span>&nbsp;<span class="num" id="7309438">0x2b</span><span class="op" id="7309442">,</span>&nbsp;<span class="num" id="7309444">0x48</span><span class="op" id="7309448">,</span>&nbsp;<span class="num" id="7309450">0x46</span><span class="op" id="7309454">,</span>&nbsp;<span class="num" id="7309456">0x34</span><span class="op" id="7309460">,</span>&nbsp;<span class="num" id="7309462">0xf3</span><span class="op" id="7309466">,</span>&nbsp;<span class="num" id="7309468">0xc9</span><span class="op" id="7309472">,</span>&nbsp;<span class="num" id="7309474">0xc2</span><span class="op" id="7309478">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309482">0x6e</span><span class="op" id="7309486">,</span>&nbsp;<span class="num" id="7309488">0x64</span><span class="op" id="7309492">,</span>&nbsp;<span class="num" id="7309494">0x78</span><span class="op" id="7309498">,</span>&nbsp;<span class="num" id="7309500">0xae</span><span class="op" id="7309504">,</span>&nbsp;<span class="num" id="7309506">0x10</span><span class="op" id="7309510">,</span>&nbsp;<span class="num" id="7309512">0x26</span><span class="op" id="7309516">,</span>&nbsp;<span class="num" id="7309518">0x0f</span><span class="op" id="7309522">,</span>&nbsp;<span class="num" id="7309524">0xe0</span><span class="op" id="7309528">,</span>&nbsp;<span class="num" id="7309530">0xdd</span><span class="op" id="7309534">,</span>&nbsp;<span class="num" id="7309536">0x8c</span><span class="op" id="7309540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309544">0x08</span><span class="op" id="7309548">,</span>&nbsp;<span class="num" id="7309550">0x2e</span><span class="op" id="7309554">,</span>&nbsp;<span class="num" id="7309556">0x53</span><span class="op" id="7309560">,</span>&nbsp;<span class="num" id="7309562">0xa5</span><span class="op" id="7309566">,</span>&nbsp;<span class="num" id="7309568">0x29</span><span class="op" id="7309572">,</span>&nbsp;<span class="num" id="7309574">0x3a</span><span class="op" id="7309578">,</span>&nbsp;<span class="num" id="7309580">0xf2</span><span class="op" id="7309584">,</span>&nbsp;<span class="num" id="7309586">0x17</span><span class="op" id="7309590">,</span>&nbsp;<span class="num" id="7309592">0x3c</span><span class="op" id="7309596">,</span>&nbsp;<span class="num" id="7309598">0xd5</span><span class="op" id="7309602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309606">0x0c</span><span class="op" id="7309610">,</span>&nbsp;<span class="num" id="7309612">0x6d</span><span class="op" id="7309616">,</span>&nbsp;<span class="num" id="7309618">0x5d</span><span class="op" id="7309622">,</span>&nbsp;<span class="num" id="7309624">0x35</span><span class="op" id="7309628">,</span>&nbsp;<span class="num" id="7309630">0x4f</span><span class="op" id="7309634">,</span>&nbsp;<span class="num" id="7309636">0xeb</span><span class="op" id="7309640">,</span>&nbsp;<span class="num" id="7309642">0xf7</span><span class="op" id="7309646">,</span>&nbsp;<span class="num" id="7309648">0x8b</span><span class="op" id="7309652">,</span>&nbsp;<span class="num" id="7309654">0x26</span><span class="op" id="7309658">,</span>&nbsp;<span class="num" id="7309660">0x02</span><span class="op" id="7309664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309668">0x1c</span><span class="op" id="7309672">,</span>&nbsp;<span class="num" id="7309674">0x25</span><span class="op" id="7309678">,</span>&nbsp;<span class="num" id="7309680">0xc0</span><span class="op" id="7309684">,</span>&nbsp;<span class="num" id="7309686">0x27</span><span class="op" id="7309690">,</span>&nbsp;<span class="num" id="7309692">0x12</span><span class="op" id="7309696">,</span>&nbsp;<span class="num" id="7309698">0xe7</span><span class="op" id="7309702">,</span>&nbsp;<span class="num" id="7309704">0x8c</span><span class="op" id="7309708">,</span>&nbsp;<span class="num" id="7309710">0xd4</span><span class="op" id="7309714">,</span>&nbsp;<span class="num" id="7309716">0x69</span><span class="op" id="7309720">,</span>&nbsp;<span class="num" id="7309722">0x4c</span><span class="op" id="7309726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309730">0x9f</span><span class="op" id="7309734">,</span>&nbsp;<span class="num" id="7309736">0x46</span><span class="op" id="7309740">,</span>&nbsp;<span class="num" id="7309742">0x97</span><span class="op" id="7309746">,</span>&nbsp;<span class="num" id="7309748">0x77</span><span class="op" id="7309752">,</span>&nbsp;<span class="num" id="7309754">0xe4</span><span class="op" id="7309758">,</span>&nbsp;<span class="num" id="7309760">0x51</span><span class="op" id="7309764">,</span>&nbsp;<span class="num" id="7309766">0xe7</span><span class="op" id="7309770">,</span>&nbsp;<span class="num" id="7309772">0xf8</span><span class="op" id="7309776">,</span>&nbsp;<span class="num" id="7309778">0xe9</span><span class="op" id="7309782">,</span>&nbsp;<span class="num" id="7309784">0xe0</span><span class="op" id="7309788">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309792">0x4c</span><span class="op" id="7309796">,</span>&nbsp;<span class="num" id="7309798">0xd3</span><span class="op" id="7309802">,</span>&nbsp;<span class="num" id="7309804">0x73</span><span class="op" id="7309808">,</span>&nbsp;<span class="num" id="7309810">0x9c</span><span class="op" id="7309814">,</span>&nbsp;<span class="num" id="7309816">0x6b</span><span class="op" id="7309820">,</span>&nbsp;<span class="num" id="7309822">0xbf</span><span class="op" id="7309826">,</span>&nbsp;<span class="num" id="7309828">0xed</span><span class="op" id="7309832">,</span>&nbsp;<span class="num" id="7309834">0xae</span><span class="op" id="7309838">,</span>&nbsp;<span class="num" id="7309840">0x48</span><span class="op" id="7309844">,</span>&nbsp;<span class="num" id="7309846">0x7f</span><span class="op" id="7309850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309854">0xb5</span><span class="op" id="7309858">,</span>&nbsp;<span class="num" id="7309860">0x56</span><span class="op" id="7309864">,</span>&nbsp;<span class="num" id="7309866">0x44</span><span class="op" id="7309870">,</span>&nbsp;<span class="num" id="7309872">0xe9</span><span class="op" id="7309876">,</span>&nbsp;<span class="num" id="7309878">0xca</span><span class="op" id="7309882">,</span>&nbsp;<span class="num" id="7309884">0x74</span><span class="op" id="7309888">,</span>&nbsp;<span class="num" id="7309890">0xff</span><span class="op" id="7309894">,</span>&nbsp;<span class="num" id="7309896">0x77</span><span class="op" id="7309900">,</span>&nbsp;<span class="num" id="7309902">0xa5</span><span class="op" id="7309906">,</span>&nbsp;<span class="num" id="7309908">0x3c</span><span class="op" id="7309912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309916">0xb7</span><span class="op" id="7309920">,</span>&nbsp;<span class="num" id="7309922">0x29</span><span class="op" id="7309926">,</span>&nbsp;<span class="num" id="7309928">0x80</span><span class="op" id="7309932">,</span>&nbsp;<span class="num" id="7309934">0x2f</span><span class="op" id="7309938">,</span>&nbsp;<span class="num" id="7309940">0x6e</span><span class="op" id="7309944">,</span>&nbsp;<span class="num" id="7309946">0xd4</span><span class="op" id="7309950">,</span>&nbsp;<span class="num" id="7309952">0xa5</span><span class="op" id="7309956">,</span>&nbsp;<span class="num" id="7309958">0xff</span><span class="op" id="7309962">,</span>&nbsp;<span class="num" id="7309964">0xa8</span><span class="op" id="7309968">,</span>&nbsp;<span class="num" id="7309970">0xba</span><span class="op" id="7309974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7309978">0x15</span><span class="op" id="7309982">,</span>&nbsp;<span class="num" id="7309984">0x98</span><span class="op" id="7309988">,</span>&nbsp;<span class="num" id="7309990">0x90</span><span class="op" id="7309994">,</span>&nbsp;<span class="num" id="7309996">0xfc</span><span class="op" id="7310000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7310003">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7310006">salt</span>&nbsp;<span class="op" id="7310011">:=</span>&nbsp;<span class="op" id="7310014">[</span><span class="op" id="7310015">]</span><span class="builtintype" id="7310016">byte</span><span class="op" id="7310020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310024">0xe3</span><span class="op" id="7310028">,</span>&nbsp;<span class="num" id="7310030">0xb5</span><span class="op" id="7310034">,</span>&nbsp;<span class="num" id="7310036">0xd5</span><span class="op" id="7310040">,</span>&nbsp;<span class="num" id="7310042">0xd0</span><span class="op" id="7310046">,</span>&nbsp;<span class="num" id="7310048">0x02</span><span class="op" id="7310052">,</span>&nbsp;<span class="num" id="7310054">0xc1</span><span class="op" id="7310058">,</span>&nbsp;<span class="num" id="7310060">0xbc</span><span class="op" id="7310064">,</span>&nbsp;<span class="num" id="7310066">0xe5</span><span class="op" id="7310070">,</span>&nbsp;<span class="num" id="7310072">0x0c</span><span class="op" id="7310076">,</span>&nbsp;<span class="num" id="7310078">0x2b</span><span class="op" id="7310082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310086">0x65</span><span class="op" id="7310090">,</span>&nbsp;<span class="num" id="7310092">0xef</span><span class="op" id="7310096">,</span>&nbsp;<span class="num" id="7310098">0x88</span><span class="op" id="7310102">,</span>&nbsp;<span class="num" id="7310104">0xa1</span><span class="op" id="7310108">,</span>&nbsp;<span class="num" id="7310110">0x88</span><span class="op" id="7310114">,</span>&nbsp;<span class="num" id="7310116">0xd8</span><span class="op" id="7310120">,</span>&nbsp;<span class="num" id="7310122">0x3b</span><span class="op" id="7310126">,</span>&nbsp;<span class="num" id="7310128">0xce</span><span class="op" id="7310132">,</span>&nbsp;<span class="num" id="7310134">0x7e</span><span class="op" id="7310138">,</span>&nbsp;<span class="num" id="7310140">0x61</span><span class="op" id="7310144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7310147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7310150">expected</span>&nbsp;<span class="op" id="7310159">:=</span>&nbsp;<span class="op" id="7310162">[</span><span class="op" id="7310163">]</span><span class="builtintype" id="7310164">byte</span><span class="op" id="7310168">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310172">0x66</span><span class="op" id="7310176">,</span>&nbsp;<span class="num" id="7310178">0xe4</span><span class="op" id="7310182">,</span>&nbsp;<span class="num" id="7310184">0x67</span><span class="op" id="7310188">,</span>&nbsp;<span class="num" id="7310190">0x2e</span><span class="op" id="7310194">,</span>&nbsp;<span class="num" id="7310196">0x83</span><span class="op" id="7310200">,</span>&nbsp;<span class="num" id="7310202">0x6a</span><span class="op" id="7310206">,</span>&nbsp;<span class="num" id="7310208">0xd1</span><span class="op" id="7310212">,</span>&nbsp;<span class="num" id="7310214">0x21</span><span class="op" id="7310218">,</span>&nbsp;<span class="num" id="7310220">0xba</span><span class="op" id="7310224">,</span>&nbsp;<span class="num" id="7310226">0x24</span><span class="op" id="7310230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310234">0x4b</span><span class="op" id="7310238">,</span>&nbsp;<span class="num" id="7310240">0xed</span><span class="op" id="7310244">,</span>&nbsp;<span class="num" id="7310246">0x65</span><span class="op" id="7310250">,</span>&nbsp;<span class="num" id="7310252">0x76</span><span class="op" id="7310256">,</span>&nbsp;<span class="num" id="7310258">0xb8</span><span class="op" id="7310262">,</span>&nbsp;<span class="num" id="7310264">0x67</span><span class="op" id="7310268">,</span>&nbsp;<span class="num" id="7310270">0xd9</span><span class="op" id="7310274">,</span>&nbsp;<span class="num" id="7310276">0xa4</span><span class="op" id="7310280">,</span>&nbsp;<span class="num" id="7310282">0x47</span><span class="op" id="7310286">,</span>&nbsp;<span class="num" id="7310288">0xc2</span><span class="op" id="7310292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310296">0x8a</span><span class="op" id="7310300">,</span>&nbsp;<span class="num" id="7310302">0x6e</span><span class="op" id="7310306">,</span>&nbsp;<span class="num" id="7310308">0x66</span><span class="op" id="7310312">,</span>&nbsp;<span class="num" id="7310314">0xa5</span><span class="op" id="7310318">,</span>&nbsp;<span class="num" id="7310320">0xb8</span><span class="op" id="7310324">,</span>&nbsp;<span class="num" id="7310326">0x7d</span><span class="op" id="7310330">,</span>&nbsp;<span class="num" id="7310332">0xee</span><span class="op" id="7310336">,</span>&nbsp;<span class="num" id="7310338">0x7f</span><span class="op" id="7310342">,</span>&nbsp;<span class="num" id="7310344">0xbc</span><span class="op" id="7310348">,</span>&nbsp;<span class="num" id="7310350">0x7e</span><span class="op" id="7310354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310358">0x65</span><span class="op" id="7310362">,</span>&nbsp;<span class="num" id="7310364">0xaf</span><span class="op" id="7310368">,</span>&nbsp;<span class="num" id="7310370">0x50</span><span class="op" id="7310374">,</span>&nbsp;<span class="num" id="7310376">0x57</span><span class="op" id="7310380">,</span>&nbsp;<span class="num" id="7310382">0xf8</span><span class="op" id="7310386">,</span>&nbsp;<span class="num" id="7310388">0x6f</span><span class="op" id="7310392">,</span>&nbsp;<span class="num" id="7310394">0xae</span><span class="op" id="7310398">,</span>&nbsp;<span class="num" id="7310400">0x89</span><span class="op" id="7310404">,</span>&nbsp;<span class="num" id="7310406">0x84</span><span class="op" id="7310410">,</span>&nbsp;<span class="num" id="7310412">0xd9</span><span class="op" id="7310416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310420">0xba</span><span class="op" id="7310424">,</span>&nbsp;<span class="num" id="7310426">0x7f</span><span class="op" id="7310430">,</span>&nbsp;<span class="num" id="7310432">0x96</span><span class="op" id="7310436">,</span>&nbsp;<span class="num" id="7310438">0x9a</span><span class="op" id="7310442">,</span>&nbsp;<span class="num" id="7310444">0xd6</span><span class="op" id="7310448">,</span>&nbsp;<span class="num" id="7310450">0xfe</span><span class="op" id="7310454">,</span>&nbsp;<span class="num" id="7310456">0x02</span><span class="op" id="7310460">,</span>&nbsp;<span class="num" id="7310462">0xa4</span><span class="op" id="7310466">,</span>&nbsp;<span class="num" id="7310468">0xd7</span><span class="op" id="7310472">,</span>&nbsp;<span class="num" id="7310474">0x5f</span><span class="op" id="7310478">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310482">0x74</span><span class="op" id="7310486">,</span>&nbsp;<span class="num" id="7310488">0x45</span><span class="op" id="7310492">,</span>&nbsp;<span class="num" id="7310494">0xfe</span><span class="op" id="7310498">,</span>&nbsp;<span class="num" id="7310500">0xfd</span><span class="op" id="7310504">,</span>&nbsp;<span class="num" id="7310506">0xd8</span><span class="op" id="7310510">,</span>&nbsp;<span class="num" id="7310512">0x5b</span><span class="op" id="7310516">,</span>&nbsp;<span class="num" id="7310518">0x6d</span><span class="op" id="7310522">,</span>&nbsp;<span class="num" id="7310524">0x3a</span><span class="op" id="7310528">,</span>&nbsp;<span class="num" id="7310530">0x47</span><span class="op" id="7310534">,</span>&nbsp;<span class="num" id="7310536">0x7c</span><span class="op" id="7310540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310544">0x28</span><span class="op" id="7310548">,</span>&nbsp;<span class="num" id="7310550">0xd2</span><span class="op" id="7310554">,</span>&nbsp;<span class="num" id="7310556">0x4b</span><span class="op" id="7310560">,</span>&nbsp;<span class="num" id="7310562">0xa1</span><span class="op" id="7310566">,</span>&nbsp;<span class="num" id="7310568">0xe3</span><span class="op" id="7310572">,</span>&nbsp;<span class="num" id="7310574">0x75</span><span class="op" id="7310578">,</span>&nbsp;<span class="num" id="7310580">0x6f</span><span class="op" id="7310584">,</span>&nbsp;<span class="num" id="7310586">0x79</span><span class="op" id="7310590">,</span>&nbsp;<span class="num" id="7310592">0x2d</span><span class="op" id="7310596">,</span>&nbsp;<span class="num" id="7310598">0xd1</span><span class="op" id="7310602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310606">0xdc</span><span class="op" id="7310610">,</span>&nbsp;<span class="num" id="7310612">0xe8</span><span class="op" id="7310616">,</span>&nbsp;<span class="num" id="7310618">0xca</span><span class="op" id="7310622">,</span>&nbsp;<span class="num" id="7310624">0x94</span><span class="op" id="7310628">,</span>&nbsp;<span class="num" id="7310630">0x44</span><span class="op" id="7310634">,</span>&nbsp;<span class="num" id="7310636">0x0e</span><span class="op" id="7310640">,</span>&nbsp;<span class="num" id="7310642">0xcb</span><span class="op" id="7310646">,</span>&nbsp;<span class="num" id="7310648">0x52</span><span class="op" id="7310652">,</span>&nbsp;<span class="num" id="7310654">0x79</span><span class="op" id="7310658">,</span>&nbsp;<span class="num" id="7310660">0xec</span><span class="op" id="7310664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310668">0xd3</span><span class="op" id="7310672">,</span>&nbsp;<span class="num" id="7310674">0x18</span><span class="op" id="7310678">,</span>&nbsp;<span class="num" id="7310680">0x3a</span><span class="op" id="7310684">,</span>&nbsp;<span class="num" id="7310686">0x31</span><span class="op" id="7310690">,</span>&nbsp;<span class="num" id="7310692">0x1f</span><span class="op" id="7310696">,</span>&nbsp;<span class="num" id="7310698">0xc8</span><span class="op" id="7310702">,</span>&nbsp;<span class="num" id="7310704">0x96</span><span class="op" id="7310708">,</span>&nbsp;<span class="num" id="7310710">0xda</span><span class="op" id="7310714">,</span>&nbsp;<span class="num" id="7310716">0x1c</span><span class="op" id="7310720">,</span>&nbsp;<span class="num" id="7310722">0xb3</span><span class="op" id="7310726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310730">0x93</span><span class="op" id="7310734">,</span>&nbsp;<span class="num" id="7310736">0x11</span><span class="op" id="7310740">,</span>&nbsp;<span class="num" id="7310742">0xaf</span><span class="op" id="7310746">,</span>&nbsp;<span class="num" id="7310748">0x37</span><span class="op" id="7310752">,</span>&nbsp;<span class="num" id="7310754">0xea</span><span class="op" id="7310758">,</span>&nbsp;<span class="num" id="7310760">0x4a</span><span class="op" id="7310764">,</span>&nbsp;<span class="num" id="7310766">0x75</span><span class="op" id="7310770">,</span>&nbsp;<span class="num" id="7310772">0xe2</span><span class="op" id="7310776">,</span>&nbsp;<span class="num" id="7310778">0x4b</span><span class="op" id="7310782">,</span>&nbsp;<span class="num" id="7310784">0xdb</span><span class="op" id="7310788">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310792">0xfd</span><span class="op" id="7310796">,</span>&nbsp;<span class="num" id="7310798">0x5c</span><span class="op" id="7310802">,</span>&nbsp;<span class="num" id="7310804">0x1d</span><span class="op" id="7310808">,</span>&nbsp;<span class="num" id="7310810">0xa0</span><span class="op" id="7310814">,</span>&nbsp;<span class="num" id="7310816">0xde</span><span class="op" id="7310820">,</span>&nbsp;<span class="num" id="7310822">0x7c</span><span class="op" id="7310826">,</span>&nbsp;<span class="num" id="7310828">0xec</span><span class="op" id="7310832">,</span>&nbsp;<span class="num" id="7310834">0xdf</span><span class="op" id="7310838">,</span>&nbsp;<span class="num" id="7310840">0x1a</span><span class="op" id="7310844">,</span>&nbsp;<span class="num" id="7310846">0x89</span><span class="op" id="7310850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310854">0x6f</span><span class="op" id="7310858">,</span>&nbsp;<span class="num" id="7310860">0x9d</span><span class="op" id="7310864">,</span>&nbsp;<span class="num" id="7310866">0x8b</span><span class="op" id="7310870">,</span>&nbsp;<span class="num" id="7310872">0xc8</span><span class="op" id="7310876">,</span>&nbsp;<span class="num" id="7310878">0x16</span><span class="op" id="7310882">,</span>&nbsp;<span class="num" id="7310884">0xd9</span><span class="op" id="7310888">,</span>&nbsp;<span class="num" id="7310890">0x7c</span><span class="op" id="7310894">,</span>&nbsp;<span class="num" id="7310896">0xd7</span><span class="op" id="7310900">,</span>&nbsp;<span class="num" id="7310902">0xa2</span><span class="op" id="7310906">,</span>&nbsp;<span class="num" id="7310908">0xc4</span><span class="op" id="7310912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7310916">0x3b</span><span class="op" id="7310920">,</span>&nbsp;<span class="num" id="7310922">0xad</span><span class="op" id="7310926">,</span>&nbsp;<span class="num" id="7310928">0x54</span><span class="op" id="7310932">,</span>&nbsp;<span class="num" id="7310934">0x6f</span><span class="op" id="7310938">,</span>&nbsp;<span class="num" id="7310940">0xbe</span><span class="op" id="7310944">,</span>&nbsp;<span class="num" id="7310946">0x8c</span><span class="op" id="7310950">,</span>&nbsp;<span class="num" id="7310952">0xfe</span><span class="op" id="7310956">,</span>&nbsp;<span class="num" id="7310958">0xbc</span><span class="op" id="7310962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7310965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7310969">hash</span>&nbsp;<span class="op" id="7310974">:=</span>&nbsp;<span class="ident" id="7310977">sha1</span><span class="op" id="7310981">.</span><span class="ident" id="7310982">New</span><span class="op" id="7310985">(</span><span class="op" id="7310986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7310989">hash</span><span class="op" id="7310993">.</span><span class="ident" id="7310994">Write</span><span class="op" id="7310999">(</span><span class="ident" id="7311000">msg</span><span class="op" id="7311003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311006">hashed</span>&nbsp;<span class="op" id="7311013">:=</span>&nbsp;<span class="ident" id="7311016">hash</span><span class="op" id="7311020">.</span><span class="ident" id="7311021">Sum</span><span class="op" id="7311024">(</span><span class="builtintype" id="7311025">nil</span><span class="op" id="7311028">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311032">encoded</span><span class="op" id="7311039">,</span>&nbsp;<span class="ident" id="7311041">err</span>&nbsp;<span class="op" id="7311045">:=</span>&nbsp;<span class="ident" id="7311048">emsaPSSEncode</span><span class="op" id="7311061">(</span><span class="ident" id="7311062">hashed</span><span class="op" id="7311068">,</span>&nbsp;<span class="num" id="7311070">1023</span><span class="op" id="7311074">,</span>&nbsp;<span class="ident" id="7311076">salt</span><span class="op" id="7311080">,</span>&nbsp;<span class="ident" id="7311082">sha1</span><span class="op" id="7311086">.</span><span class="ident" id="7311087">New</span><span class="op" id="7311090">(</span><span class="op" id="7311091">)</span><span class="op" id="7311092">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311095">if</span>&nbsp;<span class="ident" id="7311098">err</span>&nbsp;<span class="op" id="7311102">!=</span>&nbsp;<span class="builtintype" id="7311105">nil</span>&nbsp;<span class="op" id="7311109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311113">t</span><span class="op" id="7311114">.</span><span class="ident" id="7311115">Errorf</span><span class="op" id="7311121">(</span><span class="string" id="7311122">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="7311154">,</span>&nbsp;<span class="ident" id="7311156">err</span><span class="op" id="7311159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311165">if</span>&nbsp;<span class="op" id="7311168">!</span><span class="ident" id="7311169">bytes</span><span class="op" id="7311174">.</span><span class="ident" id="7311175">Equal</span><span class="op" id="7311180">(</span><span class="ident" id="7311181">encoded</span><span class="op" id="7311188">,</span>&nbsp;<span class="ident" id="7311190">expected</span><span class="op" id="7311198">)</span>&nbsp;<span class="op" id="7311200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311204">t</span><span class="op" id="7311205">.</span><span class="ident" id="7311206">Errorf</span><span class="op" id="7311212">(</span><span class="string" id="7311213">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7311244">,</span>&nbsp;<span class="ident" id="7311246">encoded</span><span class="op" id="7311253">,</span>&nbsp;<span class="ident" id="7311255">expected</span><span class="op" id="7311263">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311270">if</span>&nbsp;<span class="ident" id="7311273">err</span>&nbsp;<span class="op" id="7311277">=</span>&nbsp;<span class="ident" id="7311279">emsaPSSVerify</span><span class="op" id="7311292">(</span><span class="ident" id="7311293">hashed</span><span class="op" id="7311299">,</span>&nbsp;<span class="ident" id="7311301">encoded</span><span class="op" id="7311308">,</span>&nbsp;<span class="num" id="7311310">1023</span><span class="op" id="7311314">,</span>&nbsp;<span class="builtinfunc" id="7311316">len</span><span class="op" id="7311319">(</span><span class="ident" id="7311320">salt</span><span class="op" id="7311324">)</span><span class="op" id="7311325">,</span>&nbsp;<span class="ident" id="7311327">sha1</span><span class="op" id="7311331">.</span><span class="ident" id="7311332">New</span><span class="op" id="7311335">(</span><span class="op" id="7311336">)</span><span class="op" id="7311337">)</span><span class="op" id="7311338">;</span>&nbsp;<span class="ident" id="7311340">err</span>&nbsp;<span class="op" id="7311344">!=</span>&nbsp;<span class="builtintype" id="7311347">nil</span>&nbsp;<span class="op" id="7311351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311355">t</span><span class="op" id="7311356">.</span><span class="ident" id="7311357">Errorf</span><span class="op" id="7311363">(</span><span class="string" id="7311364">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="7311386">,</span>&nbsp;<span class="ident" id="7311388">err</span><span class="op" id="7311391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311394">}</span><br>
<span class="lineno">75</span><span class="op" id="7311396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7311399">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="7311464">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="7311528">func</span>&nbsp;<span class="ident" id="7311533">TestPSSGolden</span><span class="op" id="7311546">(</span><span class="ident" id="7311547">t</span>&nbsp;<span class="op" id="7311549">*</span><span class="ident" id="7311550">testing</span><span class="op" id="7311557">.</span><span class="ident" id="7311558">T</span><span class="op" id="7311559">)</span>&nbsp;<span class="op" id="7311561">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311564">inFile</span><span class="op" id="7311570">,</span>&nbsp;<span class="ident" id="7311572">err</span>&nbsp;<span class="op" id="7311576">:=</span>&nbsp;<span class="ident" id="7311579">os</span><span class="op" id="7311581">.</span><span class="ident" id="7311582">Open</span><span class="op" id="7311586">(</span><span class="string" id="7311587">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="7311614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311617">if</span>&nbsp;<span class="ident" id="7311620">err</span>&nbsp;<span class="op" id="7311624">!=</span>&nbsp;<span class="builtintype" id="7311627">nil</span>&nbsp;<span class="op" id="7311631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311635">t</span><span class="op" id="7311636">.</span><span class="ident" id="7311637">Fatalf</span><span class="op" id="7311643">(</span><span class="string" id="7311644">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="7311675">,</span>&nbsp;<span class="ident" id="7311677">err</span><span class="op" id="7311680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311686">defer</span>&nbsp;<span class="ident" id="7311692">inFile</span><span class="op" id="7311698">.</span><span class="ident" id="7311699">Close</span><span class="op" id="7311704">(</span><span class="op" id="7311705">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7311709">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7311774">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7311845">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7311915">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311950">const</span>&nbsp;<span class="ident" id="7311956">newKeyMarker</span>&nbsp;<span class="op" id="7311969">=</span>&nbsp;<span class="string" id="7311971">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311988">const</span>&nbsp;<span class="ident" id="7311994">newSignatureMarker</span>&nbsp;<span class="op" id="7312013">=</span>&nbsp;<span class="string" id="7312015">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312039">values</span>&nbsp;<span class="op" id="7312046">:=</span>&nbsp;<span class="builtinfunc" id="7312049">make</span><span class="op" id="7312053">(</span><span class="keyword" id="7312054">chan</span>&nbsp;<span class="builtintype" id="7312059">string</span><span class="op" id="7312065">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312069">go</span>&nbsp;<span class="keyword" id="7312072">func</span><span class="op" id="7312076">(</span><span class="op" id="7312077">)</span>&nbsp;<span class="op" id="7312079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312083">defer</span>&nbsp;<span class="builtinfunc" id="7312089">close</span><span class="op" id="7312094">(</span><span class="ident" id="7312095">values</span><span class="op" id="7312101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312105">scanner</span>&nbsp;<span class="op" id="7312113">:=</span>&nbsp;<span class="ident" id="7312116">bufio</span><span class="op" id="7312121">.</span><span class="ident" id="7312122">NewScanner</span><span class="op" id="7312132">(</span><span class="ident" id="7312133">bzip2</span><span class="op" id="7312138">.</span><span class="ident" id="7312139">NewReader</span><span class="op" id="7312148">(</span><span class="ident" id="7312149">inFile</span><span class="op" id="7312155">)</span><span class="op" id="7312156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312160">var</span>&nbsp;<span class="ident" id="7312164">partialValue</span>&nbsp;<span class="builtintype" id="7312177">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312186">lastWasValue</span>&nbsp;<span class="op" id="7312199">:=</span>&nbsp;<span class="builtintype" id="7312202">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312210">for</span>&nbsp;<span class="ident" id="7312214">scanner</span><span class="op" id="7312221">.</span><span class="ident" id="7312222">Scan</span><span class="op" id="7312226">(</span><span class="op" id="7312227">)</span>&nbsp;<span class="op" id="7312229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312234">line</span>&nbsp;<span class="op" id="7312239">:=</span>&nbsp;<span class="ident" id="7312242">scanner</span><span class="op" id="7312249">.</span><span class="ident" id="7312250">Text</span><span class="op" id="7312254">(</span><span class="op" id="7312255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312260">switch</span>&nbsp;<span class="op" id="7312267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312272">case</span>&nbsp;<span class="builtinfunc" id="7312277">len</span><span class="op" id="7312280">(</span><span class="ident" id="7312281">line</span><span class="op" id="7312285">)</span>&nbsp;<span class="op" id="7312287">==</span>&nbsp;<span class="num" id="7312290">0</span><span class="op" id="7312291">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312297">if</span>&nbsp;<span class="builtinfunc" id="7312300">len</span><span class="op" id="7312303">(</span><span class="ident" id="7312304">partialValue</span><span class="op" id="7312316">)</span>&nbsp;<span class="op" id="7312318">&gt;</span>&nbsp;<span class="num" id="7312320">0</span>&nbsp;<span class="op" id="7312322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312329">values</span>&nbsp;<span class="op" id="7312336">&lt;-</span>&nbsp;<span class="ident" id="7312339">strings</span><span class="op" id="7312346">.</span><span class="ident" id="7312347">Replace</span><span class="op" id="7312354">(</span><span class="ident" id="7312355">partialValue</span><span class="op" id="7312367">,</span>&nbsp;<span class="string" id="7312369">&#34;&nbsp;&#34;</span><span class="op" id="7312372">,</span>&nbsp;<span class="string" id="7312374">&#34;&#34;</span><span class="op" id="7312376">,</span>&nbsp;<span class="op" id="7312378">-</span><span class="num" id="7312379">1</span><span class="op" id="7312380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312387">partialValue</span>&nbsp;<span class="op" id="7312400">=</span>&nbsp;<span class="string" id="7312402">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312410">lastWasValue</span>&nbsp;<span class="op" id="7312423">=</span>&nbsp;<span class="builtintype" id="7312425">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312434">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312440">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312452">case</span>&nbsp;<span class="ident" id="7312457">strings</span><span class="op" id="7312464">.</span><span class="ident" id="7312465">HasPrefix</span><span class="op" id="7312474">(</span><span class="ident" id="7312475">line</span><span class="op" id="7312479">,</span>&nbsp;<span class="string" id="7312481">&#34;#&nbsp;======&#34;</span><span class="op" id="7312491">)</span>&nbsp;<span class="op" id="7312493">&amp;&amp;</span>&nbsp;<span class="ident" id="7312496">lastWasValue</span><span class="op" id="7312508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312514">values</span>&nbsp;<span class="op" id="7312521">&lt;-</span>&nbsp;<span class="ident" id="7312524">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312541">lastWasValue</span>&nbsp;<span class="op" id="7312554">=</span>&nbsp;<span class="builtintype" id="7312556">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312565">case</span>&nbsp;<span class="ident" id="7312570">strings</span><span class="op" id="7312577">.</span><span class="ident" id="7312578">HasPrefix</span><span class="op" id="7312587">(</span><span class="ident" id="7312588">line</span><span class="op" id="7312592">,</span>&nbsp;<span class="string" id="7312594">&#34;#&nbsp;------&#34;</span><span class="op" id="7312604">)</span>&nbsp;<span class="op" id="7312606">&amp;&amp;</span>&nbsp;<span class="ident" id="7312609">lastWasValue</span><span class="op" id="7312621">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312627">values</span>&nbsp;<span class="op" id="7312634">&lt;-</span>&nbsp;<span class="ident" id="7312637">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312660">lastWasValue</span>&nbsp;<span class="op" id="7312673">=</span>&nbsp;<span class="builtintype" id="7312675">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312684">case</span>&nbsp;<span class="ident" id="7312689">strings</span><span class="op" id="7312696">.</span><span class="ident" id="7312697">HasPrefix</span><span class="op" id="7312706">(</span><span class="ident" id="7312707">line</span><span class="op" id="7312711">,</span>&nbsp;<span class="string" id="7312713">&#34;#&#34;</span><span class="op" id="7312716">)</span><span class="op" id="7312717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312723">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312735">default</span><span class="op" id="7312742">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312748">partialValue</span>&nbsp;<span class="op" id="7312761">+=</span>&nbsp;<span class="ident" id="7312764">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312780">if</span>&nbsp;<span class="ident" id="7312783">err</span>&nbsp;<span class="op" id="7312787">:=</span>&nbsp;<span class="ident" id="7312790">scanner</span><span class="op" id="7312797">.</span><span class="ident" id="7312798">Err</span><span class="op" id="7312801">(</span><span class="op" id="7312802">)</span><span class="op" id="7312803">;</span>&nbsp;<span class="ident" id="7312805">err</span>&nbsp;<span class="op" id="7312809">!=</span>&nbsp;<span class="builtintype" id="7312812">nil</span>&nbsp;<span class="op" id="7312816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7312821">panic</span><span class="op" id="7312826">(</span><span class="ident" id="7312827">err</span><span class="op" id="7312830">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312837">}</span><span class="op" id="7312838">(</span><span class="op" id="7312839">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312843">var</span>&nbsp;<span class="ident" id="7312847">key</span>&nbsp;<span class="op" id="7312851">*</span><span class="ident" id="7312852">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312863">var</span>&nbsp;<span class="ident" id="7312867">hashed</span>&nbsp;<span class="op" id="7312874">[</span><span class="op" id="7312875">]</span><span class="builtintype" id="7312876">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312882">hash</span>&nbsp;<span class="op" id="7312887">:=</span>&nbsp;<span class="ident" id="7312890">crypto</span><span class="op" id="7312896">.</span><span class="ident" id="7312897">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312903">h</span>&nbsp;<span class="op" id="7312905">:=</span>&nbsp;<span class="ident" id="7312908">hash</span><span class="op" id="7312912">.</span><span class="ident" id="7312913">New</span><span class="op" id="7312916">(</span><span class="op" id="7312917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312920">opts</span>&nbsp;<span class="op" id="7312925">:=</span>&nbsp;<span class="op" id="7312928">&amp;</span><span class="ident" id="7312929">PSSOptions</span><span class="op" id="7312939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312943">SaltLength</span><span class="op" id="7312953">:</span>&nbsp;<span class="ident" id="7312955">PSSSaltLengthEqualsHash</span><span class="op" id="7312978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312981">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312985">for</span>&nbsp;<span class="ident" id="7312989">marker</span>&nbsp;<span class="op" id="7312996">:=</span>&nbsp;<span class="keyword" id="7312999">range</span>&nbsp;<span class="ident" id="7313005">values</span>&nbsp;<span class="op" id="7313012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313016">switch</span>&nbsp;<span class="ident" id="7313023">marker</span>&nbsp;<span class="op" id="7313030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313034">case</span>&nbsp;<span class="ident" id="7313039">newKeyMarker</span><span class="op" id="7313051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313056">key</span>&nbsp;<span class="op" id="7313060">=</span>&nbsp;<span class="builtinfunc" id="7313062">new</span><span class="op" id="7313065">(</span><span class="ident" id="7313066">PublicKey</span><span class="op" id="7313075">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313080">nHex</span><span class="op" id="7313084">,</span>&nbsp;<span class="ident" id="7313086">ok</span>&nbsp;<span class="op" id="7313089">:=</span>&nbsp;<span class="op" id="7313092">&lt;-</span><span class="ident" id="7313094">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313104">if</span>&nbsp;<span class="op" id="7313107">!</span><span class="ident" id="7313108">ok</span>&nbsp;<span class="op" id="7313111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313117">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313134">key</span><span class="op" id="7313137">.</span><span class="ident" id="7313138">N</span>&nbsp;<span class="op" id="7313140">=</span>&nbsp;<span class="ident" id="7313142">bigFromHex</span><span class="op" id="7313152">(</span><span class="ident" id="7313153">nHex</span><span class="op" id="7313157">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313162">key</span><span class="op" id="7313165">.</span><span class="ident" id="7313166">E</span>&nbsp;<span class="op" id="7313168">=</span>&nbsp;<span class="ident" id="7313170">intFromHex</span><span class="op" id="7313180">(</span><span class="op" id="7313181">&lt;-</span><span class="ident" id="7313183">values</span><span class="op" id="7313189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7313194">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313243">for</span>&nbsp;<span class="ident" id="7313247">i</span>&nbsp;<span class="op" id="7313249">:=</span>&nbsp;<span class="num" id="7313252">0</span><span class="op" id="7313253">;</span>&nbsp;<span class="ident" id="7313255">i</span>&nbsp;<span class="op" id="7313257">&lt;</span>&nbsp;<span class="num" id="7313259">6</span><span class="op" id="7313260">;</span>&nbsp;<span class="ident" id="7313262">i</span><span class="op" id="7313263">++</span>&nbsp;<span class="op" id="7313266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313272">&lt;-</span><span class="ident" id="7313274">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313284">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313288">case</span>&nbsp;<span class="ident" id="7313293">newSignatureMarker</span><span class="op" id="7313311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313316">msg</span>&nbsp;<span class="op" id="7313320">:=</span>&nbsp;<span class="ident" id="7313323">fromHex</span><span class="op" id="7313330">(</span><span class="op" id="7313331">&lt;-</span><span class="ident" id="7313333">values</span><span class="op" id="7313339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313344">&lt;-</span><span class="ident" id="7313346">values</span>&nbsp;<span class="comment" id="7313353">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313369">sig</span>&nbsp;<span class="op" id="7313373">:=</span>&nbsp;<span class="ident" id="7313376">fromHex</span><span class="op" id="7313383">(</span><span class="op" id="7313384">&lt;-</span><span class="ident" id="7313386">values</span><span class="op" id="7313392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313398">h</span><span class="op" id="7313399">.</span><span class="ident" id="7313400">Reset</span><span class="op" id="7313405">(</span><span class="op" id="7313406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313411">h</span><span class="op" id="7313412">.</span><span class="ident" id="7313413">Write</span><span class="op" id="7313418">(</span><span class="ident" id="7313419">msg</span><span class="op" id="7313422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313427">hashed</span>&nbsp;<span class="op" id="7313434">=</span>&nbsp;<span class="ident" id="7313436">h</span><span class="op" id="7313437">.</span><span class="ident" id="7313438">Sum</span><span class="op" id="7313441">(</span><span class="ident" id="7313442">hashed</span><span class="op" id="7313448">[</span><span class="op" id="7313449">:</span><span class="num" id="7313450">0</span><span class="op" id="7313451">]</span><span class="op" id="7313452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313458">if</span>&nbsp;<span class="ident" id="7313461">err</span>&nbsp;<span class="op" id="7313465">:=</span>&nbsp;<span class="ident" id="7313468">VerifyPSS</span><span class="op" id="7313477">(</span><span class="ident" id="7313478">key</span><span class="op" id="7313481">,</span>&nbsp;<span class="ident" id="7313483">hash</span><span class="op" id="7313487">,</span>&nbsp;<span class="ident" id="7313489">hashed</span><span class="op" id="7313495">,</span>&nbsp;<span class="ident" id="7313497">sig</span><span class="op" id="7313500">,</span>&nbsp;<span class="ident" id="7313502">opts</span><span class="op" id="7313506">)</span><span class="op" id="7313507">;</span>&nbsp;<span class="ident" id="7313509">err</span>&nbsp;<span class="op" id="7313513">!=</span>&nbsp;<span class="builtintype" id="7313516">nil</span>&nbsp;<span class="op" id="7313520">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313526">t</span><span class="op" id="7313527">.</span><span class="ident" id="7313528">Error</span><span class="op" id="7313533">(</span><span class="ident" id="7313534">err</span><span class="op" id="7313537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313546">default</span><span class="op" id="7313553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313558">t</span><span class="op" id="7313559">.</span><span class="ident" id="7313560">Fatalf</span><span class="op" id="7313566">(</span><span class="string" id="7313567">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="7313586">+</span>&nbsp;<span class="ident" id="7313588">marker</span><span class="op" id="7313594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313598">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313601">}</span><br>
<span class="lineno"></span><span class="op" id="7313603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7313606">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7313685">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="7313753">func</span>&nbsp;<span class="ident" id="7313758">TestPSSOpenSSL</span><span class="op" id="7313772">(</span><span class="ident" id="7313773">t</span>&nbsp;<span class="op" id="7313775">*</span><span class="ident" id="7313776">testing</span><span class="op" id="7313783">.</span><span class="ident" id="7313784">T</span><span class="op" id="7313785">)</span>&nbsp;<span class="op" id="7313787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313790">hash</span>&nbsp;<span class="op" id="7313795">:=</span>&nbsp;<span class="ident" id="7313798">crypto</span><span class="op" id="7313804">.</span><span class="ident" id="7313805">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313813">h</span>&nbsp;<span class="op" id="7313815">:=</span>&nbsp;<span class="ident" id="7313818">hash</span><span class="op" id="7313822">.</span><span class="ident" id="7313823">New</span><span class="op" id="7313826">(</span><span class="op" id="7313827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313830">h</span><span class="op" id="7313831">.</span><span class="ident" id="7313832">Write</span><span class="op" id="7313837">(</span><span class="op" id="7313838">[</span><span class="op" id="7313839">]</span><span class="builtintype" id="7313840">byte</span><span class="op" id="7313844">(</span><span class="string" id="7313845">&#34;testing&#34;</span><span class="op" id="7313854">)</span><span class="op" id="7313855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313858">hashed</span>&nbsp;<span class="op" id="7313865">:=</span>&nbsp;<span class="ident" id="7313868">h</span><span class="op" id="7313869">.</span><span class="ident" id="7313870">Sum</span><span class="op" id="7313873">(</span><span class="builtintype" id="7313874">nil</span><span class="op" id="7313877">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7313881">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313990">sig</span>&nbsp;<span class="op" id="7313994">:=</span>&nbsp;<span class="op" id="7313997">[</span><span class="op" id="7313998">]</span><span class="builtintype" id="7313999">byte</span><span class="op" id="7314003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7314007">0x95</span><span class="op" id="7314011">,</span>&nbsp;<span class="num" id="7314013">0x59</span><span class="op" id="7314017">,</span>&nbsp;<span class="num" id="7314019">0x6f</span><span class="op" id="7314023">,</span>&nbsp;<span class="num" id="7314025">0xd3</span><span class="op" id="7314029">,</span>&nbsp;<span class="num" id="7314031">0x10</span><span class="op" id="7314035">,</span>&nbsp;<span class="num" id="7314037">0xa2</span><span class="op" id="7314041">,</span>&nbsp;<span class="num" id="7314043">0xe7</span><span class="op" id="7314047">,</span>&nbsp;<span class="num" id="7314049">0xa2</span><span class="op" id="7314053">,</span>&nbsp;<span class="num" id="7314055">0x92</span><span class="op" id="7314059">,</span>&nbsp;<span class="num" id="7314061">0x9d</span><span class="op" id="7314065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7314069">0x4a</span><span class="op" id="7314073">,</span>&nbsp;<span class="num" id="7314075">0x07</span><span class="op" id="7314079">,</span>&nbsp;<span class="num" id="7314081">0x2e</span><span class="op" id="7314085">,</span>&nbsp;<span class="num" id="7314087">0x2b</span><span class="op" id="7314091">,</span>&nbsp;<span class="num" id="7314093">0x27</span><span class="op" id="7314097">,</span>&nbsp;<span class="num" id="7314099">0xcc</span><span class="op" id="7314103">,</span>&nbsp;<span class="num" id="7314105">0x06</span><span class="op" id="7314109">,</span>&nbsp;<span class="num" id="7314111">0xc2</span><span class="op" id="7314115">,</span>&nbsp;<span class="num" id="7314117">0x87</span><span class="op" id="7314121">,</span>&nbsp;<span class="num" id="7314123">0x2c</span><span class="op" id="7314127">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7314131">0x52</span><span class="op" id="7314135">,</span>&nbsp;<span class="num" id="7314137">0xf0</span><span class="op" id="7314141">,</span>&nbsp;<span class="num" id="7314143">0x4a</span><span class="op" id="7314147">,</span>&nbsp;<span class="num" id="7314149">0xcc</span><span class="op" id="7314153">,</span>&nbsp;<span class="num" id="7314155">0x05</span><span class="op" id="7314159">,</span>&nbsp;<span class="num" id="7314161">0x94</span><span class="op" id="7314165">,</span>&nbsp;<span class="num" id="7314167">0xf2</span><span class="op" id="7314171">,</span>&nbsp;<span class="num" id="7314173">0xc3</span><span class="op" id="7314177">,</span>&nbsp;<span class="num" id="7314179">0x2e</span><span class="op" id="7314183">,</span>&nbsp;<span class="num" id="7314185">0x20</span><span class="op" id="7314189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7314193">0xd7</span><span class="op" id="7314197">,</span>&nbsp;<span class="num" id="7314199">0x3e</span><span class="op" id="7314203">,</span>&nbsp;<span class="num" id="7314205">0x66</span><span class="op" id="7314209">,</span>&nbsp;<span class="num" id="7314211">0x62</span><span class="op" id="7314215">,</span>&nbsp;<span class="num" id="7314217">0xb5</span><span class="op" id="7314221">,</span>&nbsp;<span class="num" id="7314223">0x95</span><span class="op" id="7314227">,</span>&nbsp;<span class="num" id="7314229">0x2b</span><span class="op" id="7314233">,</span>&nbsp;<span class="num" id="7314235">0xa3</span><span class="op" id="7314239">,</span>&nbsp;<span class="num" id="7314241">0x93</span><span class="op" id="7314245">,</span>&nbsp;<span class="num" id="7314247">0x9a</span><span class="op" id="7314251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7314255">0x66</span><span class="op" id="7314259">,</span>&nbsp;<span class="num" id="7314261">0x64</span><span class="op" id="7314265">,</span>&nbsp;<span class="num" id="7314267">0x25</span><span class="op" id="7314271">,</span>&nbsp;<span class="num" id="7314273">0xe0</span><span class="op" id="7314277">,</span>&nbsp;<span class="num" id="7314279">0x74</span><span class="op" id="7314283">,</span>&nbsp;<span class="num" id="7314285">0x66</span><span class="op" id="7314289">,</span>&nbsp;<span class="num" id="7314291">0x8c</span><span class="op" id="7314295">,</span>&nbsp;<span class="num" id="7314297">0x3e</span><span class="op" id="7314301">,</span>&nbsp;<span class="num" id="7314303">0x92</span><span class="op" id="7314307">,</span>&nbsp;<span class="num" id="7314309">0xeb</span><span class="op" id="7314313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7314317">0xc6</span><span class="op" id="7314321">,</span>&nbsp;<span class="num" id="7314323">0xe6</span><span class="op" id="7314327">,</span>&nbsp;<span class="num" id="7314329">0xc0</span><span class="op" id="7314333">,</span>&nbsp;<span class="num" id="7314335">0x44</span><span class="op" id="7314339">,</span>&nbsp;<span class="num" id="7314341">0xf3</span><span class="op" id="7314345">,</span>&nbsp;<span class="num" id="7314347">0xb4</span><span class="op" id="7314351">,</span>&nbsp;<span class="num" id="7314353">0xb4</span><span class="op" id="7314357">,</span>&nbsp;<span class="num" id="7314359">0x2e</span><span class="op" id="7314363">,</span>&nbsp;<span class="num" id="7314365">0x8c</span><span class="op" id="7314369">,</span>&nbsp;<span class="num" id="7314371">0x66</span><span class="op" id="7314375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7314379">0x0a</span><span class="op" id="7314383">,</span>&nbsp;<span class="num" id="7314385">0x37</span><span class="op" id="7314389">,</span>&nbsp;<span class="num" id="7314391">0x9c</span><span class="op" id="7314395">,</span>&nbsp;<span class="num" id="7314397">0x69</span><span class="op" id="7314401">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314408">if</span>&nbsp;<span class="ident" id="7314411">err</span>&nbsp;<span class="op" id="7314415">:=</span>&nbsp;<span class="ident" id="7314418">VerifyPSS</span><span class="op" id="7314427">(</span><span class="op" id="7314428">&amp;</span><span class="ident" id="7314429">rsaPrivateKey</span><span class="op" id="7314442">.</span><span class="ident" id="7314443">PublicKey</span><span class="op" id="7314452">,</span>&nbsp;<span class="ident" id="7314454">hash</span><span class="op" id="7314458">,</span>&nbsp;<span class="ident" id="7314460">hashed</span><span class="op" id="7314466">,</span>&nbsp;<span class="ident" id="7314468">sig</span><span class="op" id="7314471">,</span>&nbsp;<span class="builtintype" id="7314473">nil</span><span class="op" id="7314476">)</span><span class="op" id="7314477">;</span>&nbsp;<span class="ident" id="7314479">err</span>&nbsp;<span class="op" id="7314483">!=</span>&nbsp;<span class="builtintype" id="7314486">nil</span>&nbsp;<span class="op" id="7314490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314494">t</span><span class="op" id="7314495">.</span><span class="ident" id="7314496">Error</span><span class="op" id="7314501">(</span><span class="ident" id="7314502">err</span><span class="op" id="7314505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314508">}</span><br>
<span class="lineno">190</span><span class="op" id="7314510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7314513">func</span>&nbsp;<span class="ident" id="7314518">TestPSSSigning</span><span class="op" id="7314532">(</span><span class="ident" id="7314533">t</span>&nbsp;<span class="op" id="7314535">*</span><span class="ident" id="7314536">testing</span><span class="op" id="7314543">.</span><span class="ident" id="7314544">T</span><span class="op" id="7314545">)</span>&nbsp;<span class="op" id="7314547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314550">var</span>&nbsp;<span class="ident" id="7314554">saltLengthCombinations</span>&nbsp;<span class="op" id="7314577">=</span>&nbsp;<span class="op" id="7314579">[</span><span class="op" id="7314580">]</span><span class="keyword" id="7314581">struct</span>&nbsp;<span class="op" id="7314588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314592">signSaltLength</span><span class="op" id="7314606">,</span>&nbsp;<span class="ident" id="7314608">verifySaltLength</span>&nbsp;<span class="builtintype" id="7314625">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314631">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7314664">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314670">}</span><span class="op" id="7314671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314675">{</span><span class="ident" id="7314676">PSSSaltLengthAuto</span><span class="op" id="7314693">,</span>&nbsp;<span class="ident" id="7314695">PSSSaltLengthAuto</span><span class="op" id="7314712">,</span>&nbsp;<span class="builtintype" id="7314714">true</span><span class="op" id="7314718">}</span><span class="op" id="7314719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314723">{</span><span class="ident" id="7314724">PSSSaltLengthEqualsHash</span><span class="op" id="7314747">,</span>&nbsp;<span class="ident" id="7314749">PSSSaltLengthAuto</span><span class="op" id="7314766">,</span>&nbsp;<span class="builtintype" id="7314768">true</span><span class="op" id="7314772">}</span><span class="op" id="7314773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314777">{</span><span class="ident" id="7314778">PSSSaltLengthEqualsHash</span><span class="op" id="7314801">,</span>&nbsp;<span class="ident" id="7314803">PSSSaltLengthEqualsHash</span><span class="op" id="7314826">,</span>&nbsp;<span class="builtintype" id="7314828">true</span><span class="op" id="7314832">}</span><span class="op" id="7314833">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314837">{</span><span class="ident" id="7314838">PSSSaltLengthEqualsHash</span><span class="op" id="7314861">,</span>&nbsp;<span class="num" id="7314863">8</span><span class="op" id="7314864">,</span>&nbsp;<span class="builtintype" id="7314866">false</span><span class="op" id="7314871">}</span><span class="op" id="7314872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314876">{</span><span class="ident" id="7314877">PSSSaltLengthAuto</span><span class="op" id="7314894">,</span>&nbsp;<span class="ident" id="7314896">PSSSaltLengthEqualsHash</span><span class="op" id="7314919">,</span>&nbsp;<span class="builtintype" id="7314921">false</span><span class="op" id="7314926">}</span><span class="op" id="7314927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314931">{</span><span class="num" id="7314932">8</span><span class="op" id="7314933">,</span>&nbsp;<span class="num" id="7314935">8</span><span class="op" id="7314936">,</span>&nbsp;<span class="builtintype" id="7314938">true</span><span class="op" id="7314942">}</span><span class="op" id="7314943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314950">hash</span>&nbsp;<span class="op" id="7314955">:=</span>&nbsp;<span class="ident" id="7314958">crypto</span><span class="op" id="7314964">.</span><span class="ident" id="7314965">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314970">h</span>&nbsp;<span class="op" id="7314972">:=</span>&nbsp;<span class="ident" id="7314975">hash</span><span class="op" id="7314979">.</span><span class="ident" id="7314980">New</span><span class="op" id="7314983">(</span><span class="op" id="7314984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314987">h</span><span class="op" id="7314988">.</span><span class="ident" id="7314989">Write</span><span class="op" id="7314994">(</span><span class="op" id="7314995">[</span><span class="op" id="7314996">]</span><span class="builtintype" id="7314997">byte</span><span class="op" id="7315001">(</span><span class="string" id="7315002">&#34;testing&#34;</span><span class="op" id="7315011">)</span><span class="op" id="7315012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315015">hashed</span>&nbsp;<span class="op" id="7315022">:=</span>&nbsp;<span class="ident" id="7315025">h</span><span class="op" id="7315026">.</span><span class="ident" id="7315027">Sum</span><span class="op" id="7315030">(</span><span class="builtintype" id="7315031">nil</span><span class="op" id="7315034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315037">var</span>&nbsp;<span class="ident" id="7315041">opts</span>&nbsp;<span class="ident" id="7315046">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315059">for</span>&nbsp;<span class="ident" id="7315063">i</span><span class="op" id="7315064">,</span>&nbsp;<span class="ident" id="7315066">test</span>&nbsp;<span class="op" id="7315071">:=</span>&nbsp;<span class="keyword" id="7315074">range</span>&nbsp;<span class="ident" id="7315080">saltLengthCombinations</span>&nbsp;<span class="op" id="7315103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315107">opts</span><span class="op" id="7315111">.</span><span class="ident" id="7315112">SaltLength</span>&nbsp;<span class="op" id="7315123">=</span>&nbsp;<span class="ident" id="7315125">test</span><span class="op" id="7315129">.</span><span class="ident" id="7315130">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315147">sig</span><span class="op" id="7315150">,</span>&nbsp;<span class="ident" id="7315152">err</span>&nbsp;<span class="op" id="7315156">:=</span>&nbsp;<span class="ident" id="7315159">SignPSS</span><span class="op" id="7315166">(</span><span class="ident" id="7315167">rand</span><span class="op" id="7315171">.</span><span class="ident" id="7315172">Reader</span><span class="op" id="7315178">,</span>&nbsp;<span class="ident" id="7315180">rsaPrivateKey</span><span class="op" id="7315193">,</span>&nbsp;<span class="ident" id="7315195">hash</span><span class="op" id="7315199">,</span>&nbsp;<span class="ident" id="7315201">hashed</span><span class="op" id="7315207">,</span>&nbsp;<span class="op" id="7315209">&amp;</span><span class="ident" id="7315210">opts</span><span class="op" id="7315214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315218">if</span>&nbsp;<span class="ident" id="7315221">err</span>&nbsp;<span class="op" id="7315225">!=</span>&nbsp;<span class="builtintype" id="7315228">nil</span>&nbsp;<span class="op" id="7315232">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315237">t</span><span class="op" id="7315238">.</span><span class="ident" id="7315239">Errorf</span><span class="op" id="7315245">(</span><span class="string" id="7315246">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7315276">,</span>&nbsp;<span class="ident" id="7315278">i</span><span class="op" id="7315279">,</span>&nbsp;<span class="ident" id="7315281">err</span><span class="op" id="7315284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315289">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315305">opts</span><span class="op" id="7315309">.</span><span class="ident" id="7315310">SaltLength</span>&nbsp;<span class="op" id="7315321">=</span>&nbsp;<span class="ident" id="7315323">test</span><span class="op" id="7315327">.</span><span class="ident" id="7315328">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315347">err</span>&nbsp;<span class="op" id="7315351">=</span>&nbsp;<span class="ident" id="7315353">VerifyPSS</span><span class="op" id="7315362">(</span><span class="op" id="7315363">&amp;</span><span class="ident" id="7315364">rsaPrivateKey</span><span class="op" id="7315377">.</span><span class="ident" id="7315378">PublicKey</span><span class="op" id="7315387">,</span>&nbsp;<span class="ident" id="7315389">hash</span><span class="op" id="7315393">,</span>&nbsp;<span class="ident" id="7315395">hashed</span><span class="op" id="7315401">,</span>&nbsp;<span class="ident" id="7315403">sig</span><span class="op" id="7315406">,</span>&nbsp;<span class="op" id="7315408">&amp;</span><span class="ident" id="7315409">opts</span><span class="op" id="7315413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315417">if</span>&nbsp;<span class="op" id="7315420">(</span><span class="ident" id="7315421">err</span>&nbsp;<span class="op" id="7315425">==</span>&nbsp;<span class="builtintype" id="7315428">nil</span><span class="op" id="7315431">)</span>&nbsp;<span class="op" id="7315433">!=</span>&nbsp;<span class="ident" id="7315436">test</span><span class="op" id="7315440">.</span><span class="ident" id="7315441">good</span>&nbsp;<span class="op" id="7315446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315451">t</span><span class="op" id="7315452">.</span><span class="ident" id="7315453">Errorf</span><span class="op" id="7315459">(</span><span class="string" id="7315460">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="7315498">,</span>&nbsp;<span class="ident" id="7315500">i</span><span class="op" id="7315501">,</span>&nbsp;<span class="ident" id="7315503">test</span><span class="op" id="7315507">.</span><span class="ident" id="7315508">good</span><span class="op" id="7315512">,</span>&nbsp;<span class="ident" id="7315514">err</span><span class="op" id="7315517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315524">}</span><br>
<span class="lineno">225</span><span class="op" id="7315526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7315529">func</span>&nbsp;<span class="ident" id="7315534">bigFromHex</span><span class="op" id="7315544">(</span><span class="ident" id="7315545">hex</span>&nbsp;<span class="builtintype" id="7315549">string</span><span class="op" id="7315555">)</span>&nbsp;<span class="op" id="7315557">*</span><span class="ident" id="7315558">big</span><span class="op" id="7315561">.</span><span class="ident" id="7315562">Int</span>&nbsp;<span class="op" id="7315566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315569">n</span><span class="op" id="7315570">,</span>&nbsp;<span class="ident" id="7315572">ok</span>&nbsp;<span class="op" id="7315575">:=</span>&nbsp;<span class="builtinfunc" id="7315578">new</span><span class="op" id="7315581">(</span><span class="ident" id="7315582">big</span><span class="op" id="7315585">.</span><span class="ident" id="7315586">Int</span><span class="op" id="7315589">)</span><span class="op" id="7315590">.</span><span class="ident" id="7315591">SetString</span><span class="op" id="7315600">(</span><span class="ident" id="7315601">hex</span><span class="op" id="7315604">,</span>&nbsp;<span class="num" id="7315606">16</span><span class="op" id="7315608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315611">if</span>&nbsp;<span class="op" id="7315614">!</span><span class="ident" id="7315615">ok</span>&nbsp;<span class="op" id="7315618">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7315622">panic</span><span class="op" id="7315627">(</span><span class="string" id="7315628">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="7315640">+</span>&nbsp;<span class="ident" id="7315642">hex</span><span class="op" id="7315645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315651">return</span>&nbsp;<span class="ident" id="7315658">n</span><br>
<span class="lineno"></span><span class="op" id="7315660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7315663">func</span>&nbsp;<span class="ident" id="7315668">intFromHex</span><span class="op" id="7315678">(</span><span class="ident" id="7315679">hex</span>&nbsp;<span class="builtintype" id="7315683">string</span><span class="op" id="7315689">)</span>&nbsp;<span class="builtintype" id="7315691">int</span>&nbsp;<span class="op" id="7315695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315698">i</span><span class="op" id="7315699">,</span>&nbsp;<span class="ident" id="7315701">err</span>&nbsp;<span class="op" id="7315705">:=</span>&nbsp;<span class="ident" id="7315708">strconv</span><span class="op" id="7315715">.</span><span class="ident" id="7315716">ParseInt</span><span class="op" id="7315724">(</span><span class="ident" id="7315725">hex</span><span class="op" id="7315728">,</span>&nbsp;<span class="num" id="7315730">16</span><span class="op" id="7315732">,</span>&nbsp;<span class="num" id="7315734">32</span><span class="op" id="7315736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315739">if</span>&nbsp;<span class="ident" id="7315742">err</span>&nbsp;<span class="op" id="7315746">!=</span>&nbsp;<span class="builtintype" id="7315749">nil</span>&nbsp;<span class="op" id="7315753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7315757">panic</span><span class="op" id="7315762">(</span><span class="ident" id="7315763">err</span><span class="op" id="7315766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315769">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315772">return</span>&nbsp;<span class="builtintype" id="7315779">int</span><span class="op" id="7315782">(</span><span class="ident" id="7315783">i</span><span class="op" id="7315784">)</span><br>
<span class="lineno"></span><span class="op" id="7315786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7315789">func</span>&nbsp;<span class="ident" id="7315794">fromHex</span><span class="op" id="7315801">(</span><span class="ident" id="7315802">hexStr</span>&nbsp;<span class="builtintype" id="7315809">string</span><span class="op" id="7315815">)</span>&nbsp;<span class="op" id="7315817">[</span><span class="op" id="7315818">]</span><span class="builtintype" id="7315819">byte</span>&nbsp;<span class="op" id="7315824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315827">s</span><span class="op" id="7315828">,</span>&nbsp;<span class="ident" id="7315830">err</span>&nbsp;<span class="op" id="7315834">:=</span>&nbsp;<span class="ident" id="7315837">hex</span><span class="op" id="7315840">.</span><span class="ident" id="7315841">DecodeString</span><span class="op" id="7315853">(</span><span class="ident" id="7315854">hexStr</span><span class="op" id="7315860">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315863">if</span>&nbsp;<span class="ident" id="7315866">err</span>&nbsp;<span class="op" id="7315870">!=</span>&nbsp;<span class="builtintype" id="7315873">nil</span>&nbsp;<span class="op" id="7315877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7315881">panic</span><span class="op" id="7315886">(</span><span class="ident" id="7315887">err</span><span class="op" id="7315890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315896">return</span>&nbsp;<span class="ident" id="7315903">s</span><br>
<span class="lineno"></span><span class="op" id="7315905">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
