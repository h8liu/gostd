<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2678891">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2678947">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2679001">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2679052">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679130">package</span>&nbsp;<span class="ident" id="2679138">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679143">import</span>&nbsp;<span class="op" id="2679150">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2679153">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2679159">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2679170">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="2679177">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="2679180">//&nbsp;A&nbsp;sockaddr&nbsp;represents&nbsp;a&nbsp;TCP,&nbsp;UDP,&nbsp;IP&nbsp;or&nbsp;Unix&nbsp;network&nbsp;endpoint</span><br>
<span class="lineno"></span><span class="comment" id="2679245">//&nbsp;address&nbsp;that&nbsp;can&nbsp;be&nbsp;converted&nbsp;into&nbsp;a&nbsp;syscall.Sockaddr.</span><br>
<span class="lineno"></span><span class="keyword" id="2679303">type</span>&nbsp;<span class="ident" id="2679308">sockaddr</span>&nbsp;<span class="keyword" id="2679317">interface</span>&nbsp;<span class="op" id="2679327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679330"><a href="/net/net.go.html#2652238">Addr</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679337"><a href="/net/ipsock.go.html#2628205">netaddr</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679347">//&nbsp;family&nbsp;returns&nbsp;the&nbsp;platform-dependent&nbsp;address&nbsp;family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679404">//&nbsp;identifier.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679420">family</span><span class="op" id="2679426">(</span><span class="op" id="2679427">)</span>&nbsp;<span class="builtintype" id="2679429">int</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679435">//&nbsp;isWildcard&nbsp;reports&nbsp;whether&nbsp;the&nbsp;address&nbsp;is&nbsp;a&nbsp;wildcard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679492">//&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679505">isWildcard</span><span class="op" id="2679515">(</span><span class="op" id="2679516">)</span>&nbsp;<span class="builtintype" id="2679518">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679525">//&nbsp;sockaddr&nbsp;returns&nbsp;the&nbsp;address&nbsp;converted&nbsp;into&nbsp;a&nbsp;syscall</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679583">//&nbsp;sockaddr&nbsp;type&nbsp;that&nbsp;implements&nbsp;syscall.Sockaddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679634">//&nbsp;interface.&nbsp;It&nbsp;returns&nbsp;a&nbsp;nil&nbsp;interface&nbsp;when&nbsp;the&nbsp;address&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679696">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679705">sockaddr</span><span class="op" id="2679713">(</span><span class="ident" id="2679714">family</span>&nbsp;<span class="builtintype" id="2679721">int</span><span class="op" id="2679724">)</span>&nbsp;<span class="op" id="2679726">(</span><span class="ident" id="2679727"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2679734">.</span><span class="ident" id="2679735">Sockaddr</span><span class="op" id="2679743">,</span>&nbsp;<span class="builtintype" id="2679745">error</span><span class="op" id="2679750">)</span><br>
<span class="lineno">35</span><span class="op" id="2679752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2679755">//&nbsp;socket&nbsp;returns&nbsp;a&nbsp;network&nbsp;file&nbsp;descriptor&nbsp;that&nbsp;is&nbsp;ready&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2679817">//&nbsp;asynchronous&nbsp;I/O&nbsp;using&nbsp;the&nbsp;network&nbsp;poller.</span><br>
<span class="lineno"></span><span class="keyword" id="2679863">func</span>&nbsp;<span class="ident" id="2679868">socket</span><span class="op" id="2679874">(</span><span class="ident" id="2679875">net</span>&nbsp;<span class="builtintype" id="2679879">string</span><span class="op" id="2679885">,</span>&nbsp;<span class="ident" id="2679887">family</span><span class="op" id="2679893">,</span>&nbsp;<span class="ident" id="2679895">sotype</span><span class="op" id="2679901">,</span>&nbsp;<span class="ident" id="2679903">proto</span>&nbsp;<span class="builtintype" id="2679909">int</span><span class="op" id="2679912">,</span>&nbsp;<span class="ident" id="2679914">ipv6only</span>&nbsp;<span class="builtintype" id="2679923">bool</span><span class="op" id="2679927">,</span>&nbsp;<span class="ident" id="2679929">laddr</span><span class="op" id="2679934">,</span>&nbsp;<span class="ident" id="2679936">raddr</span>&nbsp;<span class="ident" id="2679942"><a href="/net/sock_posix.go.html#2679308">sockaddr</a></span><span class="op" id="2679950">,</span>&nbsp;<span class="ident" id="2679952">deadline</span>&nbsp;<span class="ident" id="2679961"><a href="/net/sock_posix.go.html#2679170">time</a></span><span class="op" id="2679965">.</span><span class="ident" id="2679966">Time</span><span class="op" id="2679970">)</span>&nbsp;<span class="op" id="2679972">(</span><span class="ident" id="2679973">fd</span>&nbsp;<span class="op" id="2679976">*</span><span class="ident" id="2679977"><a href="/net/fd_unix.go.html#2575420">netFD</a></span><span class="op" id="2679982">,</span>&nbsp;<span class="ident" id="2679984">err</span>&nbsp;<span class="builtintype" id="2679988">error</span><span class="op" id="2679993">)</span>&nbsp;<span class="op" id="2679995">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679998">s</span><span class="op" id="2679999">,</span>&nbsp;<span class="ident" id="2680001"><a href="/net/sock_posix.go.html#2679984">err</a></span>&nbsp;<span class="op" id="2680005">:=</span>&nbsp;<span class="ident" id="2680008"><a href="/net/sock_cloexec.go.html#2676010">sysSocket</a></span><span class="op" id="2680017">(</span><span class="ident" id="2680018"><a href="/net/sock_posix.go.html#2679887">family</a></span><span class="op" id="2680024">,</span>&nbsp;<span class="ident" id="2680026"><a href="/net/sock_posix.go.html#2679895">sotype</a></span><span class="op" id="2680032">,</span>&nbsp;<span class="ident" id="2680034"><a href="/net/sock_posix.go.html#2679903">proto</a></span><span class="op" id="2680039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680042">if</span>&nbsp;<span class="ident" id="2680045"><a href="/net/sock_posix.go.html#2679984">err</a></span>&nbsp;<span class="op" id="2680049">!=</span>&nbsp;<span class="ident" id="2680052">nil</span>&nbsp;<span class="op" id="2680056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680060">return</span>&nbsp;<span class="ident" id="2680067">nil</span><span class="op" id="2680070">,</span>&nbsp;<span class="ident" id="2680072"><a href="/net/sock_posix.go.html#2679984">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680080">if</span>&nbsp;<span class="ident" id="2680083"><a href="/net/sock_posix.go.html#2679984">err</a></span>&nbsp;<span class="op" id="2680087">=</span>&nbsp;<span class="ident" id="2680089"><a href="/net/sockopt_linux.go.html#2684951">setDefaultSockopts</a></span><span class="op" id="2680107">(</span><span class="ident" id="2680108"><a href="/net/sock_posix.go.html#2679998">s</a></span><span class="op" id="2680109">,</span>&nbsp;<span class="ident" id="2680111"><a href="/net/sock_posix.go.html#2679887">family</a></span><span class="op" id="2680117">,</span>&nbsp;<span class="ident" id="2680119"><a href="/net/sock_posix.go.html#2679895">sotype</a></span><span class="op" id="2680125">,</span>&nbsp;<span class="ident" id="2680127"><a href="/net/sock_posix.go.html#2679914">ipv6only</a></span><span class="op" id="2680135">)</span><span class="op" id="2680136">;</span>&nbsp;<span class="ident" id="2680138"><a href="/net/sock_posix.go.html#2679984">err</a></span>&nbsp;<span class="op" id="2680142">!=</span>&nbsp;<span class="ident" id="2680145">nil</span>&nbsp;<span class="op" id="2680149">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680153"><a href="/net/fd_unix.go.html#2587250">closesocket</a></span><span class="op" id="2680164">(</span><span class="ident" id="2680165"><a href="/net/sock_posix.go.html#2679998">s</a></span><span class="op" id="2680166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680170">return</span>&nbsp;<span class="ident" id="2680177">nil</span><span class="op" id="2680180">,</span>&nbsp;<span class="ident" id="2680182"><a href="/net/sock_posix.go.html#2679984">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680190">if</span>&nbsp;<span class="ident" id="2680193"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2680195">,</span>&nbsp;<span class="ident" id="2680197"><a href="/net/sock_posix.go.html#2679984">err</a></span>&nbsp;<span class="op" id="2680201">=</span>&nbsp;<span class="ident" id="2680203"><a href="/net/fd_unix.go.html#2575871">newFD</a></span><span class="op" id="2680208">(</span><span class="ident" id="2680209"><a href="/net/sock_posix.go.html#2679998">s</a></span><span class="op" id="2680210">,</span>&nbsp;<span class="ident" id="2680212"><a href="/net/sock_posix.go.html#2679887">family</a></span><span class="op" id="2680218">,</span>&nbsp;<span class="ident" id="2680220"><a href="/net/sock_posix.go.html#2679895">sotype</a></span><span class="op" id="2680226">,</span>&nbsp;<span class="ident" id="2680228"><a href="/net/sock_posix.go.html#2679875">net</a></span><span class="op" id="2680231">)</span><span class="op" id="2680232">;</span>&nbsp;<span class="ident" id="2680234"><a href="/net/sock_posix.go.html#2679984">err</a></span>&nbsp;<span class="op" id="2680238">!=</span>&nbsp;<span class="ident" id="2680241">nil</span>&nbsp;<span class="op" id="2680245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680249"><a href="/net/fd_unix.go.html#2587250">closesocket</a></span><span class="op" id="2680260">(</span><span class="ident" id="2680261"><a href="/net/sock_posix.go.html#2679998">s</a></span><span class="op" id="2680262">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680266">return</span>&nbsp;<span class="ident" id="2680273">nil</span><span class="op" id="2680276">,</span>&nbsp;<span class="ident" id="2680278"><a href="/net/sock_posix.go.html#2679984">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680287">//&nbsp;This&nbsp;function&nbsp;makes&nbsp;a&nbsp;network&nbsp;file&nbsp;descriptor&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680345">//&nbsp;following&nbsp;applications:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680373">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680377">//&nbsp;-&nbsp;An&nbsp;endpoint&nbsp;holder&nbsp;that&nbsp;opens&nbsp;a&nbsp;passive&nbsp;stream</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680430">//&nbsp;&nbsp;&nbsp;connenction,&nbsp;known&nbsp;as&nbsp;a&nbsp;stream&nbsp;listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680476">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680480">//&nbsp;-&nbsp;An&nbsp;endpoint&nbsp;holder&nbsp;that&nbsp;opens&nbsp;a&nbsp;destination-unspecific</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680541">//&nbsp;&nbsp;&nbsp;datagram&nbsp;connection,&nbsp;known&nbsp;as&nbsp;a&nbsp;datagram&nbsp;listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680597">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680601">//&nbsp;-&nbsp;An&nbsp;endpoint&nbsp;holder&nbsp;that&nbsp;opens&nbsp;an&nbsp;active&nbsp;stream&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680659">//&nbsp;&nbsp;&nbsp;destination-specific&nbsp;datagram&nbsp;connection,&nbsp;known&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680718">//&nbsp;&nbsp;&nbsp;dialer</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680731">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680735">//&nbsp;-&nbsp;An&nbsp;endpoint&nbsp;holder&nbsp;that&nbsp;opens&nbsp;the&nbsp;other&nbsp;connection,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680798">//&nbsp;&nbsp;&nbsp;as&nbsp;talking&nbsp;to&nbsp;the&nbsp;protocol&nbsp;stack&nbsp;inside&nbsp;the&nbsp;kernel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680855">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680859">//&nbsp;For&nbsp;stream&nbsp;and&nbsp;datagram&nbsp;listeners,&nbsp;they&nbsp;will&nbsp;only&nbsp;require</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680921">//&nbsp;named&nbsp;sockets,&nbsp;so&nbsp;we&nbsp;can&nbsp;assume&nbsp;that&nbsp;it&#39;s&nbsp;just&nbsp;a&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2680982">//&nbsp;from&nbsp;stream&nbsp;or&nbsp;datagram&nbsp;listeners&nbsp;when&nbsp;laddr&nbsp;is&nbsp;not&nbsp;nil&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2681046">//&nbsp;raddr&nbsp;is&nbsp;nil.&nbsp;Otherwise&nbsp;we&nbsp;assume&nbsp;it&#39;s&nbsp;just&nbsp;for&nbsp;dialers&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2681109">//&nbsp;the&nbsp;other&nbsp;connection&nbsp;holders.</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681144">if</span>&nbsp;<span class="ident" id="2681147"><a href="/net/sock_posix.go.html#2679929">laddr</a></span>&nbsp;<span class="op" id="2681153">!=</span>&nbsp;<span class="ident" id="2681156">nil</span>&nbsp;<span class="op" id="2681160">&amp;&amp;</span>&nbsp;<span class="ident" id="2681163"><a href="/net/sock_posix.go.html#2679936">raddr</a></span>&nbsp;<span class="op" id="2681169">==</span>&nbsp;<span class="ident" id="2681172">nil</span>&nbsp;<span class="op" id="2681176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681180">switch</span>&nbsp;<span class="ident" id="2681187"><a href="/net/sock_posix.go.html#2679895">sotype</a></span>&nbsp;<span class="op" id="2681194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681198">case</span>&nbsp;<span class="ident" id="2681203"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681210">.</span><span class="ident" id="2681211">SOCK_STREAM</span><span class="op" id="2681222">,</span>&nbsp;<span class="ident" id="2681224"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681231">.</span><span class="ident" id="2681232">SOCK_SEQPACKET</span><span class="op" id="2681246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681251">if</span>&nbsp;<span class="ident" id="2681254">err</span>&nbsp;<span class="op" id="2681258">:=</span>&nbsp;<span class="ident" id="2681261"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681263">.</span><span class="ident" id="2681264">listenStream</span><span class="op" id="2681276">(</span><span class="ident" id="2681277"><a href="/net/sock_posix.go.html#2679929">laddr</a></span><span class="op" id="2681282">,</span>&nbsp;<span class="ident" id="2681284"><a href="/net/net.go.html#2658567">listenerBacklog</a></span><span class="op" id="2681299">)</span><span class="op" id="2681300">;</span>&nbsp;<span class="ident" id="2681302"><a href="/net/sock_posix.go.html#2681254">err</a></span>&nbsp;<span class="op" id="2681306">!=</span>&nbsp;<span class="ident" id="2681309">nil</span>&nbsp;<span class="op" id="2681313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681319"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681321">.</span><span class="ident" id="2681322">Close</span><span class="op" id="2681327">(</span><span class="op" id="2681328">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681334">return</span>&nbsp;<span class="ident" id="2681341">nil</span><span class="op" id="2681344">,</span>&nbsp;<span class="ident" id="2681346"><a href="/net/sock_posix.go.html#2681254">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681358">return</span>&nbsp;<span class="ident" id="2681365"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681367">,</span>&nbsp;<span class="ident" id="2681369">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681375">case</span>&nbsp;<span class="ident" id="2681380"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681387">.</span><span class="ident" id="2681388">SOCK_DGRAM</span><span class="op" id="2681398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681403">if</span>&nbsp;<span class="ident" id="2681406">err</span>&nbsp;<span class="op" id="2681410">:=</span>&nbsp;<span class="ident" id="2681413"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681415">.</span><span class="ident" id="2681416">listenDatagram</span><span class="op" id="2681430">(</span><span class="ident" id="2681431"><a href="/net/sock_posix.go.html#2679929">laddr</a></span><span class="op" id="2681436">)</span><span class="op" id="2681437">;</span>&nbsp;<span class="ident" id="2681439"><a href="/net/sock_posix.go.html#2681406">err</a></span>&nbsp;<span class="op" id="2681443">!=</span>&nbsp;<span class="ident" id="2681446">nil</span>&nbsp;<span class="op" id="2681450">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681456"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681458">.</span><span class="ident" id="2681459">Close</span><span class="op" id="2681464">(</span><span class="op" id="2681465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681471">return</span>&nbsp;<span class="ident" id="2681478">nil</span><span class="op" id="2681481">,</span>&nbsp;<span class="ident" id="2681483"><a href="/net/sock_posix.go.html#2681406">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681495">return</span>&nbsp;<span class="ident" id="2681502"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681504">,</span>&nbsp;<span class="ident" id="2681506">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681512">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681518">if</span>&nbsp;<span class="ident" id="2681521">err</span>&nbsp;<span class="op" id="2681525">:=</span>&nbsp;<span class="ident" id="2681528"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681530">.</span><span class="ident" id="2681531">dial</span><span class="op" id="2681535">(</span><span class="ident" id="2681536"><a href="/net/sock_posix.go.html#2679929">laddr</a></span><span class="op" id="2681541">,</span>&nbsp;<span class="ident" id="2681543"><a href="/net/sock_posix.go.html#2679936">raddr</a></span><span class="op" id="2681548">,</span>&nbsp;<span class="ident" id="2681550"><a href="/net/sock_posix.go.html#2679952">deadline</a></span><span class="op" id="2681558">)</span><span class="op" id="2681559">;</span>&nbsp;<span class="ident" id="2681561"><a href="/net/sock_posix.go.html#2681521">err</a></span>&nbsp;<span class="op" id="2681565">!=</span>&nbsp;<span class="ident" id="2681568">nil</span>&nbsp;<span class="op" id="2681572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681576"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681578">.</span><span class="ident" id="2681579">Close</span><span class="op" id="2681584">(</span><span class="op" id="2681585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681589">return</span>&nbsp;<span class="ident" id="2681596">nil</span><span class="op" id="2681599">,</span>&nbsp;<span class="ident" id="2681601"><a href="/net/sock_posix.go.html#2681521">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681606">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681609">return</span>&nbsp;<span class="ident" id="2681616"><a href="/net/sock_posix.go.html#2679973">fd</a></span><span class="op" id="2681618">,</span>&nbsp;<span class="ident" id="2681620">nil</span><br>
<span class="lineno"></span><span class="op" id="2681624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681627">func</span>&nbsp;<span class="op" id="2681632">(</span><span class="ident" id="2681633">fd</span>&nbsp;<span class="op" id="2681636">*</span><span class="ident" id="2681637"><a href="/net/fd_unix.go.html#2575420">netFD</a></span><span class="op" id="2681642">)</span>&nbsp;<span class="ident" id="2681644">addrFunc</span><span class="op" id="2681652">(</span><span class="op" id="2681653">)</span>&nbsp;<span class="keyword" id="2681655">func</span><span class="op" id="2681659">(</span><span class="ident" id="2681660"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681667">.</span><span class="ident" id="2681668">Sockaddr</span><span class="op" id="2681676">)</span>&nbsp;<span class="ident" id="2681678"><a href="/net/net.go.html#2652238">Addr</a></span>&nbsp;<span class="op" id="2681683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681686">switch</span>&nbsp;<span class="ident" id="2681693"><a href="/net/sock_posix.go.html#2681633">fd</a></span><span class="op" id="2681695">.</span><span class="ident" id="2681696">family</span>&nbsp;<span class="op" id="2681703">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681706">case</span>&nbsp;<span class="ident" id="2681711"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681718">.</span><span class="ident" id="2681719">AF_INET</span><span class="op" id="2681726">,</span>&nbsp;<span class="ident" id="2681728"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681735">.</span><span class="ident" id="2681736">AF_INET6</span><span class="op" id="2681744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681748">switch</span>&nbsp;<span class="ident" id="2681755"><a href="/net/sock_posix.go.html#2681633">fd</a></span><span class="op" id="2681757">.</span><span class="ident" id="2681758">sotype</span>&nbsp;<span class="op" id="2681765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681769">case</span>&nbsp;<span class="ident" id="2681774"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681781">.</span><span class="ident" id="2681782">SOCK_STREAM</span><span class="op" id="2681793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681798">return</span>&nbsp;<span class="ident" id="2681805"><a href="/net/tcpsock_posix.go.html#2693333">sockaddrToTCP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681821">case</span>&nbsp;<span class="ident" id="2681826"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681833">.</span><span class="ident" id="2681834">SOCK_DGRAM</span><span class="op" id="2681844">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681849">return</span>&nbsp;<span class="ident" id="2681856"><a href="/net/udpsock_posix.go.html#2705391">sockaddrToUDP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681872">case</span>&nbsp;<span class="ident" id="2681877"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681884">.</span><span class="ident" id="2681885">SOCK_RAW</span><span class="op" id="2681893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681898">return</span>&nbsp;<span class="ident" id="2681905"><a href="/net/iprawsock_posix.go.html#2621057">sockaddrToIP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681923">case</span>&nbsp;<span class="ident" id="2681928"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681935">.</span><span class="ident" id="2681936">AF_UNIX</span><span class="op" id="2681943">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681947">switch</span>&nbsp;<span class="ident" id="2681954"><a href="/net/sock_posix.go.html#2681633">fd</a></span><span class="op" id="2681956">.</span><span class="ident" id="2681957">sotype</span>&nbsp;<span class="op" id="2681964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681968">case</span>&nbsp;<span class="ident" id="2681973"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2681980">.</span><span class="ident" id="2681981">SOCK_STREAM</span><span class="op" id="2681992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681997">return</span>&nbsp;<span class="ident" id="2682004"><a href="/net/unixsock_posix.go.html#2715391">sockaddrToUnix</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682021">case</span>&nbsp;<span class="ident" id="2682026"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2682033">.</span><span class="ident" id="2682034">SOCK_DGRAM</span><span class="op" id="2682044">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682049">return</span>&nbsp;<span class="ident" id="2682056"><a href="/net/unixsock_posix.go.html#2715549">sockaddrToUnixgram</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682077">case</span>&nbsp;<span class="ident" id="2682082"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2682089">.</span><span class="ident" id="2682090">SOCK_SEQPACKET</span><span class="op" id="2682104">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682109">return</span>&nbsp;<span class="ident" id="2682116"><a href="/net/unixsock_posix.go.html#2715715">sockaddrToUnixpacket</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682145">return</span>&nbsp;<span class="keyword" id="2682152">func</span><span class="op" id="2682156">(</span><span class="ident" id="2682157"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2682164">.</span><span class="ident" id="2682165">Sockaddr</span><span class="op" id="2682173">)</span>&nbsp;<span class="ident" id="2682175"><a href="/net/net.go.html#2652238">Addr</a></span>&nbsp;<span class="op" id="2682180">{</span>&nbsp;<span class="keyword" id="2682182">return</span>&nbsp;<span class="ident" id="2682189">nil</span>&nbsp;<span class="op" id="2682193">}</span><br>
<span class="lineno">120</span><span class="op" id="2682195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2682198">func</span>&nbsp;<span class="op" id="2682203">(</span><span class="ident" id="2682204">fd</span>&nbsp;<span class="op" id="2682207">*</span><span class="ident" id="2682208"><a href="/net/fd_unix.go.html#2575420">netFD</a></span><span class="op" id="2682213">)</span>&nbsp;<span class="ident" id="2682215">dial</span><span class="op" id="2682219">(</span><span class="ident" id="2682220">laddr</span><span class="op" id="2682225">,</span>&nbsp;<span class="ident" id="2682227">raddr</span>&nbsp;<span class="ident" id="2682233"><a href="/net/sock_posix.go.html#2679308">sockaddr</a></span><span class="op" id="2682241">,</span>&nbsp;<span class="ident" id="2682243">deadline</span>&nbsp;<span class="ident" id="2682252"><a href="/net/sock_posix.go.html#2679170">time</a></span><span class="op" id="2682256">.</span><span class="ident" id="2682257">Time</span><span class="op" id="2682261">)</span>&nbsp;<span class="builtintype" id="2682263">error</span>&nbsp;<span class="op" id="2682269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682272">var</span>&nbsp;<span class="ident" id="2682276">err</span>&nbsp;<span class="builtintype" id="2682280">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682287">var</span>&nbsp;<span class="ident" id="2682291">lsa</span>&nbsp;<span class="ident" id="2682295"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2682302">.</span><span class="ident" id="2682303">Sockaddr</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682313">if</span>&nbsp;<span class="ident" id="2682316"><a href="/net/sock_posix.go.html#2682220">laddr</a></span>&nbsp;<span class="op" id="2682322">!=</span>&nbsp;<span class="ident" id="2682325">nil</span>&nbsp;<span class="op" id="2682329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682333">if</span>&nbsp;<span class="ident" id="2682336"><a href="/net/sock_posix.go.html#2682291">lsa</a></span><span class="op" id="2682339">,</span>&nbsp;<span class="ident" id="2682341"><a href="/net/sock_posix.go.html#2682276">err</a></span>&nbsp;<span class="op" id="2682345">=</span>&nbsp;<span class="ident" id="2682347"><a href="/net/sock_posix.go.html#2682220">laddr</a></span><span class="op" id="2682352">.</span><span class="ident" id="2682353">sockaddr</span><span class="op" id="2682361">(</span><span class="ident" id="2682362"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682364">.</span><span class="ident" id="2682365">family</span><span class="op" id="2682371">)</span><span class="op" id="2682372">;</span>&nbsp;<span class="ident" id="2682374"><a href="/net/sock_posix.go.html#2682276">err</a></span>&nbsp;<span class="op" id="2682378">!=</span>&nbsp;<span class="ident" id="2682381">nil</span>&nbsp;<span class="op" id="2682385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682390">return</span>&nbsp;<span class="ident" id="2682397"><a href="/net/sock_posix.go.html#2682276">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682403">}</span>&nbsp;<span class="keyword" id="2682405">else</span>&nbsp;<span class="keyword" id="2682410">if</span>&nbsp;<span class="ident" id="2682413"><a href="/net/sock_posix.go.html#2682291">lsa</a></span>&nbsp;<span class="op" id="2682417">!=</span>&nbsp;<span class="ident" id="2682420">nil</span>&nbsp;<span class="op" id="2682424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682429">if</span>&nbsp;<span class="ident" id="2682432">err</span>&nbsp;<span class="op" id="2682436">:=</span>&nbsp;<span class="ident" id="2682439"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2682446">.</span><span class="ident" id="2682447">Bind</span><span class="op" id="2682451">(</span><span class="ident" id="2682452"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682454">.</span><span class="ident" id="2682455">sysfd</span><span class="op" id="2682460">,</span>&nbsp;<span class="ident" id="2682462"><a href="/net/sock_posix.go.html#2682291">lsa</a></span><span class="op" id="2682465">)</span><span class="op" id="2682466">;</span>&nbsp;<span class="ident" id="2682468"><a href="/net/sock_posix.go.html#2682432">err</a></span>&nbsp;<span class="op" id="2682472">!=</span>&nbsp;<span class="ident" id="2682475">nil</span>&nbsp;<span class="op" id="2682479">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682485">return</span>&nbsp;<span class="ident" id="2682492"><a href="/net/sock_posix.go.html#2679153">os</a></span><span class="op" id="2682494">.</span><span class="ident" id="2682495">NewSyscallError</span><span class="op" id="2682510">(</span><span class="string" id="2682511">&#34;bind&#34;</span><span class="op" id="2682517">,</span>&nbsp;<span class="ident" id="2682519"><a href="/net/sock_posix.go.html#2682432">err</a></span><span class="op" id="2682522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682537">var</span>&nbsp;<span class="ident" id="2682541">rsa</span>&nbsp;<span class="ident" id="2682545"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2682552">.</span><span class="ident" id="2682553">Sockaddr</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682563">if</span>&nbsp;<span class="ident" id="2682566"><a href="/net/sock_posix.go.html#2682227">raddr</a></span>&nbsp;<span class="op" id="2682572">!=</span>&nbsp;<span class="ident" id="2682575">nil</span>&nbsp;<span class="op" id="2682579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682583">if</span>&nbsp;<span class="ident" id="2682586"><a href="/net/sock_posix.go.html#2682541">rsa</a></span><span class="op" id="2682589">,</span>&nbsp;<span class="ident" id="2682591"><a href="/net/sock_posix.go.html#2682276">err</a></span>&nbsp;<span class="op" id="2682595">=</span>&nbsp;<span class="ident" id="2682597"><a href="/net/sock_posix.go.html#2682227">raddr</a></span><span class="op" id="2682602">.</span><span class="ident" id="2682603">sockaddr</span><span class="op" id="2682611">(</span><span class="ident" id="2682612"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682614">.</span><span class="ident" id="2682615">family</span><span class="op" id="2682621">)</span><span class="op" id="2682622">;</span>&nbsp;<span class="ident" id="2682624"><a href="/net/sock_posix.go.html#2682276">err</a></span>&nbsp;<span class="op" id="2682628">!=</span>&nbsp;<span class="ident" id="2682631">nil</span>&nbsp;<span class="op" id="2682635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682640">return</span>&nbsp;<span class="ident" id="2682647"><a href="/net/sock_posix.go.html#2682276">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682657">if</span>&nbsp;<span class="ident" id="2682660">err</span>&nbsp;<span class="op" id="2682664">:=</span>&nbsp;<span class="ident" id="2682667"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682669">.</span><span class="ident" id="2682670">connect</span><span class="op" id="2682677">(</span><span class="ident" id="2682678"><a href="/net/sock_posix.go.html#2682291">lsa</a></span><span class="op" id="2682681">,</span>&nbsp;<span class="ident" id="2682683"><a href="/net/sock_posix.go.html#2682541">rsa</a></span><span class="op" id="2682686">,</span>&nbsp;<span class="ident" id="2682688"><a href="/net/sock_posix.go.html#2682243">deadline</a></span><span class="op" id="2682696">)</span><span class="op" id="2682697">;</span>&nbsp;<span class="ident" id="2682699"><a href="/net/sock_posix.go.html#2682660">err</a></span>&nbsp;<span class="op" id="2682703">!=</span>&nbsp;<span class="ident" id="2682706">nil</span>&nbsp;<span class="op" id="2682710">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682715">return</span>&nbsp;<span class="ident" id="2682722"><a href="/net/sock_posix.go.html#2682660">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682732"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682734">.</span><span class="ident" id="2682735">isConnected</span>&nbsp;<span class="op" id="2682747">=</span>&nbsp;<span class="ident" id="2682749">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682755">}</span>&nbsp;<span class="keyword" id="2682757">else</span>&nbsp;<span class="op" id="2682762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682766">if</span>&nbsp;<span class="ident" id="2682769">err</span>&nbsp;<span class="op" id="2682773">:=</span>&nbsp;<span class="ident" id="2682776"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682778">.</span><span class="ident" id="2682779">init</span><span class="op" id="2682783">(</span><span class="op" id="2682784">)</span><span class="op" id="2682785">;</span>&nbsp;<span class="ident" id="2682787"><a href="/net/sock_posix.go.html#2682769">err</a></span>&nbsp;<span class="op" id="2682791">!=</span>&nbsp;<span class="ident" id="2682794">nil</span>&nbsp;<span class="op" id="2682798">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682803">return</span>&nbsp;<span class="ident" id="2682810"><a href="/net/sock_posix.go.html#2682769">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682822"><a href="/net/sock_posix.go.html#2682291">lsa</a></span><span class="op" id="2682825">,</span>&nbsp;<span class="ident" id="2682827">_</span>&nbsp;<span class="op" id="2682829">=</span>&nbsp;<span class="ident" id="2682831"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2682838">.</span><span class="ident" id="2682839">Getsockname</span><span class="op" id="2682850">(</span><span class="ident" id="2682851"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682853">.</span><span class="ident" id="2682854">sysfd</span><span class="op" id="2682859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682862">if</span>&nbsp;<span class="ident" id="2682865"><a href="/net/sock_posix.go.html#2682541">rsa</a></span><span class="op" id="2682868">,</span>&nbsp;<span class="ident" id="2682870">_</span>&nbsp;<span class="op" id="2682872">=</span>&nbsp;<span class="ident" id="2682874"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2682881">.</span><span class="ident" id="2682882">Getpeername</span><span class="op" id="2682893">(</span><span class="ident" id="2682894"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682896">.</span><span class="ident" id="2682897">sysfd</span><span class="op" id="2682902">)</span><span class="op" id="2682903">;</span>&nbsp;<span class="ident" id="2682905"><a href="/net/sock_posix.go.html#2682541">rsa</a></span>&nbsp;<span class="op" id="2682909">!=</span>&nbsp;<span class="ident" id="2682912">nil</span>&nbsp;<span class="op" id="2682916">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682920"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682922">.</span><span class="ident" id="2682923">setAddr</span><span class="op" id="2682930">(</span><span class="ident" id="2682931"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682933">.</span><span class="ident" id="2682934">addrFunc</span><span class="op" id="2682942">(</span><span class="op" id="2682943">)</span><span class="op" id="2682944">(</span><span class="ident" id="2682945"><a href="/net/sock_posix.go.html#2682291">lsa</a></span><span class="op" id="2682948">)</span><span class="op" id="2682949">,</span>&nbsp;<span class="ident" id="2682951"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682953">.</span><span class="ident" id="2682954">addrFunc</span><span class="op" id="2682962">(</span><span class="op" id="2682963">)</span><span class="op" id="2682964">(</span><span class="ident" id="2682965"><a href="/net/sock_posix.go.html#2682541">rsa</a></span><span class="op" id="2682968">)</span><span class="op" id="2682969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682972">}</span>&nbsp;<span class="keyword" id="2682974">else</span>&nbsp;<span class="op" id="2682979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682983"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682985">.</span><span class="ident" id="2682986">setAddr</span><span class="op" id="2682993">(</span><span class="ident" id="2682994"><a href="/net/sock_posix.go.html#2682204">fd</a></span><span class="op" id="2682996">.</span><span class="ident" id="2682997">addrFunc</span><span class="op" id="2683005">(</span><span class="op" id="2683006">)</span><span class="op" id="2683007">(</span><span class="ident" id="2683008"><a href="/net/sock_posix.go.html#2682291">lsa</a></span><span class="op" id="2683011">)</span><span class="op" id="2683012">,</span>&nbsp;<span class="ident" id="2683014"><a href="/net/sock_posix.go.html#2682227">raddr</a></span><span class="op" id="2683019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683025">return</span>&nbsp;<span class="ident" id="2683032">nil</span><br>
<span class="lineno">155</span><span class="op" id="2683036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683039">func</span>&nbsp;<span class="op" id="2683044">(</span><span class="ident" id="2683045">fd</span>&nbsp;<span class="op" id="2683048">*</span><span class="ident" id="2683049"><a href="/net/fd_unix.go.html#2575420">netFD</a></span><span class="op" id="2683054">)</span>&nbsp;<span class="ident" id="2683056">listenStream</span><span class="op" id="2683068">(</span><span class="ident" id="2683069">laddr</span>&nbsp;<span class="ident" id="2683075"><a href="/net/sock_posix.go.html#2679308">sockaddr</a></span><span class="op" id="2683083">,</span>&nbsp;<span class="ident" id="2683085">backlog</span>&nbsp;<span class="builtintype" id="2683093">int</span><span class="op" id="2683096">)</span>&nbsp;<span class="builtintype" id="2683098">error</span>&nbsp;<span class="op" id="2683104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683107">if</span>&nbsp;<span class="ident" id="2683110">err</span>&nbsp;<span class="op" id="2683114">:=</span>&nbsp;<span class="ident" id="2683117"><a href="/net/sockopt_linux.go.html#2685446">setDefaultListenerSockopts</a></span><span class="op" id="2683143">(</span><span class="ident" id="2683144"><a href="/net/sock_posix.go.html#2683045">fd</a></span><span class="op" id="2683146">.</span><span class="ident" id="2683147">sysfd</span><span class="op" id="2683152">)</span><span class="op" id="2683153">;</span>&nbsp;<span class="ident" id="2683155"><a href="/net/sock_posix.go.html#2683110">err</a></span>&nbsp;<span class="op" id="2683159">!=</span>&nbsp;<span class="ident" id="2683162">nil</span>&nbsp;<span class="op" id="2683166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683170">return</span>&nbsp;<span class="ident" id="2683177"><a href="/net/sock_posix.go.html#2683110">err</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683185">if</span>&nbsp;<span class="ident" id="2683188">lsa</span><span class="op" id="2683191">,</span>&nbsp;<span class="ident" id="2683193">err</span>&nbsp;<span class="op" id="2683197">:=</span>&nbsp;<span class="ident" id="2683200"><a href="/net/sock_posix.go.html#2683069">laddr</a></span><span class="op" id="2683205">.</span><span class="ident" id="2683206">sockaddr</span><span class="op" id="2683214">(</span><span class="ident" id="2683215"><a href="/net/sock_posix.go.html#2683045">fd</a></span><span class="op" id="2683217">.</span><span class="ident" id="2683218">family</span><span class="op" id="2683224">)</span><span class="op" id="2683225">;</span>&nbsp;<span class="ident" id="2683227"><a href="/net/sock_posix.go.html#2683193">err</a></span>&nbsp;<span class="op" id="2683231">!=</span>&nbsp;<span class="ident" id="2683234">nil</span>&nbsp;<span class="op" id="2683238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683242">return</span>&nbsp;<span class="ident" id="2683249"><a href="/net/sock_posix.go.html#2683193">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683254">}</span>&nbsp;<span class="keyword" id="2683256">else</span>&nbsp;<span class="keyword" id="2683261">if</span>&nbsp;<span class="ident" id="2683264"><a href="/net/sock_posix.go.html#2683188">lsa</a></span>&nbsp;<span class="op" id="2683268">!=</span>&nbsp;<span class="ident" id="2683271">nil</span>&nbsp;<span class="op" id="2683275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683279">if</span>&nbsp;<span class="ident" id="2683282">err</span>&nbsp;<span class="op" id="2683286">:=</span>&nbsp;<span class="ident" id="2683289"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2683296">.</span><span class="ident" id="2683297">Bind</span><span class="op" id="2683301">(</span><span class="ident" id="2683302"><a href="/net/sock_posix.go.html#2683045">fd</a></span><span class="op" id="2683304">.</span><span class="ident" id="2683305">sysfd</span><span class="op" id="2683310">,</span>&nbsp;<span class="ident" id="2683312"><a href="/net/sock_posix.go.html#2683188">lsa</a></span><span class="op" id="2683315">)</span><span class="op" id="2683316">;</span>&nbsp;<span class="ident" id="2683318"><a href="/net/sock_posix.go.html#2683282">err</a></span>&nbsp;<span class="op" id="2683322">!=</span>&nbsp;<span class="ident" id="2683325">nil</span>&nbsp;<span class="op" id="2683329">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683334">return</span>&nbsp;<span class="ident" id="2683341"><a href="/net/sock_posix.go.html#2679153">os</a></span><span class="op" id="2683343">.</span><span class="ident" id="2683344">NewSyscallError</span><span class="op" id="2683359">(</span><span class="string" id="2683360">&#34;bind&#34;</span><span class="op" id="2683366">,</span>&nbsp;<span class="ident" id="2683368"><a href="/net/sock_posix.go.html#2683282">err</a></span><span class="op" id="2683371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683381">if</span>&nbsp;<span class="ident" id="2683384">err</span>&nbsp;<span class="op" id="2683388">:=</span>&nbsp;<span class="ident" id="2683391"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2683398">.</span><span class="ident" id="2683399">Listen</span><span class="op" id="2683405">(</span><span class="ident" id="2683406"><a href="/net/sock_posix.go.html#2683045">fd</a></span><span class="op" id="2683408">.</span><span class="ident" id="2683409">sysfd</span><span class="op" id="2683414">,</span>&nbsp;<span class="ident" id="2683416"><a href="/net/sock_posix.go.html#2683085">backlog</a></span><span class="op" id="2683423">)</span><span class="op" id="2683424">;</span>&nbsp;<span class="ident" id="2683426"><a href="/net/sock_posix.go.html#2683384">err</a></span>&nbsp;<span class="op" id="2683430">!=</span>&nbsp;<span class="ident" id="2683433">nil</span>&nbsp;<span class="op" id="2683437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683441">return</span>&nbsp;<span class="ident" id="2683448"><a href="/net/sock_posix.go.html#2679153">os</a></span><span class="op" id="2683450">.</span><span class="ident" id="2683451">NewSyscallError</span><span class="op" id="2683466">(</span><span class="string" id="2683467">&#34;listen&#34;</span><span class="op" id="2683475">,</span>&nbsp;<span class="ident" id="2683477"><a href="/net/sock_posix.go.html#2683384">err</a></span><span class="op" id="2683480">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683486">if</span>&nbsp;<span class="ident" id="2683489">err</span>&nbsp;<span class="op" id="2683493">:=</span>&nbsp;<span class="ident" id="2683496"><a href="/net/sock_posix.go.html#2683045">fd</a></span><span class="op" id="2683498">.</span><span class="ident" id="2683499">init</span><span class="op" id="2683503">(</span><span class="op" id="2683504">)</span><span class="op" id="2683505">;</span>&nbsp;<span class="ident" id="2683507"><a href="/net/sock_posix.go.html#2683489">err</a></span>&nbsp;<span class="op" id="2683511">!=</span>&nbsp;<span class="ident" id="2683514">nil</span>&nbsp;<span class="op" id="2683518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683522">return</span>&nbsp;<span class="ident" id="2683529"><a href="/net/sock_posix.go.html#2683489">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683537">lsa</span><span class="op" id="2683540">,</span>&nbsp;<span class="ident" id="2683542">_</span>&nbsp;<span class="op" id="2683544">:=</span>&nbsp;<span class="ident" id="2683547"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2683554">.</span><span class="ident" id="2683555">Getsockname</span><span class="op" id="2683566">(</span><span class="ident" id="2683567"><a href="/net/sock_posix.go.html#2683045">fd</a></span><span class="op" id="2683569">.</span><span class="ident" id="2683570">sysfd</span><span class="op" id="2683575">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683578"><a href="/net/sock_posix.go.html#2683045">fd</a></span><span class="op" id="2683580">.</span><span class="ident" id="2683581">setAddr</span><span class="op" id="2683588">(</span><span class="ident" id="2683589"><a href="/net/sock_posix.go.html#2683045">fd</a></span><span class="op" id="2683591">.</span><span class="ident" id="2683592">addrFunc</span><span class="op" id="2683600">(</span><span class="op" id="2683601">)</span><span class="op" id="2683602">(</span><span class="ident" id="2683603"><a href="/net/sock_posix.go.html#2683537">lsa</a></span><span class="op" id="2683606">)</span><span class="op" id="2683607">,</span>&nbsp;<span class="ident" id="2683609">nil</span><span class="op" id="2683612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683615">return</span>&nbsp;<span class="ident" id="2683622">nil</span><br>
<span class="lineno"></span><span class="op" id="2683626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683629">func</span>&nbsp;<span class="op" id="2683634">(</span><span class="ident" id="2683635">fd</span>&nbsp;<span class="op" id="2683638">*</span><span class="ident" id="2683639"><a href="/net/fd_unix.go.html#2575420">netFD</a></span><span class="op" id="2683644">)</span>&nbsp;<span class="ident" id="2683646">listenDatagram</span><span class="op" id="2683660">(</span><span class="ident" id="2683661">laddr</span>&nbsp;<span class="ident" id="2683667"><a href="/net/sock_posix.go.html#2679308">sockaddr</a></span><span class="op" id="2683675">)</span>&nbsp;<span class="builtintype" id="2683677">error</span>&nbsp;<span class="op" id="2683683">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683686">switch</span>&nbsp;<span class="ident" id="2683693">addr</span>&nbsp;<span class="op" id="2683698">:=</span>&nbsp;<span class="ident" id="2683701"><a href="/net/sock_posix.go.html#2683661">laddr</a></span><span class="op" id="2683706">.</span><span class="op" id="2683707">(</span><span class="keyword" id="2683708">type</span><span class="op" id="2683712">)</span>&nbsp;<span class="op" id="2683714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683717">case</span>&nbsp;<span class="op" id="2683722">*</span><span class="ident" id="2683723"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="2683730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683734">//&nbsp;We&nbsp;provide&nbsp;a&nbsp;socket&nbsp;that&nbsp;listens&nbsp;to&nbsp;a&nbsp;wildcard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683786">//&nbsp;address&nbsp;with&nbsp;reusable&nbsp;UDP&nbsp;port&nbsp;when&nbsp;the&nbsp;given&nbsp;laddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683843">//&nbsp;is&nbsp;an&nbsp;appropriate&nbsp;UDP&nbsp;multicast&nbsp;address&nbsp;prefix.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683896">//&nbsp;This&nbsp;makes&nbsp;it&nbsp;possible&nbsp;for&nbsp;a&nbsp;single&nbsp;UDP&nbsp;listener&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683953">//&nbsp;join&nbsp;multiple&nbsp;different&nbsp;group&nbsp;addresses,&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2684003">//&nbsp;multiple&nbsp;UDP&nbsp;listeners&nbsp;that&nbsp;listen&nbsp;on&nbsp;the&nbsp;same&nbsp;UDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2684059">//&nbsp;port&nbsp;to&nbsp;join&nbsp;the&nbsp;same&nbsp;group&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684101">if</span>&nbsp;<span class="ident" id="2684104"><a href="/net/sock_posix.go.html#2683693">addr</a></span><span class="op" id="2684108">.</span><span class="ident" id="2684109">IP</span>&nbsp;<span class="op" id="2684112">!=</span>&nbsp;<span class="ident" id="2684115">nil</span>&nbsp;<span class="op" id="2684119">&amp;&amp;</span>&nbsp;<span class="ident" id="2684122"><a href="/net/sock_posix.go.html#2683693">addr</a></span><span class="op" id="2684126">.</span><span class="ident" id="2684127">IP</span><span class="op" id="2684129">.</span><span class="ident" id="2684130">IsMulticast</span><span class="op" id="2684141">(</span><span class="op" id="2684142">)</span>&nbsp;<span class="op" id="2684144">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684149">if</span>&nbsp;<span class="ident" id="2684152">err</span>&nbsp;<span class="op" id="2684156">:=</span>&nbsp;<span class="ident" id="2684159"><a href="/net/sockopt_linux.go.html#2685652">setDefaultMulticastSockopts</a></span><span class="op" id="2684186">(</span><span class="ident" id="2684187"><a href="/net/sock_posix.go.html#2683635">fd</a></span><span class="op" id="2684189">.</span><span class="ident" id="2684190">sysfd</span><span class="op" id="2684195">)</span><span class="op" id="2684196">;</span>&nbsp;<span class="ident" id="2684198"><a href="/net/sock_posix.go.html#2684152">err</a></span>&nbsp;<span class="op" id="2684202">!=</span>&nbsp;<span class="ident" id="2684205">nil</span>&nbsp;<span class="op" id="2684209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684215">return</span>&nbsp;<span class="ident" id="2684222"><a href="/net/sock_posix.go.html#2684152">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684234">addr</span>&nbsp;<span class="op" id="2684239">:=</span>&nbsp;<span class="op" id="2684242">*</span><span class="ident" id="2684243"><a href="/net/sock_posix.go.html#2683693">addr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684251">switch</span>&nbsp;<span class="ident" id="2684258"><a href="/net/sock_posix.go.html#2683635">fd</a></span><span class="op" id="2684260">.</span><span class="ident" id="2684261">family</span>&nbsp;<span class="op" id="2684268">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684273">case</span>&nbsp;<span class="ident" id="2684278"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2684285">.</span><span class="ident" id="2684286">AF_INET</span><span class="op" id="2684293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684299"><a href="/net/sock_posix.go.html#2684234">addr</a></span><span class="op" id="2684303">.</span><span class="ident" id="2684304">IP</span>&nbsp;<span class="op" id="2684307">=</span>&nbsp;<span class="ident" id="2684309"><a href="/net/ip.go.html#2605716">IPv4zero</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684321">case</span>&nbsp;<span class="ident" id="2684326"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2684333">.</span><span class="ident" id="2684334">AF_INET6</span><span class="op" id="2684342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684348"><a href="/net/sock_posix.go.html#2684234">addr</a></span><span class="op" id="2684352">.</span><span class="ident" id="2684353">IP</span>&nbsp;<span class="op" id="2684356">=</span>&nbsp;<span class="ident" id="2684358"><a href="/net/ip.go.html#2605890">IPv6unspecified</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684377">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684382"><a href="/net/sock_posix.go.html#2683661">laddr</a></span>&nbsp;<span class="op" id="2684388">=</span>&nbsp;<span class="op" id="2684390">&amp;</span><span class="ident" id="2684391"><a href="/net/sock_posix.go.html#2684234">addr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684404">if</span>&nbsp;<span class="ident" id="2684407">lsa</span><span class="op" id="2684410">,</span>&nbsp;<span class="ident" id="2684412">err</span>&nbsp;<span class="op" id="2684416">:=</span>&nbsp;<span class="ident" id="2684419"><a href="/net/sock_posix.go.html#2683661">laddr</a></span><span class="op" id="2684424">.</span><span class="ident" id="2684425">sockaddr</span><span class="op" id="2684433">(</span><span class="ident" id="2684434"><a href="/net/sock_posix.go.html#2683635">fd</a></span><span class="op" id="2684436">.</span><span class="ident" id="2684437">family</span><span class="op" id="2684443">)</span><span class="op" id="2684444">;</span>&nbsp;<span class="ident" id="2684446"><a href="/net/sock_posix.go.html#2684412">err</a></span>&nbsp;<span class="op" id="2684450">!=</span>&nbsp;<span class="ident" id="2684453">nil</span>&nbsp;<span class="op" id="2684457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684461">return</span>&nbsp;<span class="ident" id="2684468"><a href="/net/sock_posix.go.html#2684412">err</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684473">}</span>&nbsp;<span class="keyword" id="2684475">else</span>&nbsp;<span class="keyword" id="2684480">if</span>&nbsp;<span class="ident" id="2684483"><a href="/net/sock_posix.go.html#2684407">lsa</a></span>&nbsp;<span class="op" id="2684487">!=</span>&nbsp;<span class="ident" id="2684490">nil</span>&nbsp;<span class="op" id="2684494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684498">if</span>&nbsp;<span class="ident" id="2684501">err</span>&nbsp;<span class="op" id="2684505">:=</span>&nbsp;<span class="ident" id="2684508"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2684515">.</span><span class="ident" id="2684516">Bind</span><span class="op" id="2684520">(</span><span class="ident" id="2684521"><a href="/net/sock_posix.go.html#2683635">fd</a></span><span class="op" id="2684523">.</span><span class="ident" id="2684524">sysfd</span><span class="op" id="2684529">,</span>&nbsp;<span class="ident" id="2684531"><a href="/net/sock_posix.go.html#2684407">lsa</a></span><span class="op" id="2684534">)</span><span class="op" id="2684535">;</span>&nbsp;<span class="ident" id="2684537"><a href="/net/sock_posix.go.html#2684501">err</a></span>&nbsp;<span class="op" id="2684541">!=</span>&nbsp;<span class="ident" id="2684544">nil</span>&nbsp;<span class="op" id="2684548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684553">return</span>&nbsp;<span class="ident" id="2684560"><a href="/net/sock_posix.go.html#2679153">os</a></span><span class="op" id="2684562">.</span><span class="ident" id="2684563">NewSyscallError</span><span class="op" id="2684578">(</span><span class="string" id="2684579">&#34;bind&#34;</span><span class="op" id="2684585">,</span>&nbsp;<span class="ident" id="2684587"><a href="/net/sock_posix.go.html#2684501">err</a></span><span class="op" id="2684590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684597">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684600">if</span>&nbsp;<span class="ident" id="2684603">err</span>&nbsp;<span class="op" id="2684607">:=</span>&nbsp;<span class="ident" id="2684610"><a href="/net/sock_posix.go.html#2683635">fd</a></span><span class="op" id="2684612">.</span><span class="ident" id="2684613">init</span><span class="op" id="2684617">(</span><span class="op" id="2684618">)</span><span class="op" id="2684619">;</span>&nbsp;<span class="ident" id="2684621"><a href="/net/sock_posix.go.html#2684603">err</a></span>&nbsp;<span class="op" id="2684625">!=</span>&nbsp;<span class="ident" id="2684628">nil</span>&nbsp;<span class="op" id="2684632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684636">return</span>&nbsp;<span class="ident" id="2684643"><a href="/net/sock_posix.go.html#2684603">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684651">lsa</span><span class="op" id="2684654">,</span>&nbsp;<span class="ident" id="2684656">_</span>&nbsp;<span class="op" id="2684658">:=</span>&nbsp;<span class="ident" id="2684661"><a href="/net/sock_posix.go.html#2679159">syscall</a></span><span class="op" id="2684668">.</span><span class="ident" id="2684669">Getsockname</span><span class="op" id="2684680">(</span><span class="ident" id="2684681"><a href="/net/sock_posix.go.html#2683635">fd</a></span><span class="op" id="2684683">.</span><span class="ident" id="2684684">sysfd</span><span class="op" id="2684689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684692"><a href="/net/sock_posix.go.html#2683635">fd</a></span><span class="op" id="2684694">.</span><span class="ident" id="2684695">setAddr</span><span class="op" id="2684702">(</span><span class="ident" id="2684703"><a href="/net/sock_posix.go.html#2683635">fd</a></span><span class="op" id="2684705">.</span><span class="ident" id="2684706">addrFunc</span><span class="op" id="2684714">(</span><span class="op" id="2684715">)</span><span class="op" id="2684716">(</span><span class="ident" id="2684717"><a href="/net/sock_posix.go.html#2684651">lsa</a></span><span class="op" id="2684720">)</span><span class="op" id="2684721">,</span>&nbsp;<span class="ident" id="2684723">nil</span><span class="op" id="2684726">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684729">return</span>&nbsp;<span class="ident" id="2684736">nil</span><br>
<span class="lineno"></span><span class="op" id="2684740">}</span>
</div>
</body>
</html>
