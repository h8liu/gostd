<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2494210">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2494265">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2494319">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2494370">package</span>&nbsp;<span class="ident" id="2494378">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2494383">import</span>&nbsp;<span class="op" id="2494390">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2494393">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2494403">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2494409">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2494417">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2494423">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2494434">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2494445">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2494453">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2494468">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2494471">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="2494540">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="2494607">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="2494677">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2494712">type</span>&nbsp;<span class="ident" id="2494717">runeUnreader</span>&nbsp;<span class="keyword" id="2494730">interface</span>&nbsp;<span class="op" id="2494740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2494743">UnreadRune</span><span class="op" id="2494753">(</span><span class="op" id="2494754">)</span>&nbsp;<span class="builtintype" id="2494756">error</span><br>
<span class="lineno"></span><span class="op" id="2494762">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2494765">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="2494834">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2494898">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2494945">type</span>&nbsp;<span class="ident" id="2494950">ScanState</span>&nbsp;<span class="keyword" id="2494960">interface</span>&nbsp;<span class="op" id="2494970">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494973">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495043">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495110">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495179">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495204">ReadRune</span><span class="op" id="2495212">(</span><span class="op" id="2495213">)</span>&nbsp;<span class="op" id="2495215">(</span><span class="ident" id="2495216">r</span>&nbsp;<span class="builtintype" id="2495218">rune</span><span class="op" id="2495222">,</span>&nbsp;<span class="ident" id="2495224">size</span>&nbsp;<span class="builtintype" id="2495229">int</span><span class="op" id="2495232">,</span>&nbsp;<span class="ident" id="2495234">err</span>&nbsp;<span class="builtintype" id="2495238">error</span><span class="op" id="2495243">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495246">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495319">UnreadRune</span><span class="op" id="2495329">(</span><span class="op" id="2495330">)</span>&nbsp;<span class="builtintype" id="2495332">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495339">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495409">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495484">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495517">SkipSpace</span><span class="op" id="2495526">(</span><span class="op" id="2495527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495530">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495604">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495668">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495740">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495813">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495886">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495961">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496038">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496093">Token</span><span class="op" id="2496098">(</span><span class="ident" id="2496099">skipSpace</span>&nbsp;<span class="builtintype" id="2496109">bool</span><span class="op" id="2496113">,</span>&nbsp;<span class="ident" id="2496115">f</span>&nbsp;<span class="keyword" id="2496117">func</span><span class="op" id="2496121">(</span><span class="builtintype" id="2496122">rune</span><span class="op" id="2496126">)</span>&nbsp;<span class="builtintype" id="2496128">bool</span><span class="op" id="2496132">)</span>&nbsp;<span class="op" id="2496134">(</span><span class="ident" id="2496135">token</span>&nbsp;<span class="op" id="2496141">[</span><span class="op" id="2496142">]</span><span class="builtintype" id="2496143">byte</span><span class="op" id="2496147">,</span>&nbsp;<span class="ident" id="2496149">err</span>&nbsp;<span class="builtintype" id="2496153">error</span><span class="op" id="2496158">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496161">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496238">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496275">Width</span><span class="op" id="2496280">(</span><span class="op" id="2496281">)</span>&nbsp;<span class="op" id="2496283">(</span><span class="ident" id="2496284">wid</span>&nbsp;<span class="builtintype" id="2496288">int</span><span class="op" id="2496291">,</span>&nbsp;<span class="ident" id="2496293">ok</span>&nbsp;<span class="builtintype" id="2496296">bool</span><span class="op" id="2496300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496303">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496378">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496444">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496506">Read</span><span class="op" id="2496510">(</span><span class="ident" id="2496511">buf</span>&nbsp;<span class="op" id="2496515">[</span><span class="op" id="2496516">]</span><span class="builtintype" id="2496517">byte</span><span class="op" id="2496521">)</span>&nbsp;<span class="op" id="2496523">(</span><span class="ident" id="2496524">n</span>&nbsp;<span class="builtintype" id="2496526">int</span><span class="op" id="2496529">,</span>&nbsp;<span class="ident" id="2496531">err</span>&nbsp;<span class="builtintype" id="2496535">error</span><span class="op" id="2496540">)</span><br>
<span class="lineno"></span><span class="op" id="2496542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2496545">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="2496620">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2496696">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="2496774">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2496840">type</span>&nbsp;<span class="ident" id="2496845">Scanner</span>&nbsp;<span class="keyword" id="2496853">interface</span>&nbsp;<span class="op" id="2496863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496866">Scan</span><span class="op" id="2496870">(</span><span class="ident" id="2496871">state</span>&nbsp;<span class="ident" id="2496877">ScanState</span><span class="op" id="2496886">,</span>&nbsp;<span class="ident" id="2496888">verb</span>&nbsp;<span class="builtintype" id="2496893">rune</span><span class="op" id="2496897">)</span>&nbsp;<span class="builtintype" id="2496899">error</span><br>
<span class="lineno">65</span><span class="op" id="2496905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2496908">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2496972">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="2497041">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="2497108">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2497178">func</span>&nbsp;<span class="ident" id="2497183">Scan</span><span class="op" id="2497187">(</span><span class="ident" id="2497188">a</span>&nbsp;<span class="op" id="2497190">...</span><span class="keyword" id="2497193">interface</span><span class="op" id="2497202">{</span><span class="op" id="2497203">}</span><span class="op" id="2497204">)</span>&nbsp;<span class="op" id="2497206">(</span><span class="ident" id="2497207">n</span>&nbsp;<span class="builtintype" id="2497209">int</span><span class="op" id="2497212">,</span>&nbsp;<span class="ident" id="2497214">err</span>&nbsp;<span class="builtintype" id="2497218">error</span><span class="op" id="2497223">)</span>&nbsp;<span class="op" id="2497225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497228">return</span>&nbsp;<span class="ident" id="2497235">Fscan</span><span class="op" id="2497240">(</span><span class="ident" id="2497241">os</span><span class="op" id="2497243">.</span><span class="ident" id="2497244">Stdin</span><span class="op" id="2497249">,</span>&nbsp;<span class="ident" id="2497251">a</span><span class="op" id="2497252">...</span><span class="op" id="2497255">)</span><br>
<span class="lineno"></span><span class="op" id="2497257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2497260">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2497326">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2497382">func</span>&nbsp;<span class="ident" id="2497387">Scanln</span><span class="op" id="2497393">(</span><span class="ident" id="2497394">a</span>&nbsp;<span class="op" id="2497396">...</span><span class="keyword" id="2497399">interface</span><span class="op" id="2497408">{</span><span class="op" id="2497409">}</span><span class="op" id="2497410">)</span>&nbsp;<span class="op" id="2497412">(</span><span class="ident" id="2497413">n</span>&nbsp;<span class="builtintype" id="2497415">int</span><span class="op" id="2497418">,</span>&nbsp;<span class="ident" id="2497420">err</span>&nbsp;<span class="builtintype" id="2497424">error</span><span class="op" id="2497429">)</span>&nbsp;<span class="op" id="2497431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497434">return</span>&nbsp;<span class="ident" id="2497441">Fscanln</span><span class="op" id="2497448">(</span><span class="ident" id="2497449">os</span><span class="op" id="2497451">.</span><span class="ident" id="2497452">Stdin</span><span class="op" id="2497457">,</span>&nbsp;<span class="ident" id="2497459">a</span><span class="op" id="2497460">...</span><span class="op" id="2497463">)</span><br>
<span class="lineno"></span><span class="op" id="2497465">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2497468">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2497533">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2497602">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="2497671">func</span>&nbsp;<span class="ident" id="2497676">Scanf</span><span class="op" id="2497681">(</span><span class="ident" id="2497682">format</span>&nbsp;<span class="builtintype" id="2497689">string</span><span class="op" id="2497695">,</span>&nbsp;<span class="ident" id="2497697">a</span>&nbsp;<span class="op" id="2497699">...</span><span class="keyword" id="2497702">interface</span><span class="op" id="2497711">{</span><span class="op" id="2497712">}</span><span class="op" id="2497713">)</span>&nbsp;<span class="op" id="2497715">(</span><span class="ident" id="2497716">n</span>&nbsp;<span class="builtintype" id="2497718">int</span><span class="op" id="2497721">,</span>&nbsp;<span class="ident" id="2497723">err</span>&nbsp;<span class="builtintype" id="2497727">error</span><span class="op" id="2497732">)</span>&nbsp;<span class="op" id="2497734">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497737">return</span>&nbsp;<span class="ident" id="2497744">Fscanf</span><span class="op" id="2497750">(</span><span class="ident" id="2497751">os</span><span class="op" id="2497753">.</span><span class="ident" id="2497754">Stdin</span><span class="op" id="2497759">,</span>&nbsp;<span class="ident" id="2497761">format</span><span class="op" id="2497767">,</span>&nbsp;<span class="ident" id="2497769">a</span><span class="op" id="2497770">...</span><span class="op" id="2497773">)</span><br>
<span class="lineno"></span><span class="op" id="2497775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2497778">type</span>&nbsp;<span class="ident" id="2497783">stringReader</span>&nbsp;<span class="builtintype" id="2497796">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="2497804">func</span>&nbsp;<span class="op" id="2497809">(</span><span class="ident" id="2497810">r</span>&nbsp;<span class="op" id="2497812">*</span><span class="ident" id="2497813">stringReader</span><span class="op" id="2497825">)</span>&nbsp;<span class="ident" id="2497827">Read</span><span class="op" id="2497831">(</span><span class="ident" id="2497832">b</span>&nbsp;<span class="op" id="2497834">[</span><span class="op" id="2497835">]</span><span class="builtintype" id="2497836">byte</span><span class="op" id="2497840">)</span>&nbsp;<span class="op" id="2497842">(</span><span class="ident" id="2497843">n</span>&nbsp;<span class="builtintype" id="2497845">int</span><span class="op" id="2497848">,</span>&nbsp;<span class="ident" id="2497850">err</span>&nbsp;<span class="builtintype" id="2497854">error</span><span class="op" id="2497859">)</span>&nbsp;<span class="op" id="2497861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497864">n</span>&nbsp;<span class="op" id="2497866">=</span>&nbsp;<span class="builtinfunc" id="2497868">copy</span><span class="op" id="2497872">(</span><span class="ident" id="2497873">b</span><span class="op" id="2497874">,</span>&nbsp;<span class="op" id="2497876">*</span><span class="ident" id="2497877">r</span><span class="op" id="2497878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497881">*</span><span class="ident" id="2497882">r</span>&nbsp;<span class="op" id="2497884">=</span>&nbsp;<span class="op" id="2497886">(</span><span class="op" id="2497887">*</span><span class="ident" id="2497888">r</span><span class="op" id="2497889">)</span><span class="op" id="2497890">[</span><span class="ident" id="2497891">n</span><span class="op" id="2497892">:</span><span class="op" id="2497893">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497896">if</span>&nbsp;<span class="ident" id="2497899">n</span>&nbsp;<span class="op" id="2497901">==</span>&nbsp;<span class="num" id="2497904">0</span>&nbsp;<span class="op" id="2497906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497910">err</span>&nbsp;<span class="op" id="2497914">=</span>&nbsp;<span class="ident" id="2497916">io</span><span class="op" id="2497918">.</span><span class="ident" id="2497919">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497927">return</span><br>
<span class="lineno"></span><span class="op" id="2497934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2497937">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="2498008">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2498075">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2498145">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2498199">func</span>&nbsp;<span class="ident" id="2498204">Sscan</span><span class="op" id="2498209">(</span><span class="ident" id="2498210">str</span>&nbsp;<span class="builtintype" id="2498214">string</span><span class="op" id="2498220">,</span>&nbsp;<span class="ident" id="2498222">a</span>&nbsp;<span class="op" id="2498224">...</span><span class="keyword" id="2498227">interface</span><span class="op" id="2498236">{</span><span class="op" id="2498237">}</span><span class="op" id="2498238">)</span>&nbsp;<span class="op" id="2498240">(</span><span class="ident" id="2498241">n</span>&nbsp;<span class="builtintype" id="2498243">int</span><span class="op" id="2498246">,</span>&nbsp;<span class="ident" id="2498248">err</span>&nbsp;<span class="builtintype" id="2498252">error</span><span class="op" id="2498257">)</span>&nbsp;<span class="op" id="2498259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2498262">return</span>&nbsp;<span class="ident" id="2498269">Fscan</span><span class="op" id="2498274">(</span><span class="op" id="2498275">(</span><span class="op" id="2498276">*</span><span class="ident" id="2498277">stringReader</span><span class="op" id="2498289">)</span><span class="op" id="2498290">(</span><span class="op" id="2498291">&amp;</span><span class="ident" id="2498292">str</span><span class="op" id="2498295">)</span><span class="op" id="2498296">,</span>&nbsp;<span class="ident" id="2498298">a</span><span class="op" id="2498299">...</span><span class="op" id="2498302">)</span><br>
<span class="lineno">105</span><span class="op" id="2498304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2498307">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2498375">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2498431">func</span>&nbsp;<span class="ident" id="2498436">Sscanln</span><span class="op" id="2498443">(</span><span class="ident" id="2498444">str</span>&nbsp;<span class="builtintype" id="2498448">string</span><span class="op" id="2498454">,</span>&nbsp;<span class="ident" id="2498456">a</span>&nbsp;<span class="op" id="2498458">...</span><span class="keyword" id="2498461">interface</span><span class="op" id="2498470">{</span><span class="op" id="2498471">}</span><span class="op" id="2498472">)</span>&nbsp;<span class="op" id="2498474">(</span><span class="ident" id="2498475">n</span>&nbsp;<span class="builtintype" id="2498477">int</span><span class="op" id="2498480">,</span>&nbsp;<span class="ident" id="2498482">err</span>&nbsp;<span class="builtintype" id="2498486">error</span><span class="op" id="2498491">)</span>&nbsp;<span class="op" id="2498493">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2498496">return</span>&nbsp;<span class="ident" id="2498503">Fscanln</span><span class="op" id="2498510">(</span><span class="op" id="2498511">(</span><span class="op" id="2498512">*</span><span class="ident" id="2498513">stringReader</span><span class="op" id="2498525">)</span><span class="op" id="2498526">(</span><span class="op" id="2498527">&amp;</span><span class="ident" id="2498528">str</span><span class="op" id="2498531">)</span><span class="op" id="2498532">,</span>&nbsp;<span class="ident" id="2498534">a</span><span class="op" id="2498535">...</span><span class="op" id="2498538">)</span><br>
<span class="lineno"></span><span class="op" id="2498540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2498543">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2498615">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="2498684">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2498736">func</span>&nbsp;<span class="ident" id="2498741">Sscanf</span><span class="op" id="2498747">(</span><span class="ident" id="2498748">str</span>&nbsp;<span class="builtintype" id="2498752">string</span><span class="op" id="2498758">,</span>&nbsp;<span class="ident" id="2498760">format</span>&nbsp;<span class="builtintype" id="2498767">string</span><span class="op" id="2498773">,</span>&nbsp;<span class="ident" id="2498775">a</span>&nbsp;<span class="op" id="2498777">...</span><span class="keyword" id="2498780">interface</span><span class="op" id="2498789">{</span><span class="op" id="2498790">}</span><span class="op" id="2498791">)</span>&nbsp;<span class="op" id="2498793">(</span><span class="ident" id="2498794">n</span>&nbsp;<span class="builtintype" id="2498796">int</span><span class="op" id="2498799">,</span>&nbsp;<span class="ident" id="2498801">err</span>&nbsp;<span class="builtintype" id="2498805">error</span><span class="op" id="2498810">)</span>&nbsp;<span class="op" id="2498812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2498815">return</span>&nbsp;<span class="ident" id="2498822">Fscanf</span><span class="op" id="2498828">(</span><span class="op" id="2498829">(</span><span class="op" id="2498830">*</span><span class="ident" id="2498831">stringReader</span><span class="op" id="2498843">)</span><span class="op" id="2498844">(</span><span class="op" id="2498845">&amp;</span><span class="ident" id="2498846">str</span><span class="op" id="2498849">)</span><span class="op" id="2498850">,</span>&nbsp;<span class="ident" id="2498852">format</span><span class="op" id="2498858">,</span>&nbsp;<span class="ident" id="2498860">a</span><span class="op" id="2498861">...</span><span class="op" id="2498864">)</span><br>
<span class="lineno"></span><span class="op" id="2498866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2498869">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2498937">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2499004">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2499074">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2499128">func</span>&nbsp;<span class="ident" id="2499133">Fscan</span><span class="op" id="2499138">(</span><span class="ident" id="2499139">r</span>&nbsp;<span class="ident" id="2499141">io</span><span class="op" id="2499143">.</span><span class="ident" id="2499144">Reader</span><span class="op" id="2499150">,</span>&nbsp;<span class="ident" id="2499152">a</span>&nbsp;<span class="op" id="2499154">...</span><span class="keyword" id="2499157">interface</span><span class="op" id="2499166">{</span><span class="op" id="2499167">}</span><span class="op" id="2499168">)</span>&nbsp;<span class="op" id="2499170">(</span><span class="ident" id="2499171">n</span>&nbsp;<span class="builtintype" id="2499173">int</span><span class="op" id="2499176">,</span>&nbsp;<span class="ident" id="2499178">err</span>&nbsp;<span class="builtintype" id="2499182">error</span><span class="op" id="2499187">)</span>&nbsp;<span class="op" id="2499189">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499192">s</span><span class="op" id="2499193">,</span>&nbsp;<span class="ident" id="2499195">old</span>&nbsp;<span class="op" id="2499199">:=</span>&nbsp;<span class="ident" id="2499202">newScanState</span><span class="op" id="2499214">(</span><span class="ident" id="2499215">r</span><span class="op" id="2499216">,</span>&nbsp;<span class="builtintype" id="2499218">true</span><span class="op" id="2499222">,</span>&nbsp;<span class="builtintype" id="2499224">false</span><span class="op" id="2499229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499232">n</span><span class="op" id="2499233">,</span>&nbsp;<span class="ident" id="2499235">err</span>&nbsp;<span class="op" id="2499239">=</span>&nbsp;<span class="ident" id="2499241">s</span><span class="op" id="2499242">.</span><span class="ident" id="2499243">doScan</span><span class="op" id="2499249">(</span><span class="ident" id="2499250">a</span><span class="op" id="2499251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499254">s</span><span class="op" id="2499255">.</span><span class="ident" id="2499256">free</span><span class="op" id="2499260">(</span><span class="ident" id="2499261">old</span><span class="op" id="2499264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2499267">return</span><br>
<span class="lineno"></span><span class="op" id="2499274">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2499277">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2499345">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2499401">func</span>&nbsp;<span class="ident" id="2499406">Fscanln</span><span class="op" id="2499413">(</span><span class="ident" id="2499414">r</span>&nbsp;<span class="ident" id="2499416">io</span><span class="op" id="2499418">.</span><span class="ident" id="2499419">Reader</span><span class="op" id="2499425">,</span>&nbsp;<span class="ident" id="2499427">a</span>&nbsp;<span class="op" id="2499429">...</span><span class="keyword" id="2499432">interface</span><span class="op" id="2499441">{</span><span class="op" id="2499442">}</span><span class="op" id="2499443">)</span>&nbsp;<span class="op" id="2499445">(</span><span class="ident" id="2499446">n</span>&nbsp;<span class="builtintype" id="2499448">int</span><span class="op" id="2499451">,</span>&nbsp;<span class="ident" id="2499453">err</span>&nbsp;<span class="builtintype" id="2499457">error</span><span class="op" id="2499462">)</span>&nbsp;<span class="op" id="2499464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499467">s</span><span class="op" id="2499468">,</span>&nbsp;<span class="ident" id="2499470">old</span>&nbsp;<span class="op" id="2499474">:=</span>&nbsp;<span class="ident" id="2499477">newScanState</span><span class="op" id="2499489">(</span><span class="ident" id="2499490">r</span><span class="op" id="2499491">,</span>&nbsp;<span class="builtintype" id="2499493">false</span><span class="op" id="2499498">,</span>&nbsp;<span class="builtintype" id="2499500">true</span><span class="op" id="2499504">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499507">n</span><span class="op" id="2499508">,</span>&nbsp;<span class="ident" id="2499510">err</span>&nbsp;<span class="op" id="2499514">=</span>&nbsp;<span class="ident" id="2499516">s</span><span class="op" id="2499517">.</span><span class="ident" id="2499518">doScan</span><span class="op" id="2499524">(</span><span class="ident" id="2499525">a</span><span class="op" id="2499526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499529">s</span><span class="op" id="2499530">.</span><span class="ident" id="2499531">free</span><span class="op" id="2499535">(</span><span class="ident" id="2499536">old</span><span class="op" id="2499539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2499542">return</span><br>
<span class="lineno"></span><span class="op" id="2499549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2499552">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2499621">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2499690">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2499742">func</span>&nbsp;<span class="ident" id="2499747">Fscanf</span><span class="op" id="2499753">(</span><span class="ident" id="2499754">r</span>&nbsp;<span class="ident" id="2499756">io</span><span class="op" id="2499758">.</span><span class="ident" id="2499759">Reader</span><span class="op" id="2499765">,</span>&nbsp;<span class="ident" id="2499767">format</span>&nbsp;<span class="builtintype" id="2499774">string</span><span class="op" id="2499780">,</span>&nbsp;<span class="ident" id="2499782">a</span>&nbsp;<span class="op" id="2499784">...</span><span class="keyword" id="2499787">interface</span><span class="op" id="2499796">{</span><span class="op" id="2499797">}</span><span class="op" id="2499798">)</span>&nbsp;<span class="op" id="2499800">(</span><span class="ident" id="2499801">n</span>&nbsp;<span class="builtintype" id="2499803">int</span><span class="op" id="2499806">,</span>&nbsp;<span class="ident" id="2499808">err</span>&nbsp;<span class="builtintype" id="2499812">error</span><span class="op" id="2499817">)</span>&nbsp;<span class="op" id="2499819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499822">s</span><span class="op" id="2499823">,</span>&nbsp;<span class="ident" id="2499825">old</span>&nbsp;<span class="op" id="2499829">:=</span>&nbsp;<span class="ident" id="2499832">newScanState</span><span class="op" id="2499844">(</span><span class="ident" id="2499845">r</span><span class="op" id="2499846">,</span>&nbsp;<span class="builtintype" id="2499848">false</span><span class="op" id="2499853">,</span>&nbsp;<span class="builtintype" id="2499855">false</span><span class="op" id="2499860">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499863">n</span><span class="op" id="2499864">,</span>&nbsp;<span class="ident" id="2499866">err</span>&nbsp;<span class="op" id="2499870">=</span>&nbsp;<span class="ident" id="2499872">s</span><span class="op" id="2499873">.</span><span class="ident" id="2499874">doScanf</span><span class="op" id="2499881">(</span><span class="ident" id="2499882">format</span><span class="op" id="2499888">,</span>&nbsp;<span class="ident" id="2499890">a</span><span class="op" id="2499891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499894">s</span><span class="op" id="2499895">.</span><span class="ident" id="2499896">free</span><span class="op" id="2499900">(</span><span class="ident" id="2499901">old</span><span class="op" id="2499904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2499907">return</span><br>
<span class="lineno"></span><span class="op" id="2499914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2499917">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="2499986">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="2500062">type</span>&nbsp;<span class="ident" id="2500067">scanError</span>&nbsp;<span class="keyword" id="2500077">struct</span>&nbsp;<span class="op" id="2500084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500087">err</span>&nbsp;<span class="builtintype" id="2500091">error</span><br>
<span class="lineno"></span><span class="op" id="2500097">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="2500100">const</span>&nbsp;<span class="ident" id="2500106">eof</span>&nbsp;<span class="op" id="2500110">=</span>&nbsp;<span class="op" id="2500112">-</span><span class="num" id="2500113">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2500116">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="2500167">type</span>&nbsp;<span class="ident" id="2500172">ss</span>&nbsp;<span class="keyword" id="2500175">struct</span>&nbsp;<span class="op" id="2500182">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500185">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500194">io</span><span class="op" id="2500196">.</span><span class="ident" id="2500197">RuneReader</span>&nbsp;<span class="comment" id="2500208">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500232">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500241">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2500255">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500277">peekRune</span>&nbsp;<span class="builtintype" id="2500286">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2500300">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500323">prevRune</span>&nbsp;<span class="builtintype" id="2500332">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2500346">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500381">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2500390">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2500404">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500431">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2500440">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2500454">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500475">ssave</span><br>
<span class="lineno"></span><span class="op" id="2500481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2500484">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="2500531">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="2500573">type</span>&nbsp;<span class="ident" id="2500578">ssave</span>&nbsp;<span class="keyword" id="2500584">struct</span>&nbsp;<span class="op" id="2500591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500594">validSave</span>&nbsp;<span class="builtintype" id="2500604">bool</span>&nbsp;<span class="comment" id="2500609">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500647">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2500657">bool</span>&nbsp;<span class="comment" id="2500662">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500698">nlIsSpace</span>&nbsp;<span class="builtintype" id="2500708">bool</span>&nbsp;<span class="comment" id="2500713">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500755">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="2500765">int</span>&nbsp;&nbsp;<span class="comment" id="2500770">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500828">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2500838">int</span>&nbsp;&nbsp;<span class="comment" id="2500843">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500870">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2500880">int</span>&nbsp;&nbsp;<span class="comment" id="2500885">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="2500907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2500910">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2500968">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2501029">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="2501088">func</span>&nbsp;<span class="op" id="2501093">(</span><span class="ident" id="2501094">s</span>&nbsp;<span class="op" id="2501096">*</span><span class="ident" id="2501097">ss</span><span class="op" id="2501099">)</span>&nbsp;<span class="ident" id="2501101">Read</span><span class="op" id="2501105">(</span><span class="ident" id="2501106">buf</span>&nbsp;<span class="op" id="2501110">[</span><span class="op" id="2501111">]</span><span class="builtintype" id="2501112">byte</span><span class="op" id="2501116">)</span>&nbsp;<span class="op" id="2501118">(</span><span class="ident" id="2501119">n</span>&nbsp;<span class="builtintype" id="2501121">int</span><span class="op" id="2501124">,</span>&nbsp;<span class="ident" id="2501126">err</span>&nbsp;<span class="builtintype" id="2501130">error</span><span class="op" id="2501135">)</span>&nbsp;<span class="op" id="2501137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501140">return</span>&nbsp;<span class="num" id="2501147">0</span><span class="op" id="2501148">,</span>&nbsp;<span class="ident" id="2501150">errors</span><span class="op" id="2501156">.</span><span class="ident" id="2501157">New</span><span class="op" id="2501160">(</span><span class="string" id="2501161">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="2501214">)</span><br>
<span class="lineno">185</span><span class="op" id="2501216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2501219">func</span>&nbsp;<span class="op" id="2501224">(</span><span class="ident" id="2501225">s</span>&nbsp;<span class="op" id="2501227">*</span><span class="ident" id="2501228">ss</span><span class="op" id="2501230">)</span>&nbsp;<span class="ident" id="2501232">ReadRune</span><span class="op" id="2501240">(</span><span class="op" id="2501241">)</span>&nbsp;<span class="op" id="2501243">(</span><span class="ident" id="2501244">r</span>&nbsp;<span class="builtintype" id="2501246">rune</span><span class="op" id="2501250">,</span>&nbsp;<span class="ident" id="2501252">size</span>&nbsp;<span class="builtintype" id="2501257">int</span><span class="op" id="2501260">,</span>&nbsp;<span class="ident" id="2501262">err</span>&nbsp;<span class="builtintype" id="2501266">error</span><span class="op" id="2501271">)</span>&nbsp;<span class="op" id="2501273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501276">if</span>&nbsp;<span class="ident" id="2501279">s</span><span class="op" id="2501280">.</span><span class="ident" id="2501281">peekRune</span>&nbsp;<span class="op" id="2501290">&gt;=</span>&nbsp;<span class="num" id="2501293">0</span>&nbsp;<span class="op" id="2501295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501299">s</span><span class="op" id="2501300">.</span><span class="ident" id="2501301">count</span><span class="op" id="2501306">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501311">r</span>&nbsp;<span class="op" id="2501313">=</span>&nbsp;<span class="ident" id="2501315">s</span><span class="op" id="2501316">.</span><span class="ident" id="2501317">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501328">size</span>&nbsp;<span class="op" id="2501333">=</span>&nbsp;<span class="ident" id="2501335">utf8</span><span class="op" id="2501339">.</span><span class="ident" id="2501340">RuneLen</span><span class="op" id="2501347">(</span><span class="ident" id="2501348">r</span><span class="op" id="2501349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501353">s</span><span class="op" id="2501354">.</span><span class="ident" id="2501355">prevRune</span>&nbsp;<span class="op" id="2501364">=</span>&nbsp;<span class="ident" id="2501366">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501370">s</span><span class="op" id="2501371">.</span><span class="ident" id="2501372">peekRune</span>&nbsp;<span class="op" id="2501381">=</span>&nbsp;<span class="op" id="2501383">-</span><span class="num" id="2501384">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501388">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501399">if</span>&nbsp;<span class="ident" id="2501402">s</span><span class="op" id="2501403">.</span><span class="ident" id="2501404">atEOF</span>&nbsp;<span class="op" id="2501410">||</span>&nbsp;<span class="ident" id="2501413">s</span><span class="op" id="2501414">.</span><span class="ident" id="2501415">nlIsEnd</span>&nbsp;<span class="op" id="2501423">&amp;&amp;</span>&nbsp;<span class="ident" id="2501426">s</span><span class="op" id="2501427">.</span><span class="ident" id="2501428">prevRune</span>&nbsp;<span class="op" id="2501437">==</span>&nbsp;<span class="string" id="2501440">&#39;\n&#39;</span>&nbsp;<span class="op" id="2501445">||</span>&nbsp;<span class="ident" id="2501448">s</span><span class="op" id="2501449">.</span><span class="ident" id="2501450">count</span>&nbsp;<span class="op" id="2501456">&gt;=</span>&nbsp;<span class="ident" id="2501459">s</span><span class="op" id="2501460">.</span><span class="ident" id="2501461">argLimit</span>&nbsp;<span class="op" id="2501470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501474">err</span>&nbsp;<span class="op" id="2501478">=</span>&nbsp;<span class="ident" id="2501480">io</span><span class="op" id="2501482">.</span><span class="ident" id="2501483">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501489">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501497">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501501">r</span><span class="op" id="2501502">,</span>&nbsp;<span class="ident" id="2501504">size</span><span class="op" id="2501508">,</span>&nbsp;<span class="ident" id="2501510">err</span>&nbsp;<span class="op" id="2501514">=</span>&nbsp;<span class="ident" id="2501516">s</span><span class="op" id="2501517">.</span><span class="ident" id="2501518">rr</span><span class="op" id="2501520">.</span><span class="ident" id="2501521">ReadRune</span><span class="op" id="2501529">(</span><span class="op" id="2501530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501533">if</span>&nbsp;<span class="ident" id="2501536">err</span>&nbsp;<span class="op" id="2501540">==</span>&nbsp;<span class="ident" id="2501543">nil</span>&nbsp;<span class="op" id="2501547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501551">s</span><span class="op" id="2501552">.</span><span class="ident" id="2501553">count</span><span class="op" id="2501558">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501563">s</span><span class="op" id="2501564">.</span><span class="ident" id="2501565">prevRune</span>&nbsp;<span class="op" id="2501574">=</span>&nbsp;<span class="ident" id="2501576">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501579">}</span>&nbsp;<span class="keyword" id="2501581">else</span>&nbsp;<span class="keyword" id="2501586">if</span>&nbsp;<span class="ident" id="2501589">err</span>&nbsp;<span class="op" id="2501593">==</span>&nbsp;<span class="ident" id="2501596">io</span><span class="op" id="2501598">.</span><span class="ident" id="2501599">EOF</span>&nbsp;<span class="op" id="2501603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501607">s</span><span class="op" id="2501608">.</span><span class="ident" id="2501609">atEOF</span>&nbsp;<span class="op" id="2501615">=</span>&nbsp;<span class="builtintype" id="2501617">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501626">return</span><br>
<span class="lineno"></span><span class="op" id="2501633">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="2501636">func</span>&nbsp;<span class="op" id="2501641">(</span><span class="ident" id="2501642">s</span>&nbsp;<span class="op" id="2501644">*</span><span class="ident" id="2501645">ss</span><span class="op" id="2501647">)</span>&nbsp;<span class="ident" id="2501649">Width</span><span class="op" id="2501654">(</span><span class="op" id="2501655">)</span>&nbsp;<span class="op" id="2501657">(</span><span class="ident" id="2501658">wid</span>&nbsp;<span class="builtintype" id="2501662">int</span><span class="op" id="2501665">,</span>&nbsp;<span class="ident" id="2501667">ok</span>&nbsp;<span class="builtintype" id="2501670">bool</span><span class="op" id="2501674">)</span>&nbsp;<span class="op" id="2501676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501679">if</span>&nbsp;<span class="ident" id="2501682">s</span><span class="op" id="2501683">.</span><span class="ident" id="2501684">maxWid</span>&nbsp;<span class="op" id="2501691">==</span>&nbsp;<span class="ident" id="2501694">hugeWid</span>&nbsp;<span class="op" id="2501702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501706">return</span>&nbsp;<span class="num" id="2501713">0</span><span class="op" id="2501714">,</span>&nbsp;<span class="builtintype" id="2501716">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501723">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501726">return</span>&nbsp;<span class="ident" id="2501733">s</span><span class="op" id="2501734">.</span><span class="ident" id="2501735">maxWid</span><span class="op" id="2501741">,</span>&nbsp;<span class="builtintype" id="2501743">true</span><br>
<span class="lineno"></span><span class="op" id="2501748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2501751">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2501815">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="2501872">func</span>&nbsp;<span class="op" id="2501877">(</span><span class="ident" id="2501878">s</span>&nbsp;<span class="op" id="2501880">*</span><span class="ident" id="2501881">ss</span><span class="op" id="2501883">)</span>&nbsp;<span class="ident" id="2501885">getRune</span><span class="op" id="2501892">(</span><span class="op" id="2501893">)</span>&nbsp;<span class="op" id="2501895">(</span><span class="ident" id="2501896">r</span>&nbsp;<span class="builtintype" id="2501898">rune</span><span class="op" id="2501902">)</span>&nbsp;<span class="op" id="2501904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501907">r</span><span class="op" id="2501908">,</span>&nbsp;<span class="ident" id="2501910">_</span><span class="op" id="2501911">,</span>&nbsp;<span class="ident" id="2501913">err</span>&nbsp;<span class="op" id="2501917">:=</span>&nbsp;<span class="ident" id="2501920">s</span><span class="op" id="2501921">.</span><span class="ident" id="2501922">ReadRune</span><span class="op" id="2501930">(</span><span class="op" id="2501931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501934">if</span>&nbsp;<span class="ident" id="2501937">err</span>&nbsp;<span class="op" id="2501941">!=</span>&nbsp;<span class="ident" id="2501944">nil</span>&nbsp;<span class="op" id="2501948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501952">if</span>&nbsp;<span class="ident" id="2501955">err</span>&nbsp;<span class="op" id="2501959">==</span>&nbsp;<span class="ident" id="2501962">io</span><span class="op" id="2501964">.</span><span class="ident" id="2501965">EOF</span>&nbsp;<span class="op" id="2501969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501974">return</span>&nbsp;<span class="ident" id="2501981">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501991">s</span><span class="op" id="2501992">.</span><span class="builtintype" id="2501993">error</span><span class="op" id="2501998">(</span><span class="ident" id="2501999">err</span><span class="op" id="2502002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502008">return</span><br>
<span class="lineno"></span><span class="op" id="2502015">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2502018">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="2502082">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2502149">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2502166">func</span>&nbsp;<span class="op" id="2502171">(</span><span class="ident" id="2502172">s</span>&nbsp;<span class="op" id="2502174">*</span><span class="ident" id="2502175">ss</span><span class="op" id="2502177">)</span>&nbsp;<span class="ident" id="2502179">mustReadRune</span><span class="op" id="2502191">(</span><span class="op" id="2502192">)</span>&nbsp;<span class="op" id="2502194">(</span><span class="ident" id="2502195">r</span>&nbsp;<span class="builtintype" id="2502197">rune</span><span class="op" id="2502201">)</span>&nbsp;<span class="op" id="2502203">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502206">r</span>&nbsp;<span class="op" id="2502208">=</span>&nbsp;<span class="ident" id="2502210">s</span><span class="op" id="2502211">.</span><span class="ident" id="2502212">getRune</span><span class="op" id="2502219">(</span><span class="op" id="2502220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502223">if</span>&nbsp;<span class="ident" id="2502226">r</span>&nbsp;<span class="op" id="2502228">==</span>&nbsp;<span class="ident" id="2502231">eof</span>&nbsp;<span class="op" id="2502235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502239">s</span><span class="op" id="2502240">.</span><span class="builtintype" id="2502241">error</span><span class="op" id="2502246">(</span><span class="ident" id="2502247">io</span><span class="op" id="2502249">.</span><span class="ident" id="2502250">ErrUnexpectedEOF</span><span class="op" id="2502266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502272">return</span><br>
<span class="lineno">240</span><span class="op" id="2502279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2502282">func</span>&nbsp;<span class="op" id="2502287">(</span><span class="ident" id="2502288">s</span>&nbsp;<span class="op" id="2502290">*</span><span class="ident" id="2502291">ss</span><span class="op" id="2502293">)</span>&nbsp;<span class="ident" id="2502295">UnreadRune</span><span class="op" id="2502305">(</span><span class="op" id="2502306">)</span>&nbsp;<span class="builtintype" id="2502308">error</span>&nbsp;<span class="op" id="2502314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502317">if</span>&nbsp;<span class="ident" id="2502320">u</span><span class="op" id="2502321">,</span>&nbsp;<span class="ident" id="2502323">ok</span>&nbsp;<span class="op" id="2502326">:=</span>&nbsp;<span class="ident" id="2502329">s</span><span class="op" id="2502330">.</span><span class="ident" id="2502331">rr</span><span class="op" id="2502333">.</span><span class="op" id="2502334">(</span><span class="ident" id="2502335">runeUnreader</span><span class="op" id="2502347">)</span><span class="op" id="2502348">;</span>&nbsp;<span class="ident" id="2502350">ok</span>&nbsp;<span class="op" id="2502353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502357">u</span><span class="op" id="2502358">.</span><span class="ident" id="2502359">UnreadRune</span><span class="op" id="2502369">(</span><span class="op" id="2502370">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502373">}</span>&nbsp;<span class="keyword" id="2502375">else</span>&nbsp;<span class="op" id="2502380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502384">s</span><span class="op" id="2502385">.</span><span class="ident" id="2502386">peekRune</span>&nbsp;<span class="op" id="2502395">=</span>&nbsp;<span class="ident" id="2502397">s</span><span class="op" id="2502398">.</span><span class="ident" id="2502399">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502412">s</span><span class="op" id="2502413">.</span><span class="ident" id="2502414">prevRune</span>&nbsp;<span class="op" id="2502423">=</span>&nbsp;<span class="op" id="2502425">-</span><span class="num" id="2502426">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502429">s</span><span class="op" id="2502430">.</span><span class="ident" id="2502431">count</span><span class="op" id="2502436">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502440">return</span>&nbsp;<span class="ident" id="2502447">nil</span><br>
<span class="lineno"></span><span class="op" id="2502451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2502454">func</span>&nbsp;<span class="op" id="2502459">(</span><span class="ident" id="2502460">s</span>&nbsp;<span class="op" id="2502462">*</span><span class="ident" id="2502463">ss</span><span class="op" id="2502465">)</span>&nbsp;<span class="builtintype" id="2502467">error</span><span class="op" id="2502472">(</span><span class="ident" id="2502473">err</span>&nbsp;<span class="builtintype" id="2502477">error</span><span class="op" id="2502482">)</span>&nbsp;<span class="op" id="2502484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2502487">panic</span><span class="op" id="2502492">(</span><span class="ident" id="2502493">scanError</span><span class="op" id="2502502">{</span><span class="ident" id="2502503">err</span><span class="op" id="2502506">}</span><span class="op" id="2502507">)</span><br>
<span class="lineno">255</span><span class="op" id="2502509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2502512">func</span>&nbsp;<span class="op" id="2502517">(</span><span class="ident" id="2502518">s</span>&nbsp;<span class="op" id="2502520">*</span><span class="ident" id="2502521">ss</span><span class="op" id="2502523">)</span>&nbsp;<span class="ident" id="2502525">errorString</span><span class="op" id="2502536">(</span><span class="ident" id="2502537">err</span>&nbsp;<span class="builtintype" id="2502541">string</span><span class="op" id="2502547">)</span>&nbsp;<span class="op" id="2502549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2502552">panic</span><span class="op" id="2502557">(</span><span class="ident" id="2502558">scanError</span><span class="op" id="2502567">{</span><span class="ident" id="2502568">errors</span><span class="op" id="2502574">.</span><span class="ident" id="2502575">New</span><span class="op" id="2502578">(</span><span class="ident" id="2502579">err</span><span class="op" id="2502582">)</span><span class="op" id="2502583">}</span><span class="op" id="2502584">)</span><br>
<span class="lineno"></span><span class="op" id="2502586">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="2502589">func</span>&nbsp;<span class="op" id="2502594">(</span><span class="ident" id="2502595">s</span>&nbsp;<span class="op" id="2502597">*</span><span class="ident" id="2502598">ss</span><span class="op" id="2502600">)</span>&nbsp;<span class="ident" id="2502602">Token</span><span class="op" id="2502607">(</span><span class="ident" id="2502608">skipSpace</span>&nbsp;<span class="builtintype" id="2502618">bool</span><span class="op" id="2502622">,</span>&nbsp;<span class="ident" id="2502624">f</span>&nbsp;<span class="keyword" id="2502626">func</span><span class="op" id="2502630">(</span><span class="builtintype" id="2502631">rune</span><span class="op" id="2502635">)</span>&nbsp;<span class="builtintype" id="2502637">bool</span><span class="op" id="2502641">)</span>&nbsp;<span class="op" id="2502643">(</span><span class="ident" id="2502644">tok</span>&nbsp;<span class="op" id="2502648">[</span><span class="op" id="2502649">]</span><span class="builtintype" id="2502650">byte</span><span class="op" id="2502654">,</span>&nbsp;<span class="ident" id="2502656">err</span>&nbsp;<span class="builtintype" id="2502660">error</span><span class="op" id="2502665">)</span>&nbsp;<span class="op" id="2502667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502670">defer</span>&nbsp;<span class="keyword" id="2502676">func</span><span class="op" id="2502680">(</span><span class="op" id="2502681">)</span>&nbsp;<span class="op" id="2502683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502687">if</span>&nbsp;<span class="ident" id="2502690">e</span>&nbsp;<span class="op" id="2502692">:=</span>&nbsp;<span class="builtinfunc" id="2502695">recover</span><span class="op" id="2502702">(</span><span class="op" id="2502703">)</span><span class="op" id="2502704">;</span>&nbsp;<span class="ident" id="2502706">e</span>&nbsp;<span class="op" id="2502708">!=</span>&nbsp;<span class="ident" id="2502711">nil</span>&nbsp;<span class="op" id="2502715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502720">if</span>&nbsp;<span class="ident" id="2502723">se</span><span class="op" id="2502725">,</span>&nbsp;<span class="ident" id="2502727">ok</span>&nbsp;<span class="op" id="2502730">:=</span>&nbsp;<span class="ident" id="2502733">e</span><span class="op" id="2502734">.</span><span class="op" id="2502735">(</span><span class="ident" id="2502736">scanError</span><span class="op" id="2502745">)</span><span class="op" id="2502746">;</span>&nbsp;<span class="ident" id="2502748">ok</span>&nbsp;<span class="op" id="2502751">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502757">err</span>&nbsp;<span class="op" id="2502761">=</span>&nbsp;<span class="ident" id="2502763">se</span><span class="op" id="2502765">.</span><span class="ident" id="2502766">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502773">}</span>&nbsp;<span class="keyword" id="2502775">else</span>&nbsp;<span class="op" id="2502780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2502786">panic</span><span class="op" id="2502791">(</span><span class="ident" id="2502792">e</span><span class="op" id="2502793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502802">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502805">}</span><span class="op" id="2502806">(</span><span class="op" id="2502807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502810">if</span>&nbsp;<span class="ident" id="2502813">f</span>&nbsp;<span class="op" id="2502815">==</span>&nbsp;<span class="ident" id="2502818">nil</span>&nbsp;<span class="op" id="2502822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502826">f</span>&nbsp;<span class="op" id="2502828">=</span>&nbsp;<span class="ident" id="2502830">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502843">s</span><span class="op" id="2502844">.</span><span class="ident" id="2502845">buf</span>&nbsp;<span class="op" id="2502849">=</span>&nbsp;<span class="ident" id="2502851">s</span><span class="op" id="2502852">.</span><span class="ident" id="2502853">buf</span><span class="op" id="2502856">[</span><span class="op" id="2502857">:</span><span class="num" id="2502858">0</span><span class="op" id="2502859">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502862">tok</span>&nbsp;<span class="op" id="2502866">=</span>&nbsp;<span class="ident" id="2502868">s</span><span class="op" id="2502869">.</span><span class="ident" id="2502870">token</span><span class="op" id="2502875">(</span><span class="ident" id="2502876">skipSpace</span><span class="op" id="2502885">,</span>&nbsp;<span class="ident" id="2502887">f</span><span class="op" id="2502888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502891">return</span><br>
<span class="lineno"></span><span class="op" id="2502898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2502901">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="2502955">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2502997">var</span>&nbsp;<span class="ident" id="2503001">space</span>&nbsp;<span class="op" id="2503007">=</span>&nbsp;<span class="op" id="2503009">[</span><span class="op" id="2503010">]</span><span class="op" id="2503011">[</span><span class="num" id="2503012">2</span><span class="op" id="2503013">]</span><span class="builtintype" id="2503014">uint16</span><span class="op" id="2503020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503023">{</span><span class="num" id="2503024">0x0009</span><span class="op" id="2503030">,</span>&nbsp;<span class="num" id="2503032">0x000d</span><span class="op" id="2503038">}</span><span class="op" id="2503039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503042">{</span><span class="num" id="2503043">0x0020</span><span class="op" id="2503049">,</span>&nbsp;<span class="num" id="2503051">0x0020</span><span class="op" id="2503057">}</span><span class="op" id="2503058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503061">{</span><span class="num" id="2503062">0x0085</span><span class="op" id="2503068">,</span>&nbsp;<span class="num" id="2503070">0x0085</span><span class="op" id="2503076">}</span><span class="op" id="2503077">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503080">{</span><span class="num" id="2503081">0x00a0</span><span class="op" id="2503087">,</span>&nbsp;<span class="num" id="2503089">0x00a0</span><span class="op" id="2503095">}</span><span class="op" id="2503096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503099">{</span><span class="num" id="2503100">0x1680</span><span class="op" id="2503106">,</span>&nbsp;<span class="num" id="2503108">0x1680</span><span class="op" id="2503114">}</span><span class="op" id="2503115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503118">{</span><span class="num" id="2503119">0x2000</span><span class="op" id="2503125">,</span>&nbsp;<span class="num" id="2503127">0x200a</span><span class="op" id="2503133">}</span><span class="op" id="2503134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503137">{</span><span class="num" id="2503138">0x2028</span><span class="op" id="2503144">,</span>&nbsp;<span class="num" id="2503146">0x2029</span><span class="op" id="2503152">}</span><span class="op" id="2503153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503156">{</span><span class="num" id="2503157">0x202f</span><span class="op" id="2503163">,</span>&nbsp;<span class="num" id="2503165">0x202f</span><span class="op" id="2503171">}</span><span class="op" id="2503172">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503175">{</span><span class="num" id="2503176">0x205f</span><span class="op" id="2503182">,</span>&nbsp;<span class="num" id="2503184">0x205f</span><span class="op" id="2503190">}</span><span class="op" id="2503191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503194">{</span><span class="num" id="2503195">0x3000</span><span class="op" id="2503201">,</span>&nbsp;<span class="num" id="2503203">0x3000</span><span class="op" id="2503209">}</span><span class="op" id="2503210">,</span><br>
<span class="lineno"></span><span class="op" id="2503212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2503215">func</span>&nbsp;<span class="ident" id="2503220">isSpace</span><span class="op" id="2503227">(</span><span class="ident" id="2503228">r</span>&nbsp;<span class="builtintype" id="2503230">rune</span><span class="op" id="2503234">)</span>&nbsp;<span class="builtintype" id="2503236">bool</span>&nbsp;<span class="op" id="2503241">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503244">if</span>&nbsp;<span class="ident" id="2503247">r</span>&nbsp;<span class="op" id="2503249">&gt;=</span>&nbsp;<span class="num" id="2503252">1</span><span class="op" id="2503253">&lt;&lt;</span><span class="num" id="2503255">16</span>&nbsp;<span class="op" id="2503258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503262">return</span>&nbsp;<span class="builtintype" id="2503269">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503279">rx</span>&nbsp;<span class="op" id="2503282">:=</span>&nbsp;<span class="builtintype" id="2503285">uint16</span><span class="op" id="2503291">(</span><span class="ident" id="2503292">r</span><span class="op" id="2503293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503296">for</span>&nbsp;<span class="ident" id="2503300">_</span><span class="op" id="2503301">,</span>&nbsp;<span class="ident" id="2503303">rng</span>&nbsp;<span class="op" id="2503307">:=</span>&nbsp;<span class="keyword" id="2503310">range</span>&nbsp;<span class="ident" id="2503316">space</span>&nbsp;<span class="op" id="2503322">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503326">if</span>&nbsp;<span class="ident" id="2503329">rx</span>&nbsp;<span class="op" id="2503332">&lt;</span>&nbsp;<span class="ident" id="2503334">rng</span><span class="op" id="2503337">[</span><span class="num" id="2503338">0</span><span class="op" id="2503339">]</span>&nbsp;<span class="op" id="2503341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503346">return</span>&nbsp;<span class="builtintype" id="2503353">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503365">if</span>&nbsp;<span class="ident" id="2503368">rx</span>&nbsp;<span class="op" id="2503371">&lt;=</span>&nbsp;<span class="ident" id="2503374">rng</span><span class="op" id="2503377">[</span><span class="num" id="2503378">1</span><span class="op" id="2503379">]</span>&nbsp;<span class="op" id="2503381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503386">return</span>&nbsp;<span class="builtintype" id="2503393">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503406">return</span>&nbsp;<span class="builtintype" id="2503413">false</span><br>
<span class="lineno"></span><span class="op" id="2503419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2503422">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="2503482">func</span>&nbsp;<span class="ident" id="2503487">notSpace</span><span class="op" id="2503495">(</span><span class="ident" id="2503496">r</span>&nbsp;<span class="builtintype" id="2503498">rune</span><span class="op" id="2503502">)</span>&nbsp;<span class="builtintype" id="2503504">bool</span>&nbsp;<span class="op" id="2503509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503512">return</span>&nbsp;<span class="op" id="2503519">!</span><span class="ident" id="2503520">isSpace</span><span class="op" id="2503527">(</span><span class="ident" id="2503528">r</span><span class="op" id="2503529">)</span><br>
<span class="lineno"></span><span class="op" id="2503531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2503534">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2503607">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2503685">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="2503705">func</span>&nbsp;<span class="op" id="2503710">(</span><span class="ident" id="2503711">s</span>&nbsp;<span class="op" id="2503713">*</span><span class="ident" id="2503714">ss</span><span class="op" id="2503716">)</span>&nbsp;<span class="ident" id="2503718">SkipSpace</span><span class="op" id="2503727">(</span><span class="op" id="2503728">)</span>&nbsp;<span class="op" id="2503730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503733">s</span><span class="op" id="2503734">.</span><span class="ident" id="2503735">skipSpace</span><span class="op" id="2503744">(</span><span class="builtintype" id="2503745">false</span><span class="op" id="2503750">)</span><br>
<span class="lineno">320</span><span class="op" id="2503752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2503755">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2503826">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2503900">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="2503940">type</span>&nbsp;<span class="ident" id="2503945">readRune</span>&nbsp;<span class="keyword" id="2503954">struct</span>&nbsp;<span class="op" id="2503961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503964">reader</span>&nbsp;&nbsp;<span class="ident" id="2503972">io</span><span class="op" id="2503974">.</span><span class="ident" id="2503975">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503983">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2503991">[</span><span class="ident" id="2503992">utf8</span><span class="op" id="2503996">.</span><span class="ident" id="2503997">UTFMax</span><span class="op" id="2504003">]</span><span class="builtintype" id="2504004">byte</span>&nbsp;<span class="comment" id="2504009">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504039">pending</span>&nbsp;<span class="builtintype" id="2504047">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504065">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504119">pendBuf</span>&nbsp;<span class="op" id="2504127">[</span><span class="ident" id="2504128">utf8</span><span class="op" id="2504132">.</span><span class="ident" id="2504133">UTFMax</span><span class="op" id="2504139">]</span><span class="builtintype" id="2504140">byte</span>&nbsp;<span class="comment" id="2504145">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="2504164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2504167">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2504230">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="2504293">func</span>&nbsp;<span class="op" id="2504298">(</span><span class="ident" id="2504299">r</span>&nbsp;<span class="op" id="2504301">*</span><span class="ident" id="2504302">readRune</span><span class="op" id="2504310">)</span>&nbsp;<span class="ident" id="2504312">readByte</span><span class="op" id="2504320">(</span><span class="op" id="2504321">)</span>&nbsp;<span class="op" id="2504323">(</span><span class="ident" id="2504324">b</span>&nbsp;<span class="builtintype" id="2504326">byte</span><span class="op" id="2504330">,</span>&nbsp;<span class="ident" id="2504332">err</span>&nbsp;<span class="builtintype" id="2504336">error</span><span class="op" id="2504341">)</span>&nbsp;<span class="op" id="2504343">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504346">if</span>&nbsp;<span class="ident" id="2504349">r</span><span class="op" id="2504350">.</span><span class="ident" id="2504351">pending</span>&nbsp;<span class="op" id="2504359">&gt;</span>&nbsp;<span class="num" id="2504361">0</span>&nbsp;<span class="op" id="2504363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504367">b</span>&nbsp;<span class="op" id="2504369">=</span>&nbsp;<span class="ident" id="2504371">r</span><span class="op" id="2504372">.</span><span class="ident" id="2504373">pendBuf</span><span class="op" id="2504380">[</span><span class="num" id="2504381">0</span><span class="op" id="2504382">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2504386">copy</span><span class="op" id="2504390">(</span><span class="ident" id="2504391">r</span><span class="op" id="2504392">.</span><span class="ident" id="2504393">pendBuf</span><span class="op" id="2504400">[</span><span class="num" id="2504401">0</span><span class="op" id="2504402">:</span><span class="op" id="2504403">]</span><span class="op" id="2504404">,</span>&nbsp;<span class="ident" id="2504406">r</span><span class="op" id="2504407">.</span><span class="ident" id="2504408">pendBuf</span><span class="op" id="2504415">[</span><span class="num" id="2504416">1</span><span class="op" id="2504417">:</span><span class="op" id="2504418">]</span><span class="op" id="2504419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504423">r</span><span class="op" id="2504424">.</span><span class="ident" id="2504425">pending</span><span class="op" id="2504432">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504437">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2504445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504448">n</span><span class="op" id="2504449">,</span>&nbsp;<span class="ident" id="2504451">err</span>&nbsp;<span class="op" id="2504455">:=</span>&nbsp;<span class="ident" id="2504458">io</span><span class="op" id="2504460">.</span><span class="ident" id="2504461">ReadFull</span><span class="op" id="2504469">(</span><span class="ident" id="2504470">r</span><span class="op" id="2504471">.</span><span class="ident" id="2504472">reader</span><span class="op" id="2504478">,</span>&nbsp;<span class="ident" id="2504480">r</span><span class="op" id="2504481">.</span><span class="ident" id="2504482">pendBuf</span><span class="op" id="2504489">[</span><span class="num" id="2504490">0</span><span class="op" id="2504491">:</span><span class="num" id="2504492">1</span><span class="op" id="2504493">]</span><span class="op" id="2504494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504497">if</span>&nbsp;<span class="ident" id="2504500">n</span>&nbsp;<span class="op" id="2504502">!=</span>&nbsp;<span class="num" id="2504505">1</span>&nbsp;<span class="op" id="2504507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504511">return</span>&nbsp;<span class="num" id="2504518">0</span><span class="op" id="2504519">,</span>&nbsp;<span class="ident" id="2504521">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2504526">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504529">return</span>&nbsp;<span class="ident" id="2504536">r</span><span class="op" id="2504537">.</span><span class="ident" id="2504538">pendBuf</span><span class="op" id="2504545">[</span><span class="num" id="2504546">0</span><span class="op" id="2504547">]</span><span class="op" id="2504548">,</span>&nbsp;<span class="ident" id="2504550">err</span><br>
<span class="lineno"></span><span class="op" id="2504554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2504557">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="2504602">func</span>&nbsp;<span class="op" id="2504607">(</span><span class="ident" id="2504608">r</span>&nbsp;<span class="op" id="2504610">*</span><span class="ident" id="2504611">readRune</span><span class="op" id="2504619">)</span>&nbsp;<span class="ident" id="2504621">unread</span><span class="op" id="2504627">(</span><span class="ident" id="2504628">buf</span>&nbsp;<span class="op" id="2504632">[</span><span class="op" id="2504633">]</span><span class="builtintype" id="2504634">byte</span><span class="op" id="2504638">)</span>&nbsp;<span class="op" id="2504640">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2504643">copy</span><span class="op" id="2504647">(</span><span class="ident" id="2504648">r</span><span class="op" id="2504649">.</span><span class="ident" id="2504650">pendBuf</span><span class="op" id="2504657">[</span><span class="ident" id="2504658">r</span><span class="op" id="2504659">.</span><span class="ident" id="2504660">pending</span><span class="op" id="2504667">:</span><span class="op" id="2504668">]</span><span class="op" id="2504669">,</span>&nbsp;<span class="ident" id="2504671">buf</span><span class="op" id="2504674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504677">r</span><span class="op" id="2504678">.</span><span class="ident" id="2504679">pending</span>&nbsp;<span class="op" id="2504687">+=</span>&nbsp;<span class="builtinfunc" id="2504690">len</span><span class="op" id="2504693">(</span><span class="ident" id="2504694">buf</span><span class="op" id="2504697">)</span><br>
<span class="lineno"></span><span class="op" id="2504699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2504702">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="2504765">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="2504788">func</span>&nbsp;<span class="op" id="2504793">(</span><span class="ident" id="2504794">r</span>&nbsp;<span class="op" id="2504796">*</span><span class="ident" id="2504797">readRune</span><span class="op" id="2504805">)</span>&nbsp;<span class="ident" id="2504807">ReadRune</span><span class="op" id="2504815">(</span><span class="op" id="2504816">)</span>&nbsp;<span class="op" id="2504818">(</span><span class="ident" id="2504819">rr</span>&nbsp;<span class="builtintype" id="2504822">rune</span><span class="op" id="2504826">,</span>&nbsp;<span class="ident" id="2504828">size</span>&nbsp;<span class="builtintype" id="2504833">int</span><span class="op" id="2504836">,</span>&nbsp;<span class="ident" id="2504838">err</span>&nbsp;<span class="builtintype" id="2504842">error</span><span class="op" id="2504847">)</span>&nbsp;<span class="op" id="2504849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504852">r</span><span class="op" id="2504853">.</span><span class="ident" id="2504854">buf</span><span class="op" id="2504857">[</span><span class="num" id="2504858">0</span><span class="op" id="2504859">]</span><span class="op" id="2504860">,</span>&nbsp;<span class="ident" id="2504862">err</span>&nbsp;<span class="op" id="2504866">=</span>&nbsp;<span class="ident" id="2504868">r</span><span class="op" id="2504869">.</span><span class="ident" id="2504870">readByte</span><span class="op" id="2504878">(</span><span class="op" id="2504879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504882">if</span>&nbsp;<span class="ident" id="2504885">err</span>&nbsp;<span class="op" id="2504889">!=</span>&nbsp;<span class="ident" id="2504892">nil</span>&nbsp;<span class="op" id="2504896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504900">return</span>&nbsp;<span class="num" id="2504907">0</span><span class="op" id="2504908">,</span>&nbsp;<span class="num" id="2504910">0</span><span class="op" id="2504911">,</span>&nbsp;<span class="ident" id="2504913">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2504918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504921">if</span>&nbsp;<span class="ident" id="2504924">r</span><span class="op" id="2504925">.</span><span class="ident" id="2504926">buf</span><span class="op" id="2504929">[</span><span class="num" id="2504930">0</span><span class="op" id="2504931">]</span>&nbsp;<span class="op" id="2504933">&lt;</span>&nbsp;<span class="ident" id="2504935">utf8</span><span class="op" id="2504939">.</span><span class="ident" id="2504940">RuneSelf</span>&nbsp;<span class="op" id="2504949">{</span>&nbsp;<span class="comment" id="2504951">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504989">rr</span>&nbsp;<span class="op" id="2504992">=</span>&nbsp;<span class="builtintype" id="2504994">rune</span><span class="op" id="2504998">(</span><span class="ident" id="2504999">r</span><span class="op" id="2505000">.</span><span class="ident" id="2505001">buf</span><span class="op" id="2505004">[</span><span class="num" id="2505005">0</span><span class="op" id="2505006">]</span><span class="op" id="2505007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505011">size</span>&nbsp;<span class="op" id="2505016">=</span>&nbsp;<span class="num" id="2505018">1</span>&nbsp;<span class="comment" id="2505020">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505040">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505051">var</span>&nbsp;<span class="ident" id="2505055">n</span>&nbsp;<span class="builtintype" id="2505057">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505062">for</span>&nbsp;<span class="ident" id="2505066">n</span>&nbsp;<span class="op" id="2505068">=</span>&nbsp;<span class="num" id="2505070">1</span><span class="op" id="2505071">;</span>&nbsp;<span class="op" id="2505073">!</span><span class="ident" id="2505074">utf8</span><span class="op" id="2505078">.</span><span class="ident" id="2505079">FullRune</span><span class="op" id="2505087">(</span><span class="ident" id="2505088">r</span><span class="op" id="2505089">.</span><span class="ident" id="2505090">buf</span><span class="op" id="2505093">[</span><span class="num" id="2505094">0</span><span class="op" id="2505095">:</span><span class="ident" id="2505096">n</span><span class="op" id="2505097">]</span><span class="op" id="2505098">)</span><span class="op" id="2505099">;</span>&nbsp;<span class="ident" id="2505101">n</span><span class="op" id="2505102">++</span>&nbsp;<span class="op" id="2505105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505109">r</span><span class="op" id="2505110">.</span><span class="ident" id="2505111">buf</span><span class="op" id="2505114">[</span><span class="ident" id="2505115">n</span><span class="op" id="2505116">]</span><span class="op" id="2505117">,</span>&nbsp;<span class="ident" id="2505119">err</span>&nbsp;<span class="op" id="2505123">=</span>&nbsp;<span class="ident" id="2505125">r</span><span class="op" id="2505126">.</span><span class="ident" id="2505127">readByte</span><span class="op" id="2505135">(</span><span class="op" id="2505136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505140">if</span>&nbsp;<span class="ident" id="2505143">err</span>&nbsp;<span class="op" id="2505147">!=</span>&nbsp;<span class="ident" id="2505150">nil</span>&nbsp;<span class="op" id="2505154">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505159">if</span>&nbsp;<span class="ident" id="2505162">err</span>&nbsp;<span class="op" id="2505166">==</span>&nbsp;<span class="ident" id="2505169">io</span><span class="op" id="2505171">.</span><span class="ident" id="2505172">EOF</span>&nbsp;<span class="op" id="2505176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505182">err</span>&nbsp;<span class="op" id="2505186">=</span>&nbsp;<span class="ident" id="2505188">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505196">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505210">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505225">rr</span><span class="op" id="2505227">,</span>&nbsp;<span class="ident" id="2505229">size</span>&nbsp;<span class="op" id="2505234">=</span>&nbsp;<span class="ident" id="2505236">utf8</span><span class="op" id="2505240">.</span><span class="ident" id="2505241">DecodeRune</span><span class="op" id="2505251">(</span><span class="ident" id="2505252">r</span><span class="op" id="2505253">.</span><span class="ident" id="2505254">buf</span><span class="op" id="2505257">[</span><span class="num" id="2505258">0</span><span class="op" id="2505259">:</span><span class="ident" id="2505260">n</span><span class="op" id="2505261">]</span><span class="op" id="2505262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505265">if</span>&nbsp;<span class="ident" id="2505268">size</span>&nbsp;<span class="op" id="2505273">&lt;</span>&nbsp;<span class="ident" id="2505275">n</span>&nbsp;<span class="op" id="2505277">{</span>&nbsp;<span class="comment" id="2505279">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505293">r</span><span class="op" id="2505294">.</span><span class="ident" id="2505295">unread</span><span class="op" id="2505301">(</span><span class="ident" id="2505302">r</span><span class="op" id="2505303">.</span><span class="ident" id="2505304">buf</span><span class="op" id="2505307">[</span><span class="ident" id="2505308">size</span><span class="op" id="2505312">:</span><span class="ident" id="2505313">n</span><span class="op" id="2505314">]</span><span class="op" id="2505315">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505321">return</span><br>
<span class="lineno"></span><span class="op" id="2505328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505331">var</span>&nbsp;<span class="ident" id="2505335">ssFree</span>&nbsp;<span class="op" id="2505342">=</span>&nbsp;<span class="ident" id="2505344">sync</span><span class="op" id="2505348">.</span><span class="ident" id="2505349">Pool</span><span class="op" id="2505353">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505356">New</span><span class="op" id="2505359">:</span>&nbsp;<span class="keyword" id="2505361">func</span><span class="op" id="2505365">(</span><span class="op" id="2505366">)</span>&nbsp;<span class="keyword" id="2505368">interface</span><span class="op" id="2505377">{</span><span class="op" id="2505378">}</span>&nbsp;<span class="op" id="2505380">{</span>&nbsp;<span class="keyword" id="2505382">return</span>&nbsp;<span class="builtinfunc" id="2505389">new</span><span class="op" id="2505392">(</span><span class="ident" id="2505393">ss</span><span class="op" id="2505395">)</span>&nbsp;<span class="op" id="2505397">}</span><span class="op" id="2505398">,</span><br>
<span class="lineno"></span><span class="op" id="2505400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505403">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="2505467">func</span>&nbsp;<span class="ident" id="2505472">newScanState</span><span class="op" id="2505484">(</span><span class="ident" id="2505485">r</span>&nbsp;<span class="ident" id="2505487">io</span><span class="op" id="2505489">.</span><span class="ident" id="2505490">Reader</span><span class="op" id="2505496">,</span>&nbsp;<span class="ident" id="2505498">nlIsSpace</span><span class="op" id="2505507">,</span>&nbsp;<span class="ident" id="2505509">nlIsEnd</span>&nbsp;<span class="builtintype" id="2505517">bool</span><span class="op" id="2505521">)</span>&nbsp;<span class="op" id="2505523">(</span><span class="ident" id="2505524">s</span>&nbsp;<span class="op" id="2505526">*</span><span class="ident" id="2505527">ss</span><span class="op" id="2505529">,</span>&nbsp;<span class="ident" id="2505531">old</span>&nbsp;<span class="ident" id="2505535">ssave</span><span class="op" id="2505540">)</span>&nbsp;<span class="op" id="2505542">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2505545">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2505600">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505644">s</span><span class="op" id="2505645">,</span>&nbsp;<span class="ident" id="2505647">ok</span>&nbsp;<span class="op" id="2505650">:=</span>&nbsp;<span class="ident" id="2505653">r</span><span class="op" id="2505654">.</span><span class="op" id="2505655">(</span><span class="op" id="2505656">*</span><span class="ident" id="2505657">ss</span><span class="op" id="2505659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505662">if</span>&nbsp;<span class="ident" id="2505665">ok</span>&nbsp;<span class="op" id="2505668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505672">old</span>&nbsp;<span class="op" id="2505676">=</span>&nbsp;<span class="ident" id="2505678">s</span><span class="op" id="2505679">.</span><span class="ident" id="2505680">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505688">s</span><span class="op" id="2505689">.</span><span class="ident" id="2505690">limit</span>&nbsp;<span class="op" id="2505696">=</span>&nbsp;<span class="ident" id="2505698">s</span><span class="op" id="2505699">.</span><span class="ident" id="2505700">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505711">s</span><span class="op" id="2505712">.</span><span class="ident" id="2505713">nlIsEnd</span>&nbsp;<span class="op" id="2505721">=</span>&nbsp;<span class="ident" id="2505723">nlIsEnd</span>&nbsp;<span class="op" id="2505731">||</span>&nbsp;<span class="ident" id="2505734">s</span><span class="op" id="2505735">.</span><span class="ident" id="2505736">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505746">s</span><span class="op" id="2505747">.</span><span class="ident" id="2505748">nlIsSpace</span>&nbsp;<span class="op" id="2505758">=</span>&nbsp;<span class="ident" id="2505760">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505772">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505780">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505784">s</span>&nbsp;<span class="op" id="2505786">=</span>&nbsp;<span class="ident" id="2505788">ssFree</span><span class="op" id="2505794">.</span><span class="ident" id="2505795">Get</span><span class="op" id="2505798">(</span><span class="op" id="2505799">)</span><span class="op" id="2505800">.</span><span class="op" id="2505801">(</span><span class="op" id="2505802">*</span><span class="ident" id="2505803">ss</span><span class="op" id="2505805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505808">if</span>&nbsp;<span class="ident" id="2505811">rr</span><span class="op" id="2505813">,</span>&nbsp;<span class="ident" id="2505815">ok</span>&nbsp;<span class="op" id="2505818">:=</span>&nbsp;<span class="ident" id="2505821">r</span><span class="op" id="2505822">.</span><span class="op" id="2505823">(</span><span class="ident" id="2505824">io</span><span class="op" id="2505826">.</span><span class="ident" id="2505827">RuneReader</span><span class="op" id="2505837">)</span><span class="op" id="2505838">;</span>&nbsp;<span class="ident" id="2505840">ok</span>&nbsp;<span class="op" id="2505843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505847">s</span><span class="op" id="2505848">.</span><span class="ident" id="2505849">rr</span>&nbsp;<span class="op" id="2505852">=</span>&nbsp;<span class="ident" id="2505854">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505858">}</span>&nbsp;<span class="keyword" id="2505860">else</span>&nbsp;<span class="op" id="2505865">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505869">s</span><span class="op" id="2505870">.</span><span class="ident" id="2505871">rr</span>&nbsp;<span class="op" id="2505874">=</span>&nbsp;<span class="op" id="2505876">&amp;</span><span class="ident" id="2505877">readRune</span><span class="op" id="2505885">{</span><span class="ident" id="2505886">reader</span><span class="op" id="2505892">:</span>&nbsp;<span class="ident" id="2505894">r</span><span class="op" id="2505895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505901">s</span><span class="op" id="2505902">.</span><span class="ident" id="2505903">nlIsSpace</span>&nbsp;<span class="op" id="2505913">=</span>&nbsp;<span class="ident" id="2505915">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505926">s</span><span class="op" id="2505927">.</span><span class="ident" id="2505928">nlIsEnd</span>&nbsp;<span class="op" id="2505936">=</span>&nbsp;<span class="ident" id="2505938">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505947">s</span><span class="op" id="2505948">.</span><span class="ident" id="2505949">prevRune</span>&nbsp;<span class="op" id="2505958">=</span>&nbsp;<span class="op" id="2505960">-</span><span class="num" id="2505961">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505964">s</span><span class="op" id="2505965">.</span><span class="ident" id="2505966">peekRune</span>&nbsp;<span class="op" id="2505975">=</span>&nbsp;<span class="op" id="2505977">-</span><span class="num" id="2505978">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505981">s</span><span class="op" id="2505982">.</span><span class="ident" id="2505983">atEOF</span>&nbsp;<span class="op" id="2505989">=</span>&nbsp;<span class="builtintype" id="2505991">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505998">s</span><span class="op" id="2505999">.</span><span class="ident" id="2506000">limit</span>&nbsp;<span class="op" id="2506006">=</span>&nbsp;<span class="ident" id="2506008">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506017">s</span><span class="op" id="2506018">.</span><span class="ident" id="2506019">argLimit</span>&nbsp;<span class="op" id="2506028">=</span>&nbsp;<span class="ident" id="2506030">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506039">s</span><span class="op" id="2506040">.</span><span class="ident" id="2506041">maxWid</span>&nbsp;<span class="op" id="2506048">=</span>&nbsp;<span class="ident" id="2506050">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506059">s</span><span class="op" id="2506060">.</span><span class="ident" id="2506061">validSave</span>&nbsp;<span class="op" id="2506071">=</span>&nbsp;<span class="builtintype" id="2506073">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506079">s</span><span class="op" id="2506080">.</span><span class="ident" id="2506081">count</span>&nbsp;<span class="op" id="2506087">=</span>&nbsp;<span class="num" id="2506089">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506092">return</span><br>
<span class="lineno"></span><span class="op" id="2506099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2506102">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2506179">func</span>&nbsp;<span class="op" id="2506184">(</span><span class="ident" id="2506185">s</span>&nbsp;<span class="op" id="2506187">*</span><span class="ident" id="2506188">ss</span><span class="op" id="2506190">)</span>&nbsp;<span class="ident" id="2506192">free</span><span class="op" id="2506196">(</span><span class="ident" id="2506197">old</span>&nbsp;<span class="ident" id="2506201">ssave</span><span class="op" id="2506206">)</span>&nbsp;<span class="op" id="2506208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2506211">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506271">if</span>&nbsp;<span class="ident" id="2506274">old</span><span class="op" id="2506277">.</span><span class="ident" id="2506278">validSave</span>&nbsp;<span class="op" id="2506288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506292">s</span><span class="op" id="2506293">.</span><span class="ident" id="2506294">ssave</span>&nbsp;<span class="op" id="2506300">=</span>&nbsp;<span class="ident" id="2506302">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506308">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2506319">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506371">if</span>&nbsp;<span class="builtinfunc" id="2506374">cap</span><span class="op" id="2506377">(</span><span class="ident" id="2506378">s</span><span class="op" id="2506379">.</span><span class="ident" id="2506380">buf</span><span class="op" id="2506383">)</span>&nbsp;<span class="op" id="2506385">&gt;</span>&nbsp;<span class="num" id="2506387">1024</span>&nbsp;<span class="op" id="2506392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506396">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506407">s</span><span class="op" id="2506408">.</span><span class="ident" id="2506409">buf</span>&nbsp;<span class="op" id="2506413">=</span>&nbsp;<span class="ident" id="2506415">s</span><span class="op" id="2506416">.</span><span class="ident" id="2506417">buf</span><span class="op" id="2506420">[</span><span class="op" id="2506421">:</span><span class="num" id="2506422">0</span><span class="op" id="2506423">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506426">s</span><span class="op" id="2506427">.</span><span class="ident" id="2506428">rr</span>&nbsp;<span class="op" id="2506431">=</span>&nbsp;<span class="ident" id="2506433">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506438">ssFree</span><span class="op" id="2506444">.</span><span class="ident" id="2506445">Put</span><span class="op" id="2506448">(</span><span class="ident" id="2506449">s</span><span class="op" id="2506450">)</span><br>
<span class="lineno"></span><span class="op" id="2506452">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="2506455">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="2506501">func</span>&nbsp;<span class="op" id="2506506">(</span><span class="ident" id="2506507">s</span>&nbsp;<span class="op" id="2506509">*</span><span class="ident" id="2506510">ss</span><span class="op" id="2506512">)</span>&nbsp;<span class="ident" id="2506514">skipSpace</span><span class="op" id="2506523">(</span><span class="ident" id="2506524">stopAtNewline</span>&nbsp;<span class="builtintype" id="2506538">bool</span><span class="op" id="2506542">)</span>&nbsp;<span class="op" id="2506544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506547">for</span>&nbsp;<span class="op" id="2506551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506555">r</span>&nbsp;<span class="op" id="2506557">:=</span>&nbsp;<span class="ident" id="2506560">s</span><span class="op" id="2506561">.</span><span class="ident" id="2506562">getRune</span><span class="op" id="2506569">(</span><span class="op" id="2506570">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506574">if</span>&nbsp;<span class="ident" id="2506577">r</span>&nbsp;<span class="op" id="2506579">==</span>&nbsp;<span class="ident" id="2506582">eof</span>&nbsp;<span class="op" id="2506586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506591">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506604">if</span>&nbsp;<span class="ident" id="2506607">r</span>&nbsp;<span class="op" id="2506609">==</span>&nbsp;<span class="string" id="2506612">&#39;\r&#39;</span>&nbsp;<span class="op" id="2506617">&amp;&amp;</span>&nbsp;<span class="ident" id="2506620">s</span><span class="op" id="2506621">.</span><span class="ident" id="2506622">peek</span><span class="op" id="2506626">(</span><span class="string" id="2506627">&#34;\n&#34;</span><span class="op" id="2506631">)</span>&nbsp;<span class="op" id="2506633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506638">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506653">if</span>&nbsp;<span class="ident" id="2506656">r</span>&nbsp;<span class="op" id="2506658">==</span>&nbsp;<span class="string" id="2506661">&#39;\n&#39;</span>&nbsp;<span class="op" id="2506666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506671">if</span>&nbsp;<span class="ident" id="2506674">stopAtNewline</span>&nbsp;<span class="op" id="2506688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506694">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506703">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506708">if</span>&nbsp;<span class="ident" id="2506711">s</span><span class="op" id="2506712">.</span><span class="ident" id="2506713">nlIsSpace</span>&nbsp;<span class="op" id="2506723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506729">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506746">s</span><span class="op" id="2506747">.</span><span class="ident" id="2506748">errorString</span><span class="op" id="2506759">(</span><span class="string" id="2506760">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="2506780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506785">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506798">if</span>&nbsp;<span class="op" id="2506801">!</span><span class="ident" id="2506802">isSpace</span><span class="op" id="2506809">(</span><span class="ident" id="2506810">r</span><span class="op" id="2506811">)</span>&nbsp;<span class="op" id="2506813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506818">s</span><span class="op" id="2506819">.</span><span class="ident" id="2506820">UnreadRune</span><span class="op" id="2506830">(</span><span class="op" id="2506831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506836">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506844">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2506847">}</span><br>
<span class="lineno"></span><span class="op" id="2506849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2506852">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2506921">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="2506989">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="2507024">func</span>&nbsp;<span class="op" id="2507029">(</span><span class="ident" id="2507030">s</span>&nbsp;<span class="op" id="2507032">*</span><span class="ident" id="2507033">ss</span><span class="op" id="2507035">)</span>&nbsp;<span class="ident" id="2507037">token</span><span class="op" id="2507042">(</span><span class="ident" id="2507043">skipSpace</span>&nbsp;<span class="builtintype" id="2507053">bool</span><span class="op" id="2507057">,</span>&nbsp;<span class="ident" id="2507059">f</span>&nbsp;<span class="keyword" id="2507061">func</span><span class="op" id="2507065">(</span><span class="builtintype" id="2507066">rune</span><span class="op" id="2507070">)</span>&nbsp;<span class="builtintype" id="2507072">bool</span><span class="op" id="2507076">)</span>&nbsp;<span class="op" id="2507078">[</span><span class="op" id="2507079">]</span><span class="builtintype" id="2507080">byte</span>&nbsp;<span class="op" id="2507085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507088">if</span>&nbsp;<span class="ident" id="2507091">skipSpace</span>&nbsp;<span class="op" id="2507101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507105">s</span><span class="op" id="2507106">.</span><span class="ident" id="2507107">skipSpace</span><span class="op" id="2507116">(</span><span class="builtintype" id="2507117">false</span><span class="op" id="2507122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507125">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2507128">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507166">for</span>&nbsp;<span class="op" id="2507170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507174">r</span>&nbsp;<span class="op" id="2507176">:=</span>&nbsp;<span class="ident" id="2507179">s</span><span class="op" id="2507180">.</span><span class="ident" id="2507181">getRune</span><span class="op" id="2507188">(</span><span class="op" id="2507189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507193">if</span>&nbsp;<span class="ident" id="2507196">r</span>&nbsp;<span class="op" id="2507198">==</span>&nbsp;<span class="ident" id="2507201">eof</span>&nbsp;<span class="op" id="2507205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507210">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507222">if</span>&nbsp;<span class="op" id="2507225">!</span><span class="ident" id="2507226">f</span><span class="op" id="2507227">(</span><span class="ident" id="2507228">r</span><span class="op" id="2507229">)</span>&nbsp;<span class="op" id="2507231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507236">s</span><span class="op" id="2507237">.</span><span class="ident" id="2507238">UnreadRune</span><span class="op" id="2507248">(</span><span class="op" id="2507249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507254">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507262">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507266">s</span><span class="op" id="2507267">.</span><span class="ident" id="2507268">buf</span><span class="op" id="2507271">.</span><span class="ident" id="2507272">WriteRune</span><span class="op" id="2507281">(</span><span class="ident" id="2507282">r</span><span class="op" id="2507283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507289">return</span>&nbsp;<span class="ident" id="2507296">s</span><span class="op" id="2507297">.</span><span class="ident" id="2507298">buf</span><br>
<span class="lineno"></span><span class="op" id="2507302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2507305">var</span>&nbsp;<span class="ident" id="2507309">complexError</span>&nbsp;<span class="op" id="2507322">=</span>&nbsp;<span class="ident" id="2507324">errors</span><span class="op" id="2507330">.</span><span class="ident" id="2507331">New</span><span class="op" id="2507334">(</span><span class="string" id="2507335">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="2507373">)</span><br>
<span class="lineno"></span><span class="keyword" id="2507375">var</span>&nbsp;<span class="ident" id="2507379">boolError</span>&nbsp;<span class="op" id="2507389">=</span>&nbsp;<span class="ident" id="2507391">errors</span><span class="op" id="2507397">.</span><span class="ident" id="2507398">New</span><span class="op" id="2507401">(</span><span class="string" id="2507402">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="2507433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2507436">func</span>&nbsp;<span class="ident" id="2507441">indexRune</span><span class="op" id="2507450">(</span><span class="ident" id="2507451">s</span>&nbsp;<span class="builtintype" id="2507453">string</span><span class="op" id="2507459">,</span>&nbsp;<span class="ident" id="2507461">r</span>&nbsp;<span class="builtintype" id="2507463">rune</span><span class="op" id="2507467">)</span>&nbsp;<span class="builtintype" id="2507469">int</span>&nbsp;<span class="op" id="2507473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507476">for</span>&nbsp;<span class="ident" id="2507480">i</span><span class="op" id="2507481">,</span>&nbsp;<span class="ident" id="2507483">c</span>&nbsp;<span class="op" id="2507485">:=</span>&nbsp;<span class="keyword" id="2507488">range</span>&nbsp;<span class="ident" id="2507494">s</span>&nbsp;<span class="op" id="2507496">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507500">if</span>&nbsp;<span class="ident" id="2507503">c</span>&nbsp;<span class="op" id="2507505">==</span>&nbsp;<span class="ident" id="2507508">r</span>&nbsp;<span class="op" id="2507510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507515">return</span>&nbsp;<span class="ident" id="2507522">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507532">return</span>&nbsp;<span class="op" id="2507539">-</span><span class="num" id="2507540">1</span><br>
<span class="lineno">495</span><span class="op" id="2507542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2507545">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2507633">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2507699">func</span>&nbsp;<span class="op" id="2507704">(</span><span class="ident" id="2507705">s</span>&nbsp;<span class="op" id="2507707">*</span><span class="ident" id="2507708">ss</span><span class="op" id="2507710">)</span>&nbsp;<span class="ident" id="2507712">consume</span><span class="op" id="2507719">(</span><span class="ident" id="2507720">ok</span>&nbsp;<span class="builtintype" id="2507723">string</span><span class="op" id="2507729">,</span>&nbsp;<span class="ident" id="2507731">accept</span>&nbsp;<span class="builtintype" id="2507738">bool</span><span class="op" id="2507742">)</span>&nbsp;<span class="builtintype" id="2507744">bool</span>&nbsp;<span class="op" id="2507749">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507752">r</span>&nbsp;<span class="op" id="2507754">:=</span>&nbsp;<span class="ident" id="2507757">s</span><span class="op" id="2507758">.</span><span class="ident" id="2507759">getRune</span><span class="op" id="2507766">(</span><span class="op" id="2507767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507770">if</span>&nbsp;<span class="ident" id="2507773">r</span>&nbsp;<span class="op" id="2507775">==</span>&nbsp;<span class="ident" id="2507778">eof</span>&nbsp;<span class="op" id="2507782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507786">return</span>&nbsp;<span class="builtintype" id="2507793">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507803">if</span>&nbsp;<span class="ident" id="2507806">indexRune</span><span class="op" id="2507815">(</span><span class="ident" id="2507816">ok</span><span class="op" id="2507818">,</span>&nbsp;<span class="ident" id="2507820">r</span><span class="op" id="2507821">)</span>&nbsp;<span class="op" id="2507823">&gt;=</span>&nbsp;<span class="num" id="2507826">0</span>&nbsp;<span class="op" id="2507828">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507832">if</span>&nbsp;<span class="ident" id="2507835">accept</span>&nbsp;<span class="op" id="2507842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507847">s</span><span class="op" id="2507848">.</span><span class="ident" id="2507849">buf</span><span class="op" id="2507852">.</span><span class="ident" id="2507853">WriteRune</span><span class="op" id="2507862">(</span><span class="ident" id="2507863">r</span><span class="op" id="2507864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507872">return</span>&nbsp;<span class="builtintype" id="2507879">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507885">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507888">if</span>&nbsp;<span class="ident" id="2507891">r</span>&nbsp;<span class="op" id="2507893">!=</span>&nbsp;<span class="ident" id="2507896">eof</span>&nbsp;<span class="op" id="2507900">&amp;&amp;</span>&nbsp;<span class="ident" id="2507903">accept</span>&nbsp;<span class="op" id="2507910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507914">s</span><span class="op" id="2507915">.</span><span class="ident" id="2507916">UnreadRune</span><span class="op" id="2507926">(</span><span class="op" id="2507927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507933">return</span>&nbsp;<span class="builtintype" id="2507940">false</span><br>
<span class="lineno"></span><span class="op" id="2507946">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2507949">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2508035">func</span>&nbsp;<span class="op" id="2508040">(</span><span class="ident" id="2508041">s</span>&nbsp;<span class="op" id="2508043">*</span><span class="ident" id="2508044">ss</span><span class="op" id="2508046">)</span>&nbsp;<span class="ident" id="2508048">peek</span><span class="op" id="2508052">(</span><span class="ident" id="2508053">ok</span>&nbsp;<span class="builtintype" id="2508056">string</span><span class="op" id="2508062">)</span>&nbsp;<span class="builtintype" id="2508064">bool</span>&nbsp;<span class="op" id="2508069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508072">r</span>&nbsp;<span class="op" id="2508074">:=</span>&nbsp;<span class="ident" id="2508077">s</span><span class="op" id="2508078">.</span><span class="ident" id="2508079">getRune</span><span class="op" id="2508086">(</span><span class="op" id="2508087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508090">if</span>&nbsp;<span class="ident" id="2508093">r</span>&nbsp;<span class="op" id="2508095">!=</span>&nbsp;<span class="ident" id="2508098">eof</span>&nbsp;<span class="op" id="2508102">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508106">s</span><span class="op" id="2508107">.</span><span class="ident" id="2508108">UnreadRune</span><span class="op" id="2508118">(</span><span class="op" id="2508119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508125">return</span>&nbsp;<span class="ident" id="2508132">indexRune</span><span class="op" id="2508141">(</span><span class="ident" id="2508142">ok</span><span class="op" id="2508144">,</span>&nbsp;<span class="ident" id="2508146">r</span><span class="op" id="2508147">)</span>&nbsp;<span class="op" id="2508149">&gt;=</span>&nbsp;<span class="num" id="2508152">0</span><br>
<span class="lineno"></span><span class="op" id="2508154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="2508157">func</span>&nbsp;<span class="op" id="2508162">(</span><span class="ident" id="2508163">s</span>&nbsp;<span class="op" id="2508165">*</span><span class="ident" id="2508166">ss</span><span class="op" id="2508168">)</span>&nbsp;<span class="ident" id="2508170">notEOF</span><span class="op" id="2508176">(</span><span class="op" id="2508177">)</span>&nbsp;<span class="op" id="2508179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2508182">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508222">if</span>&nbsp;<span class="ident" id="2508225">r</span>&nbsp;<span class="op" id="2508227">:=</span>&nbsp;<span class="ident" id="2508230">s</span><span class="op" id="2508231">.</span><span class="ident" id="2508232">getRune</span><span class="op" id="2508239">(</span><span class="op" id="2508240">)</span><span class="op" id="2508241">;</span>&nbsp;<span class="ident" id="2508243">r</span>&nbsp;<span class="op" id="2508245">==</span>&nbsp;<span class="ident" id="2508248">eof</span>&nbsp;<span class="op" id="2508252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2508256">panic</span><span class="op" id="2508261">(</span><span class="ident" id="2508262">io</span><span class="op" id="2508264">.</span><span class="ident" id="2508265">EOF</span><span class="op" id="2508268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508271">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508274">s</span><span class="op" id="2508275">.</span><span class="ident" id="2508276">UnreadRune</span><span class="op" id="2508286">(</span><span class="op" id="2508287">)</span><br>
<span class="lineno"></span><span class="op" id="2508289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2508292">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2508392">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="2508447">func</span>&nbsp;<span class="op" id="2508452">(</span><span class="ident" id="2508453">s</span>&nbsp;<span class="op" id="2508455">*</span><span class="ident" id="2508456">ss</span><span class="op" id="2508458">)</span>&nbsp;<span class="ident" id="2508460">accept</span><span class="op" id="2508466">(</span><span class="ident" id="2508467">ok</span>&nbsp;<span class="builtintype" id="2508470">string</span><span class="op" id="2508476">)</span>&nbsp;<span class="builtintype" id="2508478">bool</span>&nbsp;<span class="op" id="2508483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508486">return</span>&nbsp;<span class="ident" id="2508493">s</span><span class="op" id="2508494">.</span><span class="ident" id="2508495">consume</span><span class="op" id="2508502">(</span><span class="ident" id="2508503">ok</span><span class="op" id="2508505">,</span>&nbsp;<span class="builtintype" id="2508507">true</span><span class="op" id="2508511">)</span><br>
<span class="lineno"></span><span class="op" id="2508513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2508516">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="2508609">func</span>&nbsp;<span class="op" id="2508614">(</span><span class="ident" id="2508615">s</span>&nbsp;<span class="op" id="2508617">*</span><span class="ident" id="2508618">ss</span><span class="op" id="2508620">)</span>&nbsp;<span class="ident" id="2508622">okVerb</span><span class="op" id="2508628">(</span><span class="ident" id="2508629">verb</span>&nbsp;<span class="builtintype" id="2508634">rune</span><span class="op" id="2508638">,</span>&nbsp;<span class="ident" id="2508640">okVerbs</span><span class="op" id="2508647">,</span>&nbsp;<span class="ident" id="2508649">typ</span>&nbsp;<span class="builtintype" id="2508653">string</span><span class="op" id="2508659">)</span>&nbsp;<span class="builtintype" id="2508661">bool</span>&nbsp;<span class="op" id="2508666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508669">for</span>&nbsp;<span class="ident" id="2508673">_</span><span class="op" id="2508674">,</span>&nbsp;<span class="ident" id="2508676">v</span>&nbsp;<span class="op" id="2508678">:=</span>&nbsp;<span class="keyword" id="2508681">range</span>&nbsp;<span class="ident" id="2508687">okVerbs</span>&nbsp;<span class="op" id="2508695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508699">if</span>&nbsp;<span class="ident" id="2508702">v</span>&nbsp;<span class="op" id="2508704">==</span>&nbsp;<span class="ident" id="2508707">verb</span>&nbsp;<span class="op" id="2508712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508717">return</span>&nbsp;<span class="builtintype" id="2508724">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508731">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508737">s</span><span class="op" id="2508738">.</span><span class="ident" id="2508739">errorString</span><span class="op" id="2508750">(</span><span class="string" id="2508751">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="2508764">+</span>&nbsp;<span class="builtintype" id="2508766">string</span><span class="op" id="2508772">(</span><span class="ident" id="2508773">verb</span><span class="op" id="2508777">)</span>&nbsp;<span class="op" id="2508779">+</span>&nbsp;<span class="string" id="2508781">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2508789">+</span>&nbsp;<span class="ident" id="2508791">typ</span><span class="op" id="2508794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508797">return</span>&nbsp;<span class="builtintype" id="2508804">false</span><br>
<span class="lineno"></span><span class="op" id="2508810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="2508813">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2508889">func</span>&nbsp;<span class="op" id="2508894">(</span><span class="ident" id="2508895">s</span>&nbsp;<span class="op" id="2508897">*</span><span class="ident" id="2508898">ss</span><span class="op" id="2508900">)</span>&nbsp;<span class="ident" id="2508902">scanBool</span><span class="op" id="2508910">(</span><span class="ident" id="2508911">verb</span>&nbsp;<span class="builtintype" id="2508916">rune</span><span class="op" id="2508920">)</span>&nbsp;<span class="builtintype" id="2508922">bool</span>&nbsp;<span class="op" id="2508927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508930">s</span><span class="op" id="2508931">.</span><span class="ident" id="2508932">skipSpace</span><span class="op" id="2508941">(</span><span class="builtintype" id="2508942">false</span><span class="op" id="2508947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508950">s</span><span class="op" id="2508951">.</span><span class="ident" id="2508952">notEOF</span><span class="op" id="2508958">(</span><span class="op" id="2508959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508962">if</span>&nbsp;<span class="op" id="2508965">!</span><span class="ident" id="2508966">s</span><span class="op" id="2508967">.</span><span class="ident" id="2508968">okVerb</span><span class="op" id="2508974">(</span><span class="ident" id="2508975">verb</span><span class="op" id="2508979">,</span>&nbsp;<span class="string" id="2508981">&#34;tv&#34;</span><span class="op" id="2508985">,</span>&nbsp;<span class="string" id="2508987">&#34;boolean&#34;</span><span class="op" id="2508996">)</span>&nbsp;<span class="op" id="2508998">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509002">return</span>&nbsp;<span class="builtintype" id="2509009">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2509019">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509096">switch</span>&nbsp;<span class="ident" id="2509103">s</span><span class="op" id="2509104">.</span><span class="ident" id="2509105">getRune</span><span class="op" id="2509112">(</span><span class="op" id="2509113">)</span>&nbsp;<span class="op" id="2509115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509118">case</span>&nbsp;<span class="string" id="2509123">&#39;0&#39;</span><span class="op" id="2509126">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509130">return</span>&nbsp;<span class="builtintype" id="2509137">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509144">case</span>&nbsp;<span class="string" id="2509149">&#39;1&#39;</span><span class="op" id="2509152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509156">return</span>&nbsp;<span class="builtintype" id="2509163">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509169">case</span>&nbsp;<span class="string" id="2509174">&#39;t&#39;</span><span class="op" id="2509177">,</span>&nbsp;<span class="string" id="2509179">&#39;T&#39;</span><span class="op" id="2509182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509186">if</span>&nbsp;<span class="ident" id="2509189">s</span><span class="op" id="2509190">.</span><span class="ident" id="2509191">accept</span><span class="op" id="2509197">(</span><span class="string" id="2509198">&#34;rR&#34;</span><span class="op" id="2509202">)</span>&nbsp;<span class="op" id="2509204">&amp;&amp;</span>&nbsp;<span class="op" id="2509207">(</span><span class="op" id="2509208">!</span><span class="ident" id="2509209">s</span><span class="op" id="2509210">.</span><span class="ident" id="2509211">accept</span><span class="op" id="2509217">(</span><span class="string" id="2509218">&#34;uU&#34;</span><span class="op" id="2509222">)</span>&nbsp;<span class="op" id="2509224">||</span>&nbsp;<span class="op" id="2509227">!</span><span class="ident" id="2509228">s</span><span class="op" id="2509229">.</span><span class="ident" id="2509230">accept</span><span class="op" id="2509236">(</span><span class="string" id="2509237">&#34;eE&#34;</span><span class="op" id="2509241">)</span><span class="op" id="2509242">)</span>&nbsp;<span class="op" id="2509244">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509249">s</span><span class="op" id="2509250">.</span><span class="builtintype" id="2509251">error</span><span class="op" id="2509256">(</span><span class="ident" id="2509257">boolError</span><span class="op" id="2509266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509274">return</span>&nbsp;<span class="builtintype" id="2509281">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509287">case</span>&nbsp;<span class="string" id="2509292">&#39;f&#39;</span><span class="op" id="2509295">,</span>&nbsp;<span class="string" id="2509297">&#39;F&#39;</span><span class="op" id="2509300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509304">if</span>&nbsp;<span class="ident" id="2509307">s</span><span class="op" id="2509308">.</span><span class="ident" id="2509309">accept</span><span class="op" id="2509315">(</span><span class="string" id="2509316">&#34;aA&#34;</span><span class="op" id="2509320">)</span>&nbsp;<span class="op" id="2509322">&amp;&amp;</span>&nbsp;<span class="op" id="2509325">(</span><span class="op" id="2509326">!</span><span class="ident" id="2509327">s</span><span class="op" id="2509328">.</span><span class="ident" id="2509329">accept</span><span class="op" id="2509335">(</span><span class="string" id="2509336">&#34;lL&#34;</span><span class="op" id="2509340">)</span>&nbsp;<span class="op" id="2509342">||</span>&nbsp;<span class="op" id="2509345">!</span><span class="ident" id="2509346">s</span><span class="op" id="2509347">.</span><span class="ident" id="2509348">accept</span><span class="op" id="2509354">(</span><span class="string" id="2509355">&#34;sS&#34;</span><span class="op" id="2509359">)</span>&nbsp;<span class="op" id="2509361">||</span>&nbsp;<span class="op" id="2509364">!</span><span class="ident" id="2509365">s</span><span class="op" id="2509366">.</span><span class="ident" id="2509367">accept</span><span class="op" id="2509373">(</span><span class="string" id="2509374">&#34;eE&#34;</span><span class="op" id="2509378">)</span><span class="op" id="2509379">)</span>&nbsp;<span class="op" id="2509381">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509386">s</span><span class="op" id="2509387">.</span><span class="builtintype" id="2509388">error</span><span class="op" id="2509393">(</span><span class="ident" id="2509394">boolError</span><span class="op" id="2509403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509411">return</span>&nbsp;<span class="builtintype" id="2509418">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509428">return</span>&nbsp;<span class="builtintype" id="2509435">false</span><br>
<span class="lineno">575</span><span class="op" id="2509441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2509444">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="2509466">const</span>&nbsp;<span class="op" id="2509472">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509475">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509493">=</span>&nbsp;<span class="string" id="2509495">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509501">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509519">=</span>&nbsp;<span class="string" id="2509521">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509533">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509551">=</span>&nbsp;<span class="string" id="2509553">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509567">hexadecimalDigits</span>&nbsp;<span class="op" id="2509585">=</span>&nbsp;<span class="string" id="2509587">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509613">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509631">=</span>&nbsp;<span class="string" id="2509633">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509639">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509657">=</span>&nbsp;<span class="string" id="2509659">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509664">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509682">=</span>&nbsp;<span class="string" id="2509684">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="2509690">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2509693">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2509775">func</span>&nbsp;<span class="op" id="2509780">(</span><span class="ident" id="2509781">s</span>&nbsp;<span class="op" id="2509783">*</span><span class="ident" id="2509784">ss</span><span class="op" id="2509786">)</span>&nbsp;<span class="ident" id="2509788">getBase</span><span class="op" id="2509795">(</span><span class="ident" id="2509796">verb</span>&nbsp;<span class="builtintype" id="2509801">rune</span><span class="op" id="2509805">)</span>&nbsp;<span class="op" id="2509807">(</span><span class="ident" id="2509808">base</span>&nbsp;<span class="builtintype" id="2509813">int</span><span class="op" id="2509816">,</span>&nbsp;<span class="ident" id="2509818">digits</span>&nbsp;<span class="builtintype" id="2509825">string</span><span class="op" id="2509831">)</span>&nbsp;<span class="op" id="2509833">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509836">s</span><span class="op" id="2509837">.</span><span class="ident" id="2509838">okVerb</span><span class="op" id="2509844">(</span><span class="ident" id="2509845">verb</span><span class="op" id="2509849">,</span>&nbsp;<span class="string" id="2509851">&#34;bdoUxXv&#34;</span><span class="op" id="2509860">,</span>&nbsp;<span class="string" id="2509862">&#34;integer&#34;</span><span class="op" id="2509871">)</span>&nbsp;<span class="comment" id="2509873">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509888">base</span>&nbsp;<span class="op" id="2509893">=</span>&nbsp;<span class="num" id="2509895">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509899">digits</span>&nbsp;<span class="op" id="2509906">=</span>&nbsp;<span class="ident" id="2509908">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509923">switch</span>&nbsp;<span class="ident" id="2509930">verb</span>&nbsp;<span class="op" id="2509935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509938">case</span>&nbsp;<span class="string" id="2509943">&#39;b&#39;</span><span class="op" id="2509946">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509950">base</span>&nbsp;<span class="op" id="2509955">=</span>&nbsp;<span class="num" id="2509957">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509961">digits</span>&nbsp;<span class="op" id="2509968">=</span>&nbsp;<span class="ident" id="2509970">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509984">case</span>&nbsp;<span class="string" id="2509989">&#39;o&#39;</span><span class="op" id="2509992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509996">base</span>&nbsp;<span class="op" id="2510001">=</span>&nbsp;<span class="num" id="2510003">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510007">digits</span>&nbsp;<span class="op" id="2510014">=</span>&nbsp;<span class="ident" id="2510016">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510029">case</span>&nbsp;<span class="string" id="2510034">&#39;x&#39;</span><span class="op" id="2510037">,</span>&nbsp;<span class="string" id="2510039">&#39;X&#39;</span><span class="op" id="2510042">,</span>&nbsp;<span class="string" id="2510044">&#39;U&#39;</span><span class="op" id="2510047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510051">base</span>&nbsp;<span class="op" id="2510056">=</span>&nbsp;<span class="num" id="2510058">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510063">digits</span>&nbsp;<span class="op" id="2510070">=</span>&nbsp;<span class="ident" id="2510072">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510094">return</span><br>
<span class="lineno">605</span><span class="op" id="2510101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2510104">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2510184">func</span>&nbsp;<span class="op" id="2510189">(</span><span class="ident" id="2510190">s</span>&nbsp;<span class="op" id="2510192">*</span><span class="ident" id="2510193">ss</span><span class="op" id="2510195">)</span>&nbsp;<span class="ident" id="2510197">scanNumber</span><span class="op" id="2510207">(</span><span class="ident" id="2510208">digits</span>&nbsp;<span class="builtintype" id="2510215">string</span><span class="op" id="2510221">,</span>&nbsp;<span class="ident" id="2510223">haveDigits</span>&nbsp;<span class="builtintype" id="2510234">bool</span><span class="op" id="2510238">)</span>&nbsp;<span class="builtintype" id="2510240">string</span>&nbsp;<span class="op" id="2510247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510250">if</span>&nbsp;<span class="op" id="2510253">!</span><span class="ident" id="2510254">haveDigits</span>&nbsp;<span class="op" id="2510265">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510269">s</span><span class="op" id="2510270">.</span><span class="ident" id="2510271">notEOF</span><span class="op" id="2510277">(</span><span class="op" id="2510278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510282">if</span>&nbsp;<span class="op" id="2510285">!</span><span class="ident" id="2510286">s</span><span class="op" id="2510287">.</span><span class="ident" id="2510288">accept</span><span class="op" id="2510294">(</span><span class="ident" id="2510295">digits</span><span class="op" id="2510301">)</span>&nbsp;<span class="op" id="2510303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510308">s</span><span class="op" id="2510309">.</span><span class="ident" id="2510310">errorString</span><span class="op" id="2510321">(</span><span class="string" id="2510322">&#34;expected&nbsp;integer&#34;</span><span class="op" id="2510340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510347">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510350">for</span>&nbsp;<span class="ident" id="2510354">s</span><span class="op" id="2510355">.</span><span class="ident" id="2510356">accept</span><span class="op" id="2510362">(</span><span class="ident" id="2510363">digits</span><span class="op" id="2510369">)</span>&nbsp;<span class="op" id="2510371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510377">return</span>&nbsp;<span class="builtintype" id="2510384">string</span><span class="op" id="2510390">(</span><span class="ident" id="2510391">s</span><span class="op" id="2510392">.</span><span class="ident" id="2510393">buf</span><span class="op" id="2510396">)</span><br>
<span class="lineno"></span><span class="op" id="2510398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="2510401">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="2510455">func</span>&nbsp;<span class="op" id="2510460">(</span><span class="ident" id="2510461">s</span>&nbsp;<span class="op" id="2510463">*</span><span class="ident" id="2510464">ss</span><span class="op" id="2510466">)</span>&nbsp;<span class="ident" id="2510468">scanRune</span><span class="op" id="2510476">(</span><span class="ident" id="2510477">bitSize</span>&nbsp;<span class="builtintype" id="2510485">int</span><span class="op" id="2510488">)</span>&nbsp;<span class="ident" id="2510490">int64</span>&nbsp;<span class="op" id="2510496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510499">s</span><span class="op" id="2510500">.</span><span class="ident" id="2510501">notEOF</span><span class="op" id="2510507">(</span><span class="op" id="2510508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510511">r</span>&nbsp;<span class="op" id="2510513">:=</span>&nbsp;<span class="ident" id="2510516">int64</span><span class="op" id="2510521">(</span><span class="ident" id="2510522">s</span><span class="op" id="2510523">.</span><span class="ident" id="2510524">getRune</span><span class="op" id="2510531">(</span><span class="op" id="2510532">)</span><span class="op" id="2510533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510536">n</span>&nbsp;<span class="op" id="2510538">:=</span>&nbsp;<span class="builtintype" id="2510541">uint</span><span class="op" id="2510545">(</span><span class="ident" id="2510546">bitSize</span><span class="op" id="2510553">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510556">x</span>&nbsp;<span class="op" id="2510558">:=</span>&nbsp;<span class="op" id="2510561">(</span><span class="ident" id="2510562">r</span>&nbsp;<span class="op" id="2510564">&lt;&lt;</span>&nbsp;<span class="op" id="2510567">(</span><span class="num" id="2510568">64</span>&nbsp;<span class="op" id="2510571">-</span>&nbsp;<span class="ident" id="2510573">n</span><span class="op" id="2510574">)</span><span class="op" id="2510575">)</span>&nbsp;<span class="op" id="2510577">&gt;&gt;</span>&nbsp;<span class="op" id="2510580">(</span><span class="num" id="2510581">64</span>&nbsp;<span class="op" id="2510584">-</span>&nbsp;<span class="ident" id="2510586">n</span><span class="op" id="2510587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510590">if</span>&nbsp;<span class="ident" id="2510593">x</span>&nbsp;<span class="op" id="2510595">!=</span>&nbsp;<span class="ident" id="2510598">r</span>&nbsp;<span class="op" id="2510600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510604">s</span><span class="op" id="2510605">.</span><span class="ident" id="2510606">errorString</span><span class="op" id="2510617">(</span><span class="string" id="2510618">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="2510649">+</span>&nbsp;<span class="builtintype" id="2510651">string</span><span class="op" id="2510657">(</span><span class="ident" id="2510658">r</span><span class="op" id="2510659">)</span><span class="op" id="2510660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510666">return</span>&nbsp;<span class="ident" id="2510673">r</span><br>
<span class="lineno">630</span><span class="op" id="2510675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2510678">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="2510747">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="2510816">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="2510856">func</span>&nbsp;<span class="op" id="2510861">(</span><span class="ident" id="2510862">s</span>&nbsp;<span class="op" id="2510864">*</span><span class="ident" id="2510865">ss</span><span class="op" id="2510867">)</span>&nbsp;<span class="ident" id="2510869">scanBasePrefix</span><span class="op" id="2510883">(</span><span class="op" id="2510884">)</span>&nbsp;<span class="op" id="2510886">(</span><span class="ident" id="2510887">base</span>&nbsp;<span class="builtintype" id="2510892">int</span><span class="op" id="2510895">,</span>&nbsp;<span class="ident" id="2510897">digits</span>&nbsp;<span class="builtintype" id="2510904">string</span><span class="op" id="2510910">,</span>&nbsp;<span class="ident" id="2510912">found</span>&nbsp;<span class="builtintype" id="2510918">bool</span><span class="op" id="2510922">)</span>&nbsp;<span class="op" id="2510924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510927">if</span>&nbsp;<span class="op" id="2510930">!</span><span class="ident" id="2510931">s</span><span class="op" id="2510932">.</span><span class="ident" id="2510933">peek</span><span class="op" id="2510937">(</span><span class="string" id="2510938">&#34;0&#34;</span><span class="op" id="2510941">)</span>&nbsp;<span class="op" id="2510943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510947">return</span>&nbsp;<span class="num" id="2510954">10</span><span class="op" id="2510956">,</span>&nbsp;<span class="ident" id="2510958">decimalDigits</span><span class="op" id="2510971">,</span>&nbsp;<span class="builtintype" id="2510973">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510983">s</span><span class="op" id="2510984">.</span><span class="ident" id="2510985">accept</span><span class="op" id="2510991">(</span><span class="string" id="2510992">&#34;0&#34;</span><span class="op" id="2510995">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510998">found</span>&nbsp;<span class="op" id="2511004">=</span>&nbsp;<span class="builtintype" id="2511006">true</span>&nbsp;<span class="comment" id="2511011">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2511056">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511090">base</span><span class="op" id="2511094">,</span>&nbsp;<span class="ident" id="2511096">digits</span>&nbsp;<span class="op" id="2511103">=</span>&nbsp;<span class="num" id="2511105">8</span><span class="op" id="2511106">,</span>&nbsp;<span class="ident" id="2511108">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511121">if</span>&nbsp;<span class="ident" id="2511124">s</span><span class="op" id="2511125">.</span><span class="ident" id="2511126">peek</span><span class="op" id="2511130">(</span><span class="string" id="2511131">&#34;xX&#34;</span><span class="op" id="2511135">)</span>&nbsp;<span class="op" id="2511137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511141">s</span><span class="op" id="2511142">.</span><span class="ident" id="2511143">consume</span><span class="op" id="2511150">(</span><span class="string" id="2511151">&#34;xX&#34;</span><span class="op" id="2511155">,</span>&nbsp;<span class="builtintype" id="2511157">false</span><span class="op" id="2511162">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511166">base</span><span class="op" id="2511170">,</span>&nbsp;<span class="ident" id="2511172">digits</span>&nbsp;<span class="op" id="2511179">=</span>&nbsp;<span class="num" id="2511181">16</span><span class="op" id="2511183">,</span>&nbsp;<span class="ident" id="2511185">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511207">return</span><br>
<span class="lineno"></span><span class="op" id="2511214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2511217">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="2511285">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="2511349">func</span>&nbsp;<span class="op" id="2511354">(</span><span class="ident" id="2511355">s</span>&nbsp;<span class="op" id="2511357">*</span><span class="ident" id="2511358">ss</span><span class="op" id="2511360">)</span>&nbsp;<span class="ident" id="2511362">scanInt</span><span class="op" id="2511369">(</span><span class="ident" id="2511370">verb</span>&nbsp;<span class="builtintype" id="2511375">rune</span><span class="op" id="2511379">,</span>&nbsp;<span class="ident" id="2511381">bitSize</span>&nbsp;<span class="builtintype" id="2511389">int</span><span class="op" id="2511392">)</span>&nbsp;<span class="ident" id="2511394">int64</span>&nbsp;<span class="op" id="2511400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511403">if</span>&nbsp;<span class="ident" id="2511406">verb</span>&nbsp;<span class="op" id="2511411">==</span>&nbsp;<span class="string" id="2511414">&#39;c&#39;</span>&nbsp;<span class="op" id="2511418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511422">return</span>&nbsp;<span class="ident" id="2511429">s</span><span class="op" id="2511430">.</span><span class="ident" id="2511431">scanRune</span><span class="op" id="2511439">(</span><span class="ident" id="2511440">bitSize</span><span class="op" id="2511447">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511453">s</span><span class="op" id="2511454">.</span><span class="ident" id="2511455">skipSpace</span><span class="op" id="2511464">(</span><span class="builtintype" id="2511465">false</span><span class="op" id="2511470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511473">s</span><span class="op" id="2511474">.</span><span class="ident" id="2511475">notEOF</span><span class="op" id="2511481">(</span><span class="op" id="2511482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511485">base</span><span class="op" id="2511489">,</span>&nbsp;<span class="ident" id="2511491">digits</span>&nbsp;<span class="op" id="2511498">:=</span>&nbsp;<span class="ident" id="2511501">s</span><span class="op" id="2511502">.</span><span class="ident" id="2511503">getBase</span><span class="op" id="2511510">(</span><span class="ident" id="2511511">verb</span><span class="op" id="2511515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511518">haveDigits</span>&nbsp;<span class="op" id="2511529">:=</span>&nbsp;<span class="builtintype" id="2511532">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511539">if</span>&nbsp;<span class="ident" id="2511542">verb</span>&nbsp;<span class="op" id="2511547">==</span>&nbsp;<span class="string" id="2511550">&#39;U&#39;</span>&nbsp;<span class="op" id="2511554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511558">if</span>&nbsp;<span class="op" id="2511561">!</span><span class="ident" id="2511562">s</span><span class="op" id="2511563">.</span><span class="ident" id="2511564">consume</span><span class="op" id="2511571">(</span><span class="string" id="2511572">&#34;U&#34;</span><span class="op" id="2511575">,</span>&nbsp;<span class="builtintype" id="2511577">false</span><span class="op" id="2511582">)</span>&nbsp;<span class="op" id="2511584">||</span>&nbsp;<span class="op" id="2511587">!</span><span class="ident" id="2511588">s</span><span class="op" id="2511589">.</span><span class="ident" id="2511590">consume</span><span class="op" id="2511597">(</span><span class="string" id="2511598">&#34;+&#34;</span><span class="op" id="2511601">,</span>&nbsp;<span class="builtintype" id="2511603">false</span><span class="op" id="2511608">)</span>&nbsp;<span class="op" id="2511610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511615">s</span><span class="op" id="2511616">.</span><span class="ident" id="2511617">errorString</span><span class="op" id="2511628">(</span><span class="string" id="2511629">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2511650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511657">}</span>&nbsp;<span class="keyword" id="2511659">else</span>&nbsp;<span class="op" id="2511664">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511668">s</span><span class="op" id="2511669">.</span><span class="ident" id="2511670">accept</span><span class="op" id="2511676">(</span><span class="ident" id="2511677">sign</span><span class="op" id="2511681">)</span>&nbsp;<span class="comment" id="2511683">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511744">if</span>&nbsp;<span class="ident" id="2511747">verb</span>&nbsp;<span class="op" id="2511752">==</span>&nbsp;<span class="string" id="2511755">&#39;v&#39;</span>&nbsp;<span class="op" id="2511759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511764">base</span><span class="op" id="2511768">,</span>&nbsp;<span class="ident" id="2511770">digits</span><span class="op" id="2511776">,</span>&nbsp;<span class="ident" id="2511778">haveDigits</span>&nbsp;<span class="op" id="2511789">=</span>&nbsp;<span class="ident" id="2511791">s</span><span class="op" id="2511792">.</span><span class="ident" id="2511793">scanBasePrefix</span><span class="op" id="2511807">(</span><span class="op" id="2511808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511815">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511818">tok</span>&nbsp;<span class="op" id="2511822">:=</span>&nbsp;<span class="ident" id="2511825">s</span><span class="op" id="2511826">.</span><span class="ident" id="2511827">scanNumber</span><span class="op" id="2511837">(</span><span class="ident" id="2511838">digits</span><span class="op" id="2511844">,</span>&nbsp;<span class="ident" id="2511846">haveDigits</span><span class="op" id="2511856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511859">i</span><span class="op" id="2511860">,</span>&nbsp;<span class="ident" id="2511862">err</span>&nbsp;<span class="op" id="2511866">:=</span>&nbsp;<span class="ident" id="2511869">strconv</span><span class="op" id="2511876">.</span><span class="ident" id="2511877">ParseInt</span><span class="op" id="2511885">(</span><span class="ident" id="2511886">tok</span><span class="op" id="2511889">,</span>&nbsp;<span class="ident" id="2511891">base</span><span class="op" id="2511895">,</span>&nbsp;<span class="num" id="2511897">64</span><span class="op" id="2511899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511902">if</span>&nbsp;<span class="ident" id="2511905">err</span>&nbsp;<span class="op" id="2511909">!=</span>&nbsp;<span class="ident" id="2511912">nil</span>&nbsp;<span class="op" id="2511916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511920">s</span><span class="op" id="2511921">.</span><span class="builtintype" id="2511922">error</span><span class="op" id="2511927">(</span><span class="ident" id="2511928">err</span><span class="op" id="2511931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511934">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511937">n</span>&nbsp;<span class="op" id="2511939">:=</span>&nbsp;<span class="builtintype" id="2511942">uint</span><span class="op" id="2511946">(</span><span class="ident" id="2511947">bitSize</span><span class="op" id="2511954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511957">x</span>&nbsp;<span class="op" id="2511959">:=</span>&nbsp;<span class="op" id="2511962">(</span><span class="ident" id="2511963">i</span>&nbsp;<span class="op" id="2511965">&lt;&lt;</span>&nbsp;<span class="op" id="2511968">(</span><span class="num" id="2511969">64</span>&nbsp;<span class="op" id="2511972">-</span>&nbsp;<span class="ident" id="2511974">n</span><span class="op" id="2511975">)</span><span class="op" id="2511976">)</span>&nbsp;<span class="op" id="2511978">&gt;&gt;</span>&nbsp;<span class="op" id="2511981">(</span><span class="num" id="2511982">64</span>&nbsp;<span class="op" id="2511985">-</span>&nbsp;<span class="ident" id="2511987">n</span><span class="op" id="2511988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511991">if</span>&nbsp;<span class="ident" id="2511994">x</span>&nbsp;<span class="op" id="2511996">!=</span>&nbsp;<span class="ident" id="2511999">i</span>&nbsp;<span class="op" id="2512001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512005">s</span><span class="op" id="2512006">.</span><span class="ident" id="2512007">errorString</span><span class="op" id="2512018">(</span><span class="string" id="2512019">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2512048">+</span>&nbsp;<span class="ident" id="2512050">tok</span><span class="op" id="2512053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512056">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512059">return</span>&nbsp;<span class="ident" id="2512066">i</span><br>
<span class="lineno"></span><span class="op" id="2512068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2512071">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="2512137">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="2512213">func</span>&nbsp;<span class="op" id="2512218">(</span><span class="ident" id="2512219">s</span>&nbsp;<span class="op" id="2512221">*</span><span class="ident" id="2512222">ss</span><span class="op" id="2512224">)</span>&nbsp;<span class="ident" id="2512226">scanUint</span><span class="op" id="2512234">(</span><span class="ident" id="2512235">verb</span>&nbsp;<span class="builtintype" id="2512240">rune</span><span class="op" id="2512244">,</span>&nbsp;<span class="ident" id="2512246">bitSize</span>&nbsp;<span class="builtintype" id="2512254">int</span><span class="op" id="2512257">)</span>&nbsp;<span class="ident" id="2512259">uint64</span>&nbsp;<span class="op" id="2512266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512269">if</span>&nbsp;<span class="ident" id="2512272">verb</span>&nbsp;<span class="op" id="2512277">==</span>&nbsp;<span class="string" id="2512280">&#39;c&#39;</span>&nbsp;<span class="op" id="2512284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512288">return</span>&nbsp;<span class="ident" id="2512295">uint64</span><span class="op" id="2512301">(</span><span class="ident" id="2512302">s</span><span class="op" id="2512303">.</span><span class="ident" id="2512304">scanRune</span><span class="op" id="2512312">(</span><span class="ident" id="2512313">bitSize</span><span class="op" id="2512320">)</span><span class="op" id="2512321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512327">s</span><span class="op" id="2512328">.</span><span class="ident" id="2512329">skipSpace</span><span class="op" id="2512338">(</span><span class="builtintype" id="2512339">false</span><span class="op" id="2512344">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512347">s</span><span class="op" id="2512348">.</span><span class="ident" id="2512349">notEOF</span><span class="op" id="2512355">(</span><span class="op" id="2512356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512359">base</span><span class="op" id="2512363">,</span>&nbsp;<span class="ident" id="2512365">digits</span>&nbsp;<span class="op" id="2512372">:=</span>&nbsp;<span class="ident" id="2512375">s</span><span class="op" id="2512376">.</span><span class="ident" id="2512377">getBase</span><span class="op" id="2512384">(</span><span class="ident" id="2512385">verb</span><span class="op" id="2512389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512392">haveDigits</span>&nbsp;<span class="op" id="2512403">:=</span>&nbsp;<span class="builtintype" id="2512406">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512413">if</span>&nbsp;<span class="ident" id="2512416">verb</span>&nbsp;<span class="op" id="2512421">==</span>&nbsp;<span class="string" id="2512424">&#39;U&#39;</span>&nbsp;<span class="op" id="2512428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512432">if</span>&nbsp;<span class="op" id="2512435">!</span><span class="ident" id="2512436">s</span><span class="op" id="2512437">.</span><span class="ident" id="2512438">consume</span><span class="op" id="2512445">(</span><span class="string" id="2512446">&#34;U&#34;</span><span class="op" id="2512449">,</span>&nbsp;<span class="builtintype" id="2512451">false</span><span class="op" id="2512456">)</span>&nbsp;<span class="op" id="2512458">||</span>&nbsp;<span class="op" id="2512461">!</span><span class="ident" id="2512462">s</span><span class="op" id="2512463">.</span><span class="ident" id="2512464">consume</span><span class="op" id="2512471">(</span><span class="string" id="2512472">&#34;+&#34;</span><span class="op" id="2512475">,</span>&nbsp;<span class="builtintype" id="2512477">false</span><span class="op" id="2512482">)</span>&nbsp;<span class="op" id="2512484">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512489">s</span><span class="op" id="2512490">.</span><span class="ident" id="2512491">errorString</span><span class="op" id="2512502">(</span><span class="string" id="2512503">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2512524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512531">}</span>&nbsp;<span class="keyword" id="2512533">else</span>&nbsp;<span class="keyword" id="2512538">if</span>&nbsp;<span class="ident" id="2512541">verb</span>&nbsp;<span class="op" id="2512546">==</span>&nbsp;<span class="string" id="2512549">&#39;v&#39;</span>&nbsp;<span class="op" id="2512553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512557">base</span><span class="op" id="2512561">,</span>&nbsp;<span class="ident" id="2512563">digits</span><span class="op" id="2512569">,</span>&nbsp;<span class="ident" id="2512571">haveDigits</span>&nbsp;<span class="op" id="2512582">=</span>&nbsp;<span class="ident" id="2512584">s</span><span class="op" id="2512585">.</span><span class="ident" id="2512586">scanBasePrefix</span><span class="op" id="2512600">(</span><span class="op" id="2512601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512604">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512607">tok</span>&nbsp;<span class="op" id="2512611">:=</span>&nbsp;<span class="ident" id="2512614">s</span><span class="op" id="2512615">.</span><span class="ident" id="2512616">scanNumber</span><span class="op" id="2512626">(</span><span class="ident" id="2512627">digits</span><span class="op" id="2512633">,</span>&nbsp;<span class="ident" id="2512635">haveDigits</span><span class="op" id="2512645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512648">i</span><span class="op" id="2512649">,</span>&nbsp;<span class="ident" id="2512651">err</span>&nbsp;<span class="op" id="2512655">:=</span>&nbsp;<span class="ident" id="2512658">strconv</span><span class="op" id="2512665">.</span><span class="ident" id="2512666">ParseUint</span><span class="op" id="2512675">(</span><span class="ident" id="2512676">tok</span><span class="op" id="2512679">,</span>&nbsp;<span class="ident" id="2512681">base</span><span class="op" id="2512685">,</span>&nbsp;<span class="num" id="2512687">64</span><span class="op" id="2512689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512692">if</span>&nbsp;<span class="ident" id="2512695">err</span>&nbsp;<span class="op" id="2512699">!=</span>&nbsp;<span class="ident" id="2512702">nil</span>&nbsp;<span class="op" id="2512706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512710">s</span><span class="op" id="2512711">.</span><span class="builtintype" id="2512712">error</span><span class="op" id="2512717">(</span><span class="ident" id="2512718">err</span><span class="op" id="2512721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512724">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512727">n</span>&nbsp;<span class="op" id="2512729">:=</span>&nbsp;<span class="builtintype" id="2512732">uint</span><span class="op" id="2512736">(</span><span class="ident" id="2512737">bitSize</span><span class="op" id="2512744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512747">x</span>&nbsp;<span class="op" id="2512749">:=</span>&nbsp;<span class="op" id="2512752">(</span><span class="ident" id="2512753">i</span>&nbsp;<span class="op" id="2512755">&lt;&lt;</span>&nbsp;<span class="op" id="2512758">(</span><span class="num" id="2512759">64</span>&nbsp;<span class="op" id="2512762">-</span>&nbsp;<span class="ident" id="2512764">n</span><span class="op" id="2512765">)</span><span class="op" id="2512766">)</span>&nbsp;<span class="op" id="2512768">&gt;&gt;</span>&nbsp;<span class="op" id="2512771">(</span><span class="num" id="2512772">64</span>&nbsp;<span class="op" id="2512775">-</span>&nbsp;<span class="ident" id="2512777">n</span><span class="op" id="2512778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512781">if</span>&nbsp;<span class="ident" id="2512784">x</span>&nbsp;<span class="op" id="2512786">!=</span>&nbsp;<span class="ident" id="2512789">i</span>&nbsp;<span class="op" id="2512791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512795">s</span><span class="op" id="2512796">.</span><span class="ident" id="2512797">errorString</span><span class="op" id="2512808">(</span><span class="string" id="2512809">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2512847">+</span>&nbsp;<span class="ident" id="2512849">tok</span><span class="op" id="2512852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512855">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512858">return</span>&nbsp;<span class="ident" id="2512865">i</span><br>
<span class="lineno"></span><span class="op" id="2512867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2512870">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="2512953">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="2513044">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="2513100">func</span>&nbsp;<span class="op" id="2513105">(</span><span class="ident" id="2513106">s</span>&nbsp;<span class="op" id="2513108">*</span><span class="ident" id="2513109">ss</span><span class="op" id="2513111">)</span>&nbsp;<span class="ident" id="2513113">floatToken</span><span class="op" id="2513123">(</span><span class="op" id="2513124">)</span>&nbsp;<span class="builtintype" id="2513126">string</span>&nbsp;<span class="op" id="2513133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513136">s</span><span class="op" id="2513137">.</span><span class="ident" id="2513138">buf</span>&nbsp;<span class="op" id="2513142">=</span>&nbsp;<span class="ident" id="2513144">s</span><span class="op" id="2513145">.</span><span class="ident" id="2513146">buf</span><span class="op" id="2513149">[</span><span class="op" id="2513150">:</span><span class="num" id="2513151">0</span><span class="op" id="2513152">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513155">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513164">if</span>&nbsp;<span class="ident" id="2513167">s</span><span class="op" id="2513168">.</span><span class="ident" id="2513169">accept</span><span class="op" id="2513175">(</span><span class="string" id="2513176">&#34;nN&#34;</span><span class="op" id="2513180">)</span>&nbsp;<span class="op" id="2513182">&amp;&amp;</span>&nbsp;<span class="ident" id="2513185">s</span><span class="op" id="2513186">.</span><span class="ident" id="2513187">accept</span><span class="op" id="2513193">(</span><span class="string" id="2513194">&#34;aA&#34;</span><span class="op" id="2513198">)</span>&nbsp;<span class="op" id="2513200">&amp;&amp;</span>&nbsp;<span class="ident" id="2513203">s</span><span class="op" id="2513204">.</span><span class="ident" id="2513205">accept</span><span class="op" id="2513211">(</span><span class="string" id="2513212">&#34;nN&#34;</span><span class="op" id="2513216">)</span>&nbsp;<span class="op" id="2513218">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513222">return</span>&nbsp;<span class="builtintype" id="2513229">string</span><span class="op" id="2513235">(</span><span class="ident" id="2513236">s</span><span class="op" id="2513237">.</span><span class="ident" id="2513238">buf</span><span class="op" id="2513241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513247">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513265">s</span><span class="op" id="2513266">.</span><span class="ident" id="2513267">accept</span><span class="op" id="2513273">(</span><span class="ident" id="2513274">sign</span><span class="op" id="2513278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513281">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513290">if</span>&nbsp;<span class="ident" id="2513293">s</span><span class="op" id="2513294">.</span><span class="ident" id="2513295">accept</span><span class="op" id="2513301">(</span><span class="string" id="2513302">&#34;iI&#34;</span><span class="op" id="2513306">)</span>&nbsp;<span class="op" id="2513308">&amp;&amp;</span>&nbsp;<span class="ident" id="2513311">s</span><span class="op" id="2513312">.</span><span class="ident" id="2513313">accept</span><span class="op" id="2513319">(</span><span class="string" id="2513320">&#34;nN&#34;</span><span class="op" id="2513324">)</span>&nbsp;<span class="op" id="2513326">&amp;&amp;</span>&nbsp;<span class="ident" id="2513329">s</span><span class="op" id="2513330">.</span><span class="ident" id="2513331">accept</span><span class="op" id="2513337">(</span><span class="string" id="2513338">&#34;fF&#34;</span><span class="op" id="2513342">)</span>&nbsp;<span class="op" id="2513344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513348">return</span>&nbsp;<span class="builtintype" id="2513355">string</span><span class="op" id="2513361">(</span><span class="ident" id="2513362">s</span><span class="op" id="2513363">.</span><span class="ident" id="2513364">buf</span><span class="op" id="2513367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513373">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513385">for</span>&nbsp;<span class="ident" id="2513389">s</span><span class="op" id="2513390">.</span><span class="ident" id="2513391">accept</span><span class="op" id="2513397">(</span><span class="ident" id="2513398">decimalDigits</span><span class="op" id="2513411">)</span>&nbsp;<span class="op" id="2513413">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513419">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513438">if</span>&nbsp;<span class="ident" id="2513441">s</span><span class="op" id="2513442">.</span><span class="ident" id="2513443">accept</span><span class="op" id="2513449">(</span><span class="ident" id="2513450">period</span><span class="op" id="2513456">)</span>&nbsp;<span class="op" id="2513458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513462">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513477">for</span>&nbsp;<span class="ident" id="2513481">s</span><span class="op" id="2513482">.</span><span class="ident" id="2513483">accept</span><span class="op" id="2513489">(</span><span class="ident" id="2513490">decimalDigits</span><span class="op" id="2513503">)</span>&nbsp;<span class="op" id="2513505">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513515">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513529">if</span>&nbsp;<span class="ident" id="2513532">s</span><span class="op" id="2513533">.</span><span class="ident" id="2513534">accept</span><span class="op" id="2513540">(</span><span class="ident" id="2513541">exponent</span><span class="op" id="2513549">)</span>&nbsp;<span class="op" id="2513551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513555">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513574">s</span><span class="op" id="2513575">.</span><span class="ident" id="2513576">accept</span><span class="op" id="2513582">(</span><span class="ident" id="2513583">sign</span><span class="op" id="2513587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513591">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513604">for</span>&nbsp;<span class="ident" id="2513608">s</span><span class="op" id="2513609">.</span><span class="ident" id="2513610">accept</span><span class="op" id="2513616">(</span><span class="ident" id="2513617">decimalDigits</span><span class="op" id="2513630">)</span>&nbsp;<span class="op" id="2513632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513639">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513642">return</span>&nbsp;<span class="builtintype" id="2513649">string</span><span class="op" id="2513655">(</span><span class="ident" id="2513656">s</span><span class="op" id="2513657">.</span><span class="ident" id="2513658">buf</span><span class="op" id="2513661">)</span><br>
<span class="lineno"></span><span class="op" id="2513663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2513666">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="2513757">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="2513848">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="2513890">func</span>&nbsp;<span class="op" id="2513895">(</span><span class="ident" id="2513896">s</span>&nbsp;<span class="op" id="2513898">*</span><span class="ident" id="2513899">ss</span><span class="op" id="2513901">)</span>&nbsp;<span class="ident" id="2513903">complexTokens</span><span class="op" id="2513916">(</span><span class="op" id="2513917">)</span>&nbsp;<span class="op" id="2513919">(</span><span class="builtinfunc" id="2513920">real</span><span class="op" id="2513924">,</span>&nbsp;<span class="builtinfunc" id="2513926">imag</span>&nbsp;<span class="builtintype" id="2513931">string</span><span class="op" id="2513937">)</span>&nbsp;<span class="op" id="2513939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513942">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513983">parens</span>&nbsp;<span class="op" id="2513990">:=</span>&nbsp;<span class="ident" id="2513993">s</span><span class="op" id="2513994">.</span><span class="ident" id="2513995">accept</span><span class="op" id="2514001">(</span><span class="string" id="2514002">&#34;(&#34;</span><span class="op" id="2514005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2514008">real</span>&nbsp;<span class="op" id="2514013">=</span>&nbsp;<span class="ident" id="2514015">s</span><span class="op" id="2514016">.</span><span class="ident" id="2514017">floatToken</span><span class="op" id="2514027">(</span><span class="op" id="2514028">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514031">s</span><span class="op" id="2514032">.</span><span class="ident" id="2514033">buf</span>&nbsp;<span class="op" id="2514037">=</span>&nbsp;<span class="ident" id="2514039">s</span><span class="op" id="2514040">.</span><span class="ident" id="2514041">buf</span><span class="op" id="2514044">[</span><span class="op" id="2514045">:</span><span class="num" id="2514046">0</span><span class="op" id="2514047">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514050">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514076">if</span>&nbsp;<span class="op" id="2514079">!</span><span class="ident" id="2514080">s</span><span class="op" id="2514081">.</span><span class="ident" id="2514082">accept</span><span class="op" id="2514088">(</span><span class="string" id="2514089">&#34;+-&#34;</span><span class="op" id="2514093">)</span>&nbsp;<span class="op" id="2514095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514099">s</span><span class="op" id="2514100">.</span><span class="builtintype" id="2514101">error</span><span class="op" id="2514106">(</span><span class="ident" id="2514107">complexError</span><span class="op" id="2514119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514122">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514125">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514151">imagSign</span>&nbsp;<span class="op" id="2514160">:=</span>&nbsp;<span class="builtintype" id="2514163">string</span><span class="op" id="2514169">(</span><span class="ident" id="2514170">s</span><span class="op" id="2514171">.</span><span class="ident" id="2514172">buf</span><span class="op" id="2514175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2514178">imag</span>&nbsp;<span class="op" id="2514183">=</span>&nbsp;<span class="ident" id="2514185">s</span><span class="op" id="2514186">.</span><span class="ident" id="2514187">floatToken</span><span class="op" id="2514197">(</span><span class="op" id="2514198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514201">if</span>&nbsp;<span class="op" id="2514204">!</span><span class="ident" id="2514205">s</span><span class="op" id="2514206">.</span><span class="ident" id="2514207">accept</span><span class="op" id="2514213">(</span><span class="string" id="2514214">&#34;i&#34;</span><span class="op" id="2514217">)</span>&nbsp;<span class="op" id="2514219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514223">s</span><span class="op" id="2514224">.</span><span class="builtintype" id="2514225">error</span><span class="op" id="2514230">(</span><span class="ident" id="2514231">complexError</span><span class="op" id="2514243">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514249">if</span>&nbsp;<span class="ident" id="2514252">parens</span>&nbsp;<span class="op" id="2514259">&amp;&amp;</span>&nbsp;<span class="op" id="2514262">!</span><span class="ident" id="2514263">s</span><span class="op" id="2514264">.</span><span class="ident" id="2514265">accept</span><span class="op" id="2514271">(</span><span class="string" id="2514272">&#34;)&#34;</span><span class="op" id="2514275">)</span>&nbsp;<span class="op" id="2514277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514281">s</span><span class="op" id="2514282">.</span><span class="builtintype" id="2514283">error</span><span class="op" id="2514288">(</span><span class="ident" id="2514289">complexError</span><span class="op" id="2514301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514307">return</span>&nbsp;<span class="builtinfunc" id="2514314">real</span><span class="op" id="2514318">,</span>&nbsp;<span class="ident" id="2514320">imagSign</span>&nbsp;<span class="op" id="2514329">+</span>&nbsp;<span class="builtinfunc" id="2514331">imag</span><br>
<span class="lineno">770</span><span class="op" id="2514336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2514339">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="2514394">func</span>&nbsp;<span class="op" id="2514399">(</span><span class="ident" id="2514400">s</span>&nbsp;<span class="op" id="2514402">*</span><span class="ident" id="2514403">ss</span><span class="op" id="2514405">)</span>&nbsp;<span class="ident" id="2514407">convertFloat</span><span class="op" id="2514419">(</span><span class="ident" id="2514420">str</span>&nbsp;<span class="builtintype" id="2514424">string</span><span class="op" id="2514430">,</span>&nbsp;<span class="ident" id="2514432">n</span>&nbsp;<span class="builtintype" id="2514434">int</span><span class="op" id="2514437">)</span>&nbsp;<span class="builtintype" id="2514439">float64</span>&nbsp;<span class="op" id="2514447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514450">if</span>&nbsp;<span class="ident" id="2514453">p</span>&nbsp;<span class="op" id="2514455">:=</span>&nbsp;<span class="ident" id="2514458">indexRune</span><span class="op" id="2514467">(</span><span class="ident" id="2514468">str</span><span class="op" id="2514471">,</span>&nbsp;<span class="string" id="2514473">&#39;p&#39;</span><span class="op" id="2514476">)</span><span class="op" id="2514477">;</span>&nbsp;<span class="ident" id="2514479">p</span>&nbsp;<span class="op" id="2514481">&gt;=</span>&nbsp;<span class="num" id="2514484">0</span>&nbsp;<span class="op" id="2514486">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514490">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514537">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514572">f</span><span class="op" id="2514573">,</span>&nbsp;<span class="ident" id="2514575">err</span>&nbsp;<span class="op" id="2514579">:=</span>&nbsp;<span class="ident" id="2514582">strconv</span><span class="op" id="2514589">.</span><span class="ident" id="2514590">ParseFloat</span><span class="op" id="2514600">(</span><span class="ident" id="2514601">str</span><span class="op" id="2514604">[</span><span class="op" id="2514605">:</span><span class="ident" id="2514606">p</span><span class="op" id="2514607">]</span><span class="op" id="2514608">,</span>&nbsp;<span class="ident" id="2514610">n</span><span class="op" id="2514611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514615">if</span>&nbsp;<span class="ident" id="2514618">err</span>&nbsp;<span class="op" id="2514622">!=</span>&nbsp;<span class="ident" id="2514625">nil</span>&nbsp;<span class="op" id="2514629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514634">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514668">if</span>&nbsp;<span class="ident" id="2514671">e</span><span class="op" id="2514672">,</span>&nbsp;<span class="ident" id="2514674">ok</span>&nbsp;<span class="op" id="2514677">:=</span>&nbsp;<span class="ident" id="2514680">err</span><span class="op" id="2514683">.</span><span class="op" id="2514684">(</span><span class="op" id="2514685">*</span><span class="ident" id="2514686">strconv</span><span class="op" id="2514693">.</span><span class="ident" id="2514694">NumError</span><span class="op" id="2514702">)</span><span class="op" id="2514703">;</span>&nbsp;<span class="ident" id="2514705">ok</span>&nbsp;<span class="op" id="2514708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514714">e</span><span class="op" id="2514715">.</span><span class="ident" id="2514716">Num</span>&nbsp;<span class="op" id="2514720">=</span>&nbsp;<span class="ident" id="2514722">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514734">s</span><span class="op" id="2514735">.</span><span class="builtintype" id="2514736">error</span><span class="op" id="2514741">(</span><span class="ident" id="2514742">err</span><span class="op" id="2514745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514749">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514753">m</span><span class="op" id="2514754">,</span>&nbsp;<span class="ident" id="2514756">err</span>&nbsp;<span class="op" id="2514760">:=</span>&nbsp;<span class="ident" id="2514763">strconv</span><span class="op" id="2514770">.</span><span class="ident" id="2514771">Atoi</span><span class="op" id="2514775">(</span><span class="ident" id="2514776">str</span><span class="op" id="2514779">[</span><span class="ident" id="2514780">p</span><span class="op" id="2514781">+</span><span class="num" id="2514782">1</span><span class="op" id="2514783">:</span><span class="op" id="2514784">]</span><span class="op" id="2514785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514789">if</span>&nbsp;<span class="ident" id="2514792">err</span>&nbsp;<span class="op" id="2514796">!=</span>&nbsp;<span class="ident" id="2514799">nil</span>&nbsp;<span class="op" id="2514803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514808">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514842">if</span>&nbsp;<span class="ident" id="2514845">e</span><span class="op" id="2514846">,</span>&nbsp;<span class="ident" id="2514848">ok</span>&nbsp;<span class="op" id="2514851">:=</span>&nbsp;<span class="ident" id="2514854">err</span><span class="op" id="2514857">.</span><span class="op" id="2514858">(</span><span class="op" id="2514859">*</span><span class="ident" id="2514860">strconv</span><span class="op" id="2514867">.</span><span class="ident" id="2514868">NumError</span><span class="op" id="2514876">)</span><span class="op" id="2514877">;</span>&nbsp;<span class="ident" id="2514879">ok</span>&nbsp;<span class="op" id="2514882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514888">e</span><span class="op" id="2514889">.</span><span class="ident" id="2514890">Num</span>&nbsp;<span class="op" id="2514894">=</span>&nbsp;<span class="ident" id="2514896">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514908">s</span><span class="op" id="2514909">.</span><span class="builtintype" id="2514910">error</span><span class="op" id="2514915">(</span><span class="ident" id="2514916">err</span><span class="op" id="2514919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514927">return</span>&nbsp;<span class="ident" id="2514934">math</span><span class="op" id="2514938">.</span><span class="ident" id="2514939">Ldexp</span><span class="op" id="2514944">(</span><span class="ident" id="2514945">f</span><span class="op" id="2514946">,</span>&nbsp;<span class="ident" id="2514948">m</span><span class="op" id="2514949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514952">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514955">f</span><span class="op" id="2514956">,</span>&nbsp;<span class="ident" id="2514958">err</span>&nbsp;<span class="op" id="2514962">:=</span>&nbsp;<span class="ident" id="2514965">strconv</span><span class="op" id="2514972">.</span><span class="ident" id="2514973">ParseFloat</span><span class="op" id="2514983">(</span><span class="ident" id="2514984">str</span><span class="op" id="2514987">,</span>&nbsp;<span class="ident" id="2514989">n</span><span class="op" id="2514990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514993">if</span>&nbsp;<span class="ident" id="2514996">err</span>&nbsp;<span class="op" id="2515000">!=</span>&nbsp;<span class="ident" id="2515003">nil</span>&nbsp;<span class="op" id="2515007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515011">s</span><span class="op" id="2515012">.</span><span class="builtintype" id="2515013">error</span><span class="op" id="2515018">(</span><span class="ident" id="2515019">err</span><span class="op" id="2515022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515028">return</span>&nbsp;<span class="ident" id="2515035">f</span><br>
<span class="lineno">800</span><span class="op" id="2515037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2515040">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2515105">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2515177">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="2515250">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2515320">func</span>&nbsp;<span class="op" id="2515325">(</span><span class="ident" id="2515326">s</span>&nbsp;<span class="op" id="2515328">*</span><span class="ident" id="2515329">ss</span><span class="op" id="2515331">)</span>&nbsp;<span class="ident" id="2515333">scanComplex</span><span class="op" id="2515344">(</span><span class="ident" id="2515345">verb</span>&nbsp;<span class="builtintype" id="2515350">rune</span><span class="op" id="2515354">,</span>&nbsp;<span class="ident" id="2515356">n</span>&nbsp;<span class="builtintype" id="2515358">int</span><span class="op" id="2515361">)</span>&nbsp;<span class="builtintype" id="2515363">complex128</span>&nbsp;<span class="op" id="2515374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515377">if</span>&nbsp;<span class="op" id="2515380">!</span><span class="ident" id="2515381">s</span><span class="op" id="2515382">.</span><span class="ident" id="2515383">okVerb</span><span class="op" id="2515389">(</span><span class="ident" id="2515390">verb</span><span class="op" id="2515394">,</span>&nbsp;<span class="ident" id="2515396">floatVerbs</span><span class="op" id="2515406">,</span>&nbsp;<span class="string" id="2515408">&#34;complex&#34;</span><span class="op" id="2515417">)</span>&nbsp;<span class="op" id="2515419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515423">return</span>&nbsp;<span class="num" id="2515430">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515433">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515436">s</span><span class="op" id="2515437">.</span><span class="ident" id="2515438">skipSpace</span><span class="op" id="2515447">(</span><span class="builtintype" id="2515448">false</span><span class="op" id="2515453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515456">s</span><span class="op" id="2515457">.</span><span class="ident" id="2515458">notEOF</span><span class="op" id="2515464">(</span><span class="op" id="2515465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515468">sreal</span><span class="op" id="2515473">,</span>&nbsp;<span class="ident" id="2515475">simag</span>&nbsp;<span class="op" id="2515481">:=</span>&nbsp;<span class="ident" id="2515484">s</span><span class="op" id="2515485">.</span><span class="ident" id="2515486">complexTokens</span><span class="op" id="2515499">(</span><span class="op" id="2515500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2515503">real</span>&nbsp;<span class="op" id="2515508">:=</span>&nbsp;<span class="ident" id="2515511">s</span><span class="op" id="2515512">.</span><span class="ident" id="2515513">convertFloat</span><span class="op" id="2515525">(</span><span class="ident" id="2515526">sreal</span><span class="op" id="2515531">,</span>&nbsp;<span class="ident" id="2515533">n</span><span class="op" id="2515534">/</span><span class="num" id="2515535">2</span><span class="op" id="2515536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2515539">imag</span>&nbsp;<span class="op" id="2515544">:=</span>&nbsp;<span class="ident" id="2515547">s</span><span class="op" id="2515548">.</span><span class="ident" id="2515549">convertFloat</span><span class="op" id="2515561">(</span><span class="ident" id="2515562">simag</span><span class="op" id="2515567">,</span>&nbsp;<span class="ident" id="2515569">n</span><span class="op" id="2515570">/</span><span class="num" id="2515571">2</span><span class="op" id="2515572">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515575">return</span>&nbsp;<span class="builtinfunc" id="2515582">complex</span><span class="op" id="2515589">(</span><span class="builtinfunc" id="2515590">real</span><span class="op" id="2515594">,</span>&nbsp;<span class="builtinfunc" id="2515596">imag</span><span class="op" id="2515600">)</span><br>
<span class="lineno"></span><span class="op" id="2515602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2515605">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="2515683">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="2515737">func</span>&nbsp;<span class="op" id="2515742">(</span><span class="ident" id="2515743">s</span>&nbsp;<span class="op" id="2515745">*</span><span class="ident" id="2515746">ss</span><span class="op" id="2515748">)</span>&nbsp;<span class="ident" id="2515750">convertString</span><span class="op" id="2515763">(</span><span class="ident" id="2515764">verb</span>&nbsp;<span class="builtintype" id="2515769">rune</span><span class="op" id="2515773">)</span>&nbsp;<span class="op" id="2515775">(</span><span class="ident" id="2515776">str</span>&nbsp;<span class="builtintype" id="2515780">string</span><span class="op" id="2515786">)</span>&nbsp;<span class="op" id="2515788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515791">if</span>&nbsp;<span class="op" id="2515794">!</span><span class="ident" id="2515795">s</span><span class="op" id="2515796">.</span><span class="ident" id="2515797">okVerb</span><span class="op" id="2515803">(</span><span class="ident" id="2515804">verb</span><span class="op" id="2515808">,</span>&nbsp;<span class="string" id="2515810">&#34;svqx&#34;</span><span class="op" id="2515816">,</span>&nbsp;<span class="string" id="2515818">&#34;string&#34;</span><span class="op" id="2515826">)</span>&nbsp;<span class="op" id="2515828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515832">return</span>&nbsp;<span class="string" id="2515839">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515846">s</span><span class="op" id="2515847">.</span><span class="ident" id="2515848">skipSpace</span><span class="op" id="2515857">(</span><span class="builtintype" id="2515858">false</span><span class="op" id="2515863">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515866">s</span><span class="op" id="2515867">.</span><span class="ident" id="2515868">notEOF</span><span class="op" id="2515874">(</span><span class="op" id="2515875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515878">switch</span>&nbsp;<span class="ident" id="2515885">verb</span>&nbsp;<span class="op" id="2515890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515893">case</span>&nbsp;<span class="string" id="2515898">&#39;q&#39;</span><span class="op" id="2515901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515905">str</span>&nbsp;<span class="op" id="2515909">=</span>&nbsp;<span class="ident" id="2515911">s</span><span class="op" id="2515912">.</span><span class="ident" id="2515913">quotedString</span><span class="op" id="2515925">(</span><span class="op" id="2515926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515929">case</span>&nbsp;<span class="string" id="2515934">&#39;x&#39;</span><span class="op" id="2515937">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515941">str</span>&nbsp;<span class="op" id="2515945">=</span>&nbsp;<span class="ident" id="2515947">s</span><span class="op" id="2515948">.</span><span class="ident" id="2515949">hexString</span><span class="op" id="2515958">(</span><span class="op" id="2515959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515962">default</span><span class="op" id="2515969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515973">str</span>&nbsp;<span class="op" id="2515977">=</span>&nbsp;<span class="builtintype" id="2515979">string</span><span class="op" id="2515985">(</span><span class="ident" id="2515986">s</span><span class="op" id="2515987">.</span><span class="ident" id="2515988">token</span><span class="op" id="2515993">(</span><span class="builtintype" id="2515994">true</span><span class="op" id="2515998">,</span>&nbsp;<span class="ident" id="2516000">notSpace</span><span class="op" id="2516008">)</span><span class="op" id="2516009">)</span>&nbsp;<span class="comment" id="2516011">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516054">return</span><br>
<span class="lineno">835</span><span class="op" id="2516061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2516064">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="2516164">func</span>&nbsp;<span class="op" id="2516169">(</span><span class="ident" id="2516170">s</span>&nbsp;<span class="op" id="2516172">*</span><span class="ident" id="2516173">ss</span><span class="op" id="2516175">)</span>&nbsp;<span class="ident" id="2516177">quotedString</span><span class="op" id="2516189">(</span><span class="op" id="2516190">)</span>&nbsp;<span class="builtintype" id="2516192">string</span>&nbsp;<span class="op" id="2516199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516202">s</span><span class="op" id="2516203">.</span><span class="ident" id="2516204">notEOF</span><span class="op" id="2516210">(</span><span class="op" id="2516211">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516214">quote</span>&nbsp;<span class="op" id="2516220">:=</span>&nbsp;<span class="ident" id="2516223">s</span><span class="op" id="2516224">.</span><span class="ident" id="2516225">getRune</span><span class="op" id="2516232">(</span><span class="op" id="2516233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516236">switch</span>&nbsp;<span class="ident" id="2516243">quote</span>&nbsp;<span class="op" id="2516249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516252">case</span>&nbsp;<span class="string" id="2516257">&#39;`&#39;</span><span class="op" id="2516260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2516264">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516321">for</span>&nbsp;<span class="op" id="2516325">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516330">r</span>&nbsp;<span class="op" id="2516332">:=</span>&nbsp;<span class="ident" id="2516335">s</span><span class="op" id="2516336">.</span><span class="ident" id="2516337">mustReadRune</span><span class="op" id="2516349">(</span><span class="op" id="2516350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516355">if</span>&nbsp;<span class="ident" id="2516358">r</span>&nbsp;<span class="op" id="2516360">==</span>&nbsp;<span class="ident" id="2516363">quote</span>&nbsp;<span class="op" id="2516369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516375">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516389">s</span><span class="op" id="2516390">.</span><span class="ident" id="2516391">buf</span><span class="op" id="2516394">.</span><span class="ident" id="2516395">WriteRune</span><span class="op" id="2516404">(</span><span class="ident" id="2516405">r</span><span class="op" id="2516406">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516414">return</span>&nbsp;<span class="builtintype" id="2516421">string</span><span class="op" id="2516427">(</span><span class="ident" id="2516428">s</span><span class="op" id="2516429">.</span><span class="ident" id="2516430">buf</span><span class="op" id="2516433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516436">case</span>&nbsp;<span class="string" id="2516441">&#39;&#34;&#39;</span><span class="op" id="2516444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2516448">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516537">s</span><span class="op" id="2516538">.</span><span class="ident" id="2516539">buf</span><span class="op" id="2516542">.</span><span class="ident" id="2516543">WriteRune</span><span class="op" id="2516552">(</span><span class="ident" id="2516553">quote</span><span class="op" id="2516558">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516562">for</span>&nbsp;<span class="op" id="2516566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516571">r</span>&nbsp;<span class="op" id="2516573">:=</span>&nbsp;<span class="ident" id="2516576">s</span><span class="op" id="2516577">.</span><span class="ident" id="2516578">mustReadRune</span><span class="op" id="2516590">(</span><span class="op" id="2516591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516596">s</span><span class="op" id="2516597">.</span><span class="ident" id="2516598">buf</span><span class="op" id="2516601">.</span><span class="ident" id="2516602">WriteRune</span><span class="op" id="2516611">(</span><span class="ident" id="2516612">r</span><span class="op" id="2516613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516618">if</span>&nbsp;<span class="ident" id="2516621">r</span>&nbsp;<span class="op" id="2516623">==</span>&nbsp;<span class="string" id="2516626">&#39;\\&#39;</span>&nbsp;<span class="op" id="2516631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2516637">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2516712">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2516784">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516861">s</span><span class="op" id="2516862">.</span><span class="ident" id="2516863">buf</span><span class="op" id="2516866">.</span><span class="ident" id="2516867">WriteRune</span><span class="op" id="2516876">(</span><span class="ident" id="2516877">s</span><span class="op" id="2516878">.</span><span class="ident" id="2516879">mustReadRune</span><span class="op" id="2516891">(</span><span class="op" id="2516892">)</span><span class="op" id="2516893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516898">}</span>&nbsp;<span class="keyword" id="2516900">else</span>&nbsp;<span class="keyword" id="2516905">if</span>&nbsp;<span class="ident" id="2516908">r</span>&nbsp;<span class="op" id="2516910">==</span>&nbsp;<span class="string" id="2516913">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2516917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516923">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516940">result</span><span class="op" id="2516946">,</span>&nbsp;<span class="ident" id="2516948">err</span>&nbsp;<span class="op" id="2516952">:=</span>&nbsp;<span class="ident" id="2516955">strconv</span><span class="op" id="2516962">.</span><span class="ident" id="2516963">Unquote</span><span class="op" id="2516970">(</span><span class="builtintype" id="2516971">string</span><span class="op" id="2516977">(</span><span class="ident" id="2516978">s</span><span class="op" id="2516979">.</span><span class="ident" id="2516980">buf</span><span class="op" id="2516983">)</span><span class="op" id="2516984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516988">if</span>&nbsp;<span class="ident" id="2516991">err</span>&nbsp;<span class="op" id="2516995">!=</span>&nbsp;<span class="ident" id="2516998">nil</span>&nbsp;<span class="op" id="2517002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517007">s</span><span class="op" id="2517008">.</span><span class="builtintype" id="2517009">error</span><span class="op" id="2517014">(</span><span class="ident" id="2517015">err</span><span class="op" id="2517018">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517026">return</span>&nbsp;<span class="ident" id="2517033">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517041">default</span><span class="op" id="2517048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517052">s</span><span class="op" id="2517053">.</span><span class="ident" id="2517054">errorString</span><span class="op" id="2517065">(</span><span class="string" id="2517066">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="2517090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517093">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517096">return</span>&nbsp;<span class="string" id="2517103">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2517106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2517109">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="2517164">func</span>&nbsp;<span class="op" id="2517169">(</span><span class="ident" id="2517170">s</span>&nbsp;<span class="op" id="2517172">*</span><span class="ident" id="2517173">ss</span><span class="op" id="2517175">)</span>&nbsp;<span class="ident" id="2517177">hexDigit</span><span class="op" id="2517185">(</span><span class="ident" id="2517186">d</span>&nbsp;<span class="builtintype" id="2517188">rune</span><span class="op" id="2517192">)</span>&nbsp;<span class="builtintype" id="2517194">int</span>&nbsp;<span class="op" id="2517198">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517201">digit</span>&nbsp;<span class="op" id="2517207">:=</span>&nbsp;<span class="builtintype" id="2517210">int</span><span class="op" id="2517213">(</span><span class="ident" id="2517214">d</span><span class="op" id="2517215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517218">switch</span>&nbsp;<span class="ident" id="2517225">digit</span>&nbsp;<span class="op" id="2517231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517234">case</span>&nbsp;<span class="string" id="2517239">&#39;0&#39;</span><span class="op" id="2517242">,</span>&nbsp;<span class="string" id="2517244">&#39;1&#39;</span><span class="op" id="2517247">,</span>&nbsp;<span class="string" id="2517249">&#39;2&#39;</span><span class="op" id="2517252">,</span>&nbsp;<span class="string" id="2517254">&#39;3&#39;</span><span class="op" id="2517257">,</span>&nbsp;<span class="string" id="2517259">&#39;4&#39;</span><span class="op" id="2517262">,</span>&nbsp;<span class="string" id="2517264">&#39;5&#39;</span><span class="op" id="2517267">,</span>&nbsp;<span class="string" id="2517269">&#39;6&#39;</span><span class="op" id="2517272">,</span>&nbsp;<span class="string" id="2517274">&#39;7&#39;</span><span class="op" id="2517277">,</span>&nbsp;<span class="string" id="2517279">&#39;8&#39;</span><span class="op" id="2517282">,</span>&nbsp;<span class="string" id="2517284">&#39;9&#39;</span><span class="op" id="2517287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517291">return</span>&nbsp;<span class="ident" id="2517298">digit</span>&nbsp;<span class="op" id="2517304">-</span>&nbsp;<span class="string" id="2517306">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517311">case</span>&nbsp;<span class="string" id="2517316">&#39;a&#39;</span><span class="op" id="2517319">,</span>&nbsp;<span class="string" id="2517321">&#39;b&#39;</span><span class="op" id="2517324">,</span>&nbsp;<span class="string" id="2517326">&#39;c&#39;</span><span class="op" id="2517329">,</span>&nbsp;<span class="string" id="2517331">&#39;d&#39;</span><span class="op" id="2517334">,</span>&nbsp;<span class="string" id="2517336">&#39;e&#39;</span><span class="op" id="2517339">,</span>&nbsp;<span class="string" id="2517341">&#39;f&#39;</span><span class="op" id="2517344">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517348">return</span>&nbsp;<span class="num" id="2517355">10</span>&nbsp;<span class="op" id="2517358">+</span>&nbsp;<span class="ident" id="2517360">digit</span>&nbsp;<span class="op" id="2517366">-</span>&nbsp;<span class="string" id="2517368">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517373">case</span>&nbsp;<span class="string" id="2517378">&#39;A&#39;</span><span class="op" id="2517381">,</span>&nbsp;<span class="string" id="2517383">&#39;B&#39;</span><span class="op" id="2517386">,</span>&nbsp;<span class="string" id="2517388">&#39;C&#39;</span><span class="op" id="2517391">,</span>&nbsp;<span class="string" id="2517393">&#39;D&#39;</span><span class="op" id="2517396">,</span>&nbsp;<span class="string" id="2517398">&#39;E&#39;</span><span class="op" id="2517401">,</span>&nbsp;<span class="string" id="2517403">&#39;F&#39;</span><span class="op" id="2517406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517410">return</span>&nbsp;<span class="num" id="2517417">10</span>&nbsp;<span class="op" id="2517420">+</span>&nbsp;<span class="ident" id="2517422">digit</span>&nbsp;<span class="op" id="2517428">-</span>&nbsp;<span class="string" id="2517430">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517438">s</span><span class="op" id="2517439">.</span><span class="ident" id="2517440">errorString</span><span class="op" id="2517451">(</span><span class="string" id="2517452">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="2517471">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517474">return</span>&nbsp;<span class="num" id="2517481">0</span><br>
<span class="lineno"></span><span class="op" id="2517483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2517486">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2517563">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="2517645">func</span>&nbsp;<span class="op" id="2517650">(</span><span class="ident" id="2517651">s</span>&nbsp;<span class="op" id="2517653">*</span><span class="ident" id="2517654">ss</span><span class="op" id="2517656">)</span>&nbsp;<span class="ident" id="2517658">hexByte</span><span class="op" id="2517665">(</span><span class="op" id="2517666">)</span>&nbsp;<span class="op" id="2517668">(</span><span class="ident" id="2517669">b</span>&nbsp;<span class="builtintype" id="2517671">byte</span><span class="op" id="2517675">,</span>&nbsp;<span class="ident" id="2517677">ok</span>&nbsp;<span class="builtintype" id="2517680">bool</span><span class="op" id="2517684">)</span>&nbsp;<span class="op" id="2517686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517689">rune1</span>&nbsp;<span class="op" id="2517695">:=</span>&nbsp;<span class="ident" id="2517698">s</span><span class="op" id="2517699">.</span><span class="ident" id="2517700">getRune</span><span class="op" id="2517707">(</span><span class="op" id="2517708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517711">if</span>&nbsp;<span class="ident" id="2517714">rune1</span>&nbsp;<span class="op" id="2517720">==</span>&nbsp;<span class="ident" id="2517723">eof</span>&nbsp;<span class="op" id="2517727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517731">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517739">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517742">if</span>&nbsp;<span class="ident" id="2517745">isSpace</span><span class="op" id="2517752">(</span><span class="ident" id="2517753">rune1</span><span class="op" id="2517758">)</span>&nbsp;<span class="op" id="2517760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517764">s</span><span class="op" id="2517765">.</span><span class="ident" id="2517766">UnreadRune</span><span class="op" id="2517776">(</span><span class="op" id="2517777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517781">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517792">rune2</span>&nbsp;<span class="op" id="2517798">:=</span>&nbsp;<span class="ident" id="2517801">s</span><span class="op" id="2517802">.</span><span class="ident" id="2517803">mustReadRune</span><span class="op" id="2517815">(</span><span class="op" id="2517816">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517819">return</span>&nbsp;<span class="builtintype" id="2517826">byte</span><span class="op" id="2517830">(</span><span class="ident" id="2517831">s</span><span class="op" id="2517832">.</span><span class="ident" id="2517833">hexDigit</span><span class="op" id="2517841">(</span><span class="ident" id="2517842">rune1</span><span class="op" id="2517847">)</span><span class="op" id="2517848">&lt;&lt;</span><span class="num" id="2517850">4</span>&nbsp;<span class="op" id="2517852">|</span>&nbsp;<span class="ident" id="2517854">s</span><span class="op" id="2517855">.</span><span class="ident" id="2517856">hexDigit</span><span class="op" id="2517864">(</span><span class="ident" id="2517865">rune2</span><span class="op" id="2517870">)</span><span class="op" id="2517871">)</span><span class="op" id="2517872">,</span>&nbsp;<span class="builtintype" id="2517874">true</span><br>
<span class="lineno"></span><span class="op" id="2517879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2517882">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2517947">func</span>&nbsp;<span class="op" id="2517952">(</span><span class="ident" id="2517953">s</span>&nbsp;<span class="op" id="2517955">*</span><span class="ident" id="2517956">ss</span><span class="op" id="2517958">)</span>&nbsp;<span class="ident" id="2517960">hexString</span><span class="op" id="2517969">(</span><span class="op" id="2517970">)</span>&nbsp;<span class="builtintype" id="2517972">string</span>&nbsp;<span class="op" id="2517979">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517982">s</span><span class="op" id="2517983">.</span><span class="ident" id="2517984">notEOF</span><span class="op" id="2517990">(</span><span class="op" id="2517991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517994">for</span>&nbsp;<span class="op" id="2517998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518002">b</span><span class="op" id="2518003">,</span>&nbsp;<span class="ident" id="2518005">ok</span>&nbsp;<span class="op" id="2518008">:=</span>&nbsp;<span class="ident" id="2518011">s</span><span class="op" id="2518012">.</span><span class="ident" id="2518013">hexByte</span><span class="op" id="2518020">(</span><span class="op" id="2518021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518025">if</span>&nbsp;<span class="op" id="2518028">!</span><span class="ident" id="2518029">ok</span>&nbsp;<span class="op" id="2518032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518037">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518049">s</span><span class="op" id="2518050">.</span><span class="ident" id="2518051">buf</span><span class="op" id="2518054">.</span><span class="ident" id="2518055">WriteByte</span><span class="op" id="2518064">(</span><span class="ident" id="2518065">b</span><span class="op" id="2518066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518072">if</span>&nbsp;<span class="builtinfunc" id="2518075">len</span><span class="op" id="2518078">(</span><span class="ident" id="2518079">s</span><span class="op" id="2518080">.</span><span class="ident" id="2518081">buf</span><span class="op" id="2518084">)</span>&nbsp;<span class="op" id="2518086">==</span>&nbsp;<span class="num" id="2518089">0</span>&nbsp;<span class="op" id="2518091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518095">s</span><span class="op" id="2518096">.</span><span class="ident" id="2518097">errorString</span><span class="op" id="2518108">(</span><span class="string" id="2518109">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="2518136">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518140">return</span>&nbsp;<span class="string" id="2518147">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518154">return</span>&nbsp;<span class="builtintype" id="2518161">string</span><span class="op" id="2518167">(</span><span class="ident" id="2518168">s</span><span class="op" id="2518169">.</span><span class="ident" id="2518170">buf</span><span class="op" id="2518173">)</span><br>
<span class="lineno"></span><span class="op" id="2518175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="2518178">const</span>&nbsp;<span class="ident" id="2518184">floatVerbs</span>&nbsp;<span class="op" id="2518195">=</span>&nbsp;<span class="string" id="2518197">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2518209">const</span>&nbsp;<span class="ident" id="2518215">hugeWid</span>&nbsp;<span class="op" id="2518223">=</span>&nbsp;<span class="num" id="2518225">1</span>&nbsp;<span class="op" id="2518227">&lt;&lt;</span>&nbsp;<span class="num" id="2518230">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2518234">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="2518319">func</span>&nbsp;<span class="op" id="2518324">(</span><span class="ident" id="2518325">s</span>&nbsp;<span class="op" id="2518327">*</span><span class="ident" id="2518328">ss</span><span class="op" id="2518330">)</span>&nbsp;<span class="ident" id="2518332">scanOne</span><span class="op" id="2518339">(</span><span class="ident" id="2518340">verb</span>&nbsp;<span class="builtintype" id="2518345">rune</span><span class="op" id="2518349">,</span>&nbsp;<span class="ident" id="2518351">arg</span>&nbsp;<span class="keyword" id="2518355">interface</span><span class="op" id="2518364">{</span><span class="op" id="2518365">}</span><span class="op" id="2518366">)</span>&nbsp;<span class="op" id="2518368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518371">s</span><span class="op" id="2518372">.</span><span class="ident" id="2518373">buf</span>&nbsp;<span class="op" id="2518377">=</span>&nbsp;<span class="ident" id="2518379">s</span><span class="op" id="2518380">.</span><span class="ident" id="2518381">buf</span><span class="op" id="2518384">[</span><span class="op" id="2518385">:</span><span class="num" id="2518386">0</span><span class="op" id="2518387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518390">var</span>&nbsp;<span class="ident" id="2518394">err</span>&nbsp;<span class="builtintype" id="2518398">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2518405">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518461">if</span>&nbsp;<span class="ident" id="2518464">v</span><span class="op" id="2518465">,</span>&nbsp;<span class="ident" id="2518467">ok</span>&nbsp;<span class="op" id="2518470">:=</span>&nbsp;<span class="ident" id="2518473">arg</span><span class="op" id="2518476">.</span><span class="op" id="2518477">(</span><span class="ident" id="2518478">Scanner</span><span class="op" id="2518485">)</span><span class="op" id="2518486">;</span>&nbsp;<span class="ident" id="2518488">ok</span>&nbsp;<span class="op" id="2518491">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518495">err</span>&nbsp;<span class="op" id="2518499">=</span>&nbsp;<span class="ident" id="2518501">v</span><span class="op" id="2518502">.</span><span class="ident" id="2518503">Scan</span><span class="op" id="2518507">(</span><span class="ident" id="2518508">s</span><span class="op" id="2518509">,</span>&nbsp;<span class="ident" id="2518511">verb</span><span class="op" id="2518515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518519">if</span>&nbsp;<span class="ident" id="2518522">err</span>&nbsp;<span class="op" id="2518526">!=</span>&nbsp;<span class="ident" id="2518529">nil</span>&nbsp;<span class="op" id="2518533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518538">if</span>&nbsp;<span class="ident" id="2518541">err</span>&nbsp;<span class="op" id="2518545">==</span>&nbsp;<span class="ident" id="2518548">io</span><span class="op" id="2518550">.</span><span class="ident" id="2518551">EOF</span>&nbsp;<span class="op" id="2518555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518561">err</span>&nbsp;<span class="op" id="2518565">=</span>&nbsp;<span class="ident" id="2518567">io</span><span class="op" id="2518569">.</span><span class="ident" id="2518570">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518590">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518595">s</span><span class="op" id="2518596">.</span><span class="builtintype" id="2518597">error</span><span class="op" id="2518602">(</span><span class="ident" id="2518603">err</span><span class="op" id="2518606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518614">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518626">switch</span>&nbsp;<span class="ident" id="2518633">v</span>&nbsp;<span class="op" id="2518635">:=</span>&nbsp;<span class="ident" id="2518638">arg</span><span class="op" id="2518641">.</span><span class="op" id="2518642">(</span><span class="keyword" id="2518643">type</span><span class="op" id="2518647">)</span>&nbsp;<span class="op" id="2518649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518652">case</span>&nbsp;<span class="op" id="2518657">*</span><span class="builtintype" id="2518658">bool</span><span class="op" id="2518662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518666">*</span><span class="ident" id="2518667">v</span>&nbsp;<span class="op" id="2518669">=</span>&nbsp;<span class="ident" id="2518671">s</span><span class="op" id="2518672">.</span><span class="ident" id="2518673">scanBool</span><span class="op" id="2518681">(</span><span class="ident" id="2518682">verb</span><span class="op" id="2518686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518689">case</span>&nbsp;<span class="op" id="2518694">*</span><span class="builtintype" id="2518695">complex64</span><span class="op" id="2518704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518708">*</span><span class="ident" id="2518709">v</span>&nbsp;<span class="op" id="2518711">=</span>&nbsp;<span class="builtintype" id="2518713">complex64</span><span class="op" id="2518722">(</span><span class="ident" id="2518723">s</span><span class="op" id="2518724">.</span><span class="ident" id="2518725">scanComplex</span><span class="op" id="2518736">(</span><span class="ident" id="2518737">verb</span><span class="op" id="2518741">,</span>&nbsp;<span class="num" id="2518743">64</span><span class="op" id="2518745">)</span><span class="op" id="2518746">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518749">case</span>&nbsp;<span class="op" id="2518754">*</span><span class="builtintype" id="2518755">complex128</span><span class="op" id="2518765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518769">*</span><span class="ident" id="2518770">v</span>&nbsp;<span class="op" id="2518772">=</span>&nbsp;<span class="ident" id="2518774">s</span><span class="op" id="2518775">.</span><span class="ident" id="2518776">scanComplex</span><span class="op" id="2518787">(</span><span class="ident" id="2518788">verb</span><span class="op" id="2518792">,</span>&nbsp;<span class="num" id="2518794">128</span><span class="op" id="2518797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518800">case</span>&nbsp;<span class="op" id="2518805">*</span><span class="builtintype" id="2518806">int</span><span class="op" id="2518809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518813">*</span><span class="ident" id="2518814">v</span>&nbsp;<span class="op" id="2518816">=</span>&nbsp;<span class="builtintype" id="2518818">int</span><span class="op" id="2518821">(</span><span class="ident" id="2518822">s</span><span class="op" id="2518823">.</span><span class="ident" id="2518824">scanInt</span><span class="op" id="2518831">(</span><span class="ident" id="2518832">verb</span><span class="op" id="2518836">,</span>&nbsp;<span class="ident" id="2518838">intBits</span><span class="op" id="2518845">)</span><span class="op" id="2518846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518849">case</span>&nbsp;<span class="op" id="2518854">*</span><span class="builtintype" id="2518855">int8</span><span class="op" id="2518859">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518863">*</span><span class="ident" id="2518864">v</span>&nbsp;<span class="op" id="2518866">=</span>&nbsp;<span class="builtintype" id="2518868">int8</span><span class="op" id="2518872">(</span><span class="ident" id="2518873">s</span><span class="op" id="2518874">.</span><span class="ident" id="2518875">scanInt</span><span class="op" id="2518882">(</span><span class="ident" id="2518883">verb</span><span class="op" id="2518887">,</span>&nbsp;<span class="num" id="2518889">8</span><span class="op" id="2518890">)</span><span class="op" id="2518891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518894">case</span>&nbsp;<span class="op" id="2518899">*</span><span class="builtintype" id="2518900">int16</span><span class="op" id="2518905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518909">*</span><span class="ident" id="2518910">v</span>&nbsp;<span class="op" id="2518912">=</span>&nbsp;<span class="builtintype" id="2518914">int16</span><span class="op" id="2518919">(</span><span class="ident" id="2518920">s</span><span class="op" id="2518921">.</span><span class="ident" id="2518922">scanInt</span><span class="op" id="2518929">(</span><span class="ident" id="2518930">verb</span><span class="op" id="2518934">,</span>&nbsp;<span class="num" id="2518936">16</span><span class="op" id="2518938">)</span><span class="op" id="2518939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518942">case</span>&nbsp;<span class="op" id="2518947">*</span><span class="builtintype" id="2518948">int32</span><span class="op" id="2518953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518957">*</span><span class="ident" id="2518958">v</span>&nbsp;<span class="op" id="2518960">=</span>&nbsp;<span class="builtintype" id="2518962">int32</span><span class="op" id="2518967">(</span><span class="ident" id="2518968">s</span><span class="op" id="2518969">.</span><span class="ident" id="2518970">scanInt</span><span class="op" id="2518977">(</span><span class="ident" id="2518978">verb</span><span class="op" id="2518982">,</span>&nbsp;<span class="num" id="2518984">32</span><span class="op" id="2518986">)</span><span class="op" id="2518987">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518990">case</span>&nbsp;<span class="op" id="2518995">*</span><span class="ident" id="2518996">int64</span><span class="op" id="2519001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519005">*</span><span class="ident" id="2519006">v</span>&nbsp;<span class="op" id="2519008">=</span>&nbsp;<span class="ident" id="2519010">s</span><span class="op" id="2519011">.</span><span class="ident" id="2519012">scanInt</span><span class="op" id="2519019">(</span><span class="ident" id="2519020">verb</span><span class="op" id="2519024">,</span>&nbsp;<span class="num" id="2519026">64</span><span class="op" id="2519028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519031">case</span>&nbsp;<span class="op" id="2519036">*</span><span class="builtintype" id="2519037">uint</span><span class="op" id="2519041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519045">*</span><span class="ident" id="2519046">v</span>&nbsp;<span class="op" id="2519048">=</span>&nbsp;<span class="builtintype" id="2519050">uint</span><span class="op" id="2519054">(</span><span class="ident" id="2519055">s</span><span class="op" id="2519056">.</span><span class="ident" id="2519057">scanUint</span><span class="op" id="2519065">(</span><span class="ident" id="2519066">verb</span><span class="op" id="2519070">,</span>&nbsp;<span class="ident" id="2519072">intBits</span><span class="op" id="2519079">)</span><span class="op" id="2519080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519083">case</span>&nbsp;<span class="op" id="2519088">*</span><span class="builtintype" id="2519089">uint8</span><span class="op" id="2519094">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519098">*</span><span class="ident" id="2519099">v</span>&nbsp;<span class="op" id="2519101">=</span>&nbsp;<span class="builtintype" id="2519103">uint8</span><span class="op" id="2519108">(</span><span class="ident" id="2519109">s</span><span class="op" id="2519110">.</span><span class="ident" id="2519111">scanUint</span><span class="op" id="2519119">(</span><span class="ident" id="2519120">verb</span><span class="op" id="2519124">,</span>&nbsp;<span class="num" id="2519126">8</span><span class="op" id="2519127">)</span><span class="op" id="2519128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519131">case</span>&nbsp;<span class="op" id="2519136">*</span><span class="builtintype" id="2519137">uint16</span><span class="op" id="2519143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519147">*</span><span class="ident" id="2519148">v</span>&nbsp;<span class="op" id="2519150">=</span>&nbsp;<span class="builtintype" id="2519152">uint16</span><span class="op" id="2519158">(</span><span class="ident" id="2519159">s</span><span class="op" id="2519160">.</span><span class="ident" id="2519161">scanUint</span><span class="op" id="2519169">(</span><span class="ident" id="2519170">verb</span><span class="op" id="2519174">,</span>&nbsp;<span class="num" id="2519176">16</span><span class="op" id="2519178">)</span><span class="op" id="2519179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519182">case</span>&nbsp;<span class="op" id="2519187">*</span><span class="builtintype" id="2519188">uint32</span><span class="op" id="2519194">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519198">*</span><span class="ident" id="2519199">v</span>&nbsp;<span class="op" id="2519201">=</span>&nbsp;<span class="builtintype" id="2519203">uint32</span><span class="op" id="2519209">(</span><span class="ident" id="2519210">s</span><span class="op" id="2519211">.</span><span class="ident" id="2519212">scanUint</span><span class="op" id="2519220">(</span><span class="ident" id="2519221">verb</span><span class="op" id="2519225">,</span>&nbsp;<span class="num" id="2519227">32</span><span class="op" id="2519229">)</span><span class="op" id="2519230">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519233">case</span>&nbsp;<span class="op" id="2519238">*</span><span class="ident" id="2519239">uint64</span><span class="op" id="2519245">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519249">*</span><span class="ident" id="2519250">v</span>&nbsp;<span class="op" id="2519252">=</span>&nbsp;<span class="ident" id="2519254">s</span><span class="op" id="2519255">.</span><span class="ident" id="2519256">scanUint</span><span class="op" id="2519264">(</span><span class="ident" id="2519265">verb</span><span class="op" id="2519269">,</span>&nbsp;<span class="num" id="2519271">64</span><span class="op" id="2519273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519276">case</span>&nbsp;<span class="op" id="2519281">*</span><span class="builtintype" id="2519282">uintptr</span><span class="op" id="2519289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519293">*</span><span class="ident" id="2519294">v</span>&nbsp;<span class="op" id="2519296">=</span>&nbsp;<span class="builtintype" id="2519298">uintptr</span><span class="op" id="2519305">(</span><span class="ident" id="2519306">s</span><span class="op" id="2519307">.</span><span class="ident" id="2519308">scanUint</span><span class="op" id="2519316">(</span><span class="ident" id="2519317">verb</span><span class="op" id="2519321">,</span>&nbsp;<span class="ident" id="2519323">uintptrBits</span><span class="op" id="2519334">)</span><span class="op" id="2519335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519338">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519421">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519511">case</span>&nbsp;<span class="op" id="2519516">*</span><span class="builtintype" id="2519517">float32</span><span class="op" id="2519524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519528">if</span>&nbsp;<span class="ident" id="2519531">s</span><span class="op" id="2519532">.</span><span class="ident" id="2519533">okVerb</span><span class="op" id="2519539">(</span><span class="ident" id="2519540">verb</span><span class="op" id="2519544">,</span>&nbsp;<span class="ident" id="2519546">floatVerbs</span><span class="op" id="2519556">,</span>&nbsp;<span class="string" id="2519558">&#34;float32&#34;</span><span class="op" id="2519567">)</span>&nbsp;<span class="op" id="2519569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519574">s</span><span class="op" id="2519575">.</span><span class="ident" id="2519576">skipSpace</span><span class="op" id="2519585">(</span><span class="builtintype" id="2519586">false</span><span class="op" id="2519591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519596">s</span><span class="op" id="2519597">.</span><span class="ident" id="2519598">notEOF</span><span class="op" id="2519604">(</span><span class="op" id="2519605">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519610">*</span><span class="ident" id="2519611">v</span>&nbsp;<span class="op" id="2519613">=</span>&nbsp;<span class="builtintype" id="2519615">float32</span><span class="op" id="2519622">(</span><span class="ident" id="2519623">s</span><span class="op" id="2519624">.</span><span class="ident" id="2519625">convertFloat</span><span class="op" id="2519637">(</span><span class="ident" id="2519638">s</span><span class="op" id="2519639">.</span><span class="ident" id="2519640">floatToken</span><span class="op" id="2519650">(</span><span class="op" id="2519651">)</span><span class="op" id="2519652">,</span>&nbsp;<span class="num" id="2519654">32</span><span class="op" id="2519656">)</span><span class="op" id="2519657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519664">case</span>&nbsp;<span class="op" id="2519669">*</span><span class="builtintype" id="2519670">float64</span><span class="op" id="2519677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519681">if</span>&nbsp;<span class="ident" id="2519684">s</span><span class="op" id="2519685">.</span><span class="ident" id="2519686">okVerb</span><span class="op" id="2519692">(</span><span class="ident" id="2519693">verb</span><span class="op" id="2519697">,</span>&nbsp;<span class="ident" id="2519699">floatVerbs</span><span class="op" id="2519709">,</span>&nbsp;<span class="string" id="2519711">&#34;float64&#34;</span><span class="op" id="2519720">)</span>&nbsp;<span class="op" id="2519722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519727">s</span><span class="op" id="2519728">.</span><span class="ident" id="2519729">skipSpace</span><span class="op" id="2519738">(</span><span class="builtintype" id="2519739">false</span><span class="op" id="2519744">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519749">s</span><span class="op" id="2519750">.</span><span class="ident" id="2519751">notEOF</span><span class="op" id="2519757">(</span><span class="op" id="2519758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519763">*</span><span class="ident" id="2519764">v</span>&nbsp;<span class="op" id="2519766">=</span>&nbsp;<span class="ident" id="2519768">s</span><span class="op" id="2519769">.</span><span class="ident" id="2519770">convertFloat</span><span class="op" id="2519782">(</span><span class="ident" id="2519783">s</span><span class="op" id="2519784">.</span><span class="ident" id="2519785">floatToken</span><span class="op" id="2519795">(</span><span class="op" id="2519796">)</span><span class="op" id="2519797">,</span>&nbsp;<span class="num" id="2519799">64</span><span class="op" id="2519801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519808">case</span>&nbsp;<span class="op" id="2519813">*</span><span class="builtintype" id="2519814">string</span><span class="op" id="2519820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519824">*</span><span class="ident" id="2519825">v</span>&nbsp;<span class="op" id="2519827">=</span>&nbsp;<span class="ident" id="2519829">s</span><span class="op" id="2519830">.</span><span class="ident" id="2519831">convertString</span><span class="op" id="2519844">(</span><span class="ident" id="2519845">verb</span><span class="op" id="2519849">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519852">case</span>&nbsp;<span class="op" id="2519857">*</span><span class="op" id="2519858">[</span><span class="op" id="2519859">]</span><span class="builtintype" id="2519860">byte</span><span class="op" id="2519864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519868">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519933">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519999">*</span><span class="ident" id="2520000">v</span>&nbsp;<span class="op" id="2520002">=</span>&nbsp;<span class="op" id="2520004">[</span><span class="op" id="2520005">]</span><span class="builtintype" id="2520006">byte</span><span class="op" id="2520010">(</span><span class="ident" id="2520011">s</span><span class="op" id="2520012">.</span><span class="ident" id="2520013">convertString</span><span class="op" id="2520026">(</span><span class="ident" id="2520027">verb</span><span class="op" id="2520031">)</span><span class="op" id="2520032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520035">default</span><span class="op" id="2520042">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520046">val</span>&nbsp;<span class="op" id="2520050">:=</span>&nbsp;<span class="ident" id="2520053">reflect</span><span class="op" id="2520060">.</span><span class="ident" id="2520061">ValueOf</span><span class="op" id="2520068">(</span><span class="ident" id="2520069">v</span><span class="op" id="2520070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520074">ptr</span>&nbsp;<span class="op" id="2520078">:=</span>&nbsp;<span class="ident" id="2520081">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520087">if</span>&nbsp;<span class="ident" id="2520090">ptr</span><span class="op" id="2520093">.</span><span class="ident" id="2520094">Kind</span><span class="op" id="2520098">(</span><span class="op" id="2520099">)</span>&nbsp;<span class="op" id="2520101">!=</span>&nbsp;<span class="ident" id="2520104">reflect</span><span class="op" id="2520111">.</span><span class="ident" id="2520112">Ptr</span>&nbsp;<span class="op" id="2520116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520121">s</span><span class="op" id="2520122">.</span><span class="ident" id="2520123">errorString</span><span class="op" id="2520134">(</span><span class="string" id="2520135">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="2520158">+</span>&nbsp;<span class="ident" id="2520160">val</span><span class="op" id="2520163">.</span><span class="ident" id="2520164">Type</span><span class="op" id="2520168">(</span><span class="op" id="2520169">)</span><span class="op" id="2520170">.</span><span class="ident" id="2520171">String</span><span class="op" id="2520177">(</span><span class="op" id="2520178">)</span><span class="op" id="2520179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520184">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2520193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520197">switch</span>&nbsp;<span class="ident" id="2520204">v</span>&nbsp;<span class="op" id="2520206">:=</span>&nbsp;<span class="ident" id="2520209">ptr</span><span class="op" id="2520212">.</span><span class="ident" id="2520213">Elem</span><span class="op" id="2520217">(</span><span class="op" id="2520218">)</span><span class="op" id="2520219">;</span>&nbsp;<span class="ident" id="2520221">v</span><span class="op" id="2520222">.</span><span class="ident" id="2520223">Kind</span><span class="op" id="2520227">(</span><span class="op" id="2520228">)</span>&nbsp;<span class="op" id="2520230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520234">case</span>&nbsp;<span class="ident" id="2520239">reflect</span><span class="op" id="2520246">.</span><span class="ident" id="2520247">Bool</span><span class="op" id="2520251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520256">v</span><span class="op" id="2520257">.</span><span class="ident" id="2520258">SetBool</span><span class="op" id="2520265">(</span><span class="ident" id="2520266">s</span><span class="op" id="2520267">.</span><span class="ident" id="2520268">scanBool</span><span class="op" id="2520276">(</span><span class="ident" id="2520277">verb</span><span class="op" id="2520281">)</span><span class="op" id="2520282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520286">case</span>&nbsp;<span class="ident" id="2520291">reflect</span><span class="op" id="2520298">.</span><span class="ident" id="2520299">Int</span><span class="op" id="2520302">,</span>&nbsp;<span class="ident" id="2520304">reflect</span><span class="op" id="2520311">.</span><span class="ident" id="2520312">Int8</span><span class="op" id="2520316">,</span>&nbsp;<span class="ident" id="2520318">reflect</span><span class="op" id="2520325">.</span><span class="ident" id="2520326">Int16</span><span class="op" id="2520331">,</span>&nbsp;<span class="ident" id="2520333">reflect</span><span class="op" id="2520340">.</span><span class="ident" id="2520341">Int32</span><span class="op" id="2520346">,</span>&nbsp;<span class="ident" id="2520348">reflect</span><span class="op" id="2520355">.</span><span class="ident" id="2520356">Int64</span><span class="op" id="2520361">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520366">v</span><span class="op" id="2520367">.</span><span class="ident" id="2520368">SetInt</span><span class="op" id="2520374">(</span><span class="ident" id="2520375">s</span><span class="op" id="2520376">.</span><span class="ident" id="2520377">scanInt</span><span class="op" id="2520384">(</span><span class="ident" id="2520385">verb</span><span class="op" id="2520389">,</span>&nbsp;<span class="ident" id="2520391">v</span><span class="op" id="2520392">.</span><span class="ident" id="2520393">Type</span><span class="op" id="2520397">(</span><span class="op" id="2520398">)</span><span class="op" id="2520399">.</span><span class="ident" id="2520400">Bits</span><span class="op" id="2520404">(</span><span class="op" id="2520405">)</span><span class="op" id="2520406">)</span><span class="op" id="2520407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520411">case</span>&nbsp;<span class="ident" id="2520416">reflect</span><span class="op" id="2520423">.</span><span class="ident" id="2520424">Uint</span><span class="op" id="2520428">,</span>&nbsp;<span class="ident" id="2520430">reflect</span><span class="op" id="2520437">.</span><span class="ident" id="2520438">Uint8</span><span class="op" id="2520443">,</span>&nbsp;<span class="ident" id="2520445">reflect</span><span class="op" id="2520452">.</span><span class="ident" id="2520453">Uint16</span><span class="op" id="2520459">,</span>&nbsp;<span class="ident" id="2520461">reflect</span><span class="op" id="2520468">.</span><span class="ident" id="2520469">Uint32</span><span class="op" id="2520475">,</span>&nbsp;<span class="ident" id="2520477">reflect</span><span class="op" id="2520484">.</span><span class="ident" id="2520485">Uint64</span><span class="op" id="2520491">,</span>&nbsp;<span class="ident" id="2520493">reflect</span><span class="op" id="2520500">.</span><span class="ident" id="2520501">Uintptr</span><span class="op" id="2520508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520513">v</span><span class="op" id="2520514">.</span><span class="ident" id="2520515">SetUint</span><span class="op" id="2520522">(</span><span class="ident" id="2520523">s</span><span class="op" id="2520524">.</span><span class="ident" id="2520525">scanUint</span><span class="op" id="2520533">(</span><span class="ident" id="2520534">verb</span><span class="op" id="2520538">,</span>&nbsp;<span class="ident" id="2520540">v</span><span class="op" id="2520541">.</span><span class="ident" id="2520542">Type</span><span class="op" id="2520546">(</span><span class="op" id="2520547">)</span><span class="op" id="2520548">.</span><span class="ident" id="2520549">Bits</span><span class="op" id="2520553">(</span><span class="op" id="2520554">)</span><span class="op" id="2520555">)</span><span class="op" id="2520556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520560">case</span>&nbsp;<span class="ident" id="2520565">reflect</span><span class="op" id="2520572">.</span><span class="ident" id="2520573">String</span><span class="op" id="2520579">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520584">v</span><span class="op" id="2520585">.</span><span class="ident" id="2520586">SetString</span><span class="op" id="2520595">(</span><span class="ident" id="2520596">s</span><span class="op" id="2520597">.</span><span class="ident" id="2520598">convertString</span><span class="op" id="2520611">(</span><span class="ident" id="2520612">verb</span><span class="op" id="2520616">)</span><span class="op" id="2520617">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520621">case</span>&nbsp;<span class="ident" id="2520626">reflect</span><span class="op" id="2520633">.</span><span class="ident" id="2520634">Slice</span><span class="op" id="2520639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2520644">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520693">typ</span>&nbsp;<span class="op" id="2520697">:=</span>&nbsp;<span class="ident" id="2520700">v</span><span class="op" id="2520701">.</span><span class="ident" id="2520702">Type</span><span class="op" id="2520706">(</span><span class="op" id="2520707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520712">if</span>&nbsp;<span class="ident" id="2520715">typ</span><span class="op" id="2520718">.</span><span class="ident" id="2520719">Elem</span><span class="op" id="2520723">(</span><span class="op" id="2520724">)</span><span class="op" id="2520725">.</span><span class="ident" id="2520726">Kind</span><span class="op" id="2520730">(</span><span class="op" id="2520731">)</span>&nbsp;<span class="op" id="2520733">!=</span>&nbsp;<span class="ident" id="2520736">reflect</span><span class="op" id="2520743">.</span><span class="ident" id="2520744">Uint8</span>&nbsp;<span class="op" id="2520750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520756">s</span><span class="op" id="2520757">.</span><span class="ident" id="2520758">errorString</span><span class="op" id="2520769">(</span><span class="string" id="2520770">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2520790">+</span>&nbsp;<span class="ident" id="2520792">val</span><span class="op" id="2520795">.</span><span class="ident" id="2520796">Type</span><span class="op" id="2520800">(</span><span class="op" id="2520801">)</span><span class="op" id="2520802">.</span><span class="ident" id="2520803">String</span><span class="op" id="2520809">(</span><span class="op" id="2520810">)</span><span class="op" id="2520811">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2520816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520821">str</span>&nbsp;<span class="op" id="2520825">:=</span>&nbsp;<span class="ident" id="2520828">s</span><span class="op" id="2520829">.</span><span class="ident" id="2520830">convertString</span><span class="op" id="2520843">(</span><span class="ident" id="2520844">verb</span><span class="op" id="2520848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520853">v</span><span class="op" id="2520854">.</span><span class="ident" id="2520855">Set</span><span class="op" id="2520858">(</span><span class="ident" id="2520859">reflect</span><span class="op" id="2520866">.</span><span class="ident" id="2520867">MakeSlice</span><span class="op" id="2520876">(</span><span class="ident" id="2520877">typ</span><span class="op" id="2520880">,</span>&nbsp;<span class="builtinfunc" id="2520882">len</span><span class="op" id="2520885">(</span><span class="ident" id="2520886">str</span><span class="op" id="2520889">)</span><span class="op" id="2520890">,</span>&nbsp;<span class="builtinfunc" id="2520892">len</span><span class="op" id="2520895">(</span><span class="ident" id="2520896">str</span><span class="op" id="2520899">)</span><span class="op" id="2520900">)</span><span class="op" id="2520901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520906">for</span>&nbsp;<span class="ident" id="2520910">i</span>&nbsp;<span class="op" id="2520912">:=</span>&nbsp;<span class="num" id="2520915">0</span><span class="op" id="2520916">;</span>&nbsp;<span class="ident" id="2520918">i</span>&nbsp;<span class="op" id="2520920">&lt;</span>&nbsp;<span class="builtinfunc" id="2520922">len</span><span class="op" id="2520925">(</span><span class="ident" id="2520926">str</span><span class="op" id="2520929">)</span><span class="op" id="2520930">;</span>&nbsp;<span class="ident" id="2520932">i</span><span class="op" id="2520933">++</span>&nbsp;<span class="op" id="2520936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520942">v</span><span class="op" id="2520943">.</span><span class="ident" id="2520944">Index</span><span class="op" id="2520949">(</span><span class="ident" id="2520950">i</span><span class="op" id="2520951">)</span><span class="op" id="2520952">.</span><span class="ident" id="2520953">SetUint</span><span class="op" id="2520960">(</span><span class="ident" id="2520961">uint64</span><span class="op" id="2520967">(</span><span class="ident" id="2520968">str</span><span class="op" id="2520971">[</span><span class="ident" id="2520972">i</span><span class="op" id="2520973">]</span><span class="op" id="2520974">)</span><span class="op" id="2520975">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2520980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520984">case</span>&nbsp;<span class="ident" id="2520989">reflect</span><span class="op" id="2520996">.</span><span class="ident" id="2520997">Float32</span><span class="op" id="2521004">,</span>&nbsp;<span class="ident" id="2521006">reflect</span><span class="op" id="2521013">.</span><span class="ident" id="2521014">Float64</span><span class="op" id="2521021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521026">s</span><span class="op" id="2521027">.</span><span class="ident" id="2521028">skipSpace</span><span class="op" id="2521037">(</span><span class="builtintype" id="2521038">false</span><span class="op" id="2521043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521048">s</span><span class="op" id="2521049">.</span><span class="ident" id="2521050">notEOF</span><span class="op" id="2521056">(</span><span class="op" id="2521057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521062">v</span><span class="op" id="2521063">.</span><span class="ident" id="2521064">SetFloat</span><span class="op" id="2521072">(</span><span class="ident" id="2521073">s</span><span class="op" id="2521074">.</span><span class="ident" id="2521075">convertFloat</span><span class="op" id="2521087">(</span><span class="ident" id="2521088">s</span><span class="op" id="2521089">.</span><span class="ident" id="2521090">floatToken</span><span class="op" id="2521100">(</span><span class="op" id="2521101">)</span><span class="op" id="2521102">,</span>&nbsp;<span class="ident" id="2521104">v</span><span class="op" id="2521105">.</span><span class="ident" id="2521106">Type</span><span class="op" id="2521110">(</span><span class="op" id="2521111">)</span><span class="op" id="2521112">.</span><span class="ident" id="2521113">Bits</span><span class="op" id="2521117">(</span><span class="op" id="2521118">)</span><span class="op" id="2521119">)</span><span class="op" id="2521120">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521124">case</span>&nbsp;<span class="ident" id="2521129">reflect</span><span class="op" id="2521136">.</span><span class="ident" id="2521137">Complex64</span><span class="op" id="2521146">,</span>&nbsp;<span class="ident" id="2521148">reflect</span><span class="op" id="2521155">.</span><span class="ident" id="2521156">Complex128</span><span class="op" id="2521166">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521171">v</span><span class="op" id="2521172">.</span><span class="ident" id="2521173">SetComplex</span><span class="op" id="2521183">(</span><span class="ident" id="2521184">s</span><span class="op" id="2521185">.</span><span class="ident" id="2521186">scanComplex</span><span class="op" id="2521197">(</span><span class="ident" id="2521198">verb</span><span class="op" id="2521202">,</span>&nbsp;<span class="ident" id="2521204">v</span><span class="op" id="2521205">.</span><span class="ident" id="2521206">Type</span><span class="op" id="2521210">(</span><span class="op" id="2521211">)</span><span class="op" id="2521212">.</span><span class="ident" id="2521213">Bits</span><span class="op" id="2521217">(</span><span class="op" id="2521218">)</span><span class="op" id="2521219">)</span><span class="op" id="2521220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521224">default</span><span class="op" id="2521231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521236">s</span><span class="op" id="2521237">.</span><span class="ident" id="2521238">errorString</span><span class="op" id="2521249">(</span><span class="string" id="2521250">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2521270">+</span>&nbsp;<span class="ident" id="2521272">val</span><span class="op" id="2521275">.</span><span class="ident" id="2521276">Type</span><span class="op" id="2521280">(</span><span class="op" id="2521281">)</span><span class="op" id="2521282">.</span><span class="ident" id="2521283">String</span><span class="op" id="2521289">(</span><span class="op" id="2521290">)</span><span class="op" id="2521291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521295">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521298">}</span><br>
<span class="lineno"></span><span class="op" id="2521300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2521303">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2521358">func</span>&nbsp;<span class="ident" id="2521363">errorHandler</span><span class="op" id="2521375">(</span><span class="ident" id="2521376">errp</span>&nbsp;<span class="op" id="2521381">*</span><span class="builtintype" id="2521382">error</span><span class="op" id="2521387">)</span>&nbsp;<span class="op" id="2521389">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521392">if</span>&nbsp;<span class="ident" id="2521395">e</span>&nbsp;<span class="op" id="2521397">:=</span>&nbsp;<span class="builtinfunc" id="2521400">recover</span><span class="op" id="2521407">(</span><span class="op" id="2521408">)</span><span class="op" id="2521409">;</span>&nbsp;<span class="ident" id="2521411">e</span>&nbsp;<span class="op" id="2521413">!=</span>&nbsp;<span class="ident" id="2521416">nil</span>&nbsp;<span class="op" id="2521420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521424">if</span>&nbsp;<span class="ident" id="2521427">se</span><span class="op" id="2521429">,</span>&nbsp;<span class="ident" id="2521431">ok</span>&nbsp;<span class="op" id="2521434">:=</span>&nbsp;<span class="ident" id="2521437">e</span><span class="op" id="2521438">.</span><span class="op" id="2521439">(</span><span class="ident" id="2521440">scanError</span><span class="op" id="2521449">)</span><span class="op" id="2521450">;</span>&nbsp;<span class="ident" id="2521452">ok</span>&nbsp;<span class="op" id="2521455">{</span>&nbsp;<span class="comment" id="2521457">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521481">*</span><span class="ident" id="2521482">errp</span>&nbsp;<span class="op" id="2521487">=</span>&nbsp;<span class="ident" id="2521489">se</span><span class="op" id="2521491">.</span><span class="ident" id="2521492">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521498">}</span>&nbsp;<span class="keyword" id="2521500">else</span>&nbsp;<span class="keyword" id="2521505">if</span>&nbsp;<span class="ident" id="2521508">eof</span><span class="op" id="2521511">,</span>&nbsp;<span class="ident" id="2521513">ok</span>&nbsp;<span class="op" id="2521516">:=</span>&nbsp;<span class="ident" id="2521519">e</span><span class="op" id="2521520">.</span><span class="op" id="2521521">(</span><span class="builtintype" id="2521522">error</span><span class="op" id="2521527">)</span><span class="op" id="2521528">;</span>&nbsp;<span class="ident" id="2521530">ok</span>&nbsp;<span class="op" id="2521533">&amp;&amp;</span>&nbsp;<span class="ident" id="2521536">eof</span>&nbsp;<span class="op" id="2521540">==</span>&nbsp;<span class="ident" id="2521543">io</span><span class="op" id="2521545">.</span><span class="ident" id="2521546">EOF</span>&nbsp;<span class="op" id="2521550">{</span>&nbsp;<span class="comment" id="2521552">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521571">*</span><span class="ident" id="2521572">errp</span>&nbsp;<span class="op" id="2521577">=</span>&nbsp;<span class="ident" id="2521579">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521585">}</span>&nbsp;<span class="keyword" id="2521587">else</span>&nbsp;<span class="op" id="2521592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2521597">panic</span><span class="op" id="2521602">(</span><span class="ident" id="2521603">e</span><span class="op" id="2521604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521611">}</span><br>
<span class="lineno"></span><span class="op" id="2521613">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="2521616">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2521683">func</span>&nbsp;<span class="op" id="2521688">(</span><span class="ident" id="2521689">s</span>&nbsp;<span class="op" id="2521691">*</span><span class="ident" id="2521692">ss</span><span class="op" id="2521694">)</span>&nbsp;<span class="ident" id="2521696">doScan</span><span class="op" id="2521702">(</span><span class="ident" id="2521703">a</span>&nbsp;<span class="op" id="2521705">[</span><span class="op" id="2521706">]</span><span class="keyword" id="2521707">interface</span><span class="op" id="2521716">{</span><span class="op" id="2521717">}</span><span class="op" id="2521718">)</span>&nbsp;<span class="op" id="2521720">(</span><span class="ident" id="2521721">numProcessed</span>&nbsp;<span class="builtintype" id="2521734">int</span><span class="op" id="2521737">,</span>&nbsp;<span class="ident" id="2521739">err</span>&nbsp;<span class="builtintype" id="2521743">error</span><span class="op" id="2521748">)</span>&nbsp;<span class="op" id="2521750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521753">defer</span>&nbsp;<span class="ident" id="2521759">errorHandler</span><span class="op" id="2521771">(</span><span class="op" id="2521772">&amp;</span><span class="ident" id="2521773">err</span><span class="op" id="2521776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521779">for</span>&nbsp;<span class="ident" id="2521783">_</span><span class="op" id="2521784">,</span>&nbsp;<span class="ident" id="2521786">arg</span>&nbsp;<span class="op" id="2521790">:=</span>&nbsp;<span class="keyword" id="2521793">range</span>&nbsp;<span class="ident" id="2521799">a</span>&nbsp;<span class="op" id="2521801">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521805">s</span><span class="op" id="2521806">.</span><span class="ident" id="2521807">scanOne</span><span class="op" id="2521814">(</span><span class="string" id="2521815">&#39;v&#39;</span><span class="op" id="2521818">,</span>&nbsp;<span class="ident" id="2521820">arg</span><span class="op" id="2521823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521827">numProcessed</span><span class="op" id="2521839">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521846">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521881">if</span>&nbsp;<span class="op" id="2521884">!</span><span class="ident" id="2521885">s</span><span class="op" id="2521886">.</span><span class="ident" id="2521887">nlIsSpace</span>&nbsp;<span class="op" id="2521897">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521901">for</span>&nbsp;<span class="op" id="2521905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521910">r</span>&nbsp;<span class="op" id="2521912">:=</span>&nbsp;<span class="ident" id="2521915">s</span><span class="op" id="2521916">.</span><span class="ident" id="2521917">getRune</span><span class="op" id="2521924">(</span><span class="op" id="2521925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521930">if</span>&nbsp;<span class="ident" id="2521933">r</span>&nbsp;<span class="op" id="2521935">==</span>&nbsp;<span class="string" id="2521938">&#39;\n&#39;</span>&nbsp;<span class="op" id="2521943">||</span>&nbsp;<span class="ident" id="2521946">r</span>&nbsp;<span class="op" id="2521948">==</span>&nbsp;<span class="ident" id="2521951">eof</span>&nbsp;<span class="op" id="2521955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521961">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521970">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521975">if</span>&nbsp;<span class="op" id="2521978">!</span><span class="ident" id="2521979">isSpace</span><span class="op" id="2521986">(</span><span class="ident" id="2521987">r</span><span class="op" id="2521988">)</span>&nbsp;<span class="op" id="2521990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521996">s</span><span class="op" id="2521997">.</span><span class="ident" id="2521998">errorString</span><span class="op" id="2522009">(</span><span class="string" id="2522010">&#34;expected&nbsp;newline&#34;</span><span class="op" id="2522028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522034">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522047">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522053">return</span><br>
<span class="lineno"></span><span class="op" id="2522060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2522063">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="2522132">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="2522203">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2522272">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2522342">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="2522410">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="2522474">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2522532">func</span>&nbsp;<span class="op" id="2522537">(</span><span class="ident" id="2522538">s</span>&nbsp;<span class="op" id="2522540">*</span><span class="ident" id="2522541">ss</span><span class="op" id="2522543">)</span>&nbsp;<span class="ident" id="2522545">advance</span><span class="op" id="2522552">(</span><span class="ident" id="2522553">format</span>&nbsp;<span class="builtintype" id="2522560">string</span><span class="op" id="2522566">)</span>&nbsp;<span class="op" id="2522568">(</span><span class="ident" id="2522569">i</span>&nbsp;<span class="builtintype" id="2522571">int</span><span class="op" id="2522574">)</span>&nbsp;<span class="op" id="2522576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522579">for</span>&nbsp;<span class="ident" id="2522583">i</span>&nbsp;<span class="op" id="2522585">&lt;</span>&nbsp;<span class="builtinfunc" id="2522587">len</span><span class="op" id="2522590">(</span><span class="ident" id="2522591">format</span><span class="op" id="2522597">)</span>&nbsp;<span class="op" id="2522599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522603">fmtc</span><span class="op" id="2522607">,</span>&nbsp;<span class="ident" id="2522609">w</span>&nbsp;<span class="op" id="2522611">:=</span>&nbsp;<span class="ident" id="2522614">utf8</span><span class="op" id="2522618">.</span><span class="ident" id="2522619">DecodeRuneInString</span><span class="op" id="2522637">(</span><span class="ident" id="2522638">format</span><span class="op" id="2522644">[</span><span class="ident" id="2522645">i</span><span class="op" id="2522646">:</span><span class="op" id="2522647">]</span><span class="op" id="2522648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522652">if</span>&nbsp;<span class="ident" id="2522655">fmtc</span>&nbsp;<span class="op" id="2522660">==</span>&nbsp;<span class="string" id="2522663">&#39;%&#39;</span>&nbsp;<span class="op" id="2522667">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522672">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522706">nextc</span><span class="op" id="2522711">,</span>&nbsp;<span class="ident" id="2522713">_</span>&nbsp;<span class="op" id="2522715">:=</span>&nbsp;<span class="ident" id="2522718">utf8</span><span class="op" id="2522722">.</span><span class="ident" id="2522723">DecodeRuneInString</span><span class="op" id="2522741">(</span><span class="ident" id="2522742">format</span><span class="op" id="2522748">[</span><span class="ident" id="2522749">i</span><span class="op" id="2522750">+</span><span class="ident" id="2522751">w</span><span class="op" id="2522752">:</span><span class="op" id="2522753">]</span><span class="op" id="2522754">)</span>&nbsp;<span class="comment" id="2522756">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522798">if</span>&nbsp;<span class="ident" id="2522801">nextc</span>&nbsp;<span class="op" id="2522807">!=</span>&nbsp;<span class="string" id="2522810">&#39;%&#39;</span>&nbsp;<span class="op" id="2522814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522820">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522830">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522835">i</span>&nbsp;<span class="op" id="2522837">+=</span>&nbsp;<span class="ident" id="2522840">w</span>&nbsp;<span class="comment" id="2522842">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522868">sawSpace</span>&nbsp;<span class="op" id="2522877">:=</span>&nbsp;<span class="builtintype" id="2522880">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522888">for</span>&nbsp;<span class="ident" id="2522892">isSpace</span><span class="op" id="2522899">(</span><span class="ident" id="2522900">fmtc</span><span class="op" id="2522904">)</span>&nbsp;<span class="op" id="2522906">&amp;&amp;</span>&nbsp;<span class="ident" id="2522909">i</span>&nbsp;<span class="op" id="2522911">&lt;</span>&nbsp;<span class="builtinfunc" id="2522913">len</span><span class="op" id="2522916">(</span><span class="ident" id="2522917">format</span><span class="op" id="2522923">)</span>&nbsp;<span class="op" id="2522925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522930">sawSpace</span>&nbsp;<span class="op" id="2522939">=</span>&nbsp;<span class="builtintype" id="2522941">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522949">i</span>&nbsp;<span class="op" id="2522951">+=</span>&nbsp;<span class="ident" id="2522954">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522959">fmtc</span><span class="op" id="2522963">,</span>&nbsp;<span class="ident" id="2522965">w</span>&nbsp;<span class="op" id="2522967">=</span>&nbsp;<span class="ident" id="2522969">utf8</span><span class="op" id="2522973">.</span><span class="ident" id="2522974">DecodeRuneInString</span><span class="op" id="2522992">(</span><span class="ident" id="2522993">format</span><span class="op" id="2522999">[</span><span class="ident" id="2523000">i</span><span class="op" id="2523001">:</span><span class="op" id="2523002">]</span><span class="op" id="2523003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523011">if</span>&nbsp;<span class="ident" id="2523014">sawSpace</span>&nbsp;<span class="op" id="2523023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523028">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523096">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523116">inputc</span>&nbsp;<span class="op" id="2523123">:=</span>&nbsp;<span class="ident" id="2523126">s</span><span class="op" id="2523127">.</span><span class="ident" id="2523128">getRune</span><span class="op" id="2523135">(</span><span class="op" id="2523136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523141">if</span>&nbsp;<span class="ident" id="2523144">inputc</span>&nbsp;<span class="op" id="2523151">==</span>&nbsp;<span class="ident" id="2523154">eof</span>&nbsp;<span class="op" id="2523158">||</span>&nbsp;<span class="ident" id="2523161">inputc</span>&nbsp;<span class="op" id="2523168">==</span>&nbsp;<span class="string" id="2523171">&#39;\n&#39;</span>&nbsp;<span class="op" id="2523176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523182">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523245">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523260">if</span>&nbsp;<span class="op" id="2523263">!</span><span class="ident" id="2523264">isSpace</span><span class="op" id="2523271">(</span><span class="ident" id="2523272">inputc</span><span class="op" id="2523278">)</span>&nbsp;<span class="op" id="2523280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523286">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523333">s</span><span class="op" id="2523334">.</span><span class="ident" id="2523335">errorString</span><span class="op" id="2523346">(</span><span class="string" id="2523347">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="2523388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523393">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523398">s</span><span class="op" id="2523399">.</span><span class="ident" id="2523400">skipSpace</span><span class="op" id="2523409">(</span><span class="builtintype" id="2523410">true</span><span class="op" id="2523414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523419">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523434">inputc</span>&nbsp;<span class="op" id="2523441">:=</span>&nbsp;<span class="ident" id="2523444">s</span><span class="op" id="2523445">.</span><span class="ident" id="2523446">mustReadRune</span><span class="op" id="2523458">(</span><span class="op" id="2523459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523463">if</span>&nbsp;<span class="ident" id="2523466">fmtc</span>&nbsp;<span class="op" id="2523471">!=</span>&nbsp;<span class="ident" id="2523474">inputc</span>&nbsp;<span class="op" id="2523481">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523486">s</span><span class="op" id="2523487">.</span><span class="ident" id="2523488">UnreadRune</span><span class="op" id="2523498">(</span><span class="op" id="2523499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523504">return</span>&nbsp;<span class="op" id="2523511">-</span><span class="num" id="2523512">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523520">i</span>&nbsp;<span class="op" id="2523522">+=</span>&nbsp;<span class="ident" id="2523525">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523528">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523531">return</span><br>
<span class="lineno"></span><span class="op" id="2523538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2523541">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2523607">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="2523667">func</span>&nbsp;<span class="op" id="2523672">(</span><span class="ident" id="2523673">s</span>&nbsp;<span class="op" id="2523675">*</span><span class="ident" id="2523676">ss</span><span class="op" id="2523678">)</span>&nbsp;<span class="ident" id="2523680">doScanf</span><span class="op" id="2523687">(</span><span class="ident" id="2523688">format</span>&nbsp;<span class="builtintype" id="2523695">string</span><span class="op" id="2523701">,</span>&nbsp;<span class="ident" id="2523703">a</span>&nbsp;<span class="op" id="2523705">[</span><span class="op" id="2523706">]</span><span class="keyword" id="2523707">interface</span><span class="op" id="2523716">{</span><span class="op" id="2523717">}</span><span class="op" id="2523718">)</span>&nbsp;<span class="op" id="2523720">(</span><span class="ident" id="2523721">numProcessed</span>&nbsp;<span class="builtintype" id="2523734">int</span><span class="op" id="2523737">,</span>&nbsp;<span class="ident" id="2523739">err</span>&nbsp;<span class="builtintype" id="2523743">error</span><span class="op" id="2523748">)</span>&nbsp;<span class="op" id="2523750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523753">defer</span>&nbsp;<span class="ident" id="2523759">errorHandler</span><span class="op" id="2523771">(</span><span class="op" id="2523772">&amp;</span><span class="ident" id="2523773">err</span><span class="op" id="2523776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523779">end</span>&nbsp;<span class="op" id="2523783">:=</span>&nbsp;<span class="builtinfunc" id="2523786">len</span><span class="op" id="2523789">(</span><span class="ident" id="2523790">format</span><span class="op" id="2523796">)</span>&nbsp;<span class="op" id="2523798">-</span>&nbsp;<span class="num" id="2523800">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523803">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523850">for</span>&nbsp;<span class="ident" id="2523854">i</span>&nbsp;<span class="op" id="2523856">:=</span>&nbsp;<span class="num" id="2523859">0</span><span class="op" id="2523860">;</span>&nbsp;<span class="ident" id="2523862">i</span>&nbsp;<span class="op" id="2523864">&lt;=</span>&nbsp;<span class="ident" id="2523867">end</span><span class="op" id="2523870">;</span>&nbsp;<span class="op" id="2523872">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523876">w</span>&nbsp;<span class="op" id="2523878">:=</span>&nbsp;<span class="ident" id="2523881">s</span><span class="op" id="2523882">.</span><span class="ident" id="2523883">advance</span><span class="op" id="2523890">(</span><span class="ident" id="2523891">format</span><span class="op" id="2523897">[</span><span class="ident" id="2523898">i</span><span class="op" id="2523899">:</span><span class="op" id="2523900">]</span><span class="op" id="2523901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523905">if</span>&nbsp;<span class="ident" id="2523908">w</span>&nbsp;<span class="op" id="2523910">&gt;</span>&nbsp;<span class="num" id="2523912">0</span>&nbsp;<span class="op" id="2523914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523919">i</span>&nbsp;<span class="op" id="2523921">+=</span>&nbsp;<span class="ident" id="2523924">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523929">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523940">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523944">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524031">if</span>&nbsp;<span class="ident" id="2524034">format</span><span class="op" id="2524040">[</span><span class="ident" id="2524041">i</span><span class="op" id="2524042">]</span>&nbsp;<span class="op" id="2524044">!=</span>&nbsp;<span class="string" id="2524047">&#39;%&#39;</span>&nbsp;<span class="op" id="2524051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2524056">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524094">if</span>&nbsp;<span class="ident" id="2524097">w</span>&nbsp;<span class="op" id="2524099">&lt;</span>&nbsp;<span class="num" id="2524101">0</span>&nbsp;<span class="op" id="2524103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524109">s</span><span class="op" id="2524110">.</span><span class="ident" id="2524111">errorString</span><span class="op" id="2524122">(</span><span class="string" id="2524123">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="2524152">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2524162">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524226">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524238">i</span><span class="op" id="2524239">++</span>&nbsp;<span class="comment" id="2524242">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2524262">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524290">var</span>&nbsp;<span class="ident" id="2524294">widPresent</span>&nbsp;<span class="builtintype" id="2524305">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524312">s</span><span class="op" id="2524313">.</span><span class="ident" id="2524314">maxWid</span><span class="op" id="2524320">,</span>&nbsp;<span class="ident" id="2524322">widPresent</span><span class="op" id="2524332">,</span>&nbsp;<span class="ident" id="2524334">i</span>&nbsp;<span class="op" id="2524336">=</span>&nbsp;<span class="ident" id="2524338">parsenum</span><span class="op" id="2524346">(</span><span class="ident" id="2524347">format</span><span class="op" id="2524353">,</span>&nbsp;<span class="ident" id="2524355">i</span><span class="op" id="2524356">,</span>&nbsp;<span class="ident" id="2524358">end</span><span class="op" id="2524361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524365">if</span>&nbsp;<span class="op" id="2524368">!</span><span class="ident" id="2524369">widPresent</span>&nbsp;<span class="op" id="2524380">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524385">s</span><span class="op" id="2524386">.</span><span class="ident" id="2524387">maxWid</span>&nbsp;<span class="op" id="2524394">=</span>&nbsp;<span class="ident" id="2524396">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524410">s</span><span class="op" id="2524411">.</span><span class="ident" id="2524412">argLimit</span>&nbsp;<span class="op" id="2524421">=</span>&nbsp;<span class="ident" id="2524423">s</span><span class="op" id="2524424">.</span><span class="ident" id="2524425">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524433">if</span>&nbsp;<span class="ident" id="2524436">f</span>&nbsp;<span class="op" id="2524438">:=</span>&nbsp;<span class="ident" id="2524441">s</span><span class="op" id="2524442">.</span><span class="ident" id="2524443">count</span>&nbsp;<span class="op" id="2524449">+</span>&nbsp;<span class="ident" id="2524451">s</span><span class="op" id="2524452">.</span><span class="ident" id="2524453">maxWid</span><span class="op" id="2524459">;</span>&nbsp;<span class="ident" id="2524461">f</span>&nbsp;<span class="op" id="2524463">&lt;</span>&nbsp;<span class="ident" id="2524465">s</span><span class="op" id="2524466">.</span><span class="ident" id="2524467">argLimit</span>&nbsp;<span class="op" id="2524476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524481">s</span><span class="op" id="2524482">.</span><span class="ident" id="2524483">argLimit</span>&nbsp;<span class="op" id="2524492">=</span>&nbsp;<span class="ident" id="2524494">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524503">c</span><span class="op" id="2524504">,</span>&nbsp;<span class="ident" id="2524506">w</span>&nbsp;<span class="op" id="2524508">:=</span>&nbsp;<span class="ident" id="2524511">utf8</span><span class="op" id="2524515">.</span><span class="ident" id="2524516">DecodeRuneInString</span><span class="op" id="2524534">(</span><span class="ident" id="2524535">format</span><span class="op" id="2524541">[</span><span class="ident" id="2524542">i</span><span class="op" id="2524543">:</span><span class="op" id="2524544">]</span><span class="op" id="2524545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524549">i</span>&nbsp;<span class="op" id="2524551">+=</span>&nbsp;<span class="ident" id="2524554">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524559">if</span>&nbsp;<span class="ident" id="2524562">numProcessed</span>&nbsp;<span class="op" id="2524575">&gt;=</span>&nbsp;<span class="builtinfunc" id="2524578">len</span><span class="op" id="2524581">(</span><span class="ident" id="2524582">a</span><span class="op" id="2524583">)</span>&nbsp;<span class="op" id="2524585">{</span>&nbsp;<span class="comment" id="2524587">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524609">s</span><span class="op" id="2524610">.</span><span class="ident" id="2524611">errorString</span><span class="op" id="2524622">(</span><span class="string" id="2524623">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="2524655">+</span>&nbsp;<span class="ident" id="2524657">format</span><span class="op" id="2524663">[</span><span class="ident" id="2524664">i</span><span class="op" id="2524665">-</span><span class="ident" id="2524666">w</span><span class="op" id="2524667">:</span><span class="op" id="2524668">]</span><span class="op" id="2524669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524674">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524686">arg</span>&nbsp;<span class="op" id="2524690">:=</span>&nbsp;<span class="ident" id="2524693">a</span><span class="op" id="2524694">[</span><span class="ident" id="2524695">numProcessed</span><span class="op" id="2524707">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524712">s</span><span class="op" id="2524713">.</span><span class="ident" id="2524714">scanOne</span><span class="op" id="2524721">(</span><span class="ident" id="2524722">c</span><span class="op" id="2524723">,</span>&nbsp;<span class="ident" id="2524725">arg</span><span class="op" id="2524728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524732">numProcessed</span><span class="op" id="2524744">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524749">s</span><span class="op" id="2524750">.</span><span class="ident" id="2524751">argLimit</span>&nbsp;<span class="op" id="2524760">=</span>&nbsp;<span class="ident" id="2524762">s</span><span class="op" id="2524763">.</span><span class="ident" id="2524764">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524771">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524774">if</span>&nbsp;<span class="ident" id="2524777">numProcessed</span>&nbsp;<span class="op" id="2524790">&lt;</span>&nbsp;<span class="builtinfunc" id="2524792">len</span><span class="op" id="2524795">(</span><span class="ident" id="2524796">a</span><span class="op" id="2524797">)</span>&nbsp;<span class="op" id="2524799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524803">s</span><span class="op" id="2524804">.</span><span class="ident" id="2524805">errorString</span><span class="op" id="2524816">(</span><span class="string" id="2524817">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="2524836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524842">return</span><br>
<span class="lineno"></span><span class="op" id="2524849">}</span>
</div>
</body>
</html>
