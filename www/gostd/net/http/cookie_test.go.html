<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html" class="current">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7463740">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7463796">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7463850">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7463901">package</span>&nbsp;<span class="ident" id="7463909">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7463915">import</span>&nbsp;<span class="op" id="7463922">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7463925">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7463934">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7463951">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7463958">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7463965">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7463971">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7463982">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7463993">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464004">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7464011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7464014">var</span>&nbsp;<span class="ident" id="7464018">writeSetCookiesTests</span>&nbsp;<span class="op" id="7464039">=</span>&nbsp;<span class="op" id="7464041">[</span><span class="op" id="7464042">]</span><span class="keyword" id="7464043">struct</span>&nbsp;<span class="op" id="7464050">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7464053">Cookie</span>&nbsp;<span class="op" id="7464060">*</span><span class="ident" id="7464061">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7464069">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7464076">string</span><br>
<span class="lineno"></span><span class="op" id="7464083">}</span><span class="op" id="7464084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464091">&amp;</span><span class="ident" id="7464092">Cookie</span><span class="op" id="7464098">{</span><span class="ident" id="7464099">Name</span><span class="op" id="7464103">:</span>&nbsp;<span class="string" id="7464105">&#34;cookie-1&#34;</span><span class="op" id="7464115">,</span>&nbsp;<span class="ident" id="7464117">Value</span><span class="op" id="7464122">:</span>&nbsp;<span class="string" id="7464124">&#34;v$1&#34;</span><span class="op" id="7464129">}</span><span class="op" id="7464130">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464134">&#34;cookie-1=v$1&#34;</span><span class="op" id="7464148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464151">}</span><span class="op" id="7464152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464159">&amp;</span><span class="ident" id="7464160">Cookie</span><span class="op" id="7464166">{</span><span class="ident" id="7464167">Name</span><span class="op" id="7464171">:</span>&nbsp;<span class="string" id="7464173">&#34;cookie-2&#34;</span><span class="op" id="7464183">,</span>&nbsp;<span class="ident" id="7464185">Value</span><span class="op" id="7464190">:</span>&nbsp;<span class="string" id="7464192">&#34;two&#34;</span><span class="op" id="7464197">,</span>&nbsp;<span class="ident" id="7464199">MaxAge</span><span class="op" id="7464205">:</span>&nbsp;<span class="num" id="7464207">3600</span><span class="op" id="7464211">}</span><span class="op" id="7464212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464216">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7464244">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464247">}</span><span class="op" id="7464248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464255">&amp;</span><span class="ident" id="7464256">Cookie</span><span class="op" id="7464262">{</span><span class="ident" id="7464263">Name</span><span class="op" id="7464267">:</span>&nbsp;<span class="string" id="7464269">&#34;cookie-3&#34;</span><span class="op" id="7464279">,</span>&nbsp;<span class="ident" id="7464281">Value</span><span class="op" id="7464286">:</span>&nbsp;<span class="string" id="7464288">&#34;three&#34;</span><span class="op" id="7464295">,</span>&nbsp;<span class="ident" id="7464297">Domain</span><span class="op" id="7464303">:</span>&nbsp;<span class="string" id="7464305">&#34;.example.com&#34;</span><span class="op" id="7464319">}</span><span class="op" id="7464320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464324">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="7464360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464363">}</span><span class="op" id="7464364">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464371">&amp;</span><span class="ident" id="7464372">Cookie</span><span class="op" id="7464378">{</span><span class="ident" id="7464379">Name</span><span class="op" id="7464383">:</span>&nbsp;<span class="string" id="7464385">&#34;cookie-4&#34;</span><span class="op" id="7464395">,</span>&nbsp;<span class="ident" id="7464397">Value</span><span class="op" id="7464402">:</span>&nbsp;<span class="string" id="7464404">&#34;four&#34;</span><span class="op" id="7464410">,</span>&nbsp;<span class="ident" id="7464412">Path</span><span class="op" id="7464416">:</span>&nbsp;<span class="string" id="7464418">&#34;/restricted/&#34;</span><span class="op" id="7464432">}</span><span class="op" id="7464433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464437">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7464471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464474">}</span><span class="op" id="7464475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464478">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464482">&amp;</span><span class="ident" id="7464483">Cookie</span><span class="op" id="7464489">{</span><span class="ident" id="7464490">Name</span><span class="op" id="7464494">:</span>&nbsp;<span class="string" id="7464496">&#34;cookie-5&#34;</span><span class="op" id="7464506">,</span>&nbsp;<span class="ident" id="7464508">Value</span><span class="op" id="7464513">:</span>&nbsp;<span class="string" id="7464515">&#34;five&#34;</span><span class="op" id="7464521">,</span>&nbsp;<span class="ident" id="7464523">Domain</span><span class="op" id="7464529">:</span>&nbsp;<span class="string" id="7464531">&#34;wrong;bad.abc&#34;</span><span class="op" id="7464546">}</span><span class="op" id="7464547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464551">&#34;cookie-5=five&#34;</span><span class="op" id="7464566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464569">}</span><span class="op" id="7464570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464577">&amp;</span><span class="ident" id="7464578">Cookie</span><span class="op" id="7464584">{</span><span class="ident" id="7464585">Name</span><span class="op" id="7464589">:</span>&nbsp;<span class="string" id="7464591">&#34;cookie-6&#34;</span><span class="op" id="7464601">,</span>&nbsp;<span class="ident" id="7464603">Value</span><span class="op" id="7464608">:</span>&nbsp;<span class="string" id="7464610">&#34;six&#34;</span><span class="op" id="7464615">,</span>&nbsp;<span class="ident" id="7464617">Domain</span><span class="op" id="7464623">:</span>&nbsp;<span class="string" id="7464625">&#34;bad-.abc&#34;</span><span class="op" id="7464635">}</span><span class="op" id="7464636">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464640">&#34;cookie-6=six&#34;</span><span class="op" id="7464654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464657">}</span><span class="op" id="7464658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464665">&amp;</span><span class="ident" id="7464666">Cookie</span><span class="op" id="7464672">{</span><span class="ident" id="7464673">Name</span><span class="op" id="7464677">:</span>&nbsp;<span class="string" id="7464679">&#34;cookie-7&#34;</span><span class="op" id="7464689">,</span>&nbsp;<span class="ident" id="7464691">Value</span><span class="op" id="7464696">:</span>&nbsp;<span class="string" id="7464698">&#34;seven&#34;</span><span class="op" id="7464705">,</span>&nbsp;<span class="ident" id="7464707">Domain</span><span class="op" id="7464713">:</span>&nbsp;<span class="string" id="7464715">&#34;127.0.0.1&#34;</span><span class="op" id="7464726">}</span><span class="op" id="7464727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464731">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="7464765">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464768">}</span><span class="op" id="7464769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464776">&amp;</span><span class="ident" id="7464777">Cookie</span><span class="op" id="7464783">{</span><span class="ident" id="7464784">Name</span><span class="op" id="7464788">:</span>&nbsp;<span class="string" id="7464790">&#34;cookie-8&#34;</span><span class="op" id="7464800">,</span>&nbsp;<span class="ident" id="7464802">Value</span><span class="op" id="7464807">:</span>&nbsp;<span class="string" id="7464809">&#34;eight&#34;</span><span class="op" id="7464816">,</span>&nbsp;<span class="ident" id="7464818">Domain</span><span class="op" id="7464824">:</span>&nbsp;<span class="string" id="7464826">&#34;::1&#34;</span><span class="op" id="7464831">}</span><span class="op" id="7464832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7464836">&#34;cookie-8=eight&#34;</span><span class="op" id="7464852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464855">}</span><span class="op" id="7464856">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7464859">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7464931">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7464994">&amp;</span><span class="ident" id="7464995">Cookie</span><span class="op" id="7465001">{</span><span class="ident" id="7465002">Name</span><span class="op" id="7465006">:</span>&nbsp;<span class="string" id="7465008">&#34;special-1&#34;</span><span class="op" id="7465019">,</span>&nbsp;<span class="ident" id="7465021">Value</span><span class="op" id="7465026">:</span>&nbsp;<span class="string" id="7465028">&#34;a&nbsp;z&#34;</span><span class="op" id="7465033">}</span><span class="op" id="7465034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465038">`special-1=a&nbsp;z`</span><span class="op" id="7465053">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465056">}</span><span class="op" id="7465057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465064">&amp;</span><span class="ident" id="7465065">Cookie</span><span class="op" id="7465071">{</span><span class="ident" id="7465072">Name</span><span class="op" id="7465076">:</span>&nbsp;<span class="string" id="7465078">&#34;special-2&#34;</span><span class="op" id="7465089">,</span>&nbsp;<span class="ident" id="7465091">Value</span><span class="op" id="7465096">:</span>&nbsp;<span class="string" id="7465098">&#34;&nbsp;z&#34;</span><span class="op" id="7465102">}</span><span class="op" id="7465103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465107">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7465123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465126">}</span><span class="op" id="7465127">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465134">&amp;</span><span class="ident" id="7465135">Cookie</span><span class="op" id="7465141">{</span><span class="ident" id="7465142">Name</span><span class="op" id="7465146">:</span>&nbsp;<span class="string" id="7465148">&#34;special-3&#34;</span><span class="op" id="7465159">,</span>&nbsp;<span class="ident" id="7465161">Value</span><span class="op" id="7465166">:</span>&nbsp;<span class="string" id="7465168">&#34;a&nbsp;&#34;</span><span class="op" id="7465172">}</span><span class="op" id="7465173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465177">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7465193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465196">}</span><span class="op" id="7465197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465200">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465204">&amp;</span><span class="ident" id="7465205">Cookie</span><span class="op" id="7465211">{</span><span class="ident" id="7465212">Name</span><span class="op" id="7465216">:</span>&nbsp;<span class="string" id="7465218">&#34;special-4&#34;</span><span class="op" id="7465229">,</span>&nbsp;<span class="ident" id="7465231">Value</span><span class="op" id="7465236">:</span>&nbsp;<span class="string" id="7465238">&#34;&nbsp;&#34;</span><span class="op" id="7465241">}</span><span class="op" id="7465242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465246">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7465261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465264">}</span><span class="op" id="7465265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465272">&amp;</span><span class="ident" id="7465273">Cookie</span><span class="op" id="7465279">{</span><span class="ident" id="7465280">Name</span><span class="op" id="7465284">:</span>&nbsp;<span class="string" id="7465286">&#34;special-5&#34;</span><span class="op" id="7465297">,</span>&nbsp;<span class="ident" id="7465299">Value</span><span class="op" id="7465304">:</span>&nbsp;<span class="string" id="7465306">&#34;a,z&#34;</span><span class="op" id="7465311">}</span><span class="op" id="7465312">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465316">`special-5=a,z`</span><span class="op" id="7465331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465334">}</span><span class="op" id="7465335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465342">&amp;</span><span class="ident" id="7465343">Cookie</span><span class="op" id="7465349">{</span><span class="ident" id="7465350">Name</span><span class="op" id="7465354">:</span>&nbsp;<span class="string" id="7465356">&#34;special-6&#34;</span><span class="op" id="7465367">,</span>&nbsp;<span class="ident" id="7465369">Value</span><span class="op" id="7465374">:</span>&nbsp;<span class="string" id="7465376">&#34;,z&#34;</span><span class="op" id="7465380">}</span><span class="op" id="7465381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465385">`special-6=&#34;,z&#34;`</span><span class="op" id="7465401">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465404">}</span><span class="op" id="7465405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465412">&amp;</span><span class="ident" id="7465413">Cookie</span><span class="op" id="7465419">{</span><span class="ident" id="7465420">Name</span><span class="op" id="7465424">:</span>&nbsp;<span class="string" id="7465426">&#34;special-7&#34;</span><span class="op" id="7465437">,</span>&nbsp;<span class="ident" id="7465439">Value</span><span class="op" id="7465444">:</span>&nbsp;<span class="string" id="7465446">&#34;a,&#34;</span><span class="op" id="7465450">}</span><span class="op" id="7465451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465455">`special-7=&#34;a,&#34;`</span><span class="op" id="7465471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465474">}</span><span class="op" id="7465475">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465482">&amp;</span><span class="ident" id="7465483">Cookie</span><span class="op" id="7465489">{</span><span class="ident" id="7465490">Name</span><span class="op" id="7465494">:</span>&nbsp;<span class="string" id="7465496">&#34;special-8&#34;</span><span class="op" id="7465507">,</span>&nbsp;<span class="ident" id="7465509">Value</span><span class="op" id="7465514">:</span>&nbsp;<span class="string" id="7465516">&#34;,&#34;</span><span class="op" id="7465519">}</span><span class="op" id="7465520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465524">`special-8=&#34;,&#34;`</span><span class="op" id="7465539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465542">}</span><span class="op" id="7465543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465546">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465550">&amp;</span><span class="ident" id="7465551">Cookie</span><span class="op" id="7465557">{</span><span class="ident" id="7465558">Name</span><span class="op" id="7465562">:</span>&nbsp;<span class="string" id="7465564">&#34;empty-value&#34;</span><span class="op" id="7465577">,</span>&nbsp;<span class="ident" id="7465579">Value</span><span class="op" id="7465584">:</span>&nbsp;<span class="string" id="7465586">&#34;&#34;</span><span class="op" id="7465588">}</span><span class="op" id="7465589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7465593">`empty-value=`</span><span class="op" id="7465607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465610">}</span><span class="op" id="7465611">,</span><br>
<span class="lineno"></span><span class="op" id="7465613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7465616">func</span>&nbsp;<span class="ident" id="7465621">TestWriteSetCookies</span><span class="op" id="7465640">(</span><span class="ident" id="7465641">t</span>&nbsp;<span class="op" id="7465643">*</span><span class="ident" id="7465644">testing</span><span class="op" id="7465651">.</span><span class="ident" id="7465652">T</span><span class="op" id="7465653">)</span>&nbsp;<span class="op" id="7465655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7465658">defer</span>&nbsp;<span class="ident" id="7465664">log</span><span class="op" id="7465667">.</span><span class="ident" id="7465668">SetOutput</span><span class="op" id="7465677">(</span><span class="ident" id="7465678">os</span><span class="op" id="7465680">.</span><span class="ident" id="7465681">Stderr</span><span class="op" id="7465687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7465690">var</span>&nbsp;<span class="ident" id="7465694">logbuf</span>&nbsp;<span class="ident" id="7465701">bytes</span><span class="op" id="7465706">.</span><span class="ident" id="7465707">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7465715">log</span><span class="op" id="7465718">.</span><span class="ident" id="7465719">SetOutput</span><span class="op" id="7465728">(</span><span class="op" id="7465729">&amp;</span><span class="ident" id="7465730">logbuf</span><span class="op" id="7465736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7465740">for</span>&nbsp;<span class="ident" id="7465744">i</span><span class="op" id="7465745">,</span>&nbsp;<span class="ident" id="7465747">tt</span>&nbsp;<span class="op" id="7465750">:=</span>&nbsp;<span class="keyword" id="7465753">range</span>&nbsp;<span class="ident" id="7465759">writeSetCookiesTests</span>&nbsp;<span class="op" id="7465780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7465784">if</span>&nbsp;<span class="ident" id="7465787">g</span><span class="op" id="7465788">,</span>&nbsp;<span class="ident" id="7465790">e</span>&nbsp;<span class="op" id="7465792">:=</span>&nbsp;<span class="ident" id="7465795">tt</span><span class="op" id="7465797">.</span><span class="ident" id="7465798">Cookie</span><span class="op" id="7465804">.</span><span class="ident" id="7465805">String</span><span class="op" id="7465811">(</span><span class="op" id="7465812">)</span><span class="op" id="7465813">,</span>&nbsp;<span class="ident" id="7465815">tt</span><span class="op" id="7465817">.</span><span class="ident" id="7465818">Raw</span><span class="op" id="7465821">;</span>&nbsp;<span class="ident" id="7465823">g</span>&nbsp;<span class="op" id="7465825">!=</span>&nbsp;<span class="ident" id="7465828">e</span>&nbsp;<span class="op" id="7465830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7465835">t</span><span class="op" id="7465836">.</span><span class="ident" id="7465837">Errorf</span><span class="op" id="7465843">(</span><span class="string" id="7465844">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7465881">,</span>&nbsp;<span class="ident" id="7465883">i</span><span class="op" id="7465884">,</span>&nbsp;<span class="ident" id="7465886">e</span><span class="op" id="7465887">,</span>&nbsp;<span class="ident" id="7465889">g</span><span class="op" id="7465890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7465895">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465906">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7465909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7465913">if</span>&nbsp;<span class="ident" id="7465916">got</span><span class="op" id="7465919">,</span>&nbsp;<span class="ident" id="7465921">sub</span>&nbsp;<span class="op" id="7465925">:=</span>&nbsp;<span class="ident" id="7465928">logbuf</span><span class="op" id="7465934">.</span><span class="ident" id="7465935">String</span><span class="op" id="7465941">(</span><span class="op" id="7465942">)</span><span class="op" id="7465943">,</span>&nbsp;<span class="string" id="7465945">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="7465972">;</span>&nbsp;<span class="op" id="7465974">!</span><span class="ident" id="7465975">strings</span><span class="op" id="7465982">.</span><span class="ident" id="7465983">Contains</span><span class="op" id="7465991">(</span><span class="ident" id="7465992">got</span><span class="op" id="7465995">,</span>&nbsp;<span class="ident" id="7465997">sub</span><span class="op" id="7466000">)</span>&nbsp;<span class="op" id="7466002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466006">t</span><span class="op" id="7466007">.</span><span class="ident" id="7466008">Errorf</span><span class="op" id="7466014">(</span><span class="string" id="7466015">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7466062">,</span>&nbsp;<span class="ident" id="7466064">sub</span><span class="op" id="7466067">,</span>&nbsp;<span class="ident" id="7466069">got</span><span class="op" id="7466072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7466075">}</span><br>
<span class="lineno">110</span><span class="op" id="7466077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7466080">type</span>&nbsp;<span class="ident" id="7466085">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="7466110">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7466118">func</span>&nbsp;<span class="op" id="7466123">(</span><span class="ident" id="7466124">ho</span>&nbsp;<span class="ident" id="7466127">headerOnlyResponseWriter</span><span class="op" id="7466151">)</span>&nbsp;<span class="ident" id="7466153">Header</span><span class="op" id="7466159">(</span><span class="op" id="7466160">)</span>&nbsp;<span class="ident" id="7466162">Header</span>&nbsp;<span class="op" id="7466169">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7466172">return</span>&nbsp;<span class="ident" id="7466179">Header</span><span class="op" id="7466185">(</span><span class="ident" id="7466186">ho</span><span class="op" id="7466188">)</span><br>
<span class="lineno"></span><span class="op" id="7466190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7466193">func</span>&nbsp;<span class="op" id="7466198">(</span><span class="ident" id="7466199">ho</span>&nbsp;<span class="ident" id="7466202">headerOnlyResponseWriter</span><span class="op" id="7466226">)</span>&nbsp;<span class="ident" id="7466228">Write</span><span class="op" id="7466233">(</span><span class="op" id="7466234">[</span><span class="op" id="7466235">]</span><span class="builtintype" id="7466236">byte</span><span class="op" id="7466240">)</span>&nbsp;<span class="op" id="7466242">(</span><span class="builtintype" id="7466243">int</span><span class="op" id="7466246">,</span>&nbsp;<span class="builtintype" id="7466248">error</span><span class="op" id="7466253">)</span>&nbsp;<span class="op" id="7466255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7466258">panic</span><span class="op" id="7466263">(</span><span class="string" id="7466264">&#34;NOIMPL&#34;</span><span class="op" id="7466272">)</span><br>
<span class="lineno">120</span><span class="op" id="7466274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7466277">func</span>&nbsp;<span class="op" id="7466282">(</span><span class="ident" id="7466283">ho</span>&nbsp;<span class="ident" id="7466286">headerOnlyResponseWriter</span><span class="op" id="7466310">)</span>&nbsp;<span class="ident" id="7466312">WriteHeader</span><span class="op" id="7466323">(</span><span class="builtintype" id="7466324">int</span><span class="op" id="7466327">)</span>&nbsp;<span class="op" id="7466329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7466332">panic</span><span class="op" id="7466337">(</span><span class="string" id="7466338">&#34;NOIMPL&#34;</span><span class="op" id="7466346">)</span><br>
<span class="lineno"></span><span class="op" id="7466348">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7466351">func</span>&nbsp;<span class="ident" id="7466356">TestSetCookie</span><span class="op" id="7466369">(</span><span class="ident" id="7466370">t</span>&nbsp;<span class="op" id="7466372">*</span><span class="ident" id="7466373">testing</span><span class="op" id="7466380">.</span><span class="ident" id="7466381">T</span><span class="op" id="7466382">)</span>&nbsp;<span class="op" id="7466384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466387">m</span>&nbsp;<span class="op" id="7466389">:=</span>&nbsp;<span class="builtinfunc" id="7466392">make</span><span class="op" id="7466396">(</span><span class="ident" id="7466397">Header</span><span class="op" id="7466403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466406">SetCookie</span><span class="op" id="7466415">(</span><span class="ident" id="7466416">headerOnlyResponseWriter</span><span class="op" id="7466440">(</span><span class="ident" id="7466441">m</span><span class="op" id="7466442">)</span><span class="op" id="7466443">,</span>&nbsp;<span class="op" id="7466445">&amp;</span><span class="ident" id="7466446">Cookie</span><span class="op" id="7466452">{</span><span class="ident" id="7466453">Name</span><span class="op" id="7466457">:</span>&nbsp;<span class="string" id="7466459">&#34;cookie-1&#34;</span><span class="op" id="7466469">,</span>&nbsp;<span class="ident" id="7466471">Value</span><span class="op" id="7466476">:</span>&nbsp;<span class="string" id="7466478">&#34;one&#34;</span><span class="op" id="7466483">,</span>&nbsp;<span class="ident" id="7466485">Path</span><span class="op" id="7466489">:</span>&nbsp;<span class="string" id="7466491">&#34;/restricted/&#34;</span><span class="op" id="7466505">}</span><span class="op" id="7466506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466509">SetCookie</span><span class="op" id="7466518">(</span><span class="ident" id="7466519">headerOnlyResponseWriter</span><span class="op" id="7466543">(</span><span class="ident" id="7466544">m</span><span class="op" id="7466545">)</span><span class="op" id="7466546">,</span>&nbsp;<span class="op" id="7466548">&amp;</span><span class="ident" id="7466549">Cookie</span><span class="op" id="7466555">{</span><span class="ident" id="7466556">Name</span><span class="op" id="7466560">:</span>&nbsp;<span class="string" id="7466562">&#34;cookie-2&#34;</span><span class="op" id="7466572">,</span>&nbsp;<span class="ident" id="7466574">Value</span><span class="op" id="7466579">:</span>&nbsp;<span class="string" id="7466581">&#34;two&#34;</span><span class="op" id="7466586">,</span>&nbsp;<span class="ident" id="7466588">MaxAge</span><span class="op" id="7466594">:</span>&nbsp;<span class="num" id="7466596">3600</span><span class="op" id="7466600">}</span><span class="op" id="7466601">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7466604">if</span>&nbsp;<span class="ident" id="7466607">l</span>&nbsp;<span class="op" id="7466609">:=</span>&nbsp;<span class="builtinfunc" id="7466612">len</span><span class="op" id="7466615">(</span><span class="ident" id="7466616">m</span><span class="op" id="7466617">[</span><span class="string" id="7466618">&#34;Set-Cookie&#34;</span><span class="op" id="7466630">]</span><span class="op" id="7466631">)</span><span class="op" id="7466632">;</span>&nbsp;<span class="ident" id="7466634">l</span>&nbsp;<span class="op" id="7466636">!=</span>&nbsp;<span class="num" id="7466639">2</span>&nbsp;<span class="op" id="7466641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466645">t</span><span class="op" id="7466646">.</span><span class="ident" id="7466647">Fatalf</span><span class="op" id="7466653">(</span><span class="string" id="7466654">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7466683">,</span>&nbsp;<span class="num" id="7466685">2</span><span class="op" id="7466686">,</span>&nbsp;<span class="ident" id="7466688">l</span><span class="op" id="7466689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7466692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7466695">if</span>&nbsp;<span class="ident" id="7466698">g</span><span class="op" id="7466699">,</span>&nbsp;<span class="ident" id="7466701">e</span>&nbsp;<span class="op" id="7466703">:=</span>&nbsp;<span class="ident" id="7466706">m</span><span class="op" id="7466707">[</span><span class="string" id="7466708">&#34;Set-Cookie&#34;</span><span class="op" id="7466720">]</span><span class="op" id="7466721">[</span><span class="num" id="7466722">0</span><span class="op" id="7466723">]</span><span class="op" id="7466724">,</span>&nbsp;<span class="string" id="7466726">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7466759">;</span>&nbsp;<span class="ident" id="7466761">g</span>&nbsp;<span class="op" id="7466763">!=</span>&nbsp;<span class="ident" id="7466766">e</span>&nbsp;<span class="op" id="7466768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466772">t</span><span class="op" id="7466773">.</span><span class="ident" id="7466774">Errorf</span><span class="op" id="7466780">(</span><span class="string" id="7466781">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7466809">,</span>&nbsp;<span class="ident" id="7466811">e</span><span class="op" id="7466812">,</span>&nbsp;<span class="ident" id="7466814">g</span><span class="op" id="7466815">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7466818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7466821">if</span>&nbsp;<span class="ident" id="7466824">g</span><span class="op" id="7466825">,</span>&nbsp;<span class="ident" id="7466827">e</span>&nbsp;<span class="op" id="7466829">:=</span>&nbsp;<span class="ident" id="7466832">m</span><span class="op" id="7466833">[</span><span class="string" id="7466834">&#34;Set-Cookie&#34;</span><span class="op" id="7466846">]</span><span class="op" id="7466847">[</span><span class="num" id="7466848">1</span><span class="op" id="7466849">]</span><span class="op" id="7466850">,</span>&nbsp;<span class="string" id="7466852">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7466880">;</span>&nbsp;<span class="ident" id="7466882">g</span>&nbsp;<span class="op" id="7466884">!=</span>&nbsp;<span class="ident" id="7466887">e</span>&nbsp;<span class="op" id="7466889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466893">t</span><span class="op" id="7466894">.</span><span class="ident" id="7466895">Errorf</span><span class="op" id="7466901">(</span><span class="string" id="7466902">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7466930">,</span>&nbsp;<span class="ident" id="7466932">e</span><span class="op" id="7466933">,</span>&nbsp;<span class="ident" id="7466935">g</span><span class="op" id="7466936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7466939">}</span><br>
<span class="lineno"></span><span class="op" id="7466941">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7466944">var</span>&nbsp;<span class="ident" id="7466948">addCookieTests</span>&nbsp;<span class="op" id="7466963">=</span>&nbsp;<span class="op" id="7466965">[</span><span class="op" id="7466966">]</span><span class="keyword" id="7466967">struct</span>&nbsp;<span class="op" id="7466974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466977">Cookies</span>&nbsp;<span class="op" id="7466985">[</span><span class="op" id="7466986">]</span><span class="op" id="7466987">*</span><span class="ident" id="7466988">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7466996">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467004">string</span><br>
<span class="lineno"></span><span class="op" id="7467011">}</span><span class="op" id="7467012">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467019">[</span><span class="op" id="7467020">]</span><span class="op" id="7467021">*</span><span class="ident" id="7467022">Cookie</span><span class="op" id="7467028">{</span><span class="op" id="7467029">}</span><span class="op" id="7467030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7467034">&#34;&#34;</span><span class="op" id="7467036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467039">}</span><span class="op" id="7467040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467043">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467047">[</span><span class="op" id="7467048">]</span><span class="op" id="7467049">*</span><span class="ident" id="7467050">Cookie</span><span class="op" id="7467056">{</span><span class="op" id="7467057">{</span><span class="ident" id="7467058">Name</span><span class="op" id="7467062">:</span>&nbsp;<span class="string" id="7467064">&#34;cookie-1&#34;</span><span class="op" id="7467074">,</span>&nbsp;<span class="ident" id="7467076">Value</span><span class="op" id="7467081">:</span>&nbsp;<span class="string" id="7467083">&#34;v$1&#34;</span><span class="op" id="7467088">}</span><span class="op" id="7467089">}</span><span class="op" id="7467090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7467094">&#34;cookie-1=v$1&#34;</span><span class="op" id="7467108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467111">}</span><span class="op" id="7467112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467119">[</span><span class="op" id="7467120">]</span><span class="op" id="7467121">*</span><span class="ident" id="7467122">Cookie</span><span class="op" id="7467128">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467133">{</span><span class="ident" id="7467134">Name</span><span class="op" id="7467138">:</span>&nbsp;<span class="string" id="7467140">&#34;cookie-1&#34;</span><span class="op" id="7467150">,</span>&nbsp;<span class="ident" id="7467152">Value</span><span class="op" id="7467157">:</span>&nbsp;<span class="string" id="7467159">&#34;v$1&#34;</span><span class="op" id="7467164">}</span><span class="op" id="7467165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467170">{</span><span class="ident" id="7467171">Name</span><span class="op" id="7467175">:</span>&nbsp;<span class="string" id="7467177">&#34;cookie-2&#34;</span><span class="op" id="7467187">,</span>&nbsp;<span class="ident" id="7467189">Value</span><span class="op" id="7467194">:</span>&nbsp;<span class="string" id="7467196">&#34;v$2&#34;</span><span class="op" id="7467201">}</span><span class="op" id="7467202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467207">{</span><span class="ident" id="7467208">Name</span><span class="op" id="7467212">:</span>&nbsp;<span class="string" id="7467214">&#34;cookie-3&#34;</span><span class="op" id="7467224">,</span>&nbsp;<span class="ident" id="7467226">Value</span><span class="op" id="7467231">:</span>&nbsp;<span class="string" id="7467233">&#34;v$3&#34;</span><span class="op" id="7467238">}</span><span class="op" id="7467239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467243">}</span><span class="op" id="7467244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7467248">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="7467290">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467293">}</span><span class="op" id="7467294">,</span><br>
<span class="lineno"></span><span class="op" id="7467296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7467299">func</span>&nbsp;<span class="ident" id="7467304">TestAddCookie</span><span class="op" id="7467317">(</span><span class="ident" id="7467318">t</span>&nbsp;<span class="op" id="7467320">*</span><span class="ident" id="7467321">testing</span><span class="op" id="7467328">.</span><span class="ident" id="7467329">T</span><span class="op" id="7467330">)</span>&nbsp;<span class="op" id="7467332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7467335">for</span>&nbsp;<span class="ident" id="7467339">i</span><span class="op" id="7467340">,</span>&nbsp;<span class="ident" id="7467342">tt</span>&nbsp;<span class="op" id="7467345">:=</span>&nbsp;<span class="keyword" id="7467348">range</span>&nbsp;<span class="ident" id="7467354">addCookieTests</span>&nbsp;<span class="op" id="7467369">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467373">req</span><span class="op" id="7467376">,</span>&nbsp;<span class="ident" id="7467378">_</span>&nbsp;<span class="op" id="7467380">:=</span>&nbsp;<span class="ident" id="7467383">NewRequest</span><span class="op" id="7467393">(</span><span class="string" id="7467394">&#34;GET&#34;</span><span class="op" id="7467399">,</span>&nbsp;<span class="string" id="7467401">&#34;http://example.com/&#34;</span><span class="op" id="7467422">,</span>&nbsp;<span class="builtintype" id="7467424">nil</span><span class="op" id="7467427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7467431">for</span>&nbsp;<span class="ident" id="7467435">_</span><span class="op" id="7467436">,</span>&nbsp;<span class="ident" id="7467438">c</span>&nbsp;<span class="op" id="7467440">:=</span>&nbsp;<span class="keyword" id="7467443">range</span>&nbsp;<span class="ident" id="7467449">tt</span><span class="op" id="7467451">.</span><span class="ident" id="7467452">Cookies</span>&nbsp;<span class="op" id="7467460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467465">req</span><span class="op" id="7467468">.</span><span class="ident" id="7467469">AddCookie</span><span class="op" id="7467478">(</span><span class="ident" id="7467479">c</span><span class="op" id="7467480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7467488">if</span>&nbsp;<span class="ident" id="7467491">g</span>&nbsp;<span class="op" id="7467493">:=</span>&nbsp;<span class="ident" id="7467496">req</span><span class="op" id="7467499">.</span><span class="ident" id="7467500">Header</span><span class="op" id="7467506">.</span><span class="ident" id="7467507">Get</span><span class="op" id="7467510">(</span><span class="string" id="7467511">&#34;Cookie&#34;</span><span class="op" id="7467519">)</span><span class="op" id="7467520">;</span>&nbsp;<span class="ident" id="7467522">g</span>&nbsp;<span class="op" id="7467524">!=</span>&nbsp;<span class="ident" id="7467527">tt</span><span class="op" id="7467529">.</span><span class="ident" id="7467530">Raw</span>&nbsp;<span class="op" id="7467534">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467539">t</span><span class="op" id="7467540">.</span><span class="ident" id="7467541">Errorf</span><span class="op" id="7467547">(</span><span class="string" id="7467548">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="7467580">,</span>&nbsp;<span class="ident" id="7467582">i</span><span class="op" id="7467583">,</span>&nbsp;<span class="ident" id="7467585">tt</span><span class="op" id="7467587">.</span><span class="ident" id="7467588">Raw</span><span class="op" id="7467591">,</span>&nbsp;<span class="ident" id="7467593">g</span><span class="op" id="7467594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7467599">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467613">}</span><br>
<span class="lineno"></span><span class="op" id="7467615">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7467618">var</span>&nbsp;<span class="ident" id="7467622">readSetCookiesTests</span>&nbsp;<span class="op" id="7467642">=</span>&nbsp;<span class="op" id="7467644">[</span><span class="op" id="7467645">]</span><span class="keyword" id="7467646">struct</span>&nbsp;<span class="op" id="7467653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467656">Header</span>&nbsp;&nbsp;<span class="ident" id="7467664">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467672">Cookies</span>&nbsp;<span class="op" id="7467680">[</span><span class="op" id="7467681">]</span><span class="op" id="7467682">*</span><span class="ident" id="7467683">Cookie</span><br>
<span class="lineno"></span><span class="op" id="7467690">}</span><span class="op" id="7467691">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467698">Header</span><span class="op" id="7467704">{</span><span class="string" id="7467705">&#34;Set-Cookie&#34;</span><span class="op" id="7467717">:</span>&nbsp;<span class="op" id="7467719">{</span><span class="string" id="7467720">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7467734">}</span><span class="op" id="7467735">}</span><span class="op" id="7467736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467740">[</span><span class="op" id="7467741">]</span><span class="op" id="7467742">*</span><span class="ident" id="7467743">Cookie</span><span class="op" id="7467749">{</span><span class="op" id="7467750">{</span><span class="ident" id="7467751">Name</span><span class="op" id="7467755">:</span>&nbsp;<span class="string" id="7467757">&#34;Cookie-1&#34;</span><span class="op" id="7467767">,</span>&nbsp;<span class="ident" id="7467769">Value</span><span class="op" id="7467774">:</span>&nbsp;<span class="string" id="7467776">&#34;v$1&#34;</span><span class="op" id="7467781">,</span>&nbsp;<span class="ident" id="7467783">Raw</span><span class="op" id="7467786">:</span>&nbsp;<span class="string" id="7467788">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7467802">}</span><span class="op" id="7467803">}</span><span class="op" id="7467804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467807">}</span><span class="op" id="7467808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467811">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467815">Header</span><span class="op" id="7467821">{</span><span class="string" id="7467822">&#34;Set-Cookie&#34;</span><span class="op" id="7467834">:</span>&nbsp;<span class="op" id="7467836">{</span><span class="string" id="7467837">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7467936">}</span><span class="op" id="7467937">}</span><span class="op" id="7467938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467942">[</span><span class="op" id="7467943">]</span><span class="op" id="7467944">*</span><span class="ident" id="7467945">Cookie</span><span class="op" id="7467951">{</span><span class="op" id="7467952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467957">Name</span><span class="op" id="7467961">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7467969">&#34;NID&#34;</span><span class="op" id="7467974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467979">Value</span><span class="op" id="7467984">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7467991">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="7468010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468015">Path</span><span class="op" id="7468019">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468027">&#34;/&#34;</span><span class="op" id="7468030">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468035">Domain</span><span class="op" id="7468041">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468047">&#34;.google.ch&#34;</span><span class="op" id="7468059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468064">HttpOnly</span><span class="op" id="7468072">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7468076">true</span><span class="op" id="7468080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468085">Expires</span><span class="op" id="7468092">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468097">time</span><span class="op" id="7468101">.</span><span class="ident" id="7468102">Date</span><span class="op" id="7468106">(</span><span class="num" id="7468107">2011</span><span class="op" id="7468111">,</span>&nbsp;<span class="num" id="7468113">11</span><span class="op" id="7468115">,</span>&nbsp;<span class="num" id="7468117">23</span><span class="op" id="7468119">,</span>&nbsp;<span class="num" id="7468121">1</span><span class="op" id="7468122">,</span>&nbsp;<span class="num" id="7468124">5</span><span class="op" id="7468125">,</span>&nbsp;<span class="num" id="7468127">3</span><span class="op" id="7468128">,</span>&nbsp;<span class="num" id="7468130">0</span><span class="op" id="7468131">,</span>&nbsp;<span class="ident" id="7468133">time</span><span class="op" id="7468137">.</span><span class="ident" id="7468138">UTC</span><span class="op" id="7468141">)</span><span class="op" id="7468142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468147">RawExpires</span><span class="op" id="7468157">:</span>&nbsp;<span class="string" id="7468159">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="7468190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468195">Raw</span><span class="op" id="7468198">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468207">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7468306">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468310">}</span><span class="op" id="7468311">}</span><span class="op" id="7468312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468315">}</span><span class="op" id="7468316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468323">Header</span><span class="op" id="7468329">{</span><span class="string" id="7468330">&#34;Set-Cookie&#34;</span><span class="op" id="7468342">:</span>&nbsp;<span class="op" id="7468344">{</span><span class="string" id="7468345">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7468419">}</span><span class="op" id="7468420">}</span><span class="op" id="7468421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468425">[</span><span class="op" id="7468426">]</span><span class="op" id="7468427">*</span><span class="ident" id="7468428">Cookie</span><span class="op" id="7468434">{</span><span class="op" id="7468435">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468440">Name</span><span class="op" id="7468444">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468452">&#34;.ASPXAUTH&#34;</span><span class="op" id="7468463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468468">Value</span><span class="op" id="7468473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468480">&#34;7E3AA&#34;</span><span class="op" id="7468487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468492">Path</span><span class="op" id="7468496">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468504">&#34;/&#34;</span><span class="op" id="7468507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468512">Expires</span><span class="op" id="7468519">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468524">time</span><span class="op" id="7468528">.</span><span class="ident" id="7468529">Date</span><span class="op" id="7468533">(</span><span class="num" id="7468534">2012</span><span class="op" id="7468538">,</span>&nbsp;<span class="num" id="7468540">3</span><span class="op" id="7468541">,</span>&nbsp;<span class="num" id="7468543">7</span><span class="op" id="7468544">,</span>&nbsp;<span class="num" id="7468546">14</span><span class="op" id="7468548">,</span>&nbsp;<span class="num" id="7468550">25</span><span class="op" id="7468552">,</span>&nbsp;<span class="num" id="7468554">6</span><span class="op" id="7468555">,</span>&nbsp;<span class="num" id="7468557">0</span><span class="op" id="7468558">,</span>&nbsp;<span class="ident" id="7468560">time</span><span class="op" id="7468564">.</span><span class="ident" id="7468565">UTC</span><span class="op" id="7468568">)</span><span class="op" id="7468569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468574">RawExpires</span><span class="op" id="7468584">:</span>&nbsp;<span class="string" id="7468586">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="7468617">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468622">HttpOnly</span><span class="op" id="7468630">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7468634">true</span><span class="op" id="7468638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468643">Raw</span><span class="op" id="7468646">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468655">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7468729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468733">}</span><span class="op" id="7468734">}</span><span class="op" id="7468735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468738">}</span><span class="op" id="7468739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468742">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468746">Header</span><span class="op" id="7468752">{</span><span class="string" id="7468753">&#34;Set-Cookie&#34;</span><span class="op" id="7468765">:</span>&nbsp;<span class="op" id="7468767">{</span><span class="string" id="7468768">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7468809">}</span><span class="op" id="7468810">}</span><span class="op" id="7468811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468815">[</span><span class="op" id="7468816">]</span><span class="op" id="7468817">*</span><span class="ident" id="7468818">Cookie</span><span class="op" id="7468824">{</span><span class="op" id="7468825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468830">Name</span><span class="op" id="7468834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468840">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="7468859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468864">Value</span><span class="op" id="7468869">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468874">&#34;foo&#34;</span><span class="op" id="7468879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468884">Path</span><span class="op" id="7468888">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468894">&#34;/&#34;</span><span class="op" id="7468897">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468902">HttpOnly</span><span class="op" id="7468910">:</span>&nbsp;<span class="builtintype" id="7468912">true</span><span class="op" id="7468916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7468921">Raw</span><span class="op" id="7468924">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7468931">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7468972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468976">}</span><span class="op" id="7468977">}</span><span class="op" id="7468978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7468981">}</span><span class="op" id="7468982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7468985">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7469058">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7469106">Header</span><span class="op" id="7469112">{</span><span class="string" id="7469113">&#34;Set-Cookie&#34;</span><span class="op" id="7469125">:</span>&nbsp;<span class="op" id="7469127">{</span><span class="string" id="7469128">`special-1=a&nbsp;z`</span><span class="op" id="7469143">}</span><span class="op" id="7469144">}</span><span class="op" id="7469145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469149">[</span><span class="op" id="7469150">]</span><span class="op" id="7469151">*</span><span class="ident" id="7469152">Cookie</span><span class="op" id="7469158">{</span><span class="op" id="7469159">{</span><span class="ident" id="7469160">Name</span><span class="op" id="7469164">:</span>&nbsp;<span class="string" id="7469166">&#34;special-1&#34;</span><span class="op" id="7469177">,</span>&nbsp;<span class="ident" id="7469179">Value</span><span class="op" id="7469184">:</span>&nbsp;<span class="string" id="7469186">&#34;a&nbsp;z&#34;</span><span class="op" id="7469191">,</span>&nbsp;<span class="ident" id="7469193">Raw</span><span class="op" id="7469196">:</span>&nbsp;<span class="string" id="7469198">`special-1=a&nbsp;z`</span><span class="op" id="7469213">}</span><span class="op" id="7469214">}</span><span class="op" id="7469215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469218">}</span><span class="op" id="7469219">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7469226">Header</span><span class="op" id="7469232">{</span><span class="string" id="7469233">&#34;Set-Cookie&#34;</span><span class="op" id="7469245">:</span>&nbsp;<span class="op" id="7469247">{</span><span class="string" id="7469248">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7469264">}</span><span class="op" id="7469265">}</span><span class="op" id="7469266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469270">[</span><span class="op" id="7469271">]</span><span class="op" id="7469272">*</span><span class="ident" id="7469273">Cookie</span><span class="op" id="7469279">{</span><span class="op" id="7469280">{</span><span class="ident" id="7469281">Name</span><span class="op" id="7469285">:</span>&nbsp;<span class="string" id="7469287">&#34;special-2&#34;</span><span class="op" id="7469298">,</span>&nbsp;<span class="ident" id="7469300">Value</span><span class="op" id="7469305">:</span>&nbsp;<span class="string" id="7469307">&#34;&nbsp;z&#34;</span><span class="op" id="7469311">,</span>&nbsp;<span class="ident" id="7469313">Raw</span><span class="op" id="7469316">:</span>&nbsp;<span class="string" id="7469318">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7469334">}</span><span class="op" id="7469335">}</span><span class="op" id="7469336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469339">}</span><span class="op" id="7469340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469343">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7469347">Header</span><span class="op" id="7469353">{</span><span class="string" id="7469354">&#34;Set-Cookie&#34;</span><span class="op" id="7469366">:</span>&nbsp;<span class="op" id="7469368">{</span><span class="string" id="7469369">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7469385">}</span><span class="op" id="7469386">}</span><span class="op" id="7469387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469391">[</span><span class="op" id="7469392">]</span><span class="op" id="7469393">*</span><span class="ident" id="7469394">Cookie</span><span class="op" id="7469400">{</span><span class="op" id="7469401">{</span><span class="ident" id="7469402">Name</span><span class="op" id="7469406">:</span>&nbsp;<span class="string" id="7469408">&#34;special-3&#34;</span><span class="op" id="7469419">,</span>&nbsp;<span class="ident" id="7469421">Value</span><span class="op" id="7469426">:</span>&nbsp;<span class="string" id="7469428">&#34;a&nbsp;&#34;</span><span class="op" id="7469432">,</span>&nbsp;<span class="ident" id="7469434">Raw</span><span class="op" id="7469437">:</span>&nbsp;<span class="string" id="7469439">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7469455">}</span><span class="op" id="7469456">}</span><span class="op" id="7469457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469460">}</span><span class="op" id="7469461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7469468">Header</span><span class="op" id="7469474">{</span><span class="string" id="7469475">&#34;Set-Cookie&#34;</span><span class="op" id="7469487">:</span>&nbsp;<span class="op" id="7469489">{</span><span class="string" id="7469490">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7469505">}</span><span class="op" id="7469506">}</span><span class="op" id="7469507">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469511">[</span><span class="op" id="7469512">]</span><span class="op" id="7469513">*</span><span class="ident" id="7469514">Cookie</span><span class="op" id="7469520">{</span><span class="op" id="7469521">{</span><span class="ident" id="7469522">Name</span><span class="op" id="7469526">:</span>&nbsp;<span class="string" id="7469528">&#34;special-4&#34;</span><span class="op" id="7469539">,</span>&nbsp;<span class="ident" id="7469541">Value</span><span class="op" id="7469546">:</span>&nbsp;<span class="string" id="7469548">&#34;&nbsp;&#34;</span><span class="op" id="7469551">,</span>&nbsp;<span class="ident" id="7469553">Raw</span><span class="op" id="7469556">:</span>&nbsp;<span class="string" id="7469558">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7469573">}</span><span class="op" id="7469574">}</span><span class="op" id="7469575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469578">}</span><span class="op" id="7469579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7469586">Header</span><span class="op" id="7469592">{</span><span class="string" id="7469593">&#34;Set-Cookie&#34;</span><span class="op" id="7469605">:</span>&nbsp;<span class="op" id="7469607">{</span><span class="string" id="7469608">`special-5=a,z`</span><span class="op" id="7469623">}</span><span class="op" id="7469624">}</span><span class="op" id="7469625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469629">[</span><span class="op" id="7469630">]</span><span class="op" id="7469631">*</span><span class="ident" id="7469632">Cookie</span><span class="op" id="7469638">{</span><span class="op" id="7469639">{</span><span class="ident" id="7469640">Name</span><span class="op" id="7469644">:</span>&nbsp;<span class="string" id="7469646">&#34;special-5&#34;</span><span class="op" id="7469657">,</span>&nbsp;<span class="ident" id="7469659">Value</span><span class="op" id="7469664">:</span>&nbsp;<span class="string" id="7469666">&#34;a,z&#34;</span><span class="op" id="7469671">,</span>&nbsp;<span class="ident" id="7469673">Raw</span><span class="op" id="7469676">:</span>&nbsp;<span class="string" id="7469678">`special-5=a,z`</span><span class="op" id="7469693">}</span><span class="op" id="7469694">}</span><span class="op" id="7469695">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469698">}</span><span class="op" id="7469699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7469706">Header</span><span class="op" id="7469712">{</span><span class="string" id="7469713">&#34;Set-Cookie&#34;</span><span class="op" id="7469725">:</span>&nbsp;<span class="op" id="7469727">{</span><span class="string" id="7469728">`special-6=&#34;,z&#34;`</span><span class="op" id="7469744">}</span><span class="op" id="7469745">}</span><span class="op" id="7469746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469750">[</span><span class="op" id="7469751">]</span><span class="op" id="7469752">*</span><span class="ident" id="7469753">Cookie</span><span class="op" id="7469759">{</span><span class="op" id="7469760">{</span><span class="ident" id="7469761">Name</span><span class="op" id="7469765">:</span>&nbsp;<span class="string" id="7469767">&#34;special-6&#34;</span><span class="op" id="7469778">,</span>&nbsp;<span class="ident" id="7469780">Value</span><span class="op" id="7469785">:</span>&nbsp;<span class="string" id="7469787">&#34;,z&#34;</span><span class="op" id="7469791">,</span>&nbsp;<span class="ident" id="7469793">Raw</span><span class="op" id="7469796">:</span>&nbsp;<span class="string" id="7469798">`special-6=&#34;,z&#34;`</span><span class="op" id="7469814">}</span><span class="op" id="7469815">}</span><span class="op" id="7469816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469819">}</span><span class="op" id="7469820">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7469827">Header</span><span class="op" id="7469833">{</span><span class="string" id="7469834">&#34;Set-Cookie&#34;</span><span class="op" id="7469846">:</span>&nbsp;<span class="op" id="7469848">{</span><span class="string" id="7469849">`special-7=a,`</span><span class="op" id="7469863">}</span><span class="op" id="7469864">}</span><span class="op" id="7469865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469869">[</span><span class="op" id="7469870">]</span><span class="op" id="7469871">*</span><span class="ident" id="7469872">Cookie</span><span class="op" id="7469878">{</span><span class="op" id="7469879">{</span><span class="ident" id="7469880">Name</span><span class="op" id="7469884">:</span>&nbsp;<span class="string" id="7469886">&#34;special-7&#34;</span><span class="op" id="7469897">,</span>&nbsp;<span class="ident" id="7469899">Value</span><span class="op" id="7469904">:</span>&nbsp;<span class="string" id="7469906">&#34;a,&#34;</span><span class="op" id="7469910">,</span>&nbsp;<span class="ident" id="7469912">Raw</span><span class="op" id="7469915">:</span>&nbsp;<span class="string" id="7469917">`special-7=a,`</span><span class="op" id="7469931">}</span><span class="op" id="7469932">}</span><span class="op" id="7469933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469936">}</span><span class="op" id="7469937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469940">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7469944">Header</span><span class="op" id="7469950">{</span><span class="string" id="7469951">&#34;Set-Cookie&#34;</span><span class="op" id="7469963">:</span>&nbsp;<span class="op" id="7469965">{</span><span class="string" id="7469966">`special-8=&#34;,&#34;`</span><span class="op" id="7469981">}</span><span class="op" id="7469982">}</span><span class="op" id="7469983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7469987">[</span><span class="op" id="7469988">]</span><span class="op" id="7469989">*</span><span class="ident" id="7469990">Cookie</span><span class="op" id="7469996">{</span><span class="op" id="7469997">{</span><span class="ident" id="7469998">Name</span><span class="op" id="7470002">:</span>&nbsp;<span class="string" id="7470004">&#34;special-8&#34;</span><span class="op" id="7470015">,</span>&nbsp;<span class="ident" id="7470017">Value</span><span class="op" id="7470022">:</span>&nbsp;<span class="string" id="7470024">&#34;,&#34;</span><span class="op" id="7470027">,</span>&nbsp;<span class="ident" id="7470029">Raw</span><span class="op" id="7470032">:</span>&nbsp;<span class="string" id="7470034">`special-8=&#34;,&#34;`</span><span class="op" id="7470049">}</span><span class="op" id="7470050">}</span><span class="op" id="7470051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7470054">}</span><span class="op" id="7470055">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7470059">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7470118">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7470181">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7470245">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7470256">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="7470400">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7470403">func</span>&nbsp;<span class="ident" id="7470408">toJSON</span><span class="op" id="7470414">(</span><span class="ident" id="7470415">v</span>&nbsp;<span class="keyword" id="7470417">interface</span><span class="op" id="7470426">{</span><span class="op" id="7470427">}</span><span class="op" id="7470428">)</span>&nbsp;<span class="builtintype" id="7470430">string</span>&nbsp;<span class="op" id="7470437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7470440">b</span><span class="op" id="7470441">,</span>&nbsp;<span class="ident" id="7470443">err</span>&nbsp;<span class="op" id="7470447">:=</span>&nbsp;<span class="ident" id="7470450">json</span><span class="op" id="7470454">.</span><span class="ident" id="7470455">Marshal</span><span class="op" id="7470462">(</span><span class="ident" id="7470463">v</span><span class="op" id="7470464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7470467">if</span>&nbsp;<span class="ident" id="7470470">err</span>&nbsp;<span class="op" id="7470474">!=</span>&nbsp;<span class="builtintype" id="7470477">nil</span>&nbsp;<span class="op" id="7470481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7470485">return</span>&nbsp;<span class="ident" id="7470492">fmt</span><span class="op" id="7470495">.</span><span class="ident" id="7470496">Sprintf</span><span class="op" id="7470503">(</span><span class="string" id="7470504">&#34;%#v&#34;</span><span class="op" id="7470509">,</span>&nbsp;<span class="ident" id="7470511">v</span><span class="op" id="7470512">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7470515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7470518">return</span>&nbsp;<span class="builtintype" id="7470525">string</span><span class="op" id="7470531">(</span><span class="ident" id="7470532">b</span><span class="op" id="7470533">)</span><br>
<span class="lineno"></span><span class="op" id="7470535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7470538">func</span>&nbsp;<span class="ident" id="7470543">TestReadSetCookies</span><span class="op" id="7470561">(</span><span class="ident" id="7470562">t</span>&nbsp;<span class="op" id="7470564">*</span><span class="ident" id="7470565">testing</span><span class="op" id="7470572">.</span><span class="ident" id="7470573">T</span><span class="op" id="7470574">)</span>&nbsp;<span class="op" id="7470576">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7470579">for</span>&nbsp;<span class="ident" id="7470583">i</span><span class="op" id="7470584">,</span>&nbsp;<span class="ident" id="7470586">tt</span>&nbsp;<span class="op" id="7470589">:=</span>&nbsp;<span class="keyword" id="7470592">range</span>&nbsp;<span class="ident" id="7470598">readSetCookiesTests</span>&nbsp;<span class="op" id="7470618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7470622">for</span>&nbsp;<span class="ident" id="7470626">n</span>&nbsp;<span class="op" id="7470628">:=</span>&nbsp;<span class="num" id="7470631">0</span><span class="op" id="7470632">;</span>&nbsp;<span class="ident" id="7470634">n</span>&nbsp;<span class="op" id="7470636">&lt;</span>&nbsp;<span class="num" id="7470638">2</span><span class="op" id="7470639">;</span>&nbsp;<span class="ident" id="7470641">n</span><span class="op" id="7470642">++</span>&nbsp;<span class="op" id="7470645">{</span>&nbsp;<span class="comment" id="7470647">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7470703">c</span>&nbsp;<span class="op" id="7470705">:=</span>&nbsp;<span class="ident" id="7470708">readSetCookies</span><span class="op" id="7470722">(</span><span class="ident" id="7470723">tt</span><span class="op" id="7470725">.</span><span class="ident" id="7470726">Header</span><span class="op" id="7470732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7470737">if</span>&nbsp;<span class="op" id="7470740">!</span><span class="ident" id="7470741">reflect</span><span class="op" id="7470748">.</span><span class="ident" id="7470749">DeepEqual</span><span class="op" id="7470758">(</span><span class="ident" id="7470759">c</span><span class="op" id="7470760">,</span>&nbsp;<span class="ident" id="7470762">tt</span><span class="op" id="7470764">.</span><span class="ident" id="7470765">Cookies</span><span class="op" id="7470772">)</span>&nbsp;<span class="op" id="7470774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7470780">t</span><span class="op" id="7470781">.</span><span class="ident" id="7470782">Errorf</span><span class="op" id="7470788">(</span><span class="string" id="7470789">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="7470831">,</span>&nbsp;<span class="ident" id="7470833">i</span><span class="op" id="7470834">,</span>&nbsp;<span class="ident" id="7470836">toJSON</span><span class="op" id="7470842">(</span><span class="ident" id="7470843">c</span><span class="op" id="7470844">)</span><span class="op" id="7470845">,</span>&nbsp;<span class="ident" id="7470847">toJSON</span><span class="op" id="7470853">(</span><span class="ident" id="7470854">tt</span><span class="op" id="7470856">.</span><span class="ident" id="7470857">Cookies</span><span class="op" id="7470864">)</span><span class="op" id="7470865">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7470871">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7470883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7470887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7470890">}</span><br>
<span class="lineno"></span><span class="op" id="7470892">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="7470895">var</span>&nbsp;<span class="ident" id="7470899">readCookiesTests</span>&nbsp;<span class="op" id="7470916">=</span>&nbsp;<span class="op" id="7470918">[</span><span class="op" id="7470919">]</span><span class="keyword" id="7470920">struct</span>&nbsp;<span class="op" id="7470927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7470930">Header</span>&nbsp;&nbsp;<span class="ident" id="7470938">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7470946">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="7470954">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7470962">Cookies</span>&nbsp;<span class="op" id="7470970">[</span><span class="op" id="7470971">]</span><span class="op" id="7470972">*</span><span class="ident" id="7470973">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="7470980">}</span><span class="op" id="7470981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7470984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7470988">Header</span><span class="op" id="7470994">{</span><span class="string" id="7470995">&#34;Cookie&#34;</span><span class="op" id="7471003">:</span>&nbsp;<span class="op" id="7471005">{</span><span class="string" id="7471006">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7471020">,</span>&nbsp;<span class="string" id="7471022">&#34;c2=v2&#34;</span><span class="op" id="7471029">}</span><span class="op" id="7471030">}</span><span class="op" id="7471031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7471035">&#34;&#34;</span><span class="op" id="7471037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471041">[</span><span class="op" id="7471042">]</span><span class="op" id="7471043">*</span><span class="ident" id="7471044">Cookie</span><span class="op" id="7471050">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471055">{</span><span class="ident" id="7471056">Name</span><span class="op" id="7471060">:</span>&nbsp;<span class="string" id="7471062">&#34;Cookie-1&#34;</span><span class="op" id="7471072">,</span>&nbsp;<span class="ident" id="7471074">Value</span><span class="op" id="7471079">:</span>&nbsp;<span class="string" id="7471081">&#34;v$1&#34;</span><span class="op" id="7471086">}</span><span class="op" id="7471087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471092">{</span><span class="ident" id="7471093">Name</span><span class="op" id="7471097">:</span>&nbsp;<span class="string" id="7471099">&#34;c2&#34;</span><span class="op" id="7471103">,</span>&nbsp;<span class="ident" id="7471105">Value</span><span class="op" id="7471110">:</span>&nbsp;<span class="string" id="7471112">&#34;v2&#34;</span><span class="op" id="7471116">}</span><span class="op" id="7471117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471121">}</span><span class="op" id="7471122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471125">}</span><span class="op" id="7471126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471129">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7471133">Header</span><span class="op" id="7471139">{</span><span class="string" id="7471140">&#34;Cookie&#34;</span><span class="op" id="7471148">:</span>&nbsp;<span class="op" id="7471150">{</span><span class="string" id="7471151">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7471165">,</span>&nbsp;<span class="string" id="7471167">&#34;c2=v2&#34;</span><span class="op" id="7471174">}</span><span class="op" id="7471175">}</span><span class="op" id="7471176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7471180">&#34;c2&#34;</span><span class="op" id="7471184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471188">[</span><span class="op" id="7471189">]</span><span class="op" id="7471190">*</span><span class="ident" id="7471191">Cookie</span><span class="op" id="7471197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471202">{</span><span class="ident" id="7471203">Name</span><span class="op" id="7471207">:</span>&nbsp;<span class="string" id="7471209">&#34;c2&#34;</span><span class="op" id="7471213">,</span>&nbsp;<span class="ident" id="7471215">Value</span><span class="op" id="7471220">:</span>&nbsp;<span class="string" id="7471222">&#34;v2&#34;</span><span class="op" id="7471226">}</span><span class="op" id="7471227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471231">}</span><span class="op" id="7471232">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471235">}</span><span class="op" id="7471236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7471243">Header</span><span class="op" id="7471249">{</span><span class="string" id="7471250">&#34;Cookie&#34;</span><span class="op" id="7471258">:</span>&nbsp;<span class="op" id="7471260">{</span><span class="string" id="7471261">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7471282">}</span><span class="op" id="7471283">}</span><span class="op" id="7471284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7471288">&#34;&#34;</span><span class="op" id="7471290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471294">[</span><span class="op" id="7471295">]</span><span class="op" id="7471296">*</span><span class="ident" id="7471297">Cookie</span><span class="op" id="7471303">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471308">{</span><span class="ident" id="7471309">Name</span><span class="op" id="7471313">:</span>&nbsp;<span class="string" id="7471315">&#34;Cookie-1&#34;</span><span class="op" id="7471325">,</span>&nbsp;<span class="ident" id="7471327">Value</span><span class="op" id="7471332">:</span>&nbsp;<span class="string" id="7471334">&#34;v$1&#34;</span><span class="op" id="7471339">}</span><span class="op" id="7471340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471345">{</span><span class="ident" id="7471346">Name</span><span class="op" id="7471350">:</span>&nbsp;<span class="string" id="7471352">&#34;c2&#34;</span><span class="op" id="7471356">,</span>&nbsp;<span class="ident" id="7471358">Value</span><span class="op" id="7471363">:</span>&nbsp;<span class="string" id="7471365">&#34;v2&#34;</span><span class="op" id="7471369">}</span><span class="op" id="7471370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471374">}</span><span class="op" id="7471375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471378">}</span><span class="op" id="7471379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471382">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7471386">Header</span><span class="op" id="7471392">{</span><span class="string" id="7471393">&#34;Cookie&#34;</span><span class="op" id="7471401">:</span>&nbsp;<span class="op" id="7471403">{</span><span class="string" id="7471404">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7471425">}</span><span class="op" id="7471426">}</span><span class="op" id="7471427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7471431">&#34;c2&#34;</span><span class="op" id="7471435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471439">[</span><span class="op" id="7471440">]</span><span class="op" id="7471441">*</span><span class="ident" id="7471442">Cookie</span><span class="op" id="7471448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471453">{</span><span class="ident" id="7471454">Name</span><span class="op" id="7471458">:</span>&nbsp;<span class="string" id="7471460">&#34;c2&#34;</span><span class="op" id="7471464">,</span>&nbsp;<span class="ident" id="7471466">Value</span><span class="op" id="7471471">:</span>&nbsp;<span class="string" id="7471473">&#34;v2&#34;</span><span class="op" id="7471477">}</span><span class="op" id="7471478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471482">}</span><span class="op" id="7471483">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471486">}</span><span class="op" id="7471487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7471494">Header</span><span class="op" id="7471500">{</span><span class="string" id="7471501">&#34;Cookie&#34;</span><span class="op" id="7471509">:</span>&nbsp;<span class="op" id="7471511">{</span><span class="string" id="7471512">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="7471537">}</span><span class="op" id="7471538">}</span><span class="op" id="7471539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7471543">&#34;&#34;</span><span class="op" id="7471545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471549">[</span><span class="op" id="7471550">]</span><span class="op" id="7471551">*</span><span class="ident" id="7471552">Cookie</span><span class="op" id="7471558">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471563">{</span><span class="ident" id="7471564">Name</span><span class="op" id="7471568">:</span>&nbsp;<span class="string" id="7471570">&#34;Cookie-1&#34;</span><span class="op" id="7471580">,</span>&nbsp;<span class="ident" id="7471582">Value</span><span class="op" id="7471587">:</span>&nbsp;<span class="string" id="7471589">&#34;v$1&#34;</span><span class="op" id="7471594">}</span><span class="op" id="7471595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471600">{</span><span class="ident" id="7471601">Name</span><span class="op" id="7471605">:</span>&nbsp;<span class="string" id="7471607">&#34;c2&#34;</span><span class="op" id="7471611">,</span>&nbsp;<span class="ident" id="7471613">Value</span><span class="op" id="7471618">:</span>&nbsp;<span class="string" id="7471620">&#34;v2&#34;</span><span class="op" id="7471624">}</span><span class="op" id="7471625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471629">}</span><span class="op" id="7471630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471633">}</span><span class="op" id="7471634">,</span><br>
<span class="lineno"></span><span class="op" id="7471636">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="7471639">func</span>&nbsp;<span class="ident" id="7471644">TestReadCookies</span><span class="op" id="7471659">(</span><span class="ident" id="7471660">t</span>&nbsp;<span class="op" id="7471662">*</span><span class="ident" id="7471663">testing</span><span class="op" id="7471670">.</span><span class="ident" id="7471671">T</span><span class="op" id="7471672">)</span>&nbsp;<span class="op" id="7471674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7471677">for</span>&nbsp;<span class="ident" id="7471681">i</span><span class="op" id="7471682">,</span>&nbsp;<span class="ident" id="7471684">tt</span>&nbsp;<span class="op" id="7471687">:=</span>&nbsp;<span class="keyword" id="7471690">range</span>&nbsp;<span class="ident" id="7471696">readCookiesTests</span>&nbsp;<span class="op" id="7471713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7471717">for</span>&nbsp;<span class="ident" id="7471721">n</span>&nbsp;<span class="op" id="7471723">:=</span>&nbsp;<span class="num" id="7471726">0</span><span class="op" id="7471727">;</span>&nbsp;<span class="ident" id="7471729">n</span>&nbsp;<span class="op" id="7471731">&lt;</span>&nbsp;<span class="num" id="7471733">2</span><span class="op" id="7471734">;</span>&nbsp;<span class="ident" id="7471736">n</span><span class="op" id="7471737">++</span>&nbsp;<span class="op" id="7471740">{</span>&nbsp;<span class="comment" id="7471742">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7471795">c</span>&nbsp;<span class="op" id="7471797">:=</span>&nbsp;<span class="ident" id="7471800">readCookies</span><span class="op" id="7471811">(</span><span class="ident" id="7471812">tt</span><span class="op" id="7471814">.</span><span class="ident" id="7471815">Header</span><span class="op" id="7471821">,</span>&nbsp;<span class="ident" id="7471823">tt</span><span class="op" id="7471825">.</span><span class="ident" id="7471826">Filter</span><span class="op" id="7471832">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7471837">if</span>&nbsp;<span class="op" id="7471840">!</span><span class="ident" id="7471841">reflect</span><span class="op" id="7471848">.</span><span class="ident" id="7471849">DeepEqual</span><span class="op" id="7471858">(</span><span class="ident" id="7471859">c</span><span class="op" id="7471860">,</span>&nbsp;<span class="ident" id="7471862">tt</span><span class="op" id="7471864">.</span><span class="ident" id="7471865">Cookies</span><span class="op" id="7471872">)</span>&nbsp;<span class="op" id="7471874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7471880">t</span><span class="op" id="7471881">.</span><span class="ident" id="7471882">Errorf</span><span class="op" id="7471888">(</span><span class="string" id="7471889">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7471929">,</span>&nbsp;<span class="ident" id="7471931">i</span><span class="op" id="7471932">,</span>&nbsp;<span class="ident" id="7471934">toJSON</span><span class="op" id="7471940">(</span><span class="ident" id="7471941">c</span><span class="op" id="7471942">)</span><span class="op" id="7471943">,</span>&nbsp;<span class="ident" id="7471945">toJSON</span><span class="op" id="7471951">(</span><span class="ident" id="7471952">tt</span><span class="op" id="7471954">.</span><span class="ident" id="7471955">Cookies</span><span class="op" id="7471962">)</span><span class="op" id="7471963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7471969">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471985">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7471988">}</span><br>
<span class="lineno"></span><span class="op" id="7471990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7471993">func</span>&nbsp;<span class="ident" id="7471998">TestSetCookieDoubleQuotes</span><span class="op" id="7472023">(</span><span class="ident" id="7472024">t</span>&nbsp;<span class="op" id="7472026">*</span><span class="ident" id="7472027">testing</span><span class="op" id="7472034">.</span><span class="ident" id="7472035">T</span><span class="op" id="7472036">)</span>&nbsp;<span class="op" id="7472038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472041">res</span>&nbsp;<span class="op" id="7472045">:=</span>&nbsp;<span class="op" id="7472048">&amp;</span><span class="ident" id="7472049">Response</span><span class="op" id="7472057">{</span><span class="ident" id="7472058">Header</span><span class="op" id="7472064">:</span>&nbsp;<span class="ident" id="7472066">Header</span><span class="op" id="7472072">{</span><span class="op" id="7472073">}</span><span class="op" id="7472074">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472077">res</span><span class="op" id="7472080">.</span><span class="ident" id="7472081">Header</span><span class="op" id="7472087">.</span><span class="ident" id="7472088">Add</span><span class="op" id="7472091">(</span><span class="string" id="7472092">&#34;Set-Cookie&#34;</span><span class="op" id="7472104">,</span>&nbsp;<span class="string" id="7472106">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="7472132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472135">res</span><span class="op" id="7472138">.</span><span class="ident" id="7472139">Header</span><span class="op" id="7472145">.</span><span class="ident" id="7472146">Add</span><span class="op" id="7472149">(</span><span class="string" id="7472150">&#34;Set-Cookie&#34;</span><span class="op" id="7472162">,</span>&nbsp;<span class="string" id="7472164">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="7472199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472202">res</span><span class="op" id="7472205">.</span><span class="ident" id="7472206">Header</span><span class="op" id="7472212">.</span><span class="ident" id="7472213">Add</span><span class="op" id="7472216">(</span><span class="string" id="7472217">&#34;Set-Cookie&#34;</span><span class="op" id="7472229">,</span>&nbsp;<span class="string" id="7472231">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="7472263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472266">res</span><span class="op" id="7472269">.</span><span class="ident" id="7472270">Header</span><span class="op" id="7472276">.</span><span class="ident" id="7472277">Add</span><span class="op" id="7472280">(</span><span class="string" id="7472281">&#34;Set-Cookie&#34;</span><span class="op" id="7472293">,</span>&nbsp;<span class="string" id="7472295">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="7472325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472328">got</span>&nbsp;<span class="op" id="7472332">:=</span>&nbsp;<span class="ident" id="7472335">res</span><span class="op" id="7472338">.</span><span class="ident" id="7472339">Cookies</span><span class="op" id="7472346">(</span><span class="op" id="7472347">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472350">want</span>&nbsp;<span class="op" id="7472355">:=</span>&nbsp;<span class="op" id="7472358">[</span><span class="op" id="7472359">]</span><span class="op" id="7472360">*</span><span class="ident" id="7472361">Cookie</span><span class="op" id="7472367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472371">{</span><span class="ident" id="7472372">Name</span><span class="op" id="7472376">:</span>&nbsp;<span class="string" id="7472378">&#34;quoted0&#34;</span><span class="op" id="7472387">,</span>&nbsp;<span class="ident" id="7472389">Value</span><span class="op" id="7472394">:</span>&nbsp;<span class="string" id="7472396">&#34;none&#34;</span><span class="op" id="7472402">,</span>&nbsp;<span class="ident" id="7472404">MaxAge</span><span class="op" id="7472410">:</span>&nbsp;<span class="num" id="7472412">30</span><span class="op" id="7472414">}</span><span class="op" id="7472415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472419">{</span><span class="ident" id="7472420">Name</span><span class="op" id="7472424">:</span>&nbsp;<span class="string" id="7472426">&#34;quoted1&#34;</span><span class="op" id="7472435">,</span>&nbsp;<span class="ident" id="7472437">Value</span><span class="op" id="7472442">:</span>&nbsp;<span class="string" id="7472444">&#34;cookieValue&#34;</span><span class="op" id="7472457">,</span>&nbsp;<span class="ident" id="7472459">MaxAge</span><span class="op" id="7472465">:</span>&nbsp;<span class="num" id="7472467">31</span><span class="op" id="7472469">}</span><span class="op" id="7472470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472474">{</span><span class="ident" id="7472475">Name</span><span class="op" id="7472479">:</span>&nbsp;<span class="string" id="7472481">&#34;quoted2&#34;</span><span class="op" id="7472490">,</span>&nbsp;<span class="ident" id="7472492">Value</span><span class="op" id="7472497">:</span>&nbsp;<span class="string" id="7472499">&#34;cookieAV&#34;</span><span class="op" id="7472509">}</span><span class="op" id="7472510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472514">{</span><span class="ident" id="7472515">Name</span><span class="op" id="7472519">:</span>&nbsp;<span class="string" id="7472521">&#34;quoted3&#34;</span><span class="op" id="7472530">,</span>&nbsp;<span class="ident" id="7472532">Value</span><span class="op" id="7472537">:</span>&nbsp;<span class="string" id="7472539">&#34;both&#34;</span><span class="op" id="7472545">}</span><span class="op" id="7472546">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7472552">if</span>&nbsp;<span class="builtinfunc" id="7472555">len</span><span class="op" id="7472558">(</span><span class="ident" id="7472559">got</span><span class="op" id="7472562">)</span>&nbsp;<span class="op" id="7472564">!=</span>&nbsp;<span class="builtinfunc" id="7472567">len</span><span class="op" id="7472570">(</span><span class="ident" id="7472571">want</span><span class="op" id="7472575">)</span>&nbsp;<span class="op" id="7472577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472581">t</span><span class="op" id="7472582">.</span><span class="ident" id="7472583">Fatal</span><span class="op" id="7472588">(</span><span class="string" id="7472589">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7472614">,</span>&nbsp;<span class="builtinfunc" id="7472616">len</span><span class="op" id="7472619">(</span><span class="ident" id="7472620">got</span><span class="op" id="7472623">)</span><span class="op" id="7472624">,</span>&nbsp;<span class="builtinfunc" id="7472626">len</span><span class="op" id="7472629">(</span><span class="ident" id="7472630">want</span><span class="op" id="7472634">)</span><span class="op" id="7472635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7472641">for</span>&nbsp;<span class="ident" id="7472645">i</span><span class="op" id="7472646">,</span>&nbsp;<span class="ident" id="7472648">w</span>&nbsp;<span class="op" id="7472650">:=</span>&nbsp;<span class="keyword" id="7472653">range</span>&nbsp;<span class="ident" id="7472659">want</span>&nbsp;<span class="op" id="7472664">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472668">g</span>&nbsp;<span class="op" id="7472670">:=</span>&nbsp;<span class="ident" id="7472673">got</span><span class="op" id="7472676">[</span><span class="ident" id="7472677">i</span><span class="op" id="7472678">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7472682">if</span>&nbsp;<span class="ident" id="7472685">g</span><span class="op" id="7472686">.</span><span class="ident" id="7472687">Name</span>&nbsp;<span class="op" id="7472692">!=</span>&nbsp;<span class="ident" id="7472695">w</span><span class="op" id="7472696">.</span><span class="ident" id="7472697">Name</span>&nbsp;<span class="op" id="7472702">||</span>&nbsp;<span class="ident" id="7472705">g</span><span class="op" id="7472706">.</span><span class="ident" id="7472707">Value</span>&nbsp;<span class="op" id="7472713">!=</span>&nbsp;<span class="ident" id="7472716">w</span><span class="op" id="7472717">.</span><span class="ident" id="7472718">Value</span>&nbsp;<span class="op" id="7472724">||</span>&nbsp;<span class="ident" id="7472727">g</span><span class="op" id="7472728">.</span><span class="ident" id="7472729">MaxAge</span>&nbsp;<span class="op" id="7472736">!=</span>&nbsp;<span class="ident" id="7472739">w</span><span class="op" id="7472740">.</span><span class="ident" id="7472741">MaxAge</span>&nbsp;<span class="op" id="7472748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472753">t</span><span class="op" id="7472754">.</span><span class="ident" id="7472755">Errorf</span><span class="op" id="7472761">(</span><span class="string" id="7472762">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7472793">,</span>&nbsp;<span class="ident" id="7472795">i</span><span class="op" id="7472796">,</span>&nbsp;<span class="ident" id="7472798">g</span><span class="op" id="7472799">,</span>&nbsp;<span class="ident" id="7472801">w</span><span class="op" id="7472802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472809">}</span><br>
<span class="lineno">360</span><span class="op" id="7472811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7472814">func</span>&nbsp;<span class="ident" id="7472819">TestCookieSanitizeValue</span><span class="op" id="7472842">(</span><span class="ident" id="7472843">t</span>&nbsp;<span class="op" id="7472845">*</span><span class="ident" id="7472846">testing</span><span class="op" id="7472853">.</span><span class="ident" id="7472854">T</span><span class="op" id="7472855">)</span>&nbsp;<span class="op" id="7472857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7472860">defer</span>&nbsp;<span class="ident" id="7472866">log</span><span class="op" id="7472869">.</span><span class="ident" id="7472870">SetOutput</span><span class="op" id="7472879">(</span><span class="ident" id="7472880">os</span><span class="op" id="7472882">.</span><span class="ident" id="7472883">Stderr</span><span class="op" id="7472889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7472892">var</span>&nbsp;<span class="ident" id="7472896">logbuf</span>&nbsp;<span class="ident" id="7472903">bytes</span><span class="op" id="7472908">.</span><span class="ident" id="7472909">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472917">log</span><span class="op" id="7472920">.</span><span class="ident" id="7472921">SetOutput</span><span class="op" id="7472930">(</span><span class="op" id="7472931">&amp;</span><span class="ident" id="7472932">logbuf</span><span class="op" id="7472938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472942">tests</span>&nbsp;<span class="op" id="7472948">:=</span>&nbsp;<span class="op" id="7472951">[</span><span class="op" id="7472952">]</span><span class="keyword" id="7472953">struct</span>&nbsp;<span class="op" id="7472960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7472964">in</span><span class="op" id="7472966">,</span>&nbsp;<span class="ident" id="7472968">want</span>&nbsp;<span class="builtintype" id="7472973">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472981">}</span><span class="op" id="7472982">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7472986">{</span><span class="string" id="7472987">&#34;foo&#34;</span><span class="op" id="7472992">,</span>&nbsp;<span class="string" id="7472994">&#34;foo&#34;</span><span class="op" id="7472999">}</span><span class="op" id="7473000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473004">{</span><span class="string" id="7473005">&#34;foo;bar&#34;</span><span class="op" id="7473014">,</span>&nbsp;<span class="string" id="7473016">&#34;foobar&#34;</span><span class="op" id="7473024">}</span><span class="op" id="7473025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473029">{</span><span class="string" id="7473030">&#34;foo\\bar&#34;</span><span class="op" id="7473040">,</span>&nbsp;<span class="string" id="7473042">&#34;foobar&#34;</span><span class="op" id="7473050">}</span><span class="op" id="7473051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473055">{</span><span class="string" id="7473056">&#34;foo\&#34;bar&#34;</span><span class="op" id="7473066">,</span>&nbsp;<span class="string" id="7473068">&#34;foobar&#34;</span><span class="op" id="7473076">}</span><span class="op" id="7473077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473081">{</span><span class="string" id="7473082">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="7473100">,</span>&nbsp;<span class="string" id="7473102">&#34;\x7e&#34;</span><span class="op" id="7473108">}</span><span class="op" id="7473109">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473113">{</span><span class="string" id="7473114">`&#34;withquotes&#34;`</span><span class="op" id="7473128">,</span>&nbsp;<span class="string" id="7473130">&#34;withquotes&#34;</span><span class="op" id="7473142">}</span><span class="op" id="7473143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473147">{</span><span class="string" id="7473148">&#34;a&nbsp;z&#34;</span><span class="op" id="7473153">,</span>&nbsp;<span class="string" id="7473155">&#34;a&nbsp;z&#34;</span><span class="op" id="7473160">}</span><span class="op" id="7473161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473165">{</span><span class="string" id="7473166">&#34;&nbsp;z&#34;</span><span class="op" id="7473170">,</span>&nbsp;<span class="string" id="7473172">`&#34;&nbsp;z&#34;`</span><span class="op" id="7473178">}</span><span class="op" id="7473179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473183">{</span><span class="string" id="7473184">&#34;a&nbsp;&#34;</span><span class="op" id="7473188">,</span>&nbsp;<span class="string" id="7473190">`&#34;a&nbsp;&#34;`</span><span class="op" id="7473196">}</span><span class="op" id="7473197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473200">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7473203">for</span>&nbsp;<span class="ident" id="7473207">_</span><span class="op" id="7473208">,</span>&nbsp;<span class="ident" id="7473210">tt</span>&nbsp;<span class="op" id="7473213">:=</span>&nbsp;<span class="keyword" id="7473216">range</span>&nbsp;<span class="ident" id="7473222">tests</span>&nbsp;<span class="op" id="7473228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7473232">if</span>&nbsp;<span class="ident" id="7473235">got</span>&nbsp;<span class="op" id="7473239">:=</span>&nbsp;<span class="ident" id="7473242">sanitizeCookieValue</span><span class="op" id="7473261">(</span><span class="ident" id="7473262">tt</span><span class="op" id="7473264">.</span><span class="ident" id="7473265">in</span><span class="op" id="7473267">)</span><span class="op" id="7473268">;</span>&nbsp;<span class="ident" id="7473270">got</span>&nbsp;<span class="op" id="7473274">!=</span>&nbsp;<span class="ident" id="7473277">tt</span><span class="op" id="7473279">.</span><span class="ident" id="7473280">want</span>&nbsp;<span class="op" id="7473285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7473290">t</span><span class="op" id="7473291">.</span><span class="ident" id="7473292">Errorf</span><span class="op" id="7473298">(</span><span class="string" id="7473299">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7473338">,</span>&nbsp;<span class="ident" id="7473340">tt</span><span class="op" id="7473342">.</span><span class="ident" id="7473343">in</span><span class="op" id="7473345">,</span>&nbsp;<span class="ident" id="7473347">got</span><span class="op" id="7473350">,</span>&nbsp;<span class="ident" id="7473352">tt</span><span class="op" id="7473354">.</span><span class="ident" id="7473355">want</span><span class="op" id="7473359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473366">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7473370">if</span>&nbsp;<span class="ident" id="7473373">got</span><span class="op" id="7473376">,</span>&nbsp;<span class="ident" id="7473378">sub</span>&nbsp;<span class="op" id="7473382">:=</span>&nbsp;<span class="ident" id="7473385">logbuf</span><span class="op" id="7473391">.</span><span class="ident" id="7473392">String</span><span class="op" id="7473398">(</span><span class="op" id="7473399">)</span><span class="op" id="7473400">,</span>&nbsp;<span class="string" id="7473402">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7473426">;</span>&nbsp;<span class="op" id="7473428">!</span><span class="ident" id="7473429">strings</span><span class="op" id="7473436">.</span><span class="ident" id="7473437">Contains</span><span class="op" id="7473445">(</span><span class="ident" id="7473446">got</span><span class="op" id="7473449">,</span>&nbsp;<span class="ident" id="7473451">sub</span><span class="op" id="7473454">)</span>&nbsp;<span class="op" id="7473456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7473460">t</span><span class="op" id="7473461">.</span><span class="ident" id="7473462">Errorf</span><span class="op" id="7473468">(</span><span class="string" id="7473469">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7473516">,</span>&nbsp;<span class="ident" id="7473518">sub</span><span class="op" id="7473521">,</span>&nbsp;<span class="ident" id="7473523">got</span><span class="op" id="7473526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473529">}</span><br>
<span class="lineno"></span><span class="op" id="7473531">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="7473534">func</span>&nbsp;<span class="ident" id="7473539">TestCookieSanitizePath</span><span class="op" id="7473561">(</span><span class="ident" id="7473562">t</span>&nbsp;<span class="op" id="7473564">*</span><span class="ident" id="7473565">testing</span><span class="op" id="7473572">.</span><span class="ident" id="7473573">T</span><span class="op" id="7473574">)</span>&nbsp;<span class="op" id="7473576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7473579">defer</span>&nbsp;<span class="ident" id="7473585">log</span><span class="op" id="7473588">.</span><span class="ident" id="7473589">SetOutput</span><span class="op" id="7473598">(</span><span class="ident" id="7473599">os</span><span class="op" id="7473601">.</span><span class="ident" id="7473602">Stderr</span><span class="op" id="7473608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7473611">var</span>&nbsp;<span class="ident" id="7473615">logbuf</span>&nbsp;<span class="ident" id="7473622">bytes</span><span class="op" id="7473627">.</span><span class="ident" id="7473628">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7473636">log</span><span class="op" id="7473639">.</span><span class="ident" id="7473640">SetOutput</span><span class="op" id="7473649">(</span><span class="op" id="7473650">&amp;</span><span class="ident" id="7473651">logbuf</span><span class="op" id="7473657">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7473661">tests</span>&nbsp;<span class="op" id="7473667">:=</span>&nbsp;<span class="op" id="7473670">[</span><span class="op" id="7473671">]</span><span class="keyword" id="7473672">struct</span>&nbsp;<span class="op" id="7473679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7473683">in</span><span class="op" id="7473685">,</span>&nbsp;<span class="ident" id="7473687">want</span>&nbsp;<span class="builtintype" id="7473692">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473700">}</span><span class="op" id="7473701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473705">{</span><span class="string" id="7473706">&#34;/path&#34;</span><span class="op" id="7473713">,</span>&nbsp;<span class="string" id="7473715">&#34;/path&#34;</span><span class="op" id="7473722">}</span><span class="op" id="7473723">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473727">{</span><span class="string" id="7473728">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7473747">,</span>&nbsp;<span class="string" id="7473749">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7473768">}</span><span class="op" id="7473769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473773">{</span><span class="string" id="7473774">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="7473806">,</span>&nbsp;<span class="string" id="7473808">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="7473834">}</span><span class="op" id="7473835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7473841">for</span>&nbsp;<span class="ident" id="7473845">_</span><span class="op" id="7473846">,</span>&nbsp;<span class="ident" id="7473848">tt</span>&nbsp;<span class="op" id="7473851">:=</span>&nbsp;<span class="keyword" id="7473854">range</span>&nbsp;<span class="ident" id="7473860">tests</span>&nbsp;<span class="op" id="7473866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7473870">if</span>&nbsp;<span class="ident" id="7473873">got</span>&nbsp;<span class="op" id="7473877">:=</span>&nbsp;<span class="ident" id="7473880">sanitizeCookiePath</span><span class="op" id="7473898">(</span><span class="ident" id="7473899">tt</span><span class="op" id="7473901">.</span><span class="ident" id="7473902">in</span><span class="op" id="7473904">)</span><span class="op" id="7473905">;</span>&nbsp;<span class="ident" id="7473907">got</span>&nbsp;<span class="op" id="7473911">!=</span>&nbsp;<span class="ident" id="7473914">tt</span><span class="op" id="7473916">.</span><span class="ident" id="7473917">want</span>&nbsp;<span class="op" id="7473922">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7473927">t</span><span class="op" id="7473928">.</span><span class="ident" id="7473929">Errorf</span><span class="op" id="7473935">(</span><span class="string" id="7473936">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7473974">,</span>&nbsp;<span class="ident" id="7473976">tt</span><span class="op" id="7473978">.</span><span class="ident" id="7473979">in</span><span class="op" id="7473981">,</span>&nbsp;<span class="ident" id="7473983">got</span><span class="op" id="7473986">,</span>&nbsp;<span class="ident" id="7473988">tt</span><span class="op" id="7473990">.</span><span class="ident" id="7473991">want</span><span class="op" id="7473995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7473999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7474002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7474006">if</span>&nbsp;<span class="ident" id="7474009">got</span><span class="op" id="7474012">,</span>&nbsp;<span class="ident" id="7474014">sub</span>&nbsp;<span class="op" id="7474018">:=</span>&nbsp;<span class="ident" id="7474021">logbuf</span><span class="op" id="7474027">.</span><span class="ident" id="7474028">String</span><span class="op" id="7474034">(</span><span class="op" id="7474035">)</span><span class="op" id="7474036">,</span>&nbsp;<span class="string" id="7474038">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7474062">;</span>&nbsp;<span class="op" id="7474064">!</span><span class="ident" id="7474065">strings</span><span class="op" id="7474072">.</span><span class="ident" id="7474073">Contains</span><span class="op" id="7474081">(</span><span class="ident" id="7474082">got</span><span class="op" id="7474085">,</span>&nbsp;<span class="ident" id="7474087">sub</span><span class="op" id="7474090">)</span>&nbsp;<span class="op" id="7474092">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7474096">t</span><span class="op" id="7474097">.</span><span class="ident" id="7474098">Errorf</span><span class="op" id="7474104">(</span><span class="string" id="7474105">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7474152">,</span>&nbsp;<span class="ident" id="7474154">sub</span><span class="op" id="7474157">,</span>&nbsp;<span class="ident" id="7474159">got</span><span class="op" id="7474162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7474165">}</span><br>
<span class="lineno"></span><span class="op" id="7474167">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
