<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/lex8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/lex8/error.go.html">error.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/error_list.go.html">error_list.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/lex_scanner.go.html">lex_scanner.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/lexer.go.html">lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/pos.go.html">pos.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/rune_scanner.go.html">rune_scanner.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/token.go.html">token.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3670869">package</span>&nbsp;<span class="ident" id="3670877">lex8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3670883">import</span>&nbsp;<span class="op" id="3670890">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3670893">&#34;bufio&#34;</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3670902">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="3670907">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3670910">//&nbsp;RuneScanner&nbsp;is&nbsp;a&nbsp;rune&nbsp;scanner&nbsp;that&nbsp;scans&nbsp;runes&nbsp;from&nbsp;a&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="3670973">//&nbsp;and&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;tracks&nbsp;the&nbsp;reading&nbsp;position.</span><br>
<span class="lineno">10</span><span class="keyword" id="3671026">type</span>&nbsp;<span class="ident" id="3671031">RuneScanner</span>&nbsp;<span class="keyword" id="3671043">struct</span>&nbsp;<span class="op" id="3671050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671053">file</span>&nbsp;<span class="builtintype" id="3671058">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671066">line</span>&nbsp;<span class="builtintype" id="3671071">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671077">rc</span>&nbsp;<span class="ident" id="3671080">io</span><span class="op" id="3671082">.</span><span class="ident" id="3671083">ReadCloser</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671095">r</span>&nbsp;&nbsp;<span class="op" id="3671098">*</span><span class="ident" id="3671099">bufio</span><span class="op" id="3671104">.</span><span class="ident" id="3671105">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671114">Err</span>&nbsp;&nbsp;<span class="builtintype" id="3671119">error</span>&nbsp;<span class="comment" id="3671125">//&nbsp;any&nbsp;error&nbsp;encountered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671151">Rune</span>&nbsp;<span class="builtintype" id="3671156">rune</span>&nbsp;&nbsp;<span class="comment" id="3671162">//&nbsp;the&nbsp;rune&nbsp;just&nbsp;read</span><br>
<span class="lineno"></span><span class="op" id="3671184">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3671187">//&nbsp;NewRuneScanner&nbsp;creates&nbsp;a&nbsp;scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3671224">func</span>&nbsp;<span class="ident" id="3671229">NewRuneScanner</span><span class="op" id="3671243">(</span><span class="ident" id="3671244">file</span>&nbsp;<span class="builtintype" id="3671249">string</span><span class="op" id="3671255">,</span>&nbsp;<span class="ident" id="3671257">rc</span>&nbsp;<span class="ident" id="3671260">io</span><span class="op" id="3671262">.</span><span class="ident" id="3671263">ReadCloser</span><span class="op" id="3671273">)</span>&nbsp;<span class="op" id="3671275">*</span><span class="ident" id="3671276">RuneScanner</span>&nbsp;<span class="op" id="3671288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671291">ret</span>&nbsp;<span class="op" id="3671295">:=</span>&nbsp;<span class="builtinfunc" id="3671298">new</span><span class="op" id="3671301">(</span><span class="ident" id="3671302">RuneScanner</span><span class="op" id="3671313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671316">ret</span><span class="op" id="3671319">.</span><span class="ident" id="3671320">file</span>&nbsp;<span class="op" id="3671325">=</span>&nbsp;<span class="ident" id="3671327">file</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671333">ret</span><span class="op" id="3671336">.</span><span class="ident" id="3671337">rc</span>&nbsp;<span class="op" id="3671340">=</span>&nbsp;<span class="ident" id="3671342">rc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671346">ret</span><span class="op" id="3671349">.</span><span class="ident" id="3671350">r</span>&nbsp;<span class="op" id="3671352">=</span>&nbsp;<span class="ident" id="3671354">bufio</span><span class="op" id="3671359">.</span><span class="ident" id="3671360">NewReader</span><span class="op" id="3671369">(</span><span class="ident" id="3671370">rc</span><span class="op" id="3671372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671375">ret</span><span class="op" id="3671378">.</span><span class="ident" id="3671379">line</span>&nbsp;<span class="op" id="3671384">=</span>&nbsp;<span class="num" id="3671386">1</span>&nbsp;<span class="comment" id="3671388">//&nbsp;natural&nbsp;counting</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671410">return</span>&nbsp;<span class="ident" id="3671417">ret</span><br>
<span class="lineno">30</span><span class="op" id="3671421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3671424">//&nbsp;Scan&nbsp;reads&nbsp;in&nbsp;the&nbsp;next&nbsp;rune&nbsp;to&nbsp;s.Rune.</span><br>
<span class="lineno"></span><span class="comment" id="3671466">//&nbsp;It&nbsp;closes&nbsp;the&nbsp;reader&nbsp;automatically&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the&nbsp;end&nbsp;of&nbsp;file</span><br>
<span class="lineno"></span><span class="comment" id="3671536">//&nbsp;or&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno">35</span><span class="keyword" id="3671564">func</span>&nbsp;<span class="op" id="3671569">(</span><span class="ident" id="3671570">s</span>&nbsp;<span class="op" id="3671572">*</span><span class="ident" id="3671573">RuneScanner</span><span class="op" id="3671584">)</span>&nbsp;<span class="ident" id="3671586">Scan</span><span class="op" id="3671590">(</span><span class="op" id="3671591">)</span>&nbsp;<span class="builtintype" id="3671593">bool</span>&nbsp;<span class="op" id="3671598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671601">wasEndline</span>&nbsp;<span class="op" id="3671612">:=</span>&nbsp;<span class="ident" id="3671615">s</span><span class="op" id="3671616">.</span><span class="ident" id="3671617">Rune</span>&nbsp;<span class="op" id="3671622">==</span>&nbsp;<span class="string" id="3671625">&#39;\n&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671632">s</span><span class="op" id="3671633">.</span><span class="ident" id="3671634">Rune</span><span class="op" id="3671638">,</span>&nbsp;<span class="ident" id="3671640">_</span><span class="op" id="3671641">,</span>&nbsp;<span class="ident" id="3671643">s</span><span class="op" id="3671644">.</span><span class="ident" id="3671645">Err</span>&nbsp;<span class="op" id="3671649">=</span>&nbsp;<span class="ident" id="3671651">s</span><span class="op" id="3671652">.</span><span class="ident" id="3671653">r</span><span class="op" id="3671654">.</span><span class="ident" id="3671655">ReadRune</span><span class="op" id="3671663">(</span><span class="op" id="3671664">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671668">if</span>&nbsp;<span class="ident" id="3671671">s</span><span class="op" id="3671672">.</span><span class="ident" id="3671673">Err</span>&nbsp;<span class="op" id="3671677">!=</span>&nbsp;<span class="ident" id="3671680">nil</span>&nbsp;<span class="op" id="3671684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671688">closeErr</span>&nbsp;<span class="op" id="3671697">:=</span>&nbsp;<span class="ident" id="3671700">s</span><span class="op" id="3671701">.</span><span class="ident" id="3671702">rc</span><span class="op" id="3671704">.</span><span class="ident" id="3671705">Close</span><span class="op" id="3671710">(</span><span class="op" id="3671711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671715">if</span>&nbsp;<span class="ident" id="3671718">s</span><span class="op" id="3671719">.</span><span class="ident" id="3671720">Err</span>&nbsp;<span class="op" id="3671724">==</span>&nbsp;<span class="ident" id="3671727">io</span><span class="op" id="3671729">.</span><span class="ident" id="3671730">EOF</span>&nbsp;<span class="op" id="3671734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671739">s</span><span class="op" id="3671740">.</span><span class="ident" id="3671741">Err</span>&nbsp;<span class="op" id="3671745">=</span>&nbsp;<span class="ident" id="3671747">closeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671758">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671762">return</span>&nbsp;<span class="builtintype" id="3671769">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671780">if</span>&nbsp;<span class="ident" id="3671783">wasEndline</span>&nbsp;<span class="op" id="3671794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671798">s</span><span class="op" id="3671799">.</span><span class="ident" id="3671800">line</span><span class="op" id="3671804">++</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671812">return</span>&nbsp;<span class="builtintype" id="3671819">true</span><br>
<span class="lineno"></span><span class="op" id="3671824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="3671827">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;current&nbsp;position&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="3671876">func</span>&nbsp;<span class="op" id="3671881">(</span><span class="ident" id="3671882">s</span>&nbsp;<span class="op" id="3671884">*</span><span class="ident" id="3671885">RuneScanner</span><span class="op" id="3671896">)</span>&nbsp;<span class="ident" id="3671898">Pos</span><span class="op" id="3671901">(</span><span class="op" id="3671902">)</span>&nbsp;<span class="op" id="3671904">*</span><span class="ident" id="3671905">Pos</span>&nbsp;<span class="op" id="3671909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671912">return</span>&nbsp;<span class="op" id="3671919">&amp;</span><span class="ident" id="3671920">Pos</span><span class="op" id="3671923">{</span><span class="ident" id="3671924">s</span><span class="op" id="3671925">.</span><span class="ident" id="3671926">file</span><span class="op" id="3671930">,</span>&nbsp;<span class="ident" id="3671932">s</span><span class="op" id="3671933">.</span><span class="ident" id="3671934">line</span><span class="op" id="3671938">}</span><br>
<span class="lineno"></span><span class="op" id="3671940">}</span>
</div>
</body>
</html>
