<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html" class="current">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2015738">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2015793">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2015847">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2015898">package</span>&nbsp;<span class="ident" id="2015906">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2015911">import</span>&nbsp;<span class="op" id="2015918">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2015921">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2015929">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2015940">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2015955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2015958">const</span>&nbsp;<span class="op" id="2015964">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2015967">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2016000">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016047">nByte</span>&nbsp;<span class="op" id="2016053">=</span>&nbsp;<span class="num" id="2016055">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016060">ldigits</span>&nbsp;<span class="op" id="2016068">=</span>&nbsp;<span class="string" id="2016070">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016090">udigits</span>&nbsp;<span class="op" id="2016098">=</span>&nbsp;<span class="string" id="2016100">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2016119">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2016122">const</span>&nbsp;<span class="op" id="2016128">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016131">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2016140">=</span>&nbsp;<span class="builtintype" id="2016142">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016148">unsigned</span>&nbsp;<span class="op" id="2016157">=</span>&nbsp;<span class="builtintype" id="2016159">false</span><br>
<span class="lineno">25</span><span class="op" id="2016165">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2016168">var</span>&nbsp;<span class="ident" id="2016172">padZeroBytes</span>&nbsp;<span class="op" id="2016185">=</span>&nbsp;<span class="builtinfunc" id="2016187">make</span><span class="op" id="2016191">(</span><span class="op" id="2016192">[</span><span class="op" id="2016193">]</span><span class="builtintype" id="2016194">byte</span><span class="op" id="2016198">,</span>&nbsp;<span class="ident" id="2016200">nByte</span><span class="op" id="2016205">)</span><br>
<span class="lineno"></span><span class="keyword" id="2016207">var</span>&nbsp;<span class="ident" id="2016211">padSpaceBytes</span>&nbsp;<span class="op" id="2016225">=</span>&nbsp;<span class="builtinfunc" id="2016227">make</span><span class="op" id="2016231">(</span><span class="op" id="2016232">[</span><span class="op" id="2016233">]</span><span class="builtintype" id="2016234">byte</span><span class="op" id="2016238">,</span>&nbsp;<span class="ident" id="2016240">nByte</span><span class="op" id="2016245">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2016248">func</span>&nbsp;<span class="ident" id="2016253">init</span><span class="op" id="2016257">(</span><span class="op" id="2016258">)</span>&nbsp;<span class="op" id="2016260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016263">for</span>&nbsp;<span class="ident" id="2016267">i</span>&nbsp;<span class="op" id="2016269">:=</span>&nbsp;<span class="num" id="2016272">0</span><span class="op" id="2016273">;</span>&nbsp;<span class="ident" id="2016275">i</span>&nbsp;<span class="op" id="2016277">&lt;</span>&nbsp;<span class="ident" id="2016279">nByte</span><span class="op" id="2016284">;</span>&nbsp;<span class="ident" id="2016286">i</span><span class="op" id="2016287">++</span>&nbsp;<span class="op" id="2016290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016294">padZeroBytes</span><span class="op" id="2016306">[</span><span class="ident" id="2016307">i</span><span class="op" id="2016308">]</span>&nbsp;<span class="op" id="2016310">=</span>&nbsp;<span class="string" id="2016312">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016318">padSpaceBytes</span><span class="op" id="2016331">[</span><span class="ident" id="2016332">i</span><span class="op" id="2016333">]</span>&nbsp;<span class="op" id="2016335">=</span>&nbsp;<span class="string" id="2016337">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2016342">}</span><br>
<span class="lineno">35</span><span class="op" id="2016344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2016347">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2016403">type</span>&nbsp;<span class="ident" id="2016408">fmtFlags</span>&nbsp;<span class="keyword" id="2016417">struct</span>&nbsp;<span class="op" id="2016424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016427">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2016439">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016445">precPresent</span>&nbsp;<span class="builtintype" id="2016457">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016463">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2016475">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016481">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2016493">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016499">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2016511">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016517">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2016529">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016535">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2016547">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016553">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2016565">bool</span>&nbsp;<span class="comment" id="2016570">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016611">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2016623">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2016630">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2016689">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2016756">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016810">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2016817">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016823">sharpV</span>&nbsp;<span class="builtintype" id="2016830">bool</span><br>
<span class="lineno"></span><span class="op" id="2016835">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2016838">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2016888">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2016947">type</span>&nbsp;<span class="ident" id="2016952">fmt</span>&nbsp;<span class="keyword" id="2016956">struct</span>&nbsp;<span class="op" id="2016963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016966">intbuf</span>&nbsp;<span class="op" id="2016973">[</span><span class="ident" id="2016974">nByte</span><span class="op" id="2016979">]</span><span class="builtintype" id="2016980">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016986">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2016993">*</span><span class="ident" id="2016994">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017002">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017023">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2017028">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017033">prec</span>&nbsp;<span class="builtintype" id="2017038">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017043">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2017052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2017055">func</span>&nbsp;<span class="op" id="2017060">(</span><span class="ident" id="2017061">f</span>&nbsp;<span class="op" id="2017063">*</span><span class="ident" id="2017064">fmt</span><span class="op" id="2017067">)</span>&nbsp;<span class="ident" id="2017069">clearflags</span><span class="op" id="2017079">(</span><span class="op" id="2017080">)</span>&nbsp;<span class="op" id="2017082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017085">f</span><span class="op" id="2017086">.</span><span class="ident" id="2017087">fmtFlags</span>&nbsp;<span class="op" id="2017096">=</span>&nbsp;<span class="ident" id="2017098">fmtFlags</span><span class="op" id="2017106">{</span><span class="op" id="2017107">}</span><br>
<span class="lineno"></span><span class="op" id="2017109">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2017112">func</span>&nbsp;<span class="op" id="2017117">(</span><span class="ident" id="2017118">f</span>&nbsp;<span class="op" id="2017120">*</span><span class="ident" id="2017121">fmt</span><span class="op" id="2017124">)</span>&nbsp;<span class="ident" id="2017126">init</span><span class="op" id="2017130">(</span><span class="ident" id="2017131">buf</span>&nbsp;<span class="op" id="2017135">*</span><span class="ident" id="2017136">buffer</span><span class="op" id="2017142">)</span>&nbsp;<span class="op" id="2017144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017147">f</span><span class="op" id="2017148">.</span><span class="ident" id="2017149">buf</span>&nbsp;<span class="op" id="2017153">=</span>&nbsp;<span class="ident" id="2017155">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017160">f</span><span class="op" id="2017161">.</span><span class="ident" id="2017162">clearflags</span><span class="op" id="2017172">(</span><span class="op" id="2017173">)</span><br>
<span class="lineno"></span><span class="op" id="2017175">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2017178">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2017264">func</span>&nbsp;<span class="op" id="2017269">(</span><span class="ident" id="2017270">f</span>&nbsp;<span class="op" id="2017272">*</span><span class="ident" id="2017273">fmt</span><span class="op" id="2017276">)</span>&nbsp;<span class="ident" id="2017278">computePadding</span><span class="op" id="2017292">(</span><span class="ident" id="2017293">width</span>&nbsp;<span class="builtintype" id="2017299">int</span><span class="op" id="2017302">)</span>&nbsp;<span class="op" id="2017304">(</span><span class="ident" id="2017305">padding</span>&nbsp;<span class="op" id="2017313">[</span><span class="op" id="2017314">]</span><span class="builtintype" id="2017315">byte</span><span class="op" id="2017319">,</span>&nbsp;<span class="ident" id="2017321">leftWidth</span><span class="op" id="2017330">,</span>&nbsp;<span class="ident" id="2017332">rightWidth</span>&nbsp;<span class="builtintype" id="2017343">int</span><span class="op" id="2017346">)</span>&nbsp;<span class="op" id="2017348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017351">left</span>&nbsp;<span class="op" id="2017356">:=</span>&nbsp;<span class="op" id="2017359">!</span><span class="ident" id="2017360">f</span><span class="op" id="2017361">.</span><span class="ident" id="2017362">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017369">w</span>&nbsp;<span class="op" id="2017371">:=</span>&nbsp;<span class="ident" id="2017374">f</span><span class="op" id="2017375">.</span><span class="ident" id="2017376">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017381">if</span>&nbsp;<span class="ident" id="2017384">w</span>&nbsp;<span class="op" id="2017386">&lt;</span>&nbsp;<span class="num" id="2017388">0</span>&nbsp;<span class="op" id="2017390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017394">left</span>&nbsp;<span class="op" id="2017399">=</span>&nbsp;<span class="builtintype" id="2017401">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017409">w</span>&nbsp;<span class="op" id="2017411">=</span>&nbsp;<span class="op" id="2017413">-</span><span class="ident" id="2017414">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017420">w</span>&nbsp;<span class="op" id="2017422">-=</span>&nbsp;<span class="ident" id="2017425">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017432">if</span>&nbsp;<span class="ident" id="2017435">w</span>&nbsp;<span class="op" id="2017437">&gt;</span>&nbsp;<span class="num" id="2017439">0</span>&nbsp;<span class="op" id="2017441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017445">if</span>&nbsp;<span class="ident" id="2017448">left</span>&nbsp;<span class="op" id="2017453">&amp;&amp;</span>&nbsp;<span class="ident" id="2017456">f</span><span class="op" id="2017457">.</span><span class="ident" id="2017458">zero</span>&nbsp;<span class="op" id="2017463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017468">return</span>&nbsp;<span class="ident" id="2017475">padZeroBytes</span><span class="op" id="2017487">,</span>&nbsp;<span class="ident" id="2017489">w</span><span class="op" id="2017490">,</span>&nbsp;<span class="num" id="2017492">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017500">if</span>&nbsp;<span class="ident" id="2017503">left</span>&nbsp;<span class="op" id="2017508">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017513">return</span>&nbsp;<span class="ident" id="2017520">padSpaceBytes</span><span class="op" id="2017533">,</span>&nbsp;<span class="ident" id="2017535">w</span><span class="op" id="2017536">,</span>&nbsp;<span class="num" id="2017538">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017542">}</span>&nbsp;<span class="keyword" id="2017544">else</span>&nbsp;<span class="op" id="2017549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017554">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017595">return</span>&nbsp;<span class="ident" id="2017602">padSpaceBytes</span><span class="op" id="2017615">,</span>&nbsp;<span class="num" id="2017617">0</span><span class="op" id="2017618">,</span>&nbsp;<span class="ident" id="2017620">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017624">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017630">return</span><br>
<span class="lineno"></span><span class="op" id="2017637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2017640">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2017686">func</span>&nbsp;<span class="op" id="2017691">(</span><span class="ident" id="2017692">f</span>&nbsp;<span class="op" id="2017694">*</span><span class="ident" id="2017695">fmt</span><span class="op" id="2017698">)</span>&nbsp;<span class="ident" id="2017700">writePadding</span><span class="op" id="2017712">(</span><span class="ident" id="2017713">n</span>&nbsp;<span class="builtintype" id="2017715">int</span><span class="op" id="2017718">,</span>&nbsp;<span class="ident" id="2017720">padding</span>&nbsp;<span class="op" id="2017728">[</span><span class="op" id="2017729">]</span><span class="builtintype" id="2017730">byte</span><span class="op" id="2017734">)</span>&nbsp;<span class="op" id="2017736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017739">for</span>&nbsp;<span class="ident" id="2017743">n</span>&nbsp;<span class="op" id="2017745">&gt;</span>&nbsp;<span class="num" id="2017747">0</span>&nbsp;<span class="op" id="2017749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017753">m</span>&nbsp;<span class="op" id="2017755">:=</span>&nbsp;<span class="ident" id="2017758">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017762">if</span>&nbsp;<span class="ident" id="2017765">m</span>&nbsp;<span class="op" id="2017767">&gt;</span>&nbsp;<span class="ident" id="2017769">nByte</span>&nbsp;<span class="op" id="2017775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017780">m</span>&nbsp;<span class="op" id="2017782">=</span>&nbsp;<span class="ident" id="2017784">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017796">f</span><span class="op" id="2017797">.</span><span class="ident" id="2017798">buf</span><span class="op" id="2017801">.</span><span class="ident" id="2017802">Write</span><span class="op" id="2017807">(</span><span class="ident" id="2017808">padding</span><span class="op" id="2017815">[</span><span class="num" id="2017816">0</span><span class="op" id="2017817">:</span><span class="ident" id="2017818">m</span><span class="op" id="2017819">]</span><span class="op" id="2017820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017824">n</span>&nbsp;<span class="op" id="2017826">-=</span>&nbsp;<span class="ident" id="2017829">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017832">}</span><br>
<span class="lineno"></span><span class="op" id="2017834">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2017837">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2017916">func</span>&nbsp;<span class="op" id="2017921">(</span><span class="ident" id="2017922">f</span>&nbsp;<span class="op" id="2017924">*</span><span class="ident" id="2017925">fmt</span><span class="op" id="2017928">)</span>&nbsp;<span class="ident" id="2017930">pad</span><span class="op" id="2017933">(</span><span class="ident" id="2017934">b</span>&nbsp;<span class="op" id="2017936">[</span><span class="op" id="2017937">]</span><span class="builtintype" id="2017938">byte</span><span class="op" id="2017942">)</span>&nbsp;<span class="op" id="2017944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017947">if</span>&nbsp;<span class="op" id="2017950">!</span><span class="ident" id="2017951">f</span><span class="op" id="2017952">.</span><span class="ident" id="2017953">widPresent</span>&nbsp;<span class="op" id="2017964">||</span>&nbsp;<span class="ident" id="2017967">f</span><span class="op" id="2017968">.</span><span class="ident" id="2017969">wid</span>&nbsp;<span class="op" id="2017973">==</span>&nbsp;<span class="num" id="2017976">0</span>&nbsp;<span class="op" id="2017978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017982">f</span><span class="op" id="2017983">.</span><span class="ident" id="2017984">buf</span><span class="op" id="2017987">.</span><span class="ident" id="2017988">Write</span><span class="op" id="2017993">(</span><span class="ident" id="2017994">b</span><span class="op" id="2017995">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017999">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018010">padding</span><span class="op" id="2018017">,</span>&nbsp;<span class="ident" id="2018019">left</span><span class="op" id="2018023">,</span>&nbsp;<span class="ident" id="2018025">right</span>&nbsp;<span class="op" id="2018031">:=</span>&nbsp;<span class="ident" id="2018034">f</span><span class="op" id="2018035">.</span><span class="ident" id="2018036">computePadding</span><span class="op" id="2018050">(</span><span class="ident" id="2018051">utf8</span><span class="op" id="2018055">.</span><span class="ident" id="2018056">RuneCount</span><span class="op" id="2018065">(</span><span class="ident" id="2018066">b</span><span class="op" id="2018067">)</span><span class="op" id="2018068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018071">if</span>&nbsp;<span class="ident" id="2018074">left</span>&nbsp;<span class="op" id="2018079">&gt;</span>&nbsp;<span class="num" id="2018081">0</span>&nbsp;<span class="op" id="2018083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018087">f</span><span class="op" id="2018088">.</span><span class="ident" id="2018089">writePadding</span><span class="op" id="2018101">(</span><span class="ident" id="2018102">left</span><span class="op" id="2018106">,</span>&nbsp;<span class="ident" id="2018108">padding</span><span class="op" id="2018115">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018121">f</span><span class="op" id="2018122">.</span><span class="ident" id="2018123">buf</span><span class="op" id="2018126">.</span><span class="ident" id="2018127">Write</span><span class="op" id="2018132">(</span><span class="ident" id="2018133">b</span><span class="op" id="2018134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018137">if</span>&nbsp;<span class="ident" id="2018140">right</span>&nbsp;<span class="op" id="2018146">&gt;</span>&nbsp;<span class="num" id="2018148">0</span>&nbsp;<span class="op" id="2018150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018154">f</span><span class="op" id="2018155">.</span><span class="ident" id="2018156">writePadding</span><span class="op" id="2018168">(</span><span class="ident" id="2018169">right</span><span class="op" id="2018174">,</span>&nbsp;<span class="ident" id="2018176">padding</span><span class="op" id="2018183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018186">}</span><br>
<span class="lineno">125</span><span class="op" id="2018188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2018191">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2018274">func</span>&nbsp;<span class="op" id="2018279">(</span><span class="ident" id="2018280">f</span>&nbsp;<span class="op" id="2018282">*</span><span class="ident" id="2018283">fmt</span><span class="op" id="2018286">)</span>&nbsp;<span class="ident" id="2018288">padString</span><span class="op" id="2018297">(</span><span class="ident" id="2018298">s</span>&nbsp;<span class="builtintype" id="2018300">string</span><span class="op" id="2018306">)</span>&nbsp;<span class="op" id="2018308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018311">if</span>&nbsp;<span class="op" id="2018314">!</span><span class="ident" id="2018315">f</span><span class="op" id="2018316">.</span><span class="ident" id="2018317">widPresent</span>&nbsp;<span class="op" id="2018328">||</span>&nbsp;<span class="ident" id="2018331">f</span><span class="op" id="2018332">.</span><span class="ident" id="2018333">wid</span>&nbsp;<span class="op" id="2018337">==</span>&nbsp;<span class="num" id="2018340">0</span>&nbsp;<span class="op" id="2018342">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018346">f</span><span class="op" id="2018347">.</span><span class="ident" id="2018348">buf</span><span class="op" id="2018351">.</span><span class="ident" id="2018352">WriteString</span><span class="op" id="2018363">(</span><span class="ident" id="2018364">s</span><span class="op" id="2018365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018369">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018380">padding</span><span class="op" id="2018387">,</span>&nbsp;<span class="ident" id="2018389">left</span><span class="op" id="2018393">,</span>&nbsp;<span class="ident" id="2018395">right</span>&nbsp;<span class="op" id="2018401">:=</span>&nbsp;<span class="ident" id="2018404">f</span><span class="op" id="2018405">.</span><span class="ident" id="2018406">computePadding</span><span class="op" id="2018420">(</span><span class="ident" id="2018421">utf8</span><span class="op" id="2018425">.</span><span class="ident" id="2018426">RuneCountInString</span><span class="op" id="2018443">(</span><span class="ident" id="2018444">s</span><span class="op" id="2018445">)</span><span class="op" id="2018446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018449">if</span>&nbsp;<span class="ident" id="2018452">left</span>&nbsp;<span class="op" id="2018457">&gt;</span>&nbsp;<span class="num" id="2018459">0</span>&nbsp;<span class="op" id="2018461">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018465">f</span><span class="op" id="2018466">.</span><span class="ident" id="2018467">writePadding</span><span class="op" id="2018479">(</span><span class="ident" id="2018480">left</span><span class="op" id="2018484">,</span>&nbsp;<span class="ident" id="2018486">padding</span><span class="op" id="2018493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018499">f</span><span class="op" id="2018500">.</span><span class="ident" id="2018501">buf</span><span class="op" id="2018504">.</span><span class="ident" id="2018505">WriteString</span><span class="op" id="2018516">(</span><span class="ident" id="2018517">s</span><span class="op" id="2018518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018521">if</span>&nbsp;<span class="ident" id="2018524">right</span>&nbsp;<span class="op" id="2018530">&gt;</span>&nbsp;<span class="num" id="2018532">0</span>&nbsp;<span class="op" id="2018534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018538">f</span><span class="op" id="2018539">.</span><span class="ident" id="2018540">writePadding</span><span class="op" id="2018552">(</span><span class="ident" id="2018553">right</span><span class="op" id="2018558">,</span>&nbsp;<span class="ident" id="2018560">padding</span><span class="op" id="2018567">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018570">}</span><br>
<span class="lineno"></span><span class="op" id="2018572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2018575">var</span>&nbsp;<span class="op" id="2018579">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018582">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2018593">=</span>&nbsp;<span class="op" id="2018595">[</span><span class="op" id="2018596">]</span><span class="builtintype" id="2018597">byte</span><span class="op" id="2018601">(</span><span class="string" id="2018602">&#34;true&#34;</span><span class="op" id="2018608">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018611">falseBytes</span>&nbsp;<span class="op" id="2018622">=</span>&nbsp;<span class="op" id="2018624">[</span><span class="op" id="2018625">]</span><span class="builtintype" id="2018626">byte</span><span class="op" id="2018630">(</span><span class="string" id="2018631">&#34;false&#34;</span><span class="op" id="2018638">)</span><br>
<span class="lineno"></span><span class="op" id="2018640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2018643">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2018677">func</span>&nbsp;<span class="op" id="2018682">(</span><span class="ident" id="2018683">f</span>&nbsp;<span class="op" id="2018685">*</span><span class="ident" id="2018686">fmt</span><span class="op" id="2018689">)</span>&nbsp;<span class="ident" id="2018691">fmt_boolean</span><span class="op" id="2018702">(</span><span class="ident" id="2018703">v</span>&nbsp;<span class="builtintype" id="2018705">bool</span><span class="op" id="2018709">)</span>&nbsp;<span class="op" id="2018711">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018714">if</span>&nbsp;<span class="ident" id="2018717">v</span>&nbsp;<span class="op" id="2018719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018723">f</span><span class="op" id="2018724">.</span><span class="ident" id="2018725">pad</span><span class="op" id="2018728">(</span><span class="ident" id="2018729">trueBytes</span><span class="op" id="2018738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018741">}</span>&nbsp;<span class="keyword" id="2018743">else</span>&nbsp;<span class="op" id="2018748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018752">f</span><span class="op" id="2018753">.</span><span class="ident" id="2018754">pad</span><span class="op" id="2018757">(</span><span class="ident" id="2018758">falseBytes</span><span class="op" id="2018768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018771">}</span><br>
<span class="lineno">155</span><span class="op" id="2018773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2018776">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2018858">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2018889">func</span>&nbsp;<span class="op" id="2018894">(</span><span class="ident" id="2018895">f</span>&nbsp;<span class="op" id="2018897">*</span><span class="ident" id="2018898">fmt</span><span class="op" id="2018901">)</span>&nbsp;<span class="ident" id="2018903">integer</span><span class="op" id="2018910">(</span><span class="ident" id="2018911">a</span>&nbsp;<span class="ident" id="2018913">int64</span><span class="op" id="2018918">,</span>&nbsp;<span class="ident" id="2018920">base</span>&nbsp;<span class="ident" id="2018925">uint64</span><span class="op" id="2018931">,</span>&nbsp;<span class="ident" id="2018933">signedness</span>&nbsp;<span class="builtintype" id="2018944">bool</span><span class="op" id="2018948">,</span>&nbsp;<span class="ident" id="2018950">digits</span>&nbsp;<span class="builtintype" id="2018957">string</span><span class="op" id="2018963">)</span>&nbsp;<span class="op" id="2018965">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2018968">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019024">if</span>&nbsp;<span class="ident" id="2019027">f</span><span class="op" id="2019028">.</span><span class="ident" id="2019029">precPresent</span>&nbsp;<span class="op" id="2019041">&amp;&amp;</span>&nbsp;<span class="ident" id="2019044">f</span><span class="op" id="2019045">.</span><span class="ident" id="2019046">prec</span>&nbsp;<span class="op" id="2019051">==</span>&nbsp;<span class="num" id="2019054">0</span>&nbsp;<span class="op" id="2019056">&amp;&amp;</span>&nbsp;<span class="ident" id="2019059">a</span>&nbsp;<span class="op" id="2019061">==</span>&nbsp;<span class="num" id="2019064">0</span>&nbsp;<span class="op" id="2019066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019070">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2019078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019082">var</span>&nbsp;<span class="ident" id="2019086">buf</span>&nbsp;<span class="op" id="2019090">[</span><span class="op" id="2019091">]</span><span class="builtintype" id="2019092">byte</span>&nbsp;<span class="op" id="2019097">=</span>&nbsp;<span class="ident" id="2019099">f</span><span class="op" id="2019100">.</span><span class="ident" id="2019101">intbuf</span><span class="op" id="2019107">[</span><span class="num" id="2019108">0</span><span class="op" id="2019109">:</span><span class="op" id="2019110">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019113">if</span>&nbsp;<span class="ident" id="2019116">f</span><span class="op" id="2019117">.</span><span class="ident" id="2019118">widPresent</span>&nbsp;<span class="op" id="2019129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019133">width</span>&nbsp;<span class="op" id="2019139">:=</span>&nbsp;<span class="ident" id="2019142">f</span><span class="op" id="2019143">.</span><span class="ident" id="2019144">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019150">if</span>&nbsp;<span class="ident" id="2019153">base</span>&nbsp;<span class="op" id="2019158">==</span>&nbsp;<span class="num" id="2019161">16</span>&nbsp;<span class="op" id="2019164">&amp;&amp;</span>&nbsp;<span class="ident" id="2019167">f</span><span class="op" id="2019168">.</span><span class="ident" id="2019169">sharp</span>&nbsp;<span class="op" id="2019175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2019180">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019202">width</span>&nbsp;<span class="op" id="2019208">+=</span>&nbsp;<span class="num" id="2019211">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2019215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019219">if</span>&nbsp;<span class="ident" id="2019222">width</span>&nbsp;<span class="op" id="2019228">&gt;</span>&nbsp;<span class="ident" id="2019230">nByte</span>&nbsp;<span class="op" id="2019236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2019241">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019282">buf</span>&nbsp;<span class="op" id="2019286">=</span>&nbsp;<span class="builtinfunc" id="2019288">make</span><span class="op" id="2019292">(</span><span class="op" id="2019293">[</span><span class="op" id="2019294">]</span><span class="builtintype" id="2019295">byte</span><span class="op" id="2019299">,</span>&nbsp;<span class="ident" id="2019301">width</span><span class="op" id="2019306">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2019310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2019313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019317">negative</span>&nbsp;<span class="op" id="2019326">:=</span>&nbsp;<span class="ident" id="2019329">signedness</span>&nbsp;<span class="op" id="2019340">==</span>&nbsp;<span class="ident" id="2019343">signed</span>&nbsp;<span class="op" id="2019350">&amp;&amp;</span>&nbsp;<span class="ident" id="2019353">a</span>&nbsp;<span class="op" id="2019355">&lt;</span>&nbsp;<span class="num" id="2019357">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019360">if</span>&nbsp;<span class="ident" id="2019363">negative</span>&nbsp;<span class="op" id="2019372">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019376">a</span>&nbsp;<span class="op" id="2019378">=</span>&nbsp;<span class="op" id="2019380">-</span><span class="ident" id="2019381">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2019384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2019388">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2019453">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019498">prec</span>&nbsp;<span class="op" id="2019503">:=</span>&nbsp;<span class="num" id="2019506">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019509">if</span>&nbsp;<span class="ident" id="2019512">f</span><span class="op" id="2019513">.</span><span class="ident" id="2019514">precPresent</span>&nbsp;<span class="op" id="2019526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019530">prec</span>&nbsp;<span class="op" id="2019535">=</span>&nbsp;<span class="ident" id="2019537">f</span><span class="op" id="2019538">.</span><span class="ident" id="2019539">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019546">f</span><span class="op" id="2019547">.</span><span class="ident" id="2019548">zero</span>&nbsp;<span class="op" id="2019553">=</span>&nbsp;<span class="builtintype" id="2019555">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2019562">}</span>&nbsp;<span class="keyword" id="2019564">else</span>&nbsp;<span class="keyword" id="2019569">if</span>&nbsp;<span class="ident" id="2019572">f</span><span class="op" id="2019573">.</span><span class="ident" id="2019574">zero</span>&nbsp;<span class="op" id="2019579">&amp;&amp;</span>&nbsp;<span class="ident" id="2019582">f</span><span class="op" id="2019583">.</span><span class="ident" id="2019584">widPresent</span>&nbsp;<span class="op" id="2019595">&amp;&amp;</span>&nbsp;<span class="op" id="2019598">!</span><span class="ident" id="2019599">f</span><span class="op" id="2019600">.</span><span class="ident" id="2019601">minus</span>&nbsp;<span class="op" id="2019607">&amp;&amp;</span>&nbsp;<span class="ident" id="2019610">f</span><span class="op" id="2019611">.</span><span class="ident" id="2019612">wid</span>&nbsp;<span class="op" id="2019616">&gt;</span>&nbsp;<span class="num" id="2019618">0</span>&nbsp;<span class="op" id="2019620">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019624">prec</span>&nbsp;<span class="op" id="2019629">=</span>&nbsp;<span class="ident" id="2019631">f</span><span class="op" id="2019632">.</span><span class="ident" id="2019633">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2019639">if</span>&nbsp;<span class="ident" id="2019642">negative</span>&nbsp;<span class="op" id="2019651">||</span>&nbsp;<span class="ident" id="2019654">f</span><span class="op" id="2019655">.</span><span class="ident" id="2019656">plus</span>&nbsp;<span class="op" id="2019661">||</span>&nbsp;<span class="ident" id="2019664">f</span><span class="op" id="2019665">.</span><span class="ident" id="2019666">space</span>&nbsp;<span class="op" id="2019672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019677">prec</span><span class="op" id="2019681">--</span>&nbsp;<span class="comment" id="2019684">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2019709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2019712">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2019716">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2019794">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2019848">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2019919">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019984">i</span>&nbsp;<span class="op" id="2019986">:=</span>&nbsp;<span class="builtinfunc" id="2019989">len</span><span class="op" id="2019992">(</span><span class="ident" id="2019993">buf</span><span class="op" id="2019996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2019999">ua</span>&nbsp;<span class="op" id="2020002">:=</span>&nbsp;<span class="ident" id="2020005">uint64</span><span class="op" id="2020011">(</span><span class="ident" id="2020012">a</span><span class="op" id="2020013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2020016">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2020087">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020127">switch</span>&nbsp;<span class="ident" id="2020134">base</span>&nbsp;<span class="op" id="2020139">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020142">case</span>&nbsp;<span class="num" id="2020147">10</span><span class="op" id="2020149">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020153">for</span>&nbsp;<span class="ident" id="2020157">ua</span>&nbsp;<span class="op" id="2020160">&gt;=</span>&nbsp;<span class="num" id="2020163">10</span>&nbsp;<span class="op" id="2020166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020171">i</span><span class="op" id="2020172">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020178">next</span>&nbsp;<span class="op" id="2020183">:=</span>&nbsp;<span class="ident" id="2020186">ua</span>&nbsp;<span class="op" id="2020189">/</span>&nbsp;<span class="num" id="2020191">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020197">buf</span><span class="op" id="2020200">[</span><span class="ident" id="2020201">i</span><span class="op" id="2020202">]</span>&nbsp;<span class="op" id="2020204">=</span>&nbsp;<span class="builtintype" id="2020206">byte</span><span class="op" id="2020210">(</span><span class="string" id="2020211">&#39;0&#39;</span>&nbsp;<span class="op" id="2020215">+</span>&nbsp;<span class="ident" id="2020217">ua</span>&nbsp;<span class="op" id="2020220">-</span>&nbsp;<span class="ident" id="2020222">next</span><span class="op" id="2020226">*</span><span class="num" id="2020227">10</span><span class="op" id="2020229">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020234">ua</span>&nbsp;<span class="op" id="2020237">=</span>&nbsp;<span class="ident" id="2020239">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020249">case</span>&nbsp;<span class="num" id="2020254">16</span><span class="op" id="2020256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020260">for</span>&nbsp;<span class="ident" id="2020264">ua</span>&nbsp;<span class="op" id="2020267">&gt;=</span>&nbsp;<span class="num" id="2020270">16</span>&nbsp;<span class="op" id="2020273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020278">i</span><span class="op" id="2020279">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020285">buf</span><span class="op" id="2020288">[</span><span class="ident" id="2020289">i</span><span class="op" id="2020290">]</span>&nbsp;<span class="op" id="2020292">=</span>&nbsp;<span class="ident" id="2020294">digits</span><span class="op" id="2020300">[</span><span class="ident" id="2020301">ua</span><span class="op" id="2020303">&amp;</span><span class="num" id="2020304">0xF</span><span class="op" id="2020307">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020312">ua</span>&nbsp;<span class="op" id="2020315">&gt;&gt;=</span>&nbsp;<span class="num" id="2020319">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020326">case</span>&nbsp;<span class="num" id="2020331">8</span><span class="op" id="2020332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020336">for</span>&nbsp;<span class="ident" id="2020340">ua</span>&nbsp;<span class="op" id="2020343">&gt;=</span>&nbsp;<span class="num" id="2020346">8</span>&nbsp;<span class="op" id="2020348">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020353">i</span><span class="op" id="2020354">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020360">buf</span><span class="op" id="2020363">[</span><span class="ident" id="2020364">i</span><span class="op" id="2020365">]</span>&nbsp;<span class="op" id="2020367">=</span>&nbsp;<span class="builtintype" id="2020369">byte</span><span class="op" id="2020373">(</span><span class="string" id="2020374">&#39;0&#39;</span>&nbsp;<span class="op" id="2020378">+</span>&nbsp;<span class="ident" id="2020380">ua</span><span class="op" id="2020382">&amp;</span><span class="num" id="2020383">7</span><span class="op" id="2020384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020389">ua</span>&nbsp;<span class="op" id="2020392">&gt;&gt;=</span>&nbsp;<span class="num" id="2020396">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020403">case</span>&nbsp;<span class="num" id="2020408">2</span><span class="op" id="2020409">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020413">for</span>&nbsp;<span class="ident" id="2020417">ua</span>&nbsp;<span class="op" id="2020420">&gt;=</span>&nbsp;<span class="num" id="2020423">2</span>&nbsp;<span class="op" id="2020425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020430">i</span><span class="op" id="2020431">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020437">buf</span><span class="op" id="2020440">[</span><span class="ident" id="2020441">i</span><span class="op" id="2020442">]</span>&nbsp;<span class="op" id="2020444">=</span>&nbsp;<span class="builtintype" id="2020446">byte</span><span class="op" id="2020450">(</span><span class="string" id="2020451">&#39;0&#39;</span>&nbsp;<span class="op" id="2020455">+</span>&nbsp;<span class="ident" id="2020457">ua</span><span class="op" id="2020459">&amp;</span><span class="num" id="2020460">1</span><span class="op" id="2020461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020466">ua</span>&nbsp;<span class="op" id="2020469">&gt;&gt;=</span>&nbsp;<span class="num" id="2020473">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020477">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020480">default</span><span class="op" id="2020487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2020491">panic</span><span class="op" id="2020496">(</span><span class="string" id="2020497">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2020530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020536">i</span><span class="op" id="2020537">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020541">buf</span><span class="op" id="2020544">[</span><span class="ident" id="2020545">i</span><span class="op" id="2020546">]</span>&nbsp;<span class="op" id="2020548">=</span>&nbsp;<span class="ident" id="2020550">digits</span><span class="op" id="2020556">[</span><span class="ident" id="2020557">ua</span><span class="op" id="2020559">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020562">for</span>&nbsp;<span class="ident" id="2020566">i</span>&nbsp;<span class="op" id="2020568">&gt;</span>&nbsp;<span class="num" id="2020570">0</span>&nbsp;<span class="op" id="2020572">&amp;&amp;</span>&nbsp;<span class="ident" id="2020575">prec</span>&nbsp;<span class="op" id="2020580">&gt;</span>&nbsp;<span class="builtinfunc" id="2020582">len</span><span class="op" id="2020585">(</span><span class="ident" id="2020586">buf</span><span class="op" id="2020589">)</span><span class="op" id="2020590">-</span><span class="ident" id="2020591">i</span>&nbsp;<span class="op" id="2020593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020597">i</span><span class="op" id="2020598">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020603">buf</span><span class="op" id="2020606">[</span><span class="ident" id="2020607">i</span><span class="op" id="2020608">]</span>&nbsp;<span class="op" id="2020610">=</span>&nbsp;<span class="string" id="2020612">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2020621">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020655">if</span>&nbsp;<span class="ident" id="2020658">f</span><span class="op" id="2020659">.</span><span class="ident" id="2020660">sharp</span>&nbsp;<span class="op" id="2020666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020670">switch</span>&nbsp;<span class="ident" id="2020677">base</span>&nbsp;<span class="op" id="2020682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020686">case</span>&nbsp;<span class="num" id="2020691">8</span><span class="op" id="2020692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020697">if</span>&nbsp;<span class="ident" id="2020700">buf</span><span class="op" id="2020703">[</span><span class="ident" id="2020704">i</span><span class="op" id="2020705">]</span>&nbsp;<span class="op" id="2020707">!=</span>&nbsp;<span class="string" id="2020710">&#39;0&#39;</span>&nbsp;<span class="op" id="2020714">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020720">i</span><span class="op" id="2020721">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020728">buf</span><span class="op" id="2020731">[</span><span class="ident" id="2020732">i</span><span class="op" id="2020733">]</span>&nbsp;<span class="op" id="2020735">=</span>&nbsp;<span class="string" id="2020737">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020748">case</span>&nbsp;<span class="num" id="2020753">16</span><span class="op" id="2020755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020760">i</span><span class="op" id="2020761">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020767">buf</span><span class="op" id="2020770">[</span><span class="ident" id="2020771">i</span><span class="op" id="2020772">]</span>&nbsp;<span class="op" id="2020774">=</span>&nbsp;<span class="string" id="2020776">&#39;x&#39;</span>&nbsp;<span class="op" id="2020780">+</span>&nbsp;<span class="ident" id="2020782">digits</span><span class="op" id="2020788">[</span><span class="num" id="2020789">10</span><span class="op" id="2020791">]</span>&nbsp;<span class="op" id="2020793">-</span>&nbsp;<span class="string" id="2020795">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020802">i</span><span class="op" id="2020803">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020809">buf</span><span class="op" id="2020812">[</span><span class="ident" id="2020813">i</span><span class="op" id="2020814">]</span>&nbsp;<span class="op" id="2020816">=</span>&nbsp;<span class="string" id="2020818">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020827">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020830">if</span>&nbsp;<span class="ident" id="2020833">f</span><span class="op" id="2020834">.</span><span class="ident" id="2020835">unicode</span>&nbsp;<span class="op" id="2020843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020847">i</span><span class="op" id="2020848">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020853">buf</span><span class="op" id="2020856">[</span><span class="ident" id="2020857">i</span><span class="op" id="2020858">]</span>&nbsp;<span class="op" id="2020860">=</span>&nbsp;<span class="string" id="2020862">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020868">i</span><span class="op" id="2020869">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020874">buf</span><span class="op" id="2020877">[</span><span class="ident" id="2020878">i</span><span class="op" id="2020879">]</span>&nbsp;<span class="op" id="2020881">=</span>&nbsp;<span class="string" id="2020883">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020892">if</span>&nbsp;<span class="ident" id="2020895">negative</span>&nbsp;<span class="op" id="2020904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020908">i</span><span class="op" id="2020909">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020914">buf</span><span class="op" id="2020917">[</span><span class="ident" id="2020918">i</span><span class="op" id="2020919">]</span>&nbsp;<span class="op" id="2020921">=</span>&nbsp;<span class="string" id="2020923">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020928">}</span>&nbsp;<span class="keyword" id="2020930">else</span>&nbsp;<span class="keyword" id="2020935">if</span>&nbsp;<span class="ident" id="2020938">f</span><span class="op" id="2020939">.</span><span class="ident" id="2020940">plus</span>&nbsp;<span class="op" id="2020945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020949">i</span><span class="op" id="2020950">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020955">buf</span><span class="op" id="2020958">[</span><span class="ident" id="2020959">i</span><span class="op" id="2020960">]</span>&nbsp;<span class="op" id="2020962">=</span>&nbsp;<span class="string" id="2020964">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020969">}</span>&nbsp;<span class="keyword" id="2020971">else</span>&nbsp;<span class="keyword" id="2020976">if</span>&nbsp;<span class="ident" id="2020979">f</span><span class="op" id="2020980">.</span><span class="ident" id="2020981">space</span>&nbsp;<span class="op" id="2020987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020991">i</span><span class="op" id="2020992">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020997">buf</span><span class="op" id="2021000">[</span><span class="ident" id="2021001">i</span><span class="op" id="2021002">]</span>&nbsp;<span class="op" id="2021004">=</span>&nbsp;<span class="string" id="2021006">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2021011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2021015">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2021084">if</span>&nbsp;<span class="ident" id="2021087">f</span><span class="op" id="2021088">.</span><span class="ident" id="2021089">unicode</span>&nbsp;<span class="op" id="2021097">&amp;&amp;</span>&nbsp;<span class="ident" id="2021100">f</span><span class="op" id="2021101">.</span><span class="ident" id="2021102">uniQuote</span>&nbsp;<span class="op" id="2021111">&amp;&amp;</span>&nbsp;<span class="ident" id="2021114">a</span>&nbsp;<span class="op" id="2021116">&gt;=</span>&nbsp;<span class="num" id="2021119">0</span>&nbsp;<span class="op" id="2021121">&amp;&amp;</span>&nbsp;<span class="ident" id="2021124">a</span>&nbsp;<span class="op" id="2021126">&lt;=</span>&nbsp;<span class="ident" id="2021129">utf8</span><span class="op" id="2021133">.</span><span class="ident" id="2021134">MaxRune</span>&nbsp;<span class="op" id="2021142">&amp;&amp;</span>&nbsp;<span class="ident" id="2021145">strconv</span><span class="op" id="2021152">.</span><span class="ident" id="2021153">IsPrint</span><span class="op" id="2021160">(</span><span class="builtintype" id="2021161">rune</span><span class="op" id="2021165">(</span><span class="ident" id="2021166">a</span><span class="op" id="2021167">)</span><span class="op" id="2021168">)</span>&nbsp;<span class="op" id="2021170">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021174">runeWidth</span>&nbsp;<span class="op" id="2021184">:=</span>&nbsp;<span class="ident" id="2021187">utf8</span><span class="op" id="2021191">.</span><span class="ident" id="2021192">RuneLen</span><span class="op" id="2021199">(</span><span class="builtintype" id="2021200">rune</span><span class="op" id="2021204">(</span><span class="ident" id="2021205">a</span><span class="op" id="2021206">)</span><span class="op" id="2021207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021211">width</span>&nbsp;<span class="op" id="2021217">:=</span>&nbsp;<span class="num" id="2021220">1</span>&nbsp;<span class="op" id="2021222">+</span>&nbsp;<span class="num" id="2021224">1</span>&nbsp;<span class="op" id="2021226">+</span>&nbsp;<span class="ident" id="2021228">runeWidth</span>&nbsp;<span class="op" id="2021238">+</span>&nbsp;<span class="num" id="2021240">1</span>&nbsp;<span class="comment" id="2021242">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2021273">copy</span><span class="op" id="2021277">(</span><span class="ident" id="2021278">buf</span><span class="op" id="2021281">[</span><span class="ident" id="2021282">i</span><span class="op" id="2021283">-</span><span class="ident" id="2021284">width</span><span class="op" id="2021289">:</span><span class="op" id="2021290">]</span><span class="op" id="2021291">,</span>&nbsp;<span class="ident" id="2021293">buf</span><span class="op" id="2021296">[</span><span class="ident" id="2021297">i</span><span class="op" id="2021298">:</span><span class="op" id="2021299">]</span><span class="op" id="2021300">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2021304">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021341">i</span>&nbsp;<span class="op" id="2021343">-=</span>&nbsp;<span class="ident" id="2021346">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2021354">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021386">j</span>&nbsp;<span class="op" id="2021388">:=</span>&nbsp;<span class="builtinfunc" id="2021391">len</span><span class="op" id="2021394">(</span><span class="ident" id="2021395">buf</span><span class="op" id="2021398">)</span>&nbsp;<span class="op" id="2021400">-</span>&nbsp;<span class="ident" id="2021402">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021410">buf</span><span class="op" id="2021413">[</span><span class="ident" id="2021414">j</span><span class="op" id="2021415">]</span>&nbsp;<span class="op" id="2021417">=</span>&nbsp;<span class="string" id="2021419">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021425">j</span><span class="op" id="2021426">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021431">buf</span><span class="op" id="2021434">[</span><span class="ident" id="2021435">j</span><span class="op" id="2021436">]</span>&nbsp;<span class="op" id="2021438">=</span>&nbsp;<span class="string" id="2021440">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021447">j</span><span class="op" id="2021448">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021453">utf8</span><span class="op" id="2021457">.</span><span class="ident" id="2021458">EncodeRune</span><span class="op" id="2021468">(</span><span class="ident" id="2021469">buf</span><span class="op" id="2021472">[</span><span class="ident" id="2021473">j</span><span class="op" id="2021474">:</span><span class="op" id="2021475">]</span><span class="op" id="2021476">,</span>&nbsp;<span class="builtintype" id="2021478">rune</span><span class="op" id="2021482">(</span><span class="ident" id="2021483">a</span><span class="op" id="2021484">)</span><span class="op" id="2021485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021489">j</span>&nbsp;<span class="op" id="2021491">+=</span>&nbsp;<span class="ident" id="2021494">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021506">buf</span><span class="op" id="2021509">[</span><span class="ident" id="2021510">j</span><span class="op" id="2021511">]</span>&nbsp;<span class="op" id="2021513">=</span>&nbsp;<span class="string" id="2021515">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2021521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021525">f</span><span class="op" id="2021526">.</span><span class="ident" id="2021527">pad</span><span class="op" id="2021530">(</span><span class="ident" id="2021531">buf</span><span class="op" id="2021534">[</span><span class="ident" id="2021535">i</span><span class="op" id="2021536">:</span><span class="op" id="2021537">]</span><span class="op" id="2021538">)</span><br>
<span class="lineno"></span><span class="op" id="2021540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2021543">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2021616">func</span>&nbsp;<span class="op" id="2021621">(</span><span class="ident" id="2021622">f</span>&nbsp;<span class="op" id="2021624">*</span><span class="ident" id="2021625">fmt</span><span class="op" id="2021628">)</span>&nbsp;<span class="ident" id="2021630">truncate</span><span class="op" id="2021638">(</span><span class="ident" id="2021639">s</span>&nbsp;<span class="builtintype" id="2021641">string</span><span class="op" id="2021647">)</span>&nbsp;<span class="builtintype" id="2021649">string</span>&nbsp;<span class="op" id="2021656">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2021659">if</span>&nbsp;<span class="ident" id="2021662">f</span><span class="op" id="2021663">.</span><span class="ident" id="2021664">precPresent</span>&nbsp;<span class="op" id="2021676">&amp;&amp;</span>&nbsp;<span class="ident" id="2021679">f</span><span class="op" id="2021680">.</span><span class="ident" id="2021681">prec</span>&nbsp;<span class="op" id="2021686">&lt;</span>&nbsp;<span class="ident" id="2021688">utf8</span><span class="op" id="2021692">.</span><span class="ident" id="2021693">RuneCountInString</span><span class="op" id="2021710">(</span><span class="ident" id="2021711">s</span><span class="op" id="2021712">)</span>&nbsp;<span class="op" id="2021714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021718">n</span>&nbsp;<span class="op" id="2021720">:=</span>&nbsp;<span class="ident" id="2021723">f</span><span class="op" id="2021724">.</span><span class="ident" id="2021725">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2021732">for</span>&nbsp;<span class="ident" id="2021736">i</span>&nbsp;<span class="op" id="2021738">:=</span>&nbsp;<span class="keyword" id="2021741">range</span>&nbsp;<span class="ident" id="2021747">s</span>&nbsp;<span class="op" id="2021749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2021754">if</span>&nbsp;<span class="ident" id="2021757">n</span>&nbsp;<span class="op" id="2021759">==</span>&nbsp;<span class="num" id="2021762">0</span>&nbsp;<span class="op" id="2021764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021770">s</span>&nbsp;<span class="op" id="2021772">=</span>&nbsp;<span class="ident" id="2021774">s</span><span class="op" id="2021775">[</span><span class="op" id="2021776">:</span><span class="ident" id="2021777">i</span><span class="op" id="2021778">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2021784">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2021793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021798">n</span><span class="op" id="2021799">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2021804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2021807">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2021810">return</span>&nbsp;<span class="ident" id="2021817">s</span><br>
<span class="lineno"></span><span class="op" id="2021819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2021822">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2021849">func</span>&nbsp;<span class="op" id="2021854">(</span><span class="ident" id="2021855">f</span>&nbsp;<span class="op" id="2021857">*</span><span class="ident" id="2021858">fmt</span><span class="op" id="2021861">)</span>&nbsp;<span class="ident" id="2021863">fmt_s</span><span class="op" id="2021868">(</span><span class="ident" id="2021869">s</span>&nbsp;<span class="builtintype" id="2021871">string</span><span class="op" id="2021877">)</span>&nbsp;<span class="op" id="2021879">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021882">s</span>&nbsp;<span class="op" id="2021884">=</span>&nbsp;<span class="ident" id="2021886">f</span><span class="op" id="2021887">.</span><span class="ident" id="2021888">truncate</span><span class="op" id="2021896">(</span><span class="ident" id="2021897">s</span><span class="op" id="2021898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021901">f</span><span class="op" id="2021902">.</span><span class="ident" id="2021903">padString</span><span class="op" id="2021912">(</span><span class="ident" id="2021913">s</span><span class="op" id="2021914">)</span><br>
<span class="lineno"></span><span class="op" id="2021916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2021919">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2022001">func</span>&nbsp;<span class="op" id="2022006">(</span><span class="ident" id="2022007">f</span>&nbsp;<span class="op" id="2022009">*</span><span class="ident" id="2022010">fmt</span><span class="op" id="2022013">)</span>&nbsp;<span class="ident" id="2022015">fmt_sbx</span><span class="op" id="2022022">(</span><span class="ident" id="2022023">s</span>&nbsp;<span class="builtintype" id="2022025">string</span><span class="op" id="2022031">,</span>&nbsp;<span class="ident" id="2022033">b</span>&nbsp;<span class="op" id="2022035">[</span><span class="op" id="2022036">]</span><span class="builtintype" id="2022037">byte</span><span class="op" id="2022041">,</span>&nbsp;<span class="ident" id="2022043">digits</span>&nbsp;<span class="builtintype" id="2022050">string</span><span class="op" id="2022056">)</span>&nbsp;<span class="op" id="2022058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022061">n</span>&nbsp;<span class="op" id="2022063">:=</span>&nbsp;<span class="builtinfunc" id="2022066">len</span><span class="op" id="2022069">(</span><span class="ident" id="2022070">b</span><span class="op" id="2022071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022074">if</span>&nbsp;<span class="ident" id="2022077">b</span>&nbsp;<span class="op" id="2022079">==</span>&nbsp;<span class="ident" id="2022082">nil</span>&nbsp;<span class="op" id="2022086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022090">n</span>&nbsp;<span class="op" id="2022092">=</span>&nbsp;<span class="builtinfunc" id="2022094">len</span><span class="op" id="2022097">(</span><span class="ident" id="2022098">s</span><span class="op" id="2022099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2022102">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022105">x</span>&nbsp;<span class="op" id="2022107">:=</span>&nbsp;<span class="ident" id="2022110">digits</span><span class="op" id="2022116">[</span><span class="num" id="2022117">10</span><span class="op" id="2022119">]</span>&nbsp;<span class="op" id="2022121">-</span>&nbsp;<span class="string" id="2022123">&#39;a&#39;</span>&nbsp;<span class="op" id="2022127">+</span>&nbsp;<span class="string" id="2022129">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2022134">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022173">var</span>&nbsp;<span class="ident" id="2022177">buf</span>&nbsp;<span class="op" id="2022181">[</span><span class="op" id="2022182">]</span><span class="builtintype" id="2022183">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022189">for</span>&nbsp;<span class="ident" id="2022193">i</span>&nbsp;<span class="op" id="2022195">:=</span>&nbsp;<span class="num" id="2022198">0</span><span class="op" id="2022199">;</span>&nbsp;<span class="ident" id="2022201">i</span>&nbsp;<span class="op" id="2022203">&lt;</span>&nbsp;<span class="ident" id="2022205">n</span><span class="op" id="2022206">;</span>&nbsp;<span class="ident" id="2022208">i</span><span class="op" id="2022209">++</span>&nbsp;<span class="op" id="2022212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022216">if</span>&nbsp;<span class="ident" id="2022219">i</span>&nbsp;<span class="op" id="2022221">&gt;</span>&nbsp;<span class="num" id="2022223">0</span>&nbsp;<span class="op" id="2022225">&amp;&amp;</span>&nbsp;<span class="ident" id="2022228">f</span><span class="op" id="2022229">.</span><span class="ident" id="2022230">space</span>&nbsp;<span class="op" id="2022236">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022241">buf</span>&nbsp;<span class="op" id="2022245">=</span>&nbsp;<span class="builtinfunc" id="2022247">append</span><span class="op" id="2022253">(</span><span class="ident" id="2022254">buf</span><span class="op" id="2022257">,</span>&nbsp;<span class="string" id="2022259">&#39;&nbsp;&#39;</span><span class="op" id="2022262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2022266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022270">if</span>&nbsp;<span class="ident" id="2022273">f</span><span class="op" id="2022274">.</span><span class="ident" id="2022275">sharp</span>&nbsp;<span class="op" id="2022281">&amp;&amp;</span>&nbsp;<span class="op" id="2022284">(</span><span class="ident" id="2022285">f</span><span class="op" id="2022286">.</span><span class="ident" id="2022287">space</span>&nbsp;<span class="op" id="2022293">||</span>&nbsp;<span class="ident" id="2022296">i</span>&nbsp;<span class="op" id="2022298">==</span>&nbsp;<span class="num" id="2022301">0</span><span class="op" id="2022302">)</span>&nbsp;<span class="op" id="2022304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022309">buf</span>&nbsp;<span class="op" id="2022313">=</span>&nbsp;<span class="builtinfunc" id="2022315">append</span><span class="op" id="2022321">(</span><span class="ident" id="2022322">buf</span><span class="op" id="2022325">,</span>&nbsp;<span class="string" id="2022327">&#39;0&#39;</span><span class="op" id="2022330">,</span>&nbsp;<span class="ident" id="2022332">x</span><span class="op" id="2022333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2022337">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022341">var</span>&nbsp;<span class="ident" id="2022345">c</span>&nbsp;<span class="builtintype" id="2022347">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022354">if</span>&nbsp;<span class="ident" id="2022357">b</span>&nbsp;<span class="op" id="2022359">==</span>&nbsp;<span class="ident" id="2022362">nil</span>&nbsp;<span class="op" id="2022366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022371">c</span>&nbsp;<span class="op" id="2022373">=</span>&nbsp;<span class="ident" id="2022375">s</span><span class="op" id="2022376">[</span><span class="ident" id="2022377">i</span><span class="op" id="2022378">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2022382">}</span>&nbsp;<span class="keyword" id="2022384">else</span>&nbsp;<span class="op" id="2022389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022394">c</span>&nbsp;<span class="op" id="2022396">=</span>&nbsp;<span class="ident" id="2022398">b</span><span class="op" id="2022399">[</span><span class="ident" id="2022400">i</span><span class="op" id="2022401">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2022405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022409">buf</span>&nbsp;<span class="op" id="2022413">=</span>&nbsp;<span class="builtinfunc" id="2022415">append</span><span class="op" id="2022421">(</span><span class="ident" id="2022422">buf</span><span class="op" id="2022425">,</span>&nbsp;<span class="ident" id="2022427">digits</span><span class="op" id="2022433">[</span><span class="ident" id="2022434">c</span><span class="op" id="2022435">&gt;&gt;</span><span class="num" id="2022437">4</span><span class="op" id="2022438">]</span><span class="op" id="2022439">,</span>&nbsp;<span class="ident" id="2022441">digits</span><span class="op" id="2022447">[</span><span class="ident" id="2022448">c</span><span class="op" id="2022449">&amp;</span><span class="num" id="2022450">0xF</span><span class="op" id="2022453">]</span><span class="op" id="2022454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2022457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022460">f</span><span class="op" id="2022461">.</span><span class="ident" id="2022462">pad</span><span class="op" id="2022465">(</span><span class="ident" id="2022466">buf</span><span class="op" id="2022469">)</span><br>
<span class="lineno"></span><span class="op" id="2022471">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2022474">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2022541">func</span>&nbsp;<span class="op" id="2022546">(</span><span class="ident" id="2022547">f</span>&nbsp;<span class="op" id="2022549">*</span><span class="ident" id="2022550">fmt</span><span class="op" id="2022553">)</span>&nbsp;<span class="ident" id="2022555">fmt_sx</span><span class="op" id="2022561">(</span><span class="ident" id="2022562">s</span><span class="op" id="2022563">,</span>&nbsp;<span class="ident" id="2022565">digits</span>&nbsp;<span class="builtintype" id="2022572">string</span><span class="op" id="2022578">)</span>&nbsp;<span class="op" id="2022580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022583">if</span>&nbsp;<span class="ident" id="2022586">f</span><span class="op" id="2022587">.</span><span class="ident" id="2022588">precPresent</span>&nbsp;<span class="op" id="2022600">&amp;&amp;</span>&nbsp;<span class="ident" id="2022603">f</span><span class="op" id="2022604">.</span><span class="ident" id="2022605">prec</span>&nbsp;<span class="op" id="2022610">&lt;</span>&nbsp;<span class="builtinfunc" id="2022612">len</span><span class="op" id="2022615">(</span><span class="ident" id="2022616">s</span><span class="op" id="2022617">)</span>&nbsp;<span class="op" id="2022619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022623">s</span>&nbsp;<span class="op" id="2022625">=</span>&nbsp;<span class="ident" id="2022627">s</span><span class="op" id="2022628">[</span><span class="op" id="2022629">:</span><span class="ident" id="2022630">f</span><span class="op" id="2022631">.</span><span class="ident" id="2022632">prec</span><span class="op" id="2022636">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2022639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022642">f</span><span class="op" id="2022643">.</span><span class="ident" id="2022644">fmt_sbx</span><span class="op" id="2022651">(</span><span class="ident" id="2022652">s</span><span class="op" id="2022653">,</span>&nbsp;<span class="ident" id="2022655">nil</span><span class="op" id="2022658">,</span>&nbsp;<span class="ident" id="2022660">digits</span><span class="op" id="2022666">)</span><br>
<span class="lineno"></span><span class="op" id="2022668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2022671">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2022742">func</span>&nbsp;<span class="op" id="2022747">(</span><span class="ident" id="2022748">f</span>&nbsp;<span class="op" id="2022750">*</span><span class="ident" id="2022751">fmt</span><span class="op" id="2022754">)</span>&nbsp;<span class="ident" id="2022756">fmt_bx</span><span class="op" id="2022762">(</span><span class="ident" id="2022763">b</span>&nbsp;<span class="op" id="2022765">[</span><span class="op" id="2022766">]</span><span class="builtintype" id="2022767">byte</span><span class="op" id="2022771">,</span>&nbsp;<span class="ident" id="2022773">digits</span>&nbsp;<span class="builtintype" id="2022780">string</span><span class="op" id="2022786">)</span>&nbsp;<span class="op" id="2022788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2022791">if</span>&nbsp;<span class="ident" id="2022794">f</span><span class="op" id="2022795">.</span><span class="ident" id="2022796">precPresent</span>&nbsp;<span class="op" id="2022808">&amp;&amp;</span>&nbsp;<span class="ident" id="2022811">f</span><span class="op" id="2022812">.</span><span class="ident" id="2022813">prec</span>&nbsp;<span class="op" id="2022818">&lt;</span>&nbsp;<span class="builtinfunc" id="2022820">len</span><span class="op" id="2022823">(</span><span class="ident" id="2022824">b</span><span class="op" id="2022825">)</span>&nbsp;<span class="op" id="2022827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022831">b</span>&nbsp;<span class="op" id="2022833">=</span>&nbsp;<span class="ident" id="2022835">b</span><span class="op" id="2022836">[</span><span class="op" id="2022837">:</span><span class="ident" id="2022838">f</span><span class="op" id="2022839">.</span><span class="ident" id="2022840">prec</span><span class="op" id="2022844">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2022847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022850">f</span><span class="op" id="2022851">.</span><span class="ident" id="2022852">fmt_sbx</span><span class="op" id="2022859">(</span><span class="string" id="2022860">&#34;&#34;</span><span class="op" id="2022862">,</span>&nbsp;<span class="ident" id="2022864">b</span><span class="op" id="2022865">,</span>&nbsp;<span class="ident" id="2022867">digits</span><span class="op" id="2022873">)</span><br>
<span class="lineno">355</span><span class="op" id="2022875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2022878">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2022952">func</span>&nbsp;<span class="op" id="2022957">(</span><span class="ident" id="2022958">f</span>&nbsp;<span class="op" id="2022960">*</span><span class="ident" id="2022961">fmt</span><span class="op" id="2022964">)</span>&nbsp;<span class="ident" id="2022966">fmt_q</span><span class="op" id="2022971">(</span><span class="ident" id="2022972">s</span>&nbsp;<span class="builtintype" id="2022974">string</span><span class="op" id="2022980">)</span>&nbsp;<span class="op" id="2022982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2022985">s</span>&nbsp;<span class="op" id="2022987">=</span>&nbsp;<span class="ident" id="2022989">f</span><span class="op" id="2022990">.</span><span class="ident" id="2022991">truncate</span><span class="op" id="2022999">(</span><span class="ident" id="2023000">s</span><span class="op" id="2023001">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023004">var</span>&nbsp;<span class="ident" id="2023008">quoted</span>&nbsp;<span class="builtintype" id="2023015">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023023">if</span>&nbsp;<span class="ident" id="2023026">f</span><span class="op" id="2023027">.</span><span class="ident" id="2023028">sharp</span>&nbsp;<span class="op" id="2023034">&amp;&amp;</span>&nbsp;<span class="ident" id="2023037">strconv</span><span class="op" id="2023044">.</span><span class="ident" id="2023045">CanBackquote</span><span class="op" id="2023057">(</span><span class="ident" id="2023058">s</span><span class="op" id="2023059">)</span>&nbsp;<span class="op" id="2023061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2023065">quoted</span>&nbsp;<span class="op" id="2023072">=</span>&nbsp;<span class="string" id="2023074">&#34;`&#34;</span>&nbsp;<span class="op" id="2023078">+</span>&nbsp;<span class="ident" id="2023080">s</span>&nbsp;<span class="op" id="2023082">+</span>&nbsp;<span class="string" id="2023084">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2023089">}</span>&nbsp;<span class="keyword" id="2023091">else</span>&nbsp;<span class="op" id="2023096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023100">if</span>&nbsp;<span class="ident" id="2023103">f</span><span class="op" id="2023104">.</span><span class="ident" id="2023105">plus</span>&nbsp;<span class="op" id="2023110">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2023115">quoted</span>&nbsp;<span class="op" id="2023122">=</span>&nbsp;<span class="ident" id="2023124">strconv</span><span class="op" id="2023131">.</span><span class="ident" id="2023132">QuoteToASCII</span><span class="op" id="2023144">(</span><span class="ident" id="2023145">s</span><span class="op" id="2023146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2023150">}</span>&nbsp;<span class="keyword" id="2023152">else</span>&nbsp;<span class="op" id="2023157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2023162">quoted</span>&nbsp;<span class="op" id="2023169">=</span>&nbsp;<span class="ident" id="2023171">strconv</span><span class="op" id="2023178">.</span><span class="ident" id="2023179">Quote</span><span class="op" id="2023184">(</span><span class="ident" id="2023185">s</span><span class="op" id="2023186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2023190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2023193">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2023196">f</span><span class="op" id="2023197">.</span><span class="ident" id="2023198">padString</span><span class="op" id="2023207">(</span><span class="ident" id="2023208">quoted</span><span class="op" id="2023214">)</span><br>
<span class="lineno"></span><span class="op" id="2023216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2023219">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2023300">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2023366">func</span>&nbsp;<span class="op" id="2023371">(</span><span class="ident" id="2023372">f</span>&nbsp;<span class="op" id="2023374">*</span><span class="ident" id="2023375">fmt</span><span class="op" id="2023378">)</span>&nbsp;<span class="ident" id="2023380">fmt_qc</span><span class="op" id="2023386">(</span><span class="ident" id="2023387">c</span>&nbsp;<span class="ident" id="2023389">int64</span><span class="op" id="2023394">)</span>&nbsp;<span class="op" id="2023396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023399">var</span>&nbsp;<span class="ident" id="2023403">quoted</span>&nbsp;<span class="op" id="2023410">[</span><span class="op" id="2023411">]</span><span class="builtintype" id="2023412">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023418">if</span>&nbsp;<span class="ident" id="2023421">f</span><span class="op" id="2023422">.</span><span class="ident" id="2023423">plus</span>&nbsp;<span class="op" id="2023428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2023432">quoted</span>&nbsp;<span class="op" id="2023439">=</span>&nbsp;<span class="ident" id="2023441">strconv</span><span class="op" id="2023448">.</span><span class="ident" id="2023449">AppendQuoteRuneToASCII</span><span class="op" id="2023471">(</span><span class="ident" id="2023472">f</span><span class="op" id="2023473">.</span><span class="ident" id="2023474">intbuf</span><span class="op" id="2023480">[</span><span class="num" id="2023481">0</span><span class="op" id="2023482">:</span><span class="num" id="2023483">0</span><span class="op" id="2023484">]</span><span class="op" id="2023485">,</span>&nbsp;<span class="builtintype" id="2023487">rune</span><span class="op" id="2023491">(</span><span class="ident" id="2023492">c</span><span class="op" id="2023493">)</span><span class="op" id="2023494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2023497">}</span>&nbsp;<span class="keyword" id="2023499">else</span>&nbsp;<span class="op" id="2023504">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2023508">quoted</span>&nbsp;<span class="op" id="2023515">=</span>&nbsp;<span class="ident" id="2023517">strconv</span><span class="op" id="2023524">.</span><span class="ident" id="2023525">AppendQuoteRune</span><span class="op" id="2023540">(</span><span class="ident" id="2023541">f</span><span class="op" id="2023542">.</span><span class="ident" id="2023543">intbuf</span><span class="op" id="2023549">[</span><span class="num" id="2023550">0</span><span class="op" id="2023551">:</span><span class="num" id="2023552">0</span><span class="op" id="2023553">]</span><span class="op" id="2023554">,</span>&nbsp;<span class="builtintype" id="2023556">rune</span><span class="op" id="2023560">(</span><span class="ident" id="2023561">c</span><span class="op" id="2023562">)</span><span class="op" id="2023563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2023566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2023569">f</span><span class="op" id="2023570">.</span><span class="ident" id="2023571">pad</span><span class="op" id="2023574">(</span><span class="ident" id="2023575">quoted</span><span class="op" id="2023581">)</span><br>
<span class="lineno"></span><span class="op" id="2023583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2023586">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2023605">func</span>&nbsp;<span class="ident" id="2023610">doPrec</span><span class="op" id="2023616">(</span><span class="ident" id="2023617">f</span>&nbsp;<span class="op" id="2023619">*</span><span class="ident" id="2023620">fmt</span><span class="op" id="2023623">,</span>&nbsp;<span class="ident" id="2023625">def</span>&nbsp;<span class="builtintype" id="2023629">int</span><span class="op" id="2023632">)</span>&nbsp;<span class="builtintype" id="2023634">int</span>&nbsp;<span class="op" id="2023638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023641">if</span>&nbsp;<span class="ident" id="2023644">f</span><span class="op" id="2023645">.</span><span class="ident" id="2023646">precPresent</span>&nbsp;<span class="op" id="2023658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023662">return</span>&nbsp;<span class="ident" id="2023669">f</span><span class="op" id="2023670">.</span><span class="ident" id="2023671">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2023677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023680">return</span>&nbsp;<span class="ident" id="2023687">def</span><br>
<span class="lineno"></span><span class="op" id="2023691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2023694">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2023795">func</span>&nbsp;<span class="op" id="2023800">(</span><span class="ident" id="2023801">f</span>&nbsp;<span class="op" id="2023803">*</span><span class="ident" id="2023804">fmt</span><span class="op" id="2023807">)</span>&nbsp;<span class="ident" id="2023809">formatFloat</span><span class="op" id="2023820">(</span><span class="ident" id="2023821">v</span>&nbsp;<span class="builtintype" id="2023823">float64</span><span class="op" id="2023830">,</span>&nbsp;<span class="ident" id="2023832">verb</span>&nbsp;<span class="builtintype" id="2023837">byte</span><span class="op" id="2023841">,</span>&nbsp;<span class="ident" id="2023843">prec</span><span class="op" id="2023847">,</span>&nbsp;<span class="ident" id="2023849">n</span>&nbsp;<span class="builtintype" id="2023851">int</span><span class="op" id="2023854">)</span>&nbsp;<span class="op" id="2023856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2023859">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2023924">num</span>&nbsp;<span class="op" id="2023928">:=</span>&nbsp;<span class="ident" id="2023931">strconv</span><span class="op" id="2023938">.</span><span class="ident" id="2023939">AppendFloat</span><span class="op" id="2023950">(</span><span class="ident" id="2023951">f</span><span class="op" id="2023952">.</span><span class="ident" id="2023953">intbuf</span><span class="op" id="2023959">[</span><span class="num" id="2023960">0</span><span class="op" id="2023961">:</span><span class="num" id="2023962">1</span><span class="op" id="2023963">]</span><span class="op" id="2023964">,</span>&nbsp;<span class="ident" id="2023966">v</span><span class="op" id="2023967">,</span>&nbsp;<span class="ident" id="2023969">verb</span><span class="op" id="2023973">,</span>&nbsp;<span class="ident" id="2023975">prec</span><span class="op" id="2023979">,</span>&nbsp;<span class="ident" id="2023981">n</span><span class="op" id="2023982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2023985">if</span>&nbsp;<span class="ident" id="2023988">num</span><span class="op" id="2023991">[</span><span class="num" id="2023992">1</span><span class="op" id="2023993">]</span>&nbsp;<span class="op" id="2023995">==</span>&nbsp;<span class="string" id="2023998">&#39;-&#39;</span>&nbsp;<span class="op" id="2024002">||</span>&nbsp;<span class="ident" id="2024005">num</span><span class="op" id="2024008">[</span><span class="num" id="2024009">1</span><span class="op" id="2024010">]</span>&nbsp;<span class="op" id="2024012">==</span>&nbsp;<span class="string" id="2024015">&#39;+&#39;</span>&nbsp;<span class="op" id="2024019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024023">num</span>&nbsp;<span class="op" id="2024027">=</span>&nbsp;<span class="ident" id="2024029">num</span><span class="op" id="2024032">[</span><span class="num" id="2024033">1</span><span class="op" id="2024034">:</span><span class="op" id="2024035">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2024038">}</span>&nbsp;<span class="keyword" id="2024040">else</span>&nbsp;<span class="op" id="2024045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024049">num</span><span class="op" id="2024052">[</span><span class="num" id="2024053">0</span><span class="op" id="2024054">]</span>&nbsp;<span class="op" id="2024056">=</span>&nbsp;<span class="string" id="2024058">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2024063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2024066">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2024169">if</span>&nbsp;<span class="ident" id="2024172">math</span><span class="op" id="2024176">.</span><span class="ident" id="2024177">IsInf</span><span class="op" id="2024182">(</span><span class="ident" id="2024183">v</span><span class="op" id="2024184">,</span>&nbsp;<span class="num" id="2024186">0</span><span class="op" id="2024187">)</span>&nbsp;<span class="op" id="2024189">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2024193">if</span>&nbsp;<span class="ident" id="2024196">f</span><span class="op" id="2024197">.</span><span class="ident" id="2024198">zero</span>&nbsp;<span class="op" id="2024203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2024208">defer</span>&nbsp;<span class="keyword" id="2024214">func</span><span class="op" id="2024218">(</span><span class="op" id="2024219">)</span>&nbsp;<span class="op" id="2024221">{</span>&nbsp;<span class="ident" id="2024223">f</span><span class="op" id="2024224">.</span><span class="ident" id="2024225">zero</span>&nbsp;<span class="op" id="2024230">=</span>&nbsp;<span class="builtintype" id="2024232">true</span>&nbsp;<span class="op" id="2024237">}</span><span class="op" id="2024238">(</span><span class="op" id="2024239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024244">f</span><span class="op" id="2024245">.</span><span class="ident" id="2024246">zero</span>&nbsp;<span class="op" id="2024251">=</span>&nbsp;<span class="builtintype" id="2024253">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2024261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2024264">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2024267">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2024314">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2024381">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2024460">if</span>&nbsp;<span class="ident" id="2024463">f</span><span class="op" id="2024464">.</span><span class="ident" id="2024465">zero</span>&nbsp;<span class="op" id="2024470">&amp;&amp;</span>&nbsp;<span class="ident" id="2024473">f</span><span class="op" id="2024474">.</span><span class="ident" id="2024475">widPresent</span>&nbsp;<span class="op" id="2024486">&amp;&amp;</span>&nbsp;<span class="ident" id="2024489">f</span><span class="op" id="2024490">.</span><span class="ident" id="2024491">wid</span>&nbsp;<span class="op" id="2024495">&gt;</span>&nbsp;<span class="builtinfunc" id="2024497">len</span><span class="op" id="2024500">(</span><span class="ident" id="2024501">num</span><span class="op" id="2024504">)</span>&nbsp;<span class="op" id="2024506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2024510">if</span>&nbsp;<span class="ident" id="2024513">f</span><span class="op" id="2024514">.</span><span class="ident" id="2024515">space</span>&nbsp;<span class="op" id="2024521">&amp;&amp;</span>&nbsp;<span class="ident" id="2024524">v</span>&nbsp;<span class="op" id="2024526">&gt;=</span>&nbsp;<span class="num" id="2024529">0</span>&nbsp;<span class="op" id="2024531">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024536">f</span><span class="op" id="2024537">.</span><span class="ident" id="2024538">buf</span><span class="op" id="2024541">.</span><span class="ident" id="2024542">WriteByte</span><span class="op" id="2024551">(</span><span class="string" id="2024552">&#39;&nbsp;&#39;</span><span class="op" id="2024555">)</span>&nbsp;<span class="comment" id="2024557">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024621">f</span><span class="op" id="2024622">.</span><span class="ident" id="2024623">wid</span><span class="op" id="2024626">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2024631">}</span>&nbsp;<span class="keyword" id="2024633">else</span>&nbsp;<span class="keyword" id="2024638">if</span>&nbsp;<span class="ident" id="2024641">f</span><span class="op" id="2024642">.</span><span class="ident" id="2024643">plus</span>&nbsp;<span class="op" id="2024648">||</span>&nbsp;<span class="ident" id="2024651">v</span>&nbsp;<span class="op" id="2024653">&lt;</span>&nbsp;<span class="num" id="2024655">0</span>&nbsp;<span class="op" id="2024657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024662">f</span><span class="op" id="2024663">.</span><span class="ident" id="2024664">buf</span><span class="op" id="2024667">.</span><span class="ident" id="2024668">WriteByte</span><span class="op" id="2024677">(</span><span class="ident" id="2024678">num</span><span class="op" id="2024681">[</span><span class="num" id="2024682">0</span><span class="op" id="2024683">]</span><span class="op" id="2024684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024689">f</span><span class="op" id="2024690">.</span><span class="ident" id="2024691">wid</span><span class="op" id="2024694">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2024699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024703">f</span><span class="op" id="2024704">.</span><span class="ident" id="2024705">pad</span><span class="op" id="2024708">(</span><span class="ident" id="2024709">num</span><span class="op" id="2024712">[</span><span class="num" id="2024713">1</span><span class="op" id="2024714">:</span><span class="op" id="2024715">]</span><span class="op" id="2024716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2024720">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2024728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2024731">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2024785">if</span>&nbsp;<span class="ident" id="2024788">f</span><span class="op" id="2024789">.</span><span class="ident" id="2024790">space</span>&nbsp;<span class="op" id="2024796">&amp;&amp;</span>&nbsp;<span class="ident" id="2024799">num</span><span class="op" id="2024802">[</span><span class="num" id="2024803">0</span><span class="op" id="2024804">]</span>&nbsp;<span class="op" id="2024806">==</span>&nbsp;<span class="string" id="2024809">&#39;+&#39;</span>&nbsp;<span class="op" id="2024813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024817">num</span><span class="op" id="2024820">[</span><span class="num" id="2024821">0</span><span class="op" id="2024822">]</span>&nbsp;<span class="op" id="2024824">=</span>&nbsp;<span class="string" id="2024826">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2024832">f</span><span class="op" id="2024833">.</span><span class="ident" id="2024834">pad</span><span class="op" id="2024837">(</span><span class="ident" id="2024838">num</span><span class="op" id="2024841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2024845">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2024853">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2024856">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2024936">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2025024">if</span>&nbsp;<span class="ident" id="2025027">f</span><span class="op" id="2025028">.</span><span class="ident" id="2025029">plus</span>&nbsp;<span class="op" id="2025034">||</span>&nbsp;<span class="ident" id="2025037">num</span><span class="op" id="2025040">[</span><span class="num" id="2025041">0</span><span class="op" id="2025042">]</span>&nbsp;<span class="op" id="2025044">==</span>&nbsp;<span class="string" id="2025047">&#39;-&#39;</span>&nbsp;<span class="op" id="2025051">||</span>&nbsp;<span class="ident" id="2025054">math</span><span class="op" id="2025058">.</span><span class="ident" id="2025059">IsInf</span><span class="op" id="2025064">(</span><span class="ident" id="2025065">v</span><span class="op" id="2025066">,</span>&nbsp;<span class="num" id="2025068">0</span><span class="op" id="2025069">)</span>&nbsp;<span class="op" id="2025071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2025075">f</span><span class="op" id="2025076">.</span><span class="ident" id="2025077">pad</span><span class="op" id="2025080">(</span><span class="ident" id="2025081">num</span><span class="op" id="2025084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2025088">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2025096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2025099">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2025179">f</span><span class="op" id="2025180">.</span><span class="ident" id="2025181">pad</span><span class="op" id="2025184">(</span><span class="ident" id="2025185">num</span><span class="op" id="2025188">[</span><span class="num" id="2025189">1</span><span class="op" id="2025190">:</span><span class="op" id="2025191">]</span><span class="op" id="2025192">)</span><br>
<span class="lineno"></span><span class="op" id="2025194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2025197">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2025249">func</span>&nbsp;<span class="op" id="2025254">(</span><span class="ident" id="2025255">f</span>&nbsp;<span class="op" id="2025257">*</span><span class="ident" id="2025258">fmt</span><span class="op" id="2025261">)</span>&nbsp;<span class="ident" id="2025263">fmt_e64</span><span class="op" id="2025270">(</span><span class="ident" id="2025271">v</span>&nbsp;<span class="builtintype" id="2025273">float64</span><span class="op" id="2025280">)</span>&nbsp;<span class="op" id="2025282">{</span>&nbsp;<span class="ident" id="2025284">f</span><span class="op" id="2025285">.</span><span class="ident" id="2025286">formatFloat</span><span class="op" id="2025297">(</span><span class="ident" id="2025298">v</span><span class="op" id="2025299">,</span>&nbsp;<span class="string" id="2025301">&#39;e&#39;</span><span class="op" id="2025304">,</span>&nbsp;<span class="ident" id="2025306">doPrec</span><span class="op" id="2025312">(</span><span class="ident" id="2025313">f</span><span class="op" id="2025314">,</span>&nbsp;<span class="num" id="2025316">6</span><span class="op" id="2025317">)</span><span class="op" id="2025318">,</span>&nbsp;<span class="num" id="2025320">64</span><span class="op" id="2025322">)</span>&nbsp;<span class="op" id="2025324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025327">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2025379">func</span>&nbsp;<span class="op" id="2025384">(</span><span class="ident" id="2025385">f</span>&nbsp;<span class="op" id="2025387">*</span><span class="ident" id="2025388">fmt</span><span class="op" id="2025391">)</span>&nbsp;<span class="ident" id="2025393">fmt_E64</span><span class="op" id="2025400">(</span><span class="ident" id="2025401">v</span>&nbsp;<span class="builtintype" id="2025403">float64</span><span class="op" id="2025410">)</span>&nbsp;<span class="op" id="2025412">{</span>&nbsp;<span class="ident" id="2025414">f</span><span class="op" id="2025415">.</span><span class="ident" id="2025416">formatFloat</span><span class="op" id="2025427">(</span><span class="ident" id="2025428">v</span><span class="op" id="2025429">,</span>&nbsp;<span class="string" id="2025431">&#39;E&#39;</span><span class="op" id="2025434">,</span>&nbsp;<span class="ident" id="2025436">doPrec</span><span class="op" id="2025442">(</span><span class="ident" id="2025443">f</span><span class="op" id="2025444">,</span>&nbsp;<span class="num" id="2025446">6</span><span class="op" id="2025447">)</span><span class="op" id="2025448">,</span>&nbsp;<span class="num" id="2025450">64</span><span class="op" id="2025452">)</span>&nbsp;<span class="op" id="2025454">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2025457">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2025505">func</span>&nbsp;<span class="op" id="2025510">(</span><span class="ident" id="2025511">f</span>&nbsp;<span class="op" id="2025513">*</span><span class="ident" id="2025514">fmt</span><span class="op" id="2025517">)</span>&nbsp;<span class="ident" id="2025519">fmt_f64</span><span class="op" id="2025526">(</span><span class="ident" id="2025527">v</span>&nbsp;<span class="builtintype" id="2025529">float64</span><span class="op" id="2025536">)</span>&nbsp;<span class="op" id="2025538">{</span>&nbsp;<span class="ident" id="2025540">f</span><span class="op" id="2025541">.</span><span class="ident" id="2025542">formatFloat</span><span class="op" id="2025553">(</span><span class="ident" id="2025554">v</span><span class="op" id="2025555">,</span>&nbsp;<span class="string" id="2025557">&#39;f&#39;</span><span class="op" id="2025560">,</span>&nbsp;<span class="ident" id="2025562">doPrec</span><span class="op" id="2025568">(</span><span class="ident" id="2025569">f</span><span class="op" id="2025570">,</span>&nbsp;<span class="num" id="2025572">6</span><span class="op" id="2025573">)</span><span class="op" id="2025574">,</span>&nbsp;<span class="num" id="2025576">64</span><span class="op" id="2025578">)</span>&nbsp;<span class="op" id="2025580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025583">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2025654">func</span>&nbsp;<span class="op" id="2025659">(</span><span class="ident" id="2025660">f</span>&nbsp;<span class="op" id="2025662">*</span><span class="ident" id="2025663">fmt</span><span class="op" id="2025666">)</span>&nbsp;<span class="ident" id="2025668">fmt_g64</span><span class="op" id="2025675">(</span><span class="ident" id="2025676">v</span>&nbsp;<span class="builtintype" id="2025678">float64</span><span class="op" id="2025685">)</span>&nbsp;<span class="op" id="2025687">{</span>&nbsp;<span class="ident" id="2025689">f</span><span class="op" id="2025690">.</span><span class="ident" id="2025691">formatFloat</span><span class="op" id="2025702">(</span><span class="ident" id="2025703">v</span><span class="op" id="2025704">,</span>&nbsp;<span class="string" id="2025706">&#39;g&#39;</span><span class="op" id="2025709">,</span>&nbsp;<span class="ident" id="2025711">doPrec</span><span class="op" id="2025717">(</span><span class="ident" id="2025718">f</span><span class="op" id="2025719">,</span>&nbsp;<span class="op" id="2025721">-</span><span class="num" id="2025722">1</span><span class="op" id="2025723">)</span><span class="op" id="2025724">,</span>&nbsp;<span class="num" id="2025726">64</span><span class="op" id="2025728">)</span>&nbsp;<span class="op" id="2025730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025733">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2025804">func</span>&nbsp;<span class="op" id="2025809">(</span><span class="ident" id="2025810">f</span>&nbsp;<span class="op" id="2025812">*</span><span class="ident" id="2025813">fmt</span><span class="op" id="2025816">)</span>&nbsp;<span class="ident" id="2025818">fmt_G64</span><span class="op" id="2025825">(</span><span class="ident" id="2025826">v</span>&nbsp;<span class="builtintype" id="2025828">float64</span><span class="op" id="2025835">)</span>&nbsp;<span class="op" id="2025837">{</span>&nbsp;<span class="ident" id="2025839">f</span><span class="op" id="2025840">.</span><span class="ident" id="2025841">formatFloat</span><span class="op" id="2025852">(</span><span class="ident" id="2025853">v</span><span class="op" id="2025854">,</span>&nbsp;<span class="string" id="2025856">&#39;G&#39;</span><span class="op" id="2025859">,</span>&nbsp;<span class="ident" id="2025861">doPrec</span><span class="op" id="2025867">(</span><span class="ident" id="2025868">f</span><span class="op" id="2025869">,</span>&nbsp;<span class="op" id="2025871">-</span><span class="num" id="2025872">1</span><span class="op" id="2025873">)</span><span class="op" id="2025874">,</span>&nbsp;<span class="num" id="2025876">64</span><span class="op" id="2025878">)</span>&nbsp;<span class="op" id="2025880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2025883">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2025958">func</span>&nbsp;<span class="op" id="2025963">(</span><span class="ident" id="2025964">f</span>&nbsp;<span class="op" id="2025966">*</span><span class="ident" id="2025967">fmt</span><span class="op" id="2025970">)</span>&nbsp;<span class="ident" id="2025972">fmt_fb64</span><span class="op" id="2025980">(</span><span class="ident" id="2025981">v</span>&nbsp;<span class="builtintype" id="2025983">float64</span><span class="op" id="2025990">)</span>&nbsp;<span class="op" id="2025992">{</span>&nbsp;<span class="ident" id="2025994">f</span><span class="op" id="2025995">.</span><span class="ident" id="2025996">formatFloat</span><span class="op" id="2026007">(</span><span class="ident" id="2026008">v</span><span class="op" id="2026009">,</span>&nbsp;<span class="string" id="2026011">&#39;b&#39;</span><span class="op" id="2026014">,</span>&nbsp;<span class="num" id="2026016">0</span><span class="op" id="2026017">,</span>&nbsp;<span class="num" id="2026019">64</span><span class="op" id="2026021">)</span>&nbsp;<span class="op" id="2026023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2026026">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2026037">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2026073">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2026129">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2026181">func</span>&nbsp;<span class="op" id="2026186">(</span><span class="ident" id="2026187">f</span>&nbsp;<span class="op" id="2026189">*</span><span class="ident" id="2026190">fmt</span><span class="op" id="2026193">)</span>&nbsp;<span class="ident" id="2026195">fmt_e32</span><span class="op" id="2026202">(</span><span class="ident" id="2026203">v</span>&nbsp;<span class="builtintype" id="2026205">float32</span><span class="op" id="2026212">)</span>&nbsp;<span class="op" id="2026214">{</span>&nbsp;<span class="ident" id="2026216">f</span><span class="op" id="2026217">.</span><span class="ident" id="2026218">formatFloat</span><span class="op" id="2026229">(</span><span class="builtintype" id="2026230">float64</span><span class="op" id="2026237">(</span><span class="ident" id="2026238">v</span><span class="op" id="2026239">)</span><span class="op" id="2026240">,</span>&nbsp;<span class="string" id="2026242">&#39;e&#39;</span><span class="op" id="2026245">,</span>&nbsp;<span class="ident" id="2026247">doPrec</span><span class="op" id="2026253">(</span><span class="ident" id="2026254">f</span><span class="op" id="2026255">,</span>&nbsp;<span class="num" id="2026257">6</span><span class="op" id="2026258">)</span><span class="op" id="2026259">,</span>&nbsp;<span class="num" id="2026261">32</span><span class="op" id="2026263">)</span>&nbsp;<span class="op" id="2026265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2026268">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2026320">func</span>&nbsp;<span class="op" id="2026325">(</span><span class="ident" id="2026326">f</span>&nbsp;<span class="op" id="2026328">*</span><span class="ident" id="2026329">fmt</span><span class="op" id="2026332">)</span>&nbsp;<span class="ident" id="2026334">fmt_E32</span><span class="op" id="2026341">(</span><span class="ident" id="2026342">v</span>&nbsp;<span class="builtintype" id="2026344">float32</span><span class="op" id="2026351">)</span>&nbsp;<span class="op" id="2026353">{</span>&nbsp;<span class="ident" id="2026355">f</span><span class="op" id="2026356">.</span><span class="ident" id="2026357">formatFloat</span><span class="op" id="2026368">(</span><span class="builtintype" id="2026369">float64</span><span class="op" id="2026376">(</span><span class="ident" id="2026377">v</span><span class="op" id="2026378">)</span><span class="op" id="2026379">,</span>&nbsp;<span class="string" id="2026381">&#39;E&#39;</span><span class="op" id="2026384">,</span>&nbsp;<span class="ident" id="2026386">doPrec</span><span class="op" id="2026392">(</span><span class="ident" id="2026393">f</span><span class="op" id="2026394">,</span>&nbsp;<span class="num" id="2026396">6</span><span class="op" id="2026397">)</span><span class="op" id="2026398">,</span>&nbsp;<span class="num" id="2026400">32</span><span class="op" id="2026402">)</span>&nbsp;<span class="op" id="2026404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2026407">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2026455">func</span>&nbsp;<span class="op" id="2026460">(</span><span class="ident" id="2026461">f</span>&nbsp;<span class="op" id="2026463">*</span><span class="ident" id="2026464">fmt</span><span class="op" id="2026467">)</span>&nbsp;<span class="ident" id="2026469">fmt_f32</span><span class="op" id="2026476">(</span><span class="ident" id="2026477">v</span>&nbsp;<span class="builtintype" id="2026479">float32</span><span class="op" id="2026486">)</span>&nbsp;<span class="op" id="2026488">{</span>&nbsp;<span class="ident" id="2026490">f</span><span class="op" id="2026491">.</span><span class="ident" id="2026492">formatFloat</span><span class="op" id="2026503">(</span><span class="builtintype" id="2026504">float64</span><span class="op" id="2026511">(</span><span class="ident" id="2026512">v</span><span class="op" id="2026513">)</span><span class="op" id="2026514">,</span>&nbsp;<span class="string" id="2026516">&#39;f&#39;</span><span class="op" id="2026519">,</span>&nbsp;<span class="ident" id="2026521">doPrec</span><span class="op" id="2026527">(</span><span class="ident" id="2026528">f</span><span class="op" id="2026529">,</span>&nbsp;<span class="num" id="2026531">6</span><span class="op" id="2026532">)</span><span class="op" id="2026533">,</span>&nbsp;<span class="num" id="2026535">32</span><span class="op" id="2026537">)</span>&nbsp;<span class="op" id="2026539">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2026542">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2026613">func</span>&nbsp;<span class="op" id="2026618">(</span><span class="ident" id="2026619">f</span>&nbsp;<span class="op" id="2026621">*</span><span class="ident" id="2026622">fmt</span><span class="op" id="2026625">)</span>&nbsp;<span class="ident" id="2026627">fmt_g32</span><span class="op" id="2026634">(</span><span class="ident" id="2026635">v</span>&nbsp;<span class="builtintype" id="2026637">float32</span><span class="op" id="2026644">)</span>&nbsp;<span class="op" id="2026646">{</span>&nbsp;<span class="ident" id="2026648">f</span><span class="op" id="2026649">.</span><span class="ident" id="2026650">formatFloat</span><span class="op" id="2026661">(</span><span class="builtintype" id="2026662">float64</span><span class="op" id="2026669">(</span><span class="ident" id="2026670">v</span><span class="op" id="2026671">)</span><span class="op" id="2026672">,</span>&nbsp;<span class="string" id="2026674">&#39;g&#39;</span><span class="op" id="2026677">,</span>&nbsp;<span class="ident" id="2026679">doPrec</span><span class="op" id="2026685">(</span><span class="ident" id="2026686">f</span><span class="op" id="2026687">,</span>&nbsp;<span class="op" id="2026689">-</span><span class="num" id="2026690">1</span><span class="op" id="2026691">)</span><span class="op" id="2026692">,</span>&nbsp;<span class="num" id="2026694">32</span><span class="op" id="2026696">)</span>&nbsp;<span class="op" id="2026698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2026701">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2026772">func</span>&nbsp;<span class="op" id="2026777">(</span><span class="ident" id="2026778">f</span>&nbsp;<span class="op" id="2026780">*</span><span class="ident" id="2026781">fmt</span><span class="op" id="2026784">)</span>&nbsp;<span class="ident" id="2026786">fmt_G32</span><span class="op" id="2026793">(</span><span class="ident" id="2026794">v</span>&nbsp;<span class="builtintype" id="2026796">float32</span><span class="op" id="2026803">)</span>&nbsp;<span class="op" id="2026805">{</span>&nbsp;<span class="ident" id="2026807">f</span><span class="op" id="2026808">.</span><span class="ident" id="2026809">formatFloat</span><span class="op" id="2026820">(</span><span class="builtintype" id="2026821">float64</span><span class="op" id="2026828">(</span><span class="ident" id="2026829">v</span><span class="op" id="2026830">)</span><span class="op" id="2026831">,</span>&nbsp;<span class="string" id="2026833">&#39;G&#39;</span><span class="op" id="2026836">,</span>&nbsp;<span class="ident" id="2026838">doPrec</span><span class="op" id="2026844">(</span><span class="ident" id="2026845">f</span><span class="op" id="2026846">,</span>&nbsp;<span class="op" id="2026848">-</span><span class="num" id="2026849">1</span><span class="op" id="2026850">)</span><span class="op" id="2026851">,</span>&nbsp;<span class="num" id="2026853">32</span><span class="op" id="2026855">)</span>&nbsp;<span class="op" id="2026857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2026860">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2026935">func</span>&nbsp;<span class="op" id="2026940">(</span><span class="ident" id="2026941">f</span>&nbsp;<span class="op" id="2026943">*</span><span class="ident" id="2026944">fmt</span><span class="op" id="2026947">)</span>&nbsp;<span class="ident" id="2026949">fmt_fb32</span><span class="op" id="2026957">(</span><span class="ident" id="2026958">v</span>&nbsp;<span class="builtintype" id="2026960">float32</span><span class="op" id="2026967">)</span>&nbsp;<span class="op" id="2026969">{</span>&nbsp;<span class="ident" id="2026971">f</span><span class="op" id="2026972">.</span><span class="ident" id="2026973">formatFloat</span><span class="op" id="2026984">(</span><span class="builtintype" id="2026985">float64</span><span class="op" id="2026992">(</span><span class="ident" id="2026993">v</span><span class="op" id="2026994">)</span><span class="op" id="2026995">,</span>&nbsp;<span class="string" id="2026997">&#39;b&#39;</span><span class="op" id="2027000">,</span>&nbsp;<span class="num" id="2027002">0</span><span class="op" id="2027003">,</span>&nbsp;<span class="num" id="2027005">32</span><span class="op" id="2027007">)</span>&nbsp;<span class="op" id="2027009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2027012">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2027066">func</span>&nbsp;<span class="op" id="2027071">(</span><span class="ident" id="2027072">f</span>&nbsp;<span class="op" id="2027074">*</span><span class="ident" id="2027075">fmt</span><span class="op" id="2027078">)</span>&nbsp;<span class="ident" id="2027080">fmt_c64</span><span class="op" id="2027087">(</span><span class="ident" id="2027088">v</span>&nbsp;<span class="builtintype" id="2027090">complex64</span><span class="op" id="2027099">,</span>&nbsp;<span class="ident" id="2027101">verb</span>&nbsp;<span class="builtintype" id="2027106">rune</span><span class="op" id="2027110">)</span>&nbsp;<span class="op" id="2027112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027115">f</span><span class="op" id="2027116">.</span><span class="ident" id="2027117">fmt_complex</span><span class="op" id="2027128">(</span><span class="builtintype" id="2027129">float64</span><span class="op" id="2027136">(</span><span class="builtinfunc" id="2027137">real</span><span class="op" id="2027141">(</span><span class="ident" id="2027142">v</span><span class="op" id="2027143">)</span><span class="op" id="2027144">)</span><span class="op" id="2027145">,</span>&nbsp;<span class="builtintype" id="2027147">float64</span><span class="op" id="2027154">(</span><span class="builtinfunc" id="2027155">imag</span><span class="op" id="2027159">(</span><span class="ident" id="2027160">v</span><span class="op" id="2027161">)</span><span class="op" id="2027162">)</span><span class="op" id="2027163">,</span>&nbsp;<span class="num" id="2027165">32</span><span class="op" id="2027167">,</span>&nbsp;<span class="ident" id="2027169">verb</span><span class="op" id="2027173">)</span><br>
<span class="lineno"></span><span class="op" id="2027175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2027178">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2027234">func</span>&nbsp;<span class="op" id="2027239">(</span><span class="ident" id="2027240">f</span>&nbsp;<span class="op" id="2027242">*</span><span class="ident" id="2027243">fmt</span><span class="op" id="2027246">)</span>&nbsp;<span class="ident" id="2027248">fmt_c128</span><span class="op" id="2027256">(</span><span class="ident" id="2027257">v</span>&nbsp;<span class="builtintype" id="2027259">complex128</span><span class="op" id="2027269">,</span>&nbsp;<span class="ident" id="2027271">verb</span>&nbsp;<span class="builtintype" id="2027276">rune</span><span class="op" id="2027280">)</span>&nbsp;<span class="op" id="2027282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027285">f</span><span class="op" id="2027286">.</span><span class="ident" id="2027287">fmt_complex</span><span class="op" id="2027298">(</span><span class="builtinfunc" id="2027299">real</span><span class="op" id="2027303">(</span><span class="ident" id="2027304">v</span><span class="op" id="2027305">)</span><span class="op" id="2027306">,</span>&nbsp;<span class="builtinfunc" id="2027308">imag</span><span class="op" id="2027312">(</span><span class="ident" id="2027313">v</span><span class="op" id="2027314">)</span><span class="op" id="2027315">,</span>&nbsp;<span class="num" id="2027317">64</span><span class="op" id="2027319">,</span>&nbsp;<span class="ident" id="2027321">verb</span><span class="op" id="2027325">)</span><br>
<span class="lineno"></span><span class="op" id="2027327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2027330">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2027381">func</span>&nbsp;<span class="op" id="2027386">(</span><span class="ident" id="2027387">f</span>&nbsp;<span class="op" id="2027389">*</span><span class="ident" id="2027390">fmt</span><span class="op" id="2027393">)</span>&nbsp;<span class="ident" id="2027395">fmt_complex</span><span class="op" id="2027406">(</span><span class="ident" id="2027407">r</span><span class="op" id="2027408">,</span>&nbsp;<span class="ident" id="2027410">j</span>&nbsp;<span class="builtintype" id="2027412">float64</span><span class="op" id="2027419">,</span>&nbsp;<span class="ident" id="2027421">size</span>&nbsp;<span class="builtintype" id="2027426">int</span><span class="op" id="2027429">,</span>&nbsp;<span class="ident" id="2027431">verb</span>&nbsp;<span class="builtintype" id="2027436">rune</span><span class="op" id="2027440">)</span>&nbsp;<span class="op" id="2027442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027445">f</span><span class="op" id="2027446">.</span><span class="ident" id="2027447">buf</span><span class="op" id="2027450">.</span><span class="ident" id="2027451">WriteByte</span><span class="op" id="2027460">(</span><span class="string" id="2027461">&#39;(&#39;</span><span class="op" id="2027464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027467">oldPlus</span>&nbsp;<span class="op" id="2027475">:=</span>&nbsp;<span class="ident" id="2027478">f</span><span class="op" id="2027479">.</span><span class="ident" id="2027480">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027486">oldSpace</span>&nbsp;<span class="op" id="2027495">:=</span>&nbsp;<span class="ident" id="2027498">f</span><span class="op" id="2027499">.</span><span class="ident" id="2027500">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027507">oldWid</span>&nbsp;<span class="op" id="2027514">:=</span>&nbsp;<span class="ident" id="2027517">f</span><span class="op" id="2027518">.</span><span class="ident" id="2027519">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027524">for</span>&nbsp;<span class="ident" id="2027528">i</span>&nbsp;<span class="op" id="2027530">:=</span>&nbsp;<span class="num" id="2027533">0</span><span class="op" id="2027534">;</span>&nbsp;<span class="op" id="2027536">;</span>&nbsp;<span class="ident" id="2027538">i</span><span class="op" id="2027539">++</span>&nbsp;<span class="op" id="2027542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027546">switch</span>&nbsp;<span class="ident" id="2027553">verb</span>&nbsp;<span class="op" id="2027558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027562">case</span>&nbsp;<span class="string" id="2027567">&#39;b&#39;</span><span class="op" id="2027570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027575">f</span><span class="op" id="2027576">.</span><span class="ident" id="2027577">formatFloat</span><span class="op" id="2027588">(</span><span class="ident" id="2027589">r</span><span class="op" id="2027590">,</span>&nbsp;<span class="string" id="2027592">&#39;b&#39;</span><span class="op" id="2027595">,</span>&nbsp;<span class="num" id="2027597">0</span><span class="op" id="2027598">,</span>&nbsp;<span class="ident" id="2027600">size</span><span class="op" id="2027604">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027608">case</span>&nbsp;<span class="string" id="2027613">&#39;e&#39;</span><span class="op" id="2027616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027621">f</span><span class="op" id="2027622">.</span><span class="ident" id="2027623">formatFloat</span><span class="op" id="2027634">(</span><span class="ident" id="2027635">r</span><span class="op" id="2027636">,</span>&nbsp;<span class="string" id="2027638">&#39;e&#39;</span><span class="op" id="2027641">,</span>&nbsp;<span class="ident" id="2027643">doPrec</span><span class="op" id="2027649">(</span><span class="ident" id="2027650">f</span><span class="op" id="2027651">,</span>&nbsp;<span class="num" id="2027653">6</span><span class="op" id="2027654">)</span><span class="op" id="2027655">,</span>&nbsp;<span class="ident" id="2027657">size</span><span class="op" id="2027661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027665">case</span>&nbsp;<span class="string" id="2027670">&#39;E&#39;</span><span class="op" id="2027673">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027678">f</span><span class="op" id="2027679">.</span><span class="ident" id="2027680">formatFloat</span><span class="op" id="2027691">(</span><span class="ident" id="2027692">r</span><span class="op" id="2027693">,</span>&nbsp;<span class="string" id="2027695">&#39;E&#39;</span><span class="op" id="2027698">,</span>&nbsp;<span class="ident" id="2027700">doPrec</span><span class="op" id="2027706">(</span><span class="ident" id="2027707">f</span><span class="op" id="2027708">,</span>&nbsp;<span class="num" id="2027710">6</span><span class="op" id="2027711">)</span><span class="op" id="2027712">,</span>&nbsp;<span class="ident" id="2027714">size</span><span class="op" id="2027718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027722">case</span>&nbsp;<span class="string" id="2027727">&#39;f&#39;</span><span class="op" id="2027730">,</span>&nbsp;<span class="string" id="2027732">&#39;F&#39;</span><span class="op" id="2027735">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027740">f</span><span class="op" id="2027741">.</span><span class="ident" id="2027742">formatFloat</span><span class="op" id="2027753">(</span><span class="ident" id="2027754">r</span><span class="op" id="2027755">,</span>&nbsp;<span class="string" id="2027757">&#39;f&#39;</span><span class="op" id="2027760">,</span>&nbsp;<span class="ident" id="2027762">doPrec</span><span class="op" id="2027768">(</span><span class="ident" id="2027769">f</span><span class="op" id="2027770">,</span>&nbsp;<span class="num" id="2027772">6</span><span class="op" id="2027773">)</span><span class="op" id="2027774">,</span>&nbsp;<span class="ident" id="2027776">size</span><span class="op" id="2027780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027784">case</span>&nbsp;<span class="string" id="2027789">&#39;g&#39;</span><span class="op" id="2027792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027797">f</span><span class="op" id="2027798">.</span><span class="ident" id="2027799">formatFloat</span><span class="op" id="2027810">(</span><span class="ident" id="2027811">r</span><span class="op" id="2027812">,</span>&nbsp;<span class="string" id="2027814">&#39;g&#39;</span><span class="op" id="2027817">,</span>&nbsp;<span class="ident" id="2027819">doPrec</span><span class="op" id="2027825">(</span><span class="ident" id="2027826">f</span><span class="op" id="2027827">,</span>&nbsp;<span class="op" id="2027829">-</span><span class="num" id="2027830">1</span><span class="op" id="2027831">)</span><span class="op" id="2027832">,</span>&nbsp;<span class="ident" id="2027834">size</span><span class="op" id="2027838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027842">case</span>&nbsp;<span class="string" id="2027847">&#39;G&#39;</span><span class="op" id="2027850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027855">f</span><span class="op" id="2027856">.</span><span class="ident" id="2027857">formatFloat</span><span class="op" id="2027868">(</span><span class="ident" id="2027869">r</span><span class="op" id="2027870">,</span>&nbsp;<span class="string" id="2027872">&#39;G&#39;</span><span class="op" id="2027875">,</span>&nbsp;<span class="ident" id="2027877">doPrec</span><span class="op" id="2027883">(</span><span class="ident" id="2027884">f</span><span class="op" id="2027885">,</span>&nbsp;<span class="op" id="2027887">-</span><span class="num" id="2027888">1</span><span class="op" id="2027889">)</span><span class="op" id="2027890">,</span>&nbsp;<span class="ident" id="2027892">size</span><span class="op" id="2027896">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2027900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027904">if</span>&nbsp;<span class="ident" id="2027907">i</span>&nbsp;<span class="op" id="2027909">!=</span>&nbsp;<span class="num" id="2027912">0</span>&nbsp;<span class="op" id="2027914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2027919">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2027927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2027931">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027970">f</span><span class="op" id="2027971">.</span><span class="ident" id="2027972">plus</span>&nbsp;<span class="op" id="2027977">=</span>&nbsp;<span class="builtintype" id="2027979">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2027986">f</span><span class="op" id="2027987">.</span><span class="ident" id="2027988">space</span>&nbsp;<span class="op" id="2027994">=</span>&nbsp;<span class="builtintype" id="2027996">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2028004">f</span><span class="op" id="2028005">.</span><span class="ident" id="2028006">wid</span>&nbsp;<span class="op" id="2028010">=</span>&nbsp;<span class="ident" id="2028012">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2028021">r</span>&nbsp;<span class="op" id="2028023">=</span>&nbsp;<span class="ident" id="2028025">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2028028">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2028031">f</span><span class="op" id="2028032">.</span><span class="ident" id="2028033">space</span>&nbsp;<span class="op" id="2028039">=</span>&nbsp;<span class="ident" id="2028041">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2028051">f</span><span class="op" id="2028052">.</span><span class="ident" id="2028053">plus</span>&nbsp;<span class="op" id="2028058">=</span>&nbsp;<span class="ident" id="2028060">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2028069">f</span><span class="op" id="2028070">.</span><span class="ident" id="2028071">wid</span>&nbsp;<span class="op" id="2028075">=</span>&nbsp;<span class="ident" id="2028077">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2028085">f</span><span class="op" id="2028086">.</span><span class="ident" id="2028087">buf</span><span class="op" id="2028090">.</span><span class="ident" id="2028091">Write</span><span class="op" id="2028096">(</span><span class="ident" id="2028097">irparenBytes</span><span class="op" id="2028109">)</span><br>
<span class="lineno"></span><span class="op" id="2028111">}</span>
</div>
</body>
</html>
