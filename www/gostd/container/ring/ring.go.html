<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html" class="current">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5450293">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5450348">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5450402">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5450453">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="5450510">package</span>&nbsp;<span class="ident" id="5450518">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5450524">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="5450577">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="5450648">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="5450719">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="5450787">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="5450813">//</span><br>
<span class="lineno"></span><span class="keyword" id="5450816">type</span>&nbsp;<span class="ident" id="5450821">Ring</span>&nbsp;<span class="keyword" id="5450826">struct</span>&nbsp;<span class="op" id="5450833">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5450836">next</span><span class="op" id="5450840">,</span>&nbsp;<span class="ident" id="5450842">prev</span>&nbsp;<span class="op" id="5450847">*</span><span class="ident" id="5450848">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5450854">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5450865">interface</span><span class="op" id="5450874">{</span><span class="op" id="5450875">}</span>&nbsp;<span class="comment" id="5450877">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="5450925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5450928">func</span>&nbsp;<span class="op" id="5450933">(</span><span class="ident" id="5450934">r</span>&nbsp;<span class="op" id="5450936">*</span><span class="ident" id="5450937">Ring</span><span class="op" id="5450941">)</span>&nbsp;<span class="ident" id="5450943">init</span><span class="op" id="5450947">(</span><span class="op" id="5450948">)</span>&nbsp;<span class="op" id="5450950">*</span><span class="ident" id="5450951">Ring</span>&nbsp;<span class="op" id="5450956">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5450959">r</span><span class="op" id="5450960">.</span><span class="ident" id="5450961">next</span>&nbsp;<span class="op" id="5450966">=</span>&nbsp;<span class="ident" id="5450968">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5450971">r</span><span class="op" id="5450972">.</span><span class="ident" id="5450973">prev</span>&nbsp;<span class="op" id="5450978">=</span>&nbsp;<span class="ident" id="5450980">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5450983">return</span>&nbsp;<span class="ident" id="5450990">r</span><br>
<span class="lineno"></span><span class="op" id="5450992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5450995">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="5451055">func</span>&nbsp;<span class="op" id="5451060">(</span><span class="ident" id="5451061">r</span>&nbsp;<span class="op" id="5451063">*</span><span class="ident" id="5451064">Ring</span><span class="op" id="5451068">)</span>&nbsp;<span class="ident" id="5451070">Next</span><span class="op" id="5451074">(</span><span class="op" id="5451075">)</span>&nbsp;<span class="op" id="5451077">*</span><span class="ident" id="5451078">Ring</span>&nbsp;<span class="op" id="5451083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451086">if</span>&nbsp;<span class="ident" id="5451089">r</span><span class="op" id="5451090">.</span><span class="ident" id="5451091">next</span>&nbsp;<span class="op" id="5451096">==</span>&nbsp;<span class="builtintype" id="5451099">nil</span>&nbsp;<span class="op" id="5451103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451107">return</span>&nbsp;<span class="ident" id="5451114">r</span><span class="op" id="5451115">.</span><span class="ident" id="5451116">init</span><span class="op" id="5451120">(</span><span class="op" id="5451121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5451124">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451127">return</span>&nbsp;<span class="ident" id="5451134">r</span><span class="op" id="5451135">.</span><span class="ident" id="5451136">next</span><br>
<span class="lineno"></span><span class="op" id="5451141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5451144">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="5451208">func</span>&nbsp;<span class="op" id="5451213">(</span><span class="ident" id="5451214">r</span>&nbsp;<span class="op" id="5451216">*</span><span class="ident" id="5451217">Ring</span><span class="op" id="5451221">)</span>&nbsp;<span class="ident" id="5451223">Prev</span><span class="op" id="5451227">(</span><span class="op" id="5451228">)</span>&nbsp;<span class="op" id="5451230">*</span><span class="ident" id="5451231">Ring</span>&nbsp;<span class="op" id="5451236">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451239">if</span>&nbsp;<span class="ident" id="5451242">r</span><span class="op" id="5451243">.</span><span class="ident" id="5451244">next</span>&nbsp;<span class="op" id="5451249">==</span>&nbsp;<span class="builtintype" id="5451252">nil</span>&nbsp;<span class="op" id="5451256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451260">return</span>&nbsp;<span class="ident" id="5451267">r</span><span class="op" id="5451268">.</span><span class="ident" id="5451269">init</span><span class="op" id="5451273">(</span><span class="op" id="5451274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5451277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451280">return</span>&nbsp;<span class="ident" id="5451287">r</span><span class="op" id="5451288">.</span><span class="ident" id="5451289">prev</span><br>
<span class="lineno"></span><span class="op" id="5451294">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="5451297">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="5451369">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="5451436">//</span><br>
<span class="lineno"></span><span class="keyword" id="5451439">func</span>&nbsp;<span class="op" id="5451444">(</span><span class="ident" id="5451445">r</span>&nbsp;<span class="op" id="5451447">*</span><span class="ident" id="5451448">Ring</span><span class="op" id="5451452">)</span>&nbsp;<span class="ident" id="5451454">Move</span><span class="op" id="5451458">(</span><span class="ident" id="5451459">n</span>&nbsp;<span class="builtintype" id="5451461">int</span><span class="op" id="5451464">)</span>&nbsp;<span class="op" id="5451466">*</span><span class="ident" id="5451467">Ring</span>&nbsp;<span class="op" id="5451472">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451475">if</span>&nbsp;<span class="ident" id="5451478">r</span><span class="op" id="5451479">.</span><span class="ident" id="5451480">next</span>&nbsp;<span class="op" id="5451485">==</span>&nbsp;<span class="builtintype" id="5451488">nil</span>&nbsp;<span class="op" id="5451492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451496">return</span>&nbsp;<span class="ident" id="5451503">r</span><span class="op" id="5451504">.</span><span class="ident" id="5451505">init</span><span class="op" id="5451509">(</span><span class="op" id="5451510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5451513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451516">switch</span>&nbsp;<span class="op" id="5451523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451526">case</span>&nbsp;<span class="ident" id="5451531">n</span>&nbsp;<span class="op" id="5451533">&lt;</span>&nbsp;<span class="num" id="5451535">0</span><span class="op" id="5451536">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451540">for</span>&nbsp;<span class="op" id="5451544">;</span>&nbsp;<span class="ident" id="5451546">n</span>&nbsp;<span class="op" id="5451548">&lt;</span>&nbsp;<span class="num" id="5451550">0</span><span class="op" id="5451551">;</span>&nbsp;<span class="ident" id="5451553">n</span><span class="op" id="5451554">++</span>&nbsp;<span class="op" id="5451557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5451562">r</span>&nbsp;<span class="op" id="5451564">=</span>&nbsp;<span class="ident" id="5451566">r</span><span class="op" id="5451567">.</span><span class="ident" id="5451568">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5451575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451578">case</span>&nbsp;<span class="ident" id="5451583">n</span>&nbsp;<span class="op" id="5451585">&gt;</span>&nbsp;<span class="num" id="5451587">0</span><span class="op" id="5451588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451592">for</span>&nbsp;<span class="op" id="5451596">;</span>&nbsp;<span class="ident" id="5451598">n</span>&nbsp;<span class="op" id="5451600">&gt;</span>&nbsp;<span class="num" id="5451602">0</span><span class="op" id="5451603">;</span>&nbsp;<span class="ident" id="5451605">n</span><span class="op" id="5451606">--</span>&nbsp;<span class="op" id="5451609">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5451614">r</span>&nbsp;<span class="op" id="5451616">=</span>&nbsp;<span class="ident" id="5451618">r</span><span class="op" id="5451619">.</span><span class="ident" id="5451620">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5451627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5451630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451633">return</span>&nbsp;<span class="ident" id="5451640">r</span><br>
<span class="lineno"></span><span class="op" id="5451642">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5451645">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="5451682">func</span>&nbsp;<span class="ident" id="5451687">New</span><span class="op" id="5451690">(</span><span class="ident" id="5451691">n</span>&nbsp;<span class="builtintype" id="5451693">int</span><span class="op" id="5451696">)</span>&nbsp;<span class="op" id="5451698">*</span><span class="ident" id="5451699">Ring</span>&nbsp;<span class="op" id="5451704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451707">if</span>&nbsp;<span class="ident" id="5451710">n</span>&nbsp;<span class="op" id="5451712">&lt;=</span>&nbsp;<span class="num" id="5451715">0</span>&nbsp;<span class="op" id="5451717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451721">return</span>&nbsp;<span class="builtintype" id="5451728">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5451733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5451736">r</span>&nbsp;<span class="op" id="5451738">:=</span>&nbsp;<span class="builtinfunc" id="5451741">new</span><span class="op" id="5451744">(</span><span class="ident" id="5451745">Ring</span><span class="op" id="5451749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5451752">p</span>&nbsp;<span class="op" id="5451754">:=</span>&nbsp;<span class="ident" id="5451757">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451760">for</span>&nbsp;<span class="ident" id="5451764">i</span>&nbsp;<span class="op" id="5451766">:=</span>&nbsp;<span class="num" id="5451769">1</span><span class="op" id="5451770">;</span>&nbsp;<span class="ident" id="5451772">i</span>&nbsp;<span class="op" id="5451774">&lt;</span>&nbsp;<span class="ident" id="5451776">n</span><span class="op" id="5451777">;</span>&nbsp;<span class="ident" id="5451779">i</span><span class="op" id="5451780">++</span>&nbsp;<span class="op" id="5451783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5451787">p</span><span class="op" id="5451788">.</span><span class="ident" id="5451789">next</span>&nbsp;<span class="op" id="5451794">=</span>&nbsp;<span class="op" id="5451796">&amp;</span><span class="ident" id="5451797">Ring</span><span class="op" id="5451801">{</span><span class="ident" id="5451802">prev</span><span class="op" id="5451806">:</span>&nbsp;<span class="ident" id="5451808">p</span><span class="op" id="5451809">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5451813">p</span>&nbsp;<span class="op" id="5451815">=</span>&nbsp;<span class="ident" id="5451817">p</span><span class="op" id="5451818">.</span><span class="ident" id="5451819">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5451825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5451828">p</span><span class="op" id="5451829">.</span><span class="ident" id="5451830">next</span>&nbsp;<span class="op" id="5451835">=</span>&nbsp;<span class="ident" id="5451837">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5451840">r</span><span class="op" id="5451841">.</span><span class="ident" id="5451842">prev</span>&nbsp;<span class="op" id="5451847">=</span>&nbsp;<span class="ident" id="5451849">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5451852">return</span>&nbsp;<span class="ident" id="5451859">r</span><br>
<span class="lineno">75</span><span class="op" id="5451861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5451864">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="5451919">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="5451977">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="5452001">//</span><br>
<span class="lineno"></span><span class="comment" id="5452004">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="5452050">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="5452110">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5452169">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="5452228">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="5452284">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="5452301">//</span><br>
<span class="lineno"></span><span class="comment" id="5452304">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="5452352">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="5452414">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5452473">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="5452511">//</span><br>
<span class="lineno"></span><span class="keyword" id="5452514">func</span>&nbsp;<span class="op" id="5452519">(</span><span class="ident" id="5452520">r</span>&nbsp;<span class="op" id="5452522">*</span><span class="ident" id="5452523">Ring</span><span class="op" id="5452527">)</span>&nbsp;<span class="ident" id="5452529">Link</span><span class="op" id="5452533">(</span><span class="ident" id="5452534">s</span>&nbsp;<span class="op" id="5452536">*</span><span class="ident" id="5452537">Ring</span><span class="op" id="5452541">)</span>&nbsp;<span class="op" id="5452543">*</span><span class="ident" id="5452544">Ring</span>&nbsp;<span class="op" id="5452549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5452552">n</span>&nbsp;<span class="op" id="5452554">:=</span>&nbsp;<span class="ident" id="5452557">r</span><span class="op" id="5452558">.</span><span class="ident" id="5452559">Next</span><span class="op" id="5452563">(</span><span class="op" id="5452564">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5452567">if</span>&nbsp;<span class="ident" id="5452570">s</span>&nbsp;<span class="op" id="5452572">!=</span>&nbsp;<span class="builtintype" id="5452575">nil</span>&nbsp;<span class="op" id="5452579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5452583">p</span>&nbsp;<span class="op" id="5452585">:=</span>&nbsp;<span class="ident" id="5452588">s</span><span class="op" id="5452589">.</span><span class="ident" id="5452590">Prev</span><span class="op" id="5452594">(</span><span class="op" id="5452595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5452599">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5452649">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5452696">r</span><span class="op" id="5452697">.</span><span class="ident" id="5452698">next</span>&nbsp;<span class="op" id="5452703">=</span>&nbsp;<span class="ident" id="5452705">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5452709">s</span><span class="op" id="5452710">.</span><span class="ident" id="5452711">prev</span>&nbsp;<span class="op" id="5452716">=</span>&nbsp;<span class="ident" id="5452718">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5452722">n</span><span class="op" id="5452723">.</span><span class="ident" id="5452724">prev</span>&nbsp;<span class="op" id="5452729">=</span>&nbsp;<span class="ident" id="5452731">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5452735">p</span><span class="op" id="5452736">.</span><span class="ident" id="5452737">next</span>&nbsp;<span class="op" id="5452742">=</span>&nbsp;<span class="ident" id="5452744">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5452747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5452750">return</span>&nbsp;<span class="ident" id="5452757">n</span><br>
<span class="lineno">105</span><span class="op" id="5452759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5452762">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="5452827">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="5452885">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="5452944">//</span><br>
<span class="lineno"></span><span class="keyword" id="5452947">func</span>&nbsp;<span class="op" id="5452952">(</span><span class="ident" id="5452953">r</span>&nbsp;<span class="op" id="5452955">*</span><span class="ident" id="5452956">Ring</span><span class="op" id="5452960">)</span>&nbsp;<span class="ident" id="5452962">Unlink</span><span class="op" id="5452968">(</span><span class="ident" id="5452969">n</span>&nbsp;<span class="builtintype" id="5452971">int</span><span class="op" id="5452974">)</span>&nbsp;<span class="op" id="5452976">*</span><span class="ident" id="5452977">Ring</span>&nbsp;<span class="op" id="5452982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5452985">if</span>&nbsp;<span class="ident" id="5452988">n</span>&nbsp;<span class="op" id="5452990">&lt;=</span>&nbsp;<span class="num" id="5452993">0</span>&nbsp;<span class="op" id="5452995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5452999">return</span>&nbsp;<span class="builtintype" id="5453006">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5453011">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5453014">return</span>&nbsp;<span class="ident" id="5453021">r</span><span class="op" id="5453022">.</span><span class="ident" id="5453023">Link</span><span class="op" id="5453027">(</span><span class="ident" id="5453028">r</span><span class="op" id="5453029">.</span><span class="ident" id="5453030">Move</span><span class="op" id="5453034">(</span><span class="ident" id="5453035">n</span>&nbsp;<span class="op" id="5453037">+</span>&nbsp;<span class="num" id="5453039">1</span><span class="op" id="5453040">)</span><span class="op" id="5453041">)</span><br>
<span class="lineno"></span><span class="op" id="5453043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5453046">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5453096">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="5453159">//</span><br>
<span class="lineno"></span><span class="keyword" id="5453162">func</span>&nbsp;<span class="op" id="5453167">(</span><span class="ident" id="5453168">r</span>&nbsp;<span class="op" id="5453170">*</span><span class="ident" id="5453171">Ring</span><span class="op" id="5453175">)</span>&nbsp;<span class="ident" id="5453177">Len</span><span class="op" id="5453180">(</span><span class="op" id="5453181">)</span>&nbsp;<span class="builtintype" id="5453183">int</span>&nbsp;<span class="op" id="5453187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5453190">n</span>&nbsp;<span class="op" id="5453192">:=</span>&nbsp;<span class="num" id="5453195">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5453198">if</span>&nbsp;<span class="ident" id="5453201">r</span>&nbsp;<span class="op" id="5453203">!=</span>&nbsp;<span class="builtintype" id="5453206">nil</span>&nbsp;<span class="op" id="5453210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5453214">n</span>&nbsp;<span class="op" id="5453216">=</span>&nbsp;<span class="num" id="5453218">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5453222">for</span>&nbsp;<span class="ident" id="5453226">p</span>&nbsp;<span class="op" id="5453228">:=</span>&nbsp;<span class="ident" id="5453231">r</span><span class="op" id="5453232">.</span><span class="ident" id="5453233">Next</span><span class="op" id="5453237">(</span><span class="op" id="5453238">)</span><span class="op" id="5453239">;</span>&nbsp;<span class="ident" id="5453241">p</span>&nbsp;<span class="op" id="5453243">!=</span>&nbsp;<span class="ident" id="5453246">r</span><span class="op" id="5453247">;</span>&nbsp;<span class="ident" id="5453249">p</span>&nbsp;<span class="op" id="5453251">=</span>&nbsp;<span class="ident" id="5453253">p</span><span class="op" id="5453254">.</span><span class="ident" id="5453255">next</span>&nbsp;<span class="op" id="5453260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5453265">n</span><span class="op" id="5453266">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5453271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5453274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5453277">return</span>&nbsp;<span class="ident" id="5453284">n</span><br>
<span class="lineno">130</span><span class="op" id="5453286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5453289">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="5453359">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="5453411">func</span>&nbsp;<span class="op" id="5453416">(</span><span class="ident" id="5453417">r</span>&nbsp;<span class="op" id="5453419">*</span><span class="ident" id="5453420">Ring</span><span class="op" id="5453424">)</span>&nbsp;<span class="ident" id="5453426">Do</span><span class="op" id="5453428">(</span><span class="ident" id="5453429">f</span>&nbsp;<span class="keyword" id="5453431">func</span><span class="op" id="5453435">(</span><span class="keyword" id="5453436">interface</span><span class="op" id="5453445">{</span><span class="op" id="5453446">}</span><span class="op" id="5453447">)</span><span class="op" id="5453448">)</span>&nbsp;<span class="op" id="5453450">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5453453">if</span>&nbsp;<span class="ident" id="5453456">r</span>&nbsp;<span class="op" id="5453458">!=</span>&nbsp;<span class="builtintype" id="5453461">nil</span>&nbsp;<span class="op" id="5453465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5453469">f</span><span class="op" id="5453470">(</span><span class="ident" id="5453471">r</span><span class="op" id="5453472">.</span><span class="ident" id="5453473">Value</span><span class="op" id="5453478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5453482">for</span>&nbsp;<span class="ident" id="5453486">p</span>&nbsp;<span class="op" id="5453488">:=</span>&nbsp;<span class="ident" id="5453491">r</span><span class="op" id="5453492">.</span><span class="ident" id="5453493">Next</span><span class="op" id="5453497">(</span><span class="op" id="5453498">)</span><span class="op" id="5453499">;</span>&nbsp;<span class="ident" id="5453501">p</span>&nbsp;<span class="op" id="5453503">!=</span>&nbsp;<span class="ident" id="5453506">r</span><span class="op" id="5453507">;</span>&nbsp;<span class="ident" id="5453509">p</span>&nbsp;<span class="op" id="5453511">=</span>&nbsp;<span class="ident" id="5453513">p</span><span class="op" id="5453514">.</span><span class="ident" id="5453515">next</span>&nbsp;<span class="op" id="5453520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5453525">f</span><span class="op" id="5453526">(</span><span class="ident" id="5453527">p</span><span class="op" id="5453528">.</span><span class="ident" id="5453529">Value</span><span class="op" id="5453534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5453538">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5453541">}</span><br>
<span class="lineno"></span><span class="op" id="5453543">}</span>
</div>
</body>
</html>
