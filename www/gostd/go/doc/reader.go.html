<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3305552">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3305607">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3305661">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3305712">package</span>&nbsp;<span class="ident" id="3305720">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3305725">import</span>&nbsp;<span class="op" id="3305732">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3305735">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3305745">&#34;go/token&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3305757">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3305767">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3305775">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3305785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3305788">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3305868">//&nbsp;function/method&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="3305892">//</span><br>
<span class="lineno"></span><span class="comment" id="3305895">//&nbsp;Internally,&nbsp;we&nbsp;treat&nbsp;functions&nbsp;like&nbsp;methods&nbsp;and&nbsp;collect&nbsp;them&nbsp;in&nbsp;method&nbsp;sets.</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3305976">//&nbsp;A&nbsp;methodSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;methods.&nbsp;Entries&nbsp;where&nbsp;Decl&nbsp;==&nbsp;nil&nbsp;are&nbsp;conflict</span><br>
<span class="lineno"></span><span class="comment" id="3306058">//&nbsp;entries&nbsp;(more&nbsp;then&nbsp;one&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;embedding&nbsp;level).</span><br>
<span class="lineno"></span><span class="comment" id="3306140">//</span><br>
<span class="lineno"></span><span class="keyword" id="3306143">type</span>&nbsp;<span class="ident" id="3306148">methodSet</span>&nbsp;<span class="keyword" id="3306158">map</span><span class="op" id="3306161">[</span><span class="builtintype" id="3306162">string</span><span class="op" id="3306168">]</span><span class="op" id="3306169">*</span><span class="ident" id="3306170">Func</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3306176">//&nbsp;recvString&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;recv&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3306237">//&nbsp;form&nbsp;&#34;T&#34;,&nbsp;&#34;*T&#34;,&nbsp;or&nbsp;&#34;BADRECV&#34;&nbsp;(if&nbsp;not&nbsp;a&nbsp;proper&nbsp;receiver&nbsp;type).</span><br>
<span class="lineno"></span><span class="comment" id="3306302">//</span><br>
<span class="lineno"></span><span class="keyword" id="3306305">func</span>&nbsp;<span class="ident" id="3306310">recvString</span><span class="op" id="3306320">(</span><span class="ident" id="3306321">recv</span>&nbsp;<span class="ident" id="3306326">ast</span><span class="op" id="3306329">.</span><span class="ident" id="3306330">Expr</span><span class="op" id="3306334">)</span>&nbsp;<span class="builtintype" id="3306336">string</span>&nbsp;<span class="op" id="3306343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306346">switch</span>&nbsp;<span class="ident" id="3306353">t</span>&nbsp;<span class="op" id="3306355">:=</span>&nbsp;<span class="ident" id="3306358">recv</span><span class="op" id="3306362">.</span><span class="op" id="3306363">(</span><span class="keyword" id="3306364">type</span><span class="op" id="3306368">)</span>&nbsp;<span class="op" id="3306370">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306373">case</span>&nbsp;<span class="op" id="3306378">*</span><span class="ident" id="3306379">ast</span><span class="op" id="3306382">.</span><span class="ident" id="3306383">Ident</span><span class="op" id="3306388">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306392">return</span>&nbsp;<span class="ident" id="3306399">t</span><span class="op" id="3306400">.</span><span class="ident" id="3306401">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306407">case</span>&nbsp;<span class="op" id="3306412">*</span><span class="ident" id="3306413">ast</span><span class="op" id="3306416">.</span><span class="ident" id="3306417">StarExpr</span><span class="op" id="3306425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306429">return</span>&nbsp;<span class="string" id="3306436">&#34;*&#34;</span>&nbsp;<span class="op" id="3306440">+</span>&nbsp;<span class="ident" id="3306442">recvString</span><span class="op" id="3306452">(</span><span class="ident" id="3306453">t</span><span class="op" id="3306454">.</span><span class="ident" id="3306455">X</span><span class="op" id="3306456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306459">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306462">return</span>&nbsp;<span class="string" id="3306469">&#34;BADRECV&#34;</span><br>
<span class="lineno"></span><span class="op" id="3306479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3306482">//&nbsp;set&nbsp;creates&nbsp;the&nbsp;corresponding&nbsp;Func&nbsp;for&nbsp;f&nbsp;and&nbsp;adds&nbsp;it&nbsp;to&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="3306547">//&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;f&#39;s&nbsp;with&nbsp;the&nbsp;same&nbsp;name,&nbsp;set&nbsp;keeps&nbsp;the&nbsp;first</span><br>
<span class="lineno">40</span><span class="comment" id="3306616">//&nbsp;one&nbsp;with&nbsp;documentation;&nbsp;conflicts&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3306666">//</span><br>
<span class="lineno"></span><span class="keyword" id="3306669">func</span>&nbsp;<span class="op" id="3306674">(</span><span class="ident" id="3306675">mset</span>&nbsp;<span class="ident" id="3306680">methodSet</span><span class="op" id="3306689">)</span>&nbsp;<span class="ident" id="3306691">set</span><span class="op" id="3306694">(</span><span class="ident" id="3306695">f</span>&nbsp;<span class="op" id="3306697">*</span><span class="ident" id="3306698">ast</span><span class="op" id="3306701">.</span><span class="ident" id="3306702">FuncDecl</span><span class="op" id="3306710">)</span>&nbsp;<span class="op" id="3306712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306715">name</span>&nbsp;<span class="op" id="3306720">:=</span>&nbsp;<span class="ident" id="3306723">f</span><span class="op" id="3306724">.</span><span class="ident" id="3306725">Name</span><span class="op" id="3306729">.</span><span class="ident" id="3306730">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306736">if</span>&nbsp;<span class="ident" id="3306739">g</span>&nbsp;<span class="op" id="3306741">:=</span>&nbsp;<span class="ident" id="3306744">mset</span><span class="op" id="3306748">[</span><span class="ident" id="3306749">name</span><span class="op" id="3306753">]</span><span class="op" id="3306754">;</span>&nbsp;<span class="ident" id="3306756">g</span>&nbsp;<span class="op" id="3306758">!=</span>&nbsp;<span class="ident" id="3306761">nil</span>&nbsp;<span class="op" id="3306765">&amp;&amp;</span>&nbsp;<span class="ident" id="3306768">g</span><span class="op" id="3306769">.</span><span class="ident" id="3306770">Doc</span>&nbsp;<span class="op" id="3306774">!=</span>&nbsp;<span class="string" id="3306777">&#34;&#34;</span>&nbsp;<span class="op" id="3306780">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306784">//&nbsp;A&nbsp;function&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;has&nbsp;already&nbsp;been&nbsp;registered;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306848">//&nbsp;since&nbsp;it&nbsp;has&nbsp;documentation,&nbsp;assume&nbsp;f&nbsp;is&nbsp;simply&nbsp;another</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306908">//&nbsp;implementation&nbsp;and&nbsp;ignore&nbsp;it.&nbsp;This&nbsp;does&nbsp;not&nbsp;happen&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306971">//&nbsp;caller&nbsp;is&nbsp;using&nbsp;go/build.ScanDir&nbsp;to&nbsp;determine&nbsp;the&nbsp;list&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3307034">//&nbsp;files&nbsp;implementing&nbsp;a&nbsp;package.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307069">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3307080">//&nbsp;function&nbsp;doesn&#39;t&nbsp;exist&nbsp;or&nbsp;has&nbsp;no&nbsp;documentation;&nbsp;use&nbsp;f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307138">recv</span>&nbsp;<span class="op" id="3307143">:=</span>&nbsp;<span class="string" id="3307146">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307150">if</span>&nbsp;<span class="ident" id="3307153">f</span><span class="op" id="3307154">.</span><span class="ident" id="3307155">Recv</span>&nbsp;<span class="op" id="3307160">!=</span>&nbsp;<span class="ident" id="3307163">nil</span>&nbsp;<span class="op" id="3307167">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307171">var</span>&nbsp;<span class="ident" id="3307175">typ</span>&nbsp;<span class="ident" id="3307179">ast</span><span class="op" id="3307182">.</span><span class="ident" id="3307183">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3307190">//&nbsp;be&nbsp;careful&nbsp;in&nbsp;case&nbsp;of&nbsp;incorrect&nbsp;ASTs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307232">if</span>&nbsp;<span class="ident" id="3307235">list</span>&nbsp;<span class="op" id="3307240">:=</span>&nbsp;<span class="ident" id="3307243">f</span><span class="op" id="3307244">.</span><span class="ident" id="3307245">Recv</span><span class="op" id="3307249">.</span><span class="ident" id="3307250">List</span><span class="op" id="3307254">;</span>&nbsp;<span class="builtinfunc" id="3307256">len</span><span class="op" id="3307259">(</span><span class="ident" id="3307260">list</span><span class="op" id="3307264">)</span>&nbsp;<span class="op" id="3307266">==</span>&nbsp;<span class="num" id="3307269">1</span>&nbsp;<span class="op" id="3307271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307276">typ</span>&nbsp;<span class="op" id="3307280">=</span>&nbsp;<span class="ident" id="3307282">list</span><span class="op" id="3307286">[</span><span class="num" id="3307287">0</span><span class="op" id="3307288">]</span><span class="op" id="3307289">.</span><span class="ident" id="3307290">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307297">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307301">recv</span>&nbsp;<span class="op" id="3307306">=</span>&nbsp;<span class="ident" id="3307308">recvString</span><span class="op" id="3307318">(</span><span class="ident" id="3307319">typ</span><span class="op" id="3307322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307328">mset</span><span class="op" id="3307332">[</span><span class="ident" id="3307333">name</span><span class="op" id="3307337">]</span>&nbsp;<span class="op" id="3307339">=</span>&nbsp;<span class="op" id="3307341">&amp;</span><span class="ident" id="3307342">Func</span><span class="op" id="3307346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307350">Doc</span><span class="op" id="3307353">:</span>&nbsp;&nbsp;<span class="ident" id="3307356">f</span><span class="op" id="3307357">.</span><span class="ident" id="3307358">Doc</span><span class="op" id="3307361">.</span><span class="ident" id="3307362">Text</span><span class="op" id="3307366">(</span><span class="op" id="3307367">)</span><span class="op" id="3307368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307372">Name</span><span class="op" id="3307376">:</span>&nbsp;<span class="ident" id="3307378">name</span><span class="op" id="3307382">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307386">Decl</span><span class="op" id="3307390">:</span>&nbsp;<span class="ident" id="3307392">f</span><span class="op" id="3307393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307397">Recv</span><span class="op" id="3307401">:</span>&nbsp;<span class="ident" id="3307403">recv</span><span class="op" id="3307407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307411">Orig</span><span class="op" id="3307415">:</span>&nbsp;<span class="ident" id="3307417">recv</span><span class="op" id="3307421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307427">f</span><span class="op" id="3307428">.</span><span class="ident" id="3307429">Doc</span>&nbsp;<span class="op" id="3307433">=</span>&nbsp;<span class="ident" id="3307435">nil</span>&nbsp;<span class="comment" id="3307439">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno">70</span><span class="op" id="3307473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3307476">//&nbsp;add&nbsp;adds&nbsp;method&nbsp;m&nbsp;to&nbsp;the&nbsp;method&nbsp;set;&nbsp;m&nbsp;is&nbsp;ignored&nbsp;if&nbsp;the&nbsp;method&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="3307547">//&nbsp;already&nbsp;contains&nbsp;a&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;or&nbsp;a&nbsp;higher</span><br>
<span class="lineno"></span><span class="comment" id="3307619">//&nbsp;level&nbsp;then&nbsp;m.</span><br>
<span class="lineno">75</span><span class="comment" id="3307636">//</span><br>
<span class="lineno"></span><span class="keyword" id="3307639">func</span>&nbsp;<span class="op" id="3307644">(</span><span class="ident" id="3307645">mset</span>&nbsp;<span class="ident" id="3307650">methodSet</span><span class="op" id="3307659">)</span>&nbsp;<span class="ident" id="3307661">add</span><span class="op" id="3307664">(</span><span class="ident" id="3307665">m</span>&nbsp;<span class="op" id="3307667">*</span><span class="ident" id="3307668">Func</span><span class="op" id="3307672">)</span>&nbsp;<span class="op" id="3307674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307677">old</span>&nbsp;<span class="op" id="3307681">:=</span>&nbsp;<span class="ident" id="3307684">mset</span><span class="op" id="3307688">[</span><span class="ident" id="3307689">m</span><span class="op" id="3307690">.</span><span class="ident" id="3307691">Name</span><span class="op" id="3307695">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307698">if</span>&nbsp;<span class="ident" id="3307701">old</span>&nbsp;<span class="op" id="3307705">==</span>&nbsp;<span class="ident" id="3307708">nil</span>&nbsp;<span class="op" id="3307712">||</span>&nbsp;<span class="ident" id="3307715">m</span><span class="op" id="3307716">.</span><span class="ident" id="3307717">Level</span>&nbsp;<span class="op" id="3307723">&lt;</span>&nbsp;<span class="ident" id="3307725">old</span><span class="op" id="3307728">.</span><span class="ident" id="3307729">Level</span>&nbsp;<span class="op" id="3307735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307739">mset</span><span class="op" id="3307743">[</span><span class="ident" id="3307744">m</span><span class="op" id="3307745">.</span><span class="ident" id="3307746">Name</span><span class="op" id="3307750">]</span>&nbsp;<span class="op" id="3307752">=</span>&nbsp;<span class="ident" id="3307754">m</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307758">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307769">if</span>&nbsp;<span class="ident" id="3307772">old</span>&nbsp;<span class="op" id="3307776">!=</span>&nbsp;<span class="ident" id="3307779">nil</span>&nbsp;<span class="op" id="3307783">&amp;&amp;</span>&nbsp;<span class="ident" id="3307786">m</span><span class="op" id="3307787">.</span><span class="ident" id="3307788">Level</span>&nbsp;<span class="op" id="3307794">==</span>&nbsp;<span class="ident" id="3307797">old</span><span class="op" id="3307800">.</span><span class="ident" id="3307801">Level</span>&nbsp;<span class="op" id="3307807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3307811">//&nbsp;conflict&nbsp;-&nbsp;mark&nbsp;it&nbsp;using&nbsp;a&nbsp;method&nbsp;with&nbsp;nil&nbsp;Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307864">mset</span><span class="op" id="3307868">[</span><span class="ident" id="3307869">m</span><span class="op" id="3307870">.</span><span class="ident" id="3307871">Name</span><span class="op" id="3307875">]</span>&nbsp;<span class="op" id="3307877">=</span>&nbsp;<span class="op" id="3307879">&amp;</span><span class="ident" id="3307880">Func</span><span class="op" id="3307884">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307889">Name</span><span class="op" id="3307893">:</span>&nbsp;&nbsp;<span class="ident" id="3307896">m</span><span class="op" id="3307897">.</span><span class="ident" id="3307898">Name</span><span class="op" id="3307902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307907">Level</span><span class="op" id="3307912">:</span>&nbsp;<span class="ident" id="3307914">m</span><span class="op" id="3307915">.</span><span class="ident" id="3307916">Level</span><span class="op" id="3307921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307928">}</span><br>
<span class="lineno"></span><span class="op" id="3307930">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="3307933">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3308013">//&nbsp;Named&nbsp;types</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3308029">//&nbsp;baseTypeName&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;base&nbsp;type&nbsp;of&nbsp;x&nbsp;(or&nbsp;&#34;&#34;)</span><br>
<span class="lineno">95</span><span class="comment" id="3308092">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;type&nbsp;is&nbsp;imported&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span><span class="comment" id="3308136">//</span><br>
<span class="lineno"></span><span class="keyword" id="3308139">func</span>&nbsp;<span class="ident" id="3308144">baseTypeName</span><span class="op" id="3308156">(</span><span class="ident" id="3308157">x</span>&nbsp;<span class="ident" id="3308159">ast</span><span class="op" id="3308162">.</span><span class="ident" id="3308163">Expr</span><span class="op" id="3308167">)</span>&nbsp;<span class="op" id="3308169">(</span><span class="ident" id="3308170">name</span>&nbsp;<span class="builtintype" id="3308175">string</span><span class="op" id="3308181">,</span>&nbsp;<span class="ident" id="3308183">imported</span>&nbsp;<span class="builtintype" id="3308192">bool</span><span class="op" id="3308196">)</span>&nbsp;<span class="op" id="3308198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308201">switch</span>&nbsp;<span class="ident" id="3308208">t</span>&nbsp;<span class="op" id="3308210">:=</span>&nbsp;<span class="ident" id="3308213">x</span><span class="op" id="3308214">.</span><span class="op" id="3308215">(</span><span class="keyword" id="3308216">type</span><span class="op" id="3308220">)</span>&nbsp;<span class="op" id="3308222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308225">case</span>&nbsp;<span class="op" id="3308230">*</span><span class="ident" id="3308231">ast</span><span class="op" id="3308234">.</span><span class="ident" id="3308235">Ident</span><span class="op" id="3308240">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308244">return</span>&nbsp;<span class="ident" id="3308251">t</span><span class="op" id="3308252">.</span><span class="ident" id="3308253">Name</span><span class="op" id="3308257">,</span>&nbsp;<span class="builtintype" id="3308259">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308266">case</span>&nbsp;<span class="op" id="3308271">*</span><span class="ident" id="3308272">ast</span><span class="op" id="3308275">.</span><span class="ident" id="3308276">SelectorExpr</span><span class="op" id="3308288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308292">if</span>&nbsp;<span class="ident" id="3308295">_</span><span class="op" id="3308296">,</span>&nbsp;<span class="ident" id="3308298">ok</span>&nbsp;<span class="op" id="3308301">:=</span>&nbsp;<span class="ident" id="3308304">t</span><span class="op" id="3308305">.</span><span class="ident" id="3308306">X</span><span class="op" id="3308307">.</span><span class="op" id="3308308">(</span><span class="op" id="3308309">*</span><span class="ident" id="3308310">ast</span><span class="op" id="3308313">.</span><span class="ident" id="3308314">Ident</span><span class="op" id="3308319">)</span><span class="op" id="3308320">;</span>&nbsp;<span class="ident" id="3308322">ok</span>&nbsp;<span class="op" id="3308325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3308330">//&nbsp;only&nbsp;possible&nbsp;for&nbsp;qualified&nbsp;type&nbsp;names;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3308376">//&nbsp;assume&nbsp;type&nbsp;is&nbsp;imported</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308406">return</span>&nbsp;<span class="ident" id="3308413">t</span><span class="op" id="3308414">.</span><span class="ident" id="3308415">Sel</span><span class="op" id="3308418">.</span><span class="ident" id="3308419">Name</span><span class="op" id="3308423">,</span>&nbsp;<span class="builtintype" id="3308425">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308435">case</span>&nbsp;<span class="op" id="3308440">*</span><span class="ident" id="3308441">ast</span><span class="op" id="3308444">.</span><span class="ident" id="3308445">StarExpr</span><span class="op" id="3308453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308457">return</span>&nbsp;<span class="ident" id="3308464">baseTypeName</span><span class="op" id="3308476">(</span><span class="ident" id="3308477">t</span><span class="op" id="3308478">.</span><span class="ident" id="3308479">X</span><span class="op" id="3308480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308483">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308486">return</span><br>
<span class="lineno"></span><span class="op" id="3308493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3308496">//&nbsp;An&nbsp;embeddedSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;embedded&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="3308549">type</span>&nbsp;<span class="ident" id="3308554">embeddedSet</span>&nbsp;<span class="keyword" id="3308566">map</span><span class="op" id="3308569">[</span><span class="op" id="3308570">*</span><span class="ident" id="3308571">namedType</span><span class="op" id="3308580">]</span><span class="builtintype" id="3308581">bool</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3308587">//&nbsp;A&nbsp;namedType&nbsp;represents&nbsp;a&nbsp;named&nbsp;unqualified&nbsp;(package&nbsp;local,&nbsp;or&nbsp;possibly</span><br>
<span class="lineno"></span><span class="comment" id="3308661">//&nbsp;predeclared)&nbsp;type.&nbsp;The&nbsp;namedType&nbsp;for&nbsp;a&nbsp;type&nbsp;name&nbsp;is&nbsp;always&nbsp;found&nbsp;via</span><br>
<span class="lineno"></span><span class="comment" id="3308733">//&nbsp;reader.lookupType.</span><br>
<span class="lineno"></span><span class="comment" id="3308755">//</span><br>
<span class="lineno">120</span><span class="keyword" id="3308758">type</span>&nbsp;<span class="ident" id="3308763">namedType</span>&nbsp;<span class="keyword" id="3308773">struct</span>&nbsp;<span class="op" id="3308780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308783">doc</span>&nbsp;&nbsp;<span class="builtintype" id="3308788">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3308801">//&nbsp;doc&nbsp;comment&nbsp;for&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308826">name</span>&nbsp;<span class="builtintype" id="3308831">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3308844">//&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308858">decl</span>&nbsp;<span class="op" id="3308863">*</span><span class="ident" id="3308864">ast</span><span class="op" id="3308867">.</span><span class="ident" id="3308868">GenDecl</span>&nbsp;<span class="comment" id="3308876">//&nbsp;nil&nbsp;if&nbsp;declaration&nbsp;hasn&#39;t&nbsp;been&nbsp;seen&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308921">isEmbedded</span>&nbsp;<span class="builtintype" id="3308932">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3308944">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308978">isStruct</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3308989">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3309001">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309035">embedded</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3309046">embeddedSet</span>&nbsp;<span class="comment" id="3309058">//&nbsp;true&nbsp;if&nbsp;the&nbsp;embedded&nbsp;type&nbsp;is&nbsp;a&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309102">//&nbsp;associated&nbsp;declarations</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309130">values</span>&nbsp;&nbsp;<span class="op" id="3309138">[</span><span class="op" id="3309139">]</span><span class="op" id="3309140">*</span><span class="ident" id="3309141">Value</span>&nbsp;<span class="comment" id="3309147">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309167">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3309175">methodSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309186">methods</span>&nbsp;<span class="ident" id="3309194">methodSet</span><br>
<span class="lineno"></span><span class="op" id="3309204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3309207">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3309287">//&nbsp;AST&nbsp;reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3309302">//&nbsp;reader&nbsp;accumulates&nbsp;documentation&nbsp;for&nbsp;a&nbsp;single&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="3309360">//&nbsp;It&nbsp;modifies&nbsp;the&nbsp;AST:&nbsp;Comments&nbsp;(declaration&nbsp;documentation)</span><br>
<span class="lineno">140</span><span class="comment" id="3309421">//&nbsp;that&nbsp;have&nbsp;been&nbsp;collected&nbsp;by&nbsp;the&nbsp;reader&nbsp;are&nbsp;set&nbsp;to&nbsp;nil</span><br>
<span class="lineno"></span><span class="comment" id="3309478">//&nbsp;in&nbsp;the&nbsp;respective&nbsp;AST&nbsp;nodes&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;printed</span><br>
<span class="lineno"></span><span class="comment" id="3309538">//&nbsp;twice&nbsp;(once&nbsp;when&nbsp;printing&nbsp;the&nbsp;documentation&nbsp;and&nbsp;once&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="3309599">//&nbsp;printing&nbsp;the&nbsp;corresponding&nbsp;AST&nbsp;node).</span><br>
<span class="lineno"></span><span class="comment" id="3309640">//</span><br>
<span class="lineno">145</span><span class="keyword" id="3309643">type</span>&nbsp;<span class="ident" id="3309648">reader</span>&nbsp;<span class="keyword" id="3309655">struct</span>&nbsp;<span class="op" id="3309662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309665">mode</span>&nbsp;<span class="ident" id="3309670">Mode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309677">//&nbsp;package&nbsp;properties</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309700">doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3309710">string</span>&nbsp;<span class="comment" id="3309717">//&nbsp;package&nbsp;documentation,&nbsp;if&nbsp;any</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309751">filenames</span>&nbsp;<span class="op" id="3309761">[</span><span class="op" id="3309762">]</span><span class="builtintype" id="3309763">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309771">notes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309781">map</span><span class="op" id="3309784">[</span><span class="builtintype" id="3309785">string</span><span class="op" id="3309791">]</span><span class="op" id="3309792">[</span><span class="op" id="3309793">]</span><span class="op" id="3309794">*</span><span class="ident" id="3309795">Note</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309802">//&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309819">imports</span>&nbsp;<span class="keyword" id="3309827">map</span><span class="op" id="3309830">[</span><span class="builtintype" id="3309831">string</span><span class="op" id="3309837">]</span><span class="builtintype" id="3309838">int</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309843">values</span>&nbsp;&nbsp;<span class="op" id="3309851">[</span><span class="op" id="3309852">]</span><span class="op" id="3309853">*</span><span class="ident" id="3309854">Value</span>&nbsp;<span class="comment" id="3309860">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309880">types</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309888">map</span><span class="op" id="3309891">[</span><span class="builtintype" id="3309892">string</span><span class="op" id="3309898">]</span><span class="op" id="3309899">*</span><span class="ident" id="3309900">namedType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309911">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3309919">methodSet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309931">//&nbsp;support&nbsp;for&nbsp;package-local&nbsp;error&nbsp;type&nbsp;declarations</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309985">errorDecl</span>&nbsp;<span class="builtintype" id="3309995">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3310016">//&nbsp;if&nbsp;set,&nbsp;type&nbsp;&#34;error&#34;&nbsp;was&nbsp;declared&nbsp;locally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310062">fixlist</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3310072">[</span><span class="op" id="3310073">]</span><span class="op" id="3310074">*</span><span class="ident" id="3310075">ast</span><span class="op" id="3310078">.</span><span class="ident" id="3310079">InterfaceType</span>&nbsp;<span class="comment" id="3310093">//&nbsp;list&nbsp;of&nbsp;interfaces&nbsp;containing&nbsp;anonymous&nbsp;field&nbsp;&#34;error&#34;</span><br>
<span class="lineno"></span><span class="op" id="3310150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3310153">func</span>&nbsp;<span class="op" id="3310158">(</span><span class="ident" id="3310159">r</span>&nbsp;<span class="op" id="3310161">*</span><span class="ident" id="3310162">reader</span><span class="op" id="3310168">)</span>&nbsp;<span class="ident" id="3310170">isVisible</span><span class="op" id="3310179">(</span><span class="ident" id="3310180">name</span>&nbsp;<span class="builtintype" id="3310185">string</span><span class="op" id="3310191">)</span>&nbsp;<span class="builtintype" id="3310193">bool</span>&nbsp;<span class="op" id="3310198">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310201">return</span>&nbsp;<span class="ident" id="3310208">r</span><span class="op" id="3310209">.</span><span class="ident" id="3310210">mode</span><span class="op" id="3310214">&amp;</span><span class="ident" id="3310215">AllDecls</span>&nbsp;<span class="op" id="3310224">!=</span>&nbsp;<span class="num" id="3310227">0</span>&nbsp;<span class="op" id="3310229">||</span>&nbsp;<span class="ident" id="3310232">ast</span><span class="op" id="3310235">.</span><span class="ident" id="3310236">IsExported</span><span class="op" id="3310246">(</span><span class="ident" id="3310247">name</span><span class="op" id="3310251">)</span><br>
<span class="lineno"></span><span class="op" id="3310253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3310256">//&nbsp;lookupType&nbsp;returns&nbsp;the&nbsp;base&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3310313">//&nbsp;If&nbsp;the&nbsp;base&nbsp;type&nbsp;has&nbsp;not&nbsp;been&nbsp;encountered&nbsp;yet,&nbsp;a&nbsp;new</span><br>
<span class="lineno">170</span><span class="comment" id="3310369">//&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;but&nbsp;no&nbsp;associated&nbsp;declaration</span><br>
<span class="lineno"></span><span class="comment" id="3310427">//&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;type&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="3310456">//</span><br>
<span class="lineno"></span><span class="keyword" id="3310459">func</span>&nbsp;<span class="op" id="3310464">(</span><span class="ident" id="3310465">r</span>&nbsp;<span class="op" id="3310467">*</span><span class="ident" id="3310468">reader</span><span class="op" id="3310474">)</span>&nbsp;<span class="ident" id="3310476">lookupType</span><span class="op" id="3310486">(</span><span class="ident" id="3310487">name</span>&nbsp;<span class="builtintype" id="3310492">string</span><span class="op" id="3310498">)</span>&nbsp;<span class="op" id="3310500">*</span><span class="ident" id="3310501">namedType</span>&nbsp;<span class="op" id="3310511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310514">if</span>&nbsp;<span class="ident" id="3310517">name</span>&nbsp;<span class="op" id="3310522">==</span>&nbsp;<span class="string" id="3310525">&#34;&#34;</span>&nbsp;<span class="op" id="3310528">||</span>&nbsp;<span class="ident" id="3310531">name</span>&nbsp;<span class="op" id="3310536">==</span>&nbsp;<span class="string" id="3310539">&#34;_&#34;</span>&nbsp;<span class="op" id="3310543">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310547">return</span>&nbsp;<span class="ident" id="3310554">nil</span>&nbsp;<span class="comment" id="3310558">//&nbsp;no&nbsp;type&nbsp;docs&nbsp;for&nbsp;anonymous&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310598">if</span>&nbsp;<span class="ident" id="3310601">typ</span><span class="op" id="3310604">,</span>&nbsp;<span class="ident" id="3310606">found</span>&nbsp;<span class="op" id="3310612">:=</span>&nbsp;<span class="ident" id="3310615">r</span><span class="op" id="3310616">.</span><span class="ident" id="3310617">types</span><span class="op" id="3310622">[</span><span class="ident" id="3310623">name</span><span class="op" id="3310627">]</span><span class="op" id="3310628">;</span>&nbsp;<span class="ident" id="3310630">found</span>&nbsp;<span class="op" id="3310636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310640">return</span>&nbsp;<span class="ident" id="3310647">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310652">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3310655">//&nbsp;type&nbsp;not&nbsp;found&nbsp;-&nbsp;add&nbsp;one&nbsp;without&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310704">typ</span>&nbsp;<span class="op" id="3310708">:=</span>&nbsp;<span class="op" id="3310711">&amp;</span><span class="ident" id="3310712">namedType</span><span class="op" id="3310721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310725">name</span><span class="op" id="3310729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310735">name</span><span class="op" id="3310739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310743">embedded</span><span class="op" id="3310751">:</span>&nbsp;<span class="builtinfunc" id="3310753">make</span><span class="op" id="3310757">(</span><span class="ident" id="3310758">embeddedSet</span><span class="op" id="3310769">)</span><span class="op" id="3310770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310774">funcs</span><span class="op" id="3310779">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3310784">make</span><span class="op" id="3310788">(</span><span class="ident" id="3310789">methodSet</span><span class="op" id="3310798">)</span><span class="op" id="3310799">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310803">methods</span><span class="op" id="3310810">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="3310813">make</span><span class="op" id="3310817">(</span><span class="ident" id="3310818">methodSet</span><span class="op" id="3310827">)</span><span class="op" id="3310828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310834">r</span><span class="op" id="3310835">.</span><span class="ident" id="3310836">types</span><span class="op" id="3310841">[</span><span class="ident" id="3310842">name</span><span class="op" id="3310846">]</span>&nbsp;<span class="op" id="3310848">=</span>&nbsp;<span class="ident" id="3310850">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310855">return</span>&nbsp;<span class="ident" id="3310862">typ</span><br>
<span class="lineno"></span><span class="op" id="3310866">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3310869">//&nbsp;recordAnonymousField&nbsp;registers&nbsp;fieldType&nbsp;as&nbsp;the&nbsp;type&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3310931">//&nbsp;anonymous&nbsp;field&nbsp;in&nbsp;the&nbsp;parent&nbsp;type.&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="3310995">//&nbsp;(qualified&nbsp;name)&nbsp;or&nbsp;the&nbsp;parent&nbsp;is&nbsp;nil,&nbsp;the&nbsp;field&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3311059">//&nbsp;The&nbsp;function&nbsp;returns&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">195</span><span class="comment" id="3311099">//</span><br>
<span class="lineno"></span><span class="keyword" id="3311102">func</span>&nbsp;<span class="op" id="3311107">(</span><span class="ident" id="3311108">r</span>&nbsp;<span class="op" id="3311110">*</span><span class="ident" id="3311111">reader</span><span class="op" id="3311117">)</span>&nbsp;<span class="ident" id="3311119">recordAnonymousField</span><span class="op" id="3311139">(</span><span class="ident" id="3311140">parent</span>&nbsp;<span class="op" id="3311147">*</span><span class="ident" id="3311148">namedType</span><span class="op" id="3311157">,</span>&nbsp;<span class="ident" id="3311159">fieldType</span>&nbsp;<span class="ident" id="3311169">ast</span><span class="op" id="3311172">.</span><span class="ident" id="3311173">Expr</span><span class="op" id="3311177">)</span>&nbsp;<span class="op" id="3311179">(</span><span class="ident" id="3311180">fname</span>&nbsp;<span class="builtintype" id="3311186">string</span><span class="op" id="3311192">)</span>&nbsp;<span class="op" id="3311194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311197">fname</span><span class="op" id="3311202">,</span>&nbsp;<span class="ident" id="3311204">imp</span>&nbsp;<span class="op" id="3311208">:=</span>&nbsp;<span class="ident" id="3311211">baseTypeName</span><span class="op" id="3311223">(</span><span class="ident" id="3311224">fieldType</span><span class="op" id="3311233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311236">if</span>&nbsp;<span class="ident" id="3311239">parent</span>&nbsp;<span class="op" id="3311246">==</span>&nbsp;<span class="ident" id="3311249">nil</span>&nbsp;<span class="op" id="3311253">||</span>&nbsp;<span class="ident" id="3311256">imp</span>&nbsp;<span class="op" id="3311260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311264">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3311272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311275">if</span>&nbsp;<span class="ident" id="3311278">ftype</span>&nbsp;<span class="op" id="3311284">:=</span>&nbsp;<span class="ident" id="3311287">r</span><span class="op" id="3311288">.</span><span class="ident" id="3311289">lookupType</span><span class="op" id="3311299">(</span><span class="ident" id="3311300">fname</span><span class="op" id="3311305">)</span><span class="op" id="3311306">;</span>&nbsp;<span class="ident" id="3311308">ftype</span>&nbsp;<span class="op" id="3311314">!=</span>&nbsp;<span class="ident" id="3311317">nil</span>&nbsp;<span class="op" id="3311321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311325">ftype</span><span class="op" id="3311330">.</span><span class="ident" id="3311331">isEmbedded</span>&nbsp;<span class="op" id="3311342">=</span>&nbsp;<span class="builtintype" id="3311344">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311351">_</span><span class="op" id="3311352">,</span>&nbsp;<span class="ident" id="3311354">ptr</span>&nbsp;<span class="op" id="3311358">:=</span>&nbsp;<span class="ident" id="3311361">fieldType</span><span class="op" id="3311370">.</span><span class="op" id="3311371">(</span><span class="op" id="3311372">*</span><span class="ident" id="3311373">ast</span><span class="op" id="3311376">.</span><span class="ident" id="3311377">StarExpr</span><span class="op" id="3311385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311389">parent</span><span class="op" id="3311395">.</span><span class="ident" id="3311396">embedded</span><span class="op" id="3311404">[</span><span class="ident" id="3311405">ftype</span><span class="op" id="3311410">]</span>&nbsp;<span class="op" id="3311412">=</span>&nbsp;<span class="ident" id="3311414">ptr</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3311419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311422">return</span><br>
<span class="lineno"></span><span class="op" id="3311429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311432">func</span>&nbsp;<span class="op" id="3311437">(</span><span class="ident" id="3311438">r</span>&nbsp;<span class="op" id="3311440">*</span><span class="ident" id="3311441">reader</span><span class="op" id="3311447">)</span>&nbsp;<span class="ident" id="3311449">readDoc</span><span class="op" id="3311456">(</span><span class="ident" id="3311457">comment</span>&nbsp;<span class="op" id="3311465">*</span><span class="ident" id="3311466">ast</span><span class="op" id="3311469">.</span><span class="ident" id="3311470">CommentGroup</span><span class="op" id="3311482">)</span>&nbsp;<span class="op" id="3311484">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311487">//&nbsp;By&nbsp;convention&nbsp;there&nbsp;should&nbsp;be&nbsp;only&nbsp;one&nbsp;package&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311546">//&nbsp;but&nbsp;collect&nbsp;all&nbsp;of&nbsp;them&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;then&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311602">text</span>&nbsp;<span class="op" id="3311607">:=</span>&nbsp;<span class="ident" id="3311610">comment</span><span class="op" id="3311617">.</span><span class="ident" id="3311618">Text</span><span class="op" id="3311622">(</span><span class="op" id="3311623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311626">if</span>&nbsp;<span class="ident" id="3311629">r</span><span class="op" id="3311630">.</span><span class="ident" id="3311631">doc</span>&nbsp;<span class="op" id="3311635">==</span>&nbsp;<span class="string" id="3311638">&#34;&#34;</span>&nbsp;<span class="op" id="3311641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311645">r</span><span class="op" id="3311646">.</span><span class="ident" id="3311647">doc</span>&nbsp;<span class="op" id="3311651">=</span>&nbsp;<span class="ident" id="3311653">text</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311660">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3311668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311671">r</span><span class="op" id="3311672">.</span><span class="ident" id="3311673">doc</span>&nbsp;<span class="op" id="3311677">+=</span>&nbsp;<span class="string" id="3311680">&#34;\n&#34;</span>&nbsp;<span class="op" id="3311685">+</span>&nbsp;<span class="ident" id="3311687">text</span><br>
<span class="lineno"></span><span class="op" id="3311692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3311695">func</span>&nbsp;<span class="op" id="3311700">(</span><span class="ident" id="3311701">r</span>&nbsp;<span class="op" id="3311703">*</span><span class="ident" id="3311704">reader</span><span class="op" id="3311710">)</span>&nbsp;<span class="ident" id="3311712">remember</span><span class="op" id="3311720">(</span><span class="ident" id="3311721">typ</span>&nbsp;<span class="op" id="3311725">*</span><span class="ident" id="3311726">ast</span><span class="op" id="3311729">.</span><span class="ident" id="3311730">InterfaceType</span><span class="op" id="3311743">)</span>&nbsp;<span class="op" id="3311745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311748">r</span><span class="op" id="3311749">.</span><span class="ident" id="3311750">fixlist</span>&nbsp;<span class="op" id="3311758">=</span>&nbsp;<span class="builtinfunc" id="3311760">append</span><span class="op" id="3311766">(</span><span class="ident" id="3311767">r</span><span class="op" id="3311768">.</span><span class="ident" id="3311769">fixlist</span><span class="op" id="3311776">,</span>&nbsp;<span class="ident" id="3311778">typ</span><span class="op" id="3311781">)</span><br>
<span class="lineno"></span><span class="op" id="3311783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311786">func</span>&nbsp;<span class="ident" id="3311791">specNames</span><span class="op" id="3311800">(</span><span class="ident" id="3311801">specs</span>&nbsp;<span class="op" id="3311807">[</span><span class="op" id="3311808">]</span><span class="ident" id="3311809">ast</span><span class="op" id="3311812">.</span><span class="ident" id="3311813">Spec</span><span class="op" id="3311817">)</span>&nbsp;<span class="op" id="3311819">[</span><span class="op" id="3311820">]</span><span class="builtintype" id="3311821">string</span>&nbsp;<span class="op" id="3311828">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311831">names</span>&nbsp;<span class="op" id="3311837">:=</span>&nbsp;<span class="builtinfunc" id="3311840">make</span><span class="op" id="3311844">(</span><span class="op" id="3311845">[</span><span class="op" id="3311846">]</span><span class="builtintype" id="3311847">string</span><span class="op" id="3311853">,</span>&nbsp;<span class="num" id="3311855">0</span><span class="op" id="3311856">,</span>&nbsp;<span class="builtinfunc" id="3311858">len</span><span class="op" id="3311861">(</span><span class="ident" id="3311862">specs</span><span class="op" id="3311867">)</span><span class="op" id="3311868">)</span>&nbsp;<span class="comment" id="3311870">//&nbsp;reasonable&nbsp;estimate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311894">for</span>&nbsp;<span class="ident" id="3311898">_</span><span class="op" id="3311899">,</span>&nbsp;<span class="ident" id="3311901">s</span>&nbsp;<span class="op" id="3311903">:=</span>&nbsp;<span class="keyword" id="3311906">range</span>&nbsp;<span class="ident" id="3311912">specs</span>&nbsp;<span class="op" id="3311918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311922">//&nbsp;s&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;an&nbsp;*ast.ValueSpec&nbsp;by&nbsp;readValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311977">for</span>&nbsp;<span class="ident" id="3311981">_</span><span class="op" id="3311982">,</span>&nbsp;<span class="ident" id="3311984">ident</span>&nbsp;<span class="op" id="3311990">:=</span>&nbsp;<span class="keyword" id="3311993">range</span>&nbsp;<span class="ident" id="3311999">s</span><span class="op" id="3312000">.</span><span class="op" id="3312001">(</span><span class="op" id="3312002">*</span><span class="ident" id="3312003">ast</span><span class="op" id="3312006">.</span><span class="ident" id="3312007">ValueSpec</span><span class="op" id="3312016">)</span><span class="op" id="3312017">.</span><span class="ident" id="3312018">Names</span>&nbsp;<span class="op" id="3312024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312029">names</span>&nbsp;<span class="op" id="3312035">=</span>&nbsp;<span class="builtinfunc" id="3312037">append</span><span class="op" id="3312043">(</span><span class="ident" id="3312044">names</span><span class="op" id="3312049">,</span>&nbsp;<span class="ident" id="3312051">ident</span><span class="op" id="3312056">.</span><span class="ident" id="3312057">Name</span><span class="op" id="3312061">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312071">return</span>&nbsp;<span class="ident" id="3312078">names</span><br>
<span class="lineno"></span><span class="op" id="3312084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="3312087">//&nbsp;readValue&nbsp;processes&nbsp;a&nbsp;const&nbsp;or&nbsp;var&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="3312138">//</span><br>
<span class="lineno"></span><span class="keyword" id="3312141">func</span>&nbsp;<span class="op" id="3312146">(</span><span class="ident" id="3312147">r</span>&nbsp;<span class="op" id="3312149">*</span><span class="ident" id="3312150">reader</span><span class="op" id="3312156">)</span>&nbsp;<span class="ident" id="3312158">readValue</span><span class="op" id="3312167">(</span><span class="ident" id="3312168">decl</span>&nbsp;<span class="op" id="3312173">*</span><span class="ident" id="3312174">ast</span><span class="op" id="3312177">.</span><span class="ident" id="3312178">GenDecl</span><span class="op" id="3312185">)</span>&nbsp;<span class="op" id="3312187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312190">//&nbsp;determine&nbsp;if&nbsp;decl&nbsp;should&nbsp;be&nbsp;associated&nbsp;with&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312245">//&nbsp;Heuristic:&nbsp;For&nbsp;each&nbsp;typed&nbsp;entry,&nbsp;determine&nbsp;the&nbsp;type&nbsp;name,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312315">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;exactly&nbsp;one&nbsp;type&nbsp;name&nbsp;that&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312385">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequent,&nbsp;associate&nbsp;the&nbsp;decl&nbsp;with&nbsp;the&nbsp;respective&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312455">domName</span>&nbsp;<span class="op" id="3312463">:=</span>&nbsp;<span class="string" id="3312466">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312470">domFreq</span>&nbsp;<span class="op" id="3312478">:=</span>&nbsp;<span class="num" id="3312481">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312484">prev</span>&nbsp;<span class="op" id="3312489">:=</span>&nbsp;<span class="string" id="3312492">&#34;&#34;</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312496">n</span>&nbsp;<span class="op" id="3312498">:=</span>&nbsp;<span class="num" id="3312501">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312504">for</span>&nbsp;<span class="ident" id="3312508">_</span><span class="op" id="3312509">,</span>&nbsp;<span class="ident" id="3312511">spec</span>&nbsp;<span class="op" id="3312516">:=</span>&nbsp;<span class="keyword" id="3312519">range</span>&nbsp;<span class="ident" id="3312525">decl</span><span class="op" id="3312529">.</span><span class="ident" id="3312530">Specs</span>&nbsp;<span class="op" id="3312536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312540">s</span><span class="op" id="3312541">,</span>&nbsp;<span class="ident" id="3312543">ok</span>&nbsp;<span class="op" id="3312546">:=</span>&nbsp;<span class="ident" id="3312549">spec</span><span class="op" id="3312553">.</span><span class="op" id="3312554">(</span><span class="op" id="3312555">*</span><span class="ident" id="3312556">ast</span><span class="op" id="3312559">.</span><span class="ident" id="3312560">ValueSpec</span><span class="op" id="3312569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312573">if</span>&nbsp;<span class="op" id="3312576">!</span><span class="ident" id="3312577">ok</span>&nbsp;<span class="op" id="3312580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312585">continue</span>&nbsp;<span class="comment" id="3312594">//&nbsp;should&nbsp;not&nbsp;happen,&nbsp;but&nbsp;be&nbsp;conservative</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312642">name</span>&nbsp;<span class="op" id="3312647">:=</span>&nbsp;<span class="string" id="3312650">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312655">switch</span>&nbsp;<span class="op" id="3312662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312666">case</span>&nbsp;<span class="ident" id="3312671">s</span><span class="op" id="3312672">.</span><span class="ident" id="3312673">Type</span>&nbsp;<span class="op" id="3312678">!=</span>&nbsp;<span class="ident" id="3312681">nil</span><span class="op" id="3312684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312689">//&nbsp;a&nbsp;type&nbsp;is&nbsp;present;&nbsp;determine&nbsp;its&nbsp;name</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312733">if</span>&nbsp;<span class="ident" id="3312736">n</span><span class="op" id="3312737">,</span>&nbsp;<span class="ident" id="3312739">imp</span>&nbsp;<span class="op" id="3312743">:=</span>&nbsp;<span class="ident" id="3312746">baseTypeName</span><span class="op" id="3312758">(</span><span class="ident" id="3312759">s</span><span class="op" id="3312760">.</span><span class="ident" id="3312761">Type</span><span class="op" id="3312765">)</span><span class="op" id="3312766">;</span>&nbsp;<span class="op" id="3312768">!</span><span class="ident" id="3312769">imp</span>&nbsp;<span class="op" id="3312773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312779">name</span>&nbsp;<span class="op" id="3312784">=</span>&nbsp;<span class="ident" id="3312786">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312795">case</span>&nbsp;<span class="ident" id="3312800">decl</span><span class="op" id="3312804">.</span><span class="ident" id="3312805">Tok</span>&nbsp;<span class="op" id="3312809">==</span>&nbsp;<span class="ident" id="3312812">token</span><span class="op" id="3312817">.</span><span class="ident" id="3312818">CONST</span><span class="op" id="3312823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312828">//&nbsp;no&nbsp;type&nbsp;is&nbsp;present&nbsp;but&nbsp;we&nbsp;have&nbsp;a&nbsp;constant&nbsp;declaration;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312889">//&nbsp;use&nbsp;the&nbsp;previous&nbsp;type&nbsp;name&nbsp;(w/o&nbsp;more&nbsp;type&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312949">//&nbsp;we&nbsp;cannot&nbsp;handle&nbsp;the&nbsp;case&nbsp;of&nbsp;unnamed&nbsp;variables&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313007">//&nbsp;initializer&nbsp;expressions&nbsp;except&nbsp;for&nbsp;some&nbsp;trivial&nbsp;cases)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313068">name</span>&nbsp;<span class="op" id="3313073">=</span>&nbsp;<span class="ident" id="3313075">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313082">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313086">if</span>&nbsp;<span class="ident" id="3313089">name</span>&nbsp;<span class="op" id="3313094">!=</span>&nbsp;<span class="string" id="3313097">&#34;&#34;</span>&nbsp;<span class="op" id="3313100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313105">//&nbsp;entry&nbsp;has&nbsp;a&nbsp;named&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313134">if</span>&nbsp;<span class="ident" id="3313137">domName</span>&nbsp;<span class="op" id="3313145">!=</span>&nbsp;<span class="string" id="3313148">&#34;&#34;</span>&nbsp;<span class="op" id="3313151">&amp;&amp;</span>&nbsp;<span class="ident" id="3313154">domName</span>&nbsp;<span class="op" id="3313162">!=</span>&nbsp;<span class="ident" id="3313165">name</span>&nbsp;<span class="op" id="3313170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313176">//&nbsp;more&nbsp;than&nbsp;one&nbsp;type&nbsp;name&nbsp;-&nbsp;do&nbsp;not&nbsp;associate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313226">//&nbsp;with&nbsp;any&nbsp;type</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313247">domName</span>&nbsp;<span class="op" id="3313255">=</span>&nbsp;<span class="string" id="3313257">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313264">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313278">domName</span>&nbsp;<span class="op" id="3313286">=</span>&nbsp;<span class="ident" id="3313288">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313296">domFreq</span><span class="op" id="3313303">++</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313312">prev</span>&nbsp;<span class="op" id="3313317">=</span>&nbsp;<span class="ident" id="3313319">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313326">n</span><span class="op" id="3313327">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313335">//&nbsp;nothing&nbsp;to&nbsp;do&nbsp;w/o&nbsp;a&nbsp;legal&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313377">if</span>&nbsp;<span class="ident" id="3313380">n</span>&nbsp;<span class="op" id="3313382">==</span>&nbsp;<span class="num" id="3313385">0</span>&nbsp;<span class="op" id="3313387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313391">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313403">//&nbsp;determine&nbsp;values&nbsp;list&nbsp;with&nbsp;which&nbsp;to&nbsp;associate&nbsp;the&nbsp;Value&nbsp;for&nbsp;this&nbsp;decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313477">values</span>&nbsp;<span class="op" id="3313484">:=</span>&nbsp;<span class="op" id="3313487">&amp;</span><span class="ident" id="3313488">r</span><span class="op" id="3313489">.</span><span class="ident" id="3313490">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313498">const</span>&nbsp;<span class="ident" id="3313504">threshold</span>&nbsp;<span class="op" id="3313514">=</span>&nbsp;<span class="num" id="3313516">0.75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313522">if</span>&nbsp;<span class="ident" id="3313525">domName</span>&nbsp;<span class="op" id="3313533">!=</span>&nbsp;<span class="string" id="3313536">&#34;&#34;</span>&nbsp;<span class="op" id="3313539">&amp;&amp;</span>&nbsp;<span class="ident" id="3313542">r</span><span class="op" id="3313543">.</span><span class="ident" id="3313544">isVisible</span><span class="op" id="3313553">(</span><span class="ident" id="3313554">domName</span><span class="op" id="3313561">)</span>&nbsp;<span class="op" id="3313563">&amp;&amp;</span>&nbsp;<span class="ident" id="3313566">domFreq</span>&nbsp;<span class="op" id="3313574">&gt;=</span>&nbsp;<span class="builtintype" id="3313577">int</span><span class="op" id="3313580">(</span><span class="builtintype" id="3313581">float64</span><span class="op" id="3313588">(</span><span class="builtinfunc" id="3313589">len</span><span class="op" id="3313592">(</span><span class="ident" id="3313593">decl</span><span class="op" id="3313597">.</span><span class="ident" id="3313598">Specs</span><span class="op" id="3313603">)</span><span class="op" id="3313604">)</span><span class="op" id="3313605">*</span><span class="ident" id="3313606">threshold</span><span class="op" id="3313615">)</span>&nbsp;<span class="op" id="3313617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313621">//&nbsp;typed&nbsp;entries&nbsp;are&nbsp;sufficiently&nbsp;frequent</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313666">if</span>&nbsp;<span class="ident" id="3313669">typ</span>&nbsp;<span class="op" id="3313673">:=</span>&nbsp;<span class="ident" id="3313676">r</span><span class="op" id="3313677">.</span><span class="ident" id="3313678">lookupType</span><span class="op" id="3313688">(</span><span class="ident" id="3313689">domName</span><span class="op" id="3313696">)</span><span class="op" id="3313697">;</span>&nbsp;<span class="ident" id="3313699">typ</span>&nbsp;<span class="op" id="3313703">!=</span>&nbsp;<span class="ident" id="3313706">nil</span>&nbsp;<span class="op" id="3313710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313715">values</span>&nbsp;<span class="op" id="3313722">=</span>&nbsp;<span class="op" id="3313724">&amp;</span><span class="ident" id="3313725">typ</span><span class="op" id="3313728">.</span><span class="ident" id="3313729">values</span>&nbsp;<span class="comment" id="3313736">//&nbsp;associate&nbsp;with&nbsp;that&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313773">*</span><span class="ident" id="3313774">values</span>&nbsp;<span class="op" id="3313781">=</span>&nbsp;<span class="builtinfunc" id="3313783">append</span><span class="op" id="3313789">(</span><span class="op" id="3313790">*</span><span class="ident" id="3313791">values</span><span class="op" id="3313797">,</span>&nbsp;<span class="op" id="3313799">&amp;</span><span class="ident" id="3313800">Value</span><span class="op" id="3313805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313809">Doc</span><span class="op" id="3313812">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3313816">decl</span><span class="op" id="3313820">.</span><span class="ident" id="3313821">Doc</span><span class="op" id="3313824">.</span><span class="ident" id="3313825">Text</span><span class="op" id="3313829">(</span><span class="op" id="3313830">)</span><span class="op" id="3313831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313835">Names</span><span class="op" id="3313840">:</span>&nbsp;<span class="ident" id="3313842">specNames</span><span class="op" id="3313851">(</span><span class="ident" id="3313852">decl</span><span class="op" id="3313856">.</span><span class="ident" id="3313857">Specs</span><span class="op" id="3313862">)</span><span class="op" id="3313863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313867">Decl</span><span class="op" id="3313871">:</span>&nbsp;&nbsp;<span class="ident" id="3313874">decl</span><span class="op" id="3313878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313882">order</span><span class="op" id="3313887">:</span>&nbsp;<span class="builtinfunc" id="3313889">len</span><span class="op" id="3313892">(</span><span class="op" id="3313893">*</span><span class="ident" id="3313894">values</span><span class="op" id="3313900">)</span><span class="op" id="3313901">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313904">}</span><span class="op" id="3313905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313908">decl</span><span class="op" id="3313912">.</span><span class="ident" id="3313913">Doc</span>&nbsp;<span class="op" id="3313917">=</span>&nbsp;<span class="ident" id="3313919">nil</span>&nbsp;<span class="comment" id="3313923">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="3313957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3313960">//&nbsp;fields&nbsp;returns&nbsp;a&nbsp;struct&#39;s&nbsp;fields&nbsp;or&nbsp;an&nbsp;interface&#39;s&nbsp;methods.</span><br>
<span class="lineno">305</span><span class="comment" id="3314023">//</span><br>
<span class="lineno"></span><span class="keyword" id="3314026">func</span>&nbsp;<span class="ident" id="3314031">fields</span><span class="op" id="3314037">(</span><span class="ident" id="3314038">typ</span>&nbsp;<span class="ident" id="3314042">ast</span><span class="op" id="3314045">.</span><span class="ident" id="3314046">Expr</span><span class="op" id="3314050">)</span>&nbsp;<span class="op" id="3314052">(</span><span class="ident" id="3314053">list</span>&nbsp;<span class="op" id="3314058">[</span><span class="op" id="3314059">]</span><span class="op" id="3314060">*</span><span class="ident" id="3314061">ast</span><span class="op" id="3314064">.</span><span class="ident" id="3314065">Field</span><span class="op" id="3314070">,</span>&nbsp;<span class="ident" id="3314072">isStruct</span>&nbsp;<span class="builtintype" id="3314081">bool</span><span class="op" id="3314085">)</span>&nbsp;<span class="op" id="3314087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314090">var</span>&nbsp;<span class="ident" id="3314094">fields</span>&nbsp;<span class="op" id="3314101">*</span><span class="ident" id="3314102">ast</span><span class="op" id="3314105">.</span><span class="ident" id="3314106">FieldList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314117">switch</span>&nbsp;<span class="ident" id="3314124">t</span>&nbsp;<span class="op" id="3314126">:=</span>&nbsp;<span class="ident" id="3314129">typ</span><span class="op" id="3314132">.</span><span class="op" id="3314133">(</span><span class="keyword" id="3314134">type</span><span class="op" id="3314138">)</span>&nbsp;<span class="op" id="3314140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314143">case</span>&nbsp;<span class="op" id="3314148">*</span><span class="ident" id="3314149">ast</span><span class="op" id="3314152">.</span><span class="ident" id="3314153">StructType</span><span class="op" id="3314163">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314167">fields</span>&nbsp;<span class="op" id="3314174">=</span>&nbsp;<span class="ident" id="3314176">t</span><span class="op" id="3314177">.</span><span class="ident" id="3314178">Fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314187">isStruct</span>&nbsp;<span class="op" id="3314196">=</span>&nbsp;<span class="builtintype" id="3314198">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314204">case</span>&nbsp;<span class="op" id="3314209">*</span><span class="ident" id="3314210">ast</span><span class="op" id="3314213">.</span><span class="ident" id="3314214">InterfaceType</span><span class="op" id="3314227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314231">fields</span>&nbsp;<span class="op" id="3314238">=</span>&nbsp;<span class="ident" id="3314240">t</span><span class="op" id="3314241">.</span><span class="ident" id="3314242">Methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314251">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314254">if</span>&nbsp;<span class="ident" id="3314257">fields</span>&nbsp;<span class="op" id="3314264">!=</span>&nbsp;<span class="ident" id="3314267">nil</span>&nbsp;<span class="op" id="3314271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314275">list</span>&nbsp;<span class="op" id="3314280">=</span>&nbsp;<span class="ident" id="3314282">fields</span><span class="op" id="3314288">.</span><span class="ident" id="3314289">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314298">return</span><br>
<span class="lineno"></span><span class="op" id="3314305">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="3314308">//&nbsp;readType&nbsp;processes&nbsp;a&nbsp;type&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="3314350">//</span><br>
<span class="lineno"></span><span class="keyword" id="3314353">func</span>&nbsp;<span class="op" id="3314358">(</span><span class="ident" id="3314359">r</span>&nbsp;<span class="op" id="3314361">*</span><span class="ident" id="3314362">reader</span><span class="op" id="3314368">)</span>&nbsp;<span class="ident" id="3314370">readType</span><span class="op" id="3314378">(</span><span class="ident" id="3314379">decl</span>&nbsp;<span class="op" id="3314384">*</span><span class="ident" id="3314385">ast</span><span class="op" id="3314388">.</span><span class="ident" id="3314389">GenDecl</span><span class="op" id="3314396">,</span>&nbsp;<span class="ident" id="3314398">spec</span>&nbsp;<span class="op" id="3314403">*</span><span class="ident" id="3314404">ast</span><span class="op" id="3314407">.</span><span class="ident" id="3314408">TypeSpec</span><span class="op" id="3314416">)</span>&nbsp;<span class="op" id="3314418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314421">typ</span>&nbsp;<span class="op" id="3314425">:=</span>&nbsp;<span class="ident" id="3314428">r</span><span class="op" id="3314429">.</span><span class="ident" id="3314430">lookupType</span><span class="op" id="3314440">(</span><span class="ident" id="3314441">spec</span><span class="op" id="3314445">.</span><span class="ident" id="3314446">Name</span><span class="op" id="3314450">.</span><span class="ident" id="3314451">Name</span><span class="op" id="3314455">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314458">if</span>&nbsp;<span class="ident" id="3314461">typ</span>&nbsp;<span class="op" id="3314465">==</span>&nbsp;<span class="ident" id="3314468">nil</span>&nbsp;<span class="op" id="3314472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314476">return</span>&nbsp;<span class="comment" id="3314483">//&nbsp;no&nbsp;name&nbsp;or&nbsp;blank&nbsp;name&nbsp;-&nbsp;ignore&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314531">//&nbsp;A&nbsp;type&nbsp;should&nbsp;be&nbsp;added&nbsp;at&nbsp;most&nbsp;once,&nbsp;so&nbsp;typ.decl</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314584">//&nbsp;should&nbsp;be&nbsp;nil&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;not,&nbsp;simply&nbsp;overwrite&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314639">typ</span><span class="op" id="3314642">.</span><span class="ident" id="3314643">decl</span>&nbsp;<span class="op" id="3314648">=</span>&nbsp;<span class="ident" id="3314650">decl</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314657">//&nbsp;compute&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314683">doc</span>&nbsp;<span class="op" id="3314687">:=</span>&nbsp;<span class="ident" id="3314690">spec</span><span class="op" id="3314694">.</span><span class="ident" id="3314695">Doc</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314700">spec</span><span class="op" id="3314704">.</span><span class="ident" id="3314705">Doc</span>&nbsp;<span class="op" id="3314709">=</span>&nbsp;<span class="ident" id="3314711">nil</span>&nbsp;<span class="comment" id="3314715">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314750">if</span>&nbsp;<span class="ident" id="3314753">doc</span>&nbsp;<span class="op" id="3314757">==</span>&nbsp;<span class="ident" id="3314760">nil</span>&nbsp;<span class="op" id="3314764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314768">//&nbsp;no&nbsp;doc&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec,&nbsp;use&nbsp;the&nbsp;declaration&nbsp;doc,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314838">doc</span>&nbsp;<span class="op" id="3314842">=</span>&nbsp;<span class="ident" id="3314844">decl</span><span class="op" id="3314848">.</span><span class="ident" id="3314849">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314854">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314857">decl</span><span class="op" id="3314861">.</span><span class="ident" id="3314862">Doc</span>&nbsp;<span class="op" id="3314866">=</span>&nbsp;<span class="ident" id="3314868">nil</span>&nbsp;<span class="comment" id="3314872">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314907">typ</span><span class="op" id="3314910">.</span><span class="ident" id="3314911">doc</span>&nbsp;<span class="op" id="3314915">=</span>&nbsp;<span class="ident" id="3314917">doc</span><span class="op" id="3314920">.</span><span class="ident" id="3314921">Text</span><span class="op" id="3314925">(</span><span class="op" id="3314926">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314930">//&nbsp;record&nbsp;anonymous&nbsp;fields&nbsp;(they&nbsp;may&nbsp;contribute&nbsp;methods)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314988">//&nbsp;(some&nbsp;fields&nbsp;may&nbsp;have&nbsp;been&nbsp;recorded&nbsp;already&nbsp;when&nbsp;filtering</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315051">//&nbsp;exports,&nbsp;but&nbsp;that&#39;s&nbsp;ok)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315079">var</span>&nbsp;<span class="ident" id="3315083">list</span>&nbsp;<span class="op" id="3315088">[</span><span class="op" id="3315089">]</span><span class="op" id="3315090">*</span><span class="ident" id="3315091">ast</span><span class="op" id="3315094">.</span><span class="ident" id="3315095">Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315102">list</span><span class="op" id="3315106">,</span>&nbsp;<span class="ident" id="3315108">typ</span><span class="op" id="3315111">.</span><span class="ident" id="3315112">isStruct</span>&nbsp;<span class="op" id="3315121">=</span>&nbsp;<span class="ident" id="3315123">fields</span><span class="op" id="3315129">(</span><span class="ident" id="3315130">spec</span><span class="op" id="3315134">.</span><span class="ident" id="3315135">Type</span><span class="op" id="3315139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315142">for</span>&nbsp;<span class="ident" id="3315146">_</span><span class="op" id="3315147">,</span>&nbsp;<span class="ident" id="3315149">field</span>&nbsp;<span class="op" id="3315155">:=</span>&nbsp;<span class="keyword" id="3315158">range</span>&nbsp;<span class="ident" id="3315164">list</span>&nbsp;<span class="op" id="3315169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315173">if</span>&nbsp;<span class="builtinfunc" id="3315176">len</span><span class="op" id="3315179">(</span><span class="ident" id="3315180">field</span><span class="op" id="3315185">.</span><span class="ident" id="3315186">Names</span><span class="op" id="3315191">)</span>&nbsp;<span class="op" id="3315193">==</span>&nbsp;<span class="num" id="3315196">0</span>&nbsp;<span class="op" id="3315198">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315203">r</span><span class="op" id="3315204">.</span><span class="ident" id="3315205">recordAnonymousField</span><span class="op" id="3315225">(</span><span class="ident" id="3315226">typ</span><span class="op" id="3315229">,</span>&nbsp;<span class="ident" id="3315231">field</span><span class="op" id="3315236">.</span><span class="ident" id="3315237">Type</span><span class="op" id="3315241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315248">}</span><br>
<span class="lineno"></span><span class="op" id="3315250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3315253">//&nbsp;readFunc&nbsp;processes&nbsp;a&nbsp;func&nbsp;or&nbsp;method&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="3315305">//</span><br>
<span class="lineno"></span><span class="keyword" id="3315308">func</span>&nbsp;<span class="op" id="3315313">(</span><span class="ident" id="3315314">r</span>&nbsp;<span class="op" id="3315316">*</span><span class="ident" id="3315317">reader</span><span class="op" id="3315323">)</span>&nbsp;<span class="ident" id="3315325">readFunc</span><span class="op" id="3315333">(</span><span class="ident" id="3315334">fun</span>&nbsp;<span class="op" id="3315338">*</span><span class="ident" id="3315339">ast</span><span class="op" id="3315342">.</span><span class="ident" id="3315343">FuncDecl</span><span class="op" id="3315351">)</span>&nbsp;<span class="op" id="3315353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315356">//&nbsp;strip&nbsp;function&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315380">fun</span><span class="op" id="3315383">.</span><span class="ident" id="3315384">Body</span>&nbsp;<span class="op" id="3315389">=</span>&nbsp;<span class="ident" id="3315391">nil</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315397">//&nbsp;associate&nbsp;methods&nbsp;with&nbsp;the&nbsp;receiver&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315450">if</span>&nbsp;<span class="ident" id="3315453">fun</span><span class="op" id="3315456">.</span><span class="ident" id="3315457">Recv</span>&nbsp;<span class="op" id="3315462">!=</span>&nbsp;<span class="ident" id="3315465">nil</span>&nbsp;<span class="op" id="3315469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315473">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315485">recvTypeName</span><span class="op" id="3315497">,</span>&nbsp;<span class="ident" id="3315499">imp</span>&nbsp;<span class="op" id="3315503">:=</span>&nbsp;<span class="ident" id="3315506">baseTypeName</span><span class="op" id="3315518">(</span><span class="ident" id="3315519">fun</span><span class="op" id="3315522">.</span><span class="ident" id="3315523">Recv</span><span class="op" id="3315527">.</span><span class="ident" id="3315528">List</span><span class="op" id="3315532">[</span><span class="num" id="3315533">0</span><span class="op" id="3315534">]</span><span class="op" id="3315535">.</span><span class="ident" id="3315536">Type</span><span class="op" id="3315540">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315544">if</span>&nbsp;<span class="ident" id="3315547">imp</span>&nbsp;<span class="op" id="3315551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315556">//&nbsp;should&nbsp;not&nbsp;happen&nbsp;(incorrect&nbsp;AST);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315597">//&nbsp;don&#39;t&nbsp;show&nbsp;this&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315626">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315635">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315639">if</span>&nbsp;<span class="ident" id="3315642">typ</span>&nbsp;<span class="op" id="3315646">:=</span>&nbsp;<span class="ident" id="3315649">r</span><span class="op" id="3315650">.</span><span class="ident" id="3315651">lookupType</span><span class="op" id="3315661">(</span><span class="ident" id="3315662">recvTypeName</span><span class="op" id="3315674">)</span><span class="op" id="3315675">;</span>&nbsp;<span class="ident" id="3315677">typ</span>&nbsp;<span class="op" id="3315681">!=</span>&nbsp;<span class="ident" id="3315684">nil</span>&nbsp;<span class="op" id="3315688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315693">typ</span><span class="op" id="3315696">.</span><span class="ident" id="3315697">methods</span><span class="op" id="3315704">.</span><span class="ident" id="3315705">set</span><span class="op" id="3315708">(</span><span class="ident" id="3315709">fun</span><span class="op" id="3315712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315720">//&nbsp;otherwise&nbsp;ignore&nbsp;the&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315753">//&nbsp;TODO(gri):&nbsp;There&nbsp;may&nbsp;be&nbsp;exported&nbsp;methods&nbsp;of&nbsp;non-exported&nbsp;types</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315821">//&nbsp;that&nbsp;can&nbsp;be&nbsp;called&nbsp;because&nbsp;of&nbsp;exported&nbsp;values&nbsp;(consts,&nbsp;vars,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315890">//&nbsp;function&nbsp;results)&nbsp;of&nbsp;that&nbsp;type.&nbsp;Could&nbsp;determine&nbsp;if&nbsp;that&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315958">//&nbsp;case&nbsp;and&nbsp;then&nbsp;show&nbsp;those&nbsp;methods&nbsp;in&nbsp;an&nbsp;appropriate&nbsp;section.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316023">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316031">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3316035">//&nbsp;associate&nbsp;factory&nbsp;functions&nbsp;with&nbsp;the&nbsp;first&nbsp;visible&nbsp;result&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316110">if</span>&nbsp;<span class="ident" id="3316113">fun</span><span class="op" id="3316116">.</span><span class="ident" id="3316117">Type</span><span class="op" id="3316121">.</span><span class="ident" id="3316122">Results</span><span class="op" id="3316129">.</span><span class="ident" id="3316130">NumFields</span><span class="op" id="3316139">(</span><span class="op" id="3316140">)</span>&nbsp;<span class="op" id="3316142">&gt;=</span>&nbsp;<span class="num" id="3316145">1</span>&nbsp;<span class="op" id="3316147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316151">res</span>&nbsp;<span class="op" id="3316155">:=</span>&nbsp;<span class="ident" id="3316158">fun</span><span class="op" id="3316161">.</span><span class="ident" id="3316162">Type</span><span class="op" id="3316166">.</span><span class="ident" id="3316167">Results</span><span class="op" id="3316174">.</span><span class="ident" id="3316175">List</span><span class="op" id="3316179">[</span><span class="num" id="3316180">0</span><span class="op" id="3316181">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316185">if</span>&nbsp;<span class="builtinfunc" id="3316188">len</span><span class="op" id="3316191">(</span><span class="ident" id="3316192">res</span><span class="op" id="3316195">.</span><span class="ident" id="3316196">Names</span><span class="op" id="3316201">)</span>&nbsp;<span class="op" id="3316203">&lt;=</span>&nbsp;<span class="num" id="3316206">1</span>&nbsp;<span class="op" id="3316208">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3316213">//&nbsp;exactly&nbsp;one&nbsp;(named&nbsp;or&nbsp;anonymous)&nbsp;result&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3316270">//&nbsp;with&nbsp;the&nbsp;first&nbsp;type&nbsp;in&nbsp;result&nbsp;signature&nbsp;(there&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3316327">//&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;result)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316358">if</span>&nbsp;<span class="ident" id="3316361">n</span><span class="op" id="3316362">,</span>&nbsp;<span class="ident" id="3316364">imp</span>&nbsp;<span class="op" id="3316368">:=</span>&nbsp;<span class="ident" id="3316371">baseTypeName</span><span class="op" id="3316383">(</span><span class="ident" id="3316384">res</span><span class="op" id="3316387">.</span><span class="ident" id="3316388">Type</span><span class="op" id="3316392">)</span><span class="op" id="3316393">;</span>&nbsp;<span class="op" id="3316395">!</span><span class="ident" id="3316396">imp</span>&nbsp;<span class="op" id="3316400">&amp;&amp;</span>&nbsp;<span class="ident" id="3316403">r</span><span class="op" id="3316404">.</span><span class="ident" id="3316405">isVisible</span><span class="op" id="3316414">(</span><span class="ident" id="3316415">n</span><span class="op" id="3316416">)</span>&nbsp;<span class="op" id="3316418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316424">if</span>&nbsp;<span class="ident" id="3316427">typ</span>&nbsp;<span class="op" id="3316431">:=</span>&nbsp;<span class="ident" id="3316434">r</span><span class="op" id="3316435">.</span><span class="ident" id="3316436">lookupType</span><span class="op" id="3316446">(</span><span class="ident" id="3316447">n</span><span class="op" id="3316448">)</span><span class="op" id="3316449">;</span>&nbsp;<span class="ident" id="3316451">typ</span>&nbsp;<span class="op" id="3316455">!=</span>&nbsp;<span class="ident" id="3316458">nil</span>&nbsp;<span class="op" id="3316462">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3316469">//&nbsp;associate&nbsp;function&nbsp;with&nbsp;typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316505">typ</span><span class="op" id="3316508">.</span><span class="ident" id="3316509">funcs</span><span class="op" id="3316514">.</span><span class="ident" id="3316515">set</span><span class="op" id="3316518">(</span><span class="ident" id="3316519">fun</span><span class="op" id="3316522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316529">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316545">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3316556">//&nbsp;just&nbsp;an&nbsp;ordinary&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316586">r</span><span class="op" id="3316587">.</span><span class="ident" id="3316588">funcs</span><span class="op" id="3316593">.</span><span class="ident" id="3316594">set</span><span class="op" id="3316597">(</span><span class="ident" id="3316598">fun</span><span class="op" id="3316601">)</span><br>
<span class="lineno">400</span><span class="op" id="3316603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3316606">var</span>&nbsp;<span class="op" id="3316610">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316613">noteMarker</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3316627">=</span>&nbsp;<span class="string" id="3316629">`([A-Z][A-Z]+)\(([^)]+)\):?`</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3316677">//&nbsp;MARKER(uid),&nbsp;MARKER&nbsp;at&nbsp;least&nbsp;2&nbsp;chars,&nbsp;uid&nbsp;at&nbsp;least&nbsp;1&nbsp;char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316739">noteMarkerRx</span>&nbsp;&nbsp;<span class="op" id="3316753">=</span>&nbsp;<span class="ident" id="3316755">regexp</span><span class="op" id="3316761">.</span><span class="ident" id="3316762">MustCompile</span><span class="op" id="3316773">(</span><span class="string" id="3316774">`^[&nbsp;\t]*`</span>&nbsp;<span class="op" id="3316784">+</span>&nbsp;<span class="ident" id="3316786">noteMarker</span><span class="op" id="3316796">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3316803">//&nbsp;MARKER(uid)&nbsp;at&nbsp;text&nbsp;start</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316833">noteCommentRx</span>&nbsp;<span class="op" id="3316847">=</span>&nbsp;<span class="ident" id="3316849">regexp</span><span class="op" id="3316855">.</span><span class="ident" id="3316856">MustCompile</span><span class="op" id="3316867">(</span><span class="string" id="3316868">`^/[/*][&nbsp;\t]*`</span>&nbsp;<span class="op" id="3316883">+</span>&nbsp;<span class="ident" id="3316885">noteMarker</span><span class="op" id="3316895">)</span>&nbsp;<span class="comment" id="3316897">//&nbsp;MARKER(uid)&nbsp;at&nbsp;comment&nbsp;start</span><br>
<span class="lineno"></span><span class="op" id="3316929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3316932">//&nbsp;readNote&nbsp;collects&nbsp;a&nbsp;single&nbsp;note&nbsp;from&nbsp;a&nbsp;sequence&nbsp;of&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="3316996">//</span><br>
<span class="lineno">410</span><span class="keyword" id="3316999">func</span>&nbsp;<span class="op" id="3317004">(</span><span class="ident" id="3317005">r</span>&nbsp;<span class="op" id="3317007">*</span><span class="ident" id="3317008">reader</span><span class="op" id="3317014">)</span>&nbsp;<span class="ident" id="3317016">readNote</span><span class="op" id="3317024">(</span><span class="ident" id="3317025">list</span>&nbsp;<span class="op" id="3317030">[</span><span class="op" id="3317031">]</span><span class="op" id="3317032">*</span><span class="ident" id="3317033">ast</span><span class="op" id="3317036">.</span><span class="ident" id="3317037">Comment</span><span class="op" id="3317044">)</span>&nbsp;<span class="op" id="3317046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317049">text</span>&nbsp;<span class="op" id="3317054">:=</span>&nbsp;<span class="op" id="3317057">(</span><span class="op" id="3317058">&amp;</span><span class="ident" id="3317059">ast</span><span class="op" id="3317062">.</span><span class="ident" id="3317063">CommentGroup</span><span class="op" id="3317075">{</span><span class="ident" id="3317076">List</span><span class="op" id="3317080">:</span>&nbsp;<span class="ident" id="3317082">list</span><span class="op" id="3317086">}</span><span class="op" id="3317087">)</span><span class="op" id="3317088">.</span><span class="ident" id="3317089">Text</span><span class="op" id="3317093">(</span><span class="op" id="3317094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317097">if</span>&nbsp;<span class="ident" id="3317100">m</span>&nbsp;<span class="op" id="3317102">:=</span>&nbsp;<span class="ident" id="3317105">noteMarkerRx</span><span class="op" id="3317117">.</span><span class="ident" id="3317118">FindStringSubmatchIndex</span><span class="op" id="3317141">(</span><span class="ident" id="3317142">text</span><span class="op" id="3317146">)</span><span class="op" id="3317147">;</span>&nbsp;<span class="ident" id="3317149">m</span>&nbsp;<span class="op" id="3317151">!=</span>&nbsp;<span class="ident" id="3317154">nil</span>&nbsp;<span class="op" id="3317158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3317162">//&nbsp;The&nbsp;note&nbsp;body&nbsp;starts&nbsp;after&nbsp;the&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3317206">//&nbsp;We&nbsp;remove&nbsp;any&nbsp;formatting&nbsp;so&nbsp;that&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3317253">//&nbsp;get&nbsp;spurious&nbsp;line&nbsp;breaks/indentation&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3317300">//&nbsp;showing&nbsp;the&nbsp;TODO&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317328">body</span>&nbsp;<span class="op" id="3317333">:=</span>&nbsp;<span class="ident" id="3317336">clean</span><span class="op" id="3317341">(</span><span class="ident" id="3317342">text</span><span class="op" id="3317346">[</span><span class="ident" id="3317347">m</span><span class="op" id="3317348">[</span><span class="num" id="3317349">1</span><span class="op" id="3317350">]</span><span class="op" id="3317351">:</span><span class="op" id="3317352">]</span><span class="op" id="3317353">,</span>&nbsp;<span class="ident" id="3317355">keepNL</span><span class="op" id="3317361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317365">if</span>&nbsp;<span class="ident" id="3317368">body</span>&nbsp;<span class="op" id="3317373">!=</span>&nbsp;<span class="string" id="3317376">&#34;&#34;</span>&nbsp;<span class="op" id="3317379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317384">marker</span>&nbsp;<span class="op" id="3317391">:=</span>&nbsp;<span class="ident" id="3317394">text</span><span class="op" id="3317398">[</span><span class="ident" id="3317399">m</span><span class="op" id="3317400">[</span><span class="num" id="3317401">2</span><span class="op" id="3317402">]</span><span class="op" id="3317403">:</span><span class="ident" id="3317404">m</span><span class="op" id="3317405">[</span><span class="num" id="3317406">3</span><span class="op" id="3317407">]</span><span class="op" id="3317408">]</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317413">r</span><span class="op" id="3317414">.</span><span class="ident" id="3317415">notes</span><span class="op" id="3317420">[</span><span class="ident" id="3317421">marker</span><span class="op" id="3317427">]</span>&nbsp;<span class="op" id="3317429">=</span>&nbsp;<span class="builtinfunc" id="3317431">append</span><span class="op" id="3317437">(</span><span class="ident" id="3317438">r</span><span class="op" id="3317439">.</span><span class="ident" id="3317440">notes</span><span class="op" id="3317445">[</span><span class="ident" id="3317446">marker</span><span class="op" id="3317452">]</span><span class="op" id="3317453">,</span>&nbsp;<span class="op" id="3317455">&amp;</span><span class="ident" id="3317456">Note</span><span class="op" id="3317460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317466">Pos</span><span class="op" id="3317469">:</span>&nbsp;&nbsp;<span class="ident" id="3317472">list</span><span class="op" id="3317476">[</span><span class="num" id="3317477">0</span><span class="op" id="3317478">]</span><span class="op" id="3317479">.</span><span class="ident" id="3317480">Pos</span><span class="op" id="3317483">(</span><span class="op" id="3317484">)</span><span class="op" id="3317485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317491">End</span><span class="op" id="3317494">:</span>&nbsp;&nbsp;<span class="ident" id="3317497">list</span><span class="op" id="3317501">[</span><span class="builtinfunc" id="3317502">len</span><span class="op" id="3317505">(</span><span class="ident" id="3317506">list</span><span class="op" id="3317510">)</span><span class="op" id="3317511">-</span><span class="num" id="3317512">1</span><span class="op" id="3317513">]</span><span class="op" id="3317514">.</span><span class="ident" id="3317515">End</span><span class="op" id="3317518">(</span><span class="op" id="3317519">)</span><span class="op" id="3317520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317526">UID</span><span class="op" id="3317529">:</span>&nbsp;&nbsp;<span class="ident" id="3317532">text</span><span class="op" id="3317536">[</span><span class="ident" id="3317537">m</span><span class="op" id="3317538">[</span><span class="num" id="3317539">4</span><span class="op" id="3317540">]</span><span class="op" id="3317541">:</span><span class="ident" id="3317542">m</span><span class="op" id="3317543">[</span><span class="num" id="3317544">5</span><span class="op" id="3317545">]</span><span class="op" id="3317546">]</span><span class="op" id="3317547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317553">Body</span><span class="op" id="3317557">:</span>&nbsp;<span class="ident" id="3317559">body</span><span class="op" id="3317563">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317568">}</span><span class="op" id="3317569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317576">}</span><br>
<span class="lineno"></span><span class="op" id="3317578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="3317581">//&nbsp;readNotes&nbsp;extracts&nbsp;notes&nbsp;from&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="3317624">//&nbsp;A&nbsp;note&nbsp;must&nbsp;start&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;comment&nbsp;with&nbsp;&#34;MARKER(uid):&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3317695">//&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;the&nbsp;note&nbsp;body&nbsp;(e.g.,&nbsp;&#34;//&nbsp;BUG(gri):&nbsp;fix&nbsp;this&#34;).</span><br>
<span class="lineno"></span><span class="comment" id="3317764">//&nbsp;The&nbsp;note&nbsp;ends&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;comment&nbsp;group&nbsp;or&nbsp;at&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3317832">//&nbsp;another&nbsp;note&nbsp;in&nbsp;the&nbsp;same&nbsp;comment&nbsp;group,&nbsp;whichever&nbsp;comes&nbsp;first.</span><br>
<span class="lineno">435</span><span class="comment" id="3317898">//</span><br>
<span class="lineno"></span><span class="keyword" id="3317901">func</span>&nbsp;<span class="op" id="3317906">(</span><span class="ident" id="3317907">r</span>&nbsp;<span class="op" id="3317909">*</span><span class="ident" id="3317910">reader</span><span class="op" id="3317916">)</span>&nbsp;<span class="ident" id="3317918">readNotes</span><span class="op" id="3317927">(</span><span class="ident" id="3317928">comments</span>&nbsp;<span class="op" id="3317937">[</span><span class="op" id="3317938">]</span><span class="op" id="3317939">*</span><span class="ident" id="3317940">ast</span><span class="op" id="3317943">.</span><span class="ident" id="3317944">CommentGroup</span><span class="op" id="3317956">)</span>&nbsp;<span class="op" id="3317958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317961">for</span>&nbsp;<span class="ident" id="3317965">_</span><span class="op" id="3317966">,</span>&nbsp;<span class="ident" id="3317968">group</span>&nbsp;<span class="op" id="3317974">:=</span>&nbsp;<span class="keyword" id="3317977">range</span>&nbsp;<span class="ident" id="3317983">comments</span>&nbsp;<span class="op" id="3317992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317996">i</span>&nbsp;<span class="op" id="3317998">:=</span>&nbsp;<span class="op" id="3318001">-</span><span class="num" id="3318002">1</span>&nbsp;<span class="comment" id="3318004">//&nbsp;comment&nbsp;index&nbsp;of&nbsp;most&nbsp;recent&nbsp;note&nbsp;start,&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318064">list</span>&nbsp;<span class="op" id="3318069">:=</span>&nbsp;<span class="ident" id="3318072">group</span><span class="op" id="3318077">.</span><span class="ident" id="3318078">List</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318085">for</span>&nbsp;<span class="ident" id="3318089">j</span><span class="op" id="3318090">,</span>&nbsp;<span class="ident" id="3318092">c</span>&nbsp;<span class="op" id="3318094">:=</span>&nbsp;<span class="keyword" id="3318097">range</span>&nbsp;<span class="ident" id="3318103">list</span>&nbsp;<span class="op" id="3318108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318113">if</span>&nbsp;<span class="ident" id="3318116">noteCommentRx</span><span class="op" id="3318129">.</span><span class="ident" id="3318130">MatchString</span><span class="op" id="3318141">(</span><span class="ident" id="3318142">c</span><span class="op" id="3318143">.</span><span class="ident" id="3318144">Text</span><span class="op" id="3318148">)</span>&nbsp;<span class="op" id="3318150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318156">if</span>&nbsp;<span class="ident" id="3318159">i</span>&nbsp;<span class="op" id="3318161">&gt;=</span>&nbsp;<span class="num" id="3318164">0</span>&nbsp;<span class="op" id="3318166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318173">r</span><span class="op" id="3318174">.</span><span class="ident" id="3318175">readNote</span><span class="op" id="3318183">(</span><span class="ident" id="3318184">list</span><span class="op" id="3318188">[</span><span class="ident" id="3318189">i</span><span class="op" id="3318190">:</span><span class="ident" id="3318191">j</span><span class="op" id="3318192">]</span><span class="op" id="3318193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318199">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318205">i</span>&nbsp;<span class="op" id="3318207">=</span>&nbsp;<span class="ident" id="3318209">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318222">if</span>&nbsp;<span class="ident" id="3318225">i</span>&nbsp;<span class="op" id="3318227">&gt;=</span>&nbsp;<span class="num" id="3318230">0</span>&nbsp;<span class="op" id="3318232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318237">r</span><span class="op" id="3318238">.</span><span class="ident" id="3318239">readNote</span><span class="op" id="3318247">(</span><span class="ident" id="3318248">list</span><span class="op" id="3318252">[</span><span class="ident" id="3318253">i</span><span class="op" id="3318254">:</span><span class="op" id="3318255">]</span><span class="op" id="3318256">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318263">}</span><br>
<span class="lineno"></span><span class="op" id="3318265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3318268">//&nbsp;readFile&nbsp;adds&nbsp;the&nbsp;AST&nbsp;for&nbsp;a&nbsp;source&nbsp;file&nbsp;to&nbsp;the&nbsp;reader.</span><br>
<span class="lineno">455</span><span class="comment" id="3318326">//</span><br>
<span class="lineno"></span><span class="keyword" id="3318329">func</span>&nbsp;<span class="op" id="3318334">(</span><span class="ident" id="3318335">r</span>&nbsp;<span class="op" id="3318337">*</span><span class="ident" id="3318338">reader</span><span class="op" id="3318344">)</span>&nbsp;<span class="ident" id="3318346">readFile</span><span class="op" id="3318354">(</span><span class="ident" id="3318355">src</span>&nbsp;<span class="op" id="3318359">*</span><span class="ident" id="3318360">ast</span><span class="op" id="3318363">.</span><span class="ident" id="3318364">File</span><span class="op" id="3318368">)</span>&nbsp;<span class="op" id="3318370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3318373">//&nbsp;add&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318403">if</span>&nbsp;<span class="ident" id="3318406">src</span><span class="op" id="3318409">.</span><span class="ident" id="3318410">Doc</span>&nbsp;<span class="op" id="3318414">!=</span>&nbsp;<span class="ident" id="3318417">nil</span>&nbsp;<span class="op" id="3318421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318425">r</span><span class="op" id="3318426">.</span><span class="ident" id="3318427">readDoc</span><span class="op" id="3318434">(</span><span class="ident" id="3318435">src</span><span class="op" id="3318438">.</span><span class="ident" id="3318439">Doc</span><span class="op" id="3318442">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318446">src</span><span class="op" id="3318449">.</span><span class="ident" id="3318450">Doc</span>&nbsp;<span class="op" id="3318454">=</span>&nbsp;<span class="ident" id="3318456">nil</span>&nbsp;<span class="comment" id="3318460">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3318499">//&nbsp;add&nbsp;all&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318524">for</span>&nbsp;<span class="ident" id="3318528">_</span><span class="op" id="3318529">,</span>&nbsp;<span class="ident" id="3318531">decl</span>&nbsp;<span class="op" id="3318536">:=</span>&nbsp;<span class="keyword" id="3318539">range</span>&nbsp;<span class="ident" id="3318545">src</span><span class="op" id="3318548">.</span><span class="ident" id="3318549">Decls</span>&nbsp;<span class="op" id="3318555">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318559">switch</span>&nbsp;<span class="ident" id="3318566">d</span>&nbsp;<span class="op" id="3318568">:=</span>&nbsp;<span class="ident" id="3318571">decl</span><span class="op" id="3318575">.</span><span class="op" id="3318576">(</span><span class="keyword" id="3318577">type</span><span class="op" id="3318581">)</span>&nbsp;<span class="op" id="3318583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318587">case</span>&nbsp;<span class="op" id="3318592">*</span><span class="ident" id="3318593">ast</span><span class="op" id="3318596">.</span><span class="ident" id="3318597">GenDecl</span><span class="op" id="3318604">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318609">switch</span>&nbsp;<span class="ident" id="3318616">d</span><span class="op" id="3318617">.</span><span class="ident" id="3318618">Tok</span>&nbsp;<span class="op" id="3318622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318627">case</span>&nbsp;<span class="ident" id="3318632">token</span><span class="op" id="3318637">.</span><span class="ident" id="3318638">IMPORT</span><span class="op" id="3318644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3318650">//&nbsp;imports&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318690">for</span>&nbsp;<span class="ident" id="3318694">_</span><span class="op" id="3318695">,</span>&nbsp;<span class="ident" id="3318697">spec</span>&nbsp;<span class="op" id="3318702">:=</span>&nbsp;<span class="keyword" id="3318705">range</span>&nbsp;<span class="ident" id="3318711">d</span><span class="op" id="3318712">.</span><span class="ident" id="3318713">Specs</span>&nbsp;<span class="op" id="3318719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318726">if</span>&nbsp;<span class="ident" id="3318729">s</span><span class="op" id="3318730">,</span>&nbsp;<span class="ident" id="3318732">ok</span>&nbsp;<span class="op" id="3318735">:=</span>&nbsp;<span class="ident" id="3318738">spec</span><span class="op" id="3318742">.</span><span class="op" id="3318743">(</span><span class="op" id="3318744">*</span><span class="ident" id="3318745">ast</span><span class="op" id="3318748">.</span><span class="ident" id="3318749">ImportSpec</span><span class="op" id="3318759">)</span><span class="op" id="3318760">;</span>&nbsp;<span class="ident" id="3318762">ok</span>&nbsp;<span class="op" id="3318765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318773">if</span>&nbsp;<span class="ident" id="3318776">import_</span><span class="op" id="3318783">,</span>&nbsp;<span class="ident" id="3318785">err</span>&nbsp;<span class="op" id="3318789">:=</span>&nbsp;<span class="ident" id="3318792">strconv</span><span class="op" id="3318799">.</span><span class="ident" id="3318800">Unquote</span><span class="op" id="3318807">(</span><span class="ident" id="3318808">s</span><span class="op" id="3318809">.</span><span class="ident" id="3318810">Path</span><span class="op" id="3318814">.</span><span class="ident" id="3318815">Value</span><span class="op" id="3318820">)</span><span class="op" id="3318821">;</span>&nbsp;<span class="ident" id="3318823">err</span>&nbsp;<span class="op" id="3318827">==</span>&nbsp;<span class="ident" id="3318830">nil</span>&nbsp;<span class="op" id="3318834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318843">r</span><span class="op" id="3318844">.</span><span class="ident" id="3318845">imports</span><span class="op" id="3318852">[</span><span class="ident" id="3318853">import_</span><span class="op" id="3318860">]</span>&nbsp;<span class="op" id="3318862">=</span>&nbsp;<span class="num" id="3318864">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318872">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318890">case</span>&nbsp;<span class="ident" id="3318895">token</span><span class="op" id="3318900">.</span><span class="ident" id="3318901">CONST</span><span class="op" id="3318906">,</span>&nbsp;<span class="ident" id="3318908">token</span><span class="op" id="3318913">.</span><span class="ident" id="3318914">VAR</span><span class="op" id="3318917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3318923">//&nbsp;constants&nbsp;and&nbsp;variables&nbsp;are&nbsp;always&nbsp;handled&nbsp;as&nbsp;a&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318984">r</span><span class="op" id="3318985">.</span><span class="ident" id="3318986">readValue</span><span class="op" id="3318995">(</span><span class="ident" id="3318996">d</span><span class="op" id="3318997">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319002">case</span>&nbsp;<span class="ident" id="3319007">token</span><span class="op" id="3319012">.</span><span class="ident" id="3319013">TYPE</span><span class="op" id="3319017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319023">//&nbsp;types&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319061">if</span>&nbsp;<span class="builtinfunc" id="3319064">len</span><span class="op" id="3319067">(</span><span class="ident" id="3319068">d</span><span class="op" id="3319069">.</span><span class="ident" id="3319070">Specs</span><span class="op" id="3319075">)</span>&nbsp;<span class="op" id="3319077">==</span>&nbsp;<span class="num" id="3319080">1</span>&nbsp;<span class="op" id="3319082">&amp;&amp;</span>&nbsp;<span class="op" id="3319085">!</span><span class="ident" id="3319086">d</span><span class="op" id="3319087">.</span><span class="ident" id="3319088">Lparen</span><span class="op" id="3319094">.</span><span class="ident" id="3319095">IsValid</span><span class="op" id="3319102">(</span><span class="op" id="3319103">)</span>&nbsp;<span class="op" id="3319105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319112">//&nbsp;common&nbsp;case:&nbsp;single&nbsp;declaration&nbsp;w/o&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319168">//&nbsp;(if&nbsp;a&nbsp;single&nbsp;declaration&nbsp;is&nbsp;parenthesized,</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319219">//&nbsp;create&nbsp;a&nbsp;new&nbsp;fake&nbsp;declaration&nbsp;below,&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319272">//&nbsp;go/doc&nbsp;type&nbsp;declarations&nbsp;always&nbsp;appear&nbsp;w/o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319323">//&nbsp;parentheses)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319344">if</span>&nbsp;<span class="ident" id="3319347">s</span><span class="op" id="3319348">,</span>&nbsp;<span class="ident" id="3319350">ok</span>&nbsp;<span class="op" id="3319353">:=</span>&nbsp;<span class="ident" id="3319356">d</span><span class="op" id="3319357">.</span><span class="ident" id="3319358">Specs</span><span class="op" id="3319363">[</span><span class="num" id="3319364">0</span><span class="op" id="3319365">]</span><span class="op" id="3319366">.</span><span class="op" id="3319367">(</span><span class="op" id="3319368">*</span><span class="ident" id="3319369">ast</span><span class="op" id="3319372">.</span><span class="ident" id="3319373">TypeSpec</span><span class="op" id="3319381">)</span><span class="op" id="3319382">;</span>&nbsp;<span class="ident" id="3319384">ok</span>&nbsp;<span class="op" id="3319387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319395">r</span><span class="op" id="3319396">.</span><span class="ident" id="3319397">readType</span><span class="op" id="3319405">(</span><span class="ident" id="3319406">d</span><span class="op" id="3319407">,</span>&nbsp;<span class="ident" id="3319409">s</span><span class="op" id="3319410">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3319417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319424">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3319434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319440">for</span>&nbsp;<span class="ident" id="3319444">_</span><span class="op" id="3319445">,</span>&nbsp;<span class="ident" id="3319447">spec</span>&nbsp;<span class="op" id="3319452">:=</span>&nbsp;<span class="keyword" id="3319455">range</span>&nbsp;<span class="ident" id="3319461">d</span><span class="op" id="3319462">.</span><span class="ident" id="3319463">Specs</span>&nbsp;<span class="op" id="3319469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319476">if</span>&nbsp;<span class="ident" id="3319479">s</span><span class="op" id="3319480">,</span>&nbsp;<span class="ident" id="3319482">ok</span>&nbsp;<span class="op" id="3319485">:=</span>&nbsp;<span class="ident" id="3319488">spec</span><span class="op" id="3319492">.</span><span class="op" id="3319493">(</span><span class="op" id="3319494">*</span><span class="ident" id="3319495">ast</span><span class="op" id="3319498">.</span><span class="ident" id="3319499">TypeSpec</span><span class="op" id="3319507">)</span><span class="op" id="3319508">;</span>&nbsp;<span class="ident" id="3319510">ok</span>&nbsp;<span class="op" id="3319513">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319521">//&nbsp;use&nbsp;an&nbsp;individual&nbsp;(possibly&nbsp;fake)&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319576">//&nbsp;for&nbsp;each&nbsp;type;&nbsp;this&nbsp;also&nbsp;ensures&nbsp;that&nbsp;each&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319633">//&nbsp;gets&nbsp;to&nbsp;(re-)use&nbsp;the&nbsp;declaration&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319689">//&nbsp;if&nbsp;there&#39;s&nbsp;none&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319746">fake</span>&nbsp;<span class="op" id="3319751">:=</span>&nbsp;<span class="op" id="3319754">&amp;</span><span class="ident" id="3319755">ast</span><span class="op" id="3319758">.</span><span class="ident" id="3319759">GenDecl</span><span class="op" id="3319766">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319775">Doc</span><span class="op" id="3319778">:</span>&nbsp;<span class="ident" id="3319780">d</span><span class="op" id="3319781">.</span><span class="ident" id="3319782">Doc</span><span class="op" id="3319785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319794">//&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;existing&nbsp;TokPos&nbsp;because&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319845">//&nbsp;will&nbsp;lead&nbsp;to&nbsp;the&nbsp;wrong&nbsp;selection&nbsp;range&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319898">//&nbsp;the&nbsp;fake&nbsp;declaration&nbsp;if&nbsp;there&nbsp;are&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319947">//&nbsp;than&nbsp;one&nbsp;type&nbsp;in&nbsp;the&nbsp;group&nbsp;(this&nbsp;affects</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319998">//&nbsp;src/cmd/godoc/godoc.go&#39;s&nbsp;posLink_urlFunc)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320050">TokPos</span><span class="op" id="3320056">:</span>&nbsp;<span class="ident" id="3320058">s</span><span class="op" id="3320059">.</span><span class="ident" id="3320060">Pos</span><span class="op" id="3320063">(</span><span class="op" id="3320064">)</span><span class="op" id="3320065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320074">Tok</span><span class="op" id="3320077">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3320082">token</span><span class="op" id="3320087">.</span><span class="ident" id="3320088">TYPE</span><span class="op" id="3320092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320101">Specs</span><span class="op" id="3320106">:</span>&nbsp;&nbsp;<span class="op" id="3320109">[</span><span class="op" id="3320110">]</span><span class="ident" id="3320111">ast</span><span class="op" id="3320114">.</span><span class="ident" id="3320115">Spec</span><span class="op" id="3320119">{</span><span class="ident" id="3320120">s</span><span class="op" id="3320121">}</span><span class="op" id="3320122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320130">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320138">r</span><span class="op" id="3320139">.</span><span class="ident" id="3320140">readType</span><span class="op" id="3320148">(</span><span class="ident" id="3320149">fake</span><span class="op" id="3320153">,</span>&nbsp;<span class="ident" id="3320155">s</span><span class="op" id="3320156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320178">case</span>&nbsp;<span class="op" id="3320183">*</span><span class="ident" id="3320184">ast</span><span class="op" id="3320187">.</span><span class="ident" id="3320188">FuncDecl</span><span class="op" id="3320196">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320201">r</span><span class="op" id="3320202">.</span><span class="ident" id="3320203">readFunc</span><span class="op" id="3320211">(</span><span class="ident" id="3320212">d</span><span class="op" id="3320213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320224">//&nbsp;collect&nbsp;MARKER(...):&nbsp;annotations</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320261">r</span><span class="op" id="3320262">.</span><span class="ident" id="3320263">readNotes</span><span class="op" id="3320272">(</span><span class="ident" id="3320273">src</span><span class="op" id="3320276">.</span><span class="ident" id="3320277">Comments</span><span class="op" id="3320285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320288">src</span><span class="op" id="3320291">.</span><span class="ident" id="3320292">Comments</span>&nbsp;<span class="op" id="3320301">=</span>&nbsp;<span class="ident" id="3320303">nil</span>&nbsp;<span class="comment" id="3320307">//&nbsp;consumed&nbsp;unassociated&nbsp;comments&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="3320359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3320362">func</span>&nbsp;<span class="op" id="3320367">(</span><span class="ident" id="3320368">r</span>&nbsp;<span class="op" id="3320370">*</span><span class="ident" id="3320371">reader</span><span class="op" id="3320377">)</span>&nbsp;<span class="ident" id="3320379">readPackage</span><span class="op" id="3320390">(</span><span class="ident" id="3320391">pkg</span>&nbsp;<span class="op" id="3320395">*</span><span class="ident" id="3320396">ast</span><span class="op" id="3320399">.</span><span class="ident" id="3320400">Package</span><span class="op" id="3320407">,</span>&nbsp;<span class="ident" id="3320409">mode</span>&nbsp;<span class="ident" id="3320414">Mode</span><span class="op" id="3320418">)</span>&nbsp;<span class="op" id="3320420">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320423">//&nbsp;initialize&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320445">r</span><span class="op" id="3320446">.</span><span class="ident" id="3320447">filenames</span>&nbsp;<span class="op" id="3320457">=</span>&nbsp;<span class="builtinfunc" id="3320459">make</span><span class="op" id="3320463">(</span><span class="op" id="3320464">[</span><span class="op" id="3320465">]</span><span class="builtintype" id="3320466">string</span><span class="op" id="3320472">,</span>&nbsp;<span class="builtinfunc" id="3320474">len</span><span class="op" id="3320477">(</span><span class="ident" id="3320478">pkg</span><span class="op" id="3320481">.</span><span class="ident" id="3320482">Files</span><span class="op" id="3320487">)</span><span class="op" id="3320488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320491">r</span><span class="op" id="3320492">.</span><span class="ident" id="3320493">imports</span>&nbsp;<span class="op" id="3320501">=</span>&nbsp;<span class="builtinfunc" id="3320503">make</span><span class="op" id="3320507">(</span><span class="keyword" id="3320508">map</span><span class="op" id="3320511">[</span><span class="builtintype" id="3320512">string</span><span class="op" id="3320518">]</span><span class="builtintype" id="3320519">int</span><span class="op" id="3320522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320525">r</span><span class="op" id="3320526">.</span><span class="ident" id="3320527">mode</span>&nbsp;<span class="op" id="3320532">=</span>&nbsp;<span class="ident" id="3320534">mode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320540">r</span><span class="op" id="3320541">.</span><span class="ident" id="3320542">types</span>&nbsp;<span class="op" id="3320548">=</span>&nbsp;<span class="builtinfunc" id="3320550">make</span><span class="op" id="3320554">(</span><span class="keyword" id="3320555">map</span><span class="op" id="3320558">[</span><span class="builtintype" id="3320559">string</span><span class="op" id="3320565">]</span><span class="op" id="3320566">*</span><span class="ident" id="3320567">namedType</span><span class="op" id="3320576">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320579">r</span><span class="op" id="3320580">.</span><span class="ident" id="3320581">funcs</span>&nbsp;<span class="op" id="3320587">=</span>&nbsp;<span class="builtinfunc" id="3320589">make</span><span class="op" id="3320593">(</span><span class="ident" id="3320594">methodSet</span><span class="op" id="3320603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320606">r</span><span class="op" id="3320607">.</span><span class="ident" id="3320608">notes</span>&nbsp;<span class="op" id="3320614">=</span>&nbsp;<span class="builtinfunc" id="3320616">make</span><span class="op" id="3320620">(</span><span class="keyword" id="3320621">map</span><span class="op" id="3320624">[</span><span class="builtintype" id="3320625">string</span><span class="op" id="3320631">]</span><span class="op" id="3320632">[</span><span class="op" id="3320633">]</span><span class="op" id="3320634">*</span><span class="ident" id="3320635">Note</span><span class="op" id="3320639">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320643">//&nbsp;sort&nbsp;package&nbsp;files&nbsp;before&nbsp;reading&nbsp;them&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320698">//&nbsp;result&nbsp;does&nbsp;not&nbsp;depend&nbsp;on&nbsp;map&nbsp;iteration&nbsp;order</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320748">i</span>&nbsp;<span class="op" id="3320750">:=</span>&nbsp;<span class="num" id="3320753">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320756">for</span>&nbsp;<span class="ident" id="3320760">filename</span>&nbsp;<span class="op" id="3320769">:=</span>&nbsp;<span class="keyword" id="3320772">range</span>&nbsp;<span class="ident" id="3320778">pkg</span><span class="op" id="3320781">.</span><span class="ident" id="3320782">Files</span>&nbsp;<span class="op" id="3320788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320792">r</span><span class="op" id="3320793">.</span><span class="ident" id="3320794">filenames</span><span class="op" id="3320803">[</span><span class="ident" id="3320804">i</span><span class="op" id="3320805">]</span>&nbsp;<span class="op" id="3320807">=</span>&nbsp;<span class="ident" id="3320809">filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320820">i</span><span class="op" id="3320821">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320825">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320828">sort</span><span class="op" id="3320832">.</span><span class="ident" id="3320833">Strings</span><span class="op" id="3320840">(</span><span class="ident" id="3320841">r</span><span class="op" id="3320842">.</span><span class="ident" id="3320843">filenames</span><span class="op" id="3320852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320856">//&nbsp;process&nbsp;files&nbsp;in&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320890">for</span>&nbsp;<span class="ident" id="3320894">_</span><span class="op" id="3320895">,</span>&nbsp;<span class="ident" id="3320897">filename</span>&nbsp;<span class="op" id="3320906">:=</span>&nbsp;<span class="keyword" id="3320909">range</span>&nbsp;<span class="ident" id="3320915">r</span><span class="op" id="3320916">.</span><span class="ident" id="3320917">filenames</span>&nbsp;<span class="op" id="3320927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320931">f</span>&nbsp;<span class="op" id="3320933">:=</span>&nbsp;<span class="ident" id="3320936">pkg</span><span class="op" id="3320939">.</span><span class="ident" id="3320940">Files</span><span class="op" id="3320945">[</span><span class="ident" id="3320946">filename</span><span class="op" id="3320954">]</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320958">if</span>&nbsp;<span class="ident" id="3320961">mode</span><span class="op" id="3320965">&amp;</span><span class="ident" id="3320966">AllDecls</span>&nbsp;<span class="op" id="3320975">==</span>&nbsp;<span class="num" id="3320978">0</span>&nbsp;<span class="op" id="3320980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320985">r</span><span class="op" id="3320986">.</span><span class="ident" id="3320987">fileExports</span><span class="op" id="3320998">(</span><span class="ident" id="3320999">f</span><span class="op" id="3321000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321008">r</span><span class="op" id="3321009">.</span><span class="ident" id="3321010">readFile</span><span class="op" id="3321018">(</span><span class="ident" id="3321019">f</span><span class="op" id="3321020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321023">}</span><br>
<span class="lineno">550</span><span class="op" id="3321025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3321028">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3321108">//&nbsp;Types</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="3321118">func</span>&nbsp;<span class="ident" id="3321123">customizeRecv</span><span class="op" id="3321136">(</span><span class="ident" id="3321137">f</span>&nbsp;<span class="op" id="3321139">*</span><span class="ident" id="3321140">Func</span><span class="op" id="3321144">,</span>&nbsp;<span class="ident" id="3321146">recvTypeName</span>&nbsp;<span class="builtintype" id="3321159">string</span><span class="op" id="3321165">,</span>&nbsp;<span class="ident" id="3321167">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="3321181">bool</span><span class="op" id="3321185">,</span>&nbsp;<span class="ident" id="3321187">level</span>&nbsp;<span class="builtintype" id="3321193">int</span><span class="op" id="3321196">)</span>&nbsp;<span class="op" id="3321198">*</span><span class="ident" id="3321199">Func</span>&nbsp;<span class="op" id="3321204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321207">if</span>&nbsp;<span class="ident" id="3321210">f</span>&nbsp;<span class="op" id="3321212">==</span>&nbsp;<span class="ident" id="3321215">nil</span>&nbsp;<span class="op" id="3321219">||</span>&nbsp;<span class="ident" id="3321222">f</span><span class="op" id="3321223">.</span><span class="ident" id="3321224">Decl</span>&nbsp;<span class="op" id="3321229">==</span>&nbsp;<span class="ident" id="3321232">nil</span>&nbsp;<span class="op" id="3321236">||</span>&nbsp;<span class="ident" id="3321239">f</span><span class="op" id="3321240">.</span><span class="ident" id="3321241">Decl</span><span class="op" id="3321245">.</span><span class="ident" id="3321246">Recv</span>&nbsp;<span class="op" id="3321251">==</span>&nbsp;<span class="ident" id="3321254">nil</span>&nbsp;<span class="op" id="3321258">||</span>&nbsp;<span class="builtinfunc" id="3321261">len</span><span class="op" id="3321264">(</span><span class="ident" id="3321265">f</span><span class="op" id="3321266">.</span><span class="ident" id="3321267">Decl</span><span class="op" id="3321271">.</span><span class="ident" id="3321272">Recv</span><span class="op" id="3321276">.</span><span class="ident" id="3321277">List</span><span class="op" id="3321281">)</span>&nbsp;<span class="op" id="3321283">!=</span>&nbsp;<span class="num" id="3321286">1</span>&nbsp;<span class="op" id="3321288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321292">return</span>&nbsp;<span class="ident" id="3321299">f</span>&nbsp;<span class="comment" id="3321301">//&nbsp;shouldn&#39;t&nbsp;happen,&nbsp;but&nbsp;be&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3321339">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;and&nbsp;set&nbsp;new&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321389">newField</span>&nbsp;<span class="op" id="3321398">:=</span>&nbsp;<span class="op" id="3321401">*</span><span class="ident" id="3321402">f</span><span class="op" id="3321403">.</span><span class="ident" id="3321404">Decl</span><span class="op" id="3321408">.</span><span class="ident" id="3321409">Recv</span><span class="op" id="3321413">.</span><span class="ident" id="3321414">List</span><span class="op" id="3321418">[</span><span class="num" id="3321419">0</span><span class="op" id="3321420">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321423">origPos</span>&nbsp;<span class="op" id="3321431">:=</span>&nbsp;<span class="ident" id="3321434">newField</span><span class="op" id="3321442">.</span><span class="ident" id="3321443">Type</span><span class="op" id="3321447">.</span><span class="ident" id="3321448">Pos</span><span class="op" id="3321451">(</span><span class="op" id="3321452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321455">_</span><span class="op" id="3321456">,</span>&nbsp;<span class="ident" id="3321458">origRecvIsPtr</span>&nbsp;<span class="op" id="3321472">:=</span>&nbsp;<span class="ident" id="3321475">newField</span><span class="op" id="3321483">.</span><span class="ident" id="3321484">Type</span><span class="op" id="3321488">.</span><span class="op" id="3321489">(</span><span class="op" id="3321490">*</span><span class="ident" id="3321491">ast</span><span class="op" id="3321494">.</span><span class="ident" id="3321495">StarExpr</span><span class="op" id="3321503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321506">newIdent</span>&nbsp;<span class="op" id="3321515">:=</span>&nbsp;<span class="op" id="3321518">&amp;</span><span class="ident" id="3321519">ast</span><span class="op" id="3321522">.</span><span class="ident" id="3321523">Ident</span><span class="op" id="3321528">{</span><span class="ident" id="3321529">NamePos</span><span class="op" id="3321536">:</span>&nbsp;<span class="ident" id="3321538">origPos</span><span class="op" id="3321545">,</span>&nbsp;<span class="ident" id="3321547">Name</span><span class="op" id="3321551">:</span>&nbsp;<span class="ident" id="3321553">recvTypeName</span><span class="op" id="3321565">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321568">var</span>&nbsp;<span class="ident" id="3321572">typ</span>&nbsp;<span class="ident" id="3321576">ast</span><span class="op" id="3321579">.</span><span class="ident" id="3321580">Expr</span>&nbsp;<span class="op" id="3321585">=</span>&nbsp;<span class="ident" id="3321587">newIdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321597">if</span>&nbsp;<span class="op" id="3321600">!</span><span class="ident" id="3321601">embeddedIsPtr</span>&nbsp;<span class="op" id="3321615">&amp;&amp;</span>&nbsp;<span class="ident" id="3321618">origRecvIsPtr</span>&nbsp;<span class="op" id="3321632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321636">newIdent</span><span class="op" id="3321644">.</span><span class="ident" id="3321645">NamePos</span><span class="op" id="3321652">++</span>&nbsp;<span class="comment" id="3321655">//&nbsp;&#39;*&#39;&nbsp;is&nbsp;one&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321681">typ</span>&nbsp;<span class="op" id="3321685">=</span>&nbsp;<span class="op" id="3321687">&amp;</span><span class="ident" id="3321688">ast</span><span class="op" id="3321691">.</span><span class="ident" id="3321692">StarExpr</span><span class="op" id="3321700">{</span><span class="ident" id="3321701">Star</span><span class="op" id="3321705">:</span>&nbsp;<span class="ident" id="3321707">origPos</span><span class="op" id="3321714">,</span>&nbsp;<span class="ident" id="3321716">X</span><span class="op" id="3321717">:</span>&nbsp;<span class="ident" id="3321719">newIdent</span><span class="op" id="3321727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321730">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321733">newField</span><span class="op" id="3321741">.</span><span class="ident" id="3321742">Type</span>&nbsp;<span class="op" id="3321747">=</span>&nbsp;<span class="ident" id="3321749">typ</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3321755">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;list&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321820">newFieldList</span>&nbsp;<span class="op" id="3321833">:=</span>&nbsp;<span class="op" id="3321836">*</span><span class="ident" id="3321837">f</span><span class="op" id="3321838">.</span><span class="ident" id="3321839">Decl</span><span class="op" id="3321843">.</span><span class="ident" id="3321844">Recv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321850">newFieldList</span><span class="op" id="3321862">.</span><span class="ident" id="3321863">List</span>&nbsp;<span class="op" id="3321868">=</span>&nbsp;<span class="op" id="3321870">[</span><span class="op" id="3321871">]</span><span class="op" id="3321872">*</span><span class="ident" id="3321873">ast</span><span class="op" id="3321876">.</span><span class="ident" id="3321877">Field</span><span class="op" id="3321882">{</span><span class="op" id="3321883">&amp;</span><span class="ident" id="3321884">newField</span><span class="op" id="3321892">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3321896">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;declaration&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321967">newFuncDecl</span>&nbsp;<span class="op" id="3321979">:=</span>&nbsp;<span class="op" id="3321982">*</span><span class="ident" id="3321983">f</span><span class="op" id="3321984">.</span><span class="ident" id="3321985">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321991">newFuncDecl</span><span class="op" id="3322002">.</span><span class="ident" id="3322003">Recv</span>&nbsp;<span class="op" id="3322008">=</span>&nbsp;<span class="op" id="3322010">&amp;</span><span class="ident" id="3322011">newFieldList</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322026">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;documentation&nbsp;and&nbsp;set&nbsp;new&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322091">newF</span>&nbsp;<span class="op" id="3322096">:=</span>&nbsp;<span class="op" id="3322099">*</span><span class="ident" id="3322100">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322103">newF</span><span class="op" id="3322107">.</span><span class="ident" id="3322108">Decl</span>&nbsp;<span class="op" id="3322113">=</span>&nbsp;<span class="op" id="3322115">&amp;</span><span class="ident" id="3322116">newFuncDecl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322129">newF</span><span class="op" id="3322133">.</span><span class="ident" id="3322134">Recv</span>&nbsp;<span class="op" id="3322139">=</span>&nbsp;<span class="ident" id="3322141">recvString</span><span class="op" id="3322151">(</span><span class="ident" id="3322152">typ</span><span class="op" id="3322155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322158">//&nbsp;the&nbsp;Orig&nbsp;field&nbsp;never&nbsp;changes</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322191">newF</span><span class="op" id="3322195">.</span><span class="ident" id="3322196">Level</span>&nbsp;<span class="op" id="3322202">=</span>&nbsp;<span class="ident" id="3322204">level</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322212">return</span>&nbsp;<span class="op" id="3322219">&amp;</span><span class="ident" id="3322220">newF</span><br>
<span class="lineno"></span><span class="op" id="3322225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="comment" id="3322228">//&nbsp;collectEmbeddedMethods&nbsp;collects&nbsp;the&nbsp;embedded&nbsp;methods&nbsp;of&nbsp;typ&nbsp;in&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="3322300">//</span><br>
<span class="lineno"></span><span class="keyword" id="3322303">func</span>&nbsp;<span class="op" id="3322308">(</span><span class="ident" id="3322309">r</span>&nbsp;<span class="op" id="3322311">*</span><span class="ident" id="3322312">reader</span><span class="op" id="3322318">)</span>&nbsp;<span class="ident" id="3322320">collectEmbeddedMethods</span><span class="op" id="3322342">(</span><span class="ident" id="3322343">mset</span>&nbsp;<span class="ident" id="3322348">methodSet</span><span class="op" id="3322357">,</span>&nbsp;<span class="ident" id="3322359">typ</span>&nbsp;<span class="op" id="3322363">*</span><span class="ident" id="3322364">namedType</span><span class="op" id="3322373">,</span>&nbsp;<span class="ident" id="3322375">recvTypeName</span>&nbsp;<span class="builtintype" id="3322388">string</span><span class="op" id="3322394">,</span>&nbsp;<span class="ident" id="3322396">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="3322410">bool</span><span class="op" id="3322414">,</span>&nbsp;<span class="ident" id="3322416">level</span>&nbsp;<span class="builtintype" id="3322422">int</span><span class="op" id="3322425">,</span>&nbsp;<span class="ident" id="3322427">visited</span>&nbsp;<span class="ident" id="3322435">embeddedSet</span><span class="op" id="3322446">)</span>&nbsp;<span class="op" id="3322448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322451">visited</span><span class="op" id="3322458">[</span><span class="ident" id="3322459">typ</span><span class="op" id="3322462">]</span>&nbsp;<span class="op" id="3322464">=</span>&nbsp;<span class="builtintype" id="3322466">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322472">for</span>&nbsp;<span class="ident" id="3322476">embedded</span><span class="op" id="3322484">,</span>&nbsp;<span class="ident" id="3322486">isPtr</span>&nbsp;<span class="op" id="3322492">:=</span>&nbsp;<span class="keyword" id="3322495">range</span>&nbsp;<span class="ident" id="3322501">typ</span><span class="op" id="3322504">.</span><span class="ident" id="3322505">embedded</span>&nbsp;<span class="op" id="3322514">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322518">//&nbsp;Once&nbsp;an&nbsp;embedded&nbsp;type&nbsp;is&nbsp;embedded&nbsp;as&nbsp;a&nbsp;pointer&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322575">//&nbsp;all&nbsp;embedded&nbsp;types&nbsp;in&nbsp;those&nbsp;types&nbsp;are&nbsp;treated&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322631">//&nbsp;pointer&nbsp;types&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;receiver&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322687">//&nbsp;computation;&nbsp;i.e.,&nbsp;embeddedIsPtr&nbsp;is&nbsp;sticky&nbsp;for&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322744">//&nbsp;embedding&nbsp;hierarchy.</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322770">thisEmbeddedIsPtr</span>&nbsp;<span class="op" id="3322788">:=</span>&nbsp;<span class="ident" id="3322791">embeddedIsPtr</span>&nbsp;<span class="op" id="3322805">||</span>&nbsp;<span class="ident" id="3322808">isPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322816">for</span>&nbsp;<span class="ident" id="3322820">_</span><span class="op" id="3322821">,</span>&nbsp;<span class="ident" id="3322823">m</span>&nbsp;<span class="op" id="3322825">:=</span>&nbsp;<span class="keyword" id="3322828">range</span>&nbsp;<span class="ident" id="3322834">embedded</span><span class="op" id="3322842">.</span><span class="ident" id="3322843">methods</span>&nbsp;<span class="op" id="3322851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322856">//&nbsp;only&nbsp;top-level&nbsp;methods&nbsp;are&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322898">if</span>&nbsp;<span class="ident" id="3322901">m</span><span class="op" id="3322902">.</span><span class="ident" id="3322903">Level</span>&nbsp;<span class="op" id="3322909">==</span>&nbsp;<span class="num" id="3322912">0</span>&nbsp;<span class="op" id="3322914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322920">mset</span><span class="op" id="3322924">.</span><span class="ident" id="3322925">add</span><span class="op" id="3322928">(</span><span class="ident" id="3322929">customizeRecv</span><span class="op" id="3322942">(</span><span class="ident" id="3322943">m</span><span class="op" id="3322944">,</span>&nbsp;<span class="ident" id="3322946">recvTypeName</span><span class="op" id="3322958">,</span>&nbsp;<span class="ident" id="3322960">thisEmbeddedIsPtr</span><span class="op" id="3322977">,</span>&nbsp;<span class="ident" id="3322979">level</span><span class="op" id="3322984">)</span><span class="op" id="3322985">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322998">if</span>&nbsp;<span class="op" id="3323001">!</span><span class="ident" id="3323002">visited</span><span class="op" id="3323009">[</span><span class="ident" id="3323010">embedded</span><span class="op" id="3323018">]</span>&nbsp;<span class="op" id="3323020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323025">r</span><span class="op" id="3323026">.</span><span class="ident" id="3323027">collectEmbeddedMethods</span><span class="op" id="3323049">(</span><span class="ident" id="3323050">mset</span><span class="op" id="3323054">,</span>&nbsp;<span class="ident" id="3323056">embedded</span><span class="op" id="3323064">,</span>&nbsp;<span class="ident" id="3323066">recvTypeName</span><span class="op" id="3323078">,</span>&nbsp;<span class="ident" id="3323080">thisEmbeddedIsPtr</span><span class="op" id="3323097">,</span>&nbsp;<span class="ident" id="3323099">level</span><span class="op" id="3323104">+</span><span class="num" id="3323105">1</span><span class="op" id="3323106">,</span>&nbsp;<span class="ident" id="3323108">visited</span><span class="op" id="3323115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323119">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3323125">delete</span><span class="op" id="3323131">(</span><span class="ident" id="3323132">visited</span><span class="op" id="3323139">,</span>&nbsp;<span class="ident" id="3323141">typ</span><span class="op" id="3323144">)</span><br>
<span class="lineno"></span><span class="op" id="3323146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3323149">//&nbsp;computeMethodSets&nbsp;determines&nbsp;the&nbsp;actual&nbsp;method&nbsp;sets&nbsp;for&nbsp;each&nbsp;type&nbsp;encountered.</span><br>
<span class="lineno">615</span><span class="comment" id="3323231">//</span><br>
<span class="lineno"></span><span class="keyword" id="3323234">func</span>&nbsp;<span class="op" id="3323239">(</span><span class="ident" id="3323240">r</span>&nbsp;<span class="op" id="3323242">*</span><span class="ident" id="3323243">reader</span><span class="op" id="3323249">)</span>&nbsp;<span class="ident" id="3323251">computeMethodSets</span><span class="op" id="3323268">(</span><span class="op" id="3323269">)</span>&nbsp;<span class="op" id="3323271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323274">for</span>&nbsp;<span class="ident" id="3323278">_</span><span class="op" id="3323279">,</span>&nbsp;<span class="ident" id="3323281">t</span>&nbsp;<span class="op" id="3323283">:=</span>&nbsp;<span class="keyword" id="3323286">range</span>&nbsp;<span class="ident" id="3323292">r</span><span class="op" id="3323293">.</span><span class="ident" id="3323294">types</span>&nbsp;<span class="op" id="3323300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3323304">//&nbsp;collect&nbsp;embedded&nbsp;methods&nbsp;for&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323340">if</span>&nbsp;<span class="ident" id="3323343">t</span><span class="op" id="3323344">.</span><span class="ident" id="3323345">isStruct</span>&nbsp;<span class="op" id="3323354">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3323359">//&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323372">r</span><span class="op" id="3323373">.</span><span class="ident" id="3323374">collectEmbeddedMethods</span><span class="op" id="3323396">(</span><span class="ident" id="3323397">t</span><span class="op" id="3323398">.</span><span class="ident" id="3323399">methods</span><span class="op" id="3323406">,</span>&nbsp;<span class="ident" id="3323408">t</span><span class="op" id="3323409">,</span>&nbsp;<span class="ident" id="3323411">t</span><span class="op" id="3323412">.</span><span class="ident" id="3323413">name</span><span class="op" id="3323417">,</span>&nbsp;<span class="builtintype" id="3323419">false</span><span class="op" id="3323424">,</span>&nbsp;<span class="num" id="3323426">1</span><span class="op" id="3323427">,</span>&nbsp;<span class="builtinfunc" id="3323429">make</span><span class="op" id="3323433">(</span><span class="ident" id="3323434">embeddedSet</span><span class="op" id="3323445">)</span><span class="op" id="3323446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323450">}</span>&nbsp;<span class="keyword" id="3323452">else</span>&nbsp;<span class="op" id="3323457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3323462">//&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3323478">//&nbsp;TODO(gri)&nbsp;fix&nbsp;this</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3323509">//&nbsp;if&nbsp;error&nbsp;was&nbsp;declared&nbsp;locally,&nbsp;don&#39;t&nbsp;treat&nbsp;it&nbsp;as&nbsp;exported&nbsp;field&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323585">if</span>&nbsp;<span class="ident" id="3323588">r</span><span class="op" id="3323589">.</span><span class="ident" id="3323590">errorDecl</span>&nbsp;<span class="op" id="3323600">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323604">for</span>&nbsp;<span class="ident" id="3323608">_</span><span class="op" id="3323609">,</span>&nbsp;<span class="ident" id="3323611">ityp</span>&nbsp;<span class="op" id="3323616">:=</span>&nbsp;<span class="keyword" id="3323619">range</span>&nbsp;<span class="ident" id="3323625">r</span><span class="op" id="3323626">.</span><span class="ident" id="3323627">fixlist</span>&nbsp;<span class="op" id="3323635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323640">removeErrorField</span><span class="op" id="3323656">(</span><span class="ident" id="3323657">ityp</span><span class="op" id="3323661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323668">}</span><br>
<span class="lineno"></span><span class="op" id="3323670">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3323673">//&nbsp;cleanupTypes&nbsp;removes&nbsp;the&nbsp;association&nbsp;of&nbsp;functions&nbsp;and&nbsp;methods&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3323743">//&nbsp;types&nbsp;that&nbsp;have&nbsp;no&nbsp;declaration.&nbsp;Instead,&nbsp;these&nbsp;functions&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="3323815">//&nbsp;are&nbsp;shown&nbsp;at&nbsp;the&nbsp;package&nbsp;level.&nbsp;It&nbsp;also&nbsp;removes&nbsp;types&nbsp;with&nbsp;missing</span><br>
<span class="lineno"></span><span class="comment" id="3323885">//&nbsp;declarations&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible.</span><br>
<span class="lineno">640</span><span class="comment" id="3323927">//</span><br>
<span class="lineno"></span><span class="keyword" id="3323930">func</span>&nbsp;<span class="op" id="3323935">(</span><span class="ident" id="3323936">r</span>&nbsp;<span class="op" id="3323938">*</span><span class="ident" id="3323939">reader</span><span class="op" id="3323945">)</span>&nbsp;<span class="ident" id="3323947">cleanupTypes</span><span class="op" id="3323959">(</span><span class="op" id="3323960">)</span>&nbsp;<span class="op" id="3323962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323965">for</span>&nbsp;<span class="ident" id="3323969">_</span><span class="op" id="3323970">,</span>&nbsp;<span class="ident" id="3323972">t</span>&nbsp;<span class="op" id="3323974">:=</span>&nbsp;<span class="keyword" id="3323977">range</span>&nbsp;<span class="ident" id="3323983">r</span><span class="op" id="3323984">.</span><span class="ident" id="3323985">types</span>&nbsp;<span class="op" id="3323991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323995">visible</span>&nbsp;<span class="op" id="3324003">:=</span>&nbsp;<span class="ident" id="3324006">r</span><span class="op" id="3324007">.</span><span class="ident" id="3324008">isVisible</span><span class="op" id="3324017">(</span><span class="ident" id="3324018">t</span><span class="op" id="3324019">.</span><span class="ident" id="3324020">name</span><span class="op" id="3324024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324028">if</span>&nbsp;<span class="ident" id="3324031">t</span><span class="op" id="3324032">.</span><span class="ident" id="3324033">decl</span>&nbsp;<span class="op" id="3324038">==</span>&nbsp;<span class="ident" id="3324041">nil</span>&nbsp;<span class="op" id="3324045">&amp;&amp;</span>&nbsp;<span class="op" id="3324048">(</span><span class="ident" id="3324049">predeclaredTypes</span><span class="op" id="3324065">[</span><span class="ident" id="3324066">t</span><span class="op" id="3324067">.</span><span class="ident" id="3324068">name</span><span class="op" id="3324072">]</span>&nbsp;<span class="op" id="3324074">||</span>&nbsp;<span class="ident" id="3324077">t</span><span class="op" id="3324078">.</span><span class="ident" id="3324079">isEmbedded</span>&nbsp;<span class="op" id="3324090">&amp;&amp;</span>&nbsp;<span class="ident" id="3324093">visible</span><span class="op" id="3324100">)</span>&nbsp;<span class="op" id="3324102">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324107">//&nbsp;t.name&nbsp;is&nbsp;a&nbsp;predeclared&nbsp;type&nbsp;(and&nbsp;was&nbsp;not&nbsp;redeclared&nbsp;in&nbsp;this&nbsp;package),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324184">//&nbsp;or&nbsp;it&nbsp;was&nbsp;embedded&nbsp;somewhere&nbsp;but&nbsp;its&nbsp;declaration&nbsp;is&nbsp;missing&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324259">//&nbsp;the&nbsp;AST&nbsp;is&nbsp;incomplete):&nbsp;move&nbsp;any&nbsp;associated&nbsp;values,&nbsp;funcs,&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324336">//&nbsp;back&nbsp;to&nbsp;the&nbsp;top-level&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;lost.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324391">//&nbsp;1)&nbsp;move&nbsp;values</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324412">r</span><span class="op" id="3324413">.</span><span class="ident" id="3324414">values</span>&nbsp;<span class="op" id="3324421">=</span>&nbsp;<span class="builtinfunc" id="3324423">append</span><span class="op" id="3324429">(</span><span class="ident" id="3324430">r</span><span class="op" id="3324431">.</span><span class="ident" id="3324432">values</span><span class="op" id="3324438">,</span>&nbsp;<span class="ident" id="3324440">t</span><span class="op" id="3324441">.</span><span class="ident" id="3324442">values</span><span class="op" id="3324448">...</span><span class="op" id="3324451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324456">//&nbsp;2)&nbsp;move&nbsp;factory&nbsp;functions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324488">for</span>&nbsp;<span class="ident" id="3324492">name</span><span class="op" id="3324496">,</span>&nbsp;<span class="ident" id="3324498">f</span>&nbsp;<span class="op" id="3324500">:=</span>&nbsp;<span class="keyword" id="3324503">range</span>&nbsp;<span class="ident" id="3324509">t</span><span class="op" id="3324510">.</span><span class="ident" id="3324511">funcs</span>&nbsp;<span class="op" id="3324517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324523">//&nbsp;in&nbsp;a&nbsp;correct&nbsp;AST,&nbsp;package-level&nbsp;function&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324577">//&nbsp;are&nbsp;all&nbsp;different&nbsp;-&nbsp;no&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;conflicts</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324635">r</span><span class="op" id="3324636">.</span><span class="ident" id="3324637">funcs</span><span class="op" id="3324642">[</span><span class="ident" id="3324643">name</span><span class="op" id="3324647">]</span>&nbsp;<span class="op" id="3324649">=</span>&nbsp;<span class="ident" id="3324651">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324661">//&nbsp;3)&nbsp;move&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324683">for</span>&nbsp;<span class="ident" id="3324687">name</span><span class="op" id="3324691">,</span>&nbsp;<span class="ident" id="3324693">m</span>&nbsp;<span class="op" id="3324695">:=</span>&nbsp;<span class="keyword" id="3324698">range</span>&nbsp;<span class="ident" id="3324704">t</span><span class="op" id="3324705">.</span><span class="ident" id="3324706">methods</span>&nbsp;<span class="op" id="3324714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324720">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;functions&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;-&nbsp;drop&nbsp;them</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324784">if</span>&nbsp;<span class="ident" id="3324787">_</span><span class="op" id="3324788">,</span>&nbsp;<span class="ident" id="3324790">found</span>&nbsp;<span class="op" id="3324796">:=</span>&nbsp;<span class="ident" id="3324799">r</span><span class="op" id="3324800">.</span><span class="ident" id="3324801">funcs</span><span class="op" id="3324806">[</span><span class="ident" id="3324807">name</span><span class="op" id="3324811">]</span><span class="op" id="3324812">;</span>&nbsp;<span class="op" id="3324814">!</span><span class="ident" id="3324815">found</span>&nbsp;<span class="op" id="3324821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324828">r</span><span class="op" id="3324829">.</span><span class="ident" id="3324830">funcs</span><span class="op" id="3324835">[</span><span class="ident" id="3324836">name</span><span class="op" id="3324840">]</span>&nbsp;<span class="op" id="3324842">=</span>&nbsp;<span class="ident" id="3324844">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324859">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324863">//&nbsp;remove&nbsp;types&nbsp;w/o&nbsp;declaration&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324922">if</span>&nbsp;<span class="ident" id="3324925">t</span><span class="op" id="3324926">.</span><span class="ident" id="3324927">decl</span>&nbsp;<span class="op" id="3324932">==</span>&nbsp;<span class="ident" id="3324935">nil</span>&nbsp;<span class="op" id="3324939">||</span>&nbsp;<span class="op" id="3324942">!</span><span class="ident" id="3324943">visible</span>&nbsp;<span class="op" id="3324951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3324956">delete</span><span class="op" id="3324962">(</span><span class="ident" id="3324963">r</span><span class="op" id="3324964">.</span><span class="ident" id="3324965">types</span><span class="op" id="3324970">,</span>&nbsp;<span class="ident" id="3324972">t</span><span class="op" id="3324973">.</span><span class="ident" id="3324974">name</span><span class="op" id="3324978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324985">}</span><br>
<span class="lineno">670</span><span class="op" id="3324987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3324990">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3325070">//&nbsp;Sorting</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="3325082">type</span>&nbsp;<span class="ident" id="3325087">data</span>&nbsp;<span class="keyword" id="3325092">struct</span>&nbsp;<span class="op" id="3325099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325102">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3325107">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325112">swap</span>&nbsp;<span class="keyword" id="3325117">func</span><span class="op" id="3325121">(</span><span class="ident" id="3325122">i</span><span class="op" id="3325123">,</span>&nbsp;<span class="ident" id="3325125">j</span>&nbsp;<span class="builtintype" id="3325127">int</span><span class="op" id="3325130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325133">less</span>&nbsp;<span class="keyword" id="3325138">func</span><span class="op" id="3325142">(</span><span class="ident" id="3325143">i</span><span class="op" id="3325144">,</span>&nbsp;<span class="ident" id="3325146">j</span>&nbsp;<span class="builtintype" id="3325148">int</span><span class="op" id="3325151">)</span>&nbsp;<span class="builtintype" id="3325153">bool</span><br>
<span class="lineno"></span><span class="op" id="3325158">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="3325161">func</span>&nbsp;<span class="op" id="3325166">(</span><span class="ident" id="3325167">d</span>&nbsp;<span class="op" id="3325169">*</span><span class="ident" id="3325170">data</span><span class="op" id="3325174">)</span>&nbsp;<span class="ident" id="3325176">Len</span><span class="op" id="3325179">(</span><span class="op" id="3325180">)</span>&nbsp;<span class="builtintype" id="3325182">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3325196">{</span>&nbsp;<span class="keyword" id="3325198">return</span>&nbsp;<span class="ident" id="3325205">d</span><span class="op" id="3325206">.</span><span class="ident" id="3325207">n</span>&nbsp;<span class="op" id="3325209">}</span><br>
<span class="lineno"></span><span class="keyword" id="3325211">func</span>&nbsp;<span class="op" id="3325216">(</span><span class="ident" id="3325217">d</span>&nbsp;<span class="op" id="3325219">*</span><span class="ident" id="3325220">data</span><span class="op" id="3325224">)</span>&nbsp;<span class="ident" id="3325226">Swap</span><span class="op" id="3325230">(</span><span class="ident" id="3325231">i</span><span class="op" id="3325232">,</span>&nbsp;<span class="ident" id="3325234">j</span>&nbsp;<span class="builtintype" id="3325236">int</span><span class="op" id="3325239">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3325246">{</span>&nbsp;<span class="ident" id="3325248">d</span><span class="op" id="3325249">.</span><span class="ident" id="3325250">swap</span><span class="op" id="3325254">(</span><span class="ident" id="3325255">i</span><span class="op" id="3325256">,</span>&nbsp;<span class="ident" id="3325258">j</span><span class="op" id="3325259">)</span>&nbsp;<span class="op" id="3325261">}</span><br>
<span class="lineno"></span><span class="keyword" id="3325263">func</span>&nbsp;<span class="op" id="3325268">(</span><span class="ident" id="3325269">d</span>&nbsp;<span class="op" id="3325271">*</span><span class="ident" id="3325272">data</span><span class="op" id="3325276">)</span>&nbsp;<span class="ident" id="3325278">Less</span><span class="op" id="3325282">(</span><span class="ident" id="3325283">i</span><span class="op" id="3325284">,</span>&nbsp;<span class="ident" id="3325286">j</span>&nbsp;<span class="builtintype" id="3325288">int</span><span class="op" id="3325291">)</span>&nbsp;<span class="builtintype" id="3325293">bool</span>&nbsp;<span class="op" id="3325298">{</span>&nbsp;<span class="keyword" id="3325300">return</span>&nbsp;<span class="ident" id="3325307">d</span><span class="op" id="3325308">.</span><span class="ident" id="3325309">less</span><span class="op" id="3325313">(</span><span class="ident" id="3325314">i</span><span class="op" id="3325315">,</span>&nbsp;<span class="ident" id="3325317">j</span><span class="op" id="3325318">)</span>&nbsp;<span class="op" id="3325320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="comment" id="3325323">//&nbsp;sortBy&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;sorting</span><br>
<span class="lineno"></span><span class="keyword" id="3325366">func</span>&nbsp;<span class="ident" id="3325371">sortBy</span><span class="op" id="3325377">(</span><span class="ident" id="3325378">less</span>&nbsp;<span class="keyword" id="3325383">func</span><span class="op" id="3325387">(</span><span class="ident" id="3325388">i</span><span class="op" id="3325389">,</span>&nbsp;<span class="ident" id="3325391">j</span>&nbsp;<span class="builtintype" id="3325393">int</span><span class="op" id="3325396">)</span>&nbsp;<span class="builtintype" id="3325398">bool</span><span class="op" id="3325402">,</span>&nbsp;<span class="ident" id="3325404">swap</span>&nbsp;<span class="keyword" id="3325409">func</span><span class="op" id="3325413">(</span><span class="ident" id="3325414">i</span><span class="op" id="3325415">,</span>&nbsp;<span class="ident" id="3325417">j</span>&nbsp;<span class="builtintype" id="3325419">int</span><span class="op" id="3325422">)</span><span class="op" id="3325423">,</span>&nbsp;<span class="ident" id="3325425">n</span>&nbsp;<span class="builtintype" id="3325427">int</span><span class="op" id="3325430">)</span>&nbsp;<span class="op" id="3325432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325435">sort</span><span class="op" id="3325439">.</span><span class="ident" id="3325440">Sort</span><span class="op" id="3325444">(</span><span class="op" id="3325445">&amp;</span><span class="ident" id="3325446">data</span><span class="op" id="3325450">{</span><span class="ident" id="3325451">n</span><span class="op" id="3325452">,</span>&nbsp;<span class="ident" id="3325454">swap</span><span class="op" id="3325458">,</span>&nbsp;<span class="ident" id="3325460">less</span><span class="op" id="3325464">}</span><span class="op" id="3325465">)</span><br>
<span class="lineno"></span><span class="op" id="3325467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="3325470">func</span>&nbsp;<span class="ident" id="3325475">sortedKeys</span><span class="op" id="3325485">(</span><span class="ident" id="3325486">m</span>&nbsp;<span class="keyword" id="3325488">map</span><span class="op" id="3325491">[</span><span class="builtintype" id="3325492">string</span><span class="op" id="3325498">]</span><span class="builtintype" id="3325499">int</span><span class="op" id="3325502">)</span>&nbsp;<span class="op" id="3325504">[</span><span class="op" id="3325505">]</span><span class="builtintype" id="3325506">string</span>&nbsp;<span class="op" id="3325513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325516">list</span>&nbsp;<span class="op" id="3325521">:=</span>&nbsp;<span class="builtinfunc" id="3325524">make</span><span class="op" id="3325528">(</span><span class="op" id="3325529">[</span><span class="op" id="3325530">]</span><span class="builtintype" id="3325531">string</span><span class="op" id="3325537">,</span>&nbsp;<span class="builtinfunc" id="3325539">len</span><span class="op" id="3325542">(</span><span class="ident" id="3325543">m</span><span class="op" id="3325544">)</span><span class="op" id="3325545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325548">i</span>&nbsp;<span class="op" id="3325550">:=</span>&nbsp;<span class="num" id="3325553">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325556">for</span>&nbsp;<span class="ident" id="3325560">key</span>&nbsp;<span class="op" id="3325564">:=</span>&nbsp;<span class="keyword" id="3325567">range</span>&nbsp;<span class="ident" id="3325573">m</span>&nbsp;<span class="op" id="3325575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325579">list</span><span class="op" id="3325583">[</span><span class="ident" id="3325584">i</span><span class="op" id="3325585">]</span>&nbsp;<span class="op" id="3325587">=</span>&nbsp;<span class="ident" id="3325589">key</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325595">i</span><span class="op" id="3325596">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3325600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325603">sort</span><span class="op" id="3325607">.</span><span class="ident" id="3325608">Strings</span><span class="op" id="3325615">(</span><span class="ident" id="3325616">list</span><span class="op" id="3325620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325623">return</span>&nbsp;<span class="ident" id="3325630">list</span><br>
<span class="lineno"></span><span class="op" id="3325635">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="comment" id="3325638">//&nbsp;sortingName&nbsp;returns&nbsp;the&nbsp;name&nbsp;to&nbsp;use&nbsp;when&nbsp;sorting&nbsp;d&nbsp;into&nbsp;place.</span><br>
<span class="lineno"></span><span class="comment" id="3325704">//</span><br>
<span class="lineno"></span><span class="keyword" id="3325707">func</span>&nbsp;<span class="ident" id="3325712">sortingName</span><span class="op" id="3325723">(</span><span class="ident" id="3325724">d</span>&nbsp;<span class="op" id="3325726">*</span><span class="ident" id="3325727">ast</span><span class="op" id="3325730">.</span><span class="ident" id="3325731">GenDecl</span><span class="op" id="3325738">)</span>&nbsp;<span class="builtintype" id="3325740">string</span>&nbsp;<span class="op" id="3325747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325750">if</span>&nbsp;<span class="builtinfunc" id="3325753">len</span><span class="op" id="3325756">(</span><span class="ident" id="3325757">d</span><span class="op" id="3325758">.</span><span class="ident" id="3325759">Specs</span><span class="op" id="3325764">)</span>&nbsp;<span class="op" id="3325766">==</span>&nbsp;<span class="num" id="3325769">1</span>&nbsp;<span class="op" id="3325771">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325775">if</span>&nbsp;<span class="ident" id="3325778">s</span><span class="op" id="3325779">,</span>&nbsp;<span class="ident" id="3325781">ok</span>&nbsp;<span class="op" id="3325784">:=</span>&nbsp;<span class="ident" id="3325787">d</span><span class="op" id="3325788">.</span><span class="ident" id="3325789">Specs</span><span class="op" id="3325794">[</span><span class="num" id="3325795">0</span><span class="op" id="3325796">]</span><span class="op" id="3325797">.</span><span class="op" id="3325798">(</span><span class="op" id="3325799">*</span><span class="ident" id="3325800">ast</span><span class="op" id="3325803">.</span><span class="ident" id="3325804">ValueSpec</span><span class="op" id="3325813">)</span><span class="op" id="3325814">;</span>&nbsp;<span class="ident" id="3325816">ok</span>&nbsp;<span class="op" id="3325819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325824">return</span>&nbsp;<span class="ident" id="3325831">s</span><span class="op" id="3325832">.</span><span class="ident" id="3325833">Names</span><span class="op" id="3325838">[</span><span class="num" id="3325839">0</span><span class="op" id="3325840">]</span><span class="op" id="3325841">.</span><span class="ident" id="3325842">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3325849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3325852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325855">return</span>&nbsp;<span class="string" id="3325862">&#34;&#34;</span><br>
<span class="lineno">710</span><span class="op" id="3325865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3325868">func</span>&nbsp;<span class="ident" id="3325873">sortedValues</span><span class="op" id="3325885">(</span><span class="ident" id="3325886">m</span>&nbsp;<span class="op" id="3325888">[</span><span class="op" id="3325889">]</span><span class="op" id="3325890">*</span><span class="ident" id="3325891">Value</span><span class="op" id="3325896">,</span>&nbsp;<span class="ident" id="3325898">tok</span>&nbsp;<span class="ident" id="3325902">token</span><span class="op" id="3325907">.</span><span class="ident" id="3325908">Token</span><span class="op" id="3325913">)</span>&nbsp;<span class="op" id="3325915">[</span><span class="op" id="3325916">]</span><span class="op" id="3325917">*</span><span class="ident" id="3325918">Value</span>&nbsp;<span class="op" id="3325924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325927">list</span>&nbsp;<span class="op" id="3325932">:=</span>&nbsp;<span class="builtinfunc" id="3325935">make</span><span class="op" id="3325939">(</span><span class="op" id="3325940">[</span><span class="op" id="3325941">]</span><span class="op" id="3325942">*</span><span class="ident" id="3325943">Value</span><span class="op" id="3325948">,</span>&nbsp;<span class="builtinfunc" id="3325950">len</span><span class="op" id="3325953">(</span><span class="ident" id="3325954">m</span><span class="op" id="3325955">)</span><span class="op" id="3325956">)</span>&nbsp;<span class="comment" id="3325958">//&nbsp;big&nbsp;enough&nbsp;in&nbsp;any&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325985">i</span>&nbsp;<span class="op" id="3325987">:=</span>&nbsp;<span class="num" id="3325990">0</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325993">for</span>&nbsp;<span class="ident" id="3325997">_</span><span class="op" id="3325998">,</span>&nbsp;<span class="ident" id="3326000">val</span>&nbsp;<span class="op" id="3326004">:=</span>&nbsp;<span class="keyword" id="3326007">range</span>&nbsp;<span class="ident" id="3326013">m</span>&nbsp;<span class="op" id="3326015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326019">if</span>&nbsp;<span class="ident" id="3326022">val</span><span class="op" id="3326025">.</span><span class="ident" id="3326026">Decl</span><span class="op" id="3326030">.</span><span class="ident" id="3326031">Tok</span>&nbsp;<span class="op" id="3326035">==</span>&nbsp;<span class="ident" id="3326038">tok</span>&nbsp;<span class="op" id="3326042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326047">list</span><span class="op" id="3326051">[</span><span class="ident" id="3326052">i</span><span class="op" id="3326053">]</span>&nbsp;<span class="op" id="3326055">=</span>&nbsp;<span class="ident" id="3326057">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326064">i</span><span class="op" id="3326065">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326070">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326076">list</span>&nbsp;<span class="op" id="3326081">=</span>&nbsp;<span class="ident" id="3326083">list</span><span class="op" id="3326087">[</span><span class="num" id="3326088">0</span><span class="op" id="3326089">:</span><span class="ident" id="3326090">i</span><span class="op" id="3326091">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326095">sortBy</span><span class="op" id="3326101">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326105">func</span><span class="op" id="3326109">(</span><span class="ident" id="3326110">i</span><span class="op" id="3326111">,</span>&nbsp;<span class="ident" id="3326113">j</span>&nbsp;<span class="builtintype" id="3326115">int</span><span class="op" id="3326118">)</span>&nbsp;<span class="builtintype" id="3326120">bool</span>&nbsp;<span class="op" id="3326125">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326130">if</span>&nbsp;<span class="ident" id="3326133">ni</span><span class="op" id="3326135">,</span>&nbsp;<span class="ident" id="3326137">nj</span>&nbsp;<span class="op" id="3326140">:=</span>&nbsp;<span class="ident" id="3326143">sortingName</span><span class="op" id="3326154">(</span><span class="ident" id="3326155">list</span><span class="op" id="3326159">[</span><span class="ident" id="3326160">i</span><span class="op" id="3326161">]</span><span class="op" id="3326162">.</span><span class="ident" id="3326163">Decl</span><span class="op" id="3326167">)</span><span class="op" id="3326168">,</span>&nbsp;<span class="ident" id="3326170">sortingName</span><span class="op" id="3326181">(</span><span class="ident" id="3326182">list</span><span class="op" id="3326186">[</span><span class="ident" id="3326187">j</span><span class="op" id="3326188">]</span><span class="op" id="3326189">.</span><span class="ident" id="3326190">Decl</span><span class="op" id="3326194">)</span><span class="op" id="3326195">;</span>&nbsp;<span class="ident" id="3326197">ni</span>&nbsp;<span class="op" id="3326200">!=</span>&nbsp;<span class="ident" id="3326203">nj</span>&nbsp;<span class="op" id="3326206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326212">return</span>&nbsp;<span class="ident" id="3326219">ni</span>&nbsp;<span class="op" id="3326222">&lt;</span>&nbsp;<span class="ident" id="3326224">nj</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326235">return</span>&nbsp;<span class="ident" id="3326242">list</span><span class="op" id="3326246">[</span><span class="ident" id="3326247">i</span><span class="op" id="3326248">]</span><span class="op" id="3326249">.</span><span class="ident" id="3326250">order</span>&nbsp;<span class="op" id="3326256">&lt;</span>&nbsp;<span class="ident" id="3326258">list</span><span class="op" id="3326262">[</span><span class="ident" id="3326263">j</span><span class="op" id="3326264">]</span><span class="op" id="3326265">.</span><span class="ident" id="3326266">order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326274">}</span><span class="op" id="3326275">,</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326279">func</span><span class="op" id="3326283">(</span><span class="ident" id="3326284">i</span><span class="op" id="3326285">,</span>&nbsp;<span class="ident" id="3326287">j</span>&nbsp;<span class="builtintype" id="3326289">int</span><span class="op" id="3326292">)</span>&nbsp;<span class="op" id="3326294">{</span>&nbsp;<span class="ident" id="3326296">list</span><span class="op" id="3326300">[</span><span class="ident" id="3326301">i</span><span class="op" id="3326302">]</span><span class="op" id="3326303">,</span>&nbsp;<span class="ident" id="3326305">list</span><span class="op" id="3326309">[</span><span class="ident" id="3326310">j</span><span class="op" id="3326311">]</span>&nbsp;<span class="op" id="3326313">=</span>&nbsp;<span class="ident" id="3326315">list</span><span class="op" id="3326319">[</span><span class="ident" id="3326320">j</span><span class="op" id="3326321">]</span><span class="op" id="3326322">,</span>&nbsp;<span class="ident" id="3326324">list</span><span class="op" id="3326328">[</span><span class="ident" id="3326329">i</span><span class="op" id="3326330">]</span>&nbsp;<span class="op" id="3326332">}</span><span class="op" id="3326333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3326337">len</span><span class="op" id="3326340">(</span><span class="ident" id="3326341">list</span><span class="op" id="3326345">)</span><span class="op" id="3326346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326353">return</span>&nbsp;<span class="ident" id="3326360">list</span><br>
<span class="lineno">735</span><span class="op" id="3326365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3326368">func</span>&nbsp;<span class="ident" id="3326373">sortedTypes</span><span class="op" id="3326384">(</span><span class="ident" id="3326385">m</span>&nbsp;<span class="keyword" id="3326387">map</span><span class="op" id="3326390">[</span><span class="builtintype" id="3326391">string</span><span class="op" id="3326397">]</span><span class="op" id="3326398">*</span><span class="ident" id="3326399">namedType</span><span class="op" id="3326408">,</span>&nbsp;<span class="ident" id="3326410">allMethods</span>&nbsp;<span class="builtintype" id="3326421">bool</span><span class="op" id="3326425">)</span>&nbsp;<span class="op" id="3326427">[</span><span class="op" id="3326428">]</span><span class="op" id="3326429">*</span><span class="ident" id="3326430">Type</span>&nbsp;<span class="op" id="3326435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326438">list</span>&nbsp;<span class="op" id="3326443">:=</span>&nbsp;<span class="builtinfunc" id="3326446">make</span><span class="op" id="3326450">(</span><span class="op" id="3326451">[</span><span class="op" id="3326452">]</span><span class="op" id="3326453">*</span><span class="ident" id="3326454">Type</span><span class="op" id="3326458">,</span>&nbsp;<span class="builtinfunc" id="3326460">len</span><span class="op" id="3326463">(</span><span class="ident" id="3326464">m</span><span class="op" id="3326465">)</span><span class="op" id="3326466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326469">i</span>&nbsp;<span class="op" id="3326471">:=</span>&nbsp;<span class="num" id="3326474">0</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326477">for</span>&nbsp;<span class="ident" id="3326481">_</span><span class="op" id="3326482">,</span>&nbsp;<span class="ident" id="3326484">t</span>&nbsp;<span class="op" id="3326486">:=</span>&nbsp;<span class="keyword" id="3326489">range</span>&nbsp;<span class="ident" id="3326495">m</span>&nbsp;<span class="op" id="3326497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326501">list</span><span class="op" id="3326505">[</span><span class="ident" id="3326506">i</span><span class="op" id="3326507">]</span>&nbsp;<span class="op" id="3326509">=</span>&nbsp;<span class="op" id="3326511">&amp;</span><span class="ident" id="3326512">Type</span><span class="op" id="3326516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326521">Doc</span><span class="op" id="3326524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326530">t</span><span class="op" id="3326531">.</span><span class="ident" id="3326532">doc</span><span class="op" id="3326535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326540">Name</span><span class="op" id="3326544">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326549">t</span><span class="op" id="3326550">.</span><span class="ident" id="3326551">name</span><span class="op" id="3326555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326560">Decl</span><span class="op" id="3326564">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326569">t</span><span class="op" id="3326570">.</span><span class="ident" id="3326571">decl</span><span class="op" id="3326575">,</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326580">Consts</span><span class="op" id="3326586">:</span>&nbsp;&nbsp;<span class="ident" id="3326589">sortedValues</span><span class="op" id="3326601">(</span><span class="ident" id="3326602">t</span><span class="op" id="3326603">.</span><span class="ident" id="3326604">values</span><span class="op" id="3326610">,</span>&nbsp;<span class="ident" id="3326612">token</span><span class="op" id="3326617">.</span><span class="ident" id="3326618">CONST</span><span class="op" id="3326623">)</span><span class="op" id="3326624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326629">Vars</span><span class="op" id="3326633">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326638">sortedValues</span><span class="op" id="3326650">(</span><span class="ident" id="3326651">t</span><span class="op" id="3326652">.</span><span class="ident" id="3326653">values</span><span class="op" id="3326659">,</span>&nbsp;<span class="ident" id="3326661">token</span><span class="op" id="3326666">.</span><span class="ident" id="3326667">VAR</span><span class="op" id="3326670">)</span><span class="op" id="3326671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326676">Funcs</span><span class="op" id="3326681">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3326685">sortedFuncs</span><span class="op" id="3326696">(</span><span class="ident" id="3326697">t</span><span class="op" id="3326698">.</span><span class="ident" id="3326699">funcs</span><span class="op" id="3326704">,</span>&nbsp;<span class="builtintype" id="3326706">true</span><span class="op" id="3326710">)</span><span class="op" id="3326711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326716">Methods</span><span class="op" id="3326723">:</span>&nbsp;<span class="ident" id="3326725">sortedFuncs</span><span class="op" id="3326736">(</span><span class="ident" id="3326737">t</span><span class="op" id="3326738">.</span><span class="ident" id="3326739">methods</span><span class="op" id="3326746">,</span>&nbsp;<span class="ident" id="3326748">allMethods</span><span class="op" id="3326758">)</span><span class="op" id="3326759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326763">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326767">i</span><span class="op" id="3326768">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326776">sortBy</span><span class="op" id="3326782">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326786">func</span><span class="op" id="3326790">(</span><span class="ident" id="3326791">i</span><span class="op" id="3326792">,</span>&nbsp;<span class="ident" id="3326794">j</span>&nbsp;<span class="builtintype" id="3326796">int</span><span class="op" id="3326799">)</span>&nbsp;<span class="builtintype" id="3326801">bool</span>&nbsp;<span class="op" id="3326806">{</span>&nbsp;<span class="keyword" id="3326808">return</span>&nbsp;<span class="ident" id="3326815">list</span><span class="op" id="3326819">[</span><span class="ident" id="3326820">i</span><span class="op" id="3326821">]</span><span class="op" id="3326822">.</span><span class="ident" id="3326823">Name</span>&nbsp;<span class="op" id="3326828">&lt;</span>&nbsp;<span class="ident" id="3326830">list</span><span class="op" id="3326834">[</span><span class="ident" id="3326835">j</span><span class="op" id="3326836">]</span><span class="op" id="3326837">.</span><span class="ident" id="3326838">Name</span>&nbsp;<span class="op" id="3326843">}</span><span class="op" id="3326844">,</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326848">func</span><span class="op" id="3326852">(</span><span class="ident" id="3326853">i</span><span class="op" id="3326854">,</span>&nbsp;<span class="ident" id="3326856">j</span>&nbsp;<span class="builtintype" id="3326858">int</span><span class="op" id="3326861">)</span>&nbsp;<span class="op" id="3326863">{</span>&nbsp;<span class="ident" id="3326865">list</span><span class="op" id="3326869">[</span><span class="ident" id="3326870">i</span><span class="op" id="3326871">]</span><span class="op" id="3326872">,</span>&nbsp;<span class="ident" id="3326874">list</span><span class="op" id="3326878">[</span><span class="ident" id="3326879">j</span><span class="op" id="3326880">]</span>&nbsp;<span class="op" id="3326882">=</span>&nbsp;<span class="ident" id="3326884">list</span><span class="op" id="3326888">[</span><span class="ident" id="3326889">j</span><span class="op" id="3326890">]</span><span class="op" id="3326891">,</span>&nbsp;<span class="ident" id="3326893">list</span><span class="op" id="3326897">[</span><span class="ident" id="3326898">i</span><span class="op" id="3326899">]</span>&nbsp;<span class="op" id="3326901">}</span><span class="op" id="3326902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3326906">len</span><span class="op" id="3326909">(</span><span class="ident" id="3326910">list</span><span class="op" id="3326914">)</span><span class="op" id="3326915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326922">return</span>&nbsp;<span class="ident" id="3326929">list</span><br>
<span class="lineno">760</span><span class="op" id="3326934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3326937">func</span>&nbsp;<span class="ident" id="3326942">removeStar</span><span class="op" id="3326952">(</span><span class="ident" id="3326953">s</span>&nbsp;<span class="builtintype" id="3326955">string</span><span class="op" id="3326961">)</span>&nbsp;<span class="builtintype" id="3326963">string</span>&nbsp;<span class="op" id="3326970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326973">if</span>&nbsp;<span class="builtinfunc" id="3326976">len</span><span class="op" id="3326979">(</span><span class="ident" id="3326980">s</span><span class="op" id="3326981">)</span>&nbsp;<span class="op" id="3326983">&gt;</span>&nbsp;<span class="num" id="3326985">0</span>&nbsp;<span class="op" id="3326987">&amp;&amp;</span>&nbsp;<span class="ident" id="3326990">s</span><span class="op" id="3326991">[</span><span class="num" id="3326992">0</span><span class="op" id="3326993">]</span>&nbsp;<span class="op" id="3326995">==</span>&nbsp;<span class="string" id="3326998">&#39;*&#39;</span>&nbsp;<span class="op" id="3327002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327006">return</span>&nbsp;<span class="ident" id="3327013">s</span><span class="op" id="3327014">[</span><span class="num" id="3327015">1</span><span class="op" id="3327016">:</span><span class="op" id="3327017">]</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327023">return</span>&nbsp;<span class="ident" id="3327030">s</span><br>
<span class="lineno"></span><span class="op" id="3327032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3327035">func</span>&nbsp;<span class="ident" id="3327040">sortedFuncs</span><span class="op" id="3327051">(</span><span class="ident" id="3327052">m</span>&nbsp;<span class="ident" id="3327054">methodSet</span><span class="op" id="3327063">,</span>&nbsp;<span class="ident" id="3327065">allMethods</span>&nbsp;<span class="builtintype" id="3327076">bool</span><span class="op" id="3327080">)</span>&nbsp;<span class="op" id="3327082">[</span><span class="op" id="3327083">]</span><span class="op" id="3327084">*</span><span class="ident" id="3327085">Func</span>&nbsp;<span class="op" id="3327090">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327093">list</span>&nbsp;<span class="op" id="3327098">:=</span>&nbsp;<span class="builtinfunc" id="3327101">make</span><span class="op" id="3327105">(</span><span class="op" id="3327106">[</span><span class="op" id="3327107">]</span><span class="op" id="3327108">*</span><span class="ident" id="3327109">Func</span><span class="op" id="3327113">,</span>&nbsp;<span class="builtinfunc" id="3327115">len</span><span class="op" id="3327118">(</span><span class="ident" id="3327119">m</span><span class="op" id="3327120">)</span><span class="op" id="3327121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327124">i</span>&nbsp;<span class="op" id="3327126">:=</span>&nbsp;<span class="num" id="3327129">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327132">for</span>&nbsp;<span class="ident" id="3327136">_</span><span class="op" id="3327137">,</span>&nbsp;<span class="ident" id="3327139">m</span>&nbsp;<span class="op" id="3327141">:=</span>&nbsp;<span class="keyword" id="3327144">range</span>&nbsp;<span class="ident" id="3327150">m</span>&nbsp;<span class="op" id="3327152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3327156">//&nbsp;determine&nbsp;which&nbsp;methods&nbsp;to&nbsp;include</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327196">switch</span>&nbsp;<span class="op" id="3327203">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327207">case</span>&nbsp;<span class="ident" id="3327212">m</span><span class="op" id="3327213">.</span><span class="ident" id="3327214">Decl</span>&nbsp;<span class="op" id="3327219">==</span>&nbsp;<span class="ident" id="3327222">nil</span><span class="op" id="3327225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3327230">//&nbsp;exclude&nbsp;conflict&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327258">case</span>&nbsp;<span class="ident" id="3327263">allMethods</span><span class="op" id="3327273">,</span>&nbsp;<span class="ident" id="3327275">m</span><span class="op" id="3327276">.</span><span class="ident" id="3327277">Level</span>&nbsp;<span class="op" id="3327283">==</span>&nbsp;<span class="num" id="3327286">0</span><span class="op" id="3327287">,</span>&nbsp;<span class="op" id="3327289">!</span><span class="ident" id="3327290">ast</span><span class="op" id="3327293">.</span><span class="ident" id="3327294">IsExported</span><span class="op" id="3327304">(</span><span class="ident" id="3327305">removeStar</span><span class="op" id="3327315">(</span><span class="ident" id="3327316">m</span><span class="op" id="3327317">.</span><span class="ident" id="3327318">Orig</span><span class="op" id="3327322">)</span><span class="op" id="3327323">)</span><span class="op" id="3327324">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3327329">//&nbsp;forced&nbsp;inclusion,&nbsp;method&nbsp;not&nbsp;embedded,&nbsp;or&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3327384">//&nbsp;embedded&nbsp;but&nbsp;original&nbsp;receiver&nbsp;type&nbsp;not&nbsp;exported</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327439">list</span><span class="op" id="3327443">[</span><span class="ident" id="3327444">i</span><span class="op" id="3327445">]</span>&nbsp;<span class="op" id="3327447">=</span>&nbsp;<span class="ident" id="3327449">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327454">i</span><span class="op" id="3327455">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327466">list</span>&nbsp;<span class="op" id="3327471">=</span>&nbsp;<span class="ident" id="3327473">list</span><span class="op" id="3327477">[</span><span class="num" id="3327478">0</span><span class="op" id="3327479">:</span><span class="ident" id="3327480">i</span><span class="op" id="3327481">]</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327484">sortBy</span><span class="op" id="3327490">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327494">func</span><span class="op" id="3327498">(</span><span class="ident" id="3327499">i</span><span class="op" id="3327500">,</span>&nbsp;<span class="ident" id="3327502">j</span>&nbsp;<span class="builtintype" id="3327504">int</span><span class="op" id="3327507">)</span>&nbsp;<span class="builtintype" id="3327509">bool</span>&nbsp;<span class="op" id="3327514">{</span>&nbsp;<span class="keyword" id="3327516">return</span>&nbsp;<span class="ident" id="3327523">list</span><span class="op" id="3327527">[</span><span class="ident" id="3327528">i</span><span class="op" id="3327529">]</span><span class="op" id="3327530">.</span><span class="ident" id="3327531">Name</span>&nbsp;<span class="op" id="3327536">&lt;</span>&nbsp;<span class="ident" id="3327538">list</span><span class="op" id="3327542">[</span><span class="ident" id="3327543">j</span><span class="op" id="3327544">]</span><span class="op" id="3327545">.</span><span class="ident" id="3327546">Name</span>&nbsp;<span class="op" id="3327551">}</span><span class="op" id="3327552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327556">func</span><span class="op" id="3327560">(</span><span class="ident" id="3327561">i</span><span class="op" id="3327562">,</span>&nbsp;<span class="ident" id="3327564">j</span>&nbsp;<span class="builtintype" id="3327566">int</span><span class="op" id="3327569">)</span>&nbsp;<span class="op" id="3327571">{</span>&nbsp;<span class="ident" id="3327573">list</span><span class="op" id="3327577">[</span><span class="ident" id="3327578">i</span><span class="op" id="3327579">]</span><span class="op" id="3327580">,</span>&nbsp;<span class="ident" id="3327582">list</span><span class="op" id="3327586">[</span><span class="ident" id="3327587">j</span><span class="op" id="3327588">]</span>&nbsp;<span class="op" id="3327590">=</span>&nbsp;<span class="ident" id="3327592">list</span><span class="op" id="3327596">[</span><span class="ident" id="3327597">j</span><span class="op" id="3327598">]</span><span class="op" id="3327599">,</span>&nbsp;<span class="ident" id="3327601">list</span><span class="op" id="3327605">[</span><span class="ident" id="3327606">i</span><span class="op" id="3327607">]</span>&nbsp;<span class="op" id="3327609">}</span><span class="op" id="3327610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3327614">len</span><span class="op" id="3327617">(</span><span class="ident" id="3327618">list</span><span class="op" id="3327622">)</span><span class="op" id="3327623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327626">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327629">return</span>&nbsp;<span class="ident" id="3327636">list</span><br>
<span class="lineno"></span><span class="op" id="3327641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3327644">//&nbsp;noteBodies&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;note&nbsp;body&nbsp;strings&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;notes.</span><br>
<span class="lineno"></span><span class="comment" id="3327717">//&nbsp;This&nbsp;is&nbsp;only&nbsp;used&nbsp;to&nbsp;populate&nbsp;the&nbsp;deprecated&nbsp;Package.Bugs&nbsp;field.</span><br>
<span class="lineno">795</span><span class="comment" id="3327785">//</span><br>
<span class="lineno"></span><span class="keyword" id="3327788">func</span>&nbsp;<span class="ident" id="3327793">noteBodies</span><span class="op" id="3327803">(</span><span class="ident" id="3327804">notes</span>&nbsp;<span class="op" id="3327810">[</span><span class="op" id="3327811">]</span><span class="op" id="3327812">*</span><span class="ident" id="3327813">Note</span><span class="op" id="3327817">)</span>&nbsp;<span class="op" id="3327819">[</span><span class="op" id="3327820">]</span><span class="builtintype" id="3327821">string</span>&nbsp;<span class="op" id="3327828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327831">var</span>&nbsp;<span class="ident" id="3327835">list</span>&nbsp;<span class="op" id="3327840">[</span><span class="op" id="3327841">]</span><span class="builtintype" id="3327842">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327850">for</span>&nbsp;<span class="ident" id="3327854">_</span><span class="op" id="3327855">,</span>&nbsp;<span class="ident" id="3327857">n</span>&nbsp;<span class="op" id="3327859">:=</span>&nbsp;<span class="keyword" id="3327862">range</span>&nbsp;<span class="ident" id="3327868">notes</span>&nbsp;<span class="op" id="3327874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327878">list</span>&nbsp;<span class="op" id="3327883">=</span>&nbsp;<span class="builtinfunc" id="3327885">append</span><span class="op" id="3327891">(</span><span class="ident" id="3327892">list</span><span class="op" id="3327896">,</span>&nbsp;<span class="ident" id="3327898">n</span><span class="op" id="3327899">.</span><span class="ident" id="3327900">Body</span><span class="op" id="3327904">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327910">return</span>&nbsp;<span class="ident" id="3327917">list</span><br>
<span class="lineno"></span><span class="op" id="3327922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3327925">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">805</span><span class="comment" id="3328005">//&nbsp;Predeclared&nbsp;identifiers</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3328033">var</span>&nbsp;<span class="ident" id="3328037">predeclaredTypes</span>&nbsp;<span class="op" id="3328054">=</span>&nbsp;<span class="keyword" id="3328056">map</span><span class="op" id="3328059">[</span><span class="builtintype" id="3328060">string</span><span class="op" id="3328066">]</span><span class="builtintype" id="3328067">bool</span><span class="op" id="3328071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328074">&#34;bool&#34;</span><span class="op" id="3328080">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328088">true</span><span class="op" id="3328092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328095">&#34;byte&#34;</span><span class="op" id="3328101">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328109">true</span><span class="op" id="3328113">,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328116">&#34;complex64&#34;</span><span class="op" id="3328127">:</span>&nbsp;&nbsp;<span class="builtintype" id="3328130">true</span><span class="op" id="3328134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328137">&#34;complex128&#34;</span><span class="op" id="3328149">:</span>&nbsp;<span class="builtintype" id="3328151">true</span><span class="op" id="3328155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328158">&#34;error&#34;</span><span class="op" id="3328165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328172">true</span><span class="op" id="3328176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328179">&#34;float32&#34;</span><span class="op" id="3328188">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328193">true</span><span class="op" id="3328197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328200">&#34;float64&#34;</span><span class="op" id="3328209">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328214">true</span><span class="op" id="3328218">,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328221">&#34;int&#34;</span><span class="op" id="3328226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328235">true</span><span class="op" id="3328239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328242">&#34;int8&#34;</span><span class="op" id="3328248">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328256">true</span><span class="op" id="3328260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328263">&#34;int16&#34;</span><span class="op" id="3328270">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328277">true</span><span class="op" id="3328281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328284">&#34;int32&#34;</span><span class="op" id="3328291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328298">true</span><span class="op" id="3328302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328305">&#34;int64&#34;</span><span class="op" id="3328312">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328319">true</span><span class="op" id="3328323">,</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328326">&#34;rune&#34;</span><span class="op" id="3328332">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328340">true</span><span class="op" id="3328344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328347">&#34;string&#34;</span><span class="op" id="3328355">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328361">true</span><span class="op" id="3328365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328368">&#34;uint&#34;</span><span class="op" id="3328374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328382">true</span><span class="op" id="3328386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328389">&#34;uint8&#34;</span><span class="op" id="3328396">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328403">true</span><span class="op" id="3328407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328410">&#34;uint16&#34;</span><span class="op" id="3328418">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328424">true</span><span class="op" id="3328428">,</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328431">&#34;uint32&#34;</span><span class="op" id="3328439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328445">true</span><span class="op" id="3328449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328452">&#34;uint64&#34;</span><span class="op" id="3328460">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328466">true</span><span class="op" id="3328470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328473">&#34;uintptr&#34;</span><span class="op" id="3328482">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328487">true</span><span class="op" id="3328491">,</span><br>
<span class="lineno"></span><span class="op" id="3328493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="keyword" id="3328496">var</span>&nbsp;<span class="ident" id="3328500">predeclaredFuncs</span>&nbsp;<span class="op" id="3328517">=</span>&nbsp;<span class="keyword" id="3328519">map</span><span class="op" id="3328522">[</span><span class="builtintype" id="3328523">string</span><span class="op" id="3328529">]</span><span class="builtintype" id="3328530">bool</span><span class="op" id="3328534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328537">&#34;append&#34;</span><span class="op" id="3328545">:</span>&nbsp;&nbsp;<span class="builtintype" id="3328548">true</span><span class="op" id="3328552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328555">&#34;cap&#34;</span><span class="op" id="3328560">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328566">true</span><span class="op" id="3328570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328573">&#34;close&#34;</span><span class="op" id="3328580">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328584">true</span><span class="op" id="3328588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328591">&#34;complex&#34;</span><span class="op" id="3328600">:</span>&nbsp;<span class="builtintype" id="3328602">true</span><span class="op" id="3328606">,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328609">&#34;copy&#34;</span><span class="op" id="3328615">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328620">true</span><span class="op" id="3328624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328627">&#34;delete&#34;</span><span class="op" id="3328635">:</span>&nbsp;&nbsp;<span class="builtintype" id="3328638">true</span><span class="op" id="3328642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328645">&#34;imag&#34;</span><span class="op" id="3328651">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328656">true</span><span class="op" id="3328660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328663">&#34;len&#34;</span><span class="op" id="3328668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328674">true</span><span class="op" id="3328678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328681">&#34;make&#34;</span><span class="op" id="3328687">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328692">true</span><span class="op" id="3328696">,</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328699">&#34;new&#34;</span><span class="op" id="3328704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328710">true</span><span class="op" id="3328714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328717">&#34;panic&#34;</span><span class="op" id="3328724">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328728">true</span><span class="op" id="3328732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328735">&#34;print&#34;</span><span class="op" id="3328742">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328746">true</span><span class="op" id="3328750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328753">&#34;println&#34;</span><span class="op" id="3328762">:</span>&nbsp;<span class="builtintype" id="3328764">true</span><span class="op" id="3328768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328771">&#34;real&#34;</span><span class="op" id="3328777">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328782">true</span><span class="op" id="3328786">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328789">&#34;recover&#34;</span><span class="op" id="3328798">:</span>&nbsp;<span class="builtintype" id="3328800">true</span><span class="op" id="3328804">,</span><br>
<span class="lineno"></span><span class="op" id="3328806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3328809">var</span>&nbsp;<span class="ident" id="3328813">predeclaredConstants</span>&nbsp;<span class="op" id="3328834">=</span>&nbsp;<span class="keyword" id="3328836">map</span><span class="op" id="3328839">[</span><span class="builtintype" id="3328840">string</span><span class="op" id="3328846">]</span><span class="builtintype" id="3328847">bool</span><span class="op" id="3328851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328854">&#34;false&#34;</span><span class="op" id="3328861">:</span>&nbsp;<span class="builtintype" id="3328863">true</span><span class="op" id="3328867">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328870">&#34;iota&#34;</span><span class="op" id="3328876">:</span>&nbsp;&nbsp;<span class="builtintype" id="3328879">true</span><span class="op" id="3328883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328886">&#34;nil&#34;</span><span class="op" id="3328891">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3328895">true</span><span class="op" id="3328899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3328902">&#34;true&#34;</span><span class="op" id="3328908">:</span>&nbsp;&nbsp;<span class="builtintype" id="3328911">true</span><span class="op" id="3328915">,</span><br>
<span class="lineno"></span><span class="op" id="3328917">}</span>
</div>
</body>
</html>
