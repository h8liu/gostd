<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1837868">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1837923">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1837977">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1838028">package</span>&nbsp;<span class="ident" id="1838036">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1838042">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1838092">//</span><br>
<span class="lineno"></span><span class="comment" id="1838095">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="1838117">//&nbsp;&nbsp;&nbsp;&nbspExp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1838137">//&nbsp;&nbsp;&nbsp;&nbspExp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1838155">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="1838199">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="1838236">func</span>&nbsp;<span class="ident" id="1838241">Exp</span><span class="op" id="1838244">(</span><span class="ident" id="1838245">x</span>&nbsp;<span class="builtintype" id="1838247">float64</span><span class="op" id="1838254">)</span>&nbsp;<span class="builtintype" id="1838256">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="1838265">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1838325">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="1838383">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1838442">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="1838472">//</span><br>
<span class="lineno"></span><span class="comment" id="1838475">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1838531">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1838600">//</span><br>
<span class="lineno"></span><span class="comment" id="1838603">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="1838659">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1838716">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1838733">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1838789">//</span><br>
<span class="lineno"></span><span class="comment" id="1838792">//</span><br>
<span class="lineno">30</span><span class="comment" id="1838795">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="1838805">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1838838">//</span><br>
<span class="lineno"></span><span class="comment" id="1838841">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="1838851">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="1838879">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="1838938">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1838986">//</span><br>
<span class="lineno"></span><span class="comment" id="1838989">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="1839038">//</span><br>
<span class="lineno">40</span><span class="comment" id="1839041">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="1839100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="1839118">//</span><br>
<span class="lineno"></span><span class="comment" id="1839121">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="1839187">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="1839221">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="1839235">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="1839310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="1839378">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1839447">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="1839513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="1839534">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="1839604">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="1839671">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1839683">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="1839735">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1839784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1839828">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="1839875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="1839910">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="1839947">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1839983">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="1840026">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="1840093">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="1840137">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="1840151">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="1840209">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="1840270">//</span><br>
<span class="lineno"></span><span class="comment" id="1840273">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="1840310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="1840339">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="1840373">//</span><br>
<span class="lineno"></span><span class="comment" id="1840376">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1840394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="1840436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="1840464">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="1840517">//</span><br>
<span class="lineno"></span><span class="comment" id="1840520">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="1840533">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1840603">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="1840643">//</span><br>
<span class="lineno"></span><span class="comment" id="1840646">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="1840661">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="1840685">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="1840753">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="1840822">//</span><br>
<span class="lineno"></span><span class="comment" id="1840825">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="1840839">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1840905">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1840969">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="1841035">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1841080">func</span>&nbsp;<span class="ident" id="1841085">exp</span><span class="op" id="1841088">(</span><span class="ident" id="1841089">x</span>&nbsp;<span class="builtintype" id="1841091">float64</span><span class="op" id="1841098">)</span>&nbsp;<span class="builtintype" id="1841100">float64</span>&nbsp;<span class="op" id="1841108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841111">const</span>&nbsp;<span class="op" id="1841117">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841121">Ln2Hi</span>&nbsp;<span class="op" id="1841127">=</span>&nbsp;<span class="num" id="1841129">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841158">Ln2Lo</span>&nbsp;<span class="op" id="1841164">=</span>&nbsp;<span class="num" id="1841166">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841195">Log2e</span>&nbsp;<span class="op" id="1841201">=</span>&nbsp;<span class="num" id="1841203">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841233">Overflow</span>&nbsp;&nbsp;<span class="op" id="1841243">=</span>&nbsp;<span class="num" id="1841245">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841274">Underflow</span>&nbsp;<span class="op" id="1841284">=</span>&nbsp;<span class="op" id="1841286">-</span><span class="num" id="1841287">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841316">NearZero</span>&nbsp;&nbsp;<span class="op" id="1841326">=</span>&nbsp;<span class="num" id="1841328">1.0</span>&nbsp;<span class="op" id="1841332">/</span>&nbsp;<span class="op" id="1841334">(</span><span class="num" id="1841335">1</span>&nbsp;<span class="op" id="1841337">&lt;&lt;</span>&nbsp;<span class="num" id="1841340">28</span><span class="op" id="1841342">)</span>&nbsp;<span class="comment" id="1841344">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1841355">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1841359">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841377">switch</span>&nbsp;<span class="op" id="1841384">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841387">case</span>&nbsp;<span class="ident" id="1841392">IsNaN</span><span class="op" id="1841397">(</span><span class="ident" id="1841398">x</span><span class="op" id="1841399">)</span>&nbsp;<span class="op" id="1841401">||</span>&nbsp;<span class="ident" id="1841404">IsInf</span><span class="op" id="1841409">(</span><span class="ident" id="1841410">x</span><span class="op" id="1841411">,</span>&nbsp;<span class="num" id="1841413">1</span><span class="op" id="1841414">)</span><span class="op" id="1841415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841419">return</span>&nbsp;<span class="ident" id="1841426">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841429">case</span>&nbsp;<span class="ident" id="1841434">IsInf</span><span class="op" id="1841439">(</span><span class="ident" id="1841440">x</span><span class="op" id="1841441">,</span>&nbsp;<span class="op" id="1841443">-</span><span class="num" id="1841444">1</span><span class="op" id="1841445">)</span><span class="op" id="1841446">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841450">return</span>&nbsp;<span class="num" id="1841457">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841460">case</span>&nbsp;<span class="ident" id="1841465">x</span>&nbsp;<span class="op" id="1841467">&gt;</span>&nbsp;<span class="ident" id="1841469">Overflow</span><span class="op" id="1841477">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841481">return</span>&nbsp;<span class="ident" id="1841488">Inf</span><span class="op" id="1841491">(</span><span class="num" id="1841492">1</span><span class="op" id="1841493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841496">case</span>&nbsp;<span class="ident" id="1841501">x</span>&nbsp;<span class="op" id="1841503">&lt;</span>&nbsp;<span class="ident" id="1841505">Underflow</span><span class="op" id="1841514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841518">return</span>&nbsp;<span class="num" id="1841525">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841528">case</span>&nbsp;<span class="op" id="1841533">-</span><span class="ident" id="1841534">NearZero</span>&nbsp;<span class="op" id="1841543">&lt;</span>&nbsp;<span class="ident" id="1841545">x</span>&nbsp;<span class="op" id="1841547">&amp;&amp;</span>&nbsp;<span class="ident" id="1841550">x</span>&nbsp;<span class="op" id="1841552">&lt;</span>&nbsp;<span class="ident" id="1841554">NearZero</span><span class="op" id="1841562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841566">return</span>&nbsp;<span class="num" id="1841573">1</span>&nbsp;<span class="op" id="1841575">+</span>&nbsp;<span class="ident" id="1841577">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1841580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1841584">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841641">var</span>&nbsp;<span class="ident" id="1841645">k</span>&nbsp;<span class="builtintype" id="1841647">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841652">switch</span>&nbsp;<span class="op" id="1841659">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841662">case</span>&nbsp;<span class="ident" id="1841667">x</span>&nbsp;<span class="op" id="1841669">&lt;</span>&nbsp;<span class="num" id="1841671">0</span><span class="op" id="1841672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841676">k</span>&nbsp;<span class="op" id="1841678">=</span>&nbsp;<span class="builtintype" id="1841680">int</span><span class="op" id="1841683">(</span><span class="ident" id="1841684">Log2e</span><span class="op" id="1841689">*</span><span class="ident" id="1841690">x</span>&nbsp;<span class="op" id="1841692">-</span>&nbsp;<span class="num" id="1841694">0.5</span><span class="op" id="1841697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841700">case</span>&nbsp;<span class="ident" id="1841705">x</span>&nbsp;<span class="op" id="1841707">&gt;</span>&nbsp;<span class="num" id="1841709">0</span><span class="op" id="1841710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841714">k</span>&nbsp;<span class="op" id="1841716">=</span>&nbsp;<span class="builtintype" id="1841718">int</span><span class="op" id="1841721">(</span><span class="ident" id="1841722">Log2e</span><span class="op" id="1841727">*</span><span class="ident" id="1841728">x</span>&nbsp;<span class="op" id="1841730">+</span>&nbsp;<span class="num" id="1841732">0.5</span><span class="op" id="1841735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1841738">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841741">hi</span>&nbsp;<span class="op" id="1841744">:=</span>&nbsp;<span class="ident" id="1841747">x</span>&nbsp;<span class="op" id="1841749">-</span>&nbsp;<span class="builtintype" id="1841751">float64</span><span class="op" id="1841758">(</span><span class="ident" id="1841759">k</span><span class="op" id="1841760">)</span><span class="op" id="1841761">*</span><span class="ident" id="1841762">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841769">lo</span>&nbsp;<span class="op" id="1841772">:=</span>&nbsp;<span class="builtintype" id="1841775">float64</span><span class="op" id="1841782">(</span><span class="ident" id="1841783">k</span><span class="op" id="1841784">)</span>&nbsp;<span class="op" id="1841786">*</span>&nbsp;<span class="ident" id="1841788">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1841796">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841808">return</span>&nbsp;<span class="ident" id="1841815">expmulti</span><span class="op" id="1841823">(</span><span class="ident" id="1841824">hi</span><span class="op" id="1841826">,</span>&nbsp;<span class="ident" id="1841828">lo</span><span class="op" id="1841830">,</span>&nbsp;<span class="ident" id="1841832">k</span><span class="op" id="1841833">)</span><br>
<span class="lineno">130</span><span class="op" id="1841835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1841838">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1841889">//</span><br>
<span class="lineno"></span><span class="comment" id="1841892">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="1841930">func</span>&nbsp;<span class="ident" id="1841935">Exp2</span><span class="op" id="1841939">(</span><span class="ident" id="1841940">x</span>&nbsp;<span class="builtintype" id="1841942">float64</span><span class="op" id="1841949">)</span>&nbsp;<span class="builtintype" id="1841951">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1841960">func</span>&nbsp;<span class="ident" id="1841965">exp2</span><span class="op" id="1841969">(</span><span class="ident" id="1841970">x</span>&nbsp;<span class="builtintype" id="1841972">float64</span><span class="op" id="1841979">)</span>&nbsp;<span class="builtintype" id="1841981">float64</span>&nbsp;<span class="op" id="1841989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1841992">const</span>&nbsp;<span class="op" id="1841998">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842002">Ln2Hi</span>&nbsp;<span class="op" id="1842008">=</span>&nbsp;<span class="num" id="1842010">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842039">Ln2Lo</span>&nbsp;<span class="op" id="1842045">=</span>&nbsp;<span class="num" id="1842047">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842077">Overflow</span>&nbsp;&nbsp;<span class="op" id="1842087">=</span>&nbsp;<span class="num" id="1842089">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842114">Underflow</span>&nbsp;<span class="op" id="1842124">=</span>&nbsp;<span class="op" id="1842126">-</span><span class="num" id="1842127">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1842139">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842143">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842161">switch</span>&nbsp;<span class="op" id="1842168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842171">case</span>&nbsp;<span class="ident" id="1842176">IsNaN</span><span class="op" id="1842181">(</span><span class="ident" id="1842182">x</span><span class="op" id="1842183">)</span>&nbsp;<span class="op" id="1842185">||</span>&nbsp;<span class="ident" id="1842188">IsInf</span><span class="op" id="1842193">(</span><span class="ident" id="1842194">x</span><span class="op" id="1842195">,</span>&nbsp;<span class="num" id="1842197">1</span><span class="op" id="1842198">)</span><span class="op" id="1842199">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842203">return</span>&nbsp;<span class="ident" id="1842210">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842213">case</span>&nbsp;<span class="ident" id="1842218">IsInf</span><span class="op" id="1842223">(</span><span class="ident" id="1842224">x</span><span class="op" id="1842225">,</span>&nbsp;<span class="op" id="1842227">-</span><span class="num" id="1842228">1</span><span class="op" id="1842229">)</span><span class="op" id="1842230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842234">return</span>&nbsp;<span class="num" id="1842241">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842244">case</span>&nbsp;<span class="ident" id="1842249">x</span>&nbsp;<span class="op" id="1842251">&gt;</span>&nbsp;<span class="ident" id="1842253">Overflow</span><span class="op" id="1842261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842265">return</span>&nbsp;<span class="ident" id="1842272">Inf</span><span class="op" id="1842275">(</span><span class="num" id="1842276">1</span><span class="op" id="1842277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842280">case</span>&nbsp;<span class="ident" id="1842285">x</span>&nbsp;<span class="op" id="1842287">&lt;</span>&nbsp;<span class="ident" id="1842289">Underflow</span><span class="op" id="1842298">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842302">return</span>&nbsp;<span class="num" id="1842309">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1842312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842316">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842379">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842428">var</span>&nbsp;<span class="ident" id="1842432">k</span>&nbsp;<span class="builtintype" id="1842434">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842439">switch</span>&nbsp;<span class="op" id="1842446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842449">case</span>&nbsp;<span class="ident" id="1842454">x</span>&nbsp;<span class="op" id="1842456">&gt;</span>&nbsp;<span class="num" id="1842458">0</span><span class="op" id="1842459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842463">k</span>&nbsp;<span class="op" id="1842465">=</span>&nbsp;<span class="builtintype" id="1842467">int</span><span class="op" id="1842470">(</span><span class="ident" id="1842471">x</span>&nbsp;<span class="op" id="1842473">+</span>&nbsp;<span class="num" id="1842475">0.5</span><span class="op" id="1842478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842481">case</span>&nbsp;<span class="ident" id="1842486">x</span>&nbsp;<span class="op" id="1842488">&lt;</span>&nbsp;<span class="num" id="1842490">0</span><span class="op" id="1842491">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842495">k</span>&nbsp;<span class="op" id="1842497">=</span>&nbsp;<span class="builtintype" id="1842499">int</span><span class="op" id="1842502">(</span><span class="ident" id="1842503">x</span>&nbsp;<span class="op" id="1842505">-</span>&nbsp;<span class="num" id="1842507">0.5</span><span class="op" id="1842510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1842513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842516">t</span>&nbsp;<span class="op" id="1842518">:=</span>&nbsp;<span class="ident" id="1842521">x</span>&nbsp;<span class="op" id="1842523">-</span>&nbsp;<span class="builtintype" id="1842525">float64</span><span class="op" id="1842532">(</span><span class="ident" id="1842533">k</span><span class="op" id="1842534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842537">hi</span>&nbsp;<span class="op" id="1842540">:=</span>&nbsp;<span class="ident" id="1842543">t</span>&nbsp;<span class="op" id="1842545">*</span>&nbsp;<span class="ident" id="1842547">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842554">lo</span>&nbsp;<span class="op" id="1842557">:=</span>&nbsp;<span class="op" id="1842560">-</span><span class="ident" id="1842561">t</span>&nbsp;<span class="op" id="1842563">*</span>&nbsp;<span class="ident" id="1842565">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842573">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842585">return</span>&nbsp;<span class="ident" id="1842592">expmulti</span><span class="op" id="1842600">(</span><span class="ident" id="1842601">hi</span><span class="op" id="1842603">,</span>&nbsp;<span class="ident" id="1842605">lo</span><span class="op" id="1842607">,</span>&nbsp;<span class="ident" id="1842609">k</span><span class="op" id="1842610">)</span><br>
<span class="lineno"></span><span class="op" id="1842612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="1842615">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="1842683">func</span>&nbsp;<span class="ident" id="1842688">expmulti</span><span class="op" id="1842696">(</span><span class="ident" id="1842697">hi</span><span class="op" id="1842699">,</span>&nbsp;<span class="ident" id="1842701">lo</span>&nbsp;<span class="builtintype" id="1842704">float64</span><span class="op" id="1842711">,</span>&nbsp;<span class="ident" id="1842713">k</span>&nbsp;<span class="builtintype" id="1842715">int</span><span class="op" id="1842718">)</span>&nbsp;<span class="builtintype" id="1842720">float64</span>&nbsp;<span class="op" id="1842728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842731">const</span>&nbsp;<span class="op" id="1842737">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842741">P1</span>&nbsp;<span class="op" id="1842744">=</span>&nbsp;<span class="num" id="1842746">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="1842774">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842805">P2</span>&nbsp;<span class="op" id="1842808">=</span>&nbsp;<span class="op" id="1842810">-</span><span class="num" id="1842811">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="1842838">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842869">P3</span>&nbsp;<span class="op" id="1842872">=</span>&nbsp;<span class="num" id="1842874">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="1842902">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842933">P4</span>&nbsp;<span class="op" id="1842936">=</span>&nbsp;<span class="op" id="1842938">-</span><span class="num" id="1842939">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="1842966">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842997">P5</span>&nbsp;<span class="op" id="1843000">=</span>&nbsp;<span class="num" id="1843002">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="1843030">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1843060">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843064">r</span>&nbsp;<span class="op" id="1843066">:=</span>&nbsp;<span class="ident" id="1843069">hi</span>&nbsp;<span class="op" id="1843072">-</span>&nbsp;<span class="ident" id="1843074">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843078">t</span>&nbsp;<span class="op" id="1843080">:=</span>&nbsp;<span class="ident" id="1843083">r</span>&nbsp;<span class="op" id="1843085">*</span>&nbsp;<span class="ident" id="1843087">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843090">c</span>&nbsp;<span class="op" id="1843092">:=</span>&nbsp;<span class="ident" id="1843095">r</span>&nbsp;<span class="op" id="1843097">-</span>&nbsp;<span class="ident" id="1843099">t</span><span class="op" id="1843100">*</span><span class="op" id="1843101">(</span><span class="ident" id="1843102">P1</span><span class="op" id="1843104">+</span><span class="ident" id="1843105">t</span><span class="op" id="1843106">*</span><span class="op" id="1843107">(</span><span class="ident" id="1843108">P2</span><span class="op" id="1843110">+</span><span class="ident" id="1843111">t</span><span class="op" id="1843112">*</span><span class="op" id="1843113">(</span><span class="ident" id="1843114">P3</span><span class="op" id="1843116">+</span><span class="ident" id="1843117">t</span><span class="op" id="1843118">*</span><span class="op" id="1843119">(</span><span class="ident" id="1843120">P4</span><span class="op" id="1843122">+</span><span class="ident" id="1843123">t</span><span class="op" id="1843124">*</span><span class="ident" id="1843125">P5</span><span class="op" id="1843127">)</span><span class="op" id="1843128">)</span><span class="op" id="1843129">)</span><span class="op" id="1843130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843133">y</span>&nbsp;<span class="op" id="1843135">:=</span>&nbsp;<span class="num" id="1843138">1</span>&nbsp;<span class="op" id="1843140">-</span>&nbsp;<span class="op" id="1843142">(</span><span class="op" id="1843143">(</span><span class="ident" id="1843144">lo</span>&nbsp;<span class="op" id="1843147">-</span>&nbsp;<span class="op" id="1843149">(</span><span class="ident" id="1843150">r</span><span class="op" id="1843151">*</span><span class="ident" id="1843152">c</span><span class="op" id="1843153">)</span><span class="op" id="1843154">/</span><span class="op" id="1843155">(</span><span class="num" id="1843156">2</span><span class="op" id="1843157">-</span><span class="ident" id="1843158">c</span><span class="op" id="1843159">)</span><span class="op" id="1843160">)</span>&nbsp;<span class="op" id="1843162">-</span>&nbsp;<span class="ident" id="1843164">hi</span><span class="op" id="1843166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1843169">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843222">return</span>&nbsp;<span class="ident" id="1843229">Ldexp</span><span class="op" id="1843234">(</span><span class="ident" id="1843235">y</span><span class="op" id="1843236">,</span>&nbsp;<span class="ident" id="1843238">k</span><span class="op" id="1843239">)</span><br>
<span class="lineno"></span><span class="op" id="1843241">}</span>
</div>
</body>
</html>
