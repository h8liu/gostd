<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html" class="current">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3251111">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3251167">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3251221">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3251272">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3251345">package</span>&nbsp;<span class="ident" id="3251353">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3251358">import</span>&nbsp;<span class="op" id="3251365">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3251368">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3251374">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3251384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3251387">//&nbsp;Boolean&nbsp;to&nbsp;int.</span><br>
<span class="lineno">15</span><span class="keyword" id="3251406">func</span>&nbsp;<span class="ident" id="3251411">boolint</span><span class="op" id="3251418">(</span><span class="ident" id="3251419">b</span>&nbsp;<span class="builtintype" id="3251421">bool</span><span class="op" id="3251425">)</span>&nbsp;<span class="builtintype" id="3251427">int</span>&nbsp;<span class="op" id="3251431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251434">if</span>&nbsp;<span class="ident" id="3251437">b</span>&nbsp;<span class="op" id="3251439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251443">return</span>&nbsp;<span class="num" id="3251450">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251456">return</span>&nbsp;<span class="num" id="3251463">0</span><br>
<span class="lineno">20</span><span class="op" id="3251465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3251468">func</span>&nbsp;<span class="ident" id="3251473">ipv4AddrToInterface</span><span class="op" id="3251492">(</span><span class="ident" id="3251493">ip</span>&nbsp;<span class="ident" id="3251496">IP</span><span class="op" id="3251498">)</span>&nbsp;<span class="op" id="3251500">(</span><span class="op" id="3251501">*</span><span class="ident" id="3251502">Interface</span><span class="op" id="3251511">,</span>&nbsp;<span class="builtintype" id="3251513">error</span><span class="op" id="3251518">)</span>&nbsp;<span class="op" id="3251520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251523">ift</span><span class="op" id="3251526">,</span>&nbsp;<span class="ident" id="3251528">err</span>&nbsp;<span class="op" id="3251532">:=</span>&nbsp;<span class="ident" id="3251535">Interfaces</span><span class="op" id="3251545">(</span><span class="op" id="3251546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251549">if</span>&nbsp;<span class="ident" id="3251552">err</span>&nbsp;<span class="op" id="3251556">!=</span>&nbsp;<span class="ident" id="3251559">nil</span>&nbsp;<span class="op" id="3251563">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251567">return</span>&nbsp;<span class="ident" id="3251574">nil</span><span class="op" id="3251577">,</span>&nbsp;<span class="ident" id="3251579">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251587">for</span>&nbsp;<span class="ident" id="3251591">_</span><span class="op" id="3251592">,</span>&nbsp;<span class="ident" id="3251594">ifi</span>&nbsp;<span class="op" id="3251598">:=</span>&nbsp;<span class="keyword" id="3251601">range</span>&nbsp;<span class="ident" id="3251607">ift</span>&nbsp;<span class="op" id="3251611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251615">ifat</span><span class="op" id="3251619">,</span>&nbsp;<span class="ident" id="3251621">err</span>&nbsp;<span class="op" id="3251625">:=</span>&nbsp;<span class="ident" id="3251628">ifi</span><span class="op" id="3251631">.</span><span class="ident" id="3251632">Addrs</span><span class="op" id="3251637">(</span><span class="op" id="3251638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251642">if</span>&nbsp;<span class="ident" id="3251645">err</span>&nbsp;<span class="op" id="3251649">!=</span>&nbsp;<span class="ident" id="3251652">nil</span>&nbsp;<span class="op" id="3251656">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251661">return</span>&nbsp;<span class="ident" id="3251668">nil</span><span class="op" id="3251671">,</span>&nbsp;<span class="ident" id="3251673">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251683">for</span>&nbsp;<span class="ident" id="3251687">_</span><span class="op" id="3251688">,</span>&nbsp;<span class="ident" id="3251690">ifa</span>&nbsp;<span class="op" id="3251694">:=</span>&nbsp;<span class="keyword" id="3251697">range</span>&nbsp;<span class="ident" id="3251703">ifat</span>&nbsp;<span class="op" id="3251708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251713">switch</span>&nbsp;<span class="ident" id="3251720">v</span>&nbsp;<span class="op" id="3251722">:=</span>&nbsp;<span class="ident" id="3251725">ifa</span><span class="op" id="3251728">.</span><span class="op" id="3251729">(</span><span class="keyword" id="3251730">type</span><span class="op" id="3251734">)</span>&nbsp;<span class="op" id="3251736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251741">case</span>&nbsp;<span class="op" id="3251746">*</span><span class="ident" id="3251747">IPAddr</span><span class="op" id="3251753">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251759">if</span>&nbsp;<span class="ident" id="3251762">ip</span><span class="op" id="3251764">.</span><span class="ident" id="3251765">Equal</span><span class="op" id="3251770">(</span><span class="ident" id="3251771">v</span><span class="op" id="3251772">.</span><span class="ident" id="3251773">IP</span><span class="op" id="3251775">)</span>&nbsp;<span class="op" id="3251777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251784">return</span>&nbsp;<span class="op" id="3251791">&amp;</span><span class="ident" id="3251792">ifi</span><span class="op" id="3251795">,</span>&nbsp;<span class="ident" id="3251797">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251810">case</span>&nbsp;<span class="op" id="3251815">*</span><span class="ident" id="3251816">IPNet</span><span class="op" id="3251821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251827">if</span>&nbsp;<span class="ident" id="3251830">ip</span><span class="op" id="3251832">.</span><span class="ident" id="3251833">Equal</span><span class="op" id="3251838">(</span><span class="ident" id="3251839">v</span><span class="op" id="3251840">.</span><span class="ident" id="3251841">IP</span><span class="op" id="3251843">)</span>&nbsp;<span class="op" id="3251845">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251852">return</span>&nbsp;<span class="op" id="3251859">&amp;</span><span class="ident" id="3251860">ifi</span><span class="op" id="3251863">,</span>&nbsp;<span class="ident" id="3251865">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251885">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251888">if</span>&nbsp;<span class="ident" id="3251891">ip</span><span class="op" id="3251893">.</span><span class="ident" id="3251894">Equal</span><span class="op" id="3251899">(</span><span class="ident" id="3251900">IPv4zero</span><span class="op" id="3251908">)</span>&nbsp;<span class="op" id="3251910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251914">return</span>&nbsp;<span class="ident" id="3251921">nil</span><span class="op" id="3251924">,</span>&nbsp;<span class="ident" id="3251926">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251934">return</span>&nbsp;<span class="ident" id="3251941">nil</span><span class="op" id="3251944">,</span>&nbsp;<span class="ident" id="3251946">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="3251965">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3251968">func</span>&nbsp;<span class="ident" id="3251973">interfaceToIPv4Addr</span><span class="op" id="3251992">(</span><span class="ident" id="3251993">ifi</span>&nbsp;<span class="op" id="3251997">*</span><span class="ident" id="3251998">Interface</span><span class="op" id="3252007">)</span>&nbsp;<span class="op" id="3252009">(</span><span class="ident" id="3252010">IP</span><span class="op" id="3252012">,</span>&nbsp;<span class="builtintype" id="3252014">error</span><span class="op" id="3252019">)</span>&nbsp;<span class="op" id="3252021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252024">if</span>&nbsp;<span class="ident" id="3252027">ifi</span>&nbsp;<span class="op" id="3252031">==</span>&nbsp;<span class="ident" id="3252034">nil</span>&nbsp;<span class="op" id="3252038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252042">return</span>&nbsp;<span class="ident" id="3252049">IPv4zero</span><span class="op" id="3252057">,</span>&nbsp;<span class="ident" id="3252059">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252064">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252067">ifat</span><span class="op" id="3252071">,</span>&nbsp;<span class="ident" id="3252073">err</span>&nbsp;<span class="op" id="3252077">:=</span>&nbsp;<span class="ident" id="3252080">ifi</span><span class="op" id="3252083">.</span><span class="ident" id="3252084">Addrs</span><span class="op" id="3252089">(</span><span class="op" id="3252090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252093">if</span>&nbsp;<span class="ident" id="3252096">err</span>&nbsp;<span class="op" id="3252100">!=</span>&nbsp;<span class="ident" id="3252103">nil</span>&nbsp;<span class="op" id="3252107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252111">return</span>&nbsp;<span class="ident" id="3252118">nil</span><span class="op" id="3252121">,</span>&nbsp;<span class="ident" id="3252123">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252131">for</span>&nbsp;<span class="ident" id="3252135">_</span><span class="op" id="3252136">,</span>&nbsp;<span class="ident" id="3252138">ifa</span>&nbsp;<span class="op" id="3252142">:=</span>&nbsp;<span class="keyword" id="3252145">range</span>&nbsp;<span class="ident" id="3252151">ifat</span>&nbsp;<span class="op" id="3252156">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252160">switch</span>&nbsp;<span class="ident" id="3252167">v</span>&nbsp;<span class="op" id="3252169">:=</span>&nbsp;<span class="ident" id="3252172">ifa</span><span class="op" id="3252175">.</span><span class="op" id="3252176">(</span><span class="keyword" id="3252177">type</span><span class="op" id="3252181">)</span>&nbsp;<span class="op" id="3252183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252187">case</span>&nbsp;<span class="op" id="3252192">*</span><span class="ident" id="3252193">IPAddr</span><span class="op" id="3252199">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252204">if</span>&nbsp;<span class="ident" id="3252207">v</span><span class="op" id="3252208">.</span><span class="ident" id="3252209">IP</span><span class="op" id="3252211">.</span><span class="ident" id="3252212">To4</span><span class="op" id="3252215">(</span><span class="op" id="3252216">)</span>&nbsp;<span class="op" id="3252218">!=</span>&nbsp;<span class="ident" id="3252221">nil</span>&nbsp;<span class="op" id="3252225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252231">return</span>&nbsp;<span class="ident" id="3252238">v</span><span class="op" id="3252239">.</span><span class="ident" id="3252240">IP</span><span class="op" id="3252242">,</span>&nbsp;<span class="ident" id="3252244">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252251">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252255">case</span>&nbsp;<span class="op" id="3252260">*</span><span class="ident" id="3252261">IPNet</span><span class="op" id="3252266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252271">if</span>&nbsp;<span class="ident" id="3252274">v</span><span class="op" id="3252275">.</span><span class="ident" id="3252276">IP</span><span class="op" id="3252278">.</span><span class="ident" id="3252279">To4</span><span class="op" id="3252282">(</span><span class="op" id="3252283">)</span>&nbsp;<span class="op" id="3252285">!=</span>&nbsp;<span class="ident" id="3252288">nil</span>&nbsp;<span class="op" id="3252292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252298">return</span>&nbsp;<span class="ident" id="3252305">v</span><span class="op" id="3252306">.</span><span class="ident" id="3252307">IP</span><span class="op" id="3252309">,</span>&nbsp;<span class="ident" id="3252311">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252322">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252328">return</span>&nbsp;<span class="ident" id="3252335">nil</span><span class="op" id="3252338">,</span>&nbsp;<span class="ident" id="3252340">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="3252359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3252362">func</span>&nbsp;<span class="ident" id="3252367">setIPv4MreqToInterface</span><span class="op" id="3252389">(</span><span class="ident" id="3252390">mreq</span>&nbsp;<span class="op" id="3252395">*</span><span class="ident" id="3252396">syscall</span><span class="op" id="3252403">.</span><span class="ident" id="3252404">IPMreq</span><span class="op" id="3252410">,</span>&nbsp;<span class="ident" id="3252412">ifi</span>&nbsp;<span class="op" id="3252416">*</span><span class="ident" id="3252417">Interface</span><span class="op" id="3252426">)</span>&nbsp;<span class="builtintype" id="3252428">error</span>&nbsp;<span class="op" id="3252434">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252437">if</span>&nbsp;<span class="ident" id="3252440">ifi</span>&nbsp;<span class="op" id="3252444">==</span>&nbsp;<span class="ident" id="3252447">nil</span>&nbsp;<span class="op" id="3252451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252455">return</span>&nbsp;<span class="ident" id="3252462">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252470">ifat</span><span class="op" id="3252474">,</span>&nbsp;<span class="ident" id="3252476">err</span>&nbsp;<span class="op" id="3252480">:=</span>&nbsp;<span class="ident" id="3252483">ifi</span><span class="op" id="3252486">.</span><span class="ident" id="3252487">Addrs</span><span class="op" id="3252492">(</span><span class="op" id="3252493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252496">if</span>&nbsp;<span class="ident" id="3252499">err</span>&nbsp;<span class="op" id="3252503">!=</span>&nbsp;<span class="ident" id="3252506">nil</span>&nbsp;<span class="op" id="3252510">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252514">return</span>&nbsp;<span class="ident" id="3252521">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252529">for</span>&nbsp;<span class="ident" id="3252533">_</span><span class="op" id="3252534">,</span>&nbsp;<span class="ident" id="3252536">ifa</span>&nbsp;<span class="op" id="3252540">:=</span>&nbsp;<span class="keyword" id="3252543">range</span>&nbsp;<span class="ident" id="3252549">ifat</span>&nbsp;<span class="op" id="3252554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252558">switch</span>&nbsp;<span class="ident" id="3252565">v</span>&nbsp;<span class="op" id="3252567">:=</span>&nbsp;<span class="ident" id="3252570">ifa</span><span class="op" id="3252573">.</span><span class="op" id="3252574">(</span><span class="keyword" id="3252575">type</span><span class="op" id="3252579">)</span>&nbsp;<span class="op" id="3252581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252585">case</span>&nbsp;<span class="op" id="3252590">*</span><span class="ident" id="3252591">IPAddr</span><span class="op" id="3252597">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252602">if</span>&nbsp;<span class="ident" id="3252605">a</span>&nbsp;<span class="op" id="3252607">:=</span>&nbsp;<span class="ident" id="3252610">v</span><span class="op" id="3252611">.</span><span class="ident" id="3252612">IP</span><span class="op" id="3252614">.</span><span class="ident" id="3252615">To4</span><span class="op" id="3252618">(</span><span class="op" id="3252619">)</span><span class="op" id="3252620">;</span>&nbsp;<span class="ident" id="3252622">a</span>&nbsp;<span class="op" id="3252624">!=</span>&nbsp;<span class="ident" id="3252627">nil</span>&nbsp;<span class="op" id="3252631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3252637">copy</span><span class="op" id="3252641">(</span><span class="ident" id="3252642">mreq</span><span class="op" id="3252646">.</span><span class="ident" id="3252647">Interface</span><span class="op" id="3252656">[</span><span class="op" id="3252657">:</span><span class="op" id="3252658">]</span><span class="op" id="3252659">,</span>&nbsp;<span class="ident" id="3252661">a</span><span class="op" id="3252662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252668">goto</span>&nbsp;<span class="ident" id="3252673">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252685">case</span>&nbsp;<span class="op" id="3252690">*</span><span class="ident" id="3252691">IPNet</span><span class="op" id="3252696">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252701">if</span>&nbsp;<span class="ident" id="3252704">a</span>&nbsp;<span class="op" id="3252706">:=</span>&nbsp;<span class="ident" id="3252709">v</span><span class="op" id="3252710">.</span><span class="ident" id="3252711">IP</span><span class="op" id="3252713">.</span><span class="ident" id="3252714">To4</span><span class="op" id="3252717">(</span><span class="op" id="3252718">)</span><span class="op" id="3252719">;</span>&nbsp;<span class="ident" id="3252721">a</span>&nbsp;<span class="op" id="3252723">!=</span>&nbsp;<span class="ident" id="3252726">nil</span>&nbsp;<span class="op" id="3252730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3252736">copy</span><span class="op" id="3252740">(</span><span class="ident" id="3252741">mreq</span><span class="op" id="3252745">.</span><span class="ident" id="3252746">Interface</span><span class="op" id="3252755">[</span><span class="op" id="3252756">:</span><span class="op" id="3252757">]</span><span class="op" id="3252758">,</span>&nbsp;<span class="ident" id="3252760">a</span><span class="op" id="3252761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252767">goto</span>&nbsp;<span class="ident" id="3252772">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252784">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252787">}</span><br>
<span class="lineno"></span><span class="ident" id="3252789">done</span><span class="op" id="3252793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252796">if</span>&nbsp;<span class="ident" id="3252799">bytesEqual</span><span class="op" id="3252809">(</span><span class="ident" id="3252810">mreq</span><span class="op" id="3252814">.</span><span class="ident" id="3252815">Multiaddr</span><span class="op" id="3252824">[</span><span class="op" id="3252825">:</span><span class="op" id="3252826">]</span><span class="op" id="3252827">,</span>&nbsp;<span class="ident" id="3252829">IPv4zero</span><span class="op" id="3252837">.</span><span class="ident" id="3252838">To4</span><span class="op" id="3252841">(</span><span class="op" id="3252842">)</span><span class="op" id="3252843">)</span>&nbsp;<span class="op" id="3252845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252849">return</span>&nbsp;<span class="ident" id="3252856">errNoSuchMulticastInterface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252885">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252888">return</span>&nbsp;<span class="ident" id="3252895">nil</span><br>
<span class="lineno"></span><span class="op" id="3252899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3252902">func</span>&nbsp;<span class="ident" id="3252907">setReadBuffer</span><span class="op" id="3252920">(</span><span class="ident" id="3252921">fd</span>&nbsp;<span class="op" id="3252924">*</span><span class="ident" id="3252925">netFD</span><span class="op" id="3252930">,</span>&nbsp;<span class="ident" id="3252932">bytes</span>&nbsp;<span class="builtintype" id="3252938">int</span><span class="op" id="3252941">)</span>&nbsp;<span class="builtintype" id="3252943">error</span>&nbsp;<span class="op" id="3252949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252952">if</span>&nbsp;<span class="ident" id="3252955">err</span>&nbsp;<span class="op" id="3252959">:=</span>&nbsp;<span class="ident" id="3252962">fd</span><span class="op" id="3252964">.</span><span class="ident" id="3252965">incref</span><span class="op" id="3252971">(</span><span class="op" id="3252972">)</span><span class="op" id="3252973">;</span>&nbsp;<span class="ident" id="3252975">err</span>&nbsp;<span class="op" id="3252979">!=</span>&nbsp;<span class="ident" id="3252982">nil</span>&nbsp;<span class="op" id="3252986">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252990">return</span>&nbsp;<span class="ident" id="3252997">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253005">defer</span>&nbsp;<span class="ident" id="3253011">fd</span><span class="op" id="3253013">.</span><span class="ident" id="3253014">decref</span><span class="op" id="3253020">(</span><span class="op" id="3253021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253024">return</span>&nbsp;<span class="ident" id="3253031">os</span><span class="op" id="3253033">.</span><span class="ident" id="3253034">NewSyscallError</span><span class="op" id="3253049">(</span><span class="string" id="3253050">&#34;setsockopt&#34;</span><span class="op" id="3253062">,</span>&nbsp;<span class="ident" id="3253064">syscall</span><span class="op" id="3253071">.</span><span class="ident" id="3253072">SetsockoptInt</span><span class="op" id="3253085">(</span><span class="ident" id="3253086">fd</span><span class="op" id="3253088">.</span><span class="ident" id="3253089">sysfd</span><span class="op" id="3253094">,</span>&nbsp;<span class="ident" id="3253096">syscall</span><span class="op" id="3253103">.</span><span class="ident" id="3253104">SOL_SOCKET</span><span class="op" id="3253114">,</span>&nbsp;<span class="ident" id="3253116">syscall</span><span class="op" id="3253123">.</span><span class="ident" id="3253124">SO_RCVBUF</span><span class="op" id="3253133">,</span>&nbsp;<span class="ident" id="3253135">bytes</span><span class="op" id="3253140">)</span><span class="op" id="3253141">)</span><br>
<span class="lineno"></span><span class="op" id="3253143">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="3253146">func</span>&nbsp;<span class="ident" id="3253151">setWriteBuffer</span><span class="op" id="3253165">(</span><span class="ident" id="3253166">fd</span>&nbsp;<span class="op" id="3253169">*</span><span class="ident" id="3253170">netFD</span><span class="op" id="3253175">,</span>&nbsp;<span class="ident" id="3253177">bytes</span>&nbsp;<span class="builtintype" id="3253183">int</span><span class="op" id="3253186">)</span>&nbsp;<span class="builtintype" id="3253188">error</span>&nbsp;<span class="op" id="3253194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253197">if</span>&nbsp;<span class="ident" id="3253200">err</span>&nbsp;<span class="op" id="3253204">:=</span>&nbsp;<span class="ident" id="3253207">fd</span><span class="op" id="3253209">.</span><span class="ident" id="3253210">incref</span><span class="op" id="3253216">(</span><span class="op" id="3253217">)</span><span class="op" id="3253218">;</span>&nbsp;<span class="ident" id="3253220">err</span>&nbsp;<span class="op" id="3253224">!=</span>&nbsp;<span class="ident" id="3253227">nil</span>&nbsp;<span class="op" id="3253231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253235">return</span>&nbsp;<span class="ident" id="3253242">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253247">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253250">defer</span>&nbsp;<span class="ident" id="3253256">fd</span><span class="op" id="3253258">.</span><span class="ident" id="3253259">decref</span><span class="op" id="3253265">(</span><span class="op" id="3253266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253269">return</span>&nbsp;<span class="ident" id="3253276">os</span><span class="op" id="3253278">.</span><span class="ident" id="3253279">NewSyscallError</span><span class="op" id="3253294">(</span><span class="string" id="3253295">&#34;setsockopt&#34;</span><span class="op" id="3253307">,</span>&nbsp;<span class="ident" id="3253309">syscall</span><span class="op" id="3253316">.</span><span class="ident" id="3253317">SetsockoptInt</span><span class="op" id="3253330">(</span><span class="ident" id="3253331">fd</span><span class="op" id="3253333">.</span><span class="ident" id="3253334">sysfd</span><span class="op" id="3253339">,</span>&nbsp;<span class="ident" id="3253341">syscall</span><span class="op" id="3253348">.</span><span class="ident" id="3253349">SOL_SOCKET</span><span class="op" id="3253359">,</span>&nbsp;<span class="ident" id="3253361">syscall</span><span class="op" id="3253368">.</span><span class="ident" id="3253369">SO_SNDBUF</span><span class="op" id="3253378">,</span>&nbsp;<span class="ident" id="3253380">bytes</span><span class="op" id="3253385">)</span><span class="op" id="3253386">)</span><br>
<span class="lineno"></span><span class="op" id="3253388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3253391">func</span>&nbsp;<span class="ident" id="3253396">setKeepAlive</span><span class="op" id="3253408">(</span><span class="ident" id="3253409">fd</span>&nbsp;<span class="op" id="3253412">*</span><span class="ident" id="3253413">netFD</span><span class="op" id="3253418">,</span>&nbsp;<span class="ident" id="3253420">keepalive</span>&nbsp;<span class="builtintype" id="3253430">bool</span><span class="op" id="3253434">)</span>&nbsp;<span class="builtintype" id="3253436">error</span>&nbsp;<span class="op" id="3253442">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253445">if</span>&nbsp;<span class="ident" id="3253448">err</span>&nbsp;<span class="op" id="3253452">:=</span>&nbsp;<span class="ident" id="3253455">fd</span><span class="op" id="3253457">.</span><span class="ident" id="3253458">incref</span><span class="op" id="3253464">(</span><span class="op" id="3253465">)</span><span class="op" id="3253466">;</span>&nbsp;<span class="ident" id="3253468">err</span>&nbsp;<span class="op" id="3253472">!=</span>&nbsp;<span class="ident" id="3253475">nil</span>&nbsp;<span class="op" id="3253479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253483">return</span>&nbsp;<span class="ident" id="3253490">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253498">defer</span>&nbsp;<span class="ident" id="3253504">fd</span><span class="op" id="3253506">.</span><span class="ident" id="3253507">decref</span><span class="op" id="3253513">(</span><span class="op" id="3253514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253517">return</span>&nbsp;<span class="ident" id="3253524">os</span><span class="op" id="3253526">.</span><span class="ident" id="3253527">NewSyscallError</span><span class="op" id="3253542">(</span><span class="string" id="3253543">&#34;setsockopt&#34;</span><span class="op" id="3253555">,</span>&nbsp;<span class="ident" id="3253557">syscall</span><span class="op" id="3253564">.</span><span class="ident" id="3253565">SetsockoptInt</span><span class="op" id="3253578">(</span><span class="ident" id="3253579">fd</span><span class="op" id="3253581">.</span><span class="ident" id="3253582">sysfd</span><span class="op" id="3253587">,</span>&nbsp;<span class="ident" id="3253589">syscall</span><span class="op" id="3253596">.</span><span class="ident" id="3253597">SOL_SOCKET</span><span class="op" id="3253607">,</span>&nbsp;<span class="ident" id="3253609">syscall</span><span class="op" id="3253616">.</span><span class="ident" id="3253617">SO_KEEPALIVE</span><span class="op" id="3253629">,</span>&nbsp;<span class="ident" id="3253631">boolint</span><span class="op" id="3253638">(</span><span class="ident" id="3253639">keepalive</span><span class="op" id="3253648">)</span><span class="op" id="3253649">)</span><span class="op" id="3253650">)</span><br>
<span class="lineno">125</span><span class="op" id="3253652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3253655">func</span>&nbsp;<span class="ident" id="3253660">setLinger</span><span class="op" id="3253669">(</span><span class="ident" id="3253670">fd</span>&nbsp;<span class="op" id="3253673">*</span><span class="ident" id="3253674">netFD</span><span class="op" id="3253679">,</span>&nbsp;<span class="ident" id="3253681">sec</span>&nbsp;<span class="builtintype" id="3253685">int</span><span class="op" id="3253688">)</span>&nbsp;<span class="builtintype" id="3253690">error</span>&nbsp;<span class="op" id="3253696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253699">var</span>&nbsp;<span class="ident" id="3253703">l</span>&nbsp;<span class="ident" id="3253705">syscall</span><span class="op" id="3253712">.</span><span class="ident" id="3253713">Linger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253721">if</span>&nbsp;<span class="ident" id="3253724">sec</span>&nbsp;<span class="op" id="3253728">&gt;=</span>&nbsp;<span class="num" id="3253731">0</span>&nbsp;<span class="op" id="3253733">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253737">l</span><span class="op" id="3253738">.</span><span class="ident" id="3253739">Onoff</span>&nbsp;<span class="op" id="3253745">=</span>&nbsp;<span class="num" id="3253747">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253751">l</span><span class="op" id="3253752">.</span><span class="ident" id="3253753">Linger</span>&nbsp;<span class="op" id="3253760">=</span>&nbsp;<span class="builtintype" id="3253762">int32</span><span class="op" id="3253767">(</span><span class="ident" id="3253768">sec</span><span class="op" id="3253771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253774">}</span>&nbsp;<span class="keyword" id="3253776">else</span>&nbsp;<span class="op" id="3253781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253785">l</span><span class="op" id="3253786">.</span><span class="ident" id="3253787">Onoff</span>&nbsp;<span class="op" id="3253793">=</span>&nbsp;<span class="num" id="3253795">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253799">l</span><span class="op" id="3253800">.</span><span class="ident" id="3253801">Linger</span>&nbsp;<span class="op" id="3253808">=</span>&nbsp;<span class="num" id="3253810">0</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253816">if</span>&nbsp;<span class="ident" id="3253819">err</span>&nbsp;<span class="op" id="3253823">:=</span>&nbsp;<span class="ident" id="3253826">fd</span><span class="op" id="3253828">.</span><span class="ident" id="3253829">incref</span><span class="op" id="3253835">(</span><span class="op" id="3253836">)</span><span class="op" id="3253837">;</span>&nbsp;<span class="ident" id="3253839">err</span>&nbsp;<span class="op" id="3253843">!=</span>&nbsp;<span class="ident" id="3253846">nil</span>&nbsp;<span class="op" id="3253850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253854">return</span>&nbsp;<span class="ident" id="3253861">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253869">defer</span>&nbsp;<span class="ident" id="3253875">fd</span><span class="op" id="3253877">.</span><span class="ident" id="3253878">decref</span><span class="op" id="3253884">(</span><span class="op" id="3253885">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253888">return</span>&nbsp;<span class="ident" id="3253895">os</span><span class="op" id="3253897">.</span><span class="ident" id="3253898">NewSyscallError</span><span class="op" id="3253913">(</span><span class="string" id="3253914">&#34;setsockopt&#34;</span><span class="op" id="3253926">,</span>&nbsp;<span class="ident" id="3253928">syscall</span><span class="op" id="3253935">.</span><span class="ident" id="3253936">SetsockoptLinger</span><span class="op" id="3253952">(</span><span class="ident" id="3253953">fd</span><span class="op" id="3253955">.</span><span class="ident" id="3253956">sysfd</span><span class="op" id="3253961">,</span>&nbsp;<span class="ident" id="3253963">syscall</span><span class="op" id="3253970">.</span><span class="ident" id="3253971">SOL_SOCKET</span><span class="op" id="3253981">,</span>&nbsp;<span class="ident" id="3253983">syscall</span><span class="op" id="3253990">.</span><span class="ident" id="3253991">SO_LINGER</span><span class="op" id="3254000">,</span>&nbsp;<span class="op" id="3254002">&amp;</span><span class="ident" id="3254003">l</span><span class="op" id="3254004">)</span><span class="op" id="3254005">)</span><br>
<span class="lineno"></span><span class="op" id="3254007">}</span>
</div>
</body>
</html>
