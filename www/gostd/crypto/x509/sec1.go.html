<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html" class="current">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4628996">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4629051">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4629105">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4629156">package</span>&nbsp;<span class="ident" id="4629164">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4629170">import</span>&nbsp;<span class="op" id="4629177">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4629180">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4629196">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4629215">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4629232">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4629242">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4629249">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4629260">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4629263">const</span>&nbsp;<span class="ident" id="4629269">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4629286">=</span>&nbsp;<span class="num" id="4629288">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4629291">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4629363">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4629378">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4629391">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4629452">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4629525">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4629550">type</span>&nbsp;<span class="ident" id="4629555">ecPrivateKey</span>&nbsp;<span class="keyword" id="4629568">struct</span>&nbsp;<span class="op" id="4629575">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629578">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4629592">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629597">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4629611">[</span><span class="op" id="4629612">]</span><span class="builtintype" id="4629613">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629619">NamedCurveOID</span>&nbsp;<span class="ident" id="4629633"><a href="/gostd/crypto/x509/sec1.go.html#4629215">asn1</a></span><span class="op" id="4629637">.</span><span class="ident" id="4629638"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span>&nbsp;<span class="string" id="4629655">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629689">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629703"><a href="/gostd/crypto/x509/sec1.go.html#4629215">asn1</a></span><span class="op" id="4629707">.</span><span class="ident" id="4629708"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4629725">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4629758">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4629761">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4629836">func</span>&nbsp;<span class="ident" id="4629841">ParseECPrivateKey</span><span class="op" id="4629858">(</span><span class="ident" id="4629859">der</span>&nbsp;<span class="op" id="4629863">[</span><span class="op" id="4629864">]</span><span class="builtintype" id="4629865">byte</span><span class="op" id="4629869">)</span>&nbsp;<span class="op" id="4629871">(</span><span class="ident" id="4629872">key</span>&nbsp;<span class="op" id="4629876">*</span><span class="ident" id="4629877"><a href="/gostd/crypto/x509/sec1.go.html#4629180">ecdsa</a></span><span class="op" id="4629882">.</span><span class="ident" id="4629883"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="4629893">,</span>&nbsp;<span class="ident" id="4629895">err</span>&nbsp;<span class="builtintype" id="4629899">error</span><span class="op" id="4629904">)</span>&nbsp;<span class="op" id="4629906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629909">return</span>&nbsp;<span class="ident" id="4629916"><a href="/gostd/crypto/x509/sec1.go.html#4630681">parseECPrivateKey</a></span><span class="op" id="4629933">(</span><span class="builtintype" id="4629934">nil</span><span class="op" id="4629937">,</span>&nbsp;<span class="ident" id="4629939"><a href="/gostd/crypto/x509/sec1.go.html#4629859">der</a></span><span class="op" id="4629942">)</span><br>
<span class="lineno"></span><span class="op" id="4629944">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4629947">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4630021">func</span>&nbsp;<span class="ident" id="4630026">MarshalECPrivateKey</span><span class="op" id="4630045">(</span><span class="ident" id="4630046">key</span>&nbsp;<span class="op" id="4630050">*</span><span class="ident" id="4630051"><a href="/gostd/crypto/x509/sec1.go.html#4629180">ecdsa</a></span><span class="op" id="4630056">.</span><span class="ident" id="4630057"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="4630067">)</span>&nbsp;<span class="op" id="4630069">(</span><span class="op" id="4630070">[</span><span class="op" id="4630071">]</span><span class="builtintype" id="4630072">byte</span><span class="op" id="4630076">,</span>&nbsp;<span class="builtintype" id="4630078">error</span><span class="op" id="4630083">)</span>&nbsp;<span class="op" id="4630085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630088">oid</span><span class="op" id="4630091">,</span>&nbsp;<span class="ident" id="4630093">ok</span>&nbsp;<span class="op" id="4630096">:=</span>&nbsp;<span class="ident" id="4630099"><a href="/gostd/crypto/x509/x509.go.html#4655537">oidFromNamedCurve</a></span><span class="op" id="4630116">(</span><span class="ident" id="4630117"><a href="/gostd/crypto/x509/sec1.go.html#4630046">key</a></span><span class="op" id="4630120">.</span><span class="ident" id="4630121"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span><span class="op" id="4630126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630129">if</span>&nbsp;<span class="op" id="4630132">!</span><span class="ident" id="4630133"><a href="/gostd/crypto/x509/sec1.go.html#4630093">ok</a></span>&nbsp;<span class="op" id="4630136">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630140">return</span>&nbsp;<span class="builtintype" id="4630147">nil</span><span class="op" id="4630150">,</span>&nbsp;<span class="ident" id="4630152"><a href="/gostd/crypto/x509/sec1.go.html#4629232">errors</a></span><span class="op" id="4630158">.</span><span class="ident" id="4630159"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4630162">(</span><span class="string" id="4630163">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4630193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630199">return</span>&nbsp;<span class="ident" id="4630206"><a href="/gostd/crypto/x509/sec1.go.html#4629215">asn1</a></span><span class="op" id="4630210">.</span><span class="ident" id="4630211"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4630218">(</span><span class="ident" id="4630219"><a href="/gostd/crypto/x509/sec1.go.html#4629555">ecPrivateKey</a></span><span class="op" id="4630231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630235"><a href="/gostd/crypto/x509/sec1.go.html#4629578">Version</a></span><span class="op" id="4630242">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4630250">1</span><span class="op" id="4630251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630255"><a href="/gostd/crypto/x509/sec1.go.html#4629597">PrivateKey</a></span><span class="op" id="4630265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630270"><a href="/gostd/crypto/x509/sec1.go.html#4630046">key</a></span><span class="op" id="4630273">.</span><span class="ident" id="4630274"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005545">D</a></span><span class="op" id="4630275">.</span><span class="ident" id="4630276"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="4630281">(</span><span class="op" id="4630282">)</span><span class="op" id="4630283">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630287"><a href="/gostd/crypto/x509/sec1.go.html#4629619">NamedCurveOID</a></span><span class="op" id="4630300">:</span>&nbsp;<span class="ident" id="4630302"><a href="/gostd/crypto/x509/sec1.go.html#4630088">oid</a></span><span class="op" id="4630305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630309"><a href="/gostd/crypto/x509/sec1.go.html#4629689">PublicKey</a></span><span class="op" id="4630318">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630324"><a href="/gostd/crypto/x509/sec1.go.html#4629215">asn1</a></span><span class="op" id="4630328">.</span><span class="ident" id="4630329"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="4630338">{</span><span class="ident" id="4630339"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="4630344">:</span>&nbsp;<span class="ident" id="4630346"><a href="/gostd/crypto/x509/sec1.go.html#4629196">elliptic</a></span><span class="op" id="4630354">.</span><span class="ident" id="4630355"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023027">Marshal</a></span><span class="op" id="4630362">(</span><span class="ident" id="4630363"><a href="/gostd/crypto/x509/sec1.go.html#4630046">key</a></span><span class="op" id="4630366">.</span><span class="ident" id="4630367"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span><span class="op" id="4630372">,</span>&nbsp;<span class="ident" id="4630374"><a href="/gostd/crypto/x509/sec1.go.html#4630046">key</a></span><span class="op" id="4630377">.</span><span class="ident" id="4630378"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005445">X</a></span><span class="op" id="4630379">,</span>&nbsp;<span class="ident" id="4630381"><a href="/gostd/crypto/x509/sec1.go.html#4630046">key</a></span><span class="op" id="4630384">.</span><span class="ident" id="4630385"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005448">Y</a></span><span class="op" id="4630386">)</span><span class="op" id="4630387">}</span><span class="op" id="4630388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630391">}</span><span class="op" id="4630392">)</span><br>
<span class="lineno"></span><span class="op" id="4630394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4630397">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4630472">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4630548">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4630625">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4630676">func</span>&nbsp;<span class="ident" id="4630681">parseECPrivateKey</span><span class="op" id="4630698">(</span><span class="ident" id="4630699">namedCurveOID</span>&nbsp;<span class="op" id="4630713">*</span><span class="ident" id="4630714"><a href="/gostd/crypto/x509/sec1.go.html#4629215">asn1</a></span><span class="op" id="4630718">.</span><span class="ident" id="4630719"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4630735">,</span>&nbsp;<span class="ident" id="4630737">der</span>&nbsp;<span class="op" id="4630741">[</span><span class="op" id="4630742">]</span><span class="builtintype" id="4630743">byte</span><span class="op" id="4630747">)</span>&nbsp;<span class="op" id="4630749">(</span><span class="ident" id="4630750">key</span>&nbsp;<span class="op" id="4630754">*</span><span class="ident" id="4630755"><a href="/gostd/crypto/x509/sec1.go.html#4629180">ecdsa</a></span><span class="op" id="4630760">.</span><span class="ident" id="4630761"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="4630771">,</span>&nbsp;<span class="ident" id="4630773">err</span>&nbsp;<span class="builtintype" id="4630777">error</span><span class="op" id="4630782">)</span>&nbsp;<span class="op" id="4630784">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630787">var</span>&nbsp;<span class="ident" id="4630791">privKey</span>&nbsp;<span class="ident" id="4630799"><a href="/gostd/crypto/x509/sec1.go.html#4629555">ecPrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630813">if</span>&nbsp;<span class="ident" id="4630816">_</span><span class="op" id="4630817">,</span>&nbsp;<span class="ident" id="4630819">err</span>&nbsp;<span class="op" id="4630823">:=</span>&nbsp;<span class="ident" id="4630826"><a href="/gostd/crypto/x509/sec1.go.html#4629215">asn1</a></span><span class="op" id="4630830">.</span><span class="ident" id="4630831"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4630840">(</span><span class="ident" id="4630841"><a href="/gostd/crypto/x509/sec1.go.html#4630737">der</a></span><span class="op" id="4630844">,</span>&nbsp;<span class="op" id="4630846">&amp;</span><span class="ident" id="4630847"><a href="/gostd/crypto/x509/sec1.go.html#4630791">privKey</a></span><span class="op" id="4630854">)</span><span class="op" id="4630855">;</span>&nbsp;<span class="ident" id="4630857"><a href="/gostd/crypto/x509/sec1.go.html#4630819">err</a></span>&nbsp;<span class="op" id="4630861">!=</span>&nbsp;<span class="builtintype" id="4630864">nil</span>&nbsp;<span class="op" id="4630868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630872">return</span>&nbsp;<span class="builtintype" id="4630879">nil</span><span class="op" id="4630882">,</span>&nbsp;<span class="ident" id="4630884"><a href="/gostd/crypto/x509/sec1.go.html#4629232">errors</a></span><span class="op" id="4630890">.</span><span class="ident" id="4630891"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4630894">(</span><span class="string" id="4630895">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4630936">+</span>&nbsp;<span class="ident" id="4630938"><a href="/gostd/crypto/x509/sec1.go.html#4630819">err</a></span><span class="op" id="4630941">.</span><span class="ident" id="4630942">Error</span><span class="op" id="4630947">(</span><span class="op" id="4630948">)</span><span class="op" id="4630949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630955">if</span>&nbsp;<span class="ident" id="4630958"><a href="/gostd/crypto/x509/sec1.go.html#4630791">privKey</a></span><span class="op" id="4630965">.</span><span class="ident" id="4630966"><a href="/gostd/crypto/x509/sec1.go.html#4629578">Version</a></span>&nbsp;<span class="op" id="4630974">!=</span>&nbsp;<span class="ident" id="4630977"><a href="/gostd/crypto/x509/sec1.go.html#4629269">ecPrivKeyVersion</a></span>&nbsp;<span class="op" id="4630994">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630998">return</span>&nbsp;<span class="builtintype" id="4631005">nil</span><span class="op" id="4631008">,</span>&nbsp;<span class="ident" id="4631010"><a href="/gostd/crypto/x509/sec1.go.html#4629242">fmt</a></span><span class="op" id="4631013">.</span><span class="ident" id="4631014"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="4631020">(</span><span class="string" id="4631021">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4631062">,</span>&nbsp;<span class="ident" id="4631064"><a href="/gostd/crypto/x509/sec1.go.html#4630791">privKey</a></span><span class="op" id="4631071">.</span><span class="ident" id="4631072"><a href="/gostd/crypto/x509/sec1.go.html#4629578">Version</a></span><span class="op" id="4631079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631086">var</span>&nbsp;<span class="ident" id="4631090">curve</span>&nbsp;<span class="ident" id="4631096"><a href="/gostd/crypto/x509/sec1.go.html#4629196">elliptic</a></span><span class="op" id="4631104">.</span><span class="ident" id="4631105"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631112">if</span>&nbsp;<span class="ident" id="4631115"><a href="/gostd/crypto/x509/sec1.go.html#4630699">namedCurveOID</a></span>&nbsp;<span class="op" id="4631129">!=</span>&nbsp;<span class="builtintype" id="4631132">nil</span>&nbsp;<span class="op" id="4631136">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631140"><a href="/gostd/crypto/x509/sec1.go.html#4631090">curve</a></span>&nbsp;<span class="op" id="4631146">=</span>&nbsp;<span class="ident" id="4631148"><a href="/gostd/crypto/x509/x509.go.html#4655198">namedCurveFromOID</a></span><span class="op" id="4631165">(</span><span class="op" id="4631166">*</span><span class="ident" id="4631167"><a href="/gostd/crypto/x509/sec1.go.html#4630699">namedCurveOID</a></span><span class="op" id="4631180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631183">}</span>&nbsp;<span class="keyword" id="4631185">else</span>&nbsp;<span class="op" id="4631190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631194"><a href="/gostd/crypto/x509/sec1.go.html#4631090">curve</a></span>&nbsp;<span class="op" id="4631200">=</span>&nbsp;<span class="ident" id="4631202"><a href="/gostd/crypto/x509/x509.go.html#4655198">namedCurveFromOID</a></span><span class="op" id="4631219">(</span><span class="ident" id="4631220"><a href="/gostd/crypto/x509/sec1.go.html#4630791">privKey</a></span><span class="op" id="4631227">.</span><span class="ident" id="4631228"><a href="/gostd/crypto/x509/sec1.go.html#4629619">NamedCurveOID</a></span><span class="op" id="4631241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631247">if</span>&nbsp;<span class="ident" id="4631250"><a href="/gostd/crypto/x509/sec1.go.html#4631090">curve</a></span>&nbsp;<span class="op" id="4631256">==</span>&nbsp;<span class="builtintype" id="4631259">nil</span>&nbsp;<span class="op" id="4631263">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631267">return</span>&nbsp;<span class="builtintype" id="4631274">nil</span><span class="op" id="4631277">,</span>&nbsp;<span class="ident" id="4631279"><a href="/gostd/crypto/x509/sec1.go.html#4629232">errors</a></span><span class="op" id="4631285">.</span><span class="ident" id="4631286"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4631289">(</span><span class="string" id="4631290">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4631320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631327">k</span>&nbsp;<span class="op" id="4631329">:=</span>&nbsp;<span class="builtinfunc" id="4631332">new</span><span class="op" id="4631335">(</span><span class="ident" id="4631336"><a href="/gostd/crypto/x509/sec1.go.html#4629249">big</a></span><span class="op" id="4631339">.</span><span class="ident" id="4631340"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4631343">)</span><span class="op" id="4631344">.</span><span class="ident" id="4631345"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="4631353">(</span><span class="ident" id="4631354"><a href="/gostd/crypto/x509/sec1.go.html#4630791">privKey</a></span><span class="op" id="4631361">.</span><span class="ident" id="4631362"><a href="/gostd/crypto/x509/sec1.go.html#4629597">PrivateKey</a></span><span class="op" id="4631372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631375">if</span>&nbsp;<span class="ident" id="4631378"><a href="/gostd/crypto/x509/sec1.go.html#4631327">k</a></span><span class="op" id="4631379">.</span><span class="ident" id="4631380"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4631383">(</span><span class="ident" id="4631384"><a href="/gostd/crypto/x509/sec1.go.html#4631090">curve</a></span><span class="op" id="4631389">.</span><span class="ident" id="4631390"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015945">Params</a></span><span class="op" id="4631396">(</span><span class="op" id="4631397">)</span><span class="op" id="4631398">.</span><span class="ident" id="4631399"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016729">N</a></span><span class="op" id="4631400">)</span>&nbsp;<span class="op" id="4631402">&gt;=</span>&nbsp;<span class="num" id="4631405">0</span>&nbsp;<span class="op" id="4631407">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631411">return</span>&nbsp;<span class="builtintype" id="4631418">nil</span><span class="op" id="4631421">,</span>&nbsp;<span class="ident" id="4631423"><a href="/gostd/crypto/x509/sec1.go.html#4629232">errors</a></span><span class="op" id="4631429">.</span><span class="ident" id="4631430"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4631433">(</span><span class="string" id="4631434">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4631482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631488">priv</span>&nbsp;<span class="op" id="4631493">:=</span>&nbsp;<span class="builtinfunc" id="4631496">new</span><span class="op" id="4631499">(</span><span class="ident" id="4631500"><a href="/gostd/crypto/x509/sec1.go.html#4629180">ecdsa</a></span><span class="op" id="4631505">.</span><span class="ident" id="4631506"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="4631516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631519"><a href="/gostd/crypto/x509/sec1.go.html#4631488">priv</a></span><span class="op" id="4631523">.</span><span class="ident" id="4631524"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="4631530">=</span>&nbsp;<span class="ident" id="4631532"><a href="/gostd/crypto/x509/sec1.go.html#4631090">curve</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631539"><a href="/gostd/crypto/x509/sec1.go.html#4631488">priv</a></span><span class="op" id="4631543">.</span><span class="ident" id="4631544"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005545">D</a></span>&nbsp;<span class="op" id="4631546">=</span>&nbsp;<span class="ident" id="4631548"><a href="/gostd/crypto/x509/sec1.go.html#4631327">k</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631551"><a href="/gostd/crypto/x509/sec1.go.html#4631488">priv</a></span><span class="op" id="4631555">.</span><span class="ident" id="4631556"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005445">X</a></span><span class="op" id="4631557">,</span>&nbsp;<span class="ident" id="4631559"><a href="/gostd/crypto/x509/sec1.go.html#4631488">priv</a></span><span class="op" id="4631563">.</span><span class="ident" id="4631564"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005448">Y</a></span>&nbsp;<span class="op" id="4631566">=</span>&nbsp;<span class="ident" id="4631568"><a href="/gostd/crypto/x509/sec1.go.html#4631090">curve</a></span><span class="op" id="4631573">.</span><span class="ident" id="4631574"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016468">ScalarBaseMult</a></span><span class="op" id="4631588">(</span><span class="ident" id="4631589"><a href="/gostd/crypto/x509/sec1.go.html#4630791">privKey</a></span><span class="op" id="4631596">.</span><span class="ident" id="4631597"><a href="/gostd/crypto/x509/sec1.go.html#4629597">PrivateKey</a></span><span class="op" id="4631607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631611">return</span>&nbsp;<span class="ident" id="4631618"><a href="/gostd/crypto/x509/sec1.go.html#4631488">priv</a></span><span class="op" id="4631622">,</span>&nbsp;<span class="builtintype" id="4631624">nil</span><br>
<span class="lineno"></span><span class="op" id="4631628">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
