<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5413100">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5413156">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5413210">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5413261">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5413346">package</span>&nbsp;<span class="ident" id="5413354">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5413358">import</span>&nbsp;<span class="op" id="5413365">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5413368">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5413383">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5413402">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5413412">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5413419">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5413425">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5413431">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5413441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5413444">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5413482">type</span>&nbsp;<span class="ident" id="5413487">File</span>&nbsp;<span class="keyword" id="5413492">struct</span>&nbsp;<span class="op" id="5413499">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413502">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413514">OptionalHeader</span>&nbsp;<span class="keyword" id="5413529">interface</span><span class="op" id="5413538">{</span><span class="op" id="5413539">}</span>&nbsp;<span class="comment" id="5413541">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413592">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413607">[</span><span class="op" id="5413608">]</span><span class="op" id="5413609">*</span><span class="ident" id="5413610">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413619">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413634">[</span><span class="op" id="5413635">]</span><span class="op" id="5413636">*</span><span class="ident" id="5413637">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413646">closer</span>&nbsp;<span class="ident" id="5413653">io</span><span class="op" id="5413655">.</span><span class="ident" id="5413656">Closer</span><br>
<span class="lineno"></span><span class="op" id="5413663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5413666">type</span>&nbsp;<span class="ident" id="5413671">SectionHeader</span>&nbsp;<span class="keyword" id="5413685">struct</span>&nbsp;<span class="op" id="5413692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413695">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5413716">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413724">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5413745">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413753">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5413774">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413782">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5413803">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413811">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5413832">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413840">PointerToRelocations</span>&nbsp;<span class="builtintype" id="5413861">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413869">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="5413890">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413898">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="5413919">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413927">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="5413948">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413956">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5413977">uint32</span><br>
<span class="lineno"></span><span class="op" id="5413984">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5413987">type</span>&nbsp;<span class="ident" id="5413992">Section</span>&nbsp;<span class="keyword" id="5414000">struct</span>&nbsp;<span class="op" id="5414007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414010">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5414026">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5414064">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5414104">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5414139">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5414187">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5414237">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414261">io</span><span class="op" id="5414263">.</span><span class="ident" id="5414264">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414274">sr</span>&nbsp;<span class="op" id="5414277">*</span><span class="ident" id="5414278">io</span><span class="op" id="5414280">.</span><span class="ident" id="5414281">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5414295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5414298">type</span>&nbsp;<span class="ident" id="5414303">Symbol</span>&nbsp;<span class="keyword" id="5414310">struct</span>&nbsp;<span class="op" id="5414317">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414320">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5414334">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414342">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5414356">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414364">SectionNumber</span>&nbsp;<span class="builtintype" id="5414378">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414385">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5414399">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414407">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="5414421">uint8</span><br>
<span class="lineno">60</span><span class="op" id="5414427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5414430">type</span>&nbsp;<span class="ident" id="5414435">ImportDirectory</span>&nbsp;<span class="keyword" id="5414451">struct</span>&nbsp;<span class="op" id="5414458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414461">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="5414480">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414488">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5414507">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414515">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5414534">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414542">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5414561">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414569">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5414588">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414597">dll</span>&nbsp;<span class="builtintype" id="5414601">string</span><br>
<span class="lineno">70</span><span class="op" id="5414608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5414611">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5414669">func</span>&nbsp;<span class="op" id="5414674">(</span><span class="ident" id="5414675">s</span>&nbsp;<span class="op" id="5414677">*</span><span class="ident" id="5414678">Section</span><span class="op" id="5414685">)</span>&nbsp;<span class="ident" id="5414687">Data</span><span class="op" id="5414691">(</span><span class="op" id="5414692">)</span>&nbsp;<span class="op" id="5414694">(</span><span class="op" id="5414695">[</span><span class="op" id="5414696">]</span><span class="builtintype" id="5414697">byte</span><span class="op" id="5414701">,</span>&nbsp;<span class="builtintype" id="5414703">error</span><span class="op" id="5414708">)</span>&nbsp;<span class="op" id="5414710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414713">dat</span>&nbsp;<span class="op" id="5414717">:=</span>&nbsp;<span class="builtinfunc" id="5414720">make</span><span class="op" id="5414724">(</span><span class="op" id="5414725">[</span><span class="op" id="5414726">]</span><span class="builtintype" id="5414727">byte</span><span class="op" id="5414731">,</span>&nbsp;<span class="ident" id="5414733">s</span><span class="op" id="5414734">.</span><span class="ident" id="5414735">sr</span><span class="op" id="5414737">.</span><span class="ident" id="5414738">Size</span><span class="op" id="5414742">(</span><span class="op" id="5414743">)</span><span class="op" id="5414744">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414747">n</span><span class="op" id="5414748">,</span>&nbsp;<span class="ident" id="5414750">err</span>&nbsp;<span class="op" id="5414754">:=</span>&nbsp;<span class="ident" id="5414757">s</span><span class="op" id="5414758">.</span><span class="ident" id="5414759">sr</span><span class="op" id="5414761">.</span><span class="ident" id="5414762">ReadAt</span><span class="op" id="5414768">(</span><span class="ident" id="5414769">dat</span><span class="op" id="5414772">,</span>&nbsp;<span class="num" id="5414774">0</span><span class="op" id="5414775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5414778">if</span>&nbsp;<span class="ident" id="5414781">n</span>&nbsp;<span class="op" id="5414783">==</span>&nbsp;<span class="builtinfunc" id="5414786">len</span><span class="op" id="5414789">(</span><span class="ident" id="5414790">dat</span><span class="op" id="5414793">)</span>&nbsp;<span class="op" id="5414795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414799">err</span>&nbsp;<span class="op" id="5414803">=</span>&nbsp;<span class="ident" id="5414805">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5414810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5414813">return</span>&nbsp;<span class="ident" id="5414820">dat</span><span class="op" id="5414823">[</span><span class="num" id="5414824">0</span><span class="op" id="5414825">:</span><span class="ident" id="5414826">n</span><span class="op" id="5414827">]</span><span class="op" id="5414828">,</span>&nbsp;<span class="ident" id="5414830">err</span><br>
<span class="lineno">80</span><span class="op" id="5414834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5414837">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5414894">func</span>&nbsp;<span class="op" id="5414899">(</span><span class="ident" id="5414900">s</span>&nbsp;<span class="op" id="5414902">*</span><span class="ident" id="5414903">Section</span><span class="op" id="5414910">)</span>&nbsp;<span class="ident" id="5414912">Open</span><span class="op" id="5414916">(</span><span class="op" id="5414917">)</span>&nbsp;<span class="ident" id="5414919">io</span><span class="op" id="5414921">.</span><span class="ident" id="5414922">ReadSeeker</span>&nbsp;<span class="op" id="5414933">{</span>&nbsp;<span class="keyword" id="5414935">return</span>&nbsp;<span class="ident" id="5414942">io</span><span class="op" id="5414944">.</span><span class="ident" id="5414945">NewSectionReader</span><span class="op" id="5414961">(</span><span class="ident" id="5414962">s</span><span class="op" id="5414963">.</span><span class="ident" id="5414964">sr</span><span class="op" id="5414966">,</span>&nbsp;<span class="num" id="5414968">0</span><span class="op" id="5414969">,</span>&nbsp;<span class="num" id="5414971">1</span><span class="op" id="5414972">&lt;&lt;</span><span class="num" id="5414974">63</span><span class="op" id="5414976">-</span><span class="num" id="5414977">1</span><span class="op" id="5414978">)</span>&nbsp;<span class="op" id="5414980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="5414983">type</span>&nbsp;<span class="ident" id="5414988">FormatError</span>&nbsp;<span class="keyword" id="5415000">struct</span>&nbsp;<span class="op" id="5415007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415010">off</span>&nbsp;<span class="ident" id="5415014">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415021">msg</span>&nbsp;<span class="builtintype" id="5415025">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415033">val</span>&nbsp;<span class="keyword" id="5415037">interface</span><span class="op" id="5415046">{</span><span class="op" id="5415047">}</span><br>
<span class="lineno"></span><span class="op" id="5415049">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="5415052">func</span>&nbsp;<span class="op" id="5415057">(</span><span class="ident" id="5415058">e</span>&nbsp;<span class="op" id="5415060">*</span><span class="ident" id="5415061">FormatError</span><span class="op" id="5415072">)</span>&nbsp;<span class="ident" id="5415074">Error</span><span class="op" id="5415079">(</span><span class="op" id="5415080">)</span>&nbsp;<span class="builtintype" id="5415082">string</span>&nbsp;<span class="op" id="5415089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415092">msg</span>&nbsp;<span class="op" id="5415096">:=</span>&nbsp;<span class="ident" id="5415099">e</span><span class="op" id="5415100">.</span><span class="ident" id="5415101">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415106">if</span>&nbsp;<span class="ident" id="5415109">e</span><span class="op" id="5415110">.</span><span class="ident" id="5415111">val</span>&nbsp;<span class="op" id="5415115">!=</span>&nbsp;<span class="ident" id="5415118">nil</span>&nbsp;<span class="op" id="5415122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415126">msg</span>&nbsp;<span class="op" id="5415130">+=</span>&nbsp;<span class="ident" id="5415133">fmt</span><span class="op" id="5415136">.</span><span class="ident" id="5415137">Sprintf</span><span class="op" id="5415144">(</span><span class="string" id="5415145">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="5415152">,</span>&nbsp;<span class="ident" id="5415154">e</span><span class="op" id="5415155">.</span><span class="ident" id="5415156">val</span><span class="op" id="5415159">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5415162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415165">msg</span>&nbsp;<span class="op" id="5415169">+=</span>&nbsp;<span class="ident" id="5415172">fmt</span><span class="op" id="5415175">.</span><span class="ident" id="5415176">Sprintf</span><span class="op" id="5415183">(</span><span class="string" id="5415184">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5415208">,</span>&nbsp;<span class="ident" id="5415210">e</span><span class="op" id="5415211">.</span><span class="ident" id="5415212">off</span><span class="op" id="5415215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415218">return</span>&nbsp;<span class="ident" id="5415225">msg</span><br>
<span class="lineno"></span><span class="op" id="5415229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5415232">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5415315">func</span>&nbsp;<span class="ident" id="5415320">Open</span><span class="op" id="5415324">(</span><span class="ident" id="5415325">name</span>&nbsp;<span class="builtintype" id="5415330">string</span><span class="op" id="5415336">)</span>&nbsp;<span class="op" id="5415338">(</span><span class="op" id="5415339">*</span><span class="ident" id="5415340">File</span><span class="op" id="5415344">,</span>&nbsp;<span class="builtintype" id="5415346">error</span><span class="op" id="5415351">)</span>&nbsp;<span class="op" id="5415353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415356">f</span><span class="op" id="5415357">,</span>&nbsp;<span class="ident" id="5415359">err</span>&nbsp;<span class="op" id="5415363">:=</span>&nbsp;<span class="ident" id="5415366">os</span><span class="op" id="5415368">.</span><span class="ident" id="5415369">Open</span><span class="op" id="5415373">(</span><span class="ident" id="5415374">name</span><span class="op" id="5415378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415381">if</span>&nbsp;<span class="ident" id="5415384">err</span>&nbsp;<span class="op" id="5415388">!=</span>&nbsp;<span class="ident" id="5415391">nil</span>&nbsp;<span class="op" id="5415395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415399">return</span>&nbsp;<span class="ident" id="5415406">nil</span><span class="op" id="5415409">,</span>&nbsp;<span class="ident" id="5415411">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5415416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415419">ff</span><span class="op" id="5415421">,</span>&nbsp;<span class="ident" id="5415423">err</span>&nbsp;<span class="op" id="5415427">:=</span>&nbsp;<span class="ident" id="5415430">NewFile</span><span class="op" id="5415437">(</span><span class="ident" id="5415438">f</span><span class="op" id="5415439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415442">if</span>&nbsp;<span class="ident" id="5415445">err</span>&nbsp;<span class="op" id="5415449">!=</span>&nbsp;<span class="ident" id="5415452">nil</span>&nbsp;<span class="op" id="5415456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415460">f</span><span class="op" id="5415461">.</span><span class="ident" id="5415462">Close</span><span class="op" id="5415467">(</span><span class="op" id="5415468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415472">return</span>&nbsp;<span class="ident" id="5415479">nil</span><span class="op" id="5415482">,</span>&nbsp;<span class="ident" id="5415484">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5415489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415492">ff</span><span class="op" id="5415494">.</span><span class="ident" id="5415495">closer</span>&nbsp;<span class="op" id="5415502">=</span>&nbsp;<span class="ident" id="5415504">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415507">return</span>&nbsp;<span class="ident" id="5415514">ff</span><span class="op" id="5415516">,</span>&nbsp;<span class="ident" id="5415518">nil</span><br>
<span class="lineno"></span><span class="op" id="5415522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5415525">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5415551">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="5415618">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5415642">func</span>&nbsp;<span class="op" id="5415647">(</span><span class="ident" id="5415648">f</span>&nbsp;<span class="op" id="5415650">*</span><span class="ident" id="5415651">File</span><span class="op" id="5415655">)</span>&nbsp;<span class="ident" id="5415657">Close</span><span class="op" id="5415662">(</span><span class="op" id="5415663">)</span>&nbsp;<span class="builtintype" id="5415665">error</span>&nbsp;<span class="op" id="5415671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415674">var</span>&nbsp;<span class="ident" id="5415678">err</span>&nbsp;<span class="builtintype" id="5415682">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415689">if</span>&nbsp;<span class="ident" id="5415692">f</span><span class="op" id="5415693">.</span><span class="ident" id="5415694">closer</span>&nbsp;<span class="op" id="5415701">!=</span>&nbsp;<span class="ident" id="5415704">nil</span>&nbsp;<span class="op" id="5415708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415712">err</span>&nbsp;<span class="op" id="5415716">=</span>&nbsp;<span class="ident" id="5415718">f</span><span class="op" id="5415719">.</span><span class="ident" id="5415720">closer</span><span class="op" id="5415726">.</span><span class="ident" id="5415727">Close</span><span class="op" id="5415732">(</span><span class="op" id="5415733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415737">f</span><span class="op" id="5415738">.</span><span class="ident" id="5415739">closer</span>&nbsp;<span class="op" id="5415746">=</span>&nbsp;<span class="ident" id="5415748">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5415753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415756">return</span>&nbsp;<span class="ident" id="5415763">err</span><br>
<span class="lineno">125</span><span class="op" id="5415767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5415770">var</span>&nbsp;<span class="op" id="5415774">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415777">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="5415800">=</span>&nbsp;<span class="builtintype" id="5415802">uint16</span><span class="op" id="5415808">(</span><span class="ident" id="5415809">binary</span><span class="op" id="5415815">.</span><span class="ident" id="5415816">Size</span><span class="op" id="5415820">(</span><span class="ident" id="5415821">OptionalHeader32</span><span class="op" id="5415837">{</span><span class="op" id="5415838">}</span><span class="op" id="5415839">)</span><span class="op" id="5415840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415843">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="5415866">=</span>&nbsp;<span class="builtintype" id="5415868">uint16</span><span class="op" id="5415874">(</span><span class="ident" id="5415875">binary</span><span class="op" id="5415881">.</span><span class="ident" id="5415882">Size</span><span class="op" id="5415886">(</span><span class="ident" id="5415887">OptionalHeader64</span><span class="op" id="5415903">{</span><span class="op" id="5415904">}</span><span class="op" id="5415905">)</span><span class="op" id="5415906">)</span><br>
<span class="lineno">130</span><span class="op" id="5415908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5415911">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5415992">func</span>&nbsp;<span class="ident" id="5415997">NewFile</span><span class="op" id="5416004">(</span><span class="ident" id="5416005">r</span>&nbsp;<span class="ident" id="5416007">io</span><span class="op" id="5416009">.</span><span class="ident" id="5416010">ReaderAt</span><span class="op" id="5416018">)</span>&nbsp;<span class="op" id="5416020">(</span><span class="op" id="5416021">*</span><span class="ident" id="5416022">File</span><span class="op" id="5416026">,</span>&nbsp;<span class="builtintype" id="5416028">error</span><span class="op" id="5416033">)</span>&nbsp;<span class="op" id="5416035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416038">f</span>&nbsp;<span class="op" id="5416040">:=</span>&nbsp;<span class="builtinfunc" id="5416043">new</span><span class="op" id="5416046">(</span><span class="ident" id="5416047">File</span><span class="op" id="5416051">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416054">sr</span>&nbsp;<span class="op" id="5416057">:=</span>&nbsp;<span class="ident" id="5416060">io</span><span class="op" id="5416062">.</span><span class="ident" id="5416063">NewSectionReader</span><span class="op" id="5416079">(</span><span class="ident" id="5416080">r</span><span class="op" id="5416081">,</span>&nbsp;<span class="num" id="5416083">0</span><span class="op" id="5416084">,</span>&nbsp;<span class="num" id="5416086">1</span><span class="op" id="5416087">&lt;&lt;</span><span class="num" id="5416089">63</span><span class="op" id="5416091">-</span><span class="num" id="5416092">1</span><span class="op" id="5416093">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416097">var</span>&nbsp;<span class="ident" id="5416101">dosheader</span>&nbsp;<span class="op" id="5416111">[</span><span class="num" id="5416112">96</span><span class="op" id="5416114">]</span><span class="builtintype" id="5416115">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416121">if</span>&nbsp;<span class="ident" id="5416124">_</span><span class="op" id="5416125">,</span>&nbsp;<span class="ident" id="5416127">err</span>&nbsp;<span class="op" id="5416131">:=</span>&nbsp;<span class="ident" id="5416134">r</span><span class="op" id="5416135">.</span><span class="ident" id="5416136">ReadAt</span><span class="op" id="5416142">(</span><span class="ident" id="5416143">dosheader</span><span class="op" id="5416152">[</span><span class="num" id="5416153">0</span><span class="op" id="5416154">:</span><span class="op" id="5416155">]</span><span class="op" id="5416156">,</span>&nbsp;<span class="num" id="5416158">0</span><span class="op" id="5416159">)</span><span class="op" id="5416160">;</span>&nbsp;<span class="ident" id="5416162">err</span>&nbsp;<span class="op" id="5416166">!=</span>&nbsp;<span class="ident" id="5416169">nil</span>&nbsp;<span class="op" id="5416173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416177">return</span>&nbsp;<span class="ident" id="5416184">nil</span><span class="op" id="5416187">,</span>&nbsp;<span class="ident" id="5416189">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5416194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416197">var</span>&nbsp;<span class="ident" id="5416201">base</span>&nbsp;<span class="ident" id="5416206">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416213">if</span>&nbsp;<span class="ident" id="5416216">dosheader</span><span class="op" id="5416225">[</span><span class="num" id="5416226">0</span><span class="op" id="5416227">]</span>&nbsp;<span class="op" id="5416229">==</span>&nbsp;<span class="string" id="5416232">&#39;M&#39;</span>&nbsp;<span class="op" id="5416236">&amp;&amp;</span>&nbsp;<span class="ident" id="5416239">dosheader</span><span class="op" id="5416248">[</span><span class="num" id="5416249">1</span><span class="op" id="5416250">]</span>&nbsp;<span class="op" id="5416252">==</span>&nbsp;<span class="string" id="5416255">&#39;Z&#39;</span>&nbsp;<span class="op" id="5416259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416263">signoff</span>&nbsp;<span class="op" id="5416271">:=</span>&nbsp;<span class="ident" id="5416274">int64</span><span class="op" id="5416279">(</span><span class="ident" id="5416280">binary</span><span class="op" id="5416286">.</span><span class="ident" id="5416287">LittleEndian</span><span class="op" id="5416299">.</span><span class="ident" id="5416300">Uint32</span><span class="op" id="5416306">(</span><span class="ident" id="5416307">dosheader</span><span class="op" id="5416316">[</span><span class="num" id="5416317">0x3c</span><span class="op" id="5416321">:</span><span class="op" id="5416322">]</span><span class="op" id="5416323">)</span><span class="op" id="5416324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416328">var</span>&nbsp;<span class="ident" id="5416332">sign</span>&nbsp;<span class="op" id="5416337">[</span><span class="num" id="5416338">4</span><span class="op" id="5416339">]</span><span class="builtintype" id="5416340">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416347">r</span><span class="op" id="5416348">.</span><span class="ident" id="5416349">ReadAt</span><span class="op" id="5416355">(</span><span class="ident" id="5416356">sign</span><span class="op" id="5416360">[</span><span class="op" id="5416361">:</span><span class="op" id="5416362">]</span><span class="op" id="5416363">,</span>&nbsp;<span class="ident" id="5416365">signoff</span><span class="op" id="5416372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416376">if</span>&nbsp;<span class="op" id="5416379">!</span><span class="op" id="5416380">(</span><span class="ident" id="5416381">sign</span><span class="op" id="5416385">[</span><span class="num" id="5416386">0</span><span class="op" id="5416387">]</span>&nbsp;<span class="op" id="5416389">==</span>&nbsp;<span class="string" id="5416392">&#39;P&#39;</span>&nbsp;<span class="op" id="5416396">&amp;&amp;</span>&nbsp;<span class="ident" id="5416399">sign</span><span class="op" id="5416403">[</span><span class="num" id="5416404">1</span><span class="op" id="5416405">]</span>&nbsp;<span class="op" id="5416407">==</span>&nbsp;<span class="string" id="5416410">&#39;E&#39;</span>&nbsp;<span class="op" id="5416414">&amp;&amp;</span>&nbsp;<span class="ident" id="5416417">sign</span><span class="op" id="5416421">[</span><span class="num" id="5416422">2</span><span class="op" id="5416423">]</span>&nbsp;<span class="op" id="5416425">==</span>&nbsp;<span class="num" id="5416428">0</span>&nbsp;<span class="op" id="5416430">&amp;&amp;</span>&nbsp;<span class="ident" id="5416433">sign</span><span class="op" id="5416437">[</span><span class="num" id="5416438">3</span><span class="op" id="5416439">]</span>&nbsp;<span class="op" id="5416441">==</span>&nbsp;<span class="num" id="5416444">0</span><span class="op" id="5416445">)</span>&nbsp;<span class="op" id="5416447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416452">return</span>&nbsp;<span class="ident" id="5416459">nil</span><span class="op" id="5416462">,</span>&nbsp;<span class="ident" id="5416464">errors</span><span class="op" id="5416470">.</span><span class="ident" id="5416471">New</span><span class="op" id="5416474">(</span><span class="string" id="5416475">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5416500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5416504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416508">base</span>&nbsp;<span class="op" id="5416513">=</span>&nbsp;<span class="ident" id="5416515">signoff</span>&nbsp;<span class="op" id="5416523">+</span>&nbsp;<span class="num" id="5416525">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5416528">}</span>&nbsp;<span class="keyword" id="5416530">else</span>&nbsp;<span class="op" id="5416535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416539">base</span>&nbsp;<span class="op" id="5416544">=</span>&nbsp;<span class="ident" id="5416546">int64</span><span class="op" id="5416551">(</span><span class="num" id="5416552">0</span><span class="op" id="5416553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5416556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416559">sr</span><span class="op" id="5416561">.</span><span class="ident" id="5416562">Seek</span><span class="op" id="5416566">(</span><span class="ident" id="5416567">base</span><span class="op" id="5416571">,</span>&nbsp;<span class="ident" id="5416573">os</span><span class="op" id="5416575">.</span><span class="ident" id="5416576">SEEK_SET</span><span class="op" id="5416584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416587">if</span>&nbsp;<span class="ident" id="5416590">err</span>&nbsp;<span class="op" id="5416594">:=</span>&nbsp;<span class="ident" id="5416597">binary</span><span class="op" id="5416603">.</span><span class="ident" id="5416604">Read</span><span class="op" id="5416608">(</span><span class="ident" id="5416609">sr</span><span class="op" id="5416611">,</span>&nbsp;<span class="ident" id="5416613">binary</span><span class="op" id="5416619">.</span><span class="ident" id="5416620">LittleEndian</span><span class="op" id="5416632">,</span>&nbsp;<span class="op" id="5416634">&amp;</span><span class="ident" id="5416635">f</span><span class="op" id="5416636">.</span><span class="ident" id="5416637">FileHeader</span><span class="op" id="5416647">)</span><span class="op" id="5416648">;</span>&nbsp;<span class="ident" id="5416650">err</span>&nbsp;<span class="op" id="5416654">!=</span>&nbsp;<span class="ident" id="5416657">nil</span>&nbsp;<span class="op" id="5416661">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416665">return</span>&nbsp;<span class="ident" id="5416672">nil</span><span class="op" id="5416675">,</span>&nbsp;<span class="ident" id="5416677">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5416682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416685">if</span>&nbsp;<span class="ident" id="5416688">f</span><span class="op" id="5416689">.</span><span class="ident" id="5416690">FileHeader</span><span class="op" id="5416700">.</span><span class="ident" id="5416701">Machine</span>&nbsp;<span class="op" id="5416709">!=</span>&nbsp;<span class="ident" id="5416712">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="5416739">&amp;&amp;</span>&nbsp;<span class="ident" id="5416742">f</span><span class="op" id="5416743">.</span><span class="ident" id="5416744">FileHeader</span><span class="op" id="5416754">.</span><span class="ident" id="5416755">Machine</span>&nbsp;<span class="op" id="5416763">!=</span>&nbsp;<span class="ident" id="5416766">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="5416791">&amp;&amp;</span>&nbsp;<span class="ident" id="5416794">f</span><span class="op" id="5416795">.</span><span class="ident" id="5416796">FileHeader</span><span class="op" id="5416806">.</span><span class="ident" id="5416807">Machine</span>&nbsp;<span class="op" id="5416815">!=</span>&nbsp;<span class="ident" id="5416818">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="5416842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416846">return</span>&nbsp;<span class="ident" id="5416853">nil</span><span class="op" id="5416856">,</span>&nbsp;<span class="ident" id="5416858">errors</span><span class="op" id="5416864">.</span><span class="ident" id="5416865">New</span><span class="op" id="5416868">(</span><span class="string" id="5416869">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5416894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5416897">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416901">var</span>&nbsp;<span class="ident" id="5416905">ss</span>&nbsp;<span class="op" id="5416908">[</span><span class="op" id="5416909">]</span><span class="builtintype" id="5416910">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416916">if</span>&nbsp;<span class="ident" id="5416919">f</span><span class="op" id="5416920">.</span><span class="ident" id="5416921">FileHeader</span><span class="op" id="5416931">.</span><span class="ident" id="5416932">NumberOfSymbols</span>&nbsp;<span class="op" id="5416948">&gt;</span>&nbsp;<span class="num" id="5416950">0</span>&nbsp;<span class="op" id="5416952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416956">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417038">sr</span><span class="op" id="5417040">.</span><span class="ident" id="5417041">Seek</span><span class="op" id="5417045">(</span><span class="ident" id="5417046">int64</span><span class="op" id="5417051">(</span><span class="ident" id="5417052">f</span><span class="op" id="5417053">.</span><span class="ident" id="5417054">FileHeader</span><span class="op" id="5417064">.</span><span class="ident" id="5417065">PointerToSymbolTable</span><span class="op" id="5417085">+</span><span class="ident" id="5417086">COFFSymbolSize</span><span class="op" id="5417100">*</span><span class="ident" id="5417101">f</span><span class="op" id="5417102">.</span><span class="ident" id="5417103">FileHeader</span><span class="op" id="5417113">.</span><span class="ident" id="5417114">NumberOfSymbols</span><span class="op" id="5417129">)</span><span class="op" id="5417130">,</span>&nbsp;<span class="ident" id="5417132">os</span><span class="op" id="5417134">.</span><span class="ident" id="5417135">SEEK_SET</span><span class="op" id="5417143">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417147">var</span>&nbsp;<span class="ident" id="5417151">l</span>&nbsp;<span class="builtintype" id="5417153">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417162">if</span>&nbsp;<span class="ident" id="5417165">err</span>&nbsp;<span class="op" id="5417169">:=</span>&nbsp;<span class="ident" id="5417172">binary</span><span class="op" id="5417178">.</span><span class="ident" id="5417179">Read</span><span class="op" id="5417183">(</span><span class="ident" id="5417184">sr</span><span class="op" id="5417186">,</span>&nbsp;<span class="ident" id="5417188">binary</span><span class="op" id="5417194">.</span><span class="ident" id="5417195">LittleEndian</span><span class="op" id="5417207">,</span>&nbsp;<span class="op" id="5417209">&amp;</span><span class="ident" id="5417210">l</span><span class="op" id="5417211">)</span><span class="op" id="5417212">;</span>&nbsp;<span class="ident" id="5417214">err</span>&nbsp;<span class="op" id="5417218">!=</span>&nbsp;<span class="ident" id="5417221">nil</span>&nbsp;<span class="op" id="5417225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417230">return</span>&nbsp;<span class="ident" id="5417237">nil</span><span class="op" id="5417240">,</span>&nbsp;<span class="ident" id="5417242">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5417248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417252">ss</span>&nbsp;<span class="op" id="5417255">=</span>&nbsp;<span class="builtinfunc" id="5417257">make</span><span class="op" id="5417261">(</span><span class="op" id="5417262">[</span><span class="op" id="5417263">]</span><span class="builtintype" id="5417264">byte</span><span class="op" id="5417268">,</span>&nbsp;<span class="ident" id="5417270">l</span><span class="op" id="5417271">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417275">if</span>&nbsp;<span class="ident" id="5417278">_</span><span class="op" id="5417279">,</span>&nbsp;<span class="ident" id="5417281">err</span>&nbsp;<span class="op" id="5417285">:=</span>&nbsp;<span class="ident" id="5417288">r</span><span class="op" id="5417289">.</span><span class="ident" id="5417290">ReadAt</span><span class="op" id="5417296">(</span><span class="ident" id="5417297">ss</span><span class="op" id="5417299">,</span>&nbsp;<span class="ident" id="5417301">int64</span><span class="op" id="5417306">(</span><span class="ident" id="5417307">f</span><span class="op" id="5417308">.</span><span class="ident" id="5417309">FileHeader</span><span class="op" id="5417319">.</span><span class="ident" id="5417320">PointerToSymbolTable</span><span class="op" id="5417340">+</span><span class="ident" id="5417341">COFFSymbolSize</span><span class="op" id="5417355">*</span><span class="ident" id="5417356">f</span><span class="op" id="5417357">.</span><span class="ident" id="5417358">FileHeader</span><span class="op" id="5417368">.</span><span class="ident" id="5417369">NumberOfSymbols</span><span class="op" id="5417384">)</span><span class="op" id="5417385">)</span><span class="op" id="5417386">;</span>&nbsp;<span class="ident" id="5417388">err</span>&nbsp;<span class="op" id="5417392">!=</span>&nbsp;<span class="ident" id="5417395">nil</span>&nbsp;<span class="op" id="5417399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417404">return</span>&nbsp;<span class="ident" id="5417411">nil</span><span class="op" id="5417414">,</span>&nbsp;<span class="ident" id="5417416">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5417422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5417427">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417459">sr</span><span class="op" id="5417461">.</span><span class="ident" id="5417462">Seek</span><span class="op" id="5417466">(</span><span class="ident" id="5417467">int64</span><span class="op" id="5417472">(</span><span class="ident" id="5417473">f</span><span class="op" id="5417474">.</span><span class="ident" id="5417475">FileHeader</span><span class="op" id="5417485">.</span><span class="ident" id="5417486">PointerToSymbolTable</span><span class="op" id="5417506">)</span><span class="op" id="5417507">,</span>&nbsp;<span class="ident" id="5417509">os</span><span class="op" id="5417511">.</span><span class="ident" id="5417512">SEEK_SET</span><span class="op" id="5417520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417524">aux</span>&nbsp;<span class="op" id="5417528">:=</span>&nbsp;<span class="builtintype" id="5417531">uint8</span><span class="op" id="5417536">(</span><span class="num" id="5417537">0</span><span class="op" id="5417538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417542">for</span>&nbsp;<span class="ident" id="5417546">i</span>&nbsp;<span class="op" id="5417548">:=</span>&nbsp;<span class="num" id="5417551">0</span><span class="op" id="5417552">;</span>&nbsp;<span class="ident" id="5417554">i</span>&nbsp;<span class="op" id="5417556">&lt;</span>&nbsp;<span class="builtintype" id="5417558">int</span><span class="op" id="5417561">(</span><span class="ident" id="5417562">f</span><span class="op" id="5417563">.</span><span class="ident" id="5417564">FileHeader</span><span class="op" id="5417574">.</span><span class="ident" id="5417575">NumberOfSymbols</span><span class="op" id="5417590">)</span><span class="op" id="5417591">;</span>&nbsp;<span class="ident" id="5417593">i</span><span class="op" id="5417594">++</span>&nbsp;<span class="op" id="5417597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417602">cs</span>&nbsp;<span class="op" id="5417605">:=</span>&nbsp;<span class="builtinfunc" id="5417608">new</span><span class="op" id="5417611">(</span><span class="ident" id="5417612">COFFSymbol</span><span class="op" id="5417622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417627">if</span>&nbsp;<span class="ident" id="5417630">err</span>&nbsp;<span class="op" id="5417634">:=</span>&nbsp;<span class="ident" id="5417637">binary</span><span class="op" id="5417643">.</span><span class="ident" id="5417644">Read</span><span class="op" id="5417648">(</span><span class="ident" id="5417649">sr</span><span class="op" id="5417651">,</span>&nbsp;<span class="ident" id="5417653">binary</span><span class="op" id="5417659">.</span><span class="ident" id="5417660">LittleEndian</span><span class="op" id="5417672">,</span>&nbsp;<span class="ident" id="5417674">cs</span><span class="op" id="5417676">)</span><span class="op" id="5417677">;</span>&nbsp;<span class="ident" id="5417679">err</span>&nbsp;<span class="op" id="5417683">!=</span>&nbsp;<span class="ident" id="5417686">nil</span>&nbsp;<span class="op" id="5417690">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417696">return</span>&nbsp;<span class="ident" id="5417703">nil</span><span class="op" id="5417706">,</span>&nbsp;<span class="ident" id="5417708">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5417715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417720">if</span>&nbsp;<span class="ident" id="5417723">aux</span>&nbsp;<span class="op" id="5417727">&gt;</span>&nbsp;<span class="num" id="5417729">0</span>&nbsp;<span class="op" id="5417731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417737">aux</span><span class="op" id="5417740">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417747">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5417759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417764">var</span>&nbsp;<span class="ident" id="5417768">name</span>&nbsp;<span class="builtintype" id="5417773">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417783">if</span>&nbsp;<span class="ident" id="5417786">cs</span><span class="op" id="5417788">.</span><span class="ident" id="5417789">Name</span><span class="op" id="5417793">[</span><span class="num" id="5417794">0</span><span class="op" id="5417795">]</span>&nbsp;<span class="op" id="5417797">==</span>&nbsp;<span class="num" id="5417800">0</span>&nbsp;<span class="op" id="5417802">&amp;&amp;</span>&nbsp;<span class="ident" id="5417805">cs</span><span class="op" id="5417807">.</span><span class="ident" id="5417808">Name</span><span class="op" id="5417812">[</span><span class="num" id="5417813">1</span><span class="op" id="5417814">]</span>&nbsp;<span class="op" id="5417816">==</span>&nbsp;<span class="num" id="5417819">0</span>&nbsp;<span class="op" id="5417821">&amp;&amp;</span>&nbsp;<span class="ident" id="5417824">cs</span><span class="op" id="5417826">.</span><span class="ident" id="5417827">Name</span><span class="op" id="5417831">[</span><span class="num" id="5417832">2</span><span class="op" id="5417833">]</span>&nbsp;<span class="op" id="5417835">==</span>&nbsp;<span class="num" id="5417838">0</span>&nbsp;<span class="op" id="5417840">&amp;&amp;</span>&nbsp;<span class="ident" id="5417843">cs</span><span class="op" id="5417845">.</span><span class="ident" id="5417846">Name</span><span class="op" id="5417850">[</span><span class="num" id="5417851">3</span><span class="op" id="5417852">]</span>&nbsp;<span class="op" id="5417854">==</span>&nbsp;<span class="num" id="5417857">0</span>&nbsp;<span class="op" id="5417859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417865">si</span>&nbsp;<span class="op" id="5417868">:=</span>&nbsp;<span class="builtintype" id="5417871">int</span><span class="op" id="5417874">(</span><span class="ident" id="5417875">binary</span><span class="op" id="5417881">.</span><span class="ident" id="5417882">LittleEndian</span><span class="op" id="5417894">.</span><span class="ident" id="5417895">Uint32</span><span class="op" id="5417901">(</span><span class="ident" id="5417902">cs</span><span class="op" id="5417904">.</span><span class="ident" id="5417905">Name</span><span class="op" id="5417909">[</span><span class="num" id="5417910">4</span><span class="op" id="5417911">:</span><span class="op" id="5417912">]</span><span class="op" id="5417913">)</span><span class="op" id="5417914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417920">name</span><span class="op" id="5417924">,</span>&nbsp;<span class="ident" id="5417926">_</span>&nbsp;<span class="op" id="5417928">=</span>&nbsp;<span class="ident" id="5417930">getString</span><span class="op" id="5417939">(</span><span class="ident" id="5417940">ss</span><span class="op" id="5417942">,</span>&nbsp;<span class="ident" id="5417944">si</span><span class="op" id="5417946">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5417951">}</span>&nbsp;<span class="keyword" id="5417953">else</span>&nbsp;<span class="op" id="5417958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417964">name</span>&nbsp;<span class="op" id="5417969">=</span>&nbsp;<span class="ident" id="5417971">cstring</span><span class="op" id="5417978">(</span><span class="ident" id="5417979">cs</span><span class="op" id="5417981">.</span><span class="ident" id="5417982">Name</span><span class="op" id="5417986">[</span><span class="op" id="5417987">:</span><span class="op" id="5417988">]</span><span class="op" id="5417989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5417994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417999">aux</span>&nbsp;<span class="op" id="5418003">=</span>&nbsp;<span class="ident" id="5418005">cs</span><span class="op" id="5418007">.</span><span class="ident" id="5418008">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418030">s</span>&nbsp;<span class="op" id="5418032">:=</span>&nbsp;<span class="op" id="5418035">&amp;</span><span class="ident" id="5418036">Symbol</span><span class="op" id="5418042">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418048">Name</span><span class="op" id="5418052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5418063">name</span><span class="op" id="5418067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418073">Value</span><span class="op" id="5418078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5418088">cs</span><span class="op" id="5418090">.</span><span class="ident" id="5418091">Value</span><span class="op" id="5418096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418102">SectionNumber</span><span class="op" id="5418115">:</span>&nbsp;<span class="ident" id="5418117">cs</span><span class="op" id="5418119">.</span><span class="ident" id="5418120">SectionNumber</span><span class="op" id="5418133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418139">Type</span><span class="op" id="5418143">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5418154">cs</span><span class="op" id="5418156">.</span><span class="ident" id="5418157">Type</span><span class="op" id="5418161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418167">StorageClass</span><span class="op" id="5418179">:</span>&nbsp;&nbsp;<span class="ident" id="5418182">cs</span><span class="op" id="5418184">.</span><span class="ident" id="5418185">StorageClass</span><span class="op" id="5418197">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418207">f</span><span class="op" id="5418208">.</span><span class="ident" id="5418209">Symbols</span>&nbsp;<span class="op" id="5418217">=</span>&nbsp;<span class="builtinfunc" id="5418219">append</span><span class="op" id="5418225">(</span><span class="ident" id="5418226">f</span><span class="op" id="5418227">.</span><span class="ident" id="5418228">Symbols</span><span class="op" id="5418235">,</span>&nbsp;<span class="ident" id="5418237">s</span><span class="op" id="5418238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5418249">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418275">sr</span><span class="op" id="5418277">.</span><span class="ident" id="5418278">Seek</span><span class="op" id="5418282">(</span><span class="ident" id="5418283">base</span><span class="op" id="5418287">,</span>&nbsp;<span class="ident" id="5418289">os</span><span class="op" id="5418291">.</span><span class="ident" id="5418292">SEEK_SET</span><span class="op" id="5418300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418303">if</span>&nbsp;<span class="ident" id="5418306">err</span>&nbsp;<span class="op" id="5418310">:=</span>&nbsp;<span class="ident" id="5418313">binary</span><span class="op" id="5418319">.</span><span class="ident" id="5418320">Read</span><span class="op" id="5418324">(</span><span class="ident" id="5418325">sr</span><span class="op" id="5418327">,</span>&nbsp;<span class="ident" id="5418329">binary</span><span class="op" id="5418335">.</span><span class="ident" id="5418336">LittleEndian</span><span class="op" id="5418348">,</span>&nbsp;<span class="op" id="5418350">&amp;</span><span class="ident" id="5418351">f</span><span class="op" id="5418352">.</span><span class="ident" id="5418353">FileHeader</span><span class="op" id="5418363">)</span><span class="op" id="5418364">;</span>&nbsp;<span class="ident" id="5418366">err</span>&nbsp;<span class="op" id="5418370">!=</span>&nbsp;<span class="ident" id="5418373">nil</span>&nbsp;<span class="op" id="5418377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418381">return</span>&nbsp;<span class="ident" id="5418388">nil</span><span class="op" id="5418391">,</span>&nbsp;<span class="ident" id="5418393">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418398">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418401">var</span>&nbsp;<span class="ident" id="5418405">oh32</span>&nbsp;<span class="ident" id="5418410">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418428">var</span>&nbsp;<span class="ident" id="5418432">oh64</span>&nbsp;<span class="ident" id="5418437">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418455">switch</span>&nbsp;<span class="ident" id="5418462">f</span><span class="op" id="5418463">.</span><span class="ident" id="5418464">FileHeader</span><span class="op" id="5418474">.</span><span class="ident" id="5418475">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="5418496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418499">case</span>&nbsp;<span class="ident" id="5418504">sizeofOptionalHeader32</span><span class="op" id="5418526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418530">if</span>&nbsp;<span class="ident" id="5418533">err</span>&nbsp;<span class="op" id="5418537">:=</span>&nbsp;<span class="ident" id="5418540">binary</span><span class="op" id="5418546">.</span><span class="ident" id="5418547">Read</span><span class="op" id="5418551">(</span><span class="ident" id="5418552">sr</span><span class="op" id="5418554">,</span>&nbsp;<span class="ident" id="5418556">binary</span><span class="op" id="5418562">.</span><span class="ident" id="5418563">LittleEndian</span><span class="op" id="5418575">,</span>&nbsp;<span class="op" id="5418577">&amp;</span><span class="ident" id="5418578">oh32</span><span class="op" id="5418582">)</span><span class="op" id="5418583">;</span>&nbsp;<span class="ident" id="5418585">err</span>&nbsp;<span class="op" id="5418589">!=</span>&nbsp;<span class="ident" id="5418592">nil</span>&nbsp;<span class="op" id="5418596">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418601">return</span>&nbsp;<span class="ident" id="5418608">nil</span><span class="op" id="5418611">,</span>&nbsp;<span class="ident" id="5418613">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418623">if</span>&nbsp;<span class="ident" id="5418626">oh32</span><span class="op" id="5418630">.</span><span class="ident" id="5418631">Magic</span>&nbsp;<span class="op" id="5418637">!=</span>&nbsp;<span class="num" id="5418640">0x10b</span>&nbsp;<span class="op" id="5418646">{</span>&nbsp;<span class="comment" id="5418648">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418659">return</span>&nbsp;<span class="ident" id="5418666">nil</span><span class="op" id="5418669">,</span>&nbsp;<span class="ident" id="5418671">fmt</span><span class="op" id="5418674">.</span><span class="ident" id="5418675">Errorf</span><span class="op" id="5418681">(</span><span class="string" id="5418682">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5418733">,</span>&nbsp;<span class="ident" id="5418735">oh32</span><span class="op" id="5418739">.</span><span class="ident" id="5418740">Magic</span><span class="op" id="5418745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418749">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418753">f</span><span class="op" id="5418754">.</span><span class="ident" id="5418755">OptionalHeader</span>&nbsp;<span class="op" id="5418770">=</span>&nbsp;<span class="op" id="5418772">&amp;</span><span class="ident" id="5418773">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418779">case</span>&nbsp;<span class="ident" id="5418784">sizeofOptionalHeader64</span><span class="op" id="5418806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418810">if</span>&nbsp;<span class="ident" id="5418813">err</span>&nbsp;<span class="op" id="5418817">:=</span>&nbsp;<span class="ident" id="5418820">binary</span><span class="op" id="5418826">.</span><span class="ident" id="5418827">Read</span><span class="op" id="5418831">(</span><span class="ident" id="5418832">sr</span><span class="op" id="5418834">,</span>&nbsp;<span class="ident" id="5418836">binary</span><span class="op" id="5418842">.</span><span class="ident" id="5418843">LittleEndian</span><span class="op" id="5418855">,</span>&nbsp;<span class="op" id="5418857">&amp;</span><span class="ident" id="5418858">oh64</span><span class="op" id="5418862">)</span><span class="op" id="5418863">;</span>&nbsp;<span class="ident" id="5418865">err</span>&nbsp;<span class="op" id="5418869">!=</span>&nbsp;<span class="ident" id="5418872">nil</span>&nbsp;<span class="op" id="5418876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418881">return</span>&nbsp;<span class="ident" id="5418888">nil</span><span class="op" id="5418891">,</span>&nbsp;<span class="ident" id="5418893">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418899">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418903">if</span>&nbsp;<span class="ident" id="5418906">oh64</span><span class="op" id="5418910">.</span><span class="ident" id="5418911">Magic</span>&nbsp;<span class="op" id="5418917">!=</span>&nbsp;<span class="num" id="5418920">0x20b</span>&nbsp;<span class="op" id="5418926">{</span>&nbsp;<span class="comment" id="5418928">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418940">return</span>&nbsp;<span class="ident" id="5418947">nil</span><span class="op" id="5418950">,</span>&nbsp;<span class="ident" id="5418952">fmt</span><span class="op" id="5418955">.</span><span class="ident" id="5418956">Errorf</span><span class="op" id="5418962">(</span><span class="string" id="5418963">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5419015">,</span>&nbsp;<span class="ident" id="5419017">oh64</span><span class="op" id="5419021">.</span><span class="ident" id="5419022">Magic</span><span class="op" id="5419027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419035">f</span><span class="op" id="5419036">.</span><span class="ident" id="5419037">OptionalHeader</span>&nbsp;<span class="op" id="5419052">=</span>&nbsp;<span class="op" id="5419054">&amp;</span><span class="ident" id="5419055">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419061">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5419065">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419087">f</span><span class="op" id="5419088">.</span><span class="ident" id="5419089">Sections</span>&nbsp;<span class="op" id="5419098">=</span>&nbsp;<span class="builtinfunc" id="5419100">make</span><span class="op" id="5419104">(</span><span class="op" id="5419105">[</span><span class="op" id="5419106">]</span><span class="op" id="5419107">*</span><span class="ident" id="5419108">Section</span><span class="op" id="5419115">,</span>&nbsp;<span class="ident" id="5419117">f</span><span class="op" id="5419118">.</span><span class="ident" id="5419119">FileHeader</span><span class="op" id="5419129">.</span><span class="ident" id="5419130">NumberOfSections</span><span class="op" id="5419146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419149">for</span>&nbsp;<span class="ident" id="5419153">i</span>&nbsp;<span class="op" id="5419155">:=</span>&nbsp;<span class="num" id="5419158">0</span><span class="op" id="5419159">;</span>&nbsp;<span class="ident" id="5419161">i</span>&nbsp;<span class="op" id="5419163">&lt;</span>&nbsp;<span class="builtintype" id="5419165">int</span><span class="op" id="5419168">(</span><span class="ident" id="5419169">f</span><span class="op" id="5419170">.</span><span class="ident" id="5419171">FileHeader</span><span class="op" id="5419181">.</span><span class="ident" id="5419182">NumberOfSections</span><span class="op" id="5419198">)</span><span class="op" id="5419199">;</span>&nbsp;<span class="ident" id="5419201">i</span><span class="op" id="5419202">++</span>&nbsp;<span class="op" id="5419205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419209">sh</span>&nbsp;<span class="op" id="5419212">:=</span>&nbsp;<span class="builtinfunc" id="5419215">new</span><span class="op" id="5419218">(</span><span class="ident" id="5419219">SectionHeader32</span><span class="op" id="5419234">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419238">if</span>&nbsp;<span class="ident" id="5419241">err</span>&nbsp;<span class="op" id="5419245">:=</span>&nbsp;<span class="ident" id="5419248">binary</span><span class="op" id="5419254">.</span><span class="ident" id="5419255">Read</span><span class="op" id="5419259">(</span><span class="ident" id="5419260">sr</span><span class="op" id="5419262">,</span>&nbsp;<span class="ident" id="5419264">binary</span><span class="op" id="5419270">.</span><span class="ident" id="5419271">LittleEndian</span><span class="op" id="5419283">,</span>&nbsp;<span class="ident" id="5419285">sh</span><span class="op" id="5419287">)</span><span class="op" id="5419288">;</span>&nbsp;<span class="ident" id="5419290">err</span>&nbsp;<span class="op" id="5419294">!=</span>&nbsp;<span class="ident" id="5419297">nil</span>&nbsp;<span class="op" id="5419301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419306">return</span>&nbsp;<span class="ident" id="5419313">nil</span><span class="op" id="5419316">,</span>&nbsp;<span class="ident" id="5419318">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419328">var</span>&nbsp;<span class="ident" id="5419332">name</span>&nbsp;<span class="builtintype" id="5419337">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419346">if</span>&nbsp;<span class="ident" id="5419349">sh</span><span class="op" id="5419351">.</span><span class="ident" id="5419352">Name</span><span class="op" id="5419356">[</span><span class="num" id="5419357">0</span><span class="op" id="5419358">]</span>&nbsp;<span class="op" id="5419360">==</span>&nbsp;<span class="string" id="5419363">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="5419370">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419375">si</span><span class="op" id="5419377">,</span>&nbsp;<span class="ident" id="5419379">_</span>&nbsp;<span class="op" id="5419381">:=</span>&nbsp;<span class="ident" id="5419384">strconv</span><span class="op" id="5419391">.</span><span class="ident" id="5419392">Atoi</span><span class="op" id="5419396">(</span><span class="ident" id="5419397">cstring</span><span class="op" id="5419404">(</span><span class="ident" id="5419405">sh</span><span class="op" id="5419407">.</span><span class="ident" id="5419408">Name</span><span class="op" id="5419412">[</span><span class="num" id="5419413">1</span><span class="op" id="5419414">:</span><span class="op" id="5419415">]</span><span class="op" id="5419416">)</span><span class="op" id="5419417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419422">name</span><span class="op" id="5419426">,</span>&nbsp;<span class="ident" id="5419428">_</span>&nbsp;<span class="op" id="5419430">=</span>&nbsp;<span class="ident" id="5419432">getString</span><span class="op" id="5419441">(</span><span class="ident" id="5419442">ss</span><span class="op" id="5419444">,</span>&nbsp;<span class="ident" id="5419446">si</span><span class="op" id="5419448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419452">}</span>&nbsp;<span class="keyword" id="5419454">else</span>&nbsp;<span class="op" id="5419459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419464">name</span>&nbsp;<span class="op" id="5419469">=</span>&nbsp;<span class="ident" id="5419471">cstring</span><span class="op" id="5419478">(</span><span class="ident" id="5419479">sh</span><span class="op" id="5419481">.</span><span class="ident" id="5419482">Name</span><span class="op" id="5419486">[</span><span class="num" id="5419487">0</span><span class="op" id="5419488">:</span><span class="op" id="5419489">]</span><span class="op" id="5419490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419494">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419498">s</span>&nbsp;<span class="op" id="5419500">:=</span>&nbsp;<span class="builtinfunc" id="5419503">new</span><span class="op" id="5419506">(</span><span class="ident" id="5419507">Section</span><span class="op" id="5419514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419518">s</span><span class="op" id="5419519">.</span><span class="ident" id="5419520">SectionHeader</span>&nbsp;<span class="op" id="5419534">=</span>&nbsp;<span class="ident" id="5419536">SectionHeader</span><span class="op" id="5419549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419554">Name</span><span class="op" id="5419558">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419576">name</span><span class="op" id="5419580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419585">VirtualSize</span><span class="op" id="5419596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419607">sh</span><span class="op" id="5419609">.</span><span class="ident" id="5419610">VirtualSize</span><span class="op" id="5419621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419626">VirtualAddress</span><span class="op" id="5419640">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419648">sh</span><span class="op" id="5419650">.</span><span class="ident" id="5419651">VirtualAddress</span><span class="op" id="5419665">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419670">Size</span><span class="op" id="5419674">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419692">sh</span><span class="op" id="5419694">.</span><span class="ident" id="5419695">SizeOfRawData</span><span class="op" id="5419708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419713">Offset</span><span class="op" id="5419719">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419735">sh</span><span class="op" id="5419737">.</span><span class="ident" id="5419738">PointerToRawData</span><span class="op" id="5419754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419759">PointerToRelocations</span><span class="op" id="5419779">:</span>&nbsp;<span class="ident" id="5419781">sh</span><span class="op" id="5419783">.</span><span class="ident" id="5419784">PointerToRelocations</span><span class="op" id="5419804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419809">PointerToLineNumbers</span><span class="op" id="5419829">:</span>&nbsp;<span class="ident" id="5419831">sh</span><span class="op" id="5419833">.</span><span class="ident" id="5419834">PointerToLineNumbers</span><span class="op" id="5419854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419859">NumberOfRelocations</span><span class="op" id="5419878">:</span>&nbsp;&nbsp;<span class="ident" id="5419881">sh</span><span class="op" id="5419883">.</span><span class="ident" id="5419884">NumberOfRelocations</span><span class="op" id="5419903">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419908">NumberOfLineNumbers</span><span class="op" id="5419927">:</span>&nbsp;&nbsp;<span class="ident" id="5419930">sh</span><span class="op" id="5419932">.</span><span class="ident" id="5419933">NumberOfLineNumbers</span><span class="op" id="5419952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419957">Characteristics</span><span class="op" id="5419972">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419979">sh</span><span class="op" id="5419981">.</span><span class="ident" id="5419982">Characteristics</span><span class="op" id="5419997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420005">s</span><span class="op" id="5420006">.</span><span class="ident" id="5420007">sr</span>&nbsp;<span class="op" id="5420010">=</span>&nbsp;<span class="ident" id="5420012">io</span><span class="op" id="5420014">.</span><span class="ident" id="5420015">NewSectionReader</span><span class="op" id="5420031">(</span><span class="ident" id="5420032">r</span><span class="op" id="5420033">,</span>&nbsp;<span class="ident" id="5420035">int64</span><span class="op" id="5420040">(</span><span class="ident" id="5420041">s</span><span class="op" id="5420042">.</span><span class="ident" id="5420043">SectionHeader</span><span class="op" id="5420056">.</span><span class="ident" id="5420057">Offset</span><span class="op" id="5420063">)</span><span class="op" id="5420064">,</span>&nbsp;<span class="ident" id="5420066">int64</span><span class="op" id="5420071">(</span><span class="ident" id="5420072">s</span><span class="op" id="5420073">.</span><span class="ident" id="5420074">SectionHeader</span><span class="op" id="5420087">.</span><span class="ident" id="5420088">Size</span><span class="op" id="5420092">)</span><span class="op" id="5420093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420097">s</span><span class="op" id="5420098">.</span><span class="ident" id="5420099">ReaderAt</span>&nbsp;<span class="op" id="5420108">=</span>&nbsp;<span class="ident" id="5420110">s</span><span class="op" id="5420111">.</span><span class="ident" id="5420112">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420117">f</span><span class="op" id="5420118">.</span><span class="ident" id="5420119">Sections</span><span class="op" id="5420127">[</span><span class="ident" id="5420128">i</span><span class="op" id="5420129">]</span>&nbsp;<span class="op" id="5420131">=</span>&nbsp;<span class="ident" id="5420133">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420139">return</span>&nbsp;<span class="ident" id="5420146">f</span><span class="op" id="5420147">,</span>&nbsp;<span class="ident" id="5420149">nil</span><br>
<span class="lineno"></span><span class="op" id="5420153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="5420156">func</span>&nbsp;<span class="ident" id="5420161">cstring</span><span class="op" id="5420168">(</span><span class="ident" id="5420169">b</span>&nbsp;<span class="op" id="5420171">[</span><span class="op" id="5420172">]</span><span class="builtintype" id="5420173">byte</span><span class="op" id="5420177">)</span>&nbsp;<span class="builtintype" id="5420179">string</span>&nbsp;<span class="op" id="5420186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420189">var</span>&nbsp;<span class="ident" id="5420193">i</span>&nbsp;<span class="builtintype" id="5420195">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420200">for</span>&nbsp;<span class="ident" id="5420204">i</span>&nbsp;<span class="op" id="5420206">=</span>&nbsp;<span class="num" id="5420208">0</span><span class="op" id="5420209">;</span>&nbsp;<span class="ident" id="5420211">i</span>&nbsp;<span class="op" id="5420213">&lt;</span>&nbsp;<span class="builtinfunc" id="5420215">len</span><span class="op" id="5420218">(</span><span class="ident" id="5420219">b</span><span class="op" id="5420220">)</span>&nbsp;<span class="op" id="5420222">&amp;&amp;</span>&nbsp;<span class="ident" id="5420225">b</span><span class="op" id="5420226">[</span><span class="ident" id="5420227">i</span><span class="op" id="5420228">]</span>&nbsp;<span class="op" id="5420230">!=</span>&nbsp;<span class="num" id="5420233">0</span><span class="op" id="5420234">;</span>&nbsp;<span class="ident" id="5420236">i</span><span class="op" id="5420237">++</span>&nbsp;<span class="op" id="5420240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420246">return</span>&nbsp;<span class="builtintype" id="5420253">string</span><span class="op" id="5420259">(</span><span class="ident" id="5420260">b</span><span class="op" id="5420261">[</span><span class="num" id="5420262">0</span><span class="op" id="5420263">:</span><span class="ident" id="5420264">i</span><span class="op" id="5420265">]</span><span class="op" id="5420266">)</span><br>
<span class="lineno">270</span><span class="op" id="5420268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5420271">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5420328">func</span>&nbsp;<span class="ident" id="5420333">getString</span><span class="op" id="5420342">(</span><span class="ident" id="5420343">section</span>&nbsp;<span class="op" id="5420351">[</span><span class="op" id="5420352">]</span><span class="builtintype" id="5420353">byte</span><span class="op" id="5420357">,</span>&nbsp;<span class="ident" id="5420359">start</span>&nbsp;<span class="builtintype" id="5420365">int</span><span class="op" id="5420368">)</span>&nbsp;<span class="op" id="5420370">(</span><span class="builtintype" id="5420371">string</span><span class="op" id="5420377">,</span>&nbsp;<span class="builtintype" id="5420379">bool</span><span class="op" id="5420383">)</span>&nbsp;<span class="op" id="5420385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420388">if</span>&nbsp;<span class="ident" id="5420391">start</span>&nbsp;<span class="op" id="5420397">&lt;</span>&nbsp;<span class="num" id="5420399">0</span>&nbsp;<span class="op" id="5420401">||</span>&nbsp;<span class="ident" id="5420404">start</span>&nbsp;<span class="op" id="5420410">&gt;=</span>&nbsp;<span class="builtinfunc" id="5420413">len</span><span class="op" id="5420416">(</span><span class="ident" id="5420417">section</span><span class="op" id="5420424">)</span>&nbsp;<span class="op" id="5420426">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420430">return</span>&nbsp;<span class="string" id="5420437">&#34;&#34;</span><span class="op" id="5420439">,</span>&nbsp;<span class="builtintype" id="5420441">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420452">for</span>&nbsp;<span class="ident" id="5420456">end</span>&nbsp;<span class="op" id="5420460">:=</span>&nbsp;<span class="ident" id="5420463">start</span><span class="op" id="5420468">;</span>&nbsp;<span class="ident" id="5420470">end</span>&nbsp;<span class="op" id="5420474">&lt;</span>&nbsp;<span class="builtinfunc" id="5420476">len</span><span class="op" id="5420479">(</span><span class="ident" id="5420480">section</span><span class="op" id="5420487">)</span><span class="op" id="5420488">;</span>&nbsp;<span class="ident" id="5420490">end</span><span class="op" id="5420493">++</span>&nbsp;<span class="op" id="5420496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420500">if</span>&nbsp;<span class="ident" id="5420503">section</span><span class="op" id="5420510">[</span><span class="ident" id="5420511">end</span><span class="op" id="5420514">]</span>&nbsp;<span class="op" id="5420516">==</span>&nbsp;<span class="num" id="5420519">0</span>&nbsp;<span class="op" id="5420521">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420526">return</span>&nbsp;<span class="builtintype" id="5420533">string</span><span class="op" id="5420539">(</span><span class="ident" id="5420540">section</span><span class="op" id="5420547">[</span><span class="ident" id="5420548">start</span><span class="op" id="5420553">:</span><span class="ident" id="5420554">end</span><span class="op" id="5420557">]</span><span class="op" id="5420558">)</span><span class="op" id="5420559">,</span>&nbsp;<span class="builtintype" id="5420561">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420574">return</span>&nbsp;<span class="string" id="5420581">&#34;&#34;</span><span class="op" id="5420583">,</span>&nbsp;<span class="builtintype" id="5420585">false</span><br>
<span class="lineno"></span><span class="op" id="5420591">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="5420594">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5420670">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5420689">func</span>&nbsp;<span class="op" id="5420694">(</span><span class="ident" id="5420695">f</span>&nbsp;<span class="op" id="5420697">*</span><span class="ident" id="5420698">File</span><span class="op" id="5420702">)</span>&nbsp;<span class="ident" id="5420704">Section</span><span class="op" id="5420711">(</span><span class="ident" id="5420712">name</span>&nbsp;<span class="builtintype" id="5420717">string</span><span class="op" id="5420723">)</span>&nbsp;<span class="op" id="5420725">*</span><span class="ident" id="5420726">Section</span>&nbsp;<span class="op" id="5420734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420737">for</span>&nbsp;<span class="ident" id="5420741">_</span><span class="op" id="5420742">,</span>&nbsp;<span class="ident" id="5420744">s</span>&nbsp;<span class="op" id="5420746">:=</span>&nbsp;<span class="keyword" id="5420749">range</span>&nbsp;<span class="ident" id="5420755">f</span><span class="op" id="5420756">.</span><span class="ident" id="5420757">Sections</span>&nbsp;<span class="op" id="5420766">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420770">if</span>&nbsp;<span class="ident" id="5420773">s</span><span class="op" id="5420774">.</span><span class="ident" id="5420775">Name</span>&nbsp;<span class="op" id="5420780">==</span>&nbsp;<span class="ident" id="5420783">name</span>&nbsp;<span class="op" id="5420788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420793">return</span>&nbsp;<span class="ident" id="5420800">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420810">return</span>&nbsp;<span class="ident" id="5420817">nil</span><br>
<span class="lineno">295</span><span class="op" id="5420821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5420824">func</span>&nbsp;<span class="op" id="5420829">(</span><span class="ident" id="5420830">f</span>&nbsp;<span class="op" id="5420832">*</span><span class="ident" id="5420833">File</span><span class="op" id="5420837">)</span>&nbsp;<span class="ident" id="5420839">DWARF</span><span class="op" id="5420844">(</span><span class="op" id="5420845">)</span>&nbsp;<span class="op" id="5420847">(</span><span class="op" id="5420848">*</span><span class="ident" id="5420849">dwarf</span><span class="op" id="5420854">.</span><span class="ident" id="5420855">Data</span><span class="op" id="5420859">,</span>&nbsp;<span class="builtintype" id="5420861">error</span><span class="op" id="5420866">)</span>&nbsp;<span class="op" id="5420868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420871">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420922">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420977">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421036">var</span>&nbsp;<span class="ident" id="5421040">names</span>&nbsp;<span class="op" id="5421046">=</span>&nbsp;<span class="op" id="5421048">[</span><span class="op" id="5421049">...</span><span class="op" id="5421052">]</span><span class="builtintype" id="5421053">string</span><span class="op" id="5421059">{</span><span class="string" id="5421060">&#34;abbrev&#34;</span><span class="op" id="5421068">,</span>&nbsp;<span class="string" id="5421070">&#34;info&#34;</span><span class="op" id="5421076">,</span>&nbsp;<span class="string" id="5421078">&#34;str&#34;</span><span class="op" id="5421083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421086">var</span>&nbsp;<span class="ident" id="5421090">dat</span>&nbsp;<span class="op" id="5421094">[</span><span class="builtinfunc" id="5421095">len</span><span class="op" id="5421098">(</span><span class="ident" id="5421099">names</span><span class="op" id="5421104">)</span><span class="op" id="5421105">]</span><span class="op" id="5421106">[</span><span class="op" id="5421107">]</span><span class="builtintype" id="5421108">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421114">for</span>&nbsp;<span class="ident" id="5421118">i</span><span class="op" id="5421119">,</span>&nbsp;<span class="ident" id="5421121">name</span>&nbsp;<span class="op" id="5421126">:=</span>&nbsp;<span class="keyword" id="5421129">range</span>&nbsp;<span class="ident" id="5421135">names</span>&nbsp;<span class="op" id="5421141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421145">name</span>&nbsp;<span class="op" id="5421150">=</span>&nbsp;<span class="string" id="5421152">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5421162">+</span>&nbsp;<span class="ident" id="5421164">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421171">s</span>&nbsp;<span class="op" id="5421173">:=</span>&nbsp;<span class="ident" id="5421176">f</span><span class="op" id="5421177">.</span><span class="ident" id="5421178">Section</span><span class="op" id="5421185">(</span><span class="ident" id="5421186">name</span><span class="op" id="5421190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421194">if</span>&nbsp;<span class="ident" id="5421197">s</span>&nbsp;<span class="op" id="5421199">==</span>&nbsp;<span class="ident" id="5421202">nil</span>&nbsp;<span class="op" id="5421206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421211">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421226">b</span><span class="op" id="5421227">,</span>&nbsp;<span class="ident" id="5421229">err</span>&nbsp;<span class="op" id="5421233">:=</span>&nbsp;<span class="ident" id="5421236">s</span><span class="op" id="5421237">.</span><span class="ident" id="5421238">Data</span><span class="op" id="5421242">(</span><span class="op" id="5421243">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421247">if</span>&nbsp;<span class="ident" id="5421250">err</span>&nbsp;<span class="op" id="5421254">!=</span>&nbsp;<span class="ident" id="5421257">nil</span>&nbsp;<span class="op" id="5421261">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5421264">uint32</span><span class="op" id="5421270">(</span><span class="builtinfunc" id="5421271">len</span><span class="op" id="5421274">(</span><span class="ident" id="5421275">b</span><span class="op" id="5421276">)</span><span class="op" id="5421277">)</span>&nbsp;<span class="op" id="5421279">&lt;</span>&nbsp;<span class="ident" id="5421281">s</span><span class="op" id="5421282">.</span><span class="ident" id="5421283">Size</span>&nbsp;<span class="op" id="5421288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421293">return</span>&nbsp;<span class="ident" id="5421300">nil</span><span class="op" id="5421303">,</span>&nbsp;<span class="ident" id="5421305">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421315">dat</span><span class="op" id="5421318">[</span><span class="ident" id="5421319">i</span><span class="op" id="5421320">]</span>&nbsp;<span class="op" id="5421322">=</span>&nbsp;<span class="ident" id="5421324">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421327">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421331">abbrev</span><span class="op" id="5421337">,</span>&nbsp;<span class="ident" id="5421339">info</span><span class="op" id="5421343">,</span>&nbsp;<span class="ident" id="5421345">str</span>&nbsp;<span class="op" id="5421349">:=</span>&nbsp;<span class="ident" id="5421352">dat</span><span class="op" id="5421355">[</span><span class="num" id="5421356">0</span><span class="op" id="5421357">]</span><span class="op" id="5421358">,</span>&nbsp;<span class="ident" id="5421360">dat</span><span class="op" id="5421363">[</span><span class="num" id="5421364">1</span><span class="op" id="5421365">]</span><span class="op" id="5421366">,</span>&nbsp;<span class="ident" id="5421368">dat</span><span class="op" id="5421371">[</span><span class="num" id="5421372">2</span><span class="op" id="5421373">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421376">return</span>&nbsp;<span class="ident" id="5421383">dwarf</span><span class="op" id="5421388">.</span><span class="ident" id="5421389">New</span><span class="op" id="5421392">(</span><span class="ident" id="5421393">abbrev</span><span class="op" id="5421399">,</span>&nbsp;<span class="ident" id="5421401">nil</span><span class="op" id="5421404">,</span>&nbsp;<span class="ident" id="5421406">nil</span><span class="op" id="5421409">,</span>&nbsp;<span class="ident" id="5421411">info</span><span class="op" id="5421415">,</span>&nbsp;<span class="ident" id="5421417">nil</span><span class="op" id="5421420">,</span>&nbsp;<span class="ident" id="5421422">nil</span><span class="op" id="5421425">,</span>&nbsp;<span class="ident" id="5421427">nil</span><span class="op" id="5421430">,</span>&nbsp;<span class="ident" id="5421432">str</span><span class="op" id="5421435">)</span><br>
<span class="lineno"></span><span class="op" id="5421437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5421440">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5421492">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5421547">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5421601">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5421637">func</span>&nbsp;<span class="op" id="5421642">(</span><span class="ident" id="5421643">f</span>&nbsp;<span class="op" id="5421645">*</span><span class="ident" id="5421646">File</span><span class="op" id="5421650">)</span>&nbsp;<span class="ident" id="5421652">ImportedSymbols</span><span class="op" id="5421667">(</span><span class="op" id="5421668">)</span>&nbsp;<span class="op" id="5421670">(</span><span class="op" id="5421671">[</span><span class="op" id="5421672">]</span><span class="builtintype" id="5421673">string</span><span class="op" id="5421679">,</span>&nbsp;<span class="builtintype" id="5421681">error</span><span class="op" id="5421686">)</span>&nbsp;<span class="op" id="5421688">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421691">pe64</span>&nbsp;<span class="op" id="5421696">:=</span>&nbsp;<span class="ident" id="5421699">f</span><span class="op" id="5421700">.</span><span class="ident" id="5421701">Machine</span>&nbsp;<span class="op" id="5421709">==</span>&nbsp;<span class="ident" id="5421712">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421738">ds</span>&nbsp;<span class="op" id="5421741">:=</span>&nbsp;<span class="ident" id="5421744">f</span><span class="op" id="5421745">.</span><span class="ident" id="5421746">Section</span><span class="op" id="5421753">(</span><span class="string" id="5421754">&#34;.idata&#34;</span><span class="op" id="5421762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421765">if</span>&nbsp;<span class="ident" id="5421768">ds</span>&nbsp;<span class="op" id="5421771">==</span>&nbsp;<span class="ident" id="5421774">nil</span>&nbsp;<span class="op" id="5421778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421782">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421816">return</span>&nbsp;<span class="ident" id="5421823">nil</span><span class="op" id="5421826">,</span>&nbsp;<span class="ident" id="5421828">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421836">d</span><span class="op" id="5421837">,</span>&nbsp;<span class="ident" id="5421839">err</span>&nbsp;<span class="op" id="5421843">:=</span>&nbsp;<span class="ident" id="5421846">ds</span><span class="op" id="5421848">.</span><span class="ident" id="5421849">Data</span><span class="op" id="5421853">(</span><span class="op" id="5421854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421857">if</span>&nbsp;<span class="ident" id="5421860">err</span>&nbsp;<span class="op" id="5421864">!=</span>&nbsp;<span class="ident" id="5421867">nil</span>&nbsp;<span class="op" id="5421871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421875">return</span>&nbsp;<span class="ident" id="5421882">nil</span><span class="op" id="5421885">,</span>&nbsp;<span class="ident" id="5421887">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421892">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421895">var</span>&nbsp;<span class="ident" id="5421899">ida</span>&nbsp;<span class="op" id="5421903">[</span><span class="op" id="5421904">]</span><span class="ident" id="5421905">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421922">for</span>&nbsp;<span class="builtinfunc" id="5421926">len</span><span class="op" id="5421929">(</span><span class="ident" id="5421930">d</span><span class="op" id="5421931">)</span>&nbsp;<span class="op" id="5421933">&gt;</span>&nbsp;<span class="num" id="5421935">0</span>&nbsp;<span class="op" id="5421937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421941">var</span>&nbsp;<span class="ident" id="5421945">dt</span>&nbsp;<span class="ident" id="5421948">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421966">dt</span><span class="op" id="5421968">.</span><span class="ident" id="5421969">OriginalFirstThunk</span>&nbsp;<span class="op" id="5421988">=</span>&nbsp;<span class="ident" id="5421990">binary</span><span class="op" id="5421996">.</span><span class="ident" id="5421997">LittleEndian</span><span class="op" id="5422009">.</span><span class="ident" id="5422010">Uint32</span><span class="op" id="5422016">(</span><span class="ident" id="5422017">d</span><span class="op" id="5422018">[</span><span class="num" id="5422019">0</span><span class="op" id="5422020">:</span><span class="num" id="5422021">4</span><span class="op" id="5422022">]</span><span class="op" id="5422023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422027">dt</span><span class="op" id="5422029">.</span><span class="ident" id="5422030">Name</span>&nbsp;<span class="op" id="5422035">=</span>&nbsp;<span class="ident" id="5422037">binary</span><span class="op" id="5422043">.</span><span class="ident" id="5422044">LittleEndian</span><span class="op" id="5422056">.</span><span class="ident" id="5422057">Uint32</span><span class="op" id="5422063">(</span><span class="ident" id="5422064">d</span><span class="op" id="5422065">[</span><span class="num" id="5422066">12</span><span class="op" id="5422068">:</span><span class="num" id="5422069">16</span><span class="op" id="5422071">]</span><span class="op" id="5422072">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422076">dt</span><span class="op" id="5422078">.</span><span class="ident" id="5422079">FirstThunk</span>&nbsp;<span class="op" id="5422090">=</span>&nbsp;<span class="ident" id="5422092">binary</span><span class="op" id="5422098">.</span><span class="ident" id="5422099">LittleEndian</span><span class="op" id="5422111">.</span><span class="ident" id="5422112">Uint32</span><span class="op" id="5422118">(</span><span class="ident" id="5422119">d</span><span class="op" id="5422120">[</span><span class="num" id="5422121">16</span><span class="op" id="5422123">:</span><span class="num" id="5422124">20</span><span class="op" id="5422126">]</span><span class="op" id="5422127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422131">d</span>&nbsp;<span class="op" id="5422133">=</span>&nbsp;<span class="ident" id="5422135">d</span><span class="op" id="5422136">[</span><span class="num" id="5422137">20</span><span class="op" id="5422139">:</span><span class="op" id="5422140">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422144">if</span>&nbsp;<span class="ident" id="5422147">dt</span><span class="op" id="5422149">.</span><span class="ident" id="5422150">OriginalFirstThunk</span>&nbsp;<span class="op" id="5422169">==</span>&nbsp;<span class="num" id="5422172">0</span>&nbsp;<span class="op" id="5422174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422179">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422187">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422191">ida</span>&nbsp;<span class="op" id="5422195">=</span>&nbsp;<span class="builtinfunc" id="5422197">append</span><span class="op" id="5422203">(</span><span class="ident" id="5422204">ida</span><span class="op" id="5422207">,</span>&nbsp;<span class="ident" id="5422209">dt</span><span class="op" id="5422211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422217">names</span><span class="op" id="5422222">,</span>&nbsp;<span class="ident" id="5422224">_</span>&nbsp;<span class="op" id="5422226">:=</span>&nbsp;<span class="ident" id="5422229">ds</span><span class="op" id="5422231">.</span><span class="ident" id="5422232">Data</span><span class="op" id="5422236">(</span><span class="op" id="5422237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422240">var</span>&nbsp;<span class="ident" id="5422244">all</span>&nbsp;<span class="op" id="5422248">[</span><span class="op" id="5422249">]</span><span class="builtintype" id="5422250">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422258">for</span>&nbsp;<span class="ident" id="5422262">_</span><span class="op" id="5422263">,</span>&nbsp;<span class="ident" id="5422265">dt</span>&nbsp;<span class="op" id="5422268">:=</span>&nbsp;<span class="keyword" id="5422271">range</span>&nbsp;<span class="ident" id="5422277">ida</span>&nbsp;<span class="op" id="5422281">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422285">dt</span><span class="op" id="5422287">.</span><span class="ident" id="5422288">dll</span><span class="op" id="5422291">,</span>&nbsp;<span class="ident" id="5422293">_</span>&nbsp;<span class="op" id="5422295">=</span>&nbsp;<span class="ident" id="5422297">getString</span><span class="op" id="5422306">(</span><span class="ident" id="5422307">names</span><span class="op" id="5422312">,</span>&nbsp;<span class="builtintype" id="5422314">int</span><span class="op" id="5422317">(</span><span class="ident" id="5422318">dt</span><span class="op" id="5422320">.</span><span class="ident" id="5422321">Name</span><span class="op" id="5422325">-</span><span class="ident" id="5422326">ds</span><span class="op" id="5422328">.</span><span class="ident" id="5422329">VirtualAddress</span><span class="op" id="5422343">)</span><span class="op" id="5422344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422348">d</span><span class="op" id="5422349">,</span>&nbsp;<span class="ident" id="5422351">_</span>&nbsp;<span class="op" id="5422353">=</span>&nbsp;<span class="ident" id="5422355">ds</span><span class="op" id="5422357">.</span><span class="ident" id="5422358">Data</span><span class="op" id="5422362">(</span><span class="op" id="5422363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422367">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422399">d</span>&nbsp;<span class="op" id="5422401">=</span>&nbsp;<span class="ident" id="5422403">d</span><span class="op" id="5422404">[</span><span class="ident" id="5422405">dt</span><span class="op" id="5422407">.</span><span class="ident" id="5422408">OriginalFirstThunk</span><span class="op" id="5422426">-</span><span class="ident" id="5422427">ds</span><span class="op" id="5422429">.</span><span class="ident" id="5422430">VirtualAddress</span><span class="op" id="5422444">:</span><span class="op" id="5422445">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422449">for</span>&nbsp;<span class="builtinfunc" id="5422453">len</span><span class="op" id="5422456">(</span><span class="ident" id="5422457">d</span><span class="op" id="5422458">)</span>&nbsp;<span class="op" id="5422460">&gt;</span>&nbsp;<span class="num" id="5422462">0</span>&nbsp;<span class="op" id="5422464">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422469">if</span>&nbsp;<span class="ident" id="5422472">pe64</span>&nbsp;<span class="op" id="5422477">{</span>&nbsp;<span class="comment" id="5422479">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422492">va</span>&nbsp;<span class="op" id="5422495">:=</span>&nbsp;<span class="ident" id="5422498">binary</span><span class="op" id="5422504">.</span><span class="ident" id="5422505">LittleEndian</span><span class="op" id="5422517">.</span><span class="ident" id="5422518">Uint64</span><span class="op" id="5422524">(</span><span class="ident" id="5422525">d</span><span class="op" id="5422526">[</span><span class="num" id="5422527">0</span><span class="op" id="5422528">:</span><span class="num" id="5422529">8</span><span class="op" id="5422530">]</span><span class="op" id="5422531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422537">d</span>&nbsp;<span class="op" id="5422539">=</span>&nbsp;<span class="ident" id="5422541">d</span><span class="op" id="5422542">[</span><span class="num" id="5422543">8</span><span class="op" id="5422544">:</span><span class="op" id="5422545">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422551">if</span>&nbsp;<span class="ident" id="5422554">va</span>&nbsp;<span class="op" id="5422557">==</span>&nbsp;<span class="num" id="5422560">0</span>&nbsp;<span class="op" id="5422562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422569">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422585">if</span>&nbsp;<span class="ident" id="5422588">va</span><span class="op" id="5422590">&amp;</span><span class="num" id="5422591">0x8000000000000000</span>&nbsp;<span class="op" id="5422610">&gt;</span>&nbsp;<span class="num" id="5422612">0</span>&nbsp;<span class="op" id="5422614">{</span>&nbsp;<span class="comment" id="5422616">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422635">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422678">}</span>&nbsp;<span class="keyword" id="5422680">else</span>&nbsp;<span class="op" id="5422685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422692">fn</span><span class="op" id="5422694">,</span>&nbsp;<span class="ident" id="5422696">_</span>&nbsp;<span class="op" id="5422698">:=</span>&nbsp;<span class="ident" id="5422701">getString</span><span class="op" id="5422710">(</span><span class="ident" id="5422711">names</span><span class="op" id="5422716">,</span>&nbsp;<span class="builtintype" id="5422718">int</span><span class="op" id="5422721">(</span><span class="builtintype" id="5422722">uint32</span><span class="op" id="5422728">(</span><span class="ident" id="5422729">va</span><span class="op" id="5422731">)</span><span class="op" id="5422732">-</span><span class="ident" id="5422733">ds</span><span class="op" id="5422735">.</span><span class="ident" id="5422736">VirtualAddress</span><span class="op" id="5422750">+</span><span class="num" id="5422751">2</span><span class="op" id="5422752">)</span><span class="op" id="5422753">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422760">all</span>&nbsp;<span class="op" id="5422764">=</span>&nbsp;<span class="builtinfunc" id="5422766">append</span><span class="op" id="5422772">(</span><span class="ident" id="5422773">all</span><span class="op" id="5422776">,</span>&nbsp;<span class="ident" id="5422778">fn</span><span class="op" id="5422780">+</span><span class="string" id="5422781">&#34;:&#34;</span><span class="op" id="5422784">+</span><span class="ident" id="5422785">dt</span><span class="op" id="5422787">.</span><span class="ident" id="5422788">dll</span><span class="op" id="5422791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422802">}</span>&nbsp;<span class="keyword" id="5422804">else</span>&nbsp;<span class="op" id="5422809">{</span>&nbsp;<span class="comment" id="5422811">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422824">va</span>&nbsp;<span class="op" id="5422827">:=</span>&nbsp;<span class="ident" id="5422830">binary</span><span class="op" id="5422836">.</span><span class="ident" id="5422837">LittleEndian</span><span class="op" id="5422849">.</span><span class="ident" id="5422850">Uint32</span><span class="op" id="5422856">(</span><span class="ident" id="5422857">d</span><span class="op" id="5422858">[</span><span class="num" id="5422859">0</span><span class="op" id="5422860">:</span><span class="num" id="5422861">4</span><span class="op" id="5422862">]</span><span class="op" id="5422863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422869">d</span>&nbsp;<span class="op" id="5422871">=</span>&nbsp;<span class="ident" id="5422873">d</span><span class="op" id="5422874">[</span><span class="num" id="5422875">4</span><span class="op" id="5422876">:</span><span class="op" id="5422877">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422883">if</span>&nbsp;<span class="ident" id="5422886">va</span>&nbsp;<span class="op" id="5422889">==</span>&nbsp;<span class="num" id="5422892">0</span>&nbsp;<span class="op" id="5422894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422901">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422917">if</span>&nbsp;<span class="ident" id="5422920">va</span><span class="op" id="5422922">&amp;</span><span class="num" id="5422923">0x80000000</span>&nbsp;<span class="op" id="5422934">&gt;</span>&nbsp;<span class="num" id="5422936">0</span>&nbsp;<span class="op" id="5422938">{</span>&nbsp;<span class="comment" id="5422940">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422959">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423003">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423030">}</span>&nbsp;<span class="keyword" id="5423032">else</span>&nbsp;<span class="op" id="5423037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423044">fn</span><span class="op" id="5423046">,</span>&nbsp;<span class="ident" id="5423048">_</span>&nbsp;<span class="op" id="5423050">:=</span>&nbsp;<span class="ident" id="5423053">getString</span><span class="op" id="5423062">(</span><span class="ident" id="5423063">names</span><span class="op" id="5423068">,</span>&nbsp;<span class="builtintype" id="5423070">int</span><span class="op" id="5423073">(</span><span class="ident" id="5423074">va</span><span class="op" id="5423076">-</span><span class="ident" id="5423077">ds</span><span class="op" id="5423079">.</span><span class="ident" id="5423080">VirtualAddress</span><span class="op" id="5423094">+</span><span class="num" id="5423095">2</span><span class="op" id="5423096">)</span><span class="op" id="5423097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423104">all</span>&nbsp;<span class="op" id="5423108">=</span>&nbsp;<span class="builtinfunc" id="5423110">append</span><span class="op" id="5423116">(</span><span class="ident" id="5423117">all</span><span class="op" id="5423120">,</span>&nbsp;<span class="ident" id="5423122">fn</span><span class="op" id="5423124">+</span><span class="string" id="5423125">&#34;:&#34;</span><span class="op" id="5423128">+</span><span class="ident" id="5423129">dt</span><span class="op" id="5423131">.</span><span class="ident" id="5423132">dll</span><span class="op" id="5423135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423141">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423157">return</span>&nbsp;<span class="ident" id="5423164">all</span><span class="op" id="5423167">,</span>&nbsp;<span class="ident" id="5423169">nil</span><br>
<span class="lineno">385</span><span class="op" id="5423173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5423176">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5423232">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5423287">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="5423335">func</span>&nbsp;<span class="op" id="5423340">(</span><span class="ident" id="5423341">f</span>&nbsp;<span class="op" id="5423343">*</span><span class="ident" id="5423344">File</span><span class="op" id="5423348">)</span>&nbsp;<span class="ident" id="5423350">ImportedLibraries</span><span class="op" id="5423367">(</span><span class="op" id="5423368">)</span>&nbsp;<span class="op" id="5423370">(</span><span class="op" id="5423371">[</span><span class="op" id="5423372">]</span><span class="builtintype" id="5423373">string</span><span class="op" id="5423379">,</span>&nbsp;<span class="builtintype" id="5423381">error</span><span class="op" id="5423386">)</span>&nbsp;<span class="op" id="5423388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423391">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423400">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423466">return</span>&nbsp;<span class="ident" id="5423473">nil</span><span class="op" id="5423476">,</span>&nbsp;<span class="ident" id="5423478">nil</span><br>
<span class="lineno"></span><span class="op" id="5423482">}</span>
</div>
</body>
</html>
