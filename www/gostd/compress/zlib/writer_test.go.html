<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6632403">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6632458">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6632512">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6632563">package</span>&nbsp;<span class="ident" id="6632571">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6632577">import</span>&nbsp;<span class="op" id="6632584">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632587">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632596">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632603">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632609">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632622">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632628">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6632638">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6632641">var</span>&nbsp;<span class="ident" id="6632645">filenames</span>&nbsp;<span class="op" id="6632655">=</span>&nbsp;<span class="op" id="6632657">[</span><span class="op" id="6632658">]</span><span class="builtintype" id="6632659">string</span><span class="op" id="6632665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632668">&#34;../testdata/e.txt&#34;</span><span class="op" id="6632687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632690">&#34;../testdata/pi.txt&#34;</span><span class="op" id="6632710">,</span><br>
<span class="lineno"></span><span class="op" id="6632712">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6632715">var</span>&nbsp;<span class="ident" id="6632719">data</span>&nbsp;<span class="op" id="6632724">=</span>&nbsp;<span class="op" id="6632726">[</span><span class="op" id="6632727">]</span><span class="builtintype" id="6632728">string</span><span class="op" id="6632734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6632737">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="6632792">,</span><br>
<span class="lineno"></span><span class="op" id="6632794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6632797">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="6632907">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6632956">func</span>&nbsp;<span class="ident" id="6632961">testFileLevelDict</span><span class="op" id="6632978">(</span><span class="ident" id="6632979">t</span>&nbsp;<span class="op" id="6632981">*</span><span class="ident" id="6632982">testing</span><span class="op" id="6632989">.</span><span class="ident" id="6632990">T</span><span class="op" id="6632991">,</span>&nbsp;<span class="ident" id="6632993">fn</span>&nbsp;<span class="builtintype" id="6632996">string</span><span class="op" id="6633002">,</span>&nbsp;<span class="ident" id="6633004">level</span>&nbsp;<span class="builtintype" id="6633010">int</span><span class="op" id="6633013">,</span>&nbsp;<span class="ident" id="6633015">d</span>&nbsp;<span class="builtintype" id="6633017">string</span><span class="op" id="6633023">)</span>&nbsp;<span class="op" id="6633025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6633028">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633065">golden</span><span class="op" id="6633071">,</span>&nbsp;<span class="ident" id="6633073">err</span>&nbsp;<span class="op" id="6633077">:=</span>&nbsp;<span class="ident" id="6633080">os</span><span class="op" id="6633082">.</span><span class="ident" id="6633083">Open</span><span class="op" id="6633087">(</span><span class="ident" id="6633088">fn</span><span class="op" id="6633090">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633093">if</span>&nbsp;<span class="ident" id="6633096">err</span>&nbsp;<span class="op" id="6633100">!=</span>&nbsp;<span class="ident" id="6633103">nil</span>&nbsp;<span class="op" id="6633107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633111">t</span><span class="op" id="6633112">.</span><span class="ident" id="6633113">Errorf</span><span class="op" id="6633119">(</span><span class="string" id="6633120">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6633148">,</span>&nbsp;<span class="ident" id="6633150">fn</span><span class="op" id="6633152">,</span>&nbsp;<span class="ident" id="6633154">level</span><span class="op" id="6633159">,</span>&nbsp;<span class="ident" id="6633161">d</span><span class="op" id="6633162">,</span>&nbsp;<span class="ident" id="6633164">err</span><span class="op" id="6633167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633171">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633182">defer</span>&nbsp;<span class="ident" id="6633188">golden</span><span class="op" id="6633194">.</span><span class="ident" id="6633195">Close</span><span class="op" id="6633200">(</span><span class="op" id="6633201">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633204">b0</span><span class="op" id="6633206">,</span>&nbsp;<span class="ident" id="6633208">err0</span>&nbsp;<span class="op" id="6633213">:=</span>&nbsp;<span class="ident" id="6633216">ioutil</span><span class="op" id="6633222">.</span><span class="ident" id="6633223">ReadAll</span><span class="op" id="6633230">(</span><span class="ident" id="6633231">golden</span><span class="op" id="6633237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633240">if</span>&nbsp;<span class="ident" id="6633243">err0</span>&nbsp;<span class="op" id="6633248">!=</span>&nbsp;<span class="ident" id="6633251">nil</span>&nbsp;<span class="op" id="6633255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633259">t</span><span class="op" id="6633260">.</span><span class="ident" id="6633261">Errorf</span><span class="op" id="6633267">(</span><span class="string" id="6633268">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6633296">,</span>&nbsp;<span class="ident" id="6633298">fn</span><span class="op" id="6633300">,</span>&nbsp;<span class="ident" id="6633302">level</span><span class="op" id="6633307">,</span>&nbsp;<span class="ident" id="6633309">d</span><span class="op" id="6633310">,</span>&nbsp;<span class="ident" id="6633312">err0</span><span class="op" id="6633316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633320">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633328">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633331">testLevelDict</span><span class="op" id="6633344">(</span><span class="ident" id="6633345">t</span><span class="op" id="6633346">,</span>&nbsp;<span class="ident" id="6633348">fn</span><span class="op" id="6633350">,</span>&nbsp;<span class="ident" id="6633352">b0</span><span class="op" id="6633354">,</span>&nbsp;<span class="ident" id="6633356">level</span><span class="op" id="6633361">,</span>&nbsp;<span class="ident" id="6633363">d</span><span class="op" id="6633364">)</span><br>
<span class="lineno"></span><span class="op" id="6633366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6633369">func</span>&nbsp;<span class="ident" id="6633374">testLevelDict</span><span class="op" id="6633387">(</span><span class="ident" id="6633388">t</span>&nbsp;<span class="op" id="6633390">*</span><span class="ident" id="6633391">testing</span><span class="op" id="6633398">.</span><span class="ident" id="6633399">T</span><span class="op" id="6633400">,</span>&nbsp;<span class="ident" id="6633402">fn</span>&nbsp;<span class="builtintype" id="6633405">string</span><span class="op" id="6633411">,</span>&nbsp;<span class="ident" id="6633413">b0</span>&nbsp;<span class="op" id="6633416">[</span><span class="op" id="6633417">]</span><span class="builtintype" id="6633418">byte</span><span class="op" id="6633422">,</span>&nbsp;<span class="ident" id="6633424">level</span>&nbsp;<span class="builtintype" id="6633430">int</span><span class="op" id="6633433">,</span>&nbsp;<span class="ident" id="6633435">d</span>&nbsp;<span class="builtintype" id="6633437">string</span><span class="op" id="6633443">)</span>&nbsp;<span class="op" id="6633445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6633448">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633479">var</span>&nbsp;<span class="ident" id="6633483">dict</span>&nbsp;<span class="op" id="6633488">[</span><span class="op" id="6633489">]</span><span class="builtintype" id="6633490">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633496">if</span>&nbsp;<span class="ident" id="6633499">d</span>&nbsp;<span class="op" id="6633501">!=</span>&nbsp;<span class="string" id="6633504">&#34;&#34;</span>&nbsp;<span class="op" id="6633507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633511">dict</span>&nbsp;<span class="op" id="6633516">=</span>&nbsp;<span class="op" id="6633518">[</span><span class="op" id="6633519">]</span><span class="builtintype" id="6633520">byte</span><span class="op" id="6633524">(</span><span class="ident" id="6633525">d</span><span class="op" id="6633526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6633533">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633630">piper</span><span class="op" id="6633635">,</span>&nbsp;<span class="ident" id="6633637">pipew</span>&nbsp;<span class="op" id="6633643">:=</span>&nbsp;<span class="ident" id="6633646">io</span><span class="op" id="6633648">.</span><span class="ident" id="6633649">Pipe</span><span class="op" id="6633653">(</span><span class="op" id="6633654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633657">defer</span>&nbsp;<span class="ident" id="6633663">piper</span><span class="op" id="6633668">.</span><span class="ident" id="6633669">Close</span><span class="op" id="6633674">(</span><span class="op" id="6633675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633678">go</span>&nbsp;<span class="keyword" id="6633681">func</span><span class="op" id="6633685">(</span><span class="op" id="6633686">)</span>&nbsp;<span class="op" id="6633688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633692">defer</span>&nbsp;<span class="ident" id="6633698">pipew</span><span class="op" id="6633703">.</span><span class="ident" id="6633704">Close</span><span class="op" id="6633709">(</span><span class="op" id="6633710">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633714">zlibw</span><span class="op" id="6633719">,</span>&nbsp;<span class="ident" id="6633721">err</span>&nbsp;<span class="op" id="6633725">:=</span>&nbsp;<span class="ident" id="6633728">NewWriterLevelDict</span><span class="op" id="6633746">(</span><span class="ident" id="6633747">pipew</span><span class="op" id="6633752">,</span>&nbsp;<span class="ident" id="6633754">level</span><span class="op" id="6633759">,</span>&nbsp;<span class="ident" id="6633761">dict</span><span class="op" id="6633765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633769">if</span>&nbsp;<span class="ident" id="6633772">err</span>&nbsp;<span class="op" id="6633776">!=</span>&nbsp;<span class="ident" id="6633779">nil</span>&nbsp;<span class="op" id="6633783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633788">t</span><span class="op" id="6633789">.</span><span class="ident" id="6633790">Errorf</span><span class="op" id="6633796">(</span><span class="string" id="6633797">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6633825">,</span>&nbsp;<span class="ident" id="6633827">fn</span><span class="op" id="6633829">,</span>&nbsp;<span class="ident" id="6633831">level</span><span class="op" id="6633836">,</span>&nbsp;<span class="ident" id="6633838">d</span><span class="op" id="6633839">,</span>&nbsp;<span class="ident" id="6633841">err</span><span class="op" id="6633844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633849">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633858">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633862">defer</span>&nbsp;<span class="ident" id="6633868">zlibw</span><span class="op" id="6633873">.</span><span class="ident" id="6633874">Close</span><span class="op" id="6633879">(</span><span class="op" id="6633880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633884">_</span><span class="op" id="6633885">,</span>&nbsp;<span class="ident" id="6633887">err</span>&nbsp;<span class="op" id="6633891">=</span>&nbsp;<span class="ident" id="6633893">zlibw</span><span class="op" id="6633898">.</span><span class="ident" id="6633899">Write</span><span class="op" id="6633904">(</span><span class="ident" id="6633905">b0</span><span class="op" id="6633907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633911">if</span>&nbsp;<span class="ident" id="6633914">err</span>&nbsp;<span class="op" id="6633918">!=</span>&nbsp;<span class="ident" id="6633921">nil</span>&nbsp;<span class="op" id="6633925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633930">t</span><span class="op" id="6633931">.</span><span class="ident" id="6633932">Errorf</span><span class="op" id="6633938">(</span><span class="string" id="6633939">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6633967">,</span>&nbsp;<span class="ident" id="6633969">fn</span><span class="op" id="6633971">,</span>&nbsp;<span class="ident" id="6633973">level</span><span class="op" id="6633978">,</span>&nbsp;<span class="ident" id="6633980">d</span><span class="op" id="6633981">,</span>&nbsp;<span class="ident" id="6633983">err</span><span class="op" id="6633986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633991">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634003">}</span><span class="op" id="6634004">(</span><span class="op" id="6634005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634008">zlibr</span><span class="op" id="6634013">,</span>&nbsp;<span class="ident" id="6634015">err</span>&nbsp;<span class="op" id="6634019">:=</span>&nbsp;<span class="ident" id="6634022">NewReaderDict</span><span class="op" id="6634035">(</span><span class="ident" id="6634036">piper</span><span class="op" id="6634041">,</span>&nbsp;<span class="ident" id="6634043">dict</span><span class="op" id="6634047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634050">if</span>&nbsp;<span class="ident" id="6634053">err</span>&nbsp;<span class="op" id="6634057">!=</span>&nbsp;<span class="ident" id="6634060">nil</span>&nbsp;<span class="op" id="6634064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634068">t</span><span class="op" id="6634069">.</span><span class="ident" id="6634070">Errorf</span><span class="op" id="6634076">(</span><span class="string" id="6634077">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6634105">,</span>&nbsp;<span class="ident" id="6634107">fn</span><span class="op" id="6634109">,</span>&nbsp;<span class="ident" id="6634111">level</span><span class="op" id="6634116">,</span>&nbsp;<span class="ident" id="6634118">d</span><span class="op" id="6634119">,</span>&nbsp;<span class="ident" id="6634121">err</span><span class="op" id="6634124">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634128">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634139">defer</span>&nbsp;<span class="ident" id="6634145">zlibr</span><span class="op" id="6634150">.</span><span class="ident" id="6634151">Close</span><span class="op" id="6634156">(</span><span class="op" id="6634157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6634161">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634196">b1</span><span class="op" id="6634198">,</span>&nbsp;<span class="ident" id="6634200">err1</span>&nbsp;<span class="op" id="6634205">:=</span>&nbsp;<span class="ident" id="6634208">ioutil</span><span class="op" id="6634214">.</span><span class="ident" id="6634215">ReadAll</span><span class="op" id="6634222">(</span><span class="ident" id="6634223">zlibr</span><span class="op" id="6634228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634231">if</span>&nbsp;<span class="ident" id="6634234">err1</span>&nbsp;<span class="op" id="6634239">!=</span>&nbsp;<span class="ident" id="6634242">nil</span>&nbsp;<span class="op" id="6634246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634250">t</span><span class="op" id="6634251">.</span><span class="ident" id="6634252">Errorf</span><span class="op" id="6634258">(</span><span class="string" id="6634259">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6634287">,</span>&nbsp;<span class="ident" id="6634289">fn</span><span class="op" id="6634291">,</span>&nbsp;<span class="ident" id="6634293">level</span><span class="op" id="6634298">,</span>&nbsp;<span class="ident" id="6634300">d</span><span class="op" id="6634301">,</span>&nbsp;<span class="ident" id="6634303">err1</span><span class="op" id="6634307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634311">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634319">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634322">if</span>&nbsp;<span class="builtinfunc" id="6634325">len</span><span class="op" id="6634328">(</span><span class="ident" id="6634329">b0</span><span class="op" id="6634331">)</span>&nbsp;<span class="op" id="6634333">!=</span>&nbsp;<span class="builtinfunc" id="6634336">len</span><span class="op" id="6634339">(</span><span class="ident" id="6634340">b1</span><span class="op" id="6634342">)</span>&nbsp;<span class="op" id="6634344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634348">t</span><span class="op" id="6634349">.</span><span class="ident" id="6634350">Errorf</span><span class="op" id="6634356">(</span><span class="string" id="6634357">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="6634411">,</span>&nbsp;<span class="ident" id="6634413">fn</span><span class="op" id="6634415">,</span>&nbsp;<span class="ident" id="6634417">level</span><span class="op" id="6634422">,</span>&nbsp;<span class="ident" id="6634424">d</span><span class="op" id="6634425">,</span>&nbsp;<span class="builtinfunc" id="6634427">len</span><span class="op" id="6634430">(</span><span class="ident" id="6634431">b0</span><span class="op" id="6634433">)</span><span class="op" id="6634434">,</span>&nbsp;<span class="builtinfunc" id="6634436">len</span><span class="op" id="6634439">(</span><span class="ident" id="6634440">b1</span><span class="op" id="6634442">)</span><span class="op" id="6634443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634447">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634458">for</span>&nbsp;<span class="ident" id="6634462">i</span>&nbsp;<span class="op" id="6634464">:=</span>&nbsp;<span class="num" id="6634467">0</span><span class="op" id="6634468">;</span>&nbsp;<span class="ident" id="6634470">i</span>&nbsp;<span class="op" id="6634472">&lt;</span>&nbsp;<span class="builtinfunc" id="6634474">len</span><span class="op" id="6634477">(</span><span class="ident" id="6634478">b0</span><span class="op" id="6634480">)</span><span class="op" id="6634481">;</span>&nbsp;<span class="ident" id="6634483">i</span><span class="op" id="6634484">++</span>&nbsp;<span class="op" id="6634487">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634491">if</span>&nbsp;<span class="ident" id="6634494">b0</span><span class="op" id="6634496">[</span><span class="ident" id="6634497">i</span><span class="op" id="6634498">]</span>&nbsp;<span class="op" id="6634500">!=</span>&nbsp;<span class="ident" id="6634503">b1</span><span class="op" id="6634505">[</span><span class="ident" id="6634506">i</span><span class="op" id="6634507">]</span>&nbsp;<span class="op" id="6634509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634514">t</span><span class="op" id="6634515">.</span><span class="ident" id="6634516">Errorf</span><span class="op" id="6634522">(</span><span class="string" id="6634523">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="6634587">,</span>&nbsp;<span class="ident" id="6634589">fn</span><span class="op" id="6634591">,</span>&nbsp;<span class="ident" id="6634593">level</span><span class="op" id="6634598">,</span>&nbsp;<span class="ident" id="6634600">d</span><span class="op" id="6634601">,</span>&nbsp;<span class="ident" id="6634603">i</span><span class="op" id="6634604">,</span>&nbsp;<span class="ident" id="6634606">b0</span><span class="op" id="6634608">[</span><span class="ident" id="6634609">i</span><span class="op" id="6634610">]</span><span class="op" id="6634611">,</span>&nbsp;<span class="ident" id="6634613">b1</span><span class="op" id="6634615">[</span><span class="ident" id="6634616">i</span><span class="op" id="6634617">]</span><span class="op" id="6634618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634623">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634635">}</span><br>
<span class="lineno">90</span><span class="op" id="6634637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6634640">func</span>&nbsp;<span class="ident" id="6634645">testFileLevelDictReset</span><span class="op" id="6634667">(</span><span class="ident" id="6634668">t</span>&nbsp;<span class="op" id="6634670">*</span><span class="ident" id="6634671">testing</span><span class="op" id="6634678">.</span><span class="ident" id="6634679">T</span><span class="op" id="6634680">,</span>&nbsp;<span class="ident" id="6634682">fn</span>&nbsp;<span class="builtintype" id="6634685">string</span><span class="op" id="6634691">,</span>&nbsp;<span class="ident" id="6634693">level</span>&nbsp;<span class="builtintype" id="6634699">int</span><span class="op" id="6634702">,</span>&nbsp;<span class="ident" id="6634704">dict</span>&nbsp;<span class="op" id="6634709">[</span><span class="op" id="6634710">]</span><span class="builtintype" id="6634711">byte</span><span class="op" id="6634715">)</span>&nbsp;<span class="op" id="6634717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634720">var</span>&nbsp;<span class="ident" id="6634724">b0</span>&nbsp;<span class="op" id="6634727">[</span><span class="op" id="6634728">]</span><span class="builtintype" id="6634729">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634735">var</span>&nbsp;<span class="ident" id="6634739">err</span>&nbsp;<span class="builtintype" id="6634743">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634750">if</span>&nbsp;<span class="ident" id="6634753">fn</span>&nbsp;<span class="op" id="6634756">!=</span>&nbsp;<span class="string" id="6634759">&#34;&#34;</span>&nbsp;<span class="op" id="6634762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634766">b0</span><span class="op" id="6634768">,</span>&nbsp;<span class="ident" id="6634770">err</span>&nbsp;<span class="op" id="6634774">=</span>&nbsp;<span class="ident" id="6634776">ioutil</span><span class="op" id="6634782">.</span><span class="ident" id="6634783">ReadFile</span><span class="op" id="6634791">(</span><span class="ident" id="6634792">fn</span><span class="op" id="6634794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634798">if</span>&nbsp;<span class="ident" id="6634801">err</span>&nbsp;<span class="op" id="6634805">!=</span>&nbsp;<span class="ident" id="6634808">nil</span>&nbsp;<span class="op" id="6634812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634817">t</span><span class="op" id="6634818">.</span><span class="ident" id="6634819">Errorf</span><span class="op" id="6634825">(</span><span class="string" id="6634826">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6634845">,</span>&nbsp;<span class="ident" id="6634847">fn</span><span class="op" id="6634849">,</span>&nbsp;<span class="ident" id="6634851">level</span><span class="op" id="6634856">,</span>&nbsp;<span class="ident" id="6634858">err</span><span class="op" id="6634861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634866">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6634882">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634901">buf</span>&nbsp;<span class="op" id="6634905">:=</span>&nbsp;<span class="builtinfunc" id="6634908">new</span><span class="op" id="6634911">(</span><span class="ident" id="6634912">bytes</span><span class="op" id="6634917">.</span><span class="ident" id="6634918">Buffer</span><span class="op" id="6634924">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634927">var</span>&nbsp;<span class="ident" id="6634931">zlibw</span>&nbsp;<span class="op" id="6634937">*</span><span class="ident" id="6634938">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634946">if</span>&nbsp;<span class="ident" id="6634949">dict</span>&nbsp;<span class="op" id="6634954">==</span>&nbsp;<span class="ident" id="6634957">nil</span>&nbsp;<span class="op" id="6634961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634965">zlibw</span><span class="op" id="6634970">,</span>&nbsp;<span class="ident" id="6634972">err</span>&nbsp;<span class="op" id="6634976">=</span>&nbsp;<span class="ident" id="6634978">NewWriterLevel</span><span class="op" id="6634992">(</span><span class="ident" id="6634993">buf</span><span class="op" id="6634996">,</span>&nbsp;<span class="ident" id="6634998">level</span><span class="op" id="6635003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635006">}</span>&nbsp;<span class="keyword" id="6635008">else</span>&nbsp;<span class="op" id="6635013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635017">zlibw</span><span class="op" id="6635022">,</span>&nbsp;<span class="ident" id="6635024">err</span>&nbsp;<span class="op" id="6635028">=</span>&nbsp;<span class="ident" id="6635030">NewWriterLevelDict</span><span class="op" id="6635048">(</span><span class="ident" id="6635049">buf</span><span class="op" id="6635052">,</span>&nbsp;<span class="ident" id="6635054">level</span><span class="op" id="6635059">,</span>&nbsp;<span class="ident" id="6635061">dict</span><span class="op" id="6635065">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635071">if</span>&nbsp;<span class="ident" id="6635074">err</span>&nbsp;<span class="op" id="6635078">==</span>&nbsp;<span class="ident" id="6635081">nil</span>&nbsp;<span class="op" id="6635085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635089">_</span><span class="op" id="6635090">,</span>&nbsp;<span class="ident" id="6635092">err</span>&nbsp;<span class="op" id="6635096">=</span>&nbsp;<span class="ident" id="6635098">zlibw</span><span class="op" id="6635103">.</span><span class="ident" id="6635104">Write</span><span class="op" id="6635109">(</span><span class="ident" id="6635110">b0</span><span class="op" id="6635112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635118">if</span>&nbsp;<span class="ident" id="6635121">err</span>&nbsp;<span class="op" id="6635125">==</span>&nbsp;<span class="ident" id="6635128">nil</span>&nbsp;<span class="op" id="6635132">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635136">err</span>&nbsp;<span class="op" id="6635140">=</span>&nbsp;<span class="ident" id="6635142">zlibw</span><span class="op" id="6635147">.</span><span class="ident" id="6635148">Close</span><span class="op" id="6635153">(</span><span class="op" id="6635154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635160">if</span>&nbsp;<span class="ident" id="6635163">err</span>&nbsp;<span class="op" id="6635167">!=</span>&nbsp;<span class="ident" id="6635170">nil</span>&nbsp;<span class="op" id="6635174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635178">t</span><span class="op" id="6635179">.</span><span class="ident" id="6635180">Errorf</span><span class="op" id="6635186">(</span><span class="string" id="6635187">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6635206">,</span>&nbsp;<span class="ident" id="6635208">fn</span><span class="op" id="6635210">,</span>&nbsp;<span class="ident" id="6635212">level</span><span class="op" id="6635217">,</span>&nbsp;<span class="ident" id="6635219">err</span><span class="op" id="6635222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635226">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635237">out</span>&nbsp;<span class="op" id="6635241">:=</span>&nbsp;<span class="ident" id="6635244">buf</span><span class="op" id="6635247">.</span><span class="ident" id="6635248">String</span><span class="op" id="6635254">(</span><span class="op" id="6635255">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6635259">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635289">buf2</span>&nbsp;<span class="op" id="6635294">:=</span>&nbsp;<span class="builtinfunc" id="6635297">new</span><span class="op" id="6635300">(</span><span class="ident" id="6635301">bytes</span><span class="op" id="6635306">.</span><span class="ident" id="6635307">Buffer</span><span class="op" id="6635313">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635316">zlibw</span><span class="op" id="6635321">.</span><span class="ident" id="6635322">Reset</span><span class="op" id="6635327">(</span><span class="ident" id="6635328">buf2</span><span class="op" id="6635332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635335">_</span><span class="op" id="6635336">,</span>&nbsp;<span class="ident" id="6635338">err</span>&nbsp;<span class="op" id="6635342">=</span>&nbsp;<span class="ident" id="6635344">zlibw</span><span class="op" id="6635349">.</span><span class="ident" id="6635350">Write</span><span class="op" id="6635355">(</span><span class="ident" id="6635356">b0</span><span class="op" id="6635358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635361">if</span>&nbsp;<span class="ident" id="6635364">err</span>&nbsp;<span class="op" id="6635368">==</span>&nbsp;<span class="ident" id="6635371">nil</span>&nbsp;<span class="op" id="6635375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635379">err</span>&nbsp;<span class="op" id="6635383">=</span>&nbsp;<span class="ident" id="6635385">zlibw</span><span class="op" id="6635390">.</span><span class="ident" id="6635391">Close</span><span class="op" id="6635396">(</span><span class="op" id="6635397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635400">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635403">if</span>&nbsp;<span class="ident" id="6635406">err</span>&nbsp;<span class="op" id="6635410">!=</span>&nbsp;<span class="ident" id="6635413">nil</span>&nbsp;<span class="op" id="6635417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635421">t</span><span class="op" id="6635422">.</span><span class="ident" id="6635423">Errorf</span><span class="op" id="6635429">(</span><span class="string" id="6635430">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6635449">,</span>&nbsp;<span class="ident" id="6635451">fn</span><span class="op" id="6635453">,</span>&nbsp;<span class="ident" id="6635455">level</span><span class="op" id="6635460">,</span>&nbsp;<span class="ident" id="6635462">err</span><span class="op" id="6635465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635469">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635480">out2</span>&nbsp;<span class="op" id="6635485">:=</span>&nbsp;<span class="ident" id="6635488">buf2</span><span class="op" id="6635492">.</span><span class="ident" id="6635493">String</span><span class="op" id="6635499">(</span><span class="op" id="6635500">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635504">if</span>&nbsp;<span class="ident" id="6635507">out2</span>&nbsp;<span class="op" id="6635512">!=</span>&nbsp;<span class="ident" id="6635515">out</span>&nbsp;<span class="op" id="6635519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635523">t</span><span class="op" id="6635524">.</span><span class="ident" id="6635525">Errorf</span><span class="op" id="6635531">(</span><span class="string" id="6635532">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="6635604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635609">fn</span><span class="op" id="6635611">,</span>&nbsp;<span class="ident" id="6635613">level</span><span class="op" id="6635618">,</span>&nbsp;<span class="builtinfunc" id="6635620">len</span><span class="op" id="6635623">(</span><span class="ident" id="6635624">out2</span><span class="op" id="6635628">)</span><span class="op" id="6635629">,</span>&nbsp;<span class="builtinfunc" id="6635631">len</span><span class="op" id="6635634">(</span><span class="ident" id="6635635">out</span><span class="op" id="6635638">)</span><span class="op" id="6635639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635642">}</span><br>
<span class="lineno">140</span><span class="op" id="6635644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6635647">func</span>&nbsp;<span class="ident" id="6635652">TestWriter</span><span class="op" id="6635662">(</span><span class="ident" id="6635663">t</span>&nbsp;<span class="op" id="6635665">*</span><span class="ident" id="6635666">testing</span><span class="op" id="6635673">.</span><span class="ident" id="6635674">T</span><span class="op" id="6635675">)</span>&nbsp;<span class="op" id="6635677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635680">for</span>&nbsp;<span class="ident" id="6635684">i</span><span class="op" id="6635685">,</span>&nbsp;<span class="ident" id="6635687">s</span>&nbsp;<span class="op" id="6635689">:=</span>&nbsp;<span class="keyword" id="6635692">range</span>&nbsp;<span class="ident" id="6635698">data</span>&nbsp;<span class="op" id="6635703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635707">b</span>&nbsp;<span class="op" id="6635709">:=</span>&nbsp;<span class="op" id="6635712">[</span><span class="op" id="6635713">]</span><span class="builtintype" id="6635714">byte</span><span class="op" id="6635718">(</span><span class="ident" id="6635719">s</span><span class="op" id="6635720">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635724">tag</span>&nbsp;<span class="op" id="6635728">:=</span>&nbsp;<span class="ident" id="6635731">fmt</span><span class="op" id="6635734">.</span><span class="ident" id="6635735">Sprintf</span><span class="op" id="6635742">(</span><span class="string" id="6635743">&#34;#%d&#34;</span><span class="op" id="6635748">,</span>&nbsp;<span class="ident" id="6635750">i</span><span class="op" id="6635751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635755">testLevelDict</span><span class="op" id="6635768">(</span><span class="ident" id="6635769">t</span><span class="op" id="6635770">,</span>&nbsp;<span class="ident" id="6635772">tag</span><span class="op" id="6635775">,</span>&nbsp;<span class="ident" id="6635777">b</span><span class="op" id="6635778">,</span>&nbsp;<span class="ident" id="6635780">DefaultCompression</span><span class="op" id="6635798">,</span>&nbsp;<span class="string" id="6635800">&#34;&#34;</span><span class="op" id="6635802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635806">testLevelDict</span><span class="op" id="6635819">(</span><span class="ident" id="6635820">t</span><span class="op" id="6635821">,</span>&nbsp;<span class="ident" id="6635823">tag</span><span class="op" id="6635826">,</span>&nbsp;<span class="ident" id="6635828">b</span><span class="op" id="6635829">,</span>&nbsp;<span class="ident" id="6635831">NoCompression</span><span class="op" id="6635844">,</span>&nbsp;<span class="string" id="6635846">&#34;&#34;</span><span class="op" id="6635848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635852">for</span>&nbsp;<span class="ident" id="6635856">level</span>&nbsp;<span class="op" id="6635862">:=</span>&nbsp;<span class="ident" id="6635865">BestSpeed</span><span class="op" id="6635874">;</span>&nbsp;<span class="ident" id="6635876">level</span>&nbsp;<span class="op" id="6635882">&lt;=</span>&nbsp;<span class="ident" id="6635885">BestCompression</span><span class="op" id="6635900">;</span>&nbsp;<span class="ident" id="6635902">level</span><span class="op" id="6635907">++</span>&nbsp;<span class="op" id="6635910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6635915">testLevelDict</span><span class="op" id="6635928">(</span><span class="ident" id="6635929">t</span><span class="op" id="6635930">,</span>&nbsp;<span class="ident" id="6635932">tag</span><span class="op" id="6635935">,</span>&nbsp;<span class="ident" id="6635937">b</span><span class="op" id="6635938">,</span>&nbsp;<span class="ident" id="6635940">level</span><span class="op" id="6635945">,</span>&nbsp;<span class="string" id="6635947">&#34;&#34;</span><span class="op" id="6635949">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6635956">}</span><br>
<span class="lineno"></span><span class="op" id="6635958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6635961">func</span>&nbsp;<span class="ident" id="6635966">TestWriterBig</span><span class="op" id="6635979">(</span><span class="ident" id="6635980">t</span>&nbsp;<span class="op" id="6635982">*</span><span class="ident" id="6635983">testing</span><span class="op" id="6635990">.</span><span class="ident" id="6635991">T</span><span class="op" id="6635992">)</span>&nbsp;<span class="op" id="6635994">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6635997">for</span>&nbsp;<span class="ident" id="6636001">_</span><span class="op" id="6636002">,</span>&nbsp;<span class="ident" id="6636004">fn</span>&nbsp;<span class="op" id="6636007">:=</span>&nbsp;<span class="keyword" id="6636010">range</span>&nbsp;<span class="ident" id="6636016">filenames</span>&nbsp;<span class="op" id="6636026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636030">testFileLevelDict</span><span class="op" id="6636047">(</span><span class="ident" id="6636048">t</span><span class="op" id="6636049">,</span>&nbsp;<span class="ident" id="6636051">fn</span><span class="op" id="6636053">,</span>&nbsp;<span class="ident" id="6636055">DefaultCompression</span><span class="op" id="6636073">,</span>&nbsp;<span class="string" id="6636075">&#34;&#34;</span><span class="op" id="6636077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636081">testFileLevelDict</span><span class="op" id="6636098">(</span><span class="ident" id="6636099">t</span><span class="op" id="6636100">,</span>&nbsp;<span class="ident" id="6636102">fn</span><span class="op" id="6636104">,</span>&nbsp;<span class="ident" id="6636106">NoCompression</span><span class="op" id="6636119">,</span>&nbsp;<span class="string" id="6636121">&#34;&#34;</span><span class="op" id="6636123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6636127">for</span>&nbsp;<span class="ident" id="6636131">level</span>&nbsp;<span class="op" id="6636137">:=</span>&nbsp;<span class="ident" id="6636140">BestSpeed</span><span class="op" id="6636149">;</span>&nbsp;<span class="ident" id="6636151">level</span>&nbsp;<span class="op" id="6636157">&lt;=</span>&nbsp;<span class="ident" id="6636160">BestCompression</span><span class="op" id="6636175">;</span>&nbsp;<span class="ident" id="6636177">level</span><span class="op" id="6636182">++</span>&nbsp;<span class="op" id="6636185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636190">testFileLevelDict</span><span class="op" id="6636207">(</span><span class="ident" id="6636208">t</span><span class="op" id="6636209">,</span>&nbsp;<span class="ident" id="6636211">fn</span><span class="op" id="6636213">,</span>&nbsp;<span class="ident" id="6636215">level</span><span class="op" id="6636220">,</span>&nbsp;<span class="string" id="6636222">&#34;&#34;</span><span class="op" id="6636224">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6636228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6636231">}</span><br>
<span class="lineno"></span><span class="op" id="6636233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6636236">func</span>&nbsp;<span class="ident" id="6636241">TestWriterDict</span><span class="op" id="6636255">(</span><span class="ident" id="6636256">t</span>&nbsp;<span class="op" id="6636258">*</span><span class="ident" id="6636259">testing</span><span class="op" id="6636266">.</span><span class="ident" id="6636267">T</span><span class="op" id="6636268">)</span>&nbsp;<span class="op" id="6636270">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6636273">const</span>&nbsp;<span class="ident" id="6636279">dictionary</span>&nbsp;<span class="op" id="6636290">=</span>&nbsp;<span class="string" id="6636292">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6636307">for</span>&nbsp;<span class="ident" id="6636311">_</span><span class="op" id="6636312">,</span>&nbsp;<span class="ident" id="6636314">fn</span>&nbsp;<span class="op" id="6636317">:=</span>&nbsp;<span class="keyword" id="6636320">range</span>&nbsp;<span class="ident" id="6636326">filenames</span>&nbsp;<span class="op" id="6636336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636340">testFileLevelDict</span><span class="op" id="6636357">(</span><span class="ident" id="6636358">t</span><span class="op" id="6636359">,</span>&nbsp;<span class="ident" id="6636361">fn</span><span class="op" id="6636363">,</span>&nbsp;<span class="ident" id="6636365">DefaultCompression</span><span class="op" id="6636383">,</span>&nbsp;<span class="ident" id="6636385">dictionary</span><span class="op" id="6636395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636399">testFileLevelDict</span><span class="op" id="6636416">(</span><span class="ident" id="6636417">t</span><span class="op" id="6636418">,</span>&nbsp;<span class="ident" id="6636420">fn</span><span class="op" id="6636422">,</span>&nbsp;<span class="ident" id="6636424">NoCompression</span><span class="op" id="6636437">,</span>&nbsp;<span class="ident" id="6636439">dictionary</span><span class="op" id="6636449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6636453">for</span>&nbsp;<span class="ident" id="6636457">level</span>&nbsp;<span class="op" id="6636463">:=</span>&nbsp;<span class="ident" id="6636466">BestSpeed</span><span class="op" id="6636475">;</span>&nbsp;<span class="ident" id="6636477">level</span>&nbsp;<span class="op" id="6636483">&lt;=</span>&nbsp;<span class="ident" id="6636486">BestCompression</span><span class="op" id="6636501">;</span>&nbsp;<span class="ident" id="6636503">level</span><span class="op" id="6636508">++</span>&nbsp;<span class="op" id="6636511">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636516">testFileLevelDict</span><span class="op" id="6636533">(</span><span class="ident" id="6636534">t</span><span class="op" id="6636535">,</span>&nbsp;<span class="ident" id="6636537">fn</span><span class="op" id="6636539">,</span>&nbsp;<span class="ident" id="6636541">level</span><span class="op" id="6636546">,</span>&nbsp;<span class="ident" id="6636548">dictionary</span><span class="op" id="6636558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6636562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6636565">}</span><br>
<span class="lineno"></span><span class="op" id="6636567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6636570">func</span>&nbsp;<span class="ident" id="6636575">TestWriterReset</span><span class="op" id="6636590">(</span><span class="ident" id="6636591">t</span>&nbsp;<span class="op" id="6636593">*</span><span class="ident" id="6636594">testing</span><span class="op" id="6636601">.</span><span class="ident" id="6636602">T</span><span class="op" id="6636603">)</span>&nbsp;<span class="op" id="6636605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6636608">const</span>&nbsp;<span class="ident" id="6636614">dictionary</span>&nbsp;<span class="op" id="6636625">=</span>&nbsp;<span class="string" id="6636627">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6636642">for</span>&nbsp;<span class="ident" id="6636646">_</span><span class="op" id="6636647">,</span>&nbsp;<span class="ident" id="6636649">fn</span>&nbsp;<span class="op" id="6636652">:=</span>&nbsp;<span class="keyword" id="6636655">range</span>&nbsp;<span class="ident" id="6636661">filenames</span>&nbsp;<span class="op" id="6636671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636675">testFileLevelDictReset</span><span class="op" id="6636697">(</span><span class="ident" id="6636698">t</span><span class="op" id="6636699">,</span>&nbsp;<span class="ident" id="6636701">fn</span><span class="op" id="6636703">,</span>&nbsp;<span class="ident" id="6636705">NoCompression</span><span class="op" id="6636718">,</span>&nbsp;<span class="ident" id="6636720">nil</span><span class="op" id="6636723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636727">testFileLevelDictReset</span><span class="op" id="6636749">(</span><span class="ident" id="6636750">t</span><span class="op" id="6636751">,</span>&nbsp;<span class="ident" id="6636753">fn</span><span class="op" id="6636755">,</span>&nbsp;<span class="ident" id="6636757">DefaultCompression</span><span class="op" id="6636775">,</span>&nbsp;<span class="ident" id="6636777">nil</span><span class="op" id="6636780">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636784">testFileLevelDictReset</span><span class="op" id="6636806">(</span><span class="ident" id="6636807">t</span><span class="op" id="6636808">,</span>&nbsp;<span class="ident" id="6636810">fn</span><span class="op" id="6636812">,</span>&nbsp;<span class="ident" id="6636814">NoCompression</span><span class="op" id="6636827">,</span>&nbsp;<span class="op" id="6636829">[</span><span class="op" id="6636830">]</span><span class="builtintype" id="6636831">byte</span><span class="op" id="6636835">(</span><span class="ident" id="6636836">dictionary</span><span class="op" id="6636846">)</span><span class="op" id="6636847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6636851">testFileLevelDictReset</span><span class="op" id="6636873">(</span><span class="ident" id="6636874">t</span><span class="op" id="6636875">,</span>&nbsp;<span class="ident" id="6636877">fn</span><span class="op" id="6636879">,</span>&nbsp;<span class="ident" id="6636881">DefaultCompression</span><span class="op" id="6636899">,</span>&nbsp;<span class="op" id="6636901">[</span><span class="op" id="6636902">]</span><span class="builtintype" id="6636903">byte</span><span class="op" id="6636907">(</span><span class="ident" id="6636908">dictionary</span><span class="op" id="6636918">)</span><span class="op" id="6636919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6636923">if</span>&nbsp;<span class="op" id="6636926">!</span><span class="ident" id="6636927">testing</span><span class="op" id="6636934">.</span><span class="ident" id="6636935">Short</span><span class="op" id="6636940">(</span><span class="op" id="6636941">)</span>&nbsp;<span class="op" id="6636943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6636948">for</span>&nbsp;<span class="ident" id="6636952">level</span>&nbsp;<span class="op" id="6636958">:=</span>&nbsp;<span class="ident" id="6636961">BestSpeed</span><span class="op" id="6636970">;</span>&nbsp;<span class="ident" id="6636972">level</span>&nbsp;<span class="op" id="6636978">&lt;=</span>&nbsp;<span class="ident" id="6636981">BestCompression</span><span class="op" id="6636996">;</span>&nbsp;<span class="ident" id="6636998">level</span><span class="op" id="6637003">++</span>&nbsp;<span class="op" id="6637006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6637012">testFileLevelDictReset</span><span class="op" id="6637034">(</span><span class="ident" id="6637035">t</span><span class="op" id="6637036">,</span>&nbsp;<span class="ident" id="6637038">fn</span><span class="op" id="6637040">,</span>&nbsp;<span class="ident" id="6637042">level</span><span class="op" id="6637047">,</span>&nbsp;<span class="ident" id="6637049">nil</span><span class="op" id="6637052">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6637057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6637061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6637064">}</span><br>
<span class="lineno"></span><span class="op" id="6637066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="6637069">func</span>&nbsp;<span class="ident" id="6637074">TestWriterDictIsUsed</span><span class="op" id="6637094">(</span><span class="ident" id="6637095">t</span>&nbsp;<span class="op" id="6637097">*</span><span class="ident" id="6637098">testing</span><span class="op" id="6637105">.</span><span class="ident" id="6637106">T</span><span class="op" id="6637107">)</span>&nbsp;<span class="op" id="6637109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6637112">var</span>&nbsp;<span class="ident" id="6637116">input</span>&nbsp;<span class="op" id="6637122">=</span>&nbsp;<span class="op" id="6637124">[</span><span class="op" id="6637125">]</span><span class="builtintype" id="6637126">byte</span><span class="op" id="6637130">(</span><span class="string" id="6637131">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="6637257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6637260">var</span>&nbsp;<span class="ident" id="6637264">buf</span>&nbsp;<span class="ident" id="6637268">bytes</span><span class="op" id="6637273">.</span><span class="ident" id="6637274">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6637282">compressor</span><span class="op" id="6637292">,</span>&nbsp;<span class="ident" id="6637294">err</span>&nbsp;<span class="op" id="6637298">:=</span>&nbsp;<span class="ident" id="6637301">NewWriterLevelDict</span><span class="op" id="6637319">(</span><span class="op" id="6637320">&amp;</span><span class="ident" id="6637321">buf</span><span class="op" id="6637324">,</span>&nbsp;<span class="ident" id="6637326">BestCompression</span><span class="op" id="6637341">,</span>&nbsp;<span class="ident" id="6637343">input</span><span class="op" id="6637348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6637351">if</span>&nbsp;<span class="ident" id="6637354">err</span>&nbsp;<span class="op" id="6637358">!=</span>&nbsp;<span class="ident" id="6637361">nil</span>&nbsp;<span class="op" id="6637365">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6637369">t</span><span class="op" id="6637370">.</span><span class="ident" id="6637371">Errorf</span><span class="op" id="6637377">(</span><span class="string" id="6637378">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="6637411">,</span>&nbsp;<span class="ident" id="6637413">err</span><span class="op" id="6637416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6637420">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6637428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6637431">compressor</span><span class="op" id="6637441">.</span><span class="ident" id="6637442">Write</span><span class="op" id="6637447">(</span><span class="ident" id="6637448">input</span><span class="op" id="6637453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6637456">compressor</span><span class="op" id="6637466">.</span><span class="ident" id="6637467">Close</span><span class="op" id="6637472">(</span><span class="op" id="6637473">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6637476">const</span>&nbsp;<span class="ident" id="6637482">expectedMaxSize</span>&nbsp;<span class="op" id="6637498">=</span>&nbsp;<span class="num" id="6637500">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6637504">output</span>&nbsp;<span class="op" id="6637511">:=</span>&nbsp;<span class="ident" id="6637514">buf</span><span class="op" id="6637517">.</span><span class="ident" id="6637518">Bytes</span><span class="op" id="6637523">(</span><span class="op" id="6637524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6637527">if</span>&nbsp;<span class="builtinfunc" id="6637530">len</span><span class="op" id="6637533">(</span><span class="ident" id="6637534">output</span><span class="op" id="6637540">)</span>&nbsp;<span class="op" id="6637542">&gt;</span>&nbsp;<span class="ident" id="6637544">expectedMaxSize</span>&nbsp;<span class="op" id="6637560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6637564">t</span><span class="op" id="6637565">.</span><span class="ident" id="6637566">Errorf</span><span class="op" id="6637572">(</span><span class="string" id="6637573">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="6637649">,</span>&nbsp;<span class="builtinfunc" id="6637651">len</span><span class="op" id="6637654">(</span><span class="ident" id="6637655">output</span><span class="op" id="6637661">)</span><span class="op" id="6637662">,</span>&nbsp;<span class="ident" id="6637664">expectedMaxSize</span><span class="op" id="6637679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6637682">}</span><br>
<span class="lineno">205</span><span class="op" id="6637684">}</span>
</div>
</body>
</html>
