<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2545834">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2545889">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2545943">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2545994">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="2546033">//</span><br>
<span class="lineno"></span><span class="comment" id="2546036">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="2546096">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="2546135">//</span><br>
<span class="lineno">10</span><span class="comment" id="2546138">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2546198">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="2546263">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="2546330">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="2546354">//</span><br>
<span class="lineno">15</span><span class="comment" id="2546357">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="2546421">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="2546491">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2546554">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="2546587">//</span><br>
<span class="lineno">20</span><span class="comment" id="2546590">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2546666">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2546733">package</span>&nbsp;<span class="ident" id="2546741">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2546746">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2546765">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="2546784">const</span>&nbsp;<span class="op" id="2546790">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2546793">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546845">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2546858">=</span>&nbsp;<span class="num" id="2546860">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546863">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2546876">=</span>&nbsp;<span class="num" id="2546878">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546881">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2546894">=</span>&nbsp;<span class="num" id="2546896">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546899">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2546912">=</span>&nbsp;<span class="num" id="2546914">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546917">dnsTypeCNAME</span>&nbsp;<span class="op" id="2546930">=</span>&nbsp;<span class="num" id="2546932">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546935">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2546948">=</span>&nbsp;<span class="num" id="2546950">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546953">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2546966">=</span>&nbsp;<span class="num" id="2546968">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546971">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2546984">=</span>&nbsp;<span class="num" id="2546986">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546989">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547002">=</span>&nbsp;<span class="num" id="2547004">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547007">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="2547020">=</span>&nbsp;<span class="num" id="2547022">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547026">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2547039">=</span>&nbsp;<span class="num" id="2547041">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547045">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2547058">=</span>&nbsp;<span class="num" id="2547060">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547064">dnsTypeHINFO</span>&nbsp;<span class="op" id="2547077">=</span>&nbsp;<span class="num" id="2547079">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547083">dnsTypeMINFO</span>&nbsp;<span class="op" id="2547096">=</span>&nbsp;<span class="num" id="2547098">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547102">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547115">=</span>&nbsp;<span class="num" id="2547117">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547121">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2547134">=</span>&nbsp;<span class="num" id="2547136">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547140">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="2547153">=</span>&nbsp;<span class="num" id="2547155">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547159">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2547172">=</span>&nbsp;<span class="num" id="2547174">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547179">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547212">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="2547225">=</span>&nbsp;<span class="num" id="2547227">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547232">dnsTypeMAILB</span>&nbsp;<span class="op" id="2547245">=</span>&nbsp;<span class="num" id="2547247">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547252">dnsTypeMAILA</span>&nbsp;<span class="op" id="2547265">=</span>&nbsp;<span class="num" id="2547267">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547272">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2547285">=</span>&nbsp;<span class="num" id="2547287">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547293">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547322">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2547337">=</span>&nbsp;<span class="num" id="2547339">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547342">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="2547357">=</span>&nbsp;<span class="num" id="2547359">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547362">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="2547377">=</span>&nbsp;<span class="num" id="2547379">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547382">dnsClassHESIOD</span>&nbsp;<span class="op" id="2547397">=</span>&nbsp;<span class="num" id="2547399">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547402">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547417">=</span>&nbsp;<span class="num" id="2547419">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547425">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547442">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547465">=</span>&nbsp;<span class="num" id="2547467">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547470">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547493">=</span>&nbsp;<span class="num" id="2547495">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547498">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="2547521">=</span>&nbsp;<span class="num" id="2547523">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547526">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547549">=</span>&nbsp;<span class="num" id="2547551">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547554">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="2547577">=</span>&nbsp;<span class="num" id="2547579">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547582">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547605">=</span>&nbsp;<span class="num" id="2547607">5</span><br>
<span class="lineno"></span><span class="op" id="2547609">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="2547612">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="2547679">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="2547706">type</span>&nbsp;<span class="ident" id="2547711">dnsStruct</span>&nbsp;<span class="keyword" id="2547721">interface</span>&nbsp;<span class="op" id="2547731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547734">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547791">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547849">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547905">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547955">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548011">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548053">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548109">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548147">Walk</span><span class="op" id="2548151">(</span><span class="ident" id="2548152">f</span>&nbsp;<span class="keyword" id="2548154">func</span><span class="op" id="2548158">(</span><span class="ident" id="2548159">v</span>&nbsp;<span class="keyword" id="2548161">interface</span><span class="op" id="2548170">{</span><span class="op" id="2548171">}</span><span class="op" id="2548172">,</span>&nbsp;<span class="ident" id="2548174">name</span><span class="op" id="2548178">,</span>&nbsp;<span class="ident" id="2548180">tag</span>&nbsp;<span class="builtintype" id="2548184">string</span><span class="op" id="2548190">)</span>&nbsp;<span class="op" id="2548192">(</span><span class="ident" id="2548193">ok</span>&nbsp;<span class="builtintype" id="2548196">bool</span><span class="op" id="2548200">)</span><span class="op" id="2548201">)</span>&nbsp;<span class="op" id="2548203">(</span><span class="ident" id="2548204">ok</span>&nbsp;<span class="builtintype" id="2548207">bool</span><span class="op" id="2548211">)</span><br>
<span class="lineno"></span><span class="op" id="2548213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="2548216">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="2548262">type</span>&nbsp;<span class="ident" id="2548267">dnsHeader</span>&nbsp;<span class="keyword" id="2548277">struct</span>&nbsp;<span class="op" id="2548284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548287">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2548322">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548330">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2548365">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548373">Qdcount</span><span class="op" id="2548380">,</span>&nbsp;<span class="ident" id="2548382">Ancount</span><span class="op" id="2548389">,</span>&nbsp;<span class="ident" id="2548391">Nscount</span><span class="op" id="2548398">,</span>&nbsp;<span class="ident" id="2548400">Arcount</span>&nbsp;<span class="builtintype" id="2548408">uint16</span><br>
<span class="lineno">90</span><span class="op" id="2548415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2548418">func</span>&nbsp;<span class="op" id="2548423">(</span><span class="ident" id="2548424">h</span>&nbsp;<span class="op" id="2548426">*</span><span class="ident" id="2548427"><a href="/net/dnsmsg.go.html#2548267">dnsHeader</a></span><span class="op" id="2548436">)</span>&nbsp;<span class="ident" id="2548438">Walk</span><span class="op" id="2548442">(</span><span class="ident" id="2548443">f</span>&nbsp;<span class="keyword" id="2548445">func</span><span class="op" id="2548449">(</span><span class="ident" id="2548450">v</span>&nbsp;<span class="keyword" id="2548452">interface</span><span class="op" id="2548461">{</span><span class="op" id="2548462">}</span><span class="op" id="2548463">,</span>&nbsp;<span class="ident" id="2548465">name</span><span class="op" id="2548469">,</span>&nbsp;<span class="ident" id="2548471">tag</span>&nbsp;<span class="builtintype" id="2548475">string</span><span class="op" id="2548481">)</span>&nbsp;<span class="builtintype" id="2548483">bool</span><span class="op" id="2548487">)</span>&nbsp;<span class="builtintype" id="2548489">bool</span>&nbsp;<span class="op" id="2548494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548497">return</span>&nbsp;<span class="ident" id="2548504"><a href="/net/dnsmsg.go.html#2548443">f</a></span><span class="op" id="2548505">(</span><span class="op" id="2548506">&amp;</span><span class="ident" id="2548507"><a href="/net/dnsmsg.go.html#2548424">h</a></span><span class="op" id="2548508">.</span><span class="ident" id="2548509">Id</span><span class="op" id="2548511">,</span>&nbsp;<span class="string" id="2548513">&#34;Id&#34;</span><span class="op" id="2548517">,</span>&nbsp;<span class="string" id="2548519">&#34;&#34;</span><span class="op" id="2548521">)</span>&nbsp;<span class="op" id="2548523">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548528"><a href="/net/dnsmsg.go.html#2548443">f</a></span><span class="op" id="2548529">(</span><span class="op" id="2548530">&amp;</span><span class="ident" id="2548531"><a href="/net/dnsmsg.go.html#2548424">h</a></span><span class="op" id="2548532">.</span><span class="ident" id="2548533">Bits</span><span class="op" id="2548537">,</span>&nbsp;<span class="string" id="2548539">&#34;Bits&#34;</span><span class="op" id="2548545">,</span>&nbsp;<span class="string" id="2548547">&#34;&#34;</span><span class="op" id="2548549">)</span>&nbsp;<span class="op" id="2548551">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548556"><a href="/net/dnsmsg.go.html#2548443">f</a></span><span class="op" id="2548557">(</span><span class="op" id="2548558">&amp;</span><span class="ident" id="2548559"><a href="/net/dnsmsg.go.html#2548424">h</a></span><span class="op" id="2548560">.</span><span class="ident" id="2548561">Qdcount</span><span class="op" id="2548568">,</span>&nbsp;<span class="string" id="2548570">&#34;Qdcount&#34;</span><span class="op" id="2548579">,</span>&nbsp;<span class="string" id="2548581">&#34;&#34;</span><span class="op" id="2548583">)</span>&nbsp;<span class="op" id="2548585">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548590"><a href="/net/dnsmsg.go.html#2548443">f</a></span><span class="op" id="2548591">(</span><span class="op" id="2548592">&amp;</span><span class="ident" id="2548593"><a href="/net/dnsmsg.go.html#2548424">h</a></span><span class="op" id="2548594">.</span><span class="ident" id="2548595">Ancount</span><span class="op" id="2548602">,</span>&nbsp;<span class="string" id="2548604">&#34;Ancount&#34;</span><span class="op" id="2548613">,</span>&nbsp;<span class="string" id="2548615">&#34;&#34;</span><span class="op" id="2548617">)</span>&nbsp;<span class="op" id="2548619">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548624"><a href="/net/dnsmsg.go.html#2548443">f</a></span><span class="op" id="2548625">(</span><span class="op" id="2548626">&amp;</span><span class="ident" id="2548627"><a href="/net/dnsmsg.go.html#2548424">h</a></span><span class="op" id="2548628">.</span><span class="ident" id="2548629">Nscount</span><span class="op" id="2548636">,</span>&nbsp;<span class="string" id="2548638">&#34;Nscount&#34;</span><span class="op" id="2548647">,</span>&nbsp;<span class="string" id="2548649">&#34;&#34;</span><span class="op" id="2548651">)</span>&nbsp;<span class="op" id="2548653">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548658"><a href="/net/dnsmsg.go.html#2548443">f</a></span><span class="op" id="2548659">(</span><span class="op" id="2548660">&amp;</span><span class="ident" id="2548661"><a href="/net/dnsmsg.go.html#2548424">h</a></span><span class="op" id="2548662">.</span><span class="ident" id="2548663">Arcount</span><span class="op" id="2548670">,</span>&nbsp;<span class="string" id="2548672">&#34;Arcount&#34;</span><span class="op" id="2548681">,</span>&nbsp;<span class="string" id="2548683">&#34;&#34;</span><span class="op" id="2548685">)</span><br>
<span class="lineno"></span><span class="op" id="2548687">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="2548690">const</span>&nbsp;<span class="op" id="2548696">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548699">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548718">_QR</span>&nbsp;<span class="op" id="2548722">=</span>&nbsp;<span class="num" id="2548724">1</span>&nbsp;<span class="op" id="2548726">&lt;&lt;</span>&nbsp;<span class="num" id="2548729">15</span>&nbsp;<span class="comment" id="2548732">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548764">_AA</span>&nbsp;<span class="op" id="2548768">=</span>&nbsp;<span class="num" id="2548770">1</span>&nbsp;<span class="op" id="2548772">&lt;&lt;</span>&nbsp;<span class="num" id="2548775">10</span>&nbsp;<span class="comment" id="2548778">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548796">_TC</span>&nbsp;<span class="op" id="2548800">=</span>&nbsp;<span class="num" id="2548802">1</span>&nbsp;<span class="op" id="2548804">&lt;&lt;</span>&nbsp;<span class="num" id="2548807">9</span>&nbsp;&nbsp;<span class="comment" id="2548810">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548824">_RD</span>&nbsp;<span class="op" id="2548828">=</span>&nbsp;<span class="num" id="2548830">1</span>&nbsp;<span class="op" id="2548832">&lt;&lt;</span>&nbsp;<span class="num" id="2548835">8</span>&nbsp;&nbsp;<span class="comment" id="2548838">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548860">_RA</span>&nbsp;<span class="op" id="2548864">=</span>&nbsp;<span class="num" id="2548866">1</span>&nbsp;<span class="op" id="2548868">&lt;&lt;</span>&nbsp;<span class="num" id="2548871">7</span>&nbsp;&nbsp;<span class="comment" id="2548874">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="2548897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2548900">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="2548916">type</span>&nbsp;<span class="ident" id="2548921">dnsQuestion</span>&nbsp;<span class="keyword" id="2548933">struct</span>&nbsp;<span class="op" id="2548940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548943">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2548950">string</span>&nbsp;<span class="string" id="2548957">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="2548977">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549039">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="2549046">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549054">Qclass</span>&nbsp;<span class="builtintype" id="2549061">uint16</span><br>
<span class="lineno">115</span><span class="op" id="2549068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549071">func</span>&nbsp;<span class="op" id="2549076">(</span><span class="ident" id="2549077">q</span>&nbsp;<span class="op" id="2549079">*</span><span class="ident" id="2549080"><a href="/net/dnsmsg.go.html#2548921">dnsQuestion</a></span><span class="op" id="2549091">)</span>&nbsp;<span class="ident" id="2549093">Walk</span><span class="op" id="2549097">(</span><span class="ident" id="2549098">f</span>&nbsp;<span class="keyword" id="2549100">func</span><span class="op" id="2549104">(</span><span class="ident" id="2549105">v</span>&nbsp;<span class="keyword" id="2549107">interface</span><span class="op" id="2549116">{</span><span class="op" id="2549117">}</span><span class="op" id="2549118">,</span>&nbsp;<span class="ident" id="2549120">name</span><span class="op" id="2549124">,</span>&nbsp;<span class="ident" id="2549126">tag</span>&nbsp;<span class="builtintype" id="2549130">string</span><span class="op" id="2549136">)</span>&nbsp;<span class="builtintype" id="2549138">bool</span><span class="op" id="2549142">)</span>&nbsp;<span class="builtintype" id="2549144">bool</span>&nbsp;<span class="op" id="2549149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549152">return</span>&nbsp;<span class="ident" id="2549159"><a href="/net/dnsmsg.go.html#2549098">f</a></span><span class="op" id="2549160">(</span><span class="op" id="2549161">&amp;</span><span class="ident" id="2549162"><a href="/net/dnsmsg.go.html#2549077">q</a></span><span class="op" id="2549163">.</span><span class="ident" id="2549164">Name</span><span class="op" id="2549168">,</span>&nbsp;<span class="string" id="2549170">&#34;Name&#34;</span><span class="op" id="2549176">,</span>&nbsp;<span class="string" id="2549178">&#34;domain&#34;</span><span class="op" id="2549186">)</span>&nbsp;<span class="op" id="2549188">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549193"><a href="/net/dnsmsg.go.html#2549098">f</a></span><span class="op" id="2549194">(</span><span class="op" id="2549195">&amp;</span><span class="ident" id="2549196"><a href="/net/dnsmsg.go.html#2549077">q</a></span><span class="op" id="2549197">.</span><span class="ident" id="2549198">Qtype</span><span class="op" id="2549203">,</span>&nbsp;<span class="string" id="2549205">&#34;Qtype&#34;</span><span class="op" id="2549212">,</span>&nbsp;<span class="string" id="2549214">&#34;&#34;</span><span class="op" id="2549216">)</span>&nbsp;<span class="op" id="2549218">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549223"><a href="/net/dnsmsg.go.html#2549098">f</a></span><span class="op" id="2549224">(</span><span class="op" id="2549225">&amp;</span><span class="ident" id="2549226"><a href="/net/dnsmsg.go.html#2549077">q</a></span><span class="op" id="2549227">.</span><span class="ident" id="2549228">Qclass</span><span class="op" id="2549234">,</span>&nbsp;<span class="string" id="2549236">&#34;Qclass&#34;</span><span class="op" id="2549244">,</span>&nbsp;<span class="string" id="2549246">&#34;&#34;</span><span class="op" id="2549248">)</span><br>
<span class="lineno"></span><span class="op" id="2549250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2549253">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="2549290">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="2549327">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="2549366">type</span>&nbsp;<span class="ident" id="2549371">dnsRR_Header</span>&nbsp;<span class="keyword" id="2549384">struct</span>&nbsp;<span class="op" id="2549391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549394">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2549403">string</span>&nbsp;<span class="string" id="2549410">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549431">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2549440">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549448">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2549457">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549465">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2549474">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549482">Rdlength</span>&nbsp;<span class="builtintype" id="2549491">uint16</span>&nbsp;<span class="comment" id="2549498">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="2549529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549532">func</span>&nbsp;<span class="op" id="2549537">(</span><span class="ident" id="2549538">h</span>&nbsp;<span class="op" id="2549540">*</span><span class="ident" id="2549541"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><span class="op" id="2549553">)</span>&nbsp;<span class="ident" id="2549555">Header</span><span class="op" id="2549561">(</span><span class="op" id="2549562">)</span>&nbsp;<span class="op" id="2549564">*</span><span class="ident" id="2549565"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2549578">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549581">return</span>&nbsp;<span class="ident" id="2549588"><a href="/net/dnsmsg.go.html#2549538">h</a></span><br>
<span class="lineno"></span><span class="op" id="2549590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549593">func</span>&nbsp;<span class="op" id="2549598">(</span><span class="ident" id="2549599">h</span>&nbsp;<span class="op" id="2549601">*</span><span class="ident" id="2549602"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><span class="op" id="2549614">)</span>&nbsp;<span class="ident" id="2549616">Walk</span><span class="op" id="2549620">(</span><span class="ident" id="2549621">f</span>&nbsp;<span class="keyword" id="2549623">func</span><span class="op" id="2549627">(</span><span class="ident" id="2549628">v</span>&nbsp;<span class="keyword" id="2549630">interface</span><span class="op" id="2549639">{</span><span class="op" id="2549640">}</span><span class="op" id="2549641">,</span>&nbsp;<span class="ident" id="2549643">name</span><span class="op" id="2549647">,</span>&nbsp;<span class="ident" id="2549649">tag</span>&nbsp;<span class="builtintype" id="2549653">string</span><span class="op" id="2549659">)</span>&nbsp;<span class="builtintype" id="2549661">bool</span><span class="op" id="2549665">)</span>&nbsp;<span class="builtintype" id="2549667">bool</span>&nbsp;<span class="op" id="2549672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549675">return</span>&nbsp;<span class="ident" id="2549682"><a href="/net/dnsmsg.go.html#2549621">f</a></span><span class="op" id="2549683">(</span><span class="op" id="2549684">&amp;</span><span class="ident" id="2549685"><a href="/net/dnsmsg.go.html#2549599">h</a></span><span class="op" id="2549686">.</span><span class="ident" id="2549687">Name</span><span class="op" id="2549691">,</span>&nbsp;<span class="string" id="2549693">&#34;Name&#34;</span><span class="op" id="2549699">,</span>&nbsp;<span class="string" id="2549701">&#34;domain&#34;</span><span class="op" id="2549709">)</span>&nbsp;<span class="op" id="2549711">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549716"><a href="/net/dnsmsg.go.html#2549621">f</a></span><span class="op" id="2549717">(</span><span class="op" id="2549718">&amp;</span><span class="ident" id="2549719"><a href="/net/dnsmsg.go.html#2549599">h</a></span><span class="op" id="2549720">.</span><span class="ident" id="2549721">Rrtype</span><span class="op" id="2549727">,</span>&nbsp;<span class="string" id="2549729">&#34;Rrtype&#34;</span><span class="op" id="2549737">,</span>&nbsp;<span class="string" id="2549739">&#34;&#34;</span><span class="op" id="2549741">)</span>&nbsp;<span class="op" id="2549743">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549748"><a href="/net/dnsmsg.go.html#2549621">f</a></span><span class="op" id="2549749">(</span><span class="op" id="2549750">&amp;</span><span class="ident" id="2549751"><a href="/net/dnsmsg.go.html#2549599">h</a></span><span class="op" id="2549752">.</span><span class="ident" id="2549753">Class</span><span class="op" id="2549758">,</span>&nbsp;<span class="string" id="2549760">&#34;Class&#34;</span><span class="op" id="2549767">,</span>&nbsp;<span class="string" id="2549769">&#34;&#34;</span><span class="op" id="2549771">)</span>&nbsp;<span class="op" id="2549773">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549778"><a href="/net/dnsmsg.go.html#2549621">f</a></span><span class="op" id="2549779">(</span><span class="op" id="2549780">&amp;</span><span class="ident" id="2549781"><a href="/net/dnsmsg.go.html#2549599">h</a></span><span class="op" id="2549782">.</span><span class="ident" id="2549783">Ttl</span><span class="op" id="2549786">,</span>&nbsp;<span class="string" id="2549788">&#34;Ttl&#34;</span><span class="op" id="2549793">,</span>&nbsp;<span class="string" id="2549795">&#34;&#34;</span><span class="op" id="2549797">)</span>&nbsp;<span class="op" id="2549799">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549804"><a href="/net/dnsmsg.go.html#2549621">f</a></span><span class="op" id="2549805">(</span><span class="op" id="2549806">&amp;</span><span class="ident" id="2549807"><a href="/net/dnsmsg.go.html#2549599">h</a></span><span class="op" id="2549808">.</span><span class="ident" id="2549809">Rdlength</span><span class="op" id="2549817">,</span>&nbsp;<span class="string" id="2549819">&#34;Rdlength&#34;</span><span class="op" id="2549829">,</span>&nbsp;<span class="string" id="2549831">&#34;&#34;</span><span class="op" id="2549833">)</span><br>
<span class="lineno"></span><span class="op" id="2549835">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="2549838">type</span>&nbsp;<span class="ident" id="2549843">dnsRR</span>&nbsp;<span class="keyword" id="2549849">interface</span>&nbsp;<span class="op" id="2549859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549862"><a href="/net/dnsmsg.go.html#2547711">dnsStruct</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549873">Header</span><span class="op" id="2549879">(</span><span class="op" id="2549880">)</span>&nbsp;<span class="op" id="2549882">*</span><span class="ident" id="2549883"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span><span class="op" id="2549896">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="2549899">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549948">type</span>&nbsp;<span class="ident" id="2549953">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="2549965">struct</span>&nbsp;<span class="op" id="2549972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549975">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2549981"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549995">Cname</span>&nbsp;<span class="builtintype" id="2550001">string</span>&nbsp;<span class="string" id="2550008">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2550028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550031">func</span>&nbsp;<span class="op" id="2550036">(</span><span class="ident" id="2550037">rr</span>&nbsp;<span class="op" id="2550040">*</span><span class="ident" id="2550041"><a href="/net/dnsmsg.go.html#2549953">dnsRR_CNAME</a></span><span class="op" id="2550052">)</span>&nbsp;<span class="ident" id="2550054">Header</span><span class="op" id="2550060">(</span><span class="op" id="2550061">)</span>&nbsp;<span class="op" id="2550063">*</span><span class="ident" id="2550064"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2550077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550080">return</span>&nbsp;<span class="op" id="2550087">&amp;</span><span class="ident" id="2550088"><a href="/net/dnsmsg.go.html#2550037">rr</a></span><span class="op" id="2550090">.</span><span class="ident" id="2550091">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="2550095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550098">func</span>&nbsp;<span class="op" id="2550103">(</span><span class="ident" id="2550104">rr</span>&nbsp;<span class="op" id="2550107">*</span><span class="ident" id="2550108"><a href="/net/dnsmsg.go.html#2549953">dnsRR_CNAME</a></span><span class="op" id="2550119">)</span>&nbsp;<span class="ident" id="2550121">Walk</span><span class="op" id="2550125">(</span><span class="ident" id="2550126">f</span>&nbsp;<span class="keyword" id="2550128">func</span><span class="op" id="2550132">(</span><span class="ident" id="2550133">v</span>&nbsp;<span class="keyword" id="2550135">interface</span><span class="op" id="2550144">{</span><span class="op" id="2550145">}</span><span class="op" id="2550146">,</span>&nbsp;<span class="ident" id="2550148">name</span><span class="op" id="2550152">,</span>&nbsp;<span class="ident" id="2550154">tag</span>&nbsp;<span class="builtintype" id="2550158">string</span><span class="op" id="2550164">)</span>&nbsp;<span class="builtintype" id="2550166">bool</span><span class="op" id="2550170">)</span>&nbsp;<span class="builtintype" id="2550172">bool</span>&nbsp;<span class="op" id="2550177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550180">return</span>&nbsp;<span class="ident" id="2550187"><a href="/net/dnsmsg.go.html#2550104">rr</a></span><span class="op" id="2550189">.</span><span class="ident" id="2550190">Hdr</span><span class="op" id="2550193">.</span><span class="ident" id="2550194">Walk</span><span class="op" id="2550198">(</span><span class="ident" id="2550199"><a href="/net/dnsmsg.go.html#2550126">f</a></span><span class="op" id="2550200">)</span>&nbsp;<span class="op" id="2550202">&amp;&amp;</span>&nbsp;<span class="ident" id="2550205"><a href="/net/dnsmsg.go.html#2550126">f</a></span><span class="op" id="2550206">(</span><span class="op" id="2550207">&amp;</span><span class="ident" id="2550208"><a href="/net/dnsmsg.go.html#2550104">rr</a></span><span class="op" id="2550210">.</span><span class="ident" id="2550211">Cname</span><span class="op" id="2550216">,</span>&nbsp;<span class="string" id="2550218">&#34;Cname&#34;</span><span class="op" id="2550225">,</span>&nbsp;<span class="string" id="2550227">&#34;domain&#34;</span><span class="op" id="2550235">)</span><br>
<span class="lineno"></span><span class="op" id="2550237">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="2550240">type</span>&nbsp;<span class="ident" id="2550245">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="2550257">struct</span>&nbsp;<span class="op" id="2550264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550267">Hdr</span>&nbsp;<span class="ident" id="2550271"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550285">Cpu</span>&nbsp;<span class="builtintype" id="2550289">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550297">Os</span>&nbsp;&nbsp;<span class="builtintype" id="2550301">string</span><br>
<span class="lineno">170</span><span class="op" id="2550308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550311">func</span>&nbsp;<span class="op" id="2550316">(</span><span class="ident" id="2550317">rr</span>&nbsp;<span class="op" id="2550320">*</span><span class="ident" id="2550321"><a href="/net/dnsmsg.go.html#2550245">dnsRR_HINFO</a></span><span class="op" id="2550332">)</span>&nbsp;<span class="ident" id="2550334">Header</span><span class="op" id="2550340">(</span><span class="op" id="2550341">)</span>&nbsp;<span class="op" id="2550343">*</span><span class="ident" id="2550344"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2550357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550360">return</span>&nbsp;<span class="op" id="2550367">&amp;</span><span class="ident" id="2550368"><a href="/net/dnsmsg.go.html#2550317">rr</a></span><span class="op" id="2550370">.</span><span class="ident" id="2550371">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2550375">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2550378">func</span>&nbsp;<span class="op" id="2550383">(</span><span class="ident" id="2550384">rr</span>&nbsp;<span class="op" id="2550387">*</span><span class="ident" id="2550388"><a href="/net/dnsmsg.go.html#2550245">dnsRR_HINFO</a></span><span class="op" id="2550399">)</span>&nbsp;<span class="ident" id="2550401">Walk</span><span class="op" id="2550405">(</span><span class="ident" id="2550406">f</span>&nbsp;<span class="keyword" id="2550408">func</span><span class="op" id="2550412">(</span><span class="ident" id="2550413">v</span>&nbsp;<span class="keyword" id="2550415">interface</span><span class="op" id="2550424">{</span><span class="op" id="2550425">}</span><span class="op" id="2550426">,</span>&nbsp;<span class="ident" id="2550428">name</span><span class="op" id="2550432">,</span>&nbsp;<span class="ident" id="2550434">tag</span>&nbsp;<span class="builtintype" id="2550438">string</span><span class="op" id="2550444">)</span>&nbsp;<span class="builtintype" id="2550446">bool</span><span class="op" id="2550450">)</span>&nbsp;<span class="builtintype" id="2550452">bool</span>&nbsp;<span class="op" id="2550457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550460">return</span>&nbsp;<span class="ident" id="2550467"><a href="/net/dnsmsg.go.html#2550384">rr</a></span><span class="op" id="2550469">.</span><span class="ident" id="2550470">Hdr</span><span class="op" id="2550473">.</span><span class="ident" id="2550474">Walk</span><span class="op" id="2550478">(</span><span class="ident" id="2550479"><a href="/net/dnsmsg.go.html#2550406">f</a></span><span class="op" id="2550480">)</span>&nbsp;<span class="op" id="2550482">&amp;&amp;</span>&nbsp;<span class="ident" id="2550485"><a href="/net/dnsmsg.go.html#2550406">f</a></span><span class="op" id="2550486">(</span><span class="op" id="2550487">&amp;</span><span class="ident" id="2550488"><a href="/net/dnsmsg.go.html#2550384">rr</a></span><span class="op" id="2550490">.</span><span class="ident" id="2550491">Cpu</span><span class="op" id="2550494">,</span>&nbsp;<span class="string" id="2550496">&#34;Cpu&#34;</span><span class="op" id="2550501">,</span>&nbsp;<span class="string" id="2550503">&#34;&#34;</span><span class="op" id="2550505">)</span>&nbsp;<span class="op" id="2550507">&amp;&amp;</span>&nbsp;<span class="ident" id="2550510"><a href="/net/dnsmsg.go.html#2550406">f</a></span><span class="op" id="2550511">(</span><span class="op" id="2550512">&amp;</span><span class="ident" id="2550513"><a href="/net/dnsmsg.go.html#2550384">rr</a></span><span class="op" id="2550515">.</span><span class="ident" id="2550516">Os</span><span class="op" id="2550518">,</span>&nbsp;<span class="string" id="2550520">&#34;Os&#34;</span><span class="op" id="2550524">,</span>&nbsp;<span class="string" id="2550526">&#34;&#34;</span><span class="op" id="2550528">)</span><br>
<span class="lineno"></span><span class="op" id="2550530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="2550533">type</span>&nbsp;<span class="ident" id="2550538">dnsRR_MB</span>&nbsp;<span class="keyword" id="2550547">struct</span>&nbsp;<span class="op" id="2550554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550557">Hdr</span>&nbsp;<span class="ident" id="2550561"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550575">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="2550579">string</span>&nbsp;<span class="string" id="2550586">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2550606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="2550609">func</span>&nbsp;<span class="op" id="2550614">(</span><span class="ident" id="2550615">rr</span>&nbsp;<span class="op" id="2550618">*</span><span class="ident" id="2550619"><a href="/net/dnsmsg.go.html#2550538">dnsRR_MB</a></span><span class="op" id="2550627">)</span>&nbsp;<span class="ident" id="2550629">Header</span><span class="op" id="2550635">(</span><span class="op" id="2550636">)</span>&nbsp;<span class="op" id="2550638">*</span><span class="ident" id="2550639"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2550652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550655">return</span>&nbsp;<span class="op" id="2550662">&amp;</span><span class="ident" id="2550663"><a href="/net/dnsmsg.go.html#2550615">rr</a></span><span class="op" id="2550665">.</span><span class="ident" id="2550666">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2550670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550673">func</span>&nbsp;<span class="op" id="2550678">(</span><span class="ident" id="2550679">rr</span>&nbsp;<span class="op" id="2550682">*</span><span class="ident" id="2550683"><a href="/net/dnsmsg.go.html#2550538">dnsRR_MB</a></span><span class="op" id="2550691">)</span>&nbsp;<span class="ident" id="2550693">Walk</span><span class="op" id="2550697">(</span><span class="ident" id="2550698">f</span>&nbsp;<span class="keyword" id="2550700">func</span><span class="op" id="2550704">(</span><span class="ident" id="2550705">v</span>&nbsp;<span class="keyword" id="2550707">interface</span><span class="op" id="2550716">{</span><span class="op" id="2550717">}</span><span class="op" id="2550718">,</span>&nbsp;<span class="ident" id="2550720">name</span><span class="op" id="2550724">,</span>&nbsp;<span class="ident" id="2550726">tag</span>&nbsp;<span class="builtintype" id="2550730">string</span><span class="op" id="2550736">)</span>&nbsp;<span class="builtintype" id="2550738">bool</span><span class="op" id="2550742">)</span>&nbsp;<span class="builtintype" id="2550744">bool</span>&nbsp;<span class="op" id="2550749">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550752">return</span>&nbsp;<span class="ident" id="2550759"><a href="/net/dnsmsg.go.html#2550679">rr</a></span><span class="op" id="2550761">.</span><span class="ident" id="2550762">Hdr</span><span class="op" id="2550765">.</span><span class="ident" id="2550766">Walk</span><span class="op" id="2550770">(</span><span class="ident" id="2550771"><a href="/net/dnsmsg.go.html#2550698">f</a></span><span class="op" id="2550772">)</span>&nbsp;<span class="op" id="2550774">&amp;&amp;</span>&nbsp;<span class="ident" id="2550777"><a href="/net/dnsmsg.go.html#2550698">f</a></span><span class="op" id="2550778">(</span><span class="op" id="2550779">&amp;</span><span class="ident" id="2550780"><a href="/net/dnsmsg.go.html#2550679">rr</a></span><span class="op" id="2550782">.</span><span class="ident" id="2550783">Mb</span><span class="op" id="2550785">,</span>&nbsp;<span class="string" id="2550787">&#34;Mb&#34;</span><span class="op" id="2550791">,</span>&nbsp;<span class="string" id="2550793">&#34;domain&#34;</span><span class="op" id="2550801">)</span><br>
<span class="lineno"></span><span class="op" id="2550803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550806">type</span>&nbsp;<span class="ident" id="2550811">dnsRR_MG</span>&nbsp;<span class="keyword" id="2550820">struct</span>&nbsp;<span class="op" id="2550827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550830">Hdr</span>&nbsp;<span class="ident" id="2550834"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550848">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="2550852">string</span>&nbsp;<span class="string" id="2550859">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2550879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550882">func</span>&nbsp;<span class="op" id="2550887">(</span><span class="ident" id="2550888">rr</span>&nbsp;<span class="op" id="2550891">*</span><span class="ident" id="2550892"><a href="/net/dnsmsg.go.html#2550811">dnsRR_MG</a></span><span class="op" id="2550900">)</span>&nbsp;<span class="ident" id="2550902">Header</span><span class="op" id="2550908">(</span><span class="op" id="2550909">)</span>&nbsp;<span class="op" id="2550911">*</span><span class="ident" id="2550912"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2550925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550928">return</span>&nbsp;<span class="op" id="2550935">&amp;</span><span class="ident" id="2550936"><a href="/net/dnsmsg.go.html#2550888">rr</a></span><span class="op" id="2550938">.</span><span class="ident" id="2550939">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="2550943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550946">func</span>&nbsp;<span class="op" id="2550951">(</span><span class="ident" id="2550952">rr</span>&nbsp;<span class="op" id="2550955">*</span><span class="ident" id="2550956"><a href="/net/dnsmsg.go.html#2550811">dnsRR_MG</a></span><span class="op" id="2550964">)</span>&nbsp;<span class="ident" id="2550966">Walk</span><span class="op" id="2550970">(</span><span class="ident" id="2550971">f</span>&nbsp;<span class="keyword" id="2550973">func</span><span class="op" id="2550977">(</span><span class="ident" id="2550978">v</span>&nbsp;<span class="keyword" id="2550980">interface</span><span class="op" id="2550989">{</span><span class="op" id="2550990">}</span><span class="op" id="2550991">,</span>&nbsp;<span class="ident" id="2550993">name</span><span class="op" id="2550997">,</span>&nbsp;<span class="ident" id="2550999">tag</span>&nbsp;<span class="builtintype" id="2551003">string</span><span class="op" id="2551009">)</span>&nbsp;<span class="builtintype" id="2551011">bool</span><span class="op" id="2551015">)</span>&nbsp;<span class="builtintype" id="2551017">bool</span>&nbsp;<span class="op" id="2551022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551025">return</span>&nbsp;<span class="ident" id="2551032"><a href="/net/dnsmsg.go.html#2550952">rr</a></span><span class="op" id="2551034">.</span><span class="ident" id="2551035">Hdr</span><span class="op" id="2551038">.</span><span class="ident" id="2551039">Walk</span><span class="op" id="2551043">(</span><span class="ident" id="2551044"><a href="/net/dnsmsg.go.html#2550971">f</a></span><span class="op" id="2551045">)</span>&nbsp;<span class="op" id="2551047">&amp;&amp;</span>&nbsp;<span class="ident" id="2551050"><a href="/net/dnsmsg.go.html#2550971">f</a></span><span class="op" id="2551051">(</span><span class="op" id="2551052">&amp;</span><span class="ident" id="2551053"><a href="/net/dnsmsg.go.html#2550952">rr</a></span><span class="op" id="2551055">.</span><span class="ident" id="2551056">Mg</span><span class="op" id="2551058">,</span>&nbsp;<span class="string" id="2551060">&#34;Mg&#34;</span><span class="op" id="2551064">,</span>&nbsp;<span class="string" id="2551066">&#34;domain&#34;</span><span class="op" id="2551074">)</span><br>
<span class="lineno"></span><span class="op" id="2551076">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2551079">type</span>&nbsp;<span class="ident" id="2551084">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="2551096">struct</span>&nbsp;<span class="op" id="2551103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551106">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2551112"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551126">Rmail</span>&nbsp;<span class="builtintype" id="2551132">string</span>&nbsp;<span class="string" id="2551139">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551160">Email</span>&nbsp;<span class="builtintype" id="2551166">string</span>&nbsp;<span class="string" id="2551173">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="2551193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551196">func</span>&nbsp;<span class="op" id="2551201">(</span><span class="ident" id="2551202">rr</span>&nbsp;<span class="op" id="2551205">*</span><span class="ident" id="2551206"><a href="/net/dnsmsg.go.html#2551084">dnsRR_MINFO</a></span><span class="op" id="2551217">)</span>&nbsp;<span class="ident" id="2551219">Header</span><span class="op" id="2551225">(</span><span class="op" id="2551226">)</span>&nbsp;<span class="op" id="2551228">*</span><span class="ident" id="2551229"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2551242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551245">return</span>&nbsp;<span class="op" id="2551252">&amp;</span><span class="ident" id="2551253"><a href="/net/dnsmsg.go.html#2551202">rr</a></span><span class="op" id="2551255">.</span><span class="ident" id="2551256">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2551260">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="2551263">func</span>&nbsp;<span class="op" id="2551268">(</span><span class="ident" id="2551269">rr</span>&nbsp;<span class="op" id="2551272">*</span><span class="ident" id="2551273"><a href="/net/dnsmsg.go.html#2551084">dnsRR_MINFO</a></span><span class="op" id="2551284">)</span>&nbsp;<span class="ident" id="2551286">Walk</span><span class="op" id="2551290">(</span><span class="ident" id="2551291">f</span>&nbsp;<span class="keyword" id="2551293">func</span><span class="op" id="2551297">(</span><span class="ident" id="2551298">v</span>&nbsp;<span class="keyword" id="2551300">interface</span><span class="op" id="2551309">{</span><span class="op" id="2551310">}</span><span class="op" id="2551311">,</span>&nbsp;<span class="ident" id="2551313">name</span><span class="op" id="2551317">,</span>&nbsp;<span class="ident" id="2551319">tag</span>&nbsp;<span class="builtintype" id="2551323">string</span><span class="op" id="2551329">)</span>&nbsp;<span class="builtintype" id="2551331">bool</span><span class="op" id="2551335">)</span>&nbsp;<span class="builtintype" id="2551337">bool</span>&nbsp;<span class="op" id="2551342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551345">return</span>&nbsp;<span class="ident" id="2551352"><a href="/net/dnsmsg.go.html#2551269">rr</a></span><span class="op" id="2551354">.</span><span class="ident" id="2551355">Hdr</span><span class="op" id="2551358">.</span><span class="ident" id="2551359">Walk</span><span class="op" id="2551363">(</span><span class="ident" id="2551364"><a href="/net/dnsmsg.go.html#2551291">f</a></span><span class="op" id="2551365">)</span>&nbsp;<span class="op" id="2551367">&amp;&amp;</span>&nbsp;<span class="ident" id="2551370"><a href="/net/dnsmsg.go.html#2551291">f</a></span><span class="op" id="2551371">(</span><span class="op" id="2551372">&amp;</span><span class="ident" id="2551373"><a href="/net/dnsmsg.go.html#2551269">rr</a></span><span class="op" id="2551375">.</span><span class="ident" id="2551376">Rmail</span><span class="op" id="2551381">,</span>&nbsp;<span class="string" id="2551383">&#34;Rmail&#34;</span><span class="op" id="2551390">,</span>&nbsp;<span class="string" id="2551392">&#34;domain&#34;</span><span class="op" id="2551400">)</span>&nbsp;<span class="op" id="2551402">&amp;&amp;</span>&nbsp;<span class="ident" id="2551405"><a href="/net/dnsmsg.go.html#2551291">f</a></span><span class="op" id="2551406">(</span><span class="op" id="2551407">&amp;</span><span class="ident" id="2551408"><a href="/net/dnsmsg.go.html#2551269">rr</a></span><span class="op" id="2551410">.</span><span class="ident" id="2551411">Email</span><span class="op" id="2551416">,</span>&nbsp;<span class="string" id="2551418">&#34;Email&#34;</span><span class="op" id="2551425">,</span>&nbsp;<span class="string" id="2551427">&#34;domain&#34;</span><span class="op" id="2551435">)</span><br>
<span class="lineno"></span><span class="op" id="2551437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="2551440">type</span>&nbsp;<span class="ident" id="2551445">dnsRR_MR</span>&nbsp;<span class="keyword" id="2551454">struct</span>&nbsp;<span class="op" id="2551461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551464">Hdr</span>&nbsp;<span class="ident" id="2551468"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551482">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="2551486">string</span>&nbsp;<span class="string" id="2551493">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2551513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="2551516">func</span>&nbsp;<span class="op" id="2551521">(</span><span class="ident" id="2551522">rr</span>&nbsp;<span class="op" id="2551525">*</span><span class="ident" id="2551526"><a href="/net/dnsmsg.go.html#2551445">dnsRR_MR</a></span><span class="op" id="2551534">)</span>&nbsp;<span class="ident" id="2551536">Header</span><span class="op" id="2551542">(</span><span class="op" id="2551543">)</span>&nbsp;<span class="op" id="2551545">*</span><span class="ident" id="2551546"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2551559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551562">return</span>&nbsp;<span class="op" id="2551569">&amp;</span><span class="ident" id="2551570"><a href="/net/dnsmsg.go.html#2551522">rr</a></span><span class="op" id="2551572">.</span><span class="ident" id="2551573">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2551577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551580">func</span>&nbsp;<span class="op" id="2551585">(</span><span class="ident" id="2551586">rr</span>&nbsp;<span class="op" id="2551589">*</span><span class="ident" id="2551590"><a href="/net/dnsmsg.go.html#2551445">dnsRR_MR</a></span><span class="op" id="2551598">)</span>&nbsp;<span class="ident" id="2551600">Walk</span><span class="op" id="2551604">(</span><span class="ident" id="2551605">f</span>&nbsp;<span class="keyword" id="2551607">func</span><span class="op" id="2551611">(</span><span class="ident" id="2551612">v</span>&nbsp;<span class="keyword" id="2551614">interface</span><span class="op" id="2551623">{</span><span class="op" id="2551624">}</span><span class="op" id="2551625">,</span>&nbsp;<span class="ident" id="2551627">name</span><span class="op" id="2551631">,</span>&nbsp;<span class="ident" id="2551633">tag</span>&nbsp;<span class="builtintype" id="2551637">string</span><span class="op" id="2551643">)</span>&nbsp;<span class="builtintype" id="2551645">bool</span><span class="op" id="2551649">)</span>&nbsp;<span class="builtintype" id="2551651">bool</span>&nbsp;<span class="op" id="2551656">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551659">return</span>&nbsp;<span class="ident" id="2551666"><a href="/net/dnsmsg.go.html#2551586">rr</a></span><span class="op" id="2551668">.</span><span class="ident" id="2551669">Hdr</span><span class="op" id="2551672">.</span><span class="ident" id="2551673">Walk</span><span class="op" id="2551677">(</span><span class="ident" id="2551678"><a href="/net/dnsmsg.go.html#2551605">f</a></span><span class="op" id="2551679">)</span>&nbsp;<span class="op" id="2551681">&amp;&amp;</span>&nbsp;<span class="ident" id="2551684"><a href="/net/dnsmsg.go.html#2551605">f</a></span><span class="op" id="2551685">(</span><span class="op" id="2551686">&amp;</span><span class="ident" id="2551687"><a href="/net/dnsmsg.go.html#2551586">rr</a></span><span class="op" id="2551689">.</span><span class="ident" id="2551690">Mr</span><span class="op" id="2551692">,</span>&nbsp;<span class="string" id="2551694">&#34;Mr&#34;</span><span class="op" id="2551698">,</span>&nbsp;<span class="string" id="2551700">&#34;domain&#34;</span><span class="op" id="2551708">)</span><br>
<span class="lineno"></span><span class="op" id="2551710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551713">type</span>&nbsp;<span class="ident" id="2551718">dnsRR_MX</span>&nbsp;<span class="keyword" id="2551727">struct</span>&nbsp;<span class="op" id="2551734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551737">Hdr</span>&nbsp;&nbsp;<span class="ident" id="2551742"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551756">Pref</span>&nbsp;<span class="builtintype" id="2551761">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551769">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2551774">string</span>&nbsp;<span class="string" id="2551781">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2551801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551804">func</span>&nbsp;<span class="op" id="2551809">(</span><span class="ident" id="2551810">rr</span>&nbsp;<span class="op" id="2551813">*</span><span class="ident" id="2551814"><a href="/net/dnsmsg.go.html#2551718">dnsRR_MX</a></span><span class="op" id="2551822">)</span>&nbsp;<span class="ident" id="2551824">Header</span><span class="op" id="2551830">(</span><span class="op" id="2551831">)</span>&nbsp;<span class="op" id="2551833">*</span><span class="ident" id="2551834"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2551847">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551850">return</span>&nbsp;<span class="op" id="2551857">&amp;</span><span class="ident" id="2551858"><a href="/net/dnsmsg.go.html#2551810">rr</a></span><span class="op" id="2551860">.</span><span class="ident" id="2551861">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2551865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2551868">func</span>&nbsp;<span class="op" id="2551873">(</span><span class="ident" id="2551874">rr</span>&nbsp;<span class="op" id="2551877">*</span><span class="ident" id="2551878"><a href="/net/dnsmsg.go.html#2551718">dnsRR_MX</a></span><span class="op" id="2551886">)</span>&nbsp;<span class="ident" id="2551888">Walk</span><span class="op" id="2551892">(</span><span class="ident" id="2551893">f</span>&nbsp;<span class="keyword" id="2551895">func</span><span class="op" id="2551899">(</span><span class="ident" id="2551900">v</span>&nbsp;<span class="keyword" id="2551902">interface</span><span class="op" id="2551911">{</span><span class="op" id="2551912">}</span><span class="op" id="2551913">,</span>&nbsp;<span class="ident" id="2551915">name</span><span class="op" id="2551919">,</span>&nbsp;<span class="ident" id="2551921">tag</span>&nbsp;<span class="builtintype" id="2551925">string</span><span class="op" id="2551931">)</span>&nbsp;<span class="builtintype" id="2551933">bool</span><span class="op" id="2551937">)</span>&nbsp;<span class="builtintype" id="2551939">bool</span>&nbsp;<span class="op" id="2551944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551947">return</span>&nbsp;<span class="ident" id="2551954"><a href="/net/dnsmsg.go.html#2551874">rr</a></span><span class="op" id="2551956">.</span><span class="ident" id="2551957">Hdr</span><span class="op" id="2551960">.</span><span class="ident" id="2551961">Walk</span><span class="op" id="2551965">(</span><span class="ident" id="2551966"><a href="/net/dnsmsg.go.html#2551893">f</a></span><span class="op" id="2551967">)</span>&nbsp;<span class="op" id="2551969">&amp;&amp;</span>&nbsp;<span class="ident" id="2551972"><a href="/net/dnsmsg.go.html#2551893">f</a></span><span class="op" id="2551973">(</span><span class="op" id="2551974">&amp;</span><span class="ident" id="2551975"><a href="/net/dnsmsg.go.html#2551874">rr</a></span><span class="op" id="2551977">.</span><span class="ident" id="2551978">Pref</span><span class="op" id="2551982">,</span>&nbsp;<span class="string" id="2551984">&#34;Pref&#34;</span><span class="op" id="2551990">,</span>&nbsp;<span class="string" id="2551992">&#34;&#34;</span><span class="op" id="2551994">)</span>&nbsp;<span class="op" id="2551996">&amp;&amp;</span>&nbsp;<span class="ident" id="2551999"><a href="/net/dnsmsg.go.html#2551893">f</a></span><span class="op" id="2552000">(</span><span class="op" id="2552001">&amp;</span><span class="ident" id="2552002"><a href="/net/dnsmsg.go.html#2551874">rr</a></span><span class="op" id="2552004">.</span><span class="ident" id="2552005">Mx</span><span class="op" id="2552007">,</span>&nbsp;<span class="string" id="2552009">&#34;Mx&#34;</span><span class="op" id="2552013">,</span>&nbsp;<span class="string" id="2552015">&#34;domain&#34;</span><span class="op" id="2552023">)</span><br>
<span class="lineno">245</span><span class="op" id="2552025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552028">type</span>&nbsp;<span class="ident" id="2552033">dnsRR_NS</span>&nbsp;<span class="keyword" id="2552042">struct</span>&nbsp;<span class="op" id="2552049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552052">Hdr</span>&nbsp;<span class="ident" id="2552056"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552070">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="2552074">string</span>&nbsp;<span class="string" id="2552081">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="2552101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552104">func</span>&nbsp;<span class="op" id="2552109">(</span><span class="ident" id="2552110">rr</span>&nbsp;<span class="op" id="2552113">*</span><span class="ident" id="2552114"><a href="/net/dnsmsg.go.html#2552033">dnsRR_NS</a></span><span class="op" id="2552122">)</span>&nbsp;<span class="ident" id="2552124">Header</span><span class="op" id="2552130">(</span><span class="op" id="2552131">)</span>&nbsp;<span class="op" id="2552133">*</span><span class="ident" id="2552134"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2552147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552150">return</span>&nbsp;<span class="op" id="2552157">&amp;</span><span class="ident" id="2552158"><a href="/net/dnsmsg.go.html#2552110">rr</a></span><span class="op" id="2552160">.</span><span class="ident" id="2552161">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2552165">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="2552168">func</span>&nbsp;<span class="op" id="2552173">(</span><span class="ident" id="2552174">rr</span>&nbsp;<span class="op" id="2552177">*</span><span class="ident" id="2552178"><a href="/net/dnsmsg.go.html#2552033">dnsRR_NS</a></span><span class="op" id="2552186">)</span>&nbsp;<span class="ident" id="2552188">Walk</span><span class="op" id="2552192">(</span><span class="ident" id="2552193">f</span>&nbsp;<span class="keyword" id="2552195">func</span><span class="op" id="2552199">(</span><span class="ident" id="2552200">v</span>&nbsp;<span class="keyword" id="2552202">interface</span><span class="op" id="2552211">{</span><span class="op" id="2552212">}</span><span class="op" id="2552213">,</span>&nbsp;<span class="ident" id="2552215">name</span><span class="op" id="2552219">,</span>&nbsp;<span class="ident" id="2552221">tag</span>&nbsp;<span class="builtintype" id="2552225">string</span><span class="op" id="2552231">)</span>&nbsp;<span class="builtintype" id="2552233">bool</span><span class="op" id="2552237">)</span>&nbsp;<span class="builtintype" id="2552239">bool</span>&nbsp;<span class="op" id="2552244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552247">return</span>&nbsp;<span class="ident" id="2552254"><a href="/net/dnsmsg.go.html#2552174">rr</a></span><span class="op" id="2552256">.</span><span class="ident" id="2552257">Hdr</span><span class="op" id="2552260">.</span><span class="ident" id="2552261">Walk</span><span class="op" id="2552265">(</span><span class="ident" id="2552266"><a href="/net/dnsmsg.go.html#2552193">f</a></span><span class="op" id="2552267">)</span>&nbsp;<span class="op" id="2552269">&amp;&amp;</span>&nbsp;<span class="ident" id="2552272"><a href="/net/dnsmsg.go.html#2552193">f</a></span><span class="op" id="2552273">(</span><span class="op" id="2552274">&amp;</span><span class="ident" id="2552275"><a href="/net/dnsmsg.go.html#2552174">rr</a></span><span class="op" id="2552277">.</span><span class="ident" id="2552278">Ns</span><span class="op" id="2552280">,</span>&nbsp;<span class="string" id="2552282">&#34;Ns&#34;</span><span class="op" id="2552286">,</span>&nbsp;<span class="string" id="2552288">&#34;domain&#34;</span><span class="op" id="2552296">)</span><br>
<span class="lineno"></span><span class="op" id="2552298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="2552301">type</span>&nbsp;<span class="ident" id="2552306">dnsRR_PTR</span>&nbsp;<span class="keyword" id="2552316">struct</span>&nbsp;<span class="op" id="2552323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552326">Hdr</span>&nbsp;<span class="ident" id="2552330"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552344">Ptr</span>&nbsp;<span class="builtintype" id="2552348">string</span>&nbsp;<span class="string" id="2552355">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2552375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="2552378">func</span>&nbsp;<span class="op" id="2552383">(</span><span class="ident" id="2552384">rr</span>&nbsp;<span class="op" id="2552387">*</span><span class="ident" id="2552388"><a href="/net/dnsmsg.go.html#2552306">dnsRR_PTR</a></span><span class="op" id="2552397">)</span>&nbsp;<span class="ident" id="2552399">Header</span><span class="op" id="2552405">(</span><span class="op" id="2552406">)</span>&nbsp;<span class="op" id="2552408">*</span><span class="ident" id="2552409"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2552422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552425">return</span>&nbsp;<span class="op" id="2552432">&amp;</span><span class="ident" id="2552433"><a href="/net/dnsmsg.go.html#2552384">rr</a></span><span class="op" id="2552435">.</span><span class="ident" id="2552436">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2552440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552443">func</span>&nbsp;<span class="op" id="2552448">(</span><span class="ident" id="2552449">rr</span>&nbsp;<span class="op" id="2552452">*</span><span class="ident" id="2552453"><a href="/net/dnsmsg.go.html#2552306">dnsRR_PTR</a></span><span class="op" id="2552462">)</span>&nbsp;<span class="ident" id="2552464">Walk</span><span class="op" id="2552468">(</span><span class="ident" id="2552469">f</span>&nbsp;<span class="keyword" id="2552471">func</span><span class="op" id="2552475">(</span><span class="ident" id="2552476">v</span>&nbsp;<span class="keyword" id="2552478">interface</span><span class="op" id="2552487">{</span><span class="op" id="2552488">}</span><span class="op" id="2552489">,</span>&nbsp;<span class="ident" id="2552491">name</span><span class="op" id="2552495">,</span>&nbsp;<span class="ident" id="2552497">tag</span>&nbsp;<span class="builtintype" id="2552501">string</span><span class="op" id="2552507">)</span>&nbsp;<span class="builtintype" id="2552509">bool</span><span class="op" id="2552513">)</span>&nbsp;<span class="builtintype" id="2552515">bool</span>&nbsp;<span class="op" id="2552520">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552523">return</span>&nbsp;<span class="ident" id="2552530"><a href="/net/dnsmsg.go.html#2552449">rr</a></span><span class="op" id="2552532">.</span><span class="ident" id="2552533">Hdr</span><span class="op" id="2552536">.</span><span class="ident" id="2552537">Walk</span><span class="op" id="2552541">(</span><span class="ident" id="2552542"><a href="/net/dnsmsg.go.html#2552469">f</a></span><span class="op" id="2552543">)</span>&nbsp;<span class="op" id="2552545">&amp;&amp;</span>&nbsp;<span class="ident" id="2552548"><a href="/net/dnsmsg.go.html#2552469">f</a></span><span class="op" id="2552549">(</span><span class="op" id="2552550">&amp;</span><span class="ident" id="2552551"><a href="/net/dnsmsg.go.html#2552449">rr</a></span><span class="op" id="2552553">.</span><span class="ident" id="2552554">Ptr</span><span class="op" id="2552557">,</span>&nbsp;<span class="string" id="2552559">&#34;Ptr&#34;</span><span class="op" id="2552564">,</span>&nbsp;<span class="string" id="2552566">&#34;domain&#34;</span><span class="op" id="2552574">)</span><br>
<span class="lineno"></span><span class="op" id="2552576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552579">type</span>&nbsp;<span class="ident" id="2552584">dnsRR_SOA</span>&nbsp;<span class="keyword" id="2552594">struct</span>&nbsp;<span class="op" id="2552601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552604">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2552612"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552626">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2552634">string</span>&nbsp;<span class="string" id="2552641">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552662">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2552670">string</span>&nbsp;<span class="string" id="2552677">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552698">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="2552706">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552714">Refresh</span>&nbsp;<span class="builtintype" id="2552722">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552730">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2552738">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552746">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="2552754">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552762">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="2552770">uint32</span><br>
<span class="lineno"></span><span class="op" id="2552777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552780">func</span>&nbsp;<span class="op" id="2552785">(</span><span class="ident" id="2552786">rr</span>&nbsp;<span class="op" id="2552789">*</span><span class="ident" id="2552790"><a href="/net/dnsmsg.go.html#2552584">dnsRR_SOA</a></span><span class="op" id="2552799">)</span>&nbsp;<span class="ident" id="2552801">Header</span><span class="op" id="2552807">(</span><span class="op" id="2552808">)</span>&nbsp;<span class="op" id="2552810">*</span><span class="ident" id="2552811"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2552824">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552827">return</span>&nbsp;<span class="op" id="2552834">&amp;</span><span class="ident" id="2552835"><a href="/net/dnsmsg.go.html#2552786">rr</a></span><span class="op" id="2552837">.</span><span class="ident" id="2552838">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2552842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552845">func</span>&nbsp;<span class="op" id="2552850">(</span><span class="ident" id="2552851">rr</span>&nbsp;<span class="op" id="2552854">*</span><span class="ident" id="2552855"><a href="/net/dnsmsg.go.html#2552584">dnsRR_SOA</a></span><span class="op" id="2552864">)</span>&nbsp;<span class="ident" id="2552866">Walk</span><span class="op" id="2552870">(</span><span class="ident" id="2552871">f</span>&nbsp;<span class="keyword" id="2552873">func</span><span class="op" id="2552877">(</span><span class="ident" id="2552878">v</span>&nbsp;<span class="keyword" id="2552880">interface</span><span class="op" id="2552889">{</span><span class="op" id="2552890">}</span><span class="op" id="2552891">,</span>&nbsp;<span class="ident" id="2552893">name</span><span class="op" id="2552897">,</span>&nbsp;<span class="ident" id="2552899">tag</span>&nbsp;<span class="builtintype" id="2552903">string</span><span class="op" id="2552909">)</span>&nbsp;<span class="builtintype" id="2552911">bool</span><span class="op" id="2552915">)</span>&nbsp;<span class="builtintype" id="2552917">bool</span>&nbsp;<span class="op" id="2552922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552925">return</span>&nbsp;<span class="ident" id="2552932"><a href="/net/dnsmsg.go.html#2552851">rr</a></span><span class="op" id="2552934">.</span><span class="ident" id="2552935">Hdr</span><span class="op" id="2552938">.</span><span class="ident" id="2552939">Walk</span><span class="op" id="2552943">(</span><span class="ident" id="2552944"><a href="/net/dnsmsg.go.html#2552871">f</a></span><span class="op" id="2552945">)</span>&nbsp;<span class="op" id="2552947">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552952"><a href="/net/dnsmsg.go.html#2552871">f</a></span><span class="op" id="2552953">(</span><span class="op" id="2552954">&amp;</span><span class="ident" id="2552955"><a href="/net/dnsmsg.go.html#2552851">rr</a></span><span class="op" id="2552957">.</span><span class="ident" id="2552958">Ns</span><span class="op" id="2552960">,</span>&nbsp;<span class="string" id="2552962">&#34;Ns&#34;</span><span class="op" id="2552966">,</span>&nbsp;<span class="string" id="2552968">&#34;domain&#34;</span><span class="op" id="2552976">)</span>&nbsp;<span class="op" id="2552978">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552983"><a href="/net/dnsmsg.go.html#2552871">f</a></span><span class="op" id="2552984">(</span><span class="op" id="2552985">&amp;</span><span class="ident" id="2552986"><a href="/net/dnsmsg.go.html#2552851">rr</a></span><span class="op" id="2552988">.</span><span class="ident" id="2552989">Mbox</span><span class="op" id="2552993">,</span>&nbsp;<span class="string" id="2552995">&#34;Mbox&#34;</span><span class="op" id="2553001">,</span>&nbsp;<span class="string" id="2553003">&#34;domain&#34;</span><span class="op" id="2553011">)</span>&nbsp;<span class="op" id="2553013">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553018"><a href="/net/dnsmsg.go.html#2552871">f</a></span><span class="op" id="2553019">(</span><span class="op" id="2553020">&amp;</span><span class="ident" id="2553021"><a href="/net/dnsmsg.go.html#2552851">rr</a></span><span class="op" id="2553023">.</span><span class="ident" id="2553024">Serial</span><span class="op" id="2553030">,</span>&nbsp;<span class="string" id="2553032">&#34;Serial&#34;</span><span class="op" id="2553040">,</span>&nbsp;<span class="string" id="2553042">&#34;&#34;</span><span class="op" id="2553044">)</span>&nbsp;<span class="op" id="2553046">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553051"><a href="/net/dnsmsg.go.html#2552871">f</a></span><span class="op" id="2553052">(</span><span class="op" id="2553053">&amp;</span><span class="ident" id="2553054"><a href="/net/dnsmsg.go.html#2552851">rr</a></span><span class="op" id="2553056">.</span><span class="ident" id="2553057">Refresh</span><span class="op" id="2553064">,</span>&nbsp;<span class="string" id="2553066">&#34;Refresh&#34;</span><span class="op" id="2553075">,</span>&nbsp;<span class="string" id="2553077">&#34;&#34;</span><span class="op" id="2553079">)</span>&nbsp;<span class="op" id="2553081">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553086"><a href="/net/dnsmsg.go.html#2552871">f</a></span><span class="op" id="2553087">(</span><span class="op" id="2553088">&amp;</span><span class="ident" id="2553089"><a href="/net/dnsmsg.go.html#2552851">rr</a></span><span class="op" id="2553091">.</span><span class="ident" id="2553092">Retry</span><span class="op" id="2553097">,</span>&nbsp;<span class="string" id="2553099">&#34;Retry&#34;</span><span class="op" id="2553106">,</span>&nbsp;<span class="string" id="2553108">&#34;&#34;</span><span class="op" id="2553110">)</span>&nbsp;<span class="op" id="2553112">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553117"><a href="/net/dnsmsg.go.html#2552871">f</a></span><span class="op" id="2553118">(</span><span class="op" id="2553119">&amp;</span><span class="ident" id="2553120"><a href="/net/dnsmsg.go.html#2552851">rr</a></span><span class="op" id="2553122">.</span><span class="ident" id="2553123">Expire</span><span class="op" id="2553129">,</span>&nbsp;<span class="string" id="2553131">&#34;Expire&#34;</span><span class="op" id="2553139">,</span>&nbsp;<span class="string" id="2553141">&#34;&#34;</span><span class="op" id="2553143">)</span>&nbsp;<span class="op" id="2553145">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553150"><a href="/net/dnsmsg.go.html#2552871">f</a></span><span class="op" id="2553151">(</span><span class="op" id="2553152">&amp;</span><span class="ident" id="2553153"><a href="/net/dnsmsg.go.html#2552851">rr</a></span><span class="op" id="2553155">.</span><span class="ident" id="2553156">Minttl</span><span class="op" id="2553162">,</span>&nbsp;<span class="string" id="2553164">&#34;Minttl&#34;</span><span class="op" id="2553172">,</span>&nbsp;<span class="string" id="2553174">&#34;&#34;</span><span class="op" id="2553176">)</span><br>
<span class="lineno"></span><span class="op" id="2553178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553181">type</span>&nbsp;<span class="ident" id="2553186">dnsRR_TXT</span>&nbsp;<span class="keyword" id="2553196">struct</span>&nbsp;<span class="op" id="2553203">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553206">Hdr</span>&nbsp;<span class="ident" id="2553210"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553224">Txt</span>&nbsp;<span class="builtintype" id="2553228">string</span>&nbsp;<span class="comment" id="2553235">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="2553254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553257">func</span>&nbsp;<span class="op" id="2553262">(</span><span class="ident" id="2553263">rr</span>&nbsp;<span class="op" id="2553266">*</span><span class="ident" id="2553267"><a href="/net/dnsmsg.go.html#2553186">dnsRR_TXT</a></span><span class="op" id="2553276">)</span>&nbsp;<span class="ident" id="2553278">Header</span><span class="op" id="2553284">(</span><span class="op" id="2553285">)</span>&nbsp;<span class="op" id="2553287">*</span><span class="ident" id="2553288"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2553301">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553304">return</span>&nbsp;<span class="op" id="2553311">&amp;</span><span class="ident" id="2553312"><a href="/net/dnsmsg.go.html#2553263">rr</a></span><span class="op" id="2553314">.</span><span class="ident" id="2553315">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2553319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553322">func</span>&nbsp;<span class="op" id="2553327">(</span><span class="ident" id="2553328">rr</span>&nbsp;<span class="op" id="2553331">*</span><span class="ident" id="2553332"><a href="/net/dnsmsg.go.html#2553186">dnsRR_TXT</a></span><span class="op" id="2553341">)</span>&nbsp;<span class="ident" id="2553343">Walk</span><span class="op" id="2553347">(</span><span class="ident" id="2553348">f</span>&nbsp;<span class="keyword" id="2553350">func</span><span class="op" id="2553354">(</span><span class="ident" id="2553355">v</span>&nbsp;<span class="keyword" id="2553357">interface</span><span class="op" id="2553366">{</span><span class="op" id="2553367">}</span><span class="op" id="2553368">,</span>&nbsp;<span class="ident" id="2553370">name</span><span class="op" id="2553374">,</span>&nbsp;<span class="ident" id="2553376">tag</span>&nbsp;<span class="builtintype" id="2553380">string</span><span class="op" id="2553386">)</span>&nbsp;<span class="builtintype" id="2553388">bool</span><span class="op" id="2553392">)</span>&nbsp;<span class="builtintype" id="2553394">bool</span>&nbsp;<span class="op" id="2553399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553402">return</span>&nbsp;<span class="ident" id="2553409"><a href="/net/dnsmsg.go.html#2553328">rr</a></span><span class="op" id="2553411">.</span><span class="ident" id="2553412">Hdr</span><span class="op" id="2553415">.</span><span class="ident" id="2553416">Walk</span><span class="op" id="2553420">(</span><span class="ident" id="2553421"><a href="/net/dnsmsg.go.html#2553348">f</a></span><span class="op" id="2553422">)</span>&nbsp;<span class="op" id="2553424">&amp;&amp;</span>&nbsp;<span class="ident" id="2553427"><a href="/net/dnsmsg.go.html#2553348">f</a></span><span class="op" id="2553428">(</span><span class="op" id="2553429">&amp;</span><span class="ident" id="2553430"><a href="/net/dnsmsg.go.html#2553328">rr</a></span><span class="op" id="2553432">.</span><span class="ident" id="2553433">Txt</span><span class="op" id="2553436">,</span>&nbsp;<span class="string" id="2553438">&#34;Txt&#34;</span><span class="op" id="2553443">,</span>&nbsp;<span class="string" id="2553445">&#34;&#34;</span><span class="op" id="2553447">)</span><br>
<span class="lineno">310</span><span class="op" id="2553449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553452">type</span>&nbsp;<span class="ident" id="2553457">dnsRR_SRV</span>&nbsp;<span class="keyword" id="2553467">struct</span>&nbsp;<span class="op" id="2553474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553477">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2553486"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553500">Priority</span>&nbsp;<span class="builtintype" id="2553509">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553517">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2553526">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553534">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2553543">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553551">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2553560">string</span>&nbsp;<span class="string" id="2553567">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2553587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="2553590">func</span>&nbsp;<span class="op" id="2553595">(</span><span class="ident" id="2553596">rr</span>&nbsp;<span class="op" id="2553599">*</span><span class="ident" id="2553600"><a href="/net/dnsmsg.go.html#2553457">dnsRR_SRV</a></span><span class="op" id="2553609">)</span>&nbsp;<span class="ident" id="2553611">Header</span><span class="op" id="2553617">(</span><span class="op" id="2553618">)</span>&nbsp;<span class="op" id="2553620">*</span><span class="ident" id="2553621"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2553634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553637">return</span>&nbsp;<span class="op" id="2553644">&amp;</span><span class="ident" id="2553645"><a href="/net/dnsmsg.go.html#2553596">rr</a></span><span class="op" id="2553647">.</span><span class="ident" id="2553648">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2553652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553655">func</span>&nbsp;<span class="op" id="2553660">(</span><span class="ident" id="2553661">rr</span>&nbsp;<span class="op" id="2553664">*</span><span class="ident" id="2553665"><a href="/net/dnsmsg.go.html#2553457">dnsRR_SRV</a></span><span class="op" id="2553674">)</span>&nbsp;<span class="ident" id="2553676">Walk</span><span class="op" id="2553680">(</span><span class="ident" id="2553681">f</span>&nbsp;<span class="keyword" id="2553683">func</span><span class="op" id="2553687">(</span><span class="ident" id="2553688">v</span>&nbsp;<span class="keyword" id="2553690">interface</span><span class="op" id="2553699">{</span><span class="op" id="2553700">}</span><span class="op" id="2553701">,</span>&nbsp;<span class="ident" id="2553703">name</span><span class="op" id="2553707">,</span>&nbsp;<span class="ident" id="2553709">tag</span>&nbsp;<span class="builtintype" id="2553713">string</span><span class="op" id="2553719">)</span>&nbsp;<span class="builtintype" id="2553721">bool</span><span class="op" id="2553725">)</span>&nbsp;<span class="builtintype" id="2553727">bool</span>&nbsp;<span class="op" id="2553732">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553735">return</span>&nbsp;<span class="ident" id="2553742"><a href="/net/dnsmsg.go.html#2553661">rr</a></span><span class="op" id="2553744">.</span><span class="ident" id="2553745">Hdr</span><span class="op" id="2553748">.</span><span class="ident" id="2553749">Walk</span><span class="op" id="2553753">(</span><span class="ident" id="2553754"><a href="/net/dnsmsg.go.html#2553681">f</a></span><span class="op" id="2553755">)</span>&nbsp;<span class="op" id="2553757">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553762"><a href="/net/dnsmsg.go.html#2553681">f</a></span><span class="op" id="2553763">(</span><span class="op" id="2553764">&amp;</span><span class="ident" id="2553765"><a href="/net/dnsmsg.go.html#2553661">rr</a></span><span class="op" id="2553767">.</span><span class="ident" id="2553768">Priority</span><span class="op" id="2553776">,</span>&nbsp;<span class="string" id="2553778">&#34;Priority&#34;</span><span class="op" id="2553788">,</span>&nbsp;<span class="string" id="2553790">&#34;&#34;</span><span class="op" id="2553792">)</span>&nbsp;<span class="op" id="2553794">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553799"><a href="/net/dnsmsg.go.html#2553681">f</a></span><span class="op" id="2553800">(</span><span class="op" id="2553801">&amp;</span><span class="ident" id="2553802"><a href="/net/dnsmsg.go.html#2553661">rr</a></span><span class="op" id="2553804">.</span><span class="ident" id="2553805">Weight</span><span class="op" id="2553811">,</span>&nbsp;<span class="string" id="2553813">&#34;Weight&#34;</span><span class="op" id="2553821">,</span>&nbsp;<span class="string" id="2553823">&#34;&#34;</span><span class="op" id="2553825">)</span>&nbsp;<span class="op" id="2553827">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553832"><a href="/net/dnsmsg.go.html#2553681">f</a></span><span class="op" id="2553833">(</span><span class="op" id="2553834">&amp;</span><span class="ident" id="2553835"><a href="/net/dnsmsg.go.html#2553661">rr</a></span><span class="op" id="2553837">.</span><span class="ident" id="2553838">Port</span><span class="op" id="2553842">,</span>&nbsp;<span class="string" id="2553844">&#34;Port&#34;</span><span class="op" id="2553850">,</span>&nbsp;<span class="string" id="2553852">&#34;&#34;</span><span class="op" id="2553854">)</span>&nbsp;<span class="op" id="2553856">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553861"><a href="/net/dnsmsg.go.html#2553681">f</a></span><span class="op" id="2553862">(</span><span class="op" id="2553863">&amp;</span><span class="ident" id="2553864"><a href="/net/dnsmsg.go.html#2553661">rr</a></span><span class="op" id="2553866">.</span><span class="ident" id="2553867">Target</span><span class="op" id="2553873">,</span>&nbsp;<span class="string" id="2553875">&#34;Target&#34;</span><span class="op" id="2553883">,</span>&nbsp;<span class="string" id="2553885">&#34;domain&#34;</span><span class="op" id="2553893">)</span><br>
<span class="lineno">330</span><span class="op" id="2553895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553898">type</span>&nbsp;<span class="ident" id="2553903">dnsRR_A</span>&nbsp;<span class="keyword" id="2553911">struct</span>&nbsp;<span class="op" id="2553918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553921">Hdr</span>&nbsp;<span class="ident" id="2553925"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553939">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2553943">uint32</span>&nbsp;<span class="string" id="2553950">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="2553963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553966">func</span>&nbsp;<span class="op" id="2553971">(</span><span class="ident" id="2553972">rr</span>&nbsp;<span class="op" id="2553975">*</span><span class="ident" id="2553976"><a href="/net/dnsmsg.go.html#2553903">dnsRR_A</a></span><span class="op" id="2553983">)</span>&nbsp;<span class="ident" id="2553985">Header</span><span class="op" id="2553991">(</span><span class="op" id="2553992">)</span>&nbsp;<span class="op" id="2553994">*</span><span class="ident" id="2553995"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2554008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554011">return</span>&nbsp;<span class="op" id="2554018">&amp;</span><span class="ident" id="2554019"><a href="/net/dnsmsg.go.html#2553972">rr</a></span><span class="op" id="2554021">.</span><span class="ident" id="2554022">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2554026">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="2554029">func</span>&nbsp;<span class="op" id="2554034">(</span><span class="ident" id="2554035">rr</span>&nbsp;<span class="op" id="2554038">*</span><span class="ident" id="2554039"><a href="/net/dnsmsg.go.html#2553903">dnsRR_A</a></span><span class="op" id="2554046">)</span>&nbsp;<span class="ident" id="2554048">Walk</span><span class="op" id="2554052">(</span><span class="ident" id="2554053">f</span>&nbsp;<span class="keyword" id="2554055">func</span><span class="op" id="2554059">(</span><span class="ident" id="2554060">v</span>&nbsp;<span class="keyword" id="2554062">interface</span><span class="op" id="2554071">{</span><span class="op" id="2554072">}</span><span class="op" id="2554073">,</span>&nbsp;<span class="ident" id="2554075">name</span><span class="op" id="2554079">,</span>&nbsp;<span class="ident" id="2554081">tag</span>&nbsp;<span class="builtintype" id="2554085">string</span><span class="op" id="2554091">)</span>&nbsp;<span class="builtintype" id="2554093">bool</span><span class="op" id="2554097">)</span>&nbsp;<span class="builtintype" id="2554099">bool</span>&nbsp;<span class="op" id="2554104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554107">return</span>&nbsp;<span class="ident" id="2554114"><a href="/net/dnsmsg.go.html#2554035">rr</a></span><span class="op" id="2554116">.</span><span class="ident" id="2554117">Hdr</span><span class="op" id="2554120">.</span><span class="ident" id="2554121">Walk</span><span class="op" id="2554125">(</span><span class="ident" id="2554126"><a href="/net/dnsmsg.go.html#2554053">f</a></span><span class="op" id="2554127">)</span>&nbsp;<span class="op" id="2554129">&amp;&amp;</span>&nbsp;<span class="ident" id="2554132"><a href="/net/dnsmsg.go.html#2554053">f</a></span><span class="op" id="2554133">(</span><span class="op" id="2554134">&amp;</span><span class="ident" id="2554135"><a href="/net/dnsmsg.go.html#2554035">rr</a></span><span class="op" id="2554137">.</span><span class="ident" id="2554138">A</span><span class="op" id="2554139">,</span>&nbsp;<span class="string" id="2554141">&#34;A&#34;</span><span class="op" id="2554144">,</span>&nbsp;<span class="string" id="2554146">&#34;ipv4&#34;</span><span class="op" id="2554152">)</span><br>
<span class="lineno"></span><span class="op" id="2554154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="2554157">type</span>&nbsp;<span class="ident" id="2554162">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="2554173">struct</span>&nbsp;<span class="op" id="2554180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554183">Hdr</span>&nbsp;&nbsp;<span class="ident" id="2554188"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554202">AAAA</span>&nbsp;<span class="op" id="2554207">[</span><span class="num" id="2554208">16</span><span class="op" id="2554210">]</span><span class="builtintype" id="2554211">byte</span>&nbsp;<span class="string" id="2554216">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2554229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="2554232">func</span>&nbsp;<span class="op" id="2554237">(</span><span class="ident" id="2554238">rr</span>&nbsp;<span class="op" id="2554241">*</span><span class="ident" id="2554242"><a href="/net/dnsmsg.go.html#2554162">dnsRR_AAAA</a></span><span class="op" id="2554252">)</span>&nbsp;<span class="ident" id="2554254">Header</span><span class="op" id="2554260">(</span><span class="op" id="2554261">)</span>&nbsp;<span class="op" id="2554263">*</span><span class="ident" id="2554264"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span>&nbsp;<span class="op" id="2554277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554280">return</span>&nbsp;<span class="op" id="2554287">&amp;</span><span class="ident" id="2554288"><a href="/net/dnsmsg.go.html#2554238">rr</a></span><span class="op" id="2554290">.</span><span class="ident" id="2554291">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2554295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554298">func</span>&nbsp;<span class="op" id="2554303">(</span><span class="ident" id="2554304">rr</span>&nbsp;<span class="op" id="2554307">*</span><span class="ident" id="2554308"><a href="/net/dnsmsg.go.html#2554162">dnsRR_AAAA</a></span><span class="op" id="2554318">)</span>&nbsp;<span class="ident" id="2554320">Walk</span><span class="op" id="2554324">(</span><span class="ident" id="2554325">f</span>&nbsp;<span class="keyword" id="2554327">func</span><span class="op" id="2554331">(</span><span class="ident" id="2554332">v</span>&nbsp;<span class="keyword" id="2554334">interface</span><span class="op" id="2554343">{</span><span class="op" id="2554344">}</span><span class="op" id="2554345">,</span>&nbsp;<span class="ident" id="2554347">name</span><span class="op" id="2554351">,</span>&nbsp;<span class="ident" id="2554353">tag</span>&nbsp;<span class="builtintype" id="2554357">string</span><span class="op" id="2554363">)</span>&nbsp;<span class="builtintype" id="2554365">bool</span><span class="op" id="2554369">)</span>&nbsp;<span class="builtintype" id="2554371">bool</span>&nbsp;<span class="op" id="2554376">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554379">return</span>&nbsp;<span class="ident" id="2554386"><a href="/net/dnsmsg.go.html#2554304">rr</a></span><span class="op" id="2554388">.</span><span class="ident" id="2554389">Hdr</span><span class="op" id="2554392">.</span><span class="ident" id="2554393">Walk</span><span class="op" id="2554397">(</span><span class="ident" id="2554398"><a href="/net/dnsmsg.go.html#2554325">f</a></span><span class="op" id="2554399">)</span>&nbsp;<span class="op" id="2554401">&amp;&amp;</span>&nbsp;<span class="ident" id="2554404"><a href="/net/dnsmsg.go.html#2554325">f</a></span><span class="op" id="2554405">(</span><span class="ident" id="2554406"><a href="/net/dnsmsg.go.html#2554304">rr</a></span><span class="op" id="2554408">.</span><span class="ident" id="2554409">AAAA</span><span class="op" id="2554413">[</span><span class="op" id="2554414">:</span><span class="op" id="2554415">]</span><span class="op" id="2554416">,</span>&nbsp;<span class="string" id="2554418">&#34;AAAA&#34;</span><span class="op" id="2554424">,</span>&nbsp;<span class="string" id="2554426">&#34;ipv6&#34;</span><span class="op" id="2554432">)</span><br>
<span class="lineno"></span><span class="op" id="2554434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2554437">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="2554463">//</span><br>
<span class="lineno">360</span><span class="comment" id="2554466">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2554528">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="2554595">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="2554657">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2554723">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="2554745">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2554791">var</span>&nbsp;<span class="ident" id="2554795">rr_mk</span>&nbsp;<span class="op" id="2554801">=</span>&nbsp;<span class="keyword" id="2554803">map</span><span class="op" id="2554806">[</span><span class="builtintype" id="2554807">int</span><span class="op" id="2554810">]</span><span class="keyword" id="2554811">func</span><span class="op" id="2554815">(</span><span class="op" id="2554816">)</span>&nbsp;<span class="ident" id="2554818"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><span class="op" id="2554823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554826"><a href="/net/dnsmsg.go.html#2546917">dnsTypeCNAME</a></span><span class="op" id="2554838">:</span>&nbsp;<span class="keyword" id="2554840">func</span><span class="op" id="2554844">(</span><span class="op" id="2554845">)</span>&nbsp;<span class="ident" id="2554847"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2554853">{</span>&nbsp;<span class="keyword" id="2554855">return</span>&nbsp;<span class="builtinfunc" id="2554862">new</span><span class="op" id="2554865">(</span><span class="ident" id="2554866"><a href="/net/dnsmsg.go.html#2549953">dnsRR_CNAME</a></span><span class="op" id="2554877">)</span>&nbsp;<span class="op" id="2554879">}</span><span class="op" id="2554880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554883"><a href="/net/dnsmsg.go.html#2547064">dnsTypeHINFO</a></span><span class="op" id="2554895">:</span>&nbsp;<span class="keyword" id="2554897">func</span><span class="op" id="2554901">(</span><span class="op" id="2554902">)</span>&nbsp;<span class="ident" id="2554904"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2554910">{</span>&nbsp;<span class="keyword" id="2554912">return</span>&nbsp;<span class="builtinfunc" id="2554919">new</span><span class="op" id="2554922">(</span><span class="ident" id="2554923"><a href="/net/dnsmsg.go.html#2550245">dnsRR_HINFO</a></span><span class="op" id="2554934">)</span>&nbsp;<span class="op" id="2554936">}</span><span class="op" id="2554937">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554940"><a href="/net/dnsmsg.go.html#2546953">dnsTypeMB</a></span><span class="op" id="2554949">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2554954">func</span><span class="op" id="2554958">(</span><span class="op" id="2554959">)</span>&nbsp;<span class="ident" id="2554961"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2554967">{</span>&nbsp;<span class="keyword" id="2554969">return</span>&nbsp;<span class="builtinfunc" id="2554976">new</span><span class="op" id="2554979">(</span><span class="ident" id="2554980"><a href="/net/dnsmsg.go.html#2550538">dnsRR_MB</a></span><span class="op" id="2554988">)</span>&nbsp;<span class="op" id="2554990">}</span><span class="op" id="2554991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554994"><a href="/net/dnsmsg.go.html#2546971">dnsTypeMG</a></span><span class="op" id="2555003">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555008">func</span><span class="op" id="2555012">(</span><span class="op" id="2555013">)</span>&nbsp;<span class="ident" id="2555015"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555021">{</span>&nbsp;<span class="keyword" id="2555023">return</span>&nbsp;<span class="builtinfunc" id="2555030">new</span><span class="op" id="2555033">(</span><span class="ident" id="2555034"><a href="/net/dnsmsg.go.html#2550811">dnsRR_MG</a></span><span class="op" id="2555042">)</span>&nbsp;<span class="op" id="2555044">}</span><span class="op" id="2555045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555048"><a href="/net/dnsmsg.go.html#2547083">dnsTypeMINFO</a></span><span class="op" id="2555060">:</span>&nbsp;<span class="keyword" id="2555062">func</span><span class="op" id="2555066">(</span><span class="op" id="2555067">)</span>&nbsp;<span class="ident" id="2555069"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555075">{</span>&nbsp;<span class="keyword" id="2555077">return</span>&nbsp;<span class="builtinfunc" id="2555084">new</span><span class="op" id="2555087">(</span><span class="ident" id="2555088"><a href="/net/dnsmsg.go.html#2551084">dnsRR_MINFO</a></span><span class="op" id="2555099">)</span>&nbsp;<span class="op" id="2555101">}</span><span class="op" id="2555102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555105"><a href="/net/dnsmsg.go.html#2546989">dnsTypeMR</a></span><span class="op" id="2555114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555119">func</span><span class="op" id="2555123">(</span><span class="op" id="2555124">)</span>&nbsp;<span class="ident" id="2555126"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555132">{</span>&nbsp;<span class="keyword" id="2555134">return</span>&nbsp;<span class="builtinfunc" id="2555141">new</span><span class="op" id="2555144">(</span><span class="ident" id="2555145"><a href="/net/dnsmsg.go.html#2551445">dnsRR_MR</a></span><span class="op" id="2555153">)</span>&nbsp;<span class="op" id="2555155">}</span><span class="op" id="2555156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555159"><a href="/net/dnsmsg.go.html#2547102">dnsTypeMX</a></span><span class="op" id="2555168">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555173">func</span><span class="op" id="2555177">(</span><span class="op" id="2555178">)</span>&nbsp;<span class="ident" id="2555180"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555186">{</span>&nbsp;<span class="keyword" id="2555188">return</span>&nbsp;<span class="builtinfunc" id="2555195">new</span><span class="op" id="2555198">(</span><span class="ident" id="2555199"><a href="/net/dnsmsg.go.html#2551718">dnsRR_MX</a></span><span class="op" id="2555207">)</span>&nbsp;<span class="op" id="2555209">}</span><span class="op" id="2555210">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555213"><a href="/net/dnsmsg.go.html#2546863">dnsTypeNS</a></span><span class="op" id="2555222">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555227">func</span><span class="op" id="2555231">(</span><span class="op" id="2555232">)</span>&nbsp;<span class="ident" id="2555234"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555240">{</span>&nbsp;<span class="keyword" id="2555242">return</span>&nbsp;<span class="builtinfunc" id="2555249">new</span><span class="op" id="2555252">(</span><span class="ident" id="2555253"><a href="/net/dnsmsg.go.html#2552033">dnsRR_NS</a></span><span class="op" id="2555261">)</span>&nbsp;<span class="op" id="2555263">}</span><span class="op" id="2555264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555267"><a href="/net/dnsmsg.go.html#2547045">dnsTypePTR</a></span><span class="op" id="2555277">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555281">func</span><span class="op" id="2555285">(</span><span class="op" id="2555286">)</span>&nbsp;<span class="ident" id="2555288"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555294">{</span>&nbsp;<span class="keyword" id="2555296">return</span>&nbsp;<span class="builtinfunc" id="2555303">new</span><span class="op" id="2555306">(</span><span class="ident" id="2555307"><a href="/net/dnsmsg.go.html#2552306">dnsRR_PTR</a></span><span class="op" id="2555316">)</span>&nbsp;<span class="op" id="2555318">}</span><span class="op" id="2555319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555322"><a href="/net/dnsmsg.go.html#2546935">dnsTypeSOA</a></span><span class="op" id="2555332">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555336">func</span><span class="op" id="2555340">(</span><span class="op" id="2555341">)</span>&nbsp;<span class="ident" id="2555343"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555349">{</span>&nbsp;<span class="keyword" id="2555351">return</span>&nbsp;<span class="builtinfunc" id="2555358">new</span><span class="op" id="2555361">(</span><span class="ident" id="2555362"><a href="/net/dnsmsg.go.html#2552584">dnsRR_SOA</a></span><span class="op" id="2555371">)</span>&nbsp;<span class="op" id="2555373">}</span><span class="op" id="2555374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555377"><a href="/net/dnsmsg.go.html#2547121">dnsTypeTXT</a></span><span class="op" id="2555387">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555391">func</span><span class="op" id="2555395">(</span><span class="op" id="2555396">)</span>&nbsp;<span class="ident" id="2555398"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555404">{</span>&nbsp;<span class="keyword" id="2555406">return</span>&nbsp;<span class="builtinfunc" id="2555413">new</span><span class="op" id="2555416">(</span><span class="ident" id="2555417"><a href="/net/dnsmsg.go.html#2553186">dnsRR_TXT</a></span><span class="op" id="2555426">)</span>&nbsp;<span class="op" id="2555428">}</span><span class="op" id="2555429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555432"><a href="/net/dnsmsg.go.html#2547159">dnsTypeSRV</a></span><span class="op" id="2555442">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555446">func</span><span class="op" id="2555450">(</span><span class="op" id="2555451">)</span>&nbsp;<span class="ident" id="2555453"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555459">{</span>&nbsp;<span class="keyword" id="2555461">return</span>&nbsp;<span class="builtinfunc" id="2555468">new</span><span class="op" id="2555471">(</span><span class="ident" id="2555472"><a href="/net/dnsmsg.go.html#2553457">dnsRR_SRV</a></span><span class="op" id="2555481">)</span>&nbsp;<span class="op" id="2555483">}</span><span class="op" id="2555484">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555487"><a href="/net/dnsmsg.go.html#2546845">dnsTypeA</a></span><span class="op" id="2555495">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2555501">func</span><span class="op" id="2555505">(</span><span class="op" id="2555506">)</span>&nbsp;<span class="ident" id="2555508"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555514">{</span>&nbsp;<span class="keyword" id="2555516">return</span>&nbsp;<span class="builtinfunc" id="2555523">new</span><span class="op" id="2555526">(</span><span class="ident" id="2555527"><a href="/net/dnsmsg.go.html#2553903">dnsRR_A</a></span><span class="op" id="2555534">)</span>&nbsp;<span class="op" id="2555536">}</span><span class="op" id="2555537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555540"><a href="/net/dnsmsg.go.html#2547140">dnsTypeAAAA</a></span><span class="op" id="2555551">:</span>&nbsp;&nbsp;<span class="keyword" id="2555554">func</span><span class="op" id="2555558">(</span><span class="op" id="2555559">)</span>&nbsp;<span class="ident" id="2555561"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span>&nbsp;<span class="op" id="2555567">{</span>&nbsp;<span class="keyword" id="2555569">return</span>&nbsp;<span class="builtinfunc" id="2555576">new</span><span class="op" id="2555579">(</span><span class="ident" id="2555580"><a href="/net/dnsmsg.go.html#2554162">dnsRR_AAAA</a></span><span class="op" id="2555590">)</span>&nbsp;<span class="op" id="2555592">}</span><span class="op" id="2555593">,</span><br>
<span class="lineno"></span><span class="op" id="2555595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2555598">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="2555638">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2555688">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2555747">func</span>&nbsp;<span class="ident" id="2555752">packDomainName</span><span class="op" id="2555766">(</span><span class="ident" id="2555767">s</span>&nbsp;<span class="builtintype" id="2555769">string</span><span class="op" id="2555775">,</span>&nbsp;<span class="ident" id="2555777">msg</span>&nbsp;<span class="op" id="2555781">[</span><span class="op" id="2555782">]</span><span class="builtintype" id="2555783">byte</span><span class="op" id="2555787">,</span>&nbsp;<span class="ident" id="2555789">off</span>&nbsp;<span class="builtintype" id="2555793">int</span><span class="op" id="2555796">)</span>&nbsp;<span class="op" id="2555798">(</span><span class="ident" id="2555799">off1</span>&nbsp;<span class="builtintype" id="2555804">int</span><span class="op" id="2555807">,</span>&nbsp;<span class="ident" id="2555809">ok</span>&nbsp;<span class="builtintype" id="2555812">bool</span><span class="op" id="2555816">)</span>&nbsp;<span class="op" id="2555818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555821">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555864">if</span>&nbsp;<span class="ident" id="2555867">n</span>&nbsp;<span class="op" id="2555869">:=</span>&nbsp;<span class="builtinfunc" id="2555872">len</span><span class="op" id="2555875">(</span><span class="ident" id="2555876"><a href="/net/dnsmsg.go.html#2555767">s</a></span><span class="op" id="2555877">)</span><span class="op" id="2555878">;</span>&nbsp;<span class="ident" id="2555880"><a href="/net/dnsmsg.go.html#2555867">n</a></span>&nbsp;<span class="op" id="2555882">==</span>&nbsp;<span class="num" id="2555885">0</span>&nbsp;<span class="op" id="2555887">||</span>&nbsp;<span class="ident" id="2555890"><a href="/net/dnsmsg.go.html#2555767">s</a></span><span class="op" id="2555891">[</span><span class="ident" id="2555892"><a href="/net/dnsmsg.go.html#2555867">n</a></span><span class="op" id="2555893">-</span><span class="num" id="2555894">1</span><span class="op" id="2555895">]</span>&nbsp;<span class="op" id="2555897">!=</span>&nbsp;<span class="string" id="2555900">&#39;.&#39;</span>&nbsp;<span class="op" id="2555904">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555908"><a href="/net/dnsmsg.go.html#2555767">s</a></span>&nbsp;<span class="op" id="2555910">+=</span>&nbsp;<span class="string" id="2555913">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2555918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555922">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555963">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556009">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556044">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556090">tot</span>&nbsp;<span class="op" id="2556094">:=</span>&nbsp;<span class="builtinfunc" id="2556097">len</span><span class="op" id="2556100">(</span><span class="ident" id="2556101"><a href="/net/dnsmsg.go.html#2555767">s</a></span><span class="op" id="2556102">)</span>&nbsp;<span class="op" id="2556104">+</span>&nbsp;<span class="num" id="2556106">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556109">if</span>&nbsp;<span class="ident" id="2556112"><a href="/net/dnsmsg.go.html#2555789">off</a></span><span class="op" id="2556115">+</span><span class="ident" id="2556116"><a href="/net/dnsmsg.go.html#2556090">tot</a></span>&nbsp;<span class="op" id="2556120">&gt;</span>&nbsp;<span class="builtinfunc" id="2556122">len</span><span class="op" id="2556125">(</span><span class="ident" id="2556126"><a href="/net/dnsmsg.go.html#2555777">msg</a></span><span class="op" id="2556129">)</span>&nbsp;<span class="op" id="2556131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556135">return</span>&nbsp;<span class="builtinfunc" id="2556142">len</span><span class="op" id="2556145">(</span><span class="ident" id="2556146"><a href="/net/dnsmsg.go.html#2555777">msg</a></span><span class="op" id="2556149">)</span><span class="op" id="2556150">,</span>&nbsp;<span class="ident" id="2556152">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556163">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556219">begin</span>&nbsp;<span class="op" id="2556225">:=</span>&nbsp;<span class="num" id="2556228">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556231">for</span>&nbsp;<span class="ident" id="2556235">i</span>&nbsp;<span class="op" id="2556237">:=</span>&nbsp;<span class="num" id="2556240">0</span><span class="op" id="2556241">;</span>&nbsp;<span class="ident" id="2556243"><a href="/net/dnsmsg.go.html#2556235">i</a></span>&nbsp;<span class="op" id="2556245">&lt;</span>&nbsp;<span class="builtinfunc" id="2556247">len</span><span class="op" id="2556250">(</span><span class="ident" id="2556251"><a href="/net/dnsmsg.go.html#2555767">s</a></span><span class="op" id="2556252">)</span><span class="op" id="2556253">;</span>&nbsp;<span class="ident" id="2556255"><a href="/net/dnsmsg.go.html#2556235">i</a></span><span class="op" id="2556256">++</span>&nbsp;<span class="op" id="2556259">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556263">if</span>&nbsp;<span class="ident" id="2556266"><a href="/net/dnsmsg.go.html#2555767">s</a></span><span class="op" id="2556267">[</span><span class="ident" id="2556268"><a href="/net/dnsmsg.go.html#2556235">i</a></span><span class="op" id="2556269">]</span>&nbsp;<span class="op" id="2556271">==</span>&nbsp;<span class="string" id="2556274">&#39;.&#39;</span>&nbsp;<span class="op" id="2556278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556283">if</span>&nbsp;<span class="ident" id="2556286"><a href="/net/dnsmsg.go.html#2556235">i</a></span><span class="op" id="2556287">-</span><span class="ident" id="2556288"><a href="/net/dnsmsg.go.html#2556219">begin</a></span>&nbsp;<span class="op" id="2556294">&gt;=</span>&nbsp;<span class="num" id="2556297">1</span><span class="op" id="2556298">&lt;&lt;</span><span class="num" id="2556300">6</span>&nbsp;<span class="op" id="2556302">{</span>&nbsp;<span class="comment" id="2556304">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556348">return</span>&nbsp;<span class="builtinfunc" id="2556355">len</span><span class="op" id="2556358">(</span><span class="ident" id="2556359"><a href="/net/dnsmsg.go.html#2555777">msg</a></span><span class="op" id="2556362">)</span><span class="op" id="2556363">,</span>&nbsp;<span class="ident" id="2556365">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556379"><a href="/net/dnsmsg.go.html#2555777">msg</a></span><span class="op" id="2556382">[</span><span class="ident" id="2556383"><a href="/net/dnsmsg.go.html#2555789">off</a></span><span class="op" id="2556386">]</span>&nbsp;<span class="op" id="2556388">=</span>&nbsp;<span class="builtintype" id="2556390">byte</span><span class="op" id="2556394">(</span><span class="ident" id="2556395"><a href="/net/dnsmsg.go.html#2556235">i</a></span>&nbsp;<span class="op" id="2556397">-</span>&nbsp;<span class="ident" id="2556399"><a href="/net/dnsmsg.go.html#2556219">begin</a></span><span class="op" id="2556404">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556409"><a href="/net/dnsmsg.go.html#2555789">off</a></span><span class="op" id="2556412">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556418">for</span>&nbsp;<span class="ident" id="2556422">j</span>&nbsp;<span class="op" id="2556424">:=</span>&nbsp;<span class="ident" id="2556427"><a href="/net/dnsmsg.go.html#2556219">begin</a></span><span class="op" id="2556432">;</span>&nbsp;<span class="ident" id="2556434"><a href="/net/dnsmsg.go.html#2556422">j</a></span>&nbsp;<span class="op" id="2556436">&lt;</span>&nbsp;<span class="ident" id="2556438"><a href="/net/dnsmsg.go.html#2556235">i</a></span><span class="op" id="2556439">;</span>&nbsp;<span class="ident" id="2556441"><a href="/net/dnsmsg.go.html#2556422">j</a></span><span class="op" id="2556442">++</span>&nbsp;<span class="op" id="2556445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556451"><a href="/net/dnsmsg.go.html#2555777">msg</a></span><span class="op" id="2556454">[</span><span class="ident" id="2556455"><a href="/net/dnsmsg.go.html#2555789">off</a></span><span class="op" id="2556458">]</span>&nbsp;<span class="op" id="2556460">=</span>&nbsp;<span class="ident" id="2556462"><a href="/net/dnsmsg.go.html#2555767">s</a></span><span class="op" id="2556463">[</span><span class="ident" id="2556464"><a href="/net/dnsmsg.go.html#2556422">j</a></span><span class="op" id="2556465">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556471"><a href="/net/dnsmsg.go.html#2555789">off</a></span><span class="op" id="2556474">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556480">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556485"><a href="/net/dnsmsg.go.html#2556219">begin</a></span>&nbsp;<span class="op" id="2556491">=</span>&nbsp;<span class="ident" id="2556493"><a href="/net/dnsmsg.go.html#2556235">i</a></span>&nbsp;<span class="op" id="2556495">+</span>&nbsp;<span class="num" id="2556497">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556507"><a href="/net/dnsmsg.go.html#2555777">msg</a></span><span class="op" id="2556510">[</span><span class="ident" id="2556511"><a href="/net/dnsmsg.go.html#2555789">off</a></span><span class="op" id="2556514">]</span>&nbsp;<span class="op" id="2556516">=</span>&nbsp;<span class="num" id="2556518">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556521"><a href="/net/dnsmsg.go.html#2555789">off</a></span><span class="op" id="2556524">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556528">return</span>&nbsp;<span class="ident" id="2556535"><a href="/net/dnsmsg.go.html#2555789">off</a></span><span class="op" id="2556538">,</span>&nbsp;<span class="ident" id="2556540">true</span><br>
<span class="lineno"></span><span class="op" id="2556545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2556548">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="2556573">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="2556638">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2556703">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="2556764">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="2556825">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="2556888">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="2556957">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="2556995">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="2557044">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="2557110">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="2557156">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="2557218">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="2557279">func</span>&nbsp;<span class="ident" id="2557284">unpackDomainName</span><span class="op" id="2557300">(</span><span class="ident" id="2557301">msg</span>&nbsp;<span class="op" id="2557305">[</span><span class="op" id="2557306">]</span><span class="builtintype" id="2557307">byte</span><span class="op" id="2557311">,</span>&nbsp;<span class="ident" id="2557313">off</span>&nbsp;<span class="builtintype" id="2557317">int</span><span class="op" id="2557320">)</span>&nbsp;<span class="op" id="2557322">(</span><span class="ident" id="2557323">s</span>&nbsp;<span class="builtintype" id="2557325">string</span><span class="op" id="2557331">,</span>&nbsp;<span class="ident" id="2557333">off1</span>&nbsp;<span class="builtintype" id="2557338">int</span><span class="op" id="2557341">,</span>&nbsp;<span class="ident" id="2557343">ok</span>&nbsp;<span class="builtintype" id="2557346">bool</span><span class="op" id="2557350">)</span>&nbsp;<span class="op" id="2557352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557355"><a href="/net/dnsmsg.go.html#2557323">s</a></span>&nbsp;<span class="op" id="2557357">=</span>&nbsp;<span class="string" id="2557359">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557363">ptr</span>&nbsp;<span class="op" id="2557367">:=</span>&nbsp;<span class="num" id="2557370">0</span>&nbsp;<span class="comment" id="2557372">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="2557403">Loop</span><span class="op" id="2557407">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557410">for</span>&nbsp;<span class="op" id="2557414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557418">if</span>&nbsp;<span class="ident" id="2557421"><a href="/net/dnsmsg.go.html#2557313">off</a></span>&nbsp;<span class="op" id="2557425">&gt;=</span>&nbsp;<span class="builtinfunc" id="2557428">len</span><span class="op" id="2557431">(</span><span class="ident" id="2557432"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2557435">)</span>&nbsp;<span class="op" id="2557437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557442">return</span>&nbsp;<span class="string" id="2557449">&#34;&#34;</span><span class="op" id="2557451">,</span>&nbsp;<span class="builtinfunc" id="2557453">len</span><span class="op" id="2557456">(</span><span class="ident" id="2557457"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2557460">)</span><span class="op" id="2557461">,</span>&nbsp;<span class="ident" id="2557463">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2557471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557475">c</span>&nbsp;<span class="op" id="2557477">:=</span>&nbsp;<span class="builtintype" id="2557480">int</span><span class="op" id="2557483">(</span><span class="ident" id="2557484"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2557487">[</span><span class="ident" id="2557488"><a href="/net/dnsmsg.go.html#2557313">off</a></span><span class="op" id="2557491">]</span><span class="op" id="2557492">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557496"><a href="/net/dnsmsg.go.html#2557313">off</a></span><span class="op" id="2557499">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557504">switch</span>&nbsp;<span class="ident" id="2557511"><a href="/net/dnsmsg.go.html#2557475">c</a></span>&nbsp;<span class="op" id="2557513">&amp;</span>&nbsp;<span class="num" id="2557515">0xC0</span>&nbsp;<span class="op" id="2557520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557524">case</span>&nbsp;<span class="num" id="2557529">0x00</span><span class="op" id="2557533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557538">if</span>&nbsp;<span class="ident" id="2557541"><a href="/net/dnsmsg.go.html#2557475">c</a></span>&nbsp;<span class="op" id="2557543">==</span>&nbsp;<span class="num" id="2557546">0x00</span>&nbsp;<span class="op" id="2557551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557557">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557576">break</span>&nbsp;<span class="ident" id="2557582">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2557590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557595">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557616">if</span>&nbsp;<span class="ident" id="2557619"><a href="/net/dnsmsg.go.html#2557313">off</a></span><span class="op" id="2557622">+</span><span class="ident" id="2557623"><a href="/net/dnsmsg.go.html#2557475">c</a></span>&nbsp;<span class="op" id="2557625">&gt;</span>&nbsp;<span class="builtinfunc" id="2557627">len</span><span class="op" id="2557630">(</span><span class="ident" id="2557631"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2557634">)</span>&nbsp;<span class="op" id="2557636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557642">return</span>&nbsp;<span class="string" id="2557649">&#34;&#34;</span><span class="op" id="2557651">,</span>&nbsp;<span class="builtinfunc" id="2557653">len</span><span class="op" id="2557656">(</span><span class="ident" id="2557657"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2557660">)</span><span class="op" id="2557661">,</span>&nbsp;<span class="ident" id="2557663">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2557672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557677"><a href="/net/dnsmsg.go.html#2557323">s</a></span>&nbsp;<span class="op" id="2557679">+=</span>&nbsp;<span class="builtintype" id="2557682">string</span><span class="op" id="2557688">(</span><span class="ident" id="2557689"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2557692">[</span><span class="ident" id="2557693"><a href="/net/dnsmsg.go.html#2557313">off</a></span><span class="op" id="2557696">:</span><span class="ident" id="2557697"><a href="/net/dnsmsg.go.html#2557313">off</a></span><span class="op" id="2557700">+</span><span class="ident" id="2557701"><a href="/net/dnsmsg.go.html#2557475">c</a></span><span class="op" id="2557702">]</span><span class="op" id="2557703">)</span>&nbsp;<span class="op" id="2557705">+</span>&nbsp;<span class="string" id="2557707">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557714"><a href="/net/dnsmsg.go.html#2557313">off</a></span>&nbsp;<span class="op" id="2557718">+=</span>&nbsp;<span class="ident" id="2557721"><a href="/net/dnsmsg.go.html#2557475">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557725">case</span>&nbsp;<span class="num" id="2557730">0xC0</span><span class="op" id="2557734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557739">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557779">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557820">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557867">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557913">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557941">if</span>&nbsp;<span class="ident" id="2557944"><a href="/net/dnsmsg.go.html#2557313">off</a></span>&nbsp;<span class="op" id="2557948">&gt;=</span>&nbsp;<span class="builtinfunc" id="2557951">len</span><span class="op" id="2557954">(</span><span class="ident" id="2557955"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2557958">)</span>&nbsp;<span class="op" id="2557960">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557966">return</span>&nbsp;<span class="string" id="2557973">&#34;&#34;</span><span class="op" id="2557975">,</span>&nbsp;<span class="builtinfunc" id="2557977">len</span><span class="op" id="2557980">(</span><span class="ident" id="2557981"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2557984">)</span><span class="op" id="2557985">,</span>&nbsp;<span class="ident" id="2557987">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2557996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558001">c1</span>&nbsp;<span class="op" id="2558004">:=</span>&nbsp;<span class="ident" id="2558007"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2558010">[</span><span class="ident" id="2558011"><a href="/net/dnsmsg.go.html#2557313">off</a></span><span class="op" id="2558014">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558019"><a href="/net/dnsmsg.go.html#2557313">off</a></span><span class="op" id="2558022">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558028">if</span>&nbsp;<span class="ident" id="2558031"><a href="/net/dnsmsg.go.html#2557363">ptr</a></span>&nbsp;<span class="op" id="2558035">==</span>&nbsp;<span class="num" id="2558038">0</span>&nbsp;<span class="op" id="2558040">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558046"><a href="/net/dnsmsg.go.html#2557333">off1</a></span>&nbsp;<span class="op" id="2558051">=</span>&nbsp;<span class="ident" id="2558053"><a href="/net/dnsmsg.go.html#2557313">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558065">if</span>&nbsp;<span class="ident" id="2558068"><a href="/net/dnsmsg.go.html#2557363">ptr</a></span><span class="op" id="2558071">++</span><span class="op" id="2558073">;</span>&nbsp;<span class="ident" id="2558075"><a href="/net/dnsmsg.go.html#2557363">ptr</a></span>&nbsp;<span class="op" id="2558079">&gt;</span>&nbsp;<span class="num" id="2558081">10</span>&nbsp;<span class="op" id="2558084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558090">return</span>&nbsp;<span class="string" id="2558097">&#34;&#34;</span><span class="op" id="2558099">,</span>&nbsp;<span class="builtinfunc" id="2558101">len</span><span class="op" id="2558104">(</span><span class="ident" id="2558105"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2558108">)</span><span class="op" id="2558109">,</span>&nbsp;<span class="ident" id="2558111">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558120">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558125"><a href="/net/dnsmsg.go.html#2557313">off</a></span>&nbsp;<span class="op" id="2558129">=</span>&nbsp;<span class="op" id="2558131">(</span><span class="ident" id="2558132"><a href="/net/dnsmsg.go.html#2557475">c</a></span><span class="op" id="2558133">^</span><span class="num" id="2558134">0xC0</span><span class="op" id="2558138">)</span><span class="op" id="2558139">&lt;&lt;</span><span class="num" id="2558141">8</span>&nbsp;<span class="op" id="2558143">|</span>&nbsp;<span class="builtintype" id="2558145">int</span><span class="op" id="2558148">(</span><span class="ident" id="2558149"><a href="/net/dnsmsg.go.html#2558001">c1</a></span><span class="op" id="2558151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558155">default</span><span class="op" id="2558162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558167">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558200">return</span>&nbsp;<span class="string" id="2558207">&#34;&#34;</span><span class="op" id="2558209">,</span>&nbsp;<span class="builtinfunc" id="2558211">len</span><span class="op" id="2558214">(</span><span class="ident" id="2558215"><a href="/net/dnsmsg.go.html#2557301">msg</a></span><span class="op" id="2558218">)</span><span class="op" id="2558219">,</span>&nbsp;<span class="ident" id="2558221">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558229">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558235">if</span>&nbsp;<span class="ident" id="2558238"><a href="/net/dnsmsg.go.html#2557363">ptr</a></span>&nbsp;<span class="op" id="2558242">==</span>&nbsp;<span class="num" id="2558245">0</span>&nbsp;<span class="op" id="2558247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558251"><a href="/net/dnsmsg.go.html#2557333">off1</a></span>&nbsp;<span class="op" id="2558256">=</span>&nbsp;<span class="ident" id="2558258"><a href="/net/dnsmsg.go.html#2557313">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558266">return</span>&nbsp;<span class="ident" id="2558273"><a href="/net/dnsmsg.go.html#2557323">s</a></span><span class="op" id="2558274">,</span>&nbsp;<span class="ident" id="2558276"><a href="/net/dnsmsg.go.html#2557333">off1</a></span><span class="op" id="2558280">,</span>&nbsp;<span class="ident" id="2558282">true</span><br>
<span class="lineno">485</span><span class="op" id="2558287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2558290">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2558360">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="2558421">func</span>&nbsp;<span class="ident" id="2558426">packStruct</span><span class="op" id="2558436">(</span><span class="ident" id="2558437">any</span>&nbsp;<span class="ident" id="2558441"><a href="/net/dnsmsg.go.html#2547711">dnsStruct</a></span><span class="op" id="2558450">,</span>&nbsp;<span class="ident" id="2558452">msg</span>&nbsp;<span class="op" id="2558456">[</span><span class="op" id="2558457">]</span><span class="builtintype" id="2558458">byte</span><span class="op" id="2558462">,</span>&nbsp;<span class="ident" id="2558464">off</span>&nbsp;<span class="builtintype" id="2558468">int</span><span class="op" id="2558471">)</span>&nbsp;<span class="op" id="2558473">(</span><span class="ident" id="2558474">off1</span>&nbsp;<span class="builtintype" id="2558479">int</span><span class="op" id="2558482">,</span>&nbsp;<span class="ident" id="2558484">ok</span>&nbsp;<span class="builtintype" id="2558487">bool</span><span class="op" id="2558491">)</span>&nbsp;<span class="op" id="2558493">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558496"><a href="/net/dnsmsg.go.html#2558484">ok</a></span>&nbsp;<span class="op" id="2558499">=</span>&nbsp;<span class="ident" id="2558501"><a href="/net/dnsmsg.go.html#2558437">any</a></span><span class="op" id="2558504">.</span><span class="ident" id="2558505">Walk</span><span class="op" id="2558509">(</span><span class="keyword" id="2558510">func</span><span class="op" id="2558514">(</span><span class="ident" id="2558515">field</span>&nbsp;<span class="keyword" id="2558521">interface</span><span class="op" id="2558530">{</span><span class="op" id="2558531">}</span><span class="op" id="2558532">,</span>&nbsp;<span class="ident" id="2558534">name</span><span class="op" id="2558538">,</span>&nbsp;<span class="ident" id="2558540">tag</span>&nbsp;<span class="builtintype" id="2558544">string</span><span class="op" id="2558550">)</span>&nbsp;<span class="builtintype" id="2558552">bool</span>&nbsp;<span class="op" id="2558557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558561">switch</span>&nbsp;<span class="ident" id="2558568">fv</span>&nbsp;<span class="op" id="2558571">:=</span>&nbsp;<span class="ident" id="2558574"><a href="/net/dnsmsg.go.html#2558515">field</a></span><span class="op" id="2558579">.</span><span class="op" id="2558580">(</span><span class="keyword" id="2558581">type</span><span class="op" id="2558585">)</span>&nbsp;<span class="op" id="2558587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558591">default</span><span class="op" id="2558598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2558603">println</span><span class="op" id="2558610">(</span><span class="string" id="2558611">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="2558643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558648">return</span>&nbsp;<span class="ident" id="2558655">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558663">case</span>&nbsp;<span class="op" id="2558668">*</span><span class="builtintype" id="2558669">uint16</span><span class="op" id="2558675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558680">i</span>&nbsp;<span class="op" id="2558682">:=</span>&nbsp;<span class="op" id="2558685">*</span><span class="ident" id="2558686"><a href="/net/dnsmsg.go.html#2558568">fv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558692">if</span>&nbsp;<span class="ident" id="2558695"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2558698">+</span><span class="num" id="2558699">2</span>&nbsp;<span class="op" id="2558701">&gt;</span>&nbsp;<span class="builtinfunc" id="2558703">len</span><span class="op" id="2558706">(</span><span class="ident" id="2558707"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2558710">)</span>&nbsp;<span class="op" id="2558712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558718">return</span>&nbsp;<span class="ident" id="2558725">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558734">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558739"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2558742">[</span><span class="ident" id="2558743"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2558746">]</span>&nbsp;<span class="op" id="2558748">=</span>&nbsp;<span class="builtintype" id="2558750">byte</span><span class="op" id="2558754">(</span><span class="ident" id="2558755"><a href="/net/dnsmsg.go.html#2558680">i</a></span>&nbsp;<span class="op" id="2558757">&gt;&gt;</span>&nbsp;<span class="num" id="2558760">8</span><span class="op" id="2558761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558766"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2558769">[</span><span class="ident" id="2558770"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2558773">+</span><span class="num" id="2558774">1</span><span class="op" id="2558775">]</span>&nbsp;<span class="op" id="2558777">=</span>&nbsp;<span class="builtintype" id="2558779">byte</span><span class="op" id="2558783">(</span><span class="ident" id="2558784"><a href="/net/dnsmsg.go.html#2558680">i</a></span><span class="op" id="2558785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558790"><a href="/net/dnsmsg.go.html#2558464">off</a></span>&nbsp;<span class="op" id="2558794">+=</span>&nbsp;<span class="num" id="2558797">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558801">case</span>&nbsp;<span class="op" id="2558806">*</span><span class="builtintype" id="2558807">uint32</span><span class="op" id="2558813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558818">i</span>&nbsp;<span class="op" id="2558820">:=</span>&nbsp;<span class="op" id="2558823">*</span><span class="ident" id="2558824"><a href="/net/dnsmsg.go.html#2558568">fv</a></span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558830"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2558833">[</span><span class="ident" id="2558834"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2558837">]</span>&nbsp;<span class="op" id="2558839">=</span>&nbsp;<span class="builtintype" id="2558841">byte</span><span class="op" id="2558845">(</span><span class="ident" id="2558846"><a href="/net/dnsmsg.go.html#2558818">i</a></span>&nbsp;<span class="op" id="2558848">&gt;&gt;</span>&nbsp;<span class="num" id="2558851">24</span><span class="op" id="2558853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558858"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2558861">[</span><span class="ident" id="2558862"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2558865">+</span><span class="num" id="2558866">1</span><span class="op" id="2558867">]</span>&nbsp;<span class="op" id="2558869">=</span>&nbsp;<span class="builtintype" id="2558871">byte</span><span class="op" id="2558875">(</span><span class="ident" id="2558876"><a href="/net/dnsmsg.go.html#2558818">i</a></span>&nbsp;<span class="op" id="2558878">&gt;&gt;</span>&nbsp;<span class="num" id="2558881">16</span><span class="op" id="2558883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558888"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2558891">[</span><span class="ident" id="2558892"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2558895">+</span><span class="num" id="2558896">2</span><span class="op" id="2558897">]</span>&nbsp;<span class="op" id="2558899">=</span>&nbsp;<span class="builtintype" id="2558901">byte</span><span class="op" id="2558905">(</span><span class="ident" id="2558906"><a href="/net/dnsmsg.go.html#2558818">i</a></span>&nbsp;<span class="op" id="2558908">&gt;&gt;</span>&nbsp;<span class="num" id="2558911">8</span><span class="op" id="2558912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558917"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2558920">[</span><span class="ident" id="2558921"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2558924">+</span><span class="num" id="2558925">3</span><span class="op" id="2558926">]</span>&nbsp;<span class="op" id="2558928">=</span>&nbsp;<span class="builtintype" id="2558930">byte</span><span class="op" id="2558934">(</span><span class="ident" id="2558935"><a href="/net/dnsmsg.go.html#2558818">i</a></span><span class="op" id="2558936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558941"><a href="/net/dnsmsg.go.html#2558464">off</a></span>&nbsp;<span class="op" id="2558945">+=</span>&nbsp;<span class="num" id="2558948">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558952">case</span>&nbsp;<span class="op" id="2558957">[</span><span class="op" id="2558958">]</span><span class="builtintype" id="2558959">byte</span><span class="op" id="2558963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558968">n</span>&nbsp;<span class="op" id="2558970">:=</span>&nbsp;<span class="builtinfunc" id="2558973">len</span><span class="op" id="2558976">(</span><span class="ident" id="2558977"><a href="/net/dnsmsg.go.html#2558568">fv</a></span><span class="op" id="2558979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558984">if</span>&nbsp;<span class="ident" id="2558987"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2558990">+</span><span class="ident" id="2558991"><a href="/net/dnsmsg.go.html#2558968">n</a></span>&nbsp;<span class="op" id="2558993">&gt;</span>&nbsp;<span class="builtinfunc" id="2558995">len</span><span class="op" id="2558998">(</span><span class="ident" id="2558999"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2559002">)</span>&nbsp;<span class="op" id="2559004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559010">return</span>&nbsp;<span class="ident" id="2559017">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559026">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2559031">copy</span><span class="op" id="2559035">(</span><span class="ident" id="2559036"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2559039">[</span><span class="ident" id="2559040"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559043">:</span><span class="ident" id="2559044"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559047">+</span><span class="ident" id="2559048"><a href="/net/dnsmsg.go.html#2558968">n</a></span><span class="op" id="2559049">]</span><span class="op" id="2559050">,</span>&nbsp;<span class="ident" id="2559052"><a href="/net/dnsmsg.go.html#2558568">fv</a></span><span class="op" id="2559054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559059"><a href="/net/dnsmsg.go.html#2558464">off</a></span>&nbsp;<span class="op" id="2559063">+=</span>&nbsp;<span class="ident" id="2559066"><a href="/net/dnsmsg.go.html#2558968">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559070">case</span>&nbsp;<span class="op" id="2559075">*</span><span class="builtintype" id="2559076">string</span><span class="op" id="2559082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559087">s</span>&nbsp;<span class="op" id="2559089">:=</span>&nbsp;<span class="op" id="2559092">*</span><span class="ident" id="2559093"><a href="/net/dnsmsg.go.html#2558568">fv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559099">switch</span>&nbsp;<span class="ident" id="2559106"><a href="/net/dnsmsg.go.html#2558540">tag</a></span>&nbsp;<span class="op" id="2559110">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559115">default</span><span class="op" id="2559122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2559128">println</span><span class="op" id="2559135">(</span><span class="string" id="2559136">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="2559166">,</span>&nbsp;<span class="ident" id="2559168"><a href="/net/dnsmsg.go.html#2558540">tag</a></span><span class="op" id="2559171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559177">return</span>&nbsp;<span class="ident" id="2559184">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559193">case</span>&nbsp;<span class="string" id="2559198">&#34;domain&#34;</span><span class="op" id="2559206">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559212"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559215">,</span>&nbsp;<span class="ident" id="2559217"><a href="/net/dnsmsg.go.html#2558484">ok</a></span>&nbsp;<span class="op" id="2559220">=</span>&nbsp;<span class="ident" id="2559222"><a href="/net/dnsmsg.go.html#2555752">packDomainName</a></span><span class="op" id="2559236">(</span><span class="ident" id="2559237"><a href="/net/dnsmsg.go.html#2559087">s</a></span><span class="op" id="2559238">,</span>&nbsp;<span class="ident" id="2559240"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2559243">,</span>&nbsp;<span class="ident" id="2559245"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559248">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559254">if</span>&nbsp;<span class="op" id="2559257">!</span><span class="ident" id="2559258"><a href="/net/dnsmsg.go.html#2558484">ok</a></span>&nbsp;<span class="op" id="2559261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559268">return</span>&nbsp;<span class="ident" id="2559275">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559290">case</span>&nbsp;<span class="string" id="2559295">&#34;&#34;</span><span class="op" id="2559297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2559303">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559341">if</span>&nbsp;<span class="builtinfunc" id="2559344">len</span><span class="op" id="2559347">(</span><span class="ident" id="2559348"><a href="/net/dnsmsg.go.html#2559087">s</a></span><span class="op" id="2559349">)</span>&nbsp;<span class="op" id="2559351">&gt;</span>&nbsp;<span class="num" id="2559353">255</span>&nbsp;<span class="op" id="2559357">||</span>&nbsp;<span class="ident" id="2559360"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559363">+</span><span class="num" id="2559364">1</span><span class="op" id="2559365">+</span><span class="builtinfunc" id="2559366">len</span><span class="op" id="2559369">(</span><span class="ident" id="2559370"><a href="/net/dnsmsg.go.html#2559087">s</a></span><span class="op" id="2559371">)</span>&nbsp;<span class="op" id="2559373">&gt;</span>&nbsp;<span class="builtinfunc" id="2559375">len</span><span class="op" id="2559378">(</span><span class="ident" id="2559379"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2559382">)</span>&nbsp;<span class="op" id="2559384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559391">return</span>&nbsp;<span class="ident" id="2559398">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559414"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2559417">[</span><span class="ident" id="2559418"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559421">]</span>&nbsp;<span class="op" id="2559423">=</span>&nbsp;<span class="builtintype" id="2559425">byte</span><span class="op" id="2559429">(</span><span class="builtinfunc" id="2559430">len</span><span class="op" id="2559433">(</span><span class="ident" id="2559434"><a href="/net/dnsmsg.go.html#2559087">s</a></span><span class="op" id="2559435">)</span><span class="op" id="2559436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559442"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559445">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559452"><a href="/net/dnsmsg.go.html#2558464">off</a></span>&nbsp;<span class="op" id="2559456">+=</span>&nbsp;<span class="builtinfunc" id="2559459">copy</span><span class="op" id="2559463">(</span><span class="ident" id="2559464"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2559467">[</span><span class="ident" id="2559468"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559471">:</span><span class="op" id="2559472">]</span><span class="op" id="2559473">,</span>&nbsp;<span class="ident" id="2559475"><a href="/net/dnsmsg.go.html#2559087">s</a></span><span class="op" id="2559476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559489">return</span>&nbsp;<span class="ident" id="2559496">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559502">}</span><span class="op" id="2559503">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559506">if</span>&nbsp;<span class="op" id="2559509">!</span><span class="ident" id="2559510"><a href="/net/dnsmsg.go.html#2558484">ok</a></span>&nbsp;<span class="op" id="2559513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559517">return</span>&nbsp;<span class="builtinfunc" id="2559524">len</span><span class="op" id="2559527">(</span><span class="ident" id="2559528"><a href="/net/dnsmsg.go.html#2558452">msg</a></span><span class="op" id="2559531">)</span><span class="op" id="2559532">,</span>&nbsp;<span class="ident" id="2559534">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559544">return</span>&nbsp;<span class="ident" id="2559551"><a href="/net/dnsmsg.go.html#2558464">off</a></span><span class="op" id="2559554">,</span>&nbsp;<span class="ident" id="2559556">true</span><br>
<span class="lineno"></span><span class="op" id="2559561">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="2559564">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:]into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2559629">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="2559690">func</span>&nbsp;<span class="ident" id="2559695">unpackStruct</span><span class="op" id="2559707">(</span><span class="ident" id="2559708">any</span>&nbsp;<span class="ident" id="2559712"><a href="/net/dnsmsg.go.html#2547711">dnsStruct</a></span><span class="op" id="2559721">,</span>&nbsp;<span class="ident" id="2559723">msg</span>&nbsp;<span class="op" id="2559727">[</span><span class="op" id="2559728">]</span><span class="builtintype" id="2559729">byte</span><span class="op" id="2559733">,</span>&nbsp;<span class="ident" id="2559735">off</span>&nbsp;<span class="builtintype" id="2559739">int</span><span class="op" id="2559742">)</span>&nbsp;<span class="op" id="2559744">(</span><span class="ident" id="2559745">off1</span>&nbsp;<span class="builtintype" id="2559750">int</span><span class="op" id="2559753">,</span>&nbsp;<span class="ident" id="2559755">ok</span>&nbsp;<span class="builtintype" id="2559758">bool</span><span class="op" id="2559762">)</span>&nbsp;<span class="op" id="2559764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559767"><a href="/net/dnsmsg.go.html#2559755">ok</a></span>&nbsp;<span class="op" id="2559770">=</span>&nbsp;<span class="ident" id="2559772"><a href="/net/dnsmsg.go.html#2559708">any</a></span><span class="op" id="2559775">.</span><span class="ident" id="2559776">Walk</span><span class="op" id="2559780">(</span><span class="keyword" id="2559781">func</span><span class="op" id="2559785">(</span><span class="ident" id="2559786">field</span>&nbsp;<span class="keyword" id="2559792">interface</span><span class="op" id="2559801">{</span><span class="op" id="2559802">}</span><span class="op" id="2559803">,</span>&nbsp;<span class="ident" id="2559805">name</span><span class="op" id="2559809">,</span>&nbsp;<span class="ident" id="2559811">tag</span>&nbsp;<span class="builtintype" id="2559815">string</span><span class="op" id="2559821">)</span>&nbsp;<span class="builtintype" id="2559823">bool</span>&nbsp;<span class="op" id="2559828">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559832">switch</span>&nbsp;<span class="ident" id="2559839">fv</span>&nbsp;<span class="op" id="2559842">:=</span>&nbsp;<span class="ident" id="2559845"><a href="/net/dnsmsg.go.html#2559786">field</a></span><span class="op" id="2559850">.</span><span class="op" id="2559851">(</span><span class="keyword" id="2559852">type</span><span class="op" id="2559856">)</span>&nbsp;<span class="op" id="2559858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559862">default</span><span class="op" id="2559869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2559874">println</span><span class="op" id="2559881">(</span><span class="string" id="2559882">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="2559914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559919">return</span>&nbsp;<span class="ident" id="2559926">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559934">case</span>&nbsp;<span class="op" id="2559939">*</span><span class="builtintype" id="2559940">uint16</span><span class="op" id="2559946">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559951">if</span>&nbsp;<span class="ident" id="2559954"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2559957">+</span><span class="num" id="2559958">2</span>&nbsp;<span class="op" id="2559960">&gt;</span>&nbsp;<span class="builtinfunc" id="2559962">len</span><span class="op" id="2559965">(</span><span class="ident" id="2559966"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2559969">)</span>&nbsp;<span class="op" id="2559971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559977">return</span>&nbsp;<span class="ident" id="2559984">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559998">*</span><span class="ident" id="2559999"><a href="/net/dnsmsg.go.html#2559839">fv</a></span>&nbsp;<span class="op" id="2560002">=</span>&nbsp;<span class="builtintype" id="2560004">uint16</span><span class="op" id="2560010">(</span><span class="ident" id="2560011"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560014">[</span><span class="ident" id="2560015"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560018">]</span><span class="op" id="2560019">)</span><span class="op" id="2560020">&lt;&lt;</span><span class="num" id="2560022">8</span>&nbsp;<span class="op" id="2560024">|</span>&nbsp;<span class="builtintype" id="2560026">uint16</span><span class="op" id="2560032">(</span><span class="ident" id="2560033"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560036">[</span><span class="ident" id="2560037"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560040">+</span><span class="num" id="2560041">1</span><span class="op" id="2560042">]</span><span class="op" id="2560043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560048"><a href="/net/dnsmsg.go.html#2559735">off</a></span>&nbsp;<span class="op" id="2560052">+=</span>&nbsp;<span class="num" id="2560055">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560059">case</span>&nbsp;<span class="op" id="2560064">*</span><span class="builtintype" id="2560065">uint32</span><span class="op" id="2560071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560076">if</span>&nbsp;<span class="ident" id="2560079"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560082">+</span><span class="num" id="2560083">4</span>&nbsp;<span class="op" id="2560085">&gt;</span>&nbsp;<span class="builtinfunc" id="2560087">len</span><span class="op" id="2560090">(</span><span class="ident" id="2560091"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560094">)</span>&nbsp;<span class="op" id="2560096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560102">return</span>&nbsp;<span class="ident" id="2560109">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560123">*</span><span class="ident" id="2560124"><a href="/net/dnsmsg.go.html#2559839">fv</a></span>&nbsp;<span class="op" id="2560127">=</span>&nbsp;<span class="builtintype" id="2560129">uint32</span><span class="op" id="2560135">(</span><span class="ident" id="2560136"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560139">[</span><span class="ident" id="2560140"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560143">]</span><span class="op" id="2560144">)</span><span class="op" id="2560145">&lt;&lt;</span><span class="num" id="2560147">24</span>&nbsp;<span class="op" id="2560150">|</span>&nbsp;<span class="builtintype" id="2560152">uint32</span><span class="op" id="2560158">(</span><span class="ident" id="2560159"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560162">[</span><span class="ident" id="2560163"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560166">+</span><span class="num" id="2560167">1</span><span class="op" id="2560168">]</span><span class="op" id="2560169">)</span><span class="op" id="2560170">&lt;&lt;</span><span class="num" id="2560172">16</span>&nbsp;<span class="op" id="2560175">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2560181">uint32</span><span class="op" id="2560187">(</span><span class="ident" id="2560188"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560191">[</span><span class="ident" id="2560192"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560195">+</span><span class="num" id="2560196">2</span><span class="op" id="2560197">]</span><span class="op" id="2560198">)</span><span class="op" id="2560199">&lt;&lt;</span><span class="num" id="2560201">8</span>&nbsp;<span class="op" id="2560203">|</span>&nbsp;<span class="builtintype" id="2560205">uint32</span><span class="op" id="2560211">(</span><span class="ident" id="2560212"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560215">[</span><span class="ident" id="2560216"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560219">+</span><span class="num" id="2560220">3</span><span class="op" id="2560221">]</span><span class="op" id="2560222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560227"><a href="/net/dnsmsg.go.html#2559735">off</a></span>&nbsp;<span class="op" id="2560231">+=</span>&nbsp;<span class="num" id="2560234">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560238">case</span>&nbsp;<span class="op" id="2560243">[</span><span class="op" id="2560244">]</span><span class="builtintype" id="2560245">byte</span><span class="op" id="2560249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560254">n</span>&nbsp;<span class="op" id="2560256">:=</span>&nbsp;<span class="builtinfunc" id="2560259">len</span><span class="op" id="2560262">(</span><span class="ident" id="2560263"><a href="/net/dnsmsg.go.html#2559839">fv</a></span><span class="op" id="2560265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560270">if</span>&nbsp;<span class="ident" id="2560273"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560276">+</span><span class="ident" id="2560277"><a href="/net/dnsmsg.go.html#2560254">n</a></span>&nbsp;<span class="op" id="2560279">&gt;</span>&nbsp;<span class="builtinfunc" id="2560281">len</span><span class="op" id="2560284">(</span><span class="ident" id="2560285"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560288">)</span>&nbsp;<span class="op" id="2560290">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560296">return</span>&nbsp;<span class="ident" id="2560303">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2560317">copy</span><span class="op" id="2560321">(</span><span class="ident" id="2560322"><a href="/net/dnsmsg.go.html#2559839">fv</a></span><span class="op" id="2560324">,</span>&nbsp;<span class="ident" id="2560326"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560329">[</span><span class="ident" id="2560330"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560333">:</span><span class="ident" id="2560334"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560337">+</span><span class="ident" id="2560338"><a href="/net/dnsmsg.go.html#2560254">n</a></span><span class="op" id="2560339">]</span><span class="op" id="2560340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560345"><a href="/net/dnsmsg.go.html#2559735">off</a></span>&nbsp;<span class="op" id="2560349">+=</span>&nbsp;<span class="ident" id="2560352"><a href="/net/dnsmsg.go.html#2560254">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560356">case</span>&nbsp;<span class="op" id="2560361">*</span><span class="builtintype" id="2560362">string</span><span class="op" id="2560368">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560373">var</span>&nbsp;<span class="ident" id="2560377">s</span>&nbsp;<span class="builtintype" id="2560379">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560389">switch</span>&nbsp;<span class="ident" id="2560396"><a href="/net/dnsmsg.go.html#2559811">tag</a></span>&nbsp;<span class="op" id="2560400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560405">default</span><span class="op" id="2560412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2560418">println</span><span class="op" id="2560425">(</span><span class="string" id="2560426">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="2560456">,</span>&nbsp;<span class="ident" id="2560458"><a href="/net/dnsmsg.go.html#2559811">tag</a></span><span class="op" id="2560461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560467">return</span>&nbsp;<span class="ident" id="2560474">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560483">case</span>&nbsp;<span class="string" id="2560488">&#34;domain&#34;</span><span class="op" id="2560496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560502"><a href="/net/dnsmsg.go.html#2560377">s</a></span><span class="op" id="2560503">,</span>&nbsp;<span class="ident" id="2560505"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560508">,</span>&nbsp;<span class="ident" id="2560510"><a href="/net/dnsmsg.go.html#2559755">ok</a></span>&nbsp;<span class="op" id="2560513">=</span>&nbsp;<span class="ident" id="2560515"><a href="/net/dnsmsg.go.html#2557284">unpackDomainName</a></span><span class="op" id="2560531">(</span><span class="ident" id="2560532"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560535">,</span>&nbsp;<span class="ident" id="2560537"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560546">if</span>&nbsp;<span class="op" id="2560549">!</span><span class="ident" id="2560550"><a href="/net/dnsmsg.go.html#2559755">ok</a></span>&nbsp;<span class="op" id="2560553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560560">return</span>&nbsp;<span class="ident" id="2560567">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560577">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560582">case</span>&nbsp;<span class="string" id="2560587">&#34;&#34;</span><span class="op" id="2560589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560595">if</span>&nbsp;<span class="ident" id="2560598"><a href="/net/dnsmsg.go.html#2559735">off</a></span>&nbsp;<span class="op" id="2560602">&gt;=</span>&nbsp;<span class="builtinfunc" id="2560605">len</span><span class="op" id="2560608">(</span><span class="ident" id="2560609"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560612">)</span>&nbsp;<span class="op" id="2560614">||</span>&nbsp;<span class="ident" id="2560617"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560620">+</span><span class="num" id="2560621">1</span><span class="op" id="2560622">+</span><span class="builtintype" id="2560623">int</span><span class="op" id="2560626">(</span><span class="ident" id="2560627"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560630">[</span><span class="ident" id="2560631"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560634">]</span><span class="op" id="2560635">)</span>&nbsp;<span class="op" id="2560637">&gt;</span>&nbsp;<span class="builtinfunc" id="2560639">len</span><span class="op" id="2560642">(</span><span class="ident" id="2560643"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560646">)</span>&nbsp;<span class="op" id="2560648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560655">return</span>&nbsp;<span class="ident" id="2560662">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560678">n</span>&nbsp;<span class="op" id="2560680">:=</span>&nbsp;<span class="builtintype" id="2560683">int</span><span class="op" id="2560686">(</span><span class="ident" id="2560687"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560690">[</span><span class="ident" id="2560691"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560694">]</span><span class="op" id="2560695">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560701"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560704">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560711">b</span>&nbsp;<span class="op" id="2560713">:=</span>&nbsp;<span class="builtinfunc" id="2560716">make</span><span class="op" id="2560720">(</span><span class="op" id="2560721">[</span><span class="op" id="2560722">]</span><span class="builtintype" id="2560723">byte</span><span class="op" id="2560727">,</span>&nbsp;<span class="ident" id="2560729"><a href="/net/dnsmsg.go.html#2560678">n</a></span><span class="op" id="2560730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560736">for</span>&nbsp;<span class="ident" id="2560740">i</span>&nbsp;<span class="op" id="2560742">:=</span>&nbsp;<span class="num" id="2560745">0</span><span class="op" id="2560746">;</span>&nbsp;<span class="ident" id="2560748"><a href="/net/dnsmsg.go.html#2560740">i</a></span>&nbsp;<span class="op" id="2560750">&lt;</span>&nbsp;<span class="ident" id="2560752"><a href="/net/dnsmsg.go.html#2560678">n</a></span><span class="op" id="2560753">;</span>&nbsp;<span class="ident" id="2560755"><a href="/net/dnsmsg.go.html#2560740">i</a></span><span class="op" id="2560756">++</span>&nbsp;<span class="op" id="2560759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560766"><a href="/net/dnsmsg.go.html#2560711">b</a></span><span class="op" id="2560767">[</span><span class="ident" id="2560768"><a href="/net/dnsmsg.go.html#2560740">i</a></span><span class="op" id="2560769">]</span>&nbsp;<span class="op" id="2560771">=</span>&nbsp;<span class="ident" id="2560773"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560776">[</span><span class="ident" id="2560777"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560780">+</span><span class="ident" id="2560781"><a href="/net/dnsmsg.go.html#2560740">i</a></span><span class="op" id="2560782">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560788">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560794"><a href="/net/dnsmsg.go.html#2559735">off</a></span>&nbsp;<span class="op" id="2560798">+=</span>&nbsp;<span class="ident" id="2560801"><a href="/net/dnsmsg.go.html#2560678">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560807"><a href="/net/dnsmsg.go.html#2560377">s</a></span>&nbsp;<span class="op" id="2560809">=</span>&nbsp;<span class="builtintype" id="2560811">string</span><span class="op" id="2560817">(</span><span class="ident" id="2560818"><a href="/net/dnsmsg.go.html#2560711">b</a></span><span class="op" id="2560819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560829">*</span><span class="ident" id="2560830"><a href="/net/dnsmsg.go.html#2559839">fv</a></span>&nbsp;<span class="op" id="2560833">=</span>&nbsp;<span class="ident" id="2560835"><a href="/net/dnsmsg.go.html#2560377">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560839">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560843">return</span>&nbsp;<span class="ident" id="2560850">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560856">}</span><span class="op" id="2560857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560860">if</span>&nbsp;<span class="op" id="2560863">!</span><span class="ident" id="2560864"><a href="/net/dnsmsg.go.html#2559755">ok</a></span>&nbsp;<span class="op" id="2560867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560871">return</span>&nbsp;<span class="builtinfunc" id="2560878">len</span><span class="op" id="2560881">(</span><span class="ident" id="2560882"><a href="/net/dnsmsg.go.html#2559723">msg</a></span><span class="op" id="2560885">)</span><span class="op" id="2560886">,</span>&nbsp;<span class="ident" id="2560888">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560895">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560898">return</span>&nbsp;<span class="ident" id="2560905"><a href="/net/dnsmsg.go.html#2559735">off</a></span><span class="op" id="2560908">,</span>&nbsp;<span class="ident" id="2560910">true</span><br>
<span class="lineno"></span><span class="op" id="2560915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2560918">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2560985">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="2561005">func</span>&nbsp;<span class="ident" id="2561010">printStruct</span><span class="op" id="2561021">(</span><span class="ident" id="2561022">any</span>&nbsp;<span class="ident" id="2561026"><a href="/net/dnsmsg.go.html#2547711">dnsStruct</a></span><span class="op" id="2561035">)</span>&nbsp;<span class="builtintype" id="2561037">string</span>&nbsp;<span class="op" id="2561044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561047">s</span>&nbsp;<span class="op" id="2561049">:=</span>&nbsp;<span class="string" id="2561052">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561057">i</span>&nbsp;<span class="op" id="2561059">:=</span>&nbsp;<span class="num" id="2561062">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561065"><a href="/net/dnsmsg.go.html#2561022">any</a></span><span class="op" id="2561068">.</span><span class="ident" id="2561069">Walk</span><span class="op" id="2561073">(</span><span class="keyword" id="2561074">func</span><span class="op" id="2561078">(</span><span class="ident" id="2561079">val</span>&nbsp;<span class="keyword" id="2561083">interface</span><span class="op" id="2561092">{</span><span class="op" id="2561093">}</span><span class="op" id="2561094">,</span>&nbsp;<span class="ident" id="2561096">name</span><span class="op" id="2561100">,</span>&nbsp;<span class="ident" id="2561102">tag</span>&nbsp;<span class="builtintype" id="2561106">string</span><span class="op" id="2561112">)</span>&nbsp;<span class="builtintype" id="2561114">bool</span>&nbsp;<span class="op" id="2561119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561123"><a href="/net/dnsmsg.go.html#2561057">i</a></span><span class="op" id="2561124">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561129">if</span>&nbsp;<span class="ident" id="2561132"><a href="/net/dnsmsg.go.html#2561057">i</a></span>&nbsp;<span class="op" id="2561134">&gt;</span>&nbsp;<span class="num" id="2561136">1</span>&nbsp;<span class="op" id="2561138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561143"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561145">+=</span>&nbsp;<span class="string" id="2561148">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561159"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561161">+=</span>&nbsp;<span class="ident" id="2561164"><a href="/net/dnsmsg.go.html#2561096">name</a></span>&nbsp;<span class="op" id="2561169">+</span>&nbsp;<span class="string" id="2561171">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561177">switch</span>&nbsp;<span class="ident" id="2561184"><a href="/net/dnsmsg.go.html#2561102">tag</a></span>&nbsp;<span class="op" id="2561188">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561192">case</span>&nbsp;<span class="string" id="2561197">&#34;ipv4&#34;</span><span class="op" id="2561203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561208">i</span>&nbsp;<span class="op" id="2561210">:=</span>&nbsp;<span class="op" id="2561213">*</span><span class="ident" id="2561214"><a href="/net/dnsmsg.go.html#2561079">val</a></span><span class="op" id="2561217">.</span><span class="op" id="2561218">(</span><span class="op" id="2561219">*</span><span class="builtintype" id="2561220">uint32</span><span class="op" id="2561226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561231"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561233">+=</span>&nbsp;<span class="ident" id="2561236"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2561240">(</span><span class="builtintype" id="2561241">byte</span><span class="op" id="2561245">(</span><span class="ident" id="2561246"><a href="/net/dnsmsg.go.html#2561208">i</a></span><span class="op" id="2561247">&gt;&gt;</span><span class="num" id="2561249">24</span><span class="op" id="2561251">)</span><span class="op" id="2561252">,</span>&nbsp;<span class="builtintype" id="2561254">byte</span><span class="op" id="2561258">(</span><span class="ident" id="2561259"><a href="/net/dnsmsg.go.html#2561208">i</a></span><span class="op" id="2561260">&gt;&gt;</span><span class="num" id="2561262">16</span><span class="op" id="2561264">)</span><span class="op" id="2561265">,</span>&nbsp;<span class="builtintype" id="2561267">byte</span><span class="op" id="2561271">(</span><span class="ident" id="2561272"><a href="/net/dnsmsg.go.html#2561208">i</a></span><span class="op" id="2561273">&gt;&gt;</span><span class="num" id="2561275">8</span><span class="op" id="2561276">)</span><span class="op" id="2561277">,</span>&nbsp;<span class="builtintype" id="2561279">byte</span><span class="op" id="2561283">(</span><span class="ident" id="2561284"><a href="/net/dnsmsg.go.html#2561208">i</a></span><span class="op" id="2561285">)</span><span class="op" id="2561286">)</span><span class="op" id="2561287">.</span><span class="ident" id="2561288">String</span><span class="op" id="2561294">(</span><span class="op" id="2561295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561299">case</span>&nbsp;<span class="string" id="2561304">&#34;ipv6&#34;</span><span class="op" id="2561310">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561315">i</span>&nbsp;<span class="op" id="2561317">:=</span>&nbsp;<span class="ident" id="2561320"><a href="/net/dnsmsg.go.html#2561079">val</a></span><span class="op" id="2561323">.</span><span class="op" id="2561324">(</span><span class="op" id="2561325">[</span><span class="op" id="2561326">]</span><span class="builtintype" id="2561327">byte</span><span class="op" id="2561331">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561336"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561338">+=</span>&nbsp;<span class="ident" id="2561341"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2561343">(</span><span class="ident" id="2561344"><a href="/net/dnsmsg.go.html#2561315">i</a></span><span class="op" id="2561345">)</span><span class="op" id="2561346">.</span><span class="ident" id="2561347">String</span><span class="op" id="2561353">(</span><span class="op" id="2561354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561358">default</span><span class="op" id="2561365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561370">var</span>&nbsp;<span class="ident" id="2561374">i</span>&nbsp;<span class="ident" id="2561376">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561385">switch</span>&nbsp;<span class="ident" id="2561392">v</span>&nbsp;<span class="op" id="2561394">:=</span>&nbsp;<span class="ident" id="2561397"><a href="/net/dnsmsg.go.html#2561079">val</a></span><span class="op" id="2561400">.</span><span class="op" id="2561401">(</span><span class="keyword" id="2561402">type</span><span class="op" id="2561406">)</span>&nbsp;<span class="op" id="2561408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561413">default</span><span class="op" id="2561420">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2561426">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561454"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561456">+=</span>&nbsp;<span class="string" id="2561459">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561480">return</span>&nbsp;<span class="ident" id="2561487">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561495">case</span>&nbsp;<span class="op" id="2561500">*</span><span class="builtintype" id="2561501">string</span><span class="op" id="2561507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561513"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561515">+=</span>&nbsp;<span class="op" id="2561518">*</span><span class="ident" id="2561519"><a href="/net/dnsmsg.go.html#2561392">v</a></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561525">return</span>&nbsp;<span class="ident" id="2561532">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561540">case</span>&nbsp;<span class="op" id="2561545">[</span><span class="op" id="2561546">]</span><span class="builtintype" id="2561547">byte</span><span class="op" id="2561551">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561557"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561559">+=</span>&nbsp;<span class="builtintype" id="2561562">string</span><span class="op" id="2561568">(</span><span class="ident" id="2561569"><a href="/net/dnsmsg.go.html#2561392">v</a></span><span class="op" id="2561570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561576">return</span>&nbsp;<span class="ident" id="2561583">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561591">case</span>&nbsp;<span class="op" id="2561596">*</span><span class="builtintype" id="2561597">bool</span><span class="op" id="2561601">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561607">if</span>&nbsp;<span class="op" id="2561610">*</span><span class="ident" id="2561611"><a href="/net/dnsmsg.go.html#2561392">v</a></span>&nbsp;<span class="op" id="2561613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561620"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561622">+=</span>&nbsp;<span class="string" id="2561625">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561636">}</span>&nbsp;<span class="keyword" id="2561638">else</span>&nbsp;<span class="op" id="2561643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561650"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561652">+=</span>&nbsp;<span class="string" id="2561655">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561667">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561673">return</span>&nbsp;<span class="ident" id="2561680">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561688">case</span>&nbsp;<span class="op" id="2561693">*</span><span class="builtintype" id="2561694">int</span><span class="op" id="2561697">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561703"><a href="/net/dnsmsg.go.html#2561374">i</a></span>&nbsp;<span class="op" id="2561705">=</span>&nbsp;<span class="ident" id="2561707">int64</span><span class="op" id="2561712">(</span><span class="op" id="2561713">*</span><span class="ident" id="2561714"><a href="/net/dnsmsg.go.html#2561392">v</a></span><span class="op" id="2561715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561720">case</span>&nbsp;<span class="op" id="2561725">*</span><span class="builtintype" id="2561726">uint</span><span class="op" id="2561730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561736"><a href="/net/dnsmsg.go.html#2561374">i</a></span>&nbsp;<span class="op" id="2561738">=</span>&nbsp;<span class="ident" id="2561740">int64</span><span class="op" id="2561745">(</span><span class="op" id="2561746">*</span><span class="ident" id="2561747"><a href="/net/dnsmsg.go.html#2561392">v</a></span><span class="op" id="2561748">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561753">case</span>&nbsp;<span class="op" id="2561758">*</span><span class="builtintype" id="2561759">uint8</span><span class="op" id="2561764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561770"><a href="/net/dnsmsg.go.html#2561374">i</a></span>&nbsp;<span class="op" id="2561772">=</span>&nbsp;<span class="ident" id="2561774">int64</span><span class="op" id="2561779">(</span><span class="op" id="2561780">*</span><span class="ident" id="2561781"><a href="/net/dnsmsg.go.html#2561392">v</a></span><span class="op" id="2561782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561787">case</span>&nbsp;<span class="op" id="2561792">*</span><span class="builtintype" id="2561793">uint16</span><span class="op" id="2561799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561805"><a href="/net/dnsmsg.go.html#2561374">i</a></span>&nbsp;<span class="op" id="2561807">=</span>&nbsp;<span class="ident" id="2561809">int64</span><span class="op" id="2561814">(</span><span class="op" id="2561815">*</span><span class="ident" id="2561816"><a href="/net/dnsmsg.go.html#2561392">v</a></span><span class="op" id="2561817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561822">case</span>&nbsp;<span class="op" id="2561827">*</span><span class="builtintype" id="2561828">uint32</span><span class="op" id="2561834">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561840"><a href="/net/dnsmsg.go.html#2561374">i</a></span>&nbsp;<span class="op" id="2561842">=</span>&nbsp;<span class="ident" id="2561844">int64</span><span class="op" id="2561849">(</span><span class="op" id="2561850">*</span><span class="ident" id="2561851"><a href="/net/dnsmsg.go.html#2561392">v</a></span><span class="op" id="2561852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561857">case</span>&nbsp;<span class="op" id="2561862">*</span><span class="ident" id="2561863">uint64</span><span class="op" id="2561869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561875"><a href="/net/dnsmsg.go.html#2561374">i</a></span>&nbsp;<span class="op" id="2561877">=</span>&nbsp;<span class="ident" id="2561879">int64</span><span class="op" id="2561884">(</span><span class="op" id="2561885">*</span><span class="ident" id="2561886"><a href="/net/dnsmsg.go.html#2561392">v</a></span><span class="op" id="2561887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561892">case</span>&nbsp;<span class="op" id="2561897">*</span><span class="builtintype" id="2561898">uintptr</span><span class="op" id="2561905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561911"><a href="/net/dnsmsg.go.html#2561374">i</a></span>&nbsp;<span class="op" id="2561913">=</span>&nbsp;<span class="ident" id="2561915">int64</span><span class="op" id="2561920">(</span><span class="op" id="2561921">*</span><span class="ident" id="2561922"><a href="/net/dnsmsg.go.html#2561392">v</a></span><span class="op" id="2561923">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561933"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561935">+=</span>&nbsp;<span class="ident" id="2561938"><a href="/net/parse.go.html#2666210">itoa</a></span><span class="op" id="2561942">(</span><span class="builtintype" id="2561943">int</span><span class="op" id="2561946">(</span><span class="ident" id="2561947"><a href="/net/dnsmsg.go.html#2561374">i</a></span><span class="op" id="2561948">)</span><span class="op" id="2561949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561957">return</span>&nbsp;<span class="ident" id="2561964">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561970">}</span><span class="op" id="2561971">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561974"><a href="/net/dnsmsg.go.html#2561047">s</a></span>&nbsp;<span class="op" id="2561976">+=</span>&nbsp;<span class="string" id="2561979">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561984">return</span>&nbsp;<span class="ident" id="2561991"><a href="/net/dnsmsg.go.html#2561047">s</a></span><br>
<span class="lineno"></span><span class="op" id="2561993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2561996">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="2562023">func</span>&nbsp;<span class="ident" id="2562028">packRR</span><span class="op" id="2562034">(</span><span class="ident" id="2562035">rr</span>&nbsp;<span class="ident" id="2562038"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><span class="op" id="2562043">,</span>&nbsp;<span class="ident" id="2562045">msg</span>&nbsp;<span class="op" id="2562049">[</span><span class="op" id="2562050">]</span><span class="builtintype" id="2562051">byte</span><span class="op" id="2562055">,</span>&nbsp;<span class="ident" id="2562057">off</span>&nbsp;<span class="builtintype" id="2562061">int</span><span class="op" id="2562064">)</span>&nbsp;<span class="op" id="2562066">(</span><span class="ident" id="2562067">off2</span>&nbsp;<span class="builtintype" id="2562072">int</span><span class="op" id="2562075">,</span>&nbsp;<span class="ident" id="2562077">ok</span>&nbsp;<span class="builtintype" id="2562080">bool</span><span class="op" id="2562084">)</span>&nbsp;<span class="op" id="2562086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562089">var</span>&nbsp;<span class="ident" id="2562093">off1</span>&nbsp;<span class="builtintype" id="2562098">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562103">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562146">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562183">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562239">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562265">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562287"><a href="/net/dnsmsg.go.html#2562093">off1</a></span><span class="op" id="2562291">,</span>&nbsp;<span class="ident" id="2562293"><a href="/net/dnsmsg.go.html#2562077">ok</a></span>&nbsp;<span class="op" id="2562296">=</span>&nbsp;<span class="ident" id="2562298"><a href="/net/dnsmsg.go.html#2558426">packStruct</a></span><span class="op" id="2562308">(</span><span class="ident" id="2562309"><a href="/net/dnsmsg.go.html#2562035">rr</a></span><span class="op" id="2562311">.</span><span class="ident" id="2562312">Header</span><span class="op" id="2562318">(</span><span class="op" id="2562319">)</span><span class="op" id="2562320">,</span>&nbsp;<span class="ident" id="2562322"><a href="/net/dnsmsg.go.html#2562045">msg</a></span><span class="op" id="2562325">,</span>&nbsp;<span class="ident" id="2562327"><a href="/net/dnsmsg.go.html#2562057">off</a></span><span class="op" id="2562330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562333"><a href="/net/dnsmsg.go.html#2562067">off2</a></span><span class="op" id="2562337">,</span>&nbsp;<span class="ident" id="2562339"><a href="/net/dnsmsg.go.html#2562077">ok</a></span>&nbsp;<span class="op" id="2562342">=</span>&nbsp;<span class="ident" id="2562344"><a href="/net/dnsmsg.go.html#2558426">packStruct</a></span><span class="op" id="2562354">(</span><span class="ident" id="2562355"><a href="/net/dnsmsg.go.html#2562035">rr</a></span><span class="op" id="2562357">,</span>&nbsp;<span class="ident" id="2562359"><a href="/net/dnsmsg.go.html#2562045">msg</a></span><span class="op" id="2562362">,</span>&nbsp;<span class="ident" id="2562364"><a href="/net/dnsmsg.go.html#2562057">off</a></span><span class="op" id="2562367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562370">if</span>&nbsp;<span class="op" id="2562373">!</span><span class="ident" id="2562374"><a href="/net/dnsmsg.go.html#2562077">ok</a></span>&nbsp;<span class="op" id="2562377">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562381">return</span>&nbsp;<span class="builtinfunc" id="2562388">len</span><span class="op" id="2562391">(</span><span class="ident" id="2562392"><a href="/net/dnsmsg.go.html#2562045">msg</a></span><span class="op" id="2562395">)</span><span class="op" id="2562396">,</span>&nbsp;<span class="ident" id="2562398">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2562405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562408">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562468"><a href="/net/dnsmsg.go.html#2562035">rr</a></span><span class="op" id="2562470">.</span><span class="ident" id="2562471">Header</span><span class="op" id="2562477">(</span><span class="op" id="2562478">)</span><span class="op" id="2562479">.</span><span class="ident" id="2562480">Rdlength</span>&nbsp;<span class="op" id="2562489">=</span>&nbsp;<span class="builtintype" id="2562491">uint16</span><span class="op" id="2562497">(</span><span class="ident" id="2562498"><a href="/net/dnsmsg.go.html#2562067">off2</a></span>&nbsp;<span class="op" id="2562503">-</span>&nbsp;<span class="ident" id="2562505"><a href="/net/dnsmsg.go.html#2562093">off1</a></span><span class="op" id="2562509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562512"><a href="/net/dnsmsg.go.html#2558426">packStruct</a></span><span class="op" id="2562522">(</span><span class="ident" id="2562523"><a href="/net/dnsmsg.go.html#2562035">rr</a></span><span class="op" id="2562525">.</span><span class="ident" id="2562526">Header</span><span class="op" id="2562532">(</span><span class="op" id="2562533">)</span><span class="op" id="2562534">,</span>&nbsp;<span class="ident" id="2562536"><a href="/net/dnsmsg.go.html#2562045">msg</a></span><span class="op" id="2562539">,</span>&nbsp;<span class="ident" id="2562541"><a href="/net/dnsmsg.go.html#2562057">off</a></span><span class="op" id="2562544">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562547">return</span>&nbsp;<span class="ident" id="2562554"><a href="/net/dnsmsg.go.html#2562067">off2</a></span><span class="op" id="2562558">,</span>&nbsp;<span class="ident" id="2562560">true</span><br>
<span class="lineno"></span><span class="op" id="2562565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2562568">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="2562597">func</span>&nbsp;<span class="ident" id="2562602">unpackRR</span><span class="op" id="2562610">(</span><span class="ident" id="2562611">msg</span>&nbsp;<span class="op" id="2562615">[</span><span class="op" id="2562616">]</span><span class="builtintype" id="2562617">byte</span><span class="op" id="2562621">,</span>&nbsp;<span class="ident" id="2562623">off</span>&nbsp;<span class="builtintype" id="2562627">int</span><span class="op" id="2562630">)</span>&nbsp;<span class="op" id="2562632">(</span><span class="ident" id="2562633">rr</span>&nbsp;<span class="ident" id="2562636"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><span class="op" id="2562641">,</span>&nbsp;<span class="ident" id="2562643">off1</span>&nbsp;<span class="builtintype" id="2562648">int</span><span class="op" id="2562651">,</span>&nbsp;<span class="ident" id="2562653">ok</span>&nbsp;<span class="builtintype" id="2562656">bool</span><span class="op" id="2562660">)</span>&nbsp;<span class="op" id="2562662">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562665">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562724">var</span>&nbsp;<span class="ident" id="2562728">h</span>&nbsp;<span class="ident" id="2562730"><a href="/net/dnsmsg.go.html#2549371">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562744">off0</span>&nbsp;<span class="op" id="2562749">:=</span>&nbsp;<span class="ident" id="2562752"><a href="/net/dnsmsg.go.html#2562623">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562757">if</span>&nbsp;<span class="ident" id="2562760"><a href="/net/dnsmsg.go.html#2562623">off</a></span><span class="op" id="2562763">,</span>&nbsp;<span class="ident" id="2562765"><a href="/net/dnsmsg.go.html#2562653">ok</a></span>&nbsp;<span class="op" id="2562768">=</span>&nbsp;<span class="ident" id="2562770"><a href="/net/dnsmsg.go.html#2559695">unpackStruct</a></span><span class="op" id="2562782">(</span><span class="op" id="2562783">&amp;</span><span class="ident" id="2562784"><a href="/net/dnsmsg.go.html#2562728">h</a></span><span class="op" id="2562785">,</span>&nbsp;<span class="ident" id="2562787"><a href="/net/dnsmsg.go.html#2562611">msg</a></span><span class="op" id="2562790">,</span>&nbsp;<span class="ident" id="2562792"><a href="/net/dnsmsg.go.html#2562623">off</a></span><span class="op" id="2562795">)</span><span class="op" id="2562796">;</span>&nbsp;<span class="op" id="2562798">!</span><span class="ident" id="2562799"><a href="/net/dnsmsg.go.html#2562653">ok</a></span>&nbsp;<span class="op" id="2562802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562806">return</span>&nbsp;<span class="ident" id="2562813">nil</span><span class="op" id="2562816">,</span>&nbsp;<span class="builtinfunc" id="2562818">len</span><span class="op" id="2562821">(</span><span class="ident" id="2562822"><a href="/net/dnsmsg.go.html#2562611">msg</a></span><span class="op" id="2562825">)</span><span class="op" id="2562826">,</span>&nbsp;<span class="ident" id="2562828">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2562835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562838">end</span>&nbsp;<span class="op" id="2562842">:=</span>&nbsp;<span class="ident" id="2562845"><a href="/net/dnsmsg.go.html#2562623">off</a></span>&nbsp;<span class="op" id="2562849">+</span>&nbsp;<span class="builtintype" id="2562851">int</span><span class="op" id="2562854">(</span><span class="ident" id="2562855"><a href="/net/dnsmsg.go.html#2562728">h</a></span><span class="op" id="2562856">.</span><span class="ident" id="2562857">Rdlength</span><span class="op" id="2562865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562869">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562912">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562963">mk</span><span class="op" id="2562965">,</span>&nbsp;<span class="ident" id="2562967">known</span>&nbsp;<span class="op" id="2562973">:=</span>&nbsp;<span class="ident" id="2562976"><a href="/net/dnsmsg.go.html#2554795">rr_mk</a></span><span class="op" id="2562981">[</span><span class="builtintype" id="2562982">int</span><span class="op" id="2562985">(</span><span class="ident" id="2562986"><a href="/net/dnsmsg.go.html#2562728">h</a></span><span class="op" id="2562987">.</span><span class="ident" id="2562988">Rrtype</span><span class="op" id="2562994">)</span><span class="op" id="2562995">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562998">if</span>&nbsp;<span class="op" id="2563001">!</span><span class="ident" id="2563002"><a href="/net/dnsmsg.go.html#2562967">known</a></span>&nbsp;<span class="op" id="2563008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2563012">return</span>&nbsp;<span class="op" id="2563019">&amp;</span><span class="ident" id="2563020"><a href="/net/dnsmsg.go.html#2562728">h</a></span><span class="op" id="2563021">,</span>&nbsp;<span class="ident" id="2563023"><a href="/net/dnsmsg.go.html#2562838">end</a></span><span class="op" id="2563026">,</span>&nbsp;<span class="ident" id="2563028">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2563034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563037"><a href="/net/dnsmsg.go.html#2562633">rr</a></span>&nbsp;<span class="op" id="2563040">=</span>&nbsp;<span class="ident" id="2563042"><a href="/net/dnsmsg.go.html#2562963">mk</a></span><span class="op" id="2563044">(</span><span class="op" id="2563045">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563048"><a href="/net/dnsmsg.go.html#2562623">off</a></span><span class="op" id="2563051">,</span>&nbsp;<span class="ident" id="2563053"><a href="/net/dnsmsg.go.html#2562653">ok</a></span>&nbsp;<span class="op" id="2563056">=</span>&nbsp;<span class="ident" id="2563058"><a href="/net/dnsmsg.go.html#2559695">unpackStruct</a></span><span class="op" id="2563070">(</span><span class="ident" id="2563071"><a href="/net/dnsmsg.go.html#2562633">rr</a></span><span class="op" id="2563073">,</span>&nbsp;<span class="ident" id="2563075"><a href="/net/dnsmsg.go.html#2562611">msg</a></span><span class="op" id="2563078">,</span>&nbsp;<span class="ident" id="2563080"><a href="/net/dnsmsg.go.html#2562744">off0</a></span><span class="op" id="2563084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2563087">if</span>&nbsp;<span class="ident" id="2563090"><a href="/net/dnsmsg.go.html#2562623">off</a></span>&nbsp;<span class="op" id="2563094">!=</span>&nbsp;<span class="ident" id="2563097"><a href="/net/dnsmsg.go.html#2562838">end</a></span>&nbsp;<span class="op" id="2563101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2563105">return</span>&nbsp;<span class="op" id="2563112">&amp;</span><span class="ident" id="2563113"><a href="/net/dnsmsg.go.html#2562728">h</a></span><span class="op" id="2563114">,</span>&nbsp;<span class="ident" id="2563116"><a href="/net/dnsmsg.go.html#2562838">end</a></span><span class="op" id="2563119">,</span>&nbsp;<span class="ident" id="2563121">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2563127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2563130">return</span>&nbsp;<span class="ident" id="2563137"><a href="/net/dnsmsg.go.html#2562633">rr</a></span><span class="op" id="2563139">,</span>&nbsp;<span class="ident" id="2563141"><a href="/net/dnsmsg.go.html#2562623">off</a></span><span class="op" id="2563144">,</span>&nbsp;<span class="ident" id="2563146"><a href="/net/dnsmsg.go.html#2562653">ok</a></span><br>
<span class="lineno">710</span><span class="op" id="2563149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2563152">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2563195">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="2563241">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="2563289">type</span>&nbsp;<span class="ident" id="2563294">dnsMsgHdr</span>&nbsp;<span class="keyword" id="2563304">struct</span>&nbsp;<span class="op" id="2563311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563314">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2563334">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563342">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2563362">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563368">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2563388">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563393">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2563413">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563419">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2563439">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563445">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2563465">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563471">recursion_available</span>&nbsp;<span class="builtintype" id="2563491">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563497">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2563517">int</span><br>
<span class="lineno">725</span><span class="op" id="2563521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2563524">func</span>&nbsp;<span class="op" id="2563529">(</span><span class="ident" id="2563530">h</span>&nbsp;<span class="op" id="2563532">*</span><span class="ident" id="2563533"><a href="/net/dnsmsg.go.html#2563294">dnsMsgHdr</a></span><span class="op" id="2563542">)</span>&nbsp;<span class="ident" id="2563544">Walk</span><span class="op" id="2563548">(</span><span class="ident" id="2563549">f</span>&nbsp;<span class="keyword" id="2563551">func</span><span class="op" id="2563555">(</span><span class="ident" id="2563556">v</span>&nbsp;<span class="keyword" id="2563558">interface</span><span class="op" id="2563567">{</span><span class="op" id="2563568">}</span><span class="op" id="2563569">,</span>&nbsp;<span class="ident" id="2563571">name</span><span class="op" id="2563575">,</span>&nbsp;<span class="ident" id="2563577">tag</span>&nbsp;<span class="builtintype" id="2563581">string</span><span class="op" id="2563587">)</span>&nbsp;<span class="builtintype" id="2563589">bool</span><span class="op" id="2563593">)</span>&nbsp;<span class="builtintype" id="2563595">bool</span>&nbsp;<span class="op" id="2563600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2563603">return</span>&nbsp;<span class="ident" id="2563610"><a href="/net/dnsmsg.go.html#2563549">f</a></span><span class="op" id="2563611">(</span><span class="op" id="2563612">&amp;</span><span class="ident" id="2563613"><a href="/net/dnsmsg.go.html#2563530">h</a></span><span class="op" id="2563614">.</span><span class="ident" id="2563615">id</span><span class="op" id="2563617">,</span>&nbsp;<span class="string" id="2563619">&#34;id&#34;</span><span class="op" id="2563623">,</span>&nbsp;<span class="string" id="2563625">&#34;&#34;</span><span class="op" id="2563627">)</span>&nbsp;<span class="op" id="2563629">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563634"><a href="/net/dnsmsg.go.html#2563549">f</a></span><span class="op" id="2563635">(</span><span class="op" id="2563636">&amp;</span><span class="ident" id="2563637"><a href="/net/dnsmsg.go.html#2563530">h</a></span><span class="op" id="2563638">.</span><span class="ident" id="2563639">response</span><span class="op" id="2563647">,</span>&nbsp;<span class="string" id="2563649">&#34;response&#34;</span><span class="op" id="2563659">,</span>&nbsp;<span class="string" id="2563661">&#34;&#34;</span><span class="op" id="2563663">)</span>&nbsp;<span class="op" id="2563665">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563670"><a href="/net/dnsmsg.go.html#2563549">f</a></span><span class="op" id="2563671">(</span><span class="op" id="2563672">&amp;</span><span class="ident" id="2563673"><a href="/net/dnsmsg.go.html#2563530">h</a></span><span class="op" id="2563674">.</span><span class="ident" id="2563675">opcode</span><span class="op" id="2563681">,</span>&nbsp;<span class="string" id="2563683">&#34;opcode&#34;</span><span class="op" id="2563691">,</span>&nbsp;<span class="string" id="2563693">&#34;&#34;</span><span class="op" id="2563695">)</span>&nbsp;<span class="op" id="2563697">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563702"><a href="/net/dnsmsg.go.html#2563549">f</a></span><span class="op" id="2563703">(</span><span class="op" id="2563704">&amp;</span><span class="ident" id="2563705"><a href="/net/dnsmsg.go.html#2563530">h</a></span><span class="op" id="2563706">.</span><span class="ident" id="2563707">authoritative</span><span class="op" id="2563720">,</span>&nbsp;<span class="string" id="2563722">&#34;authoritative&#34;</span><span class="op" id="2563737">,</span>&nbsp;<span class="string" id="2563739">&#34;&#34;</span><span class="op" id="2563741">)</span>&nbsp;<span class="op" id="2563743">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563748"><a href="/net/dnsmsg.go.html#2563549">f</a></span><span class="op" id="2563749">(</span><span class="op" id="2563750">&amp;</span><span class="ident" id="2563751"><a href="/net/dnsmsg.go.html#2563530">h</a></span><span class="op" id="2563752">.</span><span class="ident" id="2563753">truncated</span><span class="op" id="2563762">,</span>&nbsp;<span class="string" id="2563764">&#34;truncated&#34;</span><span class="op" id="2563775">,</span>&nbsp;<span class="string" id="2563777">&#34;&#34;</span><span class="op" id="2563779">)</span>&nbsp;<span class="op" id="2563781">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563786"><a href="/net/dnsmsg.go.html#2563549">f</a></span><span class="op" id="2563787">(</span><span class="op" id="2563788">&amp;</span><span class="ident" id="2563789"><a href="/net/dnsmsg.go.html#2563530">h</a></span><span class="op" id="2563790">.</span><span class="ident" id="2563791">recursion_desired</span><span class="op" id="2563808">,</span>&nbsp;<span class="string" id="2563810">&#34;recursion_desired&#34;</span><span class="op" id="2563829">,</span>&nbsp;<span class="string" id="2563831">&#34;&#34;</span><span class="op" id="2563833">)</span>&nbsp;<span class="op" id="2563835">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563840"><a href="/net/dnsmsg.go.html#2563549">f</a></span><span class="op" id="2563841">(</span><span class="op" id="2563842">&amp;</span><span class="ident" id="2563843"><a href="/net/dnsmsg.go.html#2563530">h</a></span><span class="op" id="2563844">.</span><span class="ident" id="2563845">recursion_available</span><span class="op" id="2563864">,</span>&nbsp;<span class="string" id="2563866">&#34;recursion_available&#34;</span><span class="op" id="2563887">,</span>&nbsp;<span class="string" id="2563889">&#34;&#34;</span><span class="op" id="2563891">)</span>&nbsp;<span class="op" id="2563893">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563898"><a href="/net/dnsmsg.go.html#2563549">f</a></span><span class="op" id="2563899">(</span><span class="op" id="2563900">&amp;</span><span class="ident" id="2563901"><a href="/net/dnsmsg.go.html#2563530">h</a></span><span class="op" id="2563902">.</span><span class="ident" id="2563903">rcode</span><span class="op" id="2563908">,</span>&nbsp;<span class="string" id="2563910">&#34;rcode&#34;</span><span class="op" id="2563917">,</span>&nbsp;<span class="string" id="2563919">&#34;&#34;</span><span class="op" id="2563921">)</span><br>
<span class="lineno"></span><span class="op" id="2563923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2563926">type</span>&nbsp;<span class="ident" id="2563931">dnsMsg</span>&nbsp;<span class="keyword" id="2563938">struct</span>&nbsp;<span class="op" id="2563945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563948"><a href="/net/dnsmsg.go.html#2563294">dnsMsgHdr</a></span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563959">question</span>&nbsp;<span class="op" id="2563968">[</span><span class="op" id="2563969">]</span><span class="ident" id="2563970"><a href="/net/dnsmsg.go.html#2548921">dnsQuestion</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563983">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2563992">[</span><span class="op" id="2563993">]</span><span class="ident" id="2563994"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564001">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2564010">[</span><span class="op" id="2564011">]</span><span class="ident" id="2564012"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564019">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2564028">[</span><span class="op" id="2564029">]</span><span class="ident" id="2564030"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><br>
<span class="lineno"></span><span class="op" id="2564036">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="2564039">func</span>&nbsp;<span class="op" id="2564044">(</span><span class="ident" id="2564045">dns</span>&nbsp;<span class="op" id="2564049">*</span><span class="ident" id="2564050"><a href="/net/dnsmsg.go.html#2563931">dnsMsg</a></span><span class="op" id="2564056">)</span>&nbsp;<span class="ident" id="2564058">Pack</span><span class="op" id="2564062">(</span><span class="op" id="2564063">)</span>&nbsp;<span class="op" id="2564065">(</span><span class="ident" id="2564066">msg</span>&nbsp;<span class="op" id="2564070">[</span><span class="op" id="2564071">]</span><span class="builtintype" id="2564072">byte</span><span class="op" id="2564076">,</span>&nbsp;<span class="ident" id="2564078">ok</span>&nbsp;<span class="builtintype" id="2564081">bool</span><span class="op" id="2564085">)</span>&nbsp;<span class="op" id="2564087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2564090">var</span>&nbsp;<span class="ident" id="2564094">dh</span>&nbsp;<span class="ident" id="2564097"><a href="/net/dnsmsg.go.html#2548267">dnsHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2564109">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564165"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564167">.</span><span class="ident" id="2564168">Id</span>&nbsp;<span class="op" id="2564171">=</span>&nbsp;<span class="ident" id="2564173"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564176">.</span><span class="ident" id="2564177">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564181"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564183">.</span><span class="ident" id="2564184">Bits</span>&nbsp;<span class="op" id="2564189">=</span>&nbsp;<span class="builtintype" id="2564191">uint16</span><span class="op" id="2564197">(</span><span class="ident" id="2564198"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564201">.</span><span class="ident" id="2564202">opcode</span><span class="op" id="2564208">)</span><span class="op" id="2564209">&lt;&lt;</span><span class="num" id="2564211">11</span>&nbsp;<span class="op" id="2564214">|</span>&nbsp;<span class="builtintype" id="2564216">uint16</span><span class="op" id="2564222">(</span><span class="ident" id="2564223"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564226">.</span><span class="ident" id="2564227">rcode</span><span class="op" id="2564232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2564235">if</span>&nbsp;<span class="ident" id="2564238"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564241">.</span><span class="ident" id="2564242">recursion_available</span>&nbsp;<span class="op" id="2564262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564266"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564268">.</span><span class="ident" id="2564269">Bits</span>&nbsp;<span class="op" id="2564274">|=</span>&nbsp;<span class="ident" id="2564277"><a href="/net/dnsmsg.go.html#2548860">_RA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2564282">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2564285">if</span>&nbsp;<span class="ident" id="2564288"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564291">.</span><span class="ident" id="2564292">recursion_desired</span>&nbsp;<span class="op" id="2564310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564314"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564316">.</span><span class="ident" id="2564317">Bits</span>&nbsp;<span class="op" id="2564322">|=</span>&nbsp;<span class="ident" id="2564325"><a href="/net/dnsmsg.go.html#2548824">_RD</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2564330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2564333">if</span>&nbsp;<span class="ident" id="2564336"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564339">.</span><span class="ident" id="2564340">truncated</span>&nbsp;<span class="op" id="2564350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564354"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564356">.</span><span class="ident" id="2564357">Bits</span>&nbsp;<span class="op" id="2564362">|=</span>&nbsp;<span class="ident" id="2564365"><a href="/net/dnsmsg.go.html#2548796">_TC</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2564370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2564373">if</span>&nbsp;<span class="ident" id="2564376"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564379">.</span><span class="ident" id="2564380">authoritative</span>&nbsp;<span class="op" id="2564394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564398"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564400">.</span><span class="ident" id="2564401">Bits</span>&nbsp;<span class="op" id="2564406">|=</span>&nbsp;<span class="ident" id="2564409"><a href="/net/dnsmsg.go.html#2548764">_AA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2564414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2564417">if</span>&nbsp;<span class="ident" id="2564420"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564423">.</span><span class="ident" id="2564424">response</span>&nbsp;<span class="op" id="2564433">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564437"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564439">.</span><span class="ident" id="2564440">Bits</span>&nbsp;<span class="op" id="2564445">|=</span>&nbsp;<span class="ident" id="2564448"><a href="/net/dnsmsg.go.html#2548718">_QR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2564453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2564457">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564492">question</span>&nbsp;<span class="op" id="2564501">:=</span>&nbsp;<span class="ident" id="2564504"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564507">.</span><span class="ident" id="2564508">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564518">answer</span>&nbsp;<span class="op" id="2564525">:=</span>&nbsp;<span class="ident" id="2564528"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564531">.</span><span class="ident" id="2564532">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564540">ns</span>&nbsp;<span class="op" id="2564543">:=</span>&nbsp;<span class="ident" id="2564546"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564549">.</span><span class="ident" id="2564550">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564554">extra</span>&nbsp;<span class="op" id="2564560">:=</span>&nbsp;<span class="ident" id="2564563"><a href="/net/dnsmsg.go.html#2564045">dns</a></span><span class="op" id="2564566">.</span><span class="ident" id="2564567">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564575"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564577">.</span><span class="ident" id="2564578">Qdcount</span>&nbsp;<span class="op" id="2564586">=</span>&nbsp;<span class="builtintype" id="2564588">uint16</span><span class="op" id="2564594">(</span><span class="builtinfunc" id="2564595">len</span><span class="op" id="2564598">(</span><span class="ident" id="2564599"><a href="/net/dnsmsg.go.html#2564492">question</a></span><span class="op" id="2564607">)</span><span class="op" id="2564608">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564611"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564613">.</span><span class="ident" id="2564614">Ancount</span>&nbsp;<span class="op" id="2564622">=</span>&nbsp;<span class="builtintype" id="2564624">uint16</span><span class="op" id="2564630">(</span><span class="builtinfunc" id="2564631">len</span><span class="op" id="2564634">(</span><span class="ident" id="2564635"><a href="/net/dnsmsg.go.html#2564518">answer</a></span><span class="op" id="2564641">)</span><span class="op" id="2564642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564645"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564647">.</span><span class="ident" id="2564648">Nscount</span>&nbsp;<span class="op" id="2564656">=</span>&nbsp;<span class="builtintype" id="2564658">uint16</span><span class="op" id="2564664">(</span><span class="builtinfunc" id="2564665">len</span><span class="op" id="2564668">(</span><span class="ident" id="2564669"><a href="/net/dnsmsg.go.html#2564540">ns</a></span><span class="op" id="2564671">)</span><span class="op" id="2564672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564675"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564677">.</span><span class="ident" id="2564678">Arcount</span>&nbsp;<span class="op" id="2564686">=</span>&nbsp;<span class="builtintype" id="2564688">uint16</span><span class="op" id="2564694">(</span><span class="builtinfunc" id="2564695">len</span><span class="op" id="2564698">(</span><span class="ident" id="2564699"><a href="/net/dnsmsg.go.html#2564554">extra</a></span><span class="op" id="2564704">)</span><span class="op" id="2564705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2564709">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2564758">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2564804">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564842"><a href="/net/dnsmsg.go.html#2564066">msg</a></span>&nbsp;<span class="op" id="2564846">=</span>&nbsp;<span class="builtinfunc" id="2564848">make</span><span class="op" id="2564852">(</span><span class="op" id="2564853">[</span><span class="op" id="2564854">]</span><span class="builtintype" id="2564855">byte</span><span class="op" id="2564859">,</span>&nbsp;<span class="num" id="2564861">2000</span><span class="op" id="2564865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2564869">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564913">off</span>&nbsp;<span class="op" id="2564917">:=</span>&nbsp;<span class="num" id="2564920">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564923"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2564926">,</span>&nbsp;<span class="ident" id="2564928"><a href="/net/dnsmsg.go.html#2564078">ok</a></span>&nbsp;<span class="op" id="2564931">=</span>&nbsp;<span class="ident" id="2564933"><a href="/net/dnsmsg.go.html#2558426">packStruct</a></span><span class="op" id="2564943">(</span><span class="op" id="2564944">&amp;</span><span class="ident" id="2564945"><a href="/net/dnsmsg.go.html#2564094">dh</a></span><span class="op" id="2564947">,</span>&nbsp;<span class="ident" id="2564949"><a href="/net/dnsmsg.go.html#2564066">msg</a></span><span class="op" id="2564952">,</span>&nbsp;<span class="ident" id="2564954"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2564957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2564960">for</span>&nbsp;<span class="ident" id="2564964">i</span>&nbsp;<span class="op" id="2564966">:=</span>&nbsp;<span class="num" id="2564969">0</span><span class="op" id="2564970">;</span>&nbsp;<span class="ident" id="2564972"><a href="/net/dnsmsg.go.html#2564964">i</a></span>&nbsp;<span class="op" id="2564974">&lt;</span>&nbsp;<span class="builtinfunc" id="2564976">len</span><span class="op" id="2564979">(</span><span class="ident" id="2564980"><a href="/net/dnsmsg.go.html#2564492">question</a></span><span class="op" id="2564988">)</span><span class="op" id="2564989">;</span>&nbsp;<span class="ident" id="2564991"><a href="/net/dnsmsg.go.html#2564964">i</a></span><span class="op" id="2564992">++</span>&nbsp;<span class="op" id="2564995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564999"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565002">,</span>&nbsp;<span class="ident" id="2565004"><a href="/net/dnsmsg.go.html#2564078">ok</a></span>&nbsp;<span class="op" id="2565007">=</span>&nbsp;<span class="ident" id="2565009"><a href="/net/dnsmsg.go.html#2558426">packStruct</a></span><span class="op" id="2565019">(</span><span class="op" id="2565020">&amp;</span><span class="ident" id="2565021"><a href="/net/dnsmsg.go.html#2564492">question</a></span><span class="op" id="2565029">[</span><span class="ident" id="2565030"><a href="/net/dnsmsg.go.html#2564964">i</a></span><span class="op" id="2565031">]</span><span class="op" id="2565032">,</span>&nbsp;<span class="ident" id="2565034"><a href="/net/dnsmsg.go.html#2564066">msg</a></span><span class="op" id="2565037">,</span>&nbsp;<span class="ident" id="2565039"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2565045">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565048">for</span>&nbsp;<span class="ident" id="2565052">i</span>&nbsp;<span class="op" id="2565054">:=</span>&nbsp;<span class="num" id="2565057">0</span><span class="op" id="2565058">;</span>&nbsp;<span class="ident" id="2565060"><a href="/net/dnsmsg.go.html#2565052">i</a></span>&nbsp;<span class="op" id="2565062">&lt;</span>&nbsp;<span class="builtinfunc" id="2565064">len</span><span class="op" id="2565067">(</span><span class="ident" id="2565068"><a href="/net/dnsmsg.go.html#2564518">answer</a></span><span class="op" id="2565074">)</span><span class="op" id="2565075">;</span>&nbsp;<span class="ident" id="2565077"><a href="/net/dnsmsg.go.html#2565052">i</a></span><span class="op" id="2565078">++</span>&nbsp;<span class="op" id="2565081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565085"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565088">,</span>&nbsp;<span class="ident" id="2565090"><a href="/net/dnsmsg.go.html#2564078">ok</a></span>&nbsp;<span class="op" id="2565093">=</span>&nbsp;<span class="ident" id="2565095"><a href="/net/dnsmsg.go.html#2562028">packRR</a></span><span class="op" id="2565101">(</span><span class="ident" id="2565102"><a href="/net/dnsmsg.go.html#2564518">answer</a></span><span class="op" id="2565108">[</span><span class="ident" id="2565109"><a href="/net/dnsmsg.go.html#2565052">i</a></span><span class="op" id="2565110">]</span><span class="op" id="2565111">,</span>&nbsp;<span class="ident" id="2565113"><a href="/net/dnsmsg.go.html#2564066">msg</a></span><span class="op" id="2565116">,</span>&nbsp;<span class="ident" id="2565118"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2565124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565127">for</span>&nbsp;<span class="ident" id="2565131">i</span>&nbsp;<span class="op" id="2565133">:=</span>&nbsp;<span class="num" id="2565136">0</span><span class="op" id="2565137">;</span>&nbsp;<span class="ident" id="2565139"><a href="/net/dnsmsg.go.html#2565131">i</a></span>&nbsp;<span class="op" id="2565141">&lt;</span>&nbsp;<span class="builtinfunc" id="2565143">len</span><span class="op" id="2565146">(</span><span class="ident" id="2565147"><a href="/net/dnsmsg.go.html#2564540">ns</a></span><span class="op" id="2565149">)</span><span class="op" id="2565150">;</span>&nbsp;<span class="ident" id="2565152"><a href="/net/dnsmsg.go.html#2565131">i</a></span><span class="op" id="2565153">++</span>&nbsp;<span class="op" id="2565156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565160"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565163">,</span>&nbsp;<span class="ident" id="2565165"><a href="/net/dnsmsg.go.html#2564078">ok</a></span>&nbsp;<span class="op" id="2565168">=</span>&nbsp;<span class="ident" id="2565170"><a href="/net/dnsmsg.go.html#2562028">packRR</a></span><span class="op" id="2565176">(</span><span class="ident" id="2565177"><a href="/net/dnsmsg.go.html#2564540">ns</a></span><span class="op" id="2565179">[</span><span class="ident" id="2565180"><a href="/net/dnsmsg.go.html#2565131">i</a></span><span class="op" id="2565181">]</span><span class="op" id="2565182">,</span>&nbsp;<span class="ident" id="2565184"><a href="/net/dnsmsg.go.html#2564066">msg</a></span><span class="op" id="2565187">,</span>&nbsp;<span class="ident" id="2565189"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565192">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2565195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565198">for</span>&nbsp;<span class="ident" id="2565202">i</span>&nbsp;<span class="op" id="2565204">:=</span>&nbsp;<span class="num" id="2565207">0</span><span class="op" id="2565208">;</span>&nbsp;<span class="ident" id="2565210"><a href="/net/dnsmsg.go.html#2565202">i</a></span>&nbsp;<span class="op" id="2565212">&lt;</span>&nbsp;<span class="builtinfunc" id="2565214">len</span><span class="op" id="2565217">(</span><span class="ident" id="2565218"><a href="/net/dnsmsg.go.html#2564554">extra</a></span><span class="op" id="2565223">)</span><span class="op" id="2565224">;</span>&nbsp;<span class="ident" id="2565226"><a href="/net/dnsmsg.go.html#2565202">i</a></span><span class="op" id="2565227">++</span>&nbsp;<span class="op" id="2565230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565234"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565237">,</span>&nbsp;<span class="ident" id="2565239"><a href="/net/dnsmsg.go.html#2564078">ok</a></span>&nbsp;<span class="op" id="2565242">=</span>&nbsp;<span class="ident" id="2565244"><a href="/net/dnsmsg.go.html#2562028">packRR</a></span><span class="op" id="2565250">(</span><span class="ident" id="2565251"><a href="/net/dnsmsg.go.html#2564554">extra</a></span><span class="op" id="2565256">[</span><span class="ident" id="2565257"><a href="/net/dnsmsg.go.html#2565202">i</a></span><span class="op" id="2565258">]</span><span class="op" id="2565259">,</span>&nbsp;<span class="ident" id="2565261"><a href="/net/dnsmsg.go.html#2564066">msg</a></span><span class="op" id="2565264">,</span>&nbsp;<span class="ident" id="2565266"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2565272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565275">if</span>&nbsp;<span class="op" id="2565278">!</span><span class="ident" id="2565279"><a href="/net/dnsmsg.go.html#2564078">ok</a></span>&nbsp;<span class="op" id="2565282">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565286">return</span>&nbsp;<span class="ident" id="2565293">nil</span><span class="op" id="2565296">,</span>&nbsp;<span class="ident" id="2565298">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2565305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565308">return</span>&nbsp;<span class="ident" id="2565315"><a href="/net/dnsmsg.go.html#2564066">msg</a></span><span class="op" id="2565318">[</span><span class="num" id="2565319">0</span><span class="op" id="2565320">:</span><span class="ident" id="2565321"><a href="/net/dnsmsg.go.html#2564913">off</a></span><span class="op" id="2565324">]</span><span class="op" id="2565325">,</span>&nbsp;<span class="ident" id="2565327">true</span><br>
<span class="lineno"></span><span class="op" id="2565332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="2565335">func</span>&nbsp;<span class="op" id="2565340">(</span><span class="ident" id="2565341">dns</span>&nbsp;<span class="op" id="2565345">*</span><span class="ident" id="2565346"><a href="/net/dnsmsg.go.html#2563931">dnsMsg</a></span><span class="op" id="2565352">)</span>&nbsp;<span class="ident" id="2565354">Unpack</span><span class="op" id="2565360">(</span><span class="ident" id="2565361">msg</span>&nbsp;<span class="op" id="2565365">[</span><span class="op" id="2565366">]</span><span class="builtintype" id="2565367">byte</span><span class="op" id="2565371">)</span>&nbsp;<span class="builtintype" id="2565373">bool</span>&nbsp;<span class="op" id="2565378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2565381">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565393">var</span>&nbsp;<span class="ident" id="2565397">dh</span>&nbsp;<span class="ident" id="2565400"><a href="/net/dnsmsg.go.html#2548267">dnsHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565411">off</span>&nbsp;<span class="op" id="2565415">:=</span>&nbsp;<span class="num" id="2565418">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565421">var</span>&nbsp;<span class="ident" id="2565425">ok</span>&nbsp;<span class="builtintype" id="2565428">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565434">if</span>&nbsp;<span class="ident" id="2565437"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2565440">,</span>&nbsp;<span class="ident" id="2565442"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2565445">=</span>&nbsp;<span class="ident" id="2565447"><a href="/net/dnsmsg.go.html#2559695">unpackStruct</a></span><span class="op" id="2565459">(</span><span class="op" id="2565460">&amp;</span><span class="ident" id="2565461"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565463">,</span>&nbsp;<span class="ident" id="2565465"><a href="/net/dnsmsg.go.html#2565361">msg</a></span><span class="op" id="2565468">,</span>&nbsp;<span class="ident" id="2565470"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2565473">)</span><span class="op" id="2565474">;</span>&nbsp;<span class="op" id="2565476">!</span><span class="ident" id="2565477"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2565480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565484">return</span>&nbsp;<span class="ident" id="2565491">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2565498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565501"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565504">.</span><span class="ident" id="2565505">id</span>&nbsp;<span class="op" id="2565508">=</span>&nbsp;<span class="ident" id="2565510"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565512">.</span><span class="ident" id="2565513">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565517"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565520">.</span><span class="ident" id="2565521">response</span>&nbsp;<span class="op" id="2565530">=</span>&nbsp;<span class="op" id="2565532">(</span><span class="ident" id="2565533"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565535">.</span><span class="ident" id="2565536">Bits</span>&nbsp;<span class="op" id="2565541">&amp;</span>&nbsp;<span class="ident" id="2565543"><a href="/net/dnsmsg.go.html#2548718">_QR</a></span><span class="op" id="2565546">)</span>&nbsp;<span class="op" id="2565548">!=</span>&nbsp;<span class="num" id="2565551">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565554"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565557">.</span><span class="ident" id="2565558">opcode</span>&nbsp;<span class="op" id="2565565">=</span>&nbsp;<span class="builtintype" id="2565567">int</span><span class="op" id="2565570">(</span><span class="ident" id="2565571"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565573">.</span><span class="ident" id="2565574">Bits</span><span class="op" id="2565578">&gt;&gt;</span><span class="num" id="2565580">11</span><span class="op" id="2565582">)</span>&nbsp;<span class="op" id="2565584">&amp;</span>&nbsp;<span class="num" id="2565586">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565591"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565594">.</span><span class="ident" id="2565595">authoritative</span>&nbsp;<span class="op" id="2565609">=</span>&nbsp;<span class="op" id="2565611">(</span><span class="ident" id="2565612"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565614">.</span><span class="ident" id="2565615">Bits</span>&nbsp;<span class="op" id="2565620">&amp;</span>&nbsp;<span class="ident" id="2565622"><a href="/net/dnsmsg.go.html#2548764">_AA</a></span><span class="op" id="2565625">)</span>&nbsp;<span class="op" id="2565627">!=</span>&nbsp;<span class="num" id="2565630">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565633"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565636">.</span><span class="ident" id="2565637">truncated</span>&nbsp;<span class="op" id="2565647">=</span>&nbsp;<span class="op" id="2565649">(</span><span class="ident" id="2565650"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565652">.</span><span class="ident" id="2565653">Bits</span>&nbsp;<span class="op" id="2565658">&amp;</span>&nbsp;<span class="ident" id="2565660"><a href="/net/dnsmsg.go.html#2548796">_TC</a></span><span class="op" id="2565663">)</span>&nbsp;<span class="op" id="2565665">!=</span>&nbsp;<span class="num" id="2565668">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565671"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565674">.</span><span class="ident" id="2565675">recursion_desired</span>&nbsp;<span class="op" id="2565693">=</span>&nbsp;<span class="op" id="2565695">(</span><span class="ident" id="2565696"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565698">.</span><span class="ident" id="2565699">Bits</span>&nbsp;<span class="op" id="2565704">&amp;</span>&nbsp;<span class="ident" id="2565706"><a href="/net/dnsmsg.go.html#2548824">_RD</a></span><span class="op" id="2565709">)</span>&nbsp;<span class="op" id="2565711">!=</span>&nbsp;<span class="num" id="2565714">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565717"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565720">.</span><span class="ident" id="2565721">recursion_available</span>&nbsp;<span class="op" id="2565741">=</span>&nbsp;<span class="op" id="2565743">(</span><span class="ident" id="2565744"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565746">.</span><span class="ident" id="2565747">Bits</span>&nbsp;<span class="op" id="2565752">&amp;</span>&nbsp;<span class="ident" id="2565754"><a href="/net/dnsmsg.go.html#2548860">_RA</a></span><span class="op" id="2565757">)</span>&nbsp;<span class="op" id="2565759">!=</span>&nbsp;<span class="num" id="2565762">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565765"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565768">.</span><span class="ident" id="2565769">rcode</span>&nbsp;<span class="op" id="2565775">=</span>&nbsp;<span class="builtintype" id="2565777">int</span><span class="op" id="2565780">(</span><span class="ident" id="2565781"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565783">.</span><span class="ident" id="2565784">Bits</span>&nbsp;<span class="op" id="2565789">&amp;</span>&nbsp;<span class="num" id="2565791">0xF</span><span class="op" id="2565794">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2565798">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565810"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565813">.</span><span class="ident" id="2565814">question</span>&nbsp;<span class="op" id="2565823">=</span>&nbsp;<span class="builtinfunc" id="2565825">make</span><span class="op" id="2565829">(</span><span class="op" id="2565830">[</span><span class="op" id="2565831">]</span><span class="ident" id="2565832"><a href="/net/dnsmsg.go.html#2548921">dnsQuestion</a></span><span class="op" id="2565843">,</span>&nbsp;<span class="ident" id="2565845"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565847">.</span><span class="ident" id="2565848">Qdcount</span><span class="op" id="2565855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565858"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565861">.</span><span class="ident" id="2565862">answer</span>&nbsp;<span class="op" id="2565869">=</span>&nbsp;<span class="builtinfunc" id="2565871">make</span><span class="op" id="2565875">(</span><span class="op" id="2565876">[</span><span class="op" id="2565877">]</span><span class="ident" id="2565878"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><span class="op" id="2565883">,</span>&nbsp;<span class="num" id="2565885">0</span><span class="op" id="2565886">,</span>&nbsp;<span class="ident" id="2565888"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565890">.</span><span class="ident" id="2565891">Ancount</span><span class="op" id="2565898">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565901"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565904">.</span><span class="ident" id="2565905">ns</span>&nbsp;<span class="op" id="2565908">=</span>&nbsp;<span class="builtinfunc" id="2565910">make</span><span class="op" id="2565914">(</span><span class="op" id="2565915">[</span><span class="op" id="2565916">]</span><span class="ident" id="2565917"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><span class="op" id="2565922">,</span>&nbsp;<span class="num" id="2565924">0</span><span class="op" id="2565925">,</span>&nbsp;<span class="ident" id="2565927"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565929">.</span><span class="ident" id="2565930">Nscount</span><span class="op" id="2565937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565940"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2565943">.</span><span class="ident" id="2565944">extra</span>&nbsp;<span class="op" id="2565950">=</span>&nbsp;<span class="builtinfunc" id="2565952">make</span><span class="op" id="2565956">(</span><span class="op" id="2565957">[</span><span class="op" id="2565958">]</span><span class="ident" id="2565959"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><span class="op" id="2565964">,</span>&nbsp;<span class="num" id="2565966">0</span><span class="op" id="2565967">,</span>&nbsp;<span class="ident" id="2565969"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2565971">.</span><span class="ident" id="2565972">Arcount</span><span class="op" id="2565979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565983">var</span>&nbsp;<span class="ident" id="2565987">rec</span>&nbsp;<span class="ident" id="2565991"><a href="/net/dnsmsg.go.html#2549843">dnsRR</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565999">for</span>&nbsp;<span class="ident" id="2566003">i</span>&nbsp;<span class="op" id="2566005">:=</span>&nbsp;<span class="num" id="2566008">0</span><span class="op" id="2566009">;</span>&nbsp;<span class="ident" id="2566011"><a href="/net/dnsmsg.go.html#2566003">i</a></span>&nbsp;<span class="op" id="2566013">&lt;</span>&nbsp;<span class="builtinfunc" id="2566015">len</span><span class="op" id="2566018">(</span><span class="ident" id="2566019"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2566022">.</span><span class="ident" id="2566023">question</span><span class="op" id="2566031">)</span><span class="op" id="2566032">;</span>&nbsp;<span class="ident" id="2566034"><a href="/net/dnsmsg.go.html#2566003">i</a></span><span class="op" id="2566035">++</span>&nbsp;<span class="op" id="2566038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566042"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2566045">,</span>&nbsp;<span class="ident" id="2566047"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2566050">=</span>&nbsp;<span class="ident" id="2566052"><a href="/net/dnsmsg.go.html#2559695">unpackStruct</a></span><span class="op" id="2566064">(</span><span class="op" id="2566065">&amp;</span><span class="ident" id="2566066"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2566069">.</span><span class="ident" id="2566070">question</span><span class="op" id="2566078">[</span><span class="ident" id="2566079"><a href="/net/dnsmsg.go.html#2566003">i</a></span><span class="op" id="2566080">]</span><span class="op" id="2566081">,</span>&nbsp;<span class="ident" id="2566083"><a href="/net/dnsmsg.go.html#2565361">msg</a></span><span class="op" id="2566086">,</span>&nbsp;<span class="ident" id="2566088"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2566091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566097">for</span>&nbsp;<span class="ident" id="2566101">i</span>&nbsp;<span class="op" id="2566103">:=</span>&nbsp;<span class="num" id="2566106">0</span><span class="op" id="2566107">;</span>&nbsp;<span class="ident" id="2566109"><a href="/net/dnsmsg.go.html#2566101">i</a></span>&nbsp;<span class="op" id="2566111">&lt;</span>&nbsp;<span class="builtintype" id="2566113">int</span><span class="op" id="2566116">(</span><span class="ident" id="2566117"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2566119">.</span><span class="ident" id="2566120">Ancount</span><span class="op" id="2566127">)</span><span class="op" id="2566128">;</span>&nbsp;<span class="ident" id="2566130"><a href="/net/dnsmsg.go.html#2566101">i</a></span><span class="op" id="2566131">++</span>&nbsp;<span class="op" id="2566134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566138"><a href="/net/dnsmsg.go.html#2565987">rec</a></span><span class="op" id="2566141">,</span>&nbsp;<span class="ident" id="2566143"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2566146">,</span>&nbsp;<span class="ident" id="2566148"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2566151">=</span>&nbsp;<span class="ident" id="2566153"><a href="/net/dnsmsg.go.html#2562602">unpackRR</a></span><span class="op" id="2566161">(</span><span class="ident" id="2566162"><a href="/net/dnsmsg.go.html#2565361">msg</a></span><span class="op" id="2566165">,</span>&nbsp;<span class="ident" id="2566167"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2566170">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566174">if</span>&nbsp;<span class="op" id="2566177">!</span><span class="ident" id="2566178"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2566181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566186">return</span>&nbsp;<span class="ident" id="2566193">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566205"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2566208">.</span><span class="ident" id="2566209">answer</span>&nbsp;<span class="op" id="2566216">=</span>&nbsp;<span class="builtinfunc" id="2566218">append</span><span class="op" id="2566224">(</span><span class="ident" id="2566225"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2566228">.</span><span class="ident" id="2566229">answer</span><span class="op" id="2566235">,</span>&nbsp;<span class="ident" id="2566237"><a href="/net/dnsmsg.go.html#2565987">rec</a></span><span class="op" id="2566240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566243">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566246">for</span>&nbsp;<span class="ident" id="2566250">i</span>&nbsp;<span class="op" id="2566252">:=</span>&nbsp;<span class="num" id="2566255">0</span><span class="op" id="2566256">;</span>&nbsp;<span class="ident" id="2566258"><a href="/net/dnsmsg.go.html#2566250">i</a></span>&nbsp;<span class="op" id="2566260">&lt;</span>&nbsp;<span class="builtintype" id="2566262">int</span><span class="op" id="2566265">(</span><span class="ident" id="2566266"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2566268">.</span><span class="ident" id="2566269">Nscount</span><span class="op" id="2566276">)</span><span class="op" id="2566277">;</span>&nbsp;<span class="ident" id="2566279"><a href="/net/dnsmsg.go.html#2566250">i</a></span><span class="op" id="2566280">++</span>&nbsp;<span class="op" id="2566283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566287"><a href="/net/dnsmsg.go.html#2565987">rec</a></span><span class="op" id="2566290">,</span>&nbsp;<span class="ident" id="2566292"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2566295">,</span>&nbsp;<span class="ident" id="2566297"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2566300">=</span>&nbsp;<span class="ident" id="2566302"><a href="/net/dnsmsg.go.html#2562602">unpackRR</a></span><span class="op" id="2566310">(</span><span class="ident" id="2566311"><a href="/net/dnsmsg.go.html#2565361">msg</a></span><span class="op" id="2566314">,</span>&nbsp;<span class="ident" id="2566316"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2566319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566323">if</span>&nbsp;<span class="op" id="2566326">!</span><span class="ident" id="2566327"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2566330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566335">return</span>&nbsp;<span class="ident" id="2566342">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566350">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566354"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2566357">.</span><span class="ident" id="2566358">ns</span>&nbsp;<span class="op" id="2566361">=</span>&nbsp;<span class="builtinfunc" id="2566363">append</span><span class="op" id="2566369">(</span><span class="ident" id="2566370"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2566373">.</span><span class="ident" id="2566374">ns</span><span class="op" id="2566376">,</span>&nbsp;<span class="ident" id="2566378"><a href="/net/dnsmsg.go.html#2565987">rec</a></span><span class="op" id="2566381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566387">for</span>&nbsp;<span class="ident" id="2566391">i</span>&nbsp;<span class="op" id="2566393">:=</span>&nbsp;<span class="num" id="2566396">0</span><span class="op" id="2566397">;</span>&nbsp;<span class="ident" id="2566399"><a href="/net/dnsmsg.go.html#2566391">i</a></span>&nbsp;<span class="op" id="2566401">&lt;</span>&nbsp;<span class="builtintype" id="2566403">int</span><span class="op" id="2566406">(</span><span class="ident" id="2566407"><a href="/net/dnsmsg.go.html#2565397">dh</a></span><span class="op" id="2566409">.</span><span class="ident" id="2566410">Arcount</span><span class="op" id="2566417">)</span><span class="op" id="2566418">;</span>&nbsp;<span class="ident" id="2566420"><a href="/net/dnsmsg.go.html#2566391">i</a></span><span class="op" id="2566421">++</span>&nbsp;<span class="op" id="2566424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566428"><a href="/net/dnsmsg.go.html#2565987">rec</a></span><span class="op" id="2566431">,</span>&nbsp;<span class="ident" id="2566433"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2566436">,</span>&nbsp;<span class="ident" id="2566438"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2566441">=</span>&nbsp;<span class="ident" id="2566443"><a href="/net/dnsmsg.go.html#2562602">unpackRR</a></span><span class="op" id="2566451">(</span><span class="ident" id="2566452"><a href="/net/dnsmsg.go.html#2565361">msg</a></span><span class="op" id="2566455">,</span>&nbsp;<span class="ident" id="2566457"><a href="/net/dnsmsg.go.html#2565411">off</a></span><span class="op" id="2566460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566464">if</span>&nbsp;<span class="op" id="2566467">!</span><span class="ident" id="2566468"><a href="/net/dnsmsg.go.html#2565425">ok</a></span>&nbsp;<span class="op" id="2566471">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566476">return</span>&nbsp;<span class="ident" id="2566483">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566495"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2566498">.</span><span class="ident" id="2566499">extra</span>&nbsp;<span class="op" id="2566505">=</span>&nbsp;<span class="builtinfunc" id="2566507">append</span><span class="op" id="2566513">(</span><span class="ident" id="2566514"><a href="/net/dnsmsg.go.html#2565341">dns</a></span><span class="op" id="2566517">.</span><span class="ident" id="2566518">extra</span><span class="op" id="2566523">,</span>&nbsp;<span class="ident" id="2566525"><a href="/net/dnsmsg.go.html#2565987">rec</a></span><span class="op" id="2566528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2566534">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2566559">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2566622">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566628">return</span>&nbsp;<span class="ident" id="2566635">true</span><br>
<span class="lineno"></span><span class="op" id="2566640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="2566643">func</span>&nbsp;<span class="op" id="2566648">(</span><span class="ident" id="2566649">dns</span>&nbsp;<span class="op" id="2566653">*</span><span class="ident" id="2566654"><a href="/net/dnsmsg.go.html#2563931">dnsMsg</a></span><span class="op" id="2566660">)</span>&nbsp;<span class="ident" id="2566662">String</span><span class="op" id="2566668">(</span><span class="op" id="2566669">)</span>&nbsp;<span class="builtintype" id="2566671">string</span>&nbsp;<span class="op" id="2566678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566681">s</span>&nbsp;<span class="op" id="2566683">:=</span>&nbsp;<span class="string" id="2566686">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="2566694">+</span>&nbsp;<span class="ident" id="2566696"><a href="/net/dnsmsg.go.html#2561010">printStruct</a></span><span class="op" id="2566707">(</span><span class="op" id="2566708">&amp;</span><span class="ident" id="2566709"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2566712">.</span><span class="ident" id="2566713">dnsMsgHdr</span><span class="op" id="2566722">)</span>&nbsp;<span class="op" id="2566724">+</span>&nbsp;<span class="string" id="2566726">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566732">if</span>&nbsp;<span class="builtinfunc" id="2566735">len</span><span class="op" id="2566738">(</span><span class="ident" id="2566739"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2566742">.</span><span class="ident" id="2566743">question</span><span class="op" id="2566751">)</span>&nbsp;<span class="op" id="2566753">&gt;</span>&nbsp;<span class="num" id="2566755">0</span>&nbsp;<span class="op" id="2566757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566761"><a href="/net/dnsmsg.go.html#2566681">s</a></span>&nbsp;<span class="op" id="2566763">+=</span>&nbsp;<span class="string" id="2566766">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566785">for</span>&nbsp;<span class="ident" id="2566789">i</span>&nbsp;<span class="op" id="2566791">:=</span>&nbsp;<span class="num" id="2566794">0</span><span class="op" id="2566795">;</span>&nbsp;<span class="ident" id="2566797"><a href="/net/dnsmsg.go.html#2566789">i</a></span>&nbsp;<span class="op" id="2566799">&lt;</span>&nbsp;<span class="builtinfunc" id="2566801">len</span><span class="op" id="2566804">(</span><span class="ident" id="2566805"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2566808">.</span><span class="ident" id="2566809">question</span><span class="op" id="2566817">)</span><span class="op" id="2566818">;</span>&nbsp;<span class="ident" id="2566820"><a href="/net/dnsmsg.go.html#2566789">i</a></span><span class="op" id="2566821">++</span>&nbsp;<span class="op" id="2566824">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566829"><a href="/net/dnsmsg.go.html#2566681">s</a></span>&nbsp;<span class="op" id="2566831">+=</span>&nbsp;<span class="ident" id="2566834"><a href="/net/dnsmsg.go.html#2561010">printStruct</a></span><span class="op" id="2566845">(</span><span class="op" id="2566846">&amp;</span><span class="ident" id="2566847"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2566850">.</span><span class="ident" id="2566851">question</span><span class="op" id="2566859">[</span><span class="ident" id="2566860"><a href="/net/dnsmsg.go.html#2566789">i</a></span><span class="op" id="2566861">]</span><span class="op" id="2566862">)</span>&nbsp;<span class="op" id="2566864">+</span>&nbsp;<span class="string" id="2566866">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566879">if</span>&nbsp;<span class="builtinfunc" id="2566882">len</span><span class="op" id="2566885">(</span><span class="ident" id="2566886"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2566889">.</span><span class="ident" id="2566890">answer</span><span class="op" id="2566896">)</span>&nbsp;<span class="op" id="2566898">&gt;</span>&nbsp;<span class="num" id="2566900">0</span>&nbsp;<span class="op" id="2566902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566906"><a href="/net/dnsmsg.go.html#2566681">s</a></span>&nbsp;<span class="op" id="2566908">+=</span>&nbsp;<span class="string" id="2566911">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566928">for</span>&nbsp;<span class="ident" id="2566932">i</span>&nbsp;<span class="op" id="2566934">:=</span>&nbsp;<span class="num" id="2566937">0</span><span class="op" id="2566938">;</span>&nbsp;<span class="ident" id="2566940"><a href="/net/dnsmsg.go.html#2566932">i</a></span>&nbsp;<span class="op" id="2566942">&lt;</span>&nbsp;<span class="builtinfunc" id="2566944">len</span><span class="op" id="2566947">(</span><span class="ident" id="2566948"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2566951">.</span><span class="ident" id="2566952">answer</span><span class="op" id="2566958">)</span><span class="op" id="2566959">;</span>&nbsp;<span class="ident" id="2566961"><a href="/net/dnsmsg.go.html#2566932">i</a></span><span class="op" id="2566962">++</span>&nbsp;<span class="op" id="2566965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566970"><a href="/net/dnsmsg.go.html#2566681">s</a></span>&nbsp;<span class="op" id="2566972">+=</span>&nbsp;<span class="ident" id="2566975"><a href="/net/dnsmsg.go.html#2561010">printStruct</a></span><span class="op" id="2566986">(</span><span class="ident" id="2566987"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2566990">.</span><span class="ident" id="2566991">answer</span><span class="op" id="2566997">[</span><span class="ident" id="2566998"><a href="/net/dnsmsg.go.html#2566932">i</a></span><span class="op" id="2566999">]</span><span class="op" id="2567000">)</span>&nbsp;<span class="op" id="2567002">+</span>&nbsp;<span class="string" id="2567004">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567017">if</span>&nbsp;<span class="builtinfunc" id="2567020">len</span><span class="op" id="2567023">(</span><span class="ident" id="2567024"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2567027">.</span><span class="ident" id="2567028">ns</span><span class="op" id="2567030">)</span>&nbsp;<span class="op" id="2567032">&gt;</span>&nbsp;<span class="num" id="2567034">0</span>&nbsp;<span class="op" id="2567036">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567040"><a href="/net/dnsmsg.go.html#2566681">s</a></span>&nbsp;<span class="op" id="2567042">+=</span>&nbsp;<span class="string" id="2567045">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567067">for</span>&nbsp;<span class="ident" id="2567071">i</span>&nbsp;<span class="op" id="2567073">:=</span>&nbsp;<span class="num" id="2567076">0</span><span class="op" id="2567077">;</span>&nbsp;<span class="ident" id="2567079"><a href="/net/dnsmsg.go.html#2567071">i</a></span>&nbsp;<span class="op" id="2567081">&lt;</span>&nbsp;<span class="builtinfunc" id="2567083">len</span><span class="op" id="2567086">(</span><span class="ident" id="2567087"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2567090">.</span><span class="ident" id="2567091">ns</span><span class="op" id="2567093">)</span><span class="op" id="2567094">;</span>&nbsp;<span class="ident" id="2567096"><a href="/net/dnsmsg.go.html#2567071">i</a></span><span class="op" id="2567097">++</span>&nbsp;<span class="op" id="2567100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567105"><a href="/net/dnsmsg.go.html#2566681">s</a></span>&nbsp;<span class="op" id="2567107">+=</span>&nbsp;<span class="ident" id="2567110"><a href="/net/dnsmsg.go.html#2561010">printStruct</a></span><span class="op" id="2567121">(</span><span class="ident" id="2567122"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2567125">.</span><span class="ident" id="2567126">ns</span><span class="op" id="2567128">[</span><span class="ident" id="2567129"><a href="/net/dnsmsg.go.html#2567071">i</a></span><span class="op" id="2567130">]</span><span class="op" id="2567131">)</span>&nbsp;<span class="op" id="2567133">+</span>&nbsp;<span class="string" id="2567135">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567145">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567148">if</span>&nbsp;<span class="builtinfunc" id="2567151">len</span><span class="op" id="2567154">(</span><span class="ident" id="2567155"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2567158">.</span><span class="ident" id="2567159">extra</span><span class="op" id="2567164">)</span>&nbsp;<span class="op" id="2567166">&gt;</span>&nbsp;<span class="num" id="2567168">0</span>&nbsp;<span class="op" id="2567170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567174"><a href="/net/dnsmsg.go.html#2566681">s</a></span>&nbsp;<span class="op" id="2567176">+=</span>&nbsp;<span class="string" id="2567179">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567194">for</span>&nbsp;<span class="ident" id="2567198">i</span>&nbsp;<span class="op" id="2567200">:=</span>&nbsp;<span class="num" id="2567203">0</span><span class="op" id="2567204">;</span>&nbsp;<span class="ident" id="2567206"><a href="/net/dnsmsg.go.html#2567198">i</a></span>&nbsp;<span class="op" id="2567208">&lt;</span>&nbsp;<span class="builtinfunc" id="2567210">len</span><span class="op" id="2567213">(</span><span class="ident" id="2567214"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2567217">.</span><span class="ident" id="2567218">extra</span><span class="op" id="2567223">)</span><span class="op" id="2567224">;</span>&nbsp;<span class="ident" id="2567226"><a href="/net/dnsmsg.go.html#2567198">i</a></span><span class="op" id="2567227">++</span>&nbsp;<span class="op" id="2567230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567235"><a href="/net/dnsmsg.go.html#2566681">s</a></span>&nbsp;<span class="op" id="2567237">+=</span>&nbsp;<span class="ident" id="2567240"><a href="/net/dnsmsg.go.html#2561010">printStruct</a></span><span class="op" id="2567251">(</span><span class="ident" id="2567252"><a href="/net/dnsmsg.go.html#2566649">dns</a></span><span class="op" id="2567255">.</span><span class="ident" id="2567256">extra</span><span class="op" id="2567261">[</span><span class="ident" id="2567262"><a href="/net/dnsmsg.go.html#2567198">i</a></span><span class="op" id="2567263">]</span><span class="op" id="2567264">)</span>&nbsp;<span class="op" id="2567266">+</span>&nbsp;<span class="string" id="2567268">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567275">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567281">return</span>&nbsp;<span class="ident" id="2567288"><a href="/net/dnsmsg.go.html#2566681">s</a></span><br>
<span class="lineno"></span><span class="op" id="2567290">}</span>
</div>
</body>
</html>
