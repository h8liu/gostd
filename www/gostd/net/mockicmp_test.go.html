<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html" class="current">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6663192">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6663248">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6663302">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6663353">package</span>&nbsp;<span class="ident" id="6663361">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6663366">import</span>&nbsp;<span class="string" id="6663373">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6663383">const</span>&nbsp;<span class="op" id="6663389">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663392">icmpv4EchoRequest</span>&nbsp;<span class="op" id="6663410">=</span>&nbsp;<span class="num" id="6663412">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663415">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6663433">=</span>&nbsp;<span class="num" id="6663435">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663438">icmpv6EchoRequest</span>&nbsp;<span class="op" id="6663456">=</span>&nbsp;<span class="num" id="6663458">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663463">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6663481">=</span>&nbsp;<span class="num" id="6663483">129</span><br>
<span class="lineno"></span><span class="op" id="6663487">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6663490">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6663533">type</span>&nbsp;<span class="ident" id="6663538">icmpMessage</span>&nbsp;<span class="keyword" id="6663550">struct</span>&nbsp;<span class="op" id="6663557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663560">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6663569">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6663585">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663594">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6663603">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6663619">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663628">Checksum</span>&nbsp;<span class="builtintype" id="6663637">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6663653">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663666">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6663675">icmpMessageBody</span>&nbsp;<span class="comment" id="6663691">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="6663699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6663702">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="6663754">type</span>&nbsp;<span class="ident" id="6663759">icmpMessageBody</span>&nbsp;<span class="keyword" id="6663775">interface</span>&nbsp;<span class="op" id="6663785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663788">Len</span><span class="op" id="6663791">(</span><span class="op" id="6663792">)</span>&nbsp;<span class="builtintype" id="6663794">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663799">Marshal</span><span class="op" id="6663806">(</span><span class="op" id="6663807">)</span>&nbsp;<span class="op" id="6663809">(</span><span class="op" id="6663810">[</span><span class="op" id="6663811">]</span><span class="builtintype" id="6663812">byte</span><span class="op" id="6663816">,</span>&nbsp;<span class="builtintype" id="6663818">error</span><span class="op" id="6663823">)</span><br>
<span class="lineno"></span><span class="op" id="6663825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="6663828">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6663896">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="6663916">func</span>&nbsp;<span class="op" id="6663921">(</span><span class="ident" id="6663922">m</span>&nbsp;<span class="op" id="6663924">*</span><span class="ident" id="6663925">icmpMessage</span><span class="op" id="6663936">)</span>&nbsp;<span class="ident" id="6663938">Marshal</span><span class="op" id="6663945">(</span><span class="op" id="6663946">)</span>&nbsp;<span class="op" id="6663948">(</span><span class="op" id="6663949">[</span><span class="op" id="6663950">]</span><span class="builtintype" id="6663951">byte</span><span class="op" id="6663955">,</span>&nbsp;<span class="builtintype" id="6663957">error</span><span class="op" id="6663962">)</span>&nbsp;<span class="op" id="6663964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663967">b</span>&nbsp;<span class="op" id="6663969">:=</span>&nbsp;<span class="op" id="6663972">[</span><span class="op" id="6663973">]</span><span class="builtintype" id="6663974">byte</span><span class="op" id="6663978">{</span><span class="builtintype" id="6663979">byte</span><span class="op" id="6663983">(</span><span class="ident" id="6663984">m</span><span class="op" id="6663985">.</span><span class="ident" id="6663986">Type</span><span class="op" id="6663990">)</span><span class="op" id="6663991">,</span>&nbsp;<span class="builtintype" id="6663993">byte</span><span class="op" id="6663997">(</span><span class="ident" id="6663998">m</span><span class="op" id="6663999">.</span><span class="ident" id="6664000">Code</span><span class="op" id="6664004">)</span><span class="op" id="6664005">,</span>&nbsp;<span class="num" id="6664007">0</span><span class="op" id="6664008">,</span>&nbsp;<span class="num" id="6664010">0</span><span class="op" id="6664011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664014">if</span>&nbsp;<span class="ident" id="6664017">m</span><span class="op" id="6664018">.</span><span class="ident" id="6664019">Body</span>&nbsp;<span class="op" id="6664024">!=</span>&nbsp;<span class="ident" id="6664027">nil</span>&nbsp;<span class="op" id="6664031">&amp;&amp;</span>&nbsp;<span class="ident" id="6664034">m</span><span class="op" id="6664035">.</span><span class="ident" id="6664036">Body</span><span class="op" id="6664040">.</span><span class="ident" id="6664041">Len</span><span class="op" id="6664044">(</span><span class="op" id="6664045">)</span>&nbsp;<span class="op" id="6664047">!=</span>&nbsp;<span class="num" id="6664050">0</span>&nbsp;<span class="op" id="6664052">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664056">mb</span><span class="op" id="6664058">,</span>&nbsp;<span class="ident" id="6664060">err</span>&nbsp;<span class="op" id="6664064">:=</span>&nbsp;<span class="ident" id="6664067">m</span><span class="op" id="6664068">.</span><span class="ident" id="6664069">Body</span><span class="op" id="6664073">.</span><span class="ident" id="6664074">Marshal</span><span class="op" id="6664081">(</span><span class="op" id="6664082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664086">if</span>&nbsp;<span class="ident" id="6664089">err</span>&nbsp;<span class="op" id="6664093">!=</span>&nbsp;<span class="ident" id="6664096">nil</span>&nbsp;<span class="op" id="6664100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664105">return</span>&nbsp;<span class="ident" id="6664112">nil</span><span class="op" id="6664115">,</span>&nbsp;<span class="ident" id="6664117">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664127">b</span>&nbsp;<span class="op" id="6664129">=</span>&nbsp;<span class="builtinfunc" id="6664131">append</span><span class="op" id="6664137">(</span><span class="ident" id="6664138">b</span><span class="op" id="6664139">,</span>&nbsp;<span class="ident" id="6664141">mb</span><span class="op" id="6664143">...</span><span class="op" id="6664146">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664152">switch</span>&nbsp;<span class="ident" id="6664159">m</span><span class="op" id="6664160">.</span><span class="ident" id="6664161">Type</span>&nbsp;<span class="op" id="6664166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664169">case</span>&nbsp;<span class="ident" id="6664174">icmpv6EchoRequest</span><span class="op" id="6664191">,</span>&nbsp;<span class="ident" id="6664193">icmpv6EchoReply</span><span class="op" id="6664208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664212">return</span>&nbsp;<span class="ident" id="6664219">b</span><span class="op" id="6664220">,</span>&nbsp;<span class="ident" id="6664222">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664227">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664230">csumcv</span>&nbsp;<span class="op" id="6664237">:=</span>&nbsp;<span class="builtinfunc" id="6664240">len</span><span class="op" id="6664243">(</span><span class="ident" id="6664244">b</span><span class="op" id="6664245">)</span>&nbsp;<span class="op" id="6664247">-</span>&nbsp;<span class="num" id="6664249">1</span>&nbsp;<span class="comment" id="6664251">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664273">s</span>&nbsp;<span class="op" id="6664275">:=</span>&nbsp;<span class="builtintype" id="6664278">uint32</span><span class="op" id="6664284">(</span><span class="num" id="6664285">0</span><span class="op" id="6664286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664289">for</span>&nbsp;<span class="ident" id="6664293">i</span>&nbsp;<span class="op" id="6664295">:=</span>&nbsp;<span class="num" id="6664298">0</span><span class="op" id="6664299">;</span>&nbsp;<span class="ident" id="6664301">i</span>&nbsp;<span class="op" id="6664303">&lt;</span>&nbsp;<span class="ident" id="6664305">csumcv</span><span class="op" id="6664311">;</span>&nbsp;<span class="ident" id="6664313">i</span>&nbsp;<span class="op" id="6664315">+=</span>&nbsp;<span class="num" id="6664318">2</span>&nbsp;<span class="op" id="6664320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664324">s</span>&nbsp;<span class="op" id="6664326">+=</span>&nbsp;<span class="builtintype" id="6664329">uint32</span><span class="op" id="6664335">(</span><span class="ident" id="6664336">b</span><span class="op" id="6664337">[</span><span class="ident" id="6664338">i</span><span class="op" id="6664339">+</span><span class="num" id="6664340">1</span><span class="op" id="6664341">]</span><span class="op" id="6664342">)</span><span class="op" id="6664343">&lt;&lt;</span><span class="num" id="6664345">8</span>&nbsp;<span class="op" id="6664347">|</span>&nbsp;<span class="builtintype" id="6664349">uint32</span><span class="op" id="6664355">(</span><span class="ident" id="6664356">b</span><span class="op" id="6664357">[</span><span class="ident" id="6664358">i</span><span class="op" id="6664359">]</span><span class="op" id="6664360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664363">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664366">if</span>&nbsp;<span class="ident" id="6664369">csumcv</span><span class="op" id="6664375">&amp;</span><span class="num" id="6664376">1</span>&nbsp;<span class="op" id="6664378">==</span>&nbsp;<span class="num" id="6664381">0</span>&nbsp;<span class="op" id="6664383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664387">s</span>&nbsp;<span class="op" id="6664389">+=</span>&nbsp;<span class="builtintype" id="6664392">uint32</span><span class="op" id="6664398">(</span><span class="ident" id="6664399">b</span><span class="op" id="6664400">[</span><span class="ident" id="6664401">csumcv</span><span class="op" id="6664407">]</span><span class="op" id="6664408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664414">s</span>&nbsp;<span class="op" id="6664416">=</span>&nbsp;<span class="ident" id="6664418">s</span><span class="op" id="6664419">&gt;&gt;</span><span class="num" id="6664421">16</span>&nbsp;<span class="op" id="6664424">+</span>&nbsp;<span class="ident" id="6664426">s</span><span class="op" id="6664427">&amp;</span><span class="num" id="6664428">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664436">s</span>&nbsp;<span class="op" id="6664438">=</span>&nbsp;<span class="ident" id="6664440">s</span>&nbsp;<span class="op" id="6664442">+</span>&nbsp;<span class="ident" id="6664444">s</span><span class="op" id="6664445">&gt;&gt;</span><span class="num" id="6664447">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6664451">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6664506">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664550">b</span><span class="op" id="6664551">[</span><span class="num" id="6664552">2</span><span class="op" id="6664553">]</span>&nbsp;<span class="op" id="6664555">^=</span>&nbsp;<span class="builtintype" id="6664558">byte</span><span class="op" id="6664562">(</span><span class="op" id="6664563">^</span><span class="ident" id="6664564">s</span><span class="op" id="6664565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664568">b</span><span class="op" id="6664569">[</span><span class="num" id="6664570">3</span><span class="op" id="6664571">]</span>&nbsp;<span class="op" id="6664573">^=</span>&nbsp;<span class="builtintype" id="6664576">byte</span><span class="op" id="6664580">(</span><span class="op" id="6664581">^</span><span class="ident" id="6664582">s</span>&nbsp;<span class="op" id="6664584">&gt;&gt;</span>&nbsp;<span class="num" id="6664587">8</span><span class="op" id="6664588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664591">return</span>&nbsp;<span class="ident" id="6664598">b</span><span class="op" id="6664599">,</span>&nbsp;<span class="ident" id="6664601">nil</span><br>
<span class="lineno">60</span><span class="op" id="6664605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6664608">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6664657">func</span>&nbsp;<span class="ident" id="6664662">parseICMPMessage</span><span class="op" id="6664678">(</span><span class="ident" id="6664679">b</span>&nbsp;<span class="op" id="6664681">[</span><span class="op" id="6664682">]</span><span class="builtintype" id="6664683">byte</span><span class="op" id="6664687">)</span>&nbsp;<span class="op" id="6664689">(</span><span class="op" id="6664690">*</span><span class="ident" id="6664691">icmpMessage</span><span class="op" id="6664702">,</span>&nbsp;<span class="builtintype" id="6664704">error</span><span class="op" id="6664709">)</span>&nbsp;<span class="op" id="6664711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664714">msglen</span>&nbsp;<span class="op" id="6664721">:=</span>&nbsp;<span class="builtinfunc" id="6664724">len</span><span class="op" id="6664727">(</span><span class="ident" id="6664728">b</span><span class="op" id="6664729">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664732">if</span>&nbsp;<span class="ident" id="6664735">msglen</span>&nbsp;<span class="op" id="6664742">&lt;</span>&nbsp;<span class="num" id="6664744">4</span>&nbsp;<span class="op" id="6664746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664750">return</span>&nbsp;<span class="ident" id="6664757">nil</span><span class="op" id="6664760">,</span>&nbsp;<span class="ident" id="6664762">errors</span><span class="op" id="6664768">.</span><span class="ident" id="6664769">New</span><span class="op" id="6664772">(</span><span class="string" id="6664773">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="6664792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664798">m</span>&nbsp;<span class="op" id="6664800">:=</span>&nbsp;<span class="op" id="6664803">&amp;</span><span class="ident" id="6664804">icmpMessage</span><span class="op" id="6664815">{</span><span class="ident" id="6664816">Type</span><span class="op" id="6664820">:</span>&nbsp;<span class="builtintype" id="6664822">int</span><span class="op" id="6664825">(</span><span class="ident" id="6664826">b</span><span class="op" id="6664827">[</span><span class="num" id="6664828">0</span><span class="op" id="6664829">]</span><span class="op" id="6664830">)</span><span class="op" id="6664831">,</span>&nbsp;<span class="ident" id="6664833">Code</span><span class="op" id="6664837">:</span>&nbsp;<span class="builtintype" id="6664839">int</span><span class="op" id="6664842">(</span><span class="ident" id="6664843">b</span><span class="op" id="6664844">[</span><span class="num" id="6664845">1</span><span class="op" id="6664846">]</span><span class="op" id="6664847">)</span><span class="op" id="6664848">,</span>&nbsp;<span class="ident" id="6664850">Checksum</span><span class="op" id="6664858">:</span>&nbsp;<span class="builtintype" id="6664860">int</span><span class="op" id="6664863">(</span><span class="ident" id="6664864">b</span><span class="op" id="6664865">[</span><span class="num" id="6664866">2</span><span class="op" id="6664867">]</span><span class="op" id="6664868">)</span><span class="op" id="6664869">&lt;&lt;</span><span class="num" id="6664871">8</span>&nbsp;<span class="op" id="6664873">|</span>&nbsp;<span class="builtintype" id="6664875">int</span><span class="op" id="6664878">(</span><span class="ident" id="6664879">b</span><span class="op" id="6664880">[</span><span class="num" id="6664881">3</span><span class="op" id="6664882">]</span><span class="op" id="6664883">)</span><span class="op" id="6664884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664887">if</span>&nbsp;<span class="ident" id="6664890">msglen</span>&nbsp;<span class="op" id="6664897">&gt;</span>&nbsp;<span class="num" id="6664899">4</span>&nbsp;<span class="op" id="6664901">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664905">var</span>&nbsp;<span class="ident" id="6664909">err</span>&nbsp;<span class="builtintype" id="6664913">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664921">switch</span>&nbsp;<span class="ident" id="6664928">m</span><span class="op" id="6664929">.</span><span class="ident" id="6664930">Type</span>&nbsp;<span class="op" id="6664935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664939">case</span>&nbsp;<span class="ident" id="6664944">icmpv4EchoRequest</span><span class="op" id="6664961">,</span>&nbsp;<span class="ident" id="6664963">icmpv4EchoReply</span><span class="op" id="6664978">,</span>&nbsp;<span class="ident" id="6664980">icmpv6EchoRequest</span><span class="op" id="6664997">,</span>&nbsp;<span class="ident" id="6664999">icmpv6EchoReply</span><span class="op" id="6665014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665019">m</span><span class="op" id="6665020">.</span><span class="ident" id="6665021">Body</span><span class="op" id="6665025">,</span>&nbsp;<span class="ident" id="6665027">err</span>&nbsp;<span class="op" id="6665031">=</span>&nbsp;<span class="ident" id="6665033">parseICMPEcho</span><span class="op" id="6665046">(</span><span class="ident" id="6665047">b</span><span class="op" id="6665048">[</span><span class="num" id="6665049">4</span><span class="op" id="6665050">:</span><span class="op" id="6665051">]</span><span class="op" id="6665052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665057">if</span>&nbsp;<span class="ident" id="6665060">err</span>&nbsp;<span class="op" id="6665064">!=</span>&nbsp;<span class="ident" id="6665067">nil</span>&nbsp;<span class="op" id="6665071">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665077">return</span>&nbsp;<span class="ident" id="6665084">nil</span><span class="op" id="6665087">,</span>&nbsp;<span class="ident" id="6665089">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665106">return</span>&nbsp;<span class="ident" id="6665113">m</span><span class="op" id="6665114">,</span>&nbsp;<span class="ident" id="6665116">nil</span><br>
<span class="lineno">80</span><span class="op" id="6665120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6665123">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6665191">type</span>&nbsp;<span class="ident" id="6665196">icmpEcho</span>&nbsp;<span class="keyword" id="6665205">struct</span>&nbsp;<span class="op" id="6665212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665215">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6665220">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6665227">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665242">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="6665247">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6665254">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665274">Data</span>&nbsp;<span class="op" id="6665279">[</span><span class="op" id="6665280">]</span><span class="builtintype" id="6665281">byte</span>&nbsp;<span class="comment" id="6665286">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="6665294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6665297">func</span>&nbsp;<span class="op" id="6665302">(</span><span class="ident" id="6665303">p</span>&nbsp;<span class="op" id="6665305">*</span><span class="ident" id="6665306">icmpEcho</span><span class="op" id="6665314">)</span>&nbsp;<span class="ident" id="6665316">Len</span><span class="op" id="6665319">(</span><span class="op" id="6665320">)</span>&nbsp;<span class="builtintype" id="6665322">int</span>&nbsp;<span class="op" id="6665326">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665329">if</span>&nbsp;<span class="ident" id="6665332">p</span>&nbsp;<span class="op" id="6665334">==</span>&nbsp;<span class="ident" id="6665337">nil</span>&nbsp;<span class="op" id="6665341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665345">return</span>&nbsp;<span class="num" id="6665352">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665358">return</span>&nbsp;<span class="num" id="6665365">4</span>&nbsp;<span class="op" id="6665367">+</span>&nbsp;<span class="builtinfunc" id="6665369">len</span><span class="op" id="6665372">(</span><span class="ident" id="6665373">p</span><span class="op" id="6665374">.</span><span class="ident" id="6665375">Data</span><span class="op" id="6665379">)</span><br>
<span class="lineno"></span><span class="op" id="6665381">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="6665384">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6665452">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6665477">func</span>&nbsp;<span class="op" id="6665482">(</span><span class="ident" id="6665483">p</span>&nbsp;<span class="op" id="6665485">*</span><span class="ident" id="6665486">icmpEcho</span><span class="op" id="6665494">)</span>&nbsp;<span class="ident" id="6665496">Marshal</span><span class="op" id="6665503">(</span><span class="op" id="6665504">)</span>&nbsp;<span class="op" id="6665506">(</span><span class="op" id="6665507">[</span><span class="op" id="6665508">]</span><span class="builtintype" id="6665509">byte</span><span class="op" id="6665513">,</span>&nbsp;<span class="builtintype" id="6665515">error</span><span class="op" id="6665520">)</span>&nbsp;<span class="op" id="6665522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665525">b</span>&nbsp;<span class="op" id="6665527">:=</span>&nbsp;<span class="builtinfunc" id="6665530">make</span><span class="op" id="6665534">(</span><span class="op" id="6665535">[</span><span class="op" id="6665536">]</span><span class="builtintype" id="6665537">byte</span><span class="op" id="6665541">,</span>&nbsp;<span class="num" id="6665543">4</span><span class="op" id="6665544">+</span><span class="builtinfunc" id="6665545">len</span><span class="op" id="6665548">(</span><span class="ident" id="6665549">p</span><span class="op" id="6665550">.</span><span class="ident" id="6665551">Data</span><span class="op" id="6665555">)</span><span class="op" id="6665556">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665559">b</span><span class="op" id="6665560">[</span><span class="num" id="6665561">0</span><span class="op" id="6665562">]</span><span class="op" id="6665563">,</span>&nbsp;<span class="ident" id="6665565">b</span><span class="op" id="6665566">[</span><span class="num" id="6665567">1</span><span class="op" id="6665568">]</span>&nbsp;<span class="op" id="6665570">=</span>&nbsp;<span class="builtintype" id="6665572">byte</span><span class="op" id="6665576">(</span><span class="ident" id="6665577">p</span><span class="op" id="6665578">.</span><span class="ident" id="6665579">ID</span><span class="op" id="6665581">&gt;&gt;</span><span class="num" id="6665583">8</span><span class="op" id="6665584">)</span><span class="op" id="6665585">,</span>&nbsp;<span class="builtintype" id="6665587">byte</span><span class="op" id="6665591">(</span><span class="ident" id="6665592">p</span><span class="op" id="6665593">.</span><span class="ident" id="6665594">ID</span><span class="op" id="6665596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665599">b</span><span class="op" id="6665600">[</span><span class="num" id="6665601">2</span><span class="op" id="6665602">]</span><span class="op" id="6665603">,</span>&nbsp;<span class="ident" id="6665605">b</span><span class="op" id="6665606">[</span><span class="num" id="6665607">3</span><span class="op" id="6665608">]</span>&nbsp;<span class="op" id="6665610">=</span>&nbsp;<span class="builtintype" id="6665612">byte</span><span class="op" id="6665616">(</span><span class="ident" id="6665617">p</span><span class="op" id="6665618">.</span><span class="ident" id="6665619">Seq</span><span class="op" id="6665622">&gt;&gt;</span><span class="num" id="6665624">8</span><span class="op" id="6665625">)</span><span class="op" id="6665626">,</span>&nbsp;<span class="builtintype" id="6665628">byte</span><span class="op" id="6665632">(</span><span class="ident" id="6665633">p</span><span class="op" id="6665634">.</span><span class="ident" id="6665635">Seq</span><span class="op" id="6665638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6665641">copy</span><span class="op" id="6665645">(</span><span class="ident" id="6665646">b</span><span class="op" id="6665647">[</span><span class="num" id="6665648">4</span><span class="op" id="6665649">:</span><span class="op" id="6665650">]</span><span class="op" id="6665651">,</span>&nbsp;<span class="ident" id="6665653">p</span><span class="op" id="6665654">.</span><span class="ident" id="6665655">Data</span><span class="op" id="6665659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665662">return</span>&nbsp;<span class="ident" id="6665669">b</span><span class="op" id="6665670">,</span>&nbsp;<span class="ident" id="6665672">nil</span><br>
<span class="lineno"></span><span class="op" id="6665676">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="6665679">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="6665746">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6665755">func</span>&nbsp;<span class="ident" id="6665760">parseICMPEcho</span><span class="op" id="6665773">(</span><span class="ident" id="6665774">b</span>&nbsp;<span class="op" id="6665776">[</span><span class="op" id="6665777">]</span><span class="builtintype" id="6665778">byte</span><span class="op" id="6665782">)</span>&nbsp;<span class="op" id="6665784">(</span><span class="op" id="6665785">*</span><span class="ident" id="6665786">icmpEcho</span><span class="op" id="6665794">,</span>&nbsp;<span class="builtintype" id="6665796">error</span><span class="op" id="6665801">)</span>&nbsp;<span class="op" id="6665803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665806">bodylen</span>&nbsp;<span class="op" id="6665814">:=</span>&nbsp;<span class="builtinfunc" id="6665817">len</span><span class="op" id="6665820">(</span><span class="ident" id="6665821">b</span><span class="op" id="6665822">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665825">p</span>&nbsp;<span class="op" id="6665827">:=</span>&nbsp;<span class="op" id="6665830">&amp;</span><span class="ident" id="6665831">icmpEcho</span><span class="op" id="6665839">{</span><span class="ident" id="6665840">ID</span><span class="op" id="6665842">:</span>&nbsp;<span class="builtintype" id="6665844">int</span><span class="op" id="6665847">(</span><span class="ident" id="6665848">b</span><span class="op" id="6665849">[</span><span class="num" id="6665850">0</span><span class="op" id="6665851">]</span><span class="op" id="6665852">)</span><span class="op" id="6665853">&lt;&lt;</span><span class="num" id="6665855">8</span>&nbsp;<span class="op" id="6665857">|</span>&nbsp;<span class="builtintype" id="6665859">int</span><span class="op" id="6665862">(</span><span class="ident" id="6665863">b</span><span class="op" id="6665864">[</span><span class="num" id="6665865">1</span><span class="op" id="6665866">]</span><span class="op" id="6665867">)</span><span class="op" id="6665868">,</span>&nbsp;<span class="ident" id="6665870">Seq</span><span class="op" id="6665873">:</span>&nbsp;<span class="builtintype" id="6665875">int</span><span class="op" id="6665878">(</span><span class="ident" id="6665879">b</span><span class="op" id="6665880">[</span><span class="num" id="6665881">2</span><span class="op" id="6665882">]</span><span class="op" id="6665883">)</span><span class="op" id="6665884">&lt;&lt;</span><span class="num" id="6665886">8</span>&nbsp;<span class="op" id="6665888">|</span>&nbsp;<span class="builtintype" id="6665890">int</span><span class="op" id="6665893">(</span><span class="ident" id="6665894">b</span><span class="op" id="6665895">[</span><span class="num" id="6665896">3</span><span class="op" id="6665897">]</span><span class="op" id="6665898">)</span><span class="op" id="6665899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665902">if</span>&nbsp;<span class="ident" id="6665905">bodylen</span>&nbsp;<span class="op" id="6665913">&gt;</span>&nbsp;<span class="num" id="6665915">4</span>&nbsp;<span class="op" id="6665917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665921">p</span><span class="op" id="6665922">.</span><span class="ident" id="6665923">Data</span>&nbsp;<span class="op" id="6665928">=</span>&nbsp;<span class="builtinfunc" id="6665930">make</span><span class="op" id="6665934">(</span><span class="op" id="6665935">[</span><span class="op" id="6665936">]</span><span class="builtintype" id="6665937">byte</span><span class="op" id="6665941">,</span>&nbsp;<span class="ident" id="6665943">bodylen</span><span class="op" id="6665950">-</span><span class="num" id="6665951">4</span><span class="op" id="6665952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6665956">copy</span><span class="op" id="6665960">(</span><span class="ident" id="6665961">p</span><span class="op" id="6665962">.</span><span class="ident" id="6665963">Data</span><span class="op" id="6665967">,</span>&nbsp;<span class="ident" id="6665969">b</span><span class="op" id="6665970">[</span><span class="num" id="6665971">4</span><span class="op" id="6665972">:</span><span class="op" id="6665973">]</span><span class="op" id="6665974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665977">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665980">return</span>&nbsp;<span class="ident" id="6665987">p</span><span class="op" id="6665988">,</span>&nbsp;<span class="ident" id="6665990">nil</span><br>
<span class="lineno"></span><span class="op" id="6665994">}</span>
</div>
</body>
</html>
