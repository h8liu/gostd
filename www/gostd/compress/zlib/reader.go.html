<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6309176">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6309231">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6309285">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6309336">/*<br>
<span class="lineno"></span>Package&nbsp;zlib&nbsp;implements&nbsp;reading&nbsp;and&nbsp;writing&nbsp;of&nbsp;zlib&nbsp;format&nbsp;compressed&nbsp;data,<br>
<span class="lineno"></span>as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;1950.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>The&nbsp;implementation&nbsp;provides&nbsp;filters&nbsp;that&nbsp;uncompress&nbsp;during&nbsp;reading<br>
<span class="lineno">10</span>and&nbsp;compress&nbsp;during&nbsp;writing.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;write&nbsp;compressed&nbsp;data<br>
<span class="lineno"></span>to&nbsp;a&nbsp;buffer:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;b&nbsp;bytes.Buffer<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;zlib.NewWriter(&amp;b)<br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;w.Write([]byte(&#34;hello,&nbsp;world\n&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;w.Close()<br>
<span class="lineno"></span><br>
<span class="lineno"></span>and&nbsp;to&nbsp;read&nbsp;that&nbsp;data&nbsp;back:<br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;r,&nbsp;err&nbsp;:=&nbsp;zlib.NewReader(&amp;b)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;io.Copy(os.Stdout,&nbsp;r)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;r.Close()<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="6309779">package</span>&nbsp;<span class="ident" id="6309787">zlib</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6309793">import</span>&nbsp;<span class="op" id="6309800">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6309803">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6309812">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6309830">&#34;errors&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6309840">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6309848">&#34;hash/adler32&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6309864">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6309869">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6309872">const</span>&nbsp;<span class="ident" id="6309878">zlibDeflate</span>&nbsp;<span class="op" id="6309890">=</span>&nbsp;<span class="num" id="6309892">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6309895">var</span>&nbsp;<span class="op" id="6309899">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6309902">//&nbsp;ErrChecksum&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6309983">ErrChecksum</span>&nbsp;<span class="op" id="6309995">=</span>&nbsp;<span class="ident" id="6309997">errors</span><span class="op" id="6310003">.</span><span class="ident" id="6310004">New</span><span class="op" id="6310007">(</span><span class="string" id="6310008">&#34;zlib:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="6310032">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6310035">//&nbsp;ErrDictionary&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;dictionary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310120">ErrDictionary</span>&nbsp;<span class="op" id="6310134">=</span>&nbsp;<span class="ident" id="6310136">errors</span><span class="op" id="6310142">.</span><span class="ident" id="6310143">New</span><span class="op" id="6310146">(</span><span class="string" id="6310147">&#34;zlib:&nbsp;invalid&nbsp;dictionary&#34;</span><span class="op" id="6310173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6310176">//&nbsp;ErrHeader&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310253">ErrHeader</span>&nbsp;<span class="op" id="6310263">=</span>&nbsp;<span class="ident" id="6310265">errors</span><span class="op" id="6310271">.</span><span class="ident" id="6310272">New</span><span class="op" id="6310275">(</span><span class="string" id="6310276">&#34;zlib:&nbsp;invalid&nbsp;header&#34;</span><span class="op" id="6310298">)</span><br>
<span class="lineno"></span><span class="op" id="6310300">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6310303">type</span>&nbsp;<span class="ident" id="6310308">reader</span>&nbsp;<span class="keyword" id="6310315">struct</span>&nbsp;<span class="op" id="6310322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310325">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310338">flate</span><span class="op" id="6310343">.</span><span class="ident" id="6310344">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310352">decompressor</span>&nbsp;<span class="ident" id="6310365">io</span><span class="op" id="6310367">.</span><span class="ident" id="6310368">ReadCloser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310380">digest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310393">hash</span><span class="op" id="6310397">.</span><span class="ident" id="6310398">Hash32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310406">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6310419">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310426">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6310439">[</span><span class="num" id="6310440">4</span><span class="op" id="6310441">]</span><span class="builtintype" id="6310442">byte</span><br>
<span class="lineno"></span><span class="op" id="6310447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6310450">//&nbsp;Resetter&nbsp;resets&nbsp;a&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;or&nbsp;NewReaderDict&nbsp;to</span><br>
<span class="lineno">55</span><span class="comment" id="6310524">//&nbsp;to&nbsp;switch&nbsp;to&nbsp;a&nbsp;new&nbsp;underlying&nbsp;Reader.&nbsp;This&nbsp;permits&nbsp;reusing&nbsp;a&nbsp;ReadCloser</span><br>
<span class="lineno"></span><span class="comment" id="6310599">//&nbsp;instead&nbsp;of&nbsp;allocating&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="6310635">type</span>&nbsp;<span class="ident" id="6310640">Resetter</span>&nbsp;<span class="keyword" id="6310649">interface</span>&nbsp;<span class="op" id="6310659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6310662">//&nbsp;Reset&nbsp;discards&nbsp;any&nbsp;buffered&nbsp;data&nbsp;and&nbsp;resets&nbsp;the&nbsp;Resetter&nbsp;as&nbsp;if&nbsp;it&nbsp;was</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6310736">//&nbsp;newly&nbsp;initialized&nbsp;with&nbsp;the&nbsp;given&nbsp;reader.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6310781">Reset</span><span class="op" id="6310786">(</span><span class="ident" id="6310787">r</span>&nbsp;<span class="ident" id="6310789">io</span><span class="op" id="6310791">.</span><span class="ident" id="6310792">Reader</span><span class="op" id="6310798">,</span>&nbsp;<span class="ident" id="6310800">dict</span>&nbsp;<span class="op" id="6310805">[</span><span class="op" id="6310806">]</span><span class="builtintype" id="6310807">byte</span><span class="op" id="6310811">)</span>&nbsp;<span class="builtintype" id="6310813">error</span><br>
<span class="lineno"></span><span class="op" id="6310819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6310822">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="6310861">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">65</span><span class="comment" id="6310932">//&nbsp;The&nbsp;implementation&nbsp;buffers&nbsp;input&nbsp;and&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6311014">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="comment" id="6311094">//</span><br>
<span class="lineno"></span><span class="comment" id="6311097">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="6311163">func</span>&nbsp;<span class="ident" id="6311168">NewReader</span><span class="op" id="6311177">(</span><span class="ident" id="6311178">r</span>&nbsp;<span class="ident" id="6311180">io</span><span class="op" id="6311182">.</span><span class="ident" id="6311183">Reader</span><span class="op" id="6311189">)</span>&nbsp;<span class="op" id="6311191">(</span><span class="ident" id="6311192">io</span><span class="op" id="6311194">.</span><span class="ident" id="6311195">ReadCloser</span><span class="op" id="6311205">,</span>&nbsp;<span class="builtintype" id="6311207">error</span><span class="op" id="6311212">)</span>&nbsp;<span class="op" id="6311214">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311217">return</span>&nbsp;<span class="ident" id="6311224">NewReaderDict</span><span class="op" id="6311237">(</span><span class="ident" id="6311238">r</span><span class="op" id="6311239">,</span>&nbsp;<span class="builtintype" id="6311241">nil</span><span class="op" id="6311244">)</span><br>
<span class="lineno"></span><span class="op" id="6311246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6311249">//&nbsp;NewReaderDict&nbsp;is&nbsp;like&nbsp;NewReader&nbsp;but&nbsp;uses&nbsp;a&nbsp;preset&nbsp;dictionary.</span><br>
<span class="lineno"></span><span class="comment" id="6311314">//&nbsp;NewReaderDict&nbsp;ignores&nbsp;the&nbsp;dictionary&nbsp;if&nbsp;the&nbsp;compressed&nbsp;data&nbsp;does&nbsp;not&nbsp;refer&nbsp;to&nbsp;it.</span><br>
<span class="lineno">75</span><span class="comment" id="6311399">//&nbsp;If&nbsp;the&nbsp;compressed&nbsp;data&nbsp;refers&nbsp;to&nbsp;a&nbsp;different&nbsp;dictionary,&nbsp;NewReaderDict&nbsp;returns&nbsp;ErrDictionary.</span><br>
<span class="lineno"></span><span class="comment" id="6311496">//</span><br>
<span class="lineno"></span><span class="comment" id="6311499">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReaderDict&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="6311569">func</span>&nbsp;<span class="ident" id="6311574">NewReaderDict</span><span class="op" id="6311587">(</span><span class="ident" id="6311588">r</span>&nbsp;<span class="ident" id="6311590">io</span><span class="op" id="6311592">.</span><span class="ident" id="6311593">Reader</span><span class="op" id="6311599">,</span>&nbsp;<span class="ident" id="6311601">dict</span>&nbsp;<span class="op" id="6311606">[</span><span class="op" id="6311607">]</span><span class="builtintype" id="6311608">byte</span><span class="op" id="6311612">)</span>&nbsp;<span class="op" id="6311614">(</span><span class="ident" id="6311615">io</span><span class="op" id="6311617">.</span><span class="ident" id="6311618">ReadCloser</span><span class="op" id="6311628">,</span>&nbsp;<span class="builtintype" id="6311630">error</span><span class="op" id="6311635">)</span>&nbsp;<span class="op" id="6311637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6311640">z</span>&nbsp;<span class="op" id="6311642">:=</span>&nbsp;<span class="builtinfunc" id="6311645">new</span><span class="op" id="6311648">(</span><span class="ident" id="6311649">reader</span><span class="op" id="6311655">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6311658">err</span>&nbsp;<span class="op" id="6311662">:=</span>&nbsp;<span class="ident" id="6311665">z</span><span class="op" id="6311666">.</span><span class="ident" id="6311667">Reset</span><span class="op" id="6311672">(</span><span class="ident" id="6311673">r</span><span class="op" id="6311674">,</span>&nbsp;<span class="ident" id="6311676">dict</span><span class="op" id="6311680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311683">if</span>&nbsp;<span class="ident" id="6311686">err</span>&nbsp;<span class="op" id="6311690">!=</span>&nbsp;<span class="builtintype" id="6311693">nil</span>&nbsp;<span class="op" id="6311697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311701">return</span>&nbsp;<span class="builtintype" id="6311708">nil</span><span class="op" id="6311711">,</span>&nbsp;<span class="ident" id="6311713">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6311718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311721">return</span>&nbsp;<span class="ident" id="6311728">z</span><span class="op" id="6311729">,</span>&nbsp;<span class="builtintype" id="6311731">nil</span><br>
<span class="lineno">85</span><span class="op" id="6311735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6311738">func</span>&nbsp;<span class="op" id="6311743">(</span><span class="ident" id="6311744">z</span>&nbsp;<span class="op" id="6311746">*</span><span class="ident" id="6311747">reader</span><span class="op" id="6311753">)</span>&nbsp;<span class="ident" id="6311755">Read</span><span class="op" id="6311759">(</span><span class="ident" id="6311760">p</span>&nbsp;<span class="op" id="6311762">[</span><span class="op" id="6311763">]</span><span class="builtintype" id="6311764">byte</span><span class="op" id="6311768">)</span>&nbsp;<span class="op" id="6311770">(</span><span class="ident" id="6311771">n</span>&nbsp;<span class="builtintype" id="6311773">int</span><span class="op" id="6311776">,</span>&nbsp;<span class="ident" id="6311778">err</span>&nbsp;<span class="builtintype" id="6311782">error</span><span class="op" id="6311787">)</span>&nbsp;<span class="op" id="6311789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311792">if</span>&nbsp;<span class="ident" id="6311795">z</span><span class="op" id="6311796">.</span><span class="ident" id="6311797">err</span>&nbsp;<span class="op" id="6311801">!=</span>&nbsp;<span class="builtintype" id="6311804">nil</span>&nbsp;<span class="op" id="6311808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311812">return</span>&nbsp;<span class="num" id="6311819">0</span><span class="op" id="6311820">,</span>&nbsp;<span class="ident" id="6311822">z</span><span class="op" id="6311823">.</span><span class="ident" id="6311824">err</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6311829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311832">if</span>&nbsp;<span class="builtinfunc" id="6311835">len</span><span class="op" id="6311838">(</span><span class="ident" id="6311839">p</span><span class="op" id="6311840">)</span>&nbsp;<span class="op" id="6311842">==</span>&nbsp;<span class="num" id="6311845">0</span>&nbsp;<span class="op" id="6311847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311851">return</span>&nbsp;<span class="num" id="6311858">0</span><span class="op" id="6311859">,</span>&nbsp;<span class="builtintype" id="6311861">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6311866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6311870">n</span><span class="op" id="6311871">,</span>&nbsp;<span class="ident" id="6311873">err</span>&nbsp;<span class="op" id="6311877">=</span>&nbsp;<span class="ident" id="6311879">z</span><span class="op" id="6311880">.</span><span class="ident" id="6311881">decompressor</span><span class="op" id="6311893">.</span><span class="ident" id="6311894">Read</span><span class="op" id="6311898">(</span><span class="ident" id="6311899">p</span><span class="op" id="6311900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6311903">z</span><span class="op" id="6311904">.</span><span class="ident" id="6311905">digest</span><span class="op" id="6311911">.</span><span class="ident" id="6311912">Write</span><span class="op" id="6311917">(</span><span class="ident" id="6311918">p</span><span class="op" id="6311919">[</span><span class="num" id="6311920">0</span><span class="op" id="6311921">:</span><span class="ident" id="6311922">n</span><span class="op" id="6311923">]</span><span class="op" id="6311924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311927">if</span>&nbsp;<span class="ident" id="6311930">n</span>&nbsp;<span class="op" id="6311932">!=</span>&nbsp;<span class="num" id="6311935">0</span>&nbsp;<span class="op" id="6311937">||</span>&nbsp;<span class="ident" id="6311940">err</span>&nbsp;<span class="op" id="6311944">!=</span>&nbsp;<span class="ident" id="6311947">io</span><span class="op" id="6311949">.</span><span class="ident" id="6311950">EOF</span>&nbsp;<span class="op" id="6311954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6311958">z</span><span class="op" id="6311959">.</span><span class="ident" id="6311960">err</span>&nbsp;<span class="op" id="6311964">=</span>&nbsp;<span class="ident" id="6311966">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6311972">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6311980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6311984">//&nbsp;Finished&nbsp;file;&nbsp;check&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312019">if</span>&nbsp;<span class="ident" id="6312022">_</span><span class="op" id="6312023">,</span>&nbsp;<span class="ident" id="6312025">err</span>&nbsp;<span class="op" id="6312029">:=</span>&nbsp;<span class="ident" id="6312032">io</span><span class="op" id="6312034">.</span><span class="ident" id="6312035">ReadFull</span><span class="op" id="6312043">(</span><span class="ident" id="6312044">z</span><span class="op" id="6312045">.</span><span class="ident" id="6312046">r</span><span class="op" id="6312047">,</span>&nbsp;<span class="ident" id="6312049">z</span><span class="op" id="6312050">.</span><span class="ident" id="6312051">scratch</span><span class="op" id="6312058">[</span><span class="num" id="6312059">0</span><span class="op" id="6312060">:</span><span class="num" id="6312061">4</span><span class="op" id="6312062">]</span><span class="op" id="6312063">)</span><span class="op" id="6312064">;</span>&nbsp;<span class="ident" id="6312066">err</span>&nbsp;<span class="op" id="6312070">!=</span>&nbsp;<span class="builtintype" id="6312073">nil</span>&nbsp;<span class="op" id="6312077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312081">z</span><span class="op" id="6312082">.</span><span class="ident" id="6312083">err</span>&nbsp;<span class="op" id="6312087">=</span>&nbsp;<span class="ident" id="6312089">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312095">return</span>&nbsp;<span class="num" id="6312102">0</span><span class="op" id="6312103">,</span>&nbsp;<span class="ident" id="6312105">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6312110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6312113">//&nbsp;ZLIB&nbsp;(RFC&nbsp;1950)&nbsp;is&nbsp;big-endian,&nbsp;unlike&nbsp;GZIP&nbsp;(RFC&nbsp;1952).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312172">checksum</span>&nbsp;<span class="op" id="6312181">:=</span>&nbsp;<span class="builtintype" id="6312184">uint32</span><span class="op" id="6312190">(</span><span class="ident" id="6312191">z</span><span class="op" id="6312192">.</span><span class="ident" id="6312193">scratch</span><span class="op" id="6312200">[</span><span class="num" id="6312201">0</span><span class="op" id="6312202">]</span><span class="op" id="6312203">)</span><span class="op" id="6312204">&lt;&lt;</span><span class="num" id="6312206">24</span>&nbsp;<span class="op" id="6312209">|</span>&nbsp;<span class="builtintype" id="6312211">uint32</span><span class="op" id="6312217">(</span><span class="ident" id="6312218">z</span><span class="op" id="6312219">.</span><span class="ident" id="6312220">scratch</span><span class="op" id="6312227">[</span><span class="num" id="6312228">1</span><span class="op" id="6312229">]</span><span class="op" id="6312230">)</span><span class="op" id="6312231">&lt;&lt;</span><span class="num" id="6312233">16</span>&nbsp;<span class="op" id="6312236">|</span>&nbsp;<span class="builtintype" id="6312238">uint32</span><span class="op" id="6312244">(</span><span class="ident" id="6312245">z</span><span class="op" id="6312246">.</span><span class="ident" id="6312247">scratch</span><span class="op" id="6312254">[</span><span class="num" id="6312255">2</span><span class="op" id="6312256">]</span><span class="op" id="6312257">)</span><span class="op" id="6312258">&lt;&lt;</span><span class="num" id="6312260">8</span>&nbsp;<span class="op" id="6312262">|</span>&nbsp;<span class="builtintype" id="6312264">uint32</span><span class="op" id="6312270">(</span><span class="ident" id="6312271">z</span><span class="op" id="6312272">.</span><span class="ident" id="6312273">scratch</span><span class="op" id="6312280">[</span><span class="num" id="6312281">3</span><span class="op" id="6312282">]</span><span class="op" id="6312283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312286">if</span>&nbsp;<span class="ident" id="6312289">checksum</span>&nbsp;<span class="op" id="6312298">!=</span>&nbsp;<span class="ident" id="6312301">z</span><span class="op" id="6312302">.</span><span class="ident" id="6312303">digest</span><span class="op" id="6312309">.</span><span class="ident" id="6312310">Sum32</span><span class="op" id="6312315">(</span><span class="op" id="6312316">)</span>&nbsp;<span class="op" id="6312318">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312322">z</span><span class="op" id="6312323">.</span><span class="ident" id="6312324">err</span>&nbsp;<span class="op" id="6312328">=</span>&nbsp;<span class="ident" id="6312330">ErrChecksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312344">return</span>&nbsp;<span class="num" id="6312351">0</span><span class="op" id="6312352">,</span>&nbsp;<span class="ident" id="6312354">z</span><span class="op" id="6312355">.</span><span class="ident" id="6312356">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6312361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312364">return</span><br>
<span class="lineno"></span><span class="op" id="6312371">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="6312374">//&nbsp;Calling&nbsp;Close&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;wrapped&nbsp;io.Reader&nbsp;originally&nbsp;passed&nbsp;to&nbsp;NewReader.</span><br>
<span class="lineno"></span><span class="keyword" id="6312460">func</span>&nbsp;<span class="op" id="6312465">(</span><span class="ident" id="6312466">z</span>&nbsp;<span class="op" id="6312468">*</span><span class="ident" id="6312469">reader</span><span class="op" id="6312475">)</span>&nbsp;<span class="ident" id="6312477">Close</span><span class="op" id="6312482">(</span><span class="op" id="6312483">)</span>&nbsp;<span class="builtintype" id="6312485">error</span>&nbsp;<span class="op" id="6312491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312494">if</span>&nbsp;<span class="ident" id="6312497">z</span><span class="op" id="6312498">.</span><span class="ident" id="6312499">err</span>&nbsp;<span class="op" id="6312503">!=</span>&nbsp;<span class="builtintype" id="6312506">nil</span>&nbsp;<span class="op" id="6312510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312514">return</span>&nbsp;<span class="ident" id="6312521">z</span><span class="op" id="6312522">.</span><span class="ident" id="6312523">err</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6312528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312531">z</span><span class="op" id="6312532">.</span><span class="ident" id="6312533">err</span>&nbsp;<span class="op" id="6312537">=</span>&nbsp;<span class="ident" id="6312539">z</span><span class="op" id="6312540">.</span><span class="ident" id="6312541">decompressor</span><span class="op" id="6312553">.</span><span class="ident" id="6312554">Close</span><span class="op" id="6312559">(</span><span class="op" id="6312560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312563">return</span>&nbsp;<span class="ident" id="6312570">z</span><span class="op" id="6312571">.</span><span class="ident" id="6312572">err</span><br>
<span class="lineno"></span><span class="op" id="6312576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="6312579">func</span>&nbsp;<span class="op" id="6312584">(</span><span class="ident" id="6312585">z</span>&nbsp;<span class="op" id="6312587">*</span><span class="ident" id="6312588">reader</span><span class="op" id="6312594">)</span>&nbsp;<span class="ident" id="6312596">Reset</span><span class="op" id="6312601">(</span><span class="ident" id="6312602">r</span>&nbsp;<span class="ident" id="6312604">io</span><span class="op" id="6312606">.</span><span class="ident" id="6312607">Reader</span><span class="op" id="6312613">,</span>&nbsp;<span class="ident" id="6312615">dict</span>&nbsp;<span class="op" id="6312620">[</span><span class="op" id="6312621">]</span><span class="builtintype" id="6312622">byte</span><span class="op" id="6312626">)</span>&nbsp;<span class="builtintype" id="6312628">error</span>&nbsp;<span class="op" id="6312634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312637">if</span>&nbsp;<span class="ident" id="6312640">fr</span><span class="op" id="6312642">,</span>&nbsp;<span class="ident" id="6312644">ok</span>&nbsp;<span class="op" id="6312647">:=</span>&nbsp;<span class="ident" id="6312650">r</span><span class="op" id="6312651">.</span><span class="op" id="6312652">(</span><span class="ident" id="6312653">flate</span><span class="op" id="6312658">.</span><span class="ident" id="6312659">Reader</span><span class="op" id="6312665">)</span><span class="op" id="6312666">;</span>&nbsp;<span class="ident" id="6312668">ok</span>&nbsp;<span class="op" id="6312671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312675">z</span><span class="op" id="6312676">.</span><span class="ident" id="6312677">r</span>&nbsp;<span class="op" id="6312679">=</span>&nbsp;<span class="ident" id="6312681">fr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6312685">}</span>&nbsp;<span class="keyword" id="6312687">else</span>&nbsp;<span class="op" id="6312692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312696">z</span><span class="op" id="6312697">.</span><span class="ident" id="6312698">r</span>&nbsp;<span class="op" id="6312700">=</span>&nbsp;<span class="ident" id="6312702">bufio</span><span class="op" id="6312707">.</span><span class="ident" id="6312708">NewReader</span><span class="op" id="6312717">(</span><span class="ident" id="6312718">r</span><span class="op" id="6312719">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6312722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312725">_</span><span class="op" id="6312726">,</span>&nbsp;<span class="ident" id="6312728">err</span>&nbsp;<span class="op" id="6312732">:=</span>&nbsp;<span class="ident" id="6312735">io</span><span class="op" id="6312737">.</span><span class="ident" id="6312738">ReadFull</span><span class="op" id="6312746">(</span><span class="ident" id="6312747">z</span><span class="op" id="6312748">.</span><span class="ident" id="6312749">r</span><span class="op" id="6312750">,</span>&nbsp;<span class="ident" id="6312752">z</span><span class="op" id="6312753">.</span><span class="ident" id="6312754">scratch</span><span class="op" id="6312761">[</span><span class="num" id="6312762">0</span><span class="op" id="6312763">:</span><span class="num" id="6312764">2</span><span class="op" id="6312765">]</span><span class="op" id="6312766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312769">if</span>&nbsp;<span class="ident" id="6312772">err</span>&nbsp;<span class="op" id="6312776">!=</span>&nbsp;<span class="builtintype" id="6312779">nil</span>&nbsp;<span class="op" id="6312783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312787">return</span>&nbsp;<span class="ident" id="6312794">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6312799">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312802">h</span>&nbsp;<span class="op" id="6312804">:=</span>&nbsp;<span class="builtintype" id="6312807">uint</span><span class="op" id="6312811">(</span><span class="ident" id="6312812">z</span><span class="op" id="6312813">.</span><span class="ident" id="6312814">scratch</span><span class="op" id="6312821">[</span><span class="num" id="6312822">0</span><span class="op" id="6312823">]</span><span class="op" id="6312824">)</span><span class="op" id="6312825">&lt;&lt;</span><span class="num" id="6312827">8</span>&nbsp;<span class="op" id="6312829">|</span>&nbsp;<span class="builtintype" id="6312831">uint</span><span class="op" id="6312835">(</span><span class="ident" id="6312836">z</span><span class="op" id="6312837">.</span><span class="ident" id="6312838">scratch</span><span class="op" id="6312845">[</span><span class="num" id="6312846">1</span><span class="op" id="6312847">]</span><span class="op" id="6312848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312851">if</span>&nbsp;<span class="op" id="6312854">(</span><span class="ident" id="6312855">z</span><span class="op" id="6312856">.</span><span class="ident" id="6312857">scratch</span><span class="op" id="6312864">[</span><span class="num" id="6312865">0</span><span class="op" id="6312866">]</span><span class="op" id="6312867">&amp;</span><span class="num" id="6312868">0x0f</span>&nbsp;<span class="op" id="6312873">!=</span>&nbsp;<span class="ident" id="6312876">zlibDeflate</span><span class="op" id="6312887">)</span>&nbsp;<span class="op" id="6312889">||</span>&nbsp;<span class="op" id="6312892">(</span><span class="ident" id="6312893">h</span><span class="op" id="6312894">%</span><span class="num" id="6312895">31</span>&nbsp;<span class="op" id="6312898">!=</span>&nbsp;<span class="num" id="6312901">0</span><span class="op" id="6312902">)</span>&nbsp;<span class="op" id="6312904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312908">return</span>&nbsp;<span class="ident" id="6312915">ErrHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6312926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312929">haveDict</span>&nbsp;<span class="op" id="6312938">:=</span>&nbsp;<span class="ident" id="6312941">z</span><span class="op" id="6312942">.</span><span class="ident" id="6312943">scratch</span><span class="op" id="6312950">[</span><span class="num" id="6312951">1</span><span class="op" id="6312952">]</span><span class="op" id="6312953">&amp;</span><span class="num" id="6312954">0x20</span>&nbsp;<span class="op" id="6312959">!=</span>&nbsp;<span class="num" id="6312962">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6312965">if</span>&nbsp;<span class="ident" id="6312968">haveDict</span>&nbsp;<span class="op" id="6312977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6312981">_</span><span class="op" id="6312982">,</span>&nbsp;<span class="ident" id="6312984">err</span>&nbsp;<span class="op" id="6312988">=</span>&nbsp;<span class="ident" id="6312990">io</span><span class="op" id="6312992">.</span><span class="ident" id="6312993">ReadFull</span><span class="op" id="6313001">(</span><span class="ident" id="6313002">z</span><span class="op" id="6313003">.</span><span class="ident" id="6313004">r</span><span class="op" id="6313005">,</span>&nbsp;<span class="ident" id="6313007">z</span><span class="op" id="6313008">.</span><span class="ident" id="6313009">scratch</span><span class="op" id="6313016">[</span><span class="num" id="6313017">0</span><span class="op" id="6313018">:</span><span class="num" id="6313019">4</span><span class="op" id="6313020">]</span><span class="op" id="6313021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6313025">if</span>&nbsp;<span class="ident" id="6313028">err</span>&nbsp;<span class="op" id="6313032">!=</span>&nbsp;<span class="builtintype" id="6313035">nil</span>&nbsp;<span class="op" id="6313039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6313044">return</span>&nbsp;<span class="ident" id="6313051">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6313057">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6313061">checksum</span>&nbsp;<span class="op" id="6313070">:=</span>&nbsp;<span class="builtintype" id="6313073">uint32</span><span class="op" id="6313079">(</span><span class="ident" id="6313080">z</span><span class="op" id="6313081">.</span><span class="ident" id="6313082">scratch</span><span class="op" id="6313089">[</span><span class="num" id="6313090">0</span><span class="op" id="6313091">]</span><span class="op" id="6313092">)</span><span class="op" id="6313093">&lt;&lt;</span><span class="num" id="6313095">24</span>&nbsp;<span class="op" id="6313098">|</span>&nbsp;<span class="builtintype" id="6313100">uint32</span><span class="op" id="6313106">(</span><span class="ident" id="6313107">z</span><span class="op" id="6313108">.</span><span class="ident" id="6313109">scratch</span><span class="op" id="6313116">[</span><span class="num" id="6313117">1</span><span class="op" id="6313118">]</span><span class="op" id="6313119">)</span><span class="op" id="6313120">&lt;&lt;</span><span class="num" id="6313122">16</span>&nbsp;<span class="op" id="6313125">|</span>&nbsp;<span class="builtintype" id="6313127">uint32</span><span class="op" id="6313133">(</span><span class="ident" id="6313134">z</span><span class="op" id="6313135">.</span><span class="ident" id="6313136">scratch</span><span class="op" id="6313143">[</span><span class="num" id="6313144">2</span><span class="op" id="6313145">]</span><span class="op" id="6313146">)</span><span class="op" id="6313147">&lt;&lt;</span><span class="num" id="6313149">8</span>&nbsp;<span class="op" id="6313151">|</span>&nbsp;<span class="builtintype" id="6313153">uint32</span><span class="op" id="6313159">(</span><span class="ident" id="6313160">z</span><span class="op" id="6313161">.</span><span class="ident" id="6313162">scratch</span><span class="op" id="6313169">[</span><span class="num" id="6313170">3</span><span class="op" id="6313171">]</span><span class="op" id="6313172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6313176">if</span>&nbsp;<span class="ident" id="6313179">checksum</span>&nbsp;<span class="op" id="6313188">!=</span>&nbsp;<span class="ident" id="6313191">adler32</span><span class="op" id="6313198">.</span><span class="ident" id="6313199">Checksum</span><span class="op" id="6313207">(</span><span class="ident" id="6313208">dict</span><span class="op" id="6313212">)</span>&nbsp;<span class="op" id="6313214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6313219">return</span>&nbsp;<span class="ident" id="6313226">ErrDictionary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6313242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6313245">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6313248">if</span>&nbsp;<span class="ident" id="6313251">z</span><span class="op" id="6313252">.</span><span class="ident" id="6313253">decompressor</span>&nbsp;<span class="op" id="6313266">==</span>&nbsp;<span class="builtintype" id="6313269">nil</span>&nbsp;<span class="op" id="6313273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6313277">if</span>&nbsp;<span class="ident" id="6313280">haveDict</span>&nbsp;<span class="op" id="6313289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6313294">z</span><span class="op" id="6313295">.</span><span class="ident" id="6313296">decompressor</span>&nbsp;<span class="op" id="6313309">=</span>&nbsp;<span class="ident" id="6313311">flate</span><span class="op" id="6313316">.</span><span class="ident" id="6313317">NewReaderDict</span><span class="op" id="6313330">(</span><span class="ident" id="6313331">z</span><span class="op" id="6313332">.</span><span class="ident" id="6313333">r</span><span class="op" id="6313334">,</span>&nbsp;<span class="ident" id="6313336">dict</span><span class="op" id="6313340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6313344">}</span>&nbsp;<span class="keyword" id="6313346">else</span>&nbsp;<span class="op" id="6313351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6313356">z</span><span class="op" id="6313357">.</span><span class="ident" id="6313358">decompressor</span>&nbsp;<span class="op" id="6313371">=</span>&nbsp;<span class="ident" id="6313373">flate</span><span class="op" id="6313378">.</span><span class="ident" id="6313379">NewReader</span><span class="op" id="6313388">(</span><span class="ident" id="6313389">z</span><span class="op" id="6313390">.</span><span class="ident" id="6313391">r</span><span class="op" id="6313392">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6313396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6313399">}</span>&nbsp;<span class="keyword" id="6313401">else</span>&nbsp;<span class="op" id="6313406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6313410">z</span><span class="op" id="6313411">.</span><span class="ident" id="6313412">decompressor</span><span class="op" id="6313424">.</span><span class="op" id="6313425">(</span><span class="ident" id="6313426">flate</span><span class="op" id="6313431">.</span><span class="ident" id="6313432">Resetter</span><span class="op" id="6313440">)</span><span class="op" id="6313441">.</span><span class="ident" id="6313442">Reset</span><span class="op" id="6313447">(</span><span class="ident" id="6313448">z</span><span class="op" id="6313449">.</span><span class="ident" id="6313450">r</span><span class="op" id="6313451">,</span>&nbsp;<span class="ident" id="6313453">dict</span><span class="op" id="6313457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6313460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6313463">z</span><span class="op" id="6313464">.</span><span class="ident" id="6313465">digest</span>&nbsp;<span class="op" id="6313472">=</span>&nbsp;<span class="ident" id="6313474">adler32</span><span class="op" id="6313481">.</span><span class="ident" id="6313482">New</span><span class="op" id="6313485">(</span><span class="op" id="6313486">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6313489">return</span>&nbsp;<span class="builtintype" id="6313496">nil</span><br>
<span class="lineno"></span><span class="op" id="6313500">}</span>
</div>
</body>
</html>
