<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/ast</h2>
<ul>
<li><a href="/gostd/go/ast/ast.go.html">ast.go</a></li>
<li><a href="/gostd/go/ast/ast_test.go.html">ast_test.go</a></li>
<li><a href="/gostd/go/ast/commentmap.go.html">commentmap.go</a></li>
<li><a href="/gostd/go/ast/commentmap_test.go.html">commentmap_test.go</a></li>
<li><a href="/gostd/go/ast/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/ast/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/ast/filter_test.go.html">filter_test.go</a></li>
<li><a href="/gostd/go/ast/import.go.html">import.go</a></li>
<li><a href="/gostd/go/ast/print.go.html" class="current">print.go</a></li>
<li><a href="/gostd/go/ast/print_test.go.html">print_test.go</a></li>
<li><a href="/gostd/go/ast/resolve.go.html">resolve.go</a></li>
<li><a href="/gostd/go/ast/scope.go.html">scope.go</a></li>
<li><a href="/gostd/go/ast/walk.go.html">walk.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4713093">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4713148">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4713202">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4713253">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;printing&nbsp;support&nbsp;for&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4713303">package</span>&nbsp;<span class="ident" id="4713311">ast</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4713316">import</span>&nbsp;<span class="op" id="4713323">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4713326">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4713333">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4713345">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4713351">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4713357">&#34;reflect&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4713367">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4713370">//&nbsp;A&nbsp;FieldFilter&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Fprint&nbsp;to&nbsp;control&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="4713436">type</span>&nbsp;<span class="ident" id="4713441">FieldFilter</span>&nbsp;<span class="keyword" id="4713453">func</span><span class="op" id="4713457">(</span><span class="ident" id="4713458">name</span>&nbsp;<span class="builtintype" id="4713463">string</span><span class="op" id="4713469">,</span>&nbsp;<span class="ident" id="4713471">value</span>&nbsp;<span class="ident" id="4713477">reflect</span><span class="op" id="4713484">.</span><span class="ident" id="4713485">Value</span><span class="op" id="4713490">)</span>&nbsp;<span class="builtintype" id="4713492">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4713498">//&nbsp;NotNilFilter&nbsp;returns&nbsp;true&nbsp;for&nbsp;field&nbsp;values&nbsp;that&nbsp;are&nbsp;not&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="4713562">//&nbsp;it&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="4713593">func</span>&nbsp;<span class="ident" id="4713598">NotNilFilter</span><span class="op" id="4713610">(</span><span class="ident" id="4713611">_</span>&nbsp;<span class="builtintype" id="4713613">string</span><span class="op" id="4713619">,</span>&nbsp;<span class="ident" id="4713621">v</span>&nbsp;<span class="ident" id="4713623">reflect</span><span class="op" id="4713630">.</span><span class="ident" id="4713631">Value</span><span class="op" id="4713636">)</span>&nbsp;<span class="builtintype" id="4713638">bool</span>&nbsp;<span class="op" id="4713643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713646">switch</span>&nbsp;<span class="ident" id="4713653">v</span><span class="op" id="4713654">.</span><span class="ident" id="4713655">Kind</span><span class="op" id="4713659">(</span><span class="op" id="4713660">)</span>&nbsp;<span class="op" id="4713662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713665">case</span>&nbsp;<span class="ident" id="4713670">reflect</span><span class="op" id="4713677">.</span><span class="ident" id="4713678">Chan</span><span class="op" id="4713682">,</span>&nbsp;<span class="ident" id="4713684">reflect</span><span class="op" id="4713691">.</span><span class="ident" id="4713692">Func</span><span class="op" id="4713696">,</span>&nbsp;<span class="ident" id="4713698">reflect</span><span class="op" id="4713705">.</span><span class="ident" id="4713706">Interface</span><span class="op" id="4713715">,</span>&nbsp;<span class="ident" id="4713717">reflect</span><span class="op" id="4713724">.</span><span class="ident" id="4713725">Map</span><span class="op" id="4713728">,</span>&nbsp;<span class="ident" id="4713730">reflect</span><span class="op" id="4713737">.</span><span class="ident" id="4713738">Ptr</span><span class="op" id="4713741">,</span>&nbsp;<span class="ident" id="4713743">reflect</span><span class="op" id="4713750">.</span><span class="ident" id="4713751">Slice</span><span class="op" id="4713756">:</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713760">return</span>&nbsp;<span class="op" id="4713767">!</span><span class="ident" id="4713768">v</span><span class="op" id="4713769">.</span><span class="ident" id="4713770">IsNil</span><span class="op" id="4713775">(</span><span class="op" id="4713776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713782">return</span>&nbsp;<span class="builtintype" id="4713789">true</span><br>
<span class="lineno"></span><span class="op" id="4713794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4713797">//&nbsp;Fprint&nbsp;prints&nbsp;the&nbsp;(sub-)tree&nbsp;starting&nbsp;at&nbsp;AST&nbsp;node&nbsp;x&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4713858">//&nbsp;If&nbsp;fset&nbsp;!=&nbsp;nil,&nbsp;position&nbsp;information&nbsp;is&nbsp;interpreted&nbsp;relative</span><br>
<span class="lineno"></span><span class="comment" id="4713922">//&nbsp;to&nbsp;that&nbsp;file&nbsp;set.&nbsp;Otherwise&nbsp;positions&nbsp;are&nbsp;printed&nbsp;as&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="4713986">//&nbsp;values&nbsp;(file&nbsp;set&nbsp;specific&nbsp;offsets).</span><br>
<span class="lineno"></span><span class="comment" id="4714025">//</span><br>
<span class="lineno">35</span><span class="comment" id="4714028">//&nbsp;A&nbsp;non-nil&nbsp;FieldFilter&nbsp;f&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;control&nbsp;the&nbsp;output:</span><br>
<span class="lineno"></span><span class="comment" id="4714094">//&nbsp;struct&nbsp;fields&nbsp;for&nbsp;which&nbsp;f(fieldname,&nbsp;fieldvalue)&nbsp;is&nbsp;true&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4714158">//&nbsp;printed;&nbsp;all&nbsp;others&nbsp;are&nbsp;filtered&nbsp;from&nbsp;the&nbsp;output.&nbsp;Unexported</span><br>
<span class="lineno"></span><span class="comment" id="4714222">//&nbsp;struct&nbsp;fields&nbsp;are&nbsp;never&nbsp;printed.</span><br>
<span class="lineno"></span><span class="comment" id="4714258">//</span><br>
<span class="lineno">40</span><span class="keyword" id="4714261">func</span>&nbsp;<span class="ident" id="4714266">Fprint</span><span class="op" id="4714272">(</span><span class="ident" id="4714273">w</span>&nbsp;<span class="ident" id="4714275">io</span><span class="op" id="4714277">.</span><span class="ident" id="4714278">Writer</span><span class="op" id="4714284">,</span>&nbsp;<span class="ident" id="4714286">fset</span>&nbsp;<span class="op" id="4714291">*</span><span class="ident" id="4714292">token</span><span class="op" id="4714297">.</span><span class="ident" id="4714298">FileSet</span><span class="op" id="4714305">,</span>&nbsp;<span class="ident" id="4714307">x</span>&nbsp;<span class="keyword" id="4714309">interface</span><span class="op" id="4714318">{</span><span class="op" id="4714319">}</span><span class="op" id="4714320">,</span>&nbsp;<span class="ident" id="4714322">f</span>&nbsp;<span class="ident" id="4714324">FieldFilter</span><span class="op" id="4714335">)</span>&nbsp;<span class="op" id="4714337">(</span><span class="ident" id="4714338">err</span>&nbsp;<span class="builtintype" id="4714342">error</span><span class="op" id="4714347">)</span>&nbsp;<span class="op" id="4714349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4714352">//&nbsp;setup&nbsp;printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714370">p</span>&nbsp;<span class="op" id="4714372">:=</span>&nbsp;<span class="ident" id="4714375">printer</span><span class="op" id="4714382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714386">output</span><span class="op" id="4714392">:</span>&nbsp;<span class="ident" id="4714394">w</span><span class="op" id="4714395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714399">fset</span><span class="op" id="4714403">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4714407">fset</span><span class="op" id="4714411">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714415">filter</span><span class="op" id="4714421">:</span>&nbsp;<span class="ident" id="4714423">f</span><span class="op" id="4714424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714428">ptrmap</span><span class="op" id="4714434">:</span>&nbsp;<span class="builtinfunc" id="4714436">make</span><span class="op" id="4714440">(</span><span class="keyword" id="4714441">map</span><span class="op" id="4714444">[</span><span class="keyword" id="4714445">interface</span><span class="op" id="4714454">{</span><span class="op" id="4714455">}</span><span class="op" id="4714456">]</span><span class="builtintype" id="4714457">int</span><span class="op" id="4714460">)</span><span class="op" id="4714461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714465">last</span><span class="op" id="4714469">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4714473">&#39;\n&#39;</span><span class="op" id="4714477">,</span>&nbsp;<span class="comment" id="4714479">//&nbsp;force&nbsp;printing&nbsp;of&nbsp;line&nbsp;number&nbsp;on&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4714527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4714531">//&nbsp;install&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714557">defer</span>&nbsp;<span class="keyword" id="4714563">func</span><span class="op" id="4714567">(</span><span class="op" id="4714568">)</span>&nbsp;<span class="op" id="4714570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714574">if</span>&nbsp;<span class="ident" id="4714577">e</span>&nbsp;<span class="op" id="4714579">:=</span>&nbsp;<span class="builtinfunc" id="4714582">recover</span><span class="op" id="4714589">(</span><span class="op" id="4714590">)</span><span class="op" id="4714591">;</span>&nbsp;<span class="ident" id="4714593">e</span>&nbsp;<span class="op" id="4714595">!=</span>&nbsp;<span class="ident" id="4714598">nil</span>&nbsp;<span class="op" id="4714602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714607">err</span>&nbsp;<span class="op" id="4714611">=</span>&nbsp;<span class="ident" id="4714613">e</span><span class="op" id="4714614">.</span><span class="op" id="4714615">(</span><span class="ident" id="4714616">localError</span><span class="op" id="4714626">)</span><span class="op" id="4714627">.</span><span class="ident" id="4714628">err</span>&nbsp;<span class="comment" id="4714632">//&nbsp;re-panics&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;a&nbsp;localError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4714672">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4714675">}</span><span class="op" id="4714676">(</span><span class="op" id="4714677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4714681">//&nbsp;print&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714693">if</span>&nbsp;<span class="ident" id="4714696">x</span>&nbsp;<span class="op" id="4714698">==</span>&nbsp;<span class="ident" id="4714701">nil</span>&nbsp;<span class="op" id="4714705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714709">p</span><span class="op" id="4714710">.</span><span class="ident" id="4714711">printf</span><span class="op" id="4714717">(</span><span class="string" id="4714718">&#34;nil\n&#34;</span><span class="op" id="4714725">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714729">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4714737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714740">p</span><span class="op" id="4714741">.</span><span class="builtinfunc" id="4714742">print</span><span class="op" id="4714747">(</span><span class="ident" id="4714748">reflect</span><span class="op" id="4714755">.</span><span class="ident" id="4714756">ValueOf</span><span class="op" id="4714763">(</span><span class="ident" id="4714764">x</span><span class="op" id="4714765">)</span><span class="op" id="4714766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714769">p</span><span class="op" id="4714770">.</span><span class="ident" id="4714771">printf</span><span class="op" id="4714777">(</span><span class="string" id="4714778">&#34;\n&#34;</span><span class="op" id="4714782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714786">return</span><br>
<span class="lineno"></span><span class="op" id="4714793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4714796">//&nbsp;Print&nbsp;prints&nbsp;x&nbsp;to&nbsp;standard&nbsp;output,&nbsp;skipping&nbsp;nil&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="4714855">//&nbsp;Print(fset,&nbsp;x)&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;Fprint(os.Stdout,&nbsp;fset,&nbsp;x,&nbsp;NotNilFilter).</span><br>
<span class="lineno">70</span><span class="keyword" id="4714930">func</span>&nbsp;<span class="ident" id="4714935">Print</span><span class="op" id="4714940">(</span><span class="ident" id="4714941">fset</span>&nbsp;<span class="op" id="4714946">*</span><span class="ident" id="4714947">token</span><span class="op" id="4714952">.</span><span class="ident" id="4714953">FileSet</span><span class="op" id="4714960">,</span>&nbsp;<span class="ident" id="4714962">x</span>&nbsp;<span class="keyword" id="4714964">interface</span><span class="op" id="4714973">{</span><span class="op" id="4714974">}</span><span class="op" id="4714975">)</span>&nbsp;<span class="builtintype" id="4714977">error</span>&nbsp;<span class="op" id="4714983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714986">return</span>&nbsp;<span class="ident" id="4714993">Fprint</span><span class="op" id="4714999">(</span><span class="ident" id="4715000">os</span><span class="op" id="4715002">.</span><span class="ident" id="4715003">Stdout</span><span class="op" id="4715009">,</span>&nbsp;<span class="ident" id="4715011">fset</span><span class="op" id="4715015">,</span>&nbsp;<span class="ident" id="4715017">x</span><span class="op" id="4715018">,</span>&nbsp;<span class="ident" id="4715020">NotNilFilter</span><span class="op" id="4715032">)</span><br>
<span class="lineno"></span><span class="op" id="4715034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4715037">type</span>&nbsp;<span class="ident" id="4715042">printer</span>&nbsp;<span class="keyword" id="4715050">struct</span>&nbsp;<span class="op" id="4715057">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715060">output</span>&nbsp;<span class="ident" id="4715067">io</span><span class="op" id="4715069">.</span><span class="ident" id="4715070">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715078">fset</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4715085">*</span><span class="ident" id="4715086">token</span><span class="op" id="4715091">.</span><span class="ident" id="4715092">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715101">filter</span>&nbsp;<span class="ident" id="4715108">FieldFilter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715121">ptrmap</span>&nbsp;<span class="keyword" id="4715128">map</span><span class="op" id="4715131">[</span><span class="keyword" id="4715132">interface</span><span class="op" id="4715141">{</span><span class="op" id="4715142">}</span><span class="op" id="4715143">]</span><span class="builtintype" id="4715144">int</span>&nbsp;<span class="comment" id="4715148">//&nbsp;*T&nbsp;-&gt;&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715170">indent</span>&nbsp;<span class="builtintype" id="4715177">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4715197">//&nbsp;current&nbsp;indentation&nbsp;level</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715227">last</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4715234">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4715254">//&nbsp;the&nbsp;last&nbsp;byte&nbsp;processed&nbsp;by&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715291">line</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4715298">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4715318">//&nbsp;current&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span><span class="op" id="4715341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4715344">var</span>&nbsp;<span class="ident" id="4715348">indent</span>&nbsp;<span class="op" id="4715355">=</span>&nbsp;<span class="op" id="4715357">[</span><span class="op" id="4715358">]</span><span class="builtintype" id="4715359">byte</span><span class="op" id="4715363">(</span><span class="string" id="4715364">&#34;.&nbsp;&nbsp;&#34;</span><span class="op" id="4715369">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4715372">func</span>&nbsp;<span class="op" id="4715377">(</span><span class="ident" id="4715378">p</span>&nbsp;<span class="op" id="4715380">*</span><span class="ident" id="4715381">printer</span><span class="op" id="4715388">)</span>&nbsp;<span class="ident" id="4715390">Write</span><span class="op" id="4715395">(</span><span class="ident" id="4715396">data</span>&nbsp;<span class="op" id="4715401">[</span><span class="op" id="4715402">]</span><span class="builtintype" id="4715403">byte</span><span class="op" id="4715407">)</span>&nbsp;<span class="op" id="4715409">(</span><span class="ident" id="4715410">n</span>&nbsp;<span class="builtintype" id="4715412">int</span><span class="op" id="4715415">,</span>&nbsp;<span class="ident" id="4715417">err</span>&nbsp;<span class="builtintype" id="4715421">error</span><span class="op" id="4715426">)</span>&nbsp;<span class="op" id="4715428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715431">var</span>&nbsp;<span class="ident" id="4715435">m</span>&nbsp;<span class="builtintype" id="4715437">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715442">for</span>&nbsp;<span class="ident" id="4715446">i</span><span class="op" id="4715447">,</span>&nbsp;<span class="ident" id="4715449">b</span>&nbsp;<span class="op" id="4715451">:=</span>&nbsp;<span class="keyword" id="4715454">range</span>&nbsp;<span class="ident" id="4715460">data</span>&nbsp;<span class="op" id="4715465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4715469">//&nbsp;invariant:&nbsp;data[0:n]&nbsp;has&nbsp;been&nbsp;written</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715512">if</span>&nbsp;<span class="ident" id="4715515">b</span>&nbsp;<span class="op" id="4715517">==</span>&nbsp;<span class="string" id="4715520">&#39;\n&#39;</span>&nbsp;<span class="op" id="4715525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715530">m</span><span class="op" id="4715531">,</span>&nbsp;<span class="ident" id="4715533">err</span>&nbsp;<span class="op" id="4715537">=</span>&nbsp;<span class="ident" id="4715539">p</span><span class="op" id="4715540">.</span><span class="ident" id="4715541">output</span><span class="op" id="4715547">.</span><span class="ident" id="4715548">Write</span><span class="op" id="4715553">(</span><span class="ident" id="4715554">data</span><span class="op" id="4715558">[</span><span class="ident" id="4715559">n</span>&nbsp;<span class="op" id="4715561">:</span>&nbsp;<span class="ident" id="4715563">i</span><span class="op" id="4715564">+</span><span class="num" id="4715565">1</span><span class="op" id="4715566">]</span><span class="op" id="4715567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715572">n</span>&nbsp;<span class="op" id="4715574">+=</span>&nbsp;<span class="ident" id="4715577">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715582">if</span>&nbsp;<span class="ident" id="4715585">err</span>&nbsp;<span class="op" id="4715589">!=</span>&nbsp;<span class="ident" id="4715592">nil</span>&nbsp;<span class="op" id="4715596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715602">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715617">p</span><span class="op" id="4715618">.</span><span class="ident" id="4715619">line</span><span class="op" id="4715623">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715628">}</span>&nbsp;<span class="keyword" id="4715630">else</span>&nbsp;<span class="keyword" id="4715635">if</span>&nbsp;<span class="ident" id="4715638">p</span><span class="op" id="4715639">.</span><span class="ident" id="4715640">last</span>&nbsp;<span class="op" id="4715645">==</span>&nbsp;<span class="string" id="4715648">&#39;\n&#39;</span>&nbsp;<span class="op" id="4715653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715658">_</span><span class="op" id="4715659">,</span>&nbsp;<span class="ident" id="4715661">err</span>&nbsp;<span class="op" id="4715665">=</span>&nbsp;<span class="ident" id="4715667">fmt</span><span class="op" id="4715670">.</span><span class="ident" id="4715671">Fprintf</span><span class="op" id="4715678">(</span><span class="ident" id="4715679">p</span><span class="op" id="4715680">.</span><span class="ident" id="4715681">output</span><span class="op" id="4715687">,</span>&nbsp;<span class="string" id="4715689">&#34;%6d&nbsp;&nbsp;&#34;</span><span class="op" id="4715696">,</span>&nbsp;<span class="ident" id="4715698">p</span><span class="op" id="4715699">.</span><span class="ident" id="4715700">line</span><span class="op" id="4715704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715709">if</span>&nbsp;<span class="ident" id="4715712">err</span>&nbsp;<span class="op" id="4715716">!=</span>&nbsp;<span class="ident" id="4715719">nil</span>&nbsp;<span class="op" id="4715723">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715729">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715744">for</span>&nbsp;<span class="ident" id="4715748">j</span>&nbsp;<span class="op" id="4715750">:=</span>&nbsp;<span class="ident" id="4715753">p</span><span class="op" id="4715754">.</span><span class="ident" id="4715755">indent</span><span class="op" id="4715761">;</span>&nbsp;<span class="ident" id="4715763">j</span>&nbsp;<span class="op" id="4715765">&gt;</span>&nbsp;<span class="num" id="4715767">0</span><span class="op" id="4715768">;</span>&nbsp;<span class="ident" id="4715770">j</span><span class="op" id="4715771">--</span>&nbsp;<span class="op" id="4715774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715780">_</span><span class="op" id="4715781">,</span>&nbsp;<span class="ident" id="4715783">err</span>&nbsp;<span class="op" id="4715787">=</span>&nbsp;<span class="ident" id="4715789">p</span><span class="op" id="4715790">.</span><span class="ident" id="4715791">output</span><span class="op" id="4715797">.</span><span class="ident" id="4715798">Write</span><span class="op" id="4715803">(</span><span class="ident" id="4715804">indent</span><span class="op" id="4715810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715816">if</span>&nbsp;<span class="ident" id="4715819">err</span>&nbsp;<span class="op" id="4715823">!=</span>&nbsp;<span class="ident" id="4715826">nil</span>&nbsp;<span class="op" id="4715830">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715861">p</span><span class="op" id="4715862">.</span><span class="ident" id="4715863">last</span>&nbsp;<span class="op" id="4715868">=</span>&nbsp;<span class="ident" id="4715870">b</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715876">if</span>&nbsp;<span class="builtinfunc" id="4715879">len</span><span class="op" id="4715882">(</span><span class="ident" id="4715883">data</span><span class="op" id="4715887">)</span>&nbsp;<span class="op" id="4715889">&gt;</span>&nbsp;<span class="ident" id="4715891">n</span>&nbsp;<span class="op" id="4715893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715897">m</span><span class="op" id="4715898">,</span>&nbsp;<span class="ident" id="4715900">err</span>&nbsp;<span class="op" id="4715904">=</span>&nbsp;<span class="ident" id="4715906">p</span><span class="op" id="4715907">.</span><span class="ident" id="4715908">output</span><span class="op" id="4715914">.</span><span class="ident" id="4715915">Write</span><span class="op" id="4715920">(</span><span class="ident" id="4715921">data</span><span class="op" id="4715925">[</span><span class="ident" id="4715926">n</span><span class="op" id="4715927">:</span><span class="op" id="4715928">]</span><span class="op" id="4715929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715933">n</span>&nbsp;<span class="op" id="4715935">+=</span>&nbsp;<span class="ident" id="4715938">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715941">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715944">return</span><br>
<span class="lineno"></span><span class="op" id="4715951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4715954">//&nbsp;localError&nbsp;wraps&nbsp;locally&nbsp;caught&nbsp;errors&nbsp;so&nbsp;we&nbsp;can&nbsp;distinguish</span><br>
<span class="lineno"></span><span class="comment" id="4716018">//&nbsp;them&nbsp;from&nbsp;genuine&nbsp;panics&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;return&nbsp;as&nbsp;errors.</span><br>
<span class="lineno">120</span><span class="keyword" id="4716087">type</span>&nbsp;<span class="ident" id="4716092">localError</span>&nbsp;<span class="keyword" id="4716103">struct</span>&nbsp;<span class="op" id="4716110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716113">err</span>&nbsp;<span class="builtintype" id="4716117">error</span><br>
<span class="lineno"></span><span class="op" id="4716123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4716126">//&nbsp;printf&nbsp;is&nbsp;a&nbsp;convenience&nbsp;wrapper&nbsp;that&nbsp;takes&nbsp;care&nbsp;of&nbsp;print&nbsp;errors.</span><br>
<span class="lineno">125</span><span class="keyword" id="4716194">func</span>&nbsp;<span class="op" id="4716199">(</span><span class="ident" id="4716200">p</span>&nbsp;<span class="op" id="4716202">*</span><span class="ident" id="4716203">printer</span><span class="op" id="4716210">)</span>&nbsp;<span class="ident" id="4716212">printf</span><span class="op" id="4716218">(</span><span class="ident" id="4716219">format</span>&nbsp;<span class="builtintype" id="4716226">string</span><span class="op" id="4716232">,</span>&nbsp;<span class="ident" id="4716234">args</span>&nbsp;<span class="op" id="4716239">...</span><span class="keyword" id="4716242">interface</span><span class="op" id="4716251">{</span><span class="op" id="4716252">}</span><span class="op" id="4716253">)</span>&nbsp;<span class="op" id="4716255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716258">if</span>&nbsp;<span class="ident" id="4716261">_</span><span class="op" id="4716262">,</span>&nbsp;<span class="ident" id="4716264">err</span>&nbsp;<span class="op" id="4716268">:=</span>&nbsp;<span class="ident" id="4716271">fmt</span><span class="op" id="4716274">.</span><span class="ident" id="4716275">Fprintf</span><span class="op" id="4716282">(</span><span class="ident" id="4716283">p</span><span class="op" id="4716284">,</span>&nbsp;<span class="ident" id="4716286">format</span><span class="op" id="4716292">,</span>&nbsp;<span class="ident" id="4716294">args</span><span class="op" id="4716298">...</span><span class="op" id="4716301">)</span><span class="op" id="4716302">;</span>&nbsp;<span class="ident" id="4716304">err</span>&nbsp;<span class="op" id="4716308">!=</span>&nbsp;<span class="ident" id="4716311">nil</span>&nbsp;<span class="op" id="4716315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4716319">panic</span><span class="op" id="4716324">(</span><span class="ident" id="4716325">localError</span><span class="op" id="4716335">{</span><span class="ident" id="4716336">err</span><span class="op" id="4716339">}</span><span class="op" id="4716340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4716343">}</span><br>
<span class="lineno"></span><span class="op" id="4716345">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="4716348">//&nbsp;Implementation&nbsp;note:&nbsp;Print&nbsp;is&nbsp;written&nbsp;for&nbsp;AST&nbsp;nodes&nbsp;but&nbsp;could&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4716416">//&nbsp;used&nbsp;to&nbsp;print&nbsp;arbitrary&nbsp;data&nbsp;structures;&nbsp;such&nbsp;a&nbsp;version&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="4716482">//&nbsp;probably&nbsp;be&nbsp;in&nbsp;a&nbsp;different&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="4716521">//</span><br>
<span class="lineno">135</span><span class="comment" id="4716524">//&nbsp;Note:&nbsp;This&nbsp;code&nbsp;detects&nbsp;(some)&nbsp;cycles&nbsp;created&nbsp;via&nbsp;pointers&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="4716590">//&nbsp;not&nbsp;cycles&nbsp;that&nbsp;are&nbsp;created&nbsp;via&nbsp;slices&nbsp;or&nbsp;maps&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4716655">//&nbsp;same&nbsp;slice&nbsp;or&nbsp;map.&nbsp;Code&nbsp;for&nbsp;general&nbsp;data&nbsp;structures&nbsp;probably</span><br>
<span class="lineno"></span><span class="comment" id="4716719">//&nbsp;should&nbsp;catch&nbsp;those&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="4716751">func</span>&nbsp;<span class="op" id="4716756">(</span><span class="ident" id="4716757">p</span>&nbsp;<span class="op" id="4716759">*</span><span class="ident" id="4716760">printer</span><span class="op" id="4716767">)</span>&nbsp;<span class="builtinfunc" id="4716769">print</span><span class="op" id="4716774">(</span><span class="ident" id="4716775">x</span>&nbsp;<span class="ident" id="4716777">reflect</span><span class="op" id="4716784">.</span><span class="ident" id="4716785">Value</span><span class="op" id="4716790">)</span>&nbsp;<span class="op" id="4716792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716795">if</span>&nbsp;<span class="op" id="4716798">!</span><span class="ident" id="4716799">NotNilFilter</span><span class="op" id="4716811">(</span><span class="string" id="4716812">&#34;&#34;</span><span class="op" id="4716814">,</span>&nbsp;<span class="ident" id="4716816">x</span><span class="op" id="4716817">)</span>&nbsp;<span class="op" id="4716819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716823">p</span><span class="op" id="4716824">.</span><span class="ident" id="4716825">printf</span><span class="op" id="4716831">(</span><span class="string" id="4716832">&#34;nil&#34;</span><span class="op" id="4716837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716841">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4716849">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716853">switch</span>&nbsp;<span class="ident" id="4716860">x</span><span class="op" id="4716861">.</span><span class="ident" id="4716862">Kind</span><span class="op" id="4716866">(</span><span class="op" id="4716867">)</span>&nbsp;<span class="op" id="4716869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716872">case</span>&nbsp;<span class="ident" id="4716877">reflect</span><span class="op" id="4716884">.</span><span class="ident" id="4716885">Interface</span><span class="op" id="4716894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716898">p</span><span class="op" id="4716899">.</span><span class="builtinfunc" id="4716900">print</span><span class="op" id="4716905">(</span><span class="ident" id="4716906">x</span><span class="op" id="4716907">.</span><span class="ident" id="4716908">Elem</span><span class="op" id="4716912">(</span><span class="op" id="4716913">)</span><span class="op" id="4716914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716918">case</span>&nbsp;<span class="ident" id="4716923">reflect</span><span class="op" id="4716930">.</span><span class="ident" id="4716931">Map</span><span class="op" id="4716934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716938">p</span><span class="op" id="4716939">.</span><span class="ident" id="4716940">printf</span><span class="op" id="4716946">(</span><span class="string" id="4716947">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="4716964">,</span>&nbsp;<span class="ident" id="4716966">x</span><span class="op" id="4716967">.</span><span class="ident" id="4716968">Type</span><span class="op" id="4716972">(</span><span class="op" id="4716973">)</span><span class="op" id="4716974">,</span>&nbsp;<span class="ident" id="4716976">x</span><span class="op" id="4716977">.</span><span class="ident" id="4716978">Len</span><span class="op" id="4716981">(</span><span class="op" id="4716982">)</span><span class="op" id="4716983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716987">if</span>&nbsp;<span class="ident" id="4716990">x</span><span class="op" id="4716991">.</span><span class="ident" id="4716992">Len</span><span class="op" id="4716995">(</span><span class="op" id="4716996">)</span>&nbsp;<span class="op" id="4716998">&gt;</span>&nbsp;<span class="num" id="4717000">0</span>&nbsp;<span class="op" id="4717002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717007">p</span><span class="op" id="4717008">.</span><span class="ident" id="4717009">indent</span><span class="op" id="4717015">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717021">p</span><span class="op" id="4717022">.</span><span class="ident" id="4717023">printf</span><span class="op" id="4717029">(</span><span class="string" id="4717030">&#34;\n&#34;</span><span class="op" id="4717034">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717039">for</span>&nbsp;<span class="ident" id="4717043">_</span><span class="op" id="4717044">,</span>&nbsp;<span class="ident" id="4717046">key</span>&nbsp;<span class="op" id="4717050">:=</span>&nbsp;<span class="keyword" id="4717053">range</span>&nbsp;<span class="ident" id="4717059">x</span><span class="op" id="4717060">.</span><span class="ident" id="4717061">MapKeys</span><span class="op" id="4717068">(</span><span class="op" id="4717069">)</span>&nbsp;<span class="op" id="4717071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717077">p</span><span class="op" id="4717078">.</span><span class="builtinfunc" id="4717079">print</span><span class="op" id="4717084">(</span><span class="ident" id="4717085">key</span><span class="op" id="4717088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717094">p</span><span class="op" id="4717095">.</span><span class="ident" id="4717096">printf</span><span class="op" id="4717102">(</span><span class="string" id="4717103">&#34;:&nbsp;&#34;</span><span class="op" id="4717107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717113">p</span><span class="op" id="4717114">.</span><span class="builtinfunc" id="4717115">print</span><span class="op" id="4717120">(</span><span class="ident" id="4717121">x</span><span class="op" id="4717122">.</span><span class="ident" id="4717123">MapIndex</span><span class="op" id="4717131">(</span><span class="ident" id="4717132">key</span><span class="op" id="4717135">)</span><span class="op" id="4717136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717142">p</span><span class="op" id="4717143">.</span><span class="ident" id="4717144">printf</span><span class="op" id="4717150">(</span><span class="string" id="4717151">&#34;\n&#34;</span><span class="op" id="4717155">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717165">p</span><span class="op" id="4717166">.</span><span class="ident" id="4717167">indent</span><span class="op" id="4717173">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717182">p</span><span class="op" id="4717183">.</span><span class="ident" id="4717184">printf</span><span class="op" id="4717190">(</span><span class="string" id="4717191">&#34;}&#34;</span><span class="op" id="4717194">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717198">case</span>&nbsp;<span class="ident" id="4717203">reflect</span><span class="op" id="4717210">.</span><span class="ident" id="4717211">Ptr</span><span class="op" id="4717214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717218">p</span><span class="op" id="4717219">.</span><span class="ident" id="4717220">printf</span><span class="op" id="4717226">(</span><span class="string" id="4717227">&#34;*&#34;</span><span class="op" id="4717230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4717234">//&nbsp;type-checked&nbsp;ASTs&nbsp;may&nbsp;contain&nbsp;cycles&nbsp;-&nbsp;use&nbsp;ptrmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4717289">//&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;objects&nbsp;that&nbsp;have&nbsp;been&nbsp;printed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4717342">//&nbsp;already&nbsp;and&nbsp;print&nbsp;the&nbsp;respective&nbsp;line&nbsp;number&nbsp;instead</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717400">ptr</span>&nbsp;<span class="op" id="4717404">:=</span>&nbsp;<span class="ident" id="4717407">x</span><span class="op" id="4717408">.</span><span class="ident" id="4717409">Interface</span><span class="op" id="4717418">(</span><span class="op" id="4717419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717423">if</span>&nbsp;<span class="ident" id="4717426">line</span><span class="op" id="4717430">,</span>&nbsp;<span class="ident" id="4717432">exists</span>&nbsp;<span class="op" id="4717439">:=</span>&nbsp;<span class="ident" id="4717442">p</span><span class="op" id="4717443">.</span><span class="ident" id="4717444">ptrmap</span><span class="op" id="4717450">[</span><span class="ident" id="4717451">ptr</span><span class="op" id="4717454">]</span><span class="op" id="4717455">;</span>&nbsp;<span class="ident" id="4717457">exists</span>&nbsp;<span class="op" id="4717464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717469">p</span><span class="op" id="4717470">.</span><span class="ident" id="4717471">printf</span><span class="op" id="4717477">(</span><span class="string" id="4717478">&#34;(obj&nbsp;@&nbsp;%d)&#34;</span><span class="op" id="4717490">,</span>&nbsp;<span class="ident" id="4717492">line</span><span class="op" id="4717496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717500">}</span>&nbsp;<span class="keyword" id="4717502">else</span>&nbsp;<span class="op" id="4717507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717512">p</span><span class="op" id="4717513">.</span><span class="ident" id="4717514">ptrmap</span><span class="op" id="4717520">[</span><span class="ident" id="4717521">ptr</span><span class="op" id="4717524">]</span>&nbsp;<span class="op" id="4717526">=</span>&nbsp;<span class="ident" id="4717528">p</span><span class="op" id="4717529">.</span><span class="ident" id="4717530">line</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717538">p</span><span class="op" id="4717539">.</span><span class="builtinfunc" id="4717540">print</span><span class="op" id="4717545">(</span><span class="ident" id="4717546">x</span><span class="op" id="4717547">.</span><span class="ident" id="4717548">Elem</span><span class="op" id="4717552">(</span><span class="op" id="4717553">)</span><span class="op" id="4717554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717562">case</span>&nbsp;<span class="ident" id="4717567">reflect</span><span class="op" id="4717574">.</span><span class="ident" id="4717575">Array</span><span class="op" id="4717580">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717584">p</span><span class="op" id="4717585">.</span><span class="ident" id="4717586">printf</span><span class="op" id="4717592">(</span><span class="string" id="4717593">&#34;%s&nbsp;{&#34;</span><span class="op" id="4717599">,</span>&nbsp;<span class="ident" id="4717601">x</span><span class="op" id="4717602">.</span><span class="ident" id="4717603">Type</span><span class="op" id="4717607">(</span><span class="op" id="4717608">)</span><span class="op" id="4717609">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717613">if</span>&nbsp;<span class="ident" id="4717616">x</span><span class="op" id="4717617">.</span><span class="ident" id="4717618">Len</span><span class="op" id="4717621">(</span><span class="op" id="4717622">)</span>&nbsp;<span class="op" id="4717624">&gt;</span>&nbsp;<span class="num" id="4717626">0</span>&nbsp;<span class="op" id="4717628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717633">p</span><span class="op" id="4717634">.</span><span class="ident" id="4717635">indent</span><span class="op" id="4717641">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717647">p</span><span class="op" id="4717648">.</span><span class="ident" id="4717649">printf</span><span class="op" id="4717655">(</span><span class="string" id="4717656">&#34;\n&#34;</span><span class="op" id="4717660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717665">for</span>&nbsp;<span class="ident" id="4717669">i</span><span class="op" id="4717670">,</span>&nbsp;<span class="ident" id="4717672">n</span>&nbsp;<span class="op" id="4717674">:=</span>&nbsp;<span class="num" id="4717677">0</span><span class="op" id="4717678">,</span>&nbsp;<span class="ident" id="4717680">x</span><span class="op" id="4717681">.</span><span class="ident" id="4717682">Len</span><span class="op" id="4717685">(</span><span class="op" id="4717686">)</span><span class="op" id="4717687">;</span>&nbsp;<span class="ident" id="4717689">i</span>&nbsp;<span class="op" id="4717691">&lt;</span>&nbsp;<span class="ident" id="4717693">n</span><span class="op" id="4717694">;</span>&nbsp;<span class="ident" id="4717696">i</span><span class="op" id="4717697">++</span>&nbsp;<span class="op" id="4717700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717706">p</span><span class="op" id="4717707">.</span><span class="ident" id="4717708">printf</span><span class="op" id="4717714">(</span><span class="string" id="4717715">&#34;%d:&nbsp;&#34;</span><span class="op" id="4717721">,</span>&nbsp;<span class="ident" id="4717723">i</span><span class="op" id="4717724">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717730">p</span><span class="op" id="4717731">.</span><span class="builtinfunc" id="4717732">print</span><span class="op" id="4717737">(</span><span class="ident" id="4717738">x</span><span class="op" id="4717739">.</span><span class="ident" id="4717740">Index</span><span class="op" id="4717745">(</span><span class="ident" id="4717746">i</span><span class="op" id="4717747">)</span><span class="op" id="4717748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717754">p</span><span class="op" id="4717755">.</span><span class="ident" id="4717756">printf</span><span class="op" id="4717762">(</span><span class="string" id="4717763">&#34;\n&#34;</span><span class="op" id="4717767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717777">p</span><span class="op" id="4717778">.</span><span class="ident" id="4717779">indent</span><span class="op" id="4717785">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717790">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717794">p</span><span class="op" id="4717795">.</span><span class="ident" id="4717796">printf</span><span class="op" id="4717802">(</span><span class="string" id="4717803">&#34;}&#34;</span><span class="op" id="4717806">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717810">case</span>&nbsp;<span class="ident" id="4717815">reflect</span><span class="op" id="4717822">.</span><span class="ident" id="4717823">Slice</span><span class="op" id="4717828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717832">if</span>&nbsp;<span class="ident" id="4717835">s</span><span class="op" id="4717836">,</span>&nbsp;<span class="ident" id="4717838">ok</span>&nbsp;<span class="op" id="4717841">:=</span>&nbsp;<span class="ident" id="4717844">x</span><span class="op" id="4717845">.</span><span class="ident" id="4717846">Interface</span><span class="op" id="4717855">(</span><span class="op" id="4717856">)</span><span class="op" id="4717857">.</span><span class="op" id="4717858">(</span><span class="op" id="4717859">[</span><span class="op" id="4717860">]</span><span class="builtintype" id="4717861">byte</span><span class="op" id="4717865">)</span><span class="op" id="4717866">;</span>&nbsp;<span class="ident" id="4717868">ok</span>&nbsp;<span class="op" id="4717871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717876">p</span><span class="op" id="4717877">.</span><span class="ident" id="4717878">printf</span><span class="op" id="4717884">(</span><span class="string" id="4717885">&#34;%#q&#34;</span><span class="op" id="4717890">,</span>&nbsp;<span class="ident" id="4717892">s</span><span class="op" id="4717893">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717898">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717911">p</span><span class="op" id="4717912">.</span><span class="ident" id="4717913">printf</span><span class="op" id="4717919">(</span><span class="string" id="4717920">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="4717937">,</span>&nbsp;<span class="ident" id="4717939">x</span><span class="op" id="4717940">.</span><span class="ident" id="4717941">Type</span><span class="op" id="4717945">(</span><span class="op" id="4717946">)</span><span class="op" id="4717947">,</span>&nbsp;<span class="ident" id="4717949">x</span><span class="op" id="4717950">.</span><span class="ident" id="4717951">Len</span><span class="op" id="4717954">(</span><span class="op" id="4717955">)</span><span class="op" id="4717956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717960">if</span>&nbsp;<span class="ident" id="4717963">x</span><span class="op" id="4717964">.</span><span class="ident" id="4717965">Len</span><span class="op" id="4717968">(</span><span class="op" id="4717969">)</span>&nbsp;<span class="op" id="4717971">&gt;</span>&nbsp;<span class="num" id="4717973">0</span>&nbsp;<span class="op" id="4717975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717980">p</span><span class="op" id="4717981">.</span><span class="ident" id="4717982">indent</span><span class="op" id="4717988">++</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717994">p</span><span class="op" id="4717995">.</span><span class="ident" id="4717996">printf</span><span class="op" id="4718002">(</span><span class="string" id="4718003">&#34;\n&#34;</span><span class="op" id="4718007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718012">for</span>&nbsp;<span class="ident" id="4718016">i</span><span class="op" id="4718017">,</span>&nbsp;<span class="ident" id="4718019">n</span>&nbsp;<span class="op" id="4718021">:=</span>&nbsp;<span class="num" id="4718024">0</span><span class="op" id="4718025">,</span>&nbsp;<span class="ident" id="4718027">x</span><span class="op" id="4718028">.</span><span class="ident" id="4718029">Len</span><span class="op" id="4718032">(</span><span class="op" id="4718033">)</span><span class="op" id="4718034">;</span>&nbsp;<span class="ident" id="4718036">i</span>&nbsp;<span class="op" id="4718038">&lt;</span>&nbsp;<span class="ident" id="4718040">n</span><span class="op" id="4718041">;</span>&nbsp;<span class="ident" id="4718043">i</span><span class="op" id="4718044">++</span>&nbsp;<span class="op" id="4718047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718053">p</span><span class="op" id="4718054">.</span><span class="ident" id="4718055">printf</span><span class="op" id="4718061">(</span><span class="string" id="4718062">&#34;%d:&nbsp;&#34;</span><span class="op" id="4718068">,</span>&nbsp;<span class="ident" id="4718070">i</span><span class="op" id="4718071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718077">p</span><span class="op" id="4718078">.</span><span class="builtinfunc" id="4718079">print</span><span class="op" id="4718084">(</span><span class="ident" id="4718085">x</span><span class="op" id="4718086">.</span><span class="ident" id="4718087">Index</span><span class="op" id="4718092">(</span><span class="ident" id="4718093">i</span><span class="op" id="4718094">)</span><span class="op" id="4718095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718101">p</span><span class="op" id="4718102">.</span><span class="ident" id="4718103">printf</span><span class="op" id="4718109">(</span><span class="string" id="4718110">&#34;\n&#34;</span><span class="op" id="4718114">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718124">p</span><span class="op" id="4718125">.</span><span class="ident" id="4718126">indent</span><span class="op" id="4718132">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718141">p</span><span class="op" id="4718142">.</span><span class="ident" id="4718143">printf</span><span class="op" id="4718149">(</span><span class="string" id="4718150">&#34;}&#34;</span><span class="op" id="4718153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718157">case</span>&nbsp;<span class="ident" id="4718162">reflect</span><span class="op" id="4718169">.</span><span class="ident" id="4718170">Struct</span><span class="op" id="4718176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718180">t</span>&nbsp;<span class="op" id="4718182">:=</span>&nbsp;<span class="ident" id="4718185">x</span><span class="op" id="4718186">.</span><span class="ident" id="4718187">Type</span><span class="op" id="4718191">(</span><span class="op" id="4718192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718196">p</span><span class="op" id="4718197">.</span><span class="ident" id="4718198">printf</span><span class="op" id="4718204">(</span><span class="string" id="4718205">&#34;%s&nbsp;{&#34;</span><span class="op" id="4718211">,</span>&nbsp;<span class="ident" id="4718213">t</span><span class="op" id="4718214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718218">p</span><span class="op" id="4718219">.</span><span class="ident" id="4718220">indent</span><span class="op" id="4718226">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718231">first</span>&nbsp;<span class="op" id="4718237">:=</span>&nbsp;<span class="builtintype" id="4718240">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718247">for</span>&nbsp;<span class="ident" id="4718251">i</span><span class="op" id="4718252">,</span>&nbsp;<span class="ident" id="4718254">n</span>&nbsp;<span class="op" id="4718256">:=</span>&nbsp;<span class="num" id="4718259">0</span><span class="op" id="4718260">,</span>&nbsp;<span class="ident" id="4718262">t</span><span class="op" id="4718263">.</span><span class="ident" id="4718264">NumField</span><span class="op" id="4718272">(</span><span class="op" id="4718273">)</span><span class="op" id="4718274">;</span>&nbsp;<span class="ident" id="4718276">i</span>&nbsp;<span class="op" id="4718278">&lt;</span>&nbsp;<span class="ident" id="4718280">n</span><span class="op" id="4718281">;</span>&nbsp;<span class="ident" id="4718283">i</span><span class="op" id="4718284">++</span>&nbsp;<span class="op" id="4718287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718292">//&nbsp;exclude&nbsp;non-exported&nbsp;fields&nbsp;because&nbsp;their</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718340">//&nbsp;values&nbsp;cannot&nbsp;be&nbsp;accessed&nbsp;via&nbsp;reflection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718387">if</span>&nbsp;<span class="ident" id="4718390">name</span>&nbsp;<span class="op" id="4718395">:=</span>&nbsp;<span class="ident" id="4718398">t</span><span class="op" id="4718399">.</span><span class="ident" id="4718400">Field</span><span class="op" id="4718405">(</span><span class="ident" id="4718406">i</span><span class="op" id="4718407">)</span><span class="op" id="4718408">.</span><span class="ident" id="4718409">Name</span><span class="op" id="4718413">;</span>&nbsp;<span class="ident" id="4718415">IsExported</span><span class="op" id="4718425">(</span><span class="ident" id="4718426">name</span><span class="op" id="4718430">)</span>&nbsp;<span class="op" id="4718432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718438">value</span>&nbsp;<span class="op" id="4718444">:=</span>&nbsp;<span class="ident" id="4718447">x</span><span class="op" id="4718448">.</span><span class="ident" id="4718449">Field</span><span class="op" id="4718454">(</span><span class="ident" id="4718455">i</span><span class="op" id="4718456">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718462">if</span>&nbsp;<span class="ident" id="4718465">p</span><span class="op" id="4718466">.</span><span class="ident" id="4718467">filter</span>&nbsp;<span class="op" id="4718474">==</span>&nbsp;<span class="ident" id="4718477">nil</span>&nbsp;<span class="op" id="4718481">||</span>&nbsp;<span class="ident" id="4718484">p</span><span class="op" id="4718485">.</span><span class="ident" id="4718486">filter</span><span class="op" id="4718492">(</span><span class="ident" id="4718493">name</span><span class="op" id="4718497">,</span>&nbsp;<span class="ident" id="4718499">value</span><span class="op" id="4718504">)</span>&nbsp;<span class="op" id="4718506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718513">if</span>&nbsp;<span class="ident" id="4718516">first</span>&nbsp;<span class="op" id="4718522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718530">p</span><span class="op" id="4718531">.</span><span class="ident" id="4718532">printf</span><span class="op" id="4718538">(</span><span class="string" id="4718539">&#34;\n&#34;</span><span class="op" id="4718543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718551">first</span>&nbsp;<span class="op" id="4718557">=</span>&nbsp;<span class="builtintype" id="4718559">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718570">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718577">p</span><span class="op" id="4718578">.</span><span class="ident" id="4718579">printf</span><span class="op" id="4718585">(</span><span class="string" id="4718586">&#34;%s:&nbsp;&#34;</span><span class="op" id="4718592">,</span>&nbsp;<span class="ident" id="4718594">name</span><span class="op" id="4718598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718605">p</span><span class="op" id="4718606">.</span><span class="builtinfunc" id="4718607">print</span><span class="op" id="4718612">(</span><span class="ident" id="4718613">value</span><span class="op" id="4718618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718625">p</span><span class="op" id="4718626">.</span><span class="ident" id="4718627">printf</span><span class="op" id="4718633">(</span><span class="string" id="4718634">&#34;\n&#34;</span><span class="op" id="4718638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718649">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718657">p</span><span class="op" id="4718658">.</span><span class="ident" id="4718659">indent</span><span class="op" id="4718665">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718670">p</span><span class="op" id="4718671">.</span><span class="ident" id="4718672">printf</span><span class="op" id="4718678">(</span><span class="string" id="4718679">&#34;}&#34;</span><span class="op" id="4718682">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718686">default</span><span class="op" id="4718693">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718697">v</span>&nbsp;<span class="op" id="4718699">:=</span>&nbsp;<span class="ident" id="4718702">x</span><span class="op" id="4718703">.</span><span class="ident" id="4718704">Interface</span><span class="op" id="4718713">(</span><span class="op" id="4718714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718718">switch</span>&nbsp;<span class="ident" id="4718725">v</span>&nbsp;<span class="op" id="4718727">:=</span>&nbsp;<span class="ident" id="4718730">v</span><span class="op" id="4718731">.</span><span class="op" id="4718732">(</span><span class="keyword" id="4718733">type</span><span class="op" id="4718737">)</span>&nbsp;<span class="op" id="4718739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718743">case</span>&nbsp;<span class="builtintype" id="4718748">string</span><span class="op" id="4718754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718759">//&nbsp;print&nbsp;strings&nbsp;in&nbsp;quotes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718789">p</span><span class="op" id="4718790">.</span><span class="ident" id="4718791">printf</span><span class="op" id="4718797">(</span><span class="string" id="4718798">&#34;%q&#34;</span><span class="op" id="4718802">,</span>&nbsp;<span class="ident" id="4718804">v</span><span class="op" id="4718805">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718810">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718819">case</span>&nbsp;<span class="ident" id="4718824">token</span><span class="op" id="4718829">.</span><span class="ident" id="4718830">Pos</span><span class="op" id="4718833">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718838">//&nbsp;position&nbsp;values&nbsp;can&nbsp;be&nbsp;printed&nbsp;nicely&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718904">if</span>&nbsp;<span class="ident" id="4718907">p</span><span class="op" id="4718908">.</span><span class="ident" id="4718909">fset</span>&nbsp;<span class="op" id="4718914">!=</span>&nbsp;<span class="ident" id="4718917">nil</span>&nbsp;<span class="op" id="4718921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718927">p</span><span class="op" id="4718928">.</span><span class="ident" id="4718929">printf</span><span class="op" id="4718935">(</span><span class="string" id="4718936">&#34;%s&#34;</span><span class="op" id="4718940">,</span>&nbsp;<span class="ident" id="4718942">p</span><span class="op" id="4718943">.</span><span class="ident" id="4718944">fset</span><span class="op" id="4718948">.</span><span class="ident" id="4718949">Position</span><span class="op" id="4718957">(</span><span class="ident" id="4718958">v</span><span class="op" id="4718959">)</span><span class="op" id="4718960">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718966">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718984">//&nbsp;default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718997">p</span><span class="op" id="4718998">.</span><span class="ident" id="4718999">printf</span><span class="op" id="4719005">(</span><span class="string" id="4719006">&#34;%v&#34;</span><span class="op" id="4719010">,</span>&nbsp;<span class="ident" id="4719012">v</span><span class="op" id="4719013">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719016">}</span><br>
<span class="lineno"></span><span class="op" id="4719018">}</span>
</div>
</body>
</html>
