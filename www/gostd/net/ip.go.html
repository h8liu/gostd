<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3168584">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3168639">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3168693">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3168744">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="3168772">//</span><br>
<span class="lineno"></span><span class="comment" id="3168775">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3168835">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3168893">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="3168943">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3169004">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3169035">package</span>&nbsp;<span class="ident" id="3169043">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3169048">import</span>&nbsp;<span class="string" id="3169055">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3169065">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="3169096">const</span>&nbsp;<span class="op" id="3169102">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169105">IPv4len</span>&nbsp;<span class="op" id="3169113">=</span>&nbsp;<span class="num" id="3169115">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169118">IPv6len</span>&nbsp;<span class="op" id="3169126">=</span>&nbsp;<span class="num" id="3169128">16</span><br>
<span class="lineno"></span><span class="op" id="3169131">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3169134">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3169185">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="3169242">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3169280">//</span><br>
<span class="lineno"></span><span class="comment" id="3169283">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3169335">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3169387">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="3169442">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3169497">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3169520">type</span>&nbsp;<span class="ident" id="3169525">IP</span>&nbsp;<span class="op" id="3169528">[</span><span class="op" id="3169529">]</span><span class="builtintype" id="3169530">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3169536">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="3169568">type</span>&nbsp;<span class="ident" id="3169573">IPMask</span>&nbsp;<span class="op" id="3169580">[</span><span class="op" id="3169581">]</span><span class="builtintype" id="3169582">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3169588">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="3169626">type</span>&nbsp;<span class="ident" id="3169631">IPNet</span>&nbsp;<span class="keyword" id="3169637">struct</span>&nbsp;<span class="op" id="3169644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169647">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3169652">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3169659">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169678">Mask</span>&nbsp;<span class="ident" id="3169683">IPMask</span>&nbsp;<span class="comment" id="3169690">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="3169706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3169709">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3169765">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="3169790">func</span>&nbsp;<span class="ident" id="3169795">IPv4</span><span class="op" id="3169799">(</span><span class="ident" id="3169800">a</span><span class="op" id="3169801">,</span>&nbsp;<span class="ident" id="3169803">b</span><span class="op" id="3169804">,</span>&nbsp;<span class="ident" id="3169806">c</span><span class="op" id="3169807">,</span>&nbsp;<span class="ident" id="3169809">d</span>&nbsp;<span class="builtintype" id="3169811">byte</span><span class="op" id="3169815">)</span>&nbsp;<span class="ident" id="3169817">IP</span>&nbsp;<span class="op" id="3169820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169823">p</span>&nbsp;<span class="op" id="3169825">:=</span>&nbsp;<span class="builtinfunc" id="3169828">make</span><span class="op" id="3169832">(</span><span class="ident" id="3169833">IP</span><span class="op" id="3169835">,</span>&nbsp;<span class="ident" id="3169837">IPv6len</span><span class="op" id="3169844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3169847">copy</span><span class="op" id="3169851">(</span><span class="ident" id="3169852">p</span><span class="op" id="3169853">,</span>&nbsp;<span class="ident" id="3169855">v4InV6Prefix</span><span class="op" id="3169867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169870">p</span><span class="op" id="3169871">[</span><span class="num" id="3169872">12</span><span class="op" id="3169874">]</span>&nbsp;<span class="op" id="3169876">=</span>&nbsp;<span class="ident" id="3169878">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169881">p</span><span class="op" id="3169882">[</span><span class="num" id="3169883">13</span><span class="op" id="3169885">]</span>&nbsp;<span class="op" id="3169887">=</span>&nbsp;<span class="ident" id="3169889">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169892">p</span><span class="op" id="3169893">[</span><span class="num" id="3169894">14</span><span class="op" id="3169896">]</span>&nbsp;<span class="op" id="3169898">=</span>&nbsp;<span class="ident" id="3169900">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3169903">p</span><span class="op" id="3169904">[</span><span class="num" id="3169905">15</span><span class="op" id="3169907">]</span>&nbsp;<span class="op" id="3169909">=</span>&nbsp;<span class="ident" id="3169911">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3169914">return</span>&nbsp;<span class="ident" id="3169921">p</span><br>
<span class="lineno"></span><span class="op" id="3169923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3169926">var</span>&nbsp;<span class="ident" id="3169930">v4InV6Prefix</span>&nbsp;<span class="op" id="3169943">=</span>&nbsp;<span class="op" id="3169945">[</span><span class="op" id="3169946">]</span><span class="builtintype" id="3169947">byte</span><span class="op" id="3169951">{</span><span class="num" id="3169952">0</span><span class="op" id="3169953">,</span>&nbsp;<span class="num" id="3169955">0</span><span class="op" id="3169956">,</span>&nbsp;<span class="num" id="3169958">0</span><span class="op" id="3169959">,</span>&nbsp;<span class="num" id="3169961">0</span><span class="op" id="3169962">,</span>&nbsp;<span class="num" id="3169964">0</span><span class="op" id="3169965">,</span>&nbsp;<span class="num" id="3169967">0</span><span class="op" id="3169968">,</span>&nbsp;<span class="num" id="3169970">0</span><span class="op" id="3169971">,</span>&nbsp;<span class="num" id="3169973">0</span><span class="op" id="3169974">,</span>&nbsp;<span class="num" id="3169976">0</span><span class="op" id="3169977">,</span>&nbsp;<span class="num" id="3169979">0</span><span class="op" id="3169980">,</span>&nbsp;<span class="num" id="3169982">0xff</span><span class="op" id="3169986">,</span>&nbsp;<span class="num" id="3169988">0xff</span><span class="op" id="3169992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3169995">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3170051">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="3170073">func</span>&nbsp;<span class="ident" id="3170078">IPv4Mask</span><span class="op" id="3170086">(</span><span class="ident" id="3170087">a</span><span class="op" id="3170088">,</span>&nbsp;<span class="ident" id="3170090">b</span><span class="op" id="3170091">,</span>&nbsp;<span class="ident" id="3170093">c</span><span class="op" id="3170094">,</span>&nbsp;<span class="ident" id="3170096">d</span>&nbsp;<span class="builtintype" id="3170098">byte</span><span class="op" id="3170102">)</span>&nbsp;<span class="ident" id="3170104">IPMask</span>&nbsp;<span class="op" id="3170111">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170114">p</span>&nbsp;<span class="op" id="3170116">:=</span>&nbsp;<span class="builtinfunc" id="3170119">make</span><span class="op" id="3170123">(</span><span class="ident" id="3170124">IPMask</span><span class="op" id="3170130">,</span>&nbsp;<span class="ident" id="3170132">IPv4len</span><span class="op" id="3170139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170142">p</span><span class="op" id="3170143">[</span><span class="num" id="3170144">0</span><span class="op" id="3170145">]</span>&nbsp;<span class="op" id="3170147">=</span>&nbsp;<span class="ident" id="3170149">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170152">p</span><span class="op" id="3170153">[</span><span class="num" id="3170154">1</span><span class="op" id="3170155">]</span>&nbsp;<span class="op" id="3170157">=</span>&nbsp;<span class="ident" id="3170159">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170162">p</span><span class="op" id="3170163">[</span><span class="num" id="3170164">2</span><span class="op" id="3170165">]</span>&nbsp;<span class="op" id="3170167">=</span>&nbsp;<span class="ident" id="3170169">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170172">p</span><span class="op" id="3170173">[</span><span class="num" id="3170174">3</span><span class="op" id="3170175">]</span>&nbsp;<span class="op" id="3170177">=</span>&nbsp;<span class="ident" id="3170179">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170182">return</span>&nbsp;<span class="ident" id="3170189">p</span><br>
<span class="lineno"></span><span class="op" id="3170191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3170194">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3170252">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="3170307">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="3170375">func</span>&nbsp;<span class="ident" id="3170380">CIDRMask</span><span class="op" id="3170388">(</span><span class="ident" id="3170389">ones</span><span class="op" id="3170393">,</span>&nbsp;<span class="ident" id="3170395">bits</span>&nbsp;<span class="builtintype" id="3170400">int</span><span class="op" id="3170403">)</span>&nbsp;<span class="ident" id="3170405">IPMask</span>&nbsp;<span class="op" id="3170412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170415">if</span>&nbsp;<span class="ident" id="3170418">bits</span>&nbsp;<span class="op" id="3170423">!=</span>&nbsp;<span class="num" id="3170426">8</span><span class="op" id="3170427">*</span><span class="ident" id="3170428">IPv4len</span>&nbsp;<span class="op" id="3170436">&amp;&amp;</span>&nbsp;<span class="ident" id="3170439">bits</span>&nbsp;<span class="op" id="3170444">!=</span>&nbsp;<span class="num" id="3170447">8</span><span class="op" id="3170448">*</span><span class="ident" id="3170449">IPv6len</span>&nbsp;<span class="op" id="3170457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170461">return</span>&nbsp;<span class="ident" id="3170468">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3170473">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170476">if</span>&nbsp;<span class="ident" id="3170479">ones</span>&nbsp;<span class="op" id="3170484">&lt;</span>&nbsp;<span class="num" id="3170486">0</span>&nbsp;<span class="op" id="3170488">||</span>&nbsp;<span class="ident" id="3170491">ones</span>&nbsp;<span class="op" id="3170496">&gt;</span>&nbsp;<span class="ident" id="3170498">bits</span>&nbsp;<span class="op" id="3170503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170507">return</span>&nbsp;<span class="ident" id="3170514">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3170519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170522">l</span>&nbsp;<span class="op" id="3170524">:=</span>&nbsp;<span class="ident" id="3170527">bits</span>&nbsp;<span class="op" id="3170532">/</span>&nbsp;<span class="num" id="3170534">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170537">m</span>&nbsp;<span class="op" id="3170539">:=</span>&nbsp;<span class="builtinfunc" id="3170542">make</span><span class="op" id="3170546">(</span><span class="ident" id="3170547">IPMask</span><span class="op" id="3170553">,</span>&nbsp;<span class="ident" id="3170555">l</span><span class="op" id="3170556">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170559">n</span>&nbsp;<span class="op" id="3170561">:=</span>&nbsp;<span class="builtintype" id="3170564">uint</span><span class="op" id="3170568">(</span><span class="ident" id="3170569">ones</span><span class="op" id="3170573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170576">for</span>&nbsp;<span class="ident" id="3170580">i</span>&nbsp;<span class="op" id="3170582">:=</span>&nbsp;<span class="num" id="3170585">0</span><span class="op" id="3170586">;</span>&nbsp;<span class="ident" id="3170588">i</span>&nbsp;<span class="op" id="3170590">&lt;</span>&nbsp;<span class="ident" id="3170592">l</span><span class="op" id="3170593">;</span>&nbsp;<span class="ident" id="3170595">i</span><span class="op" id="3170596">++</span>&nbsp;<span class="op" id="3170599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170603">if</span>&nbsp;<span class="ident" id="3170606">n</span>&nbsp;<span class="op" id="3170608">&gt;=</span>&nbsp;<span class="num" id="3170611">8</span>&nbsp;<span class="op" id="3170613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170618">m</span><span class="op" id="3170619">[</span><span class="ident" id="3170620">i</span><span class="op" id="3170621">]</span>&nbsp;<span class="op" id="3170623">=</span>&nbsp;<span class="num" id="3170625">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170633">n</span>&nbsp;<span class="op" id="3170635">-=</span>&nbsp;<span class="num" id="3170638">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170643">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3170654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170658">m</span><span class="op" id="3170659">[</span><span class="ident" id="3170660">i</span><span class="op" id="3170661">]</span>&nbsp;<span class="op" id="3170663">=</span>&nbsp;<span class="op" id="3170665">^</span><span class="builtintype" id="3170666">byte</span><span class="op" id="3170670">(</span><span class="num" id="3170671">0xff</span>&nbsp;<span class="op" id="3170676">&gt;&gt;</span>&nbsp;<span class="ident" id="3170679">n</span><span class="op" id="3170680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170684">n</span>&nbsp;<span class="op" id="3170686">=</span>&nbsp;<span class="num" id="3170688">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3170691">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3170694">return</span>&nbsp;<span class="ident" id="3170701">m</span><br>
<span class="lineno"></span><span class="op" id="3170703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3170706">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3170735">var</span>&nbsp;<span class="op" id="3170739">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170742">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170756">=</span>&nbsp;<span class="ident" id="3170758">IPv4</span><span class="op" id="3170762">(</span><span class="num" id="3170763">255</span><span class="op" id="3170766">,</span>&nbsp;<span class="num" id="3170768">255</span><span class="op" id="3170771">,</span>&nbsp;<span class="num" id="3170773">255</span><span class="op" id="3170776">,</span>&nbsp;<span class="num" id="3170778">255</span><span class="op" id="3170781">)</span>&nbsp;<span class="comment" id="3170783">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170797">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170811">=</span>&nbsp;<span class="ident" id="3170813">IPv4</span><span class="op" id="3170817">(</span><span class="num" id="3170818">224</span><span class="op" id="3170821">,</span>&nbsp;<span class="num" id="3170823">0</span><span class="op" id="3170824">,</span>&nbsp;<span class="num" id="3170826">0</span><span class="op" id="3170827">,</span>&nbsp;<span class="num" id="3170829">1</span><span class="op" id="3170830">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3170838">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170854">IPv4allrouter</span>&nbsp;<span class="op" id="3170868">=</span>&nbsp;<span class="ident" id="3170870">IPv4</span><span class="op" id="3170874">(</span><span class="num" id="3170875">224</span><span class="op" id="3170878">,</span>&nbsp;<span class="num" id="3170880">0</span><span class="op" id="3170881">,</span>&nbsp;<span class="num" id="3170883">0</span><span class="op" id="3170884">,</span>&nbsp;<span class="num" id="3170886">2</span><span class="op" id="3170887">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3170895">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3170911">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3170925">=</span>&nbsp;<span class="ident" id="3170927">IPv4</span><span class="op" id="3170931">(</span><span class="num" id="3170932">0</span><span class="op" id="3170933">,</span>&nbsp;<span class="num" id="3170935">0</span><span class="op" id="3170936">,</span>&nbsp;<span class="num" id="3170938">0</span><span class="op" id="3170939">,</span>&nbsp;<span class="num" id="3170941">0</span><span class="op" id="3170942">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3170952">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="3170965">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3170968">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3170997">var</span>&nbsp;<span class="op" id="3171001">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171004">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171031">=</span>&nbsp;<span class="ident" id="3171033">IP</span><span class="op" id="3171035">{</span><span class="num" id="3171036">0</span><span class="op" id="3171037">,</span>&nbsp;<span class="num" id="3171039">0</span><span class="op" id="3171040">,</span>&nbsp;<span class="num" id="3171042">0</span><span class="op" id="3171043">,</span>&nbsp;<span class="num" id="3171045">0</span><span class="op" id="3171046">,</span>&nbsp;<span class="num" id="3171048">0</span><span class="op" id="3171049">,</span>&nbsp;<span class="num" id="3171051">0</span><span class="op" id="3171052">,</span>&nbsp;<span class="num" id="3171054">0</span><span class="op" id="3171055">,</span>&nbsp;<span class="num" id="3171057">0</span><span class="op" id="3171058">,</span>&nbsp;<span class="num" id="3171060">0</span><span class="op" id="3171061">,</span>&nbsp;<span class="num" id="3171063">0</span><span class="op" id="3171064">,</span>&nbsp;<span class="num" id="3171066">0</span><span class="op" id="3171067">,</span>&nbsp;<span class="num" id="3171069">0</span><span class="op" id="3171070">,</span>&nbsp;<span class="num" id="3171072">0</span><span class="op" id="3171073">,</span>&nbsp;<span class="num" id="3171075">0</span><span class="op" id="3171076">,</span>&nbsp;<span class="num" id="3171078">0</span><span class="op" id="3171079">,</span>&nbsp;<span class="num" id="3171081">0</span><span class="op" id="3171082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171085">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171112">=</span>&nbsp;<span class="ident" id="3171114">IP</span><span class="op" id="3171116">{</span><span class="num" id="3171117">0</span><span class="op" id="3171118">,</span>&nbsp;<span class="num" id="3171120">0</span><span class="op" id="3171121">,</span>&nbsp;<span class="num" id="3171123">0</span><span class="op" id="3171124">,</span>&nbsp;<span class="num" id="3171126">0</span><span class="op" id="3171127">,</span>&nbsp;<span class="num" id="3171129">0</span><span class="op" id="3171130">,</span>&nbsp;<span class="num" id="3171132">0</span><span class="op" id="3171133">,</span>&nbsp;<span class="num" id="3171135">0</span><span class="op" id="3171136">,</span>&nbsp;<span class="num" id="3171138">0</span><span class="op" id="3171139">,</span>&nbsp;<span class="num" id="3171141">0</span><span class="op" id="3171142">,</span>&nbsp;<span class="num" id="3171144">0</span><span class="op" id="3171145">,</span>&nbsp;<span class="num" id="3171147">0</span><span class="op" id="3171148">,</span>&nbsp;<span class="num" id="3171150">0</span><span class="op" id="3171151">,</span>&nbsp;<span class="num" id="3171153">0</span><span class="op" id="3171154">,</span>&nbsp;<span class="num" id="3171156">0</span><span class="op" id="3171157">,</span>&nbsp;<span class="num" id="3171159">0</span><span class="op" id="3171160">,</span>&nbsp;<span class="num" id="3171162">0</span><span class="op" id="3171163">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171166">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171193">=</span>&nbsp;<span class="ident" id="3171195">IP</span><span class="op" id="3171197">{</span><span class="num" id="3171198">0</span><span class="op" id="3171199">,</span>&nbsp;<span class="num" id="3171201">0</span><span class="op" id="3171202">,</span>&nbsp;<span class="num" id="3171204">0</span><span class="op" id="3171205">,</span>&nbsp;<span class="num" id="3171207">0</span><span class="op" id="3171208">,</span>&nbsp;<span class="num" id="3171210">0</span><span class="op" id="3171211">,</span>&nbsp;<span class="num" id="3171213">0</span><span class="op" id="3171214">,</span>&nbsp;<span class="num" id="3171216">0</span><span class="op" id="3171217">,</span>&nbsp;<span class="num" id="3171219">0</span><span class="op" id="3171220">,</span>&nbsp;<span class="num" id="3171222">0</span><span class="op" id="3171223">,</span>&nbsp;<span class="num" id="3171225">0</span><span class="op" id="3171226">,</span>&nbsp;<span class="num" id="3171228">0</span><span class="op" id="3171229">,</span>&nbsp;<span class="num" id="3171231">0</span><span class="op" id="3171232">,</span>&nbsp;<span class="num" id="3171234">0</span><span class="op" id="3171235">,</span>&nbsp;<span class="num" id="3171237">0</span><span class="op" id="3171238">,</span>&nbsp;<span class="num" id="3171240">0</span><span class="op" id="3171241">,</span>&nbsp;<span class="num" id="3171243">1</span><span class="op" id="3171244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171247">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="3171274">=</span>&nbsp;<span class="ident" id="3171276">IP</span><span class="op" id="3171278">{</span><span class="num" id="3171279">0xff</span><span class="op" id="3171283">,</span>&nbsp;<span class="num" id="3171285">0x01</span><span class="op" id="3171289">,</span>&nbsp;<span class="num" id="3171291">0</span><span class="op" id="3171292">,</span>&nbsp;<span class="num" id="3171294">0</span><span class="op" id="3171295">,</span>&nbsp;<span class="num" id="3171297">0</span><span class="op" id="3171298">,</span>&nbsp;<span class="num" id="3171300">0</span><span class="op" id="3171301">,</span>&nbsp;<span class="num" id="3171303">0</span><span class="op" id="3171304">,</span>&nbsp;<span class="num" id="3171306">0</span><span class="op" id="3171307">,</span>&nbsp;<span class="num" id="3171309">0</span><span class="op" id="3171310">,</span>&nbsp;<span class="num" id="3171312">0</span><span class="op" id="3171313">,</span>&nbsp;<span class="num" id="3171315">0</span><span class="op" id="3171316">,</span>&nbsp;<span class="num" id="3171318">0</span><span class="op" id="3171319">,</span>&nbsp;<span class="num" id="3171321">0</span><span class="op" id="3171322">,</span>&nbsp;<span class="num" id="3171324">0</span><span class="op" id="3171325">,</span>&nbsp;<span class="num" id="3171327">0</span><span class="op" id="3171328">,</span>&nbsp;<span class="num" id="3171330">0x01</span><span class="op" id="3171334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171337">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171364">=</span>&nbsp;<span class="ident" id="3171366">IP</span><span class="op" id="3171368">{</span><span class="num" id="3171369">0xff</span><span class="op" id="3171373">,</span>&nbsp;<span class="num" id="3171375">0x02</span><span class="op" id="3171379">,</span>&nbsp;<span class="num" id="3171381">0</span><span class="op" id="3171382">,</span>&nbsp;<span class="num" id="3171384">0</span><span class="op" id="3171385">,</span>&nbsp;<span class="num" id="3171387">0</span><span class="op" id="3171388">,</span>&nbsp;<span class="num" id="3171390">0</span><span class="op" id="3171391">,</span>&nbsp;<span class="num" id="3171393">0</span><span class="op" id="3171394">,</span>&nbsp;<span class="num" id="3171396">0</span><span class="op" id="3171397">,</span>&nbsp;<span class="num" id="3171399">0</span><span class="op" id="3171400">,</span>&nbsp;<span class="num" id="3171402">0</span><span class="op" id="3171403">,</span>&nbsp;<span class="num" id="3171405">0</span><span class="op" id="3171406">,</span>&nbsp;<span class="num" id="3171408">0</span><span class="op" id="3171409">,</span>&nbsp;<span class="num" id="3171411">0</span><span class="op" id="3171412">,</span>&nbsp;<span class="num" id="3171414">0</span><span class="op" id="3171415">,</span>&nbsp;<span class="num" id="3171417">0</span><span class="op" id="3171418">,</span>&nbsp;<span class="num" id="3171420">0x01</span><span class="op" id="3171424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171427">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3171454">=</span>&nbsp;<span class="ident" id="3171456">IP</span><span class="op" id="3171458">{</span><span class="num" id="3171459">0xff</span><span class="op" id="3171463">,</span>&nbsp;<span class="num" id="3171465">0x02</span><span class="op" id="3171469">,</span>&nbsp;<span class="num" id="3171471">0</span><span class="op" id="3171472">,</span>&nbsp;<span class="num" id="3171474">0</span><span class="op" id="3171475">,</span>&nbsp;<span class="num" id="3171477">0</span><span class="op" id="3171478">,</span>&nbsp;<span class="num" id="3171480">0</span><span class="op" id="3171481">,</span>&nbsp;<span class="num" id="3171483">0</span><span class="op" id="3171484">,</span>&nbsp;<span class="num" id="3171486">0</span><span class="op" id="3171487">,</span>&nbsp;<span class="num" id="3171489">0</span><span class="op" id="3171490">,</span>&nbsp;<span class="num" id="3171492">0</span><span class="op" id="3171493">,</span>&nbsp;<span class="num" id="3171495">0</span><span class="op" id="3171496">,</span>&nbsp;<span class="num" id="3171498">0</span><span class="op" id="3171499">,</span>&nbsp;<span class="num" id="3171501">0</span><span class="op" id="3171502">,</span>&nbsp;<span class="num" id="3171504">0</span><span class="op" id="3171505">,</span>&nbsp;<span class="num" id="3171507">0</span><span class="op" id="3171508">,</span>&nbsp;<span class="num" id="3171510">0x02</span><span class="op" id="3171514">}</span><br>
<span class="lineno"></span><span class="op" id="3171516">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3171519">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3171582">func</span>&nbsp;<span class="op" id="3171587">(</span><span class="ident" id="3171588">ip</span>&nbsp;<span class="ident" id="3171591">IP</span><span class="op" id="3171593">)</span>&nbsp;<span class="ident" id="3171595">IsUnspecified</span><span class="op" id="3171608">(</span><span class="op" id="3171609">)</span>&nbsp;<span class="builtintype" id="3171611">bool</span>&nbsp;<span class="op" id="3171616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171619">if</span>&nbsp;<span class="ident" id="3171622">ip</span><span class="op" id="3171624">.</span><span class="ident" id="3171625">Equal</span><span class="op" id="3171630">(</span><span class="ident" id="3171631">IPv4zero</span><span class="op" id="3171639">)</span>&nbsp;<span class="op" id="3171641">||</span>&nbsp;<span class="ident" id="3171644">ip</span><span class="op" id="3171646">.</span><span class="ident" id="3171647">Equal</span><span class="op" id="3171652">(</span><span class="ident" id="3171653">IPv6unspecified</span><span class="op" id="3171668">)</span>&nbsp;<span class="op" id="3171670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171674">return</span>&nbsp;<span class="builtintype" id="3171681">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3171687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171690">return</span>&nbsp;<span class="builtintype" id="3171697">false</span><br>
<span class="lineno"></span><span class="op" id="3171703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3171706">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="3171762">func</span>&nbsp;<span class="op" id="3171767">(</span><span class="ident" id="3171768">ip</span>&nbsp;<span class="ident" id="3171771">IP</span><span class="op" id="3171773">)</span>&nbsp;<span class="ident" id="3171775">IsLoopback</span><span class="op" id="3171785">(</span><span class="op" id="3171786">)</span>&nbsp;<span class="builtintype" id="3171788">bool</span>&nbsp;<span class="op" id="3171793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171796">if</span>&nbsp;<span class="ident" id="3171799">ip4</span>&nbsp;<span class="op" id="3171803">:=</span>&nbsp;<span class="ident" id="3171806">ip</span><span class="op" id="3171808">.</span><span class="ident" id="3171809">To4</span><span class="op" id="3171812">(</span><span class="op" id="3171813">)</span><span class="op" id="3171814">;</span>&nbsp;<span class="ident" id="3171816">ip4</span>&nbsp;<span class="op" id="3171820">!=</span>&nbsp;<span class="ident" id="3171823">nil</span>&nbsp;<span class="op" id="3171827">&amp;&amp;</span>&nbsp;<span class="ident" id="3171830">ip4</span><span class="op" id="3171833">[</span><span class="num" id="3171834">0</span><span class="op" id="3171835">]</span>&nbsp;<span class="op" id="3171837">==</span>&nbsp;<span class="num" id="3171840">127</span>&nbsp;<span class="op" id="3171844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171848">return</span>&nbsp;<span class="builtintype" id="3171855">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3171861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171864">return</span>&nbsp;<span class="ident" id="3171871">ip</span><span class="op" id="3171873">.</span><span class="ident" id="3171874">Equal</span><span class="op" id="3171879">(</span><span class="ident" id="3171880">IPv6loopback</span><span class="op" id="3171892">)</span><br>
<span class="lineno">125</span><span class="op" id="3171894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3171897">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3171955">func</span>&nbsp;<span class="op" id="3171960">(</span><span class="ident" id="3171961">ip</span>&nbsp;<span class="ident" id="3171964">IP</span><span class="op" id="3171966">)</span>&nbsp;<span class="ident" id="3171968">IsMulticast</span><span class="op" id="3171979">(</span><span class="op" id="3171980">)</span>&nbsp;<span class="builtintype" id="3171982">bool</span>&nbsp;<span class="op" id="3171987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171990">if</span>&nbsp;<span class="ident" id="3171993">ip4</span>&nbsp;<span class="op" id="3171997">:=</span>&nbsp;<span class="ident" id="3172000">ip</span><span class="op" id="3172002">.</span><span class="ident" id="3172003">To4</span><span class="op" id="3172006">(</span><span class="op" id="3172007">)</span><span class="op" id="3172008">;</span>&nbsp;<span class="ident" id="3172010">ip4</span>&nbsp;<span class="op" id="3172014">!=</span>&nbsp;<span class="ident" id="3172017">nil</span>&nbsp;<span class="op" id="3172021">&amp;&amp;</span>&nbsp;<span class="ident" id="3172024">ip4</span><span class="op" id="3172027">[</span><span class="num" id="3172028">0</span><span class="op" id="3172029">]</span><span class="op" id="3172030">&amp;</span><span class="num" id="3172031">0xf0</span>&nbsp;<span class="op" id="3172036">==</span>&nbsp;<span class="num" id="3172039">0xe0</span>&nbsp;<span class="op" id="3172044">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172048">return</span>&nbsp;<span class="builtintype" id="3172055">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3172061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172064">return</span>&nbsp;<span class="ident" id="3172071">ip</span><span class="op" id="3172073">[</span><span class="num" id="3172074">0</span><span class="op" id="3172075">]</span>&nbsp;<span class="op" id="3172077">==</span>&nbsp;<span class="num" id="3172080">0xff</span><br>
<span class="lineno"></span><span class="op" id="3172085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3172088">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3172143">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3172184">func</span>&nbsp;<span class="op" id="3172189">(</span><span class="ident" id="3172190">ip</span>&nbsp;<span class="ident" id="3172193">IP</span><span class="op" id="3172195">)</span>&nbsp;<span class="ident" id="3172197">IsInterfaceLocalMulticast</span><span class="op" id="3172222">(</span><span class="op" id="3172223">)</span>&nbsp;<span class="builtintype" id="3172225">bool</span>&nbsp;<span class="op" id="3172230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172233">return</span>&nbsp;<span class="builtinfunc" id="3172240">len</span><span class="op" id="3172243">(</span><span class="ident" id="3172244">ip</span><span class="op" id="3172246">)</span>&nbsp;<span class="op" id="3172248">==</span>&nbsp;<span class="ident" id="3172251">IPv6len</span>&nbsp;<span class="op" id="3172259">&amp;&amp;</span>&nbsp;<span class="ident" id="3172262">ip</span><span class="op" id="3172264">[</span><span class="num" id="3172265">0</span><span class="op" id="3172266">]</span>&nbsp;<span class="op" id="3172268">==</span>&nbsp;<span class="num" id="3172271">0xff</span>&nbsp;<span class="op" id="3172276">&amp;&amp;</span>&nbsp;<span class="ident" id="3172279">ip</span><span class="op" id="3172281">[</span><span class="num" id="3172282">1</span><span class="op" id="3172283">]</span><span class="op" id="3172284">&amp;</span><span class="num" id="3172285">0x0f</span>&nbsp;<span class="op" id="3172290">==</span>&nbsp;<span class="num" id="3172293">0x01</span><br>
<span class="lineno"></span><span class="op" id="3172298">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="3172301">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3172360">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3172382">func</span>&nbsp;<span class="op" id="3172387">(</span><span class="ident" id="3172388">ip</span>&nbsp;<span class="ident" id="3172391">IP</span><span class="op" id="3172393">)</span>&nbsp;<span class="ident" id="3172395">IsLinkLocalMulticast</span><span class="op" id="3172415">(</span><span class="op" id="3172416">)</span>&nbsp;<span class="builtintype" id="3172418">bool</span>&nbsp;<span class="op" id="3172423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172426">if</span>&nbsp;<span class="ident" id="3172429">ip4</span>&nbsp;<span class="op" id="3172433">:=</span>&nbsp;<span class="ident" id="3172436">ip</span><span class="op" id="3172438">.</span><span class="ident" id="3172439">To4</span><span class="op" id="3172442">(</span><span class="op" id="3172443">)</span><span class="op" id="3172444">;</span>&nbsp;<span class="ident" id="3172446">ip4</span>&nbsp;<span class="op" id="3172450">!=</span>&nbsp;<span class="ident" id="3172453">nil</span>&nbsp;<span class="op" id="3172457">&amp;&amp;</span>&nbsp;<span class="ident" id="3172460">ip4</span><span class="op" id="3172463">[</span><span class="num" id="3172464">0</span><span class="op" id="3172465">]</span>&nbsp;<span class="op" id="3172467">==</span>&nbsp;<span class="num" id="3172470">224</span>&nbsp;<span class="op" id="3172474">&amp;&amp;</span>&nbsp;<span class="ident" id="3172477">ip4</span><span class="op" id="3172480">[</span><span class="num" id="3172481">1</span><span class="op" id="3172482">]</span>&nbsp;<span class="op" id="3172484">==</span>&nbsp;<span class="num" id="3172487">0</span>&nbsp;<span class="op" id="3172489">&amp;&amp;</span>&nbsp;<span class="ident" id="3172492">ip4</span><span class="op" id="3172495">[</span><span class="num" id="3172496">2</span><span class="op" id="3172497">]</span>&nbsp;<span class="op" id="3172499">==</span>&nbsp;<span class="num" id="3172502">0</span>&nbsp;<span class="op" id="3172504">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172508">return</span>&nbsp;<span class="builtintype" id="3172515">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3172521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172524">return</span>&nbsp;<span class="ident" id="3172531">ip</span><span class="op" id="3172533">[</span><span class="num" id="3172534">0</span><span class="op" id="3172535">]</span>&nbsp;<span class="op" id="3172537">==</span>&nbsp;<span class="num" id="3172540">0xff</span>&nbsp;<span class="op" id="3172545">&amp;&amp;</span>&nbsp;<span class="ident" id="3172548">ip</span><span class="op" id="3172550">[</span><span class="num" id="3172551">1</span><span class="op" id="3172552">]</span><span class="op" id="3172553">&amp;</span><span class="num" id="3172554">0x0f</span>&nbsp;<span class="op" id="3172559">==</span>&nbsp;<span class="num" id="3172562">0x02</span><br>
<span class="lineno"></span><span class="op" id="3172567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3172570">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3172627">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3172647">func</span>&nbsp;<span class="op" id="3172652">(</span><span class="ident" id="3172653">ip</span>&nbsp;<span class="ident" id="3172656">IP</span><span class="op" id="3172658">)</span>&nbsp;<span class="ident" id="3172660">IsLinkLocalUnicast</span><span class="op" id="3172678">(</span><span class="op" id="3172679">)</span>&nbsp;<span class="builtintype" id="3172681">bool</span>&nbsp;<span class="op" id="3172686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172689">if</span>&nbsp;<span class="ident" id="3172692">ip4</span>&nbsp;<span class="op" id="3172696">:=</span>&nbsp;<span class="ident" id="3172699">ip</span><span class="op" id="3172701">.</span><span class="ident" id="3172702">To4</span><span class="op" id="3172705">(</span><span class="op" id="3172706">)</span><span class="op" id="3172707">;</span>&nbsp;<span class="ident" id="3172709">ip4</span>&nbsp;<span class="op" id="3172713">!=</span>&nbsp;<span class="ident" id="3172716">nil</span>&nbsp;<span class="op" id="3172720">&amp;&amp;</span>&nbsp;<span class="ident" id="3172723">ip4</span><span class="op" id="3172726">[</span><span class="num" id="3172727">0</span><span class="op" id="3172728">]</span>&nbsp;<span class="op" id="3172730">==</span>&nbsp;<span class="num" id="3172733">169</span>&nbsp;<span class="op" id="3172737">&amp;&amp;</span>&nbsp;<span class="ident" id="3172740">ip4</span><span class="op" id="3172743">[</span><span class="num" id="3172744">1</span><span class="op" id="3172745">]</span>&nbsp;<span class="op" id="3172747">==</span>&nbsp;<span class="num" id="3172750">254</span>&nbsp;<span class="op" id="3172754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172758">return</span>&nbsp;<span class="builtintype" id="3172765">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3172771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172774">return</span>&nbsp;<span class="ident" id="3172781">ip</span><span class="op" id="3172783">[</span><span class="num" id="3172784">0</span><span class="op" id="3172785">]</span>&nbsp;<span class="op" id="3172787">==</span>&nbsp;<span class="num" id="3172790">0xfe</span>&nbsp;<span class="op" id="3172795">&amp;&amp;</span>&nbsp;<span class="ident" id="3172798">ip</span><span class="op" id="3172800">[</span><span class="num" id="3172801">1</span><span class="op" id="3172802">]</span><span class="op" id="3172803">&amp;</span><span class="num" id="3172804">0xc0</span>&nbsp;<span class="op" id="3172809">==</span>&nbsp;<span class="num" id="3172812">0x80</span><br>
<span class="lineno"></span><span class="op" id="3172817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3172820">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="3172878">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3172890">func</span>&nbsp;<span class="op" id="3172895">(</span><span class="ident" id="3172896">ip</span>&nbsp;<span class="ident" id="3172899">IP</span><span class="op" id="3172901">)</span>&nbsp;<span class="ident" id="3172903">IsGlobalUnicast</span><span class="op" id="3172918">(</span><span class="op" id="3172919">)</span>&nbsp;<span class="builtintype" id="3172921">bool</span>&nbsp;<span class="op" id="3172926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172929">return</span>&nbsp;<span class="op" id="3172936">!</span><span class="ident" id="3172937">ip</span><span class="op" id="3172939">.</span><span class="ident" id="3172940">IsUnspecified</span><span class="op" id="3172953">(</span><span class="op" id="3172954">)</span>&nbsp;<span class="op" id="3172956">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3172961">!</span><span class="ident" id="3172962">ip</span><span class="op" id="3172964">.</span><span class="ident" id="3172965">IsLoopback</span><span class="op" id="3172975">(</span><span class="op" id="3172976">)</span>&nbsp;<span class="op" id="3172978">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3172983">!</span><span class="ident" id="3172984">ip</span><span class="op" id="3172986">.</span><span class="ident" id="3172987">IsMulticast</span><span class="op" id="3172998">(</span><span class="op" id="3172999">)</span>&nbsp;<span class="op" id="3173001">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173006">!</span><span class="ident" id="3173007">ip</span><span class="op" id="3173009">.</span><span class="ident" id="3173010">IsLinkLocalUnicast</span><span class="op" id="3173028">(</span><span class="op" id="3173029">)</span><br>
<span class="lineno"></span><span class="op" id="3173031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3173034">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="3173053">func</span>&nbsp;<span class="ident" id="3173058">isZeros</span><span class="op" id="3173065">(</span><span class="ident" id="3173066">p</span>&nbsp;<span class="ident" id="3173068">IP</span><span class="op" id="3173070">)</span>&nbsp;<span class="builtintype" id="3173072">bool</span>&nbsp;<span class="op" id="3173077">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173080">for</span>&nbsp;<span class="ident" id="3173084">i</span>&nbsp;<span class="op" id="3173086">:=</span>&nbsp;<span class="num" id="3173089">0</span><span class="op" id="3173090">;</span>&nbsp;<span class="ident" id="3173092">i</span>&nbsp;<span class="op" id="3173094">&lt;</span>&nbsp;<span class="builtinfunc" id="3173096">len</span><span class="op" id="3173099">(</span><span class="ident" id="3173100">p</span><span class="op" id="3173101">)</span><span class="op" id="3173102">;</span>&nbsp;<span class="ident" id="3173104">i</span><span class="op" id="3173105">++</span>&nbsp;<span class="op" id="3173108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173112">if</span>&nbsp;<span class="ident" id="3173115">p</span><span class="op" id="3173116">[</span><span class="ident" id="3173117">i</span><span class="op" id="3173118">]</span>&nbsp;<span class="op" id="3173120">!=</span>&nbsp;<span class="num" id="3173123">0</span>&nbsp;<span class="op" id="3173125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173130">return</span>&nbsp;<span class="builtintype" id="3173137">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173148">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173151">return</span>&nbsp;<span class="builtintype" id="3173158">true</span><br>
<span class="lineno"></span><span class="op" id="3173163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3173166">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3173230">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="3173280">func</span>&nbsp;<span class="op" id="3173285">(</span><span class="ident" id="3173286">ip</span>&nbsp;<span class="ident" id="3173289">IP</span><span class="op" id="3173291">)</span>&nbsp;<span class="ident" id="3173293">To4</span><span class="op" id="3173296">(</span><span class="op" id="3173297">)</span>&nbsp;<span class="ident" id="3173299">IP</span>&nbsp;<span class="op" id="3173302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173305">if</span>&nbsp;<span class="builtinfunc" id="3173308">len</span><span class="op" id="3173311">(</span><span class="ident" id="3173312">ip</span><span class="op" id="3173314">)</span>&nbsp;<span class="op" id="3173316">==</span>&nbsp;<span class="ident" id="3173319">IPv4len</span>&nbsp;<span class="op" id="3173327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173331">return</span>&nbsp;<span class="ident" id="3173338">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173345">if</span>&nbsp;<span class="builtinfunc" id="3173348">len</span><span class="op" id="3173351">(</span><span class="ident" id="3173352">ip</span><span class="op" id="3173354">)</span>&nbsp;<span class="op" id="3173356">==</span>&nbsp;<span class="ident" id="3173359">IPv6len</span>&nbsp;<span class="op" id="3173367">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173372">isZeros</span><span class="op" id="3173379">(</span><span class="ident" id="3173380">ip</span><span class="op" id="3173382">[</span><span class="num" id="3173383">0</span><span class="op" id="3173384">:</span><span class="num" id="3173385">10</span><span class="op" id="3173387">]</span><span class="op" id="3173388">)</span>&nbsp;<span class="op" id="3173390">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173395">ip</span><span class="op" id="3173397">[</span><span class="num" id="3173398">10</span><span class="op" id="3173400">]</span>&nbsp;<span class="op" id="3173402">==</span>&nbsp;<span class="num" id="3173405">0xff</span>&nbsp;<span class="op" id="3173410">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173415">ip</span><span class="op" id="3173417">[</span><span class="num" id="3173418">11</span><span class="op" id="3173420">]</span>&nbsp;<span class="op" id="3173422">==</span>&nbsp;<span class="num" id="3173425">0xff</span>&nbsp;<span class="op" id="3173430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173434">return</span>&nbsp;<span class="ident" id="3173441">ip</span><span class="op" id="3173443">[</span><span class="num" id="3173444">12</span><span class="op" id="3173446">:</span><span class="num" id="3173447">16</span><span class="op" id="3173449">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173452">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173455">return</span>&nbsp;<span class="ident" id="3173462">nil</span><br>
<span class="lineno"></span><span class="op" id="3173466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3173469">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3173533">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="3173607">func</span>&nbsp;<span class="op" id="3173612">(</span><span class="ident" id="3173613">ip</span>&nbsp;<span class="ident" id="3173616">IP</span><span class="op" id="3173618">)</span>&nbsp;<span class="ident" id="3173620">To16</span><span class="op" id="3173624">(</span><span class="op" id="3173625">)</span>&nbsp;<span class="ident" id="3173627">IP</span>&nbsp;<span class="op" id="3173630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173633">if</span>&nbsp;<span class="builtinfunc" id="3173636">len</span><span class="op" id="3173639">(</span><span class="ident" id="3173640">ip</span><span class="op" id="3173642">)</span>&nbsp;<span class="op" id="3173644">==</span>&nbsp;<span class="ident" id="3173647">IPv4len</span>&nbsp;<span class="op" id="3173655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173659">return</span>&nbsp;<span class="ident" id="3173666">IPv4</span><span class="op" id="3173670">(</span><span class="ident" id="3173671">ip</span><span class="op" id="3173673">[</span><span class="num" id="3173674">0</span><span class="op" id="3173675">]</span><span class="op" id="3173676">,</span>&nbsp;<span class="ident" id="3173678">ip</span><span class="op" id="3173680">[</span><span class="num" id="3173681">1</span><span class="op" id="3173682">]</span><span class="op" id="3173683">,</span>&nbsp;<span class="ident" id="3173685">ip</span><span class="op" id="3173687">[</span><span class="num" id="3173688">2</span><span class="op" id="3173689">]</span><span class="op" id="3173690">,</span>&nbsp;<span class="ident" id="3173692">ip</span><span class="op" id="3173694">[</span><span class="num" id="3173695">3</span><span class="op" id="3173696">]</span><span class="op" id="3173697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173703">if</span>&nbsp;<span class="builtinfunc" id="3173706">len</span><span class="op" id="3173709">(</span><span class="ident" id="3173710">ip</span><span class="op" id="3173712">)</span>&nbsp;<span class="op" id="3173714">==</span>&nbsp;<span class="ident" id="3173717">IPv6len</span>&nbsp;<span class="op" id="3173725">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173729">return</span>&nbsp;<span class="ident" id="3173736">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173743">return</span>&nbsp;<span class="ident" id="3173750">nil</span><br>
<span class="lineno"></span><span class="op" id="3173754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3173757">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="3173790">var</span>&nbsp;<span class="op" id="3173794">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173797">classAMask</span>&nbsp;<span class="op" id="3173808">=</span>&nbsp;<span class="ident" id="3173810">IPv4Mask</span><span class="op" id="3173818">(</span><span class="num" id="3173819">0xff</span><span class="op" id="3173823">,</span>&nbsp;<span class="num" id="3173825">0</span><span class="op" id="3173826">,</span>&nbsp;<span class="num" id="3173828">0</span><span class="op" id="3173829">,</span>&nbsp;<span class="num" id="3173831">0</span><span class="op" id="3173832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173835">classBMask</span>&nbsp;<span class="op" id="3173846">=</span>&nbsp;<span class="ident" id="3173848">IPv4Mask</span><span class="op" id="3173856">(</span><span class="num" id="3173857">0xff</span><span class="op" id="3173861">,</span>&nbsp;<span class="num" id="3173863">0xff</span><span class="op" id="3173867">,</span>&nbsp;<span class="num" id="3173869">0</span><span class="op" id="3173870">,</span>&nbsp;<span class="num" id="3173872">0</span><span class="op" id="3173873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173876">classCMask</span>&nbsp;<span class="op" id="3173887">=</span>&nbsp;<span class="ident" id="3173889">IPv4Mask</span><span class="op" id="3173897">(</span><span class="num" id="3173898">0xff</span><span class="op" id="3173902">,</span>&nbsp;<span class="num" id="3173904">0xff</span><span class="op" id="3173908">,</span>&nbsp;<span class="num" id="3173910">0xff</span><span class="op" id="3173914">,</span>&nbsp;<span class="num" id="3173916">0</span><span class="op" id="3173917">)</span><br>
<span class="lineno">210</span><span class="op" id="3173919">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3173922">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3173988">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3174051">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="3174093">func</span>&nbsp;<span class="op" id="3174098">(</span><span class="ident" id="3174099">ip</span>&nbsp;<span class="ident" id="3174102">IP</span><span class="op" id="3174104">)</span>&nbsp;<span class="ident" id="3174106">DefaultMask</span><span class="op" id="3174117">(</span><span class="op" id="3174118">)</span>&nbsp;<span class="ident" id="3174120">IPMask</span>&nbsp;<span class="op" id="3174127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174130">if</span>&nbsp;<span class="ident" id="3174133">ip</span>&nbsp;<span class="op" id="3174136">=</span>&nbsp;<span class="ident" id="3174138">ip</span><span class="op" id="3174140">.</span><span class="ident" id="3174141">To4</span><span class="op" id="3174144">(</span><span class="op" id="3174145">)</span><span class="op" id="3174146">;</span>&nbsp;<span class="ident" id="3174148">ip</span>&nbsp;<span class="op" id="3174151">==</span>&nbsp;<span class="ident" id="3174154">nil</span>&nbsp;<span class="op" id="3174158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174162">return</span>&nbsp;<span class="ident" id="3174169">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3174174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174177">switch</span>&nbsp;<span class="builtintype" id="3174184">true</span>&nbsp;<span class="op" id="3174189">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174192">case</span>&nbsp;<span class="ident" id="3174197">ip</span><span class="op" id="3174199">[</span><span class="num" id="3174200">0</span><span class="op" id="3174201">]</span>&nbsp;<span class="op" id="3174203">&lt;</span>&nbsp;<span class="num" id="3174205">0x80</span><span class="op" id="3174209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174213">return</span>&nbsp;<span class="ident" id="3174220">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174232">case</span>&nbsp;<span class="ident" id="3174237">ip</span><span class="op" id="3174239">[</span><span class="num" id="3174240">0</span><span class="op" id="3174241">]</span>&nbsp;<span class="op" id="3174243">&lt;</span>&nbsp;<span class="num" id="3174245">0xC0</span><span class="op" id="3174249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174253">return</span>&nbsp;<span class="ident" id="3174260">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174272">default</span><span class="op" id="3174279">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174283">return</span>&nbsp;<span class="ident" id="3174290">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3174302">}</span><br>
<span class="lineno"></span><span class="op" id="3174304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3174307">func</span>&nbsp;<span class="ident" id="3174312">allFF</span><span class="op" id="3174317">(</span><span class="ident" id="3174318">b</span>&nbsp;<span class="op" id="3174320">[</span><span class="op" id="3174321">]</span><span class="builtintype" id="3174322">byte</span><span class="op" id="3174326">)</span>&nbsp;<span class="builtintype" id="3174328">bool</span>&nbsp;<span class="op" id="3174333">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174336">for</span>&nbsp;<span class="ident" id="3174340">_</span><span class="op" id="3174341">,</span>&nbsp;<span class="ident" id="3174343">c</span>&nbsp;<span class="op" id="3174345">:=</span>&nbsp;<span class="keyword" id="3174348">range</span>&nbsp;<span class="ident" id="3174354">b</span>&nbsp;<span class="op" id="3174356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174360">if</span>&nbsp;<span class="ident" id="3174363">c</span>&nbsp;<span class="op" id="3174365">!=</span>&nbsp;<span class="num" id="3174368">0xff</span>&nbsp;<span class="op" id="3174373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174378">return</span>&nbsp;<span class="builtintype" id="3174385">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3174393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3174396">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174399">return</span>&nbsp;<span class="builtintype" id="3174406">true</span><br>
<span class="lineno"></span><span class="op" id="3174411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3174414">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="3174481">func</span>&nbsp;<span class="op" id="3174486">(</span><span class="ident" id="3174487">ip</span>&nbsp;<span class="ident" id="3174490">IP</span><span class="op" id="3174492">)</span>&nbsp;<span class="ident" id="3174494">Mask</span><span class="op" id="3174498">(</span><span class="ident" id="3174499">mask</span>&nbsp;<span class="ident" id="3174504">IPMask</span><span class="op" id="3174510">)</span>&nbsp;<span class="ident" id="3174512">IP</span>&nbsp;<span class="op" id="3174515">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174518">if</span>&nbsp;<span class="builtinfunc" id="3174521">len</span><span class="op" id="3174524">(</span><span class="ident" id="3174525">mask</span><span class="op" id="3174529">)</span>&nbsp;<span class="op" id="3174531">==</span>&nbsp;<span class="ident" id="3174534">IPv6len</span>&nbsp;<span class="op" id="3174542">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3174545">len</span><span class="op" id="3174548">(</span><span class="ident" id="3174549">ip</span><span class="op" id="3174551">)</span>&nbsp;<span class="op" id="3174553">==</span>&nbsp;<span class="ident" id="3174556">IPv4len</span>&nbsp;<span class="op" id="3174564">&amp;&amp;</span>&nbsp;<span class="ident" id="3174567">allFF</span><span class="op" id="3174572">(</span><span class="ident" id="3174573">mask</span><span class="op" id="3174577">[</span><span class="op" id="3174578">:</span><span class="num" id="3174579">12</span><span class="op" id="3174581">]</span><span class="op" id="3174582">)</span>&nbsp;<span class="op" id="3174584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3174588">mask</span>&nbsp;<span class="op" id="3174593">=</span>&nbsp;<span class="ident" id="3174595">mask</span><span class="op" id="3174599">[</span><span class="num" id="3174600">12</span><span class="op" id="3174602">:</span><span class="op" id="3174603">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3174606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174609">if</span>&nbsp;<span class="builtinfunc" id="3174612">len</span><span class="op" id="3174615">(</span><span class="ident" id="3174616">mask</span><span class="op" id="3174620">)</span>&nbsp;<span class="op" id="3174622">==</span>&nbsp;<span class="ident" id="3174625">IPv4len</span>&nbsp;<span class="op" id="3174633">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3174636">len</span><span class="op" id="3174639">(</span><span class="ident" id="3174640">ip</span><span class="op" id="3174642">)</span>&nbsp;<span class="op" id="3174644">==</span>&nbsp;<span class="ident" id="3174647">IPv6len</span>&nbsp;<span class="op" id="3174655">&amp;&amp;</span>&nbsp;<span class="ident" id="3174658">bytesEqual</span><span class="op" id="3174668">(</span><span class="ident" id="3174669">ip</span><span class="op" id="3174671">[</span><span class="op" id="3174672">:</span><span class="num" id="3174673">12</span><span class="op" id="3174675">]</span><span class="op" id="3174676">,</span>&nbsp;<span class="ident" id="3174678">v4InV6Prefix</span><span class="op" id="3174690">)</span>&nbsp;<span class="op" id="3174692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3174696">ip</span>&nbsp;<span class="op" id="3174699">=</span>&nbsp;<span class="ident" id="3174701">ip</span><span class="op" id="3174703">[</span><span class="num" id="3174704">12</span><span class="op" id="3174706">:</span><span class="op" id="3174707">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3174710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3174713">n</span>&nbsp;<span class="op" id="3174715">:=</span>&nbsp;<span class="builtinfunc" id="3174718">len</span><span class="op" id="3174721">(</span><span class="ident" id="3174722">ip</span><span class="op" id="3174724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174727">if</span>&nbsp;<span class="ident" id="3174730">n</span>&nbsp;<span class="op" id="3174732">!=</span>&nbsp;<span class="builtinfunc" id="3174735">len</span><span class="op" id="3174738">(</span><span class="ident" id="3174739">mask</span><span class="op" id="3174743">)</span>&nbsp;<span class="op" id="3174745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174749">return</span>&nbsp;<span class="ident" id="3174756">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3174761">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3174764">out</span>&nbsp;<span class="op" id="3174768">:=</span>&nbsp;<span class="builtinfunc" id="3174771">make</span><span class="op" id="3174775">(</span><span class="ident" id="3174776">IP</span><span class="op" id="3174778">,</span>&nbsp;<span class="ident" id="3174780">n</span><span class="op" id="3174781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174784">for</span>&nbsp;<span class="ident" id="3174788">i</span>&nbsp;<span class="op" id="3174790">:=</span>&nbsp;<span class="num" id="3174793">0</span><span class="op" id="3174794">;</span>&nbsp;<span class="ident" id="3174796">i</span>&nbsp;<span class="op" id="3174798">&lt;</span>&nbsp;<span class="ident" id="3174800">n</span><span class="op" id="3174801">;</span>&nbsp;<span class="ident" id="3174803">i</span><span class="op" id="3174804">++</span>&nbsp;<span class="op" id="3174807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3174811">out</span><span class="op" id="3174814">[</span><span class="ident" id="3174815">i</span><span class="op" id="3174816">]</span>&nbsp;<span class="op" id="3174818">=</span>&nbsp;<span class="ident" id="3174820">ip</span><span class="op" id="3174822">[</span><span class="ident" id="3174823">i</span><span class="op" id="3174824">]</span>&nbsp;<span class="op" id="3174826">&amp;</span>&nbsp;<span class="ident" id="3174828">mask</span><span class="op" id="3174832">[</span><span class="ident" id="3174833">i</span><span class="op" id="3174834">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3174837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3174840">return</span>&nbsp;<span class="ident" id="3174847">out</span><br>
<span class="lineno">255</span><span class="op" id="3174851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3174854">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3174910">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="3174974">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="3175043">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="3175080">func</span>&nbsp;<span class="op" id="3175085">(</span><span class="ident" id="3175086">ip</span>&nbsp;<span class="ident" id="3175089">IP</span><span class="op" id="3175091">)</span>&nbsp;<span class="ident" id="3175093">String</span><span class="op" id="3175099">(</span><span class="op" id="3175100">)</span>&nbsp;<span class="builtintype" id="3175102">string</span>&nbsp;<span class="op" id="3175109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175112">p</span>&nbsp;<span class="op" id="3175114">:=</span>&nbsp;<span class="ident" id="3175117">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175122">if</span>&nbsp;<span class="builtinfunc" id="3175125">len</span><span class="op" id="3175128">(</span><span class="ident" id="3175129">ip</span><span class="op" id="3175131">)</span>&nbsp;<span class="op" id="3175133">==</span>&nbsp;<span class="num" id="3175136">0</span>&nbsp;<span class="op" id="3175138">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175142">return</span>&nbsp;<span class="string" id="3175149">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3175162">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175196">if</span>&nbsp;<span class="ident" id="3175199">p4</span>&nbsp;<span class="op" id="3175202">:=</span>&nbsp;<span class="ident" id="3175205">p</span><span class="op" id="3175206">.</span><span class="ident" id="3175207">To4</span><span class="op" id="3175210">(</span><span class="op" id="3175211">)</span><span class="op" id="3175212">;</span>&nbsp;<span class="builtinfunc" id="3175214">len</span><span class="op" id="3175217">(</span><span class="ident" id="3175218">p4</span><span class="op" id="3175220">)</span>&nbsp;<span class="op" id="3175222">==</span>&nbsp;<span class="ident" id="3175225">IPv4len</span>&nbsp;<span class="op" id="3175233">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175237">return</span>&nbsp;<span class="ident" id="3175244">itod</span><span class="op" id="3175248">(</span><span class="builtintype" id="3175249">uint</span><span class="op" id="3175253">(</span><span class="ident" id="3175254">p4</span><span class="op" id="3175256">[</span><span class="num" id="3175257">0</span><span class="op" id="3175258">]</span><span class="op" id="3175259">)</span><span class="op" id="3175260">)</span>&nbsp;<span class="op" id="3175262">+</span>&nbsp;<span class="string" id="3175264">&#34;.&#34;</span>&nbsp;<span class="op" id="3175268">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175273">itod</span><span class="op" id="3175277">(</span><span class="builtintype" id="3175278">uint</span><span class="op" id="3175282">(</span><span class="ident" id="3175283">p4</span><span class="op" id="3175285">[</span><span class="num" id="3175286">1</span><span class="op" id="3175287">]</span><span class="op" id="3175288">)</span><span class="op" id="3175289">)</span>&nbsp;<span class="op" id="3175291">+</span>&nbsp;<span class="string" id="3175293">&#34;.&#34;</span>&nbsp;<span class="op" id="3175297">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175302">itod</span><span class="op" id="3175306">(</span><span class="builtintype" id="3175307">uint</span><span class="op" id="3175311">(</span><span class="ident" id="3175312">p4</span><span class="op" id="3175314">[</span><span class="num" id="3175315">2</span><span class="op" id="3175316">]</span><span class="op" id="3175317">)</span><span class="op" id="3175318">)</span>&nbsp;<span class="op" id="3175320">+</span>&nbsp;<span class="string" id="3175322">&#34;.&#34;</span>&nbsp;<span class="op" id="3175326">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175331">itod</span><span class="op" id="3175335">(</span><span class="builtintype" id="3175336">uint</span><span class="op" id="3175340">(</span><span class="ident" id="3175341">p4</span><span class="op" id="3175343">[</span><span class="num" id="3175344">3</span><span class="op" id="3175345">]</span><span class="op" id="3175346">)</span><span class="op" id="3175347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175350">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175353">if</span>&nbsp;<span class="builtinfunc" id="3175356">len</span><span class="op" id="3175359">(</span><span class="ident" id="3175360">p</span><span class="op" id="3175361">)</span>&nbsp;<span class="op" id="3175363">!=</span>&nbsp;<span class="ident" id="3175366">IPv6len</span>&nbsp;<span class="op" id="3175374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175378">return</span>&nbsp;<span class="string" id="3175385">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3175394">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175425">e0</span>&nbsp;<span class="op" id="3175428">:=</span>&nbsp;<span class="op" id="3175431">-</span><span class="num" id="3175432">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175435">e1</span>&nbsp;<span class="op" id="3175438">:=</span>&nbsp;<span class="op" id="3175441">-</span><span class="num" id="3175442">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175445">for</span>&nbsp;<span class="ident" id="3175449">i</span>&nbsp;<span class="op" id="3175451">:=</span>&nbsp;<span class="num" id="3175454">0</span><span class="op" id="3175455">;</span>&nbsp;<span class="ident" id="3175457">i</span>&nbsp;<span class="op" id="3175459">&lt;</span>&nbsp;<span class="ident" id="3175461">IPv6len</span><span class="op" id="3175468">;</span>&nbsp;<span class="ident" id="3175470">i</span>&nbsp;<span class="op" id="3175472">+=</span>&nbsp;<span class="num" id="3175475">2</span>&nbsp;<span class="op" id="3175477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175481">j</span>&nbsp;<span class="op" id="3175483">:=</span>&nbsp;<span class="ident" id="3175486">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175490">for</span>&nbsp;<span class="ident" id="3175494">j</span>&nbsp;<span class="op" id="3175496">&lt;</span>&nbsp;<span class="ident" id="3175498">IPv6len</span>&nbsp;<span class="op" id="3175506">&amp;&amp;</span>&nbsp;<span class="ident" id="3175509">p</span><span class="op" id="3175510">[</span><span class="ident" id="3175511">j</span><span class="op" id="3175512">]</span>&nbsp;<span class="op" id="3175514">==</span>&nbsp;<span class="num" id="3175517">0</span>&nbsp;<span class="op" id="3175519">&amp;&amp;</span>&nbsp;<span class="ident" id="3175522">p</span><span class="op" id="3175523">[</span><span class="ident" id="3175524">j</span><span class="op" id="3175525">+</span><span class="num" id="3175526">1</span><span class="op" id="3175527">]</span>&nbsp;<span class="op" id="3175529">==</span>&nbsp;<span class="num" id="3175532">0</span>&nbsp;<span class="op" id="3175534">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175539">j</span>&nbsp;<span class="op" id="3175541">+=</span>&nbsp;<span class="num" id="3175544">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175552">if</span>&nbsp;<span class="ident" id="3175555">j</span>&nbsp;<span class="op" id="3175557">&gt;</span>&nbsp;<span class="ident" id="3175559">i</span>&nbsp;<span class="op" id="3175561">&amp;&amp;</span>&nbsp;<span class="ident" id="3175564">j</span><span class="op" id="3175565">-</span><span class="ident" id="3175566">i</span>&nbsp;<span class="op" id="3175568">&gt;</span>&nbsp;<span class="ident" id="3175570">e1</span><span class="op" id="3175572">-</span><span class="ident" id="3175573">e0</span>&nbsp;<span class="op" id="3175576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175581">e0</span>&nbsp;<span class="op" id="3175584">=</span>&nbsp;<span class="ident" id="3175586">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175591">e1</span>&nbsp;<span class="op" id="3175594">=</span>&nbsp;<span class="ident" id="3175596">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175601">i</span>&nbsp;<span class="op" id="3175603">=</span>&nbsp;<span class="ident" id="3175605">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3175615">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175688">if</span>&nbsp;<span class="ident" id="3175691">e1</span><span class="op" id="3175693">-</span><span class="ident" id="3175694">e0</span>&nbsp;<span class="op" id="3175697">&lt;=</span>&nbsp;<span class="num" id="3175700">2</span>&nbsp;<span class="op" id="3175702">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175706">e0</span>&nbsp;<span class="op" id="3175709">=</span>&nbsp;<span class="op" id="3175711">-</span><span class="num" id="3175712">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175716">e1</span>&nbsp;<span class="op" id="3175719">=</span>&nbsp;<span class="op" id="3175721">-</span><span class="num" id="3175722">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175729">const</span>&nbsp;<span class="ident" id="3175735">maxLen</span>&nbsp;<span class="op" id="3175742">=</span>&nbsp;<span class="builtinfunc" id="3175744">len</span><span class="op" id="3175747">(</span><span class="string" id="3175748">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="3175789">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175792">b</span>&nbsp;<span class="op" id="3175794">:=</span>&nbsp;<span class="builtinfunc" id="3175797">make</span><span class="op" id="3175801">(</span><span class="op" id="3175802">[</span><span class="op" id="3175803">]</span><span class="builtintype" id="3175804">byte</span><span class="op" id="3175808">,</span>&nbsp;<span class="num" id="3175810">0</span><span class="op" id="3175811">,</span>&nbsp;<span class="ident" id="3175813">maxLen</span><span class="op" id="3175819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3175823">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175875">for</span>&nbsp;<span class="ident" id="3175879">i</span>&nbsp;<span class="op" id="3175881">:=</span>&nbsp;<span class="num" id="3175884">0</span><span class="op" id="3175885">;</span>&nbsp;<span class="ident" id="3175887">i</span>&nbsp;<span class="op" id="3175889">&lt;</span>&nbsp;<span class="ident" id="3175891">IPv6len</span><span class="op" id="3175898">;</span>&nbsp;<span class="ident" id="3175900">i</span>&nbsp;<span class="op" id="3175902">+=</span>&nbsp;<span class="num" id="3175905">2</span>&nbsp;<span class="op" id="3175907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175911">if</span>&nbsp;<span class="ident" id="3175914">i</span>&nbsp;<span class="op" id="3175916">==</span>&nbsp;<span class="ident" id="3175919">e0</span>&nbsp;<span class="op" id="3175922">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175927">b</span>&nbsp;<span class="op" id="3175929">=</span>&nbsp;<span class="builtinfunc" id="3175931">append</span><span class="op" id="3175937">(</span><span class="ident" id="3175938">b</span><span class="op" id="3175939">,</span>&nbsp;<span class="string" id="3175941">&#39;:&#39;</span><span class="op" id="3175944">,</span>&nbsp;<span class="string" id="3175946">&#39;:&#39;</span><span class="op" id="3175949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3175954">i</span>&nbsp;<span class="op" id="3175956">=</span>&nbsp;<span class="ident" id="3175958">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175964">if</span>&nbsp;<span class="ident" id="3175967">i</span>&nbsp;<span class="op" id="3175969">&gt;=</span>&nbsp;<span class="ident" id="3175972">IPv6len</span>&nbsp;<span class="op" id="3175980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3175986">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175995">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3175999">}</span>&nbsp;<span class="keyword" id="3176001">else</span>&nbsp;<span class="keyword" id="3176006">if</span>&nbsp;<span class="ident" id="3176009">i</span>&nbsp;<span class="op" id="3176011">&gt;</span>&nbsp;<span class="num" id="3176013">0</span>&nbsp;<span class="op" id="3176015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3176020">b</span>&nbsp;<span class="op" id="3176022">=</span>&nbsp;<span class="builtinfunc" id="3176024">append</span><span class="op" id="3176030">(</span><span class="ident" id="3176031">b</span><span class="op" id="3176032">,</span>&nbsp;<span class="string" id="3176034">&#39;:&#39;</span><span class="op" id="3176037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3176045">b</span>&nbsp;<span class="op" id="3176047">=</span>&nbsp;<span class="ident" id="3176049">appendHex</span><span class="op" id="3176058">(</span><span class="ident" id="3176059">b</span><span class="op" id="3176060">,</span>&nbsp;<span class="op" id="3176062">(</span><span class="builtintype" id="3176063">uint32</span><span class="op" id="3176069">(</span><span class="ident" id="3176070">p</span><span class="op" id="3176071">[</span><span class="ident" id="3176072">i</span><span class="op" id="3176073">]</span><span class="op" id="3176074">)</span><span class="op" id="3176075">&lt;&lt;</span><span class="num" id="3176077">8</span><span class="op" id="3176078">)</span><span class="op" id="3176079">|</span><span class="builtintype" id="3176080">uint32</span><span class="op" id="3176086">(</span><span class="ident" id="3176087">p</span><span class="op" id="3176088">[</span><span class="ident" id="3176089">i</span><span class="op" id="3176090">+</span><span class="num" id="3176091">1</span><span class="op" id="3176092">]</span><span class="op" id="3176093">)</span><span class="op" id="3176094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176097">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176100">return</span>&nbsp;<span class="builtintype" id="3176107">string</span><span class="op" id="3176113">(</span><span class="ident" id="3176114">b</span><span class="op" id="3176115">)</span><br>
<span class="lineno"></span><span class="op" id="3176117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3176120">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3176178">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="3176215">func</span>&nbsp;<span class="ident" id="3176220">ipEmptyString</span><span class="op" id="3176233">(</span><span class="ident" id="3176234">ip</span>&nbsp;<span class="ident" id="3176237">IP</span><span class="op" id="3176239">)</span>&nbsp;<span class="builtintype" id="3176241">string</span>&nbsp;<span class="op" id="3176248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176251">if</span>&nbsp;<span class="builtinfunc" id="3176254">len</span><span class="op" id="3176257">(</span><span class="ident" id="3176258">ip</span><span class="op" id="3176260">)</span>&nbsp;<span class="op" id="3176262">==</span>&nbsp;<span class="num" id="3176265">0</span>&nbsp;<span class="op" id="3176267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176271">return</span>&nbsp;<span class="string" id="3176278">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176285">return</span>&nbsp;<span class="ident" id="3176292">ip</span><span class="op" id="3176294">.</span><span class="ident" id="3176295">String</span><span class="op" id="3176301">(</span><span class="op" id="3176302">)</span><br>
<span class="lineno">325</span><span class="op" id="3176304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3176307">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3176371">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="3176422">func</span>&nbsp;<span class="op" id="3176427">(</span><span class="ident" id="3176428">ip</span>&nbsp;<span class="ident" id="3176431">IP</span><span class="op" id="3176433">)</span>&nbsp;<span class="ident" id="3176435">MarshalText</span><span class="op" id="3176446">(</span><span class="op" id="3176447">)</span>&nbsp;<span class="op" id="3176449">(</span><span class="op" id="3176450">[</span><span class="op" id="3176451">]</span><span class="builtintype" id="3176452">byte</span><span class="op" id="3176456">,</span>&nbsp;<span class="builtintype" id="3176458">error</span><span class="op" id="3176463">)</span>&nbsp;<span class="op" id="3176465">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176468">if</span>&nbsp;<span class="builtinfunc" id="3176471">len</span><span class="op" id="3176474">(</span><span class="ident" id="3176475">ip</span><span class="op" id="3176477">)</span>&nbsp;<span class="op" id="3176479">==</span>&nbsp;<span class="num" id="3176482">0</span>&nbsp;<span class="op" id="3176484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176488">return</span>&nbsp;<span class="op" id="3176495">[</span><span class="op" id="3176496">]</span><span class="builtintype" id="3176497">byte</span><span class="op" id="3176501">(</span><span class="string" id="3176502">&#34;&#34;</span><span class="op" id="3176504">)</span><span class="op" id="3176505">,</span>&nbsp;<span class="ident" id="3176507">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176515">if</span>&nbsp;<span class="builtinfunc" id="3176518">len</span><span class="op" id="3176521">(</span><span class="ident" id="3176522">ip</span><span class="op" id="3176524">)</span>&nbsp;<span class="op" id="3176526">!=</span>&nbsp;<span class="ident" id="3176529">IPv4len</span>&nbsp;<span class="op" id="3176537">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3176540">len</span><span class="op" id="3176543">(</span><span class="ident" id="3176544">ip</span><span class="op" id="3176546">)</span>&nbsp;<span class="op" id="3176548">!=</span>&nbsp;<span class="ident" id="3176551">IPv6len</span>&nbsp;<span class="op" id="3176559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176563">return</span>&nbsp;<span class="ident" id="3176570">nil</span><span class="op" id="3176573">,</span>&nbsp;<span class="ident" id="3176575">errors</span><span class="op" id="3176581">.</span><span class="ident" id="3176582">New</span><span class="op" id="3176585">(</span><span class="string" id="3176586">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="3176606">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176612">return</span>&nbsp;<span class="op" id="3176619">[</span><span class="op" id="3176620">]</span><span class="builtintype" id="3176621">byte</span><span class="op" id="3176625">(</span><span class="ident" id="3176626">ip</span><span class="op" id="3176628">.</span><span class="ident" id="3176629">String</span><span class="op" id="3176635">(</span><span class="op" id="3176636">)</span><span class="op" id="3176637">)</span><span class="op" id="3176638">,</span>&nbsp;<span class="ident" id="3176640">nil</span><br>
<span class="lineno"></span><span class="op" id="3176644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3176647">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="3176715">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="3176776">func</span>&nbsp;<span class="op" id="3176781">(</span><span class="ident" id="3176782">ip</span>&nbsp;<span class="op" id="3176785">*</span><span class="ident" id="3176786">IP</span><span class="op" id="3176788">)</span>&nbsp;<span class="ident" id="3176790">UnmarshalText</span><span class="op" id="3176803">(</span><span class="ident" id="3176804">text</span>&nbsp;<span class="op" id="3176809">[</span><span class="op" id="3176810">]</span><span class="builtintype" id="3176811">byte</span><span class="op" id="3176815">)</span>&nbsp;<span class="builtintype" id="3176817">error</span>&nbsp;<span class="op" id="3176823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176826">if</span>&nbsp;<span class="builtinfunc" id="3176829">len</span><span class="op" id="3176832">(</span><span class="ident" id="3176833">text</span><span class="op" id="3176837">)</span>&nbsp;<span class="op" id="3176839">==</span>&nbsp;<span class="num" id="3176842">0</span>&nbsp;<span class="op" id="3176844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176848">*</span><span class="ident" id="3176849">ip</span>&nbsp;<span class="op" id="3176852">=</span>&nbsp;<span class="ident" id="3176854">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176860">return</span>&nbsp;<span class="ident" id="3176867">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3176875">s</span>&nbsp;<span class="op" id="3176877">:=</span>&nbsp;<span class="builtintype" id="3176880">string</span><span class="op" id="3176886">(</span><span class="ident" id="3176887">text</span><span class="op" id="3176891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3176894">x</span>&nbsp;<span class="op" id="3176896">:=</span>&nbsp;<span class="ident" id="3176899">ParseIP</span><span class="op" id="3176906">(</span><span class="ident" id="3176907">s</span><span class="op" id="3176908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176911">if</span>&nbsp;<span class="ident" id="3176914">x</span>&nbsp;<span class="op" id="3176916">==</span>&nbsp;<span class="ident" id="3176919">nil</span>&nbsp;<span class="op" id="3176923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176927">return</span>&nbsp;<span class="op" id="3176934">&amp;</span><span class="ident" id="3176935">ParseError</span><span class="op" id="3176945">{</span><span class="string" id="3176946">&#34;IP&nbsp;address&#34;</span><span class="op" id="3176958">,</span>&nbsp;<span class="ident" id="3176960">s</span><span class="op" id="3176961">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3176967">*</span><span class="ident" id="3176968">ip</span>&nbsp;<span class="op" id="3176971">=</span>&nbsp;<span class="ident" id="3176973">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3176976">return</span>&nbsp;<span class="ident" id="3176983">nil</span><br>
<span class="lineno"></span><span class="op" id="3176987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3176990">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3177049">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3177107">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3177134">func</span>&nbsp;<span class="op" id="3177139">(</span><span class="ident" id="3177140">ip</span>&nbsp;<span class="ident" id="3177143">IP</span><span class="op" id="3177145">)</span>&nbsp;<span class="ident" id="3177147">Equal</span><span class="op" id="3177152">(</span><span class="ident" id="3177153">x</span>&nbsp;<span class="ident" id="3177155">IP</span><span class="op" id="3177157">)</span>&nbsp;<span class="builtintype" id="3177159">bool</span>&nbsp;<span class="op" id="3177164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177167">if</span>&nbsp;<span class="builtinfunc" id="3177170">len</span><span class="op" id="3177173">(</span><span class="ident" id="3177174">ip</span><span class="op" id="3177176">)</span>&nbsp;<span class="op" id="3177178">==</span>&nbsp;<span class="builtinfunc" id="3177181">len</span><span class="op" id="3177184">(</span><span class="ident" id="3177185">x</span><span class="op" id="3177186">)</span>&nbsp;<span class="op" id="3177188">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177192">return</span>&nbsp;<span class="ident" id="3177199">bytesEqual</span><span class="op" id="3177209">(</span><span class="ident" id="3177210">ip</span><span class="op" id="3177212">,</span>&nbsp;<span class="ident" id="3177214">x</span><span class="op" id="3177215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177221">if</span>&nbsp;<span class="builtinfunc" id="3177224">len</span><span class="op" id="3177227">(</span><span class="ident" id="3177228">ip</span><span class="op" id="3177230">)</span>&nbsp;<span class="op" id="3177232">==</span>&nbsp;<span class="ident" id="3177235">IPv4len</span>&nbsp;<span class="op" id="3177243">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3177246">len</span><span class="op" id="3177249">(</span><span class="ident" id="3177250">x</span><span class="op" id="3177251">)</span>&nbsp;<span class="op" id="3177253">==</span>&nbsp;<span class="ident" id="3177256">IPv6len</span>&nbsp;<span class="op" id="3177264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177268">return</span>&nbsp;<span class="ident" id="3177275">bytesEqual</span><span class="op" id="3177285">(</span><span class="ident" id="3177286">x</span><span class="op" id="3177287">[</span><span class="num" id="3177288">0</span><span class="op" id="3177289">:</span><span class="num" id="3177290">12</span><span class="op" id="3177292">]</span><span class="op" id="3177293">,</span>&nbsp;<span class="ident" id="3177295">v4InV6Prefix</span><span class="op" id="3177307">)</span>&nbsp;<span class="op" id="3177309">&amp;&amp;</span>&nbsp;<span class="ident" id="3177312">bytesEqual</span><span class="op" id="3177322">(</span><span class="ident" id="3177323">ip</span><span class="op" id="3177325">,</span>&nbsp;<span class="ident" id="3177327">x</span><span class="op" id="3177328">[</span><span class="num" id="3177329">12</span><span class="op" id="3177331">:</span><span class="op" id="3177332">]</span><span class="op" id="3177333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177336">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177339">if</span>&nbsp;<span class="builtinfunc" id="3177342">len</span><span class="op" id="3177345">(</span><span class="ident" id="3177346">ip</span><span class="op" id="3177348">)</span>&nbsp;<span class="op" id="3177350">==</span>&nbsp;<span class="ident" id="3177353">IPv6len</span>&nbsp;<span class="op" id="3177361">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3177364">len</span><span class="op" id="3177367">(</span><span class="ident" id="3177368">x</span><span class="op" id="3177369">)</span>&nbsp;<span class="op" id="3177371">==</span>&nbsp;<span class="ident" id="3177374">IPv4len</span>&nbsp;<span class="op" id="3177382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177386">return</span>&nbsp;<span class="ident" id="3177393">bytesEqual</span><span class="op" id="3177403">(</span><span class="ident" id="3177404">ip</span><span class="op" id="3177406">[</span><span class="num" id="3177407">0</span><span class="op" id="3177408">:</span><span class="num" id="3177409">12</span><span class="op" id="3177411">]</span><span class="op" id="3177412">,</span>&nbsp;<span class="ident" id="3177414">v4InV6Prefix</span><span class="op" id="3177426">)</span>&nbsp;<span class="op" id="3177428">&amp;&amp;</span>&nbsp;<span class="ident" id="3177431">bytesEqual</span><span class="op" id="3177441">(</span><span class="ident" id="3177442">ip</span><span class="op" id="3177444">[</span><span class="num" id="3177445">12</span><span class="op" id="3177447">:</span><span class="op" id="3177448">]</span><span class="op" id="3177449">,</span>&nbsp;<span class="ident" id="3177451">x</span><span class="op" id="3177452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177458">return</span>&nbsp;<span class="builtintype" id="3177465">false</span><br>
<span class="lineno"></span><span class="op" id="3177471">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="3177474">func</span>&nbsp;<span class="ident" id="3177479">bytesEqual</span><span class="op" id="3177489">(</span><span class="ident" id="3177490">x</span><span class="op" id="3177491">,</span>&nbsp;<span class="ident" id="3177493">y</span>&nbsp;<span class="op" id="3177495">[</span><span class="op" id="3177496">]</span><span class="builtintype" id="3177497">byte</span><span class="op" id="3177501">)</span>&nbsp;<span class="builtintype" id="3177503">bool</span>&nbsp;<span class="op" id="3177508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177511">if</span>&nbsp;<span class="builtinfunc" id="3177514">len</span><span class="op" id="3177517">(</span><span class="ident" id="3177518">x</span><span class="op" id="3177519">)</span>&nbsp;<span class="op" id="3177521">!=</span>&nbsp;<span class="builtinfunc" id="3177524">len</span><span class="op" id="3177527">(</span><span class="ident" id="3177528">y</span><span class="op" id="3177529">)</span>&nbsp;<span class="op" id="3177531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177535">return</span>&nbsp;<span class="builtintype" id="3177542">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177549">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177552">for</span>&nbsp;<span class="ident" id="3177556">i</span><span class="op" id="3177557">,</span>&nbsp;<span class="ident" id="3177559">b</span>&nbsp;<span class="op" id="3177561">:=</span>&nbsp;<span class="keyword" id="3177564">range</span>&nbsp;<span class="ident" id="3177570">x</span>&nbsp;<span class="op" id="3177572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177576">if</span>&nbsp;<span class="ident" id="3177579">y</span><span class="op" id="3177580">[</span><span class="ident" id="3177581">i</span><span class="op" id="3177582">]</span>&nbsp;<span class="op" id="3177584">!=</span>&nbsp;<span class="ident" id="3177587">b</span>&nbsp;<span class="op" id="3177589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177594">return</span>&nbsp;<span class="builtintype" id="3177601">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177612">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177615">return</span>&nbsp;<span class="builtintype" id="3177622">true</span><br>
<span class="lineno"></span><span class="op" id="3177627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3177630">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3177685">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="3177717">func</span>&nbsp;<span class="ident" id="3177722">simpleMaskLength</span><span class="op" id="3177738">(</span><span class="ident" id="3177739">mask</span>&nbsp;<span class="ident" id="3177744">IPMask</span><span class="op" id="3177750">)</span>&nbsp;<span class="builtintype" id="3177752">int</span>&nbsp;<span class="op" id="3177756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177759">var</span>&nbsp;<span class="ident" id="3177763">n</span>&nbsp;<span class="builtintype" id="3177765">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177770">for</span>&nbsp;<span class="ident" id="3177774">i</span><span class="op" id="3177775">,</span>&nbsp;<span class="ident" id="3177777">v</span>&nbsp;<span class="op" id="3177779">:=</span>&nbsp;<span class="keyword" id="3177782">range</span>&nbsp;<span class="ident" id="3177788">mask</span>&nbsp;<span class="op" id="3177793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177797">if</span>&nbsp;<span class="ident" id="3177800">v</span>&nbsp;<span class="op" id="3177802">==</span>&nbsp;<span class="num" id="3177805">0xff</span>&nbsp;<span class="op" id="3177810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3177815">n</span>&nbsp;<span class="op" id="3177817">+=</span>&nbsp;<span class="num" id="3177820">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177825">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3177840">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3177863">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177881">for</span>&nbsp;<span class="ident" id="3177885">v</span><span class="op" id="3177886">&amp;</span><span class="num" id="3177887">0x80</span>&nbsp;<span class="op" id="3177892">!=</span>&nbsp;<span class="num" id="3177895">0</span>&nbsp;<span class="op" id="3177897">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3177902">n</span><span class="op" id="3177903">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3177909">v</span>&nbsp;<span class="op" id="3177911">&lt;&lt;=</span>&nbsp;<span class="num" id="3177915">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3177923">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177948">if</span>&nbsp;<span class="ident" id="3177951">v</span>&nbsp;<span class="op" id="3177953">!=</span>&nbsp;<span class="num" id="3177956">0</span>&nbsp;<span class="op" id="3177958">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177963">return</span>&nbsp;<span class="op" id="3177970">-</span><span class="num" id="3177971">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3177975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3177979">for</span>&nbsp;<span class="ident" id="3177983">i</span><span class="op" id="3177984">++</span><span class="op" id="3177986">;</span>&nbsp;<span class="ident" id="3177988">i</span>&nbsp;<span class="op" id="3177990">&lt;</span>&nbsp;<span class="builtinfunc" id="3177992">len</span><span class="op" id="3177995">(</span><span class="ident" id="3177996">mask</span><span class="op" id="3178000">)</span><span class="op" id="3178001">;</span>&nbsp;<span class="ident" id="3178003">i</span><span class="op" id="3178004">++</span>&nbsp;<span class="op" id="3178007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178012">if</span>&nbsp;<span class="ident" id="3178015">mask</span><span class="op" id="3178019">[</span><span class="ident" id="3178020">i</span><span class="op" id="3178021">]</span>&nbsp;<span class="op" id="3178023">!=</span>&nbsp;<span class="num" id="3178026">0</span>&nbsp;<span class="op" id="3178028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178034">return</span>&nbsp;<span class="op" id="3178041">-</span><span class="num" id="3178042">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178055">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178065">return</span>&nbsp;<span class="ident" id="3178072">n</span><br>
<span class="lineno">410</span><span class="op" id="3178074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3178077">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="3178148">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="3178222">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="3178244">func</span>&nbsp;<span class="op" id="3178249">(</span><span class="ident" id="3178250">m</span>&nbsp;<span class="ident" id="3178252">IPMask</span><span class="op" id="3178258">)</span>&nbsp;<span class="ident" id="3178260">Size</span><span class="op" id="3178264">(</span><span class="op" id="3178265">)</span>&nbsp;<span class="op" id="3178267">(</span><span class="ident" id="3178268">ones</span><span class="op" id="3178272">,</span>&nbsp;<span class="ident" id="3178274">bits</span>&nbsp;<span class="builtintype" id="3178279">int</span><span class="op" id="3178282">)</span>&nbsp;<span class="op" id="3178284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3178287">ones</span><span class="op" id="3178291">,</span>&nbsp;<span class="ident" id="3178293">bits</span>&nbsp;<span class="op" id="3178298">=</span>&nbsp;<span class="ident" id="3178300">simpleMaskLength</span><span class="op" id="3178316">(</span><span class="ident" id="3178317">m</span><span class="op" id="3178318">)</span><span class="op" id="3178319">,</span>&nbsp;<span class="builtinfunc" id="3178321">len</span><span class="op" id="3178324">(</span><span class="ident" id="3178325">m</span><span class="op" id="3178326">)</span><span class="op" id="3178327">*</span><span class="num" id="3178328">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178331">if</span>&nbsp;<span class="ident" id="3178334">ones</span>&nbsp;<span class="op" id="3178339">==</span>&nbsp;<span class="op" id="3178342">-</span><span class="num" id="3178343">1</span>&nbsp;<span class="op" id="3178345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178349">return</span>&nbsp;<span class="num" id="3178356">0</span><span class="op" id="3178357">,</span>&nbsp;<span class="num" id="3178359">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178362">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178365">return</span><br>
<span class="lineno"></span><span class="op" id="3178372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3178375">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="3178441">func</span>&nbsp;<span class="op" id="3178446">(</span><span class="ident" id="3178447">m</span>&nbsp;<span class="ident" id="3178449">IPMask</span><span class="op" id="3178455">)</span>&nbsp;<span class="ident" id="3178457">String</span><span class="op" id="3178463">(</span><span class="op" id="3178464">)</span>&nbsp;<span class="builtintype" id="3178466">string</span>&nbsp;<span class="op" id="3178473">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178476">if</span>&nbsp;<span class="builtinfunc" id="3178479">len</span><span class="op" id="3178482">(</span><span class="ident" id="3178483">m</span><span class="op" id="3178484">)</span>&nbsp;<span class="op" id="3178486">==</span>&nbsp;<span class="num" id="3178489">0</span>&nbsp;<span class="op" id="3178491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178495">return</span>&nbsp;<span class="string" id="3178502">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3178514">buf</span>&nbsp;<span class="op" id="3178518">:=</span>&nbsp;<span class="builtinfunc" id="3178521">make</span><span class="op" id="3178525">(</span><span class="op" id="3178526">[</span><span class="op" id="3178527">]</span><span class="builtintype" id="3178528">byte</span><span class="op" id="3178532">,</span>&nbsp;<span class="builtinfunc" id="3178534">len</span><span class="op" id="3178537">(</span><span class="ident" id="3178538">m</span><span class="op" id="3178539">)</span><span class="op" id="3178540">*</span><span class="num" id="3178541">2</span><span class="op" id="3178542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178545">for</span>&nbsp;<span class="ident" id="3178549">i</span><span class="op" id="3178550">,</span>&nbsp;<span class="ident" id="3178552">b</span>&nbsp;<span class="op" id="3178554">:=</span>&nbsp;<span class="keyword" id="3178557">range</span>&nbsp;<span class="ident" id="3178563">m</span>&nbsp;<span class="op" id="3178565">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3178569">buf</span><span class="op" id="3178572">[</span><span class="ident" id="3178573">i</span><span class="op" id="3178574">*</span><span class="num" id="3178575">2</span><span class="op" id="3178576">]</span><span class="op" id="3178577">,</span>&nbsp;<span class="ident" id="3178579">buf</span><span class="op" id="3178582">[</span><span class="ident" id="3178583">i</span><span class="op" id="3178584">*</span><span class="num" id="3178585">2</span><span class="op" id="3178586">+</span><span class="num" id="3178587">1</span><span class="op" id="3178588">]</span>&nbsp;<span class="op" id="3178590">=</span>&nbsp;<span class="ident" id="3178592">hexDigit</span><span class="op" id="3178600">[</span><span class="ident" id="3178601">b</span><span class="op" id="3178602">&gt;&gt;</span><span class="num" id="3178604">4</span><span class="op" id="3178605">]</span><span class="op" id="3178606">,</span>&nbsp;<span class="ident" id="3178608">hexDigit</span><span class="op" id="3178616">[</span><span class="ident" id="3178617">b</span><span class="op" id="3178618">&amp;</span><span class="num" id="3178619">0xf</span><span class="op" id="3178622">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178628">return</span>&nbsp;<span class="builtintype" id="3178635">string</span><span class="op" id="3178641">(</span><span class="ident" id="3178642">buf</span><span class="op" id="3178645">)</span><br>
<span class="lineno"></span><span class="op" id="3178647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="3178650">func</span>&nbsp;<span class="ident" id="3178655">networkNumberAndMask</span><span class="op" id="3178675">(</span><span class="ident" id="3178676">n</span>&nbsp;<span class="op" id="3178678">*</span><span class="ident" id="3178679">IPNet</span><span class="op" id="3178684">)</span>&nbsp;<span class="op" id="3178686">(</span><span class="ident" id="3178687">ip</span>&nbsp;<span class="ident" id="3178690">IP</span><span class="op" id="3178692">,</span>&nbsp;<span class="ident" id="3178694">m</span>&nbsp;<span class="ident" id="3178696">IPMask</span><span class="op" id="3178702">)</span>&nbsp;<span class="op" id="3178704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178707">if</span>&nbsp;<span class="ident" id="3178710">ip</span>&nbsp;<span class="op" id="3178713">=</span>&nbsp;<span class="ident" id="3178715">n</span><span class="op" id="3178716">.</span><span class="ident" id="3178717">IP</span><span class="op" id="3178719">.</span><span class="ident" id="3178720">To4</span><span class="op" id="3178723">(</span><span class="op" id="3178724">)</span><span class="op" id="3178725">;</span>&nbsp;<span class="ident" id="3178727">ip</span>&nbsp;<span class="op" id="3178730">==</span>&nbsp;<span class="ident" id="3178733">nil</span>&nbsp;<span class="op" id="3178737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3178741">ip</span>&nbsp;<span class="op" id="3178744">=</span>&nbsp;<span class="ident" id="3178746">n</span><span class="op" id="3178747">.</span><span class="ident" id="3178748">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178753">if</span>&nbsp;<span class="builtinfunc" id="3178756">len</span><span class="op" id="3178759">(</span><span class="ident" id="3178760">ip</span><span class="op" id="3178762">)</span>&nbsp;<span class="op" id="3178764">!=</span>&nbsp;<span class="ident" id="3178767">IPv6len</span>&nbsp;<span class="op" id="3178775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178780">return</span>&nbsp;<span class="ident" id="3178787">nil</span><span class="op" id="3178790">,</span>&nbsp;<span class="ident" id="3178792">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3178804">m</span>&nbsp;<span class="op" id="3178806">=</span>&nbsp;<span class="ident" id="3178808">n</span><span class="op" id="3178809">.</span><span class="ident" id="3178810">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178816">switch</span>&nbsp;<span class="builtinfunc" id="3178823">len</span><span class="op" id="3178826">(</span><span class="ident" id="3178827">m</span><span class="op" id="3178828">)</span>&nbsp;<span class="op" id="3178830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178833">case</span>&nbsp;<span class="ident" id="3178838">IPv4len</span><span class="op" id="3178845">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178849">if</span>&nbsp;<span class="builtinfunc" id="3178852">len</span><span class="op" id="3178855">(</span><span class="ident" id="3178856">ip</span><span class="op" id="3178858">)</span>&nbsp;<span class="op" id="3178860">!=</span>&nbsp;<span class="ident" id="3178863">IPv4len</span>&nbsp;<span class="op" id="3178871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178876">return</span>&nbsp;<span class="ident" id="3178883">nil</span><span class="op" id="3178886">,</span>&nbsp;<span class="ident" id="3178888">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178897">case</span>&nbsp;<span class="ident" id="3178902">IPv6len</span><span class="op" id="3178909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178913">if</span>&nbsp;<span class="builtinfunc" id="3178916">len</span><span class="op" id="3178919">(</span><span class="ident" id="3178920">ip</span><span class="op" id="3178922">)</span>&nbsp;<span class="op" id="3178924">==</span>&nbsp;<span class="ident" id="3178927">IPv4len</span>&nbsp;<span class="op" id="3178935">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3178940">m</span>&nbsp;<span class="op" id="3178942">=</span>&nbsp;<span class="ident" id="3178944">m</span><span class="op" id="3178945">[</span><span class="num" id="3178946">12</span><span class="op" id="3178948">:</span><span class="op" id="3178949">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178956">default</span><span class="op" id="3178963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178967">return</span>&nbsp;<span class="ident" id="3178974">nil</span><span class="op" id="3178977">,</span>&nbsp;<span class="ident" id="3178979">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3178984">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3178987">return</span><br>
<span class="lineno"></span><span class="op" id="3178994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3178997">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="3179050">func</span>&nbsp;<span class="op" id="3179055">(</span><span class="ident" id="3179056">n</span>&nbsp;<span class="op" id="3179058">*</span><span class="ident" id="3179059">IPNet</span><span class="op" id="3179064">)</span>&nbsp;<span class="ident" id="3179066">Contains</span><span class="op" id="3179074">(</span><span class="ident" id="3179075">ip</span>&nbsp;<span class="ident" id="3179078">IP</span><span class="op" id="3179080">)</span>&nbsp;<span class="builtintype" id="3179082">bool</span>&nbsp;<span class="op" id="3179087">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3179090">nn</span><span class="op" id="3179092">,</span>&nbsp;<span class="ident" id="3179094">m</span>&nbsp;<span class="op" id="3179096">:=</span>&nbsp;<span class="ident" id="3179099">networkNumberAndMask</span><span class="op" id="3179119">(</span><span class="ident" id="3179120">n</span><span class="op" id="3179121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179124">if</span>&nbsp;<span class="ident" id="3179127">x</span>&nbsp;<span class="op" id="3179129">:=</span>&nbsp;<span class="ident" id="3179132">ip</span><span class="op" id="3179134">.</span><span class="ident" id="3179135">To4</span><span class="op" id="3179138">(</span><span class="op" id="3179139">)</span><span class="op" id="3179140">;</span>&nbsp;<span class="ident" id="3179142">x</span>&nbsp;<span class="op" id="3179144">!=</span>&nbsp;<span class="ident" id="3179147">nil</span>&nbsp;<span class="op" id="3179151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3179155">ip</span>&nbsp;<span class="op" id="3179158">=</span>&nbsp;<span class="ident" id="3179160">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3179163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3179166">l</span>&nbsp;<span class="op" id="3179168">:=</span>&nbsp;<span class="builtinfunc" id="3179171">len</span><span class="op" id="3179174">(</span><span class="ident" id="3179175">ip</span><span class="op" id="3179177">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179180">if</span>&nbsp;<span class="ident" id="3179183">l</span>&nbsp;<span class="op" id="3179185">!=</span>&nbsp;<span class="builtinfunc" id="3179188">len</span><span class="op" id="3179191">(</span><span class="ident" id="3179192">nn</span><span class="op" id="3179194">)</span>&nbsp;<span class="op" id="3179196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179200">return</span>&nbsp;<span class="builtintype" id="3179207">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3179214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179217">for</span>&nbsp;<span class="ident" id="3179221">i</span>&nbsp;<span class="op" id="3179223">:=</span>&nbsp;<span class="num" id="3179226">0</span><span class="op" id="3179227">;</span>&nbsp;<span class="ident" id="3179229">i</span>&nbsp;<span class="op" id="3179231">&lt;</span>&nbsp;<span class="ident" id="3179233">l</span><span class="op" id="3179234">;</span>&nbsp;<span class="ident" id="3179236">i</span><span class="op" id="3179237">++</span>&nbsp;<span class="op" id="3179240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179244">if</span>&nbsp;<span class="ident" id="3179247">nn</span><span class="op" id="3179249">[</span><span class="ident" id="3179250">i</span><span class="op" id="3179251">]</span><span class="op" id="3179252">&amp;</span><span class="ident" id="3179253">m</span><span class="op" id="3179254">[</span><span class="ident" id="3179255">i</span><span class="op" id="3179256">]</span>&nbsp;<span class="op" id="3179258">!=</span>&nbsp;<span class="ident" id="3179261">ip</span><span class="op" id="3179263">[</span><span class="ident" id="3179264">i</span><span class="op" id="3179265">]</span><span class="op" id="3179266">&amp;</span><span class="ident" id="3179267">m</span><span class="op" id="3179268">[</span><span class="ident" id="3179269">i</span><span class="op" id="3179270">]</span>&nbsp;<span class="op" id="3179272">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179277">return</span>&nbsp;<span class="builtintype" id="3179284">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3179292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3179295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179298">return</span>&nbsp;<span class="builtintype" id="3179305">true</span><br>
<span class="lineno"></span><span class="op" id="3179310">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3179313">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3179370">func</span>&nbsp;<span class="op" id="3179375">(</span><span class="ident" id="3179376">n</span>&nbsp;<span class="op" id="3179378">*</span><span class="ident" id="3179379">IPNet</span><span class="op" id="3179384">)</span>&nbsp;<span class="ident" id="3179386">Network</span><span class="op" id="3179393">(</span><span class="op" id="3179394">)</span>&nbsp;<span class="builtintype" id="3179396">string</span>&nbsp;<span class="op" id="3179403">{</span>&nbsp;<span class="keyword" id="3179405">return</span>&nbsp;<span class="string" id="3179412">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="3179421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3179424">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="3179489">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3179548">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3179608">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="3179671">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3179733">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="3179779">func</span>&nbsp;<span class="op" id="3179784">(</span><span class="ident" id="3179785">n</span>&nbsp;<span class="op" id="3179787">*</span><span class="ident" id="3179788">IPNet</span><span class="op" id="3179793">)</span>&nbsp;<span class="ident" id="3179795">String</span><span class="op" id="3179801">(</span><span class="op" id="3179802">)</span>&nbsp;<span class="builtintype" id="3179804">string</span>&nbsp;<span class="op" id="3179811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3179814">nn</span><span class="op" id="3179816">,</span>&nbsp;<span class="ident" id="3179818">m</span>&nbsp;<span class="op" id="3179820">:=</span>&nbsp;<span class="ident" id="3179823">networkNumberAndMask</span><span class="op" id="3179843">(</span><span class="ident" id="3179844">n</span><span class="op" id="3179845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179848">if</span>&nbsp;<span class="ident" id="3179851">nn</span>&nbsp;<span class="op" id="3179854">==</span>&nbsp;<span class="ident" id="3179857">nil</span>&nbsp;<span class="op" id="3179861">||</span>&nbsp;<span class="ident" id="3179864">m</span>&nbsp;<span class="op" id="3179866">==</span>&nbsp;<span class="ident" id="3179869">nil</span>&nbsp;<span class="op" id="3179873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179877">return</span>&nbsp;<span class="string" id="3179884">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3179893">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3179896">l</span>&nbsp;<span class="op" id="3179898">:=</span>&nbsp;<span class="ident" id="3179901">simpleMaskLength</span><span class="op" id="3179917">(</span><span class="ident" id="3179918">m</span><span class="op" id="3179919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179922">if</span>&nbsp;<span class="ident" id="3179925">l</span>&nbsp;<span class="op" id="3179927">==</span>&nbsp;<span class="op" id="3179930">-</span><span class="num" id="3179931">1</span>&nbsp;<span class="op" id="3179933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179937">return</span>&nbsp;<span class="ident" id="3179944">nn</span><span class="op" id="3179946">.</span><span class="ident" id="3179947">String</span><span class="op" id="3179953">(</span><span class="op" id="3179954">)</span>&nbsp;<span class="op" id="3179956">+</span>&nbsp;<span class="string" id="3179958">&#34;/&#34;</span>&nbsp;<span class="op" id="3179962">+</span>&nbsp;<span class="ident" id="3179964">m</span><span class="op" id="3179965">.</span><span class="ident" id="3179966">String</span><span class="op" id="3179972">(</span><span class="op" id="3179973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3179976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3179979">return</span>&nbsp;<span class="ident" id="3179986">nn</span><span class="op" id="3179988">.</span><span class="ident" id="3179989">String</span><span class="op" id="3179995">(</span><span class="op" id="3179996">)</span>&nbsp;<span class="op" id="3179998">+</span>&nbsp;<span class="string" id="3180000">&#34;/&#34;</span>&nbsp;<span class="op" id="3180004">+</span>&nbsp;<span class="ident" id="3180006">itod</span><span class="op" id="3180010">(</span><span class="builtintype" id="3180011">uint</span><span class="op" id="3180015">(</span><span class="ident" id="3180016">l</span><span class="op" id="3180017">)</span><span class="op" id="3180018">)</span><br>
<span class="lineno">495</span><span class="op" id="3180020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3180023">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="3180056">func</span>&nbsp;<span class="ident" id="3180061">parseIPv4</span><span class="op" id="3180070">(</span><span class="ident" id="3180071">s</span>&nbsp;<span class="builtintype" id="3180073">string</span><span class="op" id="3180079">)</span>&nbsp;<span class="ident" id="3180081">IP</span>&nbsp;<span class="op" id="3180084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180087">var</span>&nbsp;<span class="ident" id="3180091">p</span>&nbsp;<span class="op" id="3180093">[</span><span class="ident" id="3180094">IPv4len</span><span class="op" id="3180101">]</span><span class="builtintype" id="3180102">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180108">i</span>&nbsp;<span class="op" id="3180110">:=</span>&nbsp;<span class="num" id="3180113">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180116">for</span>&nbsp;<span class="ident" id="3180120">j</span>&nbsp;<span class="op" id="3180122">:=</span>&nbsp;<span class="num" id="3180125">0</span><span class="op" id="3180126">;</span>&nbsp;<span class="ident" id="3180128">j</span>&nbsp;<span class="op" id="3180130">&lt;</span>&nbsp;<span class="ident" id="3180132">IPv4len</span><span class="op" id="3180139">;</span>&nbsp;<span class="ident" id="3180141">j</span><span class="op" id="3180142">++</span>&nbsp;<span class="op" id="3180145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180149">if</span>&nbsp;<span class="ident" id="3180152">i</span>&nbsp;<span class="op" id="3180154">&gt;=</span>&nbsp;<span class="builtinfunc" id="3180157">len</span><span class="op" id="3180160">(</span><span class="ident" id="3180161">s</span><span class="op" id="3180162">)</span>&nbsp;<span class="op" id="3180164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3180169">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180191">return</span>&nbsp;<span class="ident" id="3180198">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3180204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180208">if</span>&nbsp;<span class="ident" id="3180211">j</span>&nbsp;<span class="op" id="3180213">&gt;</span>&nbsp;<span class="num" id="3180215">0</span>&nbsp;<span class="op" id="3180217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180222">if</span>&nbsp;<span class="ident" id="3180225">s</span><span class="op" id="3180226">[</span><span class="ident" id="3180227">i</span><span class="op" id="3180228">]</span>&nbsp;<span class="op" id="3180230">!=</span>&nbsp;<span class="string" id="3180233">&#39;.&#39;</span>&nbsp;<span class="op" id="3180237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180243">return</span>&nbsp;<span class="ident" id="3180250">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3180257">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180262">i</span><span class="op" id="3180263">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3180268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180272">var</span>&nbsp;<span class="op" id="3180276">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180281">n</span>&nbsp;&nbsp;<span class="builtintype" id="3180284">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180291">ok</span>&nbsp;<span class="builtintype" id="3180294">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3180301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180305">n</span><span class="op" id="3180306">,</span>&nbsp;<span class="ident" id="3180308">i</span><span class="op" id="3180309">,</span>&nbsp;<span class="ident" id="3180311">ok</span>&nbsp;<span class="op" id="3180314">=</span>&nbsp;<span class="ident" id="3180316">dtoi</span><span class="op" id="3180320">(</span><span class="ident" id="3180321">s</span><span class="op" id="3180322">,</span>&nbsp;<span class="ident" id="3180324">i</span><span class="op" id="3180325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180329">if</span>&nbsp;<span class="op" id="3180332">!</span><span class="ident" id="3180333">ok</span>&nbsp;<span class="op" id="3180336">||</span>&nbsp;<span class="ident" id="3180339">n</span>&nbsp;<span class="op" id="3180341">&gt;</span>&nbsp;<span class="num" id="3180343">0xFF</span>&nbsp;<span class="op" id="3180348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180353">return</span>&nbsp;<span class="ident" id="3180360">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3180366">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180370">p</span><span class="op" id="3180371">[</span><span class="ident" id="3180372">j</span><span class="op" id="3180373">]</span>&nbsp;<span class="op" id="3180375">=</span>&nbsp;<span class="builtintype" id="3180377">byte</span><span class="op" id="3180381">(</span><span class="ident" id="3180382">n</span><span class="op" id="3180383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3180386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180389">if</span>&nbsp;<span class="ident" id="3180392">i</span>&nbsp;<span class="op" id="3180394">!=</span>&nbsp;<span class="builtinfunc" id="3180397">len</span><span class="op" id="3180400">(</span><span class="ident" id="3180401">s</span><span class="op" id="3180402">)</span>&nbsp;<span class="op" id="3180404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180408">return</span>&nbsp;<span class="ident" id="3180415">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3180420">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180423">return</span>&nbsp;<span class="ident" id="3180430">IPv4</span><span class="op" id="3180434">(</span><span class="ident" id="3180435">p</span><span class="op" id="3180436">[</span><span class="num" id="3180437">0</span><span class="op" id="3180438">]</span><span class="op" id="3180439">,</span>&nbsp;<span class="ident" id="3180441">p</span><span class="op" id="3180442">[</span><span class="num" id="3180443">1</span><span class="op" id="3180444">]</span><span class="op" id="3180445">,</span>&nbsp;<span class="ident" id="3180447">p</span><span class="op" id="3180448">[</span><span class="num" id="3180449">2</span><span class="op" id="3180450">]</span><span class="op" id="3180451">,</span>&nbsp;<span class="ident" id="3180453">p</span><span class="op" id="3180454">[</span><span class="num" id="3180455">3</span><span class="op" id="3180456">]</span><span class="op" id="3180457">)</span><br>
<span class="lineno"></span><span class="op" id="3180459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3180462">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="3180532">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="3180603">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3180673">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3180682">func</span>&nbsp;<span class="ident" id="3180687">parseIPv6</span><span class="op" id="3180696">(</span><span class="ident" id="3180697">s</span>&nbsp;<span class="builtintype" id="3180699">string</span><span class="op" id="3180705">,</span>&nbsp;<span class="ident" id="3180707">zoneAllowed</span>&nbsp;<span class="builtintype" id="3180719">bool</span><span class="op" id="3180723">)</span>&nbsp;<span class="op" id="3180725">(</span><span class="ident" id="3180726">ip</span>&nbsp;<span class="ident" id="3180729">IP</span><span class="op" id="3180731">,</span>&nbsp;<span class="ident" id="3180733">zone</span>&nbsp;<span class="builtintype" id="3180738">string</span><span class="op" id="3180744">)</span>&nbsp;<span class="op" id="3180746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180749">ip</span>&nbsp;<span class="op" id="3180752">=</span>&nbsp;<span class="builtinfunc" id="3180754">make</span><span class="op" id="3180758">(</span><span class="ident" id="3180759">IP</span><span class="op" id="3180761">,</span>&nbsp;<span class="ident" id="3180763">IPv6len</span><span class="op" id="3180770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180773">ellipsis</span>&nbsp;<span class="op" id="3180782">:=</span>&nbsp;<span class="op" id="3180785">-</span><span class="num" id="3180786">1</span>&nbsp;<span class="comment" id="3180788">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180818">i</span>&nbsp;<span class="op" id="3180820">:=</span>&nbsp;<span class="num" id="3180823">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3180833">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180856">if</span>&nbsp;<span class="ident" id="3180859">zoneAllowed</span>&nbsp;<span class="op" id="3180871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180875">s</span><span class="op" id="3180876">,</span>&nbsp;<span class="ident" id="3180878">zone</span>&nbsp;<span class="op" id="3180883">=</span>&nbsp;<span class="ident" id="3180885">splitHostZone</span><span class="op" id="3180898">(</span><span class="ident" id="3180899">s</span><span class="op" id="3180900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3180903">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3180907">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3180939">if</span>&nbsp;<span class="builtinfunc" id="3180942">len</span><span class="op" id="3180945">(</span><span class="ident" id="3180946">s</span><span class="op" id="3180947">)</span>&nbsp;<span class="op" id="3180949">&gt;=</span>&nbsp;<span class="num" id="3180952">2</span>&nbsp;<span class="op" id="3180954">&amp;&amp;</span>&nbsp;<span class="ident" id="3180957">s</span><span class="op" id="3180958">[</span><span class="num" id="3180959">0</span><span class="op" id="3180960">]</span>&nbsp;<span class="op" id="3180962">==</span>&nbsp;<span class="string" id="3180965">&#39;:&#39;</span>&nbsp;<span class="op" id="3180969">&amp;&amp;</span>&nbsp;<span class="ident" id="3180972">s</span><span class="op" id="3180973">[</span><span class="num" id="3180974">1</span><span class="op" id="3180975">]</span>&nbsp;<span class="op" id="3180977">==</span>&nbsp;<span class="string" id="3180980">&#39;:&#39;</span>&nbsp;<span class="op" id="3180984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3180988">ellipsis</span>&nbsp;<span class="op" id="3180997">=</span>&nbsp;<span class="num" id="3180999">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181003">i</span>&nbsp;<span class="op" id="3181005">=</span>&nbsp;<span class="num" id="3181007">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181011">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181039">if</span>&nbsp;<span class="ident" id="3181042">i</span>&nbsp;<span class="op" id="3181044">==</span>&nbsp;<span class="builtinfunc" id="3181047">len</span><span class="op" id="3181050">(</span><span class="ident" id="3181051">s</span><span class="op" id="3181052">)</span>&nbsp;<span class="op" id="3181054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181059">return</span>&nbsp;<span class="ident" id="3181066">ip</span><span class="op" id="3181068">,</span>&nbsp;<span class="ident" id="3181070">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181080">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181084">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181133">j</span>&nbsp;<span class="op" id="3181135">:=</span>&nbsp;<span class="num" id="3181138">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181141">for</span>&nbsp;<span class="ident" id="3181145">j</span>&nbsp;<span class="op" id="3181147">&lt;</span>&nbsp;<span class="ident" id="3181149">IPv6len</span>&nbsp;<span class="op" id="3181157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181161">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181178">n</span><span class="op" id="3181179">,</span>&nbsp;<span class="ident" id="3181181">i1</span><span class="op" id="3181183">,</span>&nbsp;<span class="ident" id="3181185">ok</span>&nbsp;<span class="op" id="3181188">:=</span>&nbsp;<span class="ident" id="3181191">xtoi</span><span class="op" id="3181195">(</span><span class="ident" id="3181196">s</span><span class="op" id="3181197">,</span>&nbsp;<span class="ident" id="3181199">i</span><span class="op" id="3181200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181204">if</span>&nbsp;<span class="op" id="3181207">!</span><span class="ident" id="3181208">ok</span>&nbsp;<span class="op" id="3181211">||</span>&nbsp;<span class="ident" id="3181214">n</span>&nbsp;<span class="op" id="3181216">&gt;</span>&nbsp;<span class="num" id="3181218">0xFFFF</span>&nbsp;<span class="op" id="3181225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181230">return</span>&nbsp;<span class="ident" id="3181237">nil</span><span class="op" id="3181240">,</span>&nbsp;<span class="ident" id="3181242">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181254">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181306">if</span>&nbsp;<span class="ident" id="3181309">i1</span>&nbsp;<span class="op" id="3181312">&lt;</span>&nbsp;<span class="builtinfunc" id="3181314">len</span><span class="op" id="3181317">(</span><span class="ident" id="3181318">s</span><span class="op" id="3181319">)</span>&nbsp;<span class="op" id="3181321">&amp;&amp;</span>&nbsp;<span class="ident" id="3181324">s</span><span class="op" id="3181325">[</span><span class="ident" id="3181326">i1</span><span class="op" id="3181328">]</span>&nbsp;<span class="op" id="3181330">==</span>&nbsp;<span class="string" id="3181333">&#39;.&#39;</span>&nbsp;<span class="op" id="3181337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181342">if</span>&nbsp;<span class="ident" id="3181345">ellipsis</span>&nbsp;<span class="op" id="3181354">&lt;</span>&nbsp;<span class="num" id="3181356">0</span>&nbsp;<span class="op" id="3181358">&amp;&amp;</span>&nbsp;<span class="ident" id="3181361">j</span>&nbsp;<span class="op" id="3181363">!=</span>&nbsp;<span class="ident" id="3181366">IPv6len</span><span class="op" id="3181373">-</span><span class="ident" id="3181374">IPv4len</span>&nbsp;<span class="op" id="3181382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181388">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181416">return</span>&nbsp;<span class="ident" id="3181423">nil</span><span class="op" id="3181426">,</span>&nbsp;<span class="ident" id="3181428">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181441">if</span>&nbsp;<span class="ident" id="3181444">j</span><span class="op" id="3181445">+</span><span class="ident" id="3181446">IPv4len</span>&nbsp;<span class="op" id="3181454">&gt;</span>&nbsp;<span class="ident" id="3181456">IPv6len</span>&nbsp;<span class="op" id="3181464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181470">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181494">return</span>&nbsp;<span class="ident" id="3181501">nil</span><span class="op" id="3181504">,</span>&nbsp;<span class="ident" id="3181506">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181514">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181519">ip4</span>&nbsp;<span class="op" id="3181523">:=</span>&nbsp;<span class="ident" id="3181526">parseIPv4</span><span class="op" id="3181535">(</span><span class="ident" id="3181536">s</span><span class="op" id="3181537">[</span><span class="ident" id="3181538">i</span><span class="op" id="3181539">:</span><span class="op" id="3181540">]</span><span class="op" id="3181541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181546">if</span>&nbsp;<span class="ident" id="3181549">ip4</span>&nbsp;<span class="op" id="3181553">==</span>&nbsp;<span class="ident" id="3181556">nil</span>&nbsp;<span class="op" id="3181560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181566">return</span>&nbsp;<span class="ident" id="3181573">nil</span><span class="op" id="3181576">,</span>&nbsp;<span class="ident" id="3181578">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181591">ip</span><span class="op" id="3181593">[</span><span class="ident" id="3181594">j</span><span class="op" id="3181595">]</span>&nbsp;<span class="op" id="3181597">=</span>&nbsp;<span class="ident" id="3181599">ip4</span><span class="op" id="3181602">[</span><span class="num" id="3181603">12</span><span class="op" id="3181605">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181610">ip</span><span class="op" id="3181612">[</span><span class="ident" id="3181613">j</span><span class="op" id="3181614">+</span><span class="num" id="3181615">1</span><span class="op" id="3181616">]</span>&nbsp;<span class="op" id="3181618">=</span>&nbsp;<span class="ident" id="3181620">ip4</span><span class="op" id="3181623">[</span><span class="num" id="3181624">13</span><span class="op" id="3181626">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181631">ip</span><span class="op" id="3181633">[</span><span class="ident" id="3181634">j</span><span class="op" id="3181635">+</span><span class="num" id="3181636">2</span><span class="op" id="3181637">]</span>&nbsp;<span class="op" id="3181639">=</span>&nbsp;<span class="ident" id="3181641">ip4</span><span class="op" id="3181644">[</span><span class="num" id="3181645">14</span><span class="op" id="3181647">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181652">ip</span><span class="op" id="3181654">[</span><span class="ident" id="3181655">j</span><span class="op" id="3181656">+</span><span class="num" id="3181657">3</span><span class="op" id="3181658">]</span>&nbsp;<span class="op" id="3181660">=</span>&nbsp;<span class="ident" id="3181662">ip4</span><span class="op" id="3181665">[</span><span class="num" id="3181666">15</span><span class="op" id="3181668">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181673">i</span>&nbsp;<span class="op" id="3181675">=</span>&nbsp;<span class="builtinfunc" id="3181677">len</span><span class="op" id="3181680">(</span><span class="ident" id="3181681">s</span><span class="op" id="3181682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181687">j</span>&nbsp;<span class="op" id="3181689">+=</span>&nbsp;<span class="ident" id="3181692">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181703">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181716">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181745">ip</span><span class="op" id="3181747">[</span><span class="ident" id="3181748">j</span><span class="op" id="3181749">]</span>&nbsp;<span class="op" id="3181751">=</span>&nbsp;<span class="builtintype" id="3181753">byte</span><span class="op" id="3181757">(</span><span class="ident" id="3181758">n</span>&nbsp;<span class="op" id="3181760">&gt;&gt;</span>&nbsp;<span class="num" id="3181763">8</span><span class="op" id="3181764">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181768">ip</span><span class="op" id="3181770">[</span><span class="ident" id="3181771">j</span><span class="op" id="3181772">+</span><span class="num" id="3181773">1</span><span class="op" id="3181774">]</span>&nbsp;<span class="op" id="3181776">=</span>&nbsp;<span class="builtintype" id="3181778">byte</span><span class="op" id="3181782">(</span><span class="ident" id="3181783">n</span><span class="op" id="3181784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181788">j</span>&nbsp;<span class="op" id="3181790">+=</span>&nbsp;<span class="num" id="3181793">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181798">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181826">i</span>&nbsp;<span class="op" id="3181828">=</span>&nbsp;<span class="ident" id="3181830">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181835">if</span>&nbsp;<span class="ident" id="3181838">i</span>&nbsp;<span class="op" id="3181840">==</span>&nbsp;<span class="builtinfunc" id="3181843">len</span><span class="op" id="3181846">(</span><span class="ident" id="3181847">s</span><span class="op" id="3181848">)</span>&nbsp;<span class="op" id="3181850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181855">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181868">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181919">if</span>&nbsp;<span class="ident" id="3181922">s</span><span class="op" id="3181923">[</span><span class="ident" id="3181924">i</span><span class="op" id="3181925">]</span>&nbsp;<span class="op" id="3181927">!=</span>&nbsp;<span class="string" id="3181930">&#39;:&#39;</span>&nbsp;<span class="op" id="3181934">||</span>&nbsp;<span class="ident" id="3181937">i</span><span class="op" id="3181938">+</span><span class="num" id="3181939">1</span>&nbsp;<span class="op" id="3181941">==</span>&nbsp;<span class="builtinfunc" id="3181944">len</span><span class="op" id="3181947">(</span><span class="ident" id="3181948">s</span><span class="op" id="3181949">)</span>&nbsp;<span class="op" id="3181951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3181956">return</span>&nbsp;<span class="ident" id="3181963">nil</span><span class="op" id="3181966">,</span>&nbsp;<span class="ident" id="3181968">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3181975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3181979">i</span><span class="op" id="3181980">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3181986">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182010">if</span>&nbsp;<span class="ident" id="3182013">s</span><span class="op" id="3182014">[</span><span class="ident" id="3182015">i</span><span class="op" id="3182016">]</span>&nbsp;<span class="op" id="3182018">==</span>&nbsp;<span class="string" id="3182021">&#39;:&#39;</span>&nbsp;<span class="op" id="3182025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182030">if</span>&nbsp;<span class="ident" id="3182033">ellipsis</span>&nbsp;<span class="op" id="3182042">&gt;=</span>&nbsp;<span class="num" id="3182045">0</span>&nbsp;<span class="op" id="3182047">{</span>&nbsp;<span class="comment" id="3182049">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182073">return</span>&nbsp;<span class="ident" id="3182080">nil</span><span class="op" id="3182083">,</span>&nbsp;<span class="ident" id="3182085">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182093">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3182098">ellipsis</span>&nbsp;<span class="op" id="3182107">=</span>&nbsp;<span class="ident" id="3182109">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182114">if</span>&nbsp;<span class="ident" id="3182117">i</span><span class="op" id="3182118">++</span><span class="op" id="3182120">;</span>&nbsp;<span class="ident" id="3182122">i</span>&nbsp;<span class="op" id="3182124">==</span>&nbsp;<span class="builtinfunc" id="3182127">len</span><span class="op" id="3182130">(</span><span class="ident" id="3182131">s</span><span class="op" id="3182132">)</span>&nbsp;<span class="op" id="3182134">{</span>&nbsp;<span class="comment" id="3182136">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182157">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182170">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3182177">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182211">if</span>&nbsp;<span class="ident" id="3182214">i</span>&nbsp;<span class="op" id="3182216">!=</span>&nbsp;<span class="builtinfunc" id="3182219">len</span><span class="op" id="3182222">(</span><span class="ident" id="3182223">s</span><span class="op" id="3182224">)</span>&nbsp;<span class="op" id="3182226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182230">return</span>&nbsp;<span class="ident" id="3182237">nil</span><span class="op" id="3182240">,</span>&nbsp;<span class="ident" id="3182242">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3182252">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182297">if</span>&nbsp;<span class="ident" id="3182300">j</span>&nbsp;<span class="op" id="3182302">&lt;</span>&nbsp;<span class="ident" id="3182304">IPv6len</span>&nbsp;<span class="op" id="3182312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182316">if</span>&nbsp;<span class="ident" id="3182319">ellipsis</span>&nbsp;<span class="op" id="3182328">&lt;</span>&nbsp;<span class="num" id="3182330">0</span>&nbsp;<span class="op" id="3182332">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182337">return</span>&nbsp;<span class="ident" id="3182344">nil</span><span class="op" id="3182347">,</span>&nbsp;<span class="ident" id="3182349">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3182360">n</span>&nbsp;<span class="op" id="3182362">:=</span>&nbsp;<span class="ident" id="3182365">IPv6len</span>&nbsp;<span class="op" id="3182373">-</span>&nbsp;<span class="ident" id="3182375">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182379">for</span>&nbsp;<span class="ident" id="3182383">k</span>&nbsp;<span class="op" id="3182385">:=</span>&nbsp;<span class="ident" id="3182388">j</span>&nbsp;<span class="op" id="3182390">-</span>&nbsp;<span class="num" id="3182392">1</span><span class="op" id="3182393">;</span>&nbsp;<span class="ident" id="3182395">k</span>&nbsp;<span class="op" id="3182397">&gt;=</span>&nbsp;<span class="ident" id="3182400">ellipsis</span><span class="op" id="3182408">;</span>&nbsp;<span class="ident" id="3182410">k</span><span class="op" id="3182411">--</span>&nbsp;<span class="op" id="3182414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3182419">ip</span><span class="op" id="3182421">[</span><span class="ident" id="3182422">k</span><span class="op" id="3182423">+</span><span class="ident" id="3182424">n</span><span class="op" id="3182425">]</span>&nbsp;<span class="op" id="3182427">=</span>&nbsp;<span class="ident" id="3182429">ip</span><span class="op" id="3182431">[</span><span class="ident" id="3182432">k</span><span class="op" id="3182433">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182441">for</span>&nbsp;<span class="ident" id="3182445">k</span>&nbsp;<span class="op" id="3182447">:=</span>&nbsp;<span class="ident" id="3182450">ellipsis</span>&nbsp;<span class="op" id="3182459">+</span>&nbsp;<span class="ident" id="3182461">n</span>&nbsp;<span class="op" id="3182463">-</span>&nbsp;<span class="num" id="3182465">1</span><span class="op" id="3182466">;</span>&nbsp;<span class="ident" id="3182468">k</span>&nbsp;<span class="op" id="3182470">&gt;=</span>&nbsp;<span class="ident" id="3182473">ellipsis</span><span class="op" id="3182481">;</span>&nbsp;<span class="ident" id="3182483">k</span><span class="op" id="3182484">--</span>&nbsp;<span class="op" id="3182487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3182492">ip</span><span class="op" id="3182494">[</span><span class="ident" id="3182495">k</span><span class="op" id="3182496">]</span>&nbsp;<span class="op" id="3182498">=</span>&nbsp;<span class="num" id="3182500">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182507">}</span>&nbsp;<span class="keyword" id="3182509">else</span>&nbsp;<span class="keyword" id="3182514">if</span>&nbsp;<span class="ident" id="3182517">ellipsis</span>&nbsp;<span class="op" id="3182526">&gt;=</span>&nbsp;<span class="num" id="3182529">0</span>&nbsp;<span class="op" id="3182531">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3182535">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182586">return</span>&nbsp;<span class="ident" id="3182593">nil</span><span class="op" id="3182596">,</span>&nbsp;<span class="ident" id="3182598">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3182604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182607">return</span>&nbsp;<span class="ident" id="3182614">ip</span><span class="op" id="3182616">,</span>&nbsp;<span class="ident" id="3182618">zone</span><br>
<span class="lineno"></span><span class="op" id="3182623">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3182626">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="3182719">type</span>&nbsp;<span class="ident" id="3182724">ParseError</span>&nbsp;<span class="keyword" id="3182735">struct</span>&nbsp;<span class="op" id="3182742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3182745">Type</span>&nbsp;<span class="builtintype" id="3182750">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3182758">Text</span>&nbsp;<span class="builtintype" id="3182763">string</span><br>
<span class="lineno">640</span><span class="op" id="3182770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3182773">func</span>&nbsp;<span class="op" id="3182778">(</span><span class="ident" id="3182779">e</span>&nbsp;<span class="op" id="3182781">*</span><span class="ident" id="3182782">ParseError</span><span class="op" id="3182792">)</span>&nbsp;<span class="ident" id="3182794">Error</span><span class="op" id="3182799">(</span><span class="op" id="3182800">)</span>&nbsp;<span class="builtintype" id="3182802">string</span>&nbsp;<span class="op" id="3182809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3182812">return</span>&nbsp;<span class="string" id="3182819">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="3182830">+</span>&nbsp;<span class="ident" id="3182832">e</span><span class="op" id="3182833">.</span><span class="ident" id="3182834">Type</span>&nbsp;<span class="op" id="3182839">+</span>&nbsp;<span class="string" id="3182841">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3182846">+</span>&nbsp;<span class="ident" id="3182848">e</span><span class="op" id="3182849">.</span><span class="ident" id="3182850">Text</span><br>
<span class="lineno"></span><span class="op" id="3182855">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="3182858">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="3182918">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3182976">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="3183018">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="3183082">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3183106">func</span>&nbsp;<span class="ident" id="3183111">ParseIP</span><span class="op" id="3183118">(</span><span class="ident" id="3183119">s</span>&nbsp;<span class="builtintype" id="3183121">string</span><span class="op" id="3183127">)</span>&nbsp;<span class="ident" id="3183129">IP</span>&nbsp;<span class="op" id="3183132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183135">for</span>&nbsp;<span class="ident" id="3183139">i</span>&nbsp;<span class="op" id="3183141">:=</span>&nbsp;<span class="num" id="3183144">0</span><span class="op" id="3183145">;</span>&nbsp;<span class="ident" id="3183147">i</span>&nbsp;<span class="op" id="3183149">&lt;</span>&nbsp;<span class="builtinfunc" id="3183151">len</span><span class="op" id="3183154">(</span><span class="ident" id="3183155">s</span><span class="op" id="3183156">)</span><span class="op" id="3183157">;</span>&nbsp;<span class="ident" id="3183159">i</span><span class="op" id="3183160">++</span>&nbsp;<span class="op" id="3183163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183167">switch</span>&nbsp;<span class="ident" id="3183174">s</span><span class="op" id="3183175">[</span><span class="ident" id="3183176">i</span><span class="op" id="3183177">]</span>&nbsp;<span class="op" id="3183179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183183">case</span>&nbsp;<span class="string" id="3183188">&#39;.&#39;</span><span class="op" id="3183191">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183196">return</span>&nbsp;<span class="ident" id="3183203">parseIPv4</span><span class="op" id="3183212">(</span><span class="ident" id="3183213">s</span><span class="op" id="3183214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183218">case</span>&nbsp;<span class="string" id="3183223">&#39;:&#39;</span><span class="op" id="3183226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3183231">ip</span><span class="op" id="3183233">,</span>&nbsp;<span class="ident" id="3183235">_</span>&nbsp;<span class="op" id="3183237">:=</span>&nbsp;<span class="ident" id="3183240">parseIPv6</span><span class="op" id="3183249">(</span><span class="ident" id="3183250">s</span><span class="op" id="3183251">,</span>&nbsp;<span class="builtintype" id="3183253">false</span><span class="op" id="3183258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183263">return</span>&nbsp;<span class="ident" id="3183270">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3183275">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3183278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183281">return</span>&nbsp;<span class="ident" id="3183288">nil</span><br>
<span class="lineno"></span><span class="op" id="3183292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3183295">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="3183357">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3183418">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3183444">//</span><br>
<span class="lineno"></span><span class="comment" id="3183447">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3183510">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="3183575">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="3183639">func</span>&nbsp;<span class="ident" id="3183644">ParseCIDR</span><span class="op" id="3183653">(</span><span class="ident" id="3183654">s</span>&nbsp;<span class="builtintype" id="3183656">string</span><span class="op" id="3183662">)</span>&nbsp;<span class="op" id="3183664">(</span><span class="ident" id="3183665">IP</span><span class="op" id="3183667">,</span>&nbsp;<span class="op" id="3183669">*</span><span class="ident" id="3183670">IPNet</span><span class="op" id="3183675">,</span>&nbsp;<span class="builtintype" id="3183677">error</span><span class="op" id="3183682">)</span>&nbsp;<span class="op" id="3183684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3183687">i</span>&nbsp;<span class="op" id="3183689">:=</span>&nbsp;<span class="ident" id="3183692">byteIndex</span><span class="op" id="3183701">(</span><span class="ident" id="3183702">s</span><span class="op" id="3183703">,</span>&nbsp;<span class="string" id="3183705">&#39;/&#39;</span><span class="op" id="3183708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183711">if</span>&nbsp;<span class="ident" id="3183714">i</span>&nbsp;<span class="op" id="3183716">&lt;</span>&nbsp;<span class="num" id="3183718">0</span>&nbsp;<span class="op" id="3183720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183724">return</span>&nbsp;<span class="ident" id="3183731">nil</span><span class="op" id="3183734">,</span>&nbsp;<span class="ident" id="3183736">nil</span><span class="op" id="3183739">,</span>&nbsp;<span class="op" id="3183741">&amp;</span><span class="ident" id="3183742">ParseError</span><span class="op" id="3183752">{</span><span class="string" id="3183753">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3183767">,</span>&nbsp;<span class="ident" id="3183769">s</span><span class="op" id="3183770">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3183773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3183776">addr</span><span class="op" id="3183780">,</span>&nbsp;<span class="ident" id="3183782">mask</span>&nbsp;<span class="op" id="3183787">:=</span>&nbsp;<span class="ident" id="3183790">s</span><span class="op" id="3183791">[</span><span class="op" id="3183792">:</span><span class="ident" id="3183793">i</span><span class="op" id="3183794">]</span><span class="op" id="3183795">,</span>&nbsp;<span class="ident" id="3183797">s</span><span class="op" id="3183798">[</span><span class="ident" id="3183799">i</span><span class="op" id="3183800">+</span><span class="num" id="3183801">1</span><span class="op" id="3183802">:</span><span class="op" id="3183803">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3183806">iplen</span>&nbsp;<span class="op" id="3183812">:=</span>&nbsp;<span class="ident" id="3183815">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3183824">ip</span>&nbsp;<span class="op" id="3183827">:=</span>&nbsp;<span class="ident" id="3183830">parseIPv4</span><span class="op" id="3183839">(</span><span class="ident" id="3183840">addr</span><span class="op" id="3183844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183847">if</span>&nbsp;<span class="ident" id="3183850">ip</span>&nbsp;<span class="op" id="3183853">==</span>&nbsp;<span class="ident" id="3183856">nil</span>&nbsp;<span class="op" id="3183860">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3183864">iplen</span>&nbsp;<span class="op" id="3183870">=</span>&nbsp;<span class="ident" id="3183872">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3183882">ip</span><span class="op" id="3183884">,</span>&nbsp;<span class="ident" id="3183886">_</span>&nbsp;<span class="op" id="3183888">=</span>&nbsp;<span class="ident" id="3183890">parseIPv6</span><span class="op" id="3183899">(</span><span class="ident" id="3183900">addr</span><span class="op" id="3183904">,</span>&nbsp;<span class="builtintype" id="3183906">false</span><span class="op" id="3183911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3183914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3183917">n</span><span class="op" id="3183918">,</span>&nbsp;<span class="ident" id="3183920">i</span><span class="op" id="3183921">,</span>&nbsp;<span class="ident" id="3183923">ok</span>&nbsp;<span class="op" id="3183926">:=</span>&nbsp;<span class="ident" id="3183929">dtoi</span><span class="op" id="3183933">(</span><span class="ident" id="3183934">mask</span><span class="op" id="3183938">,</span>&nbsp;<span class="num" id="3183940">0</span><span class="op" id="3183941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3183944">if</span>&nbsp;<span class="ident" id="3183947">ip</span>&nbsp;<span class="op" id="3183950">==</span>&nbsp;<span class="ident" id="3183953">nil</span>&nbsp;<span class="op" id="3183957">||</span>&nbsp;<span class="op" id="3183960">!</span><span class="ident" id="3183961">ok</span>&nbsp;<span class="op" id="3183964">||</span>&nbsp;<span class="ident" id="3183967">i</span>&nbsp;<span class="op" id="3183969">!=</span>&nbsp;<span class="builtinfunc" id="3183972">len</span><span class="op" id="3183975">(</span><span class="ident" id="3183976">mask</span><span class="op" id="3183980">)</span>&nbsp;<span class="op" id="3183982">||</span>&nbsp;<span class="ident" id="3183985">n</span>&nbsp;<span class="op" id="3183987">&lt;</span>&nbsp;<span class="num" id="3183989">0</span>&nbsp;<span class="op" id="3183991">||</span>&nbsp;<span class="ident" id="3183994">n</span>&nbsp;<span class="op" id="3183996">&gt;</span>&nbsp;<span class="num" id="3183998">8</span><span class="op" id="3183999">*</span><span class="ident" id="3184000">iplen</span>&nbsp;<span class="op" id="3184006">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3184010">return</span>&nbsp;<span class="ident" id="3184017">nil</span><span class="op" id="3184020">,</span>&nbsp;<span class="ident" id="3184022">nil</span><span class="op" id="3184025">,</span>&nbsp;<span class="op" id="3184027">&amp;</span><span class="ident" id="3184028">ParseError</span><span class="op" id="3184038">{</span><span class="string" id="3184039">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3184053">,</span>&nbsp;<span class="ident" id="3184055">s</span><span class="op" id="3184056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3184059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3184062">m</span>&nbsp;<span class="op" id="3184064">:=</span>&nbsp;<span class="ident" id="3184067">CIDRMask</span><span class="op" id="3184075">(</span><span class="ident" id="3184076">n</span><span class="op" id="3184077">,</span>&nbsp;<span class="num" id="3184079">8</span><span class="op" id="3184080">*</span><span class="ident" id="3184081">iplen</span><span class="op" id="3184086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3184089">return</span>&nbsp;<span class="ident" id="3184096">ip</span><span class="op" id="3184098">,</span>&nbsp;<span class="op" id="3184100">&amp;</span><span class="ident" id="3184101">IPNet</span><span class="op" id="3184106">{</span><span class="ident" id="3184107">IP</span><span class="op" id="3184109">:</span>&nbsp;<span class="ident" id="3184111">ip</span><span class="op" id="3184113">.</span><span class="ident" id="3184114">Mask</span><span class="op" id="3184118">(</span><span class="ident" id="3184119">m</span><span class="op" id="3184120">)</span><span class="op" id="3184121">,</span>&nbsp;<span class="ident" id="3184123">Mask</span><span class="op" id="3184127">:</span>&nbsp;<span class="ident" id="3184129">m</span><span class="op" id="3184130">}</span><span class="op" id="3184131">,</span>&nbsp;<span class="ident" id="3184133">nil</span><br>
<span class="lineno"></span><span class="op" id="3184137">}</span>
</div>
</body>
</html>
