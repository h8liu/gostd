<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html" class="current">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3152669">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3152724">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3152778">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3152829">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3152894">package</span>&nbsp;<span class="ident" id="3152902">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3152907">import</span>&nbsp;<span class="op" id="3152914">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3152917">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3152923">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3152933">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3152936">func</span>&nbsp;<span class="ident" id="3152941">newFileFD</span><span class="op" id="3152950">(</span><span class="ident" id="3152951">f</span>&nbsp;<span class="op" id="3152953">*</span><span class="ident" id="3152954">os</span><span class="op" id="3152956">.</span><span class="ident" id="3152957">File</span><span class="op" id="3152961">)</span>&nbsp;<span class="op" id="3152963">(</span><span class="op" id="3152964">*</span><span class="ident" id="3152965">netFD</span><span class="op" id="3152970">,</span>&nbsp;<span class="builtintype" id="3152972">error</span><span class="op" id="3152977">)</span>&nbsp;<span class="op" id="3152979">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152982">fd</span><span class="op" id="3152984">,</span>&nbsp;<span class="ident" id="3152986">err</span>&nbsp;<span class="op" id="3152990">:=</span>&nbsp;<span class="ident" id="3152993">dupCloseOnExec</span><span class="op" id="3153007">(</span><span class="builtintype" id="3153008">int</span><span class="op" id="3153011">(</span><span class="ident" id="3153012">f</span><span class="op" id="3153013">.</span><span class="ident" id="3153014">Fd</span><span class="op" id="3153016">(</span><span class="op" id="3153017">)</span><span class="op" id="3153018">)</span><span class="op" id="3153019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153022">if</span>&nbsp;<span class="ident" id="3153025">err</span>&nbsp;<span class="op" id="3153029">!=</span>&nbsp;<span class="ident" id="3153032">nil</span>&nbsp;<span class="op" id="3153036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153040">return</span>&nbsp;<span class="ident" id="3153047">nil</span><span class="op" id="3153050">,</span>&nbsp;<span class="ident" id="3153052">os</span><span class="op" id="3153054">.</span><span class="ident" id="3153055">NewSyscallError</span><span class="op" id="3153070">(</span><span class="string" id="3153071">&#34;dup&#34;</span><span class="op" id="3153076">,</span>&nbsp;<span class="ident" id="3153078">err</span><span class="op" id="3153081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153088">if</span>&nbsp;<span class="ident" id="3153091">err</span>&nbsp;<span class="op" id="3153095">=</span>&nbsp;<span class="ident" id="3153097">syscall</span><span class="op" id="3153104">.</span><span class="ident" id="3153105">SetNonblock</span><span class="op" id="3153116">(</span><span class="ident" id="3153117">fd</span><span class="op" id="3153119">,</span>&nbsp;<span class="builtintype" id="3153121">true</span><span class="op" id="3153125">)</span><span class="op" id="3153126">;</span>&nbsp;<span class="ident" id="3153128">err</span>&nbsp;<span class="op" id="3153132">!=</span>&nbsp;<span class="ident" id="3153135">nil</span>&nbsp;<span class="op" id="3153139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153143">closesocket</span><span class="op" id="3153154">(</span><span class="ident" id="3153155">fd</span><span class="op" id="3153157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153161">return</span>&nbsp;<span class="ident" id="3153168">nil</span><span class="op" id="3153171">,</span>&nbsp;<span class="ident" id="3153173">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153182">sotype</span><span class="op" id="3153188">,</span>&nbsp;<span class="ident" id="3153190">err</span>&nbsp;<span class="op" id="3153194">:=</span>&nbsp;<span class="ident" id="3153197">syscall</span><span class="op" id="3153204">.</span><span class="ident" id="3153205">GetsockoptInt</span><span class="op" id="3153218">(</span><span class="ident" id="3153219">fd</span><span class="op" id="3153221">,</span>&nbsp;<span class="ident" id="3153223">syscall</span><span class="op" id="3153230">.</span><span class="ident" id="3153231">SOL_SOCKET</span><span class="op" id="3153241">,</span>&nbsp;<span class="ident" id="3153243">syscall</span><span class="op" id="3153250">.</span><span class="ident" id="3153251">SO_TYPE</span><span class="op" id="3153258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153261">if</span>&nbsp;<span class="ident" id="3153264">err</span>&nbsp;<span class="op" id="3153268">!=</span>&nbsp;<span class="ident" id="3153271">nil</span>&nbsp;<span class="op" id="3153275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153279">closesocket</span><span class="op" id="3153290">(</span><span class="ident" id="3153291">fd</span><span class="op" id="3153293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153297">return</span>&nbsp;<span class="ident" id="3153304">nil</span><span class="op" id="3153307">,</span>&nbsp;<span class="ident" id="3153309">os</span><span class="op" id="3153311">.</span><span class="ident" id="3153312">NewSyscallError</span><span class="op" id="3153327">(</span><span class="string" id="3153328">&#34;getsockopt&#34;</span><span class="op" id="3153340">,</span>&nbsp;<span class="ident" id="3153342">err</span><span class="op" id="3153345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153348">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153352">family</span>&nbsp;<span class="op" id="3153359">:=</span>&nbsp;<span class="ident" id="3153362">syscall</span><span class="op" id="3153369">.</span><span class="ident" id="3153370">AF_UNSPEC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153381">toAddr</span>&nbsp;<span class="op" id="3153388">:=</span>&nbsp;<span class="ident" id="3153391">sockaddrToTCP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153406">lsa</span><span class="op" id="3153409">,</span>&nbsp;<span class="ident" id="3153411">_</span>&nbsp;<span class="op" id="3153413">:=</span>&nbsp;<span class="ident" id="3153416">syscall</span><span class="op" id="3153423">.</span><span class="ident" id="3153424">Getsockname</span><span class="op" id="3153435">(</span><span class="ident" id="3153436">fd</span><span class="op" id="3153438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153441">switch</span>&nbsp;<span class="ident" id="3153448">lsa</span><span class="op" id="3153451">.</span><span class="op" id="3153452">(</span><span class="keyword" id="3153453">type</span><span class="op" id="3153457">)</span>&nbsp;<span class="op" id="3153459">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153462">default</span><span class="op" id="3153469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153473">closesocket</span><span class="op" id="3153484">(</span><span class="ident" id="3153485">fd</span><span class="op" id="3153487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153491">return</span>&nbsp;<span class="ident" id="3153498">nil</span><span class="op" id="3153501">,</span>&nbsp;<span class="ident" id="3153503">syscall</span><span class="op" id="3153510">.</span><span class="ident" id="3153511">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153519">case</span>&nbsp;<span class="op" id="3153524">*</span><span class="ident" id="3153525">syscall</span><span class="op" id="3153532">.</span><span class="ident" id="3153533">SockaddrInet4</span><span class="op" id="3153546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153550">family</span>&nbsp;<span class="op" id="3153557">=</span>&nbsp;<span class="ident" id="3153559">syscall</span><span class="op" id="3153566">.</span><span class="ident" id="3153567">AF_INET</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153577">if</span>&nbsp;<span class="ident" id="3153580">sotype</span>&nbsp;<span class="op" id="3153587">==</span>&nbsp;<span class="ident" id="3153590">syscall</span><span class="op" id="3153597">.</span><span class="ident" id="3153598">SOCK_DGRAM</span>&nbsp;<span class="op" id="3153609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153614">toAddr</span>&nbsp;<span class="op" id="3153621">=</span>&nbsp;<span class="ident" id="3153623">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153639">}</span>&nbsp;<span class="keyword" id="3153641">else</span>&nbsp;<span class="keyword" id="3153646">if</span>&nbsp;<span class="ident" id="3153649">sotype</span>&nbsp;<span class="op" id="3153656">==</span>&nbsp;<span class="ident" id="3153659">syscall</span><span class="op" id="3153666">.</span><span class="ident" id="3153667">SOCK_RAW</span>&nbsp;<span class="op" id="3153676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153681">toAddr</span>&nbsp;<span class="op" id="3153688">=</span>&nbsp;<span class="ident" id="3153690">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153705">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153708">case</span>&nbsp;<span class="op" id="3153713">*</span><span class="ident" id="3153714">syscall</span><span class="op" id="3153721">.</span><span class="ident" id="3153722">SockaddrInet6</span><span class="op" id="3153735">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153739">family</span>&nbsp;<span class="op" id="3153746">=</span>&nbsp;<span class="ident" id="3153748">syscall</span><span class="op" id="3153755">.</span><span class="ident" id="3153756">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153767">if</span>&nbsp;<span class="ident" id="3153770">sotype</span>&nbsp;<span class="op" id="3153777">==</span>&nbsp;<span class="ident" id="3153780">syscall</span><span class="op" id="3153787">.</span><span class="ident" id="3153788">SOCK_DGRAM</span>&nbsp;<span class="op" id="3153799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153804">toAddr</span>&nbsp;<span class="op" id="3153811">=</span>&nbsp;<span class="ident" id="3153813">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153829">}</span>&nbsp;<span class="keyword" id="3153831">else</span>&nbsp;<span class="keyword" id="3153836">if</span>&nbsp;<span class="ident" id="3153839">sotype</span>&nbsp;<span class="op" id="3153846">==</span>&nbsp;<span class="ident" id="3153849">syscall</span><span class="op" id="3153856">.</span><span class="ident" id="3153857">SOCK_RAW</span>&nbsp;<span class="op" id="3153866">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153871">toAddr</span>&nbsp;<span class="op" id="3153878">=</span>&nbsp;<span class="ident" id="3153880">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153898">case</span>&nbsp;<span class="op" id="3153903">*</span><span class="ident" id="3153904">syscall</span><span class="op" id="3153911">.</span><span class="ident" id="3153912">SockaddrUnix</span><span class="op" id="3153924">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153928">family</span>&nbsp;<span class="op" id="3153935">=</span>&nbsp;<span class="ident" id="3153937">syscall</span><span class="op" id="3153944">.</span><span class="ident" id="3153945">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153955">toAddr</span>&nbsp;<span class="op" id="3153962">=</span>&nbsp;<span class="ident" id="3153964">sockaddrToUnix</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153981">if</span>&nbsp;<span class="ident" id="3153984">sotype</span>&nbsp;<span class="op" id="3153991">==</span>&nbsp;<span class="ident" id="3153994">syscall</span><span class="op" id="3154001">.</span><span class="ident" id="3154002">SOCK_DGRAM</span>&nbsp;<span class="op" id="3154013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154018">toAddr</span>&nbsp;<span class="op" id="3154025">=</span>&nbsp;<span class="ident" id="3154027">sockaddrToUnixgram</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154048">}</span>&nbsp;<span class="keyword" id="3154050">else</span>&nbsp;<span class="keyword" id="3154055">if</span>&nbsp;<span class="ident" id="3154058">sotype</span>&nbsp;<span class="op" id="3154065">==</span>&nbsp;<span class="ident" id="3154068">syscall</span><span class="op" id="3154075">.</span><span class="ident" id="3154076">SOCK_SEQPACKET</span>&nbsp;<span class="op" id="3154091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154096">toAddr</span>&nbsp;<span class="op" id="3154103">=</span>&nbsp;<span class="ident" id="3154105">sockaddrToUnixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154128">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154134">laddr</span>&nbsp;<span class="op" id="3154140">:=</span>&nbsp;<span class="ident" id="3154143">toAddr</span><span class="op" id="3154149">(</span><span class="ident" id="3154150">lsa</span><span class="op" id="3154153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154156">rsa</span><span class="op" id="3154159">,</span>&nbsp;<span class="ident" id="3154161">_</span>&nbsp;<span class="op" id="3154163">:=</span>&nbsp;<span class="ident" id="3154166">syscall</span><span class="op" id="3154173">.</span><span class="ident" id="3154174">Getpeername</span><span class="op" id="3154185">(</span><span class="ident" id="3154186">fd</span><span class="op" id="3154188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154191">raddr</span>&nbsp;<span class="op" id="3154197">:=</span>&nbsp;<span class="ident" id="3154200">toAddr</span><span class="op" id="3154206">(</span><span class="ident" id="3154207">rsa</span><span class="op" id="3154210">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154214">netfd</span><span class="op" id="3154219">,</span>&nbsp;<span class="ident" id="3154221">err</span>&nbsp;<span class="op" id="3154225">:=</span>&nbsp;<span class="ident" id="3154228">newFD</span><span class="op" id="3154233">(</span><span class="ident" id="3154234">fd</span><span class="op" id="3154236">,</span>&nbsp;<span class="ident" id="3154238">family</span><span class="op" id="3154244">,</span>&nbsp;<span class="ident" id="3154246">sotype</span><span class="op" id="3154252">,</span>&nbsp;<span class="ident" id="3154254">laddr</span><span class="op" id="3154259">.</span><span class="ident" id="3154260">Network</span><span class="op" id="3154267">(</span><span class="op" id="3154268">)</span><span class="op" id="3154269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154272">if</span>&nbsp;<span class="ident" id="3154275">err</span>&nbsp;<span class="op" id="3154279">!=</span>&nbsp;<span class="ident" id="3154282">nil</span>&nbsp;<span class="op" id="3154286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154290">closesocket</span><span class="op" id="3154301">(</span><span class="ident" id="3154302">fd</span><span class="op" id="3154304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154308">return</span>&nbsp;<span class="ident" id="3154315">nil</span><span class="op" id="3154318">,</span>&nbsp;<span class="ident" id="3154320">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154325">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154328">if</span>&nbsp;<span class="ident" id="3154331">err</span>&nbsp;<span class="op" id="3154335">:=</span>&nbsp;<span class="ident" id="3154338">netfd</span><span class="op" id="3154343">.</span><span class="ident" id="3154344">init</span><span class="op" id="3154348">(</span><span class="op" id="3154349">)</span><span class="op" id="3154350">;</span>&nbsp;<span class="ident" id="3154352">err</span>&nbsp;<span class="op" id="3154356">!=</span>&nbsp;<span class="ident" id="3154359">nil</span>&nbsp;<span class="op" id="3154363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154367">netfd</span><span class="op" id="3154372">.</span><span class="ident" id="3154373">Close</span><span class="op" id="3154378">(</span><span class="op" id="3154379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154383">return</span>&nbsp;<span class="ident" id="3154390">nil</span><span class="op" id="3154393">,</span>&nbsp;<span class="ident" id="3154395">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154403">netfd</span><span class="op" id="3154408">.</span><span class="ident" id="3154409">setAddr</span><span class="op" id="3154416">(</span><span class="ident" id="3154417">laddr</span><span class="op" id="3154422">,</span>&nbsp;<span class="ident" id="3154424">raddr</span><span class="op" id="3154429">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154432">return</span>&nbsp;<span class="ident" id="3154439">netfd</span><span class="op" id="3154444">,</span>&nbsp;<span class="ident" id="3154446">nil</span><br>
<span class="lineno"></span><span class="op" id="3154450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3154453">//&nbsp;FileConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;connection&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3154523">//&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when</span><br>
<span class="lineno">80</span><span class="comment" id="3154594">//&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3154660">//&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3154673">func</span>&nbsp;<span class="ident" id="3154678">FileConn</span><span class="op" id="3154686">(</span><span class="ident" id="3154687">f</span>&nbsp;<span class="op" id="3154689">*</span><span class="ident" id="3154690">os</span><span class="op" id="3154692">.</span><span class="ident" id="3154693">File</span><span class="op" id="3154697">)</span>&nbsp;<span class="op" id="3154699">(</span><span class="ident" id="3154700">c</span>&nbsp;<span class="ident" id="3154702">Conn</span><span class="op" id="3154706">,</span>&nbsp;<span class="ident" id="3154708">err</span>&nbsp;<span class="builtintype" id="3154712">error</span><span class="op" id="3154717">)</span>&nbsp;<span class="op" id="3154719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154722">fd</span><span class="op" id="3154724">,</span>&nbsp;<span class="ident" id="3154726">err</span>&nbsp;<span class="op" id="3154730">:=</span>&nbsp;<span class="ident" id="3154733">newFileFD</span><span class="op" id="3154742">(</span><span class="ident" id="3154743">f</span><span class="op" id="3154744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154747">if</span>&nbsp;<span class="ident" id="3154750">err</span>&nbsp;<span class="op" id="3154754">!=</span>&nbsp;<span class="ident" id="3154757">nil</span>&nbsp;<span class="op" id="3154761">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154765">return</span>&nbsp;<span class="ident" id="3154772">nil</span><span class="op" id="3154775">,</span>&nbsp;<span class="ident" id="3154777">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154785">switch</span>&nbsp;<span class="ident" id="3154792">fd</span><span class="op" id="3154794">.</span><span class="ident" id="3154795">laddr</span><span class="op" id="3154800">.</span><span class="op" id="3154801">(</span><span class="keyword" id="3154802">type</span><span class="op" id="3154806">)</span>&nbsp;<span class="op" id="3154808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154811">case</span>&nbsp;<span class="op" id="3154816">*</span><span class="ident" id="3154817">TCPAddr</span><span class="op" id="3154824">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154828">return</span>&nbsp;<span class="ident" id="3154835">newTCPConn</span><span class="op" id="3154845">(</span><span class="ident" id="3154846">fd</span><span class="op" id="3154848">)</span><span class="op" id="3154849">,</span>&nbsp;<span class="ident" id="3154851">nil</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154856">case</span>&nbsp;<span class="op" id="3154861">*</span><span class="ident" id="3154862">UDPAddr</span><span class="op" id="3154869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154873">return</span>&nbsp;<span class="ident" id="3154880">newUDPConn</span><span class="op" id="3154890">(</span><span class="ident" id="3154891">fd</span><span class="op" id="3154893">)</span><span class="op" id="3154894">,</span>&nbsp;<span class="ident" id="3154896">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154901">case</span>&nbsp;<span class="op" id="3154906">*</span><span class="ident" id="3154907">IPAddr</span><span class="op" id="3154913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154917">return</span>&nbsp;<span class="ident" id="3154924">newIPConn</span><span class="op" id="3154933">(</span><span class="ident" id="3154934">fd</span><span class="op" id="3154936">)</span><span class="op" id="3154937">,</span>&nbsp;<span class="ident" id="3154939">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154944">case</span>&nbsp;<span class="op" id="3154949">*</span><span class="ident" id="3154950">UnixAddr</span><span class="op" id="3154958">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154962">return</span>&nbsp;<span class="ident" id="3154969">newUnixConn</span><span class="op" id="3154980">(</span><span class="ident" id="3154981">fd</span><span class="op" id="3154983">)</span><span class="op" id="3154984">,</span>&nbsp;<span class="ident" id="3154986">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154994">fd</span><span class="op" id="3154996">.</span><span class="ident" id="3154997">Close</span><span class="op" id="3155002">(</span><span class="op" id="3155003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155006">return</span>&nbsp;<span class="ident" id="3155013">nil</span><span class="op" id="3155016">,</span>&nbsp;<span class="ident" id="3155018">syscall</span><span class="op" id="3155025">.</span><span class="ident" id="3155026">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3155033">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3155036">//&nbsp;FileListener&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;listener&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3155105">//&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;l</span><br>
<span class="lineno"></span><span class="comment" id="3155174">//&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3155245">//&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">105</span><span class="keyword" id="3155258">func</span>&nbsp;<span class="ident" id="3155263">FileListener</span><span class="op" id="3155275">(</span><span class="ident" id="3155276">f</span>&nbsp;<span class="op" id="3155278">*</span><span class="ident" id="3155279">os</span><span class="op" id="3155281">.</span><span class="ident" id="3155282">File</span><span class="op" id="3155286">)</span>&nbsp;<span class="op" id="3155288">(</span><span class="ident" id="3155289">l</span>&nbsp;<span class="ident" id="3155291">Listener</span><span class="op" id="3155299">,</span>&nbsp;<span class="ident" id="3155301">err</span>&nbsp;<span class="builtintype" id="3155305">error</span><span class="op" id="3155310">)</span>&nbsp;<span class="op" id="3155312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155315">fd</span><span class="op" id="3155317">,</span>&nbsp;<span class="ident" id="3155319">err</span>&nbsp;<span class="op" id="3155323">:=</span>&nbsp;<span class="ident" id="3155326">newFileFD</span><span class="op" id="3155335">(</span><span class="ident" id="3155336">f</span><span class="op" id="3155337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155340">if</span>&nbsp;<span class="ident" id="3155343">err</span>&nbsp;<span class="op" id="3155347">!=</span>&nbsp;<span class="ident" id="3155350">nil</span>&nbsp;<span class="op" id="3155354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155358">return</span>&nbsp;<span class="ident" id="3155365">nil</span><span class="op" id="3155368">,</span>&nbsp;<span class="ident" id="3155370">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3155375">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155378">switch</span>&nbsp;<span class="ident" id="3155385">laddr</span>&nbsp;<span class="op" id="3155391">:=</span>&nbsp;<span class="ident" id="3155394">fd</span><span class="op" id="3155396">.</span><span class="ident" id="3155397">laddr</span><span class="op" id="3155402">.</span><span class="op" id="3155403">(</span><span class="keyword" id="3155404">type</span><span class="op" id="3155408">)</span>&nbsp;<span class="op" id="3155410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155413">case</span>&nbsp;<span class="op" id="3155418">*</span><span class="ident" id="3155419">TCPAddr</span><span class="op" id="3155426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155430">return</span>&nbsp;<span class="op" id="3155437">&amp;</span><span class="ident" id="3155438">TCPListener</span><span class="op" id="3155449">{</span><span class="ident" id="3155450">fd</span><span class="op" id="3155452">}</span><span class="op" id="3155453">,</span>&nbsp;<span class="ident" id="3155455">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155460">case</span>&nbsp;<span class="op" id="3155465">*</span><span class="ident" id="3155466">UnixAddr</span><span class="op" id="3155474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155478">return</span>&nbsp;<span class="op" id="3155485">&amp;</span><span class="ident" id="3155486">UnixListener</span><span class="op" id="3155498">{</span><span class="ident" id="3155499">fd</span><span class="op" id="3155501">,</span>&nbsp;<span class="ident" id="3155503">laddr</span><span class="op" id="3155508">.</span><span class="ident" id="3155509">Name</span><span class="op" id="3155513">}</span><span class="op" id="3155514">,</span>&nbsp;<span class="ident" id="3155516">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3155521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155524">fd</span><span class="op" id="3155526">.</span><span class="ident" id="3155527">Close</span><span class="op" id="3155532">(</span><span class="op" id="3155533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155536">return</span>&nbsp;<span class="ident" id="3155543">nil</span><span class="op" id="3155546">,</span>&nbsp;<span class="ident" id="3155548">syscall</span><span class="op" id="3155555">.</span><span class="ident" id="3155556">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3155563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3155566">//&nbsp;FilePacketConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;packet&nbsp;network&nbsp;connection</span><br>
<span class="lineno"></span><span class="comment" id="3155632">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3155689">//&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect</span><br>
<span class="lineno"></span><span class="comment" id="3155760">//&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3155799">func</span>&nbsp;<span class="ident" id="3155804">FilePacketConn</span><span class="op" id="3155818">(</span><span class="ident" id="3155819">f</span>&nbsp;<span class="op" id="3155821">*</span><span class="ident" id="3155822">os</span><span class="op" id="3155824">.</span><span class="ident" id="3155825">File</span><span class="op" id="3155829">)</span>&nbsp;<span class="op" id="3155831">(</span><span class="ident" id="3155832">c</span>&nbsp;<span class="ident" id="3155834">PacketConn</span><span class="op" id="3155844">,</span>&nbsp;<span class="ident" id="3155846">err</span>&nbsp;<span class="builtintype" id="3155850">error</span><span class="op" id="3155855">)</span>&nbsp;<span class="op" id="3155857">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155860">fd</span><span class="op" id="3155862">,</span>&nbsp;<span class="ident" id="3155864">err</span>&nbsp;<span class="op" id="3155868">:=</span>&nbsp;<span class="ident" id="3155871">newFileFD</span><span class="op" id="3155880">(</span><span class="ident" id="3155881">f</span><span class="op" id="3155882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155885">if</span>&nbsp;<span class="ident" id="3155888">err</span>&nbsp;<span class="op" id="3155892">!=</span>&nbsp;<span class="ident" id="3155895">nil</span>&nbsp;<span class="op" id="3155899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155903">return</span>&nbsp;<span class="ident" id="3155910">nil</span><span class="op" id="3155913">,</span>&nbsp;<span class="ident" id="3155915">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3155920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155923">switch</span>&nbsp;<span class="ident" id="3155930">fd</span><span class="op" id="3155932">.</span><span class="ident" id="3155933">laddr</span><span class="op" id="3155938">.</span><span class="op" id="3155939">(</span><span class="keyword" id="3155940">type</span><span class="op" id="3155944">)</span>&nbsp;<span class="op" id="3155946">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155949">case</span>&nbsp;<span class="op" id="3155954">*</span><span class="ident" id="3155955">UDPAddr</span><span class="op" id="3155962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155966">return</span>&nbsp;<span class="ident" id="3155973">newUDPConn</span><span class="op" id="3155983">(</span><span class="ident" id="3155984">fd</span><span class="op" id="3155986">)</span><span class="op" id="3155987">,</span>&nbsp;<span class="ident" id="3155989">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155994">case</span>&nbsp;<span class="op" id="3155999">*</span><span class="ident" id="3156000">IPAddr</span><span class="op" id="3156006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156010">return</span>&nbsp;<span class="ident" id="3156017">newIPConn</span><span class="op" id="3156026">(</span><span class="ident" id="3156027">fd</span><span class="op" id="3156029">)</span><span class="op" id="3156030">,</span>&nbsp;<span class="ident" id="3156032">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156037">case</span>&nbsp;<span class="op" id="3156042">*</span><span class="ident" id="3156043">UnixAddr</span><span class="op" id="3156051">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156055">return</span>&nbsp;<span class="ident" id="3156062">newUnixConn</span><span class="op" id="3156073">(</span><span class="ident" id="3156074">fd</span><span class="op" id="3156076">)</span><span class="op" id="3156077">,</span>&nbsp;<span class="ident" id="3156079">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156087">fd</span><span class="op" id="3156089">.</span><span class="ident" id="3156090">Close</span><span class="op" id="3156095">(</span><span class="op" id="3156096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156099">return</span>&nbsp;<span class="ident" id="3156106">nil</span><span class="op" id="3156109">,</span>&nbsp;<span class="ident" id="3156111">syscall</span><span class="op" id="3156118">.</span><span class="ident" id="3156119">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3156126">}</span>
</div>
</body>
</html>
