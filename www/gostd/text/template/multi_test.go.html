<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6922996">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6923051">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6923105">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6923156">package</span>&nbsp;<span class="ident" id="6923164">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6923174">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6923229">import</span>&nbsp;<span class="op" id="6923236">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6923239">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6923248">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6923255">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6923266">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6923277">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6923299">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6923302">const</span>&nbsp;<span class="op" id="6923308">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923311">noError</span>&nbsp;&nbsp;<span class="op" id="6923320">=</span>&nbsp;<span class="builtintype" id="6923322">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923328">hasError</span>&nbsp;<span class="op" id="6923337">=</span>&nbsp;<span class="builtintype" id="6923339">false</span><br>
<span class="lineno">20</span><span class="op" id="6923345">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6923348">type</span>&nbsp;<span class="ident" id="6923353">multiParseTest</span>&nbsp;<span class="keyword" id="6923368">struct</span>&nbsp;<span class="op" id="6923375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923378">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6923386">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923394">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6923402">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923410">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6923418">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923424">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6923432">[</span><span class="op" id="6923433">]</span><span class="builtintype" id="6923434">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923442">results</span>&nbsp;<span class="op" id="6923450">[</span><span class="op" id="6923451">]</span><span class="builtintype" id="6923452">string</span><br>
<span class="lineno"></span><span class="op" id="6923459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="6923462">var</span>&nbsp;<span class="ident" id="6923466">multiParseTests</span>&nbsp;<span class="op" id="6923482">=</span>&nbsp;<span class="op" id="6923484">[</span><span class="op" id="6923485">]</span><span class="ident" id="6923486">multiParseTest</span><span class="op" id="6923500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923503">{</span><span class="string" id="6923504">&#34;empty&#34;</span><span class="op" id="6923511">,</span>&nbsp;<span class="string" id="6923513">&#34;&#34;</span><span class="op" id="6923515">,</span>&nbsp;<span class="ident" id="6923517">noError</span><span class="op" id="6923524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923528">nil</span><span class="op" id="6923531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923535">nil</span><span class="op" id="6923538">}</span><span class="op" id="6923539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923542">{</span><span class="string" id="6923543">&#34;one&#34;</span><span class="op" id="6923548">,</span>&nbsp;<span class="string" id="6923550">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="6923580">,</span>&nbsp;<span class="ident" id="6923582">noError</span><span class="op" id="6923589">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923593">[</span><span class="op" id="6923594">]</span><span class="builtintype" id="6923595">string</span><span class="op" id="6923601">{</span><span class="string" id="6923602">&#34;foo&#34;</span><span class="op" id="6923607">}</span><span class="op" id="6923608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923612">[</span><span class="op" id="6923613">]</span><span class="builtintype" id="6923614">string</span><span class="op" id="6923620">{</span><span class="string" id="6923621">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="6923628">}</span><span class="op" id="6923629">}</span><span class="op" id="6923630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923633">{</span><span class="string" id="6923634">&#34;two&#34;</span><span class="op" id="6923639">,</span>&nbsp;<span class="string" id="6923641">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="6923699">,</span>&nbsp;<span class="ident" id="6923701">noError</span><span class="op" id="6923708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923712">[</span><span class="op" id="6923713">]</span><span class="builtintype" id="6923714">string</span><span class="op" id="6923720">{</span><span class="string" id="6923721">&#34;foo&#34;</span><span class="op" id="6923726">,</span>&nbsp;<span class="string" id="6923728">&#34;bar&#34;</span><span class="op" id="6923733">}</span><span class="op" id="6923734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923738">[</span><span class="op" id="6923739">]</span><span class="builtintype" id="6923740">string</span><span class="op" id="6923746">{</span><span class="string" id="6923747">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="6923754">,</span>&nbsp;<span class="string" id="6923756">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="6923763">}</span><span class="op" id="6923764">}</span><span class="op" id="6923765">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6923768">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923779">{</span><span class="string" id="6923780">&#34;missing&nbsp;end&#34;</span><span class="op" id="6923793">,</span>&nbsp;<span class="string" id="6923795">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="6923818">,</span>&nbsp;<span class="ident" id="6923820">hasError</span><span class="op" id="6923828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923832">nil</span><span class="op" id="6923835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923839">nil</span><span class="op" id="6923842">}</span><span class="op" id="6923843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6923846">{</span><span class="string" id="6923847">&#34;malformed&nbsp;name&#34;</span><span class="op" id="6923863">,</span>&nbsp;<span class="string" id="6923865">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="6923887">,</span>&nbsp;<span class="ident" id="6923889">hasError</span><span class="op" id="6923897">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923901">nil</span><span class="op" id="6923904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923908">nil</span><span class="op" id="6923911">}</span><span class="op" id="6923912">,</span><br>
<span class="lineno"></span><span class="op" id="6923914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6923917">func</span>&nbsp;<span class="ident" id="6923922">TestMultiParse</span><span class="op" id="6923936">(</span><span class="ident" id="6923937">t</span>&nbsp;<span class="op" id="6923939">*</span><span class="ident" id="6923940">testing</span><span class="op" id="6923947">.</span><span class="ident" id="6923948">T</span><span class="op" id="6923949">)</span>&nbsp;<span class="op" id="6923951">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6923954">for</span>&nbsp;<span class="ident" id="6923958">_</span><span class="op" id="6923959">,</span>&nbsp;<span class="ident" id="6923961">test</span>&nbsp;<span class="op" id="6923966">:=</span>&nbsp;<span class="keyword" id="6923969">range</span>&nbsp;<span class="ident" id="6923975">multiParseTests</span>&nbsp;<span class="op" id="6923991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6923995">template</span><span class="op" id="6924003">,</span>&nbsp;<span class="ident" id="6924005">err</span>&nbsp;<span class="op" id="6924009">:=</span>&nbsp;<span class="ident" id="6924012">New</span><span class="op" id="6924015">(</span><span class="string" id="6924016">&#34;root&#34;</span><span class="op" id="6924022">)</span><span class="op" id="6924023">.</span><span class="ident" id="6924024">Parse</span><span class="op" id="6924029">(</span><span class="ident" id="6924030">test</span><span class="op" id="6924034">.</span><span class="ident" id="6924035">input</span><span class="op" id="6924040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924044">switch</span>&nbsp;<span class="op" id="6924051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924055">case</span>&nbsp;<span class="ident" id="6924060">err</span>&nbsp;<span class="op" id="6924064">==</span>&nbsp;<span class="ident" id="6924067">nil</span>&nbsp;<span class="op" id="6924071">&amp;&amp;</span>&nbsp;<span class="op" id="6924074">!</span><span class="ident" id="6924075">test</span><span class="op" id="6924079">.</span><span class="ident" id="6924080">ok</span><span class="op" id="6924082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6924087">t</span><span class="op" id="6924088">.</span><span class="ident" id="6924089">Errorf</span><span class="op" id="6924095">(</span><span class="string" id="6924096">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6924126">,</span>&nbsp;<span class="ident" id="6924128">test</span><span class="op" id="6924132">.</span><span class="ident" id="6924133">name</span><span class="op" id="6924137">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924142">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924153">case</span>&nbsp;<span class="ident" id="6924158">err</span>&nbsp;<span class="op" id="6924162">!=</span>&nbsp;<span class="ident" id="6924165">nil</span>&nbsp;<span class="op" id="6924169">&amp;&amp;</span>&nbsp;<span class="ident" id="6924172">test</span><span class="op" id="6924176">.</span><span class="ident" id="6924177">ok</span><span class="op" id="6924179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6924184">t</span><span class="op" id="6924185">.</span><span class="ident" id="6924186">Errorf</span><span class="op" id="6924192">(</span><span class="string" id="6924193">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6924219">,</span>&nbsp;<span class="ident" id="6924221">test</span><span class="op" id="6924225">.</span><span class="ident" id="6924226">name</span><span class="op" id="6924230">,</span>&nbsp;<span class="ident" id="6924232">err</span><span class="op" id="6924235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924240">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924251">case</span>&nbsp;<span class="ident" id="6924256">err</span>&nbsp;<span class="op" id="6924260">!=</span>&nbsp;<span class="ident" id="6924263">nil</span>&nbsp;<span class="op" id="6924267">&amp;&amp;</span>&nbsp;<span class="op" id="6924270">!</span><span class="ident" id="6924271">test</span><span class="op" id="6924275">.</span><span class="ident" id="6924276">ok</span><span class="op" id="6924278">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6924283">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924313">if</span>&nbsp;<span class="op" id="6924316">*</span><span class="ident" id="6924317">debug</span>&nbsp;<span class="op" id="6924323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6924329">fmt</span><span class="op" id="6924332">.</span><span class="ident" id="6924333">Printf</span><span class="op" id="6924339">(</span><span class="string" id="6924340">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="6924356">,</span>&nbsp;<span class="ident" id="6924358">test</span><span class="op" id="6924362">.</span><span class="ident" id="6924363">name</span><span class="op" id="6924367">,</span>&nbsp;<span class="ident" id="6924369">test</span><span class="op" id="6924373">.</span><span class="ident" id="6924374">input</span><span class="op" id="6924379">,</span>&nbsp;<span class="ident" id="6924381">err</span><span class="op" id="6924384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6924389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924394">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6924405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924409">if</span>&nbsp;<span class="ident" id="6924412">template</span>&nbsp;<span class="op" id="6924421">==</span>&nbsp;<span class="ident" id="6924424">nil</span>&nbsp;<span class="op" id="6924428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924433">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6924444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924448">if</span>&nbsp;<span class="builtinfunc" id="6924451">len</span><span class="op" id="6924454">(</span><span class="ident" id="6924455">template</span><span class="op" id="6924463">.</span><span class="ident" id="6924464">tmpl</span><span class="op" id="6924468">)</span>&nbsp;<span class="op" id="6924470">!=</span>&nbsp;<span class="builtinfunc" id="6924473">len</span><span class="op" id="6924476">(</span><span class="ident" id="6924477">test</span><span class="op" id="6924481">.</span><span class="ident" id="6924482">names</span><span class="op" id="6924487">)</span><span class="op" id="6924488">+</span><span class="num" id="6924489">1</span>&nbsp;<span class="op" id="6924491">{</span>&nbsp;<span class="comment" id="6924493">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6924511">t</span><span class="op" id="6924512">.</span><span class="ident" id="6924513">Errorf</span><span class="op" id="6924519">(</span><span class="string" id="6924520">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6924569">,</span>&nbsp;<span class="ident" id="6924571">test</span><span class="op" id="6924575">.</span><span class="ident" id="6924576">name</span><span class="op" id="6924580">,</span>&nbsp;<span class="builtinfunc" id="6924582">len</span><span class="op" id="6924585">(</span><span class="ident" id="6924586">test</span><span class="op" id="6924590">.</span><span class="ident" id="6924591">names</span><span class="op" id="6924596">)</span><span class="op" id="6924597">,</span>&nbsp;<span class="builtinfunc" id="6924599">len</span><span class="op" id="6924602">(</span><span class="ident" id="6924603">template</span><span class="op" id="6924611">.</span><span class="ident" id="6924612">tmpl</span><span class="op" id="6924616">)</span><span class="op" id="6924617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924622">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6924633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924637">for</span>&nbsp;<span class="ident" id="6924641">i</span><span class="op" id="6924642">,</span>&nbsp;<span class="ident" id="6924644">name</span>&nbsp;<span class="op" id="6924649">:=</span>&nbsp;<span class="keyword" id="6924652">range</span>&nbsp;<span class="ident" id="6924658">test</span><span class="op" id="6924662">.</span><span class="ident" id="6924663">names</span>&nbsp;<span class="op" id="6924669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6924674">tmpl</span><span class="op" id="6924678">,</span>&nbsp;<span class="ident" id="6924680">ok</span>&nbsp;<span class="op" id="6924683">:=</span>&nbsp;<span class="ident" id="6924686">template</span><span class="op" id="6924694">.</span><span class="ident" id="6924695">tmpl</span><span class="op" id="6924699">[</span><span class="ident" id="6924700">name</span><span class="op" id="6924704">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924709">if</span>&nbsp;<span class="op" id="6924712">!</span><span class="ident" id="6924713">ok</span>&nbsp;<span class="op" id="6924716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6924722">t</span><span class="op" id="6924723">.</span><span class="ident" id="6924724">Errorf</span><span class="op" id="6924730">(</span><span class="string" id="6924731">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="6924759">,</span>&nbsp;<span class="ident" id="6924761">test</span><span class="op" id="6924765">.</span><span class="ident" id="6924766">name</span><span class="op" id="6924770">,</span>&nbsp;<span class="ident" id="6924772">name</span><span class="op" id="6924776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924782">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6924794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6924799">result</span>&nbsp;<span class="op" id="6924806">:=</span>&nbsp;<span class="ident" id="6924809">tmpl</span><span class="op" id="6924813">.</span><span class="ident" id="6924814">Root</span><span class="op" id="6924818">.</span><span class="ident" id="6924819">String</span><span class="op" id="6924825">(</span><span class="op" id="6924826">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6924831">if</span>&nbsp;<span class="ident" id="6924834">result</span>&nbsp;<span class="op" id="6924841">!=</span>&nbsp;<span class="ident" id="6924844">test</span><span class="op" id="6924848">.</span><span class="ident" id="6924849">results</span><span class="op" id="6924856">[</span><span class="ident" id="6924857">i</span><span class="op" id="6924858">]</span>&nbsp;<span class="op" id="6924860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6924866">t</span><span class="op" id="6924867">.</span><span class="ident" id="6924868">Errorf</span><span class="op" id="6924874">(</span><span class="string" id="6924875">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="6924911">,</span>&nbsp;<span class="ident" id="6924913">test</span><span class="op" id="6924917">.</span><span class="ident" id="6924918">name</span><span class="op" id="6924922">,</span>&nbsp;<span class="ident" id="6924924">test</span><span class="op" id="6924928">.</span><span class="ident" id="6924929">input</span><span class="op" id="6924934">,</span>&nbsp;<span class="ident" id="6924936">result</span><span class="op" id="6924942">,</span>&nbsp;<span class="ident" id="6924944">test</span><span class="op" id="6924948">.</span><span class="ident" id="6924949">results</span><span class="op" id="6924956">[</span><span class="ident" id="6924957">i</span><span class="op" id="6924958">]</span><span class="op" id="6924959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6924964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6924968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6924971">}</span><br>
<span class="lineno">85</span><span class="op" id="6924973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6924976">var</span>&nbsp;<span class="ident" id="6924980">multiExecTests</span>&nbsp;<span class="op" id="6924995">=</span>&nbsp;<span class="op" id="6924997">[</span><span class="op" id="6924998">]</span><span class="ident" id="6924999">execTest</span><span class="op" id="6925007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925010">{</span><span class="string" id="6925011">&#34;empty&#34;</span><span class="op" id="6925018">,</span>&nbsp;<span class="string" id="6925020">&#34;&#34;</span><span class="op" id="6925022">,</span>&nbsp;<span class="string" id="6925024">&#34;&#34;</span><span class="op" id="6925026">,</span>&nbsp;<span class="ident" id="6925028">nil</span><span class="op" id="6925031">,</span>&nbsp;<span class="builtintype" id="6925033">true</span><span class="op" id="6925037">}</span><span class="op" id="6925038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925041">{</span><span class="string" id="6925042">&#34;text&#34;</span><span class="op" id="6925048">,</span>&nbsp;<span class="string" id="6925050">&#34;some&nbsp;text&#34;</span><span class="op" id="6925061">,</span>&nbsp;<span class="string" id="6925063">&#34;some&nbsp;text&#34;</span><span class="op" id="6925074">,</span>&nbsp;<span class="ident" id="6925076">nil</span><span class="op" id="6925079">,</span>&nbsp;<span class="builtintype" id="6925081">true</span><span class="op" id="6925085">}</span><span class="op" id="6925086">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925089">{</span><span class="string" id="6925090">&#34;invoke&nbsp;x&#34;</span><span class="op" id="6925100">,</span>&nbsp;<span class="string" id="6925102">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="6925124">,</span>&nbsp;<span class="string" id="6925126">&#34;TEXT&#34;</span><span class="op" id="6925132">,</span>&nbsp;<span class="ident" id="6925134">tVal</span><span class="op" id="6925138">,</span>&nbsp;<span class="builtintype" id="6925140">true</span><span class="op" id="6925144">}</span><span class="op" id="6925145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925148">{</span><span class="string" id="6925149">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="6925167">,</span>&nbsp;<span class="string" id="6925169">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="6925187">,</span>&nbsp;<span class="string" id="6925189">&#34;TEXT&#34;</span><span class="op" id="6925195">,</span>&nbsp;<span class="ident" id="6925197">tVal</span><span class="op" id="6925201">,</span>&nbsp;<span class="builtintype" id="6925203">true</span><span class="op" id="6925207">}</span><span class="op" id="6925208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925211">{</span><span class="string" id="6925212">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="6925228">,</span>&nbsp;<span class="string" id="6925230">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="6925253">,</span>&nbsp;<span class="string" id="6925255">&#34;17&#34;</span><span class="op" id="6925259">,</span>&nbsp;<span class="ident" id="6925261">tVal</span><span class="op" id="6925265">,</span>&nbsp;<span class="builtintype" id="6925267">true</span><span class="op" id="6925271">}</span><span class="op" id="6925272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925275">{</span><span class="string" id="6925276">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="6925294">,</span>&nbsp;<span class="string" id="6925296">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="6925320">,</span>&nbsp;<span class="string" id="6925322">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="6925331">,</span>&nbsp;<span class="ident" id="6925333">tVal</span><span class="op" id="6925337">,</span>&nbsp;<span class="builtintype" id="6925339">true</span><span class="op" id="6925343">}</span><span class="op" id="6925344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925347">{</span><span class="string" id="6925348">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="6925361">,</span>&nbsp;<span class="string" id="6925363">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="6925387">,</span>&nbsp;<span class="string" id="6925389">&#34;v&#34;</span><span class="op" id="6925392">,</span>&nbsp;<span class="ident" id="6925394">tVal</span><span class="op" id="6925398">,</span>&nbsp;<span class="builtintype" id="6925400">true</span><span class="op" id="6925404">}</span><span class="op" id="6925405">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925408">{</span><span class="string" id="6925409">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="6925428">,</span>&nbsp;<span class="string" id="6925430">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="6925456">,</span>&nbsp;<span class="string" id="6925458">&#34;17&#34;</span><span class="op" id="6925462">,</span>&nbsp;<span class="ident" id="6925464">tVal</span><span class="op" id="6925468">,</span>&nbsp;<span class="builtintype" id="6925470">true</span><span class="op" id="6925474">}</span><span class="op" id="6925475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925478">{</span><span class="string" id="6925479">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="6925510">,</span>&nbsp;<span class="string" id="6925512">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="6925558">,</span>&nbsp;<span class="string" id="6925560">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="6925571">,</span>&nbsp;<span class="ident" id="6925573">tVal</span><span class="op" id="6925577">,</span>&nbsp;<span class="builtintype" id="6925579">true</span><span class="op" id="6925583">}</span><span class="op" id="6925584">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6925588">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925640">{</span><span class="string" id="6925641">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="6925659">,</span>&nbsp;<span class="string" id="6925661">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="6925679">,</span>&nbsp;<span class="string" id="6925681">&#34;oneArg=joe&#34;</span><span class="op" id="6925693">,</span>&nbsp;<span class="ident" id="6925695">tVal</span><span class="op" id="6925699">,</span>&nbsp;<span class="builtintype" id="6925701">true</span><span class="op" id="6925705">}</span><span class="op" id="6925706">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6925709">{</span><span class="string" id="6925710">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="6925722">,</span>&nbsp;<span class="string" id="6925724">`{{oneArg&nbsp;.}}`</span><span class="op" id="6925738">,</span>&nbsp;<span class="string" id="6925740">&#34;oneArg=joe&#34;</span><span class="op" id="6925752">,</span>&nbsp;<span class="string" id="6925754">&#34;joe&#34;</span><span class="op" id="6925759">,</span>&nbsp;<span class="builtintype" id="6925761">true</span><span class="op" id="6925765">}</span><span class="op" id="6925766">,</span><br>
<span class="lineno"></span><span class="op" id="6925768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6925771">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="6925812">const</span>&nbsp;<span class="ident" id="6925818">multiText1</span>&nbsp;<span class="op" id="6925829">=</span>&nbsp;<span class="string" id="6925831">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6925895">const</span>&nbsp;<span class="ident" id="6925901">multiText2</span>&nbsp;<span class="op" id="6925912">=</span>&nbsp;<span class="string" id="6925914">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6925997">func</span>&nbsp;<span class="ident" id="6926002">TestMultiExecute</span><span class="op" id="6926018">(</span><span class="ident" id="6926019">t</span>&nbsp;<span class="op" id="6926021">*</span><span class="ident" id="6926022">testing</span><span class="op" id="6926029">.</span><span class="ident" id="6926030">T</span><span class="op" id="6926031">)</span>&nbsp;<span class="op" id="6926033">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6926036">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926077">template</span><span class="op" id="6926085">,</span>&nbsp;<span class="ident" id="6926087">err</span>&nbsp;<span class="op" id="6926091">:=</span>&nbsp;<span class="ident" id="6926094">New</span><span class="op" id="6926097">(</span><span class="string" id="6926098">&#34;root&#34;</span><span class="op" id="6926104">)</span><span class="op" id="6926105">.</span><span class="ident" id="6926106">Parse</span><span class="op" id="6926111">(</span><span class="ident" id="6926112">multiText1</span><span class="op" id="6926122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926125">if</span>&nbsp;<span class="ident" id="6926128">err</span>&nbsp;<span class="op" id="6926132">!=</span>&nbsp;<span class="ident" id="6926135">nil</span>&nbsp;<span class="op" id="6926139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926143">t</span><span class="op" id="6926144">.</span><span class="ident" id="6926145">Fatalf</span><span class="op" id="6926151">(</span><span class="string" id="6926152">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="6926175">,</span>&nbsp;<span class="ident" id="6926177">err</span><span class="op" id="6926180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926183">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926186">_</span><span class="op" id="6926187">,</span>&nbsp;<span class="ident" id="6926189">err</span>&nbsp;<span class="op" id="6926193">=</span>&nbsp;<span class="ident" id="6926195">template</span><span class="op" id="6926203">.</span><span class="ident" id="6926204">Parse</span><span class="op" id="6926209">(</span><span class="ident" id="6926210">multiText2</span><span class="op" id="6926220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926223">if</span>&nbsp;<span class="ident" id="6926226">err</span>&nbsp;<span class="op" id="6926230">!=</span>&nbsp;<span class="ident" id="6926233">nil</span>&nbsp;<span class="op" id="6926237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926241">t</span><span class="op" id="6926242">.</span><span class="ident" id="6926243">Fatalf</span><span class="op" id="6926249">(</span><span class="string" id="6926250">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="6926273">,</span>&nbsp;<span class="ident" id="6926275">err</span><span class="op" id="6926278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926284">testExecute</span><span class="op" id="6926295">(</span><span class="ident" id="6926296">multiExecTests</span><span class="op" id="6926310">,</span>&nbsp;<span class="ident" id="6926312">template</span><span class="op" id="6926320">,</span>&nbsp;<span class="ident" id="6926322">t</span><span class="op" id="6926323">)</span><br>
<span class="lineno">125</span><span class="op" id="6926325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6926328">func</span>&nbsp;<span class="ident" id="6926333">TestParseFiles</span><span class="op" id="6926347">(</span><span class="ident" id="6926348">t</span>&nbsp;<span class="op" id="6926350">*</span><span class="ident" id="6926351">testing</span><span class="op" id="6926358">.</span><span class="ident" id="6926359">T</span><span class="op" id="6926360">)</span>&nbsp;<span class="op" id="6926362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926365">_</span><span class="op" id="6926366">,</span>&nbsp;<span class="ident" id="6926368">err</span>&nbsp;<span class="op" id="6926372">:=</span>&nbsp;<span class="ident" id="6926375">ParseFiles</span><span class="op" id="6926385">(</span><span class="string" id="6926386">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="6926402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926405">if</span>&nbsp;<span class="ident" id="6926408">err</span>&nbsp;<span class="op" id="6926412">==</span>&nbsp;<span class="ident" id="6926415">nil</span>&nbsp;<span class="op" id="6926419">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926423">t</span><span class="op" id="6926424">.</span><span class="ident" id="6926425">Error</span><span class="op" id="6926430">(</span><span class="string" id="6926431">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6926479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926485">template</span>&nbsp;<span class="op" id="6926494">:=</span>&nbsp;<span class="ident" id="6926497">New</span><span class="op" id="6926500">(</span><span class="string" id="6926501">&#34;root&#34;</span><span class="op" id="6926507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926510">_</span><span class="op" id="6926511">,</span>&nbsp;<span class="ident" id="6926513">err</span>&nbsp;<span class="op" id="6926517">=</span>&nbsp;<span class="ident" id="6926519">template</span><span class="op" id="6926527">.</span><span class="ident" id="6926528">ParseFiles</span><span class="op" id="6926538">(</span><span class="string" id="6926539">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="6926560">,</span>&nbsp;<span class="string" id="6926562">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="6926583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926586">if</span>&nbsp;<span class="ident" id="6926589">err</span>&nbsp;<span class="op" id="6926593">!=</span>&nbsp;<span class="ident" id="6926596">nil</span>&nbsp;<span class="op" id="6926600">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926604">t</span><span class="op" id="6926605">.</span><span class="ident" id="6926606">Fatalf</span><span class="op" id="6926612">(</span><span class="string" id="6926613">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="6926638">,</span>&nbsp;<span class="ident" id="6926640">err</span><span class="op" id="6926643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926649">testExecute</span><span class="op" id="6926660">(</span><span class="ident" id="6926661">multiExecTests</span><span class="op" id="6926675">,</span>&nbsp;<span class="ident" id="6926677">template</span><span class="op" id="6926685">,</span>&nbsp;<span class="ident" id="6926687">t</span><span class="op" id="6926688">)</span><br>
<span class="lineno"></span><span class="op" id="6926690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="6926693">func</span>&nbsp;<span class="ident" id="6926698">TestParseGlob</span><span class="op" id="6926711">(</span><span class="ident" id="6926712">t</span>&nbsp;<span class="op" id="6926714">*</span><span class="ident" id="6926715">testing</span><span class="op" id="6926722">.</span><span class="ident" id="6926723">T</span><span class="op" id="6926724">)</span>&nbsp;<span class="op" id="6926726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926729">_</span><span class="op" id="6926730">,</span>&nbsp;<span class="ident" id="6926732">err</span>&nbsp;<span class="op" id="6926736">:=</span>&nbsp;<span class="ident" id="6926739">ParseGlob</span><span class="op" id="6926748">(</span><span class="string" id="6926749">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="6926765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926768">if</span>&nbsp;<span class="ident" id="6926771">err</span>&nbsp;<span class="op" id="6926775">==</span>&nbsp;<span class="ident" id="6926778">nil</span>&nbsp;<span class="op" id="6926782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926786">t</span><span class="op" id="6926787">.</span><span class="ident" id="6926788">Error</span><span class="op" id="6926793">(</span><span class="string" id="6926794">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6926842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926845">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926848">_</span><span class="op" id="6926849">,</span>&nbsp;<span class="ident" id="6926851">err</span>&nbsp;<span class="op" id="6926855">=</span>&nbsp;<span class="ident" id="6926857">New</span><span class="op" id="6926860">(</span><span class="string" id="6926861">&#34;error&#34;</span><span class="op" id="6926868">)</span><span class="op" id="6926869">.</span><span class="ident" id="6926870">ParseGlob</span><span class="op" id="6926879">(</span><span class="string" id="6926880">&#34;[x&#34;</span><span class="op" id="6926884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926887">if</span>&nbsp;<span class="ident" id="6926890">err</span>&nbsp;<span class="op" id="6926894">==</span>&nbsp;<span class="ident" id="6926897">nil</span>&nbsp;<span class="op" id="6926901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926905">t</span><span class="op" id="6926906">.</span><span class="ident" id="6926907">Error</span><span class="op" id="6926912">(</span><span class="string" id="6926913">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6926955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926961">template</span>&nbsp;<span class="op" id="6926970">:=</span>&nbsp;<span class="ident" id="6926973">New</span><span class="op" id="6926976">(</span><span class="string" id="6926977">&#34;root&#34;</span><span class="op" id="6926983">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926986">_</span><span class="op" id="6926987">,</span>&nbsp;<span class="ident" id="6926989">err</span>&nbsp;<span class="op" id="6926993">=</span>&nbsp;<span class="ident" id="6926995">template</span><span class="op" id="6927003">.</span><span class="ident" id="6927004">ParseGlob</span><span class="op" id="6927013">(</span><span class="string" id="6927014">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="6927035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927038">if</span>&nbsp;<span class="ident" id="6927041">err</span>&nbsp;<span class="op" id="6927045">!=</span>&nbsp;<span class="ident" id="6927048">nil</span>&nbsp;<span class="op" id="6927052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927056">t</span><span class="op" id="6927057">.</span><span class="ident" id="6927058">Fatalf</span><span class="op" id="6927064">(</span><span class="string" id="6927065">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="6927090">,</span>&nbsp;<span class="ident" id="6927092">err</span><span class="op" id="6927095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927101">testExecute</span><span class="op" id="6927112">(</span><span class="ident" id="6927113">multiExecTests</span><span class="op" id="6927127">,</span>&nbsp;<span class="ident" id="6927129">template</span><span class="op" id="6927137">,</span>&nbsp;<span class="ident" id="6927139">t</span><span class="op" id="6927140">)</span><br>
<span class="lineno">155</span><span class="op" id="6927142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6927145">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6927241">var</span>&nbsp;<span class="ident" id="6927245">templateFileExecTests</span>&nbsp;<span class="op" id="6927267">=</span>&nbsp;<span class="op" id="6927269">[</span><span class="op" id="6927270">]</span><span class="ident" id="6927271">execTest</span><span class="op" id="6927279">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927282">{</span><span class="string" id="6927283">&#34;test&#34;</span><span class="op" id="6927289">,</span>&nbsp;<span class="string" id="6927291">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="6927343">,</span>&nbsp;<span class="string" id="6927345">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="6927379">,</span>&nbsp;<span class="num" id="6927381">0</span><span class="op" id="6927382">,</span>&nbsp;<span class="builtintype" id="6927384">true</span><span class="op" id="6927388">}</span><span class="op" id="6927389">,</span><br>
<span class="lineno"></span><span class="op" id="6927391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6927394">func</span>&nbsp;<span class="ident" id="6927399">TestParseFilesWithData</span><span class="op" id="6927421">(</span><span class="ident" id="6927422">t</span>&nbsp;<span class="op" id="6927424">*</span><span class="ident" id="6927425">testing</span><span class="op" id="6927432">.</span><span class="ident" id="6927433">T</span><span class="op" id="6927434">)</span>&nbsp;<span class="op" id="6927436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927439">template</span><span class="op" id="6927447">,</span>&nbsp;<span class="ident" id="6927449">err</span>&nbsp;<span class="op" id="6927453">:=</span>&nbsp;<span class="ident" id="6927456">New</span><span class="op" id="6927459">(</span><span class="string" id="6927460">&#34;root&#34;</span><span class="op" id="6927466">)</span><span class="op" id="6927467">.</span><span class="ident" id="6927468">ParseFiles</span><span class="op" id="6927478">(</span><span class="string" id="6927479">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="6927500">,</span>&nbsp;<span class="string" id="6927502">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="6927523">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927526">if</span>&nbsp;<span class="ident" id="6927529">err</span>&nbsp;<span class="op" id="6927533">!=</span>&nbsp;<span class="ident" id="6927536">nil</span>&nbsp;<span class="op" id="6927540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927544">t</span><span class="op" id="6927545">.</span><span class="ident" id="6927546">Fatalf</span><span class="op" id="6927552">(</span><span class="string" id="6927553">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="6927578">,</span>&nbsp;<span class="ident" id="6927580">err</span><span class="op" id="6927583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927589">testExecute</span><span class="op" id="6927600">(</span><span class="ident" id="6927601">templateFileExecTests</span><span class="op" id="6927622">,</span>&nbsp;<span class="ident" id="6927624">template</span><span class="op" id="6927632">,</span>&nbsp;<span class="ident" id="6927634">t</span><span class="op" id="6927635">)</span><br>
<span class="lineno"></span><span class="op" id="6927637">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6927640">func</span>&nbsp;<span class="ident" id="6927645">TestParseGlobWithData</span><span class="op" id="6927666">(</span><span class="ident" id="6927667">t</span>&nbsp;<span class="op" id="6927669">*</span><span class="ident" id="6927670">testing</span><span class="op" id="6927677">.</span><span class="ident" id="6927678">T</span><span class="op" id="6927679">)</span>&nbsp;<span class="op" id="6927681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927684">template</span><span class="op" id="6927692">,</span>&nbsp;<span class="ident" id="6927694">err</span>&nbsp;<span class="op" id="6927698">:=</span>&nbsp;<span class="ident" id="6927701">New</span><span class="op" id="6927704">(</span><span class="string" id="6927705">&#34;root&#34;</span><span class="op" id="6927711">)</span><span class="op" id="6927712">.</span><span class="ident" id="6927713">ParseGlob</span><span class="op" id="6927722">(</span><span class="string" id="6927723">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="6927744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927747">if</span>&nbsp;<span class="ident" id="6927750">err</span>&nbsp;<span class="op" id="6927754">!=</span>&nbsp;<span class="ident" id="6927757">nil</span>&nbsp;<span class="op" id="6927761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927765">t</span><span class="op" id="6927766">.</span><span class="ident" id="6927767">Fatalf</span><span class="op" id="6927773">(</span><span class="string" id="6927774">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="6927799">,</span>&nbsp;<span class="ident" id="6927801">err</span><span class="op" id="6927804">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927810">testExecute</span><span class="op" id="6927821">(</span><span class="ident" id="6927822">templateFileExecTests</span><span class="op" id="6927843">,</span>&nbsp;<span class="ident" id="6927845">template</span><span class="op" id="6927853">,</span>&nbsp;<span class="ident" id="6927855">t</span><span class="op" id="6927856">)</span><br>
<span class="lineno"></span><span class="op" id="6927858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6927861">const</span>&nbsp;<span class="op" id="6927867">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927870">cloneText1</span>&nbsp;<span class="op" id="6927881">=</span>&nbsp;<span class="string" id="6927883">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927940">cloneText2</span>&nbsp;<span class="op" id="6927951">=</span>&nbsp;<span class="string" id="6927953">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927979">cloneText3</span>&nbsp;<span class="op" id="6927990">=</span>&nbsp;<span class="string" id="6927992">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928021">cloneText4</span>&nbsp;<span class="op" id="6928032">=</span>&nbsp;<span class="string" id="6928034">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="6928063">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="6928066">func</span>&nbsp;<span class="ident" id="6928071">TestClone</span><span class="op" id="6928080">(</span><span class="ident" id="6928081">t</span>&nbsp;<span class="op" id="6928083">*</span><span class="ident" id="6928084">testing</span><span class="op" id="6928091">.</span><span class="ident" id="6928092">T</span><span class="op" id="6928093">)</span>&nbsp;<span class="op" id="6928095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6928098">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928144">root</span><span class="op" id="6928148">,</span>&nbsp;<span class="ident" id="6928150">err</span>&nbsp;<span class="op" id="6928154">:=</span>&nbsp;<span class="ident" id="6928157">New</span><span class="op" id="6928160">(</span><span class="string" id="6928161">&#34;root&#34;</span><span class="op" id="6928167">)</span><span class="op" id="6928168">.</span><span class="ident" id="6928169">Parse</span><span class="op" id="6928174">(</span><span class="ident" id="6928175">cloneText1</span><span class="op" id="6928185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928188">if</span>&nbsp;<span class="ident" id="6928191">err</span>&nbsp;<span class="op" id="6928195">!=</span>&nbsp;<span class="ident" id="6928198">nil</span>&nbsp;<span class="op" id="6928202">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928206">t</span><span class="op" id="6928207">.</span><span class="ident" id="6928208">Fatal</span><span class="op" id="6928213">(</span><span class="ident" id="6928214">err</span><span class="op" id="6928217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928223">_</span><span class="op" id="6928224">,</span>&nbsp;<span class="ident" id="6928226">err</span>&nbsp;<span class="op" id="6928230">=</span>&nbsp;<span class="ident" id="6928232">root</span><span class="op" id="6928236">.</span><span class="ident" id="6928237">Parse</span><span class="op" id="6928242">(</span><span class="ident" id="6928243">cloneText2</span><span class="op" id="6928253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928256">if</span>&nbsp;<span class="ident" id="6928259">err</span>&nbsp;<span class="op" id="6928263">!=</span>&nbsp;<span class="ident" id="6928266">nil</span>&nbsp;<span class="op" id="6928270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928274">t</span><span class="op" id="6928275">.</span><span class="ident" id="6928276">Fatal</span><span class="op" id="6928281">(</span><span class="ident" id="6928282">err</span><span class="op" id="6928285">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928291">clone</span>&nbsp;<span class="op" id="6928297">:=</span>&nbsp;<span class="ident" id="6928300">Must</span><span class="op" id="6928304">(</span><span class="ident" id="6928305">root</span><span class="op" id="6928309">.</span><span class="ident" id="6928310">Clone</span><span class="op" id="6928315">(</span><span class="op" id="6928316">)</span><span class="op" id="6928317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6928320">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928346">_</span><span class="op" id="6928347">,</span>&nbsp;<span class="ident" id="6928349">err</span>&nbsp;<span class="op" id="6928353">=</span>&nbsp;<span class="ident" id="6928355">root</span><span class="op" id="6928359">.</span><span class="ident" id="6928360">Parse</span><span class="op" id="6928365">(</span><span class="ident" id="6928366">cloneText3</span><span class="op" id="6928376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928379">if</span>&nbsp;<span class="ident" id="6928382">err</span>&nbsp;<span class="op" id="6928386">!=</span>&nbsp;<span class="ident" id="6928389">nil</span>&nbsp;<span class="op" id="6928393">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928397">t</span><span class="op" id="6928398">.</span><span class="ident" id="6928399">Fatal</span><span class="op" id="6928404">(</span><span class="ident" id="6928405">err</span><span class="op" id="6928408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928414">_</span><span class="op" id="6928415">,</span>&nbsp;<span class="ident" id="6928417">err</span>&nbsp;<span class="op" id="6928421">=</span>&nbsp;<span class="ident" id="6928423">clone</span><span class="op" id="6928428">.</span><span class="ident" id="6928429">Parse</span><span class="op" id="6928434">(</span><span class="ident" id="6928435">cloneText4</span><span class="op" id="6928445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928448">if</span>&nbsp;<span class="ident" id="6928451">err</span>&nbsp;<span class="op" id="6928455">!=</span>&nbsp;<span class="ident" id="6928458">nil</span>&nbsp;<span class="op" id="6928462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928466">t</span><span class="op" id="6928467">.</span><span class="ident" id="6928468">Fatal</span><span class="op" id="6928473">(</span><span class="ident" id="6928474">err</span><span class="op" id="6928477">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6928483">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928529">for</span>&nbsp;<span class="ident" id="6928533">k</span><span class="op" id="6928534">,</span>&nbsp;<span class="ident" id="6928536">v</span>&nbsp;<span class="op" id="6928538">:=</span>&nbsp;<span class="keyword" id="6928541">range</span>&nbsp;<span class="ident" id="6928547">clone</span><span class="op" id="6928552">.</span><span class="ident" id="6928553">tmpl</span>&nbsp;<span class="op" id="6928558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928562">if</span>&nbsp;<span class="ident" id="6928565">k</span>&nbsp;<span class="op" id="6928567">==</span>&nbsp;<span class="ident" id="6928570">clone</span><span class="op" id="6928575">.</span><span class="ident" id="6928576">name</span>&nbsp;<span class="op" id="6928581">&amp;&amp;</span>&nbsp;<span class="ident" id="6928584">v</span><span class="op" id="6928585">.</span><span class="ident" id="6928586">tmpl</span><span class="op" id="6928590">[</span><span class="ident" id="6928591">k</span><span class="op" id="6928592">]</span>&nbsp;<span class="op" id="6928594">!=</span>&nbsp;<span class="ident" id="6928597">clone</span>&nbsp;<span class="op" id="6928603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928608">t</span><span class="op" id="6928609">.</span><span class="ident" id="6928610">Error</span><span class="op" id="6928615">(</span><span class="string" id="6928616">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="6928645">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928653">if</span>&nbsp;<span class="ident" id="6928656">v</span>&nbsp;<span class="op" id="6928658">!=</span>&nbsp;<span class="ident" id="6928661">v</span><span class="op" id="6928662">.</span><span class="ident" id="6928663">tmpl</span><span class="op" id="6928667">[</span><span class="ident" id="6928668">v</span><span class="op" id="6928669">.</span><span class="ident" id="6928670">name</span><span class="op" id="6928674">]</span>&nbsp;<span class="op" id="6928676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928681">t</span><span class="op" id="6928682">.</span><span class="ident" id="6928683">Errorf</span><span class="op" id="6928689">(</span><span class="string" id="6928690">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="6928726">,</span>&nbsp;<span class="ident" id="6928728">k</span><span class="op" id="6928729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928736">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6928739">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928757">var</span>&nbsp;<span class="ident" id="6928761">b</span>&nbsp;<span class="ident" id="6928763">bytes</span><span class="op" id="6928768">.</span><span class="ident" id="6928769">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928777">err</span>&nbsp;<span class="op" id="6928781">=</span>&nbsp;<span class="ident" id="6928783">root</span><span class="op" id="6928787">.</span><span class="ident" id="6928788">ExecuteTemplate</span><span class="op" id="6928803">(</span><span class="op" id="6928804">&amp;</span><span class="ident" id="6928805">b</span><span class="op" id="6928806">,</span>&nbsp;<span class="string" id="6928808">&#34;a&#34;</span><span class="op" id="6928811">,</span>&nbsp;<span class="num" id="6928813">0</span><span class="op" id="6928814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928817">if</span>&nbsp;<span class="ident" id="6928820">err</span>&nbsp;<span class="op" id="6928824">!=</span>&nbsp;<span class="ident" id="6928827">nil</span>&nbsp;<span class="op" id="6928831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928835">t</span><span class="op" id="6928836">.</span><span class="ident" id="6928837">Fatal</span><span class="op" id="6928842">(</span><span class="ident" id="6928843">err</span><span class="op" id="6928846">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928852">if</span>&nbsp;<span class="ident" id="6928855">b</span><span class="op" id="6928856">.</span><span class="ident" id="6928857">String</span><span class="op" id="6928863">(</span><span class="op" id="6928864">)</span>&nbsp;<span class="op" id="6928866">!=</span>&nbsp;<span class="string" id="6928869">&#34;broot&#34;</span>&nbsp;<span class="op" id="6928877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928881">t</span><span class="op" id="6928882">.</span><span class="ident" id="6928883">Errorf</span><span class="op" id="6928889">(</span><span class="string" id="6928890">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6928910">,</span>&nbsp;<span class="string" id="6928912">&#34;broot&#34;</span><span class="op" id="6928919">,</span>&nbsp;<span class="ident" id="6928921">b</span><span class="op" id="6928922">.</span><span class="ident" id="6928923">String</span><span class="op" id="6928929">(</span><span class="op" id="6928930">)</span><span class="op" id="6928931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6928937">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928955">b</span><span class="op" id="6928956">.</span><span class="ident" id="6928957">Reset</span><span class="op" id="6928962">(</span><span class="op" id="6928963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928966">err</span>&nbsp;<span class="op" id="6928970">=</span>&nbsp;<span class="ident" id="6928972">clone</span><span class="op" id="6928977">.</span><span class="ident" id="6928978">ExecuteTemplate</span><span class="op" id="6928993">(</span><span class="op" id="6928994">&amp;</span><span class="ident" id="6928995">b</span><span class="op" id="6928996">,</span>&nbsp;<span class="string" id="6928998">&#34;a&#34;</span><span class="op" id="6929001">,</span>&nbsp;<span class="num" id="6929003">0</span><span class="op" id="6929004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929007">if</span>&nbsp;<span class="ident" id="6929010">err</span>&nbsp;<span class="op" id="6929014">!=</span>&nbsp;<span class="ident" id="6929017">nil</span>&nbsp;<span class="op" id="6929021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929025">t</span><span class="op" id="6929026">.</span><span class="ident" id="6929027">Fatal</span><span class="op" id="6929032">(</span><span class="ident" id="6929033">err</span><span class="op" id="6929036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929039">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929042">if</span>&nbsp;<span class="ident" id="6929045">b</span><span class="op" id="6929046">.</span><span class="ident" id="6929047">String</span><span class="op" id="6929053">(</span><span class="op" id="6929054">)</span>&nbsp;<span class="op" id="6929056">!=</span>&nbsp;<span class="string" id="6929059">&#34;bclone&#34;</span>&nbsp;<span class="op" id="6929068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929072">t</span><span class="op" id="6929073">.</span><span class="ident" id="6929074">Errorf</span><span class="op" id="6929080">(</span><span class="string" id="6929081">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6929101">,</span>&nbsp;<span class="string" id="6929103">&#34;bclone&#34;</span><span class="op" id="6929111">,</span>&nbsp;<span class="ident" id="6929113">b</span><span class="op" id="6929114">.</span><span class="ident" id="6929115">String</span><span class="op" id="6929121">(</span><span class="op" id="6929122">)</span><span class="op" id="6929123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929126">}</span><br>
<span class="lineno"></span><span class="op" id="6929128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="6929131">func</span>&nbsp;<span class="ident" id="6929136">TestAddParseTree</span><span class="op" id="6929152">(</span><span class="ident" id="6929153">t</span>&nbsp;<span class="op" id="6929155">*</span><span class="ident" id="6929156">testing</span><span class="op" id="6929163">.</span><span class="ident" id="6929164">T</span><span class="op" id="6929165">)</span>&nbsp;<span class="op" id="6929167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6929170">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929197">root</span><span class="op" id="6929201">,</span>&nbsp;<span class="ident" id="6929203">err</span>&nbsp;<span class="op" id="6929207">:=</span>&nbsp;<span class="ident" id="6929210">New</span><span class="op" id="6929213">(</span><span class="string" id="6929214">&#34;root&#34;</span><span class="op" id="6929220">)</span><span class="op" id="6929221">.</span><span class="ident" id="6929222">Parse</span><span class="op" id="6929227">(</span><span class="ident" id="6929228">cloneText1</span><span class="op" id="6929238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929241">if</span>&nbsp;<span class="ident" id="6929244">err</span>&nbsp;<span class="op" id="6929248">!=</span>&nbsp;<span class="ident" id="6929251">nil</span>&nbsp;<span class="op" id="6929255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929259">t</span><span class="op" id="6929260">.</span><span class="ident" id="6929261">Fatal</span><span class="op" id="6929266">(</span><span class="ident" id="6929267">err</span><span class="op" id="6929270">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929276">_</span><span class="op" id="6929277">,</span>&nbsp;<span class="ident" id="6929279">err</span>&nbsp;<span class="op" id="6929283">=</span>&nbsp;<span class="ident" id="6929285">root</span><span class="op" id="6929289">.</span><span class="ident" id="6929290">Parse</span><span class="op" id="6929295">(</span><span class="ident" id="6929296">cloneText2</span><span class="op" id="6929306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929309">if</span>&nbsp;<span class="ident" id="6929312">err</span>&nbsp;<span class="op" id="6929316">!=</span>&nbsp;<span class="ident" id="6929319">nil</span>&nbsp;<span class="op" id="6929323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929327">t</span><span class="op" id="6929328">.</span><span class="ident" id="6929329">Fatal</span><span class="op" id="6929334">(</span><span class="ident" id="6929335">err</span><span class="op" id="6929338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929341">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6929344">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929370">tree</span><span class="op" id="6929374">,</span>&nbsp;<span class="ident" id="6929376">err</span>&nbsp;<span class="op" id="6929380">:=</span>&nbsp;<span class="ident" id="6929383">parse</span><span class="op" id="6929388">.</span><span class="ident" id="6929389">Parse</span><span class="op" id="6929394">(</span><span class="string" id="6929395">&#34;cloneText3&#34;</span><span class="op" id="6929407">,</span>&nbsp;<span class="ident" id="6929409">cloneText3</span><span class="op" id="6929419">,</span>&nbsp;<span class="string" id="6929421">&#34;&#34;</span><span class="op" id="6929423">,</span>&nbsp;<span class="string" id="6929425">&#34;&#34;</span><span class="op" id="6929427">,</span>&nbsp;<span class="ident" id="6929429">nil</span><span class="op" id="6929432">,</span>&nbsp;<span class="ident" id="6929434">builtins</span><span class="op" id="6929442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929445">if</span>&nbsp;<span class="ident" id="6929448">err</span>&nbsp;<span class="op" id="6929452">!=</span>&nbsp;<span class="ident" id="6929455">nil</span>&nbsp;<span class="op" id="6929459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929463">t</span><span class="op" id="6929464">.</span><span class="ident" id="6929465">Fatal</span><span class="op" id="6929470">(</span><span class="ident" id="6929471">err</span><span class="op" id="6929474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929477">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929480">added</span><span class="op" id="6929485">,</span>&nbsp;<span class="ident" id="6929487">err</span>&nbsp;<span class="op" id="6929491">:=</span>&nbsp;<span class="ident" id="6929494">root</span><span class="op" id="6929498">.</span><span class="ident" id="6929499">AddParseTree</span><span class="op" id="6929511">(</span><span class="string" id="6929512">&#34;c&#34;</span><span class="op" id="6929515">,</span>&nbsp;<span class="ident" id="6929517">tree</span><span class="op" id="6929521">[</span><span class="string" id="6929522">&#34;c&#34;</span><span class="op" id="6929525">]</span><span class="op" id="6929526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6929529">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929542">var</span>&nbsp;<span class="ident" id="6929546">b</span>&nbsp;<span class="ident" id="6929548">bytes</span><span class="op" id="6929553">.</span><span class="ident" id="6929554">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929562">err</span>&nbsp;<span class="op" id="6929566">=</span>&nbsp;<span class="ident" id="6929568">added</span><span class="op" id="6929573">.</span><span class="ident" id="6929574">ExecuteTemplate</span><span class="op" id="6929589">(</span><span class="op" id="6929590">&amp;</span><span class="ident" id="6929591">b</span><span class="op" id="6929592">,</span>&nbsp;<span class="string" id="6929594">&#34;a&#34;</span><span class="op" id="6929597">,</span>&nbsp;<span class="num" id="6929599">0</span><span class="op" id="6929600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929603">if</span>&nbsp;<span class="ident" id="6929606">err</span>&nbsp;<span class="op" id="6929610">!=</span>&nbsp;<span class="ident" id="6929613">nil</span>&nbsp;<span class="op" id="6929617">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929621">t</span><span class="op" id="6929622">.</span><span class="ident" id="6929623">Fatal</span><span class="op" id="6929628">(</span><span class="ident" id="6929629">err</span><span class="op" id="6929632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929638">if</span>&nbsp;<span class="ident" id="6929641">b</span><span class="op" id="6929642">.</span><span class="ident" id="6929643">String</span><span class="op" id="6929649">(</span><span class="op" id="6929650">)</span>&nbsp;<span class="op" id="6929652">!=</span>&nbsp;<span class="string" id="6929655">&#34;broot&#34;</span>&nbsp;<span class="op" id="6929663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929667">t</span><span class="op" id="6929668">.</span><span class="ident" id="6929669">Errorf</span><span class="op" id="6929675">(</span><span class="string" id="6929676">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6929696">,</span>&nbsp;<span class="string" id="6929698">&#34;broot&#34;</span><span class="op" id="6929705">,</span>&nbsp;<span class="ident" id="6929707">b</span><span class="op" id="6929708">.</span><span class="ident" id="6929709">String</span><span class="op" id="6929715">(</span><span class="op" id="6929716">)</span><span class="op" id="6929717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929720">}</span><br>
<span class="lineno">260</span><span class="op" id="6929722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6929725">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="6929739">func</span>&nbsp;<span class="ident" id="6929744">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="6929778">(</span><span class="ident" id="6929779">t</span>&nbsp;<span class="op" id="6929781">*</span><span class="ident" id="6929782">testing</span><span class="op" id="6929789">.</span><span class="ident" id="6929790">T</span><span class="op" id="6929791">)</span>&nbsp;<span class="op" id="6929793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929796">master</span>&nbsp;<span class="op" id="6929803">:=</span>&nbsp;<span class="string" id="6929806">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929838">tmpl</span>&nbsp;<span class="op" id="6929843">:=</span>&nbsp;<span class="ident" id="6929846">New</span><span class="op" id="6929849">(</span><span class="string" id="6929850">&#34;master&#34;</span><span class="op" id="6929858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929861">tree</span><span class="op" id="6929865">,</span>&nbsp;<span class="ident" id="6929867">err</span>&nbsp;<span class="op" id="6929871">:=</span>&nbsp;<span class="ident" id="6929874">parse</span><span class="op" id="6929879">.</span><span class="ident" id="6929880">Parse</span><span class="op" id="6929885">(</span><span class="string" id="6929886">&#34;master&#34;</span><span class="op" id="6929894">,</span>&nbsp;<span class="ident" id="6929896">master</span><span class="op" id="6929902">,</span>&nbsp;<span class="string" id="6929904">&#34;&#34;</span><span class="op" id="6929906">,</span>&nbsp;<span class="string" id="6929908">&#34;&#34;</span><span class="op" id="6929910">,</span>&nbsp;<span class="ident" id="6929912">nil</span><span class="op" id="6929915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929918">if</span>&nbsp;<span class="ident" id="6929921">err</span>&nbsp;<span class="op" id="6929925">!=</span>&nbsp;<span class="ident" id="6929928">nil</span>&nbsp;<span class="op" id="6929932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929936">t</span><span class="op" id="6929937">.</span><span class="ident" id="6929938">Fatalf</span><span class="op" id="6929944">(</span><span class="string" id="6929945">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="6929971">,</span>&nbsp;<span class="ident" id="6929973">err</span><span class="op" id="6929976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929979">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929982">masterTree</span>&nbsp;<span class="op" id="6929993">:=</span>&nbsp;<span class="ident" id="6929996">tree</span><span class="op" id="6930000">[</span><span class="string" id="6930001">&#34;master&#34;</span><span class="op" id="6930009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930012">tmpl</span><span class="op" id="6930016">.</span><span class="ident" id="6930017">AddParseTree</span><span class="op" id="6930029">(</span><span class="string" id="6930030">&#34;master&#34;</span><span class="op" id="6930038">,</span>&nbsp;<span class="ident" id="6930040">masterTree</span><span class="op" id="6930050">)</span>&nbsp;<span class="comment" id="6930052">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="6930069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6930072">func</span>&nbsp;<span class="ident" id="6930077">TestRedefinition</span><span class="op" id="6930093">(</span><span class="ident" id="6930094">t</span>&nbsp;<span class="op" id="6930096">*</span><span class="ident" id="6930097">testing</span><span class="op" id="6930104">.</span><span class="ident" id="6930105">T</span><span class="op" id="6930106">)</span>&nbsp;<span class="op" id="6930108">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930111">var</span>&nbsp;<span class="ident" id="6930115">tmpl</span>&nbsp;<span class="op" id="6930120">*</span><span class="ident" id="6930121">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930131">var</span>&nbsp;<span class="ident" id="6930135">err</span>&nbsp;<span class="builtintype" id="6930139">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930146">if</span>&nbsp;<span class="ident" id="6930149">tmpl</span><span class="op" id="6930153">,</span>&nbsp;<span class="ident" id="6930155">err</span>&nbsp;<span class="op" id="6930159">=</span>&nbsp;<span class="ident" id="6930161">New</span><span class="op" id="6930164">(</span><span class="string" id="6930165">&#34;tmpl1&#34;</span><span class="op" id="6930172">)</span><span class="op" id="6930173">.</span><span class="ident" id="6930174">Parse</span><span class="op" id="6930179">(</span><span class="string" id="6930180">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="6930209">)</span><span class="op" id="6930210">;</span>&nbsp;<span class="ident" id="6930212">err</span>&nbsp;<span class="op" id="6930216">!=</span>&nbsp;<span class="ident" id="6930219">nil</span>&nbsp;<span class="op" id="6930223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930227">t</span><span class="op" id="6930228">.</span><span class="ident" id="6930229">Fatalf</span><span class="op" id="6930235">(</span><span class="string" id="6930236">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="6930249">,</span>&nbsp;<span class="ident" id="6930251">err</span><span class="op" id="6930254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930257">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930260">if</span>&nbsp;<span class="ident" id="6930263">_</span><span class="op" id="6930264">,</span>&nbsp;<span class="ident" id="6930266">err</span>&nbsp;<span class="op" id="6930270">=</span>&nbsp;<span class="ident" id="6930272">tmpl</span><span class="op" id="6930276">.</span><span class="ident" id="6930277">Parse</span><span class="op" id="6930282">(</span><span class="string" id="6930283">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="6930312">)</span><span class="op" id="6930313">;</span>&nbsp;<span class="ident" id="6930315">err</span>&nbsp;<span class="op" id="6930319">==</span>&nbsp;<span class="ident" id="6930322">nil</span>&nbsp;<span class="op" id="6930326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930330">t</span><span class="op" id="6930331">.</span><span class="ident" id="6930332">Fatal</span><span class="op" id="6930337">(</span><span class="string" id="6930338">&#34;expected&nbsp;error&#34;</span><span class="op" id="6930354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930360">if</span>&nbsp;<span class="op" id="6930363">!</span><span class="ident" id="6930364">strings</span><span class="op" id="6930371">.</span><span class="ident" id="6930372">Contains</span><span class="op" id="6930380">(</span><span class="ident" id="6930381">err</span><span class="op" id="6930384">.</span><span class="ident" id="6930385">Error</span><span class="op" id="6930390">(</span><span class="op" id="6930391">)</span><span class="op" id="6930392">,</span>&nbsp;<span class="string" id="6930394">&#34;redefinition&#34;</span><span class="op" id="6930408">)</span>&nbsp;<span class="op" id="6930410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930414">t</span><span class="op" id="6930415">.</span><span class="ident" id="6930416">Fatalf</span><span class="op" id="6930422">(</span><span class="string" id="6930423">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6930460">,</span>&nbsp;<span class="ident" id="6930462">err</span><span class="op" id="6930465">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930471">if</span>&nbsp;<span class="ident" id="6930474">_</span><span class="op" id="6930475">,</span>&nbsp;<span class="ident" id="6930477">err</span>&nbsp;<span class="op" id="6930481">=</span>&nbsp;<span class="ident" id="6930483">tmpl</span><span class="op" id="6930487">.</span><span class="ident" id="6930488">New</span><span class="op" id="6930491">(</span><span class="string" id="6930492">&#34;tmpl2&#34;</span><span class="op" id="6930499">)</span><span class="op" id="6930500">.</span><span class="ident" id="6930501">Parse</span><span class="op" id="6930506">(</span><span class="string" id="6930507">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="6930536">)</span><span class="op" id="6930537">;</span>&nbsp;<span class="ident" id="6930539">err</span>&nbsp;<span class="op" id="6930543">==</span>&nbsp;<span class="ident" id="6930546">nil</span>&nbsp;<span class="op" id="6930550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930554">t</span><span class="op" id="6930555">.</span><span class="ident" id="6930556">Fatal</span><span class="op" id="6930561">(</span><span class="string" id="6930562">&#34;expected&nbsp;error&#34;</span><span class="op" id="6930578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930584">if</span>&nbsp;<span class="op" id="6930587">!</span><span class="ident" id="6930588">strings</span><span class="op" id="6930595">.</span><span class="ident" id="6930596">Contains</span><span class="op" id="6930604">(</span><span class="ident" id="6930605">err</span><span class="op" id="6930608">.</span><span class="ident" id="6930609">Error</span><span class="op" id="6930614">(</span><span class="op" id="6930615">)</span><span class="op" id="6930616">,</span>&nbsp;<span class="string" id="6930618">&#34;redefinition&#34;</span><span class="op" id="6930632">)</span>&nbsp;<span class="op" id="6930634">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930638">t</span><span class="op" id="6930639">.</span><span class="ident" id="6930640">Fatalf</span><span class="op" id="6930646">(</span><span class="string" id="6930647">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6930684">,</span>&nbsp;<span class="ident" id="6930686">err</span><span class="op" id="6930689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930692">}</span><br>
<span class="lineno"></span><span class="op" id="6930694">}</span>
</div>
</body>
</html>
