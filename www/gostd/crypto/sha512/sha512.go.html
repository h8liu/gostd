<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html" class="current">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4960967">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4961022">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4961076">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4961127">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4961205">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4961223">package</span>&nbsp;<span class="ident" id="4961231">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4961239">import</span>&nbsp;<span class="op" id="4961246">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4961249">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4961259">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4961266">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4961269">func</span>&nbsp;<span class="ident" id="4961274">init</span><span class="op" id="4961278">(</span><span class="op" id="4961279">)</span>&nbsp;<span class="op" id="4961281">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961284">crypto</span><span class="op" id="4961290">.</span><span class="ident" id="4961291">RegisterHash</span><span class="op" id="4961303">(</span><span class="ident" id="4961304">crypto</span><span class="op" id="4961310">.</span><span class="ident" id="4961311">SHA384</span><span class="op" id="4961317">,</span>&nbsp;<span class="ident" id="4961319">New384</span><span class="op" id="4961325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961328">crypto</span><span class="op" id="4961334">.</span><span class="ident" id="4961335">RegisterHash</span><span class="op" id="4961347">(</span><span class="ident" id="4961348">crypto</span><span class="op" id="4961354">.</span><span class="ident" id="4961355">SHA512</span><span class="op" id="4961361">,</span>&nbsp;<span class="ident" id="4961363">New</span><span class="op" id="4961366">)</span><br>
<span class="lineno"></span><span class="op" id="4961368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4961371">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4961414">const</span>&nbsp;<span class="ident" id="4961420">Size</span>&nbsp;<span class="op" id="4961425">=</span>&nbsp;<span class="num" id="4961427">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4961431">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4961474">const</span>&nbsp;<span class="ident" id="4961480">Size384</span>&nbsp;<span class="op" id="4961488">=</span>&nbsp;<span class="num" id="4961490">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4961494">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4961542">const</span>&nbsp;<span class="ident" id="4961548">BlockSize</span>&nbsp;<span class="op" id="4961558">=</span>&nbsp;<span class="num" id="4961560">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4961565">const</span>&nbsp;<span class="op" id="4961571">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961574">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961584">=</span>&nbsp;<span class="num" id="4961586">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961591">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961601">=</span>&nbsp;<span class="num" id="4961603">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961623">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961633">=</span>&nbsp;<span class="num" id="4961635">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961655">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961665">=</span>&nbsp;<span class="num" id="4961667">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961687">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961697">=</span>&nbsp;<span class="num" id="4961699">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961719">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961729">=</span>&nbsp;<span class="num" id="4961731">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961751">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961761">=</span>&nbsp;<span class="num" id="4961763">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961783">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961793">=</span>&nbsp;<span class="num" id="4961795">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961815">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961825">=</span>&nbsp;<span class="num" id="4961827">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961847">init0_384</span>&nbsp;<span class="op" id="4961857">=</span>&nbsp;<span class="num" id="4961859">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961879">init1_384</span>&nbsp;<span class="op" id="4961889">=</span>&nbsp;<span class="num" id="4961891">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961911">init2_384</span>&nbsp;<span class="op" id="4961921">=</span>&nbsp;<span class="num" id="4961923">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961943">init3_384</span>&nbsp;<span class="op" id="4961953">=</span>&nbsp;<span class="num" id="4961955">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961975">init4_384</span>&nbsp;<span class="op" id="4961985">=</span>&nbsp;<span class="num" id="4961987">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962007">init5_384</span>&nbsp;<span class="op" id="4962017">=</span>&nbsp;<span class="num" id="4962019">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962039">init6_384</span>&nbsp;<span class="op" id="4962049">=</span>&nbsp;<span class="num" id="4962051">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962071">init7_384</span>&nbsp;<span class="op" id="4962081">=</span>&nbsp;<span class="num" id="4962083">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4962102">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4962105">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4962164">type</span>&nbsp;<span class="ident" id="4962169">digest</span>&nbsp;<span class="keyword" id="4962176">struct</span>&nbsp;<span class="op" id="4962183">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962186">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4962192">[</span><span class="num" id="4962193">8</span><span class="op" id="4962194">]</span><span class="ident" id="4962195">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962203">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4962209">[</span><span class="ident" id="4962210">chunk</span><span class="op" id="4962215">]</span><span class="builtintype" id="4962216">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962222">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4962228">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4962233">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4962239">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962247">is384</span>&nbsp;<span class="builtintype" id="4962253">bool</span>&nbsp;<span class="comment" id="4962258">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4962292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4962295">func</span>&nbsp;<span class="op" id="4962300">(</span><span class="ident" id="4962301">d</span>&nbsp;<span class="op" id="4962303">*</span><span class="ident" id="4962304">digest</span><span class="op" id="4962310">)</span>&nbsp;<span class="ident" id="4962312">Reset</span><span class="op" id="4962317">(</span><span class="op" id="4962318">)</span>&nbsp;<span class="op" id="4962320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962323">if</span>&nbsp;<span class="op" id="4962326">!</span><span class="ident" id="4962327">d</span><span class="op" id="4962328">.</span><span class="ident" id="4962329">is384</span>&nbsp;<span class="op" id="4962335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962339">d</span><span class="op" id="4962340">.</span><span class="ident" id="4962341">h</span><span class="op" id="4962342">[</span><span class="num" id="4962343">0</span><span class="op" id="4962344">]</span>&nbsp;<span class="op" id="4962346">=</span>&nbsp;<span class="ident" id="4962348">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962356">d</span><span class="op" id="4962357">.</span><span class="ident" id="4962358">h</span><span class="op" id="4962359">[</span><span class="num" id="4962360">1</span><span class="op" id="4962361">]</span>&nbsp;<span class="op" id="4962363">=</span>&nbsp;<span class="ident" id="4962365">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962373">d</span><span class="op" id="4962374">.</span><span class="ident" id="4962375">h</span><span class="op" id="4962376">[</span><span class="num" id="4962377">2</span><span class="op" id="4962378">]</span>&nbsp;<span class="op" id="4962380">=</span>&nbsp;<span class="ident" id="4962382">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962390">d</span><span class="op" id="4962391">.</span><span class="ident" id="4962392">h</span><span class="op" id="4962393">[</span><span class="num" id="4962394">3</span><span class="op" id="4962395">]</span>&nbsp;<span class="op" id="4962397">=</span>&nbsp;<span class="ident" id="4962399">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962407">d</span><span class="op" id="4962408">.</span><span class="ident" id="4962409">h</span><span class="op" id="4962410">[</span><span class="num" id="4962411">4</span><span class="op" id="4962412">]</span>&nbsp;<span class="op" id="4962414">=</span>&nbsp;<span class="ident" id="4962416">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962424">d</span><span class="op" id="4962425">.</span><span class="ident" id="4962426">h</span><span class="op" id="4962427">[</span><span class="num" id="4962428">5</span><span class="op" id="4962429">]</span>&nbsp;<span class="op" id="4962431">=</span>&nbsp;<span class="ident" id="4962433">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962441">d</span><span class="op" id="4962442">.</span><span class="ident" id="4962443">h</span><span class="op" id="4962444">[</span><span class="num" id="4962445">6</span><span class="op" id="4962446">]</span>&nbsp;<span class="op" id="4962448">=</span>&nbsp;<span class="ident" id="4962450">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962458">d</span><span class="op" id="4962459">.</span><span class="ident" id="4962460">h</span><span class="op" id="4962461">[</span><span class="num" id="4962462">7</span><span class="op" id="4962463">]</span>&nbsp;<span class="op" id="4962465">=</span>&nbsp;<span class="ident" id="4962467">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4962474">}</span>&nbsp;<span class="keyword" id="4962476">else</span>&nbsp;<span class="op" id="4962481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962485">d</span><span class="op" id="4962486">.</span><span class="ident" id="4962487">h</span><span class="op" id="4962488">[</span><span class="num" id="4962489">0</span><span class="op" id="4962490">]</span>&nbsp;<span class="op" id="4962492">=</span>&nbsp;<span class="ident" id="4962494">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962506">d</span><span class="op" id="4962507">.</span><span class="ident" id="4962508">h</span><span class="op" id="4962509">[</span><span class="num" id="4962510">1</span><span class="op" id="4962511">]</span>&nbsp;<span class="op" id="4962513">=</span>&nbsp;<span class="ident" id="4962515">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962527">d</span><span class="op" id="4962528">.</span><span class="ident" id="4962529">h</span><span class="op" id="4962530">[</span><span class="num" id="4962531">2</span><span class="op" id="4962532">]</span>&nbsp;<span class="op" id="4962534">=</span>&nbsp;<span class="ident" id="4962536">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962548">d</span><span class="op" id="4962549">.</span><span class="ident" id="4962550">h</span><span class="op" id="4962551">[</span><span class="num" id="4962552">3</span><span class="op" id="4962553">]</span>&nbsp;<span class="op" id="4962555">=</span>&nbsp;<span class="ident" id="4962557">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962569">d</span><span class="op" id="4962570">.</span><span class="ident" id="4962571">h</span><span class="op" id="4962572">[</span><span class="num" id="4962573">4</span><span class="op" id="4962574">]</span>&nbsp;<span class="op" id="4962576">=</span>&nbsp;<span class="ident" id="4962578">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962590">d</span><span class="op" id="4962591">.</span><span class="ident" id="4962592">h</span><span class="op" id="4962593">[</span><span class="num" id="4962594">5</span><span class="op" id="4962595">]</span>&nbsp;<span class="op" id="4962597">=</span>&nbsp;<span class="ident" id="4962599">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962611">d</span><span class="op" id="4962612">.</span><span class="ident" id="4962613">h</span><span class="op" id="4962614">[</span><span class="num" id="4962615">6</span><span class="op" id="4962616">]</span>&nbsp;<span class="op" id="4962618">=</span>&nbsp;<span class="ident" id="4962620">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962632">d</span><span class="op" id="4962633">.</span><span class="ident" id="4962634">h</span><span class="op" id="4962635">[</span><span class="num" id="4962636">7</span><span class="op" id="4962637">]</span>&nbsp;<span class="op" id="4962639">=</span>&nbsp;<span class="ident" id="4962641">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4962652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962655">d</span><span class="op" id="4962656">.</span><span class="ident" id="4962657">nx</span>&nbsp;<span class="op" id="4962660">=</span>&nbsp;<span class="num" id="4962662">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962665">d</span><span class="op" id="4962666">.</span><span class="builtinfunc" id="4962667">len</span>&nbsp;<span class="op" id="4962671">=</span>&nbsp;<span class="num" id="4962673">0</span><br>
<span class="lineno"></span><span class="op" id="4962675">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4962678">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4962740">func</span>&nbsp;<span class="ident" id="4962745">New</span><span class="op" id="4962748">(</span><span class="op" id="4962749">)</span>&nbsp;<span class="ident" id="4962751">hash</span><span class="op" id="4962755">.</span><span class="ident" id="4962756">Hash</span>&nbsp;<span class="op" id="4962761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962764">d</span>&nbsp;<span class="op" id="4962766">:=</span>&nbsp;<span class="builtinfunc" id="4962769">new</span><span class="op" id="4962772">(</span><span class="ident" id="4962773">digest</span><span class="op" id="4962779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962782">d</span><span class="op" id="4962783">.</span><span class="ident" id="4962784">Reset</span><span class="op" id="4962789">(</span><span class="op" id="4962790">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962793">return</span>&nbsp;<span class="ident" id="4962800">d</span><br>
<span class="lineno"></span><span class="op" id="4962802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4962805">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4962870">func</span>&nbsp;<span class="ident" id="4962875">New384</span><span class="op" id="4962881">(</span><span class="op" id="4962882">)</span>&nbsp;<span class="ident" id="4962884">hash</span><span class="op" id="4962888">.</span><span class="ident" id="4962889">Hash</span>&nbsp;<span class="op" id="4962894">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962897">d</span>&nbsp;<span class="op" id="4962899">:=</span>&nbsp;<span class="builtinfunc" id="4962902">new</span><span class="op" id="4962905">(</span><span class="ident" id="4962906">digest</span><span class="op" id="4962912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962915">d</span><span class="op" id="4962916">.</span><span class="ident" id="4962917">is384</span>&nbsp;<span class="op" id="4962923">=</span>&nbsp;<span class="builtintype" id="4962925">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962931">d</span><span class="op" id="4962932">.</span><span class="ident" id="4962933">Reset</span><span class="op" id="4962938">(</span><span class="op" id="4962939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962942">return</span>&nbsp;<span class="ident" id="4962949">d</span><br>
<span class="lineno"></span><span class="op" id="4962951">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4962954">func</span>&nbsp;<span class="op" id="4962959">(</span><span class="ident" id="4962960">d</span>&nbsp;<span class="op" id="4962962">*</span><span class="ident" id="4962963">digest</span><span class="op" id="4962969">)</span>&nbsp;<span class="ident" id="4962971">Size</span><span class="op" id="4962975">(</span><span class="op" id="4962976">)</span>&nbsp;<span class="builtintype" id="4962978">int</span>&nbsp;<span class="op" id="4962982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962985">if</span>&nbsp;<span class="op" id="4962988">!</span><span class="ident" id="4962989">d</span><span class="op" id="4962990">.</span><span class="ident" id="4962991">is384</span>&nbsp;<span class="op" id="4962997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963001">return</span>&nbsp;<span class="ident" id="4963008">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963014">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963017">return</span>&nbsp;<span class="ident" id="4963024">Size384</span><br>
<span class="lineno"></span><span class="op" id="4963032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4963035">func</span>&nbsp;<span class="op" id="4963040">(</span><span class="ident" id="4963041">d</span>&nbsp;<span class="op" id="4963043">*</span><span class="ident" id="4963044">digest</span><span class="op" id="4963050">)</span>&nbsp;<span class="ident" id="4963052">BlockSize</span><span class="op" id="4963061">(</span><span class="op" id="4963062">)</span>&nbsp;<span class="builtintype" id="4963064">int</span>&nbsp;<span class="op" id="4963068">{</span>&nbsp;<span class="keyword" id="4963070">return</span>&nbsp;<span class="ident" id="4963077">BlockSize</span>&nbsp;<span class="op" id="4963087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4963090">func</span>&nbsp;<span class="op" id="4963095">(</span><span class="ident" id="4963096">d</span>&nbsp;<span class="op" id="4963098">*</span><span class="ident" id="4963099">digest</span><span class="op" id="4963105">)</span>&nbsp;<span class="ident" id="4963107">Write</span><span class="op" id="4963112">(</span><span class="ident" id="4963113">p</span>&nbsp;<span class="op" id="4963115">[</span><span class="op" id="4963116">]</span><span class="builtintype" id="4963117">byte</span><span class="op" id="4963121">)</span>&nbsp;<span class="op" id="4963123">(</span><span class="ident" id="4963124">nn</span>&nbsp;<span class="builtintype" id="4963127">int</span><span class="op" id="4963130">,</span>&nbsp;<span class="ident" id="4963132">err</span>&nbsp;<span class="builtintype" id="4963136">error</span><span class="op" id="4963141">)</span>&nbsp;<span class="op" id="4963143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963146">nn</span>&nbsp;<span class="op" id="4963149">=</span>&nbsp;<span class="builtinfunc" id="4963151">len</span><span class="op" id="4963154">(</span><span class="ident" id="4963155">p</span><span class="op" id="4963156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963159">d</span><span class="op" id="4963160">.</span><span class="builtinfunc" id="4963161">len</span>&nbsp;<span class="op" id="4963165">+=</span>&nbsp;<span class="ident" id="4963168">uint64</span><span class="op" id="4963174">(</span><span class="ident" id="4963175">nn</span><span class="op" id="4963177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963180">if</span>&nbsp;<span class="ident" id="4963183">d</span><span class="op" id="4963184">.</span><span class="ident" id="4963185">nx</span>&nbsp;<span class="op" id="4963188">&gt;</span>&nbsp;<span class="num" id="4963190">0</span>&nbsp;<span class="op" id="4963192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963196">n</span>&nbsp;<span class="op" id="4963198">:=</span>&nbsp;<span class="builtinfunc" id="4963201">copy</span><span class="op" id="4963205">(</span><span class="ident" id="4963206">d</span><span class="op" id="4963207">.</span><span class="ident" id="4963208">x</span><span class="op" id="4963209">[</span><span class="ident" id="4963210">d</span><span class="op" id="4963211">.</span><span class="ident" id="4963212">nx</span><span class="op" id="4963214">:</span><span class="op" id="4963215">]</span><span class="op" id="4963216">,</span>&nbsp;<span class="ident" id="4963218">p</span><span class="op" id="4963219">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963223">d</span><span class="op" id="4963224">.</span><span class="ident" id="4963225">nx</span>&nbsp;<span class="op" id="4963228">+=</span>&nbsp;<span class="ident" id="4963231">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963235">if</span>&nbsp;<span class="ident" id="4963238">d</span><span class="op" id="4963239">.</span><span class="ident" id="4963240">nx</span>&nbsp;<span class="op" id="4963243">==</span>&nbsp;<span class="ident" id="4963246">chunk</span>&nbsp;<span class="op" id="4963252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963257">block</span><span class="op" id="4963262">(</span><span class="ident" id="4963263">d</span><span class="op" id="4963264">,</span>&nbsp;<span class="ident" id="4963266">d</span><span class="op" id="4963267">.</span><span class="ident" id="4963268">x</span><span class="op" id="4963269">[</span><span class="op" id="4963270">:</span><span class="op" id="4963271">]</span><span class="op" id="4963272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963277">d</span><span class="op" id="4963278">.</span><span class="ident" id="4963279">nx</span>&nbsp;<span class="op" id="4963282">=</span>&nbsp;<span class="num" id="4963284">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963288">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963292">p</span>&nbsp;<span class="op" id="4963294">=</span>&nbsp;<span class="ident" id="4963296">p</span><span class="op" id="4963297">[</span><span class="ident" id="4963298">n</span><span class="op" id="4963299">:</span><span class="op" id="4963300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963306">if</span>&nbsp;<span class="builtinfunc" id="4963309">len</span><span class="op" id="4963312">(</span><span class="ident" id="4963313">p</span><span class="op" id="4963314">)</span>&nbsp;<span class="op" id="4963316">&gt;=</span>&nbsp;<span class="ident" id="4963319">chunk</span>&nbsp;<span class="op" id="4963325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963329">n</span>&nbsp;<span class="op" id="4963331">:=</span>&nbsp;<span class="builtinfunc" id="4963334">len</span><span class="op" id="4963337">(</span><span class="ident" id="4963338">p</span><span class="op" id="4963339">)</span>&nbsp;<span class="op" id="4963341">&amp;^</span>&nbsp;<span class="op" id="4963344">(</span><span class="ident" id="4963345">chunk</span>&nbsp;<span class="op" id="4963351">-</span>&nbsp;<span class="num" id="4963353">1</span><span class="op" id="4963354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963358">block</span><span class="op" id="4963363">(</span><span class="ident" id="4963364">d</span><span class="op" id="4963365">,</span>&nbsp;<span class="ident" id="4963367">p</span><span class="op" id="4963368">[</span><span class="op" id="4963369">:</span><span class="ident" id="4963370">n</span><span class="op" id="4963371">]</span><span class="op" id="4963372">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963376">p</span>&nbsp;<span class="op" id="4963378">=</span>&nbsp;<span class="ident" id="4963380">p</span><span class="op" id="4963381">[</span><span class="ident" id="4963382">n</span><span class="op" id="4963383">:</span><span class="op" id="4963384">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963390">if</span>&nbsp;<span class="builtinfunc" id="4963393">len</span><span class="op" id="4963396">(</span><span class="ident" id="4963397">p</span><span class="op" id="4963398">)</span>&nbsp;<span class="op" id="4963400">&gt;</span>&nbsp;<span class="num" id="4963402">0</span>&nbsp;<span class="op" id="4963404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963408">d</span><span class="op" id="4963409">.</span><span class="ident" id="4963410">nx</span>&nbsp;<span class="op" id="4963413">=</span>&nbsp;<span class="builtinfunc" id="4963415">copy</span><span class="op" id="4963419">(</span><span class="ident" id="4963420">d</span><span class="op" id="4963421">.</span><span class="ident" id="4963422">x</span><span class="op" id="4963423">[</span><span class="op" id="4963424">:</span><span class="op" id="4963425">]</span><span class="op" id="4963426">,</span>&nbsp;<span class="ident" id="4963428">p</span><span class="op" id="4963429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963432">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963435">return</span><br>
<span class="lineno"></span><span class="op" id="4963442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4963445">func</span>&nbsp;<span class="op" id="4963450">(</span><span class="ident" id="4963451">d0</span>&nbsp;<span class="op" id="4963454">*</span><span class="ident" id="4963455">digest</span><span class="op" id="4963461">)</span>&nbsp;<span class="ident" id="4963463">Sum</span><span class="op" id="4963466">(</span><span class="ident" id="4963467">in</span>&nbsp;<span class="op" id="4963470">[</span><span class="op" id="4963471">]</span><span class="builtintype" id="4963472">byte</span><span class="op" id="4963476">)</span>&nbsp;<span class="op" id="4963478">[</span><span class="op" id="4963479">]</span><span class="builtintype" id="4963480">byte</span>&nbsp;<span class="op" id="4963485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4963488">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963555">d</span>&nbsp;<span class="op" id="4963557">:=</span>&nbsp;<span class="builtinfunc" id="4963560">new</span><span class="op" id="4963563">(</span><span class="ident" id="4963564">digest</span><span class="op" id="4963570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963573">*</span><span class="ident" id="4963574">d</span>&nbsp;<span class="op" id="4963576">=</span>&nbsp;<span class="op" id="4963578">*</span><span class="ident" id="4963579">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963583">hash</span>&nbsp;<span class="op" id="4963588">:=</span>&nbsp;<span class="ident" id="4963591">d</span><span class="op" id="4963592">.</span><span class="ident" id="4963593">checkSum</span><span class="op" id="4963601">(</span><span class="op" id="4963602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963605">if</span>&nbsp;<span class="ident" id="4963608">d</span><span class="op" id="4963609">.</span><span class="ident" id="4963610">is384</span>&nbsp;<span class="op" id="4963616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963620">return</span>&nbsp;<span class="builtinfunc" id="4963627">append</span><span class="op" id="4963633">(</span><span class="ident" id="4963634">in</span><span class="op" id="4963636">,</span>&nbsp;<span class="ident" id="4963638">hash</span><span class="op" id="4963642">[</span><span class="op" id="4963643">:</span><span class="ident" id="4963644">Size384</span><span class="op" id="4963651">]</span><span class="op" id="4963652">...</span><span class="op" id="4963655">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963661">return</span>&nbsp;<span class="builtinfunc" id="4963668">append</span><span class="op" id="4963674">(</span><span class="ident" id="4963675">in</span><span class="op" id="4963677">,</span>&nbsp;<span class="ident" id="4963679">hash</span><span class="op" id="4963683">[</span><span class="op" id="4963684">:</span><span class="op" id="4963685">]</span><span class="op" id="4963686">...</span><span class="op" id="4963689">)</span><br>
<span class="lineno"></span><span class="op" id="4963691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4963694">func</span>&nbsp;<span class="op" id="4963699">(</span><span class="ident" id="4963700">d</span>&nbsp;<span class="op" id="4963702">*</span><span class="ident" id="4963703">digest</span><span class="op" id="4963709">)</span>&nbsp;<span class="ident" id="4963711">checkSum</span><span class="op" id="4963719">(</span><span class="op" id="4963720">)</span>&nbsp;<span class="op" id="4963722">[</span><span class="ident" id="4963723">Size</span><span class="op" id="4963727">]</span><span class="builtintype" id="4963728">byte</span>&nbsp;<span class="op" id="4963733">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4963736">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4963798">len</span>&nbsp;<span class="op" id="4963802">:=</span>&nbsp;<span class="ident" id="4963805">d</span><span class="op" id="4963806">.</span><span class="builtinfunc" id="4963807">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963812">var</span>&nbsp;<span class="ident" id="4963816">tmp</span>&nbsp;<span class="op" id="4963820">[</span><span class="num" id="4963821">128</span><span class="op" id="4963824">]</span><span class="builtintype" id="4963825">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963831">tmp</span><span class="op" id="4963834">[</span><span class="num" id="4963835">0</span><span class="op" id="4963836">]</span>&nbsp;<span class="op" id="4963838">=</span>&nbsp;<span class="num" id="4963840">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963846">if</span>&nbsp;<span class="builtinfunc" id="4963849">len</span><span class="op" id="4963852">%</span><span class="num" id="4963853">128</span>&nbsp;<span class="op" id="4963857">&lt;</span>&nbsp;<span class="num" id="4963859">112</span>&nbsp;<span class="op" id="4963863">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963867">d</span><span class="op" id="4963868">.</span><span class="ident" id="4963869">Write</span><span class="op" id="4963874">(</span><span class="ident" id="4963875">tmp</span><span class="op" id="4963878">[</span><span class="num" id="4963879">0</span>&nbsp;<span class="op" id="4963881">:</span>&nbsp;<span class="num" id="4963883">112</span><span class="op" id="4963886">-</span><span class="builtinfunc" id="4963887">len</span><span class="op" id="4963890">%</span><span class="num" id="4963891">128</span><span class="op" id="4963894">]</span><span class="op" id="4963895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963898">}</span>&nbsp;<span class="keyword" id="4963900">else</span>&nbsp;<span class="op" id="4963905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963909">d</span><span class="op" id="4963910">.</span><span class="ident" id="4963911">Write</span><span class="op" id="4963916">(</span><span class="ident" id="4963917">tmp</span><span class="op" id="4963920">[</span><span class="num" id="4963921">0</span>&nbsp;<span class="op" id="4963923">:</span>&nbsp;<span class="num" id="4963925">128</span><span class="op" id="4963928">+</span><span class="num" id="4963929">112</span><span class="op" id="4963932">-</span><span class="builtinfunc" id="4963933">len</span><span class="op" id="4963936">%</span><span class="num" id="4963937">128</span><span class="op" id="4963940">]</span><span class="op" id="4963941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4963948">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4963968">len</span>&nbsp;<span class="op" id="4963972">&lt;&lt;=</span>&nbsp;<span class="num" id="4963976">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963979">for</span>&nbsp;<span class="ident" id="4963983">i</span>&nbsp;<span class="op" id="4963985">:=</span>&nbsp;<span class="builtintype" id="4963988">uint</span><span class="op" id="4963992">(</span><span class="num" id="4963993">0</span><span class="op" id="4963994">)</span><span class="op" id="4963995">;</span>&nbsp;<span class="ident" id="4963997">i</span>&nbsp;<span class="op" id="4963999">&lt;</span>&nbsp;<span class="num" id="4964001">16</span><span class="op" id="4964003">;</span>&nbsp;<span class="ident" id="4964005">i</span><span class="op" id="4964006">++</span>&nbsp;<span class="op" id="4964009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964013">tmp</span><span class="op" id="4964016">[</span><span class="ident" id="4964017">i</span><span class="op" id="4964018">]</span>&nbsp;<span class="op" id="4964020">=</span>&nbsp;<span class="builtintype" id="4964022">byte</span><span class="op" id="4964026">(</span><span class="builtinfunc" id="4964027">len</span>&nbsp;<span class="op" id="4964031">&gt;&gt;</span>&nbsp;<span class="op" id="4964034">(</span><span class="num" id="4964035">120</span>&nbsp;<span class="op" id="4964039">-</span>&nbsp;<span class="num" id="4964041">8</span><span class="op" id="4964042">*</span><span class="ident" id="4964043">i</span><span class="op" id="4964044">)</span><span class="op" id="4964045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4964048">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964051">d</span><span class="op" id="4964052">.</span><span class="ident" id="4964053">Write</span><span class="op" id="4964058">(</span><span class="ident" id="4964059">tmp</span><span class="op" id="4964062">[</span><span class="num" id="4964063">0</span><span class="op" id="4964064">:</span><span class="num" id="4964065">16</span><span class="op" id="4964067">]</span><span class="op" id="4964068">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964072">if</span>&nbsp;<span class="ident" id="4964075">d</span><span class="op" id="4964076">.</span><span class="ident" id="4964077">nx</span>&nbsp;<span class="op" id="4964080">!=</span>&nbsp;<span class="num" id="4964083">0</span>&nbsp;<span class="op" id="4964085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4964089">panic</span><span class="op" id="4964094">(</span><span class="string" id="4964095">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4964106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4964109">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964113">h</span>&nbsp;<span class="op" id="4964115">:=</span>&nbsp;<span class="ident" id="4964118">d</span><span class="op" id="4964119">.</span><span class="ident" id="4964120">h</span><span class="op" id="4964121">[</span><span class="op" id="4964122">:</span><span class="op" id="4964123">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964126">if</span>&nbsp;<span class="ident" id="4964129">d</span><span class="op" id="4964130">.</span><span class="ident" id="4964131">is384</span>&nbsp;<span class="op" id="4964137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964141">h</span>&nbsp;<span class="op" id="4964143">=</span>&nbsp;<span class="ident" id="4964145">d</span><span class="op" id="4964146">.</span><span class="ident" id="4964147">h</span><span class="op" id="4964148">[</span><span class="op" id="4964149">:</span><span class="num" id="4964150">6</span><span class="op" id="4964151">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4964154">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964158">var</span>&nbsp;<span class="ident" id="4964162">digest</span>&nbsp;<span class="op" id="4964169">[</span><span class="ident" id="4964170">Size</span><span class="op" id="4964174">]</span><span class="builtintype" id="4964175">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964181">for</span>&nbsp;<span class="ident" id="4964185">i</span><span class="op" id="4964186">,</span>&nbsp;<span class="ident" id="4964188">s</span>&nbsp;<span class="op" id="4964190">:=</span>&nbsp;<span class="keyword" id="4964193">range</span>&nbsp;<span class="ident" id="4964199">h</span>&nbsp;<span class="op" id="4964201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964205">digest</span><span class="op" id="4964211">[</span><span class="ident" id="4964212">i</span><span class="op" id="4964213">*</span><span class="num" id="4964214">8</span><span class="op" id="4964215">]</span>&nbsp;<span class="op" id="4964217">=</span>&nbsp;<span class="builtintype" id="4964219">byte</span><span class="op" id="4964223">(</span><span class="ident" id="4964224">s</span>&nbsp;<span class="op" id="4964226">&gt;&gt;</span>&nbsp;<span class="num" id="4964229">56</span><span class="op" id="4964231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964235">digest</span><span class="op" id="4964241">[</span><span class="ident" id="4964242">i</span><span class="op" id="4964243">*</span><span class="num" id="4964244">8</span><span class="op" id="4964245">+</span><span class="num" id="4964246">1</span><span class="op" id="4964247">]</span>&nbsp;<span class="op" id="4964249">=</span>&nbsp;<span class="builtintype" id="4964251">byte</span><span class="op" id="4964255">(</span><span class="ident" id="4964256">s</span>&nbsp;<span class="op" id="4964258">&gt;&gt;</span>&nbsp;<span class="num" id="4964261">48</span><span class="op" id="4964263">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964267">digest</span><span class="op" id="4964273">[</span><span class="ident" id="4964274">i</span><span class="op" id="4964275">*</span><span class="num" id="4964276">8</span><span class="op" id="4964277">+</span><span class="num" id="4964278">2</span><span class="op" id="4964279">]</span>&nbsp;<span class="op" id="4964281">=</span>&nbsp;<span class="builtintype" id="4964283">byte</span><span class="op" id="4964287">(</span><span class="ident" id="4964288">s</span>&nbsp;<span class="op" id="4964290">&gt;&gt;</span>&nbsp;<span class="num" id="4964293">40</span><span class="op" id="4964295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964299">digest</span><span class="op" id="4964305">[</span><span class="ident" id="4964306">i</span><span class="op" id="4964307">*</span><span class="num" id="4964308">8</span><span class="op" id="4964309">+</span><span class="num" id="4964310">3</span><span class="op" id="4964311">]</span>&nbsp;<span class="op" id="4964313">=</span>&nbsp;<span class="builtintype" id="4964315">byte</span><span class="op" id="4964319">(</span><span class="ident" id="4964320">s</span>&nbsp;<span class="op" id="4964322">&gt;&gt;</span>&nbsp;<span class="num" id="4964325">32</span><span class="op" id="4964327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964331">digest</span><span class="op" id="4964337">[</span><span class="ident" id="4964338">i</span><span class="op" id="4964339">*</span><span class="num" id="4964340">8</span><span class="op" id="4964341">+</span><span class="num" id="4964342">4</span><span class="op" id="4964343">]</span>&nbsp;<span class="op" id="4964345">=</span>&nbsp;<span class="builtintype" id="4964347">byte</span><span class="op" id="4964351">(</span><span class="ident" id="4964352">s</span>&nbsp;<span class="op" id="4964354">&gt;&gt;</span>&nbsp;<span class="num" id="4964357">24</span><span class="op" id="4964359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964363">digest</span><span class="op" id="4964369">[</span><span class="ident" id="4964370">i</span><span class="op" id="4964371">*</span><span class="num" id="4964372">8</span><span class="op" id="4964373">+</span><span class="num" id="4964374">5</span><span class="op" id="4964375">]</span>&nbsp;<span class="op" id="4964377">=</span>&nbsp;<span class="builtintype" id="4964379">byte</span><span class="op" id="4964383">(</span><span class="ident" id="4964384">s</span>&nbsp;<span class="op" id="4964386">&gt;&gt;</span>&nbsp;<span class="num" id="4964389">16</span><span class="op" id="4964391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964395">digest</span><span class="op" id="4964401">[</span><span class="ident" id="4964402">i</span><span class="op" id="4964403">*</span><span class="num" id="4964404">8</span><span class="op" id="4964405">+</span><span class="num" id="4964406">6</span><span class="op" id="4964407">]</span>&nbsp;<span class="op" id="4964409">=</span>&nbsp;<span class="builtintype" id="4964411">byte</span><span class="op" id="4964415">(</span><span class="ident" id="4964416">s</span>&nbsp;<span class="op" id="4964418">&gt;&gt;</span>&nbsp;<span class="num" id="4964421">8</span><span class="op" id="4964422">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964426">digest</span><span class="op" id="4964432">[</span><span class="ident" id="4964433">i</span><span class="op" id="4964434">*</span><span class="num" id="4964435">8</span><span class="op" id="4964436">+</span><span class="num" id="4964437">7</span><span class="op" id="4964438">]</span>&nbsp;<span class="op" id="4964440">=</span>&nbsp;<span class="builtintype" id="4964442">byte</span><span class="op" id="4964446">(</span><span class="ident" id="4964447">s</span><span class="op" id="4964448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4964451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964455">return</span>&nbsp;<span class="ident" id="4964462">digest</span><br>
<span class="lineno"></span><span class="op" id="4964469">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4964472">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4964523">func</span>&nbsp;<span class="ident" id="4964528">Sum512</span><span class="op" id="4964534">(</span><span class="ident" id="4964535">data</span>&nbsp;<span class="op" id="4964540">[</span><span class="op" id="4964541">]</span><span class="builtintype" id="4964542">byte</span><span class="op" id="4964546">)</span>&nbsp;<span class="op" id="4964548">[</span><span class="ident" id="4964549">Size</span><span class="op" id="4964553">]</span><span class="builtintype" id="4964554">byte</span>&nbsp;<span class="op" id="4964559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964562">var</span>&nbsp;<span class="ident" id="4964566">d</span>&nbsp;<span class="ident" id="4964568">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964576">d</span><span class="op" id="4964577">.</span><span class="ident" id="4964578">Reset</span><span class="op" id="4964583">(</span><span class="op" id="4964584">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964587">d</span><span class="op" id="4964588">.</span><span class="ident" id="4964589">Write</span><span class="op" id="4964594">(</span><span class="ident" id="4964595">data</span><span class="op" id="4964599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964602">return</span>&nbsp;<span class="ident" id="4964609">d</span><span class="op" id="4964610">.</span><span class="ident" id="4964611">checkSum</span><span class="op" id="4964619">(</span><span class="op" id="4964620">)</span><br>
<span class="lineno"></span><span class="op" id="4964622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4964625">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4964676">func</span>&nbsp;<span class="ident" id="4964681">Sum384</span><span class="op" id="4964687">(</span><span class="ident" id="4964688">data</span>&nbsp;<span class="op" id="4964693">[</span><span class="op" id="4964694">]</span><span class="builtintype" id="4964695">byte</span><span class="op" id="4964699">)</span>&nbsp;<span class="op" id="4964701">(</span><span class="ident" id="4964702">sum384</span>&nbsp;<span class="op" id="4964709">[</span><span class="ident" id="4964710">Size384</span><span class="op" id="4964717">]</span><span class="builtintype" id="4964718">byte</span><span class="op" id="4964722">)</span>&nbsp;<span class="op" id="4964724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964727">var</span>&nbsp;<span class="ident" id="4964731">d</span>&nbsp;<span class="ident" id="4964733">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964741">d</span><span class="op" id="4964742">.</span><span class="ident" id="4964743">is384</span>&nbsp;<span class="op" id="4964749">=</span>&nbsp;<span class="builtintype" id="4964751">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964757">d</span><span class="op" id="4964758">.</span><span class="ident" id="4964759">Reset</span><span class="op" id="4964764">(</span><span class="op" id="4964765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964768">d</span><span class="op" id="4964769">.</span><span class="ident" id="4964770">Write</span><span class="op" id="4964775">(</span><span class="ident" id="4964776">data</span><span class="op" id="4964780">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964783">sum</span>&nbsp;<span class="op" id="4964787">:=</span>&nbsp;<span class="ident" id="4964790">d</span><span class="op" id="4964791">.</span><span class="ident" id="4964792">checkSum</span><span class="op" id="4964800">(</span><span class="op" id="4964801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4964804">copy</span><span class="op" id="4964808">(</span><span class="ident" id="4964809">sum384</span><span class="op" id="4964815">[</span><span class="op" id="4964816">:</span><span class="op" id="4964817">]</span><span class="op" id="4964818">,</span>&nbsp;<span class="ident" id="4964820">sum</span><span class="op" id="4964823">[</span><span class="op" id="4964824">:</span><span class="ident" id="4964825">Size384</span><span class="op" id="4964832">]</span><span class="op" id="4964833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964836">return</span><br>
<span class="lineno"></span><span class="op" id="4964843">}</span>
</div>
</body>
</html>
