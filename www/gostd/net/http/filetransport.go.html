<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5032466">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5032521">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5032575">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5032626">package</span>&nbsp;<span class="ident" id="5032634">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5032640">import</span>&nbsp;<span class="op" id="5032647">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5032650">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5032657">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="5032662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5032665">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="5032731">type</span>&nbsp;<span class="ident" id="5032736">fileTransport</span>&nbsp;<span class="keyword" id="5032750">struct</span>&nbsp;<span class="op" id="5032757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032760">fh</span>&nbsp;<span class="ident" id="5032763">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="5032775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5032778">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="5032847">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5032916">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="5032978">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="5032990">//</span><br>
<span class="lineno"></span><span class="comment" id="5032993">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5033064">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="5033101">//</span><br>
<span class="lineno">25</span><span class="comment" id="5033104">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="5033132">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="5033202">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="5033239">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="5033284">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="5033293">func</span>&nbsp;<span class="ident" id="5033298">NewFileTransport</span><span class="op" id="5033314">(</span><span class="ident" id="5033315">fs</span>&nbsp;<span class="ident" id="5033318">FileSystem</span><span class="op" id="5033328">)</span>&nbsp;<span class="ident" id="5033330">RoundTripper</span>&nbsp;<span class="op" id="5033343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033346">return</span>&nbsp;<span class="ident" id="5033353">fileTransport</span><span class="op" id="5033366">{</span><span class="ident" id="5033367">fileHandler</span><span class="op" id="5033378">{</span><span class="ident" id="5033379">fs</span><span class="op" id="5033381">}</span><span class="op" id="5033382">}</span><br>
<span class="lineno"></span><span class="op" id="5033384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5033387">func</span>&nbsp;<span class="op" id="5033392">(</span><span class="ident" id="5033393">t</span>&nbsp;<span class="ident" id="5033395">fileTransport</span><span class="op" id="5033408">)</span>&nbsp;<span class="ident" id="5033410">RoundTrip</span><span class="op" id="5033419">(</span><span class="ident" id="5033420">req</span>&nbsp;<span class="op" id="5033424">*</span><span class="ident" id="5033425">Request</span><span class="op" id="5033432">)</span>&nbsp;<span class="op" id="5033434">(</span><span class="ident" id="5033435">resp</span>&nbsp;<span class="op" id="5033440">*</span><span class="ident" id="5033441">Response</span><span class="op" id="5033449">,</span>&nbsp;<span class="ident" id="5033451">err</span>&nbsp;<span class="builtintype" id="5033455">error</span><span class="op" id="5033460">)</span>&nbsp;<span class="op" id="5033462">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5033465">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5033526">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5033588">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5033650">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5033713">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5033767">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033804">rw</span><span class="op" id="5033806">,</span>&nbsp;<span class="ident" id="5033808">resc</span>&nbsp;<span class="op" id="5033813">:=</span>&nbsp;<span class="ident" id="5033816">newPopulateResponseWriter</span><span class="op" id="5033841">(</span><span class="op" id="5033842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033845">go</span>&nbsp;<span class="keyword" id="5033848">func</span><span class="op" id="5033852">(</span><span class="op" id="5033853">)</span>&nbsp;<span class="op" id="5033855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033859">t</span><span class="op" id="5033860">.</span><span class="ident" id="5033861">fh</span><span class="op" id="5033863">.</span><span class="ident" id="5033864">ServeHTTP</span><span class="op" id="5033873">(</span><span class="ident" id="5033874">rw</span><span class="op" id="5033876">,</span>&nbsp;<span class="ident" id="5033878">req</span><span class="op" id="5033881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033885">rw</span><span class="op" id="5033887">.</span><span class="ident" id="5033888">finish</span><span class="op" id="5033894">(</span><span class="op" id="5033895">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5033898">}</span><span class="op" id="5033899">(</span><span class="op" id="5033900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033903">return</span>&nbsp;<span class="op" id="5033910">&lt;-</span><span class="ident" id="5033912">resc</span><span class="op" id="5033916">,</span>&nbsp;<span class="ident" id="5033918">nil</span><br>
<span class="lineno"></span><span class="op" id="5033922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5033925">func</span>&nbsp;<span class="ident" id="5033930">newPopulateResponseWriter</span><span class="op" id="5033955">(</span><span class="op" id="5033956">)</span>&nbsp;<span class="op" id="5033958">(</span><span class="op" id="5033959">*</span><span class="ident" id="5033960">populateResponse</span><span class="op" id="5033976">,</span>&nbsp;<span class="op" id="5033978">&lt;-</span><span class="keyword" id="5033980">chan</span>&nbsp;<span class="op" id="5033985">*</span><span class="ident" id="5033986">Response</span><span class="op" id="5033994">)</span>&nbsp;<span class="op" id="5033996">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033999">pr</span><span class="op" id="5034001">,</span>&nbsp;<span class="ident" id="5034003">pw</span>&nbsp;<span class="op" id="5034006">:=</span>&nbsp;<span class="ident" id="5034009">io</span><span class="op" id="5034011">.</span><span class="ident" id="5034012">Pipe</span><span class="op" id="5034016">(</span><span class="op" id="5034017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034020">rw</span>&nbsp;<span class="op" id="5034023">:=</span>&nbsp;<span class="op" id="5034026">&amp;</span><span class="ident" id="5034027">populateResponse</span><span class="op" id="5034043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034047">ch</span><span class="op" id="5034049">:</span>&nbsp;<span class="builtinfunc" id="5034051">make</span><span class="op" id="5034055">(</span><span class="keyword" id="5034056">chan</span>&nbsp;<span class="op" id="5034061">*</span><span class="ident" id="5034062">Response</span><span class="op" id="5034070">)</span><span class="op" id="5034071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034075">pw</span><span class="op" id="5034077">:</span>&nbsp;<span class="ident" id="5034079">pw</span><span class="op" id="5034081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034085">res</span><span class="op" id="5034088">:</span>&nbsp;<span class="op" id="5034090">&amp;</span><span class="ident" id="5034091">Response</span><span class="op" id="5034099">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034104">Proto</span><span class="op" id="5034109">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5034116">&#34;HTTP/1.0&#34;</span><span class="op" id="5034126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034131">ProtoMajor</span><span class="op" id="5034141">:</span>&nbsp;<span class="num" id="5034143">1</span><span class="op" id="5034144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034149">Header</span><span class="op" id="5034155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5034161">make</span><span class="op" id="5034165">(</span><span class="ident" id="5034166">Header</span><span class="op" id="5034172">)</span><span class="op" id="5034173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034178">Close</span><span class="op" id="5034183">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5034190">true</span><span class="op" id="5034194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034199">Body</span><span class="op" id="5034203">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5034211">pr</span><span class="op" id="5034213">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5034217">}</span><span class="op" id="5034218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5034221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034224">return</span>&nbsp;<span class="ident" id="5034231">rw</span><span class="op" id="5034233">,</span>&nbsp;<span class="ident" id="5034235">rw</span><span class="op" id="5034237">.</span><span class="ident" id="5034238">ch</span><br>
<span class="lineno"></span><span class="op" id="5034241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="5034244">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="5034313">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="5034380">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="5034451">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="5034461">type</span>&nbsp;<span class="ident" id="5034466">populateResponse</span>&nbsp;<span class="keyword" id="5034483">struct</span>&nbsp;<span class="op" id="5034490">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034493">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5034506">*</span><span class="ident" id="5034507">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034517">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5034530">chan</span>&nbsp;<span class="op" id="5034535">*</span><span class="ident" id="5034536">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034546">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="5034559">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034565">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5034578">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034584">sentResponse</span>&nbsp;<span class="builtintype" id="5034597">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034603">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5034616">*</span><span class="ident" id="5034617">io</span><span class="op" id="5034619">.</span><span class="ident" id="5034620">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="5034631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5034634">func</span>&nbsp;<span class="op" id="5034639">(</span><span class="ident" id="5034640">pr</span>&nbsp;<span class="op" id="5034643">*</span><span class="ident" id="5034644">populateResponse</span><span class="op" id="5034660">)</span>&nbsp;<span class="ident" id="5034662">finish</span><span class="op" id="5034668">(</span><span class="op" id="5034669">)</span>&nbsp;<span class="op" id="5034671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034674">if</span>&nbsp;<span class="op" id="5034677">!</span><span class="ident" id="5034678">pr</span><span class="op" id="5034680">.</span><span class="ident" id="5034681">wroteHeader</span>&nbsp;<span class="op" id="5034693">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034697">pr</span><span class="op" id="5034699">.</span><span class="ident" id="5034700">WriteHeader</span><span class="op" id="5034711">(</span><span class="num" id="5034712">500</span><span class="op" id="5034715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5034718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034721">if</span>&nbsp;<span class="op" id="5034724">!</span><span class="ident" id="5034725">pr</span><span class="op" id="5034727">.</span><span class="ident" id="5034728">sentResponse</span>&nbsp;<span class="op" id="5034741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034745">pr</span><span class="op" id="5034747">.</span><span class="ident" id="5034748">sendResponse</span><span class="op" id="5034760">(</span><span class="op" id="5034761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5034764">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034767">pr</span><span class="op" id="5034769">.</span><span class="ident" id="5034770">pw</span><span class="op" id="5034772">.</span><span class="ident" id="5034773">Close</span><span class="op" id="5034778">(</span><span class="op" id="5034779">)</span><br>
<span class="lineno"></span><span class="op" id="5034781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5034784">func</span>&nbsp;<span class="op" id="5034789">(</span><span class="ident" id="5034790">pr</span>&nbsp;<span class="op" id="5034793">*</span><span class="ident" id="5034794">populateResponse</span><span class="op" id="5034810">)</span>&nbsp;<span class="ident" id="5034812">sendResponse</span><span class="op" id="5034824">(</span><span class="op" id="5034825">)</span>&nbsp;<span class="op" id="5034827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034830">if</span>&nbsp;<span class="ident" id="5034833">pr</span><span class="op" id="5034835">.</span><span class="ident" id="5034836">sentResponse</span>&nbsp;<span class="op" id="5034849">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034853">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5034861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034864">pr</span><span class="op" id="5034866">.</span><span class="ident" id="5034867">sentResponse</span>&nbsp;<span class="op" id="5034880">=</span>&nbsp;<span class="builtintype" id="5034882">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034889">if</span>&nbsp;<span class="ident" id="5034892">pr</span><span class="op" id="5034894">.</span><span class="ident" id="5034895">hasContent</span>&nbsp;<span class="op" id="5034906">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034910">pr</span><span class="op" id="5034912">.</span><span class="ident" id="5034913">res</span><span class="op" id="5034916">.</span><span class="ident" id="5034917">ContentLength</span>&nbsp;<span class="op" id="5034931">=</span>&nbsp;<span class="op" id="5034933">-</span><span class="num" id="5034934">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5034937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034940">pr</span><span class="op" id="5034942">.</span><span class="ident" id="5034943">ch</span>&nbsp;<span class="op" id="5034946">&lt;-</span>&nbsp;<span class="ident" id="5034949">pr</span><span class="op" id="5034951">.</span><span class="ident" id="5034952">res</span><br>
<span class="lineno"></span><span class="op" id="5034956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="5034959">func</span>&nbsp;<span class="op" id="5034964">(</span><span class="ident" id="5034965">pr</span>&nbsp;<span class="op" id="5034968">*</span><span class="ident" id="5034969">populateResponse</span><span class="op" id="5034985">)</span>&nbsp;<span class="ident" id="5034987">Header</span><span class="op" id="5034993">(</span><span class="op" id="5034994">)</span>&nbsp;<span class="ident" id="5034996">Header</span>&nbsp;<span class="op" id="5035003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035006">return</span>&nbsp;<span class="ident" id="5035013">pr</span><span class="op" id="5035015">.</span><span class="ident" id="5035016">res</span><span class="op" id="5035019">.</span><span class="ident" id="5035020">Header</span><br>
<span class="lineno"></span><span class="op" id="5035027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5035030">func</span>&nbsp;<span class="op" id="5035035">(</span><span class="ident" id="5035036">pr</span>&nbsp;<span class="op" id="5035039">*</span><span class="ident" id="5035040">populateResponse</span><span class="op" id="5035056">)</span>&nbsp;<span class="ident" id="5035058">WriteHeader</span><span class="op" id="5035069">(</span><span class="ident" id="5035070">code</span>&nbsp;<span class="builtintype" id="5035075">int</span><span class="op" id="5035078">)</span>&nbsp;<span class="op" id="5035080">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035083">if</span>&nbsp;<span class="ident" id="5035086">pr</span><span class="op" id="5035088">.</span><span class="ident" id="5035089">wroteHeader</span>&nbsp;<span class="op" id="5035101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035105">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5035113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5035116">pr</span><span class="op" id="5035118">.</span><span class="ident" id="5035119">wroteHeader</span>&nbsp;<span class="op" id="5035131">=</span>&nbsp;<span class="builtintype" id="5035133">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5035140">pr</span><span class="op" id="5035142">.</span><span class="ident" id="5035143">res</span><span class="op" id="5035146">.</span><span class="ident" id="5035147">StatusCode</span>&nbsp;<span class="op" id="5035158">=</span>&nbsp;<span class="ident" id="5035160">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5035166">pr</span><span class="op" id="5035168">.</span><span class="ident" id="5035169">res</span><span class="op" id="5035172">.</span><span class="ident" id="5035173">Status</span>&nbsp;<span class="op" id="5035180">=</span>&nbsp;<span class="ident" id="5035182">fmt</span><span class="op" id="5035185">.</span><span class="ident" id="5035186">Sprintf</span><span class="op" id="5035193">(</span><span class="string" id="5035194">&#34;%d&nbsp;%s&#34;</span><span class="op" id="5035201">,</span>&nbsp;<span class="ident" id="5035203">code</span><span class="op" id="5035207">,</span>&nbsp;<span class="ident" id="5035209">StatusText</span><span class="op" id="5035219">(</span><span class="ident" id="5035220">code</span><span class="op" id="5035224">)</span><span class="op" id="5035225">)</span><br>
<span class="lineno"></span><span class="op" id="5035227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5035230">func</span>&nbsp;<span class="op" id="5035235">(</span><span class="ident" id="5035236">pr</span>&nbsp;<span class="op" id="5035239">*</span><span class="ident" id="5035240">populateResponse</span><span class="op" id="5035256">)</span>&nbsp;<span class="ident" id="5035258">Write</span><span class="op" id="5035263">(</span><span class="ident" id="5035264">p</span>&nbsp;<span class="op" id="5035266">[</span><span class="op" id="5035267">]</span><span class="builtintype" id="5035268">byte</span><span class="op" id="5035272">)</span>&nbsp;<span class="op" id="5035274">(</span><span class="ident" id="5035275">n</span>&nbsp;<span class="builtintype" id="5035277">int</span><span class="op" id="5035280">,</span>&nbsp;<span class="ident" id="5035282">err</span>&nbsp;<span class="builtintype" id="5035286">error</span><span class="op" id="5035291">)</span>&nbsp;<span class="op" id="5035293">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035296">if</span>&nbsp;<span class="op" id="5035299">!</span><span class="ident" id="5035300">pr</span><span class="op" id="5035302">.</span><span class="ident" id="5035303">wroteHeader</span>&nbsp;<span class="op" id="5035315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5035319">pr</span><span class="op" id="5035321">.</span><span class="ident" id="5035322">WriteHeader</span><span class="op" id="5035333">(</span><span class="ident" id="5035334">StatusOK</span><span class="op" id="5035342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5035345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5035348">pr</span><span class="op" id="5035350">.</span><span class="ident" id="5035351">hasContent</span>&nbsp;<span class="op" id="5035362">=</span>&nbsp;<span class="builtintype" id="5035364">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035370">if</span>&nbsp;<span class="op" id="5035373">!</span><span class="ident" id="5035374">pr</span><span class="op" id="5035376">.</span><span class="ident" id="5035377">sentResponse</span>&nbsp;<span class="op" id="5035390">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5035394">pr</span><span class="op" id="5035396">.</span><span class="ident" id="5035397">sendResponse</span><span class="op" id="5035409">(</span><span class="op" id="5035410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5035413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035416">return</span>&nbsp;<span class="ident" id="5035423">pr</span><span class="op" id="5035425">.</span><span class="ident" id="5035426">pw</span><span class="op" id="5035428">.</span><span class="ident" id="5035429">Write</span><span class="op" id="5035434">(</span><span class="ident" id="5035435">p</span><span class="op" id="5035436">)</span><br>
<span class="lineno"></span><span class="op" id="5035438">}</span>
</div>
</body>
</html>
