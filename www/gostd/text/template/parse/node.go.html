<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html" class="current">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5142993">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5143048">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5143102">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5143153">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5143170">package</span>&nbsp;<span class="ident" id="5143178">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5143185">import</span>&nbsp;<span class="op" id="5143192">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5143195">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5143204">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5143211">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5143222">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5143232">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5143235">var</span>&nbsp;<span class="ident" id="5143239">textFormat</span>&nbsp;<span class="op" id="5143250">=</span>&nbsp;<span class="string" id="5143252">&#34;%s&#34;</span>&nbsp;<span class="comment" id="5143257">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5143313">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="5143382">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="5143442">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="5143489">type</span>&nbsp;<span class="ident" id="5143494">Node</span>&nbsp;<span class="keyword" id="5143499">interface</span>&nbsp;<span class="op" id="5143509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143512">Type</span><span class="op" id="5143516">(</span><span class="op" id="5143517">)</span>&nbsp;<span class="ident" id="5143519">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143529">String</span><span class="op" id="5143535">(</span><span class="op" id="5143536">)</span>&nbsp;<span class="builtintype" id="5143538">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5143546">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5143608">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5143674">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143716">Copy</span><span class="op" id="5143720">(</span><span class="op" id="5143721">)</span>&nbsp;<span class="ident" id="5143723">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143729">Position</span><span class="op" id="5143737">(</span><span class="op" id="5143738">)</span>&nbsp;<span class="ident" id="5143740">Pos</span>&nbsp;<span class="comment" id="5143744">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5143809">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5143848">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143921">tree</span><span class="op" id="5143925">(</span><span class="op" id="5143926">)</span>&nbsp;<span class="op" id="5143928">*</span><span class="ident" id="5143929">Tree</span><br>
<span class="lineno"></span><span class="op" id="5143934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5143937">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="5143991">type</span>&nbsp;<span class="ident" id="5143996">NodeType</span>&nbsp;<span class="builtintype" id="5144005">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5144010">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="5144082">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="5144111">type</span>&nbsp;<span class="ident" id="5144116">Pos</span>&nbsp;<span class="builtintype" id="5144120">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5144125">func</span>&nbsp;<span class="op" id="5144130">(</span><span class="ident" id="5144131">p</span>&nbsp;<span class="ident" id="5144133">Pos</span><span class="op" id="5144136">)</span>&nbsp;<span class="ident" id="5144138">Position</span><span class="op" id="5144146">(</span><span class="op" id="5144147">)</span>&nbsp;<span class="ident" id="5144149">Pos</span>&nbsp;<span class="op" id="5144153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144156">return</span>&nbsp;<span class="ident" id="5144163">p</span><br>
<span class="lineno"></span><span class="op" id="5144165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5144168">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="5144235">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5144298">func</span>&nbsp;<span class="op" id="5144303">(</span><span class="ident" id="5144304">t</span>&nbsp;<span class="ident" id="5144306">NodeType</span><span class="op" id="5144314">)</span>&nbsp;<span class="ident" id="5144316">Type</span><span class="op" id="5144320">(</span><span class="op" id="5144321">)</span>&nbsp;<span class="ident" id="5144323">NodeType</span>&nbsp;<span class="op" id="5144332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144335">return</span>&nbsp;<span class="ident" id="5144342">t</span><br>
<span class="lineno"></span><span class="op" id="5144344">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="5144347">const</span>&nbsp;<span class="op" id="5144353">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144356">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144371">NodeType</span>&nbsp;<span class="op" id="5144380">=</span>&nbsp;<span class="ident" id="5144382">iota</span>&nbsp;<span class="comment" id="5144387">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144403">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144434">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144487">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144518">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144542">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144573">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144607">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144638">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144668">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144699">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144720">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144751">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144790">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144821">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144859">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144890">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144918">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144949">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144992">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145023">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145041">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145072">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145093">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145124">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145153">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145184">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145210">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145241">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145269">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145300">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145320">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145351">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145374">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145405">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145439">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145470">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145488">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145519">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="5145537">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5145540">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="5145551">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5145590">type</span>&nbsp;<span class="ident" id="5145595">ListNode</span>&nbsp;<span class="keyword" id="5145604">struct</span>&nbsp;<span class="op" id="5145611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145614">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145624">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145629">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5145635">*</span><span class="ident" id="5145636">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145642">Nodes</span>&nbsp;<span class="op" id="5145648">[</span><span class="op" id="5145649">]</span><span class="ident" id="5145650">Node</span>&nbsp;<span class="comment" id="5145655">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="5145694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5145697">func</span>&nbsp;<span class="op" id="5145702">(</span><span class="ident" id="5145703">t</span>&nbsp;<span class="op" id="5145705">*</span><span class="ident" id="5145706">Tree</span><span class="op" id="5145710">)</span>&nbsp;<span class="ident" id="5145712">newList</span><span class="op" id="5145719">(</span><span class="ident" id="5145720">pos</span>&nbsp;<span class="ident" id="5145724">Pos</span><span class="op" id="5145727">)</span>&nbsp;<span class="op" id="5145729">*</span><span class="ident" id="5145730">ListNode</span>&nbsp;<span class="op" id="5145739">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5145742">return</span>&nbsp;<span class="op" id="5145749">&amp;</span><span class="ident" id="5145750">ListNode</span><span class="op" id="5145758">{</span><span class="ident" id="5145759">tr</span><span class="op" id="5145761">:</span>&nbsp;<span class="ident" id="5145763">t</span><span class="op" id="5145764">,</span>&nbsp;<span class="ident" id="5145766">NodeType</span><span class="op" id="5145774">:</span>&nbsp;<span class="ident" id="5145776">NodeList</span><span class="op" id="5145784">,</span>&nbsp;<span class="ident" id="5145786">Pos</span><span class="op" id="5145789">:</span>&nbsp;<span class="ident" id="5145791">pos</span><span class="op" id="5145794">}</span><br>
<span class="lineno"></span><span class="op" id="5145796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5145799">func</span>&nbsp;<span class="op" id="5145804">(</span><span class="ident" id="5145805">l</span>&nbsp;<span class="op" id="5145807">*</span><span class="ident" id="5145808">ListNode</span><span class="op" id="5145816">)</span>&nbsp;<span class="builtinfunc" id="5145818">append</span><span class="op" id="5145824">(</span><span class="ident" id="5145825">n</span>&nbsp;<span class="ident" id="5145827">Node</span><span class="op" id="5145831">)</span>&nbsp;<span class="op" id="5145833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145836">l</span><span class="op" id="5145837">.</span><span class="ident" id="5145838">Nodes</span>&nbsp;<span class="op" id="5145844">=</span>&nbsp;<span class="builtinfunc" id="5145846">append</span><span class="op" id="5145852">(</span><span class="ident" id="5145853">l</span><span class="op" id="5145854">.</span><span class="ident" id="5145855">Nodes</span><span class="op" id="5145860">,</span>&nbsp;<span class="ident" id="5145862">n</span><span class="op" id="5145863">)</span><br>
<span class="lineno">90</span><span class="op" id="5145865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5145868">func</span>&nbsp;<span class="op" id="5145873">(</span><span class="ident" id="5145874">l</span>&nbsp;<span class="op" id="5145876">*</span><span class="ident" id="5145877">ListNode</span><span class="op" id="5145885">)</span>&nbsp;<span class="ident" id="5145887">tree</span><span class="op" id="5145891">(</span><span class="op" id="5145892">)</span>&nbsp;<span class="op" id="5145894">*</span><span class="ident" id="5145895">Tree</span>&nbsp;<span class="op" id="5145900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5145903">return</span>&nbsp;<span class="ident" id="5145910">l</span><span class="op" id="5145911">.</span><span class="ident" id="5145912">tr</span><br>
<span class="lineno"></span><span class="op" id="5145915">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="5145918">func</span>&nbsp;<span class="op" id="5145923">(</span><span class="ident" id="5145924">l</span>&nbsp;<span class="op" id="5145926">*</span><span class="ident" id="5145927">ListNode</span><span class="op" id="5145935">)</span>&nbsp;<span class="ident" id="5145937">String</span><span class="op" id="5145943">(</span><span class="op" id="5145944">)</span>&nbsp;<span class="builtintype" id="5145946">string</span>&nbsp;<span class="op" id="5145953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145956">b</span>&nbsp;<span class="op" id="5145958">:=</span>&nbsp;<span class="builtinfunc" id="5145961">new</span><span class="op" id="5145964">(</span><span class="ident" id="5145965">bytes</span><span class="op" id="5145970">.</span><span class="ident" id="5145971">Buffer</span><span class="op" id="5145977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5145980">for</span>&nbsp;<span class="ident" id="5145984">_</span><span class="op" id="5145985">,</span>&nbsp;<span class="ident" id="5145987">n</span>&nbsp;<span class="op" id="5145989">:=</span>&nbsp;<span class="keyword" id="5145992">range</span>&nbsp;<span class="ident" id="5145998">l</span><span class="op" id="5145999">.</span><span class="ident" id="5146000">Nodes</span>&nbsp;<span class="op" id="5146006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146010">fmt</span><span class="op" id="5146013">.</span><span class="ident" id="5146014">Fprint</span><span class="op" id="5146020">(</span><span class="ident" id="5146021">b</span><span class="op" id="5146022">,</span>&nbsp;<span class="ident" id="5146024">n</span><span class="op" id="5146025">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5146028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146031">return</span>&nbsp;<span class="ident" id="5146038">b</span><span class="op" id="5146039">.</span><span class="ident" id="5146040">String</span><span class="op" id="5146046">(</span><span class="op" id="5146047">)</span><br>
<span class="lineno"></span><span class="op" id="5146049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5146052">func</span>&nbsp;<span class="op" id="5146057">(</span><span class="ident" id="5146058">l</span>&nbsp;<span class="op" id="5146060">*</span><span class="ident" id="5146061">ListNode</span><span class="op" id="5146069">)</span>&nbsp;<span class="ident" id="5146071">CopyList</span><span class="op" id="5146079">(</span><span class="op" id="5146080">)</span>&nbsp;<span class="op" id="5146082">*</span><span class="ident" id="5146083">ListNode</span>&nbsp;<span class="op" id="5146092">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146095">if</span>&nbsp;<span class="ident" id="5146098">l</span>&nbsp;<span class="op" id="5146100">==</span>&nbsp;<span class="ident" id="5146103">nil</span>&nbsp;<span class="op" id="5146107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146111">return</span>&nbsp;<span class="ident" id="5146118">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5146121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146124">n</span>&nbsp;<span class="op" id="5146126">:=</span>&nbsp;<span class="ident" id="5146129">l</span><span class="op" id="5146130">.</span><span class="ident" id="5146131">tr</span><span class="op" id="5146133">.</span><span class="ident" id="5146134">newList</span><span class="op" id="5146141">(</span><span class="ident" id="5146142">l</span><span class="op" id="5146143">.</span><span class="ident" id="5146144">Pos</span><span class="op" id="5146147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146150">for</span>&nbsp;<span class="ident" id="5146154">_</span><span class="op" id="5146155">,</span>&nbsp;<span class="ident" id="5146157">elem</span>&nbsp;<span class="op" id="5146162">:=</span>&nbsp;<span class="keyword" id="5146165">range</span>&nbsp;<span class="ident" id="5146171">l</span><span class="op" id="5146172">.</span><span class="ident" id="5146173">Nodes</span>&nbsp;<span class="op" id="5146179">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146183">n</span><span class="op" id="5146184">.</span><span class="builtinfunc" id="5146185">append</span><span class="op" id="5146191">(</span><span class="ident" id="5146192">elem</span><span class="op" id="5146196">.</span><span class="ident" id="5146197">Copy</span><span class="op" id="5146201">(</span><span class="op" id="5146202">)</span><span class="op" id="5146203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5146206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146209">return</span>&nbsp;<span class="ident" id="5146216">n</span><br>
<span class="lineno"></span><span class="op" id="5146218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="5146221">func</span>&nbsp;<span class="op" id="5146226">(</span><span class="ident" id="5146227">l</span>&nbsp;<span class="op" id="5146229">*</span><span class="ident" id="5146230">ListNode</span><span class="op" id="5146238">)</span>&nbsp;<span class="ident" id="5146240">Copy</span><span class="op" id="5146244">(</span><span class="op" id="5146245">)</span>&nbsp;<span class="ident" id="5146247">Node</span>&nbsp;<span class="op" id="5146252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146255">return</span>&nbsp;<span class="ident" id="5146262">l</span><span class="op" id="5146263">.</span><span class="ident" id="5146264">CopyList</span><span class="op" id="5146272">(</span><span class="op" id="5146273">)</span><br>
<span class="lineno"></span><span class="op" id="5146275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5146278">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="5146308">type</span>&nbsp;<span class="ident" id="5146313">TextNode</span>&nbsp;<span class="keyword" id="5146322">struct</span>&nbsp;<span class="op" id="5146329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146332">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146342">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146347">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5146352">*</span><span class="ident" id="5146353">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146359">Text</span>&nbsp;<span class="op" id="5146364">[</span><span class="op" id="5146365">]</span><span class="builtintype" id="5146366">byte</span>&nbsp;<span class="comment" id="5146371">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="5146403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5146406">func</span>&nbsp;<span class="op" id="5146411">(</span><span class="ident" id="5146412">t</span>&nbsp;<span class="op" id="5146414">*</span><span class="ident" id="5146415">Tree</span><span class="op" id="5146419">)</span>&nbsp;<span class="ident" id="5146421">newText</span><span class="op" id="5146428">(</span><span class="ident" id="5146429">pos</span>&nbsp;<span class="ident" id="5146433">Pos</span><span class="op" id="5146436">,</span>&nbsp;<span class="ident" id="5146438">text</span>&nbsp;<span class="builtintype" id="5146443">string</span><span class="op" id="5146449">)</span>&nbsp;<span class="op" id="5146451">*</span><span class="ident" id="5146452">TextNode</span>&nbsp;<span class="op" id="5146461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146464">return</span>&nbsp;<span class="op" id="5146471">&amp;</span><span class="ident" id="5146472">TextNode</span><span class="op" id="5146480">{</span><span class="ident" id="5146481">tr</span><span class="op" id="5146483">:</span>&nbsp;<span class="ident" id="5146485">t</span><span class="op" id="5146486">,</span>&nbsp;<span class="ident" id="5146488">NodeType</span><span class="op" id="5146496">:</span>&nbsp;<span class="ident" id="5146498">NodeText</span><span class="op" id="5146506">,</span>&nbsp;<span class="ident" id="5146508">Pos</span><span class="op" id="5146511">:</span>&nbsp;<span class="ident" id="5146513">pos</span><span class="op" id="5146516">,</span>&nbsp;<span class="ident" id="5146518">Text</span><span class="op" id="5146522">:</span>&nbsp;<span class="op" id="5146524">[</span><span class="op" id="5146525">]</span><span class="builtintype" id="5146526">byte</span><span class="op" id="5146530">(</span><span class="ident" id="5146531">text</span><span class="op" id="5146535">)</span><span class="op" id="5146536">}</span><br>
<span class="lineno"></span><span class="op" id="5146538">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="5146541">func</span>&nbsp;<span class="op" id="5146546">(</span><span class="ident" id="5146547">t</span>&nbsp;<span class="op" id="5146549">*</span><span class="ident" id="5146550">TextNode</span><span class="op" id="5146558">)</span>&nbsp;<span class="ident" id="5146560">String</span><span class="op" id="5146566">(</span><span class="op" id="5146567">)</span>&nbsp;<span class="builtintype" id="5146569">string</span>&nbsp;<span class="op" id="5146576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146579">return</span>&nbsp;<span class="ident" id="5146586">fmt</span><span class="op" id="5146589">.</span><span class="ident" id="5146590">Sprintf</span><span class="op" id="5146597">(</span><span class="ident" id="5146598">textFormat</span><span class="op" id="5146608">,</span>&nbsp;<span class="ident" id="5146610">t</span><span class="op" id="5146611">.</span><span class="ident" id="5146612">Text</span><span class="op" id="5146616">)</span><br>
<span class="lineno"></span><span class="op" id="5146618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="5146621">func</span>&nbsp;<span class="op" id="5146626">(</span><span class="ident" id="5146627">t</span>&nbsp;<span class="op" id="5146629">*</span><span class="ident" id="5146630">TextNode</span><span class="op" id="5146638">)</span>&nbsp;<span class="ident" id="5146640">tree</span><span class="op" id="5146644">(</span><span class="op" id="5146645">)</span>&nbsp;<span class="op" id="5146647">*</span><span class="ident" id="5146648">Tree</span>&nbsp;<span class="op" id="5146653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146656">return</span>&nbsp;<span class="ident" id="5146663">t</span><span class="op" id="5146664">.</span><span class="ident" id="5146665">tr</span><br>
<span class="lineno"></span><span class="op" id="5146668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5146671">func</span>&nbsp;<span class="op" id="5146676">(</span><span class="ident" id="5146677">t</span>&nbsp;<span class="op" id="5146679">*</span><span class="ident" id="5146680">TextNode</span><span class="op" id="5146688">)</span>&nbsp;<span class="ident" id="5146690">Copy</span><span class="op" id="5146694">(</span><span class="op" id="5146695">)</span>&nbsp;<span class="ident" id="5146697">Node</span>&nbsp;<span class="op" id="5146702">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5146705">return</span>&nbsp;<span class="op" id="5146712">&amp;</span><span class="ident" id="5146713">TextNode</span><span class="op" id="5146721">{</span><span class="ident" id="5146722">tr</span><span class="op" id="5146724">:</span>&nbsp;<span class="ident" id="5146726">t</span><span class="op" id="5146727">.</span><span class="ident" id="5146728">tr</span><span class="op" id="5146730">,</span>&nbsp;<span class="ident" id="5146732">NodeType</span><span class="op" id="5146740">:</span>&nbsp;<span class="ident" id="5146742">NodeText</span><span class="op" id="5146750">,</span>&nbsp;<span class="ident" id="5146752">Pos</span><span class="op" id="5146755">:</span>&nbsp;<span class="ident" id="5146757">t</span><span class="op" id="5146758">.</span><span class="ident" id="5146759">Pos</span><span class="op" id="5146762">,</span>&nbsp;<span class="ident" id="5146764">Text</span><span class="op" id="5146768">:</span>&nbsp;<span class="builtinfunc" id="5146770">append</span><span class="op" id="5146776">(</span><span class="op" id="5146777">[</span><span class="op" id="5146778">]</span><span class="builtintype" id="5146779">byte</span><span class="op" id="5146783">{</span><span class="op" id="5146784">}</span><span class="op" id="5146785">,</span>&nbsp;<span class="ident" id="5146787">t</span><span class="op" id="5146788">.</span><span class="ident" id="5146789">Text</span><span class="op" id="5146793">...</span><span class="op" id="5146796">)</span><span class="op" id="5146797">}</span><br>
<span class="lineno"></span><span class="op" id="5146799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5146802">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="5146857">type</span>&nbsp;<span class="ident" id="5146862">PipeNode</span>&nbsp;<span class="keyword" id="5146871">struct</span>&nbsp;<span class="op" id="5146878">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146881">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146891">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146896">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5146901">*</span><span class="ident" id="5146902">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146908">Line</span>&nbsp;<span class="builtintype" id="5146913">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5146929">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5146999">Decl</span>&nbsp;<span class="op" id="5147004">[</span><span class="op" id="5147005">]</span><span class="op" id="5147006">*</span><span class="ident" id="5147007">VariableNode</span>&nbsp;<span class="comment" id="5147020">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147064">Cmds</span>&nbsp;<span class="op" id="5147069">[</span><span class="op" id="5147070">]</span><span class="op" id="5147071">*</span><span class="ident" id="5147072">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="5147085">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="5147119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5147122">func</span>&nbsp;<span class="op" id="5147127">(</span><span class="ident" id="5147128">t</span>&nbsp;<span class="op" id="5147130">*</span><span class="ident" id="5147131">Tree</span><span class="op" id="5147135">)</span>&nbsp;<span class="ident" id="5147137">newPipeline</span><span class="op" id="5147148">(</span><span class="ident" id="5147149">pos</span>&nbsp;<span class="ident" id="5147153">Pos</span><span class="op" id="5147156">,</span>&nbsp;<span class="ident" id="5147158">line</span>&nbsp;<span class="builtintype" id="5147163">int</span><span class="op" id="5147166">,</span>&nbsp;<span class="ident" id="5147168">decl</span>&nbsp;<span class="op" id="5147173">[</span><span class="op" id="5147174">]</span><span class="op" id="5147175">*</span><span class="ident" id="5147176">VariableNode</span><span class="op" id="5147188">)</span>&nbsp;<span class="op" id="5147190">*</span><span class="ident" id="5147191">PipeNode</span>&nbsp;<span class="op" id="5147200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147203">return</span>&nbsp;<span class="op" id="5147210">&amp;</span><span class="ident" id="5147211">PipeNode</span><span class="op" id="5147219">{</span><span class="ident" id="5147220">tr</span><span class="op" id="5147222">:</span>&nbsp;<span class="ident" id="5147224">t</span><span class="op" id="5147225">,</span>&nbsp;<span class="ident" id="5147227">NodeType</span><span class="op" id="5147235">:</span>&nbsp;<span class="ident" id="5147237">NodePipe</span><span class="op" id="5147245">,</span>&nbsp;<span class="ident" id="5147247">Pos</span><span class="op" id="5147250">:</span>&nbsp;<span class="ident" id="5147252">pos</span><span class="op" id="5147255">,</span>&nbsp;<span class="ident" id="5147257">Line</span><span class="op" id="5147261">:</span>&nbsp;<span class="ident" id="5147263">line</span><span class="op" id="5147267">,</span>&nbsp;<span class="ident" id="5147269">Decl</span><span class="op" id="5147273">:</span>&nbsp;<span class="ident" id="5147275">decl</span><span class="op" id="5147279">}</span><br>
<span class="lineno">155</span><span class="op" id="5147281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5147284">func</span>&nbsp;<span class="op" id="5147289">(</span><span class="ident" id="5147290">p</span>&nbsp;<span class="op" id="5147292">*</span><span class="ident" id="5147293">PipeNode</span><span class="op" id="5147301">)</span>&nbsp;<span class="builtinfunc" id="5147303">append</span><span class="op" id="5147309">(</span><span class="ident" id="5147310">command</span>&nbsp;<span class="op" id="5147318">*</span><span class="ident" id="5147319">CommandNode</span><span class="op" id="5147330">)</span>&nbsp;<span class="op" id="5147332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147335">p</span><span class="op" id="5147336">.</span><span class="ident" id="5147337">Cmds</span>&nbsp;<span class="op" id="5147342">=</span>&nbsp;<span class="builtinfunc" id="5147344">append</span><span class="op" id="5147350">(</span><span class="ident" id="5147351">p</span><span class="op" id="5147352">.</span><span class="ident" id="5147353">Cmds</span><span class="op" id="5147357">,</span>&nbsp;<span class="ident" id="5147359">command</span><span class="op" id="5147366">)</span><br>
<span class="lineno"></span><span class="op" id="5147368">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="5147371">func</span>&nbsp;<span class="op" id="5147376">(</span><span class="ident" id="5147377">p</span>&nbsp;<span class="op" id="5147379">*</span><span class="ident" id="5147380">PipeNode</span><span class="op" id="5147388">)</span>&nbsp;<span class="ident" id="5147390">String</span><span class="op" id="5147396">(</span><span class="op" id="5147397">)</span>&nbsp;<span class="builtintype" id="5147399">string</span>&nbsp;<span class="op" id="5147406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147409">s</span>&nbsp;<span class="op" id="5147411">:=</span>&nbsp;<span class="string" id="5147414">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147418">if</span>&nbsp;<span class="builtinfunc" id="5147421">len</span><span class="op" id="5147424">(</span><span class="ident" id="5147425">p</span><span class="op" id="5147426">.</span><span class="ident" id="5147427">Decl</span><span class="op" id="5147431">)</span>&nbsp;<span class="op" id="5147433">&gt;</span>&nbsp;<span class="num" id="5147435">0</span>&nbsp;<span class="op" id="5147437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147441">for</span>&nbsp;<span class="ident" id="5147445">i</span><span class="op" id="5147446">,</span>&nbsp;<span class="ident" id="5147448">v</span>&nbsp;<span class="op" id="5147450">:=</span>&nbsp;<span class="keyword" id="5147453">range</span>&nbsp;<span class="ident" id="5147459">p</span><span class="op" id="5147460">.</span><span class="ident" id="5147461">Decl</span>&nbsp;<span class="op" id="5147466">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147471">if</span>&nbsp;<span class="ident" id="5147474">i</span>&nbsp;<span class="op" id="5147476">&gt;</span>&nbsp;<span class="num" id="5147478">0</span>&nbsp;<span class="op" id="5147480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147486">s</span>&nbsp;<span class="op" id="5147488">+=</span>&nbsp;<span class="string" id="5147491">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5147499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147504">s</span>&nbsp;<span class="op" id="5147506">+=</span>&nbsp;<span class="ident" id="5147509">v</span><span class="op" id="5147510">.</span><span class="ident" id="5147511">String</span><span class="op" id="5147517">(</span><span class="op" id="5147518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5147522">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147526">s</span>&nbsp;<span class="op" id="5147528">+=</span>&nbsp;<span class="string" id="5147531">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5147539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147542">for</span>&nbsp;<span class="ident" id="5147546">i</span><span class="op" id="5147547">,</span>&nbsp;<span class="ident" id="5147549">c</span>&nbsp;<span class="op" id="5147551">:=</span>&nbsp;<span class="keyword" id="5147554">range</span>&nbsp;<span class="ident" id="5147560">p</span><span class="op" id="5147561">.</span><span class="ident" id="5147562">Cmds</span>&nbsp;<span class="op" id="5147567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147571">if</span>&nbsp;<span class="ident" id="5147574">i</span>&nbsp;<span class="op" id="5147576">&gt;</span>&nbsp;<span class="num" id="5147578">0</span>&nbsp;<span class="op" id="5147580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147585">s</span>&nbsp;<span class="op" id="5147587">+=</span>&nbsp;<span class="string" id="5147590">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5147598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147602">s</span>&nbsp;<span class="op" id="5147604">+=</span>&nbsp;<span class="ident" id="5147607">c</span><span class="op" id="5147608">.</span><span class="ident" id="5147609">String</span><span class="op" id="5147615">(</span><span class="op" id="5147616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5147619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147622">return</span>&nbsp;<span class="ident" id="5147629">s</span><br>
<span class="lineno"></span><span class="op" id="5147631">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="5147634">func</span>&nbsp;<span class="op" id="5147639">(</span><span class="ident" id="5147640">p</span>&nbsp;<span class="op" id="5147642">*</span><span class="ident" id="5147643">PipeNode</span><span class="op" id="5147651">)</span>&nbsp;<span class="ident" id="5147653">tree</span><span class="op" id="5147657">(</span><span class="op" id="5147658">)</span>&nbsp;<span class="op" id="5147660">*</span><span class="ident" id="5147661">Tree</span>&nbsp;<span class="op" id="5147666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147669">return</span>&nbsp;<span class="ident" id="5147676">p</span><span class="op" id="5147677">.</span><span class="ident" id="5147678">tr</span><br>
<span class="lineno"></span><span class="op" id="5147681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="5147684">func</span>&nbsp;<span class="op" id="5147689">(</span><span class="ident" id="5147690">p</span>&nbsp;<span class="op" id="5147692">*</span><span class="ident" id="5147693">PipeNode</span><span class="op" id="5147701">)</span>&nbsp;<span class="ident" id="5147703">CopyPipe</span><span class="op" id="5147711">(</span><span class="op" id="5147712">)</span>&nbsp;<span class="op" id="5147714">*</span><span class="ident" id="5147715">PipeNode</span>&nbsp;<span class="op" id="5147724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147727">if</span>&nbsp;<span class="ident" id="5147730">p</span>&nbsp;<span class="op" id="5147732">==</span>&nbsp;<span class="ident" id="5147735">nil</span>&nbsp;<span class="op" id="5147739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147743">return</span>&nbsp;<span class="ident" id="5147750">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5147753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147756">var</span>&nbsp;<span class="ident" id="5147760">decl</span>&nbsp;<span class="op" id="5147765">[</span><span class="op" id="5147766">]</span><span class="op" id="5147767">*</span><span class="ident" id="5147768">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147782">for</span>&nbsp;<span class="ident" id="5147786">_</span><span class="op" id="5147787">,</span>&nbsp;<span class="ident" id="5147789">d</span>&nbsp;<span class="op" id="5147791">:=</span>&nbsp;<span class="keyword" id="5147794">range</span>&nbsp;<span class="ident" id="5147800">p</span><span class="op" id="5147801">.</span><span class="ident" id="5147802">Decl</span>&nbsp;<span class="op" id="5147807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147811">decl</span>&nbsp;<span class="op" id="5147816">=</span>&nbsp;<span class="builtinfunc" id="5147818">append</span><span class="op" id="5147824">(</span><span class="ident" id="5147825">decl</span><span class="op" id="5147829">,</span>&nbsp;<span class="ident" id="5147831">d</span><span class="op" id="5147832">.</span><span class="ident" id="5147833">Copy</span><span class="op" id="5147837">(</span><span class="op" id="5147838">)</span><span class="op" id="5147839">.</span><span class="op" id="5147840">(</span><span class="op" id="5147841">*</span><span class="ident" id="5147842">VariableNode</span><span class="op" id="5147854">)</span><span class="op" id="5147855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5147858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147861">n</span>&nbsp;<span class="op" id="5147863">:=</span>&nbsp;<span class="ident" id="5147866">p</span><span class="op" id="5147867">.</span><span class="ident" id="5147868">tr</span><span class="op" id="5147870">.</span><span class="ident" id="5147871">newPipeline</span><span class="op" id="5147882">(</span><span class="ident" id="5147883">p</span><span class="op" id="5147884">.</span><span class="ident" id="5147885">Pos</span><span class="op" id="5147888">,</span>&nbsp;<span class="ident" id="5147890">p</span><span class="op" id="5147891">.</span><span class="ident" id="5147892">Line</span><span class="op" id="5147896">,</span>&nbsp;<span class="ident" id="5147898">decl</span><span class="op" id="5147902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147905">for</span>&nbsp;<span class="ident" id="5147909">_</span><span class="op" id="5147910">,</span>&nbsp;<span class="ident" id="5147912">c</span>&nbsp;<span class="op" id="5147914">:=</span>&nbsp;<span class="keyword" id="5147917">range</span>&nbsp;<span class="ident" id="5147923">p</span><span class="op" id="5147924">.</span><span class="ident" id="5147925">Cmds</span>&nbsp;<span class="op" id="5147930">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5147934">n</span><span class="op" id="5147935">.</span><span class="builtinfunc" id="5147936">append</span><span class="op" id="5147942">(</span><span class="ident" id="5147943">c</span><span class="op" id="5147944">.</span><span class="ident" id="5147945">Copy</span><span class="op" id="5147949">(</span><span class="op" id="5147950">)</span><span class="op" id="5147951">.</span><span class="op" id="5147952">(</span><span class="op" id="5147953">*</span><span class="ident" id="5147954">CommandNode</span><span class="op" id="5147965">)</span><span class="op" id="5147966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5147969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5147972">return</span>&nbsp;<span class="ident" id="5147979">n</span><br>
<span class="lineno"></span><span class="op" id="5147981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="5147984">func</span>&nbsp;<span class="op" id="5147989">(</span><span class="ident" id="5147990">p</span>&nbsp;<span class="op" id="5147992">*</span><span class="ident" id="5147993">PipeNode</span><span class="op" id="5148001">)</span>&nbsp;<span class="ident" id="5148003">Copy</span><span class="op" id="5148007">(</span><span class="op" id="5148008">)</span>&nbsp;<span class="ident" id="5148010">Node</span>&nbsp;<span class="op" id="5148015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5148018">return</span>&nbsp;<span class="ident" id="5148025">p</span><span class="op" id="5148026">.</span><span class="ident" id="5148027">CopyPipe</span><span class="op" id="5148035">(</span><span class="op" id="5148036">)</span><br>
<span class="lineno"></span><span class="op" id="5148038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5148041">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="5148106">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="5148176">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="5148239">type</span>&nbsp;<span class="ident" id="5148244">ActionNode</span>&nbsp;<span class="keyword" id="5148255">struct</span>&nbsp;<span class="op" id="5148262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148265">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148275">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148280">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5148285">*</span><span class="ident" id="5148286">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148292">Line</span>&nbsp;<span class="builtintype" id="5148297">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5148307">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148377">Pipe</span>&nbsp;<span class="op" id="5148382">*</span><span class="ident" id="5148383">PipeNode</span>&nbsp;<span class="comment" id="5148392">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="5148423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="5148426">func</span>&nbsp;<span class="op" id="5148431">(</span><span class="ident" id="5148432">t</span>&nbsp;<span class="op" id="5148434">*</span><span class="ident" id="5148435">Tree</span><span class="op" id="5148439">)</span>&nbsp;<span class="ident" id="5148441">newAction</span><span class="op" id="5148450">(</span><span class="ident" id="5148451">pos</span>&nbsp;<span class="ident" id="5148455">Pos</span><span class="op" id="5148458">,</span>&nbsp;<span class="ident" id="5148460">line</span>&nbsp;<span class="builtintype" id="5148465">int</span><span class="op" id="5148468">,</span>&nbsp;<span class="ident" id="5148470">pipe</span>&nbsp;<span class="op" id="5148475">*</span><span class="ident" id="5148476">PipeNode</span><span class="op" id="5148484">)</span>&nbsp;<span class="op" id="5148486">*</span><span class="ident" id="5148487">ActionNode</span>&nbsp;<span class="op" id="5148498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5148501">return</span>&nbsp;<span class="op" id="5148508">&amp;</span><span class="ident" id="5148509">ActionNode</span><span class="op" id="5148519">{</span><span class="ident" id="5148520">tr</span><span class="op" id="5148522">:</span>&nbsp;<span class="ident" id="5148524">t</span><span class="op" id="5148525">,</span>&nbsp;<span class="ident" id="5148527">NodeType</span><span class="op" id="5148535">:</span>&nbsp;<span class="ident" id="5148537">NodeAction</span><span class="op" id="5148547">,</span>&nbsp;<span class="ident" id="5148549">Pos</span><span class="op" id="5148552">:</span>&nbsp;<span class="ident" id="5148554">pos</span><span class="op" id="5148557">,</span>&nbsp;<span class="ident" id="5148559">Line</span><span class="op" id="5148563">:</span>&nbsp;<span class="ident" id="5148565">line</span><span class="op" id="5148569">,</span>&nbsp;<span class="ident" id="5148571">Pipe</span><span class="op" id="5148575">:</span>&nbsp;<span class="ident" id="5148577">pipe</span><span class="op" id="5148581">}</span><br>
<span class="lineno"></span><span class="op" id="5148583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5148586">func</span>&nbsp;<span class="op" id="5148591">(</span><span class="ident" id="5148592">a</span>&nbsp;<span class="op" id="5148594">*</span><span class="ident" id="5148595">ActionNode</span><span class="op" id="5148605">)</span>&nbsp;<span class="ident" id="5148607">String</span><span class="op" id="5148613">(</span><span class="op" id="5148614">)</span>&nbsp;<span class="builtintype" id="5148616">string</span>&nbsp;<span class="op" id="5148623">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5148626">return</span>&nbsp;<span class="ident" id="5148633">fmt</span><span class="op" id="5148636">.</span><span class="ident" id="5148637">Sprintf</span><span class="op" id="5148644">(</span><span class="string" id="5148645">&#34;{{%s}}&#34;</span><span class="op" id="5148653">,</span>&nbsp;<span class="ident" id="5148655">a</span><span class="op" id="5148656">.</span><span class="ident" id="5148657">Pipe</span><span class="op" id="5148661">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="5148664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5148667">func</span>&nbsp;<span class="op" id="5148672">(</span><span class="ident" id="5148673">a</span>&nbsp;<span class="op" id="5148675">*</span><span class="ident" id="5148676">ActionNode</span><span class="op" id="5148686">)</span>&nbsp;<span class="ident" id="5148688">tree</span><span class="op" id="5148692">(</span><span class="op" id="5148693">)</span>&nbsp;<span class="op" id="5148695">*</span><span class="ident" id="5148696">Tree</span>&nbsp;<span class="op" id="5148701">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5148704">return</span>&nbsp;<span class="ident" id="5148711">a</span><span class="op" id="5148712">.</span><span class="ident" id="5148713">tr</span><br>
<span class="lineno"></span><span class="op" id="5148716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5148719">func</span>&nbsp;<span class="op" id="5148724">(</span><span class="ident" id="5148725">a</span>&nbsp;<span class="op" id="5148727">*</span><span class="ident" id="5148728">ActionNode</span><span class="op" id="5148738">)</span>&nbsp;<span class="ident" id="5148740">Copy</span><span class="op" id="5148744">(</span><span class="op" id="5148745">)</span>&nbsp;<span class="ident" id="5148747">Node</span>&nbsp;<span class="op" id="5148752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5148755">return</span>&nbsp;<span class="ident" id="5148762">a</span><span class="op" id="5148763">.</span><span class="ident" id="5148764">tr</span><span class="op" id="5148766">.</span><span class="ident" id="5148767">newAction</span><span class="op" id="5148776">(</span><span class="ident" id="5148777">a</span><span class="op" id="5148778">.</span><span class="ident" id="5148779">Pos</span><span class="op" id="5148782">,</span>&nbsp;<span class="ident" id="5148784">a</span><span class="op" id="5148785">.</span><span class="ident" id="5148786">Line</span><span class="op" id="5148790">,</span>&nbsp;<span class="ident" id="5148792">a</span><span class="op" id="5148793">.</span><span class="ident" id="5148794">Pipe</span><span class="op" id="5148798">.</span><span class="ident" id="5148799">CopyPipe</span><span class="op" id="5148807">(</span><span class="op" id="5148808">)</span><span class="op" id="5148809">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="5148812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5148815">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="5148888">type</span>&nbsp;<span class="ident" id="5148893">CommandNode</span>&nbsp;<span class="keyword" id="5148905">struct</span>&nbsp;<span class="op" id="5148912">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148915">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148925">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148930">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5148935">*</span><span class="ident" id="5148936">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5148942">Args</span>&nbsp;<span class="op" id="5148947">[</span><span class="op" id="5148948">]</span><span class="ident" id="5148949">Node</span>&nbsp;<span class="comment" id="5148954">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="5149017">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="5149020">func</span>&nbsp;<span class="op" id="5149025">(</span><span class="ident" id="5149026">t</span>&nbsp;<span class="op" id="5149028">*</span><span class="ident" id="5149029">Tree</span><span class="op" id="5149033">)</span>&nbsp;<span class="ident" id="5149035">newCommand</span><span class="op" id="5149045">(</span><span class="ident" id="5149046">pos</span>&nbsp;<span class="ident" id="5149050">Pos</span><span class="op" id="5149053">)</span>&nbsp;<span class="op" id="5149055">*</span><span class="ident" id="5149056">CommandNode</span>&nbsp;<span class="op" id="5149068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149071">return</span>&nbsp;<span class="op" id="5149078">&amp;</span><span class="ident" id="5149079">CommandNode</span><span class="op" id="5149090">{</span><span class="ident" id="5149091">tr</span><span class="op" id="5149093">:</span>&nbsp;<span class="ident" id="5149095">t</span><span class="op" id="5149096">,</span>&nbsp;<span class="ident" id="5149098">NodeType</span><span class="op" id="5149106">:</span>&nbsp;<span class="ident" id="5149108">NodeCommand</span><span class="op" id="5149119">,</span>&nbsp;<span class="ident" id="5149121">Pos</span><span class="op" id="5149124">:</span>&nbsp;<span class="ident" id="5149126">pos</span><span class="op" id="5149129">}</span><br>
<span class="lineno"></span><span class="op" id="5149131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="5149134">func</span>&nbsp;<span class="op" id="5149139">(</span><span class="ident" id="5149140">c</span>&nbsp;<span class="op" id="5149142">*</span><span class="ident" id="5149143">CommandNode</span><span class="op" id="5149154">)</span>&nbsp;<span class="builtinfunc" id="5149156">append</span><span class="op" id="5149162">(</span><span class="ident" id="5149163">arg</span>&nbsp;<span class="ident" id="5149167">Node</span><span class="op" id="5149171">)</span>&nbsp;<span class="op" id="5149173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149176">c</span><span class="op" id="5149177">.</span><span class="ident" id="5149178">Args</span>&nbsp;<span class="op" id="5149183">=</span>&nbsp;<span class="builtinfunc" id="5149185">append</span><span class="op" id="5149191">(</span><span class="ident" id="5149192">c</span><span class="op" id="5149193">.</span><span class="ident" id="5149194">Args</span><span class="op" id="5149198">,</span>&nbsp;<span class="ident" id="5149200">arg</span><span class="op" id="5149203">)</span><br>
<span class="lineno"></span><span class="op" id="5149205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5149208">func</span>&nbsp;<span class="op" id="5149213">(</span><span class="ident" id="5149214">c</span>&nbsp;<span class="op" id="5149216">*</span><span class="ident" id="5149217">CommandNode</span><span class="op" id="5149228">)</span>&nbsp;<span class="ident" id="5149230">String</span><span class="op" id="5149236">(</span><span class="op" id="5149237">)</span>&nbsp;<span class="builtintype" id="5149239">string</span>&nbsp;<span class="op" id="5149246">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149249">s</span>&nbsp;<span class="op" id="5149251">:=</span>&nbsp;<span class="string" id="5149254">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149258">for</span>&nbsp;<span class="ident" id="5149262">i</span><span class="op" id="5149263">,</span>&nbsp;<span class="ident" id="5149265">arg</span>&nbsp;<span class="op" id="5149269">:=</span>&nbsp;<span class="keyword" id="5149272">range</span>&nbsp;<span class="ident" id="5149278">c</span><span class="op" id="5149279">.</span><span class="ident" id="5149280">Args</span>&nbsp;<span class="op" id="5149285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149289">if</span>&nbsp;<span class="ident" id="5149292">i</span>&nbsp;<span class="op" id="5149294">&gt;</span>&nbsp;<span class="num" id="5149296">0</span>&nbsp;<span class="op" id="5149298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149303">s</span>&nbsp;<span class="op" id="5149305">+=</span>&nbsp;<span class="string" id="5149308">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5149314">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149318">if</span>&nbsp;<span class="ident" id="5149321">arg</span><span class="op" id="5149324">,</span>&nbsp;<span class="ident" id="5149326">ok</span>&nbsp;<span class="op" id="5149329">:=</span>&nbsp;<span class="ident" id="5149332">arg</span><span class="op" id="5149335">.</span><span class="op" id="5149336">(</span><span class="op" id="5149337">*</span><span class="ident" id="5149338">PipeNode</span><span class="op" id="5149346">)</span><span class="op" id="5149347">;</span>&nbsp;<span class="ident" id="5149349">ok</span>&nbsp;<span class="op" id="5149352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149357">s</span>&nbsp;<span class="op" id="5149359">+=</span>&nbsp;<span class="string" id="5149362">&#34;(&#34;</span>&nbsp;<span class="op" id="5149366">+</span>&nbsp;<span class="ident" id="5149368">arg</span><span class="op" id="5149371">.</span><span class="ident" id="5149372">String</span><span class="op" id="5149378">(</span><span class="op" id="5149379">)</span>&nbsp;<span class="op" id="5149381">+</span>&nbsp;<span class="string" id="5149383">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149390">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5149401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149405">s</span>&nbsp;<span class="op" id="5149407">+=</span>&nbsp;<span class="ident" id="5149410">arg</span><span class="op" id="5149413">.</span><span class="ident" id="5149414">String</span><span class="op" id="5149420">(</span><span class="op" id="5149421">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5149424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149427">return</span>&nbsp;<span class="ident" id="5149434">s</span><br>
<span class="lineno"></span><span class="op" id="5149436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5149439">func</span>&nbsp;<span class="op" id="5149444">(</span><span class="ident" id="5149445">c</span>&nbsp;<span class="op" id="5149447">*</span><span class="ident" id="5149448">CommandNode</span><span class="op" id="5149459">)</span>&nbsp;<span class="ident" id="5149461">tree</span><span class="op" id="5149465">(</span><span class="op" id="5149466">)</span>&nbsp;<span class="op" id="5149468">*</span><span class="ident" id="5149469">Tree</span>&nbsp;<span class="op" id="5149474">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149477">return</span>&nbsp;<span class="ident" id="5149484">c</span><span class="op" id="5149485">.</span><span class="ident" id="5149486">tr</span><br>
<span class="lineno"></span><span class="op" id="5149489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5149492">func</span>&nbsp;<span class="op" id="5149497">(</span><span class="ident" id="5149498">c</span>&nbsp;<span class="op" id="5149500">*</span><span class="ident" id="5149501">CommandNode</span><span class="op" id="5149512">)</span>&nbsp;<span class="ident" id="5149514">Copy</span><span class="op" id="5149518">(</span><span class="op" id="5149519">)</span>&nbsp;<span class="ident" id="5149521">Node</span>&nbsp;<span class="op" id="5149526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149529">if</span>&nbsp;<span class="ident" id="5149532">c</span>&nbsp;<span class="op" id="5149534">==</span>&nbsp;<span class="ident" id="5149537">nil</span>&nbsp;<span class="op" id="5149541">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149545">return</span>&nbsp;<span class="ident" id="5149552">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5149555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149558">n</span>&nbsp;<span class="op" id="5149560">:=</span>&nbsp;<span class="ident" id="5149563">c</span><span class="op" id="5149564">.</span><span class="ident" id="5149565">tr</span><span class="op" id="5149567">.</span><span class="ident" id="5149568">newCommand</span><span class="op" id="5149578">(</span><span class="ident" id="5149579">c</span><span class="op" id="5149580">.</span><span class="ident" id="5149581">Pos</span><span class="op" id="5149584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149587">for</span>&nbsp;<span class="ident" id="5149591">_</span><span class="op" id="5149592">,</span>&nbsp;<span class="ident" id="5149594">c</span>&nbsp;<span class="op" id="5149596">:=</span>&nbsp;<span class="keyword" id="5149599">range</span>&nbsp;<span class="ident" id="5149605">c</span><span class="op" id="5149606">.</span><span class="ident" id="5149607">Args</span>&nbsp;<span class="op" id="5149612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149616">n</span><span class="op" id="5149617">.</span><span class="builtinfunc" id="5149618">append</span><span class="op" id="5149624">(</span><span class="ident" id="5149625">c</span><span class="op" id="5149626">.</span><span class="ident" id="5149627">Copy</span><span class="op" id="5149631">(</span><span class="op" id="5149632">)</span><span class="op" id="5149633">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5149636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149639">return</span>&nbsp;<span class="ident" id="5149646">n</span><br>
<span class="lineno"></span><span class="op" id="5149648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5149651">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="5149690">type</span>&nbsp;<span class="ident" id="5149695">IdentifierNode</span>&nbsp;<span class="keyword" id="5149710">struct</span>&nbsp;<span class="op" id="5149717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149720">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149730">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149735">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5149741">*</span><span class="ident" id="5149742">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5149748">Ident</span>&nbsp;<span class="builtintype" id="5149754">string</span>&nbsp;<span class="comment" id="5149761">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="5149787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5149790">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5149868">func</span>&nbsp;<span class="ident" id="5149873">NewIdentifier</span><span class="op" id="5149886">(</span><span class="ident" id="5149887">ident</span>&nbsp;<span class="builtintype" id="5149893">string</span><span class="op" id="5149899">)</span>&nbsp;<span class="op" id="5149901">*</span><span class="ident" id="5149902">IdentifierNode</span>&nbsp;<span class="op" id="5149917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5149920">return</span>&nbsp;<span class="op" id="5149927">&amp;</span><span class="ident" id="5149928">IdentifierNode</span><span class="op" id="5149942">{</span><span class="ident" id="5149943">NodeType</span><span class="op" id="5149951">:</span>&nbsp;<span class="ident" id="5149953">NodeIdentifier</span><span class="op" id="5149967">,</span>&nbsp;<span class="ident" id="5149969">Ident</span><span class="op" id="5149974">:</span>&nbsp;<span class="ident" id="5149976">ident</span><span class="op" id="5149981">}</span><br>
<span class="lineno">290</span><span class="op" id="5149983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5149986">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="5150082">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="5150110">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="5150132">func</span>&nbsp;<span class="op" id="5150137">(</span><span class="ident" id="5150138">i</span>&nbsp;<span class="op" id="5150140">*</span><span class="ident" id="5150141">IdentifierNode</span><span class="op" id="5150155">)</span>&nbsp;<span class="ident" id="5150157">SetPos</span><span class="op" id="5150163">(</span><span class="ident" id="5150164">pos</span>&nbsp;<span class="ident" id="5150168">Pos</span><span class="op" id="5150171">)</span>&nbsp;<span class="op" id="5150173">*</span><span class="ident" id="5150174">IdentifierNode</span>&nbsp;<span class="op" id="5150189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5150192">i</span><span class="op" id="5150193">.</span><span class="ident" id="5150194">Pos</span>&nbsp;<span class="op" id="5150198">=</span>&nbsp;<span class="ident" id="5150200">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5150205">return</span>&nbsp;<span class="ident" id="5150212">i</span><br>
<span class="lineno"></span><span class="op" id="5150214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="5150217">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="5150330">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="5150358">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="5150380">func</span>&nbsp;<span class="op" id="5150385">(</span><span class="ident" id="5150386">i</span>&nbsp;<span class="op" id="5150388">*</span><span class="ident" id="5150389">IdentifierNode</span><span class="op" id="5150403">)</span>&nbsp;<span class="ident" id="5150405">SetTree</span><span class="op" id="5150412">(</span><span class="ident" id="5150413">t</span>&nbsp;<span class="op" id="5150415">*</span><span class="ident" id="5150416">Tree</span><span class="op" id="5150420">)</span>&nbsp;<span class="op" id="5150422">*</span><span class="ident" id="5150423">IdentifierNode</span>&nbsp;<span class="op" id="5150438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5150441">i</span><span class="op" id="5150442">.</span><span class="ident" id="5150443">tr</span>&nbsp;<span class="op" id="5150446">=</span>&nbsp;<span class="ident" id="5150448">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5150451">return</span>&nbsp;<span class="ident" id="5150458">i</span><br>
<span class="lineno"></span><span class="op" id="5150460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150463">func</span>&nbsp;<span class="op" id="5150468">(</span><span class="ident" id="5150469">i</span>&nbsp;<span class="op" id="5150471">*</span><span class="ident" id="5150472">IdentifierNode</span><span class="op" id="5150486">)</span>&nbsp;<span class="ident" id="5150488">String</span><span class="op" id="5150494">(</span><span class="op" id="5150495">)</span>&nbsp;<span class="builtintype" id="5150497">string</span>&nbsp;<span class="op" id="5150504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5150507">return</span>&nbsp;<span class="ident" id="5150514">i</span><span class="op" id="5150515">.</span><span class="ident" id="5150516">Ident</span><br>
<span class="lineno">310</span><span class="op" id="5150522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150525">func</span>&nbsp;<span class="op" id="5150530">(</span><span class="ident" id="5150531">i</span>&nbsp;<span class="op" id="5150533">*</span><span class="ident" id="5150534">IdentifierNode</span><span class="op" id="5150548">)</span>&nbsp;<span class="ident" id="5150550">tree</span><span class="op" id="5150554">(</span><span class="op" id="5150555">)</span>&nbsp;<span class="op" id="5150557">*</span><span class="ident" id="5150558">Tree</span>&nbsp;<span class="op" id="5150563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5150566">return</span>&nbsp;<span class="ident" id="5150573">i</span><span class="op" id="5150574">.</span><span class="ident" id="5150575">tr</span><br>
<span class="lineno"></span><span class="op" id="5150578">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5150581">func</span>&nbsp;<span class="op" id="5150586">(</span><span class="ident" id="5150587">i</span>&nbsp;<span class="op" id="5150589">*</span><span class="ident" id="5150590">IdentifierNode</span><span class="op" id="5150604">)</span>&nbsp;<span class="ident" id="5150606">Copy</span><span class="op" id="5150610">(</span><span class="op" id="5150611">)</span>&nbsp;<span class="ident" id="5150613">Node</span>&nbsp;<span class="op" id="5150618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5150621">return</span>&nbsp;<span class="ident" id="5150628">NewIdentifier</span><span class="op" id="5150641">(</span><span class="ident" id="5150642">i</span><span class="op" id="5150643">.</span><span class="ident" id="5150644">Ident</span><span class="op" id="5150649">)</span><span class="op" id="5150650">.</span><span class="ident" id="5150651">SetTree</span><span class="op" id="5150658">(</span><span class="ident" id="5150659">i</span><span class="op" id="5150660">.</span><span class="ident" id="5150661">tr</span><span class="op" id="5150663">)</span><span class="op" id="5150664">.</span><span class="ident" id="5150665">SetPos</span><span class="op" id="5150671">(</span><span class="ident" id="5150672">i</span><span class="op" id="5150673">.</span><span class="ident" id="5150674">Pos</span><span class="op" id="5150677">)</span><br>
<span class="lineno"></span><span class="op" id="5150679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5150682">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="5150758">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5150816">type</span>&nbsp;<span class="ident" id="5150821">VariableNode</span>&nbsp;<span class="keyword" id="5150834">struct</span>&nbsp;<span class="op" id="5150841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5150844">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5150854">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5150859">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5150865">*</span><span class="ident" id="5150866">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5150872">Ident</span>&nbsp;<span class="op" id="5150878">[</span><span class="op" id="5150879">]</span><span class="builtintype" id="5150880">string</span>&nbsp;<span class="comment" id="5150887">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="5150933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150936">func</span>&nbsp;<span class="op" id="5150941">(</span><span class="ident" id="5150942">t</span>&nbsp;<span class="op" id="5150944">*</span><span class="ident" id="5150945">Tree</span><span class="op" id="5150949">)</span>&nbsp;<span class="ident" id="5150951">newVariable</span><span class="op" id="5150962">(</span><span class="ident" id="5150963">pos</span>&nbsp;<span class="ident" id="5150967">Pos</span><span class="op" id="5150970">,</span>&nbsp;<span class="ident" id="5150972">ident</span>&nbsp;<span class="builtintype" id="5150978">string</span><span class="op" id="5150984">)</span>&nbsp;<span class="op" id="5150986">*</span><span class="ident" id="5150987">VariableNode</span>&nbsp;<span class="op" id="5151000">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151003">return</span>&nbsp;<span class="op" id="5151010">&amp;</span><span class="ident" id="5151011">VariableNode</span><span class="op" id="5151023">{</span><span class="ident" id="5151024">tr</span><span class="op" id="5151026">:</span>&nbsp;<span class="ident" id="5151028">t</span><span class="op" id="5151029">,</span>&nbsp;<span class="ident" id="5151031">NodeType</span><span class="op" id="5151039">:</span>&nbsp;<span class="ident" id="5151041">NodeVariable</span><span class="op" id="5151053">,</span>&nbsp;<span class="ident" id="5151055">Pos</span><span class="op" id="5151058">:</span>&nbsp;<span class="ident" id="5151060">pos</span><span class="op" id="5151063">,</span>&nbsp;<span class="ident" id="5151065">Ident</span><span class="op" id="5151070">:</span>&nbsp;<span class="ident" id="5151072">strings</span><span class="op" id="5151079">.</span><span class="ident" id="5151080">Split</span><span class="op" id="5151085">(</span><span class="ident" id="5151086">ident</span><span class="op" id="5151091">,</span>&nbsp;<span class="string" id="5151093">&#34;.&#34;</span><span class="op" id="5151096">)</span><span class="op" id="5151097">}</span><br>
<span class="lineno"></span><span class="op" id="5151099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5151102">func</span>&nbsp;<span class="op" id="5151107">(</span><span class="ident" id="5151108">v</span>&nbsp;<span class="op" id="5151110">*</span><span class="ident" id="5151111">VariableNode</span><span class="op" id="5151123">)</span>&nbsp;<span class="ident" id="5151125">String</span><span class="op" id="5151131">(</span><span class="op" id="5151132">)</span>&nbsp;<span class="builtintype" id="5151134">string</span>&nbsp;<span class="op" id="5151141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5151144">s</span>&nbsp;<span class="op" id="5151146">:=</span>&nbsp;<span class="string" id="5151149">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151153">for</span>&nbsp;<span class="ident" id="5151157">i</span><span class="op" id="5151158">,</span>&nbsp;<span class="ident" id="5151160">id</span>&nbsp;<span class="op" id="5151163">:=</span>&nbsp;<span class="keyword" id="5151166">range</span>&nbsp;<span class="ident" id="5151172">v</span><span class="op" id="5151173">.</span><span class="ident" id="5151174">Ident</span>&nbsp;<span class="op" id="5151180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151184">if</span>&nbsp;<span class="ident" id="5151187">i</span>&nbsp;<span class="op" id="5151189">&gt;</span>&nbsp;<span class="num" id="5151191">0</span>&nbsp;<span class="op" id="5151193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5151198">s</span>&nbsp;<span class="op" id="5151200">+=</span>&nbsp;<span class="string" id="5151203">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5151209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5151213">s</span>&nbsp;<span class="op" id="5151215">+=</span>&nbsp;<span class="ident" id="5151218">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5151222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151225">return</span>&nbsp;<span class="ident" id="5151232">s</span><br>
<span class="lineno"></span><span class="op" id="5151234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5151237">func</span>&nbsp;<span class="op" id="5151242">(</span><span class="ident" id="5151243">v</span>&nbsp;<span class="op" id="5151245">*</span><span class="ident" id="5151246">VariableNode</span><span class="op" id="5151258">)</span>&nbsp;<span class="ident" id="5151260">tree</span><span class="op" id="5151264">(</span><span class="op" id="5151265">)</span>&nbsp;<span class="op" id="5151267">*</span><span class="ident" id="5151268">Tree</span>&nbsp;<span class="op" id="5151273">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151276">return</span>&nbsp;<span class="ident" id="5151283">v</span><span class="op" id="5151284">.</span><span class="ident" id="5151285">tr</span><br>
<span class="lineno"></span><span class="op" id="5151288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5151291">func</span>&nbsp;<span class="op" id="5151296">(</span><span class="ident" id="5151297">v</span>&nbsp;<span class="op" id="5151299">*</span><span class="ident" id="5151300">VariableNode</span><span class="op" id="5151312">)</span>&nbsp;<span class="ident" id="5151314">Copy</span><span class="op" id="5151318">(</span><span class="op" id="5151319">)</span>&nbsp;<span class="ident" id="5151321">Node</span>&nbsp;<span class="op" id="5151326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151329">return</span>&nbsp;<span class="op" id="5151336">&amp;</span><span class="ident" id="5151337">VariableNode</span><span class="op" id="5151349">{</span><span class="ident" id="5151350">tr</span><span class="op" id="5151352">:</span>&nbsp;<span class="ident" id="5151354">v</span><span class="op" id="5151355">.</span><span class="ident" id="5151356">tr</span><span class="op" id="5151358">,</span>&nbsp;<span class="ident" id="5151360">NodeType</span><span class="op" id="5151368">:</span>&nbsp;<span class="ident" id="5151370">NodeVariable</span><span class="op" id="5151382">,</span>&nbsp;<span class="ident" id="5151384">Pos</span><span class="op" id="5151387">:</span>&nbsp;<span class="ident" id="5151389">v</span><span class="op" id="5151390">.</span><span class="ident" id="5151391">Pos</span><span class="op" id="5151394">,</span>&nbsp;<span class="ident" id="5151396">Ident</span><span class="op" id="5151401">:</span>&nbsp;<span class="builtinfunc" id="5151403">append</span><span class="op" id="5151409">(</span><span class="op" id="5151410">[</span><span class="op" id="5151411">]</span><span class="builtintype" id="5151412">string</span><span class="op" id="5151418">{</span><span class="op" id="5151419">}</span><span class="op" id="5151420">,</span>&nbsp;<span class="ident" id="5151422">v</span><span class="op" id="5151423">.</span><span class="ident" id="5151424">Ident</span><span class="op" id="5151429">...</span><span class="op" id="5151432">)</span><span class="op" id="5151433">}</span><br>
<span class="lineno">350</span><span class="op" id="5151435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5151438">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="5151483">type</span>&nbsp;<span class="ident" id="5151488">DotNode</span>&nbsp;<span class="keyword" id="5151496">struct</span>&nbsp;<span class="op" id="5151503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5151506">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5151516">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5151521">tr</span>&nbsp;<span class="op" id="5151524">*</span><span class="ident" id="5151525">Tree</span><br>
<span class="lineno"></span><span class="op" id="5151530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5151533">func</span>&nbsp;<span class="op" id="5151538">(</span><span class="ident" id="5151539">t</span>&nbsp;<span class="op" id="5151541">*</span><span class="ident" id="5151542">Tree</span><span class="op" id="5151546">)</span>&nbsp;<span class="ident" id="5151548">newDot</span><span class="op" id="5151554">(</span><span class="ident" id="5151555">pos</span>&nbsp;<span class="ident" id="5151559">Pos</span><span class="op" id="5151562">)</span>&nbsp;<span class="op" id="5151564">*</span><span class="ident" id="5151565">DotNode</span>&nbsp;<span class="op" id="5151573">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151576">return</span>&nbsp;<span class="op" id="5151583">&amp;</span><span class="ident" id="5151584">DotNode</span><span class="op" id="5151591">{</span><span class="ident" id="5151592">tr</span><span class="op" id="5151594">:</span>&nbsp;<span class="ident" id="5151596">t</span><span class="op" id="5151597">,</span>&nbsp;<span class="ident" id="5151599">NodeType</span><span class="op" id="5151607">:</span>&nbsp;<span class="ident" id="5151609">NodeDot</span><span class="op" id="5151616">,</span>&nbsp;<span class="ident" id="5151618">Pos</span><span class="op" id="5151621">:</span>&nbsp;<span class="ident" id="5151623">pos</span><span class="op" id="5151626">}</span><br>
<span class="lineno"></span><span class="op" id="5151628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5151631">func</span>&nbsp;<span class="op" id="5151636">(</span><span class="ident" id="5151637">d</span>&nbsp;<span class="op" id="5151639">*</span><span class="ident" id="5151640">DotNode</span><span class="op" id="5151647">)</span>&nbsp;<span class="ident" id="5151649">Type</span><span class="op" id="5151653">(</span><span class="op" id="5151654">)</span>&nbsp;<span class="ident" id="5151656">NodeType</span>&nbsp;<span class="op" id="5151665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5151668">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5151732">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5151800">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151824">return</span>&nbsp;<span class="ident" id="5151831">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="5151839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="5151842">func</span>&nbsp;<span class="op" id="5151847">(</span><span class="ident" id="5151848">d</span>&nbsp;<span class="op" id="5151850">*</span><span class="ident" id="5151851">DotNode</span><span class="op" id="5151858">)</span>&nbsp;<span class="ident" id="5151860">String</span><span class="op" id="5151866">(</span><span class="op" id="5151867">)</span>&nbsp;<span class="builtintype" id="5151869">string</span>&nbsp;<span class="op" id="5151876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151879">return</span>&nbsp;<span class="string" id="5151886">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="5151890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5151893">func</span>&nbsp;<span class="op" id="5151898">(</span><span class="ident" id="5151899">d</span>&nbsp;<span class="op" id="5151901">*</span><span class="ident" id="5151902">DotNode</span><span class="op" id="5151909">)</span>&nbsp;<span class="ident" id="5151911">tree</span><span class="op" id="5151915">(</span><span class="op" id="5151916">)</span>&nbsp;<span class="op" id="5151918">*</span><span class="ident" id="5151919">Tree</span>&nbsp;<span class="op" id="5151924">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151927">return</span>&nbsp;<span class="ident" id="5151934">d</span><span class="op" id="5151935">.</span><span class="ident" id="5151936">tr</span><br>
<span class="lineno"></span><span class="op" id="5151939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5151942">func</span>&nbsp;<span class="op" id="5151947">(</span><span class="ident" id="5151948">d</span>&nbsp;<span class="op" id="5151950">*</span><span class="ident" id="5151951">DotNode</span><span class="op" id="5151958">)</span>&nbsp;<span class="ident" id="5151960">Copy</span><span class="op" id="5151964">(</span><span class="op" id="5151965">)</span>&nbsp;<span class="ident" id="5151967">Node</span>&nbsp;<span class="op" id="5151972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5151975">return</span>&nbsp;<span class="ident" id="5151982">d</span><span class="op" id="5151983">.</span><span class="ident" id="5151984">tr</span><span class="op" id="5151986">.</span><span class="ident" id="5151987">newDot</span><span class="op" id="5151993">(</span><span class="ident" id="5151994">d</span><span class="op" id="5151995">.</span><span class="ident" id="5151996">Pos</span><span class="op" id="5151999">)</span><br>
<span class="lineno">380</span><span class="op" id="5152001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5152004">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="5152088">type</span>&nbsp;<span class="ident" id="5152093">NilNode</span>&nbsp;<span class="keyword" id="5152101">struct</span>&nbsp;<span class="op" id="5152108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5152111">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5152121">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5152126">tr</span>&nbsp;<span class="op" id="5152129">*</span><span class="ident" id="5152130">Tree</span><br>
<span class="lineno"></span><span class="op" id="5152135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5152138">func</span>&nbsp;<span class="op" id="5152143">(</span><span class="ident" id="5152144">t</span>&nbsp;<span class="op" id="5152146">*</span><span class="ident" id="5152147">Tree</span><span class="op" id="5152151">)</span>&nbsp;<span class="ident" id="5152153">newNil</span><span class="op" id="5152159">(</span><span class="ident" id="5152160">pos</span>&nbsp;<span class="ident" id="5152164">Pos</span><span class="op" id="5152167">)</span>&nbsp;<span class="op" id="5152169">*</span><span class="ident" id="5152170">NilNode</span>&nbsp;<span class="op" id="5152178">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5152181">return</span>&nbsp;<span class="op" id="5152188">&amp;</span><span class="ident" id="5152189">NilNode</span><span class="op" id="5152196">{</span><span class="ident" id="5152197">tr</span><span class="op" id="5152199">:</span>&nbsp;<span class="ident" id="5152201">t</span><span class="op" id="5152202">,</span>&nbsp;<span class="ident" id="5152204">NodeType</span><span class="op" id="5152212">:</span>&nbsp;<span class="ident" id="5152214">NodeNil</span><span class="op" id="5152221">,</span>&nbsp;<span class="ident" id="5152223">Pos</span><span class="op" id="5152226">:</span>&nbsp;<span class="ident" id="5152228">pos</span><span class="op" id="5152231">}</span><br>
<span class="lineno"></span><span class="op" id="5152233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5152236">func</span>&nbsp;<span class="op" id="5152241">(</span><span class="ident" id="5152242">n</span>&nbsp;<span class="op" id="5152244">*</span><span class="ident" id="5152245">NilNode</span><span class="op" id="5152252">)</span>&nbsp;<span class="ident" id="5152254">Type</span><span class="op" id="5152258">(</span><span class="op" id="5152259">)</span>&nbsp;<span class="ident" id="5152261">NodeType</span>&nbsp;<span class="op" id="5152270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5152273">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5152337">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5152405">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5152429">return</span>&nbsp;<span class="ident" id="5152436">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="5152444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="5152447">func</span>&nbsp;<span class="op" id="5152452">(</span><span class="ident" id="5152453">n</span>&nbsp;<span class="op" id="5152455">*</span><span class="ident" id="5152456">NilNode</span><span class="op" id="5152463">)</span>&nbsp;<span class="ident" id="5152465">String</span><span class="op" id="5152471">(</span><span class="op" id="5152472">)</span>&nbsp;<span class="builtintype" id="5152474">string</span>&nbsp;<span class="op" id="5152481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5152484">return</span>&nbsp;<span class="string" id="5152491">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="5152497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5152500">func</span>&nbsp;<span class="op" id="5152505">(</span><span class="ident" id="5152506">n</span>&nbsp;<span class="op" id="5152508">*</span><span class="ident" id="5152509">NilNode</span><span class="op" id="5152516">)</span>&nbsp;<span class="ident" id="5152518">tree</span><span class="op" id="5152522">(</span><span class="op" id="5152523">)</span>&nbsp;<span class="op" id="5152525">*</span><span class="ident" id="5152526">Tree</span>&nbsp;<span class="op" id="5152531">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5152534">return</span>&nbsp;<span class="ident" id="5152541">n</span><span class="op" id="5152542">.</span><span class="ident" id="5152543">tr</span><br>
<span class="lineno"></span><span class="op" id="5152546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5152549">func</span>&nbsp;<span class="op" id="5152554">(</span><span class="ident" id="5152555">n</span>&nbsp;<span class="op" id="5152557">*</span><span class="ident" id="5152558">NilNode</span><span class="op" id="5152565">)</span>&nbsp;<span class="ident" id="5152567">Copy</span><span class="op" id="5152571">(</span><span class="op" id="5152572">)</span>&nbsp;<span class="ident" id="5152574">Node</span>&nbsp;<span class="op" id="5152579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5152582">return</span>&nbsp;<span class="ident" id="5152589">n</span><span class="op" id="5152590">.</span><span class="ident" id="5152591">tr</span><span class="op" id="5152593">.</span><span class="ident" id="5152594">newNil</span><span class="op" id="5152600">(</span><span class="ident" id="5152601">n</span><span class="op" id="5152602">.</span><span class="ident" id="5152603">Pos</span><span class="op" id="5152606">)</span><br>
<span class="lineno">410</span><span class="op" id="5152608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5152611">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="5152670">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="5152708">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="5152750">type</span>&nbsp;<span class="ident" id="5152755">FieldNode</span>&nbsp;<span class="keyword" id="5152765">struct</span>&nbsp;<span class="op" id="5152772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5152775">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5152785">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5152790">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5152796">*</span><span class="ident" id="5152797">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5152803">Ident</span>&nbsp;<span class="op" id="5152809">[</span><span class="op" id="5152810">]</span><span class="builtintype" id="5152811">string</span>&nbsp;<span class="comment" id="5152818">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="5152855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5152858">func</span>&nbsp;<span class="op" id="5152863">(</span><span class="ident" id="5152864">t</span>&nbsp;<span class="op" id="5152866">*</span><span class="ident" id="5152867">Tree</span><span class="op" id="5152871">)</span>&nbsp;<span class="ident" id="5152873">newField</span><span class="op" id="5152881">(</span><span class="ident" id="5152882">pos</span>&nbsp;<span class="ident" id="5152886">Pos</span><span class="op" id="5152889">,</span>&nbsp;<span class="ident" id="5152891">ident</span>&nbsp;<span class="builtintype" id="5152897">string</span><span class="op" id="5152903">)</span>&nbsp;<span class="op" id="5152905">*</span><span class="ident" id="5152906">FieldNode</span>&nbsp;<span class="op" id="5152916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5152919">return</span>&nbsp;<span class="op" id="5152926">&amp;</span><span class="ident" id="5152927">FieldNode</span><span class="op" id="5152936">{</span><span class="ident" id="5152937">tr</span><span class="op" id="5152939">:</span>&nbsp;<span class="ident" id="5152941">t</span><span class="op" id="5152942">,</span>&nbsp;<span class="ident" id="5152944">NodeType</span><span class="op" id="5152952">:</span>&nbsp;<span class="ident" id="5152954">NodeField</span><span class="op" id="5152963">,</span>&nbsp;<span class="ident" id="5152965">Pos</span><span class="op" id="5152968">:</span>&nbsp;<span class="ident" id="5152970">pos</span><span class="op" id="5152973">,</span>&nbsp;<span class="ident" id="5152975">Ident</span><span class="op" id="5152980">:</span>&nbsp;<span class="ident" id="5152982">strings</span><span class="op" id="5152989">.</span><span class="ident" id="5152990">Split</span><span class="op" id="5152995">(</span><span class="ident" id="5152996">ident</span><span class="op" id="5153001">[</span><span class="num" id="5153002">1</span><span class="op" id="5153003">:</span><span class="op" id="5153004">]</span><span class="op" id="5153005">,</span>&nbsp;<span class="string" id="5153007">&#34;.&#34;</span><span class="op" id="5153010">)</span><span class="op" id="5153011">}</span>&nbsp;<span class="comment" id="5153013">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="5153044">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="5153047">func</span>&nbsp;<span class="op" id="5153052">(</span><span class="ident" id="5153053">f</span>&nbsp;<span class="op" id="5153055">*</span><span class="ident" id="5153056">FieldNode</span><span class="op" id="5153065">)</span>&nbsp;<span class="ident" id="5153067">String</span><span class="op" id="5153073">(</span><span class="op" id="5153074">)</span>&nbsp;<span class="builtintype" id="5153076">string</span>&nbsp;<span class="op" id="5153083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5153086">s</span>&nbsp;<span class="op" id="5153088">:=</span>&nbsp;<span class="string" id="5153091">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5153095">for</span>&nbsp;<span class="ident" id="5153099">_</span><span class="op" id="5153100">,</span>&nbsp;<span class="ident" id="5153102">id</span>&nbsp;<span class="op" id="5153105">:=</span>&nbsp;<span class="keyword" id="5153108">range</span>&nbsp;<span class="ident" id="5153114">f</span><span class="op" id="5153115">.</span><span class="ident" id="5153116">Ident</span>&nbsp;<span class="op" id="5153122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5153126">s</span>&nbsp;<span class="op" id="5153128">+=</span>&nbsp;<span class="string" id="5153131">&#34;.&#34;</span>&nbsp;<span class="op" id="5153135">+</span>&nbsp;<span class="ident" id="5153137">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5153141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5153144">return</span>&nbsp;<span class="ident" id="5153151">s</span><br>
<span class="lineno"></span><span class="op" id="5153153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5153156">func</span>&nbsp;<span class="op" id="5153161">(</span><span class="ident" id="5153162">f</span>&nbsp;<span class="op" id="5153164">*</span><span class="ident" id="5153165">FieldNode</span><span class="op" id="5153174">)</span>&nbsp;<span class="ident" id="5153176">tree</span><span class="op" id="5153180">(</span><span class="op" id="5153181">)</span>&nbsp;<span class="op" id="5153183">*</span><span class="ident" id="5153184">Tree</span>&nbsp;<span class="op" id="5153189">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5153192">return</span>&nbsp;<span class="ident" id="5153199">f</span><span class="op" id="5153200">.</span><span class="ident" id="5153201">tr</span><br>
<span class="lineno"></span><span class="op" id="5153204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5153207">func</span>&nbsp;<span class="op" id="5153212">(</span><span class="ident" id="5153213">f</span>&nbsp;<span class="op" id="5153215">*</span><span class="ident" id="5153216">FieldNode</span><span class="op" id="5153225">)</span>&nbsp;<span class="ident" id="5153227">Copy</span><span class="op" id="5153231">(</span><span class="op" id="5153232">)</span>&nbsp;<span class="ident" id="5153234">Node</span>&nbsp;<span class="op" id="5153239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5153242">return</span>&nbsp;<span class="op" id="5153249">&amp;</span><span class="ident" id="5153250">FieldNode</span><span class="op" id="5153259">{</span><span class="ident" id="5153260">tr</span><span class="op" id="5153262">:</span>&nbsp;<span class="ident" id="5153264">f</span><span class="op" id="5153265">.</span><span class="ident" id="5153266">tr</span><span class="op" id="5153268">,</span>&nbsp;<span class="ident" id="5153270">NodeType</span><span class="op" id="5153278">:</span>&nbsp;<span class="ident" id="5153280">NodeField</span><span class="op" id="5153289">,</span>&nbsp;<span class="ident" id="5153291">Pos</span><span class="op" id="5153294">:</span>&nbsp;<span class="ident" id="5153296">f</span><span class="op" id="5153297">.</span><span class="ident" id="5153298">Pos</span><span class="op" id="5153301">,</span>&nbsp;<span class="ident" id="5153303">Ident</span><span class="op" id="5153308">:</span>&nbsp;<span class="builtinfunc" id="5153310">append</span><span class="op" id="5153316">(</span><span class="op" id="5153317">[</span><span class="op" id="5153318">]</span><span class="builtintype" id="5153319">string</span><span class="op" id="5153325">{</span><span class="op" id="5153326">}</span><span class="op" id="5153327">,</span>&nbsp;<span class="ident" id="5153329">f</span><span class="op" id="5153330">.</span><span class="ident" id="5153331">Ident</span><span class="op" id="5153336">...</span><span class="op" id="5153339">)</span><span class="op" id="5153340">}</span><br>
<span class="lineno">440</span><span class="op" id="5153342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5153345">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="5153441">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="5153479">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="5153523">type</span>&nbsp;<span class="ident" id="5153528">ChainNode</span>&nbsp;<span class="keyword" id="5153538">struct</span>&nbsp;<span class="op" id="5153545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5153548">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5153558">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5153563">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5153569">*</span><span class="ident" id="5153570">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5153576">Node</span>&nbsp;&nbsp;<span class="ident" id="5153582">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5153588">Field</span>&nbsp;<span class="op" id="5153594">[</span><span class="op" id="5153595">]</span><span class="builtintype" id="5153596">string</span>&nbsp;<span class="comment" id="5153603">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="5153640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5153643">func</span>&nbsp;<span class="op" id="5153648">(</span><span class="ident" id="5153649">t</span>&nbsp;<span class="op" id="5153651">*</span><span class="ident" id="5153652">Tree</span><span class="op" id="5153656">)</span>&nbsp;<span class="ident" id="5153658">newChain</span><span class="op" id="5153666">(</span><span class="ident" id="5153667">pos</span>&nbsp;<span class="ident" id="5153671">Pos</span><span class="op" id="5153674">,</span>&nbsp;<span class="ident" id="5153676">node</span>&nbsp;<span class="ident" id="5153681">Node</span><span class="op" id="5153685">)</span>&nbsp;<span class="op" id="5153687">*</span><span class="ident" id="5153688">ChainNode</span>&nbsp;<span class="op" id="5153698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5153701">return</span>&nbsp;<span class="op" id="5153708">&amp;</span><span class="ident" id="5153709">ChainNode</span><span class="op" id="5153718">{</span><span class="ident" id="5153719">tr</span><span class="op" id="5153721">:</span>&nbsp;<span class="ident" id="5153723">t</span><span class="op" id="5153724">,</span>&nbsp;<span class="ident" id="5153726">NodeType</span><span class="op" id="5153734">:</span>&nbsp;<span class="ident" id="5153736">NodeChain</span><span class="op" id="5153745">,</span>&nbsp;<span class="ident" id="5153747">Pos</span><span class="op" id="5153750">:</span>&nbsp;<span class="ident" id="5153752">pos</span><span class="op" id="5153755">,</span>&nbsp;<span class="ident" id="5153757">Node</span><span class="op" id="5153761">:</span>&nbsp;<span class="ident" id="5153763">node</span><span class="op" id="5153767">}</span><br>
<span class="lineno">455</span><span class="op" id="5153769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5153772">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="5153860">func</span>&nbsp;<span class="op" id="5153865">(</span><span class="ident" id="5153866">c</span>&nbsp;<span class="op" id="5153868">*</span><span class="ident" id="5153869">ChainNode</span><span class="op" id="5153878">)</span>&nbsp;<span class="ident" id="5153880">Add</span><span class="op" id="5153883">(</span><span class="ident" id="5153884">field</span>&nbsp;<span class="builtintype" id="5153890">string</span><span class="op" id="5153896">)</span>&nbsp;<span class="op" id="5153898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5153901">if</span>&nbsp;<span class="builtinfunc" id="5153904">len</span><span class="op" id="5153907">(</span><span class="ident" id="5153908">field</span><span class="op" id="5153913">)</span>&nbsp;<span class="op" id="5153915">==</span>&nbsp;<span class="num" id="5153918">0</span>&nbsp;<span class="op" id="5153920">||</span>&nbsp;<span class="ident" id="5153923">field</span><span class="op" id="5153928">[</span><span class="num" id="5153929">0</span><span class="op" id="5153930">]</span>&nbsp;<span class="op" id="5153932">!=</span>&nbsp;<span class="string" id="5153935">&#39;.&#39;</span>&nbsp;<span class="op" id="5153939">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5153943">panic</span><span class="op" id="5153948">(</span><span class="string" id="5153949">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="5153966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5153969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5153972">field</span>&nbsp;<span class="op" id="5153978">=</span>&nbsp;<span class="ident" id="5153980">field</span><span class="op" id="5153985">[</span><span class="num" id="5153986">1</span><span class="op" id="5153987">:</span><span class="op" id="5153988">]</span>&nbsp;<span class="comment" id="5153990">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154014">if</span>&nbsp;<span class="ident" id="5154017">field</span>&nbsp;<span class="op" id="5154023">==</span>&nbsp;<span class="string" id="5154026">&#34;&#34;</span>&nbsp;<span class="op" id="5154029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5154033">panic</span><span class="op" id="5154038">(</span><span class="string" id="5154039">&#34;empty&nbsp;field&#34;</span><span class="op" id="5154052">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5154055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154058">c</span><span class="op" id="5154059">.</span><span class="ident" id="5154060">Field</span>&nbsp;<span class="op" id="5154066">=</span>&nbsp;<span class="builtinfunc" id="5154068">append</span><span class="op" id="5154074">(</span><span class="ident" id="5154075">c</span><span class="op" id="5154076">.</span><span class="ident" id="5154077">Field</span><span class="op" id="5154082">,</span>&nbsp;<span class="ident" id="5154084">field</span><span class="op" id="5154089">)</span><br>
<span class="lineno"></span><span class="op" id="5154091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5154094">func</span>&nbsp;<span class="op" id="5154099">(</span><span class="ident" id="5154100">c</span>&nbsp;<span class="op" id="5154102">*</span><span class="ident" id="5154103">ChainNode</span><span class="op" id="5154112">)</span>&nbsp;<span class="ident" id="5154114">String</span><span class="op" id="5154120">(</span><span class="op" id="5154121">)</span>&nbsp;<span class="builtintype" id="5154123">string</span>&nbsp;<span class="op" id="5154130">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154133">s</span>&nbsp;<span class="op" id="5154135">:=</span>&nbsp;<span class="ident" id="5154138">c</span><span class="op" id="5154139">.</span><span class="ident" id="5154140">Node</span><span class="op" id="5154144">.</span><span class="ident" id="5154145">String</span><span class="op" id="5154151">(</span><span class="op" id="5154152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154155">if</span>&nbsp;<span class="ident" id="5154158">_</span><span class="op" id="5154159">,</span>&nbsp;<span class="ident" id="5154161">ok</span>&nbsp;<span class="op" id="5154164">:=</span>&nbsp;<span class="ident" id="5154167">c</span><span class="op" id="5154168">.</span><span class="ident" id="5154169">Node</span><span class="op" id="5154173">.</span><span class="op" id="5154174">(</span><span class="op" id="5154175">*</span><span class="ident" id="5154176">PipeNode</span><span class="op" id="5154184">)</span><span class="op" id="5154185">;</span>&nbsp;<span class="ident" id="5154187">ok</span>&nbsp;<span class="op" id="5154190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154194">s</span>&nbsp;<span class="op" id="5154196">=</span>&nbsp;<span class="string" id="5154198">&#34;(&#34;</span>&nbsp;<span class="op" id="5154202">+</span>&nbsp;<span class="ident" id="5154204">s</span>&nbsp;<span class="op" id="5154206">+</span>&nbsp;<span class="string" id="5154208">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5154213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154216">for</span>&nbsp;<span class="ident" id="5154220">_</span><span class="op" id="5154221">,</span>&nbsp;<span class="ident" id="5154223">field</span>&nbsp;<span class="op" id="5154229">:=</span>&nbsp;<span class="keyword" id="5154232">range</span>&nbsp;<span class="ident" id="5154238">c</span><span class="op" id="5154239">.</span><span class="ident" id="5154240">Field</span>&nbsp;<span class="op" id="5154246">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154250">s</span>&nbsp;<span class="op" id="5154252">+=</span>&nbsp;<span class="string" id="5154255">&#34;.&#34;</span>&nbsp;<span class="op" id="5154259">+</span>&nbsp;<span class="ident" id="5154261">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5154268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154271">return</span>&nbsp;<span class="ident" id="5154278">s</span><br>
<span class="lineno"></span><span class="op" id="5154280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="5154283">func</span>&nbsp;<span class="op" id="5154288">(</span><span class="ident" id="5154289">c</span>&nbsp;<span class="op" id="5154291">*</span><span class="ident" id="5154292">ChainNode</span><span class="op" id="5154301">)</span>&nbsp;<span class="ident" id="5154303">tree</span><span class="op" id="5154307">(</span><span class="op" id="5154308">)</span>&nbsp;<span class="op" id="5154310">*</span><span class="ident" id="5154311">Tree</span>&nbsp;<span class="op" id="5154316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154319">return</span>&nbsp;<span class="ident" id="5154326">c</span><span class="op" id="5154327">.</span><span class="ident" id="5154328">tr</span><br>
<span class="lineno"></span><span class="op" id="5154331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5154334">func</span>&nbsp;<span class="op" id="5154339">(</span><span class="ident" id="5154340">c</span>&nbsp;<span class="op" id="5154342">*</span><span class="ident" id="5154343">ChainNode</span><span class="op" id="5154352">)</span>&nbsp;<span class="ident" id="5154354">Copy</span><span class="op" id="5154358">(</span><span class="op" id="5154359">)</span>&nbsp;<span class="ident" id="5154361">Node</span>&nbsp;<span class="op" id="5154366">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154369">return</span>&nbsp;<span class="op" id="5154376">&amp;</span><span class="ident" id="5154377">ChainNode</span><span class="op" id="5154386">{</span><span class="ident" id="5154387">tr</span><span class="op" id="5154389">:</span>&nbsp;<span class="ident" id="5154391">c</span><span class="op" id="5154392">.</span><span class="ident" id="5154393">tr</span><span class="op" id="5154395">,</span>&nbsp;<span class="ident" id="5154397">NodeType</span><span class="op" id="5154405">:</span>&nbsp;<span class="ident" id="5154407">NodeChain</span><span class="op" id="5154416">,</span>&nbsp;<span class="ident" id="5154418">Pos</span><span class="op" id="5154421">:</span>&nbsp;<span class="ident" id="5154423">c</span><span class="op" id="5154424">.</span><span class="ident" id="5154425">Pos</span><span class="op" id="5154428">,</span>&nbsp;<span class="ident" id="5154430">Node</span><span class="op" id="5154434">:</span>&nbsp;<span class="ident" id="5154436">c</span><span class="op" id="5154437">.</span><span class="ident" id="5154438">Node</span><span class="op" id="5154442">,</span>&nbsp;<span class="ident" id="5154444">Field</span><span class="op" id="5154449">:</span>&nbsp;<span class="builtinfunc" id="5154451">append</span><span class="op" id="5154457">(</span><span class="op" id="5154458">[</span><span class="op" id="5154459">]</span><span class="builtintype" id="5154460">string</span><span class="op" id="5154466">{</span><span class="op" id="5154467">}</span><span class="op" id="5154468">,</span>&nbsp;<span class="ident" id="5154470">c</span><span class="op" id="5154471">.</span><span class="ident" id="5154472">Field</span><span class="op" id="5154477">...</span><span class="op" id="5154480">)</span><span class="op" id="5154481">}</span><br>
<span class="lineno"></span><span class="op" id="5154483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5154486">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="5154524">type</span>&nbsp;<span class="ident" id="5154529">BoolNode</span>&nbsp;<span class="keyword" id="5154538">struct</span>&nbsp;<span class="op" id="5154545">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154548">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154558">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154563">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5154568">*</span><span class="ident" id="5154569">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154575">True</span>&nbsp;<span class="builtintype" id="5154580">bool</span>&nbsp;<span class="comment" id="5154585">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="5154623">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="5154626">func</span>&nbsp;<span class="op" id="5154631">(</span><span class="ident" id="5154632">t</span>&nbsp;<span class="op" id="5154634">*</span><span class="ident" id="5154635">Tree</span><span class="op" id="5154639">)</span>&nbsp;<span class="ident" id="5154641">newBool</span><span class="op" id="5154648">(</span><span class="ident" id="5154649">pos</span>&nbsp;<span class="ident" id="5154653">Pos</span><span class="op" id="5154656">,</span>&nbsp;<span class="builtintype" id="5154658">true</span>&nbsp;<span class="builtintype" id="5154663">bool</span><span class="op" id="5154667">)</span>&nbsp;<span class="op" id="5154669">*</span><span class="ident" id="5154670">BoolNode</span>&nbsp;<span class="op" id="5154679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154682">return</span>&nbsp;<span class="op" id="5154689">&amp;</span><span class="ident" id="5154690">BoolNode</span><span class="op" id="5154698">{</span><span class="ident" id="5154699">tr</span><span class="op" id="5154701">:</span>&nbsp;<span class="ident" id="5154703">t</span><span class="op" id="5154704">,</span>&nbsp;<span class="ident" id="5154706">NodeType</span><span class="op" id="5154714">:</span>&nbsp;<span class="ident" id="5154716">NodeBool</span><span class="op" id="5154724">,</span>&nbsp;<span class="ident" id="5154726">Pos</span><span class="op" id="5154729">:</span>&nbsp;<span class="ident" id="5154731">pos</span><span class="op" id="5154734">,</span>&nbsp;<span class="ident" id="5154736">True</span><span class="op" id="5154740">:</span>&nbsp;<span class="builtintype" id="5154742">true</span><span class="op" id="5154746">}</span><br>
<span class="lineno"></span><span class="op" id="5154748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="5154751">func</span>&nbsp;<span class="op" id="5154756">(</span><span class="ident" id="5154757">b</span>&nbsp;<span class="op" id="5154759">*</span><span class="ident" id="5154760">BoolNode</span><span class="op" id="5154768">)</span>&nbsp;<span class="ident" id="5154770">String</span><span class="op" id="5154776">(</span><span class="op" id="5154777">)</span>&nbsp;<span class="builtintype" id="5154779">string</span>&nbsp;<span class="op" id="5154786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154789">if</span>&nbsp;<span class="ident" id="5154792">b</span><span class="op" id="5154793">.</span><span class="ident" id="5154794">True</span>&nbsp;<span class="op" id="5154799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154803">return</span>&nbsp;<span class="string" id="5154810">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5154818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154821">return</span>&nbsp;<span class="string" id="5154828">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="5154836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5154839">func</span>&nbsp;<span class="op" id="5154844">(</span><span class="ident" id="5154845">b</span>&nbsp;<span class="op" id="5154847">*</span><span class="ident" id="5154848">BoolNode</span><span class="op" id="5154856">)</span>&nbsp;<span class="ident" id="5154858">tree</span><span class="op" id="5154862">(</span><span class="op" id="5154863">)</span>&nbsp;<span class="op" id="5154865">*</span><span class="ident" id="5154866">Tree</span>&nbsp;<span class="op" id="5154871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154874">return</span>&nbsp;<span class="ident" id="5154881">b</span><span class="op" id="5154882">.</span><span class="ident" id="5154883">tr</span><br>
<span class="lineno"></span><span class="op" id="5154886">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="5154889">func</span>&nbsp;<span class="op" id="5154894">(</span><span class="ident" id="5154895">b</span>&nbsp;<span class="op" id="5154897">*</span><span class="ident" id="5154898">BoolNode</span><span class="op" id="5154906">)</span>&nbsp;<span class="ident" id="5154908">Copy</span><span class="op" id="5154912">(</span><span class="op" id="5154913">)</span>&nbsp;<span class="ident" id="5154915">Node</span>&nbsp;<span class="op" id="5154920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5154923">return</span>&nbsp;<span class="ident" id="5154930">b</span><span class="op" id="5154931">.</span><span class="ident" id="5154932">tr</span><span class="op" id="5154934">.</span><span class="ident" id="5154935">newBool</span><span class="op" id="5154942">(</span><span class="ident" id="5154943">b</span><span class="op" id="5154944">.</span><span class="ident" id="5154945">Pos</span><span class="op" id="5154948">,</span>&nbsp;<span class="ident" id="5154950">b</span><span class="op" id="5154951">.</span><span class="ident" id="5154952">True</span><span class="op" id="5154956">)</span><br>
<span class="lineno"></span><span class="op" id="5154958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="5154961">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="5155038">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5155122">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="5155204">type</span>&nbsp;<span class="ident" id="5155209">NumberNode</span>&nbsp;<span class="keyword" id="5155220">struct</span>&nbsp;<span class="op" id="5155227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155230">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155240">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155245">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5155256">*</span><span class="ident" id="5155257">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155263">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5155274">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155285">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155319">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5155330">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155341">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155384">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5155395">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155406">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155445">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="5155456">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155467">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155490">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155501">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155512">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155542">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155553">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155564">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155596">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5155607">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155618">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155648">Complex128</span>&nbsp;<span class="builtintype" id="5155659">complex128</span>&nbsp;<span class="comment" id="5155670">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155693">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5155704">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155715">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="5155770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5155773">func</span>&nbsp;<span class="op" id="5155778">(</span><span class="ident" id="5155779">t</span>&nbsp;<span class="op" id="5155781">*</span><span class="ident" id="5155782">Tree</span><span class="op" id="5155786">)</span>&nbsp;<span class="ident" id="5155788">newNumber</span><span class="op" id="5155797">(</span><span class="ident" id="5155798">pos</span>&nbsp;<span class="ident" id="5155802">Pos</span><span class="op" id="5155805">,</span>&nbsp;<span class="ident" id="5155807">text</span>&nbsp;<span class="builtintype" id="5155812">string</span><span class="op" id="5155818">,</span>&nbsp;<span class="ident" id="5155820">typ</span>&nbsp;<span class="ident" id="5155824">itemType</span><span class="op" id="5155832">)</span>&nbsp;<span class="op" id="5155834">(</span><span class="op" id="5155835">*</span><span class="ident" id="5155836">NumberNode</span><span class="op" id="5155846">,</span>&nbsp;<span class="builtintype" id="5155848">error</span><span class="op" id="5155853">)</span>&nbsp;<span class="op" id="5155855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5155858">n</span>&nbsp;<span class="op" id="5155860">:=</span>&nbsp;<span class="op" id="5155863">&amp;</span><span class="ident" id="5155864">NumberNode</span><span class="op" id="5155874">{</span><span class="ident" id="5155875">tr</span><span class="op" id="5155877">:</span>&nbsp;<span class="ident" id="5155879">t</span><span class="op" id="5155880">,</span>&nbsp;<span class="ident" id="5155882">NodeType</span><span class="op" id="5155890">:</span>&nbsp;<span class="ident" id="5155892">NodeNumber</span><span class="op" id="5155902">,</span>&nbsp;<span class="ident" id="5155904">Pos</span><span class="op" id="5155907">:</span>&nbsp;<span class="ident" id="5155909">pos</span><span class="op" id="5155912">,</span>&nbsp;<span class="ident" id="5155914">Text</span><span class="op" id="5155918">:</span>&nbsp;<span class="ident" id="5155920">text</span><span class="op" id="5155924">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5155927">switch</span>&nbsp;<span class="ident" id="5155934">typ</span>&nbsp;<span class="op" id="5155938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5155941">case</span>&nbsp;<span class="ident" id="5155946">itemCharConstant</span><span class="op" id="5155962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5155966">rune</span><span class="op" id="5155970">,</span>&nbsp;<span class="ident" id="5155972">_</span><span class="op" id="5155973">,</span>&nbsp;<span class="ident" id="5155975">tail</span><span class="op" id="5155979">,</span>&nbsp;<span class="ident" id="5155981">err</span>&nbsp;<span class="op" id="5155985">:=</span>&nbsp;<span class="ident" id="5155988">strconv</span><span class="op" id="5155995">.</span><span class="ident" id="5155996">UnquoteChar</span><span class="op" id="5156007">(</span><span class="ident" id="5156008">text</span><span class="op" id="5156012">[</span><span class="num" id="5156013">1</span><span class="op" id="5156014">:</span><span class="op" id="5156015">]</span><span class="op" id="5156016">,</span>&nbsp;<span class="ident" id="5156018">text</span><span class="op" id="5156022">[</span><span class="num" id="5156023">0</span><span class="op" id="5156024">]</span><span class="op" id="5156025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156029">if</span>&nbsp;<span class="ident" id="5156032">err</span>&nbsp;<span class="op" id="5156036">!=</span>&nbsp;<span class="ident" id="5156039">nil</span>&nbsp;<span class="op" id="5156043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156048">return</span>&nbsp;<span class="ident" id="5156055">nil</span><span class="op" id="5156058">,</span>&nbsp;<span class="ident" id="5156060">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5156066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156070">if</span>&nbsp;<span class="ident" id="5156073">tail</span>&nbsp;<span class="op" id="5156078">!=</span>&nbsp;<span class="string" id="5156081">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="5156085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156090">return</span>&nbsp;<span class="ident" id="5156097">nil</span><span class="op" id="5156100">,</span>&nbsp;<span class="ident" id="5156102">fmt</span><span class="op" id="5156105">.</span><span class="ident" id="5156106">Errorf</span><span class="op" id="5156112">(</span><span class="string" id="5156113">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="5156147">,</span>&nbsp;<span class="ident" id="5156149">text</span><span class="op" id="5156153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5156157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156161">n</span><span class="op" id="5156162">.</span><span class="ident" id="5156163">Int64</span>&nbsp;<span class="op" id="5156169">=</span>&nbsp;<span class="ident" id="5156171">int64</span><span class="op" id="5156176">(</span><span class="builtintype" id="5156177">rune</span><span class="op" id="5156181">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156185">n</span><span class="op" id="5156186">.</span><span class="ident" id="5156187">IsInt</span>&nbsp;<span class="op" id="5156193">=</span>&nbsp;<span class="builtintype" id="5156195">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156202">n</span><span class="op" id="5156203">.</span><span class="ident" id="5156204">Uint64</span>&nbsp;<span class="op" id="5156211">=</span>&nbsp;<span class="ident" id="5156213">uint64</span><span class="op" id="5156219">(</span><span class="builtintype" id="5156220">rune</span><span class="op" id="5156224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156228">n</span><span class="op" id="5156229">.</span><span class="ident" id="5156230">IsUint</span>&nbsp;<span class="op" id="5156237">=</span>&nbsp;<span class="builtintype" id="5156239">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156246">n</span><span class="op" id="5156247">.</span><span class="ident" id="5156248">Float64</span>&nbsp;<span class="op" id="5156256">=</span>&nbsp;<span class="builtintype" id="5156258">float64</span><span class="op" id="5156265">(</span><span class="builtintype" id="5156266">rune</span><span class="op" id="5156270">)</span>&nbsp;<span class="comment" id="5156272">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156306">n</span><span class="op" id="5156307">.</span><span class="ident" id="5156308">IsFloat</span>&nbsp;<span class="op" id="5156316">=</span>&nbsp;<span class="builtintype" id="5156318">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156325">return</span>&nbsp;<span class="ident" id="5156332">n</span><span class="op" id="5156333">,</span>&nbsp;<span class="ident" id="5156335">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156340">case</span>&nbsp;<span class="ident" id="5156345">itemComplex</span><span class="op" id="5156356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5156360">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156418">if</span>&nbsp;<span class="ident" id="5156421">_</span><span class="op" id="5156422">,</span>&nbsp;<span class="ident" id="5156424">err</span>&nbsp;<span class="op" id="5156428">:=</span>&nbsp;<span class="ident" id="5156431">fmt</span><span class="op" id="5156434">.</span><span class="ident" id="5156435">Sscan</span><span class="op" id="5156440">(</span><span class="ident" id="5156441">text</span><span class="op" id="5156445">,</span>&nbsp;<span class="op" id="5156447">&amp;</span><span class="ident" id="5156448">n</span><span class="op" id="5156449">.</span><span class="ident" id="5156450">Complex128</span><span class="op" id="5156460">)</span><span class="op" id="5156461">;</span>&nbsp;<span class="ident" id="5156463">err</span>&nbsp;<span class="op" id="5156467">!=</span>&nbsp;<span class="ident" id="5156470">nil</span>&nbsp;<span class="op" id="5156474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156479">return</span>&nbsp;<span class="ident" id="5156486">nil</span><span class="op" id="5156489">,</span>&nbsp;<span class="ident" id="5156491">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5156497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156501">n</span><span class="op" id="5156502">.</span><span class="ident" id="5156503">IsComplex</span>&nbsp;<span class="op" id="5156513">=</span>&nbsp;<span class="builtintype" id="5156515">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156522">n</span><span class="op" id="5156523">.</span><span class="ident" id="5156524">simplifyComplex</span><span class="op" id="5156539">(</span><span class="op" id="5156540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156544">return</span>&nbsp;<span class="ident" id="5156551">n</span><span class="op" id="5156552">,</span>&nbsp;<span class="ident" id="5156554">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5156559">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5156562">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156628">if</span>&nbsp;<span class="builtinfunc" id="5156631">len</span><span class="op" id="5156634">(</span><span class="ident" id="5156635">text</span><span class="op" id="5156639">)</span>&nbsp;<span class="op" id="5156641">&gt;</span>&nbsp;<span class="num" id="5156643">0</span>&nbsp;<span class="op" id="5156645">&amp;&amp;</span>&nbsp;<span class="ident" id="5156648">text</span><span class="op" id="5156652">[</span><span class="builtinfunc" id="5156653">len</span><span class="op" id="5156656">(</span><span class="ident" id="5156657">text</span><span class="op" id="5156661">)</span><span class="op" id="5156662">-</span><span class="num" id="5156663">1</span><span class="op" id="5156664">]</span>&nbsp;<span class="op" id="5156666">==</span>&nbsp;<span class="string" id="5156669">&#39;i&#39;</span>&nbsp;<span class="op" id="5156673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156677">f</span><span class="op" id="5156678">,</span>&nbsp;<span class="ident" id="5156680">err</span>&nbsp;<span class="op" id="5156684">:=</span>&nbsp;<span class="ident" id="5156687">strconv</span><span class="op" id="5156694">.</span><span class="ident" id="5156695">ParseFloat</span><span class="op" id="5156705">(</span><span class="ident" id="5156706">text</span><span class="op" id="5156710">[</span><span class="op" id="5156711">:</span><span class="builtinfunc" id="5156712">len</span><span class="op" id="5156715">(</span><span class="ident" id="5156716">text</span><span class="op" id="5156720">)</span><span class="op" id="5156721">-</span><span class="num" id="5156722">1</span><span class="op" id="5156723">]</span><span class="op" id="5156724">,</span>&nbsp;<span class="num" id="5156726">64</span><span class="op" id="5156728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156732">if</span>&nbsp;<span class="ident" id="5156735">err</span>&nbsp;<span class="op" id="5156739">==</span>&nbsp;<span class="ident" id="5156742">nil</span>&nbsp;<span class="op" id="5156746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156751">n</span><span class="op" id="5156752">.</span><span class="ident" id="5156753">IsComplex</span>&nbsp;<span class="op" id="5156763">=</span>&nbsp;<span class="builtintype" id="5156765">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156773">n</span><span class="op" id="5156774">.</span><span class="ident" id="5156775">Complex128</span>&nbsp;<span class="op" id="5156786">=</span>&nbsp;<span class="builtinfunc" id="5156788">complex</span><span class="op" id="5156795">(</span><span class="num" id="5156796">0</span><span class="op" id="5156797">,</span>&nbsp;<span class="ident" id="5156799">f</span><span class="op" id="5156800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156805">n</span><span class="op" id="5156806">.</span><span class="ident" id="5156807">simplifyComplex</span><span class="op" id="5156822">(</span><span class="op" id="5156823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156828">return</span>&nbsp;<span class="ident" id="5156835">n</span><span class="op" id="5156836">,</span>&nbsp;<span class="ident" id="5156838">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5156844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5156847">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5156850">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156897">u</span><span class="op" id="5156898">,</span>&nbsp;<span class="ident" id="5156900">err</span>&nbsp;<span class="op" id="5156904">:=</span>&nbsp;<span class="ident" id="5156907">strconv</span><span class="op" id="5156914">.</span><span class="ident" id="5156915">ParseUint</span><span class="op" id="5156924">(</span><span class="ident" id="5156925">text</span><span class="op" id="5156929">,</span>&nbsp;<span class="num" id="5156931">0</span><span class="op" id="5156932">,</span>&nbsp;<span class="num" id="5156934">64</span><span class="op" id="5156936">)</span>&nbsp;<span class="comment" id="5156938">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5156973">if</span>&nbsp;<span class="ident" id="5156976">err</span>&nbsp;<span class="op" id="5156980">==</span>&nbsp;<span class="ident" id="5156983">nil</span>&nbsp;<span class="op" id="5156987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156991">n</span><span class="op" id="5156992">.</span><span class="ident" id="5156993">IsUint</span>&nbsp;<span class="op" id="5157000">=</span>&nbsp;<span class="builtintype" id="5157002">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157009">n</span><span class="op" id="5157010">.</span><span class="ident" id="5157011">Uint64</span>&nbsp;<span class="op" id="5157018">=</span>&nbsp;<span class="ident" id="5157020">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157026">i</span><span class="op" id="5157027">,</span>&nbsp;<span class="ident" id="5157029">err</span>&nbsp;<span class="op" id="5157033">:=</span>&nbsp;<span class="ident" id="5157036">strconv</span><span class="op" id="5157043">.</span><span class="ident" id="5157044">ParseInt</span><span class="op" id="5157052">(</span><span class="ident" id="5157053">text</span><span class="op" id="5157057">,</span>&nbsp;<span class="num" id="5157059">0</span><span class="op" id="5157060">,</span>&nbsp;<span class="num" id="5157062">64</span><span class="op" id="5157064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157067">if</span>&nbsp;<span class="ident" id="5157070">err</span>&nbsp;<span class="op" id="5157074">==</span>&nbsp;<span class="ident" id="5157077">nil</span>&nbsp;<span class="op" id="5157081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157085">n</span><span class="op" id="5157086">.</span><span class="ident" id="5157087">IsInt</span>&nbsp;<span class="op" id="5157093">=</span>&nbsp;<span class="builtintype" id="5157095">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157102">n</span><span class="op" id="5157103">.</span><span class="ident" id="5157104">Int64</span>&nbsp;<span class="op" id="5157110">=</span>&nbsp;<span class="ident" id="5157112">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157116">if</span>&nbsp;<span class="ident" id="5157119">i</span>&nbsp;<span class="op" id="5157121">==</span>&nbsp;<span class="num" id="5157124">0</span>&nbsp;<span class="op" id="5157126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157131">n</span><span class="op" id="5157132">.</span><span class="ident" id="5157133">IsUint</span>&nbsp;<span class="op" id="5157140">=</span>&nbsp;<span class="builtintype" id="5157142">true</span>&nbsp;<span class="comment" id="5157147">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157168">n</span><span class="op" id="5157169">.</span><span class="ident" id="5157170">Uint64</span>&nbsp;<span class="op" id="5157177">=</span>&nbsp;<span class="ident" id="5157179">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157186">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5157189">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157248">if</span>&nbsp;<span class="ident" id="5157251">n</span><span class="op" id="5157252">.</span><span class="ident" id="5157253">IsInt</span>&nbsp;<span class="op" id="5157259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157263">n</span><span class="op" id="5157264">.</span><span class="ident" id="5157265">IsFloat</span>&nbsp;<span class="op" id="5157273">=</span>&nbsp;<span class="builtintype" id="5157275">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157282">n</span><span class="op" id="5157283">.</span><span class="ident" id="5157284">Float64</span>&nbsp;<span class="op" id="5157292">=</span>&nbsp;<span class="builtintype" id="5157294">float64</span><span class="op" id="5157301">(</span><span class="ident" id="5157302">n</span><span class="op" id="5157303">.</span><span class="ident" id="5157304">Int64</span><span class="op" id="5157309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157312">}</span>&nbsp;<span class="keyword" id="5157314">else</span>&nbsp;<span class="keyword" id="5157319">if</span>&nbsp;<span class="ident" id="5157322">n</span><span class="op" id="5157323">.</span><span class="ident" id="5157324">IsUint</span>&nbsp;<span class="op" id="5157331">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157335">n</span><span class="op" id="5157336">.</span><span class="ident" id="5157337">IsFloat</span>&nbsp;<span class="op" id="5157345">=</span>&nbsp;<span class="builtintype" id="5157347">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157354">n</span><span class="op" id="5157355">.</span><span class="ident" id="5157356">Float64</span>&nbsp;<span class="op" id="5157364">=</span>&nbsp;<span class="builtintype" id="5157366">float64</span><span class="op" id="5157373">(</span><span class="ident" id="5157374">n</span><span class="op" id="5157375">.</span><span class="ident" id="5157376">Uint64</span><span class="op" id="5157382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157385">}</span>&nbsp;<span class="keyword" id="5157387">else</span>&nbsp;<span class="op" id="5157392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157396">f</span><span class="op" id="5157397">,</span>&nbsp;<span class="ident" id="5157399">err</span>&nbsp;<span class="op" id="5157403">:=</span>&nbsp;<span class="ident" id="5157406">strconv</span><span class="op" id="5157413">.</span><span class="ident" id="5157414">ParseFloat</span><span class="op" id="5157424">(</span><span class="ident" id="5157425">text</span><span class="op" id="5157429">,</span>&nbsp;<span class="num" id="5157431">64</span><span class="op" id="5157433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157437">if</span>&nbsp;<span class="ident" id="5157440">err</span>&nbsp;<span class="op" id="5157444">==</span>&nbsp;<span class="ident" id="5157447">nil</span>&nbsp;<span class="op" id="5157451">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157456">n</span><span class="op" id="5157457">.</span><span class="ident" id="5157458">IsFloat</span>&nbsp;<span class="op" id="5157466">=</span>&nbsp;<span class="builtintype" id="5157468">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157476">n</span><span class="op" id="5157477">.</span><span class="ident" id="5157478">Float64</span>&nbsp;<span class="op" id="5157486">=</span>&nbsp;<span class="ident" id="5157488">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5157493">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157568">if</span>&nbsp;<span class="op" id="5157571">!</span><span class="ident" id="5157572">n</span><span class="op" id="5157573">.</span><span class="ident" id="5157574">IsInt</span>&nbsp;<span class="op" id="5157580">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5157583">float64</span><span class="op" id="5157590">(</span><span class="ident" id="5157591">int64</span><span class="op" id="5157596">(</span><span class="ident" id="5157597">f</span><span class="op" id="5157598">)</span><span class="op" id="5157599">)</span>&nbsp;<span class="op" id="5157601">==</span>&nbsp;<span class="ident" id="5157604">f</span>&nbsp;<span class="op" id="5157606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157612">n</span><span class="op" id="5157613">.</span><span class="ident" id="5157614">IsInt</span>&nbsp;<span class="op" id="5157620">=</span>&nbsp;<span class="builtintype" id="5157622">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157631">n</span><span class="op" id="5157632">.</span><span class="ident" id="5157633">Int64</span>&nbsp;<span class="op" id="5157639">=</span>&nbsp;<span class="ident" id="5157641">int64</span><span class="op" id="5157646">(</span><span class="ident" id="5157647">f</span><span class="op" id="5157648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157658">if</span>&nbsp;<span class="op" id="5157661">!</span><span class="ident" id="5157662">n</span><span class="op" id="5157663">.</span><span class="ident" id="5157664">IsUint</span>&nbsp;<span class="op" id="5157671">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5157674">float64</span><span class="op" id="5157681">(</span><span class="ident" id="5157682">uint64</span><span class="op" id="5157688">(</span><span class="ident" id="5157689">f</span><span class="op" id="5157690">)</span><span class="op" id="5157691">)</span>&nbsp;<span class="op" id="5157693">==</span>&nbsp;<span class="ident" id="5157696">f</span>&nbsp;<span class="op" id="5157698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157704">n</span><span class="op" id="5157705">.</span><span class="ident" id="5157706">IsUint</span>&nbsp;<span class="op" id="5157713">=</span>&nbsp;<span class="builtintype" id="5157715">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5157724">n</span><span class="op" id="5157725">.</span><span class="ident" id="5157726">Uint64</span>&nbsp;<span class="op" id="5157733">=</span>&nbsp;<span class="ident" id="5157735">uint64</span><span class="op" id="5157741">(</span><span class="ident" id="5157742">f</span><span class="op" id="5157743">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157758">if</span>&nbsp;<span class="op" id="5157761">!</span><span class="ident" id="5157762">n</span><span class="op" id="5157763">.</span><span class="ident" id="5157764">IsInt</span>&nbsp;<span class="op" id="5157770">&amp;&amp;</span>&nbsp;<span class="op" id="5157773">!</span><span class="ident" id="5157774">n</span><span class="op" id="5157775">.</span><span class="ident" id="5157776">IsUint</span>&nbsp;<span class="op" id="5157783">&amp;&amp;</span>&nbsp;<span class="op" id="5157786">!</span><span class="ident" id="5157787">n</span><span class="op" id="5157788">.</span><span class="ident" id="5157789">IsFloat</span>&nbsp;<span class="op" id="5157797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157801">return</span>&nbsp;<span class="ident" id="5157808">nil</span><span class="op" id="5157811">,</span>&nbsp;<span class="ident" id="5157813">fmt</span><span class="op" id="5157816">.</span><span class="ident" id="5157817">Errorf</span><span class="op" id="5157823">(</span><span class="string" id="5157824">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="5157851">,</span>&nbsp;<span class="ident" id="5157853">text</span><span class="op" id="5157857">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5157863">return</span>&nbsp;<span class="ident" id="5157870">n</span><span class="op" id="5157871">,</span>&nbsp;<span class="ident" id="5157873">nil</span><br>
<span class="lineno"></span><span class="op" id="5157877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5157880">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="5157969">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="5158023">func</span>&nbsp;<span class="op" id="5158028">(</span><span class="ident" id="5158029">n</span>&nbsp;<span class="op" id="5158031">*</span><span class="ident" id="5158032">NumberNode</span><span class="op" id="5158042">)</span>&nbsp;<span class="ident" id="5158044">simplifyComplex</span><span class="op" id="5158059">(</span><span class="op" id="5158060">)</span>&nbsp;<span class="op" id="5158062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158065">n</span><span class="op" id="5158066">.</span><span class="ident" id="5158067">IsFloat</span>&nbsp;<span class="op" id="5158075">=</span>&nbsp;<span class="builtinfunc" id="5158077">imag</span><span class="op" id="5158081">(</span><span class="ident" id="5158082">n</span><span class="op" id="5158083">.</span><span class="ident" id="5158084">Complex128</span><span class="op" id="5158094">)</span>&nbsp;<span class="op" id="5158096">==</span>&nbsp;<span class="num" id="5158099">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5158102">if</span>&nbsp;<span class="ident" id="5158105">n</span><span class="op" id="5158106">.</span><span class="ident" id="5158107">IsFloat</span>&nbsp;<span class="op" id="5158115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158119">n</span><span class="op" id="5158120">.</span><span class="ident" id="5158121">Float64</span>&nbsp;<span class="op" id="5158129">=</span>&nbsp;<span class="builtinfunc" id="5158131">real</span><span class="op" id="5158135">(</span><span class="ident" id="5158136">n</span><span class="op" id="5158137">.</span><span class="ident" id="5158138">Complex128</span><span class="op" id="5158148">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158152">n</span><span class="op" id="5158153">.</span><span class="ident" id="5158154">IsInt</span>&nbsp;<span class="op" id="5158160">=</span>&nbsp;<span class="builtintype" id="5158162">float64</span><span class="op" id="5158169">(</span><span class="ident" id="5158170">int64</span><span class="op" id="5158175">(</span><span class="ident" id="5158176">n</span><span class="op" id="5158177">.</span><span class="ident" id="5158178">Float64</span><span class="op" id="5158185">)</span><span class="op" id="5158186">)</span>&nbsp;<span class="op" id="5158188">==</span>&nbsp;<span class="ident" id="5158191">n</span><span class="op" id="5158192">.</span><span class="ident" id="5158193">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5158203">if</span>&nbsp;<span class="ident" id="5158206">n</span><span class="op" id="5158207">.</span><span class="ident" id="5158208">IsInt</span>&nbsp;<span class="op" id="5158214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158219">n</span><span class="op" id="5158220">.</span><span class="ident" id="5158221">Int64</span>&nbsp;<span class="op" id="5158227">=</span>&nbsp;<span class="ident" id="5158229">int64</span><span class="op" id="5158234">(</span><span class="ident" id="5158235">n</span><span class="op" id="5158236">.</span><span class="ident" id="5158237">Float64</span><span class="op" id="5158244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5158248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158252">n</span><span class="op" id="5158253">.</span><span class="ident" id="5158254">IsUint</span>&nbsp;<span class="op" id="5158261">=</span>&nbsp;<span class="builtintype" id="5158263">float64</span><span class="op" id="5158270">(</span><span class="ident" id="5158271">uint64</span><span class="op" id="5158277">(</span><span class="ident" id="5158278">n</span><span class="op" id="5158279">.</span><span class="ident" id="5158280">Float64</span><span class="op" id="5158287">)</span><span class="op" id="5158288">)</span>&nbsp;<span class="op" id="5158290">==</span>&nbsp;<span class="ident" id="5158293">n</span><span class="op" id="5158294">.</span><span class="ident" id="5158295">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5158305">if</span>&nbsp;<span class="ident" id="5158308">n</span><span class="op" id="5158309">.</span><span class="ident" id="5158310">IsUint</span>&nbsp;<span class="op" id="5158317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158322">n</span><span class="op" id="5158323">.</span><span class="ident" id="5158324">Uint64</span>&nbsp;<span class="op" id="5158331">=</span>&nbsp;<span class="ident" id="5158333">uint64</span><span class="op" id="5158339">(</span><span class="ident" id="5158340">n</span><span class="op" id="5158341">.</span><span class="ident" id="5158342">Float64</span><span class="op" id="5158349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5158353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5158356">}</span><br>
<span class="lineno"></span><span class="op" id="5158358">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="5158361">func</span>&nbsp;<span class="op" id="5158366">(</span><span class="ident" id="5158367">n</span>&nbsp;<span class="op" id="5158369">*</span><span class="ident" id="5158370">NumberNode</span><span class="op" id="5158380">)</span>&nbsp;<span class="ident" id="5158382">String</span><span class="op" id="5158388">(</span><span class="op" id="5158389">)</span>&nbsp;<span class="builtintype" id="5158391">string</span>&nbsp;<span class="op" id="5158398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5158401">return</span>&nbsp;<span class="ident" id="5158408">n</span><span class="op" id="5158409">.</span><span class="ident" id="5158410">Text</span><br>
<span class="lineno"></span><span class="op" id="5158415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="5158418">func</span>&nbsp;<span class="op" id="5158423">(</span><span class="ident" id="5158424">n</span>&nbsp;<span class="op" id="5158426">*</span><span class="ident" id="5158427">NumberNode</span><span class="op" id="5158437">)</span>&nbsp;<span class="ident" id="5158439">tree</span><span class="op" id="5158443">(</span><span class="op" id="5158444">)</span>&nbsp;<span class="op" id="5158446">*</span><span class="ident" id="5158447">Tree</span>&nbsp;<span class="op" id="5158452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5158455">return</span>&nbsp;<span class="ident" id="5158462">n</span><span class="op" id="5158463">.</span><span class="ident" id="5158464">tr</span><br>
<span class="lineno"></span><span class="op" id="5158467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158470">func</span>&nbsp;<span class="op" id="5158475">(</span><span class="ident" id="5158476">n</span>&nbsp;<span class="op" id="5158478">*</span><span class="ident" id="5158479">NumberNode</span><span class="op" id="5158489">)</span>&nbsp;<span class="ident" id="5158491">Copy</span><span class="op" id="5158495">(</span><span class="op" id="5158496">)</span>&nbsp;<span class="ident" id="5158498">Node</span>&nbsp;<span class="op" id="5158503">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158506">nn</span>&nbsp;<span class="op" id="5158509">:=</span>&nbsp;<span class="builtinfunc" id="5158512">new</span><span class="op" id="5158515">(</span><span class="ident" id="5158516">NumberNode</span><span class="op" id="5158526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5158529">*</span><span class="ident" id="5158530">nn</span>&nbsp;<span class="op" id="5158533">=</span>&nbsp;<span class="op" id="5158535">*</span><span class="ident" id="5158536">n</span>&nbsp;<span class="comment" id="5158538">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5158563">return</span>&nbsp;<span class="ident" id="5158570">nn</span><br>
<span class="lineno"></span><span class="op" id="5158573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="5158576">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5158646">type</span>&nbsp;<span class="ident" id="5158651">StringNode</span>&nbsp;<span class="keyword" id="5158662">struct</span>&nbsp;<span class="op" id="5158669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158672">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158682">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158687">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5158694">*</span><span class="ident" id="5158695">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158701">Quoted</span>&nbsp;<span class="builtintype" id="5158708">string</span>&nbsp;<span class="comment" id="5158715">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158765">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5158772">string</span>&nbsp;<span class="comment" id="5158779">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="5158818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158821">func</span>&nbsp;<span class="op" id="5158826">(</span><span class="ident" id="5158827">t</span>&nbsp;<span class="op" id="5158829">*</span><span class="ident" id="5158830">Tree</span><span class="op" id="5158834">)</span>&nbsp;<span class="ident" id="5158836">newString</span><span class="op" id="5158845">(</span><span class="ident" id="5158846">pos</span>&nbsp;<span class="ident" id="5158850">Pos</span><span class="op" id="5158853">,</span>&nbsp;<span class="ident" id="5158855">orig</span><span class="op" id="5158859">,</span>&nbsp;<span class="ident" id="5158861">text</span>&nbsp;<span class="builtintype" id="5158866">string</span><span class="op" id="5158872">)</span>&nbsp;<span class="op" id="5158874">*</span><span class="ident" id="5158875">StringNode</span>&nbsp;<span class="op" id="5158886">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5158889">return</span>&nbsp;<span class="op" id="5158896">&amp;</span><span class="ident" id="5158897">StringNode</span><span class="op" id="5158907">{</span><span class="ident" id="5158908">tr</span><span class="op" id="5158910">:</span>&nbsp;<span class="ident" id="5158912">t</span><span class="op" id="5158913">,</span>&nbsp;<span class="ident" id="5158915">NodeType</span><span class="op" id="5158923">:</span>&nbsp;<span class="ident" id="5158925">NodeString</span><span class="op" id="5158935">,</span>&nbsp;<span class="ident" id="5158937">Pos</span><span class="op" id="5158940">:</span>&nbsp;<span class="ident" id="5158942">pos</span><span class="op" id="5158945">,</span>&nbsp;<span class="ident" id="5158947">Quoted</span><span class="op" id="5158953">:</span>&nbsp;<span class="ident" id="5158955">orig</span><span class="op" id="5158959">,</span>&nbsp;<span class="ident" id="5158961">Text</span><span class="op" id="5158965">:</span>&nbsp;<span class="ident" id="5158967">text</span><span class="op" id="5158971">}</span><br>
<span class="lineno"></span><span class="op" id="5158973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158976">func</span>&nbsp;<span class="op" id="5158981">(</span><span class="ident" id="5158982">s</span>&nbsp;<span class="op" id="5158984">*</span><span class="ident" id="5158985">StringNode</span><span class="op" id="5158995">)</span>&nbsp;<span class="ident" id="5158997">String</span><span class="op" id="5159003">(</span><span class="op" id="5159004">)</span>&nbsp;<span class="builtintype" id="5159006">string</span>&nbsp;<span class="op" id="5159013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159016">return</span>&nbsp;<span class="ident" id="5159023">s</span><span class="op" id="5159024">.</span><span class="ident" id="5159025">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="5159032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5159035">func</span>&nbsp;<span class="op" id="5159040">(</span><span class="ident" id="5159041">s</span>&nbsp;<span class="op" id="5159043">*</span><span class="ident" id="5159044">StringNode</span><span class="op" id="5159054">)</span>&nbsp;<span class="ident" id="5159056">tree</span><span class="op" id="5159060">(</span><span class="op" id="5159061">)</span>&nbsp;<span class="op" id="5159063">*</span><span class="ident" id="5159064">Tree</span>&nbsp;<span class="op" id="5159069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159072">return</span>&nbsp;<span class="ident" id="5159079">s</span><span class="op" id="5159080">.</span><span class="ident" id="5159081">tr</span><br>
<span class="lineno"></span><span class="op" id="5159084">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="5159087">func</span>&nbsp;<span class="op" id="5159092">(</span><span class="ident" id="5159093">s</span>&nbsp;<span class="op" id="5159095">*</span><span class="ident" id="5159096">StringNode</span><span class="op" id="5159106">)</span>&nbsp;<span class="ident" id="5159108">Copy</span><span class="op" id="5159112">(</span><span class="op" id="5159113">)</span>&nbsp;<span class="ident" id="5159115">Node</span>&nbsp;<span class="op" id="5159120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159123">return</span>&nbsp;<span class="ident" id="5159130">s</span><span class="op" id="5159131">.</span><span class="ident" id="5159132">tr</span><span class="op" id="5159134">.</span><span class="ident" id="5159135">newString</span><span class="op" id="5159144">(</span><span class="ident" id="5159145">s</span><span class="op" id="5159146">.</span><span class="ident" id="5159147">Pos</span><span class="op" id="5159150">,</span>&nbsp;<span class="ident" id="5159152">s</span><span class="op" id="5159153">.</span><span class="ident" id="5159154">Quoted</span><span class="op" id="5159160">,</span>&nbsp;<span class="ident" id="5159162">s</span><span class="op" id="5159163">.</span><span class="ident" id="5159164">Text</span><span class="op" id="5159168">)</span><br>
<span class="lineno"></span><span class="op" id="5159170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="5159173">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="5159214">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="5159261">type</span>&nbsp;<span class="ident" id="5159266">endNode</span>&nbsp;<span class="keyword" id="5159274">struct</span>&nbsp;<span class="op" id="5159281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5159284">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5159294">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5159299">tr</span>&nbsp;<span class="op" id="5159302">*</span><span class="ident" id="5159303">Tree</span><br>
<span class="lineno"></span><span class="op" id="5159308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5159311">func</span>&nbsp;<span class="op" id="5159316">(</span><span class="ident" id="5159317">t</span>&nbsp;<span class="op" id="5159319">*</span><span class="ident" id="5159320">Tree</span><span class="op" id="5159324">)</span>&nbsp;<span class="ident" id="5159326">newEnd</span><span class="op" id="5159332">(</span><span class="ident" id="5159333">pos</span>&nbsp;<span class="ident" id="5159337">Pos</span><span class="op" id="5159340">)</span>&nbsp;<span class="op" id="5159342">*</span><span class="ident" id="5159343">endNode</span>&nbsp;<span class="op" id="5159351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159354">return</span>&nbsp;<span class="op" id="5159361">&amp;</span><span class="ident" id="5159362">endNode</span><span class="op" id="5159369">{</span><span class="ident" id="5159370">tr</span><span class="op" id="5159372">:</span>&nbsp;<span class="ident" id="5159374">t</span><span class="op" id="5159375">,</span>&nbsp;<span class="ident" id="5159377">NodeType</span><span class="op" id="5159385">:</span>&nbsp;<span class="ident" id="5159387">nodeEnd</span><span class="op" id="5159394">,</span>&nbsp;<span class="ident" id="5159396">Pos</span><span class="op" id="5159399">:</span>&nbsp;<span class="ident" id="5159401">pos</span><span class="op" id="5159404">}</span><br>
<span class="lineno">680</span><span class="op" id="5159406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5159409">func</span>&nbsp;<span class="op" id="5159414">(</span><span class="ident" id="5159415">e</span>&nbsp;<span class="op" id="5159417">*</span><span class="ident" id="5159418">endNode</span><span class="op" id="5159425">)</span>&nbsp;<span class="ident" id="5159427">String</span><span class="op" id="5159433">(</span><span class="op" id="5159434">)</span>&nbsp;<span class="builtintype" id="5159436">string</span>&nbsp;<span class="op" id="5159443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159446">return</span>&nbsp;<span class="string" id="5159453">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="5159463">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="5159466">func</span>&nbsp;<span class="op" id="5159471">(</span><span class="ident" id="5159472">e</span>&nbsp;<span class="op" id="5159474">*</span><span class="ident" id="5159475">endNode</span><span class="op" id="5159482">)</span>&nbsp;<span class="ident" id="5159484">tree</span><span class="op" id="5159488">(</span><span class="op" id="5159489">)</span>&nbsp;<span class="op" id="5159491">*</span><span class="ident" id="5159492">Tree</span>&nbsp;<span class="op" id="5159497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159500">return</span>&nbsp;<span class="ident" id="5159507">e</span><span class="op" id="5159508">.</span><span class="ident" id="5159509">tr</span><br>
<span class="lineno"></span><span class="op" id="5159512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="5159515">func</span>&nbsp;<span class="op" id="5159520">(</span><span class="ident" id="5159521">e</span>&nbsp;<span class="op" id="5159523">*</span><span class="ident" id="5159524">endNode</span><span class="op" id="5159531">)</span>&nbsp;<span class="ident" id="5159533">Copy</span><span class="op" id="5159537">(</span><span class="op" id="5159538">)</span>&nbsp;<span class="ident" id="5159540">Node</span>&nbsp;<span class="op" id="5159545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159548">return</span>&nbsp;<span class="ident" id="5159555">e</span><span class="op" id="5159556">.</span><span class="ident" id="5159557">tr</span><span class="op" id="5159559">.</span><span class="ident" id="5159560">newEnd</span><span class="op" id="5159566">(</span><span class="ident" id="5159567">e</span><span class="op" id="5159568">.</span><span class="ident" id="5159569">Pos</span><span class="op" id="5159572">)</span><br>
<span class="lineno"></span><span class="op" id="5159574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5159577">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="5159655">type</span>&nbsp;<span class="ident" id="5159660">elseNode</span>&nbsp;<span class="keyword" id="5159669">struct</span>&nbsp;<span class="op" id="5159676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5159679">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5159689">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5159694">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5159699">*</span><span class="ident" id="5159700">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5159706">Line</span>&nbsp;<span class="builtintype" id="5159711">int</span>&nbsp;<span class="comment" id="5159715">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="5159784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5159787">func</span>&nbsp;<span class="op" id="5159792">(</span><span class="ident" id="5159793">t</span>&nbsp;<span class="op" id="5159795">*</span><span class="ident" id="5159796">Tree</span><span class="op" id="5159800">)</span>&nbsp;<span class="ident" id="5159802">newElse</span><span class="op" id="5159809">(</span><span class="ident" id="5159810">pos</span>&nbsp;<span class="ident" id="5159814">Pos</span><span class="op" id="5159817">,</span>&nbsp;<span class="ident" id="5159819">line</span>&nbsp;<span class="builtintype" id="5159824">int</span><span class="op" id="5159827">)</span>&nbsp;<span class="op" id="5159829">*</span><span class="ident" id="5159830">elseNode</span>&nbsp;<span class="op" id="5159839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159842">return</span>&nbsp;<span class="op" id="5159849">&amp;</span><span class="ident" id="5159850">elseNode</span><span class="op" id="5159858">{</span><span class="ident" id="5159859">tr</span><span class="op" id="5159861">:</span>&nbsp;<span class="ident" id="5159863">t</span><span class="op" id="5159864">,</span>&nbsp;<span class="ident" id="5159866">NodeType</span><span class="op" id="5159874">:</span>&nbsp;<span class="ident" id="5159876">nodeElse</span><span class="op" id="5159884">,</span>&nbsp;<span class="ident" id="5159886">Pos</span><span class="op" id="5159889">:</span>&nbsp;<span class="ident" id="5159891">pos</span><span class="op" id="5159894">,</span>&nbsp;<span class="ident" id="5159896">Line</span><span class="op" id="5159900">:</span>&nbsp;<span class="ident" id="5159902">line</span><span class="op" id="5159906">}</span><br>
<span class="lineno"></span><span class="op" id="5159908">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="5159911">func</span>&nbsp;<span class="op" id="5159916">(</span><span class="ident" id="5159917">e</span>&nbsp;<span class="op" id="5159919">*</span><span class="ident" id="5159920">elseNode</span><span class="op" id="5159928">)</span>&nbsp;<span class="ident" id="5159930">Type</span><span class="op" id="5159934">(</span><span class="op" id="5159935">)</span>&nbsp;<span class="ident" id="5159937">NodeType</span>&nbsp;<span class="op" id="5159946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5159949">return</span>&nbsp;<span class="ident" id="5159956">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="5159965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="5159968">func</span>&nbsp;<span class="op" id="5159973">(</span><span class="ident" id="5159974">e</span>&nbsp;<span class="op" id="5159976">*</span><span class="ident" id="5159977">elseNode</span><span class="op" id="5159985">)</span>&nbsp;<span class="ident" id="5159987">String</span><span class="op" id="5159993">(</span><span class="op" id="5159994">)</span>&nbsp;<span class="builtintype" id="5159996">string</span>&nbsp;<span class="op" id="5160003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160006">return</span>&nbsp;<span class="string" id="5160013">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="5160024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5160027">func</span>&nbsp;<span class="op" id="5160032">(</span><span class="ident" id="5160033">e</span>&nbsp;<span class="op" id="5160035">*</span><span class="ident" id="5160036">elseNode</span><span class="op" id="5160044">)</span>&nbsp;<span class="ident" id="5160046">tree</span><span class="op" id="5160050">(</span><span class="op" id="5160051">)</span>&nbsp;<span class="op" id="5160053">*</span><span class="ident" id="5160054">Tree</span>&nbsp;<span class="op" id="5160059">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160062">return</span>&nbsp;<span class="ident" id="5160069">e</span><span class="op" id="5160070">.</span><span class="ident" id="5160071">tr</span><br>
<span class="lineno"></span><span class="op" id="5160074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5160077">func</span>&nbsp;<span class="op" id="5160082">(</span><span class="ident" id="5160083">e</span>&nbsp;<span class="op" id="5160085">*</span><span class="ident" id="5160086">elseNode</span><span class="op" id="5160094">)</span>&nbsp;<span class="ident" id="5160096">Copy</span><span class="op" id="5160100">(</span><span class="op" id="5160101">)</span>&nbsp;<span class="ident" id="5160103">Node</span>&nbsp;<span class="op" id="5160108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160111">return</span>&nbsp;<span class="ident" id="5160118">e</span><span class="op" id="5160119">.</span><span class="ident" id="5160120">tr</span><span class="op" id="5160122">.</span><span class="ident" id="5160123">newElse</span><span class="op" id="5160130">(</span><span class="ident" id="5160131">e</span><span class="op" id="5160132">.</span><span class="ident" id="5160133">Pos</span><span class="op" id="5160136">,</span>&nbsp;<span class="ident" id="5160138">e</span><span class="op" id="5160139">.</span><span class="ident" id="5160140">Line</span><span class="op" id="5160144">)</span><br>
<span class="lineno">720</span><span class="op" id="5160146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5160149">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="5160216">type</span>&nbsp;<span class="ident" id="5160221">BranchNode</span>&nbsp;<span class="keyword" id="5160232">struct</span>&nbsp;<span class="op" id="5160239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160242">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160252">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160257">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5160266">*</span><span class="ident" id="5160267">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160273">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5160282">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5160292">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160362">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5160371">*</span><span class="ident" id="5160372">PipeNode</span>&nbsp;<span class="comment" id="5160381">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160415">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5160424">*</span><span class="ident" id="5160425">ListNode</span>&nbsp;<span class="comment" id="5160434">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160481">ElseList</span>&nbsp;<span class="op" id="5160490">*</span><span class="ident" id="5160491">ListNode</span>&nbsp;<span class="comment" id="5160500">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="5160558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5160561">func</span>&nbsp;<span class="op" id="5160566">(</span><span class="ident" id="5160567">b</span>&nbsp;<span class="op" id="5160569">*</span><span class="ident" id="5160570">BranchNode</span><span class="op" id="5160580">)</span>&nbsp;<span class="ident" id="5160582">String</span><span class="op" id="5160588">(</span><span class="op" id="5160589">)</span>&nbsp;<span class="builtintype" id="5160591">string</span>&nbsp;<span class="op" id="5160598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160601">name</span>&nbsp;<span class="op" id="5160606">:=</span>&nbsp;<span class="string" id="5160609">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160613">switch</span>&nbsp;<span class="ident" id="5160620">b</span><span class="op" id="5160621">.</span><span class="ident" id="5160622">NodeType</span>&nbsp;<span class="op" id="5160631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160634">case</span>&nbsp;<span class="ident" id="5160639">NodeIf</span><span class="op" id="5160645">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160649">name</span>&nbsp;<span class="op" id="5160654">=</span>&nbsp;<span class="string" id="5160656">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160662">case</span>&nbsp;<span class="ident" id="5160667">NodeRange</span><span class="op" id="5160676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160680">name</span>&nbsp;<span class="op" id="5160685">=</span>&nbsp;<span class="string" id="5160687">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160696">case</span>&nbsp;<span class="ident" id="5160701">NodeWith</span><span class="op" id="5160709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5160713">name</span>&nbsp;<span class="op" id="5160718">=</span>&nbsp;<span class="string" id="5160720">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160728">default</span><span class="op" id="5160735">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5160739">panic</span><span class="op" id="5160744">(</span><span class="string" id="5160745">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="5160766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5160769">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160772">if</span>&nbsp;<span class="ident" id="5160775">b</span><span class="op" id="5160776">.</span><span class="ident" id="5160777">ElseList</span>&nbsp;<span class="op" id="5160786">!=</span>&nbsp;<span class="ident" id="5160789">nil</span>&nbsp;<span class="op" id="5160793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160797">return</span>&nbsp;<span class="ident" id="5160804">fmt</span><span class="op" id="5160807">.</span><span class="ident" id="5160808">Sprintf</span><span class="op" id="5160815">(</span><span class="string" id="5160816">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="5160846">,</span>&nbsp;<span class="ident" id="5160848">name</span><span class="op" id="5160852">,</span>&nbsp;<span class="ident" id="5160854">b</span><span class="op" id="5160855">.</span><span class="ident" id="5160856">Pipe</span><span class="op" id="5160860">,</span>&nbsp;<span class="ident" id="5160862">b</span><span class="op" id="5160863">.</span><span class="ident" id="5160864">List</span><span class="op" id="5160868">,</span>&nbsp;<span class="ident" id="5160870">b</span><span class="op" id="5160871">.</span><span class="ident" id="5160872">ElseList</span><span class="op" id="5160880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5160883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160886">return</span>&nbsp;<span class="ident" id="5160893">fmt</span><span class="op" id="5160896">.</span><span class="ident" id="5160897">Sprintf</span><span class="op" id="5160904">(</span><span class="string" id="5160905">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="5160925">,</span>&nbsp;<span class="ident" id="5160927">name</span><span class="op" id="5160931">,</span>&nbsp;<span class="ident" id="5160933">b</span><span class="op" id="5160934">.</span><span class="ident" id="5160935">Pipe</span><span class="op" id="5160939">,</span>&nbsp;<span class="ident" id="5160941">b</span><span class="op" id="5160942">.</span><span class="ident" id="5160943">List</span><span class="op" id="5160947">)</span><br>
<span class="lineno"></span><span class="op" id="5160949">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="5160952">func</span>&nbsp;<span class="op" id="5160957">(</span><span class="ident" id="5160958">b</span>&nbsp;<span class="op" id="5160960">*</span><span class="ident" id="5160961">BranchNode</span><span class="op" id="5160971">)</span>&nbsp;<span class="ident" id="5160973">tree</span><span class="op" id="5160977">(</span><span class="op" id="5160978">)</span>&nbsp;<span class="op" id="5160980">*</span><span class="ident" id="5160981">Tree</span>&nbsp;<span class="op" id="5160986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5160989">return</span>&nbsp;<span class="ident" id="5160996">b</span><span class="op" id="5160997">.</span><span class="ident" id="5160998">tr</span><br>
<span class="lineno"></span><span class="op" id="5161001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="5161004">func</span>&nbsp;<span class="op" id="5161009">(</span><span class="ident" id="5161010">b</span>&nbsp;<span class="op" id="5161012">*</span><span class="ident" id="5161013">BranchNode</span><span class="op" id="5161023">)</span>&nbsp;<span class="ident" id="5161025">Copy</span><span class="op" id="5161029">(</span><span class="op" id="5161030">)</span>&nbsp;<span class="ident" id="5161032">Node</span>&nbsp;<span class="op" id="5161037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161040">switch</span>&nbsp;<span class="ident" id="5161047">b</span><span class="op" id="5161048">.</span><span class="ident" id="5161049">NodeType</span>&nbsp;<span class="op" id="5161058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161061">case</span>&nbsp;<span class="ident" id="5161066">NodeIf</span><span class="op" id="5161072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161076">return</span>&nbsp;<span class="ident" id="5161083">b</span><span class="op" id="5161084">.</span><span class="ident" id="5161085">tr</span><span class="op" id="5161087">.</span><span class="ident" id="5161088">newIf</span><span class="op" id="5161093">(</span><span class="ident" id="5161094">b</span><span class="op" id="5161095">.</span><span class="ident" id="5161096">Pos</span><span class="op" id="5161099">,</span>&nbsp;<span class="ident" id="5161101">b</span><span class="op" id="5161102">.</span><span class="ident" id="5161103">Line</span><span class="op" id="5161107">,</span>&nbsp;<span class="ident" id="5161109">b</span><span class="op" id="5161110">.</span><span class="ident" id="5161111">Pipe</span><span class="op" id="5161115">,</span>&nbsp;<span class="ident" id="5161117">b</span><span class="op" id="5161118">.</span><span class="ident" id="5161119">List</span><span class="op" id="5161123">,</span>&nbsp;<span class="ident" id="5161125">b</span><span class="op" id="5161126">.</span><span class="ident" id="5161127">ElseList</span><span class="op" id="5161135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161138">case</span>&nbsp;<span class="ident" id="5161143">NodeRange</span><span class="op" id="5161152">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161156">return</span>&nbsp;<span class="ident" id="5161163">b</span><span class="op" id="5161164">.</span><span class="ident" id="5161165">tr</span><span class="op" id="5161167">.</span><span class="ident" id="5161168">newRange</span><span class="op" id="5161176">(</span><span class="ident" id="5161177">b</span><span class="op" id="5161178">.</span><span class="ident" id="5161179">Pos</span><span class="op" id="5161182">,</span>&nbsp;<span class="ident" id="5161184">b</span><span class="op" id="5161185">.</span><span class="ident" id="5161186">Line</span><span class="op" id="5161190">,</span>&nbsp;<span class="ident" id="5161192">b</span><span class="op" id="5161193">.</span><span class="ident" id="5161194">Pipe</span><span class="op" id="5161198">,</span>&nbsp;<span class="ident" id="5161200">b</span><span class="op" id="5161201">.</span><span class="ident" id="5161202">List</span><span class="op" id="5161206">,</span>&nbsp;<span class="ident" id="5161208">b</span><span class="op" id="5161209">.</span><span class="ident" id="5161210">ElseList</span><span class="op" id="5161218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161221">case</span>&nbsp;<span class="ident" id="5161226">NodeWith</span><span class="op" id="5161234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161238">return</span>&nbsp;<span class="ident" id="5161245">b</span><span class="op" id="5161246">.</span><span class="ident" id="5161247">tr</span><span class="op" id="5161249">.</span><span class="ident" id="5161250">newWith</span><span class="op" id="5161257">(</span><span class="ident" id="5161258">b</span><span class="op" id="5161259">.</span><span class="ident" id="5161260">Pos</span><span class="op" id="5161263">,</span>&nbsp;<span class="ident" id="5161265">b</span><span class="op" id="5161266">.</span><span class="ident" id="5161267">Line</span><span class="op" id="5161271">,</span>&nbsp;<span class="ident" id="5161273">b</span><span class="op" id="5161274">.</span><span class="ident" id="5161275">Pipe</span><span class="op" id="5161279">,</span>&nbsp;<span class="ident" id="5161281">b</span><span class="op" id="5161282">.</span><span class="ident" id="5161283">List</span><span class="op" id="5161287">,</span>&nbsp;<span class="ident" id="5161289">b</span><span class="op" id="5161290">.</span><span class="ident" id="5161291">ElseList</span><span class="op" id="5161299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161302">default</span><span class="op" id="5161309">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5161313">panic</span><span class="op" id="5161318">(</span><span class="string" id="5161319">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="5161340">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5161343">}</span><br>
<span class="lineno"></span><span class="op" id="5161345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5161348">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="5161404">type</span>&nbsp;<span class="ident" id="5161409">IfNode</span>&nbsp;<span class="keyword" id="5161416">struct</span>&nbsp;<span class="op" id="5161423">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5161426">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="5161437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5161440">func</span>&nbsp;<span class="op" id="5161445">(</span><span class="ident" id="5161446">t</span>&nbsp;<span class="op" id="5161448">*</span><span class="ident" id="5161449">Tree</span><span class="op" id="5161453">)</span>&nbsp;<span class="ident" id="5161455">newIf</span><span class="op" id="5161460">(</span><span class="ident" id="5161461">pos</span>&nbsp;<span class="ident" id="5161465">Pos</span><span class="op" id="5161468">,</span>&nbsp;<span class="ident" id="5161470">line</span>&nbsp;<span class="builtintype" id="5161475">int</span><span class="op" id="5161478">,</span>&nbsp;<span class="ident" id="5161480">pipe</span>&nbsp;<span class="op" id="5161485">*</span><span class="ident" id="5161486">PipeNode</span><span class="op" id="5161494">,</span>&nbsp;<span class="ident" id="5161496">list</span><span class="op" id="5161500">,</span>&nbsp;<span class="ident" id="5161502">elseList</span>&nbsp;<span class="op" id="5161511">*</span><span class="ident" id="5161512">ListNode</span><span class="op" id="5161520">)</span>&nbsp;<span class="op" id="5161522">*</span><span class="ident" id="5161523">IfNode</span>&nbsp;<span class="op" id="5161530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161533">return</span>&nbsp;<span class="op" id="5161540">&amp;</span><span class="ident" id="5161541">IfNode</span><span class="op" id="5161547">{</span><span class="ident" id="5161548">BranchNode</span><span class="op" id="5161558">{</span><span class="ident" id="5161559">tr</span><span class="op" id="5161561">:</span>&nbsp;<span class="ident" id="5161563">t</span><span class="op" id="5161564">,</span>&nbsp;<span class="ident" id="5161566">NodeType</span><span class="op" id="5161574">:</span>&nbsp;<span class="ident" id="5161576">NodeIf</span><span class="op" id="5161582">,</span>&nbsp;<span class="ident" id="5161584">Pos</span><span class="op" id="5161587">:</span>&nbsp;<span class="ident" id="5161589">pos</span><span class="op" id="5161592">,</span>&nbsp;<span class="ident" id="5161594">Line</span><span class="op" id="5161598">:</span>&nbsp;<span class="ident" id="5161600">line</span><span class="op" id="5161604">,</span>&nbsp;<span class="ident" id="5161606">Pipe</span><span class="op" id="5161610">:</span>&nbsp;<span class="ident" id="5161612">pipe</span><span class="op" id="5161616">,</span>&nbsp;<span class="ident" id="5161618">List</span><span class="op" id="5161622">:</span>&nbsp;<span class="ident" id="5161624">list</span><span class="op" id="5161628">,</span>&nbsp;<span class="ident" id="5161630">ElseList</span><span class="op" id="5161638">:</span>&nbsp;<span class="ident" id="5161640">elseList</span><span class="op" id="5161648">}</span><span class="op" id="5161649">}</span><br>
<span class="lineno">775</span><span class="op" id="5161651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5161654">func</span>&nbsp;<span class="op" id="5161659">(</span><span class="ident" id="5161660">i</span>&nbsp;<span class="op" id="5161662">*</span><span class="ident" id="5161663">IfNode</span><span class="op" id="5161669">)</span>&nbsp;<span class="ident" id="5161671">Copy</span><span class="op" id="5161675">(</span><span class="op" id="5161676">)</span>&nbsp;<span class="ident" id="5161678">Node</span>&nbsp;<span class="op" id="5161683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161686">return</span>&nbsp;<span class="ident" id="5161693">i</span><span class="op" id="5161694">.</span><span class="ident" id="5161695">tr</span><span class="op" id="5161697">.</span><span class="ident" id="5161698">newIf</span><span class="op" id="5161703">(</span><span class="ident" id="5161704">i</span><span class="op" id="5161705">.</span><span class="ident" id="5161706">Pos</span><span class="op" id="5161709">,</span>&nbsp;<span class="ident" id="5161711">i</span><span class="op" id="5161712">.</span><span class="ident" id="5161713">Line</span><span class="op" id="5161717">,</span>&nbsp;<span class="ident" id="5161719">i</span><span class="op" id="5161720">.</span><span class="ident" id="5161721">Pipe</span><span class="op" id="5161725">.</span><span class="ident" id="5161726">CopyPipe</span><span class="op" id="5161734">(</span><span class="op" id="5161735">)</span><span class="op" id="5161736">,</span>&nbsp;<span class="ident" id="5161738">i</span><span class="op" id="5161739">.</span><span class="ident" id="5161740">List</span><span class="op" id="5161744">.</span><span class="ident" id="5161745">CopyList</span><span class="op" id="5161753">(</span><span class="op" id="5161754">)</span><span class="op" id="5161755">,</span>&nbsp;<span class="ident" id="5161757">i</span><span class="op" id="5161758">.</span><span class="ident" id="5161759">ElseList</span><span class="op" id="5161767">.</span><span class="ident" id="5161768">CopyList</span><span class="op" id="5161776">(</span><span class="op" id="5161777">)</span><span class="op" id="5161778">)</span><br>
<span class="lineno"></span><span class="op" id="5161780">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="5161783">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="5161844">type</span>&nbsp;<span class="ident" id="5161849">RangeNode</span>&nbsp;<span class="keyword" id="5161859">struct</span>&nbsp;<span class="op" id="5161866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5161869">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="5161880">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="5161883">func</span>&nbsp;<span class="op" id="5161888">(</span><span class="ident" id="5161889">t</span>&nbsp;<span class="op" id="5161891">*</span><span class="ident" id="5161892">Tree</span><span class="op" id="5161896">)</span>&nbsp;<span class="ident" id="5161898">newRange</span><span class="op" id="5161906">(</span><span class="ident" id="5161907">pos</span>&nbsp;<span class="ident" id="5161911">Pos</span><span class="op" id="5161914">,</span>&nbsp;<span class="ident" id="5161916">line</span>&nbsp;<span class="builtintype" id="5161921">int</span><span class="op" id="5161924">,</span>&nbsp;<span class="ident" id="5161926">pipe</span>&nbsp;<span class="op" id="5161931">*</span><span class="ident" id="5161932">PipeNode</span><span class="op" id="5161940">,</span>&nbsp;<span class="ident" id="5161942">list</span><span class="op" id="5161946">,</span>&nbsp;<span class="ident" id="5161948">elseList</span>&nbsp;<span class="op" id="5161957">*</span><span class="ident" id="5161958">ListNode</span><span class="op" id="5161966">)</span>&nbsp;<span class="op" id="5161968">*</span><span class="ident" id="5161969">RangeNode</span>&nbsp;<span class="op" id="5161979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5161982">return</span>&nbsp;<span class="op" id="5161989">&amp;</span><span class="ident" id="5161990">RangeNode</span><span class="op" id="5161999">{</span><span class="ident" id="5162000">BranchNode</span><span class="op" id="5162010">{</span><span class="ident" id="5162011">tr</span><span class="op" id="5162013">:</span>&nbsp;<span class="ident" id="5162015">t</span><span class="op" id="5162016">,</span>&nbsp;<span class="ident" id="5162018">NodeType</span><span class="op" id="5162026">:</span>&nbsp;<span class="ident" id="5162028">NodeRange</span><span class="op" id="5162037">,</span>&nbsp;<span class="ident" id="5162039">Pos</span><span class="op" id="5162042">:</span>&nbsp;<span class="ident" id="5162044">pos</span><span class="op" id="5162047">,</span>&nbsp;<span class="ident" id="5162049">Line</span><span class="op" id="5162053">:</span>&nbsp;<span class="ident" id="5162055">line</span><span class="op" id="5162059">,</span>&nbsp;<span class="ident" id="5162061">Pipe</span><span class="op" id="5162065">:</span>&nbsp;<span class="ident" id="5162067">pipe</span><span class="op" id="5162071">,</span>&nbsp;<span class="ident" id="5162073">List</span><span class="op" id="5162077">:</span>&nbsp;<span class="ident" id="5162079">list</span><span class="op" id="5162083">,</span>&nbsp;<span class="ident" id="5162085">ElseList</span><span class="op" id="5162093">:</span>&nbsp;<span class="ident" id="5162095">elseList</span><span class="op" id="5162103">}</span><span class="op" id="5162104">}</span><br>
<span class="lineno"></span><span class="op" id="5162106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="5162109">func</span>&nbsp;<span class="op" id="5162114">(</span><span class="ident" id="5162115">r</span>&nbsp;<span class="op" id="5162117">*</span><span class="ident" id="5162118">RangeNode</span><span class="op" id="5162127">)</span>&nbsp;<span class="ident" id="5162129">Copy</span><span class="op" id="5162133">(</span><span class="op" id="5162134">)</span>&nbsp;<span class="ident" id="5162136">Node</span>&nbsp;<span class="op" id="5162141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5162144">return</span>&nbsp;<span class="ident" id="5162151">r</span><span class="op" id="5162152">.</span><span class="ident" id="5162153">tr</span><span class="op" id="5162155">.</span><span class="ident" id="5162156">newRange</span><span class="op" id="5162164">(</span><span class="ident" id="5162165">r</span><span class="op" id="5162166">.</span><span class="ident" id="5162167">Pos</span><span class="op" id="5162170">,</span>&nbsp;<span class="ident" id="5162172">r</span><span class="op" id="5162173">.</span><span class="ident" id="5162174">Line</span><span class="op" id="5162178">,</span>&nbsp;<span class="ident" id="5162180">r</span><span class="op" id="5162181">.</span><span class="ident" id="5162182">Pipe</span><span class="op" id="5162186">.</span><span class="ident" id="5162187">CopyPipe</span><span class="op" id="5162195">(</span><span class="op" id="5162196">)</span><span class="op" id="5162197">,</span>&nbsp;<span class="ident" id="5162199">r</span><span class="op" id="5162200">.</span><span class="ident" id="5162201">List</span><span class="op" id="5162205">.</span><span class="ident" id="5162206">CopyList</span><span class="op" id="5162214">(</span><span class="op" id="5162215">)</span><span class="op" id="5162216">,</span>&nbsp;<span class="ident" id="5162218">r</span><span class="op" id="5162219">.</span><span class="ident" id="5162220">ElseList</span><span class="op" id="5162228">.</span><span class="ident" id="5162229">CopyList</span><span class="op" id="5162237">(</span><span class="op" id="5162238">)</span><span class="op" id="5162239">)</span><br>
<span class="lineno"></span><span class="op" id="5162241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5162244">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="5162303">type</span>&nbsp;<span class="ident" id="5162308">WithNode</span>&nbsp;<span class="keyword" id="5162317">struct</span>&nbsp;<span class="op" id="5162324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162327">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="5162338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5162341">func</span>&nbsp;<span class="op" id="5162346">(</span><span class="ident" id="5162347">t</span>&nbsp;<span class="op" id="5162349">*</span><span class="ident" id="5162350">Tree</span><span class="op" id="5162354">)</span>&nbsp;<span class="ident" id="5162356">newWith</span><span class="op" id="5162363">(</span><span class="ident" id="5162364">pos</span>&nbsp;<span class="ident" id="5162368">Pos</span><span class="op" id="5162371">,</span>&nbsp;<span class="ident" id="5162373">line</span>&nbsp;<span class="builtintype" id="5162378">int</span><span class="op" id="5162381">,</span>&nbsp;<span class="ident" id="5162383">pipe</span>&nbsp;<span class="op" id="5162388">*</span><span class="ident" id="5162389">PipeNode</span><span class="op" id="5162397">,</span>&nbsp;<span class="ident" id="5162399">list</span><span class="op" id="5162403">,</span>&nbsp;<span class="ident" id="5162405">elseList</span>&nbsp;<span class="op" id="5162414">*</span><span class="ident" id="5162415">ListNode</span><span class="op" id="5162423">)</span>&nbsp;<span class="op" id="5162425">*</span><span class="ident" id="5162426">WithNode</span>&nbsp;<span class="op" id="5162435">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5162438">return</span>&nbsp;<span class="op" id="5162445">&amp;</span><span class="ident" id="5162446">WithNode</span><span class="op" id="5162454">{</span><span class="ident" id="5162455">BranchNode</span><span class="op" id="5162465">{</span><span class="ident" id="5162466">tr</span><span class="op" id="5162468">:</span>&nbsp;<span class="ident" id="5162470">t</span><span class="op" id="5162471">,</span>&nbsp;<span class="ident" id="5162473">NodeType</span><span class="op" id="5162481">:</span>&nbsp;<span class="ident" id="5162483">NodeWith</span><span class="op" id="5162491">,</span>&nbsp;<span class="ident" id="5162493">Pos</span><span class="op" id="5162496">:</span>&nbsp;<span class="ident" id="5162498">pos</span><span class="op" id="5162501">,</span>&nbsp;<span class="ident" id="5162503">Line</span><span class="op" id="5162507">:</span>&nbsp;<span class="ident" id="5162509">line</span><span class="op" id="5162513">,</span>&nbsp;<span class="ident" id="5162515">Pipe</span><span class="op" id="5162519">:</span>&nbsp;<span class="ident" id="5162521">pipe</span><span class="op" id="5162525">,</span>&nbsp;<span class="ident" id="5162527">List</span><span class="op" id="5162531">:</span>&nbsp;<span class="ident" id="5162533">list</span><span class="op" id="5162537">,</span>&nbsp;<span class="ident" id="5162539">ElseList</span><span class="op" id="5162547">:</span>&nbsp;<span class="ident" id="5162549">elseList</span><span class="op" id="5162557">}</span><span class="op" id="5162558">}</span><br>
<span class="lineno"></span><span class="op" id="5162560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5162563">func</span>&nbsp;<span class="op" id="5162568">(</span><span class="ident" id="5162569">w</span>&nbsp;<span class="op" id="5162571">*</span><span class="ident" id="5162572">WithNode</span><span class="op" id="5162580">)</span>&nbsp;<span class="ident" id="5162582">Copy</span><span class="op" id="5162586">(</span><span class="op" id="5162587">)</span>&nbsp;<span class="ident" id="5162589">Node</span>&nbsp;<span class="op" id="5162594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5162597">return</span>&nbsp;<span class="ident" id="5162604">w</span><span class="op" id="5162605">.</span><span class="ident" id="5162606">tr</span><span class="op" id="5162608">.</span><span class="ident" id="5162609">newWith</span><span class="op" id="5162616">(</span><span class="ident" id="5162617">w</span><span class="op" id="5162618">.</span><span class="ident" id="5162619">Pos</span><span class="op" id="5162622">,</span>&nbsp;<span class="ident" id="5162624">w</span><span class="op" id="5162625">.</span><span class="ident" id="5162626">Line</span><span class="op" id="5162630">,</span>&nbsp;<span class="ident" id="5162632">w</span><span class="op" id="5162633">.</span><span class="ident" id="5162634">Pipe</span><span class="op" id="5162638">.</span><span class="ident" id="5162639">CopyPipe</span><span class="op" id="5162647">(</span><span class="op" id="5162648">)</span><span class="op" id="5162649">,</span>&nbsp;<span class="ident" id="5162651">w</span><span class="op" id="5162652">.</span><span class="ident" id="5162653">List</span><span class="op" id="5162657">.</span><span class="ident" id="5162658">CopyList</span><span class="op" id="5162666">(</span><span class="op" id="5162667">)</span><span class="op" id="5162668">,</span>&nbsp;<span class="ident" id="5162670">w</span><span class="op" id="5162671">.</span><span class="ident" id="5162672">ElseList</span><span class="op" id="5162680">.</span><span class="ident" id="5162681">CopyList</span><span class="op" id="5162689">(</span><span class="op" id="5162690">)</span><span class="op" id="5162691">)</span><br>
<span class="lineno">805</span><span class="op" id="5162693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5162696">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="5162746">type</span>&nbsp;<span class="ident" id="5162751">TemplateNode</span>&nbsp;<span class="keyword" id="5162764">struct</span>&nbsp;<span class="op" id="5162771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162774">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162784">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162789">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5162794">*</span><span class="ident" id="5162795">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162801">Line</span>&nbsp;<span class="builtintype" id="5162806">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5162816">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162886">Name</span>&nbsp;<span class="builtintype" id="5162891">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5162901">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162942">Pipe</span>&nbsp;<span class="op" id="5162947">*</span><span class="ident" id="5162948">PipeNode</span>&nbsp;<span class="comment" id="5162957">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="5163009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5163012">func</span>&nbsp;<span class="op" id="5163017">(</span><span class="ident" id="5163018">t</span>&nbsp;<span class="op" id="5163020">*</span><span class="ident" id="5163021">Tree</span><span class="op" id="5163025">)</span>&nbsp;<span class="ident" id="5163027">newTemplate</span><span class="op" id="5163038">(</span><span class="ident" id="5163039">pos</span>&nbsp;<span class="ident" id="5163043">Pos</span><span class="op" id="5163046">,</span>&nbsp;<span class="ident" id="5163048">line</span>&nbsp;<span class="builtintype" id="5163053">int</span><span class="op" id="5163056">,</span>&nbsp;<span class="ident" id="5163058">name</span>&nbsp;<span class="builtintype" id="5163063">string</span><span class="op" id="5163069">,</span>&nbsp;<span class="ident" id="5163071">pipe</span>&nbsp;<span class="op" id="5163076">*</span><span class="ident" id="5163077">PipeNode</span><span class="op" id="5163085">)</span>&nbsp;<span class="op" id="5163087">*</span><span class="ident" id="5163088">TemplateNode</span>&nbsp;<span class="op" id="5163101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5163104">return</span>&nbsp;<span class="op" id="5163111">&amp;</span><span class="ident" id="5163112">TemplateNode</span><span class="op" id="5163124">{</span><span class="ident" id="5163125">tr</span><span class="op" id="5163127">:</span>&nbsp;<span class="ident" id="5163129">t</span><span class="op" id="5163130">,</span>&nbsp;<span class="ident" id="5163132">NodeType</span><span class="op" id="5163140">:</span>&nbsp;<span class="ident" id="5163142">NodeTemplate</span><span class="op" id="5163154">,</span>&nbsp;<span class="ident" id="5163156">Pos</span><span class="op" id="5163159">:</span>&nbsp;<span class="ident" id="5163161">pos</span><span class="op" id="5163164">,</span>&nbsp;<span class="ident" id="5163166">Line</span><span class="op" id="5163170">:</span>&nbsp;<span class="ident" id="5163172">line</span><span class="op" id="5163176">,</span>&nbsp;<span class="ident" id="5163178">Name</span><span class="op" id="5163182">:</span>&nbsp;<span class="ident" id="5163184">name</span><span class="op" id="5163188">,</span>&nbsp;<span class="ident" id="5163190">Pipe</span><span class="op" id="5163194">:</span>&nbsp;<span class="ident" id="5163196">pipe</span><span class="op" id="5163200">}</span><br>
<span class="lineno"></span><span class="op" id="5163202">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="5163205">func</span>&nbsp;<span class="op" id="5163210">(</span><span class="ident" id="5163211">t</span>&nbsp;<span class="op" id="5163213">*</span><span class="ident" id="5163214">TemplateNode</span><span class="op" id="5163226">)</span>&nbsp;<span class="ident" id="5163228">String</span><span class="op" id="5163234">(</span><span class="op" id="5163235">)</span>&nbsp;<span class="builtintype" id="5163237">string</span>&nbsp;<span class="op" id="5163244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5163247">if</span>&nbsp;<span class="ident" id="5163250">t</span><span class="op" id="5163251">.</span><span class="ident" id="5163252">Pipe</span>&nbsp;<span class="op" id="5163257">==</span>&nbsp;<span class="ident" id="5163260">nil</span>&nbsp;<span class="op" id="5163264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5163268">return</span>&nbsp;<span class="ident" id="5163275">fmt</span><span class="op" id="5163278">.</span><span class="ident" id="5163279">Sprintf</span><span class="op" id="5163286">(</span><span class="string" id="5163287">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="5163304">,</span>&nbsp;<span class="ident" id="5163306">t</span><span class="op" id="5163307">.</span><span class="ident" id="5163308">Name</span><span class="op" id="5163312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5163315">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5163318">return</span>&nbsp;<span class="ident" id="5163325">fmt</span><span class="op" id="5163328">.</span><span class="ident" id="5163329">Sprintf</span><span class="op" id="5163336">(</span><span class="string" id="5163337">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="5163357">,</span>&nbsp;<span class="ident" id="5163359">t</span><span class="op" id="5163360">.</span><span class="ident" id="5163361">Name</span><span class="op" id="5163365">,</span>&nbsp;<span class="ident" id="5163367">t</span><span class="op" id="5163368">.</span><span class="ident" id="5163369">Pipe</span><span class="op" id="5163373">)</span><br>
<span class="lineno"></span><span class="op" id="5163375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5163378">func</span>&nbsp;<span class="op" id="5163383">(</span><span class="ident" id="5163384">t</span>&nbsp;<span class="op" id="5163386">*</span><span class="ident" id="5163387">TemplateNode</span><span class="op" id="5163399">)</span>&nbsp;<span class="ident" id="5163401">tree</span><span class="op" id="5163405">(</span><span class="op" id="5163406">)</span>&nbsp;<span class="op" id="5163408">*</span><span class="ident" id="5163409">Tree</span>&nbsp;<span class="op" id="5163414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5163417">return</span>&nbsp;<span class="ident" id="5163424">t</span><span class="op" id="5163425">.</span><span class="ident" id="5163426">tr</span><br>
<span class="lineno">830</span><span class="op" id="5163429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5163432">func</span>&nbsp;<span class="op" id="5163437">(</span><span class="ident" id="5163438">t</span>&nbsp;<span class="op" id="5163440">*</span><span class="ident" id="5163441">TemplateNode</span><span class="op" id="5163453">)</span>&nbsp;<span class="ident" id="5163455">Copy</span><span class="op" id="5163459">(</span><span class="op" id="5163460">)</span>&nbsp;<span class="ident" id="5163462">Node</span>&nbsp;<span class="op" id="5163467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5163470">return</span>&nbsp;<span class="ident" id="5163477">t</span><span class="op" id="5163478">.</span><span class="ident" id="5163479">tr</span><span class="op" id="5163481">.</span><span class="ident" id="5163482">newTemplate</span><span class="op" id="5163493">(</span><span class="ident" id="5163494">t</span><span class="op" id="5163495">.</span><span class="ident" id="5163496">Pos</span><span class="op" id="5163499">,</span>&nbsp;<span class="ident" id="5163501">t</span><span class="op" id="5163502">.</span><span class="ident" id="5163503">Line</span><span class="op" id="5163507">,</span>&nbsp;<span class="ident" id="5163509">t</span><span class="op" id="5163510">.</span><span class="ident" id="5163511">Name</span><span class="op" id="5163515">,</span>&nbsp;<span class="ident" id="5163517">t</span><span class="op" id="5163518">.</span><span class="ident" id="5163519">Pipe</span><span class="op" id="5163523">.</span><span class="ident" id="5163524">CopyPipe</span><span class="op" id="5163532">(</span><span class="op" id="5163533">)</span><span class="op" id="5163534">)</span><br>
<span class="lineno"></span><span class="op" id="5163536">}</span>
</div>
</body>
</html>
