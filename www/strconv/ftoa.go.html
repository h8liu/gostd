<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2990604">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2990659">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2990713">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2990764">//&nbsp;Binary&nbsp;to&nbsp;decimal&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2990812">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2990826">//&nbsp;&nbsp;&nbsp;1)&nbsp;store&nbsp;mantissa&nbsp;in&nbsp;multiprecision&nbsp;decimal</span><br>
<span class="lineno"></span><span class="comment" id="2990875">//&nbsp;&nbsp;&nbsp;2)&nbsp;shift&nbsp;decimal&nbsp;by&nbsp;exponent</span><br>
<span class="lineno"></span><span class="comment" id="2990909">//&nbsp;&nbsp;&nbsp;3)&nbsp;read&nbsp;digits&nbsp;out&nbsp;&amp;&nbsp;format</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="2990943">package</span>&nbsp;<span class="ident" id="2990951">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2990960">import</span>&nbsp;<span class="string" id="2990967">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="2990975">//&nbsp;TODO:&nbsp;move&nbsp;elsewhere?</span><br>
<span class="lineno"></span><span class="keyword" id="2991000">type</span>&nbsp;<span class="ident" id="2991005">floatInfo</span>&nbsp;<span class="keyword" id="2991015">struct</span>&nbsp;<span class="op" id="2991022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991025">mantbits</span>&nbsp;<span class="builtintype" id="2991034">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991040">expbits</span>&nbsp;&nbsp;<span class="builtintype" id="2991049">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991055">bias</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2991064">int</span><br>
<span class="lineno">20</span><span class="op" id="2991068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2991071">var</span>&nbsp;<span class="ident" id="2991075">float32info</span>&nbsp;<span class="op" id="2991087">=</span>&nbsp;<span class="ident" id="2991089"><a href="/strconv/ftoa.go.html#2991005">floatInfo</a></span><span class="op" id="2991098">{</span><span class="num" id="2991099">23</span><span class="op" id="2991101">,</span>&nbsp;<span class="num" id="2991103">8</span><span class="op" id="2991104">,</span>&nbsp;<span class="op" id="2991106">-</span><span class="num" id="2991107">127</span><span class="op" id="2991110">}</span><br>
<span class="lineno"></span><span class="keyword" id="2991112">var</span>&nbsp;<span class="ident" id="2991116">float64info</span>&nbsp;<span class="op" id="2991128">=</span>&nbsp;<span class="ident" id="2991130"><a href="/strconv/ftoa.go.html#2991005">floatInfo</a></span><span class="op" id="2991139">{</span><span class="num" id="2991140">52</span><span class="op" id="2991142">,</span>&nbsp;<span class="num" id="2991144">11</span><span class="op" id="2991146">,</span>&nbsp;<span class="op" id="2991148">-</span><span class="num" id="2991149">1023</span><span class="op" id="2991153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2991156">//&nbsp;FormatFloat&nbsp;converts&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;f&nbsp;to&nbsp;a&nbsp;string,</span><br>
<span class="lineno"></span><span class="comment" id="2991221">//&nbsp;according&nbsp;to&nbsp;the&nbsp;format&nbsp;fmt&nbsp;and&nbsp;precision&nbsp;prec.&nbsp;&nbsp;It&nbsp;rounds&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2991287">//&nbsp;result&nbsp;assuming&nbsp;that&nbsp;the&nbsp;original&nbsp;was&nbsp;obtained&nbsp;from&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno"></span><span class="comment" id="2991359">//&nbsp;value&nbsp;of&nbsp;bitSize&nbsp;bits&nbsp;(32&nbsp;for&nbsp;float32,&nbsp;64&nbsp;for&nbsp;float64).</span><br>
<span class="lineno"></span><span class="comment" id="2991418">//</span><br>
<span class="lineno">30</span><span class="comment" id="2991421">//&nbsp;The&nbsp;format&nbsp;fmt&nbsp;is&nbsp;one&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2991449">//&nbsp;&#39;b&#39;&nbsp;(-ddddp±ddd,&nbsp;a&nbsp;binary&nbsp;exponent),</span><br>
<span class="lineno"></span><span class="comment" id="2991490">//&nbsp;&#39;e&#39;&nbsp;(-d.dddde±dd,&nbsp;a&nbsp;decimal&nbsp;exponent),</span><br>
<span class="lineno"></span><span class="comment" id="2991533">//&nbsp;&#39;E&#39;&nbsp;(-d.ddddE±dd,&nbsp;a&nbsp;decimal&nbsp;exponent),</span><br>
<span class="lineno"></span><span class="comment" id="2991576">//&nbsp;&#39;f&#39;&nbsp;(-ddd.dddd,&nbsp;no&nbsp;exponent),</span><br>
<span class="lineno">35</span><span class="comment" id="2991609">//&nbsp;&#39;g&#39;&nbsp;(&#39;e&#39;&nbsp;for&nbsp;large&nbsp;exponents,&nbsp;&#39;f&#39;&nbsp;otherwise),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2991661">//&nbsp;&#39;G&#39;&nbsp;(&#39;E&#39;&nbsp;for&nbsp;large&nbsp;exponents,&nbsp;&#39;f&#39;&nbsp;otherwise).</span><br>
<span class="lineno"></span><span class="comment" id="2991710">//</span><br>
<span class="lineno"></span><span class="comment" id="2991713">//&nbsp;The&nbsp;precision&nbsp;prec&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2991765">//&nbsp;(excluding&nbsp;the&nbsp;exponent)&nbsp;printed&nbsp;by&nbsp;the&nbsp;&#39;e&#39;,&nbsp;&#39;E&#39;,&nbsp;&#39;f&#39;,&nbsp;&#39;g&#39;,&nbsp;and&nbsp;&#39;G&#39;&nbsp;formats.</span><br>
<span class="lineno">40</span><span class="comment" id="2991845">//&nbsp;For&nbsp;&#39;e&#39;,&nbsp;&#39;E&#39;,&nbsp;and&nbsp;&#39;f&#39;&nbsp;it&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;digits&nbsp;after&nbsp;the&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span><span class="comment" id="2991922">//&nbsp;For&nbsp;&#39;g&#39;&nbsp;and&nbsp;&#39;G&#39;&nbsp;it&nbsp;is&nbsp;the&nbsp;total&nbsp;number&nbsp;of&nbsp;digits.</span><br>
<span class="lineno"></span><span class="comment" id="2991975">//&nbsp;The&nbsp;special&nbsp;precision&nbsp;-1&nbsp;uses&nbsp;the&nbsp;smallest&nbsp;number&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2992038">//&nbsp;necessary&nbsp;such&nbsp;that&nbsp;ParseFloat&nbsp;will&nbsp;return&nbsp;f&nbsp;exactly.</span><br>
<span class="lineno"></span><span class="keyword" id="2992095">func</span>&nbsp;<span class="ident" id="2992100">FormatFloat</span><span class="op" id="2992111">(</span><span class="ident" id="2992112">f</span>&nbsp;<span class="builtintype" id="2992114">float64</span><span class="op" id="2992121">,</span>&nbsp;<span class="ident" id="2992123">fmt</span>&nbsp;<span class="builtintype" id="2992127">byte</span><span class="op" id="2992131">,</span>&nbsp;<span class="ident" id="2992133">prec</span><span class="op" id="2992137">,</span>&nbsp;<span class="ident" id="2992139">bitSize</span>&nbsp;<span class="builtintype" id="2992147">int</span><span class="op" id="2992150">)</span>&nbsp;<span class="builtintype" id="2992152">string</span>&nbsp;<span class="op" id="2992159">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992162">return</span>&nbsp;<span class="builtintype" id="2992169">string</span><span class="op" id="2992175">(</span><span class="ident" id="2992176"><a href="/strconv/ftoa.go.html#2992530">genericFtoa</a></span><span class="op" id="2992187">(</span><span class="builtinfunc" id="2992188">make</span><span class="op" id="2992192">(</span><span class="op" id="2992193">[</span><span class="op" id="2992194">]</span><span class="builtintype" id="2992195">byte</span><span class="op" id="2992199">,</span>&nbsp;<span class="num" id="2992201">0</span><span class="op" id="2992202">,</span>&nbsp;<span class="ident" id="2992204"><a href="/strconv/ftoa.go.html#3001906">max</a></span><span class="op" id="2992207">(</span><span class="ident" id="2992208"><a href="/strconv/ftoa.go.html#2992133">prec</a></span><span class="op" id="2992212">+</span><span class="num" id="2992213">4</span><span class="op" id="2992214">,</span>&nbsp;<span class="num" id="2992216">24</span><span class="op" id="2992218">)</span><span class="op" id="2992219">)</span><span class="op" id="2992220">,</span>&nbsp;<span class="ident" id="2992222"><a href="/strconv/ftoa.go.html#2992112">f</a></span><span class="op" id="2992223">,</span>&nbsp;<span class="ident" id="2992225"><a href="/strconv/ftoa.go.html#2992123">fmt</a></span><span class="op" id="2992228">,</span>&nbsp;<span class="ident" id="2992230"><a href="/strconv/ftoa.go.html#2992133">prec</a></span><span class="op" id="2992234">,</span>&nbsp;<span class="ident" id="2992236"><a href="/strconv/ftoa.go.html#2992139">bitSize</a></span><span class="op" id="2992243">)</span><span class="op" id="2992244">)</span><br>
<span class="lineno"></span><span class="op" id="2992246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2992249">//&nbsp;AppendFloat&nbsp;appends&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;f,</span><br>
<span class="lineno"></span><span class="comment" id="2992320">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;FormatFloat,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">50</span><span class="keyword" id="2992392">func</span>&nbsp;<span class="ident" id="2992397">AppendFloat</span><span class="op" id="2992408">(</span><span class="ident" id="2992409">dst</span>&nbsp;<span class="op" id="2992413">[</span><span class="op" id="2992414">]</span><span class="builtintype" id="2992415">byte</span><span class="op" id="2992419">,</span>&nbsp;<span class="ident" id="2992421">f</span>&nbsp;<span class="builtintype" id="2992423">float64</span><span class="op" id="2992430">,</span>&nbsp;<span class="ident" id="2992432">fmt</span>&nbsp;<span class="builtintype" id="2992436">byte</span><span class="op" id="2992440">,</span>&nbsp;<span class="ident" id="2992442">prec</span>&nbsp;<span class="builtintype" id="2992447">int</span><span class="op" id="2992450">,</span>&nbsp;<span class="ident" id="2992452">bitSize</span>&nbsp;<span class="builtintype" id="2992460">int</span><span class="op" id="2992463">)</span>&nbsp;<span class="op" id="2992465">[</span><span class="op" id="2992466">]</span><span class="builtintype" id="2992467">byte</span>&nbsp;<span class="op" id="2992472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992475">return</span>&nbsp;<span class="ident" id="2992482"><a href="/strconv/ftoa.go.html#2992530">genericFtoa</a></span><span class="op" id="2992493">(</span><span class="ident" id="2992494"><a href="/strconv/ftoa.go.html#2992409">dst</a></span><span class="op" id="2992497">,</span>&nbsp;<span class="ident" id="2992499"><a href="/strconv/ftoa.go.html#2992421">f</a></span><span class="op" id="2992500">,</span>&nbsp;<span class="ident" id="2992502"><a href="/strconv/ftoa.go.html#2992432">fmt</a></span><span class="op" id="2992505">,</span>&nbsp;<span class="ident" id="2992507"><a href="/strconv/ftoa.go.html#2992442">prec</a></span><span class="op" id="2992511">,</span>&nbsp;<span class="ident" id="2992513"><a href="/strconv/ftoa.go.html#2992452">bitSize</a></span><span class="op" id="2992520">)</span><br>
<span class="lineno"></span><span class="op" id="2992522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2992525">func</span>&nbsp;<span class="ident" id="2992530">genericFtoa</span><span class="op" id="2992541">(</span><span class="ident" id="2992542">dst</span>&nbsp;<span class="op" id="2992546">[</span><span class="op" id="2992547">]</span><span class="builtintype" id="2992548">byte</span><span class="op" id="2992552">,</span>&nbsp;<span class="ident" id="2992554">val</span>&nbsp;<span class="builtintype" id="2992558">float64</span><span class="op" id="2992565">,</span>&nbsp;<span class="ident" id="2992567">fmt</span>&nbsp;<span class="builtintype" id="2992571">byte</span><span class="op" id="2992575">,</span>&nbsp;<span class="ident" id="2992577">prec</span><span class="op" id="2992581">,</span>&nbsp;<span class="ident" id="2992583">bitSize</span>&nbsp;<span class="builtintype" id="2992591">int</span><span class="op" id="2992594">)</span>&nbsp;<span class="op" id="2992596">[</span><span class="op" id="2992597">]</span><span class="builtintype" id="2992598">byte</span>&nbsp;<span class="op" id="2992603">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992606">var</span>&nbsp;<span class="ident" id="2992610">bits</span>&nbsp;<span class="ident" id="2992615">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992623">var</span>&nbsp;<span class="ident" id="2992627">flt</span>&nbsp;<span class="op" id="2992631">*</span><span class="ident" id="2992632"><a href="/strconv/ftoa.go.html#2991005">floatInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992643">switch</span>&nbsp;<span class="ident" id="2992650"><a href="/strconv/ftoa.go.html#2992583">bitSize</a></span>&nbsp;<span class="op" id="2992658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992661">case</span>&nbsp;<span class="num" id="2992666">32</span><span class="op" id="2992668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992672"><a href="/strconv/ftoa.go.html#2992610">bits</a></span>&nbsp;<span class="op" id="2992677">=</span>&nbsp;<span class="ident" id="2992679">uint64</span><span class="op" id="2992685">(</span><span class="ident" id="2992686"><a href="/strconv/ftoa.go.html#2990967">math</a></span><span class="op" id="2992690">.</span><span class="ident" id="2992691">Float32bits</span><span class="op" id="2992702">(</span><span class="builtintype" id="2992703">float32</span><span class="op" id="2992710">(</span><span class="ident" id="2992711"><a href="/strconv/ftoa.go.html#2992554">val</a></span><span class="op" id="2992714">)</span><span class="op" id="2992715">)</span><span class="op" id="2992716">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992720"><a href="/strconv/ftoa.go.html#2992627">flt</a></span>&nbsp;<span class="op" id="2992724">=</span>&nbsp;<span class="op" id="2992726">&amp;</span><span class="ident" id="2992727"><a href="/strconv/ftoa.go.html#2991075">float32info</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992740">case</span>&nbsp;<span class="num" id="2992745">64</span><span class="op" id="2992747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992751"><a href="/strconv/ftoa.go.html#2992610">bits</a></span>&nbsp;<span class="op" id="2992756">=</span>&nbsp;<span class="ident" id="2992758"><a href="/strconv/ftoa.go.html#2990967">math</a></span><span class="op" id="2992762">.</span><span class="ident" id="2992763">Float64bits</span><span class="op" id="2992774">(</span><span class="ident" id="2992775"><a href="/strconv/ftoa.go.html#2992554">val</a></span><span class="op" id="2992778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992782"><a href="/strconv/ftoa.go.html#2992627">flt</a></span>&nbsp;<span class="op" id="2992786">=</span>&nbsp;<span class="op" id="2992788">&amp;</span><span class="ident" id="2992789"><a href="/strconv/ftoa.go.html#2991116">float64info</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992802">default</span><span class="op" id="2992809">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2992813">panic</span><span class="op" id="2992818">(</span><span class="string" id="2992819">&#34;strconv:&nbsp;illegal&nbsp;AppendFloat/FormatFloat&nbsp;bitSize&#34;</span><span class="op" id="2992869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2992872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992876">neg</span>&nbsp;<span class="op" id="2992880">:=</span>&nbsp;<span class="ident" id="2992883"><a href="/strconv/ftoa.go.html#2992610">bits</a></span><span class="op" id="2992887">&gt;&gt;</span><span class="op" id="2992889">(</span><span class="ident" id="2992890"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2992893">.</span><span class="ident" id="2992894">expbits</span><span class="op" id="2992901">+</span><span class="ident" id="2992902"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2992905">.</span><span class="ident" id="2992906">mantbits</span><span class="op" id="2992914">)</span>&nbsp;<span class="op" id="2992916">!=</span>&nbsp;<span class="num" id="2992919">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992922">exp</span>&nbsp;<span class="op" id="2992926">:=</span>&nbsp;<span class="builtintype" id="2992929">int</span><span class="op" id="2992932">(</span><span class="ident" id="2992933"><a href="/strconv/ftoa.go.html#2992610">bits</a></span><span class="op" id="2992937">&gt;&gt;</span><span class="ident" id="2992939"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2992942">.</span><span class="ident" id="2992943">mantbits</span><span class="op" id="2992951">)</span>&nbsp;<span class="op" id="2992953">&amp;</span>&nbsp;<span class="op" id="2992955">(</span><span class="num" id="2992956">1</span><span class="op" id="2992957">&lt;&lt;</span><span class="ident" id="2992959"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2992962">.</span><span class="ident" id="2992963">expbits</span>&nbsp;<span class="op" id="2992971">-</span>&nbsp;<span class="num" id="2992973">1</span><span class="op" id="2992974">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992977">mant</span>&nbsp;<span class="op" id="2992982">:=</span>&nbsp;<span class="ident" id="2992985"><a href="/strconv/ftoa.go.html#2992610">bits</a></span>&nbsp;<span class="op" id="2992990">&amp;</span>&nbsp;<span class="op" id="2992992">(</span><span class="ident" id="2992993">uint64</span><span class="op" id="2992999">(</span><span class="num" id="2993000">1</span><span class="op" id="2993001">)</span><span class="op" id="2993002">&lt;&lt;</span><span class="ident" id="2993004"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2993007">.</span><span class="ident" id="2993008">mantbits</span>&nbsp;<span class="op" id="2993017">-</span>&nbsp;<span class="num" id="2993019">1</span><span class="op" id="2993020">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993024">switch</span>&nbsp;<span class="ident" id="2993031"><a href="/strconv/ftoa.go.html#2992922">exp</a></span>&nbsp;<span class="op" id="2993035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993038">case</span>&nbsp;<span class="num" id="2993043">1</span><span class="op" id="2993044">&lt;&lt;</span><span class="ident" id="2993046"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2993049">.</span><span class="ident" id="2993050">expbits</span>&nbsp;<span class="op" id="2993058">-</span>&nbsp;<span class="num" id="2993060">1</span><span class="op" id="2993061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993065">//&nbsp;Inf,&nbsp;NaN</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993079">var</span>&nbsp;<span class="ident" id="2993083">s</span>&nbsp;<span class="builtintype" id="2993085">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993094">switch</span>&nbsp;<span class="op" id="2993101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993105">case</span>&nbsp;<span class="ident" id="2993110"><a href="/strconv/ftoa.go.html#2992977">mant</a></span>&nbsp;<span class="op" id="2993115">!=</span>&nbsp;<span class="num" id="2993118">0</span><span class="op" id="2993119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993124"><a href="/strconv/ftoa.go.html#2993083">s</a></span>&nbsp;<span class="op" id="2993126">=</span>&nbsp;<span class="string" id="2993128">&#34;NaN&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993136">case</span>&nbsp;<span class="ident" id="2993141"><a href="/strconv/ftoa.go.html#2992876">neg</a></span><span class="op" id="2993144">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993149"><a href="/strconv/ftoa.go.html#2993083">s</a></span>&nbsp;<span class="op" id="2993151">=</span>&nbsp;<span class="string" id="2993153">&#34;-Inf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993162">default</span><span class="op" id="2993169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993174"><a href="/strconv/ftoa.go.html#2993083">s</a></span>&nbsp;<span class="op" id="2993176">=</span>&nbsp;<span class="string" id="2993178">&#34;+Inf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993191">return</span>&nbsp;<span class="builtinfunc" id="2993198">append</span><span class="op" id="2993204">(</span><span class="ident" id="2993205"><a href="/strconv/ftoa.go.html#2992542">dst</a></span><span class="op" id="2993208">,</span>&nbsp;<span class="ident" id="2993210"><a href="/strconv/ftoa.go.html#2993083">s</a></span><span class="op" id="2993211">...</span><span class="op" id="2993214">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993218">case</span>&nbsp;<span class="num" id="2993223">0</span><span class="op" id="2993224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993228">//&nbsp;denormalized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993246"><a href="/strconv/ftoa.go.html#2992922">exp</a></span><span class="op" id="2993249">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993254">default</span><span class="op" id="2993261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993265">//&nbsp;add&nbsp;implicit&nbsp;top&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993291"><a href="/strconv/ftoa.go.html#2992977">mant</a></span>&nbsp;<span class="op" id="2993296">|=</span>&nbsp;<span class="ident" id="2993299">uint64</span><span class="op" id="2993305">(</span><span class="num" id="2993306">1</span><span class="op" id="2993307">)</span>&nbsp;<span class="op" id="2993309">&lt;&lt;</span>&nbsp;<span class="ident" id="2993312"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2993315">.</span><span class="ident" id="2993316">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993329"><a href="/strconv/ftoa.go.html#2992922">exp</a></span>&nbsp;<span class="op" id="2993333">+=</span>&nbsp;<span class="ident" id="2993336"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2993339">.</span><span class="ident" id="2993340">bias</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993347">//&nbsp;Pick&nbsp;off&nbsp;easy&nbsp;binary&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993380">if</span>&nbsp;<span class="ident" id="2993383"><a href="/strconv/ftoa.go.html#2992567">fmt</a></span>&nbsp;<span class="op" id="2993387">==</span>&nbsp;<span class="string" id="2993390">&#39;b&#39;</span>&nbsp;<span class="op" id="2993394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993398">return</span>&nbsp;<span class="ident" id="2993405"><a href="/strconv/ftoa.go.html#3001415">fmtB</a></span><span class="op" id="2993409">(</span><span class="ident" id="2993410"><a href="/strconv/ftoa.go.html#2992542">dst</a></span><span class="op" id="2993413">,</span>&nbsp;<span class="ident" id="2993415"><a href="/strconv/ftoa.go.html#2992876">neg</a></span><span class="op" id="2993418">,</span>&nbsp;<span class="ident" id="2993420"><a href="/strconv/ftoa.go.html#2992977">mant</a></span><span class="op" id="2993424">,</span>&nbsp;<span class="ident" id="2993426"><a href="/strconv/ftoa.go.html#2992922">exp</a></span><span class="op" id="2993429">,</span>&nbsp;<span class="ident" id="2993431"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2993434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993437">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993441">if</span>&nbsp;<span class="op" id="2993444">!</span><span class="ident" id="2993445"><a href="/strconv/atof.go.html#2947008">optimize</a></span>&nbsp;<span class="op" id="2993454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993458">return</span>&nbsp;<span class="ident" id="2993465"><a href="/strconv/ftoa.go.html#2994713">bigFtoa</a></span><span class="op" id="2993472">(</span><span class="ident" id="2993473"><a href="/strconv/ftoa.go.html#2992542">dst</a></span><span class="op" id="2993476">,</span>&nbsp;<span class="ident" id="2993478"><a href="/strconv/ftoa.go.html#2992577">prec</a></span><span class="op" id="2993482">,</span>&nbsp;<span class="ident" id="2993484"><a href="/strconv/ftoa.go.html#2992567">fmt</a></span><span class="op" id="2993487">,</span>&nbsp;<span class="ident" id="2993489"><a href="/strconv/ftoa.go.html#2992876">neg</a></span><span class="op" id="2993492">,</span>&nbsp;<span class="ident" id="2993494"><a href="/strconv/ftoa.go.html#2992977">mant</a></span><span class="op" id="2993498">,</span>&nbsp;<span class="ident" id="2993500"><a href="/strconv/ftoa.go.html#2992922">exp</a></span><span class="op" id="2993503">,</span>&nbsp;<span class="ident" id="2993505"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2993508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993515">var</span>&nbsp;<span class="ident" id="2993519">digs</span>&nbsp;<span class="ident" id="2993524"><a href="/strconv/ftoa.go.html#2999738">decimalSlice</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993538">ok</span>&nbsp;<span class="op" id="2993541">:=</span>&nbsp;<span class="builtintype" id="2993544">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993551">//&nbsp;Negative&nbsp;precision&nbsp;means&nbsp;&#34;only&nbsp;as&nbsp;much&nbsp;as&nbsp;needed&nbsp;to&nbsp;be&nbsp;exact.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993618">shortest</span>&nbsp;<span class="op" id="2993627">:=</span>&nbsp;<span class="ident" id="2993630"><a href="/strconv/ftoa.go.html#2992577">prec</a></span>&nbsp;<span class="op" id="2993635">&lt;</span>&nbsp;<span class="num" id="2993637">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993640">if</span>&nbsp;<span class="ident" id="2993643"><a href="/strconv/ftoa.go.html#2993618">shortest</a></span>&nbsp;<span class="op" id="2993652">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993656">//&nbsp;Try&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993683">f</span>&nbsp;<span class="op" id="2993685">:=</span>&nbsp;<span class="builtinfunc" id="2993688">new</span><span class="op" id="2993691">(</span><span class="ident" id="2993692"><a href="/strconv/extfloat.go.html#2970762">extFloat</a></span><span class="op" id="2993700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993704">lower</span><span class="op" id="2993709">,</span>&nbsp;<span class="ident" id="2993711">upper</span>&nbsp;<span class="op" id="2993717">:=</span>&nbsp;<span class="ident" id="2993720"><a href="/strconv/ftoa.go.html#2993683">f</a></span><span class="op" id="2993721">.</span><span class="ident" id="2993722">AssignComputeBounds</span><span class="op" id="2993741">(</span><span class="ident" id="2993742"><a href="/strconv/ftoa.go.html#2992977">mant</a></span><span class="op" id="2993746">,</span>&nbsp;<span class="ident" id="2993748"><a href="/strconv/ftoa.go.html#2992922">exp</a></span><span class="op" id="2993751">,</span>&nbsp;<span class="ident" id="2993753"><a href="/strconv/ftoa.go.html#2992876">neg</a></span><span class="op" id="2993756">,</span>&nbsp;<span class="ident" id="2993758"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2993761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993765">var</span>&nbsp;<span class="ident" id="2993769">buf</span>&nbsp;<span class="op" id="2993773">[</span><span class="num" id="2993774">32</span><span class="op" id="2993776">]</span><span class="builtintype" id="2993777">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993784"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2993788">.</span><span class="ident" id="2993789">d</span>&nbsp;<span class="op" id="2993791">=</span>&nbsp;<span class="ident" id="2993793"><a href="/strconv/ftoa.go.html#2993769">buf</a></span><span class="op" id="2993796">[</span><span class="op" id="2993797">:</span><span class="op" id="2993798">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993802"><a href="/strconv/ftoa.go.html#2993538">ok</a></span>&nbsp;<span class="op" id="2993805">=</span>&nbsp;<span class="ident" id="2993807"><a href="/strconv/ftoa.go.html#2993683">f</a></span><span class="op" id="2993808">.</span><span class="ident" id="2993809">ShortestDecimal</span><span class="op" id="2993824">(</span><span class="op" id="2993825">&amp;</span><span class="ident" id="2993826"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2993830">,</span>&nbsp;<span class="op" id="2993832">&amp;</span><span class="ident" id="2993833"><a href="/strconv/ftoa.go.html#2993704">lower</a></span><span class="op" id="2993838">,</span>&nbsp;<span class="op" id="2993840">&amp;</span><span class="ident" id="2993841"><a href="/strconv/ftoa.go.html#2993711">upper</a></span><span class="op" id="2993846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993850">if</span>&nbsp;<span class="op" id="2993853">!</span><span class="ident" id="2993854"><a href="/strconv/ftoa.go.html#2993538">ok</a></span>&nbsp;<span class="op" id="2993857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993862">return</span>&nbsp;<span class="ident" id="2993869"><a href="/strconv/ftoa.go.html#2994713">bigFtoa</a></span><span class="op" id="2993876">(</span><span class="ident" id="2993877"><a href="/strconv/ftoa.go.html#2992542">dst</a></span><span class="op" id="2993880">,</span>&nbsp;<span class="ident" id="2993882"><a href="/strconv/ftoa.go.html#2992577">prec</a></span><span class="op" id="2993886">,</span>&nbsp;<span class="ident" id="2993888"><a href="/strconv/ftoa.go.html#2992567">fmt</a></span><span class="op" id="2993891">,</span>&nbsp;<span class="ident" id="2993893"><a href="/strconv/ftoa.go.html#2992876">neg</a></span><span class="op" id="2993896">,</span>&nbsp;<span class="ident" id="2993898"><a href="/strconv/ftoa.go.html#2992977">mant</a></span><span class="op" id="2993902">,</span>&nbsp;<span class="ident" id="2993904"><a href="/strconv/ftoa.go.html#2992922">exp</a></span><span class="op" id="2993907">,</span>&nbsp;<span class="ident" id="2993909"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2993912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993920">//&nbsp;Precision&nbsp;for&nbsp;shortest&nbsp;representation&nbsp;mode.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993969">switch</span>&nbsp;<span class="ident" id="2993976"><a href="/strconv/ftoa.go.html#2992567">fmt</a></span>&nbsp;<span class="op" id="2993980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993984">case</span>&nbsp;<span class="string" id="2993989">&#39;e&#39;</span><span class="op" id="2993992">,</span>&nbsp;<span class="string" id="2993994">&#39;E&#39;</span><span class="op" id="2993997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994002"><a href="/strconv/ftoa.go.html#2992577">prec</a></span>&nbsp;<span class="op" id="2994007">=</span>&nbsp;<span class="ident" id="2994009"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2994013">.</span><span class="ident" id="2994014">nd</span>&nbsp;<span class="op" id="2994017">-</span>&nbsp;<span class="num" id="2994019">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994023">case</span>&nbsp;<span class="string" id="2994028">&#39;f&#39;</span><span class="op" id="2994031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994036"><a href="/strconv/ftoa.go.html#2992577">prec</a></span>&nbsp;<span class="op" id="2994041">=</span>&nbsp;<span class="ident" id="2994043"><a href="/strconv/ftoa.go.html#3001906">max</a></span><span class="op" id="2994046">(</span><span class="ident" id="2994047"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2994051">.</span><span class="ident" id="2994052">nd</span><span class="op" id="2994054">-</span><span class="ident" id="2994055"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2994059">.</span><span class="ident" id="2994060">dp</span><span class="op" id="2994062">,</span>&nbsp;<span class="num" id="2994064">0</span><span class="op" id="2994065">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994069">case</span>&nbsp;<span class="string" id="2994074">&#39;g&#39;</span><span class="op" id="2994077">,</span>&nbsp;<span class="string" id="2994079">&#39;G&#39;</span><span class="op" id="2994082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994087"><a href="/strconv/ftoa.go.html#2992577">prec</a></span>&nbsp;<span class="op" id="2994092">=</span>&nbsp;<span class="ident" id="2994094"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2994098">.</span><span class="ident" id="2994099">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994107">}</span>&nbsp;<span class="keyword" id="2994109">else</span>&nbsp;<span class="keyword" id="2994114">if</span>&nbsp;<span class="ident" id="2994117"><a href="/strconv/ftoa.go.html#2992567">fmt</a></span>&nbsp;<span class="op" id="2994121">!=</span>&nbsp;<span class="string" id="2994124">&#39;f&#39;</span>&nbsp;<span class="op" id="2994128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2994132">//&nbsp;Fixed&nbsp;number&nbsp;of&nbsp;digits.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994161">digits</span>&nbsp;<span class="op" id="2994168">:=</span>&nbsp;<span class="ident" id="2994171"><a href="/strconv/ftoa.go.html#2992577">prec</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994178">switch</span>&nbsp;<span class="ident" id="2994185"><a href="/strconv/ftoa.go.html#2992567">fmt</a></span>&nbsp;<span class="op" id="2994189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994193">case</span>&nbsp;<span class="string" id="2994198">&#39;e&#39;</span><span class="op" id="2994201">,</span>&nbsp;<span class="string" id="2994203">&#39;E&#39;</span><span class="op" id="2994206">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994211"><a href="/strconv/ftoa.go.html#2994161">digits</a></span><span class="op" id="2994217">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994222">case</span>&nbsp;<span class="string" id="2994227">&#39;g&#39;</span><span class="op" id="2994230">,</span>&nbsp;<span class="string" id="2994232">&#39;G&#39;</span><span class="op" id="2994235">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994240">if</span>&nbsp;<span class="ident" id="2994243"><a href="/strconv/ftoa.go.html#2992577">prec</a></span>&nbsp;<span class="op" id="2994248">==</span>&nbsp;<span class="num" id="2994251">0</span>&nbsp;<span class="op" id="2994253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994259"><a href="/strconv/ftoa.go.html#2992577">prec</a></span>&nbsp;<span class="op" id="2994264">=</span>&nbsp;<span class="num" id="2994266">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994276"><a href="/strconv/ftoa.go.html#2994161">digits</a></span>&nbsp;<span class="op" id="2994283">=</span>&nbsp;<span class="ident" id="2994285"><a href="/strconv/ftoa.go.html#2992577">prec</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994292">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994296">if</span>&nbsp;<span class="ident" id="2994299"><a href="/strconv/ftoa.go.html#2994161">digits</a></span>&nbsp;<span class="op" id="2994306">&lt;=</span>&nbsp;<span class="num" id="2994309">15</span>&nbsp;<span class="op" id="2994312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2994317">//&nbsp;try&nbsp;fast&nbsp;algorithm&nbsp;when&nbsp;the&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;reasonable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994383">var</span>&nbsp;<span class="ident" id="2994387">buf</span>&nbsp;<span class="op" id="2994391">[</span><span class="num" id="2994392">24</span><span class="op" id="2994394">]</span><span class="builtintype" id="2994395">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994403"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2994407">.</span><span class="ident" id="2994408">d</span>&nbsp;<span class="op" id="2994410">=</span>&nbsp;<span class="ident" id="2994412"><a href="/strconv/ftoa.go.html#2994387">buf</a></span><span class="op" id="2994415">[</span><span class="op" id="2994416">:</span><span class="op" id="2994417">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994422">f</span>&nbsp;<span class="op" id="2994424">:=</span>&nbsp;<span class="ident" id="2994427"><a href="/strconv/extfloat.go.html#2970762">extFloat</a></span><span class="op" id="2994435">{</span><span class="ident" id="2994436"><a href="/strconv/ftoa.go.html#2992977">mant</a></span><span class="op" id="2994440">,</span>&nbsp;<span class="ident" id="2994442"><a href="/strconv/ftoa.go.html#2992922">exp</a></span>&nbsp;<span class="op" id="2994446">-</span>&nbsp;<span class="builtintype" id="2994448">int</span><span class="op" id="2994451">(</span><span class="ident" id="2994452"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2994455">.</span><span class="ident" id="2994456">mantbits</span><span class="op" id="2994464">)</span><span class="op" id="2994465">,</span>&nbsp;<span class="ident" id="2994467"><a href="/strconv/ftoa.go.html#2992876">neg</a></span><span class="op" id="2994470">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994475"><a href="/strconv/ftoa.go.html#2993538">ok</a></span>&nbsp;<span class="op" id="2994478">=</span>&nbsp;<span class="ident" id="2994480"><a href="/strconv/ftoa.go.html#2994422">f</a></span><span class="op" id="2994481">.</span><span class="ident" id="2994482">FixedDecimal</span><span class="op" id="2994494">(</span><span class="op" id="2994495">&amp;</span><span class="ident" id="2994496"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2994500">,</span>&nbsp;<span class="ident" id="2994502"><a href="/strconv/ftoa.go.html#2994161">digits</a></span><span class="op" id="2994508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994518">if</span>&nbsp;<span class="op" id="2994521">!</span><span class="ident" id="2994522"><a href="/strconv/ftoa.go.html#2993538">ok</a></span>&nbsp;<span class="op" id="2994525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994529">return</span>&nbsp;<span class="ident" id="2994536"><a href="/strconv/ftoa.go.html#2994713">bigFtoa</a></span><span class="op" id="2994543">(</span><span class="ident" id="2994544"><a href="/strconv/ftoa.go.html#2992542">dst</a></span><span class="op" id="2994547">,</span>&nbsp;<span class="ident" id="2994549"><a href="/strconv/ftoa.go.html#2992577">prec</a></span><span class="op" id="2994553">,</span>&nbsp;<span class="ident" id="2994555"><a href="/strconv/ftoa.go.html#2992567">fmt</a></span><span class="op" id="2994558">,</span>&nbsp;<span class="ident" id="2994560"><a href="/strconv/ftoa.go.html#2992876">neg</a></span><span class="op" id="2994563">,</span>&nbsp;<span class="ident" id="2994565"><a href="/strconv/ftoa.go.html#2992977">mant</a></span><span class="op" id="2994569">,</span>&nbsp;<span class="ident" id="2994571"><a href="/strconv/ftoa.go.html#2992922">exp</a></span><span class="op" id="2994574">,</span>&nbsp;<span class="ident" id="2994576"><a href="/strconv/ftoa.go.html#2992627">flt</a></span><span class="op" id="2994579">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994585">return</span>&nbsp;<span class="ident" id="2994592"><a href="/strconv/ftoa.go.html#2995536">formatDigits</a></span><span class="op" id="2994604">(</span><span class="ident" id="2994605"><a href="/strconv/ftoa.go.html#2992542">dst</a></span><span class="op" id="2994608">,</span>&nbsp;<span class="ident" id="2994610"><a href="/strconv/ftoa.go.html#2993618">shortest</a></span><span class="op" id="2994618">,</span>&nbsp;<span class="ident" id="2994620"><a href="/strconv/ftoa.go.html#2992876">neg</a></span><span class="op" id="2994623">,</span>&nbsp;<span class="ident" id="2994625"><a href="/strconv/ftoa.go.html#2993519">digs</a></span><span class="op" id="2994629">,</span>&nbsp;<span class="ident" id="2994631"><a href="/strconv/ftoa.go.html#2992577">prec</a></span><span class="op" id="2994635">,</span>&nbsp;<span class="ident" id="2994637"><a href="/strconv/ftoa.go.html#2992567">fmt</a></span><span class="op" id="2994640">)</span><br>
<span class="lineno"></span><span class="op" id="2994642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2994645">//&nbsp;bigFtoa&nbsp;uses&nbsp;multiprecision&nbsp;computations&nbsp;to&nbsp;format&nbsp;a&nbsp;float.</span><br>
<span class="lineno">155</span><span class="keyword" id="2994708">func</span>&nbsp;<span class="ident" id="2994713">bigFtoa</span><span class="op" id="2994720">(</span><span class="ident" id="2994721">dst</span>&nbsp;<span class="op" id="2994725">[</span><span class="op" id="2994726">]</span><span class="builtintype" id="2994727">byte</span><span class="op" id="2994731">,</span>&nbsp;<span class="ident" id="2994733">prec</span>&nbsp;<span class="builtintype" id="2994738">int</span><span class="op" id="2994741">,</span>&nbsp;<span class="ident" id="2994743">fmt</span>&nbsp;<span class="builtintype" id="2994747">byte</span><span class="op" id="2994751">,</span>&nbsp;<span class="ident" id="2994753">neg</span>&nbsp;<span class="builtintype" id="2994757">bool</span><span class="op" id="2994761">,</span>&nbsp;<span class="ident" id="2994763">mant</span>&nbsp;<span class="ident" id="2994768">uint64</span><span class="op" id="2994774">,</span>&nbsp;<span class="ident" id="2994776">exp</span>&nbsp;<span class="builtintype" id="2994780">int</span><span class="op" id="2994783">,</span>&nbsp;<span class="ident" id="2994785">flt</span>&nbsp;<span class="op" id="2994789">*</span><span class="ident" id="2994790"><a href="/strconv/ftoa.go.html#2991005">floatInfo</a></span><span class="op" id="2994799">)</span>&nbsp;<span class="op" id="2994801">[</span><span class="op" id="2994802">]</span><span class="builtintype" id="2994803">byte</span>&nbsp;<span class="op" id="2994808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994811">d</span>&nbsp;<span class="op" id="2994813">:=</span>&nbsp;<span class="builtinfunc" id="2994816">new</span><span class="op" id="2994819">(</span><span class="ident" id="2994820"><a href="/strconv/decimal.go.html#2962789">decimal</a></span><span class="op" id="2994827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994830"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2994831">.</span><span class="ident" id="2994832">Assign</span><span class="op" id="2994838">(</span><span class="ident" id="2994839"><a href="/strconv/ftoa.go.html#2994763">mant</a></span><span class="op" id="2994843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994846"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2994847">.</span><span class="ident" id="2994848">Shift</span><span class="op" id="2994853">(</span><span class="ident" id="2994854"><a href="/strconv/ftoa.go.html#2994776">exp</a></span>&nbsp;<span class="op" id="2994858">-</span>&nbsp;<span class="builtintype" id="2994860">int</span><span class="op" id="2994863">(</span><span class="ident" id="2994864"><a href="/strconv/ftoa.go.html#2994785">flt</a></span><span class="op" id="2994867">.</span><span class="ident" id="2994868">mantbits</span><span class="op" id="2994876">)</span><span class="op" id="2994877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994880">var</span>&nbsp;<span class="ident" id="2994884">digs</span>&nbsp;<span class="ident" id="2994889"><a href="/strconv/ftoa.go.html#2999738">decimalSlice</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994903">shortest</span>&nbsp;<span class="op" id="2994912">:=</span>&nbsp;<span class="ident" id="2994915"><a href="/strconv/ftoa.go.html#2994733">prec</a></span>&nbsp;<span class="op" id="2994920">&lt;</span>&nbsp;<span class="num" id="2994922">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994925">if</span>&nbsp;<span class="ident" id="2994928"><a href="/strconv/ftoa.go.html#2994903">shortest</a></span>&nbsp;<span class="op" id="2994937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994941"><a href="/strconv/ftoa.go.html#2996647">roundShortest</a></span><span class="op" id="2994954">(</span><span class="ident" id="2994955"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2994956">,</span>&nbsp;<span class="ident" id="2994958"><a href="/strconv/ftoa.go.html#2994763">mant</a></span><span class="op" id="2994962">,</span>&nbsp;<span class="ident" id="2994964"><a href="/strconv/ftoa.go.html#2994776">exp</a></span><span class="op" id="2994967">,</span>&nbsp;<span class="ident" id="2994969"><a href="/strconv/ftoa.go.html#2994785">flt</a></span><span class="op" id="2994972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994976"><a href="/strconv/ftoa.go.html#2994884">digs</a></span>&nbsp;<span class="op" id="2994981">=</span>&nbsp;<span class="ident" id="2994983"><a href="/strconv/ftoa.go.html#2999738">decimalSlice</a></span><span class="op" id="2994995">{</span><span class="ident" id="2994996">d</span><span class="op" id="2994997">:</span>&nbsp;<span class="ident" id="2994999"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995000">.</span><span class="ident" id="2995001">d</span><span class="op" id="2995002">[</span><span class="op" id="2995003">:</span><span class="op" id="2995004">]</span><span class="op" id="2995005">,</span>&nbsp;<span class="ident" id="2995007">nd</span><span class="op" id="2995009">:</span>&nbsp;<span class="ident" id="2995011"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995012">.</span><span class="ident" id="2995013">nd</span><span class="op" id="2995015">,</span>&nbsp;<span class="ident" id="2995017">dp</span><span class="op" id="2995019">:</span>&nbsp;<span class="ident" id="2995021"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995022">.</span><span class="ident" id="2995023">dp</span><span class="op" id="2995025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2995029">//&nbsp;Precision&nbsp;for&nbsp;shortest&nbsp;representation&nbsp;mode.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995078">switch</span>&nbsp;<span class="ident" id="2995085"><a href="/strconv/ftoa.go.html#2994743">fmt</a></span>&nbsp;<span class="op" id="2995089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995093">case</span>&nbsp;<span class="string" id="2995098">&#39;e&#39;</span><span class="op" id="2995101">,</span>&nbsp;<span class="string" id="2995103">&#39;E&#39;</span><span class="op" id="2995106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995111"><a href="/strconv/ftoa.go.html#2994733">prec</a></span>&nbsp;<span class="op" id="2995116">=</span>&nbsp;<span class="ident" id="2995118"><a href="/strconv/ftoa.go.html#2994884">digs</a></span><span class="op" id="2995122">.</span><span class="ident" id="2995123">nd</span>&nbsp;<span class="op" id="2995126">-</span>&nbsp;<span class="num" id="2995128">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995132">case</span>&nbsp;<span class="string" id="2995137">&#39;f&#39;</span><span class="op" id="2995140">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995145"><a href="/strconv/ftoa.go.html#2994733">prec</a></span>&nbsp;<span class="op" id="2995150">=</span>&nbsp;<span class="ident" id="2995152"><a href="/strconv/ftoa.go.html#3001906">max</a></span><span class="op" id="2995155">(</span><span class="ident" id="2995156"><a href="/strconv/ftoa.go.html#2994884">digs</a></span><span class="op" id="2995160">.</span><span class="ident" id="2995161">nd</span><span class="op" id="2995163">-</span><span class="ident" id="2995164"><a href="/strconv/ftoa.go.html#2994884">digs</a></span><span class="op" id="2995168">.</span><span class="ident" id="2995169">dp</span><span class="op" id="2995171">,</span>&nbsp;<span class="num" id="2995173">0</span><span class="op" id="2995174">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995178">case</span>&nbsp;<span class="string" id="2995183">&#39;g&#39;</span><span class="op" id="2995186">,</span>&nbsp;<span class="string" id="2995188">&#39;G&#39;</span><span class="op" id="2995191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995196"><a href="/strconv/ftoa.go.html#2994733">prec</a></span>&nbsp;<span class="op" id="2995201">=</span>&nbsp;<span class="ident" id="2995203"><a href="/strconv/ftoa.go.html#2994884">digs</a></span><span class="op" id="2995207">.</span><span class="ident" id="2995208">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995216">}</span>&nbsp;<span class="keyword" id="2995218">else</span>&nbsp;<span class="op" id="2995223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2995227">//&nbsp;Round&nbsp;appropriately.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995253">switch</span>&nbsp;<span class="ident" id="2995260"><a href="/strconv/ftoa.go.html#2994743">fmt</a></span>&nbsp;<span class="op" id="2995264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995268">case</span>&nbsp;<span class="string" id="2995273">&#39;e&#39;</span><span class="op" id="2995276">,</span>&nbsp;<span class="string" id="2995278">&#39;E&#39;</span><span class="op" id="2995281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995286"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995287">.</span><span class="ident" id="2995288">Round</span><span class="op" id="2995293">(</span><span class="ident" id="2995294"><a href="/strconv/ftoa.go.html#2994733">prec</a></span>&nbsp;<span class="op" id="2995299">+</span>&nbsp;<span class="num" id="2995301">1</span><span class="op" id="2995302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995306">case</span>&nbsp;<span class="string" id="2995311">&#39;f&#39;</span><span class="op" id="2995314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995319"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995320">.</span><span class="ident" id="2995321">Round</span><span class="op" id="2995326">(</span><span class="ident" id="2995327"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995328">.</span><span class="ident" id="2995329">dp</span>&nbsp;<span class="op" id="2995332">+</span>&nbsp;<span class="ident" id="2995334"><a href="/strconv/ftoa.go.html#2994733">prec</a></span><span class="op" id="2995338">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995342">case</span>&nbsp;<span class="string" id="2995347">&#39;g&#39;</span><span class="op" id="2995350">,</span>&nbsp;<span class="string" id="2995352">&#39;G&#39;</span><span class="op" id="2995355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995360">if</span>&nbsp;<span class="ident" id="2995363"><a href="/strconv/ftoa.go.html#2994733">prec</a></span>&nbsp;<span class="op" id="2995368">==</span>&nbsp;<span class="num" id="2995371">0</span>&nbsp;<span class="op" id="2995373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995379"><a href="/strconv/ftoa.go.html#2994733">prec</a></span>&nbsp;<span class="op" id="2995384">=</span>&nbsp;<span class="num" id="2995386">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995396"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995397">.</span><span class="ident" id="2995398">Round</span><span class="op" id="2995403">(</span><span class="ident" id="2995404"><a href="/strconv/ftoa.go.html#2994733">prec</a></span><span class="op" id="2995408">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995416"><a href="/strconv/ftoa.go.html#2994884">digs</a></span>&nbsp;<span class="op" id="2995421">=</span>&nbsp;<span class="ident" id="2995423"><a href="/strconv/ftoa.go.html#2999738">decimalSlice</a></span><span class="op" id="2995435">{</span><span class="ident" id="2995436">d</span><span class="op" id="2995437">:</span>&nbsp;<span class="ident" id="2995439"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995440">.</span><span class="ident" id="2995441">d</span><span class="op" id="2995442">[</span><span class="op" id="2995443">:</span><span class="op" id="2995444">]</span><span class="op" id="2995445">,</span>&nbsp;<span class="ident" id="2995447">nd</span><span class="op" id="2995449">:</span>&nbsp;<span class="ident" id="2995451"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995452">.</span><span class="ident" id="2995453">nd</span><span class="op" id="2995455">,</span>&nbsp;<span class="ident" id="2995457">dp</span><span class="op" id="2995459">:</span>&nbsp;<span class="ident" id="2995461"><a href="/strconv/ftoa.go.html#2994811">d</a></span><span class="op" id="2995462">.</span><span class="ident" id="2995463">dp</span><span class="op" id="2995465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995471">return</span>&nbsp;<span class="ident" id="2995478"><a href="/strconv/ftoa.go.html#2995536">formatDigits</a></span><span class="op" id="2995490">(</span><span class="ident" id="2995491"><a href="/strconv/ftoa.go.html#2994721">dst</a></span><span class="op" id="2995494">,</span>&nbsp;<span class="ident" id="2995496"><a href="/strconv/ftoa.go.html#2994903">shortest</a></span><span class="op" id="2995504">,</span>&nbsp;<span class="ident" id="2995506"><a href="/strconv/ftoa.go.html#2994753">neg</a></span><span class="op" id="2995509">,</span>&nbsp;<span class="ident" id="2995511"><a href="/strconv/ftoa.go.html#2994884">digs</a></span><span class="op" id="2995515">,</span>&nbsp;<span class="ident" id="2995517"><a href="/strconv/ftoa.go.html#2994733">prec</a></span><span class="op" id="2995521">,</span>&nbsp;<span class="ident" id="2995523"><a href="/strconv/ftoa.go.html#2994743">fmt</a></span><span class="op" id="2995526">)</span><br>
<span class="lineno"></span><span class="op" id="2995528">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="keyword" id="2995531">func</span>&nbsp;<span class="ident" id="2995536">formatDigits</span><span class="op" id="2995548">(</span><span class="ident" id="2995549">dst</span>&nbsp;<span class="op" id="2995553">[</span><span class="op" id="2995554">]</span><span class="builtintype" id="2995555">byte</span><span class="op" id="2995559">,</span>&nbsp;<span class="ident" id="2995561">shortest</span>&nbsp;<span class="builtintype" id="2995570">bool</span><span class="op" id="2995574">,</span>&nbsp;<span class="ident" id="2995576">neg</span>&nbsp;<span class="builtintype" id="2995580">bool</span><span class="op" id="2995584">,</span>&nbsp;<span class="ident" id="2995586">digs</span>&nbsp;<span class="ident" id="2995591"><a href="/strconv/ftoa.go.html#2999738">decimalSlice</a></span><span class="op" id="2995603">,</span>&nbsp;<span class="ident" id="2995605">prec</span>&nbsp;<span class="builtintype" id="2995610">int</span><span class="op" id="2995613">,</span>&nbsp;<span class="ident" id="2995615">fmt</span>&nbsp;<span class="builtintype" id="2995619">byte</span><span class="op" id="2995623">)</span>&nbsp;<span class="op" id="2995625">[</span><span class="op" id="2995626">]</span><span class="builtintype" id="2995627">byte</span>&nbsp;<span class="op" id="2995632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995635">switch</span>&nbsp;<span class="ident" id="2995642"><a href="/strconv/ftoa.go.html#2995615">fmt</a></span>&nbsp;<span class="op" id="2995646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995649">case</span>&nbsp;<span class="string" id="2995654">&#39;e&#39;</span><span class="op" id="2995657">,</span>&nbsp;<span class="string" id="2995659">&#39;E&#39;</span><span class="op" id="2995662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995666">return</span>&nbsp;<span class="ident" id="2995673"><a href="/strconv/ftoa.go.html#2999829">fmtE</a></span><span class="op" id="2995677">(</span><span class="ident" id="2995678"><a href="/strconv/ftoa.go.html#2995549">dst</a></span><span class="op" id="2995681">,</span>&nbsp;<span class="ident" id="2995683"><a href="/strconv/ftoa.go.html#2995576">neg</a></span><span class="op" id="2995686">,</span>&nbsp;<span class="ident" id="2995688"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2995692">,</span>&nbsp;<span class="ident" id="2995694"><a href="/strconv/ftoa.go.html#2995605">prec</a></span><span class="op" id="2995698">,</span>&nbsp;<span class="ident" id="2995700"><a href="/strconv/ftoa.go.html#2995615">fmt</a></span><span class="op" id="2995703">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995706">case</span>&nbsp;<span class="string" id="2995711">&#39;f&#39;</span><span class="op" id="2995714">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995718">return</span>&nbsp;<span class="ident" id="2995725"><a href="/strconv/ftoa.go.html#3000829">fmtF</a></span><span class="op" id="2995729">(</span><span class="ident" id="2995730"><a href="/strconv/ftoa.go.html#2995549">dst</a></span><span class="op" id="2995733">,</span>&nbsp;<span class="ident" id="2995735"><a href="/strconv/ftoa.go.html#2995576">neg</a></span><span class="op" id="2995738">,</span>&nbsp;<span class="ident" id="2995740"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2995744">,</span>&nbsp;<span class="ident" id="2995746"><a href="/strconv/ftoa.go.html#2995605">prec</a></span><span class="op" id="2995750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995753">case</span>&nbsp;<span class="string" id="2995758">&#39;g&#39;</span><span class="op" id="2995761">,</span>&nbsp;<span class="string" id="2995763">&#39;G&#39;</span><span class="op" id="2995766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2995770">//&nbsp;trailing&nbsp;fractional&nbsp;zeros&nbsp;in&nbsp;&#39;e&#39;&nbsp;form&nbsp;will&nbsp;be&nbsp;trimmed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995830">eprec</span>&nbsp;<span class="op" id="2995836">:=</span>&nbsp;<span class="ident" id="2995839"><a href="/strconv/ftoa.go.html#2995605">prec</a></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995846">if</span>&nbsp;<span class="ident" id="2995849"><a href="/strconv/ftoa.go.html#2995830">eprec</a></span>&nbsp;<span class="op" id="2995855">&gt;</span>&nbsp;<span class="ident" id="2995857"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2995861">.</span><span class="ident" id="2995862">nd</span>&nbsp;<span class="op" id="2995865">&amp;&amp;</span>&nbsp;<span class="ident" id="2995868"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2995872">.</span><span class="ident" id="2995873">nd</span>&nbsp;<span class="op" id="2995876">&gt;=</span>&nbsp;<span class="ident" id="2995879"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2995883">.</span><span class="ident" id="2995884">dp</span>&nbsp;<span class="op" id="2995887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995892"><a href="/strconv/ftoa.go.html#2995830">eprec</a></span>&nbsp;<span class="op" id="2995898">=</span>&nbsp;<span class="ident" id="2995900"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2995904">.</span><span class="ident" id="2995905">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2995914">//&nbsp;%e&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;exponent&nbsp;from&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2995966">//&nbsp;is&nbsp;less&nbsp;than&nbsp;-4&nbsp;or&nbsp;greater&nbsp;than&nbsp;or&nbsp;equal&nbsp;to&nbsp;the&nbsp;precision.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2996030">//&nbsp;if&nbsp;precision&nbsp;was&nbsp;the&nbsp;shortest&nbsp;possible,&nbsp;use&nbsp;precision&nbsp;6&nbsp;for&nbsp;this&nbsp;decision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996110">if</span>&nbsp;<span class="ident" id="2996113"><a href="/strconv/ftoa.go.html#2995561">shortest</a></span>&nbsp;<span class="op" id="2996122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2996127"><a href="/strconv/ftoa.go.html#2995830">eprec</a></span>&nbsp;<span class="op" id="2996133">=</span>&nbsp;<span class="num" id="2996135">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2996139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2996143">exp</span>&nbsp;<span class="op" id="2996147">:=</span>&nbsp;<span class="ident" id="2996150"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2996154">.</span><span class="ident" id="2996155">dp</span>&nbsp;<span class="op" id="2996158">-</span>&nbsp;<span class="num" id="2996160">1</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996164">if</span>&nbsp;<span class="ident" id="2996167"><a href="/strconv/ftoa.go.html#2996143">exp</a></span>&nbsp;<span class="op" id="2996171">&lt;</span>&nbsp;<span class="op" id="2996173">-</span><span class="num" id="2996174">4</span>&nbsp;<span class="op" id="2996176">||</span>&nbsp;<span class="ident" id="2996179"><a href="/strconv/ftoa.go.html#2996143">exp</a></span>&nbsp;<span class="op" id="2996183">&gt;=</span>&nbsp;<span class="ident" id="2996186"><a href="/strconv/ftoa.go.html#2995830">eprec</a></span>&nbsp;<span class="op" id="2996192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996197">if</span>&nbsp;<span class="ident" id="2996200"><a href="/strconv/ftoa.go.html#2995605">prec</a></span>&nbsp;<span class="op" id="2996205">&gt;</span>&nbsp;<span class="ident" id="2996207"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2996211">.</span><span class="ident" id="2996212">nd</span>&nbsp;<span class="op" id="2996215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2996221"><a href="/strconv/ftoa.go.html#2995605">prec</a></span>&nbsp;<span class="op" id="2996226">=</span>&nbsp;<span class="ident" id="2996228"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2996232">.</span><span class="ident" id="2996233">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2996239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996244">return</span>&nbsp;<span class="ident" id="2996251"><a href="/strconv/ftoa.go.html#2999829">fmtE</a></span><span class="op" id="2996255">(</span><span class="ident" id="2996256"><a href="/strconv/ftoa.go.html#2995549">dst</a></span><span class="op" id="2996259">,</span>&nbsp;<span class="ident" id="2996261"><a href="/strconv/ftoa.go.html#2995576">neg</a></span><span class="op" id="2996264">,</span>&nbsp;<span class="ident" id="2996266"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2996270">,</span>&nbsp;<span class="ident" id="2996272"><a href="/strconv/ftoa.go.html#2995605">prec</a></span><span class="op" id="2996276">-</span><span class="num" id="2996277">1</span><span class="op" id="2996278">,</span>&nbsp;<span class="ident" id="2996280"><a href="/strconv/ftoa.go.html#2995615">fmt</a></span><span class="op" id="2996283">+</span><span class="string" id="2996284">&#39;e&#39;</span><span class="op" id="2996287">-</span><span class="string" id="2996288">&#39;g&#39;</span><span class="op" id="2996291">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2996295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996299">if</span>&nbsp;<span class="ident" id="2996302"><a href="/strconv/ftoa.go.html#2995605">prec</a></span>&nbsp;<span class="op" id="2996307">&gt;</span>&nbsp;<span class="ident" id="2996309"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2996313">.</span><span class="ident" id="2996314">dp</span>&nbsp;<span class="op" id="2996317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2996322"><a href="/strconv/ftoa.go.html#2995605">prec</a></span>&nbsp;<span class="op" id="2996327">=</span>&nbsp;<span class="ident" id="2996329"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2996333">.</span><span class="ident" id="2996334">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2996339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996343">return</span>&nbsp;<span class="ident" id="2996350"><a href="/strconv/ftoa.go.html#3000829">fmtF</a></span><span class="op" id="2996354">(</span><span class="ident" id="2996355"><a href="/strconv/ftoa.go.html#2995549">dst</a></span><span class="op" id="2996358">,</span>&nbsp;<span class="ident" id="2996360"><a href="/strconv/ftoa.go.html#2995576">neg</a></span><span class="op" id="2996363">,</span>&nbsp;<span class="ident" id="2996365"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2996369">,</span>&nbsp;<span class="ident" id="2996371"><a href="/strconv/ftoa.go.html#3001906">max</a></span><span class="op" id="2996374">(</span><span class="ident" id="2996375"><a href="/strconv/ftoa.go.html#2995605">prec</a></span><span class="op" id="2996379">-</span><span class="ident" id="2996380"><a href="/strconv/ftoa.go.html#2995586">digs</a></span><span class="op" id="2996384">.</span><span class="ident" id="2996385">dp</span><span class="op" id="2996387">,</span>&nbsp;<span class="num" id="2996389">0</span><span class="op" id="2996390">)</span><span class="op" id="2996391">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2996394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2996398">//&nbsp;unknown&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996417">return</span>&nbsp;<span class="builtinfunc" id="2996424">append</span><span class="op" id="2996430">(</span><span class="ident" id="2996431"><a href="/strconv/ftoa.go.html#2995549">dst</a></span><span class="op" id="2996434">,</span>&nbsp;<span class="string" id="2996436">&#39;%&#39;</span><span class="op" id="2996439">,</span>&nbsp;<span class="ident" id="2996441"><a href="/strconv/ftoa.go.html#2995615">fmt</a></span><span class="op" id="2996444">)</span><br>
<span class="lineno"></span><span class="op" id="2996446">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="2996449">//&nbsp;Round&nbsp;d&nbsp;(=&nbsp;mant&nbsp;*&nbsp;2^exp)&nbsp;to&nbsp;the&nbsp;shortest&nbsp;number&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2996510">//&nbsp;that&nbsp;will&nbsp;let&nbsp;the&nbsp;original&nbsp;floating&nbsp;point&nbsp;value&nbsp;be&nbsp;precisely</span><br>
<span class="lineno"></span><span class="comment" id="2996574">//&nbsp;reconstructed.&nbsp;&nbsp;Size&nbsp;is&nbsp;original&nbsp;floating&nbsp;point&nbsp;size&nbsp;(64&nbsp;or&nbsp;32).</span><br>
<span class="lineno"></span><span class="keyword" id="2996642">func</span>&nbsp;<span class="ident" id="2996647">roundShortest</span><span class="op" id="2996660">(</span><span class="ident" id="2996661">d</span>&nbsp;<span class="op" id="2996663">*</span><span class="ident" id="2996664"><a href="/strconv/decimal.go.html#2962789">decimal</a></span><span class="op" id="2996671">,</span>&nbsp;<span class="ident" id="2996673">mant</span>&nbsp;<span class="ident" id="2996678">uint64</span><span class="op" id="2996684">,</span>&nbsp;<span class="ident" id="2996686">exp</span>&nbsp;<span class="builtintype" id="2996690">int</span><span class="op" id="2996693">,</span>&nbsp;<span class="ident" id="2996695">flt</span>&nbsp;<span class="op" id="2996699">*</span><span class="ident" id="2996700"><a href="/strconv/ftoa.go.html#2991005">floatInfo</a></span><span class="op" id="2996709">)</span>&nbsp;<span class="op" id="2996711">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2996714">//&nbsp;If&nbsp;mantissa&nbsp;is&nbsp;zero,&nbsp;the&nbsp;number&nbsp;is&nbsp;zero;&nbsp;stop&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996769">if</span>&nbsp;<span class="ident" id="2996772"><a href="/strconv/ftoa.go.html#2996673">mant</a></span>&nbsp;<span class="op" id="2996777">==</span>&nbsp;<span class="num" id="2996780">0</span>&nbsp;<span class="op" id="2996782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2996786"><a href="/strconv/ftoa.go.html#2996661">d</a></span><span class="op" id="2996787">.</span><span class="ident" id="2996788">nd</span>&nbsp;<span class="op" id="2996791">=</span>&nbsp;<span class="num" id="2996793">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2996797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2996805">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2996809">//&nbsp;Compute&nbsp;upper&nbsp;and&nbsp;lower&nbsp;such&nbsp;that&nbsp;any&nbsp;decimal&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2996866">//&nbsp;between&nbsp;upper&nbsp;and&nbsp;lower&nbsp;(possibly&nbsp;inclusive)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2996915">//&nbsp;will&nbsp;round&nbsp;to&nbsp;the&nbsp;original&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2996970">//&nbsp;We&nbsp;may&nbsp;see&nbsp;at&nbsp;once&nbsp;that&nbsp;the&nbsp;number&nbsp;is&nbsp;already&nbsp;shortest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997030">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997034">//&nbsp;Suppose&nbsp;d&nbsp;is&nbsp;not&nbsp;denormal,&nbsp;so&nbsp;that&nbsp;2^exp&nbsp;&lt;=&nbsp;d&nbsp;&lt;&nbsp;10^dp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997093">//&nbsp;The&nbsp;closest&nbsp;shorter&nbsp;number&nbsp;is&nbsp;at&nbsp;least&nbsp;10^(dp-nd)&nbsp;away.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997153">//&nbsp;The&nbsp;lower/upper&nbsp;bounds&nbsp;computed&nbsp;below&nbsp;are&nbsp;at&nbsp;distance</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997211">//&nbsp;at&nbsp;most&nbsp;2^(exp-mantbits).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997241">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997245">//&nbsp;So&nbsp;the&nbsp;number&nbsp;is&nbsp;already&nbsp;shortest&nbsp;if&nbsp;10^(dp-nd)&nbsp;&gt;&nbsp;2^(exp-mantbits),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997317">//&nbsp;or&nbsp;equivalently&nbsp;log2(10)*(dp-nd)&nbsp;&gt;&nbsp;exp-mantbits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997370">//&nbsp;It&nbsp;is&nbsp;true&nbsp;if&nbsp;332/100*(dp-nd)&nbsp;&gt;=&nbsp;exp-mantbits&nbsp;(log2(10)&nbsp;&gt;&nbsp;3.32).</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2997439">minexp</span>&nbsp;<span class="op" id="2997446">:=</span>&nbsp;<span class="ident" id="2997449"><a href="/strconv/ftoa.go.html#2996695">flt</a></span><span class="op" id="2997452">.</span><span class="ident" id="2997453">bias</span>&nbsp;<span class="op" id="2997458">+</span>&nbsp;<span class="num" id="2997460">1</span>&nbsp;<span class="comment" id="2997462">//&nbsp;minimum&nbsp;possible&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2997492">if</span>&nbsp;<span class="ident" id="2997495"><a href="/strconv/ftoa.go.html#2996686">exp</a></span>&nbsp;<span class="op" id="2997499">&gt;</span>&nbsp;<span class="ident" id="2997501"><a href="/strconv/ftoa.go.html#2997439">minexp</a></span>&nbsp;<span class="op" id="2997508">&amp;&amp;</span>&nbsp;<span class="num" id="2997511">332</span><span class="op" id="2997514">*</span><span class="op" id="2997515">(</span><span class="ident" id="2997516"><a href="/strconv/ftoa.go.html#2996661">d</a></span><span class="op" id="2997517">.</span><span class="ident" id="2997518">dp</span><span class="op" id="2997520">-</span><span class="ident" id="2997521"><a href="/strconv/ftoa.go.html#2996661">d</a></span><span class="op" id="2997522">.</span><span class="ident" id="2997523">nd</span><span class="op" id="2997525">)</span>&nbsp;<span class="op" id="2997527">&gt;=</span>&nbsp;<span class="num" id="2997530">100</span><span class="op" id="2997533">*</span><span class="op" id="2997534">(</span><span class="ident" id="2997535"><a href="/strconv/ftoa.go.html#2996686">exp</a></span><span class="op" id="2997538">-</span><span class="builtintype" id="2997539">int</span><span class="op" id="2997542">(</span><span class="ident" id="2997543"><a href="/strconv/ftoa.go.html#2996695">flt</a></span><span class="op" id="2997546">.</span><span class="ident" id="2997547">mantbits</span><span class="op" id="2997555">)</span><span class="op" id="2997556">)</span>&nbsp;<span class="op" id="2997558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997562">//&nbsp;The&nbsp;number&nbsp;is&nbsp;already&nbsp;shortest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2997599">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2997607">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997611">//&nbsp;d&nbsp;=&nbsp;mant&nbsp;&lt;&lt;&nbsp;(exp&nbsp;-&nbsp;mantbits)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997644">//&nbsp;Next&nbsp;highest&nbsp;floating&nbsp;point&nbsp;number&nbsp;is&nbsp;mant+1&nbsp;&lt;&lt;&nbsp;exp-mantbits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997710">//&nbsp;Our&nbsp;upper&nbsp;bound&nbsp;is&nbsp;halfway&nbsp;between,&nbsp;mant*2+1&nbsp;&lt;&lt;&nbsp;exp-mantbits-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2997778">upper</span>&nbsp;<span class="op" id="2997784">:=</span>&nbsp;<span class="builtinfunc" id="2997787">new</span><span class="op" id="2997790">(</span><span class="ident" id="2997791"><a href="/strconv/decimal.go.html#2962789">decimal</a></span><span class="op" id="2997798">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2997801"><a href="/strconv/ftoa.go.html#2997778">upper</a></span><span class="op" id="2997806">.</span><span class="ident" id="2997807">Assign</span><span class="op" id="2997813">(</span><span class="ident" id="2997814"><a href="/strconv/ftoa.go.html#2996673">mant</a></span><span class="op" id="2997818">*</span><span class="num" id="2997819">2</span>&nbsp;<span class="op" id="2997821">+</span>&nbsp;<span class="num" id="2997823">1</span><span class="op" id="2997824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2997827"><a href="/strconv/ftoa.go.html#2997778">upper</a></span><span class="op" id="2997832">.</span><span class="ident" id="2997833">Shift</span><span class="op" id="2997838">(</span><span class="ident" id="2997839"><a href="/strconv/ftoa.go.html#2996686">exp</a></span>&nbsp;<span class="op" id="2997843">-</span>&nbsp;<span class="builtintype" id="2997845">int</span><span class="op" id="2997848">(</span><span class="ident" id="2997849"><a href="/strconv/ftoa.go.html#2996695">flt</a></span><span class="op" id="2997852">.</span><span class="ident" id="2997853">mantbits</span><span class="op" id="2997861">)</span>&nbsp;<span class="op" id="2997863">-</span>&nbsp;<span class="num" id="2997865">1</span><span class="op" id="2997866">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997870">//&nbsp;d&nbsp;=&nbsp;mant&nbsp;&lt;&lt;&nbsp;(exp&nbsp;-&nbsp;mantbits)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997903">//&nbsp;Next&nbsp;lowest&nbsp;floating&nbsp;point&nbsp;number&nbsp;is&nbsp;mant-1&nbsp;&lt;&lt;&nbsp;exp-mantbits,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2997968">//&nbsp;unless&nbsp;mant-1&nbsp;drops&nbsp;the&nbsp;significant&nbsp;bit&nbsp;and&nbsp;exp&nbsp;is&nbsp;not&nbsp;the&nbsp;minimum&nbsp;exp,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2998044">//&nbsp;in&nbsp;which&nbsp;case&nbsp;the&nbsp;next&nbsp;lowest&nbsp;is&nbsp;mant*2-1&nbsp;&lt;&lt;&nbsp;exp-mantbits-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2998109">//&nbsp;Either&nbsp;way,&nbsp;call&nbsp;it&nbsp;mantlo&nbsp;&lt;&lt;&nbsp;explo-mantbits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2998159">//&nbsp;Our&nbsp;lower&nbsp;bound&nbsp;is&nbsp;halfway&nbsp;between,&nbsp;mantlo*2+1&nbsp;&lt;&lt;&nbsp;explo-mantbits-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2998231">var</span>&nbsp;<span class="ident" id="2998235">mantlo</span>&nbsp;<span class="ident" id="2998242">uint64</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2998250">var</span>&nbsp;<span class="ident" id="2998254">explo</span>&nbsp;<span class="builtintype" id="2998260">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2998265">if</span>&nbsp;<span class="ident" id="2998268"><a href="/strconv/ftoa.go.html#2996673">mant</a></span>&nbsp;<span class="op" id="2998273">&gt;</span>&nbsp;<span class="num" id="2998275">1</span><span class="op" id="2998276">&lt;&lt;</span><span class="ident" id="2998278"><a href="/strconv/ftoa.go.html#2996695">flt</a></span><span class="op" id="2998281">.</span><span class="ident" id="2998282">mantbits</span>&nbsp;<span class="op" id="2998291">||</span>&nbsp;<span class="ident" id="2998294"><a href="/strconv/ftoa.go.html#2996686">exp</a></span>&nbsp;<span class="op" id="2998298">==</span>&nbsp;<span class="ident" id="2998301"><a href="/strconv/ftoa.go.html#2997439">minexp</a></span>&nbsp;<span class="op" id="2998308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998312"><a href="/strconv/ftoa.go.html#2998235">mantlo</a></span>&nbsp;<span class="op" id="2998319">=</span>&nbsp;<span class="ident" id="2998321"><a href="/strconv/ftoa.go.html#2996673">mant</a></span>&nbsp;<span class="op" id="2998326">-</span>&nbsp;<span class="num" id="2998328">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998332"><a href="/strconv/ftoa.go.html#2998254">explo</a></span>&nbsp;<span class="op" id="2998338">=</span>&nbsp;<span class="ident" id="2998340"><a href="/strconv/ftoa.go.html#2996686">exp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2998345">}</span>&nbsp;<span class="keyword" id="2998347">else</span>&nbsp;<span class="op" id="2998352">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998356"><a href="/strconv/ftoa.go.html#2998235">mantlo</a></span>&nbsp;<span class="op" id="2998363">=</span>&nbsp;<span class="ident" id="2998365"><a href="/strconv/ftoa.go.html#2996673">mant</a></span><span class="op" id="2998369">*</span><span class="num" id="2998370">2</span>&nbsp;<span class="op" id="2998372">-</span>&nbsp;<span class="num" id="2998374">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998378"><a href="/strconv/ftoa.go.html#2998254">explo</a></span>&nbsp;<span class="op" id="2998384">=</span>&nbsp;<span class="ident" id="2998386"><a href="/strconv/ftoa.go.html#2996686">exp</a></span>&nbsp;<span class="op" id="2998390">-</span>&nbsp;<span class="num" id="2998392">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2998395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998398">lower</span>&nbsp;<span class="op" id="2998404">:=</span>&nbsp;<span class="builtinfunc" id="2998407">new</span><span class="op" id="2998410">(</span><span class="ident" id="2998411"><a href="/strconv/decimal.go.html#2962789">decimal</a></span><span class="op" id="2998418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998421"><a href="/strconv/ftoa.go.html#2998398">lower</a></span><span class="op" id="2998426">.</span><span class="ident" id="2998427">Assign</span><span class="op" id="2998433">(</span><span class="ident" id="2998434"><a href="/strconv/ftoa.go.html#2998235">mantlo</a></span><span class="op" id="2998440">*</span><span class="num" id="2998441">2</span>&nbsp;<span class="op" id="2998443">+</span>&nbsp;<span class="num" id="2998445">1</span><span class="op" id="2998446">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998449"><a href="/strconv/ftoa.go.html#2998398">lower</a></span><span class="op" id="2998454">.</span><span class="ident" id="2998455">Shift</span><span class="op" id="2998460">(</span><span class="ident" id="2998461"><a href="/strconv/ftoa.go.html#2998254">explo</a></span>&nbsp;<span class="op" id="2998467">-</span>&nbsp;<span class="builtintype" id="2998469">int</span><span class="op" id="2998472">(</span><span class="ident" id="2998473"><a href="/strconv/ftoa.go.html#2996695">flt</a></span><span class="op" id="2998476">.</span><span class="ident" id="2998477">mantbits</span><span class="op" id="2998485">)</span>&nbsp;<span class="op" id="2998487">-</span>&nbsp;<span class="num" id="2998489">1</span><span class="op" id="2998490">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2998494">//&nbsp;The&nbsp;upper&nbsp;and&nbsp;lower&nbsp;bounds&nbsp;are&nbsp;possible&nbsp;outputs&nbsp;only&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2998554">//&nbsp;the&nbsp;original&nbsp;mantissa&nbsp;is&nbsp;even,&nbsp;so&nbsp;that&nbsp;IEEE&nbsp;round-to-even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2998616">//&nbsp;would&nbsp;round&nbsp;to&nbsp;the&nbsp;original&nbsp;mantissa&nbsp;and&nbsp;not&nbsp;the&nbsp;neighbors.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998680">inclusive</span>&nbsp;<span class="op" id="2998690">:=</span>&nbsp;<span class="ident" id="2998693"><a href="/strconv/ftoa.go.html#2996673">mant</a></span><span class="op" id="2998697">%</span><span class="num" id="2998698">2</span>&nbsp;<span class="op" id="2998700">==</span>&nbsp;<span class="num" id="2998703">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2998707">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;figure&nbsp;out&nbsp;the&nbsp;minimum&nbsp;number&nbsp;of&nbsp;digits&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2998772">//&nbsp;Walk&nbsp;along&nbsp;until&nbsp;d&nbsp;has&nbsp;distinguished&nbsp;itself&nbsp;from&nbsp;upper&nbsp;and&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2998842">for</span>&nbsp;<span class="ident" id="2998846">i</span>&nbsp;<span class="op" id="2998848">:=</span>&nbsp;<span class="num" id="2998851">0</span><span class="op" id="2998852">;</span>&nbsp;<span class="ident" id="2998854"><a href="/strconv/ftoa.go.html#2998846">i</a></span>&nbsp;<span class="op" id="2998856">&lt;</span>&nbsp;<span class="ident" id="2998858"><a href="/strconv/ftoa.go.html#2996661">d</a></span><span class="op" id="2998859">.</span><span class="ident" id="2998860">nd</span><span class="op" id="2998862">;</span>&nbsp;<span class="ident" id="2998864"><a href="/strconv/ftoa.go.html#2998846">i</a></span><span class="op" id="2998865">++</span>&nbsp;<span class="op" id="2998868">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2998872">var</span>&nbsp;<span class="ident" id="2998876">l</span><span class="op" id="2998877">,</span>&nbsp;<span class="ident" id="2998879">m</span><span class="op" id="2998880">,</span>&nbsp;<span class="ident" id="2998882">u</span>&nbsp;<span class="builtintype" id="2998884">byte</span>&nbsp;<span class="comment" id="2998889">//&nbsp;lower,&nbsp;middle,&nbsp;upper&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2998922">if</span>&nbsp;<span class="ident" id="2998925"><a href="/strconv/ftoa.go.html#2998846">i</a></span>&nbsp;<span class="op" id="2998927">&lt;</span>&nbsp;<span class="ident" id="2998929"><a href="/strconv/ftoa.go.html#2998398">lower</a></span><span class="op" id="2998934">.</span><span class="ident" id="2998935">nd</span>&nbsp;<span class="op" id="2998938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998943"><a href="/strconv/ftoa.go.html#2998876">l</a></span>&nbsp;<span class="op" id="2998945">=</span>&nbsp;<span class="ident" id="2998947"><a href="/strconv/ftoa.go.html#2998398">lower</a></span><span class="op" id="2998952">.</span><span class="ident" id="2998953">d</span><span class="op" id="2998954">[</span><span class="ident" id="2998955"><a href="/strconv/ftoa.go.html#2998846">i</a></span><span class="op" id="2998956">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2998960">}</span>&nbsp;<span class="keyword" id="2998962">else</span>&nbsp;<span class="op" id="2998967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998972"><a href="/strconv/ftoa.go.html#2998876">l</a></span>&nbsp;<span class="op" id="2998974">=</span>&nbsp;<span class="string" id="2998976">&#39;0&#39;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2998982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2998986"><a href="/strconv/ftoa.go.html#2998879">m</a></span>&nbsp;<span class="op" id="2998988">=</span>&nbsp;<span class="ident" id="2998990"><a href="/strconv/ftoa.go.html#2996661">d</a></span><span class="op" id="2998991">.</span><span class="ident" id="2998992">d</span><span class="op" id="2998993">[</span><span class="ident" id="2998994"><a href="/strconv/ftoa.go.html#2998846">i</a></span><span class="op" id="2998995">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2998999">if</span>&nbsp;<span class="ident" id="2999002"><a href="/strconv/ftoa.go.html#2998846">i</a></span>&nbsp;<span class="op" id="2999004">&lt;</span>&nbsp;<span class="ident" id="2999006"><a href="/strconv/ftoa.go.html#2997778">upper</a></span><span class="op" id="2999011">.</span><span class="ident" id="2999012">nd</span>&nbsp;<span class="op" id="2999015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999020"><a href="/strconv/ftoa.go.html#2998882">u</a></span>&nbsp;<span class="op" id="2999022">=</span>&nbsp;<span class="ident" id="2999024"><a href="/strconv/ftoa.go.html#2997778">upper</a></span><span class="op" id="2999029">.</span><span class="ident" id="2999030">d</span><span class="op" id="2999031">[</span><span class="ident" id="2999032"><a href="/strconv/ftoa.go.html#2998846">i</a></span><span class="op" id="2999033">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2999037">}</span>&nbsp;<span class="keyword" id="2999039">else</span>&nbsp;<span class="op" id="2999044">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999049"><a href="/strconv/ftoa.go.html#2998882">u</a></span>&nbsp;<span class="op" id="2999051">=</span>&nbsp;<span class="string" id="2999053">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2999059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2999064">//&nbsp;Okay&nbsp;to&nbsp;round&nbsp;down&nbsp;(truncate)&nbsp;if&nbsp;lower&nbsp;has&nbsp;a&nbsp;different&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2999130">//&nbsp;or&nbsp;if&nbsp;lower&nbsp;is&nbsp;inclusive&nbsp;and&nbsp;is&nbsp;exactly&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;down.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999204">okdown</span>&nbsp;<span class="op" id="2999211">:=</span>&nbsp;<span class="ident" id="2999214"><a href="/strconv/ftoa.go.html#2998876">l</a></span>&nbsp;<span class="op" id="2999216">!=</span>&nbsp;<span class="ident" id="2999219"><a href="/strconv/ftoa.go.html#2998879">m</a></span>&nbsp;<span class="op" id="2999221">||</span>&nbsp;<span class="op" id="2999224">(</span><span class="ident" id="2999225"><a href="/strconv/ftoa.go.html#2998680">inclusive</a></span>&nbsp;<span class="op" id="2999235">&amp;&amp;</span>&nbsp;<span class="ident" id="2999238"><a href="/strconv/ftoa.go.html#2998876">l</a></span>&nbsp;<span class="op" id="2999240">==</span>&nbsp;<span class="ident" id="2999243"><a href="/strconv/ftoa.go.html#2998879">m</a></span>&nbsp;<span class="op" id="2999245">&amp;&amp;</span>&nbsp;<span class="ident" id="2999248"><a href="/strconv/ftoa.go.html#2998846">i</a></span><span class="op" id="2999249">+</span><span class="num" id="2999250">1</span>&nbsp;<span class="op" id="2999252">==</span>&nbsp;<span class="ident" id="2999255"><a href="/strconv/ftoa.go.html#2998398">lower</a></span><span class="op" id="2999260">.</span><span class="ident" id="2999261">nd</span><span class="op" id="2999263">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2999268">//&nbsp;Okay&nbsp;to&nbsp;round&nbsp;up&nbsp;if&nbsp;upper&nbsp;has&nbsp;a&nbsp;different&nbsp;digit&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2999325">//&nbsp;either&nbsp;upper&nbsp;is&nbsp;inclusive&nbsp;or&nbsp;upper&nbsp;is&nbsp;bigger&nbsp;than&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999407">okup</span>&nbsp;<span class="op" id="2999412">:=</span>&nbsp;<span class="ident" id="2999415"><a href="/strconv/ftoa.go.html#2998879">m</a></span>&nbsp;<span class="op" id="2999417">!=</span>&nbsp;<span class="ident" id="2999420"><a href="/strconv/ftoa.go.html#2998882">u</a></span>&nbsp;<span class="op" id="2999422">&amp;&amp;</span>&nbsp;<span class="op" id="2999425">(</span><span class="ident" id="2999426"><a href="/strconv/ftoa.go.html#2998680">inclusive</a></span>&nbsp;<span class="op" id="2999436">||</span>&nbsp;<span class="ident" id="2999439"><a href="/strconv/ftoa.go.html#2998879">m</a></span><span class="op" id="2999440">+</span><span class="num" id="2999441">1</span>&nbsp;<span class="op" id="2999443">&lt;</span>&nbsp;<span class="ident" id="2999445"><a href="/strconv/ftoa.go.html#2998882">u</a></span>&nbsp;<span class="op" id="2999447">||</span>&nbsp;<span class="ident" id="2999450"><a href="/strconv/ftoa.go.html#2998846">i</a></span><span class="op" id="2999451">+</span><span class="num" id="2999452">1</span>&nbsp;<span class="op" id="2999454">&lt;</span>&nbsp;<span class="ident" id="2999456"><a href="/strconv/ftoa.go.html#2997778">upper</a></span><span class="op" id="2999461">.</span><span class="ident" id="2999462">nd</span><span class="op" id="2999464">)</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2999469">//&nbsp;If&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;do&nbsp;either,&nbsp;then&nbsp;round&nbsp;to&nbsp;the&nbsp;nearest&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2999532">//&nbsp;If&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;do&nbsp;only&nbsp;one,&nbsp;do&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999573">switch</span>&nbsp;<span class="op" id="2999580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999584">case</span>&nbsp;<span class="ident" id="2999589"><a href="/strconv/ftoa.go.html#2999204">okdown</a></span>&nbsp;<span class="op" id="2999596">&amp;&amp;</span>&nbsp;<span class="ident" id="2999599"><a href="/strconv/ftoa.go.html#2999407">okup</a></span><span class="op" id="2999603">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999608"><a href="/strconv/ftoa.go.html#2996661">d</a></span><span class="op" id="2999609">.</span><span class="ident" id="2999610">Round</span><span class="op" id="2999615">(</span><span class="ident" id="2999616"><a href="/strconv/ftoa.go.html#2998846">i</a></span>&nbsp;<span class="op" id="2999618">+</span>&nbsp;<span class="num" id="2999620">1</span><span class="op" id="2999621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999626">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999635">case</span>&nbsp;<span class="ident" id="2999640"><a href="/strconv/ftoa.go.html#2999204">okdown</a></span><span class="op" id="2999646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999651"><a href="/strconv/ftoa.go.html#2996661">d</a></span><span class="op" id="2999652">.</span><span class="ident" id="2999653">RoundDown</span><span class="op" id="2999662">(</span><span class="ident" id="2999663"><a href="/strconv/ftoa.go.html#2998846">i</a></span>&nbsp;<span class="op" id="2999665">+</span>&nbsp;<span class="num" id="2999667">1</span><span class="op" id="2999668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999673">return</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999682">case</span>&nbsp;<span class="ident" id="2999687"><a href="/strconv/ftoa.go.html#2999407">okup</a></span><span class="op" id="2999691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999696"><a href="/strconv/ftoa.go.html#2996661">d</a></span><span class="op" id="2999697">.</span><span class="ident" id="2999698">RoundUp</span><span class="op" id="2999705">(</span><span class="ident" id="2999706"><a href="/strconv/ftoa.go.html#2998846">i</a></span>&nbsp;<span class="op" id="2999708">+</span>&nbsp;<span class="num" id="2999710">1</span><span class="op" id="2999711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999716">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2999725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2999728">}</span><br>
<span class="lineno">325</span><span class="op" id="2999730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2999733">type</span>&nbsp;<span class="ident" id="2999738">decimalSlice</span>&nbsp;<span class="keyword" id="2999751">struct</span>&nbsp;<span class="op" id="2999758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999761">d</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2999768">[</span><span class="op" id="2999769">]</span><span class="builtintype" id="2999770">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999776">nd</span><span class="op" id="2999778">,</span>&nbsp;<span class="ident" id="2999780">dp</span>&nbsp;<span class="builtintype" id="2999783">int</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999788">neg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2999795">bool</span><br>
<span class="lineno"></span><span class="op" id="2999800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2999803">//&nbsp;%e:&nbsp;-d.ddddde±dd</span><br>
<span class="lineno"></span><span class="keyword" id="2999824">func</span>&nbsp;<span class="ident" id="2999829">fmtE</span><span class="op" id="2999833">(</span><span class="ident" id="2999834">dst</span>&nbsp;<span class="op" id="2999838">[</span><span class="op" id="2999839">]</span><span class="builtintype" id="2999840">byte</span><span class="op" id="2999844">,</span>&nbsp;<span class="ident" id="2999846">neg</span>&nbsp;<span class="builtintype" id="2999850">bool</span><span class="op" id="2999854">,</span>&nbsp;<span class="ident" id="2999856">d</span>&nbsp;<span class="ident" id="2999858"><a href="/strconv/ftoa.go.html#2999738">decimalSlice</a></span><span class="op" id="2999870">,</span>&nbsp;<span class="ident" id="2999872">prec</span>&nbsp;<span class="builtintype" id="2999877">int</span><span class="op" id="2999880">,</span>&nbsp;<span class="ident" id="2999882">fmt</span>&nbsp;<span class="builtintype" id="2999886">byte</span><span class="op" id="2999890">)</span>&nbsp;<span class="op" id="2999892">[</span><span class="op" id="2999893">]</span><span class="builtintype" id="2999894">byte</span>&nbsp;<span class="op" id="2999899">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2999902">//&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999911">if</span>&nbsp;<span class="ident" id="2999914"><a href="/strconv/ftoa.go.html#2999846">neg</a></span>&nbsp;<span class="op" id="2999918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999922"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="2999926">=</span>&nbsp;<span class="builtinfunc" id="2999928">append</span><span class="op" id="2999934">(</span><span class="ident" id="2999935"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="2999938">,</span>&nbsp;<span class="string" id="2999940">&#39;-&#39;</span><span class="op" id="2999943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2999946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2999950">//&nbsp;first&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2999966">ch</span>&nbsp;<span class="op" id="2999969">:=</span>&nbsp;<span class="builtintype" id="2999972">byte</span><span class="op" id="2999976">(</span><span class="string" id="2999977">&#39;0&#39;</span><span class="op" id="2999980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2999983">if</span>&nbsp;<span class="ident" id="2999986"><a href="/strconv/ftoa.go.html#2999856">d</a></span><span class="op" id="2999987">.</span><span class="ident" id="2999988">nd</span>&nbsp;<span class="op" id="2999991">!=</span>&nbsp;<span class="num" id="2999994">0</span>&nbsp;<span class="op" id="2999996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000000"><a href="/strconv/ftoa.go.html#2999966">ch</a></span>&nbsp;<span class="op" id="3000003">=</span>&nbsp;<span class="ident" id="3000005"><a href="/strconv/ftoa.go.html#2999856">d</a></span><span class="op" id="3000006">.</span><span class="ident" id="3000007">d</span><span class="op" id="3000008">[</span><span class="num" id="3000009">0</span><span class="op" id="3000010">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000013">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000016"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000020">=</span>&nbsp;<span class="builtinfunc" id="3000022">append</span><span class="op" id="3000028">(</span><span class="ident" id="3000029"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000032">,</span>&nbsp;<span class="ident" id="3000034"><a href="/strconv/ftoa.go.html#2999966">ch</a></span><span class="op" id="3000036">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3000040">//&nbsp;.moredigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000056">if</span>&nbsp;<span class="ident" id="3000059"><a href="/strconv/ftoa.go.html#2999872">prec</a></span>&nbsp;<span class="op" id="3000064">&gt;</span>&nbsp;<span class="num" id="3000066">0</span>&nbsp;<span class="op" id="3000068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000072"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000076">=</span>&nbsp;<span class="builtinfunc" id="3000078">append</span><span class="op" id="3000084">(</span><span class="ident" id="3000085"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000088">,</span>&nbsp;<span class="string" id="3000090">&#39;.&#39;</span><span class="op" id="3000093">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000097">i</span>&nbsp;<span class="op" id="3000099">:=</span>&nbsp;<span class="num" id="3000102">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000106">m</span>&nbsp;<span class="op" id="3000108">:=</span>&nbsp;<span class="ident" id="3000111"><a href="/strconv/ftoa.go.html#2999856">d</a></span><span class="op" id="3000112">.</span><span class="ident" id="3000113">nd</span>&nbsp;<span class="op" id="3000116">+</span>&nbsp;<span class="ident" id="3000118"><a href="/strconv/ftoa.go.html#2999872">prec</a></span>&nbsp;<span class="op" id="3000123">+</span>&nbsp;<span class="num" id="3000125">1</span>&nbsp;<span class="op" id="3000127">-</span>&nbsp;<span class="ident" id="3000129"><a href="/strconv/ftoa.go.html#3001906">max</a></span><span class="op" id="3000132">(</span><span class="ident" id="3000133"><a href="/strconv/ftoa.go.html#2999856">d</a></span><span class="op" id="3000134">.</span><span class="ident" id="3000135">nd</span><span class="op" id="3000137">,</span>&nbsp;<span class="ident" id="3000139"><a href="/strconv/ftoa.go.html#2999872">prec</a></span><span class="op" id="3000143">+</span><span class="num" id="3000144">1</span><span class="op" id="3000145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000149">for</span>&nbsp;<span class="ident" id="3000153"><a href="/strconv/ftoa.go.html#3000097">i</a></span>&nbsp;<span class="op" id="3000155">&lt;</span>&nbsp;<span class="ident" id="3000157"><a href="/strconv/ftoa.go.html#3000106">m</a></span>&nbsp;<span class="op" id="3000159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000164"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000168">=</span>&nbsp;<span class="builtinfunc" id="3000170">append</span><span class="op" id="3000176">(</span><span class="ident" id="3000177"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000180">,</span>&nbsp;<span class="ident" id="3000182"><a href="/strconv/ftoa.go.html#2999856">d</a></span><span class="op" id="3000183">.</span><span class="ident" id="3000184">d</span><span class="op" id="3000185">[</span><span class="ident" id="3000186"><a href="/strconv/ftoa.go.html#3000097">i</a></span><span class="op" id="3000187">]</span><span class="op" id="3000188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000193"><a href="/strconv/ftoa.go.html#3000097">i</a></span><span class="op" id="3000194">++</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000203">for</span>&nbsp;<span class="ident" id="3000207"><a href="/strconv/ftoa.go.html#3000097">i</a></span>&nbsp;<span class="op" id="3000209">&lt;=</span>&nbsp;<span class="ident" id="3000212"><a href="/strconv/ftoa.go.html#2999872">prec</a></span>&nbsp;<span class="op" id="3000217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000222"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000226">=</span>&nbsp;<span class="builtinfunc" id="3000228">append</span><span class="op" id="3000234">(</span><span class="ident" id="3000235"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000238">,</span>&nbsp;<span class="string" id="3000240">&#39;0&#39;</span><span class="op" id="3000243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000248"><a href="/strconv/ftoa.go.html#3000097">i</a></span><span class="op" id="3000249">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000254">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3000261">//&nbsp;e±</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000269"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000273">=</span>&nbsp;<span class="builtinfunc" id="3000275">append</span><span class="op" id="3000281">(</span><span class="ident" id="3000282"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000285">,</span>&nbsp;<span class="ident" id="3000287"><a href="/strconv/ftoa.go.html#2999882">fmt</a></span><span class="op" id="3000290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000293">exp</span>&nbsp;<span class="op" id="3000297">:=</span>&nbsp;<span class="ident" id="3000300"><a href="/strconv/ftoa.go.html#2999856">d</a></span><span class="op" id="3000301">.</span><span class="ident" id="3000302">dp</span>&nbsp;<span class="op" id="3000305">-</span>&nbsp;<span class="num" id="3000307">1</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000310">if</span>&nbsp;<span class="ident" id="3000313"><a href="/strconv/ftoa.go.html#2999856">d</a></span><span class="op" id="3000314">.</span><span class="ident" id="3000315">nd</span>&nbsp;<span class="op" id="3000318">==</span>&nbsp;<span class="num" id="3000321">0</span>&nbsp;<span class="op" id="3000323">{</span>&nbsp;<span class="comment" id="3000325">//&nbsp;special&nbsp;case:&nbsp;0&nbsp;has&nbsp;exponent&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000361"><a href="/strconv/ftoa.go.html#3000293">exp</a></span>&nbsp;<span class="op" id="3000365">=</span>&nbsp;<span class="num" id="3000367">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000373">if</span>&nbsp;<span class="ident" id="3000376"><a href="/strconv/ftoa.go.html#3000293">exp</a></span>&nbsp;<span class="op" id="3000380">&lt;</span>&nbsp;<span class="num" id="3000382">0</span>&nbsp;<span class="op" id="3000384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000388"><a href="/strconv/ftoa.go.html#2999966">ch</a></span>&nbsp;<span class="op" id="3000391">=</span>&nbsp;<span class="string" id="3000393">&#39;-&#39;</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000399"><a href="/strconv/ftoa.go.html#3000293">exp</a></span>&nbsp;<span class="op" id="3000403">=</span>&nbsp;<span class="op" id="3000405">-</span><span class="ident" id="3000406"><a href="/strconv/ftoa.go.html#3000293">exp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000411">}</span>&nbsp;<span class="keyword" id="3000413">else</span>&nbsp;<span class="op" id="3000418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000422"><a href="/strconv/ftoa.go.html#2999966">ch</a></span>&nbsp;<span class="op" id="3000425">=</span>&nbsp;<span class="string" id="3000427">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000435"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000439">=</span>&nbsp;<span class="builtinfunc" id="3000441">append</span><span class="op" id="3000447">(</span><span class="ident" id="3000448"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000451">,</span>&nbsp;<span class="ident" id="3000453"><a href="/strconv/ftoa.go.html#2999966">ch</a></span><span class="op" id="3000455">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3000459">//&nbsp;dddd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000468">var</span>&nbsp;<span class="ident" id="3000472">buf</span>&nbsp;<span class="op" id="3000476">[</span><span class="num" id="3000477">3</span><span class="op" id="3000478">]</span><span class="builtintype" id="3000479">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000485">i</span>&nbsp;<span class="op" id="3000487">:=</span>&nbsp;<span class="builtinfunc" id="3000490">len</span><span class="op" id="3000493">(</span><span class="ident" id="3000494"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000500">for</span>&nbsp;<span class="ident" id="3000504"><a href="/strconv/ftoa.go.html#3000293">exp</a></span>&nbsp;<span class="op" id="3000508">&gt;=</span>&nbsp;<span class="num" id="3000511">10</span>&nbsp;<span class="op" id="3000514">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000518"><a href="/strconv/ftoa.go.html#3000485">i</a></span><span class="op" id="3000519">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000524"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000527">[</span><span class="ident" id="3000528"><a href="/strconv/ftoa.go.html#3000485">i</a></span><span class="op" id="3000529">]</span>&nbsp;<span class="op" id="3000531">=</span>&nbsp;<span class="builtintype" id="3000533">byte</span><span class="op" id="3000537">(</span><span class="ident" id="3000538"><a href="/strconv/ftoa.go.html#3000293">exp</a></span><span class="op" id="3000541">%</span><span class="num" id="3000542">10</span>&nbsp;<span class="op" id="3000545">+</span>&nbsp;<span class="string" id="3000547">&#39;0&#39;</span><span class="op" id="3000550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000554"><a href="/strconv/ftoa.go.html#3000293">exp</a></span>&nbsp;<span class="op" id="3000558">/=</span>&nbsp;<span class="num" id="3000561">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3000568">//&nbsp;exp&nbsp;&lt;&nbsp;10</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000581"><a href="/strconv/ftoa.go.html#3000485">i</a></span><span class="op" id="3000582">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000586"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000589">[</span><span class="ident" id="3000590"><a href="/strconv/ftoa.go.html#3000485">i</a></span><span class="op" id="3000591">]</span>&nbsp;<span class="op" id="3000593">=</span>&nbsp;<span class="builtintype" id="3000595">byte</span><span class="op" id="3000599">(</span><span class="ident" id="3000600"><a href="/strconv/ftoa.go.html#3000293">exp</a></span>&nbsp;<span class="op" id="3000604">+</span>&nbsp;<span class="string" id="3000606">&#39;0&#39;</span><span class="op" id="3000609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000613">switch</span>&nbsp;<span class="ident" id="3000620"><a href="/strconv/ftoa.go.html#3000485">i</a></span>&nbsp;<span class="op" id="3000622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000625">case</span>&nbsp;<span class="num" id="3000630">0</span><span class="op" id="3000631">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000635"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000639">=</span>&nbsp;<span class="builtinfunc" id="3000641">append</span><span class="op" id="3000647">(</span><span class="ident" id="3000648"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000651">,</span>&nbsp;<span class="ident" id="3000653"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000656">[</span><span class="num" id="3000657">0</span><span class="op" id="3000658">]</span><span class="op" id="3000659">,</span>&nbsp;<span class="ident" id="3000661"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000664">[</span><span class="num" id="3000665">1</span><span class="op" id="3000666">]</span><span class="op" id="3000667">,</span>&nbsp;<span class="ident" id="3000669"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000672">[</span><span class="num" id="3000673">2</span><span class="op" id="3000674">]</span><span class="op" id="3000675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000678">case</span>&nbsp;<span class="num" id="3000683">1</span><span class="op" id="3000684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000688"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000692">=</span>&nbsp;<span class="builtinfunc" id="3000694">append</span><span class="op" id="3000700">(</span><span class="ident" id="3000701"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000704">,</span>&nbsp;<span class="ident" id="3000706"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000709">[</span><span class="num" id="3000710">1</span><span class="op" id="3000711">]</span><span class="op" id="3000712">,</span>&nbsp;<span class="ident" id="3000714"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000717">[</span><span class="num" id="3000718">2</span><span class="op" id="3000719">]</span><span class="op" id="3000720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000723">case</span>&nbsp;<span class="num" id="3000728">2</span><span class="op" id="3000729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3000733">//&nbsp;leading&nbsp;zeroes</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000753"><a href="/strconv/ftoa.go.html#2999834">dst</a></span>&nbsp;<span class="op" id="3000757">=</span>&nbsp;<span class="builtinfunc" id="3000759">append</span><span class="op" id="3000765">(</span><span class="ident" id="3000766"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><span class="op" id="3000769">,</span>&nbsp;<span class="string" id="3000771">&#39;0&#39;</span><span class="op" id="3000774">,</span>&nbsp;<span class="ident" id="3000776"><a href="/strconv/ftoa.go.html#3000472">buf</a></span><span class="op" id="3000779">[</span><span class="num" id="3000780">2</span><span class="op" id="3000781">]</span><span class="op" id="3000782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000788">return</span>&nbsp;<span class="ident" id="3000795"><a href="/strconv/ftoa.go.html#2999834">dst</a></span><br>
<span class="lineno"></span><span class="op" id="3000799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="3000802">//&nbsp;%f:&nbsp;-ddddddd.ddddd</span><br>
<span class="lineno"></span><span class="keyword" id="3000824">func</span>&nbsp;<span class="ident" id="3000829">fmtF</span><span class="op" id="3000833">(</span><span class="ident" id="3000834">dst</span>&nbsp;<span class="op" id="3000838">[</span><span class="op" id="3000839">]</span><span class="builtintype" id="3000840">byte</span><span class="op" id="3000844">,</span>&nbsp;<span class="ident" id="3000846">neg</span>&nbsp;<span class="builtintype" id="3000850">bool</span><span class="op" id="3000854">,</span>&nbsp;<span class="ident" id="3000856">d</span>&nbsp;<span class="ident" id="3000858"><a href="/strconv/ftoa.go.html#2999738">decimalSlice</a></span><span class="op" id="3000870">,</span>&nbsp;<span class="ident" id="3000872">prec</span>&nbsp;<span class="builtintype" id="3000877">int</span><span class="op" id="3000880">)</span>&nbsp;<span class="op" id="3000882">[</span><span class="op" id="3000883">]</span><span class="builtintype" id="3000884">byte</span>&nbsp;<span class="op" id="3000889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3000892">//&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000901">if</span>&nbsp;<span class="ident" id="3000904"><a href="/strconv/ftoa.go.html#3000846">neg</a></span>&nbsp;<span class="op" id="3000908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3000912"><a href="/strconv/ftoa.go.html#3000834">dst</a></span>&nbsp;<span class="op" id="3000916">=</span>&nbsp;<span class="builtinfunc" id="3000918">append</span><span class="op" id="3000924">(</span><span class="ident" id="3000925"><a href="/strconv/ftoa.go.html#3000834">dst</a></span><span class="op" id="3000928">,</span>&nbsp;<span class="string" id="3000930">&#39;-&#39;</span><span class="op" id="3000933">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3000936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3000940">//&nbsp;integer,&nbsp;padded&nbsp;with&nbsp;zeros&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000982">if</span>&nbsp;<span class="ident" id="3000985"><a href="/strconv/ftoa.go.html#3000856">d</a></span><span class="op" id="3000986">.</span><span class="ident" id="3000987">dp</span>&nbsp;<span class="op" id="3000990">&gt;</span>&nbsp;<span class="num" id="3000992">0</span>&nbsp;<span class="op" id="3000994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3000998">var</span>&nbsp;<span class="ident" id="3001002">i</span>&nbsp;<span class="builtintype" id="3001004">int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001010">for</span>&nbsp;<span class="ident" id="3001014"><a href="/strconv/ftoa.go.html#3001002">i</a></span>&nbsp;<span class="op" id="3001016">=</span>&nbsp;<span class="num" id="3001018">0</span><span class="op" id="3001019">;</span>&nbsp;<span class="ident" id="3001021"><a href="/strconv/ftoa.go.html#3001002">i</a></span>&nbsp;<span class="op" id="3001023">&lt;</span>&nbsp;<span class="ident" id="3001025"><a href="/strconv/ftoa.go.html#3000856">d</a></span><span class="op" id="3001026">.</span><span class="ident" id="3001027">dp</span>&nbsp;<span class="op" id="3001030">&amp;&amp;</span>&nbsp;<span class="ident" id="3001033"><a href="/strconv/ftoa.go.html#3001002">i</a></span>&nbsp;<span class="op" id="3001035">&lt;</span>&nbsp;<span class="ident" id="3001037"><a href="/strconv/ftoa.go.html#3000856">d</a></span><span class="op" id="3001038">.</span><span class="ident" id="3001039">nd</span><span class="op" id="3001041">;</span>&nbsp;<span class="ident" id="3001043"><a href="/strconv/ftoa.go.html#3001002">i</a></span><span class="op" id="3001044">++</span>&nbsp;<span class="op" id="3001047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001052"><a href="/strconv/ftoa.go.html#3000834">dst</a></span>&nbsp;<span class="op" id="3001056">=</span>&nbsp;<span class="builtinfunc" id="3001058">append</span><span class="op" id="3001064">(</span><span class="ident" id="3001065"><a href="/strconv/ftoa.go.html#3000834">dst</a></span><span class="op" id="3001068">,</span>&nbsp;<span class="ident" id="3001070"><a href="/strconv/ftoa.go.html#3000856">d</a></span><span class="op" id="3001071">.</span><span class="ident" id="3001072">d</span><span class="op" id="3001073">[</span><span class="ident" id="3001074"><a href="/strconv/ftoa.go.html#3001002">i</a></span><span class="op" id="3001075">]</span><span class="op" id="3001076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001084">for</span>&nbsp;<span class="op" id="3001088">;</span>&nbsp;<span class="ident" id="3001090"><a href="/strconv/ftoa.go.html#3001002">i</a></span>&nbsp;<span class="op" id="3001092">&lt;</span>&nbsp;<span class="ident" id="3001094"><a href="/strconv/ftoa.go.html#3000856">d</a></span><span class="op" id="3001095">.</span><span class="ident" id="3001096">dp</span><span class="op" id="3001098">;</span>&nbsp;<span class="ident" id="3001100"><a href="/strconv/ftoa.go.html#3001002">i</a></span><span class="op" id="3001101">++</span>&nbsp;<span class="op" id="3001104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001109"><a href="/strconv/ftoa.go.html#3000834">dst</a></span>&nbsp;<span class="op" id="3001113">=</span>&nbsp;<span class="builtinfunc" id="3001115">append</span><span class="op" id="3001121">(</span><span class="ident" id="3001122"><a href="/strconv/ftoa.go.html#3000834">dst</a></span><span class="op" id="3001125">,</span>&nbsp;<span class="string" id="3001127">&#39;0&#39;</span><span class="op" id="3001130">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001137">}</span>&nbsp;<span class="keyword" id="3001139">else</span>&nbsp;<span class="op" id="3001144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001148"><a href="/strconv/ftoa.go.html#3000834">dst</a></span>&nbsp;<span class="op" id="3001152">=</span>&nbsp;<span class="builtinfunc" id="3001154">append</span><span class="op" id="3001160">(</span><span class="ident" id="3001161"><a href="/strconv/ftoa.go.html#3000834">dst</a></span><span class="op" id="3001164">,</span>&nbsp;<span class="string" id="3001166">&#39;0&#39;</span><span class="op" id="3001169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3001176">//&nbsp;fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001189">if</span>&nbsp;<span class="ident" id="3001192"><a href="/strconv/ftoa.go.html#3000872">prec</a></span>&nbsp;<span class="op" id="3001197">&gt;</span>&nbsp;<span class="num" id="3001199">0</span>&nbsp;<span class="op" id="3001201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001205"><a href="/strconv/ftoa.go.html#3000834">dst</a></span>&nbsp;<span class="op" id="3001209">=</span>&nbsp;<span class="builtinfunc" id="3001211">append</span><span class="op" id="3001217">(</span><span class="ident" id="3001218"><a href="/strconv/ftoa.go.html#3000834">dst</a></span><span class="op" id="3001221">,</span>&nbsp;<span class="string" id="3001223">&#39;.&#39;</span><span class="op" id="3001226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001230">for</span>&nbsp;<span class="ident" id="3001234">i</span>&nbsp;<span class="op" id="3001236">:=</span>&nbsp;<span class="num" id="3001239">0</span><span class="op" id="3001240">;</span>&nbsp;<span class="ident" id="3001242"><a href="/strconv/ftoa.go.html#3001234">i</a></span>&nbsp;<span class="op" id="3001244">&lt;</span>&nbsp;<span class="ident" id="3001246"><a href="/strconv/ftoa.go.html#3000872">prec</a></span><span class="op" id="3001250">;</span>&nbsp;<span class="ident" id="3001252"><a href="/strconv/ftoa.go.html#3001234">i</a></span><span class="op" id="3001253">++</span>&nbsp;<span class="op" id="3001256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001261">ch</span>&nbsp;<span class="op" id="3001264">:=</span>&nbsp;<span class="builtintype" id="3001267">byte</span><span class="op" id="3001271">(</span><span class="string" id="3001272">&#39;0&#39;</span><span class="op" id="3001275">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001280">if</span>&nbsp;<span class="ident" id="3001283">j</span>&nbsp;<span class="op" id="3001285">:=</span>&nbsp;<span class="ident" id="3001288"><a href="/strconv/ftoa.go.html#3000856">d</a></span><span class="op" id="3001289">.</span><span class="ident" id="3001290">dp</span>&nbsp;<span class="op" id="3001293">+</span>&nbsp;<span class="ident" id="3001295"><a href="/strconv/ftoa.go.html#3001234">i</a></span><span class="op" id="3001296">;</span>&nbsp;<span class="num" id="3001298">0</span>&nbsp;<span class="op" id="3001300">&lt;=</span>&nbsp;<span class="ident" id="3001303"><a href="/strconv/ftoa.go.html#3001283">j</a></span>&nbsp;<span class="op" id="3001305">&amp;&amp;</span>&nbsp;<span class="ident" id="3001308"><a href="/strconv/ftoa.go.html#3001283">j</a></span>&nbsp;<span class="op" id="3001310">&lt;</span>&nbsp;<span class="ident" id="3001312"><a href="/strconv/ftoa.go.html#3000856">d</a></span><span class="op" id="3001313">.</span><span class="ident" id="3001314">nd</span>&nbsp;<span class="op" id="3001317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001323"><a href="/strconv/ftoa.go.html#3001261">ch</a></span>&nbsp;<span class="op" id="3001326">=</span>&nbsp;<span class="ident" id="3001328"><a href="/strconv/ftoa.go.html#3000856">d</a></span><span class="op" id="3001329">.</span><span class="ident" id="3001330">d</span><span class="op" id="3001331">[</span><span class="ident" id="3001332"><a href="/strconv/ftoa.go.html#3001283">j</a></span><span class="op" id="3001333">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001343"><a href="/strconv/ftoa.go.html#3000834">dst</a></span>&nbsp;<span class="op" id="3001347">=</span>&nbsp;<span class="builtinfunc" id="3001349">append</span><span class="op" id="3001355">(</span><span class="ident" id="3001356"><a href="/strconv/ftoa.go.html#3000834">dst</a></span><span class="op" id="3001359">,</span>&nbsp;<span class="ident" id="3001361"><a href="/strconv/ftoa.go.html#3001261">ch</a></span><span class="op" id="3001363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001367">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001374">return</span>&nbsp;<span class="ident" id="3001381"><a href="/strconv/ftoa.go.html#3000834">dst</a></span><br>
<span class="lineno"></span><span class="op" id="3001385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="comment" id="3001388">//&nbsp;%b:&nbsp;-ddddddddp+ddd</span><br>
<span class="lineno"></span><span class="keyword" id="3001410">func</span>&nbsp;<span class="ident" id="3001415">fmtB</span><span class="op" id="3001419">(</span><span class="ident" id="3001420">dst</span>&nbsp;<span class="op" id="3001424">[</span><span class="op" id="3001425">]</span><span class="builtintype" id="3001426">byte</span><span class="op" id="3001430">,</span>&nbsp;<span class="ident" id="3001432">neg</span>&nbsp;<span class="builtintype" id="3001436">bool</span><span class="op" id="3001440">,</span>&nbsp;<span class="ident" id="3001442">mant</span>&nbsp;<span class="ident" id="3001447">uint64</span><span class="op" id="3001453">,</span>&nbsp;<span class="ident" id="3001455">exp</span>&nbsp;<span class="builtintype" id="3001459">int</span><span class="op" id="3001462">,</span>&nbsp;<span class="ident" id="3001464">flt</span>&nbsp;<span class="op" id="3001468">*</span><span class="ident" id="3001469"><a href="/strconv/ftoa.go.html#2991005">floatInfo</a></span><span class="op" id="3001478">)</span>&nbsp;<span class="op" id="3001480">[</span><span class="op" id="3001481">]</span><span class="builtintype" id="3001482">byte</span>&nbsp;<span class="op" id="3001487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001490">var</span>&nbsp;<span class="ident" id="3001494">buf</span>&nbsp;<span class="op" id="3001498">[</span><span class="num" id="3001499">50</span><span class="op" id="3001501">]</span><span class="builtintype" id="3001502">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001508">w</span>&nbsp;<span class="op" id="3001510">:=</span>&nbsp;<span class="builtinfunc" id="3001513">len</span><span class="op" id="3001516">(</span><span class="ident" id="3001517"><a href="/strconv/ftoa.go.html#3001494">buf</a></span><span class="op" id="3001520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001523"><a href="/strconv/ftoa.go.html#3001455">exp</a></span>&nbsp;<span class="op" id="3001527">-=</span>&nbsp;<span class="builtintype" id="3001530">int</span><span class="op" id="3001533">(</span><span class="ident" id="3001534"><a href="/strconv/ftoa.go.html#3001464">flt</a></span><span class="op" id="3001537">.</span><span class="ident" id="3001538">mantbits</span><span class="op" id="3001546">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001549">esign</span>&nbsp;<span class="op" id="3001555">:=</span>&nbsp;<span class="builtintype" id="3001558">byte</span><span class="op" id="3001562">(</span><span class="string" id="3001563">&#39;+&#39;</span><span class="op" id="3001566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001569">if</span>&nbsp;<span class="ident" id="3001572"><a href="/strconv/ftoa.go.html#3001455">exp</a></span>&nbsp;<span class="op" id="3001576">&lt;</span>&nbsp;<span class="num" id="3001578">0</span>&nbsp;<span class="op" id="3001580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001584"><a href="/strconv/ftoa.go.html#3001549">esign</a></span>&nbsp;<span class="op" id="3001590">=</span>&nbsp;<span class="string" id="3001592">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001598"><a href="/strconv/ftoa.go.html#3001455">exp</a></span>&nbsp;<span class="op" id="3001602">=</span>&nbsp;<span class="op" id="3001604">-</span><span class="ident" id="3001605"><a href="/strconv/ftoa.go.html#3001455">exp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001610">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001613">n</span>&nbsp;<span class="op" id="3001615">:=</span>&nbsp;<span class="num" id="3001618">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001621">for</span>&nbsp;<span class="ident" id="3001625"><a href="/strconv/ftoa.go.html#3001455">exp</a></span>&nbsp;<span class="op" id="3001629">&gt;</span>&nbsp;<span class="num" id="3001631">0</span>&nbsp;<span class="op" id="3001633">||</span>&nbsp;<span class="ident" id="3001636"><a href="/strconv/ftoa.go.html#3001613">n</a></span>&nbsp;<span class="op" id="3001638">&lt;</span>&nbsp;<span class="num" id="3001640">1</span>&nbsp;<span class="op" id="3001642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001646"><a href="/strconv/ftoa.go.html#3001613">n</a></span><span class="op" id="3001647">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001652"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001653">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001658"><a href="/strconv/ftoa.go.html#3001494">buf</a></span><span class="op" id="3001661">[</span><span class="ident" id="3001662"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001663">]</span>&nbsp;<span class="op" id="3001665">=</span>&nbsp;<span class="builtintype" id="3001667">byte</span><span class="op" id="3001671">(</span><span class="ident" id="3001672"><a href="/strconv/ftoa.go.html#3001455">exp</a></span><span class="op" id="3001675">%</span><span class="num" id="3001676">10</span>&nbsp;<span class="op" id="3001679">+</span>&nbsp;<span class="string" id="3001681">&#39;0&#39;</span><span class="op" id="3001684">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001688"><a href="/strconv/ftoa.go.html#3001455">exp</a></span>&nbsp;<span class="op" id="3001692">/=</span>&nbsp;<span class="num" id="3001695">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001702"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001703">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001707"><a href="/strconv/ftoa.go.html#3001494">buf</a></span><span class="op" id="3001710">[</span><span class="ident" id="3001711"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001712">]</span>&nbsp;<span class="op" id="3001714">=</span>&nbsp;<span class="ident" id="3001716"><a href="/strconv/ftoa.go.html#3001549">esign</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001723"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001724">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001728"><a href="/strconv/ftoa.go.html#3001494">buf</a></span><span class="op" id="3001731">[</span><span class="ident" id="3001732"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001733">]</span>&nbsp;<span class="op" id="3001735">=</span>&nbsp;<span class="string" id="3001737">&#39;p&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001742"><a href="/strconv/ftoa.go.html#3001613">n</a></span>&nbsp;<span class="op" id="3001744">=</span>&nbsp;<span class="num" id="3001746">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001749">for</span>&nbsp;<span class="ident" id="3001753"><a href="/strconv/ftoa.go.html#3001442">mant</a></span>&nbsp;<span class="op" id="3001758">&gt;</span>&nbsp;<span class="num" id="3001760">0</span>&nbsp;<span class="op" id="3001762">||</span>&nbsp;<span class="ident" id="3001765"><a href="/strconv/ftoa.go.html#3001613">n</a></span>&nbsp;<span class="op" id="3001767">&lt;</span>&nbsp;<span class="num" id="3001769">1</span>&nbsp;<span class="op" id="3001771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001775"><a href="/strconv/ftoa.go.html#3001613">n</a></span><span class="op" id="3001776">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001781"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001782">--</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001787"><a href="/strconv/ftoa.go.html#3001494">buf</a></span><span class="op" id="3001790">[</span><span class="ident" id="3001791"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001792">]</span>&nbsp;<span class="op" id="3001794">=</span>&nbsp;<span class="builtintype" id="3001796">byte</span><span class="op" id="3001800">(</span><span class="ident" id="3001801"><a href="/strconv/ftoa.go.html#3001442">mant</a></span><span class="op" id="3001805">%</span><span class="num" id="3001806">10</span>&nbsp;<span class="op" id="3001809">+</span>&nbsp;<span class="string" id="3001811">&#39;0&#39;</span><span class="op" id="3001814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001818"><a href="/strconv/ftoa.go.html#3001442">mant</a></span>&nbsp;<span class="op" id="3001823">/=</span>&nbsp;<span class="num" id="3001826">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001833">if</span>&nbsp;<span class="ident" id="3001836"><a href="/strconv/ftoa.go.html#3001432">neg</a></span>&nbsp;<span class="op" id="3001840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001844"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001845">--</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3001850"><a href="/strconv/ftoa.go.html#3001494">buf</a></span><span class="op" id="3001853">[</span><span class="ident" id="3001854"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001855">]</span>&nbsp;<span class="op" id="3001857">=</span>&nbsp;<span class="string" id="3001859">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001867">return</span>&nbsp;<span class="builtinfunc" id="3001874">append</span><span class="op" id="3001880">(</span><span class="ident" id="3001881"><a href="/strconv/ftoa.go.html#3001420">dst</a></span><span class="op" id="3001884">,</span>&nbsp;<span class="ident" id="3001886"><a href="/strconv/ftoa.go.html#3001494">buf</a></span><span class="op" id="3001889">[</span><span class="ident" id="3001890"><a href="/strconv/ftoa.go.html#3001508">w</a></span><span class="op" id="3001891">:</span><span class="op" id="3001892">]</span><span class="op" id="3001893">...</span><span class="op" id="3001896">)</span><br>
<span class="lineno"></span><span class="op" id="3001898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span><span class="keyword" id="3001901">func</span>&nbsp;<span class="ident" id="3001906">max</span><span class="op" id="3001909">(</span><span class="ident" id="3001910">a</span><span class="op" id="3001911">,</span>&nbsp;<span class="ident" id="3001913">b</span>&nbsp;<span class="builtintype" id="3001915">int</span><span class="op" id="3001918">)</span>&nbsp;<span class="builtintype" id="3001920">int</span>&nbsp;<span class="op" id="3001924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001927">if</span>&nbsp;<span class="ident" id="3001930"><a href="/strconv/ftoa.go.html#3001910">a</a></span>&nbsp;<span class="op" id="3001932">&gt;</span>&nbsp;<span class="ident" id="3001934"><a href="/strconv/ftoa.go.html#3001913">b</a></span>&nbsp;<span class="op" id="3001936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001940">return</span>&nbsp;<span class="ident" id="3001947"><a href="/strconv/ftoa.go.html#3001910">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3001950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3001953">return</span>&nbsp;<span class="ident" id="3001960"><a href="/strconv/ftoa.go.html#3001913">b</a></span><br>
<span class="lineno">475</span><span class="op" id="3001962">}</span>
</div>
</body>
</html>
