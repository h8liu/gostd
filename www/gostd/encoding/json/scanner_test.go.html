<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html" class="current">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6563063">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6563119">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6563173">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6563224">package</span>&nbsp;<span class="ident" id="6563232">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6563238">import</span>&nbsp;<span class="op" id="6563245">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6563248">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6563257">&#34;math&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6563265">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6563278">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6563289">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6563299">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6563302">//&nbsp;Tests&nbsp;of&nbsp;simple&nbsp;examples.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6563332">type</span>&nbsp;<span class="ident" id="6563337">example</span>&nbsp;<span class="keyword" id="6563345">struct</span>&nbsp;<span class="op" id="6563352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563355">compact</span>&nbsp;<span class="builtintype" id="6563363">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563371">indent</span>&nbsp;&nbsp;<span class="builtintype" id="6563379">string</span><br>
<span class="lineno">20</span><span class="op" id="6563386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6563389">var</span>&nbsp;<span class="ident" id="6563393">examples</span>&nbsp;<span class="op" id="6563402">=</span>&nbsp;<span class="op" id="6563404">[</span><span class="op" id="6563405">]</span><span class="ident" id="6563406">example</span><span class="op" id="6563413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563416">{</span><span class="string" id="6563417">`1`</span><span class="op" id="6563420">,</span>&nbsp;<span class="string" id="6563422">`1`</span><span class="op" id="6563425">}</span><span class="op" id="6563426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563429">{</span><span class="string" id="6563430">`{}`</span><span class="op" id="6563434">,</span>&nbsp;<span class="string" id="6563436">`{}`</span><span class="op" id="6563440">}</span><span class="op" id="6563441">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563444">{</span><span class="string" id="6563445">`[]`</span><span class="op" id="6563449">,</span>&nbsp;<span class="string" id="6563451">`[]`</span><span class="op" id="6563455">}</span><span class="op" id="6563456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563459">{</span><span class="string" id="6563460">`{&#34;&#34;:2}`</span><span class="op" id="6563468">,</span>&nbsp;<span class="string" id="6563470">&#34;{\n\t\&#34;\&#34;:&nbsp;2\n}&#34;</span><span class="op" id="6563487">}</span><span class="op" id="6563488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563491">{</span><span class="string" id="6563492">`[3]`</span><span class="op" id="6563497">,</span>&nbsp;<span class="string" id="6563499">&#34;[\n\t3\n]&#34;</span><span class="op" id="6563510">}</span><span class="op" id="6563511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563514">{</span><span class="string" id="6563515">`[1,2,3]`</span><span class="op" id="6563524">,</span>&nbsp;<span class="string" id="6563526">&#34;[\n\t1,\n\t2,\n\t3\n]&#34;</span><span class="op" id="6563549">}</span><span class="op" id="6563550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563553">{</span><span class="string" id="6563554">`{&#34;x&#34;:1}`</span><span class="op" id="6563563">,</span>&nbsp;<span class="string" id="6563565">&#34;{\n\t\&#34;x\&#34;:&nbsp;1\n}&#34;</span><span class="op" id="6563583">}</span><span class="op" id="6563584">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563587">{</span><span class="ident" id="6563588">ex1</span><span class="op" id="6563591">,</span>&nbsp;<span class="ident" id="6563593">ex1i</span><span class="op" id="6563597">}</span><span class="op" id="6563598">,</span><br>
<span class="lineno"></span><span class="op" id="6563600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6563603">var</span>&nbsp;<span class="ident" id="6563607">ex1</span>&nbsp;<span class="op" id="6563611">=</span>&nbsp;<span class="string" id="6563613">`[true,false,null,&#34;x&#34;,1,1.5,0,-5e+2]`</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6563652">var</span>&nbsp;<span class="ident" id="6563656">ex1i</span>&nbsp;<span class="op" id="6563661">=</span>&nbsp;<span class="string" id="6563663">`[<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsptrue,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfalse,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspnull,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&#34;x&#34;,<br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp1,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp1.5,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp0,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp-5e+2<br>
<span class="lineno"></span>]`</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6563719">func</span>&nbsp;<span class="ident" id="6563724">TestCompact</span><span class="op" id="6563735">(</span><span class="ident" id="6563736">t</span>&nbsp;<span class="op" id="6563738">*</span><span class="ident" id="6563739">testing</span><span class="op" id="6563746">.</span><span class="ident" id="6563747">T</span><span class="op" id="6563748">)</span>&nbsp;<span class="op" id="6563750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563753">var</span>&nbsp;<span class="ident" id="6563757">buf</span>&nbsp;<span class="ident" id="6563761">bytes</span><span class="op" id="6563766">.</span><span class="ident" id="6563767">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563775">for</span>&nbsp;<span class="ident" id="6563779">_</span><span class="op" id="6563780">,</span>&nbsp;<span class="ident" id="6563782">tt</span>&nbsp;<span class="op" id="6563785">:=</span>&nbsp;<span class="keyword" id="6563788">range</span>&nbsp;<span class="ident" id="6563794">examples</span>&nbsp;<span class="op" id="6563803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563807">buf</span><span class="op" id="6563810">.</span><span class="ident" id="6563811">Reset</span><span class="op" id="6563816">(</span><span class="op" id="6563817">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563821">if</span>&nbsp;<span class="ident" id="6563824">err</span>&nbsp;<span class="op" id="6563828">:=</span>&nbsp;<span class="ident" id="6563831">Compact</span><span class="op" id="6563838">(</span><span class="op" id="6563839">&amp;</span><span class="ident" id="6563840">buf</span><span class="op" id="6563843">,</span>&nbsp;<span class="op" id="6563845">[</span><span class="op" id="6563846">]</span><span class="builtintype" id="6563847">byte</span><span class="op" id="6563851">(</span><span class="ident" id="6563852">tt</span><span class="op" id="6563854">.</span><span class="ident" id="6563855">compact</span><span class="op" id="6563862">)</span><span class="op" id="6563863">)</span><span class="op" id="6563864">;</span>&nbsp;<span class="ident" id="6563866">err</span>&nbsp;<span class="op" id="6563870">!=</span>&nbsp;<span class="ident" id="6563873">nil</span>&nbsp;<span class="op" id="6563877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563882">t</span><span class="op" id="6563883">.</span><span class="ident" id="6563884">Errorf</span><span class="op" id="6563890">(</span><span class="string" id="6563891">&#34;Compact(%#q):&nbsp;%v&#34;</span><span class="op" id="6563909">,</span>&nbsp;<span class="ident" id="6563911">tt</span><span class="op" id="6563913">.</span><span class="ident" id="6563914">compact</span><span class="op" id="6563921">,</span>&nbsp;<span class="ident" id="6563923">err</span><span class="op" id="6563926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563930">}</span>&nbsp;<span class="keyword" id="6563932">else</span>&nbsp;<span class="keyword" id="6563937">if</span>&nbsp;<span class="ident" id="6563940">s</span>&nbsp;<span class="op" id="6563942">:=</span>&nbsp;<span class="ident" id="6563945">buf</span><span class="op" id="6563948">.</span><span class="ident" id="6563949">String</span><span class="op" id="6563955">(</span><span class="op" id="6563956">)</span><span class="op" id="6563957">;</span>&nbsp;<span class="ident" id="6563959">s</span>&nbsp;<span class="op" id="6563961">!=</span>&nbsp;<span class="ident" id="6563964">tt</span><span class="op" id="6563966">.</span><span class="ident" id="6563967">compact</span>&nbsp;<span class="op" id="6563975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563980">t</span><span class="op" id="6563981">.</span><span class="ident" id="6563982">Errorf</span><span class="op" id="6563988">(</span><span class="string" id="6563989">&#34;Compact(%#q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;original&#34;</span><span class="op" id="6564024">,</span>&nbsp;<span class="ident" id="6564026">tt</span><span class="op" id="6564028">.</span><span class="ident" id="6564029">compact</span><span class="op" id="6564036">,</span>&nbsp;<span class="ident" id="6564038">s</span><span class="op" id="6564039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564043">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564048">buf</span><span class="op" id="6564051">.</span><span class="ident" id="6564052">Reset</span><span class="op" id="6564057">(</span><span class="op" id="6564058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564062">if</span>&nbsp;<span class="ident" id="6564065">err</span>&nbsp;<span class="op" id="6564069">:=</span>&nbsp;<span class="ident" id="6564072">Compact</span><span class="op" id="6564079">(</span><span class="op" id="6564080">&amp;</span><span class="ident" id="6564081">buf</span><span class="op" id="6564084">,</span>&nbsp;<span class="op" id="6564086">[</span><span class="op" id="6564087">]</span><span class="builtintype" id="6564088">byte</span><span class="op" id="6564092">(</span><span class="ident" id="6564093">tt</span><span class="op" id="6564095">.</span><span class="ident" id="6564096">indent</span><span class="op" id="6564102">)</span><span class="op" id="6564103">)</span><span class="op" id="6564104">;</span>&nbsp;<span class="ident" id="6564106">err</span>&nbsp;<span class="op" id="6564110">!=</span>&nbsp;<span class="ident" id="6564113">nil</span>&nbsp;<span class="op" id="6564117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564122">t</span><span class="op" id="6564123">.</span><span class="ident" id="6564124">Errorf</span><span class="op" id="6564130">(</span><span class="string" id="6564131">&#34;Compact(%#q):&nbsp;%v&#34;</span><span class="op" id="6564149">,</span>&nbsp;<span class="ident" id="6564151">tt</span><span class="op" id="6564153">.</span><span class="ident" id="6564154">indent</span><span class="op" id="6564160">,</span>&nbsp;<span class="ident" id="6564162">err</span><span class="op" id="6564165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564170">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564181">}</span>&nbsp;<span class="keyword" id="6564183">else</span>&nbsp;<span class="keyword" id="6564188">if</span>&nbsp;<span class="ident" id="6564191">s</span>&nbsp;<span class="op" id="6564193">:=</span>&nbsp;<span class="ident" id="6564196">buf</span><span class="op" id="6564199">.</span><span class="ident" id="6564200">String</span><span class="op" id="6564206">(</span><span class="op" id="6564207">)</span><span class="op" id="6564208">;</span>&nbsp;<span class="ident" id="6564210">s</span>&nbsp;<span class="op" id="6564212">!=</span>&nbsp;<span class="ident" id="6564215">tt</span><span class="op" id="6564217">.</span><span class="ident" id="6564218">compact</span>&nbsp;<span class="op" id="6564226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564231">t</span><span class="op" id="6564232">.</span><span class="ident" id="6564233">Errorf</span><span class="op" id="6564239">(</span><span class="string" id="6564240">&#34;Compact(%#q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6564270">,</span>&nbsp;<span class="ident" id="6564272">tt</span><span class="op" id="6564274">.</span><span class="ident" id="6564275">indent</span><span class="op" id="6564281">,</span>&nbsp;<span class="ident" id="6564283">s</span><span class="op" id="6564284">,</span>&nbsp;<span class="ident" id="6564286">tt</span><span class="op" id="6564288">.</span><span class="ident" id="6564289">compact</span><span class="op" id="6564296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564303">}</span><br>
<span class="lineno"></span><span class="op" id="6564305">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="6564308">func</span>&nbsp;<span class="ident" id="6564313">TestCompactSeparators</span><span class="op" id="6564334">(</span><span class="ident" id="6564335">t</span>&nbsp;<span class="op" id="6564337">*</span><span class="ident" id="6564338">testing</span><span class="op" id="6564345">.</span><span class="ident" id="6564346">T</span><span class="op" id="6564347">)</span>&nbsp;<span class="op" id="6564349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6564352">//&nbsp;U+2028&nbsp;and&nbsp;U+2029&nbsp;should&nbsp;be&nbsp;escaped&nbsp;inside&nbsp;strings.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6564408">//&nbsp;They&nbsp;should&nbsp;not&nbsp;appear&nbsp;outside&nbsp;strings.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564452">tests</span>&nbsp;<span class="op" id="6564458">:=</span>&nbsp;<span class="op" id="6564461">[</span><span class="op" id="6564462">]</span><span class="keyword" id="6564463">struct</span>&nbsp;<span class="op" id="6564470">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564474">in</span><span class="op" id="6564476">,</span>&nbsp;<span class="ident" id="6564478">compact</span>&nbsp;<span class="builtintype" id="6564486">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564494">}</span><span class="op" id="6564495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564499">{</span><span class="string" id="6564500">&#34;{\&#34;\u2028\&#34;:&nbsp;1}&#34;</span><span class="op" id="6564517">,</span>&nbsp;<span class="string" id="6564519">`{&#34;\u2028&#34;:1}`</span><span class="op" id="6564533">}</span><span class="op" id="6564534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564538">{</span><span class="string" id="6564539">&#34;{\&#34;\u2029\&#34;&nbsp;:2}&#34;</span><span class="op" id="6564556">,</span>&nbsp;<span class="string" id="6564558">`{&#34;\u2029&#34;:2}`</span><span class="op" id="6564572">}</span><span class="op" id="6564573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564576">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564579">for</span>&nbsp;<span class="ident" id="6564583">_</span><span class="op" id="6564584">,</span>&nbsp;<span class="ident" id="6564586">tt</span>&nbsp;<span class="op" id="6564589">:=</span>&nbsp;<span class="keyword" id="6564592">range</span>&nbsp;<span class="ident" id="6564598">tests</span>&nbsp;<span class="op" id="6564604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564608">var</span>&nbsp;<span class="ident" id="6564612">buf</span>&nbsp;<span class="ident" id="6564616">bytes</span><span class="op" id="6564621">.</span><span class="ident" id="6564622">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564631">if</span>&nbsp;<span class="ident" id="6564634">err</span>&nbsp;<span class="op" id="6564638">:=</span>&nbsp;<span class="ident" id="6564641">Compact</span><span class="op" id="6564648">(</span><span class="op" id="6564649">&amp;</span><span class="ident" id="6564650">buf</span><span class="op" id="6564653">,</span>&nbsp;<span class="op" id="6564655">[</span><span class="op" id="6564656">]</span><span class="builtintype" id="6564657">byte</span><span class="op" id="6564661">(</span><span class="ident" id="6564662">tt</span><span class="op" id="6564664">.</span><span class="ident" id="6564665">in</span><span class="op" id="6564667">)</span><span class="op" id="6564668">)</span><span class="op" id="6564669">;</span>&nbsp;<span class="ident" id="6564671">err</span>&nbsp;<span class="op" id="6564675">!=</span>&nbsp;<span class="ident" id="6564678">nil</span>&nbsp;<span class="op" id="6564682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564687">t</span><span class="op" id="6564688">.</span><span class="ident" id="6564689">Errorf</span><span class="op" id="6564695">(</span><span class="string" id="6564696">&#34;Compact(%q):&nbsp;%v&#34;</span><span class="op" id="6564713">,</span>&nbsp;<span class="ident" id="6564715">tt</span><span class="op" id="6564717">.</span><span class="ident" id="6564718">in</span><span class="op" id="6564720">,</span>&nbsp;<span class="ident" id="6564722">err</span><span class="op" id="6564725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564729">}</span>&nbsp;<span class="keyword" id="6564731">else</span>&nbsp;<span class="keyword" id="6564736">if</span>&nbsp;<span class="ident" id="6564739">s</span>&nbsp;<span class="op" id="6564741">:=</span>&nbsp;<span class="ident" id="6564744">buf</span><span class="op" id="6564747">.</span><span class="ident" id="6564748">String</span><span class="op" id="6564754">(</span><span class="op" id="6564755">)</span><span class="op" id="6564756">;</span>&nbsp;<span class="ident" id="6564758">s</span>&nbsp;<span class="op" id="6564760">!=</span>&nbsp;<span class="ident" id="6564763">tt</span><span class="op" id="6564765">.</span><span class="ident" id="6564766">compact</span>&nbsp;<span class="op" id="6564774">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564779">t</span><span class="op" id="6564780">.</span><span class="ident" id="6564781">Errorf</span><span class="op" id="6564787">(</span><span class="string" id="6564788">&#34;Compact(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6564815">,</span>&nbsp;<span class="ident" id="6564817">tt</span><span class="op" id="6564819">.</span><span class="ident" id="6564820">in</span><span class="op" id="6564822">,</span>&nbsp;<span class="ident" id="6564824">s</span><span class="op" id="6564825">,</span>&nbsp;<span class="ident" id="6564827">tt</span><span class="op" id="6564829">.</span><span class="ident" id="6564830">compact</span><span class="op" id="6564837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564844">}</span><br>
<span class="lineno"></span><span class="op" id="6564846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="6564849">func</span>&nbsp;<span class="ident" id="6564854">TestIndent</span><span class="op" id="6564864">(</span><span class="ident" id="6564865">t</span>&nbsp;<span class="op" id="6564867">*</span><span class="ident" id="6564868">testing</span><span class="op" id="6564875">.</span><span class="ident" id="6564876">T</span><span class="op" id="6564877">)</span>&nbsp;<span class="op" id="6564879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564882">var</span>&nbsp;<span class="ident" id="6564886">buf</span>&nbsp;<span class="ident" id="6564890">bytes</span><span class="op" id="6564895">.</span><span class="ident" id="6564896">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564904">for</span>&nbsp;<span class="ident" id="6564908">_</span><span class="op" id="6564909">,</span>&nbsp;<span class="ident" id="6564911">tt</span>&nbsp;<span class="op" id="6564914">:=</span>&nbsp;<span class="keyword" id="6564917">range</span>&nbsp;<span class="ident" id="6564923">examples</span>&nbsp;<span class="op" id="6564932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564936">buf</span><span class="op" id="6564939">.</span><span class="ident" id="6564940">Reset</span><span class="op" id="6564945">(</span><span class="op" id="6564946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564950">if</span>&nbsp;<span class="ident" id="6564953">err</span>&nbsp;<span class="op" id="6564957">:=</span>&nbsp;<span class="ident" id="6564960">Indent</span><span class="op" id="6564966">(</span><span class="op" id="6564967">&amp;</span><span class="ident" id="6564968">buf</span><span class="op" id="6564971">,</span>&nbsp;<span class="op" id="6564973">[</span><span class="op" id="6564974">]</span><span class="builtintype" id="6564975">byte</span><span class="op" id="6564979">(</span><span class="ident" id="6564980">tt</span><span class="op" id="6564982">.</span><span class="ident" id="6564983">indent</span><span class="op" id="6564989">)</span><span class="op" id="6564990">,</span>&nbsp;<span class="string" id="6564992">&#34;&#34;</span><span class="op" id="6564994">,</span>&nbsp;<span class="string" id="6564996">&#34;\t&#34;</span><span class="op" id="6565000">)</span><span class="op" id="6565001">;</span>&nbsp;<span class="ident" id="6565003">err</span>&nbsp;<span class="op" id="6565007">!=</span>&nbsp;<span class="ident" id="6565010">nil</span>&nbsp;<span class="op" id="6565014">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565019">t</span><span class="op" id="6565020">.</span><span class="ident" id="6565021">Errorf</span><span class="op" id="6565027">(</span><span class="string" id="6565028">&#34;Indent(%#q):&nbsp;%v&#34;</span><span class="op" id="6565045">,</span>&nbsp;<span class="ident" id="6565047">tt</span><span class="op" id="6565049">.</span><span class="ident" id="6565050">indent</span><span class="op" id="6565056">,</span>&nbsp;<span class="ident" id="6565058">err</span><span class="op" id="6565061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565065">}</span>&nbsp;<span class="keyword" id="6565067">else</span>&nbsp;<span class="keyword" id="6565072">if</span>&nbsp;<span class="ident" id="6565075">s</span>&nbsp;<span class="op" id="6565077">:=</span>&nbsp;<span class="ident" id="6565080">buf</span><span class="op" id="6565083">.</span><span class="ident" id="6565084">String</span><span class="op" id="6565090">(</span><span class="op" id="6565091">)</span><span class="op" id="6565092">;</span>&nbsp;<span class="ident" id="6565094">s</span>&nbsp;<span class="op" id="6565096">!=</span>&nbsp;<span class="ident" id="6565099">tt</span><span class="op" id="6565101">.</span><span class="ident" id="6565102">indent</span>&nbsp;<span class="op" id="6565109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565114">t</span><span class="op" id="6565115">.</span><span class="ident" id="6565116">Errorf</span><span class="op" id="6565122">(</span><span class="string" id="6565123">&#34;Indent(%#q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;original&#34;</span><span class="op" id="6565157">,</span>&nbsp;<span class="ident" id="6565159">tt</span><span class="op" id="6565161">.</span><span class="ident" id="6565162">indent</span><span class="op" id="6565168">,</span>&nbsp;<span class="ident" id="6565170">s</span><span class="op" id="6565171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565180">buf</span><span class="op" id="6565183">.</span><span class="ident" id="6565184">Reset</span><span class="op" id="6565189">(</span><span class="op" id="6565190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565194">if</span>&nbsp;<span class="ident" id="6565197">err</span>&nbsp;<span class="op" id="6565201">:=</span>&nbsp;<span class="ident" id="6565204">Indent</span><span class="op" id="6565210">(</span><span class="op" id="6565211">&amp;</span><span class="ident" id="6565212">buf</span><span class="op" id="6565215">,</span>&nbsp;<span class="op" id="6565217">[</span><span class="op" id="6565218">]</span><span class="builtintype" id="6565219">byte</span><span class="op" id="6565223">(</span><span class="ident" id="6565224">tt</span><span class="op" id="6565226">.</span><span class="ident" id="6565227">compact</span><span class="op" id="6565234">)</span><span class="op" id="6565235">,</span>&nbsp;<span class="string" id="6565237">&#34;&#34;</span><span class="op" id="6565239">,</span>&nbsp;<span class="string" id="6565241">&#34;\t&#34;</span><span class="op" id="6565245">)</span><span class="op" id="6565246">;</span>&nbsp;<span class="ident" id="6565248">err</span>&nbsp;<span class="op" id="6565252">!=</span>&nbsp;<span class="ident" id="6565255">nil</span>&nbsp;<span class="op" id="6565259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565264">t</span><span class="op" id="6565265">.</span><span class="ident" id="6565266">Errorf</span><span class="op" id="6565272">(</span><span class="string" id="6565273">&#34;Indent(%#q):&nbsp;%v&#34;</span><span class="op" id="6565290">,</span>&nbsp;<span class="ident" id="6565292">tt</span><span class="op" id="6565294">.</span><span class="ident" id="6565295">compact</span><span class="op" id="6565302">,</span>&nbsp;<span class="ident" id="6565304">err</span><span class="op" id="6565307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565312">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565323">}</span>&nbsp;<span class="keyword" id="6565325">else</span>&nbsp;<span class="keyword" id="6565330">if</span>&nbsp;<span class="ident" id="6565333">s</span>&nbsp;<span class="op" id="6565335">:=</span>&nbsp;<span class="ident" id="6565338">buf</span><span class="op" id="6565341">.</span><span class="ident" id="6565342">String</span><span class="op" id="6565348">(</span><span class="op" id="6565349">)</span><span class="op" id="6565350">;</span>&nbsp;<span class="ident" id="6565352">s</span>&nbsp;<span class="op" id="6565354">!=</span>&nbsp;<span class="ident" id="6565357">tt</span><span class="op" id="6565359">.</span><span class="ident" id="6565360">indent</span>&nbsp;<span class="op" id="6565367">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565372">t</span><span class="op" id="6565373">.</span><span class="ident" id="6565374">Errorf</span><span class="op" id="6565380">(</span><span class="string" id="6565381">&#34;Indent(%#q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6565410">,</span>&nbsp;<span class="ident" id="6565412">tt</span><span class="op" id="6565414">.</span><span class="ident" id="6565415">compact</span><span class="op" id="6565422">,</span>&nbsp;<span class="ident" id="6565424">s</span><span class="op" id="6565425">,</span>&nbsp;<span class="ident" id="6565427">tt</span><span class="op" id="6565429">.</span><span class="ident" id="6565430">indent</span><span class="op" id="6565436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565443">}</span><br>
<span class="lineno"></span><span class="op" id="6565445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6565448">//&nbsp;Tests&nbsp;of&nbsp;a&nbsp;large&nbsp;random&nbsp;structure.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6565487">func</span>&nbsp;<span class="ident" id="6565492">TestCompactBig</span><span class="op" id="6565506">(</span><span class="ident" id="6565507">t</span>&nbsp;<span class="op" id="6565509">*</span><span class="ident" id="6565510">testing</span><span class="op" id="6565517">.</span><span class="ident" id="6565518">T</span><span class="op" id="6565519">)</span>&nbsp;<span class="op" id="6565521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565524">initBig</span><span class="op" id="6565531">(</span><span class="op" id="6565532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565535">var</span>&nbsp;<span class="ident" id="6565539">buf</span>&nbsp;<span class="ident" id="6565543">bytes</span><span class="op" id="6565548">.</span><span class="ident" id="6565549">Buffer</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565557">if</span>&nbsp;<span class="ident" id="6565560">err</span>&nbsp;<span class="op" id="6565564">:=</span>&nbsp;<span class="ident" id="6565567">Compact</span><span class="op" id="6565574">(</span><span class="op" id="6565575">&amp;</span><span class="ident" id="6565576">buf</span><span class="op" id="6565579">,</span>&nbsp;<span class="ident" id="6565581">jsonBig</span><span class="op" id="6565588">)</span><span class="op" id="6565589">;</span>&nbsp;<span class="ident" id="6565591">err</span>&nbsp;<span class="op" id="6565595">!=</span>&nbsp;<span class="ident" id="6565598">nil</span>&nbsp;<span class="op" id="6565602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565606">t</span><span class="op" id="6565607">.</span><span class="ident" id="6565608">Fatalf</span><span class="op" id="6565614">(</span><span class="string" id="6565615">&#34;Compact:&nbsp;%v&#34;</span><span class="op" id="6565628">,</span>&nbsp;<span class="ident" id="6565630">err</span><span class="op" id="6565633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565639">b</span>&nbsp;<span class="op" id="6565641">:=</span>&nbsp;<span class="ident" id="6565644">buf</span><span class="op" id="6565647">.</span><span class="ident" id="6565648">Bytes</span><span class="op" id="6565653">(</span><span class="op" id="6565654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565657">if</span>&nbsp;<span class="op" id="6565660">!</span><span class="ident" id="6565661">bytes</span><span class="op" id="6565666">.</span><span class="ident" id="6565667">Equal</span><span class="op" id="6565672">(</span><span class="ident" id="6565673">b</span><span class="op" id="6565674">,</span>&nbsp;<span class="ident" id="6565676">jsonBig</span><span class="op" id="6565683">)</span>&nbsp;<span class="op" id="6565685">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565689">t</span><span class="op" id="6565690">.</span><span class="ident" id="6565691">Error</span><span class="op" id="6565696">(</span><span class="string" id="6565697">&#34;Compact(jsonBig)&nbsp;!=&nbsp;jsonBig&#34;</span><span class="op" id="6565726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565730">diff</span><span class="op" id="6565734">(</span><span class="ident" id="6565735">t</span><span class="op" id="6565736">,</span>&nbsp;<span class="ident" id="6565738">b</span><span class="op" id="6565739">,</span>&nbsp;<span class="ident" id="6565741">jsonBig</span><span class="op" id="6565748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565752">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565760">}</span><br>
<span class="lineno"></span><span class="op" id="6565762">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="6565765">func</span>&nbsp;<span class="ident" id="6565770">TestIndentBig</span><span class="op" id="6565783">(</span><span class="ident" id="6565784">t</span>&nbsp;<span class="op" id="6565786">*</span><span class="ident" id="6565787">testing</span><span class="op" id="6565794">.</span><span class="ident" id="6565795">T</span><span class="op" id="6565796">)</span>&nbsp;<span class="op" id="6565798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565801">initBig</span><span class="op" id="6565808">(</span><span class="op" id="6565809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565812">var</span>&nbsp;<span class="ident" id="6565816">buf</span>&nbsp;<span class="ident" id="6565820">bytes</span><span class="op" id="6565825">.</span><span class="ident" id="6565826">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565834">if</span>&nbsp;<span class="ident" id="6565837">err</span>&nbsp;<span class="op" id="6565841">:=</span>&nbsp;<span class="ident" id="6565844">Indent</span><span class="op" id="6565850">(</span><span class="op" id="6565851">&amp;</span><span class="ident" id="6565852">buf</span><span class="op" id="6565855">,</span>&nbsp;<span class="ident" id="6565857">jsonBig</span><span class="op" id="6565864">,</span>&nbsp;<span class="string" id="6565866">&#34;&#34;</span><span class="op" id="6565868">,</span>&nbsp;<span class="string" id="6565870">&#34;\t&#34;</span><span class="op" id="6565874">)</span><span class="op" id="6565875">;</span>&nbsp;<span class="ident" id="6565877">err</span>&nbsp;<span class="op" id="6565881">!=</span>&nbsp;<span class="ident" id="6565884">nil</span>&nbsp;<span class="op" id="6565888">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565892">t</span><span class="op" id="6565893">.</span><span class="ident" id="6565894">Fatalf</span><span class="op" id="6565900">(</span><span class="string" id="6565901">&#34;Indent1:&nbsp;%v&#34;</span><span class="op" id="6565914">,</span>&nbsp;<span class="ident" id="6565916">err</span><span class="op" id="6565919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565925">b</span>&nbsp;<span class="op" id="6565927">:=</span>&nbsp;<span class="ident" id="6565930">buf</span><span class="op" id="6565933">.</span><span class="ident" id="6565934">Bytes</span><span class="op" id="6565939">(</span><span class="op" id="6565940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565943">if</span>&nbsp;<span class="builtinfunc" id="6565946">len</span><span class="op" id="6565949">(</span><span class="ident" id="6565950">b</span><span class="op" id="6565951">)</span>&nbsp;<span class="op" id="6565953">==</span>&nbsp;<span class="builtinfunc" id="6565956">len</span><span class="op" id="6565959">(</span><span class="ident" id="6565960">jsonBig</span><span class="op" id="6565967">)</span>&nbsp;<span class="op" id="6565969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6565973">//&nbsp;jsonBig&nbsp;is&nbsp;compact&nbsp;(no&nbsp;unnecessary&nbsp;spaces);</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6566022">//&nbsp;indenting&nbsp;should&nbsp;make&nbsp;it&nbsp;bigger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566059">t</span><span class="op" id="6566060">.</span><span class="ident" id="6566061">Fatalf</span><span class="op" id="6566067">(</span><span class="string" id="6566068">&#34;Indent(jsonBig)&nbsp;did&nbsp;not&nbsp;get&nbsp;bigger&#34;</span><span class="op" id="6566104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6566111">//&nbsp;should&nbsp;be&nbsp;idempotent</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566136">var</span>&nbsp;<span class="ident" id="6566140">buf1</span>&nbsp;<span class="ident" id="6566145">bytes</span><span class="op" id="6566150">.</span><span class="ident" id="6566151">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566159">if</span>&nbsp;<span class="ident" id="6566162">err</span>&nbsp;<span class="op" id="6566166">:=</span>&nbsp;<span class="ident" id="6566169">Indent</span><span class="op" id="6566175">(</span><span class="op" id="6566176">&amp;</span><span class="ident" id="6566177">buf1</span><span class="op" id="6566181">,</span>&nbsp;<span class="ident" id="6566183">b</span><span class="op" id="6566184">,</span>&nbsp;<span class="string" id="6566186">&#34;&#34;</span><span class="op" id="6566188">,</span>&nbsp;<span class="string" id="6566190">&#34;\t&#34;</span><span class="op" id="6566194">)</span><span class="op" id="6566195">;</span>&nbsp;<span class="ident" id="6566197">err</span>&nbsp;<span class="op" id="6566201">!=</span>&nbsp;<span class="ident" id="6566204">nil</span>&nbsp;<span class="op" id="6566208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566212">t</span><span class="op" id="6566213">.</span><span class="ident" id="6566214">Fatalf</span><span class="op" id="6566220">(</span><span class="string" id="6566221">&#34;Indent2:&nbsp;%v&#34;</span><span class="op" id="6566234">,</span>&nbsp;<span class="ident" id="6566236">err</span><span class="op" id="6566239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566245">b1</span>&nbsp;<span class="op" id="6566248">:=</span>&nbsp;<span class="ident" id="6566251">buf1</span><span class="op" id="6566255">.</span><span class="ident" id="6566256">Bytes</span><span class="op" id="6566261">(</span><span class="op" id="6566262">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566265">if</span>&nbsp;<span class="op" id="6566268">!</span><span class="ident" id="6566269">bytes</span><span class="op" id="6566274">.</span><span class="ident" id="6566275">Equal</span><span class="op" id="6566280">(</span><span class="ident" id="6566281">b1</span><span class="op" id="6566283">,</span>&nbsp;<span class="ident" id="6566285">b</span><span class="op" id="6566286">)</span>&nbsp;<span class="op" id="6566288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566292">t</span><span class="op" id="6566293">.</span><span class="ident" id="6566294">Error</span><span class="op" id="6566299">(</span><span class="string" id="6566300">&#34;Indent(Indent(jsonBig))&nbsp;!=&nbsp;Indent(jsonBig)&#34;</span><span class="op" id="6566344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566348">diff</span><span class="op" id="6566352">(</span><span class="ident" id="6566353">t</span><span class="op" id="6566354">,</span>&nbsp;<span class="ident" id="6566356">b1</span><span class="op" id="6566358">,</span>&nbsp;<span class="ident" id="6566360">b</span><span class="op" id="6566361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566365">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566373">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6566377">//&nbsp;should&nbsp;get&nbsp;back&nbsp;to&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566409">buf1</span><span class="op" id="6566413">.</span><span class="ident" id="6566414">Reset</span><span class="op" id="6566419">(</span><span class="op" id="6566420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566423">if</span>&nbsp;<span class="ident" id="6566426">err</span>&nbsp;<span class="op" id="6566430">:=</span>&nbsp;<span class="ident" id="6566433">Compact</span><span class="op" id="6566440">(</span><span class="op" id="6566441">&amp;</span><span class="ident" id="6566442">buf1</span><span class="op" id="6566446">,</span>&nbsp;<span class="ident" id="6566448">b</span><span class="op" id="6566449">)</span><span class="op" id="6566450">;</span>&nbsp;<span class="ident" id="6566452">err</span>&nbsp;<span class="op" id="6566456">!=</span>&nbsp;<span class="ident" id="6566459">nil</span>&nbsp;<span class="op" id="6566463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566467">t</span><span class="op" id="6566468">.</span><span class="ident" id="6566469">Fatalf</span><span class="op" id="6566475">(</span><span class="string" id="6566476">&#34;Compact:&nbsp;%v&#34;</span><span class="op" id="6566489">,</span>&nbsp;<span class="ident" id="6566491">err</span><span class="op" id="6566494">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566500">b1</span>&nbsp;<span class="op" id="6566503">=</span>&nbsp;<span class="ident" id="6566505">buf1</span><span class="op" id="6566509">.</span><span class="ident" id="6566510">Bytes</span><span class="op" id="6566515">(</span><span class="op" id="6566516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566519">if</span>&nbsp;<span class="op" id="6566522">!</span><span class="ident" id="6566523">bytes</span><span class="op" id="6566528">.</span><span class="ident" id="6566529">Equal</span><span class="op" id="6566534">(</span><span class="ident" id="6566535">b1</span><span class="op" id="6566537">,</span>&nbsp;<span class="ident" id="6566539">jsonBig</span><span class="op" id="6566546">)</span>&nbsp;<span class="op" id="6566548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566552">t</span><span class="op" id="6566553">.</span><span class="ident" id="6566554">Error</span><span class="op" id="6566559">(</span><span class="string" id="6566560">&#34;Compact(Indent(jsonBig))&nbsp;!=&nbsp;jsonBig&#34;</span><span class="op" id="6566597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566601">diff</span><span class="op" id="6566605">(</span><span class="ident" id="6566606">t</span><span class="op" id="6566607">,</span>&nbsp;<span class="ident" id="6566609">b1</span><span class="op" id="6566611">,</span>&nbsp;<span class="ident" id="6566613">jsonBig</span><span class="op" id="6566620">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566624">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566632">}</span><br>
<span class="lineno"></span><span class="op" id="6566634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566637">type</span>&nbsp;<span class="ident" id="6566642">indentErrorTest</span>&nbsp;<span class="keyword" id="6566658">struct</span>&nbsp;<span class="op" id="6566665">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566668">in</span>&nbsp;&nbsp;<span class="builtintype" id="6566672">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566680">err</span>&nbsp;<span class="builtintype" id="6566684">error</span><br>
<span class="lineno"></span><span class="op" id="6566690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566693">var</span>&nbsp;<span class="ident" id="6566697">indentErrorTests</span>&nbsp;<span class="op" id="6566714">=</span>&nbsp;<span class="op" id="6566716">[</span><span class="op" id="6566717">]</span><span class="ident" id="6566718">indentErrorTest</span><span class="op" id="6566733">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566736">{</span><span class="string" id="6566737">`{&#34;X&#34;:&nbsp;&#34;foo&#34;,&nbsp;&#34;Y&#34;}`</span><span class="op" id="6566756">,</span>&nbsp;<span class="op" id="6566758">&amp;</span><span class="ident" id="6566759">SyntaxError</span><span class="op" id="6566770">{</span><span class="string" id="6566771">&#34;invalid&nbsp;character&nbsp;&#39;}&#39;&nbsp;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="6566811">,</span>&nbsp;<span class="num" id="6566813">17</span><span class="op" id="6566815">}</span><span class="op" id="6566816">}</span><span class="op" id="6566817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566820">{</span><span class="string" id="6566821">`{&#34;X&#34;:&nbsp;&#34;foo&#34;&nbsp;&#34;Y&#34;:&nbsp;&#34;bar&#34;}`</span><span class="op" id="6566846">,</span>&nbsp;<span class="op" id="6566848">&amp;</span><span class="ident" id="6566849">SyntaxError</span><span class="op" id="6566860">{</span><span class="string" id="6566861">&#34;invalid&nbsp;character&nbsp;&#39;\&#34;&#39;&nbsp;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="6566913">,</span>&nbsp;<span class="num" id="6566915">13</span><span class="op" id="6566917">}</span><span class="op" id="6566918">}</span><span class="op" id="6566919">,</span><br>
<span class="lineno"></span><span class="op" id="6566921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566924">func</span>&nbsp;<span class="ident" id="6566929">TestIndentErrors</span><span class="op" id="6566945">(</span><span class="ident" id="6566946">t</span>&nbsp;<span class="op" id="6566948">*</span><span class="ident" id="6566949">testing</span><span class="op" id="6566956">.</span><span class="ident" id="6566957">T</span><span class="op" id="6566958">)</span>&nbsp;<span class="op" id="6566960">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566963">for</span>&nbsp;<span class="ident" id="6566967">i</span><span class="op" id="6566968">,</span>&nbsp;<span class="ident" id="6566970">tt</span>&nbsp;<span class="op" id="6566973">:=</span>&nbsp;<span class="keyword" id="6566976">range</span>&nbsp;<span class="ident" id="6566982">indentErrorTests</span>&nbsp;<span class="op" id="6566999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567003">slice</span>&nbsp;<span class="op" id="6567009">:=</span>&nbsp;<span class="builtinfunc" id="6567012">make</span><span class="op" id="6567016">(</span><span class="op" id="6567017">[</span><span class="op" id="6567018">]</span><span class="builtintype" id="6567019">uint8</span><span class="op" id="6567024">,</span>&nbsp;<span class="num" id="6567026">0</span><span class="op" id="6567027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567031">buf</span>&nbsp;<span class="op" id="6567035">:=</span>&nbsp;<span class="ident" id="6567038">bytes</span><span class="op" id="6567043">.</span><span class="ident" id="6567044">NewBuffer</span><span class="op" id="6567053">(</span><span class="ident" id="6567054">slice</span><span class="op" id="6567059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567063">if</span>&nbsp;<span class="ident" id="6567066">err</span>&nbsp;<span class="op" id="6567070">:=</span>&nbsp;<span class="ident" id="6567073">Indent</span><span class="op" id="6567079">(</span><span class="ident" id="6567080">buf</span><span class="op" id="6567083">,</span>&nbsp;<span class="op" id="6567085">[</span><span class="op" id="6567086">]</span><span class="builtintype" id="6567087">uint8</span><span class="op" id="6567092">(</span><span class="ident" id="6567093">tt</span><span class="op" id="6567095">.</span><span class="ident" id="6567096">in</span><span class="op" id="6567098">)</span><span class="op" id="6567099">,</span>&nbsp;<span class="string" id="6567101">&#34;&#34;</span><span class="op" id="6567103">,</span>&nbsp;<span class="string" id="6567105">&#34;&#34;</span><span class="op" id="6567107">)</span><span class="op" id="6567108">;</span>&nbsp;<span class="ident" id="6567110">err</span>&nbsp;<span class="op" id="6567114">!=</span>&nbsp;<span class="ident" id="6567117">nil</span>&nbsp;<span class="op" id="6567121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567126">if</span>&nbsp;<span class="op" id="6567129">!</span><span class="ident" id="6567130">reflect</span><span class="op" id="6567137">.</span><span class="ident" id="6567138">DeepEqual</span><span class="op" id="6567147">(</span><span class="ident" id="6567148">err</span><span class="op" id="6567151">,</span>&nbsp;<span class="ident" id="6567153">tt</span><span class="op" id="6567155">.</span><span class="ident" id="6567156">err</span><span class="op" id="6567159">)</span>&nbsp;<span class="op" id="6567161">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567167">t</span><span class="op" id="6567168">.</span><span class="ident" id="6567169">Errorf</span><span class="op" id="6567175">(</span><span class="string" id="6567176">&#34;#%d:&nbsp;Indent:&nbsp;%#v&#34;</span><span class="op" id="6567194">,</span>&nbsp;<span class="ident" id="6567196">i</span><span class="op" id="6567197">,</span>&nbsp;<span class="ident" id="6567199">err</span><span class="op" id="6567202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567208">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567227">}</span><br>
<span class="lineno">180</span><span class="op" id="6567229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6567232">func</span>&nbsp;<span class="ident" id="6567237">TestNextValueBig</span><span class="op" id="6567253">(</span><span class="ident" id="6567254">t</span>&nbsp;<span class="op" id="6567256">*</span><span class="ident" id="6567257">testing</span><span class="op" id="6567264">.</span><span class="ident" id="6567265">T</span><span class="op" id="6567266">)</span>&nbsp;<span class="op" id="6567268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567271">initBig</span><span class="op" id="6567278">(</span><span class="op" id="6567279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567282">var</span>&nbsp;<span class="ident" id="6567286">scan</span>&nbsp;<span class="ident" id="6567291">scanner</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567300">item</span><span class="op" id="6567304">,</span>&nbsp;<span class="ident" id="6567306">rest</span><span class="op" id="6567310">,</span>&nbsp;<span class="ident" id="6567312">err</span>&nbsp;<span class="op" id="6567316">:=</span>&nbsp;<span class="ident" id="6567319">nextValue</span><span class="op" id="6567328">(</span><span class="ident" id="6567329">jsonBig</span><span class="op" id="6567336">,</span>&nbsp;<span class="op" id="6567338">&amp;</span><span class="ident" id="6567339">scan</span><span class="op" id="6567343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567346">if</span>&nbsp;<span class="ident" id="6567349">err</span>&nbsp;<span class="op" id="6567353">!=</span>&nbsp;<span class="ident" id="6567356">nil</span>&nbsp;<span class="op" id="6567360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567364">t</span><span class="op" id="6567365">.</span><span class="ident" id="6567366">Fatalf</span><span class="op" id="6567372">(</span><span class="string" id="6567373">&#34;nextValue:&nbsp;%s&#34;</span><span class="op" id="6567388">,</span>&nbsp;<span class="ident" id="6567390">err</span><span class="op" id="6567393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567399">if</span>&nbsp;<span class="builtinfunc" id="6567402">len</span><span class="op" id="6567405">(</span><span class="ident" id="6567406">item</span><span class="op" id="6567410">)</span>&nbsp;<span class="op" id="6567412">!=</span>&nbsp;<span class="builtinfunc" id="6567415">len</span><span class="op" id="6567418">(</span><span class="ident" id="6567419">jsonBig</span><span class="op" id="6567426">)</span>&nbsp;<span class="op" id="6567428">||</span>&nbsp;<span class="op" id="6567431">&amp;</span><span class="ident" id="6567432">item</span><span class="op" id="6567436">[</span><span class="num" id="6567437">0</span><span class="op" id="6567438">]</span>&nbsp;<span class="op" id="6567440">!=</span>&nbsp;<span class="op" id="6567443">&amp;</span><span class="ident" id="6567444">jsonBig</span><span class="op" id="6567451">[</span><span class="num" id="6567452">0</span><span class="op" id="6567453">]</span>&nbsp;<span class="op" id="6567455">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567459">t</span><span class="op" id="6567460">.</span><span class="ident" id="6567461">Errorf</span><span class="op" id="6567467">(</span><span class="string" id="6567468">&#34;invalid&nbsp;item:&nbsp;%d&nbsp;%d&#34;</span><span class="op" id="6567489">,</span>&nbsp;<span class="builtinfunc" id="6567491">len</span><span class="op" id="6567494">(</span><span class="ident" id="6567495">item</span><span class="op" id="6567499">)</span><span class="op" id="6567500">,</span>&nbsp;<span class="builtinfunc" id="6567502">len</span><span class="op" id="6567505">(</span><span class="ident" id="6567506">jsonBig</span><span class="op" id="6567513">)</span><span class="op" id="6567514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567520">if</span>&nbsp;<span class="builtinfunc" id="6567523">len</span><span class="op" id="6567526">(</span><span class="ident" id="6567527">rest</span><span class="op" id="6567531">)</span>&nbsp;<span class="op" id="6567533">!=</span>&nbsp;<span class="num" id="6567536">0</span>&nbsp;<span class="op" id="6567538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567542">t</span><span class="op" id="6567543">.</span><span class="ident" id="6567544">Errorf</span><span class="op" id="6567550">(</span><span class="string" id="6567551">&#34;invalid&nbsp;rest:&nbsp;%d&#34;</span><span class="op" id="6567569">,</span>&nbsp;<span class="builtinfunc" id="6567571">len</span><span class="op" id="6567574">(</span><span class="ident" id="6567575">rest</span><span class="op" id="6567579">)</span><span class="op" id="6567580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567583">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567587">item</span><span class="op" id="6567591">,</span>&nbsp;<span class="ident" id="6567593">rest</span><span class="op" id="6567597">,</span>&nbsp;<span class="ident" id="6567599">err</span>&nbsp;<span class="op" id="6567603">=</span>&nbsp;<span class="ident" id="6567605">nextValue</span><span class="op" id="6567614">(</span><span class="builtinfunc" id="6567615">append</span><span class="op" id="6567621">(</span><span class="ident" id="6567622">jsonBig</span><span class="op" id="6567629">,</span>&nbsp;<span class="string" id="6567631">&#34;HELLO&nbsp;WORLD&#34;</span><span class="op" id="6567644">...</span><span class="op" id="6567647">)</span><span class="op" id="6567648">,</span>&nbsp;<span class="op" id="6567650">&amp;</span><span class="ident" id="6567651">scan</span><span class="op" id="6567655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567658">if</span>&nbsp;<span class="ident" id="6567661">err</span>&nbsp;<span class="op" id="6567665">!=</span>&nbsp;<span class="ident" id="6567668">nil</span>&nbsp;<span class="op" id="6567672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567676">t</span><span class="op" id="6567677">.</span><span class="ident" id="6567678">Fatalf</span><span class="op" id="6567684">(</span><span class="string" id="6567685">&#34;nextValue&nbsp;extra:&nbsp;%s&#34;</span><span class="op" id="6567706">,</span>&nbsp;<span class="ident" id="6567708">err</span><span class="op" id="6567711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567714">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567717">if</span>&nbsp;<span class="builtinfunc" id="6567720">len</span><span class="op" id="6567723">(</span><span class="ident" id="6567724">item</span><span class="op" id="6567728">)</span>&nbsp;<span class="op" id="6567730">!=</span>&nbsp;<span class="builtinfunc" id="6567733">len</span><span class="op" id="6567736">(</span><span class="ident" id="6567737">jsonBig</span><span class="op" id="6567744">)</span>&nbsp;<span class="op" id="6567746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567750">t</span><span class="op" id="6567751">.</span><span class="ident" id="6567752">Errorf</span><span class="op" id="6567758">(</span><span class="string" id="6567759">&#34;invalid&nbsp;item:&nbsp;%d&nbsp;%d&#34;</span><span class="op" id="6567780">,</span>&nbsp;<span class="builtinfunc" id="6567782">len</span><span class="op" id="6567785">(</span><span class="ident" id="6567786">item</span><span class="op" id="6567790">)</span><span class="op" id="6567791">,</span>&nbsp;<span class="builtinfunc" id="6567793">len</span><span class="op" id="6567796">(</span><span class="ident" id="6567797">jsonBig</span><span class="op" id="6567804">)</span><span class="op" id="6567805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567811">if</span>&nbsp;<span class="builtintype" id="6567814">string</span><span class="op" id="6567820">(</span><span class="ident" id="6567821">rest</span><span class="op" id="6567825">)</span>&nbsp;<span class="op" id="6567827">!=</span>&nbsp;<span class="string" id="6567830">&#34;HELLO&nbsp;WORLD&#34;</span>&nbsp;<span class="op" id="6567844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567848">t</span><span class="op" id="6567849">.</span><span class="ident" id="6567850">Errorf</span><span class="op" id="6567856">(</span><span class="string" id="6567857">&#34;invalid&nbsp;rest:&nbsp;%d&#34;</span><span class="op" id="6567875">,</span>&nbsp;<span class="builtinfunc" id="6567877">len</span><span class="op" id="6567880">(</span><span class="ident" id="6567881">rest</span><span class="op" id="6567885">)</span><span class="op" id="6567886">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567889">}</span><br>
<span class="lineno"></span><span class="op" id="6567891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6567894">var</span>&nbsp;<span class="ident" id="6567898">benchScan</span>&nbsp;<span class="ident" id="6567908">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="6567917">func</span>&nbsp;<span class="ident" id="6567922">BenchmarkSkipValue</span><span class="op" id="6567940">(</span><span class="ident" id="6567941">b</span>&nbsp;<span class="op" id="6567943">*</span><span class="ident" id="6567944">testing</span><span class="op" id="6567951">.</span><span class="ident" id="6567952">B</span><span class="op" id="6567953">)</span>&nbsp;<span class="op" id="6567955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567958">initBig</span><span class="op" id="6567965">(</span><span class="op" id="6567966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567969">for</span>&nbsp;<span class="ident" id="6567973">i</span>&nbsp;<span class="op" id="6567975">:=</span>&nbsp;<span class="num" id="6567978">0</span><span class="op" id="6567979">;</span>&nbsp;<span class="ident" id="6567981">i</span>&nbsp;<span class="op" id="6567983">&lt;</span>&nbsp;<span class="ident" id="6567985">b</span><span class="op" id="6567986">.</span><span class="ident" id="6567987">N</span><span class="op" id="6567988">;</span>&nbsp;<span class="ident" id="6567990">i</span><span class="op" id="6567991">++</span>&nbsp;<span class="op" id="6567994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567998">nextValue</span><span class="op" id="6568007">(</span><span class="ident" id="6568008">jsonBig</span><span class="op" id="6568015">,</span>&nbsp;<span class="op" id="6568017">&amp;</span><span class="ident" id="6568018">benchScan</span><span class="op" id="6568027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568030">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568033">b</span><span class="op" id="6568034">.</span><span class="ident" id="6568035">SetBytes</span><span class="op" id="6568043">(</span><span class="ident" id="6568044">int64</span><span class="op" id="6568049">(</span><span class="builtinfunc" id="6568050">len</span><span class="op" id="6568053">(</span><span class="ident" id="6568054">jsonBig</span><span class="op" id="6568061">)</span><span class="op" id="6568062">)</span><span class="op" id="6568063">)</span><br>
<span class="lineno"></span><span class="op" id="6568065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6568068">func</span>&nbsp;<span class="ident" id="6568073">diff</span><span class="op" id="6568077">(</span><span class="ident" id="6568078">t</span>&nbsp;<span class="op" id="6568080">*</span><span class="ident" id="6568081">testing</span><span class="op" id="6568088">.</span><span class="ident" id="6568089">T</span><span class="op" id="6568090">,</span>&nbsp;<span class="ident" id="6568092">a</span><span class="op" id="6568093">,</span>&nbsp;<span class="ident" id="6568095">b</span>&nbsp;<span class="op" id="6568097">[</span><span class="op" id="6568098">]</span><span class="builtintype" id="6568099">byte</span><span class="op" id="6568103">)</span>&nbsp;<span class="op" id="6568105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568108">for</span>&nbsp;<span class="ident" id="6568112">i</span>&nbsp;<span class="op" id="6568114">:=</span>&nbsp;<span class="num" id="6568117">0</span><span class="op" id="6568118">;</span>&nbsp;<span class="op" id="6568120">;</span>&nbsp;<span class="ident" id="6568122">i</span><span class="op" id="6568123">++</span>&nbsp;<span class="op" id="6568126">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568130">if</span>&nbsp;<span class="ident" id="6568133">i</span>&nbsp;<span class="op" id="6568135">&gt;=</span>&nbsp;<span class="builtinfunc" id="6568138">len</span><span class="op" id="6568141">(</span><span class="ident" id="6568142">a</span><span class="op" id="6568143">)</span>&nbsp;<span class="op" id="6568145">||</span>&nbsp;<span class="ident" id="6568148">i</span>&nbsp;<span class="op" id="6568150">&gt;=</span>&nbsp;<span class="builtinfunc" id="6568153">len</span><span class="op" id="6568156">(</span><span class="ident" id="6568157">b</span><span class="op" id="6568158">)</span>&nbsp;<span class="op" id="6568160">||</span>&nbsp;<span class="ident" id="6568163">a</span><span class="op" id="6568164">[</span><span class="ident" id="6568165">i</span><span class="op" id="6568166">]</span>&nbsp;<span class="op" id="6568168">!=</span>&nbsp;<span class="ident" id="6568171">b</span><span class="op" id="6568172">[</span><span class="ident" id="6568173">i</span><span class="op" id="6568174">]</span>&nbsp;<span class="op" id="6568176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568181">j</span>&nbsp;<span class="op" id="6568183">:=</span>&nbsp;<span class="ident" id="6568186">i</span>&nbsp;<span class="op" id="6568188">-</span>&nbsp;<span class="num" id="6568190">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568196">if</span>&nbsp;<span class="ident" id="6568199">j</span>&nbsp;<span class="op" id="6568201">&lt;</span>&nbsp;<span class="num" id="6568203">0</span>&nbsp;<span class="op" id="6568205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568211">j</span>&nbsp;<span class="op" id="6568213">=</span>&nbsp;<span class="num" id="6568215">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568220">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568225">t</span><span class="op" id="6568226">.</span><span class="ident" id="6568227">Errorf</span><span class="op" id="6568233">(</span><span class="string" id="6568234">&#34;diverge&nbsp;at&nbsp;%d:&nbsp;%s&nbsp;vs&nbsp;%s&#34;</span><span class="op" id="6568267">,</span>&nbsp;<span class="ident" id="6568269">i</span><span class="op" id="6568270">,</span>&nbsp;<span class="ident" id="6568272">trim</span><span class="op" id="6568276">(</span><span class="ident" id="6568277">a</span><span class="op" id="6568278">[</span><span class="ident" id="6568279">j</span><span class="op" id="6568280">:</span><span class="op" id="6568281">]</span><span class="op" id="6568282">)</span><span class="op" id="6568283">,</span>&nbsp;<span class="ident" id="6568285">trim</span><span class="op" id="6568289">(</span><span class="ident" id="6568290">b</span><span class="op" id="6568291">[</span><span class="ident" id="6568292">j</span><span class="op" id="6568293">:</span><span class="op" id="6568294">]</span><span class="op" id="6568295">)</span><span class="op" id="6568296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568301">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568313">}</span><br>
<span class="lineno"></span><span class="op" id="6568315">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="6568318">func</span>&nbsp;<span class="ident" id="6568323">trim</span><span class="op" id="6568327">(</span><span class="ident" id="6568328">b</span>&nbsp;<span class="op" id="6568330">[</span><span class="op" id="6568331">]</span><span class="builtintype" id="6568332">byte</span><span class="op" id="6568336">)</span>&nbsp;<span class="op" id="6568338">[</span><span class="op" id="6568339">]</span><span class="builtintype" id="6568340">byte</span>&nbsp;<span class="op" id="6568345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568348">if</span>&nbsp;<span class="builtinfunc" id="6568351">len</span><span class="op" id="6568354">(</span><span class="ident" id="6568355">b</span><span class="op" id="6568356">)</span>&nbsp;<span class="op" id="6568358">&gt;</span>&nbsp;<span class="num" id="6568360">20</span>&nbsp;<span class="op" id="6568363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568367">return</span>&nbsp;<span class="ident" id="6568374">b</span><span class="op" id="6568375">[</span><span class="num" id="6568376">0</span><span class="op" id="6568377">:</span><span class="num" id="6568378">20</span><span class="op" id="6568380">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568383">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568386">return</span>&nbsp;<span class="ident" id="6568393">b</span><br>
<span class="lineno"></span><span class="op" id="6568395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6568398">//&nbsp;Generate&nbsp;a&nbsp;random&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="6568433">var</span>&nbsp;<span class="ident" id="6568437">jsonBig</span>&nbsp;<span class="op" id="6568445">[</span><span class="op" id="6568446">]</span><span class="builtintype" id="6568447">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6568453">func</span>&nbsp;<span class="ident" id="6568458">initBig</span><span class="op" id="6568465">(</span><span class="op" id="6568466">)</span>&nbsp;<span class="op" id="6568468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568471">n</span>&nbsp;<span class="op" id="6568473">:=</span>&nbsp;<span class="num" id="6568476">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568483">if</span>&nbsp;<span class="ident" id="6568486">testing</span><span class="op" id="6568493">.</span><span class="ident" id="6568494">Short</span><span class="op" id="6568499">(</span><span class="op" id="6568500">)</span>&nbsp;<span class="op" id="6568502">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568506">n</span>&nbsp;<span class="op" id="6568508">=</span>&nbsp;<span class="num" id="6568510">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568518">b</span><span class="op" id="6568519">,</span>&nbsp;<span class="ident" id="6568521">err</span>&nbsp;<span class="op" id="6568525">:=</span>&nbsp;<span class="ident" id="6568528">Marshal</span><span class="op" id="6568535">(</span><span class="ident" id="6568536">genValue</span><span class="op" id="6568544">(</span><span class="ident" id="6568545">n</span><span class="op" id="6568546">)</span><span class="op" id="6568547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568550">if</span>&nbsp;<span class="ident" id="6568553">err</span>&nbsp;<span class="op" id="6568557">!=</span>&nbsp;<span class="ident" id="6568560">nil</span>&nbsp;<span class="op" id="6568564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6568568">panic</span><span class="op" id="6568573">(</span><span class="ident" id="6568574">err</span><span class="op" id="6568577">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568583">jsonBig</span>&nbsp;<span class="op" id="6568591">=</span>&nbsp;<span class="ident" id="6568593">b</span><br>
<span class="lineno"></span><span class="op" id="6568595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6568598">func</span>&nbsp;<span class="ident" id="6568603">genValue</span><span class="op" id="6568611">(</span><span class="ident" id="6568612">n</span>&nbsp;<span class="builtintype" id="6568614">int</span><span class="op" id="6568617">)</span>&nbsp;<span class="keyword" id="6568619">interface</span><span class="op" id="6568628">{</span><span class="op" id="6568629">}</span>&nbsp;<span class="op" id="6568631">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568634">if</span>&nbsp;<span class="ident" id="6568637">n</span>&nbsp;<span class="op" id="6568639">&gt;</span>&nbsp;<span class="num" id="6568641">1</span>&nbsp;<span class="op" id="6568643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568647">switch</span>&nbsp;<span class="ident" id="6568654">rand</span><span class="op" id="6568658">.</span><span class="ident" id="6568659">Intn</span><span class="op" id="6568663">(</span><span class="num" id="6568664">2</span><span class="op" id="6568665">)</span>&nbsp;<span class="op" id="6568667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568671">case</span>&nbsp;<span class="num" id="6568676">0</span><span class="op" id="6568677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568682">return</span>&nbsp;<span class="ident" id="6568689">genArray</span><span class="op" id="6568697">(</span><span class="ident" id="6568698">n</span><span class="op" id="6568699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568703">case</span>&nbsp;<span class="num" id="6568708">1</span><span class="op" id="6568709">:</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568714">return</span>&nbsp;<span class="ident" id="6568721">genMap</span><span class="op" id="6568727">(</span><span class="ident" id="6568728">n</span><span class="op" id="6568729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568739">switch</span>&nbsp;<span class="ident" id="6568746">rand</span><span class="op" id="6568750">.</span><span class="ident" id="6568751">Intn</span><span class="op" id="6568755">(</span><span class="num" id="6568756">3</span><span class="op" id="6568757">)</span>&nbsp;<span class="op" id="6568759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568762">case</span>&nbsp;<span class="num" id="6568767">0</span><span class="op" id="6568768">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568772">return</span>&nbsp;<span class="ident" id="6568779">rand</span><span class="op" id="6568783">.</span><span class="ident" id="6568784">Intn</span><span class="op" id="6568788">(</span><span class="num" id="6568789">2</span><span class="op" id="6568790">)</span>&nbsp;<span class="op" id="6568792">==</span>&nbsp;<span class="num" id="6568795">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568798">case</span>&nbsp;<span class="num" id="6568803">1</span><span class="op" id="6568804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568808">return</span>&nbsp;<span class="ident" id="6568815">rand</span><span class="op" id="6568819">.</span><span class="ident" id="6568820">NormFloat64</span><span class="op" id="6568831">(</span><span class="op" id="6568832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568835">case</span>&nbsp;<span class="num" id="6568840">2</span><span class="op" id="6568841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568845">return</span>&nbsp;<span class="ident" id="6568852">genString</span><span class="op" id="6568861">(</span><span class="num" id="6568862">30</span><span class="op" id="6568864">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6568870">panic</span><span class="op" id="6568875">(</span><span class="string" id="6568876">&#34;unreachable&#34;</span><span class="op" id="6568889">)</span><br>
<span class="lineno"></span><span class="op" id="6568891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6568894">func</span>&nbsp;<span class="ident" id="6568899">genString</span><span class="op" id="6568908">(</span><span class="ident" id="6568909">stddev</span>&nbsp;<span class="builtintype" id="6568916">float64</span><span class="op" id="6568923">)</span>&nbsp;<span class="builtintype" id="6568925">string</span>&nbsp;<span class="op" id="6568932">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568935">n</span>&nbsp;<span class="op" id="6568937">:=</span>&nbsp;<span class="builtintype" id="6568940">int</span><span class="op" id="6568943">(</span><span class="ident" id="6568944">math</span><span class="op" id="6568948">.</span><span class="ident" id="6568949">Abs</span><span class="op" id="6568952">(</span><span class="ident" id="6568953">rand</span><span class="op" id="6568957">.</span><span class="ident" id="6568958">NormFloat64</span><span class="op" id="6568969">(</span><span class="op" id="6568970">)</span><span class="op" id="6568971">*</span><span class="ident" id="6568972">stddev</span>&nbsp;<span class="op" id="6568979">+</span>&nbsp;<span class="ident" id="6568981">stddev</span><span class="op" id="6568987">/</span><span class="num" id="6568988">2</span><span class="op" id="6568989">)</span><span class="op" id="6568990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568993">c</span>&nbsp;<span class="op" id="6568995">:=</span>&nbsp;<span class="builtinfunc" id="6568998">make</span><span class="op" id="6569002">(</span><span class="op" id="6569003">[</span><span class="op" id="6569004">]</span><span class="builtintype" id="6569005">rune</span><span class="op" id="6569009">,</span>&nbsp;<span class="ident" id="6569011">n</span><span class="op" id="6569012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569015">for</span>&nbsp;<span class="ident" id="6569019">i</span>&nbsp;<span class="op" id="6569021">:=</span>&nbsp;<span class="keyword" id="6569024">range</span>&nbsp;<span class="ident" id="6569030">c</span>&nbsp;<span class="op" id="6569032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569036">f</span>&nbsp;<span class="op" id="6569038">:=</span>&nbsp;<span class="ident" id="6569041">math</span><span class="op" id="6569045">.</span><span class="ident" id="6569046">Abs</span><span class="op" id="6569049">(</span><span class="ident" id="6569050">rand</span><span class="op" id="6569054">.</span><span class="ident" id="6569055">NormFloat64</span><span class="op" id="6569066">(</span><span class="op" id="6569067">)</span><span class="op" id="6569068">*</span><span class="num" id="6569069">64</span>&nbsp;<span class="op" id="6569072">+</span>&nbsp;<span class="num" id="6569074">32</span><span class="op" id="6569076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569080">if</span>&nbsp;<span class="ident" id="6569083">f</span>&nbsp;<span class="op" id="6569085">&gt;</span>&nbsp;<span class="num" id="6569087">0x10ffff</span>&nbsp;<span class="op" id="6569096">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569101">f</span>&nbsp;<span class="op" id="6569103">=</span>&nbsp;<span class="num" id="6569105">0x10ffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569120">c</span><span class="op" id="6569121">[</span><span class="ident" id="6569122">i</span><span class="op" id="6569123">]</span>&nbsp;<span class="op" id="6569125">=</span>&nbsp;<span class="builtintype" id="6569127">rune</span><span class="op" id="6569131">(</span><span class="ident" id="6569132">f</span><span class="op" id="6569133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569139">return</span>&nbsp;<span class="builtintype" id="6569146">string</span><span class="op" id="6569152">(</span><span class="ident" id="6569153">c</span><span class="op" id="6569154">)</span><br>
<span class="lineno">285</span><span class="op" id="6569156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6569159">func</span>&nbsp;<span class="ident" id="6569164">genArray</span><span class="op" id="6569172">(</span><span class="ident" id="6569173">n</span>&nbsp;<span class="builtintype" id="6569175">int</span><span class="op" id="6569178">)</span>&nbsp;<span class="op" id="6569180">[</span><span class="op" id="6569181">]</span><span class="keyword" id="6569182">interface</span><span class="op" id="6569191">{</span><span class="op" id="6569192">}</span>&nbsp;<span class="op" id="6569194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569197">f</span>&nbsp;<span class="op" id="6569199">:=</span>&nbsp;<span class="builtintype" id="6569202">int</span><span class="op" id="6569205">(</span><span class="ident" id="6569206">math</span><span class="op" id="6569210">.</span><span class="ident" id="6569211">Abs</span><span class="op" id="6569214">(</span><span class="ident" id="6569215">rand</span><span class="op" id="6569219">.</span><span class="ident" id="6569220">NormFloat64</span><span class="op" id="6569231">(</span><span class="op" id="6569232">)</span><span class="op" id="6569233">)</span>&nbsp;<span class="op" id="6569235">*</span>&nbsp;<span class="ident" id="6569237">math</span><span class="op" id="6569241">.</span><span class="ident" id="6569242">Min</span><span class="op" id="6569245">(</span><span class="num" id="6569246">10</span><span class="op" id="6569248">,</span>&nbsp;<span class="builtintype" id="6569250">float64</span><span class="op" id="6569257">(</span><span class="ident" id="6569258">n</span><span class="op" id="6569259">/</span><span class="num" id="6569260">2</span><span class="op" id="6569261">)</span><span class="op" id="6569262">)</span><span class="op" id="6569263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569266">if</span>&nbsp;<span class="ident" id="6569269">f</span>&nbsp;<span class="op" id="6569271">&gt;</span>&nbsp;<span class="ident" id="6569273">n</span>&nbsp;<span class="op" id="6569275">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569279">f</span>&nbsp;<span class="op" id="6569281">=</span>&nbsp;<span class="ident" id="6569283">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569289">if</span>&nbsp;<span class="ident" id="6569292">f</span>&nbsp;<span class="op" id="6569294">&lt;</span>&nbsp;<span class="num" id="6569296">1</span>&nbsp;<span class="op" id="6569298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569302">f</span>&nbsp;<span class="op" id="6569304">=</span>&nbsp;<span class="num" id="6569306">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569309">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569312">x</span>&nbsp;<span class="op" id="6569314">:=</span>&nbsp;<span class="builtinfunc" id="6569317">make</span><span class="op" id="6569321">(</span><span class="op" id="6569322">[</span><span class="op" id="6569323">]</span><span class="keyword" id="6569324">interface</span><span class="op" id="6569333">{</span><span class="op" id="6569334">}</span><span class="op" id="6569335">,</span>&nbsp;<span class="ident" id="6569337">f</span><span class="op" id="6569338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569341">for</span>&nbsp;<span class="ident" id="6569345">i</span>&nbsp;<span class="op" id="6569347">:=</span>&nbsp;<span class="keyword" id="6569350">range</span>&nbsp;<span class="ident" id="6569356">x</span>&nbsp;<span class="op" id="6569358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569362">x</span><span class="op" id="6569363">[</span><span class="ident" id="6569364">i</span><span class="op" id="6569365">]</span>&nbsp;<span class="op" id="6569367">=</span>&nbsp;<span class="ident" id="6569369">genValue</span><span class="op" id="6569377">(</span><span class="op" id="6569378">(</span><span class="op" id="6569379">(</span><span class="ident" id="6569380">i</span><span class="op" id="6569381">+</span><span class="num" id="6569382">1</span><span class="op" id="6569383">)</span><span class="op" id="6569384">*</span><span class="ident" id="6569385">n</span><span class="op" id="6569386">)</span><span class="op" id="6569387">/</span><span class="ident" id="6569388">f</span>&nbsp;<span class="op" id="6569390">-</span>&nbsp;<span class="op" id="6569392">(</span><span class="ident" id="6569393">i</span><span class="op" id="6569394">*</span><span class="ident" id="6569395">n</span><span class="op" id="6569396">)</span><span class="op" id="6569397">/</span><span class="ident" id="6569398">f</span><span class="op" id="6569399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569405">return</span>&nbsp;<span class="ident" id="6569412">x</span><br>
<span class="lineno">300</span><span class="op" id="6569414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6569417">func</span>&nbsp;<span class="ident" id="6569422">genMap</span><span class="op" id="6569428">(</span><span class="ident" id="6569429">n</span>&nbsp;<span class="builtintype" id="6569431">int</span><span class="op" id="6569434">)</span>&nbsp;<span class="keyword" id="6569436">map</span><span class="op" id="6569439">[</span><span class="builtintype" id="6569440">string</span><span class="op" id="6569446">]</span><span class="keyword" id="6569447">interface</span><span class="op" id="6569456">{</span><span class="op" id="6569457">}</span>&nbsp;<span class="op" id="6569459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569462">f</span>&nbsp;<span class="op" id="6569464">:=</span>&nbsp;<span class="builtintype" id="6569467">int</span><span class="op" id="6569470">(</span><span class="ident" id="6569471">math</span><span class="op" id="6569475">.</span><span class="ident" id="6569476">Abs</span><span class="op" id="6569479">(</span><span class="ident" id="6569480">rand</span><span class="op" id="6569484">.</span><span class="ident" id="6569485">NormFloat64</span><span class="op" id="6569496">(</span><span class="op" id="6569497">)</span><span class="op" id="6569498">)</span>&nbsp;<span class="op" id="6569500">*</span>&nbsp;<span class="ident" id="6569502">math</span><span class="op" id="6569506">.</span><span class="ident" id="6569507">Min</span><span class="op" id="6569510">(</span><span class="num" id="6569511">10</span><span class="op" id="6569513">,</span>&nbsp;<span class="builtintype" id="6569515">float64</span><span class="op" id="6569522">(</span><span class="ident" id="6569523">n</span><span class="op" id="6569524">/</span><span class="num" id="6569525">2</span><span class="op" id="6569526">)</span><span class="op" id="6569527">)</span><span class="op" id="6569528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569531">if</span>&nbsp;<span class="ident" id="6569534">f</span>&nbsp;<span class="op" id="6569536">&gt;</span>&nbsp;<span class="ident" id="6569538">n</span>&nbsp;<span class="op" id="6569540">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569544">f</span>&nbsp;<span class="op" id="6569546">=</span>&nbsp;<span class="ident" id="6569548">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569554">if</span>&nbsp;<span class="ident" id="6569557">n</span>&nbsp;<span class="op" id="6569559">&gt;</span>&nbsp;<span class="num" id="6569561">0</span>&nbsp;<span class="op" id="6569563">&amp;&amp;</span>&nbsp;<span class="ident" id="6569566">f</span>&nbsp;<span class="op" id="6569568">==</span>&nbsp;<span class="num" id="6569571">0</span>&nbsp;<span class="op" id="6569573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569577">f</span>&nbsp;<span class="op" id="6569579">=</span>&nbsp;<span class="num" id="6569581">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569584">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569587">x</span>&nbsp;<span class="op" id="6569589">:=</span>&nbsp;<span class="builtinfunc" id="6569592">make</span><span class="op" id="6569596">(</span><span class="keyword" id="6569597">map</span><span class="op" id="6569600">[</span><span class="builtintype" id="6569601">string</span><span class="op" id="6569607">]</span><span class="keyword" id="6569608">interface</span><span class="op" id="6569617">{</span><span class="op" id="6569618">}</span><span class="op" id="6569619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569622">for</span>&nbsp;<span class="ident" id="6569626">i</span>&nbsp;<span class="op" id="6569628">:=</span>&nbsp;<span class="num" id="6569631">0</span><span class="op" id="6569632">;</span>&nbsp;<span class="ident" id="6569634">i</span>&nbsp;<span class="op" id="6569636">&lt;</span>&nbsp;<span class="ident" id="6569638">f</span><span class="op" id="6569639">;</span>&nbsp;<span class="ident" id="6569641">i</span><span class="op" id="6569642">++</span>&nbsp;<span class="op" id="6569645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569649">x</span><span class="op" id="6569650">[</span><span class="ident" id="6569651">genString</span><span class="op" id="6569660">(</span><span class="num" id="6569661">10</span><span class="op" id="6569663">)</span><span class="op" id="6569664">]</span>&nbsp;<span class="op" id="6569666">=</span>&nbsp;<span class="ident" id="6569668">genValue</span><span class="op" id="6569676">(</span><span class="op" id="6569677">(</span><span class="op" id="6569678">(</span><span class="ident" id="6569679">i</span><span class="op" id="6569680">+</span><span class="num" id="6569681">1</span><span class="op" id="6569682">)</span><span class="op" id="6569683">*</span><span class="ident" id="6569684">n</span><span class="op" id="6569685">)</span><span class="op" id="6569686">/</span><span class="ident" id="6569687">f</span>&nbsp;<span class="op" id="6569689">-</span>&nbsp;<span class="op" id="6569691">(</span><span class="ident" id="6569692">i</span><span class="op" id="6569693">*</span><span class="ident" id="6569694">n</span><span class="op" id="6569695">)</span><span class="op" id="6569696">/</span><span class="ident" id="6569697">f</span><span class="op" id="6569698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569704">return</span>&nbsp;<span class="ident" id="6569711">x</span><br>
<span class="lineno">315</span><span class="op" id="6569713">}</span>
</div>
</body>
</html>
