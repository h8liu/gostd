<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8063647">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8063702">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8063756">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8063807">package</span>&nbsp;<span class="ident" id="8063815">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8063820">import</span>&nbsp;<span class="op" id="8063827">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063830">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063839">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063848">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063866">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063876">_</span>&nbsp;<span class="string" id="8063878">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063892">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063907">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063922">_</span>&nbsp;<span class="string" id="8063924">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063941">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063957">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063969">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063975">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063986">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8063997">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8064007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8064010">func</span>&nbsp;<span class="ident" id="8064015">TestEMSAPSS</span><span class="op" id="8064026">(</span><span class="ident" id="8064027">t</span>&nbsp;<span class="op" id="8064029">*</span><span class="ident" id="8064030">testing</span><span class="op" id="8064037">.</span><span class="ident" id="8064038">T</span><span class="op" id="8064039">)</span>&nbsp;<span class="op" id="8064041">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8064044">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8064147">msg</span>&nbsp;<span class="op" id="8064151">:=</span>&nbsp;<span class="op" id="8064154">[</span><span class="op" id="8064155">]</span><span class="builtintype" id="8064156">byte</span><span class="op" id="8064160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064164">0x85</span><span class="op" id="8064168">,</span>&nbsp;<span class="num" id="8064170">0x9e</span><span class="op" id="8064174">,</span>&nbsp;<span class="num" id="8064176">0xef</span><span class="op" id="8064180">,</span>&nbsp;<span class="num" id="8064182">0x2f</span><span class="op" id="8064186">,</span>&nbsp;<span class="num" id="8064188">0xd7</span><span class="op" id="8064192">,</span>&nbsp;<span class="num" id="8064194">0x8a</span><span class="op" id="8064198">,</span>&nbsp;<span class="num" id="8064200">0xca</span><span class="op" id="8064204">,</span>&nbsp;<span class="num" id="8064206">0x00</span><span class="op" id="8064210">,</span>&nbsp;<span class="num" id="8064212">0x30</span><span class="op" id="8064216">,</span>&nbsp;<span class="num" id="8064218">0x8b</span><span class="op" id="8064222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064226">0xdc</span><span class="op" id="8064230">,</span>&nbsp;<span class="num" id="8064232">0x47</span><span class="op" id="8064236">,</span>&nbsp;<span class="num" id="8064238">0x11</span><span class="op" id="8064242">,</span>&nbsp;<span class="num" id="8064244">0x93</span><span class="op" id="8064248">,</span>&nbsp;<span class="num" id="8064250">0xbf</span><span class="op" id="8064254">,</span>&nbsp;<span class="num" id="8064256">0x55</span><span class="op" id="8064260">,</span>&nbsp;<span class="num" id="8064262">0xbf</span><span class="op" id="8064266">,</span>&nbsp;<span class="num" id="8064268">0x9d</span><span class="op" id="8064272">,</span>&nbsp;<span class="num" id="8064274">0x78</span><span class="op" id="8064278">,</span>&nbsp;<span class="num" id="8064280">0xdb</span><span class="op" id="8064284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064288">0x8f</span><span class="op" id="8064292">,</span>&nbsp;<span class="num" id="8064294">0x8a</span><span class="op" id="8064298">,</span>&nbsp;<span class="num" id="8064300">0x67</span><span class="op" id="8064304">,</span>&nbsp;<span class="num" id="8064306">0x2b</span><span class="op" id="8064310">,</span>&nbsp;<span class="num" id="8064312">0x48</span><span class="op" id="8064316">,</span>&nbsp;<span class="num" id="8064318">0x46</span><span class="op" id="8064322">,</span>&nbsp;<span class="num" id="8064324">0x34</span><span class="op" id="8064328">,</span>&nbsp;<span class="num" id="8064330">0xf3</span><span class="op" id="8064334">,</span>&nbsp;<span class="num" id="8064336">0xc9</span><span class="op" id="8064340">,</span>&nbsp;<span class="num" id="8064342">0xc2</span><span class="op" id="8064346">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064350">0x6e</span><span class="op" id="8064354">,</span>&nbsp;<span class="num" id="8064356">0x64</span><span class="op" id="8064360">,</span>&nbsp;<span class="num" id="8064362">0x78</span><span class="op" id="8064366">,</span>&nbsp;<span class="num" id="8064368">0xae</span><span class="op" id="8064372">,</span>&nbsp;<span class="num" id="8064374">0x10</span><span class="op" id="8064378">,</span>&nbsp;<span class="num" id="8064380">0x26</span><span class="op" id="8064384">,</span>&nbsp;<span class="num" id="8064386">0x0f</span><span class="op" id="8064390">,</span>&nbsp;<span class="num" id="8064392">0xe0</span><span class="op" id="8064396">,</span>&nbsp;<span class="num" id="8064398">0xdd</span><span class="op" id="8064402">,</span>&nbsp;<span class="num" id="8064404">0x8c</span><span class="op" id="8064408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064412">0x08</span><span class="op" id="8064416">,</span>&nbsp;<span class="num" id="8064418">0x2e</span><span class="op" id="8064422">,</span>&nbsp;<span class="num" id="8064424">0x53</span><span class="op" id="8064428">,</span>&nbsp;<span class="num" id="8064430">0xa5</span><span class="op" id="8064434">,</span>&nbsp;<span class="num" id="8064436">0x29</span><span class="op" id="8064440">,</span>&nbsp;<span class="num" id="8064442">0x3a</span><span class="op" id="8064446">,</span>&nbsp;<span class="num" id="8064448">0xf2</span><span class="op" id="8064452">,</span>&nbsp;<span class="num" id="8064454">0x17</span><span class="op" id="8064458">,</span>&nbsp;<span class="num" id="8064460">0x3c</span><span class="op" id="8064464">,</span>&nbsp;<span class="num" id="8064466">0xd5</span><span class="op" id="8064470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064474">0x0c</span><span class="op" id="8064478">,</span>&nbsp;<span class="num" id="8064480">0x6d</span><span class="op" id="8064484">,</span>&nbsp;<span class="num" id="8064486">0x5d</span><span class="op" id="8064490">,</span>&nbsp;<span class="num" id="8064492">0x35</span><span class="op" id="8064496">,</span>&nbsp;<span class="num" id="8064498">0x4f</span><span class="op" id="8064502">,</span>&nbsp;<span class="num" id="8064504">0xeb</span><span class="op" id="8064508">,</span>&nbsp;<span class="num" id="8064510">0xf7</span><span class="op" id="8064514">,</span>&nbsp;<span class="num" id="8064516">0x8b</span><span class="op" id="8064520">,</span>&nbsp;<span class="num" id="8064522">0x26</span><span class="op" id="8064526">,</span>&nbsp;<span class="num" id="8064528">0x02</span><span class="op" id="8064532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064536">0x1c</span><span class="op" id="8064540">,</span>&nbsp;<span class="num" id="8064542">0x25</span><span class="op" id="8064546">,</span>&nbsp;<span class="num" id="8064548">0xc0</span><span class="op" id="8064552">,</span>&nbsp;<span class="num" id="8064554">0x27</span><span class="op" id="8064558">,</span>&nbsp;<span class="num" id="8064560">0x12</span><span class="op" id="8064564">,</span>&nbsp;<span class="num" id="8064566">0xe7</span><span class="op" id="8064570">,</span>&nbsp;<span class="num" id="8064572">0x8c</span><span class="op" id="8064576">,</span>&nbsp;<span class="num" id="8064578">0xd4</span><span class="op" id="8064582">,</span>&nbsp;<span class="num" id="8064584">0x69</span><span class="op" id="8064588">,</span>&nbsp;<span class="num" id="8064590">0x4c</span><span class="op" id="8064594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064598">0x9f</span><span class="op" id="8064602">,</span>&nbsp;<span class="num" id="8064604">0x46</span><span class="op" id="8064608">,</span>&nbsp;<span class="num" id="8064610">0x97</span><span class="op" id="8064614">,</span>&nbsp;<span class="num" id="8064616">0x77</span><span class="op" id="8064620">,</span>&nbsp;<span class="num" id="8064622">0xe4</span><span class="op" id="8064626">,</span>&nbsp;<span class="num" id="8064628">0x51</span><span class="op" id="8064632">,</span>&nbsp;<span class="num" id="8064634">0xe7</span><span class="op" id="8064638">,</span>&nbsp;<span class="num" id="8064640">0xf8</span><span class="op" id="8064644">,</span>&nbsp;<span class="num" id="8064646">0xe9</span><span class="op" id="8064650">,</span>&nbsp;<span class="num" id="8064652">0xe0</span><span class="op" id="8064656">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064660">0x4c</span><span class="op" id="8064664">,</span>&nbsp;<span class="num" id="8064666">0xd3</span><span class="op" id="8064670">,</span>&nbsp;<span class="num" id="8064672">0x73</span><span class="op" id="8064676">,</span>&nbsp;<span class="num" id="8064678">0x9c</span><span class="op" id="8064682">,</span>&nbsp;<span class="num" id="8064684">0x6b</span><span class="op" id="8064688">,</span>&nbsp;<span class="num" id="8064690">0xbf</span><span class="op" id="8064694">,</span>&nbsp;<span class="num" id="8064696">0xed</span><span class="op" id="8064700">,</span>&nbsp;<span class="num" id="8064702">0xae</span><span class="op" id="8064706">,</span>&nbsp;<span class="num" id="8064708">0x48</span><span class="op" id="8064712">,</span>&nbsp;<span class="num" id="8064714">0x7f</span><span class="op" id="8064718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064722">0xb5</span><span class="op" id="8064726">,</span>&nbsp;<span class="num" id="8064728">0x56</span><span class="op" id="8064732">,</span>&nbsp;<span class="num" id="8064734">0x44</span><span class="op" id="8064738">,</span>&nbsp;<span class="num" id="8064740">0xe9</span><span class="op" id="8064744">,</span>&nbsp;<span class="num" id="8064746">0xca</span><span class="op" id="8064750">,</span>&nbsp;<span class="num" id="8064752">0x74</span><span class="op" id="8064756">,</span>&nbsp;<span class="num" id="8064758">0xff</span><span class="op" id="8064762">,</span>&nbsp;<span class="num" id="8064764">0x77</span><span class="op" id="8064768">,</span>&nbsp;<span class="num" id="8064770">0xa5</span><span class="op" id="8064774">,</span>&nbsp;<span class="num" id="8064776">0x3c</span><span class="op" id="8064780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064784">0xb7</span><span class="op" id="8064788">,</span>&nbsp;<span class="num" id="8064790">0x29</span><span class="op" id="8064794">,</span>&nbsp;<span class="num" id="8064796">0x80</span><span class="op" id="8064800">,</span>&nbsp;<span class="num" id="8064802">0x2f</span><span class="op" id="8064806">,</span>&nbsp;<span class="num" id="8064808">0x6e</span><span class="op" id="8064812">,</span>&nbsp;<span class="num" id="8064814">0xd4</span><span class="op" id="8064818">,</span>&nbsp;<span class="num" id="8064820">0xa5</span><span class="op" id="8064824">,</span>&nbsp;<span class="num" id="8064826">0xff</span><span class="op" id="8064830">,</span>&nbsp;<span class="num" id="8064832">0xa8</span><span class="op" id="8064836">,</span>&nbsp;<span class="num" id="8064838">0xba</span><span class="op" id="8064842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064846">0x15</span><span class="op" id="8064850">,</span>&nbsp;<span class="num" id="8064852">0x98</span><span class="op" id="8064856">,</span>&nbsp;<span class="num" id="8064858">0x90</span><span class="op" id="8064862">,</span>&nbsp;<span class="num" id="8064864">0xfc</span><span class="op" id="8064868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8064871">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8064874">salt</span>&nbsp;<span class="op" id="8064879">:=</span>&nbsp;<span class="op" id="8064882">[</span><span class="op" id="8064883">]</span><span class="builtintype" id="8064884">byte</span><span class="op" id="8064888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064892">0xe3</span><span class="op" id="8064896">,</span>&nbsp;<span class="num" id="8064898">0xb5</span><span class="op" id="8064902">,</span>&nbsp;<span class="num" id="8064904">0xd5</span><span class="op" id="8064908">,</span>&nbsp;<span class="num" id="8064910">0xd0</span><span class="op" id="8064914">,</span>&nbsp;<span class="num" id="8064916">0x02</span><span class="op" id="8064920">,</span>&nbsp;<span class="num" id="8064922">0xc1</span><span class="op" id="8064926">,</span>&nbsp;<span class="num" id="8064928">0xbc</span><span class="op" id="8064932">,</span>&nbsp;<span class="num" id="8064934">0xe5</span><span class="op" id="8064938">,</span>&nbsp;<span class="num" id="8064940">0x0c</span><span class="op" id="8064944">,</span>&nbsp;<span class="num" id="8064946">0x2b</span><span class="op" id="8064950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8064954">0x65</span><span class="op" id="8064958">,</span>&nbsp;<span class="num" id="8064960">0xef</span><span class="op" id="8064964">,</span>&nbsp;<span class="num" id="8064966">0x88</span><span class="op" id="8064970">,</span>&nbsp;<span class="num" id="8064972">0xa1</span><span class="op" id="8064976">,</span>&nbsp;<span class="num" id="8064978">0x88</span><span class="op" id="8064982">,</span>&nbsp;<span class="num" id="8064984">0xd8</span><span class="op" id="8064988">,</span>&nbsp;<span class="num" id="8064990">0x3b</span><span class="op" id="8064994">,</span>&nbsp;<span class="num" id="8064996">0xce</span><span class="op" id="8065000">,</span>&nbsp;<span class="num" id="8065002">0x7e</span><span class="op" id="8065006">,</span>&nbsp;<span class="num" id="8065008">0x61</span><span class="op" id="8065012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8065015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8065018">expected</span>&nbsp;<span class="op" id="8065027">:=</span>&nbsp;<span class="op" id="8065030">[</span><span class="op" id="8065031">]</span><span class="builtintype" id="8065032">byte</span><span class="op" id="8065036">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065040">0x66</span><span class="op" id="8065044">,</span>&nbsp;<span class="num" id="8065046">0xe4</span><span class="op" id="8065050">,</span>&nbsp;<span class="num" id="8065052">0x67</span><span class="op" id="8065056">,</span>&nbsp;<span class="num" id="8065058">0x2e</span><span class="op" id="8065062">,</span>&nbsp;<span class="num" id="8065064">0x83</span><span class="op" id="8065068">,</span>&nbsp;<span class="num" id="8065070">0x6a</span><span class="op" id="8065074">,</span>&nbsp;<span class="num" id="8065076">0xd1</span><span class="op" id="8065080">,</span>&nbsp;<span class="num" id="8065082">0x21</span><span class="op" id="8065086">,</span>&nbsp;<span class="num" id="8065088">0xba</span><span class="op" id="8065092">,</span>&nbsp;<span class="num" id="8065094">0x24</span><span class="op" id="8065098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065102">0x4b</span><span class="op" id="8065106">,</span>&nbsp;<span class="num" id="8065108">0xed</span><span class="op" id="8065112">,</span>&nbsp;<span class="num" id="8065114">0x65</span><span class="op" id="8065118">,</span>&nbsp;<span class="num" id="8065120">0x76</span><span class="op" id="8065124">,</span>&nbsp;<span class="num" id="8065126">0xb8</span><span class="op" id="8065130">,</span>&nbsp;<span class="num" id="8065132">0x67</span><span class="op" id="8065136">,</span>&nbsp;<span class="num" id="8065138">0xd9</span><span class="op" id="8065142">,</span>&nbsp;<span class="num" id="8065144">0xa4</span><span class="op" id="8065148">,</span>&nbsp;<span class="num" id="8065150">0x47</span><span class="op" id="8065154">,</span>&nbsp;<span class="num" id="8065156">0xc2</span><span class="op" id="8065160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065164">0x8a</span><span class="op" id="8065168">,</span>&nbsp;<span class="num" id="8065170">0x6e</span><span class="op" id="8065174">,</span>&nbsp;<span class="num" id="8065176">0x66</span><span class="op" id="8065180">,</span>&nbsp;<span class="num" id="8065182">0xa5</span><span class="op" id="8065186">,</span>&nbsp;<span class="num" id="8065188">0xb8</span><span class="op" id="8065192">,</span>&nbsp;<span class="num" id="8065194">0x7d</span><span class="op" id="8065198">,</span>&nbsp;<span class="num" id="8065200">0xee</span><span class="op" id="8065204">,</span>&nbsp;<span class="num" id="8065206">0x7f</span><span class="op" id="8065210">,</span>&nbsp;<span class="num" id="8065212">0xbc</span><span class="op" id="8065216">,</span>&nbsp;<span class="num" id="8065218">0x7e</span><span class="op" id="8065222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065226">0x65</span><span class="op" id="8065230">,</span>&nbsp;<span class="num" id="8065232">0xaf</span><span class="op" id="8065236">,</span>&nbsp;<span class="num" id="8065238">0x50</span><span class="op" id="8065242">,</span>&nbsp;<span class="num" id="8065244">0x57</span><span class="op" id="8065248">,</span>&nbsp;<span class="num" id="8065250">0xf8</span><span class="op" id="8065254">,</span>&nbsp;<span class="num" id="8065256">0x6f</span><span class="op" id="8065260">,</span>&nbsp;<span class="num" id="8065262">0xae</span><span class="op" id="8065266">,</span>&nbsp;<span class="num" id="8065268">0x89</span><span class="op" id="8065272">,</span>&nbsp;<span class="num" id="8065274">0x84</span><span class="op" id="8065278">,</span>&nbsp;<span class="num" id="8065280">0xd9</span><span class="op" id="8065284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065288">0xba</span><span class="op" id="8065292">,</span>&nbsp;<span class="num" id="8065294">0x7f</span><span class="op" id="8065298">,</span>&nbsp;<span class="num" id="8065300">0x96</span><span class="op" id="8065304">,</span>&nbsp;<span class="num" id="8065306">0x9a</span><span class="op" id="8065310">,</span>&nbsp;<span class="num" id="8065312">0xd6</span><span class="op" id="8065316">,</span>&nbsp;<span class="num" id="8065318">0xfe</span><span class="op" id="8065322">,</span>&nbsp;<span class="num" id="8065324">0x02</span><span class="op" id="8065328">,</span>&nbsp;<span class="num" id="8065330">0xa4</span><span class="op" id="8065334">,</span>&nbsp;<span class="num" id="8065336">0xd7</span><span class="op" id="8065340">,</span>&nbsp;<span class="num" id="8065342">0x5f</span><span class="op" id="8065346">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065350">0x74</span><span class="op" id="8065354">,</span>&nbsp;<span class="num" id="8065356">0x45</span><span class="op" id="8065360">,</span>&nbsp;<span class="num" id="8065362">0xfe</span><span class="op" id="8065366">,</span>&nbsp;<span class="num" id="8065368">0xfd</span><span class="op" id="8065372">,</span>&nbsp;<span class="num" id="8065374">0xd8</span><span class="op" id="8065378">,</span>&nbsp;<span class="num" id="8065380">0x5b</span><span class="op" id="8065384">,</span>&nbsp;<span class="num" id="8065386">0x6d</span><span class="op" id="8065390">,</span>&nbsp;<span class="num" id="8065392">0x3a</span><span class="op" id="8065396">,</span>&nbsp;<span class="num" id="8065398">0x47</span><span class="op" id="8065402">,</span>&nbsp;<span class="num" id="8065404">0x7c</span><span class="op" id="8065408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065412">0x28</span><span class="op" id="8065416">,</span>&nbsp;<span class="num" id="8065418">0xd2</span><span class="op" id="8065422">,</span>&nbsp;<span class="num" id="8065424">0x4b</span><span class="op" id="8065428">,</span>&nbsp;<span class="num" id="8065430">0xa1</span><span class="op" id="8065434">,</span>&nbsp;<span class="num" id="8065436">0xe3</span><span class="op" id="8065440">,</span>&nbsp;<span class="num" id="8065442">0x75</span><span class="op" id="8065446">,</span>&nbsp;<span class="num" id="8065448">0x6f</span><span class="op" id="8065452">,</span>&nbsp;<span class="num" id="8065454">0x79</span><span class="op" id="8065458">,</span>&nbsp;<span class="num" id="8065460">0x2d</span><span class="op" id="8065464">,</span>&nbsp;<span class="num" id="8065466">0xd1</span><span class="op" id="8065470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065474">0xdc</span><span class="op" id="8065478">,</span>&nbsp;<span class="num" id="8065480">0xe8</span><span class="op" id="8065484">,</span>&nbsp;<span class="num" id="8065486">0xca</span><span class="op" id="8065490">,</span>&nbsp;<span class="num" id="8065492">0x94</span><span class="op" id="8065496">,</span>&nbsp;<span class="num" id="8065498">0x44</span><span class="op" id="8065502">,</span>&nbsp;<span class="num" id="8065504">0x0e</span><span class="op" id="8065508">,</span>&nbsp;<span class="num" id="8065510">0xcb</span><span class="op" id="8065514">,</span>&nbsp;<span class="num" id="8065516">0x52</span><span class="op" id="8065520">,</span>&nbsp;<span class="num" id="8065522">0x79</span><span class="op" id="8065526">,</span>&nbsp;<span class="num" id="8065528">0xec</span><span class="op" id="8065532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065536">0xd3</span><span class="op" id="8065540">,</span>&nbsp;<span class="num" id="8065542">0x18</span><span class="op" id="8065546">,</span>&nbsp;<span class="num" id="8065548">0x3a</span><span class="op" id="8065552">,</span>&nbsp;<span class="num" id="8065554">0x31</span><span class="op" id="8065558">,</span>&nbsp;<span class="num" id="8065560">0x1f</span><span class="op" id="8065564">,</span>&nbsp;<span class="num" id="8065566">0xc8</span><span class="op" id="8065570">,</span>&nbsp;<span class="num" id="8065572">0x96</span><span class="op" id="8065576">,</span>&nbsp;<span class="num" id="8065578">0xda</span><span class="op" id="8065582">,</span>&nbsp;<span class="num" id="8065584">0x1c</span><span class="op" id="8065588">,</span>&nbsp;<span class="num" id="8065590">0xb3</span><span class="op" id="8065594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065598">0x93</span><span class="op" id="8065602">,</span>&nbsp;<span class="num" id="8065604">0x11</span><span class="op" id="8065608">,</span>&nbsp;<span class="num" id="8065610">0xaf</span><span class="op" id="8065614">,</span>&nbsp;<span class="num" id="8065616">0x37</span><span class="op" id="8065620">,</span>&nbsp;<span class="num" id="8065622">0xea</span><span class="op" id="8065626">,</span>&nbsp;<span class="num" id="8065628">0x4a</span><span class="op" id="8065632">,</span>&nbsp;<span class="num" id="8065634">0x75</span><span class="op" id="8065638">,</span>&nbsp;<span class="num" id="8065640">0xe2</span><span class="op" id="8065644">,</span>&nbsp;<span class="num" id="8065646">0x4b</span><span class="op" id="8065650">,</span>&nbsp;<span class="num" id="8065652">0xdb</span><span class="op" id="8065656">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065660">0xfd</span><span class="op" id="8065664">,</span>&nbsp;<span class="num" id="8065666">0x5c</span><span class="op" id="8065670">,</span>&nbsp;<span class="num" id="8065672">0x1d</span><span class="op" id="8065676">,</span>&nbsp;<span class="num" id="8065678">0xa0</span><span class="op" id="8065682">,</span>&nbsp;<span class="num" id="8065684">0xde</span><span class="op" id="8065688">,</span>&nbsp;<span class="num" id="8065690">0x7c</span><span class="op" id="8065694">,</span>&nbsp;<span class="num" id="8065696">0xec</span><span class="op" id="8065700">,</span>&nbsp;<span class="num" id="8065702">0xdf</span><span class="op" id="8065706">,</span>&nbsp;<span class="num" id="8065708">0x1a</span><span class="op" id="8065712">,</span>&nbsp;<span class="num" id="8065714">0x89</span><span class="op" id="8065718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065722">0x6f</span><span class="op" id="8065726">,</span>&nbsp;<span class="num" id="8065728">0x9d</span><span class="op" id="8065732">,</span>&nbsp;<span class="num" id="8065734">0x8b</span><span class="op" id="8065738">,</span>&nbsp;<span class="num" id="8065740">0xc8</span><span class="op" id="8065744">,</span>&nbsp;<span class="num" id="8065746">0x16</span><span class="op" id="8065750">,</span>&nbsp;<span class="num" id="8065752">0xd9</span><span class="op" id="8065756">,</span>&nbsp;<span class="num" id="8065758">0x7c</span><span class="op" id="8065762">,</span>&nbsp;<span class="num" id="8065764">0xd7</span><span class="op" id="8065768">,</span>&nbsp;<span class="num" id="8065770">0xa2</span><span class="op" id="8065774">,</span>&nbsp;<span class="num" id="8065776">0xc4</span><span class="op" id="8065780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8065784">0x3b</span><span class="op" id="8065788">,</span>&nbsp;<span class="num" id="8065790">0xad</span><span class="op" id="8065794">,</span>&nbsp;<span class="num" id="8065796">0x54</span><span class="op" id="8065800">,</span>&nbsp;<span class="num" id="8065802">0x6f</span><span class="op" id="8065806">,</span>&nbsp;<span class="num" id="8065808">0xbe</span><span class="op" id="8065812">,</span>&nbsp;<span class="num" id="8065814">0x8c</span><span class="op" id="8065818">,</span>&nbsp;<span class="num" id="8065820">0xfe</span><span class="op" id="8065824">,</span>&nbsp;<span class="num" id="8065826">0xbc</span><span class="op" id="8065830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8065833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8065837">hash</span>&nbsp;<span class="op" id="8065842">:=</span>&nbsp;<span class="ident" id="8065845">sha1</span><span class="op" id="8065849">.</span><span class="ident" id="8065850">New</span><span class="op" id="8065853">(</span><span class="op" id="8065854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8065857">hash</span><span class="op" id="8065861">.</span><span class="ident" id="8065862">Write</span><span class="op" id="8065867">(</span><span class="ident" id="8065868">msg</span><span class="op" id="8065871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8065874">hashed</span>&nbsp;<span class="op" id="8065881">:=</span>&nbsp;<span class="ident" id="8065884">hash</span><span class="op" id="8065888">.</span><span class="ident" id="8065889">Sum</span><span class="op" id="8065892">(</span><span class="ident" id="8065893">nil</span><span class="op" id="8065896">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8065900">encoded</span><span class="op" id="8065907">,</span>&nbsp;<span class="ident" id="8065909">err</span>&nbsp;<span class="op" id="8065913">:=</span>&nbsp;<span class="ident" id="8065916">emsaPSSEncode</span><span class="op" id="8065929">(</span><span class="ident" id="8065930">hashed</span><span class="op" id="8065936">,</span>&nbsp;<span class="num" id="8065938">1023</span><span class="op" id="8065942">,</span>&nbsp;<span class="ident" id="8065944">salt</span><span class="op" id="8065948">,</span>&nbsp;<span class="ident" id="8065950">sha1</span><span class="op" id="8065954">.</span><span class="ident" id="8065955">New</span><span class="op" id="8065958">(</span><span class="op" id="8065959">)</span><span class="op" id="8065960">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8065963">if</span>&nbsp;<span class="ident" id="8065966">err</span>&nbsp;<span class="op" id="8065970">!=</span>&nbsp;<span class="ident" id="8065973">nil</span>&nbsp;<span class="op" id="8065977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8065981">t</span><span class="op" id="8065982">.</span><span class="ident" id="8065983">Errorf</span><span class="op" id="8065989">(</span><span class="string" id="8065990">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="8066022">,</span>&nbsp;<span class="ident" id="8066024">err</span><span class="op" id="8066027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8066030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8066033">if</span>&nbsp;<span class="op" id="8066036">!</span><span class="ident" id="8066037">bytes</span><span class="op" id="8066042">.</span><span class="ident" id="8066043">Equal</span><span class="op" id="8066048">(</span><span class="ident" id="8066049">encoded</span><span class="op" id="8066056">,</span>&nbsp;<span class="ident" id="8066058">expected</span><span class="op" id="8066066">)</span>&nbsp;<span class="op" id="8066068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8066072">t</span><span class="op" id="8066073">.</span><span class="ident" id="8066074">Errorf</span><span class="op" id="8066080">(</span><span class="string" id="8066081">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8066112">,</span>&nbsp;<span class="ident" id="8066114">encoded</span><span class="op" id="8066121">,</span>&nbsp;<span class="ident" id="8066123">expected</span><span class="op" id="8066131">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8066134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8066138">if</span>&nbsp;<span class="ident" id="8066141">err</span>&nbsp;<span class="op" id="8066145">=</span>&nbsp;<span class="ident" id="8066147">emsaPSSVerify</span><span class="op" id="8066160">(</span><span class="ident" id="8066161">hashed</span><span class="op" id="8066167">,</span>&nbsp;<span class="ident" id="8066169">encoded</span><span class="op" id="8066176">,</span>&nbsp;<span class="num" id="8066178">1023</span><span class="op" id="8066182">,</span>&nbsp;<span class="builtinfunc" id="8066184">len</span><span class="op" id="8066187">(</span><span class="ident" id="8066188">salt</span><span class="op" id="8066192">)</span><span class="op" id="8066193">,</span>&nbsp;<span class="ident" id="8066195">sha1</span><span class="op" id="8066199">.</span><span class="ident" id="8066200">New</span><span class="op" id="8066203">(</span><span class="op" id="8066204">)</span><span class="op" id="8066205">)</span><span class="op" id="8066206">;</span>&nbsp;<span class="ident" id="8066208">err</span>&nbsp;<span class="op" id="8066212">!=</span>&nbsp;<span class="ident" id="8066215">nil</span>&nbsp;<span class="op" id="8066219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8066223">t</span><span class="op" id="8066224">.</span><span class="ident" id="8066225">Errorf</span><span class="op" id="8066231">(</span><span class="string" id="8066232">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="8066254">,</span>&nbsp;<span class="ident" id="8066256">err</span><span class="op" id="8066259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8066262">}</span><br>
<span class="lineno">75</span><span class="op" id="8066264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8066267">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="8066332">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="8066396">func</span>&nbsp;<span class="ident" id="8066401">TestPSSGolden</span><span class="op" id="8066414">(</span><span class="ident" id="8066415">t</span>&nbsp;<span class="op" id="8066417">*</span><span class="ident" id="8066418">testing</span><span class="op" id="8066425">.</span><span class="ident" id="8066426">T</span><span class="op" id="8066427">)</span>&nbsp;<span class="op" id="8066429">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8066432">inFile</span><span class="op" id="8066438">,</span>&nbsp;<span class="ident" id="8066440">err</span>&nbsp;<span class="op" id="8066444">:=</span>&nbsp;<span class="ident" id="8066447">os</span><span class="op" id="8066449">.</span><span class="ident" id="8066450">Open</span><span class="op" id="8066454">(</span><span class="string" id="8066455">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="8066482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8066485">if</span>&nbsp;<span class="ident" id="8066488">err</span>&nbsp;<span class="op" id="8066492">!=</span>&nbsp;<span class="ident" id="8066495">nil</span>&nbsp;<span class="op" id="8066499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8066503">t</span><span class="op" id="8066504">.</span><span class="ident" id="8066505">Fatalf</span><span class="op" id="8066511">(</span><span class="string" id="8066512">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="8066543">,</span>&nbsp;<span class="ident" id="8066545">err</span><span class="op" id="8066548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8066551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8066554">defer</span>&nbsp;<span class="ident" id="8066560">inFile</span><span class="op" id="8066566">.</span><span class="ident" id="8066567">Close</span><span class="op" id="8066572">(</span><span class="op" id="8066573">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8066577">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8066642">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8066713">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8066783">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8066818">const</span>&nbsp;<span class="ident" id="8066824">newKeyMarker</span>&nbsp;<span class="op" id="8066837">=</span>&nbsp;<span class="string" id="8066839">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8066856">const</span>&nbsp;<span class="ident" id="8066862">newSignatureMarker</span>&nbsp;<span class="op" id="8066881">=</span>&nbsp;<span class="string" id="8066883">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8066907">values</span>&nbsp;<span class="op" id="8066914">:=</span>&nbsp;<span class="builtinfunc" id="8066917">make</span><span class="op" id="8066921">(</span><span class="keyword" id="8066922">chan</span>&nbsp;<span class="builtintype" id="8066927">string</span><span class="op" id="8066933">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8066937">go</span>&nbsp;<span class="keyword" id="8066940">func</span><span class="op" id="8066944">(</span><span class="op" id="8066945">)</span>&nbsp;<span class="op" id="8066947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8066951">defer</span>&nbsp;<span class="builtinfunc" id="8066957">close</span><span class="op" id="8066962">(</span><span class="ident" id="8066963">values</span><span class="op" id="8066969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8066973">scanner</span>&nbsp;<span class="op" id="8066981">:=</span>&nbsp;<span class="ident" id="8066984">bufio</span><span class="op" id="8066989">.</span><span class="ident" id="8066990">NewScanner</span><span class="op" id="8067000">(</span><span class="ident" id="8067001">bzip2</span><span class="op" id="8067006">.</span><span class="ident" id="8067007">NewReader</span><span class="op" id="8067016">(</span><span class="ident" id="8067017">inFile</span><span class="op" id="8067023">)</span><span class="op" id="8067024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067028">var</span>&nbsp;<span class="ident" id="8067032">partialValue</span>&nbsp;<span class="builtintype" id="8067045">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067054">lastWasValue</span>&nbsp;<span class="op" id="8067067">:=</span>&nbsp;<span class="builtintype" id="8067070">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067078">for</span>&nbsp;<span class="ident" id="8067082">scanner</span><span class="op" id="8067089">.</span><span class="ident" id="8067090">Scan</span><span class="op" id="8067094">(</span><span class="op" id="8067095">)</span>&nbsp;<span class="op" id="8067097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067102">line</span>&nbsp;<span class="op" id="8067107">:=</span>&nbsp;<span class="ident" id="8067110">scanner</span><span class="op" id="8067117">.</span><span class="ident" id="8067118">Text</span><span class="op" id="8067122">(</span><span class="op" id="8067123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067128">switch</span>&nbsp;<span class="op" id="8067135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067140">case</span>&nbsp;<span class="builtinfunc" id="8067145">len</span><span class="op" id="8067148">(</span><span class="ident" id="8067149">line</span><span class="op" id="8067153">)</span>&nbsp;<span class="op" id="8067155">==</span>&nbsp;<span class="num" id="8067158">0</span><span class="op" id="8067159">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067165">if</span>&nbsp;<span class="builtinfunc" id="8067168">len</span><span class="op" id="8067171">(</span><span class="ident" id="8067172">partialValue</span><span class="op" id="8067184">)</span>&nbsp;<span class="op" id="8067186">&gt;</span>&nbsp;<span class="num" id="8067188">0</span>&nbsp;<span class="op" id="8067190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067197">values</span>&nbsp;<span class="op" id="8067204">&lt;-</span>&nbsp;<span class="ident" id="8067207">strings</span><span class="op" id="8067214">.</span><span class="ident" id="8067215">Replace</span><span class="op" id="8067222">(</span><span class="ident" id="8067223">partialValue</span><span class="op" id="8067235">,</span>&nbsp;<span class="string" id="8067237">&#34;&nbsp;&#34;</span><span class="op" id="8067240">,</span>&nbsp;<span class="string" id="8067242">&#34;&#34;</span><span class="op" id="8067244">,</span>&nbsp;<span class="op" id="8067246">-</span><span class="num" id="8067247">1</span><span class="op" id="8067248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067255">partialValue</span>&nbsp;<span class="op" id="8067268">=</span>&nbsp;<span class="string" id="8067270">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067278">lastWasValue</span>&nbsp;<span class="op" id="8067291">=</span>&nbsp;<span class="builtintype" id="8067293">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8067302">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067308">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067320">case</span>&nbsp;<span class="ident" id="8067325">strings</span><span class="op" id="8067332">.</span><span class="ident" id="8067333">HasPrefix</span><span class="op" id="8067342">(</span><span class="ident" id="8067343">line</span><span class="op" id="8067347">,</span>&nbsp;<span class="string" id="8067349">&#34;#&nbsp;======&#34;</span><span class="op" id="8067359">)</span>&nbsp;<span class="op" id="8067361">&amp;&amp;</span>&nbsp;<span class="ident" id="8067364">lastWasValue</span><span class="op" id="8067376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067382">values</span>&nbsp;<span class="op" id="8067389">&lt;-</span>&nbsp;<span class="ident" id="8067392">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067409">lastWasValue</span>&nbsp;<span class="op" id="8067422">=</span>&nbsp;<span class="builtintype" id="8067424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067433">case</span>&nbsp;<span class="ident" id="8067438">strings</span><span class="op" id="8067445">.</span><span class="ident" id="8067446">HasPrefix</span><span class="op" id="8067455">(</span><span class="ident" id="8067456">line</span><span class="op" id="8067460">,</span>&nbsp;<span class="string" id="8067462">&#34;#&nbsp;------&#34;</span><span class="op" id="8067472">)</span>&nbsp;<span class="op" id="8067474">&amp;&amp;</span>&nbsp;<span class="ident" id="8067477">lastWasValue</span><span class="op" id="8067489">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067495">values</span>&nbsp;<span class="op" id="8067502">&lt;-</span>&nbsp;<span class="ident" id="8067505">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067528">lastWasValue</span>&nbsp;<span class="op" id="8067541">=</span>&nbsp;<span class="builtintype" id="8067543">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067552">case</span>&nbsp;<span class="ident" id="8067557">strings</span><span class="op" id="8067564">.</span><span class="ident" id="8067565">HasPrefix</span><span class="op" id="8067574">(</span><span class="ident" id="8067575">line</span><span class="op" id="8067579">,</span>&nbsp;<span class="string" id="8067581">&#34;#&#34;</span><span class="op" id="8067584">)</span><span class="op" id="8067585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067591">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067603">default</span><span class="op" id="8067610">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067616">partialValue</span>&nbsp;<span class="op" id="8067629">+=</span>&nbsp;<span class="ident" id="8067632">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8067640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8067644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067648">if</span>&nbsp;<span class="ident" id="8067651">err</span>&nbsp;<span class="op" id="8067655">:=</span>&nbsp;<span class="ident" id="8067658">scanner</span><span class="op" id="8067665">.</span><span class="ident" id="8067666">Err</span><span class="op" id="8067669">(</span><span class="op" id="8067670">)</span><span class="op" id="8067671">;</span>&nbsp;<span class="ident" id="8067673">err</span>&nbsp;<span class="op" id="8067677">!=</span>&nbsp;<span class="ident" id="8067680">nil</span>&nbsp;<span class="op" id="8067684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8067689">panic</span><span class="op" id="8067694">(</span><span class="ident" id="8067695">err</span><span class="op" id="8067698">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8067702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8067705">}</span><span class="op" id="8067706">(</span><span class="op" id="8067707">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067711">var</span>&nbsp;<span class="ident" id="8067715">key</span>&nbsp;<span class="op" id="8067719">*</span><span class="ident" id="8067720">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067731">var</span>&nbsp;<span class="ident" id="8067735">hashed</span>&nbsp;<span class="op" id="8067742">[</span><span class="op" id="8067743">]</span><span class="builtintype" id="8067744">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067750">hash</span>&nbsp;<span class="op" id="8067755">:=</span>&nbsp;<span class="ident" id="8067758">crypto</span><span class="op" id="8067764">.</span><span class="ident" id="8067765">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067771">h</span>&nbsp;<span class="op" id="8067773">:=</span>&nbsp;<span class="ident" id="8067776">hash</span><span class="op" id="8067780">.</span><span class="ident" id="8067781">New</span><span class="op" id="8067784">(</span><span class="op" id="8067785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067788">opts</span>&nbsp;<span class="op" id="8067793">:=</span>&nbsp;<span class="op" id="8067796">&amp;</span><span class="ident" id="8067797">PSSOptions</span><span class="op" id="8067807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067811">SaltLength</span><span class="op" id="8067821">:</span>&nbsp;<span class="ident" id="8067823">PSSSaltLengthEqualsHash</span><span class="op" id="8067846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8067849">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067853">for</span>&nbsp;<span class="ident" id="8067857">marker</span>&nbsp;<span class="op" id="8067864">:=</span>&nbsp;<span class="keyword" id="8067867">range</span>&nbsp;<span class="ident" id="8067873">values</span>&nbsp;<span class="op" id="8067880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067884">switch</span>&nbsp;<span class="ident" id="8067891">marker</span>&nbsp;<span class="op" id="8067898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067902">case</span>&nbsp;<span class="ident" id="8067907">newKeyMarker</span><span class="op" id="8067919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067924">key</span>&nbsp;<span class="op" id="8067928">=</span>&nbsp;<span class="builtinfunc" id="8067930">new</span><span class="op" id="8067933">(</span><span class="ident" id="8067934">PublicKey</span><span class="op" id="8067943">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8067948">nHex</span><span class="op" id="8067952">,</span>&nbsp;<span class="ident" id="8067954">ok</span>&nbsp;<span class="op" id="8067957">:=</span>&nbsp;<span class="op" id="8067960">&lt;-</span><span class="ident" id="8067962">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067972">if</span>&nbsp;<span class="op" id="8067975">!</span><span class="ident" id="8067976">ok</span>&nbsp;<span class="op" id="8067979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8067985">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8067997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068002">key</span><span class="op" id="8068005">.</span><span class="ident" id="8068006">N</span>&nbsp;<span class="op" id="8068008">=</span>&nbsp;<span class="ident" id="8068010">bigFromHex</span><span class="op" id="8068020">(</span><span class="ident" id="8068021">nHex</span><span class="op" id="8068025">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068030">key</span><span class="op" id="8068033">.</span><span class="ident" id="8068034">E</span>&nbsp;<span class="op" id="8068036">=</span>&nbsp;<span class="ident" id="8068038">intFromHex</span><span class="op" id="8068048">(</span><span class="op" id="8068049">&lt;-</span><span class="ident" id="8068051">values</span><span class="op" id="8068057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8068062">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8068111">for</span>&nbsp;<span class="ident" id="8068115">i</span>&nbsp;<span class="op" id="8068117">:=</span>&nbsp;<span class="num" id="8068120">0</span><span class="op" id="8068121">;</span>&nbsp;<span class="ident" id="8068123">i</span>&nbsp;<span class="op" id="8068125">&lt;</span>&nbsp;<span class="num" id="8068127">6</span><span class="op" id="8068128">;</span>&nbsp;<span class="ident" id="8068130">i</span><span class="op" id="8068131">++</span>&nbsp;<span class="op" id="8068134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8068140">&lt;-</span><span class="ident" id="8068142">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8068152">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8068156">case</span>&nbsp;<span class="ident" id="8068161">newSignatureMarker</span><span class="op" id="8068179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068184">msg</span>&nbsp;<span class="op" id="8068188">:=</span>&nbsp;<span class="ident" id="8068191">fromHex</span><span class="op" id="8068198">(</span><span class="op" id="8068199">&lt;-</span><span class="ident" id="8068201">values</span><span class="op" id="8068207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8068212">&lt;-</span><span class="ident" id="8068214">values</span>&nbsp;<span class="comment" id="8068221">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068237">sig</span>&nbsp;<span class="op" id="8068241">:=</span>&nbsp;<span class="ident" id="8068244">fromHex</span><span class="op" id="8068251">(</span><span class="op" id="8068252">&lt;-</span><span class="ident" id="8068254">values</span><span class="op" id="8068260">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068266">h</span><span class="op" id="8068267">.</span><span class="ident" id="8068268">Reset</span><span class="op" id="8068273">(</span><span class="op" id="8068274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068279">h</span><span class="op" id="8068280">.</span><span class="ident" id="8068281">Write</span><span class="op" id="8068286">(</span><span class="ident" id="8068287">msg</span><span class="op" id="8068290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068295">hashed</span>&nbsp;<span class="op" id="8068302">=</span>&nbsp;<span class="ident" id="8068304">h</span><span class="op" id="8068305">.</span><span class="ident" id="8068306">Sum</span><span class="op" id="8068309">(</span><span class="ident" id="8068310">hashed</span><span class="op" id="8068316">[</span><span class="op" id="8068317">:</span><span class="num" id="8068318">0</span><span class="op" id="8068319">]</span><span class="op" id="8068320">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8068326">if</span>&nbsp;<span class="ident" id="8068329">err</span>&nbsp;<span class="op" id="8068333">:=</span>&nbsp;<span class="ident" id="8068336">VerifyPSS</span><span class="op" id="8068345">(</span><span class="ident" id="8068346">key</span><span class="op" id="8068349">,</span>&nbsp;<span class="ident" id="8068351">hash</span><span class="op" id="8068355">,</span>&nbsp;<span class="ident" id="8068357">hashed</span><span class="op" id="8068363">,</span>&nbsp;<span class="ident" id="8068365">sig</span><span class="op" id="8068368">,</span>&nbsp;<span class="ident" id="8068370">opts</span><span class="op" id="8068374">)</span><span class="op" id="8068375">;</span>&nbsp;<span class="ident" id="8068377">err</span>&nbsp;<span class="op" id="8068381">!=</span>&nbsp;<span class="ident" id="8068384">nil</span>&nbsp;<span class="op" id="8068388">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068394">t</span><span class="op" id="8068395">.</span><span class="ident" id="8068396">Error</span><span class="op" id="8068401">(</span><span class="ident" id="8068402">err</span><span class="op" id="8068405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8068410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8068414">default</span><span class="op" id="8068421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068426">t</span><span class="op" id="8068427">.</span><span class="ident" id="8068428">Fatalf</span><span class="op" id="8068434">(</span><span class="string" id="8068435">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="8068454">+</span>&nbsp;<span class="ident" id="8068456">marker</span><span class="op" id="8068462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8068466">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8068469">}</span><br>
<span class="lineno"></span><span class="op" id="8068471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8068474">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8068553">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="8068621">func</span>&nbsp;<span class="ident" id="8068626">TestPSSOpenSSL</span><span class="op" id="8068640">(</span><span class="ident" id="8068641">t</span>&nbsp;<span class="op" id="8068643">*</span><span class="ident" id="8068644">testing</span><span class="op" id="8068651">.</span><span class="ident" id="8068652">T</span><span class="op" id="8068653">)</span>&nbsp;<span class="op" id="8068655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068658">hash</span>&nbsp;<span class="op" id="8068663">:=</span>&nbsp;<span class="ident" id="8068666">crypto</span><span class="op" id="8068672">.</span><span class="ident" id="8068673">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068681">h</span>&nbsp;<span class="op" id="8068683">:=</span>&nbsp;<span class="ident" id="8068686">hash</span><span class="op" id="8068690">.</span><span class="ident" id="8068691">New</span><span class="op" id="8068694">(</span><span class="op" id="8068695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068698">h</span><span class="op" id="8068699">.</span><span class="ident" id="8068700">Write</span><span class="op" id="8068705">(</span><span class="op" id="8068706">[</span><span class="op" id="8068707">]</span><span class="builtintype" id="8068708">byte</span><span class="op" id="8068712">(</span><span class="string" id="8068713">&#34;testing&#34;</span><span class="op" id="8068722">)</span><span class="op" id="8068723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068726">hashed</span>&nbsp;<span class="op" id="8068733">:=</span>&nbsp;<span class="ident" id="8068736">h</span><span class="op" id="8068737">.</span><span class="ident" id="8068738">Sum</span><span class="op" id="8068741">(</span><span class="ident" id="8068742">nil</span><span class="op" id="8068745">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8068749">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8068858">sig</span>&nbsp;<span class="op" id="8068862">:=</span>&nbsp;<span class="op" id="8068865">[</span><span class="op" id="8068866">]</span><span class="builtintype" id="8068867">byte</span><span class="op" id="8068871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8068875">0x95</span><span class="op" id="8068879">,</span>&nbsp;<span class="num" id="8068881">0x59</span><span class="op" id="8068885">,</span>&nbsp;<span class="num" id="8068887">0x6f</span><span class="op" id="8068891">,</span>&nbsp;<span class="num" id="8068893">0xd3</span><span class="op" id="8068897">,</span>&nbsp;<span class="num" id="8068899">0x10</span><span class="op" id="8068903">,</span>&nbsp;<span class="num" id="8068905">0xa2</span><span class="op" id="8068909">,</span>&nbsp;<span class="num" id="8068911">0xe7</span><span class="op" id="8068915">,</span>&nbsp;<span class="num" id="8068917">0xa2</span><span class="op" id="8068921">,</span>&nbsp;<span class="num" id="8068923">0x92</span><span class="op" id="8068927">,</span>&nbsp;<span class="num" id="8068929">0x9d</span><span class="op" id="8068933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8068937">0x4a</span><span class="op" id="8068941">,</span>&nbsp;<span class="num" id="8068943">0x07</span><span class="op" id="8068947">,</span>&nbsp;<span class="num" id="8068949">0x2e</span><span class="op" id="8068953">,</span>&nbsp;<span class="num" id="8068955">0x2b</span><span class="op" id="8068959">,</span>&nbsp;<span class="num" id="8068961">0x27</span><span class="op" id="8068965">,</span>&nbsp;<span class="num" id="8068967">0xcc</span><span class="op" id="8068971">,</span>&nbsp;<span class="num" id="8068973">0x06</span><span class="op" id="8068977">,</span>&nbsp;<span class="num" id="8068979">0xc2</span><span class="op" id="8068983">,</span>&nbsp;<span class="num" id="8068985">0x87</span><span class="op" id="8068989">,</span>&nbsp;<span class="num" id="8068991">0x2c</span><span class="op" id="8068995">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8068999">0x52</span><span class="op" id="8069003">,</span>&nbsp;<span class="num" id="8069005">0xf0</span><span class="op" id="8069009">,</span>&nbsp;<span class="num" id="8069011">0x4a</span><span class="op" id="8069015">,</span>&nbsp;<span class="num" id="8069017">0xcc</span><span class="op" id="8069021">,</span>&nbsp;<span class="num" id="8069023">0x05</span><span class="op" id="8069027">,</span>&nbsp;<span class="num" id="8069029">0x94</span><span class="op" id="8069033">,</span>&nbsp;<span class="num" id="8069035">0xf2</span><span class="op" id="8069039">,</span>&nbsp;<span class="num" id="8069041">0xc3</span><span class="op" id="8069045">,</span>&nbsp;<span class="num" id="8069047">0x2e</span><span class="op" id="8069051">,</span>&nbsp;<span class="num" id="8069053">0x20</span><span class="op" id="8069057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8069061">0xd7</span><span class="op" id="8069065">,</span>&nbsp;<span class="num" id="8069067">0x3e</span><span class="op" id="8069071">,</span>&nbsp;<span class="num" id="8069073">0x66</span><span class="op" id="8069077">,</span>&nbsp;<span class="num" id="8069079">0x62</span><span class="op" id="8069083">,</span>&nbsp;<span class="num" id="8069085">0xb5</span><span class="op" id="8069089">,</span>&nbsp;<span class="num" id="8069091">0x95</span><span class="op" id="8069095">,</span>&nbsp;<span class="num" id="8069097">0x2b</span><span class="op" id="8069101">,</span>&nbsp;<span class="num" id="8069103">0xa3</span><span class="op" id="8069107">,</span>&nbsp;<span class="num" id="8069109">0x93</span><span class="op" id="8069113">,</span>&nbsp;<span class="num" id="8069115">0x9a</span><span class="op" id="8069119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8069123">0x66</span><span class="op" id="8069127">,</span>&nbsp;<span class="num" id="8069129">0x64</span><span class="op" id="8069133">,</span>&nbsp;<span class="num" id="8069135">0x25</span><span class="op" id="8069139">,</span>&nbsp;<span class="num" id="8069141">0xe0</span><span class="op" id="8069145">,</span>&nbsp;<span class="num" id="8069147">0x74</span><span class="op" id="8069151">,</span>&nbsp;<span class="num" id="8069153">0x66</span><span class="op" id="8069157">,</span>&nbsp;<span class="num" id="8069159">0x8c</span><span class="op" id="8069163">,</span>&nbsp;<span class="num" id="8069165">0x3e</span><span class="op" id="8069169">,</span>&nbsp;<span class="num" id="8069171">0x92</span><span class="op" id="8069175">,</span>&nbsp;<span class="num" id="8069177">0xeb</span><span class="op" id="8069181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8069185">0xc6</span><span class="op" id="8069189">,</span>&nbsp;<span class="num" id="8069191">0xe6</span><span class="op" id="8069195">,</span>&nbsp;<span class="num" id="8069197">0xc0</span><span class="op" id="8069201">,</span>&nbsp;<span class="num" id="8069203">0x44</span><span class="op" id="8069207">,</span>&nbsp;<span class="num" id="8069209">0xf3</span><span class="op" id="8069213">,</span>&nbsp;<span class="num" id="8069215">0xb4</span><span class="op" id="8069219">,</span>&nbsp;<span class="num" id="8069221">0xb4</span><span class="op" id="8069225">,</span>&nbsp;<span class="num" id="8069227">0x2e</span><span class="op" id="8069231">,</span>&nbsp;<span class="num" id="8069233">0x8c</span><span class="op" id="8069237">,</span>&nbsp;<span class="num" id="8069239">0x66</span><span class="op" id="8069243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8069247">0x0a</span><span class="op" id="8069251">,</span>&nbsp;<span class="num" id="8069253">0x37</span><span class="op" id="8069257">,</span>&nbsp;<span class="num" id="8069259">0x9c</span><span class="op" id="8069263">,</span>&nbsp;<span class="num" id="8069265">0x69</span><span class="op" id="8069269">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8069276">if</span>&nbsp;<span class="ident" id="8069279">err</span>&nbsp;<span class="op" id="8069283">:=</span>&nbsp;<span class="ident" id="8069286">VerifyPSS</span><span class="op" id="8069295">(</span><span class="op" id="8069296">&amp;</span><span class="ident" id="8069297">rsaPrivateKey</span><span class="op" id="8069310">.</span><span class="ident" id="8069311">PublicKey</span><span class="op" id="8069320">,</span>&nbsp;<span class="ident" id="8069322">hash</span><span class="op" id="8069326">,</span>&nbsp;<span class="ident" id="8069328">hashed</span><span class="op" id="8069334">,</span>&nbsp;<span class="ident" id="8069336">sig</span><span class="op" id="8069339">,</span>&nbsp;<span class="ident" id="8069341">nil</span><span class="op" id="8069344">)</span><span class="op" id="8069345">;</span>&nbsp;<span class="ident" id="8069347">err</span>&nbsp;<span class="op" id="8069351">!=</span>&nbsp;<span class="ident" id="8069354">nil</span>&nbsp;<span class="op" id="8069358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8069362">t</span><span class="op" id="8069363">.</span><span class="ident" id="8069364">Error</span><span class="op" id="8069369">(</span><span class="ident" id="8069370">err</span><span class="op" id="8069373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069376">}</span><br>
<span class="lineno">190</span><span class="op" id="8069378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8069381">func</span>&nbsp;<span class="ident" id="8069386">TestPSSSigning</span><span class="op" id="8069400">(</span><span class="ident" id="8069401">t</span>&nbsp;<span class="op" id="8069403">*</span><span class="ident" id="8069404">testing</span><span class="op" id="8069411">.</span><span class="ident" id="8069412">T</span><span class="op" id="8069413">)</span>&nbsp;<span class="op" id="8069415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8069418">var</span>&nbsp;<span class="ident" id="8069422">saltLengthCombinations</span>&nbsp;<span class="op" id="8069445">=</span>&nbsp;<span class="op" id="8069447">[</span><span class="op" id="8069448">]</span><span class="keyword" id="8069449">struct</span>&nbsp;<span class="op" id="8069456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8069460">signSaltLength</span><span class="op" id="8069474">,</span>&nbsp;<span class="ident" id="8069476">verifySaltLength</span>&nbsp;<span class="builtintype" id="8069493">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8069499">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8069532">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069538">}</span><span class="op" id="8069539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069543">{</span><span class="ident" id="8069544">PSSSaltLengthAuto</span><span class="op" id="8069561">,</span>&nbsp;<span class="ident" id="8069563">PSSSaltLengthAuto</span><span class="op" id="8069580">,</span>&nbsp;<span class="builtintype" id="8069582">true</span><span class="op" id="8069586">}</span><span class="op" id="8069587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069591">{</span><span class="ident" id="8069592">PSSSaltLengthEqualsHash</span><span class="op" id="8069615">,</span>&nbsp;<span class="ident" id="8069617">PSSSaltLengthAuto</span><span class="op" id="8069634">,</span>&nbsp;<span class="builtintype" id="8069636">true</span><span class="op" id="8069640">}</span><span class="op" id="8069641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069645">{</span><span class="ident" id="8069646">PSSSaltLengthEqualsHash</span><span class="op" id="8069669">,</span>&nbsp;<span class="ident" id="8069671">PSSSaltLengthEqualsHash</span><span class="op" id="8069694">,</span>&nbsp;<span class="builtintype" id="8069696">true</span><span class="op" id="8069700">}</span><span class="op" id="8069701">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069705">{</span><span class="ident" id="8069706">PSSSaltLengthEqualsHash</span><span class="op" id="8069729">,</span>&nbsp;<span class="num" id="8069731">8</span><span class="op" id="8069732">,</span>&nbsp;<span class="builtintype" id="8069734">false</span><span class="op" id="8069739">}</span><span class="op" id="8069740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069744">{</span><span class="ident" id="8069745">PSSSaltLengthAuto</span><span class="op" id="8069762">,</span>&nbsp;<span class="ident" id="8069764">PSSSaltLengthEqualsHash</span><span class="op" id="8069787">,</span>&nbsp;<span class="builtintype" id="8069789">false</span><span class="op" id="8069794">}</span><span class="op" id="8069795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069799">{</span><span class="num" id="8069800">8</span><span class="op" id="8069801">,</span>&nbsp;<span class="num" id="8069803">8</span><span class="op" id="8069804">,</span>&nbsp;<span class="builtintype" id="8069806">true</span><span class="op" id="8069810">}</span><span class="op" id="8069811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8069814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8069818">hash</span>&nbsp;<span class="op" id="8069823">:=</span>&nbsp;<span class="ident" id="8069826">crypto</span><span class="op" id="8069832">.</span><span class="ident" id="8069833">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8069838">h</span>&nbsp;<span class="op" id="8069840">:=</span>&nbsp;<span class="ident" id="8069843">hash</span><span class="op" id="8069847">.</span><span class="ident" id="8069848">New</span><span class="op" id="8069851">(</span><span class="op" id="8069852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8069855">h</span><span class="op" id="8069856">.</span><span class="ident" id="8069857">Write</span><span class="op" id="8069862">(</span><span class="op" id="8069863">[</span><span class="op" id="8069864">]</span><span class="builtintype" id="8069865">byte</span><span class="op" id="8069869">(</span><span class="string" id="8069870">&#34;testing&#34;</span><span class="op" id="8069879">)</span><span class="op" id="8069880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8069883">hashed</span>&nbsp;<span class="op" id="8069890">:=</span>&nbsp;<span class="ident" id="8069893">h</span><span class="op" id="8069894">.</span><span class="ident" id="8069895">Sum</span><span class="op" id="8069898">(</span><span class="ident" id="8069899">nil</span><span class="op" id="8069902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8069905">var</span>&nbsp;<span class="ident" id="8069909">opts</span>&nbsp;<span class="ident" id="8069914">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8069927">for</span>&nbsp;<span class="ident" id="8069931">i</span><span class="op" id="8069932">,</span>&nbsp;<span class="ident" id="8069934">test</span>&nbsp;<span class="op" id="8069939">:=</span>&nbsp;<span class="keyword" id="8069942">range</span>&nbsp;<span class="ident" id="8069948">saltLengthCombinations</span>&nbsp;<span class="op" id="8069971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8069975">opts</span><span class="op" id="8069979">.</span><span class="ident" id="8069980">SaltLength</span>&nbsp;<span class="op" id="8069991">=</span>&nbsp;<span class="ident" id="8069993">test</span><span class="op" id="8069997">.</span><span class="ident" id="8069998">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8070015">sig</span><span class="op" id="8070018">,</span>&nbsp;<span class="ident" id="8070020">err</span>&nbsp;<span class="op" id="8070024">:=</span>&nbsp;<span class="ident" id="8070027">SignPSS</span><span class="op" id="8070034">(</span><span class="ident" id="8070035">rand</span><span class="op" id="8070039">.</span><span class="ident" id="8070040">Reader</span><span class="op" id="8070046">,</span>&nbsp;<span class="ident" id="8070048">rsaPrivateKey</span><span class="op" id="8070061">,</span>&nbsp;<span class="ident" id="8070063">hash</span><span class="op" id="8070067">,</span>&nbsp;<span class="ident" id="8070069">hashed</span><span class="op" id="8070075">,</span>&nbsp;<span class="op" id="8070077">&amp;</span><span class="ident" id="8070078">opts</span><span class="op" id="8070082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070086">if</span>&nbsp;<span class="ident" id="8070089">err</span>&nbsp;<span class="op" id="8070093">!=</span>&nbsp;<span class="ident" id="8070096">nil</span>&nbsp;<span class="op" id="8070100">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8070105">t</span><span class="op" id="8070106">.</span><span class="ident" id="8070107">Errorf</span><span class="op" id="8070113">(</span><span class="string" id="8070114">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8070144">,</span>&nbsp;<span class="ident" id="8070146">i</span><span class="op" id="8070147">,</span>&nbsp;<span class="ident" id="8070149">err</span><span class="op" id="8070152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070157">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8070168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8070173">opts</span><span class="op" id="8070177">.</span><span class="ident" id="8070178">SaltLength</span>&nbsp;<span class="op" id="8070189">=</span>&nbsp;<span class="ident" id="8070191">test</span><span class="op" id="8070195">.</span><span class="ident" id="8070196">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8070215">err</span>&nbsp;<span class="op" id="8070219">=</span>&nbsp;<span class="ident" id="8070221">VerifyPSS</span><span class="op" id="8070230">(</span><span class="op" id="8070231">&amp;</span><span class="ident" id="8070232">rsaPrivateKey</span><span class="op" id="8070245">.</span><span class="ident" id="8070246">PublicKey</span><span class="op" id="8070255">,</span>&nbsp;<span class="ident" id="8070257">hash</span><span class="op" id="8070261">,</span>&nbsp;<span class="ident" id="8070263">hashed</span><span class="op" id="8070269">,</span>&nbsp;<span class="ident" id="8070271">sig</span><span class="op" id="8070274">,</span>&nbsp;<span class="op" id="8070276">&amp;</span><span class="ident" id="8070277">opts</span><span class="op" id="8070281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070285">if</span>&nbsp;<span class="op" id="8070288">(</span><span class="ident" id="8070289">err</span>&nbsp;<span class="op" id="8070293">==</span>&nbsp;<span class="ident" id="8070296">nil</span><span class="op" id="8070299">)</span>&nbsp;<span class="op" id="8070301">!=</span>&nbsp;<span class="ident" id="8070304">test</span><span class="op" id="8070308">.</span><span class="ident" id="8070309">good</span>&nbsp;<span class="op" id="8070314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8070319">t</span><span class="op" id="8070320">.</span><span class="ident" id="8070321">Errorf</span><span class="op" id="8070327">(</span><span class="string" id="8070328">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="8070366">,</span>&nbsp;<span class="ident" id="8070368">i</span><span class="op" id="8070369">,</span>&nbsp;<span class="ident" id="8070371">test</span><span class="op" id="8070375">.</span><span class="ident" id="8070376">good</span><span class="op" id="8070380">,</span>&nbsp;<span class="ident" id="8070382">err</span><span class="op" id="8070385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8070389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8070392">}</span><br>
<span class="lineno">225</span><span class="op" id="8070394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8070397">func</span>&nbsp;<span class="ident" id="8070402">bigFromHex</span><span class="op" id="8070412">(</span><span class="ident" id="8070413">hex</span>&nbsp;<span class="builtintype" id="8070417">string</span><span class="op" id="8070423">)</span>&nbsp;<span class="op" id="8070425">*</span><span class="ident" id="8070426">big</span><span class="op" id="8070429">.</span><span class="ident" id="8070430">Int</span>&nbsp;<span class="op" id="8070434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8070437">n</span><span class="op" id="8070438">,</span>&nbsp;<span class="ident" id="8070440">ok</span>&nbsp;<span class="op" id="8070443">:=</span>&nbsp;<span class="builtinfunc" id="8070446">new</span><span class="op" id="8070449">(</span><span class="ident" id="8070450">big</span><span class="op" id="8070453">.</span><span class="ident" id="8070454">Int</span><span class="op" id="8070457">)</span><span class="op" id="8070458">.</span><span class="ident" id="8070459">SetString</span><span class="op" id="8070468">(</span><span class="ident" id="8070469">hex</span><span class="op" id="8070472">,</span>&nbsp;<span class="num" id="8070474">16</span><span class="op" id="8070476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070479">if</span>&nbsp;<span class="op" id="8070482">!</span><span class="ident" id="8070483">ok</span>&nbsp;<span class="op" id="8070486">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8070490">panic</span><span class="op" id="8070495">(</span><span class="string" id="8070496">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="8070508">+</span>&nbsp;<span class="ident" id="8070510">hex</span><span class="op" id="8070513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8070516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070519">return</span>&nbsp;<span class="ident" id="8070526">n</span><br>
<span class="lineno"></span><span class="op" id="8070528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8070531">func</span>&nbsp;<span class="ident" id="8070536">intFromHex</span><span class="op" id="8070546">(</span><span class="ident" id="8070547">hex</span>&nbsp;<span class="builtintype" id="8070551">string</span><span class="op" id="8070557">)</span>&nbsp;<span class="builtintype" id="8070559">int</span>&nbsp;<span class="op" id="8070563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8070566">i</span><span class="op" id="8070567">,</span>&nbsp;<span class="ident" id="8070569">err</span>&nbsp;<span class="op" id="8070573">:=</span>&nbsp;<span class="ident" id="8070576">strconv</span><span class="op" id="8070583">.</span><span class="ident" id="8070584">ParseInt</span><span class="op" id="8070592">(</span><span class="ident" id="8070593">hex</span><span class="op" id="8070596">,</span>&nbsp;<span class="num" id="8070598">16</span><span class="op" id="8070600">,</span>&nbsp;<span class="num" id="8070602">32</span><span class="op" id="8070604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070607">if</span>&nbsp;<span class="ident" id="8070610">err</span>&nbsp;<span class="op" id="8070614">!=</span>&nbsp;<span class="ident" id="8070617">nil</span>&nbsp;<span class="op" id="8070621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8070625">panic</span><span class="op" id="8070630">(</span><span class="ident" id="8070631">err</span><span class="op" id="8070634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8070637">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070640">return</span>&nbsp;<span class="builtintype" id="8070647">int</span><span class="op" id="8070650">(</span><span class="ident" id="8070651">i</span><span class="op" id="8070652">)</span><br>
<span class="lineno"></span><span class="op" id="8070654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8070657">func</span>&nbsp;<span class="ident" id="8070662">fromHex</span><span class="op" id="8070669">(</span><span class="ident" id="8070670">hexStr</span>&nbsp;<span class="builtintype" id="8070677">string</span><span class="op" id="8070683">)</span>&nbsp;<span class="op" id="8070685">[</span><span class="op" id="8070686">]</span><span class="builtintype" id="8070687">byte</span>&nbsp;<span class="op" id="8070692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8070695">s</span><span class="op" id="8070696">,</span>&nbsp;<span class="ident" id="8070698">err</span>&nbsp;<span class="op" id="8070702">:=</span>&nbsp;<span class="ident" id="8070705">hex</span><span class="op" id="8070708">.</span><span class="ident" id="8070709">DecodeString</span><span class="op" id="8070721">(</span><span class="ident" id="8070722">hexStr</span><span class="op" id="8070728">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070731">if</span>&nbsp;<span class="ident" id="8070734">err</span>&nbsp;<span class="op" id="8070738">!=</span>&nbsp;<span class="ident" id="8070741">nil</span>&nbsp;<span class="op" id="8070745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8070749">panic</span><span class="op" id="8070754">(</span><span class="ident" id="8070755">err</span><span class="op" id="8070758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8070761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8070764">return</span>&nbsp;<span class="ident" id="8070771">s</span><br>
<span class="lineno"></span><span class="op" id="8070773">}</span>
</div>
</body>
</html>
