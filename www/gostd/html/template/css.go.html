<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5419719">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5419774">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5419828">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5419879">package</span>&nbsp;<span class="ident" id="5419887">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5419897">import</span>&nbsp;<span class="op" id="5419904">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5419907">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5419916">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5419923">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5419934">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5419949">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5419952">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5420016">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="5420065">func</span>&nbsp;<span class="ident" id="5420070">endsWithCSSKeyword</span><span class="op" id="5420088">(</span><span class="ident" id="5420089">b</span>&nbsp;<span class="op" id="5420091">[</span><span class="op" id="5420092">]</span><span class="builtintype" id="5420093">byte</span><span class="op" id="5420097">,</span>&nbsp;<span class="ident" id="5420099">kw</span>&nbsp;<span class="builtintype" id="5420102">string</span><span class="op" id="5420108">)</span>&nbsp;<span class="builtintype" id="5420110">bool</span>&nbsp;<span class="op" id="5420115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420118">i</span>&nbsp;<span class="op" id="5420120">:=</span>&nbsp;<span class="builtinfunc" id="5420123">len</span><span class="op" id="5420126">(</span><span class="ident" id="5420127">b</span><span class="op" id="5420128">)</span>&nbsp;<span class="op" id="5420130">-</span>&nbsp;<span class="builtinfunc" id="5420132">len</span><span class="op" id="5420135">(</span><span class="ident" id="5420136">kw</span><span class="op" id="5420138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420141">if</span>&nbsp;<span class="ident" id="5420144">i</span>&nbsp;<span class="op" id="5420146">&lt;</span>&nbsp;<span class="num" id="5420148">0</span>&nbsp;<span class="op" id="5420150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420154">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420170">return</span>&nbsp;<span class="builtintype" id="5420177">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420187">if</span>&nbsp;<span class="ident" id="5420190">i</span>&nbsp;<span class="op" id="5420192">!=</span>&nbsp;<span class="num" id="5420195">0</span>&nbsp;<span class="op" id="5420197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420201">r</span><span class="op" id="5420202">,</span>&nbsp;<span class="ident" id="5420204">_</span>&nbsp;<span class="op" id="5420206">:=</span>&nbsp;<span class="ident" id="5420209">utf8</span><span class="op" id="5420213">.</span><span class="ident" id="5420214">DecodeLastRune</span><span class="op" id="5420228">(</span><span class="ident" id="5420229">b</span><span class="op" id="5420230">[</span><span class="op" id="5420231">:</span><span class="ident" id="5420232">i</span><span class="op" id="5420233">]</span><span class="op" id="5420234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420238">if</span>&nbsp;<span class="ident" id="5420241">isCSSNmchar</span><span class="op" id="5420252">(</span><span class="ident" id="5420253">r</span><span class="op" id="5420254">)</span>&nbsp;<span class="op" id="5420256">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420261">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420277">return</span>&nbsp;<span class="builtintype" id="5420284">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5420295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420298">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420371">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420431">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420477">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420547">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420598">return</span>&nbsp;<span class="builtintype" id="5420605">string</span><span class="op" id="5420611">(</span><span class="ident" id="5420612">bytes</span><span class="op" id="5420617">.</span><span class="ident" id="5420618">ToLower</span><span class="op" id="5420625">(</span><span class="ident" id="5420626">b</span><span class="op" id="5420627">[</span><span class="ident" id="5420628">i</span><span class="op" id="5420629">:</span><span class="op" id="5420630">]</span><span class="op" id="5420631">)</span><span class="op" id="5420632">)</span>&nbsp;<span class="op" id="5420634">==</span>&nbsp;<span class="ident" id="5420637">kw</span><br>
<span class="lineno">35</span><span class="op" id="5420640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5420643">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="5420720">func</span>&nbsp;<span class="ident" id="5420725">isCSSNmchar</span><span class="op" id="5420736">(</span><span class="ident" id="5420737">r</span>&nbsp;<span class="builtintype" id="5420739">rune</span><span class="op" id="5420743">)</span>&nbsp;<span class="builtintype" id="5420745">bool</span>&nbsp;<span class="op" id="5420750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420753">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420823">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5420838">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420890">return</span>&nbsp;<span class="string" id="5420897">&#39;a&#39;</span>&nbsp;<span class="op" id="5420901">&lt;=</span>&nbsp;<span class="ident" id="5420904">r</span>&nbsp;<span class="op" id="5420906">&amp;&amp;</span>&nbsp;<span class="ident" id="5420909">r</span>&nbsp;<span class="op" id="5420911">&lt;=</span>&nbsp;<span class="string" id="5420914">&#39;z&#39;</span>&nbsp;<span class="op" id="5420918">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5420923">&#39;A&#39;</span>&nbsp;<span class="op" id="5420927">&lt;=</span>&nbsp;<span class="ident" id="5420930">r</span>&nbsp;<span class="op" id="5420932">&amp;&amp;</span>&nbsp;<span class="ident" id="5420935">r</span>&nbsp;<span class="op" id="5420937">&lt;=</span>&nbsp;<span class="string" id="5420940">&#39;Z&#39;</span>&nbsp;<span class="op" id="5420944">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5420949">&#39;0&#39;</span>&nbsp;<span class="op" id="5420953">&lt;=</span>&nbsp;<span class="ident" id="5420956">r</span>&nbsp;<span class="op" id="5420958">&amp;&amp;</span>&nbsp;<span class="ident" id="5420961">r</span>&nbsp;<span class="op" id="5420963">&lt;=</span>&nbsp;<span class="string" id="5420966">&#39;9&#39;</span>&nbsp;<span class="op" id="5420970">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420975">r</span>&nbsp;<span class="op" id="5420977">==</span>&nbsp;<span class="string" id="5420980">&#39;-&#39;</span>&nbsp;<span class="op" id="5420984">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420989">r</span>&nbsp;<span class="op" id="5420991">==</span>&nbsp;<span class="string" id="5420994">&#39;_&#39;</span>&nbsp;<span class="op" id="5420998">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421003">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5421031">0x80</span>&nbsp;<span class="op" id="5421036">&lt;=</span>&nbsp;<span class="ident" id="5421039">r</span>&nbsp;<span class="op" id="5421041">&amp;&amp;</span>&nbsp;<span class="ident" id="5421044">r</span>&nbsp;<span class="op" id="5421046">&lt;=</span>&nbsp;<span class="num" id="5421049">0xd7ff</span>&nbsp;<span class="op" id="5421056">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5421061">0xe000</span>&nbsp;<span class="op" id="5421068">&lt;=</span>&nbsp;<span class="ident" id="5421071">r</span>&nbsp;<span class="op" id="5421073">&amp;&amp;</span>&nbsp;<span class="ident" id="5421076">r</span>&nbsp;<span class="op" id="5421078">&lt;=</span>&nbsp;<span class="num" id="5421081">0xfffd</span>&nbsp;<span class="op" id="5421088">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5421093">0x10000</span>&nbsp;<span class="op" id="5421101">&lt;=</span>&nbsp;<span class="ident" id="5421104">r</span>&nbsp;<span class="op" id="5421106">&amp;&amp;</span>&nbsp;<span class="ident" id="5421109">r</span>&nbsp;<span class="op" id="5421111">&lt;=</span>&nbsp;<span class="num" id="5421114">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="5421123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5421126">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="5421193">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="5421270">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="5421296">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="5421371">func</span>&nbsp;<span class="ident" id="5421376">decodeCSS</span><span class="op" id="5421385">(</span><span class="ident" id="5421386">s</span>&nbsp;<span class="op" id="5421388">[</span><span class="op" id="5421389">]</span><span class="builtintype" id="5421390">byte</span><span class="op" id="5421394">)</span>&nbsp;<span class="op" id="5421396">[</span><span class="op" id="5421397">]</span><span class="builtintype" id="5421398">byte</span>&nbsp;<span class="op" id="5421403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421406">i</span>&nbsp;<span class="op" id="5421408">:=</span>&nbsp;<span class="ident" id="5421411">bytes</span><span class="op" id="5421416">.</span><span class="ident" id="5421417">IndexByte</span><span class="op" id="5421426">(</span><span class="ident" id="5421427">s</span><span class="op" id="5421428">,</span>&nbsp;<span class="string" id="5421430">&#39;\\&#39;</span><span class="op" id="5421434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421437">if</span>&nbsp;<span class="ident" id="5421440">i</span>&nbsp;<span class="op" id="5421442">==</span>&nbsp;<span class="op" id="5421445">-</span><span class="num" id="5421446">1</span>&nbsp;<span class="op" id="5421448">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421452">return</span>&nbsp;<span class="ident" id="5421459">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421465">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421533">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421605">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421643">b</span>&nbsp;<span class="op" id="5421645">:=</span>&nbsp;<span class="builtinfunc" id="5421648">make</span><span class="op" id="5421652">(</span><span class="op" id="5421653">[</span><span class="op" id="5421654">]</span><span class="builtintype" id="5421655">byte</span><span class="op" id="5421659">,</span>&nbsp;<span class="num" id="5421661">0</span><span class="op" id="5421662">,</span>&nbsp;<span class="builtinfunc" id="5421664">len</span><span class="op" id="5421667">(</span><span class="ident" id="5421668">s</span><span class="op" id="5421669">)</span><span class="op" id="5421670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421673">for</span>&nbsp;<span class="builtinfunc" id="5421677">len</span><span class="op" id="5421680">(</span><span class="ident" id="5421681">s</span><span class="op" id="5421682">)</span>&nbsp;<span class="op" id="5421684">!=</span>&nbsp;<span class="num" id="5421687">0</span>&nbsp;<span class="op" id="5421689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421693">i</span>&nbsp;<span class="op" id="5421695">:=</span>&nbsp;<span class="ident" id="5421698">bytes</span><span class="op" id="5421703">.</span><span class="ident" id="5421704">IndexByte</span><span class="op" id="5421713">(</span><span class="ident" id="5421714">s</span><span class="op" id="5421715">,</span>&nbsp;<span class="string" id="5421717">&#39;\\&#39;</span><span class="op" id="5421721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421725">if</span>&nbsp;<span class="ident" id="5421728">i</span>&nbsp;<span class="op" id="5421730">==</span>&nbsp;<span class="op" id="5421733">-</span><span class="num" id="5421734">1</span>&nbsp;<span class="op" id="5421736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421741">i</span>&nbsp;<span class="op" id="5421743">=</span>&nbsp;<span class="builtinfunc" id="5421745">len</span><span class="op" id="5421748">(</span><span class="ident" id="5421749">s</span><span class="op" id="5421750">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421758">b</span><span class="op" id="5421759">,</span>&nbsp;<span class="ident" id="5421761">s</span>&nbsp;<span class="op" id="5421763">=</span>&nbsp;<span class="builtinfunc" id="5421765">append</span><span class="op" id="5421771">(</span><span class="ident" id="5421772">b</span><span class="op" id="5421773">,</span>&nbsp;<span class="ident" id="5421775">s</span><span class="op" id="5421776">[</span><span class="op" id="5421777">:</span><span class="ident" id="5421778">i</span><span class="op" id="5421779">]</span><span class="op" id="5421780">...</span><span class="op" id="5421783">)</span><span class="op" id="5421784">,</span>&nbsp;<span class="ident" id="5421786">s</span><span class="op" id="5421787">[</span><span class="ident" id="5421788">i</span><span class="op" id="5421789">:</span><span class="op" id="5421790">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421794">if</span>&nbsp;<span class="builtinfunc" id="5421797">len</span><span class="op" id="5421800">(</span><span class="ident" id="5421801">s</span><span class="op" id="5421802">)</span>&nbsp;<span class="op" id="5421804">&lt;</span>&nbsp;<span class="num" id="5421806">2</span>&nbsp;<span class="op" id="5421808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421813">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421821">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421825">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421878">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421960">if</span>&nbsp;<span class="ident" id="5421963">isHex</span><span class="op" id="5421968">(</span><span class="ident" id="5421969">s</span><span class="op" id="5421970">[</span><span class="num" id="5421971">1</span><span class="op" id="5421972">]</span><span class="op" id="5421973">)</span>&nbsp;<span class="op" id="5421975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5421980">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422035">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422080">j</span>&nbsp;<span class="op" id="5422082">:=</span>&nbsp;<span class="num" id="5422085">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422090">for</span>&nbsp;<span class="ident" id="5422094">j</span>&nbsp;<span class="op" id="5422096">&lt;</span>&nbsp;<span class="builtinfunc" id="5422098">len</span><span class="op" id="5422101">(</span><span class="ident" id="5422102">s</span><span class="op" id="5422103">)</span>&nbsp;<span class="op" id="5422105">&amp;&amp;</span>&nbsp;<span class="ident" id="5422108">j</span>&nbsp;<span class="op" id="5422110">&lt;</span>&nbsp;<span class="num" id="5422112">7</span>&nbsp;<span class="op" id="5422114">&amp;&amp;</span>&nbsp;<span class="ident" id="5422117">isHex</span><span class="op" id="5422122">(</span><span class="ident" id="5422123">s</span><span class="op" id="5422124">[</span><span class="ident" id="5422125">j</span><span class="op" id="5422126">]</span><span class="op" id="5422127">)</span>&nbsp;<span class="op" id="5422129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422135">j</span><span class="op" id="5422136">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422147">r</span>&nbsp;<span class="op" id="5422149">:=</span>&nbsp;<span class="ident" id="5422152">hexDecode</span><span class="op" id="5422161">(</span><span class="ident" id="5422162">s</span><span class="op" id="5422163">[</span><span class="num" id="5422164">1</span><span class="op" id="5422165">:</span><span class="ident" id="5422166">j</span><span class="op" id="5422167">]</span><span class="op" id="5422168">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422173">if</span>&nbsp;<span class="ident" id="5422176">r</span>&nbsp;<span class="op" id="5422178">&gt;</span>&nbsp;<span class="ident" id="5422180">unicode</span><span class="op" id="5422187">.</span><span class="ident" id="5422188">MaxRune</span>&nbsp;<span class="op" id="5422196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422202">r</span><span class="op" id="5422203">,</span>&nbsp;<span class="ident" id="5422205">j</span>&nbsp;<span class="op" id="5422207">=</span>&nbsp;<span class="ident" id="5422209">r</span><span class="op" id="5422210">/</span><span class="num" id="5422211">16</span><span class="op" id="5422213">,</span>&nbsp;<span class="ident" id="5422215">j</span><span class="op" id="5422216">-</span><span class="num" id="5422217">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422227">n</span>&nbsp;<span class="op" id="5422229">:=</span>&nbsp;<span class="ident" id="5422232">utf8</span><span class="op" id="5422236">.</span><span class="ident" id="5422237">EncodeRune</span><span class="op" id="5422247">(</span><span class="ident" id="5422248">b</span><span class="op" id="5422249">[</span><span class="builtinfunc" id="5422250">len</span><span class="op" id="5422253">(</span><span class="ident" id="5422254">b</span><span class="op" id="5422255">)</span><span class="op" id="5422256">:</span><span class="builtinfunc" id="5422257">cap</span><span class="op" id="5422260">(</span><span class="ident" id="5422261">b</span><span class="op" id="5422262">)</span><span class="op" id="5422263">]</span><span class="op" id="5422264">,</span>&nbsp;<span class="ident" id="5422266">r</span><span class="op" id="5422267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422272">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422321">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422369">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422418">b</span><span class="op" id="5422419">,</span>&nbsp;<span class="ident" id="5422421">s</span>&nbsp;<span class="op" id="5422423">=</span>&nbsp;<span class="ident" id="5422425">b</span><span class="op" id="5422426">[</span><span class="op" id="5422427">:</span><span class="builtinfunc" id="5422428">len</span><span class="op" id="5422431">(</span><span class="ident" id="5422432">b</span><span class="op" id="5422433">)</span><span class="op" id="5422434">+</span><span class="ident" id="5422435">n</span><span class="op" id="5422436">]</span><span class="op" id="5422437">,</span>&nbsp;<span class="ident" id="5422439">skipCSSSpace</span><span class="op" id="5422451">(</span><span class="ident" id="5422452">s</span><span class="op" id="5422453">[</span><span class="ident" id="5422454">j</span><span class="op" id="5422455">:</span><span class="op" id="5422456">]</span><span class="op" id="5422457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422461">}</span>&nbsp;<span class="keyword" id="5422463">else</span>&nbsp;<span class="op" id="5422468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5422473">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422516">_</span><span class="op" id="5422517">,</span>&nbsp;<span class="ident" id="5422519">n</span>&nbsp;<span class="op" id="5422521">:=</span>&nbsp;<span class="ident" id="5422524">utf8</span><span class="op" id="5422528">.</span><span class="ident" id="5422529">DecodeRune</span><span class="op" id="5422539">(</span><span class="ident" id="5422540">s</span><span class="op" id="5422541">[</span><span class="num" id="5422542">1</span><span class="op" id="5422543">:</span><span class="op" id="5422544">]</span><span class="op" id="5422545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422550">b</span><span class="op" id="5422551">,</span>&nbsp;<span class="ident" id="5422553">s</span>&nbsp;<span class="op" id="5422555">=</span>&nbsp;<span class="builtinfunc" id="5422557">append</span><span class="op" id="5422563">(</span><span class="ident" id="5422564">b</span><span class="op" id="5422565">,</span>&nbsp;<span class="ident" id="5422567">s</span><span class="op" id="5422568">[</span><span class="num" id="5422569">1</span><span class="op" id="5422570">:</span><span class="num" id="5422571">1</span><span class="op" id="5422572">+</span><span class="ident" id="5422573">n</span><span class="op" id="5422574">]</span><span class="op" id="5422575">...</span><span class="op" id="5422578">)</span><span class="op" id="5422579">,</span>&nbsp;<span class="ident" id="5422581">s</span><span class="op" id="5422582">[</span><span class="num" id="5422583">1</span><span class="op" id="5422584">+</span><span class="ident" id="5422585">n</span><span class="op" id="5422586">:</span><span class="op" id="5422587">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422597">return</span>&nbsp;<span class="ident" id="5422604">b</span><br>
<span class="lineno">100</span><span class="op" id="5422606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5422609">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="5422670">func</span>&nbsp;<span class="ident" id="5422675">isHex</span><span class="op" id="5422680">(</span><span class="ident" id="5422681">c</span>&nbsp;<span class="builtintype" id="5422683">byte</span><span class="op" id="5422687">)</span>&nbsp;<span class="builtintype" id="5422689">bool</span>&nbsp;<span class="op" id="5422694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422697">return</span>&nbsp;<span class="string" id="5422704">&#39;0&#39;</span>&nbsp;<span class="op" id="5422708">&lt;=</span>&nbsp;<span class="ident" id="5422711">c</span>&nbsp;<span class="op" id="5422713">&amp;&amp;</span>&nbsp;<span class="ident" id="5422716">c</span>&nbsp;<span class="op" id="5422718">&lt;=</span>&nbsp;<span class="string" id="5422721">&#39;9&#39;</span>&nbsp;<span class="op" id="5422725">||</span>&nbsp;<span class="string" id="5422728">&#39;a&#39;</span>&nbsp;<span class="op" id="5422732">&lt;=</span>&nbsp;<span class="ident" id="5422735">c</span>&nbsp;<span class="op" id="5422737">&amp;&amp;</span>&nbsp;<span class="ident" id="5422740">c</span>&nbsp;<span class="op" id="5422742">&lt;=</span>&nbsp;<span class="string" id="5422745">&#39;f&#39;</span>&nbsp;<span class="op" id="5422749">||</span>&nbsp;<span class="string" id="5422752">&#39;A&#39;</span>&nbsp;<span class="op" id="5422756">&lt;=</span>&nbsp;<span class="ident" id="5422759">c</span>&nbsp;<span class="op" id="5422761">&amp;&amp;</span>&nbsp;<span class="ident" id="5422764">c</span>&nbsp;<span class="op" id="5422766">&lt;=</span>&nbsp;<span class="string" id="5422769">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="5422773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5422776">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="5422837">func</span>&nbsp;<span class="ident" id="5422842">hexDecode</span><span class="op" id="5422851">(</span><span class="ident" id="5422852">s</span>&nbsp;<span class="op" id="5422854">[</span><span class="op" id="5422855">]</span><span class="builtintype" id="5422856">byte</span><span class="op" id="5422860">)</span>&nbsp;<span class="builtintype" id="5422862">rune</span>&nbsp;<span class="op" id="5422867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422870">n</span>&nbsp;<span class="op" id="5422872">:=</span>&nbsp;<span class="string" id="5422875">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422883">for</span>&nbsp;<span class="ident" id="5422887">_</span><span class="op" id="5422888">,</span>&nbsp;<span class="ident" id="5422890">c</span>&nbsp;<span class="op" id="5422892">:=</span>&nbsp;<span class="keyword" id="5422895">range</span>&nbsp;<span class="ident" id="5422901">s</span>&nbsp;<span class="op" id="5422903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422907">n</span>&nbsp;<span class="op" id="5422909">&lt;&lt;=</span>&nbsp;<span class="num" id="5422913">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422917">switch</span>&nbsp;<span class="op" id="5422924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422928">case</span>&nbsp;<span class="string" id="5422933">&#39;0&#39;</span>&nbsp;<span class="op" id="5422937">&lt;=</span>&nbsp;<span class="ident" id="5422940">c</span>&nbsp;<span class="op" id="5422942">&amp;&amp;</span>&nbsp;<span class="ident" id="5422945">c</span>&nbsp;<span class="op" id="5422947">&lt;=</span>&nbsp;<span class="string" id="5422950">&#39;9&#39;</span><span class="op" id="5422953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422958">n</span>&nbsp;<span class="op" id="5422960">|=</span>&nbsp;<span class="builtintype" id="5422963">rune</span><span class="op" id="5422967">(</span><span class="ident" id="5422968">c</span>&nbsp;<span class="op" id="5422970">-</span>&nbsp;<span class="string" id="5422972">&#39;0&#39;</span><span class="op" id="5422975">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422979">case</span>&nbsp;<span class="string" id="5422984">&#39;a&#39;</span>&nbsp;<span class="op" id="5422988">&lt;=</span>&nbsp;<span class="ident" id="5422991">c</span>&nbsp;<span class="op" id="5422993">&amp;&amp;</span>&nbsp;<span class="ident" id="5422996">c</span>&nbsp;<span class="op" id="5422998">&lt;=</span>&nbsp;<span class="string" id="5423001">&#39;f&#39;</span><span class="op" id="5423004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423009">n</span>&nbsp;<span class="op" id="5423011">|=</span>&nbsp;<span class="builtintype" id="5423014">rune</span><span class="op" id="5423018">(</span><span class="ident" id="5423019">c</span><span class="op" id="5423020">-</span><span class="string" id="5423021">&#39;a&#39;</span><span class="op" id="5423024">)</span>&nbsp;<span class="op" id="5423026">+</span>&nbsp;<span class="num" id="5423028">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423033">case</span>&nbsp;<span class="string" id="5423038">&#39;A&#39;</span>&nbsp;<span class="op" id="5423042">&lt;=</span>&nbsp;<span class="ident" id="5423045">c</span>&nbsp;<span class="op" id="5423047">&amp;&amp;</span>&nbsp;<span class="ident" id="5423050">c</span>&nbsp;<span class="op" id="5423052">&lt;=</span>&nbsp;<span class="string" id="5423055">&#39;F&#39;</span><span class="op" id="5423058">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423063">n</span>&nbsp;<span class="op" id="5423065">|=</span>&nbsp;<span class="builtintype" id="5423068">rune</span><span class="op" id="5423072">(</span><span class="ident" id="5423073">c</span><span class="op" id="5423074">-</span><span class="string" id="5423075">&#39;A&#39;</span><span class="op" id="5423078">)</span>&nbsp;<span class="op" id="5423080">+</span>&nbsp;<span class="num" id="5423082">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423087">default</span><span class="op" id="5423094">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5423099">panic</span><span class="op" id="5423104">(</span><span class="ident" id="5423105">fmt</span><span class="op" id="5423108">.</span><span class="ident" id="5423109">Sprintf</span><span class="op" id="5423116">(</span><span class="string" id="5423117">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="5423138">,</span>&nbsp;<span class="ident" id="5423140">s</span><span class="op" id="5423141">)</span><span class="op" id="5423142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423152">return</span>&nbsp;<span class="ident" id="5423159">n</span><br>
<span class="lineno"></span><span class="op" id="5423161">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5423164">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="5423233">func</span>&nbsp;<span class="ident" id="5423238">skipCSSSpace</span><span class="op" id="5423250">(</span><span class="ident" id="5423251">c</span>&nbsp;<span class="op" id="5423253">[</span><span class="op" id="5423254">]</span><span class="builtintype" id="5423255">byte</span><span class="op" id="5423259">)</span>&nbsp;<span class="op" id="5423261">[</span><span class="op" id="5423262">]</span><span class="builtintype" id="5423263">byte</span>&nbsp;<span class="op" id="5423268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423271">if</span>&nbsp;<span class="builtinfunc" id="5423274">len</span><span class="op" id="5423277">(</span><span class="ident" id="5423278">c</span><span class="op" id="5423279">)</span>&nbsp;<span class="op" id="5423281">==</span>&nbsp;<span class="num" id="5423284">0</span>&nbsp;<span class="op" id="5423286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423290">return</span>&nbsp;<span class="ident" id="5423297">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423303">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423343">switch</span>&nbsp;<span class="ident" id="5423350">c</span><span class="op" id="5423351">[</span><span class="num" id="5423352">0</span><span class="op" id="5423353">]</span>&nbsp;<span class="op" id="5423355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423358">case</span>&nbsp;<span class="string" id="5423363">&#39;\t&#39;</span><span class="op" id="5423367">,</span>&nbsp;<span class="string" id="5423369">&#39;\n&#39;</span><span class="op" id="5423373">,</span>&nbsp;<span class="string" id="5423375">&#39;\f&#39;</span><span class="op" id="5423379">,</span>&nbsp;<span class="string" id="5423381">&#39;&nbsp;&#39;</span><span class="op" id="5423384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423388">return</span>&nbsp;<span class="ident" id="5423395">c</span><span class="op" id="5423396">[</span><span class="num" id="5423397">1</span><span class="op" id="5423398">:</span><span class="op" id="5423399">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423402">case</span>&nbsp;<span class="string" id="5423407">&#39;\r&#39;</span><span class="op" id="5423411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423415">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423481">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423546">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423591">if</span>&nbsp;<span class="builtinfunc" id="5423594">len</span><span class="op" id="5423597">(</span><span class="ident" id="5423598">c</span><span class="op" id="5423599">)</span>&nbsp;<span class="op" id="5423601">&gt;=</span>&nbsp;<span class="num" id="5423604">2</span>&nbsp;<span class="op" id="5423606">&amp;&amp;</span>&nbsp;<span class="ident" id="5423609">c</span><span class="op" id="5423610">[</span><span class="num" id="5423611">1</span><span class="op" id="5423612">]</span>&nbsp;<span class="op" id="5423614">==</span>&nbsp;<span class="string" id="5423617">&#39;\n&#39;</span>&nbsp;<span class="op" id="5423622">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423627">return</span>&nbsp;<span class="ident" id="5423634">c</span><span class="op" id="5423635">[</span><span class="num" id="5423636">2</span><span class="op" id="5423637">:</span><span class="op" id="5423638">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423646">return</span>&nbsp;<span class="ident" id="5423653">c</span><span class="op" id="5423654">[</span><span class="num" id="5423655">1</span><span class="op" id="5423656">:</span><span class="op" id="5423657">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423663">return</span>&nbsp;<span class="ident" id="5423670">c</span><br>
<span class="lineno">145</span><span class="op" id="5423672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5423675">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="5423745">func</span>&nbsp;<span class="ident" id="5423750">isCSSSpace</span><span class="op" id="5423760">(</span><span class="ident" id="5423761">b</span>&nbsp;<span class="builtintype" id="5423763">byte</span><span class="op" id="5423767">)</span>&nbsp;<span class="builtintype" id="5423769">bool</span>&nbsp;<span class="op" id="5423774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423777">switch</span>&nbsp;<span class="ident" id="5423784">b</span>&nbsp;<span class="op" id="5423786">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423789">case</span>&nbsp;<span class="string" id="5423794">&#39;\t&#39;</span><span class="op" id="5423798">,</span>&nbsp;<span class="string" id="5423800">&#39;\n&#39;</span><span class="op" id="5423804">,</span>&nbsp;<span class="string" id="5423806">&#39;\f&#39;</span><span class="op" id="5423810">,</span>&nbsp;<span class="string" id="5423812">&#39;\r&#39;</span><span class="op" id="5423816">,</span>&nbsp;<span class="string" id="5423818">&#39;&nbsp;&#39;</span><span class="op" id="5423821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423825">return</span>&nbsp;<span class="builtintype" id="5423832">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423841">return</span>&nbsp;<span class="builtintype" id="5423848">false</span><br>
<span class="lineno"></span><span class="op" id="5423854">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5423857">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="5423934">func</span>&nbsp;<span class="ident" id="5423939">cssEscaper</span><span class="op" id="5423949">(</span><span class="ident" id="5423950">args</span>&nbsp;<span class="op" id="5423955">...</span><span class="keyword" id="5423958">interface</span><span class="op" id="5423967">{</span><span class="op" id="5423968">}</span><span class="op" id="5423969">)</span>&nbsp;<span class="builtintype" id="5423971">string</span>&nbsp;<span class="op" id="5423978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423981">s</span><span class="op" id="5423982">,</span>&nbsp;<span class="ident" id="5423984">_</span>&nbsp;<span class="op" id="5423986">:=</span>&nbsp;<span class="ident" id="5423989">stringify</span><span class="op" id="5423998">(</span><span class="ident" id="5423999">args</span><span class="op" id="5424003">...</span><span class="op" id="5424006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424009">var</span>&nbsp;<span class="ident" id="5424013">b</span>&nbsp;<span class="ident" id="5424015">bytes</span><span class="op" id="5424020">.</span><span class="ident" id="5424021">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424029">written</span>&nbsp;<span class="op" id="5424037">:=</span>&nbsp;<span class="num" id="5424040">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424043">for</span>&nbsp;<span class="ident" id="5424047">i</span><span class="op" id="5424048">,</span>&nbsp;<span class="ident" id="5424050">r</span>&nbsp;<span class="op" id="5424052">:=</span>&nbsp;<span class="keyword" id="5424055">range</span>&nbsp;<span class="ident" id="5424061">s</span>&nbsp;<span class="op" id="5424063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424067">var</span>&nbsp;<span class="ident" id="5424071">repl</span>&nbsp;<span class="builtintype" id="5424076">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424085">switch</span>&nbsp;<span class="ident" id="5424092">r</span>&nbsp;<span class="op" id="5424094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424098">case</span>&nbsp;<span class="num" id="5424103">0</span><span class="op" id="5424104">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424109">repl</span>&nbsp;<span class="op" id="5424114">=</span>&nbsp;<span class="string" id="5424116">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424123">case</span>&nbsp;<span class="string" id="5424128">&#39;\t&#39;</span><span class="op" id="5424132">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424137">repl</span>&nbsp;<span class="op" id="5424142">=</span>&nbsp;<span class="string" id="5424144">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424151">case</span>&nbsp;<span class="string" id="5424156">&#39;\n&#39;</span><span class="op" id="5424160">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424165">repl</span>&nbsp;<span class="op" id="5424170">=</span>&nbsp;<span class="string" id="5424172">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424179">case</span>&nbsp;<span class="string" id="5424184">&#39;\f&#39;</span><span class="op" id="5424188">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424193">repl</span>&nbsp;<span class="op" id="5424198">=</span>&nbsp;<span class="string" id="5424200">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424207">case</span>&nbsp;<span class="string" id="5424212">&#39;\r&#39;</span><span class="op" id="5424216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424221">repl</span>&nbsp;<span class="op" id="5424226">=</span>&nbsp;<span class="string" id="5424228">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5424235">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5424298">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424348">case</span>&nbsp;<span class="string" id="5424353">&#39;&#34;&#39;</span><span class="op" id="5424356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424361">repl</span>&nbsp;<span class="op" id="5424366">=</span>&nbsp;<span class="string" id="5424368">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424376">case</span>&nbsp;<span class="string" id="5424381">&#39;&amp;&#39;</span><span class="op" id="5424384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424389">repl</span>&nbsp;<span class="op" id="5424394">=</span>&nbsp;<span class="string" id="5424396">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424404">case</span>&nbsp;<span class="string" id="5424409">&#39;\&#39;&#39;</span><span class="op" id="5424413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424418">repl</span>&nbsp;<span class="op" id="5424423">=</span>&nbsp;<span class="string" id="5424425">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424433">case</span>&nbsp;<span class="string" id="5424438">&#39;(&#39;</span><span class="op" id="5424441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424446">repl</span>&nbsp;<span class="op" id="5424451">=</span>&nbsp;<span class="string" id="5424453">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424461">case</span>&nbsp;<span class="string" id="5424466">&#39;)&#39;</span><span class="op" id="5424469">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424474">repl</span>&nbsp;<span class="op" id="5424479">=</span>&nbsp;<span class="string" id="5424481">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424489">case</span>&nbsp;<span class="string" id="5424494">&#39;+&#39;</span><span class="op" id="5424497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424502">repl</span>&nbsp;<span class="op" id="5424507">=</span>&nbsp;<span class="string" id="5424509">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424517">case</span>&nbsp;<span class="string" id="5424522">&#39;/&#39;</span><span class="op" id="5424525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424530">repl</span>&nbsp;<span class="op" id="5424535">=</span>&nbsp;<span class="string" id="5424537">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424545">case</span>&nbsp;<span class="string" id="5424550">&#39;:&#39;</span><span class="op" id="5424553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424558">repl</span>&nbsp;<span class="op" id="5424563">=</span>&nbsp;<span class="string" id="5424565">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424573">case</span>&nbsp;<span class="string" id="5424578">&#39;;&#39;</span><span class="op" id="5424581">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424586">repl</span>&nbsp;<span class="op" id="5424591">=</span>&nbsp;<span class="string" id="5424593">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424601">case</span>&nbsp;<span class="string" id="5424606">&#39;&lt;&#39;</span><span class="op" id="5424609">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424614">repl</span>&nbsp;<span class="op" id="5424619">=</span>&nbsp;<span class="string" id="5424621">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424629">case</span>&nbsp;<span class="string" id="5424634">&#39;&gt;&#39;</span><span class="op" id="5424637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424642">repl</span>&nbsp;<span class="op" id="5424647">=</span>&nbsp;<span class="string" id="5424649">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424657">case</span>&nbsp;<span class="string" id="5424662">&#39;\\&#39;</span><span class="op" id="5424666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424671">repl</span>&nbsp;<span class="op" id="5424676">=</span>&nbsp;<span class="string" id="5424678">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424685">case</span>&nbsp;<span class="string" id="5424690">&#39;{&#39;</span><span class="op" id="5424693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424698">repl</span>&nbsp;<span class="op" id="5424703">=</span>&nbsp;<span class="string" id="5424705">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424713">case</span>&nbsp;<span class="string" id="5424718">&#39;}&#39;</span><span class="op" id="5424721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424726">repl</span>&nbsp;<span class="op" id="5424731">=</span>&nbsp;<span class="string" id="5424733">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424741">default</span><span class="op" id="5424748">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424753">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424768">b</span><span class="op" id="5424769">.</span><span class="ident" id="5424770">WriteString</span><span class="op" id="5424781">(</span><span class="ident" id="5424782">s</span><span class="op" id="5424783">[</span><span class="ident" id="5424784">written</span><span class="op" id="5424791">:</span><span class="ident" id="5424792">i</span><span class="op" id="5424793">]</span><span class="op" id="5424794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424798">b</span><span class="op" id="5424799">.</span><span class="ident" id="5424800">WriteString</span><span class="op" id="5424811">(</span><span class="ident" id="5424812">repl</span><span class="op" id="5424816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424820">written</span>&nbsp;<span class="op" id="5424828">=</span>&nbsp;<span class="ident" id="5424830">i</span>&nbsp;<span class="op" id="5424832">+</span>&nbsp;<span class="ident" id="5424834">utf8</span><span class="op" id="5424838">.</span><span class="ident" id="5424839">RuneLen</span><span class="op" id="5424846">(</span><span class="ident" id="5424847">r</span><span class="op" id="5424848">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424852">if</span>&nbsp;<span class="ident" id="5424855">repl</span>&nbsp;<span class="op" id="5424860">!=</span>&nbsp;<span class="string" id="5424863">`\\`</span>&nbsp;<span class="op" id="5424868">&amp;&amp;</span>&nbsp;<span class="op" id="5424871">(</span><span class="ident" id="5424872">written</span>&nbsp;<span class="op" id="5424880">==</span>&nbsp;<span class="builtinfunc" id="5424883">len</span><span class="op" id="5424886">(</span><span class="ident" id="5424887">s</span><span class="op" id="5424888">)</span>&nbsp;<span class="op" id="5424890">||</span>&nbsp;<span class="ident" id="5424893">isHex</span><span class="op" id="5424898">(</span><span class="ident" id="5424899">s</span><span class="op" id="5424900">[</span><span class="ident" id="5424901">written</span><span class="op" id="5424908">]</span><span class="op" id="5424909">)</span>&nbsp;<span class="op" id="5424911">||</span>&nbsp;<span class="ident" id="5424914">isCSSSpace</span><span class="op" id="5424924">(</span><span class="ident" id="5424925">s</span><span class="op" id="5424926">[</span><span class="ident" id="5424927">written</span><span class="op" id="5424934">]</span><span class="op" id="5424935">)</span><span class="op" id="5424936">)</span>&nbsp;<span class="op" id="5424938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424943">b</span><span class="op" id="5424944">.</span><span class="ident" id="5424945">WriteByte</span><span class="op" id="5424954">(</span><span class="string" id="5424955">&#39;&nbsp;&#39;</span><span class="op" id="5424958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424968">if</span>&nbsp;<span class="ident" id="5424971">written</span>&nbsp;<span class="op" id="5424979">==</span>&nbsp;<span class="num" id="5424982">0</span>&nbsp;<span class="op" id="5424984">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424988">return</span>&nbsp;<span class="ident" id="5424995">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425001">b</span><span class="op" id="5425002">.</span><span class="ident" id="5425003">WriteString</span><span class="op" id="5425014">(</span><span class="ident" id="5425015">s</span><span class="op" id="5425016">[</span><span class="ident" id="5425017">written</span><span class="op" id="5425024">:</span><span class="op" id="5425025">]</span><span class="op" id="5425026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425029">return</span>&nbsp;<span class="ident" id="5425036">b</span><span class="op" id="5425037">.</span><span class="ident" id="5425038">String</span><span class="op" id="5425044">(</span><span class="op" id="5425045">)</span><br>
<span class="lineno"></span><span class="op" id="5425047">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="5425050">var</span>&nbsp;<span class="ident" id="5425054">expressionBytes</span>&nbsp;<span class="op" id="5425070">=</span>&nbsp;<span class="op" id="5425072">[</span><span class="op" id="5425073">]</span><span class="builtintype" id="5425074">byte</span><span class="op" id="5425078">(</span><span class="string" id="5425079">&#34;expression&#34;</span><span class="op" id="5425091">)</span><br>
<span class="lineno"></span><span class="keyword" id="5425093">var</span>&nbsp;<span class="ident" id="5425097">mozBindingBytes</span>&nbsp;<span class="op" id="5425113">=</span>&nbsp;<span class="op" id="5425115">[</span><span class="op" id="5425116">]</span><span class="builtintype" id="5425117">byte</span><span class="op" id="5425121">(</span><span class="string" id="5425122">&#34;mozbinding&#34;</span><span class="op" id="5425134">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5425137">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="5425211">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5425290">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="5425329">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="5425406">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="5425450">func</span>&nbsp;<span class="ident" id="5425455">cssValueFilter</span><span class="op" id="5425469">(</span><span class="ident" id="5425470">args</span>&nbsp;<span class="op" id="5425475">...</span><span class="keyword" id="5425478">interface</span><span class="op" id="5425487">{</span><span class="op" id="5425488">}</span><span class="op" id="5425489">)</span>&nbsp;<span class="builtintype" id="5425491">string</span>&nbsp;<span class="op" id="5425498">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425501">s</span><span class="op" id="5425502">,</span>&nbsp;<span class="ident" id="5425504">t</span>&nbsp;<span class="op" id="5425506">:=</span>&nbsp;<span class="ident" id="5425509">stringify</span><span class="op" id="5425518">(</span><span class="ident" id="5425519">args</span><span class="op" id="5425523">...</span><span class="op" id="5425526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425529">if</span>&nbsp;<span class="ident" id="5425532">t</span>&nbsp;<span class="op" id="5425534">==</span>&nbsp;<span class="ident" id="5425537">contentTypeCSS</span>&nbsp;<span class="op" id="5425552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425556">return</span>&nbsp;<span class="ident" id="5425563">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425569">b</span><span class="op" id="5425570">,</span>&nbsp;<span class="ident" id="5425572">id</span>&nbsp;<span class="op" id="5425575">:=</span>&nbsp;<span class="ident" id="5425578">decodeCSS</span><span class="op" id="5425587">(</span><span class="op" id="5425588">[</span><span class="op" id="5425589">]</span><span class="builtintype" id="5425590">byte</span><span class="op" id="5425594">(</span><span class="ident" id="5425595">s</span><span class="op" id="5425596">)</span><span class="op" id="5425597">)</span><span class="op" id="5425598">,</span>&nbsp;<span class="builtinfunc" id="5425600">make</span><span class="op" id="5425604">(</span><span class="op" id="5425605">[</span><span class="op" id="5425606">]</span><span class="builtintype" id="5425607">byte</span><span class="op" id="5425611">,</span>&nbsp;<span class="num" id="5425613">0</span><span class="op" id="5425614">,</span>&nbsp;<span class="num" id="5425616">64</span><span class="op" id="5425618">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425622">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425693">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425748">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425815">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425887">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425953">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426026">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426097">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426135">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426206">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426277">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426333">for</span>&nbsp;<span class="ident" id="5426337">i</span><span class="op" id="5426338">,</span>&nbsp;<span class="ident" id="5426340">c</span>&nbsp;<span class="op" id="5426342">:=</span>&nbsp;<span class="keyword" id="5426345">range</span>&nbsp;<span class="ident" id="5426351">b</span>&nbsp;<span class="op" id="5426353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426357">switch</span>&nbsp;<span class="ident" id="5426364">c</span>&nbsp;<span class="op" id="5426366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426370">case</span>&nbsp;<span class="num" id="5426375">0</span><span class="op" id="5426376">,</span>&nbsp;<span class="string" id="5426378">&#39;&#34;&#39;</span><span class="op" id="5426381">,</span>&nbsp;<span class="string" id="5426383">&#39;\&#39;&#39;</span><span class="op" id="5426387">,</span>&nbsp;<span class="string" id="5426389">&#39;(&#39;</span><span class="op" id="5426392">,</span>&nbsp;<span class="string" id="5426394">&#39;)&#39;</span><span class="op" id="5426397">,</span>&nbsp;<span class="string" id="5426399">&#39;/&#39;</span><span class="op" id="5426402">,</span>&nbsp;<span class="string" id="5426404">&#39;;&#39;</span><span class="op" id="5426407">,</span>&nbsp;<span class="string" id="5426409">&#39;@&#39;</span><span class="op" id="5426412">,</span>&nbsp;<span class="string" id="5426414">&#39;[&#39;</span><span class="op" id="5426417">,</span>&nbsp;<span class="string" id="5426419">&#39;\\&#39;</span><span class="op" id="5426423">,</span>&nbsp;<span class="string" id="5426425">&#39;]&#39;</span><span class="op" id="5426428">,</span>&nbsp;<span class="string" id="5426430">&#39;`&#39;</span><span class="op" id="5426433">,</span>&nbsp;<span class="string" id="5426435">&#39;{&#39;</span><span class="op" id="5426438">,</span>&nbsp;<span class="string" id="5426440">&#39;}&#39;</span><span class="op" id="5426443">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426448">return</span>&nbsp;<span class="ident" id="5426455">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426472">case</span>&nbsp;<span class="string" id="5426477">&#39;-&#39;</span><span class="op" id="5426480">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426485">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426513">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426562">if</span>&nbsp;<span class="ident" id="5426565">i</span>&nbsp;<span class="op" id="5426567">!=</span>&nbsp;<span class="num" id="5426570">0</span>&nbsp;<span class="op" id="5426572">&amp;&amp;</span>&nbsp;<span class="ident" id="5426575">b</span><span class="op" id="5426576">[</span><span class="ident" id="5426577">i</span><span class="op" id="5426578">-</span><span class="num" id="5426579">1</span><span class="op" id="5426580">]</span>&nbsp;<span class="op" id="5426582">==</span>&nbsp;<span class="string" id="5426585">&#39;-&#39;</span>&nbsp;<span class="op" id="5426589">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426595">return</span>&nbsp;<span class="ident" id="5426602">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426624">default</span><span class="op" id="5426631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426636">if</span>&nbsp;<span class="ident" id="5426639">c</span>&nbsp;<span class="op" id="5426641">&lt;</span>&nbsp;<span class="num" id="5426643">0x80</span>&nbsp;<span class="op" id="5426648">&amp;&amp;</span>&nbsp;<span class="ident" id="5426651">isCSSNmchar</span><span class="op" id="5426662">(</span><span class="builtintype" id="5426663">rune</span><span class="op" id="5426667">(</span><span class="ident" id="5426668">c</span><span class="op" id="5426669">)</span><span class="op" id="5426670">)</span>&nbsp;<span class="op" id="5426672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426678">id</span>&nbsp;<span class="op" id="5426681">=</span>&nbsp;<span class="builtinfunc" id="5426683">append</span><span class="op" id="5426689">(</span><span class="ident" id="5426690">id</span><span class="op" id="5426692">,</span>&nbsp;<span class="ident" id="5426694">c</span><span class="op" id="5426695">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426710">id</span>&nbsp;<span class="op" id="5426713">=</span>&nbsp;<span class="ident" id="5426715">bytes</span><span class="op" id="5426720">.</span><span class="ident" id="5426721">ToLower</span><span class="op" id="5426728">(</span><span class="ident" id="5426729">id</span><span class="op" id="5426731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426734">if</span>&nbsp;<span class="ident" id="5426737">bytes</span><span class="op" id="5426742">.</span><span class="ident" id="5426743">Index</span><span class="op" id="5426748">(</span><span class="ident" id="5426749">id</span><span class="op" id="5426751">,</span>&nbsp;<span class="ident" id="5426753">expressionBytes</span><span class="op" id="5426768">)</span>&nbsp;<span class="op" id="5426770">!=</span>&nbsp;<span class="op" id="5426773">-</span><span class="num" id="5426774">1</span>&nbsp;<span class="op" id="5426776">||</span>&nbsp;<span class="ident" id="5426779">bytes</span><span class="op" id="5426784">.</span><span class="ident" id="5426785">Index</span><span class="op" id="5426790">(</span><span class="ident" id="5426791">id</span><span class="op" id="5426793">,</span>&nbsp;<span class="ident" id="5426795">mozBindingBytes</span><span class="op" id="5426810">)</span>&nbsp;<span class="op" id="5426812">!=</span>&nbsp;<span class="op" id="5426815">-</span><span class="num" id="5426816">1</span>&nbsp;<span class="op" id="5426818">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426822">return</span>&nbsp;<span class="ident" id="5426829">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426848">return</span>&nbsp;<span class="builtintype" id="5426855">string</span><span class="op" id="5426861">(</span><span class="ident" id="5426862">b</span><span class="op" id="5426863">)</span><br>
<span class="lineno"></span><span class="op" id="5426865">}</span>
</div>
</body>
</html>
