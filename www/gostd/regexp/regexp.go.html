<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp</h2>
<ul>
<li><a href="/gostd/regexp/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/regexp/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/regexp/exec.go.html">exec.go</a></li>
<li><a href="/gostd/regexp/exec2_test.go.html">exec2_test.go</a></li>
<li><a href="/gostd/regexp/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/regexp/find_test.go.html">find_test.go</a></li>
<li><a href="/gostd/regexp/onepass.go.html">onepass.go</a></li>
<li><a href="/gostd/regexp/onepass_test.go.html">onepass_test.go</a></li>
<li><a href="/gostd/regexp/regexp.go.html" class="current">regexp.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5381782">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5381837">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5381891">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5381942">//&nbsp;Package&nbsp;regexp&nbsp;implements&nbsp;regular&nbsp;expression&nbsp;search.</span><br>
<span class="lineno"></span><span class="comment" id="5381998">//</span><br>
<span class="lineno"></span><span class="comment" id="5382001">//&nbsp;The&nbsp;syntax&nbsp;of&nbsp;the&nbsp;regular&nbsp;expressions&nbsp;accepted&nbsp;is&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="5382063">//&nbsp;general&nbsp;syntax&nbsp;used&nbsp;by&nbsp;Perl,&nbsp;Python,&nbsp;and&nbsp;other&nbsp;languages.</span><br>
<span class="lineno"></span><span class="comment" id="5382124">//&nbsp;More&nbsp;precisely,&nbsp;it&nbsp;is&nbsp;the&nbsp;syntax&nbsp;accepted&nbsp;by&nbsp;RE2&nbsp;and&nbsp;described&nbsp;at</span><br>
<span class="lineno">10</span><span class="comment" id="5382193">//&nbsp;http://code.google.com/p/re2/wiki/Syntax,&nbsp;except&nbsp;for&nbsp;\C.</span><br>
<span class="lineno"></span><span class="comment" id="5382253">//&nbsp;For&nbsp;an&nbsp;overview&nbsp;of&nbsp;the&nbsp;syntax,&nbsp;run</span><br>
<span class="lineno"></span><span class="comment" id="5382291">//&nbsp;&nbsp;&nbsp;godoc&nbsp;regexp/syntax</span><br>
<span class="lineno"></span><span class="comment" id="5382316">//</span><br>
<span class="lineno"></span><span class="comment" id="5382319">//&nbsp;The&nbsp;regexp&nbsp;implementation&nbsp;provided&nbsp;by&nbsp;this&nbsp;package&nbsp;is</span><br>
<span class="lineno">15</span><span class="comment" id="5382376">//&nbsp;guaranteed&nbsp;to&nbsp;run&nbsp;in&nbsp;time&nbsp;linear&nbsp;in&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="5382438">//&nbsp;(This&nbsp;is&nbsp;a&nbsp;property&nbsp;not&nbsp;guaranteed&nbsp;by&nbsp;most&nbsp;open&nbsp;source</span><br>
<span class="lineno"></span><span class="comment" id="5382496">//&nbsp;implementations&nbsp;of&nbsp;regular&nbsp;expressions.)&nbsp;For&nbsp;more&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="5382561">//&nbsp;about&nbsp;this&nbsp;property,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="5382589">//&nbsp;&nbsp;&nbsp;&nbsp;http://swtch.com/~rsc/regexp/regexp1.html</span><br>
<span class="lineno">20</span><span class="comment" id="5382634">//&nbsp;or&nbsp;any&nbsp;book&nbsp;about&nbsp;automata&nbsp;theory.</span><br>
<span class="lineno"></span><span class="comment" id="5382672">//</span><br>
<span class="lineno"></span><span class="comment" id="5382675">//&nbsp;All&nbsp;characters&nbsp;are&nbsp;UTF-8-encoded&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5382724">//</span><br>
<span class="lineno"></span><span class="comment" id="5382727">//&nbsp;There&nbsp;are&nbsp;16&nbsp;methods&nbsp;of&nbsp;Regexp&nbsp;that&nbsp;match&nbsp;a&nbsp;regular&nbsp;expression&nbsp;and&nbsp;identify</span><br>
<span class="lineno">25</span><span class="comment" id="5382806">//&nbsp;the&nbsp;matched&nbsp;text.&nbsp;&nbsp;Their&nbsp;names&nbsp;are&nbsp;matched&nbsp;by&nbsp;this&nbsp;regular&nbsp;expression:</span><br>
<span class="lineno"></span><span class="comment" id="5382880">//</span><br>
<span class="lineno"></span><span class="comment" id="5382883">//&nbsp;&nbsp;&nbsp;&nbsp;Find(All)?(String)?(Submatch)?(Index)?</span><br>
<span class="lineno"></span><span class="comment" id="5382925">//</span><br>
<span class="lineno"></span><span class="comment" id="5382928">//&nbsp;If&nbsp;&#39;All&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;routine&nbsp;matches&nbsp;successive&nbsp;non-overlapping</span><br>
<span class="lineno">30</span><span class="comment" id="5382999">//&nbsp;matches&nbsp;of&nbsp;the&nbsp;entire&nbsp;expression.&nbsp;&nbsp;Empty&nbsp;matches&nbsp;abutting&nbsp;a&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="5383072">//&nbsp;match&nbsp;are&nbsp;ignored.&nbsp;&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;slice&nbsp;containing&nbsp;the&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="5383149">//&nbsp;return&nbsp;values&nbsp;of&nbsp;the&nbsp;corresponding&nbsp;non-&#39;All&#39;&nbsp;routine.&nbsp;&nbsp;These&nbsp;routines&nbsp;take</span><br>
<span class="lineno"></span><span class="comment" id="5383227">//&nbsp;an&nbsp;extra&nbsp;integer&nbsp;argument,&nbsp;n;&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;function&nbsp;returns&nbsp;at&nbsp;most&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="5383302">//&nbsp;matches/submatches.</span><br>
<span class="lineno">35</span><span class="comment" id="5383325">//</span><br>
<span class="lineno"></span><span class="comment" id="5383328">//&nbsp;If&nbsp;&#39;String&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;argument&nbsp;is&nbsp;a&nbsp;string;&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="5383405">//&nbsp;of&nbsp;bytes;&nbsp;return&nbsp;values&nbsp;are&nbsp;adjusted&nbsp;as&nbsp;appropriate.</span><br>
<span class="lineno"></span><span class="comment" id="5383461">//</span><br>
<span class="lineno"></span><span class="comment" id="5383464">//&nbsp;If&nbsp;&#39;Submatch&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;slice&nbsp;identifying&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="5383537">//&nbsp;successive&nbsp;submatches&nbsp;of&nbsp;the&nbsp;expression.&nbsp;Submatches&nbsp;are&nbsp;matches&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5383607">//&nbsp;parenthesized&nbsp;subexpressions&nbsp;(also&nbsp;known&nbsp;as&nbsp;capturing&nbsp;groups)&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5383683">//&nbsp;regular&nbsp;expression,&nbsp;numbered&nbsp;from&nbsp;left&nbsp;to&nbsp;right&nbsp;in&nbsp;order&nbsp;of&nbsp;opening</span><br>
<span class="lineno"></span><span class="comment" id="5383754">//&nbsp;parenthesis.&nbsp;Submatch&nbsp;0&nbsp;is&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;entire&nbsp;expression,&nbsp;submatch&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="5383831">//&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;first&nbsp;parenthesized&nbsp;subexpression,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">45</span><span class="comment" id="5383897">//</span><br>
<span class="lineno"></span><span class="comment" id="5383900">//&nbsp;If&nbsp;&#39;Index&#39;&nbsp;is&nbsp;present,&nbsp;matches&nbsp;and&nbsp;submatches&nbsp;are&nbsp;identified&nbsp;by&nbsp;byte&nbsp;index</span><br>
<span class="lineno"></span><span class="comment" id="5383978">//&nbsp;pairs&nbsp;within&nbsp;the&nbsp;input&nbsp;string:&nbsp;result[2*n:2*n+1]&nbsp;identifies&nbsp;the&nbsp;indexes&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5384056">//&nbsp;the&nbsp;nth&nbsp;submatch.&nbsp;&nbsp;The&nbsp;pair&nbsp;for&nbsp;n==0&nbsp;identifies&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;entire</span><br>
<span class="lineno"></span><span class="comment" id="5384131">//&nbsp;expression.&nbsp;&nbsp;If&nbsp;&#39;Index&#39;&nbsp;is&nbsp;not&nbsp;present,&nbsp;the&nbsp;match&nbsp;is&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno">50</span><span class="comment" id="5384205">//&nbsp;text&nbsp;of&nbsp;the&nbsp;match/submatch.&nbsp;&nbsp;If&nbsp;an&nbsp;index&nbsp;is&nbsp;negative,&nbsp;it&nbsp;means&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5384276">//&nbsp;subexpression&nbsp;did&nbsp;not&nbsp;match&nbsp;any&nbsp;string&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="5384332">//</span><br>
<span class="lineno"></span><span class="comment" id="5384335">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;subset&nbsp;of&nbsp;the&nbsp;methods&nbsp;that&nbsp;can&nbsp;be&nbsp;applied&nbsp;to&nbsp;text&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5384409">//&nbsp;from&nbsp;a&nbsp;RuneReader:</span><br>
<span class="lineno">55</span><span class="comment" id="5384431">//</span><br>
<span class="lineno"></span><span class="comment" id="5384434">//&nbsp;&nbsp;&nbsp;&nbsp;MatchReader,&nbsp;FindReaderIndex,&nbsp;FindReaderSubmatchIndex</span><br>
<span class="lineno"></span><span class="comment" id="5384491">//</span><br>
<span class="lineno"></span><span class="comment" id="5384494">//&nbsp;This&nbsp;set&nbsp;may&nbsp;grow.&nbsp;&nbsp;Note&nbsp;that&nbsp;regular&nbsp;expression&nbsp;matches&nbsp;may&nbsp;need&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5384566">//&nbsp;examine&nbsp;text&nbsp;beyond&nbsp;the&nbsp;text&nbsp;returned&nbsp;by&nbsp;a&nbsp;match,&nbsp;so&nbsp;the&nbsp;methods&nbsp;that</span><br>
<span class="lineno">60</span><span class="comment" id="5384639">//&nbsp;match&nbsp;text&nbsp;from&nbsp;a&nbsp;RuneReader&nbsp;may&nbsp;read&nbsp;arbitrarily&nbsp;far&nbsp;into&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5384711">//&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="comment" id="5384732">//</span><br>
<span class="lineno"></span><span class="comment" id="5384735">//&nbsp;(There&nbsp;are&nbsp;a&nbsp;few&nbsp;other&nbsp;methods&nbsp;that&nbsp;do&nbsp;not&nbsp;match&nbsp;this&nbsp;pattern.)</span><br>
<span class="lineno"></span><span class="comment" id="5384802">//</span><br>
<span class="lineno">65</span><span class="keyword" id="5384805">package</span>&nbsp;<span class="ident" id="5384813">regexp</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5384821">import</span>&nbsp;<span class="op" id="5384828">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5384831">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5384840">&#34;io&#34;</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5384846">&#34;regexp/syntax&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5384863">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5384874">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5384885">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5384893">&#34;unicode&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5384904">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5384919">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5384922">var</span>&nbsp;<span class="ident" id="5384926">debug</span>&nbsp;<span class="op" id="5384932">=</span>&nbsp;<span class="builtintype" id="5384934">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="5384941">//&nbsp;Regexp&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="comment" id="5385007">//&nbsp;A&nbsp;Regexp&nbsp;is&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="5385070">type</span>&nbsp;<span class="ident" id="5385075">Regexp</span>&nbsp;<span class="keyword" id="5385082">struct</span>&nbsp;<span class="op" id="5385089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5385092">//&nbsp;read-only&nbsp;after&nbsp;Compile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385120">expr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5385135">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5385150">//&nbsp;as&nbsp;passed&nbsp;to&nbsp;Compile</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385175">prog</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5385190">*</span><span class="ident" id="5385191">syntax</span><span class="op" id="5385197">.</span><span class="ident" id="5385198">Prog</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5385205">//&nbsp;compiled&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385226">onepass</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5385241">*</span><span class="ident" id="5385242">onePassProg</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5385256">//&nbsp;onpass&nbsp;program&nbsp;or&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385282">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5385297">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5385312">//&nbsp;required&nbsp;prefix&nbsp;in&nbsp;unanchored&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385354">prefixBytes</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5385369">[</span><span class="op" id="5385370">]</span><span class="builtintype" id="5385371">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5385384">//&nbsp;prefix,&nbsp;as&nbsp;a&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385408">prefixComplete</span>&nbsp;<span class="builtintype" id="5385423">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5385438">//&nbsp;prefix&nbsp;is&nbsp;the&nbsp;entire&nbsp;regexp</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385470">prefixRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5385485">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5385500">//&nbsp;first&nbsp;rune&nbsp;in&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385525">prefixEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5385540">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5385555">//&nbsp;pc&nbsp;for&nbsp;last&nbsp;rune&nbsp;in&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385586">cond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385601">syntax</span><span class="op" id="5385607">.</span><span class="ident" id="5385608">EmptyOp</span>&nbsp;<span class="comment" id="5385616">//&nbsp;empty-width&nbsp;conditions&nbsp;required&nbsp;at&nbsp;start&nbsp;of&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385670">numSubexp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5385685">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385690">subexpNames</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5385705">[</span><span class="op" id="5385706">]</span><span class="builtintype" id="5385707">string</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385715">longest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5385730">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5385737">//&nbsp;cache&nbsp;of&nbsp;machines&nbsp;for&nbsp;running&nbsp;regexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385778">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385786">sync</span><span class="op" id="5385790">.</span><span class="ident" id="5385791">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5385798">machine</span>&nbsp;<span class="op" id="5385806">[</span><span class="op" id="5385807">]</span><span class="op" id="5385808">*</span><span class="ident" id="5385809">machine</span><br>
<span class="lineno">100</span><span class="op" id="5385817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5385820">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;source&nbsp;text&nbsp;used&nbsp;to&nbsp;compile&nbsp;the&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="5385894">func</span>&nbsp;<span class="op" id="5385899">(</span><span class="ident" id="5385900">re</span>&nbsp;<span class="op" id="5385903">*</span><span class="ident" id="5385904">Regexp</span><span class="op" id="5385910">)</span>&nbsp;<span class="ident" id="5385912">String</span><span class="op" id="5385918">(</span><span class="op" id="5385919">)</span>&nbsp;<span class="builtintype" id="5385921">string</span>&nbsp;<span class="op" id="5385928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5385931">return</span>&nbsp;<span class="ident" id="5385938">re</span><span class="op" id="5385940">.</span><span class="ident" id="5385941">expr</span><br>
<span class="lineno">105</span><span class="op" id="5385946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5385949">//&nbsp;Compile&nbsp;parses&nbsp;a&nbsp;regular&nbsp;expression&nbsp;and&nbsp;returns,&nbsp;if&nbsp;successful,</span><br>
<span class="lineno"></span><span class="comment" id="5386016">//&nbsp;a&nbsp;Regexp&nbsp;object&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;match&nbsp;against&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5386075">//</span><br>
<span class="lineno">110</span><span class="comment" id="5386078">//&nbsp;When&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5386141">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5386213">//&nbsp;it&nbsp;chooses&nbsp;the&nbsp;one&nbsp;that&nbsp;a&nbsp;backtracking&nbsp;search&nbsp;would&nbsp;have&nbsp;found&nbsp;first.</span><br>
<span class="lineno"></span><span class="comment" id="5386286">//&nbsp;This&nbsp;so-called&nbsp;leftmost-first&nbsp;matching&nbsp;is&nbsp;the&nbsp;same&nbsp;semantics</span><br>
<span class="lineno"></span><span class="comment" id="5386350">//&nbsp;that&nbsp;Perl,&nbsp;Python,&nbsp;and&nbsp;other&nbsp;implementations&nbsp;use,&nbsp;although&nbsp;this</span><br>
<span class="lineno">115</span><span class="comment" id="5386417">//&nbsp;package&nbsp;implements&nbsp;it&nbsp;without&nbsp;the&nbsp;expense&nbsp;of&nbsp;backtracking.</span><br>
<span class="lineno"></span><span class="comment" id="5386479">//&nbsp;For&nbsp;POSIX&nbsp;leftmost-longest&nbsp;matching,&nbsp;see&nbsp;CompilePOSIX.</span><br>
<span class="lineno"></span><span class="keyword" id="5386537">func</span>&nbsp;<span class="ident" id="5386542">Compile</span><span class="op" id="5386549">(</span><span class="ident" id="5386550">expr</span>&nbsp;<span class="builtintype" id="5386555">string</span><span class="op" id="5386561">)</span>&nbsp;<span class="op" id="5386563">(</span><span class="op" id="5386564">*</span><span class="ident" id="5386565">Regexp</span><span class="op" id="5386571">,</span>&nbsp;<span class="builtintype" id="5386573">error</span><span class="op" id="5386578">)</span>&nbsp;<span class="op" id="5386580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5386583">return</span>&nbsp;<span class="ident" id="5386590">compile</span><span class="op" id="5386597">(</span><span class="ident" id="5386598">expr</span><span class="op" id="5386602">,</span>&nbsp;<span class="ident" id="5386604">syntax</span><span class="op" id="5386610">.</span><span class="ident" id="5386611">Perl</span><span class="op" id="5386615">,</span>&nbsp;<span class="builtintype" id="5386617">false</span><span class="op" id="5386622">)</span><br>
<span class="lineno"></span><span class="op" id="5386624">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="5386627">//&nbsp;CompilePOSIX&nbsp;is&nbsp;like&nbsp;Compile&nbsp;but&nbsp;restricts&nbsp;the&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5386696">//&nbsp;to&nbsp;POSIX&nbsp;ERE&nbsp;(egrep)&nbsp;syntax&nbsp;and&nbsp;changes&nbsp;the&nbsp;match&nbsp;semantics&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5386762">//&nbsp;leftmost-longest.</span><br>
<span class="lineno"></span><span class="comment" id="5386783">//</span><br>
<span class="lineno">125</span><span class="comment" id="5386786">//&nbsp;That&nbsp;is,&nbsp;when&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5386858">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5386930">//&nbsp;it&nbsp;chooses&nbsp;a&nbsp;match&nbsp;that&nbsp;is&nbsp;as&nbsp;long&nbsp;as&nbsp;possible.</span><br>
<span class="lineno"></span><span class="comment" id="5386981">//&nbsp;This&nbsp;so-called&nbsp;leftmost-longest&nbsp;matching&nbsp;is&nbsp;the&nbsp;same&nbsp;semantics</span><br>
<span class="lineno"></span><span class="comment" id="5387047">//&nbsp;that&nbsp;early&nbsp;regular&nbsp;expression&nbsp;implementations&nbsp;used&nbsp;and&nbsp;that&nbsp;POSIX</span><br>
<span class="lineno">130</span><span class="comment" id="5387116">//&nbsp;specifies.</span><br>
<span class="lineno"></span><span class="comment" id="5387130">//</span><br>
<span class="lineno"></span><span class="comment" id="5387133">//&nbsp;However,&nbsp;there&nbsp;can&nbsp;be&nbsp;multiple&nbsp;leftmost-longest&nbsp;matches,&nbsp;with&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5387208">//&nbsp;submatch&nbsp;choices,&nbsp;and&nbsp;here&nbsp;this&nbsp;package&nbsp;diverges&nbsp;from&nbsp;POSIX.</span><br>
<span class="lineno"></span><span class="comment" id="5387272">//&nbsp;Among&nbsp;the&nbsp;possible&nbsp;leftmost-longest&nbsp;matches,&nbsp;this&nbsp;package&nbsp;chooses</span><br>
<span class="lineno">135</span><span class="comment" id="5387341">//&nbsp;the&nbsp;one&nbsp;that&nbsp;a&nbsp;backtracking&nbsp;search&nbsp;would&nbsp;have&nbsp;found&nbsp;first,&nbsp;while&nbsp;POSIX</span><br>
<span class="lineno"></span><span class="comment" id="5387415">//&nbsp;specifies&nbsp;that&nbsp;the&nbsp;match&nbsp;be&nbsp;chosen&nbsp;to&nbsp;maximize&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5387489">//&nbsp;subexpression,&nbsp;then&nbsp;the&nbsp;second,&nbsp;and&nbsp;so&nbsp;on&nbsp;from&nbsp;left&nbsp;to&nbsp;right.</span><br>
<span class="lineno"></span><span class="comment" id="5387554">//&nbsp;The&nbsp;POSIX&nbsp;rule&nbsp;is&nbsp;computationally&nbsp;prohibitive&nbsp;and&nbsp;not&nbsp;even&nbsp;well-defined.</span><br>
<span class="lineno"></span><span class="comment" id="5387630">//&nbsp;See&nbsp;http://swtch.com/~rsc/regexp/regexp2.html#posix&nbsp;for&nbsp;details.</span><br>
<span class="lineno">140</span><span class="keyword" id="5387698">func</span>&nbsp;<span class="ident" id="5387703">CompilePOSIX</span><span class="op" id="5387715">(</span><span class="ident" id="5387716">expr</span>&nbsp;<span class="builtintype" id="5387721">string</span><span class="op" id="5387727">)</span>&nbsp;<span class="op" id="5387729">(</span><span class="op" id="5387730">*</span><span class="ident" id="5387731">Regexp</span><span class="op" id="5387737">,</span>&nbsp;<span class="builtintype" id="5387739">error</span><span class="op" id="5387744">)</span>&nbsp;<span class="op" id="5387746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5387749">return</span>&nbsp;<span class="ident" id="5387756">compile</span><span class="op" id="5387763">(</span><span class="ident" id="5387764">expr</span><span class="op" id="5387768">,</span>&nbsp;<span class="ident" id="5387770">syntax</span><span class="op" id="5387776">.</span><span class="ident" id="5387777">POSIX</span><span class="op" id="5387782">,</span>&nbsp;<span class="builtintype" id="5387784">true</span><span class="op" id="5387788">)</span><br>
<span class="lineno"></span><span class="op" id="5387790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5387793">//&nbsp;Longest&nbsp;makes&nbsp;future&nbsp;searches&nbsp;prefer&nbsp;the&nbsp;leftmost-longest&nbsp;match.</span><br>
<span class="lineno">145</span><span class="comment" id="5387861">//&nbsp;That&nbsp;is,&nbsp;when&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5387933">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5388005">//&nbsp;it&nbsp;chooses&nbsp;a&nbsp;match&nbsp;that&nbsp;is&nbsp;as&nbsp;long&nbsp;as&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="5388056">func</span>&nbsp;<span class="op" id="5388061">(</span><span class="ident" id="5388062">re</span>&nbsp;<span class="op" id="5388065">*</span><span class="ident" id="5388066">Regexp</span><span class="op" id="5388072">)</span>&nbsp;<span class="ident" id="5388074">Longest</span><span class="op" id="5388081">(</span><span class="op" id="5388082">)</span>&nbsp;<span class="op" id="5388084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388087">re</span><span class="op" id="5388089">.</span><span class="ident" id="5388090">longest</span>&nbsp;<span class="op" id="5388098">=</span>&nbsp;<span class="builtintype" id="5388100">true</span><br>
<span class="lineno">150</span><span class="op" id="5388105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5388108">func</span>&nbsp;<span class="ident" id="5388113">compile</span><span class="op" id="5388120">(</span><span class="ident" id="5388121">expr</span>&nbsp;<span class="builtintype" id="5388126">string</span><span class="op" id="5388132">,</span>&nbsp;<span class="ident" id="5388134">mode</span>&nbsp;<span class="ident" id="5388139">syntax</span><span class="op" id="5388145">.</span><span class="ident" id="5388146">Flags</span><span class="op" id="5388151">,</span>&nbsp;<span class="ident" id="5388153">longest</span>&nbsp;<span class="builtintype" id="5388161">bool</span><span class="op" id="5388165">)</span>&nbsp;<span class="op" id="5388167">(</span><span class="op" id="5388168">*</span><span class="ident" id="5388169">Regexp</span><span class="op" id="5388175">,</span>&nbsp;<span class="builtintype" id="5388177">error</span><span class="op" id="5388182">)</span>&nbsp;<span class="op" id="5388184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388187">re</span><span class="op" id="5388189">,</span>&nbsp;<span class="ident" id="5388191">err</span>&nbsp;<span class="op" id="5388195">:=</span>&nbsp;<span class="ident" id="5388198">syntax</span><span class="op" id="5388204">.</span><span class="ident" id="5388205">Parse</span><span class="op" id="5388210">(</span><span class="ident" id="5388211">expr</span><span class="op" id="5388215">,</span>&nbsp;<span class="ident" id="5388217">mode</span><span class="op" id="5388221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5388224">if</span>&nbsp;<span class="ident" id="5388227">err</span>&nbsp;<span class="op" id="5388231">!=</span>&nbsp;<span class="ident" id="5388234">nil</span>&nbsp;<span class="op" id="5388238">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5388242">return</span>&nbsp;<span class="ident" id="5388249">nil</span><span class="op" id="5388252">,</span>&nbsp;<span class="ident" id="5388254">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5388259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388262">maxCap</span>&nbsp;<span class="op" id="5388269">:=</span>&nbsp;<span class="ident" id="5388272">re</span><span class="op" id="5388274">.</span><span class="ident" id="5388275">MaxCap</span><span class="op" id="5388281">(</span><span class="op" id="5388282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388285">capNames</span>&nbsp;<span class="op" id="5388294">:=</span>&nbsp;<span class="ident" id="5388297">re</span><span class="op" id="5388299">.</span><span class="ident" id="5388300">CapNames</span><span class="op" id="5388308">(</span><span class="op" id="5388309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388313">re</span>&nbsp;<span class="op" id="5388316">=</span>&nbsp;<span class="ident" id="5388318">re</span><span class="op" id="5388320">.</span><span class="ident" id="5388321">Simplify</span><span class="op" id="5388329">(</span><span class="op" id="5388330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388333">prog</span><span class="op" id="5388337">,</span>&nbsp;<span class="ident" id="5388339">err</span>&nbsp;<span class="op" id="5388343">:=</span>&nbsp;<span class="ident" id="5388346">syntax</span><span class="op" id="5388352">.</span><span class="ident" id="5388353">Compile</span><span class="op" id="5388360">(</span><span class="ident" id="5388361">re</span><span class="op" id="5388363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5388366">if</span>&nbsp;<span class="ident" id="5388369">err</span>&nbsp;<span class="op" id="5388373">!=</span>&nbsp;<span class="ident" id="5388376">nil</span>&nbsp;<span class="op" id="5388380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5388384">return</span>&nbsp;<span class="ident" id="5388391">nil</span><span class="op" id="5388394">,</span>&nbsp;<span class="ident" id="5388396">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5388401">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388404">regexp</span>&nbsp;<span class="op" id="5388411">:=</span>&nbsp;<span class="op" id="5388414">&amp;</span><span class="ident" id="5388415">Regexp</span><span class="op" id="5388421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388425">expr</span><span class="op" id="5388429">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388438">expr</span><span class="op" id="5388442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388446">prog</span><span class="op" id="5388450">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388459">prog</span><span class="op" id="5388463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388467">onepass</span><span class="op" id="5388474">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388480">compileOnePass</span><span class="op" id="5388494">(</span><span class="ident" id="5388495">prog</span><span class="op" id="5388499">)</span><span class="op" id="5388500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388504">numSubexp</span><span class="op" id="5388513">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5388517">maxCap</span><span class="op" id="5388523">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388527">subexpNames</span><span class="op" id="5388538">:</span>&nbsp;<span class="ident" id="5388540">capNames</span><span class="op" id="5388548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388552">cond</span><span class="op" id="5388556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388565">prog</span><span class="op" id="5388569">.</span><span class="ident" id="5388570">StartCond</span><span class="op" id="5388579">(</span><span class="op" id="5388580">)</span><span class="op" id="5388581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388585">longest</span><span class="op" id="5388592">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388598">longest</span><span class="op" id="5388605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5388608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5388611">if</span>&nbsp;<span class="ident" id="5388614">regexp</span><span class="op" id="5388620">.</span><span class="ident" id="5388621">onepass</span>&nbsp;<span class="op" id="5388629">==</span>&nbsp;<span class="ident" id="5388632">notOnePass</span>&nbsp;<span class="op" id="5388643">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388647">regexp</span><span class="op" id="5388653">.</span><span class="ident" id="5388654">prefix</span><span class="op" id="5388660">,</span>&nbsp;<span class="ident" id="5388662">regexp</span><span class="op" id="5388668">.</span><span class="ident" id="5388669">prefixComplete</span>&nbsp;<span class="op" id="5388684">=</span>&nbsp;<span class="ident" id="5388686">prog</span><span class="op" id="5388690">.</span><span class="ident" id="5388691">Prefix</span><span class="op" id="5388697">(</span><span class="op" id="5388698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5388701">}</span>&nbsp;<span class="keyword" id="5388703">else</span>&nbsp;<span class="op" id="5388708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388712">regexp</span><span class="op" id="5388718">.</span><span class="ident" id="5388719">prefix</span><span class="op" id="5388725">,</span>&nbsp;<span class="ident" id="5388727">regexp</span><span class="op" id="5388733">.</span><span class="ident" id="5388734">prefixComplete</span><span class="op" id="5388748">,</span>&nbsp;<span class="ident" id="5388750">regexp</span><span class="op" id="5388756">.</span><span class="ident" id="5388757">prefixEnd</span>&nbsp;<span class="op" id="5388767">=</span>&nbsp;<span class="ident" id="5388769">onePassPrefix</span><span class="op" id="5388782">(</span><span class="ident" id="5388783">prog</span><span class="op" id="5388787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5388790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5388793">if</span>&nbsp;<span class="ident" id="5388796">regexp</span><span class="op" id="5388802">.</span><span class="ident" id="5388803">prefix</span>&nbsp;<span class="op" id="5388810">!=</span>&nbsp;<span class="string" id="5388813">&#34;&#34;</span>&nbsp;<span class="op" id="5388816">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5388820">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;this&nbsp;allocation&nbsp;by&nbsp;adding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5388869">//&nbsp;IndexString&nbsp;to&nbsp;package&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388904">regexp</span><span class="op" id="5388910">.</span><span class="ident" id="5388911">prefixBytes</span>&nbsp;<span class="op" id="5388923">=</span>&nbsp;<span class="op" id="5388925">[</span><span class="op" id="5388926">]</span><span class="builtintype" id="5388927">byte</span><span class="op" id="5388931">(</span><span class="ident" id="5388932">regexp</span><span class="op" id="5388938">.</span><span class="ident" id="5388939">prefix</span><span class="op" id="5388945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388949">regexp</span><span class="op" id="5388955">.</span><span class="ident" id="5388956">prefixRune</span><span class="op" id="5388966">,</span>&nbsp;<span class="ident" id="5388968">_</span>&nbsp;<span class="op" id="5388970">=</span>&nbsp;<span class="ident" id="5388972">utf8</span><span class="op" id="5388976">.</span><span class="ident" id="5388977">DecodeRuneInString</span><span class="op" id="5388995">(</span><span class="ident" id="5388996">regexp</span><span class="op" id="5389002">.</span><span class="ident" id="5389003">prefix</span><span class="op" id="5389009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5389012">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389015">return</span>&nbsp;<span class="ident" id="5389022">regexp</span><span class="op" id="5389028">,</span>&nbsp;<span class="ident" id="5389030">nil</span><br>
<span class="lineno"></span><span class="op" id="5389034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5389037">//&nbsp;get&nbsp;returns&nbsp;a&nbsp;machine&nbsp;to&nbsp;use&nbsp;for&nbsp;matching&nbsp;re.</span><br>
<span class="lineno"></span><span class="comment" id="5389086">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;re&#39;s&nbsp;machine&nbsp;cache&nbsp;if&nbsp;possible,&nbsp;to&nbsp;avoid</span><br>
<span class="lineno">190</span><span class="comment" id="5389142">//&nbsp;unnecessary&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5389169">func</span>&nbsp;<span class="op" id="5389174">(</span><span class="ident" id="5389175">re</span>&nbsp;<span class="op" id="5389178">*</span><span class="ident" id="5389179">Regexp</span><span class="op" id="5389185">)</span>&nbsp;<span class="ident" id="5389187">get</span><span class="op" id="5389190">(</span><span class="op" id="5389191">)</span>&nbsp;<span class="op" id="5389193">*</span><span class="ident" id="5389194">machine</span>&nbsp;<span class="op" id="5389202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389205">re</span><span class="op" id="5389207">.</span><span class="ident" id="5389208">mu</span><span class="op" id="5389210">.</span><span class="ident" id="5389211">Lock</span><span class="op" id="5389215">(</span><span class="op" id="5389216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389219">if</span>&nbsp;<span class="ident" id="5389222">n</span>&nbsp;<span class="op" id="5389224">:=</span>&nbsp;<span class="builtinfunc" id="5389227">len</span><span class="op" id="5389230">(</span><span class="ident" id="5389231">re</span><span class="op" id="5389233">.</span><span class="ident" id="5389234">machine</span><span class="op" id="5389241">)</span><span class="op" id="5389242">;</span>&nbsp;<span class="ident" id="5389244">n</span>&nbsp;<span class="op" id="5389246">&gt;</span>&nbsp;<span class="num" id="5389248">0</span>&nbsp;<span class="op" id="5389250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389254">z</span>&nbsp;<span class="op" id="5389256">:=</span>&nbsp;<span class="ident" id="5389259">re</span><span class="op" id="5389261">.</span><span class="ident" id="5389262">machine</span><span class="op" id="5389269">[</span><span class="ident" id="5389270">n</span><span class="op" id="5389271">-</span><span class="num" id="5389272">1</span><span class="op" id="5389273">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389277">re</span><span class="op" id="5389279">.</span><span class="ident" id="5389280">machine</span>&nbsp;<span class="op" id="5389288">=</span>&nbsp;<span class="ident" id="5389290">re</span><span class="op" id="5389292">.</span><span class="ident" id="5389293">machine</span><span class="op" id="5389300">[</span><span class="op" id="5389301">:</span><span class="ident" id="5389302">n</span><span class="op" id="5389303">-</span><span class="num" id="5389304">1</span><span class="op" id="5389305">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389309">re</span><span class="op" id="5389311">.</span><span class="ident" id="5389312">mu</span><span class="op" id="5389314">.</span><span class="ident" id="5389315">Unlock</span><span class="op" id="5389321">(</span><span class="op" id="5389322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389326">return</span>&nbsp;<span class="ident" id="5389333">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5389336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389339">re</span><span class="op" id="5389341">.</span><span class="ident" id="5389342">mu</span><span class="op" id="5389344">.</span><span class="ident" id="5389345">Unlock</span><span class="op" id="5389351">(</span><span class="op" id="5389352">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389355">z</span>&nbsp;<span class="op" id="5389357">:=</span>&nbsp;<span class="ident" id="5389360">progMachine</span><span class="op" id="5389371">(</span><span class="ident" id="5389372">re</span><span class="op" id="5389374">.</span><span class="ident" id="5389375">prog</span><span class="op" id="5389379">,</span>&nbsp;<span class="ident" id="5389381">re</span><span class="op" id="5389383">.</span><span class="ident" id="5389384">onepass</span><span class="op" id="5389391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389394">z</span><span class="op" id="5389395">.</span><span class="ident" id="5389396">re</span>&nbsp;<span class="op" id="5389399">=</span>&nbsp;<span class="ident" id="5389401">re</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389405">return</span>&nbsp;<span class="ident" id="5389412">z</span><br>
<span class="lineno"></span><span class="op" id="5389414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="5389417">//&nbsp;put&nbsp;returns&nbsp;a&nbsp;machine&nbsp;to&nbsp;the&nbsp;re&#39;s&nbsp;machine&nbsp;cache.</span><br>
<span class="lineno"></span><span class="comment" id="5389469">//&nbsp;There&nbsp;is&nbsp;no&nbsp;attempt&nbsp;to&nbsp;limit&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;cache,&nbsp;so&nbsp;it&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5389535">//&nbsp;grow&nbsp;to&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;simultaneous&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="5389589">//&nbsp;run&nbsp;using&nbsp;re.&nbsp;&nbsp;(The&nbsp;cache&nbsp;empties&nbsp;when&nbsp;re&nbsp;gets&nbsp;garbage&nbsp;collected.)</span><br>
<span class="lineno"></span><span class="keyword" id="5389659">func</span>&nbsp;<span class="op" id="5389664">(</span><span class="ident" id="5389665">re</span>&nbsp;<span class="op" id="5389668">*</span><span class="ident" id="5389669">Regexp</span><span class="op" id="5389675">)</span>&nbsp;<span class="ident" id="5389677">put</span><span class="op" id="5389680">(</span><span class="ident" id="5389681">z</span>&nbsp;<span class="op" id="5389683">*</span><span class="ident" id="5389684">machine</span><span class="op" id="5389691">)</span>&nbsp;<span class="op" id="5389693">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389696">re</span><span class="op" id="5389698">.</span><span class="ident" id="5389699">mu</span><span class="op" id="5389701">.</span><span class="ident" id="5389702">Lock</span><span class="op" id="5389706">(</span><span class="op" id="5389707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389710">re</span><span class="op" id="5389712">.</span><span class="ident" id="5389713">machine</span>&nbsp;<span class="op" id="5389721">=</span>&nbsp;<span class="builtinfunc" id="5389723">append</span><span class="op" id="5389729">(</span><span class="ident" id="5389730">re</span><span class="op" id="5389732">.</span><span class="ident" id="5389733">machine</span><span class="op" id="5389740">,</span>&nbsp;<span class="ident" id="5389742">z</span><span class="op" id="5389743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389746">re</span><span class="op" id="5389748">.</span><span class="ident" id="5389749">mu</span><span class="op" id="5389751">.</span><span class="ident" id="5389752">Unlock</span><span class="op" id="5389758">(</span><span class="op" id="5389759">)</span><br>
<span class="lineno"></span><span class="op" id="5389761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="5389764">//&nbsp;MustCompile&nbsp;is&nbsp;like&nbsp;Compile&nbsp;but&nbsp;panics&nbsp;if&nbsp;the&nbsp;expression&nbsp;cannot&nbsp;be&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="5389842">//&nbsp;It&nbsp;simplifies&nbsp;safe&nbsp;initialization&nbsp;of&nbsp;global&nbsp;variables&nbsp;holding&nbsp;compiled&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5389924">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="keyword" id="5389940">func</span>&nbsp;<span class="ident" id="5389945">MustCompile</span><span class="op" id="5389956">(</span><span class="ident" id="5389957">str</span>&nbsp;<span class="builtintype" id="5389961">string</span><span class="op" id="5389967">)</span>&nbsp;<span class="op" id="5389969">*</span><span class="ident" id="5389970">Regexp</span>&nbsp;<span class="op" id="5389977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389980">regexp</span><span class="op" id="5389986">,</span>&nbsp;<span class="builtintype" id="5389988">error</span>&nbsp;<span class="op" id="5389994">:=</span>&nbsp;<span class="ident" id="5389997">Compile</span><span class="op" id="5390004">(</span><span class="ident" id="5390005">str</span><span class="op" id="5390008">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390011">if</span>&nbsp;<span class="builtintype" id="5390014">error</span>&nbsp;<span class="op" id="5390020">!=</span>&nbsp;<span class="ident" id="5390023">nil</span>&nbsp;<span class="op" id="5390027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5390031">panic</span><span class="op" id="5390036">(</span><span class="string" id="5390037">`regexp:&nbsp;Compile(`</span>&nbsp;<span class="op" id="5390056">+</span>&nbsp;<span class="ident" id="5390058">quote</span><span class="op" id="5390063">(</span><span class="ident" id="5390064">str</span><span class="op" id="5390067">)</span>&nbsp;<span class="op" id="5390069">+</span>&nbsp;<span class="string" id="5390071">`):&nbsp;`</span>&nbsp;<span class="op" id="5390077">+</span>&nbsp;<span class="builtintype" id="5390079">error</span><span class="op" id="5390084">.</span><span class="ident" id="5390085">Error</span><span class="op" id="5390090">(</span><span class="op" id="5390091">)</span><span class="op" id="5390092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5390095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390098">return</span>&nbsp;<span class="ident" id="5390105">regexp</span><br>
<span class="lineno"></span><span class="op" id="5390112">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="5390115">//&nbsp;MustCompilePOSIX&nbsp;is&nbsp;like&nbsp;CompilePOSIX&nbsp;but&nbsp;panics&nbsp;if&nbsp;the&nbsp;expression&nbsp;cannot&nbsp;be&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="5390203">//&nbsp;It&nbsp;simplifies&nbsp;safe&nbsp;initialization&nbsp;of&nbsp;global&nbsp;variables&nbsp;holding&nbsp;compiled&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5390285">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="keyword" id="5390301">func</span>&nbsp;<span class="ident" id="5390306">MustCompilePOSIX</span><span class="op" id="5390322">(</span><span class="ident" id="5390323">str</span>&nbsp;<span class="builtintype" id="5390327">string</span><span class="op" id="5390333">)</span>&nbsp;<span class="op" id="5390335">*</span><span class="ident" id="5390336">Regexp</span>&nbsp;<span class="op" id="5390343">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390346">regexp</span><span class="op" id="5390352">,</span>&nbsp;<span class="builtintype" id="5390354">error</span>&nbsp;<span class="op" id="5390360">:=</span>&nbsp;<span class="ident" id="5390363">CompilePOSIX</span><span class="op" id="5390375">(</span><span class="ident" id="5390376">str</span><span class="op" id="5390379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390382">if</span>&nbsp;<span class="builtintype" id="5390385">error</span>&nbsp;<span class="op" id="5390391">!=</span>&nbsp;<span class="ident" id="5390394">nil</span>&nbsp;<span class="op" id="5390398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5390402">panic</span><span class="op" id="5390407">(</span><span class="string" id="5390408">`regexp:&nbsp;CompilePOSIX(`</span>&nbsp;<span class="op" id="5390432">+</span>&nbsp;<span class="ident" id="5390434">quote</span><span class="op" id="5390439">(</span><span class="ident" id="5390440">str</span><span class="op" id="5390443">)</span>&nbsp;<span class="op" id="5390445">+</span>&nbsp;<span class="string" id="5390447">`):&nbsp;`</span>&nbsp;<span class="op" id="5390453">+</span>&nbsp;<span class="builtintype" id="5390455">error</span><span class="op" id="5390460">.</span><span class="ident" id="5390461">Error</span><span class="op" id="5390466">(</span><span class="op" id="5390467">)</span><span class="op" id="5390468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5390471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390474">return</span>&nbsp;<span class="ident" id="5390481">regexp</span><br>
<span class="lineno">235</span><span class="op" id="5390488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5390491">func</span>&nbsp;<span class="ident" id="5390496">quote</span><span class="op" id="5390501">(</span><span class="ident" id="5390502">s</span>&nbsp;<span class="builtintype" id="5390504">string</span><span class="op" id="5390510">)</span>&nbsp;<span class="builtintype" id="5390512">string</span>&nbsp;<span class="op" id="5390519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390522">if</span>&nbsp;<span class="ident" id="5390525">strconv</span><span class="op" id="5390532">.</span><span class="ident" id="5390533">CanBackquote</span><span class="op" id="5390545">(</span><span class="ident" id="5390546">s</span><span class="op" id="5390547">)</span>&nbsp;<span class="op" id="5390549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390553">return</span>&nbsp;<span class="string" id="5390560">&#34;`&#34;</span>&nbsp;<span class="op" id="5390564">+</span>&nbsp;<span class="ident" id="5390566">s</span>&nbsp;<span class="op" id="5390568">+</span>&nbsp;<span class="string" id="5390570">&#34;`&#34;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5390575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390578">return</span>&nbsp;<span class="ident" id="5390585">strconv</span><span class="op" id="5390592">.</span><span class="ident" id="5390593">Quote</span><span class="op" id="5390598">(</span><span class="ident" id="5390599">s</span><span class="op" id="5390600">)</span><br>
<span class="lineno"></span><span class="op" id="5390602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5390605">//&nbsp;NumSubexp&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;parenthesized&nbsp;subexpressions&nbsp;in&nbsp;this&nbsp;Regexp.</span><br>
<span class="lineno">245</span><span class="keyword" id="5390685">func</span>&nbsp;<span class="op" id="5390690">(</span><span class="ident" id="5390691">re</span>&nbsp;<span class="op" id="5390694">*</span><span class="ident" id="5390695">Regexp</span><span class="op" id="5390701">)</span>&nbsp;<span class="ident" id="5390703">NumSubexp</span><span class="op" id="5390712">(</span><span class="op" id="5390713">)</span>&nbsp;<span class="builtintype" id="5390715">int</span>&nbsp;<span class="op" id="5390719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390722">return</span>&nbsp;<span class="ident" id="5390729">re</span><span class="op" id="5390731">.</span><span class="ident" id="5390732">numSubexp</span><br>
<span class="lineno"></span><span class="op" id="5390742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5390745">//&nbsp;SubexpNames&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;parenthesized&nbsp;subexpressions</span><br>
<span class="lineno">250</span><span class="comment" id="5390814">//&nbsp;in&nbsp;this&nbsp;Regexp.&nbsp;&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;first&nbsp;sub-expression&nbsp;is&nbsp;names[1],</span><br>
<span class="lineno"></span><span class="comment" id="5390885">//&nbsp;so&nbsp;that&nbsp;if&nbsp;m&nbsp;is&nbsp;a&nbsp;match&nbsp;slice,&nbsp;the&nbsp;name&nbsp;for&nbsp;m[i]&nbsp;is&nbsp;SubexpNames()[i].</span><br>
<span class="lineno"></span><span class="comment" id="5390958">//&nbsp;Since&nbsp;the&nbsp;Regexp&nbsp;as&nbsp;a&nbsp;whole&nbsp;cannot&nbsp;be&nbsp;named,&nbsp;names[0]&nbsp;is&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="5391025">//&nbsp;the&nbsp;empty&nbsp;string.&nbsp;&nbsp;The&nbsp;slice&nbsp;should&nbsp;not&nbsp;be&nbsp;modified.</span><br>
<span class="lineno"></span><span class="keyword" id="5391081">func</span>&nbsp;<span class="op" id="5391086">(</span><span class="ident" id="5391087">re</span>&nbsp;<span class="op" id="5391090">*</span><span class="ident" id="5391091">Regexp</span><span class="op" id="5391097">)</span>&nbsp;<span class="ident" id="5391099">SubexpNames</span><span class="op" id="5391110">(</span><span class="op" id="5391111">)</span>&nbsp;<span class="op" id="5391113">[</span><span class="op" id="5391114">]</span><span class="builtintype" id="5391115">string</span>&nbsp;<span class="op" id="5391122">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391125">return</span>&nbsp;<span class="ident" id="5391132">re</span><span class="op" id="5391134">.</span><span class="ident" id="5391135">subexpNames</span><br>
<span class="lineno"></span><span class="op" id="5391147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5391150">const</span>&nbsp;<span class="ident" id="5391156">endOfText</span>&nbsp;<span class="builtintype" id="5391166">rune</span>&nbsp;<span class="op" id="5391171">=</span>&nbsp;<span class="op" id="5391173">-</span><span class="num" id="5391174">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="5391177">//&nbsp;input&nbsp;abstracts&nbsp;different&nbsp;representations&nbsp;of&nbsp;the&nbsp;input&nbsp;text.&nbsp;It&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="5391253">//&nbsp;one-character&nbsp;lookahead.</span><br>
<span class="lineno"></span><span class="keyword" id="5391281">type</span>&nbsp;<span class="ident" id="5391286">input</span>&nbsp;<span class="keyword" id="5391292">interface</span>&nbsp;<span class="op" id="5391302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391305">step</span><span class="op" id="5391309">(</span><span class="ident" id="5391310">pos</span>&nbsp;<span class="builtintype" id="5391314">int</span><span class="op" id="5391317">)</span>&nbsp;<span class="op" id="5391319">(</span><span class="ident" id="5391320">r</span>&nbsp;<span class="builtintype" id="5391322">rune</span><span class="op" id="5391326">,</span>&nbsp;<span class="ident" id="5391328">width</span>&nbsp;<span class="builtintype" id="5391334">int</span><span class="op" id="5391337">)</span>&nbsp;<span class="comment" id="5391339">//&nbsp;advance&nbsp;one&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391360">canCheckPrefix</span><span class="op" id="5391374">(</span><span class="op" id="5391375">)</span>&nbsp;<span class="builtintype" id="5391377">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5391394">//&nbsp;can&nbsp;we&nbsp;look&nbsp;ahead&nbsp;without&nbsp;losing&nbsp;info?</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391437">hasPrefix</span><span class="op" id="5391446">(</span><span class="ident" id="5391447">re</span>&nbsp;<span class="op" id="5391450">*</span><span class="ident" id="5391451">Regexp</span><span class="op" id="5391457">)</span>&nbsp;<span class="builtintype" id="5391459">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391465">index</span><span class="op" id="5391470">(</span><span class="ident" id="5391471">re</span>&nbsp;<span class="op" id="5391474">*</span><span class="ident" id="5391475">Regexp</span><span class="op" id="5391481">,</span>&nbsp;<span class="ident" id="5391483">pos</span>&nbsp;<span class="builtintype" id="5391487">int</span><span class="op" id="5391490">)</span>&nbsp;<span class="builtintype" id="5391492">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391497">context</span><span class="op" id="5391504">(</span><span class="ident" id="5391505">pos</span>&nbsp;<span class="builtintype" id="5391509">int</span><span class="op" id="5391512">)</span>&nbsp;<span class="ident" id="5391514">syntax</span><span class="op" id="5391520">.</span><span class="ident" id="5391521">EmptyOp</span><br>
<span class="lineno"></span><span class="op" id="5391529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="5391532">//&nbsp;inputString&nbsp;scans&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5391563">type</span>&nbsp;<span class="ident" id="5391568">inputString</span>&nbsp;<span class="keyword" id="5391580">struct</span>&nbsp;<span class="op" id="5391587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391590">str</span>&nbsp;<span class="builtintype" id="5391594">string</span><br>
<span class="lineno"></span><span class="op" id="5391601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="5391604">func</span>&nbsp;<span class="op" id="5391609">(</span><span class="ident" id="5391610">i</span>&nbsp;<span class="op" id="5391612">*</span><span class="ident" id="5391613">inputString</span><span class="op" id="5391624">)</span>&nbsp;<span class="ident" id="5391626">step</span><span class="op" id="5391630">(</span><span class="ident" id="5391631">pos</span>&nbsp;<span class="builtintype" id="5391635">int</span><span class="op" id="5391638">)</span>&nbsp;<span class="op" id="5391640">(</span><span class="builtintype" id="5391641">rune</span><span class="op" id="5391645">,</span>&nbsp;<span class="builtintype" id="5391647">int</span><span class="op" id="5391650">)</span>&nbsp;<span class="op" id="5391652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391655">if</span>&nbsp;<span class="ident" id="5391658">pos</span>&nbsp;<span class="op" id="5391662">&lt;</span>&nbsp;<span class="builtinfunc" id="5391664">len</span><span class="op" id="5391667">(</span><span class="ident" id="5391668">i</span><span class="op" id="5391669">.</span><span class="ident" id="5391670">str</span><span class="op" id="5391673">)</span>&nbsp;<span class="op" id="5391675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391679">c</span>&nbsp;<span class="op" id="5391681">:=</span>&nbsp;<span class="ident" id="5391684">i</span><span class="op" id="5391685">.</span><span class="ident" id="5391686">str</span><span class="op" id="5391689">[</span><span class="ident" id="5391690">pos</span><span class="op" id="5391693">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391697">if</span>&nbsp;<span class="ident" id="5391700">c</span>&nbsp;<span class="op" id="5391702">&lt;</span>&nbsp;<span class="ident" id="5391704">utf8</span><span class="op" id="5391708">.</span><span class="ident" id="5391709">RuneSelf</span>&nbsp;<span class="op" id="5391718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391723">return</span>&nbsp;<span class="builtintype" id="5391730">rune</span><span class="op" id="5391734">(</span><span class="ident" id="5391735">c</span><span class="op" id="5391736">)</span><span class="op" id="5391737">,</span>&nbsp;<span class="num" id="5391739">1</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391747">return</span>&nbsp;<span class="ident" id="5391754">utf8</span><span class="op" id="5391758">.</span><span class="ident" id="5391759">DecodeRuneInString</span><span class="op" id="5391777">(</span><span class="ident" id="5391778">i</span><span class="op" id="5391779">.</span><span class="ident" id="5391780">str</span><span class="op" id="5391783">[</span><span class="ident" id="5391784">pos</span><span class="op" id="5391787">:</span><span class="op" id="5391788">]</span><span class="op" id="5391789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391795">return</span>&nbsp;<span class="ident" id="5391802">endOfText</span><span class="op" id="5391811">,</span>&nbsp;<span class="num" id="5391813">0</span><br>
<span class="lineno"></span><span class="op" id="5391815">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="5391818">func</span>&nbsp;<span class="op" id="5391823">(</span><span class="ident" id="5391824">i</span>&nbsp;<span class="op" id="5391826">*</span><span class="ident" id="5391827">inputString</span><span class="op" id="5391838">)</span>&nbsp;<span class="ident" id="5391840">canCheckPrefix</span><span class="op" id="5391854">(</span><span class="op" id="5391855">)</span>&nbsp;<span class="builtintype" id="5391857">bool</span>&nbsp;<span class="op" id="5391862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391865">return</span>&nbsp;<span class="builtintype" id="5391872">true</span><br>
<span class="lineno"></span><span class="op" id="5391877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="5391880">func</span>&nbsp;<span class="op" id="5391885">(</span><span class="ident" id="5391886">i</span>&nbsp;<span class="op" id="5391888">*</span><span class="ident" id="5391889">inputString</span><span class="op" id="5391900">)</span>&nbsp;<span class="ident" id="5391902">hasPrefix</span><span class="op" id="5391911">(</span><span class="ident" id="5391912">re</span>&nbsp;<span class="op" id="5391915">*</span><span class="ident" id="5391916">Regexp</span><span class="op" id="5391922">)</span>&nbsp;<span class="builtintype" id="5391924">bool</span>&nbsp;<span class="op" id="5391929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391932">return</span>&nbsp;<span class="ident" id="5391939">strings</span><span class="op" id="5391946">.</span><span class="ident" id="5391947">HasPrefix</span><span class="op" id="5391956">(</span><span class="ident" id="5391957">i</span><span class="op" id="5391958">.</span><span class="ident" id="5391959">str</span><span class="op" id="5391962">,</span>&nbsp;<span class="ident" id="5391964">re</span><span class="op" id="5391966">.</span><span class="ident" id="5391967">prefix</span><span class="op" id="5391973">)</span><br>
<span class="lineno"></span><span class="op" id="5391975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5391978">func</span>&nbsp;<span class="op" id="5391983">(</span><span class="ident" id="5391984">i</span>&nbsp;<span class="op" id="5391986">*</span><span class="ident" id="5391987">inputString</span><span class="op" id="5391998">)</span>&nbsp;<span class="ident" id="5392000">index</span><span class="op" id="5392005">(</span><span class="ident" id="5392006">re</span>&nbsp;<span class="op" id="5392009">*</span><span class="ident" id="5392010">Regexp</span><span class="op" id="5392016">,</span>&nbsp;<span class="ident" id="5392018">pos</span>&nbsp;<span class="builtintype" id="5392022">int</span><span class="op" id="5392025">)</span>&nbsp;<span class="builtintype" id="5392027">int</span>&nbsp;<span class="op" id="5392031">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392034">return</span>&nbsp;<span class="ident" id="5392041">strings</span><span class="op" id="5392048">.</span><span class="ident" id="5392049">Index</span><span class="op" id="5392054">(</span><span class="ident" id="5392055">i</span><span class="op" id="5392056">.</span><span class="ident" id="5392057">str</span><span class="op" id="5392060">[</span><span class="ident" id="5392061">pos</span><span class="op" id="5392064">:</span><span class="op" id="5392065">]</span><span class="op" id="5392066">,</span>&nbsp;<span class="ident" id="5392068">re</span><span class="op" id="5392070">.</span><span class="ident" id="5392071">prefix</span><span class="op" id="5392077">)</span><br>
<span class="lineno"></span><span class="op" id="5392079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5392082">func</span>&nbsp;<span class="op" id="5392087">(</span><span class="ident" id="5392088">i</span>&nbsp;<span class="op" id="5392090">*</span><span class="ident" id="5392091">inputString</span><span class="op" id="5392102">)</span>&nbsp;<span class="ident" id="5392104">context</span><span class="op" id="5392111">(</span><span class="ident" id="5392112">pos</span>&nbsp;<span class="builtintype" id="5392116">int</span><span class="op" id="5392119">)</span>&nbsp;<span class="ident" id="5392121">syntax</span><span class="op" id="5392127">.</span><span class="ident" id="5392128">EmptyOp</span>&nbsp;<span class="op" id="5392136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392139">r1</span><span class="op" id="5392141">,</span>&nbsp;<span class="ident" id="5392143">r2</span>&nbsp;<span class="op" id="5392146">:=</span>&nbsp;<span class="ident" id="5392149">endOfText</span><span class="op" id="5392158">,</span>&nbsp;<span class="ident" id="5392160">endOfText</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392171">if</span>&nbsp;<span class="ident" id="5392174">pos</span>&nbsp;<span class="op" id="5392178">&gt;</span>&nbsp;<span class="num" id="5392180">0</span>&nbsp;<span class="op" id="5392182">&amp;&amp;</span>&nbsp;<span class="ident" id="5392185">pos</span>&nbsp;<span class="op" id="5392189">&lt;=</span>&nbsp;<span class="builtinfunc" id="5392192">len</span><span class="op" id="5392195">(</span><span class="ident" id="5392196">i</span><span class="op" id="5392197">.</span><span class="ident" id="5392198">str</span><span class="op" id="5392201">)</span>&nbsp;<span class="op" id="5392203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392207">r1</span><span class="op" id="5392209">,</span>&nbsp;<span class="ident" id="5392211">_</span>&nbsp;<span class="op" id="5392213">=</span>&nbsp;<span class="ident" id="5392215">utf8</span><span class="op" id="5392219">.</span><span class="ident" id="5392220">DecodeLastRuneInString</span><span class="op" id="5392242">(</span><span class="ident" id="5392243">i</span><span class="op" id="5392244">.</span><span class="ident" id="5392245">str</span><span class="op" id="5392248">[</span><span class="op" id="5392249">:</span><span class="ident" id="5392250">pos</span><span class="op" id="5392253">]</span><span class="op" id="5392254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5392257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392260">if</span>&nbsp;<span class="ident" id="5392263">pos</span>&nbsp;<span class="op" id="5392267">&lt;</span>&nbsp;<span class="builtinfunc" id="5392269">len</span><span class="op" id="5392272">(</span><span class="ident" id="5392273">i</span><span class="op" id="5392274">.</span><span class="ident" id="5392275">str</span><span class="op" id="5392278">)</span>&nbsp;<span class="op" id="5392280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392284">r2</span><span class="op" id="5392286">,</span>&nbsp;<span class="ident" id="5392288">_</span>&nbsp;<span class="op" id="5392290">=</span>&nbsp;<span class="ident" id="5392292">utf8</span><span class="op" id="5392296">.</span><span class="ident" id="5392297">DecodeRuneInString</span><span class="op" id="5392315">(</span><span class="ident" id="5392316">i</span><span class="op" id="5392317">.</span><span class="ident" id="5392318">str</span><span class="op" id="5392321">[</span><span class="ident" id="5392322">pos</span><span class="op" id="5392325">:</span><span class="op" id="5392326">]</span><span class="op" id="5392327">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5392330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392333">return</span>&nbsp;<span class="ident" id="5392340">syntax</span><span class="op" id="5392346">.</span><span class="ident" id="5392347">EmptyOpContext</span><span class="op" id="5392361">(</span><span class="ident" id="5392362">r1</span><span class="op" id="5392364">,</span>&nbsp;<span class="ident" id="5392366">r2</span><span class="op" id="5392368">)</span><br>
<span class="lineno"></span><span class="op" id="5392370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5392373">//&nbsp;inputBytes&nbsp;scans&nbsp;a&nbsp;byte&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="5392407">type</span>&nbsp;<span class="ident" id="5392412">inputBytes</span>&nbsp;<span class="keyword" id="5392423">struct</span>&nbsp;<span class="op" id="5392430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392433">str</span>&nbsp;<span class="op" id="5392437">[</span><span class="op" id="5392438">]</span><span class="builtintype" id="5392439">byte</span><br>
<span class="lineno"></span><span class="op" id="5392444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5392447">func</span>&nbsp;<span class="op" id="5392452">(</span><span class="ident" id="5392453">i</span>&nbsp;<span class="op" id="5392455">*</span><span class="ident" id="5392456">inputBytes</span><span class="op" id="5392466">)</span>&nbsp;<span class="ident" id="5392468">step</span><span class="op" id="5392472">(</span><span class="ident" id="5392473">pos</span>&nbsp;<span class="builtintype" id="5392477">int</span><span class="op" id="5392480">)</span>&nbsp;<span class="op" id="5392482">(</span><span class="builtintype" id="5392483">rune</span><span class="op" id="5392487">,</span>&nbsp;<span class="builtintype" id="5392489">int</span><span class="op" id="5392492">)</span>&nbsp;<span class="op" id="5392494">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392497">if</span>&nbsp;<span class="ident" id="5392500">pos</span>&nbsp;<span class="op" id="5392504">&lt;</span>&nbsp;<span class="builtinfunc" id="5392506">len</span><span class="op" id="5392509">(</span><span class="ident" id="5392510">i</span><span class="op" id="5392511">.</span><span class="ident" id="5392512">str</span><span class="op" id="5392515">)</span>&nbsp;<span class="op" id="5392517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392521">c</span>&nbsp;<span class="op" id="5392523">:=</span>&nbsp;<span class="ident" id="5392526">i</span><span class="op" id="5392527">.</span><span class="ident" id="5392528">str</span><span class="op" id="5392531">[</span><span class="ident" id="5392532">pos</span><span class="op" id="5392535">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392539">if</span>&nbsp;<span class="ident" id="5392542">c</span>&nbsp;<span class="op" id="5392544">&lt;</span>&nbsp;<span class="ident" id="5392546">utf8</span><span class="op" id="5392550">.</span><span class="ident" id="5392551">RuneSelf</span>&nbsp;<span class="op" id="5392560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392565">return</span>&nbsp;<span class="builtintype" id="5392572">rune</span><span class="op" id="5392576">(</span><span class="ident" id="5392577">c</span><span class="op" id="5392578">)</span><span class="op" id="5392579">,</span>&nbsp;<span class="num" id="5392581">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5392585">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392589">return</span>&nbsp;<span class="ident" id="5392596">utf8</span><span class="op" id="5392600">.</span><span class="ident" id="5392601">DecodeRune</span><span class="op" id="5392611">(</span><span class="ident" id="5392612">i</span><span class="op" id="5392613">.</span><span class="ident" id="5392614">str</span><span class="op" id="5392617">[</span><span class="ident" id="5392618">pos</span><span class="op" id="5392621">:</span><span class="op" id="5392622">]</span><span class="op" id="5392623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5392626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392629">return</span>&nbsp;<span class="ident" id="5392636">endOfText</span><span class="op" id="5392645">,</span>&nbsp;<span class="num" id="5392647">0</span><br>
<span class="lineno"></span><span class="op" id="5392649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="5392652">func</span>&nbsp;<span class="op" id="5392657">(</span><span class="ident" id="5392658">i</span>&nbsp;<span class="op" id="5392660">*</span><span class="ident" id="5392661">inputBytes</span><span class="op" id="5392671">)</span>&nbsp;<span class="ident" id="5392673">canCheckPrefix</span><span class="op" id="5392687">(</span><span class="op" id="5392688">)</span>&nbsp;<span class="builtintype" id="5392690">bool</span>&nbsp;<span class="op" id="5392695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392698">return</span>&nbsp;<span class="builtintype" id="5392705">true</span><br>
<span class="lineno"></span><span class="op" id="5392710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5392713">func</span>&nbsp;<span class="op" id="5392718">(</span><span class="ident" id="5392719">i</span>&nbsp;<span class="op" id="5392721">*</span><span class="ident" id="5392722">inputBytes</span><span class="op" id="5392732">)</span>&nbsp;<span class="ident" id="5392734">hasPrefix</span><span class="op" id="5392743">(</span><span class="ident" id="5392744">re</span>&nbsp;<span class="op" id="5392747">*</span><span class="ident" id="5392748">Regexp</span><span class="op" id="5392754">)</span>&nbsp;<span class="builtintype" id="5392756">bool</span>&nbsp;<span class="op" id="5392761">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392764">return</span>&nbsp;<span class="ident" id="5392771">bytes</span><span class="op" id="5392776">.</span><span class="ident" id="5392777">HasPrefix</span><span class="op" id="5392786">(</span><span class="ident" id="5392787">i</span><span class="op" id="5392788">.</span><span class="ident" id="5392789">str</span><span class="op" id="5392792">,</span>&nbsp;<span class="ident" id="5392794">re</span><span class="op" id="5392796">.</span><span class="ident" id="5392797">prefixBytes</span><span class="op" id="5392808">)</span><br>
<span class="lineno"></span><span class="op" id="5392810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5392813">func</span>&nbsp;<span class="op" id="5392818">(</span><span class="ident" id="5392819">i</span>&nbsp;<span class="op" id="5392821">*</span><span class="ident" id="5392822">inputBytes</span><span class="op" id="5392832">)</span>&nbsp;<span class="ident" id="5392834">index</span><span class="op" id="5392839">(</span><span class="ident" id="5392840">re</span>&nbsp;<span class="op" id="5392843">*</span><span class="ident" id="5392844">Regexp</span><span class="op" id="5392850">,</span>&nbsp;<span class="ident" id="5392852">pos</span>&nbsp;<span class="builtintype" id="5392856">int</span><span class="op" id="5392859">)</span>&nbsp;<span class="builtintype" id="5392861">int</span>&nbsp;<span class="op" id="5392865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392868">return</span>&nbsp;<span class="ident" id="5392875">bytes</span><span class="op" id="5392880">.</span><span class="ident" id="5392881">Index</span><span class="op" id="5392886">(</span><span class="ident" id="5392887">i</span><span class="op" id="5392888">.</span><span class="ident" id="5392889">str</span><span class="op" id="5392892">[</span><span class="ident" id="5392893">pos</span><span class="op" id="5392896">:</span><span class="op" id="5392897">]</span><span class="op" id="5392898">,</span>&nbsp;<span class="ident" id="5392900">re</span><span class="op" id="5392902">.</span><span class="ident" id="5392903">prefixBytes</span><span class="op" id="5392914">)</span><br>
<span class="lineno">335</span><span class="op" id="5392916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5392919">func</span>&nbsp;<span class="op" id="5392924">(</span><span class="ident" id="5392925">i</span>&nbsp;<span class="op" id="5392927">*</span><span class="ident" id="5392928">inputBytes</span><span class="op" id="5392938">)</span>&nbsp;<span class="ident" id="5392940">context</span><span class="op" id="5392947">(</span><span class="ident" id="5392948">pos</span>&nbsp;<span class="builtintype" id="5392952">int</span><span class="op" id="5392955">)</span>&nbsp;<span class="ident" id="5392957">syntax</span><span class="op" id="5392963">.</span><span class="ident" id="5392964">EmptyOp</span>&nbsp;<span class="op" id="5392972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392975">r1</span><span class="op" id="5392977">,</span>&nbsp;<span class="ident" id="5392979">r2</span>&nbsp;<span class="op" id="5392982">:=</span>&nbsp;<span class="ident" id="5392985">endOfText</span><span class="op" id="5392994">,</span>&nbsp;<span class="ident" id="5392996">endOfText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393007">if</span>&nbsp;<span class="ident" id="5393010">pos</span>&nbsp;<span class="op" id="5393014">&gt;</span>&nbsp;<span class="num" id="5393016">0</span>&nbsp;<span class="op" id="5393018">&amp;&amp;</span>&nbsp;<span class="ident" id="5393021">pos</span>&nbsp;<span class="op" id="5393025">&lt;=</span>&nbsp;<span class="builtinfunc" id="5393028">len</span><span class="op" id="5393031">(</span><span class="ident" id="5393032">i</span><span class="op" id="5393033">.</span><span class="ident" id="5393034">str</span><span class="op" id="5393037">)</span>&nbsp;<span class="op" id="5393039">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393043">r1</span><span class="op" id="5393045">,</span>&nbsp;<span class="ident" id="5393047">_</span>&nbsp;<span class="op" id="5393049">=</span>&nbsp;<span class="ident" id="5393051">utf8</span><span class="op" id="5393055">.</span><span class="ident" id="5393056">DecodeLastRune</span><span class="op" id="5393070">(</span><span class="ident" id="5393071">i</span><span class="op" id="5393072">.</span><span class="ident" id="5393073">str</span><span class="op" id="5393076">[</span><span class="op" id="5393077">:</span><span class="ident" id="5393078">pos</span><span class="op" id="5393081">]</span><span class="op" id="5393082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393088">if</span>&nbsp;<span class="ident" id="5393091">pos</span>&nbsp;<span class="op" id="5393095">&lt;</span>&nbsp;<span class="builtinfunc" id="5393097">len</span><span class="op" id="5393100">(</span><span class="ident" id="5393101">i</span><span class="op" id="5393102">.</span><span class="ident" id="5393103">str</span><span class="op" id="5393106">)</span>&nbsp;<span class="op" id="5393108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393112">r2</span><span class="op" id="5393114">,</span>&nbsp;<span class="ident" id="5393116">_</span>&nbsp;<span class="op" id="5393118">=</span>&nbsp;<span class="ident" id="5393120">utf8</span><span class="op" id="5393124">.</span><span class="ident" id="5393125">DecodeRune</span><span class="op" id="5393135">(</span><span class="ident" id="5393136">i</span><span class="op" id="5393137">.</span><span class="ident" id="5393138">str</span><span class="op" id="5393141">[</span><span class="ident" id="5393142">pos</span><span class="op" id="5393145">:</span><span class="op" id="5393146">]</span><span class="op" id="5393147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393150">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393153">return</span>&nbsp;<span class="ident" id="5393160">syntax</span><span class="op" id="5393166">.</span><span class="ident" id="5393167">EmptyOpContext</span><span class="op" id="5393181">(</span><span class="ident" id="5393182">r1</span><span class="op" id="5393184">,</span>&nbsp;<span class="ident" id="5393186">r2</span><span class="op" id="5393188">)</span><br>
<span class="lineno"></span><span class="op" id="5393190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5393193">//&nbsp;inputReader&nbsp;scans&nbsp;a&nbsp;RuneReader.</span><br>
<span class="lineno"></span><span class="keyword" id="5393228">type</span>&nbsp;<span class="ident" id="5393233">inputReader</span>&nbsp;<span class="keyword" id="5393245">struct</span>&nbsp;<span class="op" id="5393252">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393255">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393261">io</span><span class="op" id="5393263">.</span><span class="ident" id="5393264">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393276">atEOT</span>&nbsp;<span class="builtintype" id="5393282">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393288">pos</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5393294">int</span><br>
<span class="lineno"></span><span class="op" id="5393298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5393301">func</span>&nbsp;<span class="op" id="5393306">(</span><span class="ident" id="5393307">i</span>&nbsp;<span class="op" id="5393309">*</span><span class="ident" id="5393310">inputReader</span><span class="op" id="5393321">)</span>&nbsp;<span class="ident" id="5393323">step</span><span class="op" id="5393327">(</span><span class="ident" id="5393328">pos</span>&nbsp;<span class="builtintype" id="5393332">int</span><span class="op" id="5393335">)</span>&nbsp;<span class="op" id="5393337">(</span><span class="builtintype" id="5393338">rune</span><span class="op" id="5393342">,</span>&nbsp;<span class="builtintype" id="5393344">int</span><span class="op" id="5393347">)</span>&nbsp;<span class="op" id="5393349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393352">if</span>&nbsp;<span class="op" id="5393355">!</span><span class="ident" id="5393356">i</span><span class="op" id="5393357">.</span><span class="ident" id="5393358">atEOT</span>&nbsp;<span class="op" id="5393364">&amp;&amp;</span>&nbsp;<span class="ident" id="5393367">pos</span>&nbsp;<span class="op" id="5393371">!=</span>&nbsp;<span class="ident" id="5393374">i</span><span class="op" id="5393375">.</span><span class="ident" id="5393376">pos</span>&nbsp;<span class="op" id="5393380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393384">return</span>&nbsp;<span class="ident" id="5393391">endOfText</span><span class="op" id="5393400">,</span>&nbsp;<span class="num" id="5393402">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393406">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393409">r</span><span class="op" id="5393410">,</span>&nbsp;<span class="ident" id="5393412">w</span><span class="op" id="5393413">,</span>&nbsp;<span class="ident" id="5393415">err</span>&nbsp;<span class="op" id="5393419">:=</span>&nbsp;<span class="ident" id="5393422">i</span><span class="op" id="5393423">.</span><span class="ident" id="5393424">r</span><span class="op" id="5393425">.</span><span class="ident" id="5393426">ReadRune</span><span class="op" id="5393434">(</span><span class="op" id="5393435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393438">if</span>&nbsp;<span class="ident" id="5393441">err</span>&nbsp;<span class="op" id="5393445">!=</span>&nbsp;<span class="ident" id="5393448">nil</span>&nbsp;<span class="op" id="5393452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393456">i</span><span class="op" id="5393457">.</span><span class="ident" id="5393458">atEOT</span>&nbsp;<span class="op" id="5393464">=</span>&nbsp;<span class="builtintype" id="5393466">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393473">return</span>&nbsp;<span class="ident" id="5393480">endOfText</span><span class="op" id="5393489">,</span>&nbsp;<span class="num" id="5393491">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393494">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393497">i</span><span class="op" id="5393498">.</span><span class="ident" id="5393499">pos</span>&nbsp;<span class="op" id="5393503">+=</span>&nbsp;<span class="ident" id="5393506">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393509">return</span>&nbsp;<span class="ident" id="5393516">r</span><span class="op" id="5393517">,</span>&nbsp;<span class="ident" id="5393519">w</span><br>
<span class="lineno"></span><span class="op" id="5393521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5393524">func</span>&nbsp;<span class="op" id="5393529">(</span><span class="ident" id="5393530">i</span>&nbsp;<span class="op" id="5393532">*</span><span class="ident" id="5393533">inputReader</span><span class="op" id="5393544">)</span>&nbsp;<span class="ident" id="5393546">canCheckPrefix</span><span class="op" id="5393560">(</span><span class="op" id="5393561">)</span>&nbsp;<span class="builtintype" id="5393563">bool</span>&nbsp;<span class="op" id="5393568">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393571">return</span>&nbsp;<span class="builtintype" id="5393578">false</span><br>
<span class="lineno"></span><span class="op" id="5393584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5393587">func</span>&nbsp;<span class="op" id="5393592">(</span><span class="ident" id="5393593">i</span>&nbsp;<span class="op" id="5393595">*</span><span class="ident" id="5393596">inputReader</span><span class="op" id="5393607">)</span>&nbsp;<span class="ident" id="5393609">hasPrefix</span><span class="op" id="5393618">(</span><span class="ident" id="5393619">re</span>&nbsp;<span class="op" id="5393622">*</span><span class="ident" id="5393623">Regexp</span><span class="op" id="5393629">)</span>&nbsp;<span class="builtintype" id="5393631">bool</span>&nbsp;<span class="op" id="5393636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393639">return</span>&nbsp;<span class="builtintype" id="5393646">false</span><br>
<span class="lineno">375</span><span class="op" id="5393652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5393655">func</span>&nbsp;<span class="op" id="5393660">(</span><span class="ident" id="5393661">i</span>&nbsp;<span class="op" id="5393663">*</span><span class="ident" id="5393664">inputReader</span><span class="op" id="5393675">)</span>&nbsp;<span class="ident" id="5393677">index</span><span class="op" id="5393682">(</span><span class="ident" id="5393683">re</span>&nbsp;<span class="op" id="5393686">*</span><span class="ident" id="5393687">Regexp</span><span class="op" id="5393693">,</span>&nbsp;<span class="ident" id="5393695">pos</span>&nbsp;<span class="builtintype" id="5393699">int</span><span class="op" id="5393702">)</span>&nbsp;<span class="builtintype" id="5393704">int</span>&nbsp;<span class="op" id="5393708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393711">return</span>&nbsp;<span class="op" id="5393718">-</span><span class="num" id="5393719">1</span><br>
<span class="lineno"></span><span class="op" id="5393721">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5393724">func</span>&nbsp;<span class="op" id="5393729">(</span><span class="ident" id="5393730">i</span>&nbsp;<span class="op" id="5393732">*</span><span class="ident" id="5393733">inputReader</span><span class="op" id="5393744">)</span>&nbsp;<span class="ident" id="5393746">context</span><span class="op" id="5393753">(</span><span class="ident" id="5393754">pos</span>&nbsp;<span class="builtintype" id="5393758">int</span><span class="op" id="5393761">)</span>&nbsp;<span class="ident" id="5393763">syntax</span><span class="op" id="5393769">.</span><span class="ident" id="5393770">EmptyOp</span>&nbsp;<span class="op" id="5393778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393781">return</span>&nbsp;<span class="num" id="5393788">0</span><br>
<span class="lineno"></span><span class="op" id="5393790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5393793">//&nbsp;LiteralPrefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;must&nbsp;begin&nbsp;any&nbsp;match</span><br>
<span class="lineno"></span><span class="comment" id="5393861">//&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;re.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;boolean&nbsp;true&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5393930">//&nbsp;literal&nbsp;string&nbsp;comprises&nbsp;the&nbsp;entire&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="5393989">func</span>&nbsp;<span class="op" id="5393994">(</span><span class="ident" id="5393995">re</span>&nbsp;<span class="op" id="5393998">*</span><span class="ident" id="5393999">Regexp</span><span class="op" id="5394005">)</span>&nbsp;<span class="ident" id="5394007">LiteralPrefix</span><span class="op" id="5394020">(</span><span class="op" id="5394021">)</span>&nbsp;<span class="op" id="5394023">(</span><span class="ident" id="5394024">prefix</span>&nbsp;<span class="builtintype" id="5394031">string</span><span class="op" id="5394037">,</span>&nbsp;<span class="ident" id="5394039">complete</span>&nbsp;<span class="builtintype" id="5394048">bool</span><span class="op" id="5394052">)</span>&nbsp;<span class="op" id="5394054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394057">return</span>&nbsp;<span class="ident" id="5394064">re</span><span class="op" id="5394066">.</span><span class="ident" id="5394067">prefix</span><span class="op" id="5394073">,</span>&nbsp;<span class="ident" id="5394075">re</span><span class="op" id="5394077">.</span><span class="ident" id="5394078">prefixComplete</span><br>
<span class="lineno">390</span><span class="op" id="5394093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5394096">//&nbsp;MatchReader&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;text&nbsp;read&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5394167">//&nbsp;RuneReader.</span><br>
<span class="lineno"></span><span class="keyword" id="5394182">func</span>&nbsp;<span class="op" id="5394187">(</span><span class="ident" id="5394188">re</span>&nbsp;<span class="op" id="5394191">*</span><span class="ident" id="5394192">Regexp</span><span class="op" id="5394198">)</span>&nbsp;<span class="ident" id="5394200">MatchReader</span><span class="op" id="5394211">(</span><span class="ident" id="5394212">r</span>&nbsp;<span class="ident" id="5394214">io</span><span class="op" id="5394216">.</span><span class="ident" id="5394217">RuneReader</span><span class="op" id="5394227">)</span>&nbsp;<span class="builtintype" id="5394229">bool</span>&nbsp;<span class="op" id="5394234">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394237">return</span>&nbsp;<span class="ident" id="5394244">re</span><span class="op" id="5394246">.</span><span class="ident" id="5394247">doExecute</span><span class="op" id="5394256">(</span><span class="ident" id="5394257">r</span><span class="op" id="5394258">,</span>&nbsp;<span class="ident" id="5394260">nil</span><span class="op" id="5394263">,</span>&nbsp;<span class="string" id="5394265">&#34;&#34;</span><span class="op" id="5394267">,</span>&nbsp;<span class="num" id="5394269">0</span><span class="op" id="5394270">,</span>&nbsp;<span class="num" id="5394272">0</span><span class="op" id="5394273">)</span>&nbsp;<span class="op" id="5394275">!=</span>&nbsp;<span class="ident" id="5394278">nil</span><br>
<span class="lineno"></span><span class="op" id="5394282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5394285">//&nbsp;MatchString&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5394349">func</span>&nbsp;<span class="op" id="5394354">(</span><span class="ident" id="5394355">re</span>&nbsp;<span class="op" id="5394358">*</span><span class="ident" id="5394359">Regexp</span><span class="op" id="5394365">)</span>&nbsp;<span class="ident" id="5394367">MatchString</span><span class="op" id="5394378">(</span><span class="ident" id="5394379">s</span>&nbsp;<span class="builtintype" id="5394381">string</span><span class="op" id="5394387">)</span>&nbsp;<span class="builtintype" id="5394389">bool</span>&nbsp;<span class="op" id="5394394">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394397">return</span>&nbsp;<span class="ident" id="5394404">re</span><span class="op" id="5394406">.</span><span class="ident" id="5394407">doExecute</span><span class="op" id="5394416">(</span><span class="ident" id="5394417">nil</span><span class="op" id="5394420">,</span>&nbsp;<span class="ident" id="5394422">nil</span><span class="op" id="5394425">,</span>&nbsp;<span class="ident" id="5394427">s</span><span class="op" id="5394428">,</span>&nbsp;<span class="num" id="5394430">0</span><span class="op" id="5394431">,</span>&nbsp;<span class="num" id="5394433">0</span><span class="op" id="5394434">)</span>&nbsp;<span class="op" id="5394436">!=</span>&nbsp;<span class="ident" id="5394439">nil</span><br>
<span class="lineno"></span><span class="op" id="5394443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5394446">//&nbsp;Match&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;byte&nbsp;slice&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5394508">func</span>&nbsp;<span class="op" id="5394513">(</span><span class="ident" id="5394514">re</span>&nbsp;<span class="op" id="5394517">*</span><span class="ident" id="5394518">Regexp</span><span class="op" id="5394524">)</span>&nbsp;<span class="ident" id="5394526">Match</span><span class="op" id="5394531">(</span><span class="ident" id="5394532">b</span>&nbsp;<span class="op" id="5394534">[</span><span class="op" id="5394535">]</span><span class="builtintype" id="5394536">byte</span><span class="op" id="5394540">)</span>&nbsp;<span class="builtintype" id="5394542">bool</span>&nbsp;<span class="op" id="5394547">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394550">return</span>&nbsp;<span class="ident" id="5394557">re</span><span class="op" id="5394559">.</span><span class="ident" id="5394560">doExecute</span><span class="op" id="5394569">(</span><span class="ident" id="5394570">nil</span><span class="op" id="5394573">,</span>&nbsp;<span class="ident" id="5394575">b</span><span class="op" id="5394576">,</span>&nbsp;<span class="string" id="5394578">&#34;&#34;</span><span class="op" id="5394580">,</span>&nbsp;<span class="num" id="5394582">0</span><span class="op" id="5394583">,</span>&nbsp;<span class="num" id="5394585">0</span><span class="op" id="5394586">)</span>&nbsp;<span class="op" id="5394588">!=</span>&nbsp;<span class="ident" id="5394591">nil</span><br>
<span class="lineno"></span><span class="op" id="5394595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5394598">//&nbsp;MatchReader&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression&nbsp;matches&nbsp;the&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5394674">//&nbsp;read&nbsp;by&nbsp;the&nbsp;RuneReader.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and</span><br>
<span class="lineno">410</span><span class="comment" id="5394751">//&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5394781">func</span>&nbsp;<span class="ident" id="5394786">MatchReader</span><span class="op" id="5394797">(</span><span class="ident" id="5394798">pattern</span>&nbsp;<span class="builtintype" id="5394806">string</span><span class="op" id="5394812">,</span>&nbsp;<span class="ident" id="5394814">r</span>&nbsp;<span class="ident" id="5394816">io</span><span class="op" id="5394818">.</span><span class="ident" id="5394819">RuneReader</span><span class="op" id="5394829">)</span>&nbsp;<span class="op" id="5394831">(</span><span class="ident" id="5394832">matched</span>&nbsp;<span class="builtintype" id="5394840">bool</span><span class="op" id="5394844">,</span>&nbsp;<span class="ident" id="5394846">err</span>&nbsp;<span class="builtintype" id="5394850">error</span><span class="op" id="5394855">)</span>&nbsp;<span class="op" id="5394857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394860">re</span><span class="op" id="5394862">,</span>&nbsp;<span class="ident" id="5394864">err</span>&nbsp;<span class="op" id="5394868">:=</span>&nbsp;<span class="ident" id="5394871">Compile</span><span class="op" id="5394878">(</span><span class="ident" id="5394879">pattern</span><span class="op" id="5394886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394889">if</span>&nbsp;<span class="ident" id="5394892">err</span>&nbsp;<span class="op" id="5394896">!=</span>&nbsp;<span class="ident" id="5394899">nil</span>&nbsp;<span class="op" id="5394903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394907">return</span>&nbsp;<span class="builtintype" id="5394914">false</span><span class="op" id="5394919">,</span>&nbsp;<span class="ident" id="5394921">err</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394929">return</span>&nbsp;<span class="ident" id="5394936">re</span><span class="op" id="5394938">.</span><span class="ident" id="5394939">MatchReader</span><span class="op" id="5394950">(</span><span class="ident" id="5394951">r</span><span class="op" id="5394952">)</span><span class="op" id="5394953">,</span>&nbsp;<span class="ident" id="5394955">nil</span><br>
<span class="lineno"></span><span class="op" id="5394959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5394962">//&nbsp;MatchString&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression</span><br>
<span class="lineno">420</span><span class="comment" id="5395021">//&nbsp;matches&nbsp;a&nbsp;string.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="5395073">//&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5395122">func</span>&nbsp;<span class="ident" id="5395127">MatchString</span><span class="op" id="5395138">(</span><span class="ident" id="5395139">pattern</span>&nbsp;<span class="builtintype" id="5395147">string</span><span class="op" id="5395153">,</span>&nbsp;<span class="ident" id="5395155">s</span>&nbsp;<span class="builtintype" id="5395157">string</span><span class="op" id="5395163">)</span>&nbsp;<span class="op" id="5395165">(</span><span class="ident" id="5395166">matched</span>&nbsp;<span class="builtintype" id="5395174">bool</span><span class="op" id="5395178">,</span>&nbsp;<span class="ident" id="5395180">err</span>&nbsp;<span class="builtintype" id="5395184">error</span><span class="op" id="5395189">)</span>&nbsp;<span class="op" id="5395191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395194">re</span><span class="op" id="5395196">,</span>&nbsp;<span class="ident" id="5395198">err</span>&nbsp;<span class="op" id="5395202">:=</span>&nbsp;<span class="ident" id="5395205">Compile</span><span class="op" id="5395212">(</span><span class="ident" id="5395213">pattern</span><span class="op" id="5395220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395223">if</span>&nbsp;<span class="ident" id="5395226">err</span>&nbsp;<span class="op" id="5395230">!=</span>&nbsp;<span class="ident" id="5395233">nil</span>&nbsp;<span class="op" id="5395237">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395241">return</span>&nbsp;<span class="builtintype" id="5395248">false</span><span class="op" id="5395253">,</span>&nbsp;<span class="ident" id="5395255">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395263">return</span>&nbsp;<span class="ident" id="5395270">re</span><span class="op" id="5395272">.</span><span class="ident" id="5395273">MatchString</span><span class="op" id="5395284">(</span><span class="ident" id="5395285">s</span><span class="op" id="5395286">)</span><span class="op" id="5395287">,</span>&nbsp;<span class="ident" id="5395289">nil</span><br>
<span class="lineno"></span><span class="op" id="5395293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="5395296">//&nbsp;Match&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5395349">//&nbsp;matches&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="5395405">//&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5395454">func</span>&nbsp;<span class="ident" id="5395459">Match</span><span class="op" id="5395464">(</span><span class="ident" id="5395465">pattern</span>&nbsp;<span class="builtintype" id="5395473">string</span><span class="op" id="5395479">,</span>&nbsp;<span class="ident" id="5395481">b</span>&nbsp;<span class="op" id="5395483">[</span><span class="op" id="5395484">]</span><span class="builtintype" id="5395485">byte</span><span class="op" id="5395489">)</span>&nbsp;<span class="op" id="5395491">(</span><span class="ident" id="5395492">matched</span>&nbsp;<span class="builtintype" id="5395500">bool</span><span class="op" id="5395504">,</span>&nbsp;<span class="ident" id="5395506">err</span>&nbsp;<span class="builtintype" id="5395510">error</span><span class="op" id="5395515">)</span>&nbsp;<span class="op" id="5395517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395520">re</span><span class="op" id="5395522">,</span>&nbsp;<span class="ident" id="5395524">err</span>&nbsp;<span class="op" id="5395528">:=</span>&nbsp;<span class="ident" id="5395531">Compile</span><span class="op" id="5395538">(</span><span class="ident" id="5395539">pattern</span><span class="op" id="5395546">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395549">if</span>&nbsp;<span class="ident" id="5395552">err</span>&nbsp;<span class="op" id="5395556">!=</span>&nbsp;<span class="ident" id="5395559">nil</span>&nbsp;<span class="op" id="5395563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395567">return</span>&nbsp;<span class="builtintype" id="5395574">false</span><span class="op" id="5395579">,</span>&nbsp;<span class="ident" id="5395581">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395589">return</span>&nbsp;<span class="ident" id="5395596">re</span><span class="op" id="5395598">.</span><span class="ident" id="5395599">Match</span><span class="op" id="5395604">(</span><span class="ident" id="5395605">b</span><span class="op" id="5395606">)</span><span class="op" id="5395607">,</span>&nbsp;<span class="ident" id="5395609">nil</span><br>
<span class="lineno"></span><span class="op" id="5395613">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="5395616">//&nbsp;ReplaceAllString&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5395691">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;string&nbsp;repl.&nbsp;&nbsp;Inside&nbsp;repl,&nbsp;$&nbsp;signs&nbsp;are&nbsp;interpreted&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5395769">//&nbsp;in&nbsp;Expand,&nbsp;so&nbsp;for&nbsp;instance&nbsp;$1&nbsp;represents&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;submatch.</span><br>
<span class="lineno"></span><span class="keyword" id="5395845">func</span>&nbsp;<span class="op" id="5395850">(</span><span class="ident" id="5395851">re</span>&nbsp;<span class="op" id="5395854">*</span><span class="ident" id="5395855">Regexp</span><span class="op" id="5395861">)</span>&nbsp;<span class="ident" id="5395863">ReplaceAllString</span><span class="op" id="5395879">(</span><span class="ident" id="5395880">src</span><span class="op" id="5395883">,</span>&nbsp;<span class="ident" id="5395885">repl</span>&nbsp;<span class="builtintype" id="5395890">string</span><span class="op" id="5395896">)</span>&nbsp;<span class="builtintype" id="5395898">string</span>&nbsp;<span class="op" id="5395905">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395908">n</span>&nbsp;<span class="op" id="5395910">:=</span>&nbsp;<span class="num" id="5395913">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395916">if</span>&nbsp;<span class="ident" id="5395919">strings</span><span class="op" id="5395926">.</span><span class="ident" id="5395927">Index</span><span class="op" id="5395932">(</span><span class="ident" id="5395933">repl</span><span class="op" id="5395937">,</span>&nbsp;<span class="string" id="5395939">&#34;$&#34;</span><span class="op" id="5395942">)</span>&nbsp;<span class="op" id="5395944">&gt;=</span>&nbsp;<span class="num" id="5395947">0</span>&nbsp;<span class="op" id="5395949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395953">n</span>&nbsp;<span class="op" id="5395955">=</span>&nbsp;<span class="num" id="5395957">2</span>&nbsp;<span class="op" id="5395959">*</span>&nbsp;<span class="op" id="5395961">(</span><span class="ident" id="5395962">re</span><span class="op" id="5395964">.</span><span class="ident" id="5395965">numSubexp</span>&nbsp;<span class="op" id="5395975">+</span>&nbsp;<span class="num" id="5395977">1</span><span class="op" id="5395978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395984">b</span>&nbsp;<span class="op" id="5395986">:=</span>&nbsp;<span class="ident" id="5395989">re</span><span class="op" id="5395991">.</span><span class="ident" id="5395992">replaceAll</span><span class="op" id="5396002">(</span><span class="ident" id="5396003">nil</span><span class="op" id="5396006">,</span>&nbsp;<span class="ident" id="5396008">src</span><span class="op" id="5396011">,</span>&nbsp;<span class="ident" id="5396013">n</span><span class="op" id="5396014">,</span>&nbsp;<span class="keyword" id="5396016">func</span><span class="op" id="5396020">(</span><span class="ident" id="5396021">dst</span>&nbsp;<span class="op" id="5396025">[</span><span class="op" id="5396026">]</span><span class="builtintype" id="5396027">byte</span><span class="op" id="5396031">,</span>&nbsp;<span class="ident" id="5396033">match</span>&nbsp;<span class="op" id="5396039">[</span><span class="op" id="5396040">]</span><span class="builtintype" id="5396041">int</span><span class="op" id="5396044">)</span>&nbsp;<span class="op" id="5396046">[</span><span class="op" id="5396047">]</span><span class="builtintype" id="5396048">byte</span>&nbsp;<span class="op" id="5396053">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396057">return</span>&nbsp;<span class="ident" id="5396064">re</span><span class="op" id="5396066">.</span><span class="ident" id="5396067">expand</span><span class="op" id="5396073">(</span><span class="ident" id="5396074">dst</span><span class="op" id="5396077">,</span>&nbsp;<span class="ident" id="5396079">repl</span><span class="op" id="5396083">,</span>&nbsp;<span class="ident" id="5396085">nil</span><span class="op" id="5396088">,</span>&nbsp;<span class="ident" id="5396090">src</span><span class="op" id="5396093">,</span>&nbsp;<span class="ident" id="5396095">match</span><span class="op" id="5396100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5396103">}</span><span class="op" id="5396104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396107">return</span>&nbsp;<span class="builtintype" id="5396114">string</span><span class="op" id="5396120">(</span><span class="ident" id="5396121">b</span><span class="op" id="5396122">)</span><br>
<span class="lineno"></span><span class="op" id="5396124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="5396127">//&nbsp;ReplaceAllLiteralString&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5396209">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;string&nbsp;repl.&nbsp;&nbsp;The&nbsp;replacement&nbsp;repl&nbsp;is&nbsp;substituted&nbsp;directly,</span><br>
<span class="lineno"></span><span class="comment" id="5396293">//&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5396318">func</span>&nbsp;<span class="op" id="5396323">(</span><span class="ident" id="5396324">re</span>&nbsp;<span class="op" id="5396327">*</span><span class="ident" id="5396328">Regexp</span><span class="op" id="5396334">)</span>&nbsp;<span class="ident" id="5396336">ReplaceAllLiteralString</span><span class="op" id="5396359">(</span><span class="ident" id="5396360">src</span><span class="op" id="5396363">,</span>&nbsp;<span class="ident" id="5396365">repl</span>&nbsp;<span class="builtintype" id="5396370">string</span><span class="op" id="5396376">)</span>&nbsp;<span class="builtintype" id="5396378">string</span>&nbsp;<span class="op" id="5396385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396388">return</span>&nbsp;<span class="builtintype" id="5396395">string</span><span class="op" id="5396401">(</span><span class="ident" id="5396402">re</span><span class="op" id="5396404">.</span><span class="ident" id="5396405">replaceAll</span><span class="op" id="5396415">(</span><span class="ident" id="5396416">nil</span><span class="op" id="5396419">,</span>&nbsp;<span class="ident" id="5396421">src</span><span class="op" id="5396424">,</span>&nbsp;<span class="num" id="5396426">2</span><span class="op" id="5396427">,</span>&nbsp;<span class="keyword" id="5396429">func</span><span class="op" id="5396433">(</span><span class="ident" id="5396434">dst</span>&nbsp;<span class="op" id="5396438">[</span><span class="op" id="5396439">]</span><span class="builtintype" id="5396440">byte</span><span class="op" id="5396444">,</span>&nbsp;<span class="ident" id="5396446">match</span>&nbsp;<span class="op" id="5396452">[</span><span class="op" id="5396453">]</span><span class="builtintype" id="5396454">int</span><span class="op" id="5396457">)</span>&nbsp;<span class="op" id="5396459">[</span><span class="op" id="5396460">]</span><span class="builtintype" id="5396461">byte</span>&nbsp;<span class="op" id="5396466">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396470">return</span>&nbsp;<span class="builtinfunc" id="5396477">append</span><span class="op" id="5396483">(</span><span class="ident" id="5396484">dst</span><span class="op" id="5396487">,</span>&nbsp;<span class="ident" id="5396489">repl</span><span class="op" id="5396493">...</span><span class="op" id="5396496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5396499">}</span><span class="op" id="5396500">)</span><span class="op" id="5396501">)</span><br>
<span class="lineno"></span><span class="op" id="5396503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5396506">//&nbsp;ReplaceAllStringFunc&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src&nbsp;in&nbsp;which&nbsp;all&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno">465</span><span class="comment" id="5396580">//&nbsp;Regexp&nbsp;have&nbsp;been&nbsp;replaced&nbsp;by&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;function&nbsp;repl&nbsp;applied</span><br>
<span class="lineno"></span><span class="comment" id="5396654">//&nbsp;to&nbsp;the&nbsp;matched&nbsp;substring.&nbsp;&nbsp;The&nbsp;replacement&nbsp;returned&nbsp;by&nbsp;repl&nbsp;is&nbsp;substituted</span><br>
<span class="lineno"></span><span class="comment" id="5396732">//&nbsp;directly,&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5396767">func</span>&nbsp;<span class="op" id="5396772">(</span><span class="ident" id="5396773">re</span>&nbsp;<span class="op" id="5396776">*</span><span class="ident" id="5396777">Regexp</span><span class="op" id="5396783">)</span>&nbsp;<span class="ident" id="5396785">ReplaceAllStringFunc</span><span class="op" id="5396805">(</span><span class="ident" id="5396806">src</span>&nbsp;<span class="builtintype" id="5396810">string</span><span class="op" id="5396816">,</span>&nbsp;<span class="ident" id="5396818">repl</span>&nbsp;<span class="keyword" id="5396823">func</span><span class="op" id="5396827">(</span><span class="builtintype" id="5396828">string</span><span class="op" id="5396834">)</span>&nbsp;<span class="builtintype" id="5396836">string</span><span class="op" id="5396842">)</span>&nbsp;<span class="builtintype" id="5396844">string</span>&nbsp;<span class="op" id="5396851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396854">b</span>&nbsp;<span class="op" id="5396856">:=</span>&nbsp;<span class="ident" id="5396859">re</span><span class="op" id="5396861">.</span><span class="ident" id="5396862">replaceAll</span><span class="op" id="5396872">(</span><span class="ident" id="5396873">nil</span><span class="op" id="5396876">,</span>&nbsp;<span class="ident" id="5396878">src</span><span class="op" id="5396881">,</span>&nbsp;<span class="num" id="5396883">2</span><span class="op" id="5396884">,</span>&nbsp;<span class="keyword" id="5396886">func</span><span class="op" id="5396890">(</span><span class="ident" id="5396891">dst</span>&nbsp;<span class="op" id="5396895">[</span><span class="op" id="5396896">]</span><span class="builtintype" id="5396897">byte</span><span class="op" id="5396901">,</span>&nbsp;<span class="ident" id="5396903">match</span>&nbsp;<span class="op" id="5396909">[</span><span class="op" id="5396910">]</span><span class="builtintype" id="5396911">int</span><span class="op" id="5396914">)</span>&nbsp;<span class="op" id="5396916">[</span><span class="op" id="5396917">]</span><span class="builtintype" id="5396918">byte</span>&nbsp;<span class="op" id="5396923">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396927">return</span>&nbsp;<span class="builtinfunc" id="5396934">append</span><span class="op" id="5396940">(</span><span class="ident" id="5396941">dst</span><span class="op" id="5396944">,</span>&nbsp;<span class="ident" id="5396946">repl</span><span class="op" id="5396950">(</span><span class="ident" id="5396951">src</span><span class="op" id="5396954">[</span><span class="ident" id="5396955">match</span><span class="op" id="5396960">[</span><span class="num" id="5396961">0</span><span class="op" id="5396962">]</span><span class="op" id="5396963">:</span><span class="ident" id="5396964">match</span><span class="op" id="5396969">[</span><span class="num" id="5396970">1</span><span class="op" id="5396971">]</span><span class="op" id="5396972">]</span><span class="op" id="5396973">)</span><span class="op" id="5396974">...</span><span class="op" id="5396977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5396980">}</span><span class="op" id="5396981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396984">return</span>&nbsp;<span class="builtintype" id="5396991">string</span><span class="op" id="5396997">(</span><span class="ident" id="5396998">b</span><span class="op" id="5396999">)</span><br>
<span class="lineno"></span><span class="op" id="5397001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="5397004">func</span>&nbsp;<span class="op" id="5397009">(</span><span class="ident" id="5397010">re</span>&nbsp;<span class="op" id="5397013">*</span><span class="ident" id="5397014">Regexp</span><span class="op" id="5397020">)</span>&nbsp;<span class="ident" id="5397022">replaceAll</span><span class="op" id="5397032">(</span><span class="ident" id="5397033">bsrc</span>&nbsp;<span class="op" id="5397038">[</span><span class="op" id="5397039">]</span><span class="builtintype" id="5397040">byte</span><span class="op" id="5397044">,</span>&nbsp;<span class="ident" id="5397046">src</span>&nbsp;<span class="builtintype" id="5397050">string</span><span class="op" id="5397056">,</span>&nbsp;<span class="ident" id="5397058">nmatch</span>&nbsp;<span class="builtintype" id="5397065">int</span><span class="op" id="5397068">,</span>&nbsp;<span class="ident" id="5397070">repl</span>&nbsp;<span class="keyword" id="5397075">func</span><span class="op" id="5397079">(</span><span class="ident" id="5397080">dst</span>&nbsp;<span class="op" id="5397084">[</span><span class="op" id="5397085">]</span><span class="builtintype" id="5397086">byte</span><span class="op" id="5397090">,</span>&nbsp;<span class="ident" id="5397092">m</span>&nbsp;<span class="op" id="5397094">[</span><span class="op" id="5397095">]</span><span class="builtintype" id="5397096">int</span><span class="op" id="5397099">)</span>&nbsp;<span class="op" id="5397101">[</span><span class="op" id="5397102">]</span><span class="builtintype" id="5397103">byte</span><span class="op" id="5397107">)</span>&nbsp;<span class="op" id="5397109">[</span><span class="op" id="5397110">]</span><span class="builtintype" id="5397111">byte</span>&nbsp;<span class="op" id="5397116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397119">lastMatchEnd</span>&nbsp;<span class="op" id="5397132">:=</span>&nbsp;<span class="num" id="5397135">0</span>&nbsp;<span class="comment" id="5397137">//&nbsp;end&nbsp;position&nbsp;of&nbsp;the&nbsp;most&nbsp;recent&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397179">searchPos</span>&nbsp;<span class="op" id="5397189">:=</span>&nbsp;<span class="num" id="5397192">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5397197">//&nbsp;position&nbsp;where&nbsp;we&nbsp;next&nbsp;look&nbsp;for&nbsp;a&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397241">var</span>&nbsp;<span class="ident" id="5397245">buf</span>&nbsp;<span class="op" id="5397249">[</span><span class="op" id="5397250">]</span><span class="builtintype" id="5397251">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397257">var</span>&nbsp;<span class="ident" id="5397261">endPos</span>&nbsp;<span class="builtintype" id="5397268">int</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397273">if</span>&nbsp;<span class="ident" id="5397276">bsrc</span>&nbsp;<span class="op" id="5397281">!=</span>&nbsp;<span class="ident" id="5397284">nil</span>&nbsp;<span class="op" id="5397288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397292">endPos</span>&nbsp;<span class="op" id="5397299">=</span>&nbsp;<span class="builtinfunc" id="5397301">len</span><span class="op" id="5397304">(</span><span class="ident" id="5397305">bsrc</span><span class="op" id="5397309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397312">}</span>&nbsp;<span class="keyword" id="5397314">else</span>&nbsp;<span class="op" id="5397319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397323">endPos</span>&nbsp;<span class="op" id="5397330">=</span>&nbsp;<span class="builtinfunc" id="5397332">len</span><span class="op" id="5397335">(</span><span class="ident" id="5397336">src</span><span class="op" id="5397339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397342">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397345">for</span>&nbsp;<span class="ident" id="5397349">searchPos</span>&nbsp;<span class="op" id="5397359">&lt;=</span>&nbsp;<span class="ident" id="5397362">endPos</span>&nbsp;<span class="op" id="5397369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397373">a</span>&nbsp;<span class="op" id="5397375">:=</span>&nbsp;<span class="ident" id="5397378">re</span><span class="op" id="5397380">.</span><span class="ident" id="5397381">doExecute</span><span class="op" id="5397390">(</span><span class="ident" id="5397391">nil</span><span class="op" id="5397394">,</span>&nbsp;<span class="ident" id="5397396">bsrc</span><span class="op" id="5397400">,</span>&nbsp;<span class="ident" id="5397402">src</span><span class="op" id="5397405">,</span>&nbsp;<span class="ident" id="5397407">searchPos</span><span class="op" id="5397416">,</span>&nbsp;<span class="ident" id="5397418">nmatch</span><span class="op" id="5397424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397428">if</span>&nbsp;<span class="builtinfunc" id="5397431">len</span><span class="op" id="5397434">(</span><span class="ident" id="5397435">a</span><span class="op" id="5397436">)</span>&nbsp;<span class="op" id="5397438">==</span>&nbsp;<span class="num" id="5397441">0</span>&nbsp;<span class="op" id="5397443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397448">break</span>&nbsp;<span class="comment" id="5397454">//&nbsp;no&nbsp;more&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397475">}</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5397480">//&nbsp;Copy&nbsp;the&nbsp;unmatched&nbsp;characters&nbsp;before&nbsp;this&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397534">if</span>&nbsp;<span class="ident" id="5397537">bsrc</span>&nbsp;<span class="op" id="5397542">!=</span>&nbsp;<span class="ident" id="5397545">nil</span>&nbsp;<span class="op" id="5397549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397554">buf</span>&nbsp;<span class="op" id="5397558">=</span>&nbsp;<span class="builtinfunc" id="5397560">append</span><span class="op" id="5397566">(</span><span class="ident" id="5397567">buf</span><span class="op" id="5397570">,</span>&nbsp;<span class="ident" id="5397572">bsrc</span><span class="op" id="5397576">[</span><span class="ident" id="5397577">lastMatchEnd</span><span class="op" id="5397589">:</span><span class="ident" id="5397590">a</span><span class="op" id="5397591">[</span><span class="num" id="5397592">0</span><span class="op" id="5397593">]</span><span class="op" id="5397594">]</span><span class="op" id="5397595">...</span><span class="op" id="5397598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397602">}</span>&nbsp;<span class="keyword" id="5397604">else</span>&nbsp;<span class="op" id="5397609">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397614">buf</span>&nbsp;<span class="op" id="5397618">=</span>&nbsp;<span class="builtinfunc" id="5397620">append</span><span class="op" id="5397626">(</span><span class="ident" id="5397627">buf</span><span class="op" id="5397630">,</span>&nbsp;<span class="ident" id="5397632">src</span><span class="op" id="5397635">[</span><span class="ident" id="5397636">lastMatchEnd</span><span class="op" id="5397648">:</span><span class="ident" id="5397649">a</span><span class="op" id="5397650">[</span><span class="num" id="5397651">0</span><span class="op" id="5397652">]</span><span class="op" id="5397653">]</span><span class="op" id="5397654">...</span><span class="op" id="5397657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5397666">//&nbsp;Now&nbsp;insert&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;replacement&nbsp;string,&nbsp;but&nbsp;not&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5397730">//&nbsp;match&nbsp;of&nbsp;the&nbsp;empty&nbsp;string&nbsp;immediately&nbsp;after&nbsp;another&nbsp;match.</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5397794">//&nbsp;(Otherwise,&nbsp;we&nbsp;get&nbsp;double&nbsp;replacement&nbsp;for&nbsp;patterns&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5397855">//&nbsp;match&nbsp;both&nbsp;empty&nbsp;and&nbsp;nonempty&nbsp;strings.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397900">if</span>&nbsp;<span class="ident" id="5397903">a</span><span class="op" id="5397904">[</span><span class="num" id="5397905">1</span><span class="op" id="5397906">]</span>&nbsp;<span class="op" id="5397908">&gt;</span>&nbsp;<span class="ident" id="5397910">lastMatchEnd</span>&nbsp;<span class="op" id="5397923">||</span>&nbsp;<span class="ident" id="5397926">a</span><span class="op" id="5397927">[</span><span class="num" id="5397928">0</span><span class="op" id="5397929">]</span>&nbsp;<span class="op" id="5397931">==</span>&nbsp;<span class="num" id="5397934">0</span>&nbsp;<span class="op" id="5397936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397941">buf</span>&nbsp;<span class="op" id="5397945">=</span>&nbsp;<span class="ident" id="5397947">repl</span><span class="op" id="5397951">(</span><span class="ident" id="5397952">buf</span><span class="op" id="5397955">,</span>&nbsp;<span class="ident" id="5397957">a</span><span class="op" id="5397958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397962">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397966">lastMatchEnd</span>&nbsp;<span class="op" id="5397979">=</span>&nbsp;<span class="ident" id="5397981">a</span><span class="op" id="5397982">[</span><span class="num" id="5397983">1</span><span class="op" id="5397984">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5397989">//&nbsp;Advance&nbsp;past&nbsp;this&nbsp;match;&nbsp;always&nbsp;advance&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398058">var</span>&nbsp;<span class="ident" id="5398062">width</span>&nbsp;<span class="builtintype" id="5398068">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398074">if</span>&nbsp;<span class="ident" id="5398077">bsrc</span>&nbsp;<span class="op" id="5398082">!=</span>&nbsp;<span class="ident" id="5398085">nil</span>&nbsp;<span class="op" id="5398089">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398094">_</span><span class="op" id="5398095">,</span>&nbsp;<span class="ident" id="5398097">width</span>&nbsp;<span class="op" id="5398103">=</span>&nbsp;<span class="ident" id="5398105">utf8</span><span class="op" id="5398109">.</span><span class="ident" id="5398110">DecodeRune</span><span class="op" id="5398120">(</span><span class="ident" id="5398121">bsrc</span><span class="op" id="5398125">[</span><span class="ident" id="5398126">searchPos</span><span class="op" id="5398135">:</span><span class="op" id="5398136">]</span><span class="op" id="5398137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398141">}</span>&nbsp;<span class="keyword" id="5398143">else</span>&nbsp;<span class="op" id="5398148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398153">_</span><span class="op" id="5398154">,</span>&nbsp;<span class="ident" id="5398156">width</span>&nbsp;<span class="op" id="5398162">=</span>&nbsp;<span class="ident" id="5398164">utf8</span><span class="op" id="5398168">.</span><span class="ident" id="5398169">DecodeRuneInString</span><span class="op" id="5398187">(</span><span class="ident" id="5398188">src</span><span class="op" id="5398191">[</span><span class="ident" id="5398192">searchPos</span><span class="op" id="5398201">:</span><span class="op" id="5398202">]</span><span class="op" id="5398203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398211">if</span>&nbsp;<span class="ident" id="5398214">searchPos</span><span class="op" id="5398223">+</span><span class="ident" id="5398224">width</span>&nbsp;<span class="op" id="5398230">&gt;</span>&nbsp;<span class="ident" id="5398232">a</span><span class="op" id="5398233">[</span><span class="num" id="5398234">1</span><span class="op" id="5398235">]</span>&nbsp;<span class="op" id="5398237">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398242">searchPos</span>&nbsp;<span class="op" id="5398252">+=</span>&nbsp;<span class="ident" id="5398255">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398263">}</span>&nbsp;<span class="keyword" id="5398265">else</span>&nbsp;<span class="keyword" id="5398270">if</span>&nbsp;<span class="ident" id="5398273">searchPos</span><span class="op" id="5398282">+</span><span class="num" id="5398283">1</span>&nbsp;<span class="op" id="5398285">&gt;</span>&nbsp;<span class="ident" id="5398287">a</span><span class="op" id="5398288">[</span><span class="num" id="5398289">1</span><span class="op" id="5398290">]</span>&nbsp;<span class="op" id="5398292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5398297">//&nbsp;This&nbsp;clause&nbsp;is&nbsp;only&nbsp;needed&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5398354">//&nbsp;string.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;DecodeRuneInString&nbsp;returns&nbsp;width=0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398419">searchPos</span><span class="op" id="5398428">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398433">}</span>&nbsp;<span class="keyword" id="5398435">else</span>&nbsp;<span class="op" id="5398440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398445">searchPos</span>&nbsp;<span class="op" id="5398455">=</span>&nbsp;<span class="ident" id="5398457">a</span><span class="op" id="5398458">[</span><span class="num" id="5398459">1</span><span class="op" id="5398460">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5398471">//&nbsp;Copy&nbsp;the&nbsp;unmatched&nbsp;characters&nbsp;after&nbsp;the&nbsp;last&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398527">if</span>&nbsp;<span class="ident" id="5398530">bsrc</span>&nbsp;<span class="op" id="5398535">!=</span>&nbsp;<span class="ident" id="5398538">nil</span>&nbsp;<span class="op" id="5398542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398546">buf</span>&nbsp;<span class="op" id="5398550">=</span>&nbsp;<span class="builtinfunc" id="5398552">append</span><span class="op" id="5398558">(</span><span class="ident" id="5398559">buf</span><span class="op" id="5398562">,</span>&nbsp;<span class="ident" id="5398564">bsrc</span><span class="op" id="5398568">[</span><span class="ident" id="5398569">lastMatchEnd</span><span class="op" id="5398581">:</span><span class="op" id="5398582">]</span><span class="op" id="5398583">...</span><span class="op" id="5398586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398589">}</span>&nbsp;<span class="keyword" id="5398591">else</span>&nbsp;<span class="op" id="5398596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398600">buf</span>&nbsp;<span class="op" id="5398604">=</span>&nbsp;<span class="builtinfunc" id="5398606">append</span><span class="op" id="5398612">(</span><span class="ident" id="5398613">buf</span><span class="op" id="5398616">,</span>&nbsp;<span class="ident" id="5398618">src</span><span class="op" id="5398621">[</span><span class="ident" id="5398622">lastMatchEnd</span><span class="op" id="5398634">:</span><span class="op" id="5398635">]</span><span class="op" id="5398636">...</span><span class="op" id="5398639">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398646">return</span>&nbsp;<span class="ident" id="5398653">buf</span><br>
<span class="lineno"></span><span class="op" id="5398657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="5398660">//&nbsp;ReplaceAll&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5398729">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;text&nbsp;repl.&nbsp;&nbsp;Inside&nbsp;repl,&nbsp;$&nbsp;signs&nbsp;are&nbsp;interpreted&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5398805">//&nbsp;in&nbsp;Expand,&nbsp;so&nbsp;for&nbsp;instance&nbsp;$1&nbsp;represents&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;submatch.</span><br>
<span class="lineno"></span><span class="keyword" id="5398881">func</span>&nbsp;<span class="op" id="5398886">(</span><span class="ident" id="5398887">re</span>&nbsp;<span class="op" id="5398890">*</span><span class="ident" id="5398891">Regexp</span><span class="op" id="5398897">)</span>&nbsp;<span class="ident" id="5398899">ReplaceAll</span><span class="op" id="5398909">(</span><span class="ident" id="5398910">src</span><span class="op" id="5398913">,</span>&nbsp;<span class="ident" id="5398915">repl</span>&nbsp;<span class="op" id="5398920">[</span><span class="op" id="5398921">]</span><span class="builtintype" id="5398922">byte</span><span class="op" id="5398926">)</span>&nbsp;<span class="op" id="5398928">[</span><span class="op" id="5398929">]</span><span class="builtintype" id="5398930">byte</span>&nbsp;<span class="op" id="5398935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398938">n</span>&nbsp;<span class="op" id="5398940">:=</span>&nbsp;<span class="num" id="5398943">2</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398946">if</span>&nbsp;<span class="ident" id="5398949">bytes</span><span class="op" id="5398954">.</span><span class="ident" id="5398955">IndexByte</span><span class="op" id="5398964">(</span><span class="ident" id="5398965">repl</span><span class="op" id="5398969">,</span>&nbsp;<span class="string" id="5398971">&#39;$&#39;</span><span class="op" id="5398974">)</span>&nbsp;<span class="op" id="5398976">&gt;=</span>&nbsp;<span class="num" id="5398979">0</span>&nbsp;<span class="op" id="5398981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398985">n</span>&nbsp;<span class="op" id="5398987">=</span>&nbsp;<span class="num" id="5398989">2</span>&nbsp;<span class="op" id="5398991">*</span>&nbsp;<span class="op" id="5398993">(</span><span class="ident" id="5398994">re</span><span class="op" id="5398996">.</span><span class="ident" id="5398997">numSubexp</span>&nbsp;<span class="op" id="5399007">+</span>&nbsp;<span class="num" id="5399009">1</span><span class="op" id="5399010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5399016">srepl</span>&nbsp;<span class="op" id="5399022">:=</span>&nbsp;<span class="string" id="5399025">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5399029">b</span>&nbsp;<span class="op" id="5399031">:=</span>&nbsp;<span class="ident" id="5399034">re</span><span class="op" id="5399036">.</span><span class="ident" id="5399037">replaceAll</span><span class="op" id="5399047">(</span><span class="ident" id="5399048">src</span><span class="op" id="5399051">,</span>&nbsp;<span class="string" id="5399053">&#34;&#34;</span><span class="op" id="5399055">,</span>&nbsp;<span class="ident" id="5399057">n</span><span class="op" id="5399058">,</span>&nbsp;<span class="keyword" id="5399060">func</span><span class="op" id="5399064">(</span><span class="ident" id="5399065">dst</span>&nbsp;<span class="op" id="5399069">[</span><span class="op" id="5399070">]</span><span class="builtintype" id="5399071">byte</span><span class="op" id="5399075">,</span>&nbsp;<span class="ident" id="5399077">match</span>&nbsp;<span class="op" id="5399083">[</span><span class="op" id="5399084">]</span><span class="builtintype" id="5399085">int</span><span class="op" id="5399088">)</span>&nbsp;<span class="op" id="5399090">[</span><span class="op" id="5399091">]</span><span class="builtintype" id="5399092">byte</span>&nbsp;<span class="op" id="5399097">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399101">if</span>&nbsp;<span class="builtinfunc" id="5399104">len</span><span class="op" id="5399107">(</span><span class="ident" id="5399108">srepl</span><span class="op" id="5399113">)</span>&nbsp;<span class="op" id="5399115">!=</span>&nbsp;<span class="builtinfunc" id="5399118">len</span><span class="op" id="5399121">(</span><span class="ident" id="5399122">repl</span><span class="op" id="5399126">)</span>&nbsp;<span class="op" id="5399128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5399133">srepl</span>&nbsp;<span class="op" id="5399139">=</span>&nbsp;<span class="builtintype" id="5399141">string</span><span class="op" id="5399147">(</span><span class="ident" id="5399148">repl</span><span class="op" id="5399152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399160">return</span>&nbsp;<span class="ident" id="5399167">re</span><span class="op" id="5399169">.</span><span class="ident" id="5399170">expand</span><span class="op" id="5399176">(</span><span class="ident" id="5399177">dst</span><span class="op" id="5399180">,</span>&nbsp;<span class="ident" id="5399182">srepl</span><span class="op" id="5399187">,</span>&nbsp;<span class="ident" id="5399189">src</span><span class="op" id="5399192">,</span>&nbsp;<span class="string" id="5399194">&#34;&#34;</span><span class="op" id="5399196">,</span>&nbsp;<span class="ident" id="5399198">match</span><span class="op" id="5399203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399206">}</span><span class="op" id="5399207">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399210">return</span>&nbsp;<span class="ident" id="5399217">b</span><br>
<span class="lineno"></span><span class="op" id="5399219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399222">//&nbsp;ReplaceAllLiteral&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5399298">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;bytes&nbsp;repl.&nbsp;&nbsp;The&nbsp;replacement&nbsp;repl&nbsp;is&nbsp;substituted&nbsp;directly,</span><br>
<span class="lineno">555</span><span class="comment" id="5399381">//&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5399406">func</span>&nbsp;<span class="op" id="5399411">(</span><span class="ident" id="5399412">re</span>&nbsp;<span class="op" id="5399415">*</span><span class="ident" id="5399416">Regexp</span><span class="op" id="5399422">)</span>&nbsp;<span class="ident" id="5399424">ReplaceAllLiteral</span><span class="op" id="5399441">(</span><span class="ident" id="5399442">src</span><span class="op" id="5399445">,</span>&nbsp;<span class="ident" id="5399447">repl</span>&nbsp;<span class="op" id="5399452">[</span><span class="op" id="5399453">]</span><span class="builtintype" id="5399454">byte</span><span class="op" id="5399458">)</span>&nbsp;<span class="op" id="5399460">[</span><span class="op" id="5399461">]</span><span class="builtintype" id="5399462">byte</span>&nbsp;<span class="op" id="5399467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399470">return</span>&nbsp;<span class="ident" id="5399477">re</span><span class="op" id="5399479">.</span><span class="ident" id="5399480">replaceAll</span><span class="op" id="5399490">(</span><span class="ident" id="5399491">src</span><span class="op" id="5399494">,</span>&nbsp;<span class="string" id="5399496">&#34;&#34;</span><span class="op" id="5399498">,</span>&nbsp;<span class="num" id="5399500">2</span><span class="op" id="5399501">,</span>&nbsp;<span class="keyword" id="5399503">func</span><span class="op" id="5399507">(</span><span class="ident" id="5399508">dst</span>&nbsp;<span class="op" id="5399512">[</span><span class="op" id="5399513">]</span><span class="builtintype" id="5399514">byte</span><span class="op" id="5399518">,</span>&nbsp;<span class="ident" id="5399520">match</span>&nbsp;<span class="op" id="5399526">[</span><span class="op" id="5399527">]</span><span class="builtintype" id="5399528">int</span><span class="op" id="5399531">)</span>&nbsp;<span class="op" id="5399533">[</span><span class="op" id="5399534">]</span><span class="builtintype" id="5399535">byte</span>&nbsp;<span class="op" id="5399540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399544">return</span>&nbsp;<span class="builtinfunc" id="5399551">append</span><span class="op" id="5399557">(</span><span class="ident" id="5399558">dst</span><span class="op" id="5399561">,</span>&nbsp;<span class="ident" id="5399563">repl</span><span class="op" id="5399567">...</span><span class="op" id="5399570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399573">}</span><span class="op" id="5399574">)</span><br>
<span class="lineno">560</span><span class="op" id="5399576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399579">//&nbsp;ReplaceAllFunc&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src&nbsp;in&nbsp;which&nbsp;all&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5399647">//&nbsp;Regexp&nbsp;have&nbsp;been&nbsp;replaced&nbsp;by&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;function&nbsp;repl&nbsp;applied</span><br>
<span class="lineno"></span><span class="comment" id="5399721">//&nbsp;to&nbsp;the&nbsp;matched&nbsp;byte&nbsp;slice.&nbsp;&nbsp;The&nbsp;replacement&nbsp;returned&nbsp;by&nbsp;repl&nbsp;is&nbsp;substituted</span><br>
<span class="lineno">565</span><span class="comment" id="5399800">//&nbsp;directly,&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5399835">func</span>&nbsp;<span class="op" id="5399840">(</span><span class="ident" id="5399841">re</span>&nbsp;<span class="op" id="5399844">*</span><span class="ident" id="5399845">Regexp</span><span class="op" id="5399851">)</span>&nbsp;<span class="ident" id="5399853">ReplaceAllFunc</span><span class="op" id="5399867">(</span><span class="ident" id="5399868">src</span>&nbsp;<span class="op" id="5399872">[</span><span class="op" id="5399873">]</span><span class="builtintype" id="5399874">byte</span><span class="op" id="5399878">,</span>&nbsp;<span class="ident" id="5399880">repl</span>&nbsp;<span class="keyword" id="5399885">func</span><span class="op" id="5399889">(</span><span class="op" id="5399890">[</span><span class="op" id="5399891">]</span><span class="builtintype" id="5399892">byte</span><span class="op" id="5399896">)</span>&nbsp;<span class="op" id="5399898">[</span><span class="op" id="5399899">]</span><span class="builtintype" id="5399900">byte</span><span class="op" id="5399904">)</span>&nbsp;<span class="op" id="5399906">[</span><span class="op" id="5399907">]</span><span class="builtintype" id="5399908">byte</span>&nbsp;<span class="op" id="5399913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399916">return</span>&nbsp;<span class="ident" id="5399923">re</span><span class="op" id="5399925">.</span><span class="ident" id="5399926">replaceAll</span><span class="op" id="5399936">(</span><span class="ident" id="5399937">src</span><span class="op" id="5399940">,</span>&nbsp;<span class="string" id="5399942">&#34;&#34;</span><span class="op" id="5399944">,</span>&nbsp;<span class="num" id="5399946">2</span><span class="op" id="5399947">,</span>&nbsp;<span class="keyword" id="5399949">func</span><span class="op" id="5399953">(</span><span class="ident" id="5399954">dst</span>&nbsp;<span class="op" id="5399958">[</span><span class="op" id="5399959">]</span><span class="builtintype" id="5399960">byte</span><span class="op" id="5399964">,</span>&nbsp;<span class="ident" id="5399966">match</span>&nbsp;<span class="op" id="5399972">[</span><span class="op" id="5399973">]</span><span class="builtintype" id="5399974">int</span><span class="op" id="5399977">)</span>&nbsp;<span class="op" id="5399979">[</span><span class="op" id="5399980">]</span><span class="builtintype" id="5399981">byte</span>&nbsp;<span class="op" id="5399986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399990">return</span>&nbsp;<span class="builtinfunc" id="5399997">append</span><span class="op" id="5400003">(</span><span class="ident" id="5400004">dst</span><span class="op" id="5400007">,</span>&nbsp;<span class="ident" id="5400009">repl</span><span class="op" id="5400013">(</span><span class="ident" id="5400014">src</span><span class="op" id="5400017">[</span><span class="ident" id="5400018">match</span><span class="op" id="5400023">[</span><span class="num" id="5400024">0</span><span class="op" id="5400025">]</span><span class="op" id="5400026">:</span><span class="ident" id="5400027">match</span><span class="op" id="5400032">[</span><span class="num" id="5400033">1</span><span class="op" id="5400034">]</span><span class="op" id="5400035">]</span><span class="op" id="5400036">)</span><span class="op" id="5400037">...</span><span class="op" id="5400040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5400043">}</span><span class="op" id="5400044">)</span><br>
<span class="lineno">570</span><span class="op" id="5400046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5400049">var</span>&nbsp;<span class="ident" id="5400053">specialBytes</span>&nbsp;<span class="op" id="5400066">=</span>&nbsp;<span class="op" id="5400068">[</span><span class="op" id="5400069">]</span><span class="builtintype" id="5400070">byte</span><span class="op" id="5400074">(</span><span class="string" id="5400075">`\.+*?()|[]{}^$`</span><span class="op" id="5400091">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5400094">func</span>&nbsp;<span class="ident" id="5400099">special</span><span class="op" id="5400106">(</span><span class="ident" id="5400107">b</span>&nbsp;<span class="builtintype" id="5400109">byte</span><span class="op" id="5400113">)</span>&nbsp;<span class="builtintype" id="5400115">bool</span>&nbsp;<span class="op" id="5400120">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400123">return</span>&nbsp;<span class="ident" id="5400130">bytes</span><span class="op" id="5400135">.</span><span class="ident" id="5400136">IndexByte</span><span class="op" id="5400145">(</span><span class="ident" id="5400146">specialBytes</span><span class="op" id="5400158">,</span>&nbsp;<span class="ident" id="5400160">b</span><span class="op" id="5400161">)</span>&nbsp;<span class="op" id="5400163">&gt;=</span>&nbsp;<span class="num" id="5400166">0</span><br>
<span class="lineno"></span><span class="op" id="5400168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5400171">//&nbsp;QuoteMeta&nbsp;returns&nbsp;a&nbsp;string&nbsp;that&nbsp;quotes&nbsp;all&nbsp;regular&nbsp;expression&nbsp;metacharacters</span><br>
<span class="lineno"></span><span class="comment" id="5400251">//&nbsp;inside&nbsp;the&nbsp;argument&nbsp;text;&nbsp;the&nbsp;returned&nbsp;string&nbsp;is&nbsp;a&nbsp;regular&nbsp;expression&nbsp;matching</span><br>
<span class="lineno">580</span><span class="comment" id="5400333">//&nbsp;the&nbsp;literal&nbsp;text.&nbsp;&nbsp;For&nbsp;example,&nbsp;QuoteMeta(`[foo]`)&nbsp;returns&nbsp;`\[foo\]`.</span><br>
<span class="lineno"></span><span class="keyword" id="5400406">func</span>&nbsp;<span class="ident" id="5400411">QuoteMeta</span><span class="op" id="5400420">(</span><span class="ident" id="5400421">s</span>&nbsp;<span class="builtintype" id="5400423">string</span><span class="op" id="5400429">)</span>&nbsp;<span class="builtintype" id="5400431">string</span>&nbsp;<span class="op" id="5400438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400441">b</span>&nbsp;<span class="op" id="5400443">:=</span>&nbsp;<span class="builtinfunc" id="5400446">make</span><span class="op" id="5400450">(</span><span class="op" id="5400451">[</span><span class="op" id="5400452">]</span><span class="builtintype" id="5400453">byte</span><span class="op" id="5400457">,</span>&nbsp;<span class="num" id="5400459">2</span><span class="op" id="5400460">*</span><span class="builtinfunc" id="5400461">len</span><span class="op" id="5400464">(</span><span class="ident" id="5400465">s</span><span class="op" id="5400466">)</span><span class="op" id="5400467">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5400471">//&nbsp;A&nbsp;byte&nbsp;loop&nbsp;is&nbsp;correct&nbsp;because&nbsp;all&nbsp;metacharacters&nbsp;are&nbsp;ASCII.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400536">j</span>&nbsp;<span class="op" id="5400538">:=</span>&nbsp;<span class="num" id="5400541">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400544">for</span>&nbsp;<span class="ident" id="5400548">i</span>&nbsp;<span class="op" id="5400550">:=</span>&nbsp;<span class="num" id="5400553">0</span><span class="op" id="5400554">;</span>&nbsp;<span class="ident" id="5400556">i</span>&nbsp;<span class="op" id="5400558">&lt;</span>&nbsp;<span class="builtinfunc" id="5400560">len</span><span class="op" id="5400563">(</span><span class="ident" id="5400564">s</span><span class="op" id="5400565">)</span><span class="op" id="5400566">;</span>&nbsp;<span class="ident" id="5400568">i</span><span class="op" id="5400569">++</span>&nbsp;<span class="op" id="5400572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400576">if</span>&nbsp;<span class="ident" id="5400579">special</span><span class="op" id="5400586">(</span><span class="ident" id="5400587">s</span><span class="op" id="5400588">[</span><span class="ident" id="5400589">i</span><span class="op" id="5400590">]</span><span class="op" id="5400591">)</span>&nbsp;<span class="op" id="5400593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400598">b</span><span class="op" id="5400599">[</span><span class="ident" id="5400600">j</span><span class="op" id="5400601">]</span>&nbsp;<span class="op" id="5400603">=</span>&nbsp;<span class="string" id="5400605">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400613">j</span><span class="op" id="5400614">++</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5400619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400623">b</span><span class="op" id="5400624">[</span><span class="ident" id="5400625">j</span><span class="op" id="5400626">]</span>&nbsp;<span class="op" id="5400628">=</span>&nbsp;<span class="ident" id="5400630">s</span><span class="op" id="5400631">[</span><span class="ident" id="5400632">i</span><span class="op" id="5400633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400637">j</span><span class="op" id="5400638">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5400642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400645">return</span>&nbsp;<span class="builtintype" id="5400652">string</span><span class="op" id="5400658">(</span><span class="ident" id="5400659">b</span><span class="op" id="5400660">[</span><span class="num" id="5400661">0</span><span class="op" id="5400662">:</span><span class="ident" id="5400663">j</span><span class="op" id="5400664">]</span><span class="op" id="5400665">)</span><br>
<span class="lineno">595</span><span class="op" id="5400667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5400670">//&nbsp;The&nbsp;number&nbsp;of&nbsp;capture&nbsp;values&nbsp;in&nbsp;the&nbsp;program&nbsp;may&nbsp;correspond</span><br>
<span class="lineno"></span><span class="comment" id="5400732">//&nbsp;to&nbsp;fewer&nbsp;capturing&nbsp;expressions&nbsp;than&nbsp;are&nbsp;in&nbsp;the&nbsp;regexp.</span><br>
<span class="lineno"></span><span class="comment" id="5400790">//&nbsp;For&nbsp;example,&nbsp;&#34;(a){0}&#34;&nbsp;turns&nbsp;into&nbsp;an&nbsp;empty&nbsp;program,&nbsp;so&nbsp;the</span><br>
<span class="lineno">600</span><span class="comment" id="5400851">//&nbsp;maximum&nbsp;capture&nbsp;in&nbsp;the&nbsp;program&nbsp;is&nbsp;0&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5400912">//&nbsp;an&nbsp;expression&nbsp;for&nbsp;\1.&nbsp;&nbsp;Pad&nbsp;appends&nbsp;-1s&nbsp;to&nbsp;the&nbsp;slice&nbsp;a&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span><span class="keyword" id="5400980">func</span>&nbsp;<span class="op" id="5400985">(</span><span class="ident" id="5400986">re</span>&nbsp;<span class="op" id="5400989">*</span><span class="ident" id="5400990">Regexp</span><span class="op" id="5400996">)</span>&nbsp;<span class="ident" id="5400998">pad</span><span class="op" id="5401001">(</span><span class="ident" id="5401002">a</span>&nbsp;<span class="op" id="5401004">[</span><span class="op" id="5401005">]</span><span class="builtintype" id="5401006">int</span><span class="op" id="5401009">)</span>&nbsp;<span class="op" id="5401011">[</span><span class="op" id="5401012">]</span><span class="builtintype" id="5401013">int</span>&nbsp;<span class="op" id="5401017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401020">if</span>&nbsp;<span class="ident" id="5401023">a</span>&nbsp;<span class="op" id="5401025">==</span>&nbsp;<span class="ident" id="5401028">nil</span>&nbsp;<span class="op" id="5401032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5401036">//&nbsp;No&nbsp;match.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401051">return</span>&nbsp;<span class="ident" id="5401058">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401066">n</span>&nbsp;<span class="op" id="5401068">:=</span>&nbsp;<span class="op" id="5401071">(</span><span class="num" id="5401072">1</span>&nbsp;<span class="op" id="5401074">+</span>&nbsp;<span class="ident" id="5401076">re</span><span class="op" id="5401078">.</span><span class="ident" id="5401079">numSubexp</span><span class="op" id="5401088">)</span>&nbsp;<span class="op" id="5401090">*</span>&nbsp;<span class="num" id="5401092">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401095">for</span>&nbsp;<span class="builtinfunc" id="5401099">len</span><span class="op" id="5401102">(</span><span class="ident" id="5401103">a</span><span class="op" id="5401104">)</span>&nbsp;<span class="op" id="5401106">&lt;</span>&nbsp;<span class="ident" id="5401108">n</span>&nbsp;<span class="op" id="5401110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401114">a</span>&nbsp;<span class="op" id="5401116">=</span>&nbsp;<span class="builtinfunc" id="5401118">append</span><span class="op" id="5401124">(</span><span class="ident" id="5401125">a</span><span class="op" id="5401126">,</span>&nbsp;<span class="op" id="5401128">-</span><span class="num" id="5401129">1</span><span class="op" id="5401130">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401136">return</span>&nbsp;<span class="ident" id="5401143">a</span><br>
<span class="lineno"></span><span class="op" id="5401145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5401148">//&nbsp;Find&nbsp;matches&nbsp;in&nbsp;slice&nbsp;b&nbsp;if&nbsp;b&nbsp;is&nbsp;non-nil,&nbsp;otherwise&nbsp;find&nbsp;matches&nbsp;in&nbsp;string&nbsp;s.</span><br>
<span class="lineno">615</span><span class="keyword" id="5401228">func</span>&nbsp;<span class="op" id="5401233">(</span><span class="ident" id="5401234">re</span>&nbsp;<span class="op" id="5401237">*</span><span class="ident" id="5401238">Regexp</span><span class="op" id="5401244">)</span>&nbsp;<span class="ident" id="5401246">allMatches</span><span class="op" id="5401256">(</span><span class="ident" id="5401257">s</span>&nbsp;<span class="builtintype" id="5401259">string</span><span class="op" id="5401265">,</span>&nbsp;<span class="ident" id="5401267">b</span>&nbsp;<span class="op" id="5401269">[</span><span class="op" id="5401270">]</span><span class="builtintype" id="5401271">byte</span><span class="op" id="5401275">,</span>&nbsp;<span class="ident" id="5401277">n</span>&nbsp;<span class="builtintype" id="5401279">int</span><span class="op" id="5401282">,</span>&nbsp;<span class="ident" id="5401284">deliver</span>&nbsp;<span class="keyword" id="5401292">func</span><span class="op" id="5401296">(</span><span class="op" id="5401297">[</span><span class="op" id="5401298">]</span><span class="builtintype" id="5401299">int</span><span class="op" id="5401302">)</span><span class="op" id="5401303">)</span>&nbsp;<span class="op" id="5401305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401308">var</span>&nbsp;<span class="ident" id="5401312">end</span>&nbsp;<span class="builtintype" id="5401316">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401321">if</span>&nbsp;<span class="ident" id="5401324">b</span>&nbsp;<span class="op" id="5401326">==</span>&nbsp;<span class="ident" id="5401329">nil</span>&nbsp;<span class="op" id="5401333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401337">end</span>&nbsp;<span class="op" id="5401341">=</span>&nbsp;<span class="builtinfunc" id="5401343">len</span><span class="op" id="5401346">(</span><span class="ident" id="5401347">s</span><span class="op" id="5401348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401351">}</span>&nbsp;<span class="keyword" id="5401353">else</span>&nbsp;<span class="op" id="5401358">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401362">end</span>&nbsp;<span class="op" id="5401366">=</span>&nbsp;<span class="builtinfunc" id="5401368">len</span><span class="op" id="5401371">(</span><span class="ident" id="5401372">b</span><span class="op" id="5401373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401380">for</span>&nbsp;<span class="ident" id="5401384">pos</span><span class="op" id="5401387">,</span>&nbsp;<span class="ident" id="5401389">i</span><span class="op" id="5401390">,</span>&nbsp;<span class="ident" id="5401392">prevMatchEnd</span>&nbsp;<span class="op" id="5401405">:=</span>&nbsp;<span class="num" id="5401408">0</span><span class="op" id="5401409">,</span>&nbsp;<span class="num" id="5401411">0</span><span class="op" id="5401412">,</span>&nbsp;<span class="op" id="5401414">-</span><span class="num" id="5401415">1</span><span class="op" id="5401416">;</span>&nbsp;<span class="ident" id="5401418">i</span>&nbsp;<span class="op" id="5401420">&lt;</span>&nbsp;<span class="ident" id="5401422">n</span>&nbsp;<span class="op" id="5401424">&amp;&amp;</span>&nbsp;<span class="ident" id="5401427">pos</span>&nbsp;<span class="op" id="5401431">&lt;=</span>&nbsp;<span class="ident" id="5401434">end</span><span class="op" id="5401437">;</span>&nbsp;<span class="op" id="5401439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401443">matches</span>&nbsp;<span class="op" id="5401451">:=</span>&nbsp;<span class="ident" id="5401454">re</span><span class="op" id="5401456">.</span><span class="ident" id="5401457">doExecute</span><span class="op" id="5401466">(</span><span class="ident" id="5401467">nil</span><span class="op" id="5401470">,</span>&nbsp;<span class="ident" id="5401472">b</span><span class="op" id="5401473">,</span>&nbsp;<span class="ident" id="5401475">s</span><span class="op" id="5401476">,</span>&nbsp;<span class="ident" id="5401478">pos</span><span class="op" id="5401481">,</span>&nbsp;<span class="ident" id="5401483">re</span><span class="op" id="5401485">.</span><span class="ident" id="5401486">prog</span><span class="op" id="5401490">.</span><span class="ident" id="5401491">NumCap</span><span class="op" id="5401497">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401501">if</span>&nbsp;<span class="builtinfunc" id="5401504">len</span><span class="op" id="5401507">(</span><span class="ident" id="5401508">matches</span><span class="op" id="5401515">)</span>&nbsp;<span class="op" id="5401517">==</span>&nbsp;<span class="num" id="5401520">0</span>&nbsp;<span class="op" id="5401522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401527">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401540">accept</span>&nbsp;<span class="op" id="5401547">:=</span>&nbsp;<span class="builtintype" id="5401550">true</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401557">if</span>&nbsp;<span class="ident" id="5401560">matches</span><span class="op" id="5401567">[</span><span class="num" id="5401568">1</span><span class="op" id="5401569">]</span>&nbsp;<span class="op" id="5401571">==</span>&nbsp;<span class="ident" id="5401574">pos</span>&nbsp;<span class="op" id="5401578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5401583">//&nbsp;We&#39;ve&nbsp;found&nbsp;an&nbsp;empty&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401617">if</span>&nbsp;<span class="ident" id="5401620">matches</span><span class="op" id="5401627">[</span><span class="num" id="5401628">0</span><span class="op" id="5401629">]</span>&nbsp;<span class="op" id="5401631">==</span>&nbsp;<span class="ident" id="5401634">prevMatchEnd</span>&nbsp;<span class="op" id="5401647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5401653">//&nbsp;We&nbsp;don&#39;t&nbsp;allow&nbsp;an&nbsp;empty&nbsp;match&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5401696">//&nbsp;after&nbsp;a&nbsp;previous&nbsp;match,&nbsp;so&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401741">accept</span>&nbsp;<span class="op" id="5401748">=</span>&nbsp;<span class="builtintype" id="5401750">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401764">var</span>&nbsp;<span class="ident" id="5401768">width</span>&nbsp;<span class="builtintype" id="5401774">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5401781">//&nbsp;TODO:&nbsp;use&nbsp;step()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401804">if</span>&nbsp;<span class="ident" id="5401807">b</span>&nbsp;<span class="op" id="5401809">==</span>&nbsp;<span class="ident" id="5401812">nil</span>&nbsp;<span class="op" id="5401816">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401822">_</span><span class="op" id="5401823">,</span>&nbsp;<span class="ident" id="5401825">width</span>&nbsp;<span class="op" id="5401831">=</span>&nbsp;<span class="ident" id="5401833">utf8</span><span class="op" id="5401837">.</span><span class="ident" id="5401838">DecodeRuneInString</span><span class="op" id="5401856">(</span><span class="ident" id="5401857">s</span><span class="op" id="5401858">[</span><span class="ident" id="5401859">pos</span><span class="op" id="5401862">:</span><span class="ident" id="5401863">end</span><span class="op" id="5401866">]</span><span class="op" id="5401867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401872">}</span>&nbsp;<span class="keyword" id="5401874">else</span>&nbsp;<span class="op" id="5401879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401885">_</span><span class="op" id="5401886">,</span>&nbsp;<span class="ident" id="5401888">width</span>&nbsp;<span class="op" id="5401894">=</span>&nbsp;<span class="ident" id="5401896">utf8</span><span class="op" id="5401900">.</span><span class="ident" id="5401901">DecodeRune</span><span class="op" id="5401911">(</span><span class="ident" id="5401912">b</span><span class="op" id="5401913">[</span><span class="ident" id="5401914">pos</span><span class="op" id="5401917">:</span><span class="ident" id="5401918">end</span><span class="op" id="5401921">]</span><span class="op" id="5401922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401932">if</span>&nbsp;<span class="ident" id="5401935">width</span>&nbsp;<span class="op" id="5401941">&gt;</span>&nbsp;<span class="num" id="5401943">0</span>&nbsp;<span class="op" id="5401945">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401951">pos</span>&nbsp;<span class="op" id="5401955">+=</span>&nbsp;<span class="ident" id="5401958">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401967">}</span>&nbsp;<span class="keyword" id="5401969">else</span>&nbsp;<span class="op" id="5401974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401980">pos</span>&nbsp;<span class="op" id="5401984">=</span>&nbsp;<span class="ident" id="5401986">end</span>&nbsp;<span class="op" id="5401990">+</span>&nbsp;<span class="num" id="5401992">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402001">}</span>&nbsp;<span class="keyword" id="5402003">else</span>&nbsp;<span class="op" id="5402008">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402013">pos</span>&nbsp;<span class="op" id="5402017">=</span>&nbsp;<span class="ident" id="5402019">matches</span><span class="op" id="5402026">[</span><span class="num" id="5402027">1</span><span class="op" id="5402028">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402036">prevMatchEnd</span>&nbsp;<span class="op" id="5402049">=</span>&nbsp;<span class="ident" id="5402051">matches</span><span class="op" id="5402058">[</span><span class="num" id="5402059">1</span><span class="op" id="5402060">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402065">if</span>&nbsp;<span class="ident" id="5402068">accept</span>&nbsp;<span class="op" id="5402075">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402080">deliver</span><span class="op" id="5402087">(</span><span class="ident" id="5402088">re</span><span class="op" id="5402090">.</span><span class="ident" id="5402091">pad</span><span class="op" id="5402094">(</span><span class="ident" id="5402095">matches</span><span class="op" id="5402102">)</span><span class="op" id="5402103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402108">i</span><span class="op" id="5402109">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402117">}</span><br>
<span class="lineno"></span><span class="op" id="5402119">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="comment" id="5402122">//&nbsp;Find&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;b&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="comment" id="5402217">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5402262">func</span>&nbsp;<span class="op" id="5402267">(</span><span class="ident" id="5402268">re</span>&nbsp;<span class="op" id="5402271">*</span><span class="ident" id="5402272">Regexp</span><span class="op" id="5402278">)</span>&nbsp;<span class="ident" id="5402280">Find</span><span class="op" id="5402284">(</span><span class="ident" id="5402285">b</span>&nbsp;<span class="op" id="5402287">[</span><span class="op" id="5402288">]</span><span class="builtintype" id="5402289">byte</span><span class="op" id="5402293">)</span>&nbsp;<span class="op" id="5402295">[</span><span class="op" id="5402296">]</span><span class="builtintype" id="5402297">byte</span>&nbsp;<span class="op" id="5402302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402305">a</span>&nbsp;<span class="op" id="5402307">:=</span>&nbsp;<span class="ident" id="5402310">re</span><span class="op" id="5402312">.</span><span class="ident" id="5402313">doExecute</span><span class="op" id="5402322">(</span><span class="ident" id="5402323">nil</span><span class="op" id="5402326">,</span>&nbsp;<span class="ident" id="5402328">b</span><span class="op" id="5402329">,</span>&nbsp;<span class="string" id="5402331">&#34;&#34;</span><span class="op" id="5402333">,</span>&nbsp;<span class="num" id="5402335">0</span><span class="op" id="5402336">,</span>&nbsp;<span class="num" id="5402338">2</span><span class="op" id="5402339">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402342">if</span>&nbsp;<span class="ident" id="5402345">a</span>&nbsp;<span class="op" id="5402347">==</span>&nbsp;<span class="ident" id="5402350">nil</span>&nbsp;<span class="op" id="5402354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402358">return</span>&nbsp;<span class="ident" id="5402365">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402373">return</span>&nbsp;<span class="ident" id="5402380">b</span><span class="op" id="5402381">[</span><span class="ident" id="5402382">a</span><span class="op" id="5402383">[</span><span class="num" id="5402384">0</span><span class="op" id="5402385">]</span><span class="op" id="5402386">:</span><span class="ident" id="5402387">a</span><span class="op" id="5402388">[</span><span class="num" id="5402389">1</span><span class="op" id="5402390">]</span><span class="op" id="5402391">]</span><br>
<span class="lineno"></span><span class="op" id="5402393">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="5402396">//&nbsp;FindIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the&nbsp;location&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5402474">//&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;b&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.&nbsp;&nbsp;The&nbsp;match&nbsp;itself&nbsp;is&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5402552">//&nbsp;b[loc[0]:loc[1]].</span><br>
<span class="lineno"></span><span class="comment" id="5402573">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">675</span><span class="keyword" id="5402618">func</span>&nbsp;<span class="op" id="5402623">(</span><span class="ident" id="5402624">re</span>&nbsp;<span class="op" id="5402627">*</span><span class="ident" id="5402628">Regexp</span><span class="op" id="5402634">)</span>&nbsp;<span class="ident" id="5402636">FindIndex</span><span class="op" id="5402645">(</span><span class="ident" id="5402646">b</span>&nbsp;<span class="op" id="5402648">[</span><span class="op" id="5402649">]</span><span class="builtintype" id="5402650">byte</span><span class="op" id="5402654">)</span>&nbsp;<span class="op" id="5402656">(</span><span class="ident" id="5402657">loc</span>&nbsp;<span class="op" id="5402661">[</span><span class="op" id="5402662">]</span><span class="builtintype" id="5402663">int</span><span class="op" id="5402666">)</span>&nbsp;<span class="op" id="5402668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402671">a</span>&nbsp;<span class="op" id="5402673">:=</span>&nbsp;<span class="ident" id="5402676">re</span><span class="op" id="5402678">.</span><span class="ident" id="5402679">doExecute</span><span class="op" id="5402688">(</span><span class="ident" id="5402689">nil</span><span class="op" id="5402692">,</span>&nbsp;<span class="ident" id="5402694">b</span><span class="op" id="5402695">,</span>&nbsp;<span class="string" id="5402697">&#34;&#34;</span><span class="op" id="5402699">,</span>&nbsp;<span class="num" id="5402701">0</span><span class="op" id="5402702">,</span>&nbsp;<span class="num" id="5402704">2</span><span class="op" id="5402705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402708">if</span>&nbsp;<span class="ident" id="5402711">a</span>&nbsp;<span class="op" id="5402713">==</span>&nbsp;<span class="ident" id="5402716">nil</span>&nbsp;<span class="op" id="5402720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402724">return</span>&nbsp;<span class="ident" id="5402731">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402736">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402739">return</span>&nbsp;<span class="ident" id="5402746">a</span><span class="op" id="5402747">[</span><span class="num" id="5402748">0</span><span class="op" id="5402749">:</span><span class="num" id="5402750">2</span><span class="op" id="5402751">]</span><br>
<span class="lineno"></span><span class="op" id="5402753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5402756">//&nbsp;FindString&nbsp;returns&nbsp;a&nbsp;string&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5402846">//&nbsp;expression.&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;match,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,</span><br>
<span class="lineno">685</span><span class="comment" id="5402921">//&nbsp;but&nbsp;it&nbsp;will&nbsp;also&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;regular&nbsp;expression&nbsp;successfully&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="5402997">//&nbsp;an&nbsp;empty&nbsp;string.&nbsp;&nbsp;Use&nbsp;FindStringIndex&nbsp;or&nbsp;FindStringSubmatch&nbsp;if&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5403069">//&nbsp;necessary&nbsp;to&nbsp;distinguish&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span><span class="keyword" id="5403110">func</span>&nbsp;<span class="op" id="5403115">(</span><span class="ident" id="5403116">re</span>&nbsp;<span class="op" id="5403119">*</span><span class="ident" id="5403120">Regexp</span><span class="op" id="5403126">)</span>&nbsp;<span class="ident" id="5403128">FindString</span><span class="op" id="5403138">(</span><span class="ident" id="5403139">s</span>&nbsp;<span class="builtintype" id="5403141">string</span><span class="op" id="5403147">)</span>&nbsp;<span class="builtintype" id="5403149">string</span>&nbsp;<span class="op" id="5403156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403159">a</span>&nbsp;<span class="op" id="5403161">:=</span>&nbsp;<span class="ident" id="5403164">re</span><span class="op" id="5403166">.</span><span class="ident" id="5403167">doExecute</span><span class="op" id="5403176">(</span><span class="ident" id="5403177">nil</span><span class="op" id="5403180">,</span>&nbsp;<span class="ident" id="5403182">nil</span><span class="op" id="5403185">,</span>&nbsp;<span class="ident" id="5403187">s</span><span class="op" id="5403188">,</span>&nbsp;<span class="num" id="5403190">0</span><span class="op" id="5403191">,</span>&nbsp;<span class="num" id="5403193">2</span><span class="op" id="5403194">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403197">if</span>&nbsp;<span class="ident" id="5403200">a</span>&nbsp;<span class="op" id="5403202">==</span>&nbsp;<span class="ident" id="5403205">nil</span>&nbsp;<span class="op" id="5403209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403213">return</span>&nbsp;<span class="string" id="5403220">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5403224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403227">return</span>&nbsp;<span class="ident" id="5403234">s</span><span class="op" id="5403235">[</span><span class="ident" id="5403236">a</span><span class="op" id="5403237">[</span><span class="num" id="5403238">0</span><span class="op" id="5403239">]</span><span class="op" id="5403240">:</span><span class="ident" id="5403241">a</span><span class="op" id="5403242">[</span><span class="num" id="5403243">1</span><span class="op" id="5403244">]</span><span class="op" id="5403245">]</span><br>
<span class="lineno"></span><span class="op" id="5403247">}</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span><span class="comment" id="5403250">//&nbsp;FindStringIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5403322">//&nbsp;location&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.&nbsp;&nbsp;The&nbsp;match</span><br>
<span class="lineno"></span><span class="comment" id="5403399">//&nbsp;itself&nbsp;is&nbsp;at&nbsp;s[loc[0]:loc[1]].</span><br>
<span class="lineno"></span><span class="comment" id="5403433">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">700</span><span class="keyword" id="5403478">func</span>&nbsp;<span class="op" id="5403483">(</span><span class="ident" id="5403484">re</span>&nbsp;<span class="op" id="5403487">*</span><span class="ident" id="5403488">Regexp</span><span class="op" id="5403494">)</span>&nbsp;<span class="ident" id="5403496">FindStringIndex</span><span class="op" id="5403511">(</span><span class="ident" id="5403512">s</span>&nbsp;<span class="builtintype" id="5403514">string</span><span class="op" id="5403520">)</span>&nbsp;<span class="op" id="5403522">(</span><span class="ident" id="5403523">loc</span>&nbsp;<span class="op" id="5403527">[</span><span class="op" id="5403528">]</span><span class="builtintype" id="5403529">int</span><span class="op" id="5403532">)</span>&nbsp;<span class="op" id="5403534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403537">a</span>&nbsp;<span class="op" id="5403539">:=</span>&nbsp;<span class="ident" id="5403542">re</span><span class="op" id="5403544">.</span><span class="ident" id="5403545">doExecute</span><span class="op" id="5403554">(</span><span class="ident" id="5403555">nil</span><span class="op" id="5403558">,</span>&nbsp;<span class="ident" id="5403560">nil</span><span class="op" id="5403563">,</span>&nbsp;<span class="ident" id="5403565">s</span><span class="op" id="5403566">,</span>&nbsp;<span class="num" id="5403568">0</span><span class="op" id="5403569">,</span>&nbsp;<span class="num" id="5403571">2</span><span class="op" id="5403572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403575">if</span>&nbsp;<span class="ident" id="5403578">a</span>&nbsp;<span class="op" id="5403580">==</span>&nbsp;<span class="ident" id="5403583">nil</span>&nbsp;<span class="op" id="5403587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403591">return</span>&nbsp;<span class="ident" id="5403598">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5403603">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403606">return</span>&nbsp;<span class="ident" id="5403613">a</span><span class="op" id="5403614">[</span><span class="num" id="5403615">0</span><span class="op" id="5403616">:</span><span class="num" id="5403617">2</span><span class="op" id="5403618">]</span><br>
<span class="lineno"></span><span class="op" id="5403620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5403623">//&nbsp;FindReaderIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5403695">//&nbsp;location&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;text&nbsp;read&nbsp;from</span><br>
<span class="lineno">710</span><span class="comment" id="5403773">//&nbsp;the&nbsp;RuneReader.&nbsp;&nbsp;The&nbsp;match&nbsp;text&nbsp;was&nbsp;found&nbsp;in&nbsp;the&nbsp;input&nbsp;stream&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5403841">//&nbsp;byte&nbsp;offset&nbsp;loc[0]&nbsp;through&nbsp;loc[1]-1.</span><br>
<span class="lineno"></span><span class="comment" id="5403881">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5403926">func</span>&nbsp;<span class="op" id="5403931">(</span><span class="ident" id="5403932">re</span>&nbsp;<span class="op" id="5403935">*</span><span class="ident" id="5403936">Regexp</span><span class="op" id="5403942">)</span>&nbsp;<span class="ident" id="5403944">FindReaderIndex</span><span class="op" id="5403959">(</span><span class="ident" id="5403960">r</span>&nbsp;<span class="ident" id="5403962">io</span><span class="op" id="5403964">.</span><span class="ident" id="5403965">RuneReader</span><span class="op" id="5403975">)</span>&nbsp;<span class="op" id="5403977">(</span><span class="ident" id="5403978">loc</span>&nbsp;<span class="op" id="5403982">[</span><span class="op" id="5403983">]</span><span class="builtintype" id="5403984">int</span><span class="op" id="5403987">)</span>&nbsp;<span class="op" id="5403989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403992">a</span>&nbsp;<span class="op" id="5403994">:=</span>&nbsp;<span class="ident" id="5403997">re</span><span class="op" id="5403999">.</span><span class="ident" id="5404000">doExecute</span><span class="op" id="5404009">(</span><span class="ident" id="5404010">r</span><span class="op" id="5404011">,</span>&nbsp;<span class="ident" id="5404013">nil</span><span class="op" id="5404016">,</span>&nbsp;<span class="string" id="5404018">&#34;&#34;</span><span class="op" id="5404020">,</span>&nbsp;<span class="num" id="5404022">0</span><span class="op" id="5404023">,</span>&nbsp;<span class="num" id="5404025">2</span><span class="op" id="5404026">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404029">if</span>&nbsp;<span class="ident" id="5404032">a</span>&nbsp;<span class="op" id="5404034">==</span>&nbsp;<span class="ident" id="5404037">nil</span>&nbsp;<span class="op" id="5404041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404045">return</span>&nbsp;<span class="ident" id="5404052">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404060">return</span>&nbsp;<span class="ident" id="5404067">a</span><span class="op" id="5404068">[</span><span class="num" id="5404069">0</span><span class="op" id="5404070">:</span><span class="num" id="5404071">2</span><span class="op" id="5404072">]</span><br>
<span class="lineno"></span><span class="op" id="5404074">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="comment" id="5404077">//&nbsp;FindSubmatch&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;slices&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost</span><br>
<span class="lineno"></span><span class="comment" id="5404152">//&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;b&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5404224">//&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5404300">//&nbsp;comment.</span><br>
<span class="lineno">725</span><span class="comment" id="5404312">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5404357">func</span>&nbsp;<span class="op" id="5404362">(</span><span class="ident" id="5404363">re</span>&nbsp;<span class="op" id="5404366">*</span><span class="ident" id="5404367">Regexp</span><span class="op" id="5404373">)</span>&nbsp;<span class="ident" id="5404375">FindSubmatch</span><span class="op" id="5404387">(</span><span class="ident" id="5404388">b</span>&nbsp;<span class="op" id="5404390">[</span><span class="op" id="5404391">]</span><span class="builtintype" id="5404392">byte</span><span class="op" id="5404396">)</span>&nbsp;<span class="op" id="5404398">[</span><span class="op" id="5404399">]</span><span class="op" id="5404400">[</span><span class="op" id="5404401">]</span><span class="builtintype" id="5404402">byte</span>&nbsp;<span class="op" id="5404407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5404410">a</span>&nbsp;<span class="op" id="5404412">:=</span>&nbsp;<span class="ident" id="5404415">re</span><span class="op" id="5404417">.</span><span class="ident" id="5404418">doExecute</span><span class="op" id="5404427">(</span><span class="ident" id="5404428">nil</span><span class="op" id="5404431">,</span>&nbsp;<span class="ident" id="5404433">b</span><span class="op" id="5404434">,</span>&nbsp;<span class="string" id="5404436">&#34;&#34;</span><span class="op" id="5404438">,</span>&nbsp;<span class="num" id="5404440">0</span><span class="op" id="5404441">,</span>&nbsp;<span class="ident" id="5404443">re</span><span class="op" id="5404445">.</span><span class="ident" id="5404446">prog</span><span class="op" id="5404450">.</span><span class="ident" id="5404451">NumCap</span><span class="op" id="5404457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404460">if</span>&nbsp;<span class="ident" id="5404463">a</span>&nbsp;<span class="op" id="5404465">==</span>&nbsp;<span class="ident" id="5404468">nil</span>&nbsp;<span class="op" id="5404472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404476">return</span>&nbsp;<span class="ident" id="5404483">nil</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5404491">ret</span>&nbsp;<span class="op" id="5404495">:=</span>&nbsp;<span class="builtinfunc" id="5404498">make</span><span class="op" id="5404502">(</span><span class="op" id="5404503">[</span><span class="op" id="5404504">]</span><span class="op" id="5404505">[</span><span class="op" id="5404506">]</span><span class="builtintype" id="5404507">byte</span><span class="op" id="5404511">,</span>&nbsp;<span class="num" id="5404513">1</span><span class="op" id="5404514">+</span><span class="ident" id="5404515">re</span><span class="op" id="5404517">.</span><span class="ident" id="5404518">numSubexp</span><span class="op" id="5404527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404530">for</span>&nbsp;<span class="ident" id="5404534">i</span>&nbsp;<span class="op" id="5404536">:=</span>&nbsp;<span class="keyword" id="5404539">range</span>&nbsp;<span class="ident" id="5404545">ret</span>&nbsp;<span class="op" id="5404549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404553">if</span>&nbsp;<span class="num" id="5404556">2</span><span class="op" id="5404557">*</span><span class="ident" id="5404558">i</span>&nbsp;<span class="op" id="5404560">&lt;</span>&nbsp;<span class="builtinfunc" id="5404562">len</span><span class="op" id="5404565">(</span><span class="ident" id="5404566">a</span><span class="op" id="5404567">)</span>&nbsp;<span class="op" id="5404569">&amp;&amp;</span>&nbsp;<span class="ident" id="5404572">a</span><span class="op" id="5404573">[</span><span class="num" id="5404574">2</span><span class="op" id="5404575">*</span><span class="ident" id="5404576">i</span><span class="op" id="5404577">]</span>&nbsp;<span class="op" id="5404579">&gt;=</span>&nbsp;<span class="num" id="5404582">0</span>&nbsp;<span class="op" id="5404584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5404589">ret</span><span class="op" id="5404592">[</span><span class="ident" id="5404593">i</span><span class="op" id="5404594">]</span>&nbsp;<span class="op" id="5404596">=</span>&nbsp;<span class="ident" id="5404598">b</span><span class="op" id="5404599">[</span><span class="ident" id="5404600">a</span><span class="op" id="5404601">[</span><span class="num" id="5404602">2</span><span class="op" id="5404603">*</span><span class="ident" id="5404604">i</span><span class="op" id="5404605">]</span><span class="op" id="5404606">:</span><span class="ident" id="5404607">a</span><span class="op" id="5404608">[</span><span class="num" id="5404609">2</span><span class="op" id="5404610">*</span><span class="ident" id="5404611">i</span><span class="op" id="5404612">+</span><span class="num" id="5404613">1</span><span class="op" id="5404614">]</span><span class="op" id="5404615">]</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404625">return</span>&nbsp;<span class="ident" id="5404632">ret</span><br>
<span class="lineno"></span><span class="op" id="5404636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="comment" id="5404639">//&nbsp;Expand&nbsp;appends&nbsp;template&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;result;&nbsp;during&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5404708">//&nbsp;append,&nbsp;Expand&nbsp;replaces&nbsp;variables&nbsp;in&nbsp;the&nbsp;template&nbsp;with&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="5404780">//&nbsp;matches&nbsp;drawn&nbsp;from&nbsp;src.&nbsp;&nbsp;The&nbsp;match&nbsp;slice&nbsp;should&nbsp;have&nbsp;been&nbsp;returned&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5404853">//&nbsp;FindSubmatchIndex.</span><br>
<span class="lineno"></span><span class="comment" id="5404875">//</span><br>
<span class="lineno">745</span><span class="comment" id="5404878">//&nbsp;In&nbsp;the&nbsp;template,&nbsp;a&nbsp;variable&nbsp;is&nbsp;denoted&nbsp;by&nbsp;a&nbsp;substring&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="5404947">//&nbsp;$name&nbsp;or&nbsp;${name},&nbsp;where&nbsp;name&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;sequence&nbsp;of&nbsp;letters,</span><br>
<span class="lineno"></span><span class="comment" id="5405015">//&nbsp;digits,&nbsp;and&nbsp;underscores.&nbsp;&nbsp;A&nbsp;purely&nbsp;numeric&nbsp;name&nbsp;like&nbsp;$1&nbsp;refers&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5405084">//&nbsp;the&nbsp;submatch&nbsp;with&nbsp;the&nbsp;corresponding&nbsp;index;&nbsp;other&nbsp;names&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5405151">//&nbsp;capturing&nbsp;parentheses&nbsp;named&nbsp;with&nbsp;the&nbsp;(?P&lt;name&gt;...)&nbsp;syntax.&nbsp;&nbsp;A</span><br>
<span class="lineno">750</span><span class="comment" id="5405216">//&nbsp;reference&nbsp;to&nbsp;an&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;unmatched&nbsp;index&nbsp;or&nbsp;a&nbsp;name&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5405289">//&nbsp;present&nbsp;in&nbsp;the&nbsp;regular&nbsp;expression&nbsp;is&nbsp;replaced&nbsp;with&nbsp;an&nbsp;empty&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5405359">//</span><br>
<span class="lineno"></span><span class="comment" id="5405362">//&nbsp;In&nbsp;the&nbsp;$name&nbsp;form,&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;as&nbsp;long&nbsp;as&nbsp;possible:&nbsp;$1x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5405432">//&nbsp;equivalent&nbsp;to&nbsp;${1x},&nbsp;not&nbsp;${1}x,&nbsp;and,&nbsp;$10&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;${10},&nbsp;not&nbsp;${1}0.</span><br>
<span class="lineno">755</span><span class="comment" id="5405511">//</span><br>
<span class="lineno"></span><span class="comment" id="5405514">//&nbsp;To&nbsp;insert&nbsp;a&nbsp;literal&nbsp;$&nbsp;in&nbsp;the&nbsp;output,&nbsp;use&nbsp;$$&nbsp;in&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5405578">func</span>&nbsp;<span class="op" id="5405583">(</span><span class="ident" id="5405584">re</span>&nbsp;<span class="op" id="5405587">*</span><span class="ident" id="5405588">Regexp</span><span class="op" id="5405594">)</span>&nbsp;<span class="ident" id="5405596">Expand</span><span class="op" id="5405602">(</span><span class="ident" id="5405603">dst</span>&nbsp;<span class="op" id="5405607">[</span><span class="op" id="5405608">]</span><span class="builtintype" id="5405609">byte</span><span class="op" id="5405613">,</span>&nbsp;<span class="ident" id="5405615">template</span>&nbsp;<span class="op" id="5405624">[</span><span class="op" id="5405625">]</span><span class="builtintype" id="5405626">byte</span><span class="op" id="5405630">,</span>&nbsp;<span class="ident" id="5405632">src</span>&nbsp;<span class="op" id="5405636">[</span><span class="op" id="5405637">]</span><span class="builtintype" id="5405638">byte</span><span class="op" id="5405642">,</span>&nbsp;<span class="ident" id="5405644">match</span>&nbsp;<span class="op" id="5405650">[</span><span class="op" id="5405651">]</span><span class="builtintype" id="5405652">int</span><span class="op" id="5405655">)</span>&nbsp;<span class="op" id="5405657">[</span><span class="op" id="5405658">]</span><span class="builtintype" id="5405659">byte</span>&nbsp;<span class="op" id="5405664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405667">return</span>&nbsp;<span class="ident" id="5405674">re</span><span class="op" id="5405676">.</span><span class="ident" id="5405677">expand</span><span class="op" id="5405683">(</span><span class="ident" id="5405684">dst</span><span class="op" id="5405687">,</span>&nbsp;<span class="builtintype" id="5405689">string</span><span class="op" id="5405695">(</span><span class="ident" id="5405696">template</span><span class="op" id="5405704">)</span><span class="op" id="5405705">,</span>&nbsp;<span class="ident" id="5405707">src</span><span class="op" id="5405710">,</span>&nbsp;<span class="string" id="5405712">&#34;&#34;</span><span class="op" id="5405714">,</span>&nbsp;<span class="ident" id="5405716">match</span><span class="op" id="5405721">)</span><br>
<span class="lineno"></span><span class="op" id="5405723">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5405726">//&nbsp;ExpandString&nbsp;is&nbsp;like&nbsp;Expand&nbsp;but&nbsp;the&nbsp;template&nbsp;and&nbsp;source&nbsp;are&nbsp;strings.</span><br>
<span class="lineno"></span><span class="comment" id="5405798">//&nbsp;It&nbsp;appends&nbsp;to&nbsp;and&nbsp;returns&nbsp;a&nbsp;byte&nbsp;slice&nbsp;in&nbsp;order&nbsp;to&nbsp;give&nbsp;the&nbsp;calling</span><br>
<span class="lineno"></span><span class="comment" id="5405869">//&nbsp;code&nbsp;control&nbsp;over&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5405902">func</span>&nbsp;<span class="op" id="5405907">(</span><span class="ident" id="5405908">re</span>&nbsp;<span class="op" id="5405911">*</span><span class="ident" id="5405912">Regexp</span><span class="op" id="5405918">)</span>&nbsp;<span class="ident" id="5405920">ExpandString</span><span class="op" id="5405932">(</span><span class="ident" id="5405933">dst</span>&nbsp;<span class="op" id="5405937">[</span><span class="op" id="5405938">]</span><span class="builtintype" id="5405939">byte</span><span class="op" id="5405943">,</span>&nbsp;<span class="ident" id="5405945">template</span>&nbsp;<span class="builtintype" id="5405954">string</span><span class="op" id="5405960">,</span>&nbsp;<span class="ident" id="5405962">src</span>&nbsp;<span class="builtintype" id="5405966">string</span><span class="op" id="5405972">,</span>&nbsp;<span class="ident" id="5405974">match</span>&nbsp;<span class="op" id="5405980">[</span><span class="op" id="5405981">]</span><span class="builtintype" id="5405982">int</span><span class="op" id="5405985">)</span>&nbsp;<span class="op" id="5405987">[</span><span class="op" id="5405988">]</span><span class="builtintype" id="5405989">byte</span>&nbsp;<span class="op" id="5405994">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405997">return</span>&nbsp;<span class="ident" id="5406004">re</span><span class="op" id="5406006">.</span><span class="ident" id="5406007">expand</span><span class="op" id="5406013">(</span><span class="ident" id="5406014">dst</span><span class="op" id="5406017">,</span>&nbsp;<span class="ident" id="5406019">template</span><span class="op" id="5406027">,</span>&nbsp;<span class="ident" id="5406029">nil</span><span class="op" id="5406032">,</span>&nbsp;<span class="ident" id="5406034">src</span><span class="op" id="5406037">,</span>&nbsp;<span class="ident" id="5406039">match</span><span class="op" id="5406044">)</span><br>
<span class="lineno"></span><span class="op" id="5406046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5406049">func</span>&nbsp;<span class="op" id="5406054">(</span><span class="ident" id="5406055">re</span>&nbsp;<span class="op" id="5406058">*</span><span class="ident" id="5406059">Regexp</span><span class="op" id="5406065">)</span>&nbsp;<span class="ident" id="5406067">expand</span><span class="op" id="5406073">(</span><span class="ident" id="5406074">dst</span>&nbsp;<span class="op" id="5406078">[</span><span class="op" id="5406079">]</span><span class="builtintype" id="5406080">byte</span><span class="op" id="5406084">,</span>&nbsp;<span class="ident" id="5406086">template</span>&nbsp;<span class="builtintype" id="5406095">string</span><span class="op" id="5406101">,</span>&nbsp;<span class="ident" id="5406103">bsrc</span>&nbsp;<span class="op" id="5406108">[</span><span class="op" id="5406109">]</span><span class="builtintype" id="5406110">byte</span><span class="op" id="5406114">,</span>&nbsp;<span class="ident" id="5406116">src</span>&nbsp;<span class="builtintype" id="5406120">string</span><span class="op" id="5406126">,</span>&nbsp;<span class="ident" id="5406128">match</span>&nbsp;<span class="op" id="5406134">[</span><span class="op" id="5406135">]</span><span class="builtintype" id="5406136">int</span><span class="op" id="5406139">)</span>&nbsp;<span class="op" id="5406141">[</span><span class="op" id="5406142">]</span><span class="builtintype" id="5406143">byte</span>&nbsp;<span class="op" id="5406148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406151">for</span>&nbsp;<span class="builtinfunc" id="5406155">len</span><span class="op" id="5406158">(</span><span class="ident" id="5406159">template</span><span class="op" id="5406167">)</span>&nbsp;<span class="op" id="5406169">&gt;</span>&nbsp;<span class="num" id="5406171">0</span>&nbsp;<span class="op" id="5406173">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406177">i</span>&nbsp;<span class="op" id="5406179">:=</span>&nbsp;<span class="ident" id="5406182">strings</span><span class="op" id="5406189">.</span><span class="ident" id="5406190">Index</span><span class="op" id="5406195">(</span><span class="ident" id="5406196">template</span><span class="op" id="5406204">,</span>&nbsp;<span class="string" id="5406206">&#34;$&#34;</span><span class="op" id="5406209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406213">if</span>&nbsp;<span class="ident" id="5406216">i</span>&nbsp;<span class="op" id="5406218">&lt;</span>&nbsp;<span class="num" id="5406220">0</span>&nbsp;<span class="op" id="5406222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406227">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5406235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406239">dst</span>&nbsp;<span class="op" id="5406243">=</span>&nbsp;<span class="builtinfunc" id="5406245">append</span><span class="op" id="5406251">(</span><span class="ident" id="5406252">dst</span><span class="op" id="5406255">,</span>&nbsp;<span class="ident" id="5406257">template</span><span class="op" id="5406265">[</span><span class="op" id="5406266">:</span><span class="ident" id="5406267">i</span><span class="op" id="5406268">]</span><span class="op" id="5406269">...</span><span class="op" id="5406272">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406276">template</span>&nbsp;<span class="op" id="5406285">=</span>&nbsp;<span class="ident" id="5406287">template</span><span class="op" id="5406295">[</span><span class="ident" id="5406296">i</span><span class="op" id="5406297">:</span><span class="op" id="5406298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406302">if</span>&nbsp;<span class="builtinfunc" id="5406305">len</span><span class="op" id="5406308">(</span><span class="ident" id="5406309">template</span><span class="op" id="5406317">)</span>&nbsp;<span class="op" id="5406319">&gt;</span>&nbsp;<span class="num" id="5406321">1</span>&nbsp;<span class="op" id="5406323">&amp;&amp;</span>&nbsp;<span class="ident" id="5406326">template</span><span class="op" id="5406334">[</span><span class="num" id="5406335">1</span><span class="op" id="5406336">]</span>&nbsp;<span class="op" id="5406338">==</span>&nbsp;<span class="string" id="5406341">&#39;$&#39;</span>&nbsp;<span class="op" id="5406345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5406350">//&nbsp;Treat&nbsp;$$&nbsp;as&nbsp;$.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406371">dst</span>&nbsp;<span class="op" id="5406375">=</span>&nbsp;<span class="builtinfunc" id="5406377">append</span><span class="op" id="5406383">(</span><span class="ident" id="5406384">dst</span><span class="op" id="5406387">,</span>&nbsp;<span class="string" id="5406389">&#39;$&#39;</span><span class="op" id="5406392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406397">template</span>&nbsp;<span class="op" id="5406406">=</span>&nbsp;<span class="ident" id="5406408">template</span><span class="op" id="5406416">[</span><span class="num" id="5406417">2</span><span class="op" id="5406418">:</span><span class="op" id="5406419">]</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406424">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5406435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406439">name</span><span class="op" id="5406443">,</span>&nbsp;<span class="ident" id="5406445">num</span><span class="op" id="5406448">,</span>&nbsp;<span class="ident" id="5406450">rest</span><span class="op" id="5406454">,</span>&nbsp;<span class="ident" id="5406456">ok</span>&nbsp;<span class="op" id="5406459">:=</span>&nbsp;<span class="ident" id="5406462">extract</span><span class="op" id="5406469">(</span><span class="ident" id="5406470">template</span><span class="op" id="5406478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406482">if</span>&nbsp;<span class="op" id="5406485">!</span><span class="ident" id="5406486">ok</span>&nbsp;<span class="op" id="5406489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5406494">//&nbsp;Malformed;&nbsp;treat&nbsp;$&nbsp;as&nbsp;raw&nbsp;text.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406532">dst</span>&nbsp;<span class="op" id="5406536">=</span>&nbsp;<span class="builtinfunc" id="5406538">append</span><span class="op" id="5406544">(</span><span class="ident" id="5406545">dst</span><span class="op" id="5406548">,</span>&nbsp;<span class="string" id="5406550">&#39;$&#39;</span><span class="op" id="5406553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406558">template</span>&nbsp;<span class="op" id="5406567">=</span>&nbsp;<span class="ident" id="5406569">template</span><span class="op" id="5406577">[</span><span class="num" id="5406578">1</span><span class="op" id="5406579">:</span><span class="op" id="5406580">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406585">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5406596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406600">template</span>&nbsp;<span class="op" id="5406609">=</span>&nbsp;<span class="ident" id="5406611">rest</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406618">if</span>&nbsp;<span class="ident" id="5406621">num</span>&nbsp;<span class="op" id="5406625">&gt;=</span>&nbsp;<span class="num" id="5406628">0</span>&nbsp;<span class="op" id="5406630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406635">if</span>&nbsp;<span class="num" id="5406638">2</span><span class="op" id="5406639">*</span><span class="ident" id="5406640">num</span><span class="op" id="5406643">+</span><span class="num" id="5406644">1</span>&nbsp;<span class="op" id="5406646">&lt;</span>&nbsp;<span class="builtinfunc" id="5406648">len</span><span class="op" id="5406651">(</span><span class="ident" id="5406652">match</span><span class="op" id="5406657">)</span>&nbsp;<span class="op" id="5406659">&amp;&amp;</span>&nbsp;<span class="ident" id="5406662">match</span><span class="op" id="5406667">[</span><span class="num" id="5406668">2</span><span class="op" id="5406669">*</span><span class="ident" id="5406670">num</span><span class="op" id="5406673">]</span>&nbsp;<span class="op" id="5406675">&gt;=</span>&nbsp;<span class="num" id="5406678">0</span>&nbsp;<span class="op" id="5406680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406686">if</span>&nbsp;<span class="ident" id="5406689">bsrc</span>&nbsp;<span class="op" id="5406694">!=</span>&nbsp;<span class="ident" id="5406697">nil</span>&nbsp;<span class="op" id="5406701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406708">dst</span>&nbsp;<span class="op" id="5406712">=</span>&nbsp;<span class="builtinfunc" id="5406714">append</span><span class="op" id="5406720">(</span><span class="ident" id="5406721">dst</span><span class="op" id="5406724">,</span>&nbsp;<span class="ident" id="5406726">bsrc</span><span class="op" id="5406730">[</span><span class="ident" id="5406731">match</span><span class="op" id="5406736">[</span><span class="num" id="5406737">2</span><span class="op" id="5406738">*</span><span class="ident" id="5406739">num</span><span class="op" id="5406742">]</span><span class="op" id="5406743">:</span><span class="ident" id="5406744">match</span><span class="op" id="5406749">[</span><span class="num" id="5406750">2</span><span class="op" id="5406751">*</span><span class="ident" id="5406752">num</span><span class="op" id="5406755">+</span><span class="num" id="5406756">1</span><span class="op" id="5406757">]</span><span class="op" id="5406758">]</span><span class="op" id="5406759">...</span><span class="op" id="5406762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5406768">}</span>&nbsp;<span class="keyword" id="5406770">else</span>&nbsp;<span class="op" id="5406775">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406782">dst</span>&nbsp;<span class="op" id="5406786">=</span>&nbsp;<span class="builtinfunc" id="5406788">append</span><span class="op" id="5406794">(</span><span class="ident" id="5406795">dst</span><span class="op" id="5406798">,</span>&nbsp;<span class="ident" id="5406800">src</span><span class="op" id="5406803">[</span><span class="ident" id="5406804">match</span><span class="op" id="5406809">[</span><span class="num" id="5406810">2</span><span class="op" id="5406811">*</span><span class="ident" id="5406812">num</span><span class="op" id="5406815">]</span><span class="op" id="5406816">:</span><span class="ident" id="5406817">match</span><span class="op" id="5406822">[</span><span class="num" id="5406823">2</span><span class="op" id="5406824">*</span><span class="ident" id="5406825">num</span><span class="op" id="5406828">+</span><span class="num" id="5406829">1</span><span class="op" id="5406830">]</span><span class="op" id="5406831">]</span><span class="op" id="5406832">...</span><span class="op" id="5406835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5406841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5406846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5406850">}</span>&nbsp;<span class="keyword" id="5406852">else</span>&nbsp;<span class="op" id="5406857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406862">for</span>&nbsp;<span class="ident" id="5406866">i</span><span class="op" id="5406867">,</span>&nbsp;<span class="ident" id="5406869">namei</span>&nbsp;<span class="op" id="5406875">:=</span>&nbsp;<span class="keyword" id="5406878">range</span>&nbsp;<span class="ident" id="5406884">re</span><span class="op" id="5406886">.</span><span class="ident" id="5406887">subexpNames</span>&nbsp;<span class="op" id="5406899">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406905">if</span>&nbsp;<span class="ident" id="5406908">name</span>&nbsp;<span class="op" id="5406913">==</span>&nbsp;<span class="ident" id="5406916">namei</span>&nbsp;<span class="op" id="5406922">&amp;&amp;</span>&nbsp;<span class="num" id="5406925">2</span><span class="op" id="5406926">*</span><span class="ident" id="5406927">i</span><span class="op" id="5406928">+</span><span class="num" id="5406929">1</span>&nbsp;<span class="op" id="5406931">&lt;</span>&nbsp;<span class="builtinfunc" id="5406933">len</span><span class="op" id="5406936">(</span><span class="ident" id="5406937">match</span><span class="op" id="5406942">)</span>&nbsp;<span class="op" id="5406944">&amp;&amp;</span>&nbsp;<span class="ident" id="5406947">match</span><span class="op" id="5406952">[</span><span class="num" id="5406953">2</span><span class="op" id="5406954">*</span><span class="ident" id="5406955">i</span><span class="op" id="5406956">]</span>&nbsp;<span class="op" id="5406958">&gt;=</span>&nbsp;<span class="num" id="5406961">0</span>&nbsp;<span class="op" id="5406963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406970">if</span>&nbsp;<span class="ident" id="5406973">bsrc</span>&nbsp;<span class="op" id="5406978">!=</span>&nbsp;<span class="ident" id="5406981">nil</span>&nbsp;<span class="op" id="5406985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406993">dst</span>&nbsp;<span class="op" id="5406997">=</span>&nbsp;<span class="builtinfunc" id="5406999">append</span><span class="op" id="5407005">(</span><span class="ident" id="5407006">dst</span><span class="op" id="5407009">,</span>&nbsp;<span class="ident" id="5407011">bsrc</span><span class="op" id="5407015">[</span><span class="ident" id="5407016">match</span><span class="op" id="5407021">[</span><span class="num" id="5407022">2</span><span class="op" id="5407023">*</span><span class="ident" id="5407024">i</span><span class="op" id="5407025">]</span><span class="op" id="5407026">:</span><span class="ident" id="5407027">match</span><span class="op" id="5407032">[</span><span class="num" id="5407033">2</span><span class="op" id="5407034">*</span><span class="ident" id="5407035">i</span><span class="op" id="5407036">+</span><span class="num" id="5407037">1</span><span class="op" id="5407038">]</span><span class="op" id="5407039">]</span><span class="op" id="5407040">...</span><span class="op" id="5407043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407050">}</span>&nbsp;<span class="keyword" id="5407052">else</span>&nbsp;<span class="op" id="5407057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407065">dst</span>&nbsp;<span class="op" id="5407069">=</span>&nbsp;<span class="builtinfunc" id="5407071">append</span><span class="op" id="5407077">(</span><span class="ident" id="5407078">dst</span><span class="op" id="5407081">,</span>&nbsp;<span class="ident" id="5407083">src</span><span class="op" id="5407086">[</span><span class="ident" id="5407087">match</span><span class="op" id="5407092">[</span><span class="num" id="5407093">2</span><span class="op" id="5407094">*</span><span class="ident" id="5407095">i</span><span class="op" id="5407096">]</span><span class="op" id="5407097">:</span><span class="ident" id="5407098">match</span><span class="op" id="5407103">[</span><span class="num" id="5407104">2</span><span class="op" id="5407105">*</span><span class="ident" id="5407106">i</span><span class="op" id="5407107">+</span><span class="num" id="5407108">1</span><span class="op" id="5407109">]</span><span class="op" id="5407110">]</span><span class="op" id="5407111">...</span><span class="op" id="5407114">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407128">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407147">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407153">dst</span>&nbsp;<span class="op" id="5407157">=</span>&nbsp;<span class="builtinfunc" id="5407159">append</span><span class="op" id="5407165">(</span><span class="ident" id="5407166">dst</span><span class="op" id="5407169">,</span>&nbsp;<span class="ident" id="5407171">template</span><span class="op" id="5407179">...</span><span class="op" id="5407182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407185">return</span>&nbsp;<span class="ident" id="5407192">dst</span><br>
<span class="lineno"></span><span class="op" id="5407196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span><span class="comment" id="5407199">//&nbsp;extract&nbsp;returns&nbsp;the&nbsp;name&nbsp;from&nbsp;a&nbsp;leading&nbsp;&#34;$name&#34;&nbsp;or&nbsp;&#34;${name}&#34;&nbsp;in&nbsp;str.</span><br>
<span class="lineno"></span><span class="comment" id="5407271">//&nbsp;If&nbsp;it&nbsp;is&nbsp;a&nbsp;number,&nbsp;extract&nbsp;returns&nbsp;num&nbsp;set&nbsp;to&nbsp;that&nbsp;number;&nbsp;otherwise&nbsp;num&nbsp;=&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="5407353">func</span>&nbsp;<span class="ident" id="5407358">extract</span><span class="op" id="5407365">(</span><span class="ident" id="5407366">str</span>&nbsp;<span class="builtintype" id="5407370">string</span><span class="op" id="5407376">)</span>&nbsp;<span class="op" id="5407378">(</span><span class="ident" id="5407379">name</span>&nbsp;<span class="builtintype" id="5407384">string</span><span class="op" id="5407390">,</span>&nbsp;<span class="ident" id="5407392">num</span>&nbsp;<span class="builtintype" id="5407396">int</span><span class="op" id="5407399">,</span>&nbsp;<span class="ident" id="5407401">rest</span>&nbsp;<span class="builtintype" id="5407406">string</span><span class="op" id="5407412">,</span>&nbsp;<span class="ident" id="5407414">ok</span>&nbsp;<span class="builtintype" id="5407417">bool</span><span class="op" id="5407421">)</span>&nbsp;<span class="op" id="5407423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407426">if</span>&nbsp;<span class="builtinfunc" id="5407429">len</span><span class="op" id="5407432">(</span><span class="ident" id="5407433">str</span><span class="op" id="5407436">)</span>&nbsp;<span class="op" id="5407438">&lt;</span>&nbsp;<span class="num" id="5407440">2</span>&nbsp;<span class="op" id="5407442">||</span>&nbsp;<span class="ident" id="5407445">str</span><span class="op" id="5407448">[</span><span class="num" id="5407449">0</span><span class="op" id="5407450">]</span>&nbsp;<span class="op" id="5407452">!=</span>&nbsp;<span class="string" id="5407455">&#39;$&#39;</span>&nbsp;<span class="op" id="5407459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407463">return</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407474">brace</span>&nbsp;<span class="op" id="5407480">:=</span>&nbsp;<span class="builtintype" id="5407483">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407490">if</span>&nbsp;<span class="ident" id="5407493">str</span><span class="op" id="5407496">[</span><span class="num" id="5407497">1</span><span class="op" id="5407498">]</span>&nbsp;<span class="op" id="5407500">==</span>&nbsp;<span class="string" id="5407503">&#39;{&#39;</span>&nbsp;<span class="op" id="5407507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407511">brace</span>&nbsp;<span class="op" id="5407517">=</span>&nbsp;<span class="builtintype" id="5407519">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407526">str</span>&nbsp;<span class="op" id="5407530">=</span>&nbsp;<span class="ident" id="5407532">str</span><span class="op" id="5407535">[</span><span class="num" id="5407536">2</span><span class="op" id="5407537">:</span><span class="op" id="5407538">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407541">}</span>&nbsp;<span class="keyword" id="5407543">else</span>&nbsp;<span class="op" id="5407548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407552">str</span>&nbsp;<span class="op" id="5407556">=</span>&nbsp;<span class="ident" id="5407558">str</span><span class="op" id="5407561">[</span><span class="num" id="5407562">1</span><span class="op" id="5407563">:</span><span class="op" id="5407564">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407570">i</span>&nbsp;<span class="op" id="5407572">:=</span>&nbsp;<span class="num" id="5407575">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407578">for</span>&nbsp;<span class="ident" id="5407582">i</span>&nbsp;<span class="op" id="5407584">&lt;</span>&nbsp;<span class="builtinfunc" id="5407586">len</span><span class="op" id="5407589">(</span><span class="ident" id="5407590">str</span><span class="op" id="5407593">)</span>&nbsp;<span class="op" id="5407595">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5407599">rune</span><span class="op" id="5407603">,</span>&nbsp;<span class="ident" id="5407605">size</span>&nbsp;<span class="op" id="5407610">:=</span>&nbsp;<span class="ident" id="5407613">utf8</span><span class="op" id="5407617">.</span><span class="ident" id="5407618">DecodeRuneInString</span><span class="op" id="5407636">(</span><span class="ident" id="5407637">str</span><span class="op" id="5407640">[</span><span class="ident" id="5407641">i</span><span class="op" id="5407642">:</span><span class="op" id="5407643">]</span><span class="op" id="5407644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407648">if</span>&nbsp;<span class="op" id="5407651">!</span><span class="ident" id="5407652">unicode</span><span class="op" id="5407659">.</span><span class="ident" id="5407660">IsLetter</span><span class="op" id="5407668">(</span><span class="builtintype" id="5407669">rune</span><span class="op" id="5407673">)</span>&nbsp;<span class="op" id="5407675">&amp;&amp;</span>&nbsp;<span class="op" id="5407678">!</span><span class="ident" id="5407679">unicode</span><span class="op" id="5407686">.</span><span class="ident" id="5407687">IsDigit</span><span class="op" id="5407694">(</span><span class="builtintype" id="5407695">rune</span><span class="op" id="5407699">)</span>&nbsp;<span class="op" id="5407701">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5407704">rune</span>&nbsp;<span class="op" id="5407709">!=</span>&nbsp;<span class="string" id="5407712">&#39;_&#39;</span>&nbsp;<span class="op" id="5407716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407721">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407733">i</span>&nbsp;<span class="op" id="5407735">+=</span>&nbsp;<span class="ident" id="5407738">size</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407747">if</span>&nbsp;<span class="ident" id="5407750">i</span>&nbsp;<span class="op" id="5407752">==</span>&nbsp;<span class="num" id="5407755">0</span>&nbsp;<span class="op" id="5407757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5407761">//&nbsp;empty&nbsp;name&nbsp;is&nbsp;not&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407789">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407797">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407800">name</span>&nbsp;<span class="op" id="5407805">=</span>&nbsp;<span class="ident" id="5407807">str</span><span class="op" id="5407810">[</span><span class="op" id="5407811">:</span><span class="ident" id="5407812">i</span><span class="op" id="5407813">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407816">if</span>&nbsp;<span class="ident" id="5407819">brace</span>&nbsp;<span class="op" id="5407825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407829">if</span>&nbsp;<span class="ident" id="5407832">i</span>&nbsp;<span class="op" id="5407834">&gt;=</span>&nbsp;<span class="builtinfunc" id="5407837">len</span><span class="op" id="5407840">(</span><span class="ident" id="5407841">str</span><span class="op" id="5407844">)</span>&nbsp;<span class="op" id="5407846">||</span>&nbsp;<span class="ident" id="5407849">str</span><span class="op" id="5407852">[</span><span class="ident" id="5407853">i</span><span class="op" id="5407854">]</span>&nbsp;<span class="op" id="5407856">!=</span>&nbsp;<span class="string" id="5407859">&#39;}&#39;</span>&nbsp;<span class="op" id="5407863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5407868">//&nbsp;missing&nbsp;closing&nbsp;brace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407896">return</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407909">i</span><span class="op" id="5407910">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5407914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5407918">//&nbsp;Parse&nbsp;number.</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5407936">num</span>&nbsp;<span class="op" id="5407940">=</span>&nbsp;<span class="num" id="5407942">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407945">for</span>&nbsp;<span class="ident" id="5407949">i</span>&nbsp;<span class="op" id="5407951">:=</span>&nbsp;<span class="num" id="5407954">0</span><span class="op" id="5407955">;</span>&nbsp;<span class="ident" id="5407957">i</span>&nbsp;<span class="op" id="5407959">&lt;</span>&nbsp;<span class="builtinfunc" id="5407961">len</span><span class="op" id="5407964">(</span><span class="ident" id="5407965">name</span><span class="op" id="5407969">)</span><span class="op" id="5407970">;</span>&nbsp;<span class="ident" id="5407972">i</span><span class="op" id="5407973">++</span>&nbsp;<span class="op" id="5407976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5407980">if</span>&nbsp;<span class="ident" id="5407983">name</span><span class="op" id="5407987">[</span><span class="ident" id="5407988">i</span><span class="op" id="5407989">]</span>&nbsp;<span class="op" id="5407991">&lt;</span>&nbsp;<span class="string" id="5407993">&#39;0&#39;</span>&nbsp;<span class="op" id="5407997">||</span>&nbsp;<span class="string" id="5408000">&#39;9&#39;</span>&nbsp;<span class="op" id="5408004">&lt;</span>&nbsp;<span class="ident" id="5408006">name</span><span class="op" id="5408010">[</span><span class="ident" id="5408011">i</span><span class="op" id="5408012">]</span>&nbsp;<span class="op" id="5408014">||</span>&nbsp;<span class="ident" id="5408017">num</span>&nbsp;<span class="op" id="5408021">&gt;=</span>&nbsp;<span class="num" id="5408024">1e8</span>&nbsp;<span class="op" id="5408028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5408033">num</span>&nbsp;<span class="op" id="5408037">=</span>&nbsp;<span class="op" id="5408039">-</span><span class="num" id="5408040">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5408045">break</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5408053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5408057">num</span>&nbsp;<span class="op" id="5408061">=</span>&nbsp;<span class="ident" id="5408063">num</span><span class="op" id="5408066">*</span><span class="num" id="5408067">10</span>&nbsp;<span class="op" id="5408070">+</span>&nbsp;<span class="builtintype" id="5408072">int</span><span class="op" id="5408075">(</span><span class="ident" id="5408076">name</span><span class="op" id="5408080">[</span><span class="ident" id="5408081">i</span><span class="op" id="5408082">]</span><span class="op" id="5408083">)</span>&nbsp;<span class="op" id="5408085">-</span>&nbsp;<span class="string" id="5408087">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5408092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5408095">//&nbsp;Disallow&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5408123">if</span>&nbsp;<span class="ident" id="5408126">name</span><span class="op" id="5408130">[</span><span class="num" id="5408131">0</span><span class="op" id="5408132">]</span>&nbsp;<span class="op" id="5408134">==</span>&nbsp;<span class="string" id="5408137">&#39;0&#39;</span>&nbsp;<span class="op" id="5408141">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5408144">len</span><span class="op" id="5408147">(</span><span class="ident" id="5408148">name</span><span class="op" id="5408152">)</span>&nbsp;<span class="op" id="5408154">&gt;</span>&nbsp;<span class="num" id="5408156">1</span>&nbsp;<span class="op" id="5408158">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5408162">num</span>&nbsp;<span class="op" id="5408166">=</span>&nbsp;<span class="op" id="5408168">-</span><span class="num" id="5408169">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5408172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5408176">rest</span>&nbsp;<span class="op" id="5408181">=</span>&nbsp;<span class="ident" id="5408183">str</span><span class="op" id="5408186">[</span><span class="ident" id="5408187">i</span><span class="op" id="5408188">:</span><span class="op" id="5408189">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5408192">ok</span>&nbsp;<span class="op" id="5408195">=</span>&nbsp;<span class="builtintype" id="5408197">true</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5408203">return</span><br>
<span class="lineno"></span><span class="op" id="5408210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5408213">//&nbsp;FindSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs&nbsp;identifying&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5408290">//&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;b&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of</span><br>
<span class="lineno">870</span><span class="comment" id="5408367">//&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and&nbsp;&#39;Index&#39;&nbsp;descriptions</span><br>
<span class="lineno"></span><span class="comment" id="5408444">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5408471">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5408516">func</span>&nbsp;<span class="op" id="5408521">(</span><span class="ident" id="5408522">re</span>&nbsp;<span class="op" id="5408525">*</span><span class="ident" id="5408526">Regexp</span><span class="op" id="5408532">)</span>&nbsp;<span class="ident" id="5408534">FindSubmatchIndex</span><span class="op" id="5408551">(</span><span class="ident" id="5408552">b</span>&nbsp;<span class="op" id="5408554">[</span><span class="op" id="5408555">]</span><span class="builtintype" id="5408556">byte</span><span class="op" id="5408560">)</span>&nbsp;<span class="op" id="5408562">[</span><span class="op" id="5408563">]</span><span class="builtintype" id="5408564">int</span>&nbsp;<span class="op" id="5408568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5408571">return</span>&nbsp;<span class="ident" id="5408578">re</span><span class="op" id="5408580">.</span><span class="ident" id="5408581">pad</span><span class="op" id="5408584">(</span><span class="ident" id="5408585">re</span><span class="op" id="5408587">.</span><span class="ident" id="5408588">doExecute</span><span class="op" id="5408597">(</span><span class="ident" id="5408598">nil</span><span class="op" id="5408601">,</span>&nbsp;<span class="ident" id="5408603">b</span><span class="op" id="5408604">,</span>&nbsp;<span class="string" id="5408606">&#34;&#34;</span><span class="op" id="5408608">,</span>&nbsp;<span class="num" id="5408610">0</span><span class="op" id="5408611">,</span>&nbsp;<span class="ident" id="5408613">re</span><span class="op" id="5408615">.</span><span class="ident" id="5408616">prog</span><span class="op" id="5408620">.</span><span class="ident" id="5408621">NumCap</span><span class="op" id="5408627">)</span><span class="op" id="5408628">)</span><br>
<span class="lineno">875</span><span class="op" id="5408630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5408633">//&nbsp;FindStringSubmatch&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;strings&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5408706">//&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;s&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5408783">//&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;description&nbsp;in&nbsp;the</span><br>
<span class="lineno">880</span><span class="comment" id="5408854">//&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5408874">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5408919">func</span>&nbsp;<span class="op" id="5408924">(</span><span class="ident" id="5408925">re</span>&nbsp;<span class="op" id="5408928">*</span><span class="ident" id="5408929">Regexp</span><span class="op" id="5408935">)</span>&nbsp;<span class="ident" id="5408937">FindStringSubmatch</span><span class="op" id="5408955">(</span><span class="ident" id="5408956">s</span>&nbsp;<span class="builtintype" id="5408958">string</span><span class="op" id="5408964">)</span>&nbsp;<span class="op" id="5408966">[</span><span class="op" id="5408967">]</span><span class="builtintype" id="5408968">string</span>&nbsp;<span class="op" id="5408975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5408978">a</span>&nbsp;<span class="op" id="5408980">:=</span>&nbsp;<span class="ident" id="5408983">re</span><span class="op" id="5408985">.</span><span class="ident" id="5408986">doExecute</span><span class="op" id="5408995">(</span><span class="ident" id="5408996">nil</span><span class="op" id="5408999">,</span>&nbsp;<span class="ident" id="5409001">nil</span><span class="op" id="5409004">,</span>&nbsp;<span class="ident" id="5409006">s</span><span class="op" id="5409007">,</span>&nbsp;<span class="num" id="5409009">0</span><span class="op" id="5409010">,</span>&nbsp;<span class="ident" id="5409012">re</span><span class="op" id="5409014">.</span><span class="ident" id="5409015">prog</span><span class="op" id="5409019">.</span><span class="ident" id="5409020">NumCap</span><span class="op" id="5409026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5409029">if</span>&nbsp;<span class="ident" id="5409032">a</span>&nbsp;<span class="op" id="5409034">==</span>&nbsp;<span class="ident" id="5409037">nil</span>&nbsp;<span class="op" id="5409041">{</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5409045">return</span>&nbsp;<span class="ident" id="5409052">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5409057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5409060">ret</span>&nbsp;<span class="op" id="5409064">:=</span>&nbsp;<span class="builtinfunc" id="5409067">make</span><span class="op" id="5409071">(</span><span class="op" id="5409072">[</span><span class="op" id="5409073">]</span><span class="builtintype" id="5409074">string</span><span class="op" id="5409080">,</span>&nbsp;<span class="num" id="5409082">1</span><span class="op" id="5409083">+</span><span class="ident" id="5409084">re</span><span class="op" id="5409086">.</span><span class="ident" id="5409087">numSubexp</span><span class="op" id="5409096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5409099">for</span>&nbsp;<span class="ident" id="5409103">i</span>&nbsp;<span class="op" id="5409105">:=</span>&nbsp;<span class="keyword" id="5409108">range</span>&nbsp;<span class="ident" id="5409114">ret</span>&nbsp;<span class="op" id="5409118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5409122">if</span>&nbsp;<span class="num" id="5409125">2</span><span class="op" id="5409126">*</span><span class="ident" id="5409127">i</span>&nbsp;<span class="op" id="5409129">&lt;</span>&nbsp;<span class="builtinfunc" id="5409131">len</span><span class="op" id="5409134">(</span><span class="ident" id="5409135">a</span><span class="op" id="5409136">)</span>&nbsp;<span class="op" id="5409138">&amp;&amp;</span>&nbsp;<span class="ident" id="5409141">a</span><span class="op" id="5409142">[</span><span class="num" id="5409143">2</span><span class="op" id="5409144">*</span><span class="ident" id="5409145">i</span><span class="op" id="5409146">]</span>&nbsp;<span class="op" id="5409148">&gt;=</span>&nbsp;<span class="num" id="5409151">0</span>&nbsp;<span class="op" id="5409153">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5409158">ret</span><span class="op" id="5409161">[</span><span class="ident" id="5409162">i</span><span class="op" id="5409163">]</span>&nbsp;<span class="op" id="5409165">=</span>&nbsp;<span class="ident" id="5409167">s</span><span class="op" id="5409168">[</span><span class="ident" id="5409169">a</span><span class="op" id="5409170">[</span><span class="num" id="5409171">2</span><span class="op" id="5409172">*</span><span class="ident" id="5409173">i</span><span class="op" id="5409174">]</span><span class="op" id="5409175">:</span><span class="ident" id="5409176">a</span><span class="op" id="5409177">[</span><span class="num" id="5409178">2</span><span class="op" id="5409179">*</span><span class="ident" id="5409180">i</span><span class="op" id="5409181">+</span><span class="num" id="5409182">1</span><span class="op" id="5409183">]</span><span class="op" id="5409184">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5409188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5409191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5409194">return</span>&nbsp;<span class="ident" id="5409201">ret</span><br>
<span class="lineno"></span><span class="op" id="5409205">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="comment" id="5409208">//&nbsp;FindStringSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs</span><br>
<span class="lineno"></span><span class="comment" id="5409275">//&nbsp;identifying&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5409348">//&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5409424">//&nbsp;&#39;Index&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">900</span><span class="comment" id="5409472">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5409517">func</span>&nbsp;<span class="op" id="5409522">(</span><span class="ident" id="5409523">re</span>&nbsp;<span class="op" id="5409526">*</span><span class="ident" id="5409527">Regexp</span><span class="op" id="5409533">)</span>&nbsp;<span class="ident" id="5409535">FindStringSubmatchIndex</span><span class="op" id="5409558">(</span><span class="ident" id="5409559">s</span>&nbsp;<span class="builtintype" id="5409561">string</span><span class="op" id="5409567">)</span>&nbsp;<span class="op" id="5409569">[</span><span class="op" id="5409570">]</span><span class="builtintype" id="5409571">int</span>&nbsp;<span class="op" id="5409575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5409578">return</span>&nbsp;<span class="ident" id="5409585">re</span><span class="op" id="5409587">.</span><span class="ident" id="5409588">pad</span><span class="op" id="5409591">(</span><span class="ident" id="5409592">re</span><span class="op" id="5409594">.</span><span class="ident" id="5409595">doExecute</span><span class="op" id="5409604">(</span><span class="ident" id="5409605">nil</span><span class="op" id="5409608">,</span>&nbsp;<span class="ident" id="5409610">nil</span><span class="op" id="5409613">,</span>&nbsp;<span class="ident" id="5409615">s</span><span class="op" id="5409616">,</span>&nbsp;<span class="num" id="5409618">0</span><span class="op" id="5409619">,</span>&nbsp;<span class="ident" id="5409621">re</span><span class="op" id="5409623">.</span><span class="ident" id="5409624">prog</span><span class="op" id="5409628">.</span><span class="ident" id="5409629">NumCap</span><span class="op" id="5409635">)</span><span class="op" id="5409636">)</span><br>
<span class="lineno"></span><span class="op" id="5409638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span><span class="comment" id="5409641">//&nbsp;FindReaderSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs</span><br>
<span class="lineno"></span><span class="comment" id="5409708">//&nbsp;identifying&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;of&nbsp;text&nbsp;read&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5409784">//&nbsp;the&nbsp;RuneReader,&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="5409862">//&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and&nbsp;&#39;Index&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.&nbsp;&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="5409935">//&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">910</span><span class="keyword" id="5409978">func</span>&nbsp;<span class="op" id="5409983">(</span><span class="ident" id="5409984">re</span>&nbsp;<span class="op" id="5409987">*</span><span class="ident" id="5409988">Regexp</span><span class="op" id="5409994">)</span>&nbsp;<span class="ident" id="5409996">FindReaderSubmatchIndex</span><span class="op" id="5410019">(</span><span class="ident" id="5410020">r</span>&nbsp;<span class="ident" id="5410022">io</span><span class="op" id="5410024">.</span><span class="ident" id="5410025">RuneReader</span><span class="op" id="5410035">)</span>&nbsp;<span class="op" id="5410037">[</span><span class="op" id="5410038">]</span><span class="builtintype" id="5410039">int</span>&nbsp;<span class="op" id="5410043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5410046">return</span>&nbsp;<span class="ident" id="5410053">re</span><span class="op" id="5410055">.</span><span class="ident" id="5410056">pad</span><span class="op" id="5410059">(</span><span class="ident" id="5410060">re</span><span class="op" id="5410062">.</span><span class="ident" id="5410063">doExecute</span><span class="op" id="5410072">(</span><span class="ident" id="5410073">r</span><span class="op" id="5410074">,</span>&nbsp;<span class="ident" id="5410076">nil</span><span class="op" id="5410079">,</span>&nbsp;<span class="string" id="5410081">&#34;&#34;</span><span class="op" id="5410083">,</span>&nbsp;<span class="num" id="5410085">0</span><span class="op" id="5410086">,</span>&nbsp;<span class="ident" id="5410088">re</span><span class="op" id="5410090">.</span><span class="ident" id="5410091">prog</span><span class="op" id="5410095">.</span><span class="ident" id="5410096">NumCap</span><span class="op" id="5410102">)</span><span class="op" id="5410103">)</span><br>
<span class="lineno"></span><span class="op" id="5410105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5410108">const</span>&nbsp;<span class="ident" id="5410114">startSize</span>&nbsp;<span class="op" id="5410124">=</span>&nbsp;<span class="num" id="5410126">10</span>&nbsp;<span class="comment" id="5410129">//&nbsp;The&nbsp;size&nbsp;at&nbsp;which&nbsp;to&nbsp;start&nbsp;a&nbsp;slice&nbsp;in&nbsp;the&nbsp;&#39;All&#39;&nbsp;routines.</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="5410191">//&nbsp;FindAll&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;Find;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="5410269">//&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5410342">//&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5410362">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">920</span><span class="keyword" id="5410407">func</span>&nbsp;<span class="op" id="5410412">(</span><span class="ident" id="5410413">re</span>&nbsp;<span class="op" id="5410416">*</span><span class="ident" id="5410417">Regexp</span><span class="op" id="5410423">)</span>&nbsp;<span class="ident" id="5410425">FindAll</span><span class="op" id="5410432">(</span><span class="ident" id="5410433">b</span>&nbsp;<span class="op" id="5410435">[</span><span class="op" id="5410436">]</span><span class="builtintype" id="5410437">byte</span><span class="op" id="5410441">,</span>&nbsp;<span class="ident" id="5410443">n</span>&nbsp;<span class="builtintype" id="5410445">int</span><span class="op" id="5410448">)</span>&nbsp;<span class="op" id="5410450">[</span><span class="op" id="5410451">]</span><span class="op" id="5410452">[</span><span class="op" id="5410453">]</span><span class="builtintype" id="5410454">byte</span>&nbsp;<span class="op" id="5410459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5410462">if</span>&nbsp;<span class="ident" id="5410465">n</span>&nbsp;<span class="op" id="5410467">&lt;</span>&nbsp;<span class="num" id="5410469">0</span>&nbsp;<span class="op" id="5410471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5410475">n</span>&nbsp;<span class="op" id="5410477">=</span>&nbsp;<span class="builtinfunc" id="5410479">len</span><span class="op" id="5410482">(</span><span class="ident" id="5410483">b</span><span class="op" id="5410484">)</span>&nbsp;<span class="op" id="5410486">+</span>&nbsp;<span class="num" id="5410488">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5410491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5410494">result</span>&nbsp;<span class="op" id="5410501">:=</span>&nbsp;<span class="builtinfunc" id="5410504">make</span><span class="op" id="5410508">(</span><span class="op" id="5410509">[</span><span class="op" id="5410510">]</span><span class="op" id="5410511">[</span><span class="op" id="5410512">]</span><span class="builtintype" id="5410513">byte</span><span class="op" id="5410517">,</span>&nbsp;<span class="num" id="5410519">0</span><span class="op" id="5410520">,</span>&nbsp;<span class="ident" id="5410522">startSize</span><span class="op" id="5410531">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5410534">re</span><span class="op" id="5410536">.</span><span class="ident" id="5410537">allMatches</span><span class="op" id="5410547">(</span><span class="string" id="5410548">&#34;&#34;</span><span class="op" id="5410550">,</span>&nbsp;<span class="ident" id="5410552">b</span><span class="op" id="5410553">,</span>&nbsp;<span class="ident" id="5410555">n</span><span class="op" id="5410556">,</span>&nbsp;<span class="keyword" id="5410558">func</span><span class="op" id="5410562">(</span><span class="ident" id="5410563">match</span>&nbsp;<span class="op" id="5410569">[</span><span class="op" id="5410570">]</span><span class="builtintype" id="5410571">int</span><span class="op" id="5410574">)</span>&nbsp;<span class="op" id="5410576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5410580">result</span>&nbsp;<span class="op" id="5410587">=</span>&nbsp;<span class="builtinfunc" id="5410589">append</span><span class="op" id="5410595">(</span><span class="ident" id="5410596">result</span><span class="op" id="5410602">,</span>&nbsp;<span class="ident" id="5410604">b</span><span class="op" id="5410605">[</span><span class="ident" id="5410606">match</span><span class="op" id="5410611">[</span><span class="num" id="5410612">0</span><span class="op" id="5410613">]</span><span class="op" id="5410614">:</span><span class="ident" id="5410615">match</span><span class="op" id="5410620">[</span><span class="num" id="5410621">1</span><span class="op" id="5410622">]</span><span class="op" id="5410623">]</span><span class="op" id="5410624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5410627">}</span><span class="op" id="5410628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5410631">if</span>&nbsp;<span class="builtinfunc" id="5410634">len</span><span class="op" id="5410637">(</span><span class="ident" id="5410638">result</span><span class="op" id="5410644">)</span>&nbsp;<span class="op" id="5410646">==</span>&nbsp;<span class="num" id="5410649">0</span>&nbsp;<span class="op" id="5410651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5410655">return</span>&nbsp;<span class="ident" id="5410662">nil</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5410667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5410670">return</span>&nbsp;<span class="ident" id="5410677">result</span><br>
<span class="lineno"></span><span class="op" id="5410684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5410687">//&nbsp;FindAllIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindIndex;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all</span><br>
<span class="lineno">935</span><span class="comment" id="5410764">//&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description</span><br>
<span class="lineno"></span><span class="comment" id="5410841">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5410868">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5410913">func</span>&nbsp;<span class="op" id="5410918">(</span><span class="ident" id="5410919">re</span>&nbsp;<span class="op" id="5410922">*</span><span class="ident" id="5410923">Regexp</span><span class="op" id="5410929">)</span>&nbsp;<span class="ident" id="5410931">FindAllIndex</span><span class="op" id="5410943">(</span><span class="ident" id="5410944">b</span>&nbsp;<span class="op" id="5410946">[</span><span class="op" id="5410947">]</span><span class="builtintype" id="5410948">byte</span><span class="op" id="5410952">,</span>&nbsp;<span class="ident" id="5410954">n</span>&nbsp;<span class="builtintype" id="5410956">int</span><span class="op" id="5410959">)</span>&nbsp;<span class="op" id="5410961">[</span><span class="op" id="5410962">]</span><span class="op" id="5410963">[</span><span class="op" id="5410964">]</span><span class="builtintype" id="5410965">int</span>&nbsp;<span class="op" id="5410969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5410972">if</span>&nbsp;<span class="ident" id="5410975">n</span>&nbsp;<span class="op" id="5410977">&lt;</span>&nbsp;<span class="num" id="5410979">0</span>&nbsp;<span class="op" id="5410981">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5410985">n</span>&nbsp;<span class="op" id="5410987">=</span>&nbsp;<span class="builtinfunc" id="5410989">len</span><span class="op" id="5410992">(</span><span class="ident" id="5410993">b</span><span class="op" id="5410994">)</span>&nbsp;<span class="op" id="5410996">+</span>&nbsp;<span class="num" id="5410998">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5411004">result</span>&nbsp;<span class="op" id="5411011">:=</span>&nbsp;<span class="builtinfunc" id="5411014">make</span><span class="op" id="5411018">(</span><span class="op" id="5411019">[</span><span class="op" id="5411020">]</span><span class="op" id="5411021">[</span><span class="op" id="5411022">]</span><span class="builtintype" id="5411023">int</span><span class="op" id="5411026">,</span>&nbsp;<span class="num" id="5411028">0</span><span class="op" id="5411029">,</span>&nbsp;<span class="ident" id="5411031">startSize</span><span class="op" id="5411040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5411043">re</span><span class="op" id="5411045">.</span><span class="ident" id="5411046">allMatches</span><span class="op" id="5411056">(</span><span class="string" id="5411057">&#34;&#34;</span><span class="op" id="5411059">,</span>&nbsp;<span class="ident" id="5411061">b</span><span class="op" id="5411062">,</span>&nbsp;<span class="ident" id="5411064">n</span><span class="op" id="5411065">,</span>&nbsp;<span class="keyword" id="5411067">func</span><span class="op" id="5411071">(</span><span class="ident" id="5411072">match</span>&nbsp;<span class="op" id="5411078">[</span><span class="op" id="5411079">]</span><span class="builtintype" id="5411080">int</span><span class="op" id="5411083">)</span>&nbsp;<span class="op" id="5411085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5411089">result</span>&nbsp;<span class="op" id="5411096">=</span>&nbsp;<span class="builtinfunc" id="5411098">append</span><span class="op" id="5411104">(</span><span class="ident" id="5411105">result</span><span class="op" id="5411111">,</span>&nbsp;<span class="ident" id="5411113">match</span><span class="op" id="5411118">[</span><span class="num" id="5411119">0</span><span class="op" id="5411120">:</span><span class="num" id="5411121">2</span><span class="op" id="5411122">]</span><span class="op" id="5411123">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411126">}</span><span class="op" id="5411127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411130">if</span>&nbsp;<span class="builtinfunc" id="5411133">len</span><span class="op" id="5411136">(</span><span class="ident" id="5411137">result</span><span class="op" id="5411143">)</span>&nbsp;<span class="op" id="5411145">==</span>&nbsp;<span class="num" id="5411148">0</span>&nbsp;<span class="op" id="5411150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411154">return</span>&nbsp;<span class="ident" id="5411161">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411169">return</span>&nbsp;<span class="ident" id="5411176">result</span><br>
<span class="lineno">950</span><span class="op" id="5411183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5411186">//&nbsp;FindAllString&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindString;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="5411265">//&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description</span><br>
<span class="lineno"></span><span class="comment" id="5411342">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">955</span><span class="comment" id="5411369">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5411414">func</span>&nbsp;<span class="op" id="5411419">(</span><span class="ident" id="5411420">re</span>&nbsp;<span class="op" id="5411423">*</span><span class="ident" id="5411424">Regexp</span><span class="op" id="5411430">)</span>&nbsp;<span class="ident" id="5411432">FindAllString</span><span class="op" id="5411445">(</span><span class="ident" id="5411446">s</span>&nbsp;<span class="builtintype" id="5411448">string</span><span class="op" id="5411454">,</span>&nbsp;<span class="ident" id="5411456">n</span>&nbsp;<span class="builtintype" id="5411458">int</span><span class="op" id="5411461">)</span>&nbsp;<span class="op" id="5411463">[</span><span class="op" id="5411464">]</span><span class="builtintype" id="5411465">string</span>&nbsp;<span class="op" id="5411472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411475">if</span>&nbsp;<span class="ident" id="5411478">n</span>&nbsp;<span class="op" id="5411480">&lt;</span>&nbsp;<span class="num" id="5411482">0</span>&nbsp;<span class="op" id="5411484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5411488">n</span>&nbsp;<span class="op" id="5411490">=</span>&nbsp;<span class="builtinfunc" id="5411492">len</span><span class="op" id="5411495">(</span><span class="ident" id="5411496">s</span><span class="op" id="5411497">)</span>&nbsp;<span class="op" id="5411499">+</span>&nbsp;<span class="num" id="5411501">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411504">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5411507">result</span>&nbsp;<span class="op" id="5411514">:=</span>&nbsp;<span class="builtinfunc" id="5411517">make</span><span class="op" id="5411521">(</span><span class="op" id="5411522">[</span><span class="op" id="5411523">]</span><span class="builtintype" id="5411524">string</span><span class="op" id="5411530">,</span>&nbsp;<span class="num" id="5411532">0</span><span class="op" id="5411533">,</span>&nbsp;<span class="ident" id="5411535">startSize</span><span class="op" id="5411544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5411547">re</span><span class="op" id="5411549">.</span><span class="ident" id="5411550">allMatches</span><span class="op" id="5411560">(</span><span class="ident" id="5411561">s</span><span class="op" id="5411562">,</span>&nbsp;<span class="ident" id="5411564">nil</span><span class="op" id="5411567">,</span>&nbsp;<span class="ident" id="5411569">n</span><span class="op" id="5411570">,</span>&nbsp;<span class="keyword" id="5411572">func</span><span class="op" id="5411576">(</span><span class="ident" id="5411577">match</span>&nbsp;<span class="op" id="5411583">[</span><span class="op" id="5411584">]</span><span class="builtintype" id="5411585">int</span><span class="op" id="5411588">)</span>&nbsp;<span class="op" id="5411590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5411594">result</span>&nbsp;<span class="op" id="5411601">=</span>&nbsp;<span class="builtinfunc" id="5411603">append</span><span class="op" id="5411609">(</span><span class="ident" id="5411610">result</span><span class="op" id="5411616">,</span>&nbsp;<span class="ident" id="5411618">s</span><span class="op" id="5411619">[</span><span class="ident" id="5411620">match</span><span class="op" id="5411625">[</span><span class="num" id="5411626">0</span><span class="op" id="5411627">]</span><span class="op" id="5411628">:</span><span class="ident" id="5411629">match</span><span class="op" id="5411634">[</span><span class="num" id="5411635">1</span><span class="op" id="5411636">]</span><span class="op" id="5411637">]</span><span class="op" id="5411638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411641">}</span><span class="op" id="5411642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411645">if</span>&nbsp;<span class="builtinfunc" id="5411648">len</span><span class="op" id="5411651">(</span><span class="ident" id="5411652">result</span><span class="op" id="5411658">)</span>&nbsp;<span class="op" id="5411660">==</span>&nbsp;<span class="num" id="5411663">0</span>&nbsp;<span class="op" id="5411665">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411669">return</span>&nbsp;<span class="ident" id="5411676">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411684">return</span>&nbsp;<span class="ident" id="5411691">result</span><br>
<span class="lineno"></span><span class="op" id="5411698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="comment" id="5411701">//&nbsp;FindAllStringIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindStringIndex;&nbsp;it&nbsp;returns&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5411777">//&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;</span><br>
<span class="lineno"></span><span class="comment" id="5411855">//&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5411894">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5411939">func</span>&nbsp;<span class="op" id="5411944">(</span><span class="ident" id="5411945">re</span>&nbsp;<span class="op" id="5411948">*</span><span class="ident" id="5411949">Regexp</span><span class="op" id="5411955">)</span>&nbsp;<span class="ident" id="5411957">FindAllStringIndex</span><span class="op" id="5411975">(</span><span class="ident" id="5411976">s</span>&nbsp;<span class="builtintype" id="5411978">string</span><span class="op" id="5411984">,</span>&nbsp;<span class="ident" id="5411986">n</span>&nbsp;<span class="builtintype" id="5411988">int</span><span class="op" id="5411991">)</span>&nbsp;<span class="op" id="5411993">[</span><span class="op" id="5411994">]</span><span class="op" id="5411995">[</span><span class="op" id="5411996">]</span><span class="builtintype" id="5411997">int</span>&nbsp;<span class="op" id="5412001">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412004">if</span>&nbsp;<span class="ident" id="5412007">n</span>&nbsp;<span class="op" id="5412009">&lt;</span>&nbsp;<span class="num" id="5412011">0</span>&nbsp;<span class="op" id="5412013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412017">n</span>&nbsp;<span class="op" id="5412019">=</span>&nbsp;<span class="builtinfunc" id="5412021">len</span><span class="op" id="5412024">(</span><span class="ident" id="5412025">s</span><span class="op" id="5412026">)</span>&nbsp;<span class="op" id="5412028">+</span>&nbsp;<span class="num" id="5412030">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412036">result</span>&nbsp;<span class="op" id="5412043">:=</span>&nbsp;<span class="builtinfunc" id="5412046">make</span><span class="op" id="5412050">(</span><span class="op" id="5412051">[</span><span class="op" id="5412052">]</span><span class="op" id="5412053">[</span><span class="op" id="5412054">]</span><span class="builtintype" id="5412055">int</span><span class="op" id="5412058">,</span>&nbsp;<span class="num" id="5412060">0</span><span class="op" id="5412061">,</span>&nbsp;<span class="ident" id="5412063">startSize</span><span class="op" id="5412072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412075">re</span><span class="op" id="5412077">.</span><span class="ident" id="5412078">allMatches</span><span class="op" id="5412088">(</span><span class="ident" id="5412089">s</span><span class="op" id="5412090">,</span>&nbsp;<span class="ident" id="5412092">nil</span><span class="op" id="5412095">,</span>&nbsp;<span class="ident" id="5412097">n</span><span class="op" id="5412098">,</span>&nbsp;<span class="keyword" id="5412100">func</span><span class="op" id="5412104">(</span><span class="ident" id="5412105">match</span>&nbsp;<span class="op" id="5412111">[</span><span class="op" id="5412112">]</span><span class="builtintype" id="5412113">int</span><span class="op" id="5412116">)</span>&nbsp;<span class="op" id="5412118">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412122">result</span>&nbsp;<span class="op" id="5412129">=</span>&nbsp;<span class="builtinfunc" id="5412131">append</span><span class="op" id="5412137">(</span><span class="ident" id="5412138">result</span><span class="op" id="5412144">,</span>&nbsp;<span class="ident" id="5412146">match</span><span class="op" id="5412151">[</span><span class="num" id="5412152">0</span><span class="op" id="5412153">:</span><span class="num" id="5412154">2</span><span class="op" id="5412155">]</span><span class="op" id="5412156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412159">}</span><span class="op" id="5412160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412163">if</span>&nbsp;<span class="builtinfunc" id="5412166">len</span><span class="op" id="5412169">(</span><span class="ident" id="5412170">result</span><span class="op" id="5412176">)</span>&nbsp;<span class="op" id="5412178">==</span>&nbsp;<span class="num" id="5412181">0</span>&nbsp;<span class="op" id="5412183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412187">return</span>&nbsp;<span class="ident" id="5412194">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412199">}</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412202">return</span>&nbsp;<span class="ident" id="5412209">result</span><br>
<span class="lineno"></span><span class="op" id="5412216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5412219">//&nbsp;FindAllSubmatch&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindSubmatch;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="5412295">//&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;</span><br>
<span class="lineno">990</span><span class="comment" id="5412367">//&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5412406">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5412451">func</span>&nbsp;<span class="op" id="5412456">(</span><span class="ident" id="5412457">re</span>&nbsp;<span class="op" id="5412460">*</span><span class="ident" id="5412461">Regexp</span><span class="op" id="5412467">)</span>&nbsp;<span class="ident" id="5412469">FindAllSubmatch</span><span class="op" id="5412484">(</span><span class="ident" id="5412485">b</span>&nbsp;<span class="op" id="5412487">[</span><span class="op" id="5412488">]</span><span class="builtintype" id="5412489">byte</span><span class="op" id="5412493">,</span>&nbsp;<span class="ident" id="5412495">n</span>&nbsp;<span class="builtintype" id="5412497">int</span><span class="op" id="5412500">)</span>&nbsp;<span class="op" id="5412502">[</span><span class="op" id="5412503">]</span><span class="op" id="5412504">[</span><span class="op" id="5412505">]</span><span class="op" id="5412506">[</span><span class="op" id="5412507">]</span><span class="builtintype" id="5412508">byte</span>&nbsp;<span class="op" id="5412513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412516">if</span>&nbsp;<span class="ident" id="5412519">n</span>&nbsp;<span class="op" id="5412521">&lt;</span>&nbsp;<span class="num" id="5412523">0</span>&nbsp;<span class="op" id="5412525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412529">n</span>&nbsp;<span class="op" id="5412531">=</span>&nbsp;<span class="builtinfunc" id="5412533">len</span><span class="op" id="5412536">(</span><span class="ident" id="5412537">b</span><span class="op" id="5412538">)</span>&nbsp;<span class="op" id="5412540">+</span>&nbsp;<span class="num" id="5412542">1</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412548">result</span>&nbsp;<span class="op" id="5412555">:=</span>&nbsp;<span class="builtinfunc" id="5412558">make</span><span class="op" id="5412562">(</span><span class="op" id="5412563">[</span><span class="op" id="5412564">]</span><span class="op" id="5412565">[</span><span class="op" id="5412566">]</span><span class="op" id="5412567">[</span><span class="op" id="5412568">]</span><span class="builtintype" id="5412569">byte</span><span class="op" id="5412573">,</span>&nbsp;<span class="num" id="5412575">0</span><span class="op" id="5412576">,</span>&nbsp;<span class="ident" id="5412578">startSize</span><span class="op" id="5412587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412590">re</span><span class="op" id="5412592">.</span><span class="ident" id="5412593">allMatches</span><span class="op" id="5412603">(</span><span class="string" id="5412604">&#34;&#34;</span><span class="op" id="5412606">,</span>&nbsp;<span class="ident" id="5412608">b</span><span class="op" id="5412609">,</span>&nbsp;<span class="ident" id="5412611">n</span><span class="op" id="5412612">,</span>&nbsp;<span class="keyword" id="5412614">func</span><span class="op" id="5412618">(</span><span class="ident" id="5412619">match</span>&nbsp;<span class="op" id="5412625">[</span><span class="op" id="5412626">]</span><span class="builtintype" id="5412627">int</span><span class="op" id="5412630">)</span>&nbsp;<span class="op" id="5412632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412636">slice</span>&nbsp;<span class="op" id="5412642">:=</span>&nbsp;<span class="builtinfunc" id="5412645">make</span><span class="op" id="5412649">(</span><span class="op" id="5412650">[</span><span class="op" id="5412651">]</span><span class="op" id="5412652">[</span><span class="op" id="5412653">]</span><span class="builtintype" id="5412654">byte</span><span class="op" id="5412658">,</span>&nbsp;<span class="builtinfunc" id="5412660">len</span><span class="op" id="5412663">(</span><span class="ident" id="5412664">match</span><span class="op" id="5412669">)</span><span class="op" id="5412670">/</span><span class="num" id="5412671">2</span><span class="op" id="5412672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412676">for</span>&nbsp;<span class="ident" id="5412680">j</span>&nbsp;<span class="op" id="5412682">:=</span>&nbsp;<span class="keyword" id="5412685">range</span>&nbsp;<span class="ident" id="5412691">slice</span>&nbsp;<span class="op" id="5412697">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412702">if</span>&nbsp;<span class="ident" id="5412705">match</span><span class="op" id="5412710">[</span><span class="num" id="5412711">2</span><span class="op" id="5412712">*</span><span class="ident" id="5412713">j</span><span class="op" id="5412714">]</span>&nbsp;<span class="op" id="5412716">&gt;=</span>&nbsp;<span class="num" id="5412719">0</span>&nbsp;<span class="op" id="5412721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412727">slice</span><span class="op" id="5412732">[</span><span class="ident" id="5412733">j</span><span class="op" id="5412734">]</span>&nbsp;<span class="op" id="5412736">=</span>&nbsp;<span class="ident" id="5412738">b</span><span class="op" id="5412739">[</span><span class="ident" id="5412740">match</span><span class="op" id="5412745">[</span><span class="num" id="5412746">2</span><span class="op" id="5412747">*</span><span class="ident" id="5412748">j</span><span class="op" id="5412749">]</span><span class="op" id="5412750">:</span><span class="ident" id="5412751">match</span><span class="op" id="5412756">[</span><span class="num" id="5412757">2</span><span class="op" id="5412758">*</span><span class="ident" id="5412759">j</span><span class="op" id="5412760">+</span><span class="num" id="5412761">1</span><span class="op" id="5412762">]</span><span class="op" id="5412763">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412776">result</span>&nbsp;<span class="op" id="5412783">=</span>&nbsp;<span class="builtinfunc" id="5412785">append</span><span class="op" id="5412791">(</span><span class="ident" id="5412792">result</span><span class="op" id="5412798">,</span>&nbsp;<span class="ident" id="5412800">slice</span><span class="op" id="5412805">)</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412808">}</span><span class="op" id="5412809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412812">if</span>&nbsp;<span class="builtinfunc" id="5412815">len</span><span class="op" id="5412818">(</span><span class="ident" id="5412819">result</span><span class="op" id="5412825">)</span>&nbsp;<span class="op" id="5412827">==</span>&nbsp;<span class="num" id="5412830">0</span>&nbsp;<span class="op" id="5412832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412836">return</span>&nbsp;<span class="ident" id="5412843">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412851">return</span>&nbsp;<span class="ident" id="5412858">result</span><br>
<span class="lineno">1010</span><span class="op" id="5412865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5412868">//&nbsp;FindAllSubmatchIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindSubmatchIndex;&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="5412946">//&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5413020">//&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">1015</span><span class="comment" id="5413065">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5413110">func</span>&nbsp;<span class="op" id="5413115">(</span><span class="ident" id="5413116">re</span>&nbsp;<span class="op" id="5413119">*</span><span class="ident" id="5413120">Regexp</span><span class="op" id="5413126">)</span>&nbsp;<span class="ident" id="5413128">FindAllSubmatchIndex</span><span class="op" id="5413148">(</span><span class="ident" id="5413149">b</span>&nbsp;<span class="op" id="5413151">[</span><span class="op" id="5413152">]</span><span class="builtintype" id="5413153">byte</span><span class="op" id="5413157">,</span>&nbsp;<span class="ident" id="5413159">n</span>&nbsp;<span class="builtintype" id="5413161">int</span><span class="op" id="5413164">)</span>&nbsp;<span class="op" id="5413166">[</span><span class="op" id="5413167">]</span><span class="op" id="5413168">[</span><span class="op" id="5413169">]</span><span class="builtintype" id="5413170">int</span>&nbsp;<span class="op" id="5413174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5413177">if</span>&nbsp;<span class="ident" id="5413180">n</span>&nbsp;<span class="op" id="5413182">&lt;</span>&nbsp;<span class="num" id="5413184">0</span>&nbsp;<span class="op" id="5413186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413190">n</span>&nbsp;<span class="op" id="5413192">=</span>&nbsp;<span class="builtinfunc" id="5413194">len</span><span class="op" id="5413197">(</span><span class="ident" id="5413198">b</span><span class="op" id="5413199">)</span>&nbsp;<span class="op" id="5413201">+</span>&nbsp;<span class="num" id="5413203">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413206">}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413209">result</span>&nbsp;<span class="op" id="5413216">:=</span>&nbsp;<span class="builtinfunc" id="5413219">make</span><span class="op" id="5413223">(</span><span class="op" id="5413224">[</span><span class="op" id="5413225">]</span><span class="op" id="5413226">[</span><span class="op" id="5413227">]</span><span class="builtintype" id="5413228">int</span><span class="op" id="5413231">,</span>&nbsp;<span class="num" id="5413233">0</span><span class="op" id="5413234">,</span>&nbsp;<span class="ident" id="5413236">startSize</span><span class="op" id="5413245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413248">re</span><span class="op" id="5413250">.</span><span class="ident" id="5413251">allMatches</span><span class="op" id="5413261">(</span><span class="string" id="5413262">&#34;&#34;</span><span class="op" id="5413264">,</span>&nbsp;<span class="ident" id="5413266">b</span><span class="op" id="5413267">,</span>&nbsp;<span class="ident" id="5413269">n</span><span class="op" id="5413270">,</span>&nbsp;<span class="keyword" id="5413272">func</span><span class="op" id="5413276">(</span><span class="ident" id="5413277">match</span>&nbsp;<span class="op" id="5413283">[</span><span class="op" id="5413284">]</span><span class="builtintype" id="5413285">int</span><span class="op" id="5413288">)</span>&nbsp;<span class="op" id="5413290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413294">result</span>&nbsp;<span class="op" id="5413301">=</span>&nbsp;<span class="builtinfunc" id="5413303">append</span><span class="op" id="5413309">(</span><span class="ident" id="5413310">result</span><span class="op" id="5413316">,</span>&nbsp;<span class="ident" id="5413318">match</span><span class="op" id="5413323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413326">}</span><span class="op" id="5413327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5413330">if</span>&nbsp;<span class="builtinfunc" id="5413333">len</span><span class="op" id="5413336">(</span><span class="ident" id="5413337">result</span><span class="op" id="5413343">)</span>&nbsp;<span class="op" id="5413345">==</span>&nbsp;<span class="num" id="5413348">0</span>&nbsp;<span class="op" id="5413350">{</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5413354">return</span>&nbsp;<span class="ident" id="5413361">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5413369">return</span>&nbsp;<span class="ident" id="5413376">result</span><br>
<span class="lineno"></span><span class="op" id="5413383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1030</span><span class="comment" id="5413386">//&nbsp;FindAllStringSubmatch&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindStringSubmatch;&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5413458">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5413536">//&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5413585">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5413630">func</span>&nbsp;<span class="op" id="5413635">(</span><span class="ident" id="5413636">re</span>&nbsp;<span class="op" id="5413639">*</span><span class="ident" id="5413640">Regexp</span><span class="op" id="5413646">)</span>&nbsp;<span class="ident" id="5413648">FindAllStringSubmatch</span><span class="op" id="5413669">(</span><span class="ident" id="5413670">s</span>&nbsp;<span class="builtintype" id="5413672">string</span><span class="op" id="5413678">,</span>&nbsp;<span class="ident" id="5413680">n</span>&nbsp;<span class="builtintype" id="5413682">int</span><span class="op" id="5413685">)</span>&nbsp;<span class="op" id="5413687">[</span><span class="op" id="5413688">]</span><span class="op" id="5413689">[</span><span class="op" id="5413690">]</span><span class="builtintype" id="5413691">string</span>&nbsp;<span class="op" id="5413698">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5413701">if</span>&nbsp;<span class="ident" id="5413704">n</span>&nbsp;<span class="op" id="5413706">&lt;</span>&nbsp;<span class="num" id="5413708">0</span>&nbsp;<span class="op" id="5413710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413714">n</span>&nbsp;<span class="op" id="5413716">=</span>&nbsp;<span class="builtinfunc" id="5413718">len</span><span class="op" id="5413721">(</span><span class="ident" id="5413722">s</span><span class="op" id="5413723">)</span>&nbsp;<span class="op" id="5413725">+</span>&nbsp;<span class="num" id="5413727">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413733">result</span>&nbsp;<span class="op" id="5413740">:=</span>&nbsp;<span class="builtinfunc" id="5413743">make</span><span class="op" id="5413747">(</span><span class="op" id="5413748">[</span><span class="op" id="5413749">]</span><span class="op" id="5413750">[</span><span class="op" id="5413751">]</span><span class="builtintype" id="5413752">string</span><span class="op" id="5413758">,</span>&nbsp;<span class="num" id="5413760">0</span><span class="op" id="5413761">,</span>&nbsp;<span class="ident" id="5413763">startSize</span><span class="op" id="5413772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413775">re</span><span class="op" id="5413777">.</span><span class="ident" id="5413778">allMatches</span><span class="op" id="5413788">(</span><span class="ident" id="5413789">s</span><span class="op" id="5413790">,</span>&nbsp;<span class="ident" id="5413792">nil</span><span class="op" id="5413795">,</span>&nbsp;<span class="ident" id="5413797">n</span><span class="op" id="5413798">,</span>&nbsp;<span class="keyword" id="5413800">func</span><span class="op" id="5413804">(</span><span class="ident" id="5413805">match</span>&nbsp;<span class="op" id="5413811">[</span><span class="op" id="5413812">]</span><span class="builtintype" id="5413813">int</span><span class="op" id="5413816">)</span>&nbsp;<span class="op" id="5413818">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413822">slice</span>&nbsp;<span class="op" id="5413828">:=</span>&nbsp;<span class="builtinfunc" id="5413831">make</span><span class="op" id="5413835">(</span><span class="op" id="5413836">[</span><span class="op" id="5413837">]</span><span class="builtintype" id="5413838">string</span><span class="op" id="5413844">,</span>&nbsp;<span class="builtinfunc" id="5413846">len</span><span class="op" id="5413849">(</span><span class="ident" id="5413850">match</span><span class="op" id="5413855">)</span><span class="op" id="5413856">/</span><span class="num" id="5413857">2</span><span class="op" id="5413858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5413862">for</span>&nbsp;<span class="ident" id="5413866">j</span>&nbsp;<span class="op" id="5413868">:=</span>&nbsp;<span class="keyword" id="5413871">range</span>&nbsp;<span class="ident" id="5413877">slice</span>&nbsp;<span class="op" id="5413883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5413888">if</span>&nbsp;<span class="ident" id="5413891">match</span><span class="op" id="5413896">[</span><span class="num" id="5413897">2</span><span class="op" id="5413898">*</span><span class="ident" id="5413899">j</span><span class="op" id="5413900">]</span>&nbsp;<span class="op" id="5413902">&gt;=</span>&nbsp;<span class="num" id="5413905">0</span>&nbsp;<span class="op" id="5413907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413913">slice</span><span class="op" id="5413918">[</span><span class="ident" id="5413919">j</span><span class="op" id="5413920">]</span>&nbsp;<span class="op" id="5413922">=</span>&nbsp;<span class="ident" id="5413924">s</span><span class="op" id="5413925">[</span><span class="ident" id="5413926">match</span><span class="op" id="5413931">[</span><span class="num" id="5413932">2</span><span class="op" id="5413933">*</span><span class="ident" id="5413934">j</span><span class="op" id="5413935">]</span><span class="op" id="5413936">:</span><span class="ident" id="5413937">match</span><span class="op" id="5413942">[</span><span class="num" id="5413943">2</span><span class="op" id="5413944">*</span><span class="ident" id="5413945">j</span><span class="op" id="5413946">+</span><span class="num" id="5413947">1</span><span class="op" id="5413948">]</span><span class="op" id="5413949">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413954">}</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5413962">result</span>&nbsp;<span class="op" id="5413969">=</span>&nbsp;<span class="builtinfunc" id="5413971">append</span><span class="op" id="5413977">(</span><span class="ident" id="5413978">result</span><span class="op" id="5413984">,</span>&nbsp;<span class="ident" id="5413986">slice</span><span class="op" id="5413991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5413994">}</span><span class="op" id="5413995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5413998">if</span>&nbsp;<span class="builtinfunc" id="5414001">len</span><span class="op" id="5414004">(</span><span class="ident" id="5414005">result</span><span class="op" id="5414011">)</span>&nbsp;<span class="op" id="5414013">==</span>&nbsp;<span class="num" id="5414016">0</span>&nbsp;<span class="op" id="5414018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414022">return</span>&nbsp;<span class="ident" id="5414029">nil</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5414034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414037">return</span>&nbsp;<span class="ident" id="5414044">result</span><br>
<span class="lineno"></span><span class="op" id="5414051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5414054">//&nbsp;FindAllStringSubmatchIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of</span><br>
<span class="lineno">1055</span><span class="comment" id="5414108">//&nbsp;FindStringSubmatchIndex;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5414184">//&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5414254">//&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5414266">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5414311">func</span>&nbsp;<span class="op" id="5414316">(</span><span class="ident" id="5414317">re</span>&nbsp;<span class="op" id="5414320">*</span><span class="ident" id="5414321">Regexp</span><span class="op" id="5414327">)</span>&nbsp;<span class="ident" id="5414329">FindAllStringSubmatchIndex</span><span class="op" id="5414355">(</span><span class="ident" id="5414356">s</span>&nbsp;<span class="builtintype" id="5414358">string</span><span class="op" id="5414364">,</span>&nbsp;<span class="ident" id="5414366">n</span>&nbsp;<span class="builtintype" id="5414368">int</span><span class="op" id="5414371">)</span>&nbsp;<span class="op" id="5414373">[</span><span class="op" id="5414374">]</span><span class="op" id="5414375">[</span><span class="op" id="5414376">]</span><span class="builtintype" id="5414377">int</span>&nbsp;<span class="op" id="5414381">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414384">if</span>&nbsp;<span class="ident" id="5414387">n</span>&nbsp;<span class="op" id="5414389">&lt;</span>&nbsp;<span class="num" id="5414391">0</span>&nbsp;<span class="op" id="5414393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414397">n</span>&nbsp;<span class="op" id="5414399">=</span>&nbsp;<span class="builtinfunc" id="5414401">len</span><span class="op" id="5414404">(</span><span class="ident" id="5414405">s</span><span class="op" id="5414406">)</span>&nbsp;<span class="op" id="5414408">+</span>&nbsp;<span class="num" id="5414410">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5414413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414416">result</span>&nbsp;<span class="op" id="5414423">:=</span>&nbsp;<span class="builtinfunc" id="5414426">make</span><span class="op" id="5414430">(</span><span class="op" id="5414431">[</span><span class="op" id="5414432">]</span><span class="op" id="5414433">[</span><span class="op" id="5414434">]</span><span class="builtintype" id="5414435">int</span><span class="op" id="5414438">,</span>&nbsp;<span class="num" id="5414440">0</span><span class="op" id="5414441">,</span>&nbsp;<span class="ident" id="5414443">startSize</span><span class="op" id="5414452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414455">re</span><span class="op" id="5414457">.</span><span class="ident" id="5414458">allMatches</span><span class="op" id="5414468">(</span><span class="ident" id="5414469">s</span><span class="op" id="5414470">,</span>&nbsp;<span class="ident" id="5414472">nil</span><span class="op" id="5414475">,</span>&nbsp;<span class="ident" id="5414477">n</span><span class="op" id="5414478">,</span>&nbsp;<span class="keyword" id="5414480">func</span><span class="op" id="5414484">(</span><span class="ident" id="5414485">match</span>&nbsp;<span class="op" id="5414491">[</span><span class="op" id="5414492">]</span><span class="builtintype" id="5414493">int</span><span class="op" id="5414496">)</span>&nbsp;<span class="op" id="5414498">{</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414502">result</span>&nbsp;<span class="op" id="5414509">=</span>&nbsp;<span class="builtinfunc" id="5414511">append</span><span class="op" id="5414517">(</span><span class="ident" id="5414518">result</span><span class="op" id="5414524">,</span>&nbsp;<span class="ident" id="5414526">match</span><span class="op" id="5414531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5414534">}</span><span class="op" id="5414535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414538">if</span>&nbsp;<span class="builtinfunc" id="5414541">len</span><span class="op" id="5414544">(</span><span class="ident" id="5414545">result</span><span class="op" id="5414551">)</span>&nbsp;<span class="op" id="5414553">==</span>&nbsp;<span class="num" id="5414556">0</span>&nbsp;<span class="op" id="5414558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414562">return</span>&nbsp;<span class="ident" id="5414569">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5414574">}</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5414577">return</span>&nbsp;<span class="ident" id="5414584">result</span><br>
<span class="lineno"></span><span class="op" id="5414591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5414594">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;substrings&nbsp;separated&nbsp;by&nbsp;the&nbsp;expression&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5414679">//&nbsp;the&nbsp;substrings&nbsp;between&nbsp;those&nbsp;expression&nbsp;matches.</span><br>
<span class="lineno">1075</span><span class="comment" id="5414731">//</span><br>
<span class="lineno"></span><span class="comment" id="5414734">//&nbsp;The&nbsp;slice&nbsp;returned&nbsp;by&nbsp;this&nbsp;method&nbsp;consists&nbsp;of&nbsp;all&nbsp;the&nbsp;substrings&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="5414807">//&nbsp;not&nbsp;contained&nbsp;in&nbsp;the&nbsp;slice&nbsp;returned&nbsp;by&nbsp;FindAllString.&nbsp;When&nbsp;called&nbsp;on&nbsp;an&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5414893">//&nbsp;that&nbsp;contains&nbsp;no&nbsp;metacharacters,&nbsp;it&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;strings.SplitN.</span><br>
<span class="lineno"></span><span class="comment" id="5414965">//</span><br>
<span class="lineno">1080</span><span class="comment" id="5414968">//&nbsp;Example:</span><br>
<span class="lineno"></span><span class="comment" id="5414980">//&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;regexp.MustCompile(&#34;a*&#34;).Split(&#34;abaabaccadaaae&#34;,&nbsp;5)</span><br>
<span class="lineno"></span><span class="comment" id="5415042">//&nbsp;&nbsp;&nbsp;//&nbsp;s:&nbsp;[&#34;&#34;,&nbsp;&#34;b&#34;,&nbsp;&#34;b&#34;,&nbsp;&#34;c&#34;,&nbsp;&#34;cadaaae&#34;]</span><br>
<span class="lineno"></span><span class="comment" id="5415084">//</span><br>
<span class="lineno"></span><span class="comment" id="5415087">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;substrings&nbsp;to&nbsp;return:</span><br>
<span class="lineno">1085</span><span class="comment" id="5415147">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;substrings;&nbsp;the&nbsp;last&nbsp;substring&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="5415231">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;substrings)</span><br>
<span class="lineno"></span><span class="comment" id="5415280">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;substrings</span><br>
<span class="lineno"></span><span class="keyword" id="5415307">func</span>&nbsp;<span class="op" id="5415312">(</span><span class="ident" id="5415313">re</span>&nbsp;<span class="op" id="5415316">*</span><span class="ident" id="5415317">Regexp</span><span class="op" id="5415323">)</span>&nbsp;<span class="ident" id="5415325">Split</span><span class="op" id="5415330">(</span><span class="ident" id="5415331">s</span>&nbsp;<span class="builtintype" id="5415333">string</span><span class="op" id="5415339">,</span>&nbsp;<span class="ident" id="5415341">n</span>&nbsp;<span class="builtintype" id="5415343">int</span><span class="op" id="5415346">)</span>&nbsp;<span class="op" id="5415348">[</span><span class="op" id="5415349">]</span><span class="builtintype" id="5415350">string</span>&nbsp;<span class="op" id="5415357">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415361">if</span>&nbsp;<span class="ident" id="5415364">n</span>&nbsp;<span class="op" id="5415366">==</span>&nbsp;<span class="num" id="5415369">0</span>&nbsp;<span class="op" id="5415371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415375">return</span>&nbsp;<span class="ident" id="5415382">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415391">if</span>&nbsp;<span class="builtinfunc" id="5415394">len</span><span class="op" id="5415397">(</span><span class="ident" id="5415398">re</span><span class="op" id="5415400">.</span><span class="ident" id="5415401">expr</span><span class="op" id="5415405">)</span>&nbsp;<span class="op" id="5415407">&gt;</span>&nbsp;<span class="num" id="5415409">0</span>&nbsp;<span class="op" id="5415411">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5415414">len</span><span class="op" id="5415417">(</span><span class="ident" id="5415418">s</span><span class="op" id="5415419">)</span>&nbsp;<span class="op" id="5415421">==</span>&nbsp;<span class="num" id="5415424">0</span>&nbsp;<span class="op" id="5415426">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415430">return</span>&nbsp;<span class="op" id="5415437">[</span><span class="op" id="5415438">]</span><span class="builtintype" id="5415439">string</span><span class="op" id="5415445">{</span><span class="string" id="5415446">&#34;&#34;</span><span class="op" id="5415448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415455">matches</span>&nbsp;<span class="op" id="5415463">:=</span>&nbsp;<span class="ident" id="5415466">re</span><span class="op" id="5415468">.</span><span class="ident" id="5415469">FindAllStringIndex</span><span class="op" id="5415487">(</span><span class="ident" id="5415488">s</span><span class="op" id="5415489">,</span>&nbsp;<span class="ident" id="5415491">n</span><span class="op" id="5415492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415495">strings</span>&nbsp;<span class="op" id="5415503">:=</span>&nbsp;<span class="builtinfunc" id="5415506">make</span><span class="op" id="5415510">(</span><span class="op" id="5415511">[</span><span class="op" id="5415512">]</span><span class="builtintype" id="5415513">string</span><span class="op" id="5415519">,</span>&nbsp;<span class="num" id="5415521">0</span><span class="op" id="5415522">,</span>&nbsp;<span class="builtinfunc" id="5415524">len</span><span class="op" id="5415527">(</span><span class="ident" id="5415528">matches</span><span class="op" id="5415535">)</span><span class="op" id="5415536">)</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415540">beg</span>&nbsp;<span class="op" id="5415544">:=</span>&nbsp;<span class="num" id="5415547">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415550">end</span>&nbsp;<span class="op" id="5415554">:=</span>&nbsp;<span class="num" id="5415557">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415560">for</span>&nbsp;<span class="ident" id="5415564">_</span><span class="op" id="5415565">,</span>&nbsp;<span class="ident" id="5415567">match</span>&nbsp;<span class="op" id="5415573">:=</span>&nbsp;<span class="keyword" id="5415576">range</span>&nbsp;<span class="ident" id="5415582">matches</span>&nbsp;<span class="op" id="5415590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415594">if</span>&nbsp;<span class="ident" id="5415597">n</span>&nbsp;<span class="op" id="5415599">&gt;</span>&nbsp;<span class="num" id="5415601">0</span>&nbsp;<span class="op" id="5415603">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5415606">len</span><span class="op" id="5415609">(</span><span class="ident" id="5415610">strings</span><span class="op" id="5415617">)</span>&nbsp;<span class="op" id="5415619">&gt;=</span>&nbsp;<span class="ident" id="5415622">n</span><span class="op" id="5415623">-</span><span class="num" id="5415624">1</span>&nbsp;<span class="op" id="5415626">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415631">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415644">end</span>&nbsp;<span class="op" id="5415648">=</span>&nbsp;<span class="ident" id="5415650">match</span><span class="op" id="5415655">[</span><span class="num" id="5415656">0</span><span class="op" id="5415657">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415661">if</span>&nbsp;<span class="ident" id="5415664">match</span><span class="op" id="5415669">[</span><span class="num" id="5415670">1</span><span class="op" id="5415671">]</span>&nbsp;<span class="op" id="5415673">!=</span>&nbsp;<span class="num" id="5415676">0</span>&nbsp;<span class="op" id="5415678">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415683">strings</span>&nbsp;<span class="op" id="5415691">=</span>&nbsp;<span class="builtinfunc" id="5415693">append</span><span class="op" id="5415699">(</span><span class="ident" id="5415700">strings</span><span class="op" id="5415707">,</span>&nbsp;<span class="ident" id="5415709">s</span><span class="op" id="5415710">[</span><span class="ident" id="5415711">beg</span><span class="op" id="5415714">:</span><span class="ident" id="5415715">end</span><span class="op" id="5415718">]</span><span class="op" id="5415719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415727">beg</span>&nbsp;<span class="op" id="5415731">=</span>&nbsp;<span class="ident" id="5415733">match</span><span class="op" id="5415738">[</span><span class="num" id="5415739">1</span><span class="op" id="5415740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415747">if</span>&nbsp;<span class="ident" id="5415750">end</span>&nbsp;<span class="op" id="5415754">!=</span>&nbsp;<span class="builtinfunc" id="5415757">len</span><span class="op" id="5415760">(</span><span class="ident" id="5415761">s</span><span class="op" id="5415762">)</span>&nbsp;<span class="op" id="5415764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415768">strings</span>&nbsp;<span class="op" id="5415776">=</span>&nbsp;<span class="builtinfunc" id="5415778">append</span><span class="op" id="5415784">(</span><span class="ident" id="5415785">strings</span><span class="op" id="5415792">,</span>&nbsp;<span class="ident" id="5415794">s</span><span class="op" id="5415795">[</span><span class="ident" id="5415796">beg</span><span class="op" id="5415799">:</span><span class="op" id="5415800">]</span><span class="op" id="5415801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415808">return</span>&nbsp;<span class="ident" id="5415815">strings</span><br>
<span class="lineno">1120</span><span class="op" id="5415823">}</span>
</div>
</body>
</html>
