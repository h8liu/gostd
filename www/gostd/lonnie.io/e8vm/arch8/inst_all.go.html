<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/arch8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/arch8/console.go.html">console.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu.go.html">cpu.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu_test.go.html">cpu_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/device.go.html">device.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/exception.go.html">exception.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br_test.go.html">inst_br_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm_test.go.html">inst_imm_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg_test.go.html">inst_reg_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/int_bus.go.html">int_bus.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt.go.html">interrupt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt_test.go.html">interrupt_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/machine.go.html">machine.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/multi_core.go.html">multi_core.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page.go.html">page.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table.go.html">page_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table_test.go.html">page_table_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_test.go.html">page_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory.go.html">phy_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory_test.go.html">phy_memory_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs.go.html">regs.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs_test.go.html">regs_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/run_image.go.html">run_image.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/serial.go.html">serial.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/ticker.go.html">ticker.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory.go.html">virt_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory_test.go.html">virt_memory_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3568578">package</span>&nbsp;<span class="ident" id="3568586">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3568593">//&nbsp;InstArch8&nbsp;dispatches&nbsp;and&nbsp;executes&nbsp;an&nbsp;arch8&nbsp;instruction.</span><br>
<span class="lineno"></span><span class="keyword" id="3568652">type</span>&nbsp;<span class="ident" id="3568657">instArch8</span>&nbsp;<span class="keyword" id="3568667">struct</span>&nbsp;<span class="op" id="3568674">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3568677">reg</span>&nbsp;<span class="ident" id="3568681">instReg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3568690">imm</span>&nbsp;<span class="ident" id="3568694">instImm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3568703">br</span>&nbsp;&nbsp;<span class="ident" id="3568707">instBr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3568715">sys</span>&nbsp;<span class="ident" id="3568719">instSys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3568728">jmp</span>&nbsp;<span class="ident" id="3568732">instJmp</span><br>
<span class="lineno">10</span><span class="op" id="3568740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3568743">//&nbsp;I&nbsp;executes&nbsp;an&nbsp;arch8&nbsp;instructino</span><br>
<span class="lineno"></span><span class="keyword" id="3568778">func</span>&nbsp;<span class="op" id="3568783">(</span><span class="ident" id="3568784">i</span>&nbsp;<span class="op" id="3568786">*</span><span class="ident" id="3568787">instArch8</span><span class="op" id="3568796">)</span>&nbsp;<span class="ident" id="3568798">I</span><span class="op" id="3568799">(</span><span class="ident" id="3568800">cpu</span>&nbsp;<span class="op" id="3568804">*</span><span class="ident" id="3568805">cpu</span><span class="op" id="3568808">,</span>&nbsp;<span class="ident" id="3568810">in</span>&nbsp;<span class="builtintype" id="3568813">uint32</span><span class="op" id="3568819">)</span>&nbsp;<span class="op" id="3568821">*</span><span class="ident" id="3568822">Excep</span>&nbsp;<span class="op" id="3568828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3568831">if</span>&nbsp;<span class="op" id="3568834">(</span><span class="ident" id="3568835">in</span>&nbsp;<span class="op" id="3568838">&gt;&gt;</span>&nbsp;<span class="num" id="3568841">31</span><span class="op" id="3568843">)</span>&nbsp;<span class="op" id="3568845">==</span>&nbsp;<span class="num" id="3568848">0</span>&nbsp;<span class="op" id="3568850">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3568854">op</span>&nbsp;<span class="op" id="3568857">:=</span>&nbsp;<span class="op" id="3568860">(</span><span class="ident" id="3568861">in</span>&nbsp;<span class="op" id="3568864">&gt;&gt;</span>&nbsp;<span class="num" id="3568867">24</span><span class="op" id="3568869">)</span>&nbsp;<span class="op" id="3568871">&amp;</span>&nbsp;<span class="num" id="3568873">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3568880">switch</span>&nbsp;<span class="op" id="3568887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3568891">case</span>&nbsp;<span class="ident" id="3568896">op</span>&nbsp;<span class="op" id="3568899">==</span>&nbsp;<span class="num" id="3568902">0</span><span class="op" id="3568903">:</span>&nbsp;<span class="comment" id="3568905">//&nbsp;op&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3568919">return</span>&nbsp;<span class="ident" id="3568926">i</span><span class="op" id="3568927">.</span><span class="ident" id="3568928">reg</span><span class="op" id="3568931">.</span><span class="ident" id="3568932">I</span><span class="op" id="3568933">(</span><span class="ident" id="3568934">cpu</span><span class="op" id="3568937">,</span>&nbsp;<span class="ident" id="3568939">in</span><span class="op" id="3568941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3568945">case</span>&nbsp;<span class="ident" id="3568950">op</span>&nbsp;<span class="op" id="3568953">&lt;</span>&nbsp;<span class="num" id="3568955">32</span><span class="op" id="3568957">:</span>&nbsp;<span class="comment" id="3568959">//&nbsp;op&nbsp;in&nbsp;(0,&nbsp;32)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3568979">return</span>&nbsp;<span class="ident" id="3568986">i</span><span class="op" id="3568987">.</span><span class="ident" id="3568988">imm</span><span class="op" id="3568991">.</span><span class="ident" id="3568992">I</span><span class="op" id="3568993">(</span><span class="ident" id="3568994">cpu</span><span class="op" id="3568997">,</span>&nbsp;<span class="ident" id="3568999">in</span><span class="op" id="3569001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569005">case</span>&nbsp;<span class="ident" id="3569010">op</span>&nbsp;<span class="op" id="3569013">&lt;</span>&nbsp;<span class="num" id="3569015">64</span><span class="op" id="3569017">:</span>&nbsp;<span class="comment" id="3569019">//&nbsp;op&nbsp;in&nbsp;[32,&nbsp;64)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569040">return</span>&nbsp;<span class="ident" id="3569047">i</span><span class="op" id="3569048">.</span><span class="ident" id="3569049">br</span><span class="op" id="3569051">.</span><span class="ident" id="3569052">I</span><span class="op" id="3569053">(</span><span class="ident" id="3569054">cpu</span><span class="op" id="3569057">,</span>&nbsp;<span class="ident" id="3569059">in</span><span class="op" id="3569061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569065">case</span>&nbsp;<span class="ident" id="3569070">op</span>&nbsp;<span class="op" id="3569073">&lt;</span>&nbsp;<span class="num" id="3569075">128</span><span class="op" id="3569078">:</span>&nbsp;<span class="comment" id="3569080">//&nbsp;op&nbsp;in&nbsp;[64,&nbsp;128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569102">return</span>&nbsp;<span class="ident" id="3569109">i</span><span class="op" id="3569110">.</span><span class="ident" id="3569111">sys</span><span class="op" id="3569114">.</span><span class="ident" id="3569115">I</span><span class="op" id="3569116">(</span><span class="ident" id="3569117">cpu</span><span class="op" id="3569120">,</span>&nbsp;<span class="ident" id="3569122">in</span><span class="op" id="3569124">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569128">default</span><span class="op" id="3569135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3569140">panic</span><span class="op" id="3569145">(</span><span class="string" id="3569146">&#34;bug&#34;</span><span class="op" id="3569151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3569155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3569158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569162">return</span>&nbsp;<span class="ident" id="3569169">i</span><span class="op" id="3569170">.</span><span class="ident" id="3569171">jmp</span><span class="op" id="3569174">.</span><span class="ident" id="3569175">I</span><span class="op" id="3569176">(</span><span class="ident" id="3569177">cpu</span><span class="op" id="3569180">,</span>&nbsp;<span class="ident" id="3569182">in</span><span class="op" id="3569184">)</span><br>
<span class="lineno"></span><span class="op" id="3569186">}</span>
</div>
</body>
</html>
