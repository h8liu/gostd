<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html" class="current">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7010639">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7010694">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7010748">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7010799">package</span>&nbsp;<span class="ident" id="7010807">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7010812">import</span>&nbsp;<span class="op" id="7010819">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7010822">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7010831">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7010838">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7010848">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7010851">type</span>&nbsp;<span class="ident" id="7010856">rc4Test</span>&nbsp;<span class="keyword" id="7010864">struct</span>&nbsp;<span class="op" id="7010871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7010874">key</span><span class="op" id="7010877">,</span>&nbsp;<span class="ident" id="7010879">keystream</span>&nbsp;<span class="op" id="7010889">[</span><span class="op" id="7010890">]</span><span class="builtintype" id="7010891">byte</span><br>
<span class="lineno">15</span><span class="op" id="7010896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7010899">var</span>&nbsp;<span class="ident" id="7010903">golden</span>&nbsp;<span class="op" id="7010910">=</span>&nbsp;<span class="op" id="7010912">[</span><span class="op" id="7010913">]</span><span class="ident" id="7010914">rc4Test</span><span class="op" id="7010921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7010924">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7010987">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011065">[</span><span class="op" id="7011066">]</span><span class="builtintype" id="7011067">byte</span><span class="op" id="7011071">{</span><span class="num" id="7011072">0x01</span><span class="op" id="7011076">,</span>&nbsp;<span class="num" id="7011078">0x23</span><span class="op" id="7011082">,</span>&nbsp;<span class="num" id="7011084">0x45</span><span class="op" id="7011088">,</span>&nbsp;<span class="num" id="7011090">0x67</span><span class="op" id="7011094">,</span>&nbsp;<span class="num" id="7011096">0x89</span><span class="op" id="7011100">,</span>&nbsp;<span class="num" id="7011102">0xab</span><span class="op" id="7011106">,</span>&nbsp;<span class="num" id="7011108">0xcd</span><span class="op" id="7011112">,</span>&nbsp;<span class="num" id="7011114">0xef</span><span class="op" id="7011118">}</span><span class="op" id="7011119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011123">[</span><span class="op" id="7011124">]</span><span class="builtintype" id="7011125">byte</span><span class="op" id="7011129">{</span><span class="num" id="7011130">0x74</span><span class="op" id="7011134">,</span>&nbsp;<span class="num" id="7011136">0x94</span><span class="op" id="7011140">,</span>&nbsp;<span class="num" id="7011142">0xc2</span><span class="op" id="7011146">,</span>&nbsp;<span class="num" id="7011148">0xe7</span><span class="op" id="7011152">,</span>&nbsp;<span class="num" id="7011154">0x10</span><span class="op" id="7011158">,</span>&nbsp;<span class="num" id="7011160">0x4b</span><span class="op" id="7011164">,</span>&nbsp;<span class="num" id="7011166">0x08</span><span class="op" id="7011170">,</span>&nbsp;<span class="num" id="7011172">0x79</span><span class="op" id="7011176">}</span><span class="op" id="7011177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011180">}</span><span class="op" id="7011181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011184">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011188">[</span><span class="op" id="7011189">]</span><span class="builtintype" id="7011190">byte</span><span class="op" id="7011194">{</span><span class="num" id="7011195">0x00</span><span class="op" id="7011199">,</span>&nbsp;<span class="num" id="7011201">0x00</span><span class="op" id="7011205">,</span>&nbsp;<span class="num" id="7011207">0x00</span><span class="op" id="7011211">,</span>&nbsp;<span class="num" id="7011213">0x00</span><span class="op" id="7011217">,</span>&nbsp;<span class="num" id="7011219">0x00</span><span class="op" id="7011223">,</span>&nbsp;<span class="num" id="7011225">0x00</span><span class="op" id="7011229">,</span>&nbsp;<span class="num" id="7011231">0x00</span><span class="op" id="7011235">,</span>&nbsp;<span class="num" id="7011237">0x00</span><span class="op" id="7011241">}</span><span class="op" id="7011242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011246">[</span><span class="op" id="7011247">]</span><span class="builtintype" id="7011248">byte</span><span class="op" id="7011252">{</span><span class="num" id="7011253">0xde</span><span class="op" id="7011257">,</span>&nbsp;<span class="num" id="7011259">0x18</span><span class="op" id="7011263">,</span>&nbsp;<span class="num" id="7011265">0x89</span><span class="op" id="7011269">,</span>&nbsp;<span class="num" id="7011271">0x41</span><span class="op" id="7011275">,</span>&nbsp;<span class="num" id="7011277">0xa3</span><span class="op" id="7011281">,</span>&nbsp;<span class="num" id="7011283">0x37</span><span class="op" id="7011287">,</span>&nbsp;<span class="num" id="7011289">0x5d</span><span class="op" id="7011293">,</span>&nbsp;<span class="num" id="7011295">0x3a</span><span class="op" id="7011299">}</span><span class="op" id="7011300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011303">}</span><span class="op" id="7011304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011311">[</span><span class="op" id="7011312">]</span><span class="builtintype" id="7011313">byte</span><span class="op" id="7011317">{</span><span class="num" id="7011318">0xef</span><span class="op" id="7011322">,</span>&nbsp;<span class="num" id="7011324">0x01</span><span class="op" id="7011328">,</span>&nbsp;<span class="num" id="7011330">0x23</span><span class="op" id="7011334">,</span>&nbsp;<span class="num" id="7011336">0x45</span><span class="op" id="7011340">}</span><span class="op" id="7011341">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011345">[</span><span class="op" id="7011346">]</span><span class="builtintype" id="7011347">byte</span><span class="op" id="7011351">{</span><span class="num" id="7011352">0xd6</span><span class="op" id="7011356">,</span>&nbsp;<span class="num" id="7011358">0xa1</span><span class="op" id="7011362">,</span>&nbsp;<span class="num" id="7011364">0x41</span><span class="op" id="7011368">,</span>&nbsp;<span class="num" id="7011370">0xa7</span><span class="op" id="7011374">,</span>&nbsp;<span class="num" id="7011376">0xec</span><span class="op" id="7011380">,</span>&nbsp;<span class="num" id="7011382">0x3c</span><span class="op" id="7011386">,</span>&nbsp;<span class="num" id="7011388">0x38</span><span class="op" id="7011392">,</span>&nbsp;<span class="num" id="7011394">0xdf</span><span class="op" id="7011398">,</span>&nbsp;<span class="num" id="7011400">0xbd</span><span class="op" id="7011404">,</span>&nbsp;<span class="num" id="7011406">0x61</span><span class="op" id="7011410">}</span><span class="op" id="7011411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011414">}</span><span class="op" id="7011415">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7011419">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011494">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011498">[</span><span class="op" id="7011499">]</span><span class="builtintype" id="7011500">byte</span><span class="op" id="7011504">{</span><span class="num" id="7011505">0x4b</span><span class="op" id="7011509">,</span>&nbsp;<span class="num" id="7011511">0x65</span><span class="op" id="7011515">,</span>&nbsp;<span class="num" id="7011517">0x79</span><span class="op" id="7011521">}</span><span class="op" id="7011522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011526">[</span><span class="op" id="7011527">]</span><span class="builtintype" id="7011528">byte</span><span class="op" id="7011532">{</span><span class="num" id="7011533">0xeb</span><span class="op" id="7011537">,</span>&nbsp;<span class="num" id="7011539">0x9f</span><span class="op" id="7011543">,</span>&nbsp;<span class="num" id="7011545">0x77</span><span class="op" id="7011549">,</span>&nbsp;<span class="num" id="7011551">0x81</span><span class="op" id="7011555">,</span>&nbsp;<span class="num" id="7011557">0xb7</span><span class="op" id="7011561">,</span>&nbsp;<span class="num" id="7011563">0x34</span><span class="op" id="7011567">,</span>&nbsp;<span class="num" id="7011569">0xca</span><span class="op" id="7011573">,</span>&nbsp;<span class="num" id="7011575">0x72</span><span class="op" id="7011579">,</span>&nbsp;<span class="num" id="7011581">0xa7</span><span class="op" id="7011585">,</span>&nbsp;<span class="num" id="7011587">0x19</span><span class="op" id="7011591">}</span><span class="op" id="7011592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011595">}</span><span class="op" id="7011596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011603">[</span><span class="op" id="7011604">]</span><span class="builtintype" id="7011605">byte</span><span class="op" id="7011609">{</span><span class="num" id="7011610">0x57</span><span class="op" id="7011614">,</span>&nbsp;<span class="num" id="7011616">0x69</span><span class="op" id="7011620">,</span>&nbsp;<span class="num" id="7011622">0x6b</span><span class="op" id="7011626">,</span>&nbsp;<span class="num" id="7011628">0x69</span><span class="op" id="7011632">}</span><span class="op" id="7011633">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011637">[</span><span class="op" id="7011638">]</span><span class="builtintype" id="7011639">byte</span><span class="op" id="7011643">{</span><span class="num" id="7011644">0x60</span><span class="op" id="7011648">,</span>&nbsp;<span class="num" id="7011650">0x44</span><span class="op" id="7011654">,</span>&nbsp;<span class="num" id="7011656">0xdb</span><span class="op" id="7011660">,</span>&nbsp;<span class="num" id="7011662">0x6d</span><span class="op" id="7011666">,</span>&nbsp;<span class="num" id="7011668">0x41</span><span class="op" id="7011672">,</span>&nbsp;<span class="num" id="7011674">0xb7</span><span class="op" id="7011678">}</span><span class="op" id="7011679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011682">}</span><span class="op" id="7011683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011690">[</span><span class="op" id="7011691">]</span><span class="builtintype" id="7011692">byte</span><span class="op" id="7011696">{</span><span class="num" id="7011697">0x00</span><span class="op" id="7011701">,</span>&nbsp;<span class="num" id="7011703">0x00</span><span class="op" id="7011707">,</span>&nbsp;<span class="num" id="7011709">0x00</span><span class="op" id="7011713">,</span>&nbsp;<span class="num" id="7011715">0x00</span><span class="op" id="7011719">,</span>&nbsp;<span class="num" id="7011721">0x00</span><span class="op" id="7011725">,</span>&nbsp;<span class="num" id="7011727">0x00</span><span class="op" id="7011731">,</span>&nbsp;<span class="num" id="7011733">0x00</span><span class="op" id="7011737">,</span>&nbsp;<span class="num" id="7011739">0x00</span><span class="op" id="7011743">}</span><span class="op" id="7011744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7011748">[</span><span class="op" id="7011749">]</span><span class="builtintype" id="7011750">byte</span><span class="op" id="7011754">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7011759">0xde</span><span class="op" id="7011763">,</span>&nbsp;<span class="num" id="7011765">0x18</span><span class="op" id="7011769">,</span>&nbsp;<span class="num" id="7011771">0x89</span><span class="op" id="7011775">,</span>&nbsp;<span class="num" id="7011777">0x41</span><span class="op" id="7011781">,</span>&nbsp;<span class="num" id="7011783">0xa3</span><span class="op" id="7011787">,</span>&nbsp;<span class="num" id="7011789">0x37</span><span class="op" id="7011793">,</span>&nbsp;<span class="num" id="7011795">0x5d</span><span class="op" id="7011799">,</span>&nbsp;<span class="num" id="7011801">0x3a</span><span class="op" id="7011805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7011810">0x8a</span><span class="op" id="7011814">,</span>&nbsp;<span class="num" id="7011816">0x06</span><span class="op" id="7011820">,</span>&nbsp;<span class="num" id="7011822">0x1e</span><span class="op" id="7011826">,</span>&nbsp;<span class="num" id="7011828">0x67</span><span class="op" id="7011832">,</span>&nbsp;<span class="num" id="7011834">0x57</span><span class="op" id="7011838">,</span>&nbsp;<span class="num" id="7011840">0x6e</span><span class="op" id="7011844">,</span>&nbsp;<span class="num" id="7011846">0x92</span><span class="op" id="7011850">,</span>&nbsp;<span class="num" id="7011852">0x6d</span><span class="op" id="7011856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7011861">0xc7</span><span class="op" id="7011865">,</span>&nbsp;<span class="num" id="7011867">0x1a</span><span class="op" id="7011871">,</span>&nbsp;<span class="num" id="7011873">0x7f</span><span class="op" id="7011877">,</span>&nbsp;<span class="num" id="7011879">0xa3</span><span class="op" id="7011883">,</span>&nbsp;<span class="num" id="7011885">0xf0</span><span class="op" id="7011889">,</span>&nbsp;<span class="num" id="7011891">0xcc</span><span class="op" id="7011895">,</span>&nbsp;<span class="num" id="7011897">0xeb</span><span class="op" id="7011901">,</span>&nbsp;<span class="num" id="7011903">0x97</span><span class="op" id="7011907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7011912">0x45</span><span class="op" id="7011916">,</span>&nbsp;<span class="num" id="7011918">0x2b</span><span class="op" id="7011922">,</span>&nbsp;<span class="num" id="7011924">0x4d</span><span class="op" id="7011928">,</span>&nbsp;<span class="num" id="7011930">0x32</span><span class="op" id="7011934">,</span>&nbsp;<span class="num" id="7011936">0x27</span><span class="op" id="7011940">,</span>&nbsp;<span class="num" id="7011942">0x96</span><span class="op" id="7011946">,</span>&nbsp;<span class="num" id="7011948">0x5f</span><span class="op" id="7011952">,</span>&nbsp;<span class="num" id="7011954">0x9e</span><span class="op" id="7011958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7011963">0xa8</span><span class="op" id="7011967">,</span>&nbsp;<span class="num" id="7011969">0xcc</span><span class="op" id="7011973">,</span>&nbsp;<span class="num" id="7011975">0x75</span><span class="op" id="7011979">,</span>&nbsp;<span class="num" id="7011981">0x07</span><span class="op" id="7011985">,</span>&nbsp;<span class="num" id="7011987">0x6d</span><span class="op" id="7011991">,</span>&nbsp;<span class="num" id="7011993">0x9f</span><span class="op" id="7011997">,</span>&nbsp;<span class="num" id="7011999">0xb9</span><span class="op" id="7012003">,</span>&nbsp;<span class="num" id="7012005">0xc5</span><span class="op" id="7012009">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012014">0x41</span><span class="op" id="7012018">,</span>&nbsp;<span class="num" id="7012020">0x7a</span><span class="op" id="7012024">,</span>&nbsp;<span class="num" id="7012026">0xa5</span><span class="op" id="7012030">,</span>&nbsp;<span class="num" id="7012032">0xcb</span><span class="op" id="7012036">,</span>&nbsp;<span class="num" id="7012038">0x30</span><span class="op" id="7012042">,</span>&nbsp;<span class="num" id="7012044">0xfc</span><span class="op" id="7012048">,</span>&nbsp;<span class="num" id="7012050">0x22</span><span class="op" id="7012054">,</span>&nbsp;<span class="num" id="7012056">0x19</span><span class="op" id="7012060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012065">0x8b</span><span class="op" id="7012069">,</span>&nbsp;<span class="num" id="7012071">0x34</span><span class="op" id="7012075">,</span>&nbsp;<span class="num" id="7012077">0x98</span><span class="op" id="7012081">,</span>&nbsp;<span class="num" id="7012083">0x2d</span><span class="op" id="7012087">,</span>&nbsp;<span class="num" id="7012089">0xbb</span><span class="op" id="7012093">,</span>&nbsp;<span class="num" id="7012095">0x62</span><span class="op" id="7012099">,</span>&nbsp;<span class="num" id="7012101">0x9e</span><span class="op" id="7012105">,</span>&nbsp;<span class="num" id="7012107">0xc0</span><span class="op" id="7012111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012116">0x4b</span><span class="op" id="7012120">,</span>&nbsp;<span class="num" id="7012122">0x4f</span><span class="op" id="7012126">,</span>&nbsp;<span class="num" id="7012128">0x8b</span><span class="op" id="7012132">,</span>&nbsp;<span class="num" id="7012134">0x05</span><span class="op" id="7012138">,</span>&nbsp;<span class="num" id="7012140">0xa0</span><span class="op" id="7012144">,</span>&nbsp;<span class="num" id="7012146">0x71</span><span class="op" id="7012150">,</span>&nbsp;<span class="num" id="7012152">0x08</span><span class="op" id="7012156">,</span>&nbsp;<span class="num" id="7012158">0x50</span><span class="op" id="7012162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012167">0x92</span><span class="op" id="7012171">,</span>&nbsp;<span class="num" id="7012173">0xa0</span><span class="op" id="7012177">,</span>&nbsp;<span class="num" id="7012179">0xc3</span><span class="op" id="7012183">,</span>&nbsp;<span class="num" id="7012185">0x58</span><span class="op" id="7012189">,</span>&nbsp;<span class="num" id="7012191">0x4a</span><span class="op" id="7012195">,</span>&nbsp;<span class="num" id="7012197">0x48</span><span class="op" id="7012201">,</span>&nbsp;<span class="num" id="7012203">0xe4</span><span class="op" id="7012207">,</span>&nbsp;<span class="num" id="7012209">0xa3</span><span class="op" id="7012213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012218">0x0a</span><span class="op" id="7012222">,</span>&nbsp;<span class="num" id="7012224">0x39</span><span class="op" id="7012228">,</span>&nbsp;<span class="num" id="7012230">0x7b</span><span class="op" id="7012234">,</span>&nbsp;<span class="num" id="7012236">0x8a</span><span class="op" id="7012240">,</span>&nbsp;<span class="num" id="7012242">0xcd</span><span class="op" id="7012246">,</span>&nbsp;<span class="num" id="7012248">0x1d</span><span class="op" id="7012252">,</span>&nbsp;<span class="num" id="7012254">0x00</span><span class="op" id="7012258">,</span>&nbsp;<span class="num" id="7012260">0x9e</span><span class="op" id="7012264">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012269">0xc8</span><span class="op" id="7012273">,</span>&nbsp;<span class="num" id="7012275">0x7d</span><span class="op" id="7012279">,</span>&nbsp;<span class="num" id="7012281">0x68</span><span class="op" id="7012285">,</span>&nbsp;<span class="num" id="7012287">0x11</span><span class="op" id="7012291">,</span>&nbsp;<span class="num" id="7012293">0xf2</span><span class="op" id="7012297">,</span>&nbsp;<span class="num" id="7012299">0x2c</span><span class="op" id="7012303">,</span>&nbsp;<span class="num" id="7012305">0xf4</span><span class="op" id="7012309">,</span>&nbsp;<span class="num" id="7012311">0x9c</span><span class="op" id="7012315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012320">0xa3</span><span class="op" id="7012324">,</span>&nbsp;<span class="num" id="7012326">0xe5</span><span class="op" id="7012330">,</span>&nbsp;<span class="num" id="7012332">0x93</span><span class="op" id="7012336">,</span>&nbsp;<span class="num" id="7012338">0x54</span><span class="op" id="7012342">,</span>&nbsp;<span class="num" id="7012344">0xb9</span><span class="op" id="7012348">,</span>&nbsp;<span class="num" id="7012350">0x45</span><span class="op" id="7012354">,</span>&nbsp;<span class="num" id="7012356">0x15</span><span class="op" id="7012360">,</span>&nbsp;<span class="num" id="7012362">0x35</span><span class="op" id="7012366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012371">0xa2</span><span class="op" id="7012375">,</span>&nbsp;<span class="num" id="7012377">0x18</span><span class="op" id="7012381">,</span>&nbsp;<span class="num" id="7012383">0x7a</span><span class="op" id="7012387">,</span>&nbsp;<span class="num" id="7012389">0x86</span><span class="op" id="7012393">,</span>&nbsp;<span class="num" id="7012395">0x42</span><span class="op" id="7012399">,</span>&nbsp;<span class="num" id="7012401">0x6c</span><span class="op" id="7012405">,</span>&nbsp;<span class="num" id="7012407">0xca</span><span class="op" id="7012411">,</span>&nbsp;<span class="num" id="7012413">0x7d</span><span class="op" id="7012417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012422">0x5e</span><span class="op" id="7012426">,</span>&nbsp;<span class="num" id="7012428">0x82</span><span class="op" id="7012432">,</span>&nbsp;<span class="num" id="7012434">0x3e</span><span class="op" id="7012438">,</span>&nbsp;<span class="num" id="7012440">0xba</span><span class="op" id="7012444">,</span>&nbsp;<span class="num" id="7012446">0x00</span><span class="op" id="7012450">,</span>&nbsp;<span class="num" id="7012452">0x44</span><span class="op" id="7012456">,</span>&nbsp;<span class="num" id="7012458">0x12</span><span class="op" id="7012462">,</span>&nbsp;<span class="num" id="7012464">0x67</span><span class="op" id="7012468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012473">0x12</span><span class="op" id="7012477">,</span>&nbsp;<span class="num" id="7012479">0x57</span><span class="op" id="7012483">,</span>&nbsp;<span class="num" id="7012485">0xb8</span><span class="op" id="7012489">,</span>&nbsp;<span class="num" id="7012491">0xd8</span><span class="op" id="7012495">,</span>&nbsp;<span class="num" id="7012497">0x60</span><span class="op" id="7012501">,</span>&nbsp;<span class="num" id="7012503">0xae</span><span class="op" id="7012507">,</span>&nbsp;<span class="num" id="7012509">0x4c</span><span class="op" id="7012513">,</span>&nbsp;<span class="num" id="7012515">0xbd</span><span class="op" id="7012519">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012524">0x4c</span><span class="op" id="7012528">,</span>&nbsp;<span class="num" id="7012530">0x49</span><span class="op" id="7012534">,</span>&nbsp;<span class="num" id="7012536">0x06</span><span class="op" id="7012540">,</span>&nbsp;<span class="num" id="7012542">0xbb</span><span class="op" id="7012546">,</span>&nbsp;<span class="num" id="7012548">0xc5</span><span class="op" id="7012552">,</span>&nbsp;<span class="num" id="7012554">0x35</span><span class="op" id="7012558">,</span>&nbsp;<span class="num" id="7012560">0xef</span><span class="op" id="7012564">,</span>&nbsp;<span class="num" id="7012566">0xe1</span><span class="op" id="7012570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012575">0x58</span><span class="op" id="7012579">,</span>&nbsp;<span class="num" id="7012581">0x7f</span><span class="op" id="7012585">,</span>&nbsp;<span class="num" id="7012587">0x08</span><span class="op" id="7012591">,</span>&nbsp;<span class="num" id="7012593">0xdb</span><span class="op" id="7012597">,</span>&nbsp;<span class="num" id="7012599">0x33</span><span class="op" id="7012603">,</span>&nbsp;<span class="num" id="7012605">0x95</span><span class="op" id="7012609">,</span>&nbsp;<span class="num" id="7012611">0x5c</span><span class="op" id="7012615">,</span>&nbsp;<span class="num" id="7012617">0xdb</span><span class="op" id="7012621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012626">0xcb</span><span class="op" id="7012630">,</span>&nbsp;<span class="num" id="7012632">0xad</span><span class="op" id="7012636">,</span>&nbsp;<span class="num" id="7012638">0x9b</span><span class="op" id="7012642">,</span>&nbsp;<span class="num" id="7012644">0x10</span><span class="op" id="7012648">,</span>&nbsp;<span class="num" id="7012650">0xf5</span><span class="op" id="7012654">,</span>&nbsp;<span class="num" id="7012656">0x3f</span><span class="op" id="7012660">,</span>&nbsp;<span class="num" id="7012662">0xc4</span><span class="op" id="7012666">,</span>&nbsp;<span class="num" id="7012668">0xe5</span><span class="op" id="7012672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012677">0x2c</span><span class="op" id="7012681">,</span>&nbsp;<span class="num" id="7012683">0x59</span><span class="op" id="7012687">,</span>&nbsp;<span class="num" id="7012689">0x15</span><span class="op" id="7012693">,</span>&nbsp;<span class="num" id="7012695">0x65</span><span class="op" id="7012699">,</span>&nbsp;<span class="num" id="7012701">0x51</span><span class="op" id="7012705">,</span>&nbsp;<span class="num" id="7012707">0x84</span><span class="op" id="7012711">,</span>&nbsp;<span class="num" id="7012713">0x87</span><span class="op" id="7012717">,</span>&nbsp;<span class="num" id="7012719">0xfe</span><span class="op" id="7012723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012728">0x08</span><span class="op" id="7012732">,</span>&nbsp;<span class="num" id="7012734">0x4d</span><span class="op" id="7012738">,</span>&nbsp;<span class="num" id="7012740">0x0e</span><span class="op" id="7012744">,</span>&nbsp;<span class="num" id="7012746">0x3f</span><span class="op" id="7012750">,</span>&nbsp;<span class="num" id="7012752">0x03</span><span class="op" id="7012756">,</span>&nbsp;<span class="num" id="7012758">0xde</span><span class="op" id="7012762">,</span>&nbsp;<span class="num" id="7012764">0xbc</span><span class="op" id="7012768">,</span>&nbsp;<span class="num" id="7012770">0xc9</span><span class="op" id="7012774">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012779">0xda</span><span class="op" id="7012783">,</span>&nbsp;<span class="num" id="7012785">0x1c</span><span class="op" id="7012789">,</span>&nbsp;<span class="num" id="7012791">0xe9</span><span class="op" id="7012795">,</span>&nbsp;<span class="num" id="7012797">0x0d</span><span class="op" id="7012801">,</span>&nbsp;<span class="num" id="7012803">0x08</span><span class="op" id="7012807">,</span>&nbsp;<span class="num" id="7012809">0x5c</span><span class="op" id="7012813">,</span>&nbsp;<span class="num" id="7012815">0x2d</span><span class="op" id="7012819">,</span>&nbsp;<span class="num" id="7012821">0x8a</span><span class="op" id="7012825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012830">0x19</span><span class="op" id="7012834">,</span>&nbsp;<span class="num" id="7012836">0xd8</span><span class="op" id="7012840">,</span>&nbsp;<span class="num" id="7012842">0x37</span><span class="op" id="7012846">,</span>&nbsp;<span class="num" id="7012848">0x30</span><span class="op" id="7012852">,</span>&nbsp;<span class="num" id="7012854">0x86</span><span class="op" id="7012858">,</span>&nbsp;<span class="num" id="7012860">0x16</span><span class="op" id="7012864">,</span>&nbsp;<span class="num" id="7012866">0x36</span><span class="op" id="7012870">,</span>&nbsp;<span class="num" id="7012872">0x92</span><span class="op" id="7012876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012881">0x14</span><span class="op" id="7012885">,</span>&nbsp;<span class="num" id="7012887">0x2b</span><span class="op" id="7012891">,</span>&nbsp;<span class="num" id="7012893">0xd8</span><span class="op" id="7012897">,</span>&nbsp;<span class="num" id="7012899">0xfc</span><span class="op" id="7012903">,</span>&nbsp;<span class="num" id="7012905">0x5d</span><span class="op" id="7012909">,</span>&nbsp;<span class="num" id="7012911">0x7a</span><span class="op" id="7012915">,</span>&nbsp;<span class="num" id="7012917">0x73</span><span class="op" id="7012921">,</span>&nbsp;<span class="num" id="7012923">0x49</span><span class="op" id="7012927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012932">0x6a</span><span class="op" id="7012936">,</span>&nbsp;<span class="num" id="7012938">0x8e</span><span class="op" id="7012942">,</span>&nbsp;<span class="num" id="7012944">0x59</span><span class="op" id="7012948">,</span>&nbsp;<span class="num" id="7012950">0xee</span><span class="op" id="7012954">,</span>&nbsp;<span class="num" id="7012956">0x7e</span><span class="op" id="7012960">,</span>&nbsp;<span class="num" id="7012962">0xcf</span><span class="op" id="7012966">,</span>&nbsp;<span class="num" id="7012968">0x6b</span><span class="op" id="7012972">,</span>&nbsp;<span class="num" id="7012974">0x94</span><span class="op" id="7012978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7012983">0x06</span><span class="op" id="7012987">,</span>&nbsp;<span class="num" id="7012989">0x63</span><span class="op" id="7012993">,</span>&nbsp;<span class="num" id="7012995">0xf4</span><span class="op" id="7012999">,</span>&nbsp;<span class="num" id="7013001">0xa6</span><span class="op" id="7013005">,</span>&nbsp;<span class="num" id="7013007">0xbe</span><span class="op" id="7013011">,</span>&nbsp;<span class="num" id="7013013">0xe6</span><span class="op" id="7013017">,</span>&nbsp;<span class="num" id="7013019">0x5b</span><span class="op" id="7013023">,</span>&nbsp;<span class="num" id="7013025">0xd2</span><span class="op" id="7013029">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7013034">0xc8</span><span class="op" id="7013038">,</span>&nbsp;<span class="num" id="7013040">0x5c</span><span class="op" id="7013044">,</span>&nbsp;<span class="num" id="7013046">0x46</span><span class="op" id="7013050">,</span>&nbsp;<span class="num" id="7013052">0x98</span><span class="op" id="7013056">,</span>&nbsp;<span class="num" id="7013058">0x6c</span><span class="op" id="7013062">,</span>&nbsp;<span class="num" id="7013064">0x1b</span><span class="op" id="7013068">,</span>&nbsp;<span class="num" id="7013070">0xef</span><span class="op" id="7013074">,</span>&nbsp;<span class="num" id="7013076">0x34</span><span class="op" id="7013080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7013085">0x90</span><span class="op" id="7013089">,</span>&nbsp;<span class="num" id="7013091">0xd3</span><span class="op" id="7013095">,</span>&nbsp;<span class="num" id="7013097">0x7b</span><span class="op" id="7013101">,</span>&nbsp;<span class="num" id="7013103">0x38</span><span class="op" id="7013107">,</span>&nbsp;<span class="num" id="7013109">0xda</span><span class="op" id="7013113">,</span>&nbsp;<span class="num" id="7013115">0x85</span><span class="op" id="7013119">,</span>&nbsp;<span class="num" id="7013121">0xd3</span><span class="op" id="7013125">,</span>&nbsp;<span class="num" id="7013127">0x2e</span><span class="op" id="7013131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7013136">0x97</span><span class="op" id="7013140">,</span>&nbsp;<span class="num" id="7013142">0x39</span><span class="op" id="7013146">,</span>&nbsp;<span class="num" id="7013148">0xcb</span><span class="op" id="7013152">,</span>&nbsp;<span class="num" id="7013154">0x23</span><span class="op" id="7013158">,</span>&nbsp;<span class="num" id="7013160">0x4a</span><span class="op" id="7013164">,</span>&nbsp;<span class="num" id="7013166">0x2b</span><span class="op" id="7013170">,</span>&nbsp;<span class="num" id="7013172">0xe7</span><span class="op" id="7013176">,</span>&nbsp;<span class="num" id="7013178">0x40</span><span class="op" id="7013182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7013186">}</span><span class="op" id="7013187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7013190">}</span><span class="op" id="7013191">,</span><br>
<span class="lineno">75</span><span class="op" id="7013193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7013196">func</span>&nbsp;<span class="ident" id="7013201">testEncrypt</span><span class="op" id="7013212">(</span><span class="ident" id="7013213">t</span>&nbsp;<span class="op" id="7013215">*</span><span class="ident" id="7013216">testing</span><span class="op" id="7013223">.</span><span class="ident" id="7013224">T</span><span class="op" id="7013225">,</span>&nbsp;<span class="ident" id="7013227">desc</span>&nbsp;<span class="builtintype" id="7013232">string</span><span class="op" id="7013238">,</span>&nbsp;<span class="ident" id="7013240">c</span>&nbsp;<span class="op" id="7013242">*</span><span class="ident" id="7013243">Cipher</span><span class="op" id="7013249">,</span>&nbsp;<span class="ident" id="7013251">src</span><span class="op" id="7013254">,</span>&nbsp;<span class="ident" id="7013256">expect</span>&nbsp;<span class="op" id="7013263">[</span><span class="op" id="7013264">]</span><span class="builtintype" id="7013265">byte</span><span class="op" id="7013269">)</span>&nbsp;<span class="op" id="7013271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013274">dst</span>&nbsp;<span class="op" id="7013278">:=</span>&nbsp;<span class="builtinfunc" id="7013281">make</span><span class="op" id="7013285">(</span><span class="op" id="7013286">[</span><span class="op" id="7013287">]</span><span class="builtintype" id="7013288">byte</span><span class="op" id="7013292">,</span>&nbsp;<span class="builtinfunc" id="7013294">len</span><span class="op" id="7013297">(</span><span class="ident" id="7013298">src</span><span class="op" id="7013301">)</span><span class="op" id="7013302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013305">c</span><span class="op" id="7013306">.</span><span class="ident" id="7013307">XORKeyStream</span><span class="op" id="7013319">(</span><span class="ident" id="7013320">dst</span><span class="op" id="7013323">,</span>&nbsp;<span class="ident" id="7013325">src</span><span class="op" id="7013328">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013331">for</span>&nbsp;<span class="ident" id="7013335">i</span><span class="op" id="7013336">,</span>&nbsp;<span class="ident" id="7013338">v</span>&nbsp;<span class="op" id="7013340">:=</span>&nbsp;<span class="keyword" id="7013343">range</span>&nbsp;<span class="ident" id="7013349">dst</span>&nbsp;<span class="op" id="7013353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013357">if</span>&nbsp;<span class="ident" id="7013360">v</span>&nbsp;<span class="op" id="7013362">!=</span>&nbsp;<span class="ident" id="7013365">expect</span><span class="op" id="7013371">[</span><span class="ident" id="7013372">i</span><span class="op" id="7013373">]</span>&nbsp;<span class="op" id="7013375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013380">t</span><span class="op" id="7013381">.</span><span class="ident" id="7013382">Fatalf</span><span class="op" id="7013388">(</span><span class="string" id="7013389">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="7013433">,</span>&nbsp;<span class="ident" id="7013435">desc</span><span class="op" id="7013439">,</span>&nbsp;<span class="ident" id="7013441">i</span><span class="op" id="7013442">,</span>&nbsp;<span class="ident" id="7013444">dst</span><span class="op" id="7013447">,</span>&nbsp;<span class="ident" id="7013449">expect</span><span class="op" id="7013455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7013459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7013462">}</span><br>
<span class="lineno">85</span><span class="op" id="7013464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7013467">func</span>&nbsp;<span class="ident" id="7013472">TestGolden</span><span class="op" id="7013482">(</span><span class="ident" id="7013483">t</span>&nbsp;<span class="op" id="7013485">*</span><span class="ident" id="7013486">testing</span><span class="op" id="7013493">.</span><span class="ident" id="7013494">T</span><span class="op" id="7013495">)</span>&nbsp;<span class="op" id="7013497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013500">for</span>&nbsp;<span class="ident" id="7013504">gi</span><span class="op" id="7013506">,</span>&nbsp;<span class="ident" id="7013508">g</span>&nbsp;<span class="op" id="7013510">:=</span>&nbsp;<span class="keyword" id="7013513">range</span>&nbsp;<span class="ident" id="7013519">golden</span>&nbsp;<span class="op" id="7013526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013530">data</span>&nbsp;<span class="op" id="7013535">:=</span>&nbsp;<span class="builtinfunc" id="7013538">make</span><span class="op" id="7013542">(</span><span class="op" id="7013543">[</span><span class="op" id="7013544">]</span><span class="builtintype" id="7013545">byte</span><span class="op" id="7013549">,</span>&nbsp;<span class="builtinfunc" id="7013551">len</span><span class="op" id="7013554">(</span><span class="ident" id="7013555">g</span><span class="op" id="7013556">.</span><span class="ident" id="7013557">keystream</span><span class="op" id="7013566">)</span><span class="op" id="7013567">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013571">for</span>&nbsp;<span class="ident" id="7013575">i</span>&nbsp;<span class="op" id="7013577">:=</span>&nbsp;<span class="keyword" id="7013580">range</span>&nbsp;<span class="ident" id="7013586">data</span>&nbsp;<span class="op" id="7013591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013596">data</span><span class="op" id="7013600">[</span><span class="ident" id="7013601">i</span><span class="op" id="7013602">]</span>&nbsp;<span class="op" id="7013604">=</span>&nbsp;<span class="builtintype" id="7013606">byte</span><span class="op" id="7013610">(</span><span class="ident" id="7013611">i</span><span class="op" id="7013612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7013616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013621">expect</span>&nbsp;<span class="op" id="7013628">:=</span>&nbsp;<span class="builtinfunc" id="7013631">make</span><span class="op" id="7013635">(</span><span class="op" id="7013636">[</span><span class="op" id="7013637">]</span><span class="builtintype" id="7013638">byte</span><span class="op" id="7013642">,</span>&nbsp;<span class="builtinfunc" id="7013644">len</span><span class="op" id="7013647">(</span><span class="ident" id="7013648">g</span><span class="op" id="7013649">.</span><span class="ident" id="7013650">keystream</span><span class="op" id="7013659">)</span><span class="op" id="7013660">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013664">for</span>&nbsp;<span class="ident" id="7013668">i</span>&nbsp;<span class="op" id="7013670">:=</span>&nbsp;<span class="keyword" id="7013673">range</span>&nbsp;<span class="ident" id="7013679">expect</span>&nbsp;<span class="op" id="7013686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013691">expect</span><span class="op" id="7013697">[</span><span class="ident" id="7013698">i</span><span class="op" id="7013699">]</span>&nbsp;<span class="op" id="7013701">=</span>&nbsp;<span class="builtintype" id="7013703">byte</span><span class="op" id="7013707">(</span><span class="ident" id="7013708">i</span><span class="op" id="7013709">)</span>&nbsp;<span class="op" id="7013711">^</span>&nbsp;<span class="ident" id="7013713">g</span><span class="op" id="7013714">.</span><span class="ident" id="7013715">keystream</span><span class="op" id="7013724">[</span><span class="ident" id="7013725">i</span><span class="op" id="7013726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7013730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013735">for</span>&nbsp;<span class="ident" id="7013739">size</span>&nbsp;<span class="op" id="7013744">:=</span>&nbsp;<span class="num" id="7013747">1</span><span class="op" id="7013748">;</span>&nbsp;<span class="ident" id="7013750">size</span>&nbsp;<span class="op" id="7013755">&lt;=</span>&nbsp;<span class="builtinfunc" id="7013758">len</span><span class="op" id="7013761">(</span><span class="ident" id="7013762">g</span><span class="op" id="7013763">.</span><span class="ident" id="7013764">keystream</span><span class="op" id="7013773">)</span><span class="op" id="7013774">;</span>&nbsp;<span class="ident" id="7013776">size</span><span class="op" id="7013780">++</span>&nbsp;<span class="op" id="7013783">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013788">c</span><span class="op" id="7013789">,</span>&nbsp;<span class="ident" id="7013791">err</span>&nbsp;<span class="op" id="7013795">:=</span>&nbsp;<span class="ident" id="7013798">NewCipher</span><span class="op" id="7013807">(</span><span class="ident" id="7013808">g</span><span class="op" id="7013809">.</span><span class="ident" id="7013810">key</span><span class="op" id="7013813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013818">if</span>&nbsp;<span class="ident" id="7013821">err</span>&nbsp;<span class="op" id="7013825">!=</span>&nbsp;<span class="builtintype" id="7013828">nil</span>&nbsp;<span class="op" id="7013832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013838">t</span><span class="op" id="7013839">.</span><span class="ident" id="7013840">Fatalf</span><span class="op" id="7013846">(</span><span class="string" id="7013847">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="7013867">,</span>&nbsp;<span class="ident" id="7013869">gi</span><span class="op" id="7013871">,</span>&nbsp;<span class="ident" id="7013873">err</span><span class="op" id="7013876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7013881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013887">off</span>&nbsp;<span class="op" id="7013891">:=</span>&nbsp;<span class="num" id="7013894">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013899">for</span>&nbsp;<span class="ident" id="7013903">off</span>&nbsp;<span class="op" id="7013907">&lt;</span>&nbsp;<span class="builtinfunc" id="7013909">len</span><span class="op" id="7013912">(</span><span class="ident" id="7013913">g</span><span class="op" id="7013914">.</span><span class="ident" id="7013915">keystream</span><span class="op" id="7013924">)</span>&nbsp;<span class="op" id="7013926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013932">n</span>&nbsp;<span class="op" id="7013934">:=</span>&nbsp;<span class="builtinfunc" id="7013937">len</span><span class="op" id="7013940">(</span><span class="ident" id="7013941">g</span><span class="op" id="7013942">.</span><span class="ident" id="7013943">keystream</span><span class="op" id="7013952">)</span>&nbsp;<span class="op" id="7013954">-</span>&nbsp;<span class="ident" id="7013956">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7013964">if</span>&nbsp;<span class="ident" id="7013967">n</span>&nbsp;<span class="op" id="7013969">&gt;</span>&nbsp;<span class="ident" id="7013971">size</span>&nbsp;<span class="op" id="7013976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7013983">n</span>&nbsp;<span class="op" id="7013985">=</span>&nbsp;<span class="ident" id="7013987">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7013996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014002">desc</span>&nbsp;<span class="op" id="7014007">:=</span>&nbsp;<span class="ident" id="7014010">fmt</span><span class="op" id="7014013">.</span><span class="ident" id="7014014">Sprintf</span><span class="op" id="7014021">(</span><span class="string" id="7014022">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="7014035">,</span>&nbsp;<span class="ident" id="7014037">gi</span><span class="op" id="7014039">,</span>&nbsp;<span class="ident" id="7014041">off</span><span class="op" id="7014044">,</span>&nbsp;<span class="ident" id="7014046">off</span><span class="op" id="7014049">+</span><span class="ident" id="7014050">n</span><span class="op" id="7014051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014057">testEncrypt</span><span class="op" id="7014068">(</span><span class="ident" id="7014069">t</span><span class="op" id="7014070">,</span>&nbsp;<span class="ident" id="7014072">desc</span><span class="op" id="7014076">,</span>&nbsp;<span class="ident" id="7014078">c</span><span class="op" id="7014079">,</span>&nbsp;<span class="ident" id="7014081">data</span><span class="op" id="7014085">[</span><span class="ident" id="7014086">off</span><span class="op" id="7014089">:</span><span class="ident" id="7014090">off</span><span class="op" id="7014093">+</span><span class="ident" id="7014094">n</span><span class="op" id="7014095">]</span><span class="op" id="7014096">,</span>&nbsp;<span class="ident" id="7014098">expect</span><span class="op" id="7014104">[</span><span class="ident" id="7014105">off</span><span class="op" id="7014108">:</span><span class="ident" id="7014109">off</span><span class="op" id="7014112">+</span><span class="ident" id="7014113">n</span><span class="op" id="7014114">]</span><span class="op" id="7014115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014121">off</span>&nbsp;<span class="op" id="7014125">+=</span>&nbsp;<span class="ident" id="7014128">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7014133">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7014137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7014140">}</span><br>
<span class="lineno"></span><span class="op" id="7014142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7014145">func</span>&nbsp;<span class="ident" id="7014150">TestBlock</span><span class="op" id="7014159">(</span><span class="ident" id="7014160">t</span>&nbsp;<span class="op" id="7014162">*</span><span class="ident" id="7014163">testing</span><span class="op" id="7014170">.</span><span class="ident" id="7014171">T</span><span class="op" id="7014172">)</span>&nbsp;<span class="op" id="7014174">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014177">testBlock</span><span class="op" id="7014186">(</span><span class="ident" id="7014187">t</span><span class="op" id="7014188">,</span>&nbsp;<span class="op" id="7014190">(</span><span class="op" id="7014191">*</span><span class="ident" id="7014192">Cipher</span><span class="op" id="7014198">)</span><span class="op" id="7014199">.</span><span class="ident" id="7014200">XORKeyStream</span><span class="op" id="7014212">)</span><br>
<span class="lineno"></span><span class="op" id="7014214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7014217">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="7014246">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="7014313">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="7014357">func</span>&nbsp;<span class="ident" id="7014362">TestBlockGeneric</span><span class="op" id="7014378">(</span><span class="ident" id="7014379">t</span>&nbsp;<span class="op" id="7014381">*</span><span class="ident" id="7014382">testing</span><span class="op" id="7014389">.</span><span class="ident" id="7014390">T</span><span class="op" id="7014391">)</span>&nbsp;<span class="op" id="7014393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014396">testBlock</span><span class="op" id="7014405">(</span><span class="ident" id="7014406">t</span><span class="op" id="7014407">,</span>&nbsp;<span class="op" id="7014409">(</span><span class="op" id="7014410">*</span><span class="ident" id="7014411">Cipher</span><span class="op" id="7014417">)</span><span class="op" id="7014418">.</span><span class="ident" id="7014419">xorKeyStreamGeneric</span><span class="op" id="7014438">)</span><br>
<span class="lineno"></span><span class="op" id="7014440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7014443">func</span>&nbsp;<span class="ident" id="7014448">testBlock</span><span class="op" id="7014457">(</span><span class="ident" id="7014458">t</span>&nbsp;<span class="op" id="7014460">*</span><span class="ident" id="7014461">testing</span><span class="op" id="7014468">.</span><span class="ident" id="7014469">T</span><span class="op" id="7014470">,</span>&nbsp;<span class="ident" id="7014472">xor</span>&nbsp;<span class="keyword" id="7014476">func</span><span class="op" id="7014480">(</span><span class="ident" id="7014481">c</span>&nbsp;<span class="op" id="7014483">*</span><span class="ident" id="7014484">Cipher</span><span class="op" id="7014490">,</span>&nbsp;<span class="ident" id="7014492">dst</span><span class="op" id="7014495">,</span>&nbsp;<span class="ident" id="7014497">src</span>&nbsp;<span class="op" id="7014501">[</span><span class="op" id="7014502">]</span><span class="builtintype" id="7014503">byte</span><span class="op" id="7014507">)</span><span class="op" id="7014508">)</span>&nbsp;<span class="op" id="7014510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014513">c1a</span><span class="op" id="7014516">,</span>&nbsp;<span class="ident" id="7014518">_</span>&nbsp;<span class="op" id="7014520">:=</span>&nbsp;<span class="ident" id="7014523">NewCipher</span><span class="op" id="7014532">(</span><span class="ident" id="7014533">golden</span><span class="op" id="7014539">[</span><span class="num" id="7014540">0</span><span class="op" id="7014541">]</span><span class="op" id="7014542">.</span><span class="ident" id="7014543">key</span><span class="op" id="7014546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014549">c1b</span><span class="op" id="7014552">,</span>&nbsp;<span class="ident" id="7014554">_</span>&nbsp;<span class="op" id="7014556">:=</span>&nbsp;<span class="ident" id="7014559">NewCipher</span><span class="op" id="7014568">(</span><span class="ident" id="7014569">golden</span><span class="op" id="7014575">[</span><span class="num" id="7014576">1</span><span class="op" id="7014577">]</span><span class="op" id="7014578">.</span><span class="ident" id="7014579">key</span><span class="op" id="7014582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014585">data1</span>&nbsp;<span class="op" id="7014591">:=</span>&nbsp;<span class="builtinfunc" id="7014594">make</span><span class="op" id="7014598">(</span><span class="op" id="7014599">[</span><span class="op" id="7014600">]</span><span class="builtintype" id="7014601">byte</span><span class="op" id="7014605">,</span>&nbsp;<span class="num" id="7014607">1</span><span class="op" id="7014608">&lt;&lt;</span><span class="num" id="7014610">20</span><span class="op" id="7014612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7014615">for</span>&nbsp;<span class="ident" id="7014619">i</span>&nbsp;<span class="op" id="7014621">:=</span>&nbsp;<span class="keyword" id="7014624">range</span>&nbsp;<span class="ident" id="7014630">data1</span>&nbsp;<span class="op" id="7014636">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014640">xor</span><span class="op" id="7014643">(</span><span class="ident" id="7014644">c1a</span><span class="op" id="7014647">,</span>&nbsp;<span class="ident" id="7014649">data1</span><span class="op" id="7014654">[</span><span class="ident" id="7014655">i</span><span class="op" id="7014656">:</span><span class="ident" id="7014657">i</span><span class="op" id="7014658">+</span><span class="num" id="7014659">1</span><span class="op" id="7014660">]</span><span class="op" id="7014661">,</span>&nbsp;<span class="ident" id="7014663">data1</span><span class="op" id="7014668">[</span><span class="ident" id="7014669">i</span><span class="op" id="7014670">:</span><span class="ident" id="7014671">i</span><span class="op" id="7014672">+</span><span class="num" id="7014673">1</span><span class="op" id="7014674">]</span><span class="op" id="7014675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014679">xor</span><span class="op" id="7014682">(</span><span class="ident" id="7014683">c1b</span><span class="op" id="7014686">,</span>&nbsp;<span class="ident" id="7014688">data1</span><span class="op" id="7014693">[</span><span class="ident" id="7014694">i</span><span class="op" id="7014695">:</span><span class="ident" id="7014696">i</span><span class="op" id="7014697">+</span><span class="num" id="7014698">1</span><span class="op" id="7014699">]</span><span class="op" id="7014700">,</span>&nbsp;<span class="ident" id="7014702">data1</span><span class="op" id="7014707">[</span><span class="ident" id="7014708">i</span><span class="op" id="7014709">:</span><span class="ident" id="7014710">i</span><span class="op" id="7014711">+</span><span class="num" id="7014712">1</span><span class="op" id="7014713">]</span><span class="op" id="7014714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7014717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014721">c2a</span><span class="op" id="7014724">,</span>&nbsp;<span class="ident" id="7014726">_</span>&nbsp;<span class="op" id="7014728">:=</span>&nbsp;<span class="ident" id="7014731">NewCipher</span><span class="op" id="7014740">(</span><span class="ident" id="7014741">golden</span><span class="op" id="7014747">[</span><span class="num" id="7014748">0</span><span class="op" id="7014749">]</span><span class="op" id="7014750">.</span><span class="ident" id="7014751">key</span><span class="op" id="7014754">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014757">c2b</span><span class="op" id="7014760">,</span>&nbsp;<span class="ident" id="7014762">_</span>&nbsp;<span class="op" id="7014764">:=</span>&nbsp;<span class="ident" id="7014767">NewCipher</span><span class="op" id="7014776">(</span><span class="ident" id="7014777">golden</span><span class="op" id="7014783">[</span><span class="num" id="7014784">1</span><span class="op" id="7014785">]</span><span class="op" id="7014786">.</span><span class="ident" id="7014787">key</span><span class="op" id="7014790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014793">data2</span>&nbsp;<span class="op" id="7014799">:=</span>&nbsp;<span class="builtinfunc" id="7014802">make</span><span class="op" id="7014806">(</span><span class="op" id="7014807">[</span><span class="op" id="7014808">]</span><span class="builtintype" id="7014809">byte</span><span class="op" id="7014813">,</span>&nbsp;<span class="num" id="7014815">1</span><span class="op" id="7014816">&lt;&lt;</span><span class="num" id="7014818">20</span><span class="op" id="7014820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014823">xor</span><span class="op" id="7014826">(</span><span class="ident" id="7014827">c2a</span><span class="op" id="7014830">,</span>&nbsp;<span class="ident" id="7014832">data2</span><span class="op" id="7014837">,</span>&nbsp;<span class="ident" id="7014839">data2</span><span class="op" id="7014844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014847">xor</span><span class="op" id="7014850">(</span><span class="ident" id="7014851">c2b</span><span class="op" id="7014854">,</span>&nbsp;<span class="ident" id="7014856">data2</span><span class="op" id="7014861">,</span>&nbsp;<span class="ident" id="7014863">data2</span><span class="op" id="7014868">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7014872">if</span>&nbsp;<span class="op" id="7014875">!</span><span class="ident" id="7014876">bytes</span><span class="op" id="7014881">.</span><span class="ident" id="7014882">Equal</span><span class="op" id="7014887">(</span><span class="ident" id="7014888">data1</span><span class="op" id="7014893">,</span>&nbsp;<span class="ident" id="7014895">data2</span><span class="op" id="7014900">)</span>&nbsp;<span class="op" id="7014902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014906">t</span><span class="op" id="7014907">.</span><span class="ident" id="7014908">Fatalf</span><span class="op" id="7014914">(</span><span class="string" id="7014915">&#34;bad&nbsp;block&#34;</span><span class="op" id="7014926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7014929">}</span><br>
<span class="lineno"></span><span class="op" id="7014931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7014934">func</span>&nbsp;<span class="ident" id="7014939">benchmark</span><span class="op" id="7014948">(</span><span class="ident" id="7014949">b</span>&nbsp;<span class="op" id="7014951">*</span><span class="ident" id="7014952">testing</span><span class="op" id="7014959">.</span><span class="ident" id="7014960">B</span><span class="op" id="7014961">,</span>&nbsp;<span class="ident" id="7014963">size</span>&nbsp;<span class="ident" id="7014968">int64</span><span class="op" id="7014973">)</span>&nbsp;<span class="op" id="7014975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7014978">buf</span>&nbsp;<span class="op" id="7014982">:=</span>&nbsp;<span class="builtinfunc" id="7014985">make</span><span class="op" id="7014989">(</span><span class="op" id="7014990">[</span><span class="op" id="7014991">]</span><span class="builtintype" id="7014992">byte</span><span class="op" id="7014996">,</span>&nbsp;<span class="ident" id="7014998">size</span><span class="op" id="7015002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7015005">c</span><span class="op" id="7015006">,</span>&nbsp;<span class="ident" id="7015008">err</span>&nbsp;<span class="op" id="7015012">:=</span>&nbsp;<span class="ident" id="7015015">NewCipher</span><span class="op" id="7015024">(</span><span class="ident" id="7015025">golden</span><span class="op" id="7015031">[</span><span class="num" id="7015032">0</span><span class="op" id="7015033">]</span><span class="op" id="7015034">.</span><span class="ident" id="7015035">key</span><span class="op" id="7015038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7015041">if</span>&nbsp;<span class="ident" id="7015044">err</span>&nbsp;<span class="op" id="7015048">!=</span>&nbsp;<span class="builtintype" id="7015051">nil</span>&nbsp;<span class="op" id="7015055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7015059">panic</span><span class="op" id="7015064">(</span><span class="ident" id="7015065">err</span><span class="op" id="7015068">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7015071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7015074">b</span><span class="op" id="7015075">.</span><span class="ident" id="7015076">SetBytes</span><span class="op" id="7015084">(</span><span class="ident" id="7015085">size</span><span class="op" id="7015089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7015093">for</span>&nbsp;<span class="ident" id="7015097">i</span>&nbsp;<span class="op" id="7015099">:=</span>&nbsp;<span class="num" id="7015102">0</span><span class="op" id="7015103">;</span>&nbsp;<span class="ident" id="7015105">i</span>&nbsp;<span class="op" id="7015107">&lt;</span>&nbsp;<span class="ident" id="7015109">b</span><span class="op" id="7015110">.</span><span class="ident" id="7015111">N</span><span class="op" id="7015112">;</span>&nbsp;<span class="ident" id="7015114">i</span><span class="op" id="7015115">++</span>&nbsp;<span class="op" id="7015118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7015122">c</span><span class="op" id="7015123">.</span><span class="ident" id="7015124">XORKeyStream</span><span class="op" id="7015136">(</span><span class="ident" id="7015137">buf</span><span class="op" id="7015140">,</span>&nbsp;<span class="ident" id="7015142">buf</span><span class="op" id="7015145">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7015148">}</span><br>
<span class="lineno"></span><span class="op" id="7015150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7015153">func</span>&nbsp;<span class="ident" id="7015158">BenchmarkRC4_128</span><span class="op" id="7015174">(</span><span class="ident" id="7015175">b</span>&nbsp;<span class="op" id="7015177">*</span><span class="ident" id="7015178">testing</span><span class="op" id="7015185">.</span><span class="ident" id="7015186">B</span><span class="op" id="7015187">)</span>&nbsp;<span class="op" id="7015189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7015192">benchmark</span><span class="op" id="7015201">(</span><span class="ident" id="7015202">b</span><span class="op" id="7015203">,</span>&nbsp;<span class="num" id="7015205">128</span><span class="op" id="7015208">)</span><br>
<span class="lineno">165</span><span class="op" id="7015210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7015213">func</span>&nbsp;<span class="ident" id="7015218">BenchmarkRC4_1K</span><span class="op" id="7015233">(</span><span class="ident" id="7015234">b</span>&nbsp;<span class="op" id="7015236">*</span><span class="ident" id="7015237">testing</span><span class="op" id="7015244">.</span><span class="ident" id="7015245">B</span><span class="op" id="7015246">)</span>&nbsp;<span class="op" id="7015248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7015251">benchmark</span><span class="op" id="7015260">(</span><span class="ident" id="7015261">b</span><span class="op" id="7015262">,</span>&nbsp;<span class="num" id="7015264">1024</span><span class="op" id="7015268">)</span><br>
<span class="lineno"></span><span class="op" id="7015270">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7015273">func</span>&nbsp;<span class="ident" id="7015278">BenchmarkRC4_8K</span><span class="op" id="7015293">(</span><span class="ident" id="7015294">b</span>&nbsp;<span class="op" id="7015296">*</span><span class="ident" id="7015297">testing</span><span class="op" id="7015304">.</span><span class="ident" id="7015305">B</span><span class="op" id="7015306">)</span>&nbsp;<span class="op" id="7015308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7015311">benchmark</span><span class="op" id="7015320">(</span><span class="ident" id="7015321">b</span><span class="op" id="7015322">,</span>&nbsp;<span class="num" id="7015324">8096</span><span class="op" id="7015328">)</span><br>
<span class="lineno"></span><span class="op" id="7015330">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
