<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5677832">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5677888">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5677942">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5677993">package</span>&nbsp;<span class="ident" id="5678001">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5678008">import</span>&nbsp;<span class="op" id="5678015">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5678018">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5678029">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5678037">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5678044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5678047">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="5678112">type</span>&nbsp;<span class="ident" id="5678117">GCStats</span>&nbsp;<span class="keyword" id="5678125">struct</span>&nbsp;<span class="op" id="5678132">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678135">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678150">time</span><span class="op" id="5678154">.</span><span class="ident" id="5678155">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5678166">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678194">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678209">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5678225">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678259">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5678274">time</span><span class="op" id="5678278">.</span><span class="ident" id="5678279">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5678290">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678326">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5678341">[</span><span class="op" id="5678342">]</span><span class="ident" id="5678343">time</span><span class="op" id="5678347">.</span><span class="ident" id="5678348">Duration</span>&nbsp;<span class="comment" id="5678357">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678394">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5678409">[</span><span class="op" id="5678410">]</span><span class="ident" id="5678411">time</span><span class="op" id="5678415">.</span><span class="ident" id="5678416">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5678425">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5678472">PauseQuantiles</span>&nbsp;<span class="op" id="5678487">[</span><span class="op" id="5678488">]</span><span class="ident" id="5678489">time</span><span class="op" id="5678493">.</span><span class="ident" id="5678494">Duration</span><br>
<span class="lineno"></span><span class="op" id="5678503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5678506">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="5678575">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="5678642">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5678718">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5678785">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="5678862">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5678925">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="5678996">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="5679039">func</span>&nbsp;<span class="ident" id="5679044">ReadGCStats</span><span class="op" id="5679055">(</span><span class="ident" id="5679056">stats</span>&nbsp;<span class="op" id="5679062">*</span><span class="ident" id="5679063">GCStats</span><span class="op" id="5679070">)</span>&nbsp;<span class="op" id="5679072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679075">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679137">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679200">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679264">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679320">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679345">const</span>&nbsp;<span class="ident" id="5679351">maxPause</span>&nbsp;<span class="op" id="5679360">=</span>&nbsp;<span class="builtinfunc" id="5679362">len</span><span class="op" id="5679365">(</span><span class="op" id="5679366">(</span><span class="op" id="5679367">(</span><span class="op" id="5679368">*</span><span class="ident" id="5679369">runtime</span><span class="op" id="5679376">.</span><span class="ident" id="5679377">MemStats</span><span class="op" id="5679385">)</span><span class="op" id="5679386">(</span><span class="ident" id="5679387">nil</span><span class="op" id="5679390">)</span><span class="op" id="5679391">)</span><span class="op" id="5679392">.</span><span class="ident" id="5679393">PauseNs</span><span class="op" id="5679400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5679403">if</span>&nbsp;<span class="builtinfunc" id="5679406">cap</span><span class="op" id="5679409">(</span><span class="ident" id="5679410">stats</span><span class="op" id="5679415">.</span><span class="ident" id="5679416">Pause</span><span class="op" id="5679421">)</span>&nbsp;<span class="op" id="5679423">&lt;</span>&nbsp;<span class="num" id="5679425">2</span><span class="op" id="5679426">*</span><span class="ident" id="5679427">maxPause</span><span class="op" id="5679435">+</span><span class="num" id="5679436">3</span>&nbsp;<span class="op" id="5679438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679442">stats</span><span class="op" id="5679447">.</span><span class="ident" id="5679448">Pause</span>&nbsp;<span class="op" id="5679454">=</span>&nbsp;<span class="builtinfunc" id="5679456">make</span><span class="op" id="5679460">(</span><span class="op" id="5679461">[</span><span class="op" id="5679462">]</span><span class="ident" id="5679463">time</span><span class="op" id="5679467">.</span><span class="ident" id="5679468">Duration</span><span class="op" id="5679476">,</span>&nbsp;<span class="num" id="5679478">2</span><span class="op" id="5679479">*</span><span class="ident" id="5679480">maxPause</span><span class="op" id="5679488">+</span><span class="num" id="5679489">3</span><span class="op" id="5679490">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5679493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679497">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679563">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679631">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679694">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679753">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5679821">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679841">readGCStats</span><span class="op" id="5679852">(</span><span class="op" id="5679853">&amp;</span><span class="ident" id="5679854">stats</span><span class="op" id="5679859">.</span><span class="ident" id="5679860">Pause</span><span class="op" id="5679865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679868">n</span>&nbsp;<span class="op" id="5679870">:=</span>&nbsp;<span class="builtinfunc" id="5679873">len</span><span class="op" id="5679876">(</span><span class="ident" id="5679877">stats</span><span class="op" id="5679882">.</span><span class="ident" id="5679883">Pause</span><span class="op" id="5679888">)</span>&nbsp;<span class="op" id="5679890">-</span>&nbsp;<span class="num" id="5679892">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679895">stats</span><span class="op" id="5679900">.</span><span class="ident" id="5679901">LastGC</span>&nbsp;<span class="op" id="5679908">=</span>&nbsp;<span class="ident" id="5679910">time</span><span class="op" id="5679914">.</span><span class="ident" id="5679915">Unix</span><span class="op" id="5679919">(</span><span class="num" id="5679920">0</span><span class="op" id="5679921">,</span>&nbsp;<span class="ident" id="5679923">int64</span><span class="op" id="5679928">(</span><span class="ident" id="5679929">stats</span><span class="op" id="5679934">.</span><span class="ident" id="5679935">Pause</span><span class="op" id="5679940">[</span><span class="ident" id="5679941">n</span><span class="op" id="5679942">]</span><span class="op" id="5679943">)</span><span class="op" id="5679944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679947">stats</span><span class="op" id="5679952">.</span><span class="ident" id="5679953">NumGC</span>&nbsp;<span class="op" id="5679959">=</span>&nbsp;<span class="ident" id="5679961">int64</span><span class="op" id="5679966">(</span><span class="ident" id="5679967">stats</span><span class="op" id="5679972">.</span><span class="ident" id="5679973">Pause</span><span class="op" id="5679978">[</span><span class="ident" id="5679979">n</span><span class="op" id="5679980">+</span><span class="num" id="5679981">1</span><span class="op" id="5679982">]</span><span class="op" id="5679983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5679986">stats</span><span class="op" id="5679991">.</span><span class="ident" id="5679992">PauseTotal</span>&nbsp;<span class="op" id="5680003">=</span>&nbsp;<span class="ident" id="5680005">stats</span><span class="op" id="5680010">.</span><span class="ident" id="5680011">Pause</span><span class="op" id="5680016">[</span><span class="ident" id="5680017">n</span><span class="op" id="5680018">+</span><span class="num" id="5680019">2</span><span class="op" id="5680020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680023">n</span>&nbsp;<span class="op" id="5680025">/=</span>&nbsp;<span class="num" id="5680028">2</span>&nbsp;<span class="comment" id="5680030">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680068">stats</span><span class="op" id="5680073">.</span><span class="ident" id="5680074">Pause</span>&nbsp;<span class="op" id="5680080">=</span>&nbsp;<span class="ident" id="5680082">stats</span><span class="op" id="5680087">.</span><span class="ident" id="5680088">Pause</span><span class="op" id="5680093">[</span><span class="op" id="5680094">:</span><span class="ident" id="5680095">n</span><span class="op" id="5680096">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680100">if</span>&nbsp;<span class="builtinfunc" id="5680103">cap</span><span class="op" id="5680106">(</span><span class="ident" id="5680107">stats</span><span class="op" id="5680112">.</span><span class="ident" id="5680113">PauseEnd</span><span class="op" id="5680121">)</span>&nbsp;<span class="op" id="5680123">&lt;</span>&nbsp;<span class="ident" id="5680125">maxPause</span>&nbsp;<span class="op" id="5680134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680138">stats</span><span class="op" id="5680143">.</span><span class="ident" id="5680144">PauseEnd</span>&nbsp;<span class="op" id="5680153">=</span>&nbsp;<span class="builtinfunc" id="5680155">make</span><span class="op" id="5680159">(</span><span class="op" id="5680160">[</span><span class="op" id="5680161">]</span><span class="ident" id="5680162">time</span><span class="op" id="5680166">.</span><span class="ident" id="5680167">Time</span><span class="op" id="5680171">,</span>&nbsp;<span class="num" id="5680173">0</span><span class="op" id="5680174">,</span>&nbsp;<span class="ident" id="5680176">maxPause</span><span class="op" id="5680184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680190">stats</span><span class="op" id="5680195">.</span><span class="ident" id="5680196">PauseEnd</span>&nbsp;<span class="op" id="5680205">=</span>&nbsp;<span class="ident" id="5680207">stats</span><span class="op" id="5680212">.</span><span class="ident" id="5680213">PauseEnd</span><span class="op" id="5680221">[</span><span class="op" id="5680222">:</span><span class="num" id="5680223">0</span><span class="op" id="5680224">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680227">for</span>&nbsp;<span class="ident" id="5680231">_</span><span class="op" id="5680232">,</span>&nbsp;<span class="ident" id="5680234">ns</span>&nbsp;<span class="op" id="5680237">:=</span>&nbsp;<span class="keyword" id="5680240">range</span>&nbsp;<span class="ident" id="5680246">stats</span><span class="op" id="5680251">.</span><span class="ident" id="5680252">Pause</span><span class="op" id="5680257">[</span><span class="ident" id="5680258">n</span>&nbsp;<span class="op" id="5680260">:</span>&nbsp;<span class="ident" id="5680262">n</span><span class="op" id="5680263">+</span><span class="ident" id="5680264">n</span><span class="op" id="5680265">]</span>&nbsp;<span class="op" id="5680267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680271">stats</span><span class="op" id="5680276">.</span><span class="ident" id="5680277">PauseEnd</span>&nbsp;<span class="op" id="5680286">=</span>&nbsp;<span class="builtinfunc" id="5680288">append</span><span class="op" id="5680294">(</span><span class="ident" id="5680295">stats</span><span class="op" id="5680300">.</span><span class="ident" id="5680301">PauseEnd</span><span class="op" id="5680309">,</span>&nbsp;<span class="ident" id="5680311">time</span><span class="op" id="5680315">.</span><span class="ident" id="5680316">Unix</span><span class="op" id="5680320">(</span><span class="num" id="5680321">0</span><span class="op" id="5680322">,</span>&nbsp;<span class="ident" id="5680324">int64</span><span class="op" id="5680329">(</span><span class="ident" id="5680330">ns</span><span class="op" id="5680332">)</span><span class="op" id="5680333">)</span><span class="op" id="5680334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680341">if</span>&nbsp;<span class="builtinfunc" id="5680344">len</span><span class="op" id="5680347">(</span><span class="ident" id="5680348">stats</span><span class="op" id="5680353">.</span><span class="ident" id="5680354">PauseQuantiles</span><span class="op" id="5680368">)</span>&nbsp;<span class="op" id="5680370">&gt;</span>&nbsp;<span class="num" id="5680372">0</span>&nbsp;<span class="op" id="5680374">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680378">if</span>&nbsp;<span class="ident" id="5680381">n</span>&nbsp;<span class="op" id="5680383">==</span>&nbsp;<span class="num" id="5680386">0</span>&nbsp;<span class="op" id="5680388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680393">for</span>&nbsp;<span class="ident" id="5680397">i</span>&nbsp;<span class="op" id="5680399">:=</span>&nbsp;<span class="keyword" id="5680402">range</span>&nbsp;<span class="ident" id="5680408">stats</span><span class="op" id="5680413">.</span><span class="ident" id="5680414">PauseQuantiles</span>&nbsp;<span class="op" id="5680429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680435">stats</span><span class="op" id="5680440">.</span><span class="ident" id="5680441">PauseQuantiles</span><span class="op" id="5680455">[</span><span class="ident" id="5680456">i</span><span class="op" id="5680457">]</span>&nbsp;<span class="op" id="5680459">=</span>&nbsp;<span class="num" id="5680461">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680470">}</span>&nbsp;<span class="keyword" id="5680472">else</span>&nbsp;<span class="op" id="5680477">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5680482">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5680547">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680600">sorted</span>&nbsp;<span class="op" id="5680607">:=</span>&nbsp;<span class="ident" id="5680610">stats</span><span class="op" id="5680615">.</span><span class="ident" id="5680616">Pause</span><span class="op" id="5680621">[</span><span class="ident" id="5680622">n</span>&nbsp;<span class="op" id="5680624">:</span>&nbsp;<span class="ident" id="5680626">n</span><span class="op" id="5680627">+</span><span class="ident" id="5680628">n</span><span class="op" id="5680629">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5680634">copy</span><span class="op" id="5680638">(</span><span class="ident" id="5680639">sorted</span><span class="op" id="5680645">,</span>&nbsp;<span class="ident" id="5680647">stats</span><span class="op" id="5680652">.</span><span class="ident" id="5680653">Pause</span><span class="op" id="5680658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680663">sort</span><span class="op" id="5680667">.</span><span class="ident" id="5680668">Sort</span><span class="op" id="5680672">(</span><span class="ident" id="5680673">byDuration</span><span class="op" id="5680683">(</span><span class="ident" id="5680684">sorted</span><span class="op" id="5680690">)</span><span class="op" id="5680691">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680696">nq</span>&nbsp;<span class="op" id="5680699">:=</span>&nbsp;<span class="builtinfunc" id="5680702">len</span><span class="op" id="5680705">(</span><span class="ident" id="5680706">stats</span><span class="op" id="5680711">.</span><span class="ident" id="5680712">PauseQuantiles</span><span class="op" id="5680726">)</span>&nbsp;<span class="op" id="5680728">-</span>&nbsp;<span class="num" id="5680730">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5680735">for</span>&nbsp;<span class="ident" id="5680739">i</span>&nbsp;<span class="op" id="5680741">:=</span>&nbsp;<span class="num" id="5680744">0</span><span class="op" id="5680745">;</span>&nbsp;<span class="ident" id="5680747">i</span>&nbsp;<span class="op" id="5680749">&lt;</span>&nbsp;<span class="ident" id="5680751">nq</span><span class="op" id="5680753">;</span>&nbsp;<span class="ident" id="5680755">i</span><span class="op" id="5680756">++</span>&nbsp;<span class="op" id="5680759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680765">stats</span><span class="op" id="5680770">.</span><span class="ident" id="5680771">PauseQuantiles</span><span class="op" id="5680785">[</span><span class="ident" id="5680786">i</span><span class="op" id="5680787">]</span>&nbsp;<span class="op" id="5680789">=</span>&nbsp;<span class="ident" id="5680791">sorted</span><span class="op" id="5680797">[</span><span class="builtinfunc" id="5680798">len</span><span class="op" id="5680801">(</span><span class="ident" id="5680802">sorted</span><span class="op" id="5680808">)</span><span class="op" id="5680809">*</span><span class="ident" id="5680810">i</span><span class="op" id="5680811">/</span><span class="ident" id="5680812">nq</span><span class="op" id="5680814">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5680824">stats</span><span class="op" id="5680829">.</span><span class="ident" id="5680830">PauseQuantiles</span><span class="op" id="5680844">[</span><span class="ident" id="5680845">nq</span><span class="op" id="5680847">]</span>&nbsp;<span class="op" id="5680849">=</span>&nbsp;<span class="ident" id="5680851">sorted</span><span class="op" id="5680857">[</span><span class="builtinfunc" id="5680858">len</span><span class="op" id="5680861">(</span><span class="ident" id="5680862">sorted</span><span class="op" id="5680868">)</span><span class="op" id="5680869">-</span><span class="num" id="5680870">1</span><span class="op" id="5680871">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5680878">}</span><br>
<span class="lineno"></span><span class="op" id="5680880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5680883">type</span>&nbsp;<span class="ident" id="5680888">byDuration</span>&nbsp;<span class="op" id="5680899">[</span><span class="op" id="5680900">]</span><span class="ident" id="5680901">time</span><span class="op" id="5680905">.</span><span class="ident" id="5680906">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5680916">func</span>&nbsp;<span class="op" id="5680921">(</span><span class="ident" id="5680922">x</span>&nbsp;<span class="ident" id="5680924">byDuration</span><span class="op" id="5680934">)</span>&nbsp;<span class="ident" id="5680936">Len</span><span class="op" id="5680939">(</span><span class="op" id="5680940">)</span>&nbsp;<span class="builtintype" id="5680942">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5680956">{</span>&nbsp;<span class="keyword" id="5680958">return</span>&nbsp;<span class="builtinfunc" id="5680965">len</span><span class="op" id="5680968">(</span><span class="ident" id="5680969">x</span><span class="op" id="5680970">)</span>&nbsp;<span class="op" id="5680972">}</span><br>
<span class="lineno"></span><span class="keyword" id="5680974">func</span>&nbsp;<span class="op" id="5680979">(</span><span class="ident" id="5680980">x</span>&nbsp;<span class="ident" id="5680982">byDuration</span><span class="op" id="5680992">)</span>&nbsp;<span class="ident" id="5680994">Swap</span><span class="op" id="5680998">(</span><span class="ident" id="5680999">i</span><span class="op" id="5681000">,</span>&nbsp;<span class="ident" id="5681002">j</span>&nbsp;<span class="builtintype" id="5681004">int</span><span class="op" id="5681007">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5681014">{</span>&nbsp;<span class="ident" id="5681016">x</span><span class="op" id="5681017">[</span><span class="ident" id="5681018">i</span><span class="op" id="5681019">]</span><span class="op" id="5681020">,</span>&nbsp;<span class="ident" id="5681022">x</span><span class="op" id="5681023">[</span><span class="ident" id="5681024">j</span><span class="op" id="5681025">]</span>&nbsp;<span class="op" id="5681027">=</span>&nbsp;<span class="ident" id="5681029">x</span><span class="op" id="5681030">[</span><span class="ident" id="5681031">j</span><span class="op" id="5681032">]</span><span class="op" id="5681033">,</span>&nbsp;<span class="ident" id="5681035">x</span><span class="op" id="5681036">[</span><span class="ident" id="5681037">i</span><span class="op" id="5681038">]</span>&nbsp;<span class="op" id="5681040">}</span><br>
<span class="lineno"></span><span class="keyword" id="5681042">func</span>&nbsp;<span class="op" id="5681047">(</span><span class="ident" id="5681048">x</span>&nbsp;<span class="ident" id="5681050">byDuration</span><span class="op" id="5681060">)</span>&nbsp;<span class="ident" id="5681062">Less</span><span class="op" id="5681066">(</span><span class="ident" id="5681067">i</span><span class="op" id="5681068">,</span>&nbsp;<span class="ident" id="5681070">j</span>&nbsp;<span class="builtintype" id="5681072">int</span><span class="op" id="5681075">)</span>&nbsp;<span class="builtintype" id="5681077">bool</span>&nbsp;<span class="op" id="5681082">{</span>&nbsp;<span class="keyword" id="5681084">return</span>&nbsp;<span class="ident" id="5681091">x</span><span class="op" id="5681092">[</span><span class="ident" id="5681093">i</span><span class="op" id="5681094">]</span>&nbsp;<span class="op" id="5681096">&lt;</span>&nbsp;<span class="ident" id="5681098">x</span><span class="op" id="5681099">[</span><span class="ident" id="5681100">j</span><span class="op" id="5681101">]</span>&nbsp;<span class="op" id="5681103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5681106">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="5681169">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5681239">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="5681320">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5681366">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="5681435">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5681485">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="5681539">func</span>&nbsp;<span class="ident" id="5681544">SetGCPercent</span><span class="op" id="5681556">(</span><span class="ident" id="5681557">percent</span>&nbsp;<span class="builtintype" id="5681565">int</span><span class="op" id="5681568">)</span>&nbsp;<span class="builtintype" id="5681570">int</span>&nbsp;<span class="op" id="5681574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5681577">old</span>&nbsp;<span class="op" id="5681581">:=</span>&nbsp;<span class="ident" id="5681584">setGCPercent</span><span class="op" id="5681596">(</span><span class="builtintype" id="5681597">int32</span><span class="op" id="5681602">(</span><span class="ident" id="5681603">percent</span><span class="op" id="5681610">)</span><span class="op" id="5681611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5681614">runtime</span><span class="op" id="5681621">.</span><span class="ident" id="5681622">GC</span><span class="op" id="5681624">(</span><span class="op" id="5681625">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5681628">return</span>&nbsp;<span class="builtintype" id="5681635">int</span><span class="op" id="5681638">(</span><span class="ident" id="5681639">old</span><span class="op" id="5681642">)</span><br>
<span class="lineno"></span><span class="op" id="5681644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5681647">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5681706">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="5681766">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="5681833">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="5681898">func</span>&nbsp;<span class="ident" id="5681903">FreeOSMemory</span><span class="op" id="5681915">(</span><span class="op" id="5681916">)</span>&nbsp;<span class="op" id="5681918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5681921">freeOSMemory</span><span class="op" id="5681933">(</span><span class="op" id="5681934">)</span><br>
<span class="lineno"></span><span class="op" id="5681936">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5681939">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5681993">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5682037">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="5682101">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="5682125">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5682170">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="5682246">//</span><br>
<span class="lineno"></span><span class="comment" id="5682249">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5682313">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="5682383">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="5682400">func</span>&nbsp;<span class="ident" id="5682405">SetMaxStack</span><span class="op" id="5682416">(</span><span class="ident" id="5682417">bytes</span>&nbsp;<span class="builtintype" id="5682423">int</span><span class="op" id="5682426">)</span>&nbsp;<span class="builtintype" id="5682428">int</span>&nbsp;<span class="op" id="5682432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5682435">return</span>&nbsp;<span class="ident" id="5682442">setMaxStack</span><span class="op" id="5682453">(</span><span class="ident" id="5682454">bytes</span><span class="op" id="5682459">)</span><br>
<span class="lineno"></span><span class="op" id="5682461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5682464">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="5682525">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="5682597">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="5682632">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5682679">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="5682721">//</span><br>
<span class="lineno"></span><span class="comment" id="5682724">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5682801">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="5682875">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="5682963">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="5683036">//</span><br>
<span class="lineno"></span><span class="comment" id="5683039">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5683105">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5683173">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="5683244">func</span>&nbsp;<span class="ident" id="5683249">SetMaxThreads</span><span class="op" id="5683262">(</span><span class="ident" id="5683263">threads</span>&nbsp;<span class="builtintype" id="5683271">int</span><span class="op" id="5683274">)</span>&nbsp;<span class="builtintype" id="5683276">int</span>&nbsp;<span class="op" id="5683280">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5683283">return</span>&nbsp;<span class="ident" id="5683290">setMaxThreads</span><span class="op" id="5683303">(</span><span class="ident" id="5683304">threads</span><span class="op" id="5683311">)</span><br>
<span class="lineno"></span><span class="op" id="5683313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5683316">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="5683389">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="5683464">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="5683543">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="5683611">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="5683683">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="5683755">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="5683810">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="5683868">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="5683904">func</span>&nbsp;<span class="ident" id="5683909">SetPanicOnFault</span><span class="op" id="5683924">(</span><span class="ident" id="5683925">enabled</span>&nbsp;<span class="builtintype" id="5683933">bool</span><span class="op" id="5683937">)</span>&nbsp;<span class="builtintype" id="5683939">bool</span>&nbsp;<span class="op" id="5683944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5683947">return</span>&nbsp;<span class="ident" id="5683954">setPanicOnFault</span><span class="op" id="5683969">(</span><span class="ident" id="5683970">enabled</span><span class="op" id="5683977">)</span><br>
<span class="lineno"></span><span class="op" id="5683979">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5683982">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5684051">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="5684087">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="5684159">func</span>&nbsp;<span class="ident" id="5684164">WriteHeapDump</span><span class="op" id="5684177">(</span><span class="ident" id="5684178">fd</span>&nbsp;<span class="builtintype" id="5684181">uintptr</span><span class="op" id="5684188">)</span>
</div>
</body>
</html>
