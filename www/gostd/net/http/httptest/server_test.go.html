<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httptest</h2>
<ul>
<li><a href="/gostd/net/http/httptest/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder.go.html">recorder.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder_test.go.html">recorder_test.go</a></li>
<li><a href="/gostd/net/http/httptest/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/httptest/server_test.go.html">server_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7378239">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7378294">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7378348">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7378399">package</span>&nbsp;<span class="ident" id="7378407">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7378417">import</span>&nbsp;<span class="op" id="7378424">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378427">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378440">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7378452">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7378462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7378465">func</span>&nbsp;<span class="ident" id="7378470">TestServer</span><span class="op" id="7378480">(</span><span class="ident" id="7378481">t</span>&nbsp;<span class="op" id="7378483">*</span><span class="ident" id="7378484">testing</span><span class="op" id="7378491">.</span><span class="ident" id="7378492">T</span><span class="op" id="7378493">)</span>&nbsp;<span class="op" id="7378495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378498">ts</span>&nbsp;<span class="op" id="7378501">:=</span>&nbsp;<span class="ident" id="7378504">NewServer</span><span class="op" id="7378513">(</span><span class="ident" id="7378514">http</span><span class="op" id="7378518">.</span><span class="ident" id="7378519">HandlerFunc</span><span class="op" id="7378530">(</span><span class="keyword" id="7378531">func</span><span class="op" id="7378535">(</span><span class="ident" id="7378536">w</span>&nbsp;<span class="ident" id="7378538">http</span><span class="op" id="7378542">.</span><span class="ident" id="7378543">ResponseWriter</span><span class="op" id="7378557">,</span>&nbsp;<span class="ident" id="7378559">r</span>&nbsp;<span class="op" id="7378561">*</span><span class="ident" id="7378562">http</span><span class="op" id="7378566">.</span><span class="ident" id="7378567">Request</span><span class="op" id="7378574">)</span>&nbsp;<span class="op" id="7378576">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378580">w</span><span class="op" id="7378581">.</span><span class="ident" id="7378582">Write</span><span class="op" id="7378587">(</span><span class="op" id="7378588">[</span><span class="op" id="7378589">]</span><span class="builtintype" id="7378590">byte</span><span class="op" id="7378594">(</span><span class="string" id="7378595">&#34;hello&#34;</span><span class="op" id="7378602">)</span><span class="op" id="7378603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378606">}</span><span class="op" id="7378607">)</span><span class="op" id="7378608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378611">defer</span>&nbsp;<span class="ident" id="7378617">ts</span><span class="op" id="7378619">.</span><span class="ident" id="7378620">Close</span><span class="op" id="7378625">(</span><span class="op" id="7378626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378629">res</span><span class="op" id="7378632">,</span>&nbsp;<span class="ident" id="7378634">err</span>&nbsp;<span class="op" id="7378638">:=</span>&nbsp;<span class="ident" id="7378641">http</span><span class="op" id="7378645">.</span><span class="ident" id="7378646">Get</span><span class="op" id="7378649">(</span><span class="ident" id="7378650">ts</span><span class="op" id="7378652">.</span><span class="ident" id="7378653">URL</span><span class="op" id="7378656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378659">if</span>&nbsp;<span class="ident" id="7378662">err</span>&nbsp;<span class="op" id="7378666">!=</span>&nbsp;<span class="ident" id="7378669">nil</span>&nbsp;<span class="op" id="7378673">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378677">t</span><span class="op" id="7378678">.</span><span class="ident" id="7378679">Fatal</span><span class="op" id="7378684">(</span><span class="ident" id="7378685">err</span><span class="op" id="7378688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378694">got</span><span class="op" id="7378697">,</span>&nbsp;<span class="ident" id="7378699">err</span>&nbsp;<span class="op" id="7378703">:=</span>&nbsp;<span class="ident" id="7378706">ioutil</span><span class="op" id="7378712">.</span><span class="ident" id="7378713">ReadAll</span><span class="op" id="7378720">(</span><span class="ident" id="7378721">res</span><span class="op" id="7378724">.</span><span class="ident" id="7378725">Body</span><span class="op" id="7378729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378732">if</span>&nbsp;<span class="ident" id="7378735">err</span>&nbsp;<span class="op" id="7378739">!=</span>&nbsp;<span class="ident" id="7378742">nil</span>&nbsp;<span class="op" id="7378746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378750">t</span><span class="op" id="7378751">.</span><span class="ident" id="7378752">Fatal</span><span class="op" id="7378757">(</span><span class="ident" id="7378758">err</span><span class="op" id="7378761">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378767">if</span>&nbsp;<span class="builtintype" id="7378770">string</span><span class="op" id="7378776">(</span><span class="ident" id="7378777">got</span><span class="op" id="7378780">)</span>&nbsp;<span class="op" id="7378782">!=</span>&nbsp;<span class="string" id="7378785">&#34;hello&#34;</span>&nbsp;<span class="op" id="7378793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378797">t</span><span class="op" id="7378798">.</span><span class="ident" id="7378799">Errorf</span><span class="op" id="7378805">(</span><span class="string" id="7378806">&#34;got&nbsp;%q,&nbsp;want&nbsp;hello&#34;</span><span class="op" id="7378826">,</span>&nbsp;<span class="builtintype" id="7378828">string</span><span class="op" id="7378834">(</span><span class="ident" id="7378835">got</span><span class="op" id="7378838">)</span><span class="op" id="7378839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378842">}</span><br>
<span class="lineno"></span><span class="op" id="7378844">}</span>
</div>
</body>
</html>
