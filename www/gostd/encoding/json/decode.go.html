<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html" class="current">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5325516">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5325571">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5325625">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5325676">//&nbsp;Represents&nbsp;JSON&nbsp;data&nbsp;structure&nbsp;using&nbsp;native&nbsp;Go&nbsp;types:&nbsp;booleans,&nbsp;floats,</span><br>
<span class="lineno"></span><span class="comment" id="5325751">//&nbsp;strings,&nbsp;arrays,&nbsp;and&nbsp;maps.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5325782">package</span>&nbsp;<span class="ident" id="5325790">json</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5325796">import</span>&nbsp;<span class="op" id="5325803">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325806">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325815">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325827">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325846">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325856">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325863">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325874">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325885">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325896">&#34;unicode&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325907">&#34;unicode/utf16&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5325924">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5325939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5325942">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;JSON-encoded&nbsp;data&nbsp;and&nbsp;stores&nbsp;the&nbsp;result</span><br>
<span class="lineno">25</span><span class="comment" id="5326006">//&nbsp;in&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to&nbsp;by&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="5326039">//</span><br>
<span class="lineno"></span><span class="comment" id="5326042">//&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;encodings&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5326094">//&nbsp;Marshal&nbsp;uses,&nbsp;allocating&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;pointers&nbsp;as&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="5326163">//&nbsp;with&nbsp;the&nbsp;following&nbsp;additional&nbsp;rules:</span><br>
<span class="lineno">30</span><span class="comment" id="5326203">//</span><br>
<span class="lineno"></span><span class="comment" id="5326206">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;a&nbsp;pointer,&nbsp;Unmarshal&nbsp;first&nbsp;handles&nbsp;the&nbsp;case&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5326279">//&nbsp;the&nbsp;JSON&nbsp;being&nbsp;the&nbsp;JSON&nbsp;literal&nbsp;null.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;Unmarshal&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="5326350">//&nbsp;the&nbsp;pointer&nbsp;to&nbsp;nil.&nbsp;&nbsp;Otherwise,&nbsp;Unmarshal&nbsp;unmarshals&nbsp;the&nbsp;JSON&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="5326420">//&nbsp;the&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;the&nbsp;pointer.&nbsp;&nbsp;If&nbsp;the&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;Unmarshal</span><br>
<span class="lineno">35</span><span class="comment" id="5326494">//&nbsp;allocates&nbsp;a&nbsp;new&nbsp;value&nbsp;for&nbsp;it&nbsp;to&nbsp;point&nbsp;to.</span><br>
<span class="lineno"></span><span class="comment" id="5326539">//</span><br>
<span class="lineno"></span><span class="comment" id="5326542">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;a&nbsp;struct,&nbsp;Unmarshal&nbsp;matches&nbsp;incoming&nbsp;object</span><br>
<span class="lineno"></span><span class="comment" id="5326612">//&nbsp;keys&nbsp;to&nbsp;the&nbsp;keys&nbsp;used&nbsp;by&nbsp;Marshal&nbsp;(either&nbsp;the&nbsp;struct&nbsp;field&nbsp;name&nbsp;or&nbsp;its&nbsp;tag),</span><br>
<span class="lineno"></span><span class="comment" id="5326691">//&nbsp;preferring&nbsp;an&nbsp;exact&nbsp;match&nbsp;but&nbsp;also&nbsp;accepting&nbsp;a&nbsp;case-insensitive&nbsp;match.</span><br>
<span class="lineno">40</span><span class="comment" id="5326765">//</span><br>
<span class="lineno"></span><span class="comment" id="5326768">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;an&nbsp;interface&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5326814">//&nbsp;Unmarshal&nbsp;stores&nbsp;one&nbsp;of&nbsp;these&nbsp;in&nbsp;the&nbsp;interface&nbsp;value:</span><br>
<span class="lineno"></span><span class="comment" id="5326871">//</span><br>
<span class="lineno"></span><span class="comment" id="5326874">//&nbsp;&nbsp;&nbsp;&nbsp;bool,&nbsp;for&nbsp;JSON&nbsp;booleans</span><br>
<span class="lineno">45</span><span class="comment" id="5326901">//&nbsp;&nbsp;&nbsp;&nbsp;float64,&nbsp;for&nbsp;JSON&nbsp;numbers</span><br>
<span class="lineno"></span><span class="comment" id="5326930">//&nbsp;&nbsp;&nbsp;&nbsp;string,&nbsp;for&nbsp;JSON&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="5326958">//&nbsp;&nbsp;&nbsp;&nbsp;[]interface{},&nbsp;for&nbsp;JSON&nbsp;arrays</span><br>
<span class="lineno"></span><span class="comment" id="5326992">//&nbsp;&nbsp;&nbsp;&nbsp;map[string]interface{},&nbsp;for&nbsp;JSON&nbsp;objects</span><br>
<span class="lineno"></span><span class="comment" id="5327036">//&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;for&nbsp;JSON&nbsp;null</span><br>
<span class="lineno">50</span><span class="comment" id="5327057">//</span><br>
<span class="lineno"></span><span class="comment" id="5327060">//&nbsp;If&nbsp;a&nbsp;JSON&nbsp;value&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;a&nbsp;given&nbsp;target&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="5327123">//&nbsp;or&nbsp;if&nbsp;a&nbsp;JSON&nbsp;number&nbsp;overflows&nbsp;the&nbsp;target&nbsp;type,&nbsp;Unmarshal</span><br>
<span class="lineno"></span><span class="comment" id="5327183">//&nbsp;skips&nbsp;that&nbsp;field&nbsp;and&nbsp;completes&nbsp;the&nbsp;unmarshalling&nbsp;as&nbsp;best&nbsp;it&nbsp;can.</span><br>
<span class="lineno"></span><span class="comment" id="5327251">//&nbsp;If&nbsp;no&nbsp;more&nbsp;serious&nbsp;errors&nbsp;are&nbsp;encountered,&nbsp;Unmarshal&nbsp;returns</span><br>
<span class="lineno">55</span><span class="comment" id="5327315">//&nbsp;an&nbsp;UnmarshalTypeError&nbsp;describing&nbsp;the&nbsp;earliest&nbsp;such&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="5327376">//</span><br>
<span class="lineno"></span><span class="comment" id="5327379">//&nbsp;The&nbsp;JSON&nbsp;null&nbsp;value&nbsp;unmarshals&nbsp;into&nbsp;an&nbsp;interface,&nbsp;map,&nbsp;pointer,&nbsp;or&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="5327455">//&nbsp;by&nbsp;setting&nbsp;that&nbsp;Go&nbsp;value&nbsp;to&nbsp;nil.&nbsp;Because&nbsp;null&nbsp;is&nbsp;often&nbsp;used&nbsp;in&nbsp;JSON&nbsp;to&nbsp;mean</span><br>
<span class="lineno"></span><span class="comment" id="5327534">//&nbsp;``not&nbsp;present,&#39;&#39;&nbsp;unmarshaling&nbsp;a&nbsp;JSON&nbsp;null&nbsp;into&nbsp;any&nbsp;other&nbsp;Go&nbsp;type&nbsp;has&nbsp;no&nbsp;effect</span><br>
<span class="lineno">60</span><span class="comment" id="5327616">//&nbsp;on&nbsp;the&nbsp;value&nbsp;and&nbsp;produces&nbsp;no&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="5327655">//</span><br>
<span class="lineno"></span><span class="comment" id="5327658">//&nbsp;When&nbsp;unmarshaling&nbsp;quoted&nbsp;strings,&nbsp;invalid&nbsp;UTF-8&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5327712">//&nbsp;invalid&nbsp;UTF-16&nbsp;surrogate&nbsp;pairs&nbsp;are&nbsp;not&nbsp;treated&nbsp;as&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="5327775">//&nbsp;Instead,&nbsp;they&nbsp;are&nbsp;replaced&nbsp;by&nbsp;the&nbsp;Unicode&nbsp;replacement</span><br>
<span class="lineno">65</span><span class="comment" id="5327832">//&nbsp;character&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="comment" id="5327853">//</span><br>
<span class="lineno"></span><span class="keyword" id="5327856">func</span>&nbsp;<span class="ident" id="5327861">Unmarshal</span><span class="op" id="5327870">(</span><span class="ident" id="5327871">data</span>&nbsp;<span class="op" id="5327876">[</span><span class="op" id="5327877">]</span><span class="builtintype" id="5327878">byte</span><span class="op" id="5327882">,</span>&nbsp;<span class="ident" id="5327884">v</span>&nbsp;<span class="keyword" id="5327886">interface</span><span class="op" id="5327895">{</span><span class="op" id="5327896">}</span><span class="op" id="5327897">)</span>&nbsp;<span class="builtintype" id="5327899">error</span>&nbsp;<span class="op" id="5327905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5327908">//&nbsp;Check&nbsp;for&nbsp;well-formedness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5327939">//&nbsp;Avoids&nbsp;filling&nbsp;out&nbsp;half&nbsp;a&nbsp;data&nbsp;structure</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5327984">//&nbsp;before&nbsp;discovering&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328028">var</span>&nbsp;<span class="ident" id="5328032">d</span>&nbsp;<span class="ident" id="5328034">decodeState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5328047">err</span>&nbsp;<span class="op" id="5328051">:=</span>&nbsp;<span class="ident" id="5328054">checkValid</span><span class="op" id="5328064">(</span><span class="ident" id="5328065">data</span><span class="op" id="5328069">,</span>&nbsp;<span class="op" id="5328071">&amp;</span><span class="ident" id="5328072">d</span><span class="op" id="5328073">.</span><span class="ident" id="5328074">scan</span><span class="op" id="5328078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328081">if</span>&nbsp;<span class="ident" id="5328084">err</span>&nbsp;<span class="op" id="5328088">!=</span>&nbsp;<span class="builtintype" id="5328091">nil</span>&nbsp;<span class="op" id="5328095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328099">return</span>&nbsp;<span class="ident" id="5328106">err</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5328111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5328115">d</span><span class="op" id="5328116">.</span><span class="ident" id="5328117">init</span><span class="op" id="5328121">(</span><span class="ident" id="5328122">data</span><span class="op" id="5328126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328129">return</span>&nbsp;<span class="ident" id="5328136">d</span><span class="op" id="5328137">.</span><span class="ident" id="5328138">unmarshal</span><span class="op" id="5328147">(</span><span class="ident" id="5328148">v</span><span class="op" id="5328149">)</span><br>
<span class="lineno"></span><span class="op" id="5328151">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5328154">//&nbsp;Unmarshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects</span><br>
<span class="lineno"></span><span class="comment" id="5328209">//&nbsp;that&nbsp;can&nbsp;unmarshal&nbsp;a&nbsp;JSON&nbsp;description&nbsp;of&nbsp;themselves.</span><br>
<span class="lineno"></span><span class="comment" id="5328265">//&nbsp;The&nbsp;input&nbsp;can&nbsp;be&nbsp;assumed&nbsp;to&nbsp;be&nbsp;a&nbsp;valid&nbsp;encoding&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5328319">//&nbsp;a&nbsp;JSON&nbsp;value.&nbsp;UnmarshalJSON&nbsp;must&nbsp;copy&nbsp;the&nbsp;JSON&nbsp;data</span><br>
<span class="lineno">85</span><span class="comment" id="5328374">//&nbsp;if&nbsp;it&nbsp;wishes&nbsp;to&nbsp;retain&nbsp;the&nbsp;data&nbsp;after&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="5328426">type</span>&nbsp;<span class="ident" id="5328431">Unmarshaler</span>&nbsp;<span class="keyword" id="5328443">interface</span>&nbsp;<span class="op" id="5328453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5328456">UnmarshalJSON</span><span class="op" id="5328469">(</span><span class="op" id="5328470">[</span><span class="op" id="5328471">]</span><span class="builtintype" id="5328472">byte</span><span class="op" id="5328476">)</span>&nbsp;<span class="builtintype" id="5328478">error</span><br>
<span class="lineno"></span><span class="op" id="5328484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5328487">//&nbsp;An&nbsp;UnmarshalTypeError&nbsp;describes&nbsp;a&nbsp;JSON&nbsp;value&nbsp;that&nbsp;was</span><br>
<span class="lineno"></span><span class="comment" id="5328544">//&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;a&nbsp;value&nbsp;of&nbsp;a&nbsp;specific&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5328598">type</span>&nbsp;<span class="ident" id="5328603">UnmarshalTypeError</span>&nbsp;<span class="keyword" id="5328622">struct</span>&nbsp;<span class="op" id="5328629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5328632">Value</span>&nbsp;<span class="builtintype" id="5328638">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5328651">//&nbsp;description&nbsp;of&nbsp;JSON&nbsp;value&nbsp;-&nbsp;&#34;bool&#34;,&nbsp;&#34;array&#34;,&nbsp;&#34;number&nbsp;-5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5328712">Type</span>&nbsp;&nbsp;<span class="ident" id="5328718">reflect</span><span class="op" id="5328725">.</span><span class="ident" id="5328726">Type</span>&nbsp;<span class="comment" id="5328731">//&nbsp;type&nbsp;of&nbsp;Go&nbsp;value&nbsp;it&nbsp;could&nbsp;not&nbsp;be&nbsp;assigned&nbsp;to</span><br>
<span class="lineno">95</span><span class="op" id="5328779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328782">func</span>&nbsp;<span class="op" id="5328787">(</span><span class="ident" id="5328788">e</span>&nbsp;<span class="op" id="5328790">*</span><span class="ident" id="5328791">UnmarshalTypeError</span><span class="op" id="5328809">)</span>&nbsp;<span class="ident" id="5328811">Error</span><span class="op" id="5328816">(</span><span class="op" id="5328817">)</span>&nbsp;<span class="builtintype" id="5328819">string</span>&nbsp;<span class="op" id="5328826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5328829">return</span>&nbsp;<span class="string" id="5328836">&#34;json:&nbsp;cannot&nbsp;unmarshal&nbsp;&#34;</span>&nbsp;<span class="op" id="5328862">+</span>&nbsp;<span class="ident" id="5328864">e</span><span class="op" id="5328865">.</span><span class="ident" id="5328866">Value</span>&nbsp;<span class="op" id="5328872">+</span>&nbsp;<span class="string" id="5328874">&#34;&nbsp;into&nbsp;Go&nbsp;value&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="5328900">+</span>&nbsp;<span class="ident" id="5328902">e</span><span class="op" id="5328903">.</span><span class="ident" id="5328904">Type</span><span class="op" id="5328908">.</span><span class="ident" id="5328909">String</span><span class="op" id="5328915">(</span><span class="op" id="5328916">)</span><br>
<span class="lineno"></span><span class="op" id="5328918">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5328921">//&nbsp;An&nbsp;UnmarshalFieldError&nbsp;describes&nbsp;a&nbsp;JSON&nbsp;object&nbsp;key&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5328980">//&nbsp;led&nbsp;to&nbsp;an&nbsp;unexported&nbsp;(and&nbsp;therefore&nbsp;unwritable)&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="5329045">//&nbsp;(No&nbsp;longer&nbsp;used;&nbsp;kept&nbsp;for&nbsp;compatibility.)</span><br>
<span class="lineno"></span><span class="keyword" id="5329090">type</span>&nbsp;<span class="ident" id="5329095">UnmarshalFieldError</span>&nbsp;<span class="keyword" id="5329115">struct</span>&nbsp;<span class="op" id="5329122">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5329125">Key</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5329131">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5329139">Type</span>&nbsp;&nbsp;<span class="ident" id="5329145">reflect</span><span class="op" id="5329152">.</span><span class="ident" id="5329153">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5329159">Field</span>&nbsp;<span class="ident" id="5329165">reflect</span><span class="op" id="5329172">.</span><span class="ident" id="5329173">StructField</span><br>
<span class="lineno"></span><span class="op" id="5329185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="5329188">func</span>&nbsp;<span class="op" id="5329193">(</span><span class="ident" id="5329194">e</span>&nbsp;<span class="op" id="5329196">*</span><span class="ident" id="5329197">UnmarshalFieldError</span><span class="op" id="5329216">)</span>&nbsp;<span class="ident" id="5329218">Error</span><span class="op" id="5329223">(</span><span class="op" id="5329224">)</span>&nbsp;<span class="builtintype" id="5329226">string</span>&nbsp;<span class="op" id="5329233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329236">return</span>&nbsp;<span class="string" id="5329243">&#34;json:&nbsp;cannot&nbsp;unmarshal&nbsp;object&nbsp;key&nbsp;&#34;</span>&nbsp;<span class="op" id="5329280">+</span>&nbsp;<span class="ident" id="5329282">strconv</span><span class="op" id="5329289">.</span><span class="ident" id="5329290">Quote</span><span class="op" id="5329295">(</span><span class="ident" id="5329296">e</span><span class="op" id="5329297">.</span><span class="ident" id="5329298">Key</span><span class="op" id="5329301">)</span>&nbsp;<span class="op" id="5329303">+</span>&nbsp;<span class="string" id="5329305">&#34;&nbsp;into&nbsp;unexported&nbsp;field&nbsp;&#34;</span>&nbsp;<span class="op" id="5329331">+</span>&nbsp;<span class="ident" id="5329333">e</span><span class="op" id="5329334">.</span><span class="ident" id="5329335">Field</span><span class="op" id="5329340">.</span><span class="ident" id="5329341">Name</span>&nbsp;<span class="op" id="5329346">+</span>&nbsp;<span class="string" id="5329348">&#34;&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="5329360">+</span>&nbsp;<span class="ident" id="5329362">e</span><span class="op" id="5329363">.</span><span class="ident" id="5329364">Type</span><span class="op" id="5329368">.</span><span class="ident" id="5329369">String</span><span class="op" id="5329375">(</span><span class="op" id="5329376">)</span><br>
<span class="lineno"></span><span class="op" id="5329378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5329381">//&nbsp;An&nbsp;InvalidUnmarshalError&nbsp;describes&nbsp;an&nbsp;invalid&nbsp;argument&nbsp;passed&nbsp;to&nbsp;Unmarshal.</span><br>
<span class="lineno">115</span><span class="comment" id="5329460">//&nbsp;(The&nbsp;argument&nbsp;to&nbsp;Unmarshal&nbsp;must&nbsp;be&nbsp;a&nbsp;non-nil&nbsp;pointer.)</span><br>
<span class="lineno"></span><span class="keyword" id="5329518">type</span>&nbsp;<span class="ident" id="5329523">InvalidUnmarshalError</span>&nbsp;<span class="keyword" id="5329545">struct</span>&nbsp;<span class="op" id="5329552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5329555">Type</span>&nbsp;<span class="ident" id="5329560">reflect</span><span class="op" id="5329567">.</span><span class="ident" id="5329568">Type</span><br>
<span class="lineno"></span><span class="op" id="5329573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="5329576">func</span>&nbsp;<span class="op" id="5329581">(</span><span class="ident" id="5329582">e</span>&nbsp;<span class="op" id="5329584">*</span><span class="ident" id="5329585">InvalidUnmarshalError</span><span class="op" id="5329606">)</span>&nbsp;<span class="ident" id="5329608">Error</span><span class="op" id="5329613">(</span><span class="op" id="5329614">)</span>&nbsp;<span class="builtintype" id="5329616">string</span>&nbsp;<span class="op" id="5329623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329626">if</span>&nbsp;<span class="ident" id="5329629">e</span><span class="op" id="5329630">.</span><span class="ident" id="5329631">Type</span>&nbsp;<span class="op" id="5329636">==</span>&nbsp;<span class="builtintype" id="5329639">nil</span>&nbsp;<span class="op" id="5329643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329647">return</span>&nbsp;<span class="string" id="5329654">&#34;json:&nbsp;Unmarshal(nil)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5329678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329682">if</span>&nbsp;<span class="ident" id="5329685">e</span><span class="op" id="5329686">.</span><span class="ident" id="5329687">Type</span><span class="op" id="5329691">.</span><span class="ident" id="5329692">Kind</span><span class="op" id="5329696">(</span><span class="op" id="5329697">)</span>&nbsp;<span class="op" id="5329699">!=</span>&nbsp;<span class="ident" id="5329702">reflect</span><span class="op" id="5329709">.</span><span class="ident" id="5329710">Ptr</span>&nbsp;<span class="op" id="5329714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329718">return</span>&nbsp;<span class="string" id="5329725">&#34;json:&nbsp;Unmarshal(non-pointer&nbsp;&#34;</span>&nbsp;<span class="op" id="5329756">+</span>&nbsp;<span class="ident" id="5329758">e</span><span class="op" id="5329759">.</span><span class="ident" id="5329760">Type</span><span class="op" id="5329764">.</span><span class="ident" id="5329765">String</span><span class="op" id="5329771">(</span><span class="op" id="5329772">)</span>&nbsp;<span class="op" id="5329774">+</span>&nbsp;<span class="string" id="5329776">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5329781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329784">return</span>&nbsp;<span class="string" id="5329791">&#34;json:&nbsp;Unmarshal(nil&nbsp;&#34;</span>&nbsp;<span class="op" id="5329814">+</span>&nbsp;<span class="ident" id="5329816">e</span><span class="op" id="5329817">.</span><span class="ident" id="5329818">Type</span><span class="op" id="5329822">.</span><span class="ident" id="5329823">String</span><span class="op" id="5329829">(</span><span class="op" id="5329830">)</span>&nbsp;<span class="op" id="5329832">+</span>&nbsp;<span class="string" id="5329834">&#34;)&#34;</span><br>
<span class="lineno"></span><span class="op" id="5329838">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="5329841">func</span>&nbsp;<span class="op" id="5329846">(</span><span class="ident" id="5329847">d</span>&nbsp;<span class="op" id="5329849">*</span><span class="ident" id="5329850">decodeState</span><span class="op" id="5329861">)</span>&nbsp;<span class="ident" id="5329863">unmarshal</span><span class="op" id="5329872">(</span><span class="ident" id="5329873">v</span>&nbsp;<span class="keyword" id="5329875">interface</span><span class="op" id="5329884">{</span><span class="op" id="5329885">}</span><span class="op" id="5329886">)</span>&nbsp;<span class="op" id="5329888">(</span><span class="ident" id="5329889">err</span>&nbsp;<span class="builtintype" id="5329893">error</span><span class="op" id="5329898">)</span>&nbsp;<span class="op" id="5329900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329903">defer</span>&nbsp;<span class="keyword" id="5329909">func</span><span class="op" id="5329913">(</span><span class="op" id="5329914">)</span>&nbsp;<span class="op" id="5329916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329920">if</span>&nbsp;<span class="ident" id="5329923">r</span>&nbsp;<span class="op" id="5329925">:=</span>&nbsp;<span class="builtinfunc" id="5329928">recover</span><span class="op" id="5329935">(</span><span class="op" id="5329936">)</span><span class="op" id="5329937">;</span>&nbsp;<span class="ident" id="5329939">r</span>&nbsp;<span class="op" id="5329941">!=</span>&nbsp;<span class="builtintype" id="5329944">nil</span>&nbsp;<span class="op" id="5329948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5329953">if</span>&nbsp;<span class="ident" id="5329956">_</span><span class="op" id="5329957">,</span>&nbsp;<span class="ident" id="5329959">ok</span>&nbsp;<span class="op" id="5329962">:=</span>&nbsp;<span class="ident" id="5329965">r</span><span class="op" id="5329966">.</span><span class="op" id="5329967">(</span><span class="ident" id="5329968">runtime</span><span class="op" id="5329975">.</span><span class="ident" id="5329976">Error</span><span class="op" id="5329981">)</span><span class="op" id="5329982">;</span>&nbsp;<span class="ident" id="5329984">ok</span>&nbsp;<span class="op" id="5329987">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5329993">panic</span><span class="op" id="5329998">(</span><span class="ident" id="5329999">r</span><span class="op" id="5330000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5330005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330010">err</span>&nbsp;<span class="op" id="5330014">=</span>&nbsp;<span class="ident" id="5330016">r</span><span class="op" id="5330017">.</span><span class="op" id="5330018">(</span><span class="builtintype" id="5330019">error</span><span class="op" id="5330024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5330028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5330031">}</span><span class="op" id="5330032">(</span><span class="op" id="5330033">)</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330037">rv</span>&nbsp;<span class="op" id="5330040">:=</span>&nbsp;<span class="ident" id="5330043">reflect</span><span class="op" id="5330050">.</span><span class="ident" id="5330051">ValueOf</span><span class="op" id="5330058">(</span><span class="ident" id="5330059">v</span><span class="op" id="5330060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5330063">if</span>&nbsp;<span class="ident" id="5330066">rv</span><span class="op" id="5330068">.</span><span class="ident" id="5330069">Kind</span><span class="op" id="5330073">(</span><span class="op" id="5330074">)</span>&nbsp;<span class="op" id="5330076">!=</span>&nbsp;<span class="ident" id="5330079">reflect</span><span class="op" id="5330086">.</span><span class="ident" id="5330087">Ptr</span>&nbsp;<span class="op" id="5330091">||</span>&nbsp;<span class="ident" id="5330094">rv</span><span class="op" id="5330096">.</span><span class="ident" id="5330097">IsNil</span><span class="op" id="5330102">(</span><span class="op" id="5330103">)</span>&nbsp;<span class="op" id="5330105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5330109">return</span>&nbsp;<span class="op" id="5330116">&amp;</span><span class="ident" id="5330117">InvalidUnmarshalError</span><span class="op" id="5330138">{</span><span class="ident" id="5330139">reflect</span><span class="op" id="5330146">.</span><span class="ident" id="5330147">TypeOf</span><span class="op" id="5330153">(</span><span class="ident" id="5330154">v</span><span class="op" id="5330155">)</span><span class="op" id="5330156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5330159">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330163">d</span><span class="op" id="5330164">.</span><span class="ident" id="5330165">scan</span><span class="op" id="5330169">.</span><span class="ident" id="5330170">reset</span><span class="op" id="5330175">(</span><span class="op" id="5330176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5330179">//&nbsp;We&nbsp;decode&nbsp;rv&nbsp;not&nbsp;rv.Elem&nbsp;because&nbsp;the&nbsp;Unmarshaler&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5330242">//&nbsp;test&nbsp;must&nbsp;be&nbsp;applied&nbsp;at&nbsp;the&nbsp;top&nbsp;level&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330298">d</span><span class="op" id="5330299">.</span><span class="ident" id="5330300">value</span><span class="op" id="5330305">(</span><span class="ident" id="5330306">rv</span><span class="op" id="5330308">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5330311">return</span>&nbsp;<span class="ident" id="5330318">d</span><span class="op" id="5330319">.</span><span class="ident" id="5330320">savedError</span><br>
<span class="lineno"></span><span class="op" id="5330331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5330334">//&nbsp;A&nbsp;Number&nbsp;represents&nbsp;a&nbsp;JSON&nbsp;number&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="5330380">type</span>&nbsp;<span class="ident" id="5330385">Number</span>&nbsp;<span class="builtintype" id="5330392">string</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5330400">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;literal&nbsp;text&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5330450">func</span>&nbsp;<span class="op" id="5330455">(</span><span class="ident" id="5330456">n</span>&nbsp;<span class="ident" id="5330458">Number</span><span class="op" id="5330464">)</span>&nbsp;<span class="ident" id="5330466">String</span><span class="op" id="5330472">(</span><span class="op" id="5330473">)</span>&nbsp;<span class="builtintype" id="5330475">string</span>&nbsp;<span class="op" id="5330482">{</span>&nbsp;<span class="keyword" id="5330484">return</span>&nbsp;<span class="builtintype" id="5330491">string</span><span class="op" id="5330497">(</span><span class="ident" id="5330498">n</span><span class="op" id="5330499">)</span>&nbsp;<span class="op" id="5330501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5330504">//&nbsp;Float64&nbsp;returns&nbsp;the&nbsp;number&nbsp;as&nbsp;a&nbsp;float64.</span><br>
<span class="lineno">160</span><span class="keyword" id="5330548">func</span>&nbsp;<span class="op" id="5330553">(</span><span class="ident" id="5330554">n</span>&nbsp;<span class="ident" id="5330556">Number</span><span class="op" id="5330562">)</span>&nbsp;<span class="ident" id="5330564">Float64</span><span class="op" id="5330571">(</span><span class="op" id="5330572">)</span>&nbsp;<span class="op" id="5330574">(</span><span class="builtintype" id="5330575">float64</span><span class="op" id="5330582">,</span>&nbsp;<span class="builtintype" id="5330584">error</span><span class="op" id="5330589">)</span>&nbsp;<span class="op" id="5330591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5330594">return</span>&nbsp;<span class="ident" id="5330601">strconv</span><span class="op" id="5330608">.</span><span class="ident" id="5330609">ParseFloat</span><span class="op" id="5330619">(</span><span class="builtintype" id="5330620">string</span><span class="op" id="5330626">(</span><span class="ident" id="5330627">n</span><span class="op" id="5330628">)</span><span class="op" id="5330629">,</span>&nbsp;<span class="num" id="5330631">64</span><span class="op" id="5330633">)</span><br>
<span class="lineno"></span><span class="op" id="5330635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5330638">//&nbsp;Int64&nbsp;returns&nbsp;the&nbsp;number&nbsp;as&nbsp;an&nbsp;int64.</span><br>
<span class="lineno">165</span><span class="keyword" id="5330679">func</span>&nbsp;<span class="op" id="5330684">(</span><span class="ident" id="5330685">n</span>&nbsp;<span class="ident" id="5330687">Number</span><span class="op" id="5330693">)</span>&nbsp;<span class="ident" id="5330695">Int64</span><span class="op" id="5330700">(</span><span class="op" id="5330701">)</span>&nbsp;<span class="op" id="5330703">(</span><span class="ident" id="5330704">int64</span><span class="op" id="5330709">,</span>&nbsp;<span class="builtintype" id="5330711">error</span><span class="op" id="5330716">)</span>&nbsp;<span class="op" id="5330718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5330721">return</span>&nbsp;<span class="ident" id="5330728">strconv</span><span class="op" id="5330735">.</span><span class="ident" id="5330736">ParseInt</span><span class="op" id="5330744">(</span><span class="builtintype" id="5330745">string</span><span class="op" id="5330751">(</span><span class="ident" id="5330752">n</span><span class="op" id="5330753">)</span><span class="op" id="5330754">,</span>&nbsp;<span class="num" id="5330756">10</span><span class="op" id="5330758">,</span>&nbsp;<span class="num" id="5330760">64</span><span class="op" id="5330762">)</span><br>
<span class="lineno"></span><span class="op" id="5330764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5330767">//&nbsp;decodeState&nbsp;represents&nbsp;the&nbsp;state&nbsp;while&nbsp;decoding&nbsp;a&nbsp;JSON&nbsp;value.</span><br>
<span class="lineno">170</span><span class="keyword" id="5330832">type</span>&nbsp;<span class="ident" id="5330837">decodeState</span>&nbsp;<span class="keyword" id="5330849">struct</span>&nbsp;<span class="op" id="5330856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330859">data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5330870">[</span><span class="op" id="5330871">]</span><span class="builtintype" id="5330872">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330878">off</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5330889">int</span>&nbsp;<span class="comment" id="5330893">//&nbsp;read&nbsp;offset&nbsp;in&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330917">scan</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330928">scanner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330937">nextscan</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5330948">scanner</span>&nbsp;<span class="comment" id="5330956">//&nbsp;for&nbsp;calls&nbsp;to&nbsp;nextValue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5330983">savedError</span>&nbsp;<span class="builtintype" id="5330994">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331001">useNumber</span>&nbsp;&nbsp;<span class="builtintype" id="5331012">bool</span><br>
<span class="lineno"></span><span class="op" id="5331017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5331020">//&nbsp;errPhase&nbsp;is&nbsp;used&nbsp;for&nbsp;errors&nbsp;that&nbsp;should&nbsp;not&nbsp;happen&nbsp;unless</span><br>
<span class="lineno">180</span><span class="comment" id="5331081">//&nbsp;there&nbsp;is&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&nbsp;JSON&nbsp;decoder&nbsp;or&nbsp;something&nbsp;is&nbsp;editing</span><br>
<span class="lineno"></span><span class="comment" id="5331143">//&nbsp;the&nbsp;data&nbsp;slice&nbsp;while&nbsp;the&nbsp;decoder&nbsp;executes.</span><br>
<span class="lineno"></span><span class="keyword" id="5331189">var</span>&nbsp;<span class="ident" id="5331193">errPhase</span>&nbsp;<span class="op" id="5331202">=</span>&nbsp;<span class="ident" id="5331204">errors</span><span class="op" id="5331210">.</span><span class="ident" id="5331211">New</span><span class="op" id="5331214">(</span><span class="string" id="5331215">&#34;JSON&nbsp;decoder&nbsp;out&nbsp;of&nbsp;sync&nbsp;-&nbsp;data&nbsp;changing&nbsp;underfoot?&#34;</span><span class="op" id="5331268">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5331271">func</span>&nbsp;<span class="op" id="5331276">(</span><span class="ident" id="5331277">d</span>&nbsp;<span class="op" id="5331279">*</span><span class="ident" id="5331280">decodeState</span><span class="op" id="5331291">)</span>&nbsp;<span class="ident" id="5331293">init</span><span class="op" id="5331297">(</span><span class="ident" id="5331298">data</span>&nbsp;<span class="op" id="5331303">[</span><span class="op" id="5331304">]</span><span class="builtintype" id="5331305">byte</span><span class="op" id="5331309">)</span>&nbsp;<span class="op" id="5331311">*</span><span class="ident" id="5331312">decodeState</span>&nbsp;<span class="op" id="5331324">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331327">d</span><span class="op" id="5331328">.</span><span class="ident" id="5331329">data</span>&nbsp;<span class="op" id="5331334">=</span>&nbsp;<span class="ident" id="5331336">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331342">d</span><span class="op" id="5331343">.</span><span class="ident" id="5331344">off</span>&nbsp;<span class="op" id="5331348">=</span>&nbsp;<span class="num" id="5331350">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331353">d</span><span class="op" id="5331354">.</span><span class="ident" id="5331355">savedError</span>&nbsp;<span class="op" id="5331366">=</span>&nbsp;<span class="builtintype" id="5331368">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5331373">return</span>&nbsp;<span class="ident" id="5331380">d</span><br>
<span class="lineno"></span><span class="op" id="5331382">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5331385">//&nbsp;error&nbsp;aborts&nbsp;the&nbsp;decoding&nbsp;by&nbsp;panicking&nbsp;with&nbsp;err.</span><br>
<span class="lineno"></span><span class="keyword" id="5331437">func</span>&nbsp;<span class="op" id="5331442">(</span><span class="ident" id="5331443">d</span>&nbsp;<span class="op" id="5331445">*</span><span class="ident" id="5331446">decodeState</span><span class="op" id="5331457">)</span>&nbsp;<span class="builtintype" id="5331459">error</span><span class="op" id="5331464">(</span><span class="ident" id="5331465">err</span>&nbsp;<span class="builtintype" id="5331469">error</span><span class="op" id="5331474">)</span>&nbsp;<span class="op" id="5331476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5331479">panic</span><span class="op" id="5331484">(</span><span class="ident" id="5331485">err</span><span class="op" id="5331488">)</span><br>
<span class="lineno"></span><span class="op" id="5331490">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="5331493">//&nbsp;saveError&nbsp;saves&nbsp;the&nbsp;first&nbsp;err&nbsp;it&nbsp;is&nbsp;called&nbsp;with,</span><br>
<span class="lineno"></span><span class="comment" id="5331545">//&nbsp;for&nbsp;reporting&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;unmarshal.</span><br>
<span class="lineno"></span><span class="keyword" id="5331591">func</span>&nbsp;<span class="op" id="5331596">(</span><span class="ident" id="5331597">d</span>&nbsp;<span class="op" id="5331599">*</span><span class="ident" id="5331600">decodeState</span><span class="op" id="5331611">)</span>&nbsp;<span class="ident" id="5331613">saveError</span><span class="op" id="5331622">(</span><span class="ident" id="5331623">err</span>&nbsp;<span class="builtintype" id="5331627">error</span><span class="op" id="5331632">)</span>&nbsp;<span class="op" id="5331634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5331637">if</span>&nbsp;<span class="ident" id="5331640">d</span><span class="op" id="5331641">.</span><span class="ident" id="5331642">savedError</span>&nbsp;<span class="op" id="5331653">==</span>&nbsp;<span class="builtintype" id="5331656">nil</span>&nbsp;<span class="op" id="5331660">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331664">d</span><span class="op" id="5331665">.</span><span class="ident" id="5331666">savedError</span>&nbsp;<span class="op" id="5331677">=</span>&nbsp;<span class="ident" id="5331679">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5331684">}</span><br>
<span class="lineno"></span><span class="op" id="5331686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5331689">//&nbsp;next&nbsp;cuts&nbsp;off&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;full&nbsp;JSON&nbsp;value&nbsp;in&nbsp;d.data[d.off:].</span><br>
<span class="lineno">205</span><span class="comment" id="5331762">//&nbsp;The&nbsp;next&nbsp;value&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;an&nbsp;object&nbsp;or&nbsp;array,&nbsp;not&nbsp;a&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="5331830">func</span>&nbsp;<span class="op" id="5331835">(</span><span class="ident" id="5331836">d</span>&nbsp;<span class="op" id="5331838">*</span><span class="ident" id="5331839">decodeState</span><span class="op" id="5331850">)</span>&nbsp;<span class="ident" id="5331852">next</span><span class="op" id="5331856">(</span><span class="op" id="5331857">)</span>&nbsp;<span class="op" id="5331859">[</span><span class="op" id="5331860">]</span><span class="builtintype" id="5331861">byte</span>&nbsp;<span class="op" id="5331866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331869">c</span>&nbsp;<span class="op" id="5331871">:=</span>&nbsp;<span class="ident" id="5331874">d</span><span class="op" id="5331875">.</span><span class="ident" id="5331876">data</span><span class="op" id="5331880">[</span><span class="ident" id="5331881">d</span><span class="op" id="5331882">.</span><span class="ident" id="5331883">off</span><span class="op" id="5331886">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331889">item</span><span class="op" id="5331893">,</span>&nbsp;<span class="ident" id="5331895">rest</span><span class="op" id="5331899">,</span>&nbsp;<span class="ident" id="5331901">err</span>&nbsp;<span class="op" id="5331905">:=</span>&nbsp;<span class="ident" id="5331908">nextValue</span><span class="op" id="5331917">(</span><span class="ident" id="5331918">d</span><span class="op" id="5331919">.</span><span class="ident" id="5331920">data</span><span class="op" id="5331924">[</span><span class="ident" id="5331925">d</span><span class="op" id="5331926">.</span><span class="ident" id="5331927">off</span><span class="op" id="5331930">:</span><span class="op" id="5331931">]</span><span class="op" id="5331932">,</span>&nbsp;<span class="op" id="5331934">&amp;</span><span class="ident" id="5331935">d</span><span class="op" id="5331936">.</span><span class="ident" id="5331937">nextscan</span><span class="op" id="5331945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5331948">if</span>&nbsp;<span class="ident" id="5331951">err</span>&nbsp;<span class="op" id="5331955">!=</span>&nbsp;<span class="builtintype" id="5331958">nil</span>&nbsp;<span class="op" id="5331962">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331966">d</span><span class="op" id="5331967">.</span><span class="builtintype" id="5331968">error</span><span class="op" id="5331973">(</span><span class="ident" id="5331974">err</span><span class="op" id="5331977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5331980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5331983">d</span><span class="op" id="5331984">.</span><span class="ident" id="5331985">off</span>&nbsp;<span class="op" id="5331989">=</span>&nbsp;<span class="builtinfunc" id="5331991">len</span><span class="op" id="5331994">(</span><span class="ident" id="5331995">d</span><span class="op" id="5331996">.</span><span class="ident" id="5331997">data</span><span class="op" id="5332001">)</span>&nbsp;<span class="op" id="5332003">-</span>&nbsp;<span class="builtinfunc" id="5332005">len</span><span class="op" id="5332008">(</span><span class="ident" id="5332009">rest</span><span class="op" id="5332013">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5332017">//&nbsp;Our&nbsp;scanner&nbsp;has&nbsp;seen&nbsp;the&nbsp;opening&nbsp;brace/bracket</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5332068">//&nbsp;and&nbsp;thinks&nbsp;we&#39;re&nbsp;still&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;the&nbsp;object.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5332124">//&nbsp;invent&nbsp;a&nbsp;closing&nbsp;brace/bracket&nbsp;to&nbsp;get&nbsp;it&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332174">if</span>&nbsp;<span class="ident" id="5332177">c</span>&nbsp;<span class="op" id="5332179">==</span>&nbsp;<span class="string" id="5332182">&#39;{&#39;</span>&nbsp;<span class="op" id="5332186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5332190">d</span><span class="op" id="5332191">.</span><span class="ident" id="5332192">scan</span><span class="op" id="5332196">.</span><span class="ident" id="5332197">step</span><span class="op" id="5332201">(</span><span class="op" id="5332202">&amp;</span><span class="ident" id="5332203">d</span><span class="op" id="5332204">.</span><span class="ident" id="5332205">scan</span><span class="op" id="5332209">,</span>&nbsp;<span class="string" id="5332211">&#39;}&#39;</span><span class="op" id="5332214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5332217">}</span>&nbsp;<span class="keyword" id="5332219">else</span>&nbsp;<span class="op" id="5332224">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5332228">d</span><span class="op" id="5332229">.</span><span class="ident" id="5332230">scan</span><span class="op" id="5332234">.</span><span class="ident" id="5332235">step</span><span class="op" id="5332239">(</span><span class="op" id="5332240">&amp;</span><span class="ident" id="5332241">d</span><span class="op" id="5332242">.</span><span class="ident" id="5332243">scan</span><span class="op" id="5332247">,</span>&nbsp;<span class="string" id="5332249">&#39;]&#39;</span><span class="op" id="5332252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5332255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332259">return</span>&nbsp;<span class="ident" id="5332266">item</span><br>
<span class="lineno"></span><span class="op" id="5332271">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="5332274">//&nbsp;scanWhile&nbsp;processes&nbsp;bytes&nbsp;in&nbsp;d.data[d.off:]&nbsp;until&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5332330">//&nbsp;receives&nbsp;a&nbsp;scan&nbsp;code&nbsp;not&nbsp;equal&nbsp;to&nbsp;op.</span><br>
<span class="lineno"></span><span class="comment" id="5332371">//&nbsp;It&nbsp;updates&nbsp;d.off&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;scan&nbsp;code.</span><br>
<span class="lineno"></span><span class="keyword" id="5332422">func</span>&nbsp;<span class="op" id="5332427">(</span><span class="ident" id="5332428">d</span>&nbsp;<span class="op" id="5332430">*</span><span class="ident" id="5332431">decodeState</span><span class="op" id="5332442">)</span>&nbsp;<span class="ident" id="5332444">scanWhile</span><span class="op" id="5332453">(</span><span class="ident" id="5332454">op</span>&nbsp;<span class="builtintype" id="5332457">int</span><span class="op" id="5332460">)</span>&nbsp;<span class="builtintype" id="5332462">int</span>&nbsp;<span class="op" id="5332466">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332469">var</span>&nbsp;<span class="ident" id="5332473">newOp</span>&nbsp;<span class="builtintype" id="5332479">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332484">for</span>&nbsp;<span class="op" id="5332488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332492">if</span>&nbsp;<span class="ident" id="5332495">d</span><span class="op" id="5332496">.</span><span class="ident" id="5332497">off</span>&nbsp;<span class="op" id="5332501">&gt;=</span>&nbsp;<span class="builtinfunc" id="5332504">len</span><span class="op" id="5332507">(</span><span class="ident" id="5332508">d</span><span class="op" id="5332509">.</span><span class="ident" id="5332510">data</span><span class="op" id="5332514">)</span>&nbsp;<span class="op" id="5332516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5332521">newOp</span>&nbsp;<span class="op" id="5332527">=</span>&nbsp;<span class="ident" id="5332529">d</span><span class="op" id="5332530">.</span><span class="ident" id="5332531">scan</span><span class="op" id="5332535">.</span><span class="ident" id="5332536">eof</span><span class="op" id="5332539">(</span><span class="op" id="5332540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5332545">d</span><span class="op" id="5332546">.</span><span class="ident" id="5332547">off</span>&nbsp;<span class="op" id="5332551">=</span>&nbsp;<span class="builtinfunc" id="5332553">len</span><span class="op" id="5332556">(</span><span class="ident" id="5332557">d</span><span class="op" id="5332558">.</span><span class="ident" id="5332559">data</span><span class="op" id="5332563">)</span>&nbsp;<span class="op" id="5332565">+</span>&nbsp;<span class="num" id="5332567">1</span>&nbsp;<span class="comment" id="5332569">//&nbsp;mark&nbsp;processed&nbsp;EOF&nbsp;with&nbsp;len+1</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5332604">}</span>&nbsp;<span class="keyword" id="5332606">else</span>&nbsp;<span class="op" id="5332611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5332616">c</span>&nbsp;<span class="op" id="5332618">:=</span>&nbsp;<span class="builtintype" id="5332621">int</span><span class="op" id="5332624">(</span><span class="ident" id="5332625">d</span><span class="op" id="5332626">.</span><span class="ident" id="5332627">data</span><span class="op" id="5332631">[</span><span class="ident" id="5332632">d</span><span class="op" id="5332633">.</span><span class="ident" id="5332634">off</span><span class="op" id="5332637">]</span><span class="op" id="5332638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5332643">d</span><span class="op" id="5332644">.</span><span class="ident" id="5332645">off</span><span class="op" id="5332648">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5332654">newOp</span>&nbsp;<span class="op" id="5332660">=</span>&nbsp;<span class="ident" id="5332662">d</span><span class="op" id="5332663">.</span><span class="ident" id="5332664">scan</span><span class="op" id="5332668">.</span><span class="ident" id="5332669">step</span><span class="op" id="5332673">(</span><span class="op" id="5332674">&amp;</span><span class="ident" id="5332675">d</span><span class="op" id="5332676">.</span><span class="ident" id="5332677">scan</span><span class="op" id="5332681">,</span>&nbsp;<span class="ident" id="5332683">c</span><span class="op" id="5332684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5332688">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332692">if</span>&nbsp;<span class="ident" id="5332695">newOp</span>&nbsp;<span class="op" id="5332701">!=</span>&nbsp;<span class="ident" id="5332704">op</span>&nbsp;<span class="op" id="5332707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332712">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5332720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5332723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332726">return</span>&nbsp;<span class="ident" id="5332733">newOp</span><br>
<span class="lineno">245</span><span class="op" id="5332739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5332742">//&nbsp;value&nbsp;decodes&nbsp;a&nbsp;JSON&nbsp;value&nbsp;from&nbsp;d.data[d.off:]&nbsp;into&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5332808">//&nbsp;it&nbsp;updates&nbsp;d.off&nbsp;to&nbsp;point&nbsp;past&nbsp;the&nbsp;decoded&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5332861">func</span>&nbsp;<span class="op" id="5332866">(</span><span class="ident" id="5332867">d</span>&nbsp;<span class="op" id="5332869">*</span><span class="ident" id="5332870">decodeState</span><span class="op" id="5332881">)</span>&nbsp;<span class="ident" id="5332883">value</span><span class="op" id="5332888">(</span><span class="ident" id="5332889">v</span>&nbsp;<span class="ident" id="5332891">reflect</span><span class="op" id="5332898">.</span><span class="ident" id="5332899">Value</span><span class="op" id="5332904">)</span>&nbsp;<span class="op" id="5332906">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332909">if</span>&nbsp;<span class="op" id="5332912">!</span><span class="ident" id="5332913">v</span><span class="op" id="5332914">.</span><span class="ident" id="5332915">IsValid</span><span class="op" id="5332922">(</span><span class="op" id="5332923">)</span>&nbsp;<span class="op" id="5332925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5332929">_</span><span class="op" id="5332930">,</span>&nbsp;<span class="ident" id="5332932">rest</span><span class="op" id="5332936">,</span>&nbsp;<span class="ident" id="5332938">err</span>&nbsp;<span class="op" id="5332942">:=</span>&nbsp;<span class="ident" id="5332945">nextValue</span><span class="op" id="5332954">(</span><span class="ident" id="5332955">d</span><span class="op" id="5332956">.</span><span class="ident" id="5332957">data</span><span class="op" id="5332961">[</span><span class="ident" id="5332962">d</span><span class="op" id="5332963">.</span><span class="ident" id="5332964">off</span><span class="op" id="5332967">:</span><span class="op" id="5332968">]</span><span class="op" id="5332969">,</span>&nbsp;<span class="op" id="5332971">&amp;</span><span class="ident" id="5332972">d</span><span class="op" id="5332973">.</span><span class="ident" id="5332974">nextscan</span><span class="op" id="5332982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5332986">if</span>&nbsp;<span class="ident" id="5332989">err</span>&nbsp;<span class="op" id="5332993">!=</span>&nbsp;<span class="builtintype" id="5332996">nil</span>&nbsp;<span class="op" id="5333000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333005">d</span><span class="op" id="5333006">.</span><span class="builtintype" id="5333007">error</span><span class="op" id="5333012">(</span><span class="ident" id="5333013">err</span><span class="op" id="5333016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5333020">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333024">d</span><span class="op" id="5333025">.</span><span class="ident" id="5333026">off</span>&nbsp;<span class="op" id="5333030">=</span>&nbsp;<span class="builtinfunc" id="5333032">len</span><span class="op" id="5333035">(</span><span class="ident" id="5333036">d</span><span class="op" id="5333037">.</span><span class="ident" id="5333038">data</span><span class="op" id="5333042">)</span>&nbsp;<span class="op" id="5333044">-</span>&nbsp;<span class="builtinfunc" id="5333046">len</span><span class="op" id="5333049">(</span><span class="ident" id="5333050">rest</span><span class="op" id="5333054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5333059">//&nbsp;d.scan&nbsp;thinks&nbsp;we&#39;re&nbsp;still&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;item.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5333120">//&nbsp;Feed&nbsp;in&nbsp;an&nbsp;empty&nbsp;string&nbsp;-&nbsp;the&nbsp;shortest,&nbsp;simplest&nbsp;value&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5333182">//&nbsp;so&nbsp;that&nbsp;it&nbsp;knows&nbsp;we&nbsp;got&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5333236">if</span>&nbsp;<span class="ident" id="5333239">d</span><span class="op" id="5333240">.</span><span class="ident" id="5333241">scan</span><span class="op" id="5333245">.</span><span class="ident" id="5333246">redo</span>&nbsp;<span class="op" id="5333251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5333256">//&nbsp;rewind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333270">d</span><span class="op" id="5333271">.</span><span class="ident" id="5333272">scan</span><span class="op" id="5333276">.</span><span class="ident" id="5333277">redo</span>&nbsp;<span class="op" id="5333282">=</span>&nbsp;<span class="builtintype" id="5333284">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333293">d</span><span class="op" id="5333294">.</span><span class="ident" id="5333295">scan</span><span class="op" id="5333299">.</span><span class="ident" id="5333300">step</span>&nbsp;<span class="op" id="5333305">=</span>&nbsp;<span class="ident" id="5333307">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5333325">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333329">d</span><span class="op" id="5333330">.</span><span class="ident" id="5333331">scan</span><span class="op" id="5333335">.</span><span class="ident" id="5333336">step</span><span class="op" id="5333340">(</span><span class="op" id="5333341">&amp;</span><span class="ident" id="5333342">d</span><span class="op" id="5333343">.</span><span class="ident" id="5333344">scan</span><span class="op" id="5333348">,</span>&nbsp;<span class="string" id="5333350">&#39;&#34;&#39;</span><span class="op" id="5333353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333357">d</span><span class="op" id="5333358">.</span><span class="ident" id="5333359">scan</span><span class="op" id="5333363">.</span><span class="ident" id="5333364">step</span><span class="op" id="5333368">(</span><span class="op" id="5333369">&amp;</span><span class="ident" id="5333370">d</span><span class="op" id="5333371">.</span><span class="ident" id="5333372">scan</span><span class="op" id="5333376">,</span>&nbsp;<span class="string" id="5333378">&#39;&#34;&#39;</span><span class="op" id="5333381">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333386">n</span>&nbsp;<span class="op" id="5333388">:=</span>&nbsp;<span class="builtinfunc" id="5333391">len</span><span class="op" id="5333394">(</span><span class="ident" id="5333395">d</span><span class="op" id="5333396">.</span><span class="ident" id="5333397">scan</span><span class="op" id="5333401">.</span><span class="ident" id="5333402">parseState</span><span class="op" id="5333412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5333416">if</span>&nbsp;<span class="ident" id="5333419">n</span>&nbsp;<span class="op" id="5333421">&gt;</span>&nbsp;<span class="num" id="5333423">0</span>&nbsp;<span class="op" id="5333425">&amp;&amp;</span>&nbsp;<span class="ident" id="5333428">d</span><span class="op" id="5333429">.</span><span class="ident" id="5333430">scan</span><span class="op" id="5333434">.</span><span class="ident" id="5333435">parseState</span><span class="op" id="5333445">[</span><span class="ident" id="5333446">n</span><span class="op" id="5333447">-</span><span class="num" id="5333448">1</span><span class="op" id="5333449">]</span>&nbsp;<span class="op" id="5333451">==</span>&nbsp;<span class="ident" id="5333454">parseObjectKey</span>&nbsp;<span class="op" id="5333469">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5333474">//&nbsp;d.scan&nbsp;thinks&nbsp;we&nbsp;just&nbsp;read&nbsp;an&nbsp;object&nbsp;key;&nbsp;finish&nbsp;the&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333540">d</span><span class="op" id="5333541">.</span><span class="ident" id="5333542">scan</span><span class="op" id="5333546">.</span><span class="ident" id="5333547">step</span><span class="op" id="5333551">(</span><span class="op" id="5333552">&amp;</span><span class="ident" id="5333553">d</span><span class="op" id="5333554">.</span><span class="ident" id="5333555">scan</span><span class="op" id="5333559">,</span>&nbsp;<span class="string" id="5333561">&#39;:&#39;</span><span class="op" id="5333564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333569">d</span><span class="op" id="5333570">.</span><span class="ident" id="5333571">scan</span><span class="op" id="5333575">.</span><span class="ident" id="5333576">step</span><span class="op" id="5333580">(</span><span class="op" id="5333581">&amp;</span><span class="ident" id="5333582">d</span><span class="op" id="5333583">.</span><span class="ident" id="5333584">scan</span><span class="op" id="5333588">,</span>&nbsp;<span class="string" id="5333590">&#39;&#34;&#39;</span><span class="op" id="5333593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333598">d</span><span class="op" id="5333599">.</span><span class="ident" id="5333600">scan</span><span class="op" id="5333604">.</span><span class="ident" id="5333605">step</span><span class="op" id="5333609">(</span><span class="op" id="5333610">&amp;</span><span class="ident" id="5333611">d</span><span class="op" id="5333612">.</span><span class="ident" id="5333613">scan</span><span class="op" id="5333617">,</span>&nbsp;<span class="string" id="5333619">&#39;&#34;&#39;</span><span class="op" id="5333622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333627">d</span><span class="op" id="5333628">.</span><span class="ident" id="5333629">scan</span><span class="op" id="5333633">.</span><span class="ident" id="5333634">step</span><span class="op" id="5333638">(</span><span class="op" id="5333639">&amp;</span><span class="ident" id="5333640">d</span><span class="op" id="5333641">.</span><span class="ident" id="5333642">scan</span><span class="op" id="5333646">,</span>&nbsp;<span class="string" id="5333648">&#39;}&#39;</span><span class="op" id="5333651">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5333655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5333660">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5333668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5333672">switch</span>&nbsp;<span class="ident" id="5333679">op</span>&nbsp;<span class="op" id="5333682">:=</span>&nbsp;<span class="ident" id="5333685">d</span><span class="op" id="5333686">.</span><span class="ident" id="5333687">scanWhile</span><span class="op" id="5333696">(</span><span class="ident" id="5333697">scanSkipSpace</span><span class="op" id="5333710">)</span><span class="op" id="5333711">;</span>&nbsp;<span class="ident" id="5333713">op</span>&nbsp;<span class="op" id="5333716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5333719">default</span><span class="op" id="5333726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333730">d</span><span class="op" id="5333731">.</span><span class="builtintype" id="5333732">error</span><span class="op" id="5333737">(</span><span class="ident" id="5333738">errPhase</span><span class="op" id="5333746">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5333750">case</span>&nbsp;<span class="ident" id="5333755">scanBeginArray</span><span class="op" id="5333769">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333773">d</span><span class="op" id="5333774">.</span><span class="ident" id="5333775">array</span><span class="op" id="5333780">(</span><span class="ident" id="5333781">v</span><span class="op" id="5333782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5333786">case</span>&nbsp;<span class="ident" id="5333791">scanBeginObject</span><span class="op" id="5333806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333810">d</span><span class="op" id="5333811">.</span><span class="ident" id="5333812">object</span><span class="op" id="5333818">(</span><span class="ident" id="5333819">v</span><span class="op" id="5333820">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5333824">case</span>&nbsp;<span class="ident" id="5333829">scanBeginLiteral</span><span class="op" id="5333845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5333849">d</span><span class="op" id="5333850">.</span><span class="ident" id="5333851">literal</span><span class="op" id="5333858">(</span><span class="ident" id="5333859">v</span><span class="op" id="5333860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5333863">}</span><br>
<span class="lineno"></span><span class="op" id="5333865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="5333868">type</span>&nbsp;<span class="ident" id="5333873">unquotedValue</span>&nbsp;<span class="keyword" id="5333887">struct</span><span class="op" id="5333893">{</span><span class="op" id="5333894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5333897">//&nbsp;valueQuoted&nbsp;is&nbsp;like&nbsp;value&nbsp;but&nbsp;decodes&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5333940">//&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;or&nbsp;literal&nbsp;null&nbsp;into&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5334006">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;anything&nbsp;other&nbsp;than&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;or&nbsp;null,</span><br>
<span class="lineno">300</span><span class="comment" id="5334074">//&nbsp;valueQuoted&nbsp;returns&nbsp;unquotedValue{}.</span><br>
<span class="lineno"></span><span class="keyword" id="5334114">func</span>&nbsp;<span class="op" id="5334119">(</span><span class="ident" id="5334120">d</span>&nbsp;<span class="op" id="5334122">*</span><span class="ident" id="5334123">decodeState</span><span class="op" id="5334134">)</span>&nbsp;<span class="ident" id="5334136">valueQuoted</span><span class="op" id="5334147">(</span><span class="op" id="5334148">)</span>&nbsp;<span class="keyword" id="5334150">interface</span><span class="op" id="5334159">{</span><span class="op" id="5334160">}</span>&nbsp;<span class="op" id="5334162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334165">switch</span>&nbsp;<span class="ident" id="5334172">op</span>&nbsp;<span class="op" id="5334175">:=</span>&nbsp;<span class="ident" id="5334178">d</span><span class="op" id="5334179">.</span><span class="ident" id="5334180">scanWhile</span><span class="op" id="5334189">(</span><span class="ident" id="5334190">scanSkipSpace</span><span class="op" id="5334203">)</span><span class="op" id="5334204">;</span>&nbsp;<span class="ident" id="5334206">op</span>&nbsp;<span class="op" id="5334209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334212">default</span><span class="op" id="5334219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5334223">d</span><span class="op" id="5334224">.</span><span class="builtintype" id="5334225">error</span><span class="op" id="5334230">(</span><span class="ident" id="5334231">errPhase</span><span class="op" id="5334239">)</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334243">case</span>&nbsp;<span class="ident" id="5334248">scanBeginArray</span><span class="op" id="5334262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5334266">d</span><span class="op" id="5334267">.</span><span class="ident" id="5334268">array</span><span class="op" id="5334273">(</span><span class="ident" id="5334274">reflect</span><span class="op" id="5334281">.</span><span class="ident" id="5334282">Value</span><span class="op" id="5334287">{</span><span class="op" id="5334288">}</span><span class="op" id="5334289">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334293">case</span>&nbsp;<span class="ident" id="5334298">scanBeginObject</span><span class="op" id="5334313">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5334317">d</span><span class="op" id="5334318">.</span><span class="ident" id="5334319">object</span><span class="op" id="5334325">(</span><span class="ident" id="5334326">reflect</span><span class="op" id="5334333">.</span><span class="ident" id="5334334">Value</span><span class="op" id="5334339">{</span><span class="op" id="5334340">}</span><span class="op" id="5334341">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334345">case</span>&nbsp;<span class="ident" id="5334350">scanBeginLiteral</span><span class="op" id="5334366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334370">switch</span>&nbsp;<span class="ident" id="5334377">v</span>&nbsp;<span class="op" id="5334379">:=</span>&nbsp;<span class="ident" id="5334382">d</span><span class="op" id="5334383">.</span><span class="ident" id="5334384">literalInterface</span><span class="op" id="5334400">(</span><span class="op" id="5334401">)</span><span class="op" id="5334402">.</span><span class="op" id="5334403">(</span><span class="keyword" id="5334404">type</span><span class="op" id="5334408">)</span>&nbsp;<span class="op" id="5334410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334414">case</span>&nbsp;<span class="builtintype" id="5334419">nil</span><span class="op" id="5334422">,</span>&nbsp;<span class="builtintype" id="5334424">string</span><span class="op" id="5334430">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334435">return</span>&nbsp;<span class="ident" id="5334442">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5334446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5334449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334452">return</span>&nbsp;<span class="ident" id="5334459">unquotedValue</span><span class="op" id="5334472">{</span><span class="op" id="5334473">}</span><br>
<span class="lineno"></span><span class="op" id="5334475">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5334478">//&nbsp;indirect&nbsp;walks&nbsp;down&nbsp;v&nbsp;allocating&nbsp;pointers&nbsp;as&nbsp;needed,</span><br>
<span class="lineno"></span><span class="comment" id="5334534">//&nbsp;until&nbsp;it&nbsp;gets&nbsp;to&nbsp;a&nbsp;non-pointer.</span><br>
<span class="lineno"></span><span class="comment" id="5334569">//&nbsp;if&nbsp;it&nbsp;encounters&nbsp;an&nbsp;Unmarshaler,&nbsp;indirect&nbsp;stops&nbsp;and&nbsp;returns&nbsp;that.</span><br>
<span class="lineno"></span><span class="comment" id="5334638">//&nbsp;if&nbsp;decodingNull&nbsp;is&nbsp;true,&nbsp;indirect&nbsp;stops&nbsp;at&nbsp;the&nbsp;last&nbsp;pointer&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;set&nbsp;to&nbsp;nil.</span><br>
<span class="lineno">325</span><span class="keyword" id="5334726">func</span>&nbsp;<span class="op" id="5334731">(</span><span class="ident" id="5334732">d</span>&nbsp;<span class="op" id="5334734">*</span><span class="ident" id="5334735">decodeState</span><span class="op" id="5334746">)</span>&nbsp;<span class="ident" id="5334748">indirect</span><span class="op" id="5334756">(</span><span class="ident" id="5334757">v</span>&nbsp;<span class="ident" id="5334759">reflect</span><span class="op" id="5334766">.</span><span class="ident" id="5334767">Value</span><span class="op" id="5334772">,</span>&nbsp;<span class="ident" id="5334774">decodingNull</span>&nbsp;<span class="builtintype" id="5334787">bool</span><span class="op" id="5334791">)</span>&nbsp;<span class="op" id="5334793">(</span><span class="ident" id="5334794">Unmarshaler</span><span class="op" id="5334805">,</span>&nbsp;<span class="ident" id="5334807">encoding</span><span class="op" id="5334815">.</span><span class="ident" id="5334816">TextUnmarshaler</span><span class="op" id="5334831">,</span>&nbsp;<span class="ident" id="5334833">reflect</span><span class="op" id="5334840">.</span><span class="ident" id="5334841">Value</span><span class="op" id="5334846">)</span>&nbsp;<span class="op" id="5334848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5334851">//&nbsp;If&nbsp;v&nbsp;is&nbsp;a&nbsp;named&nbsp;type&nbsp;and&nbsp;is&nbsp;addressable,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5334896">//&nbsp;start&nbsp;with&nbsp;its&nbsp;address,&nbsp;so&nbsp;that&nbsp;if&nbsp;the&nbsp;type&nbsp;has&nbsp;pointer&nbsp;methods,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5334965">//&nbsp;we&nbsp;find&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5334983">if</span>&nbsp;<span class="ident" id="5334986">v</span><span class="op" id="5334987">.</span><span class="ident" id="5334988">Kind</span><span class="op" id="5334992">(</span><span class="op" id="5334993">)</span>&nbsp;<span class="op" id="5334995">!=</span>&nbsp;<span class="ident" id="5334998">reflect</span><span class="op" id="5335005">.</span><span class="ident" id="5335006">Ptr</span>&nbsp;<span class="op" id="5335010">&amp;&amp;</span>&nbsp;<span class="ident" id="5335013">v</span><span class="op" id="5335014">.</span><span class="ident" id="5335015">Type</span><span class="op" id="5335019">(</span><span class="op" id="5335020">)</span><span class="op" id="5335021">.</span><span class="ident" id="5335022">Name</span><span class="op" id="5335026">(</span><span class="op" id="5335027">)</span>&nbsp;<span class="op" id="5335029">!=</span>&nbsp;<span class="string" id="5335032">&#34;&#34;</span>&nbsp;<span class="op" id="5335035">&amp;&amp;</span>&nbsp;<span class="ident" id="5335038">v</span><span class="op" id="5335039">.</span><span class="ident" id="5335040">CanAddr</span><span class="op" id="5335047">(</span><span class="op" id="5335048">)</span>&nbsp;<span class="op" id="5335050">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5335054">v</span>&nbsp;<span class="op" id="5335056">=</span>&nbsp;<span class="ident" id="5335058">v</span><span class="op" id="5335059">.</span><span class="ident" id="5335060">Addr</span><span class="op" id="5335064">(</span><span class="op" id="5335065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335071">for</span>&nbsp;<span class="op" id="5335075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5335079">//&nbsp;Load&nbsp;value&nbsp;from&nbsp;interface,&nbsp;but&nbsp;only&nbsp;if&nbsp;the&nbsp;result&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5335142">//&nbsp;usefully&nbsp;addressable.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335169">if</span>&nbsp;<span class="ident" id="5335172">v</span><span class="op" id="5335173">.</span><span class="ident" id="5335174">Kind</span><span class="op" id="5335178">(</span><span class="op" id="5335179">)</span>&nbsp;<span class="op" id="5335181">==</span>&nbsp;<span class="ident" id="5335184">reflect</span><span class="op" id="5335191">.</span><span class="ident" id="5335192">Interface</span>&nbsp;<span class="op" id="5335202">&amp;&amp;</span>&nbsp;<span class="op" id="5335205">!</span><span class="ident" id="5335206">v</span><span class="op" id="5335207">.</span><span class="ident" id="5335208">IsNil</span><span class="op" id="5335213">(</span><span class="op" id="5335214">)</span>&nbsp;<span class="op" id="5335216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5335221">e</span>&nbsp;<span class="op" id="5335223">:=</span>&nbsp;<span class="ident" id="5335226">v</span><span class="op" id="5335227">.</span><span class="ident" id="5335228">Elem</span><span class="op" id="5335232">(</span><span class="op" id="5335233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335238">if</span>&nbsp;<span class="ident" id="5335241">e</span><span class="op" id="5335242">.</span><span class="ident" id="5335243">Kind</span><span class="op" id="5335247">(</span><span class="op" id="5335248">)</span>&nbsp;<span class="op" id="5335250">==</span>&nbsp;<span class="ident" id="5335253">reflect</span><span class="op" id="5335260">.</span><span class="ident" id="5335261">Ptr</span>&nbsp;<span class="op" id="5335265">&amp;&amp;</span>&nbsp;<span class="op" id="5335268">!</span><span class="ident" id="5335269">e</span><span class="op" id="5335270">.</span><span class="ident" id="5335271">IsNil</span><span class="op" id="5335276">(</span><span class="op" id="5335277">)</span>&nbsp;<span class="op" id="5335279">&amp;&amp;</span>&nbsp;<span class="op" id="5335282">(</span><span class="op" id="5335283">!</span><span class="ident" id="5335284">decodingNull</span>&nbsp;<span class="op" id="5335297">||</span>&nbsp;<span class="ident" id="5335300">e</span><span class="op" id="5335301">.</span><span class="ident" id="5335302">Elem</span><span class="op" id="5335306">(</span><span class="op" id="5335307">)</span><span class="op" id="5335308">.</span><span class="ident" id="5335309">Kind</span><span class="op" id="5335313">(</span><span class="op" id="5335314">)</span>&nbsp;<span class="op" id="5335316">==</span>&nbsp;<span class="ident" id="5335319">reflect</span><span class="op" id="5335326">.</span><span class="ident" id="5335327">Ptr</span><span class="op" id="5335330">)</span>&nbsp;<span class="op" id="5335332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5335338">v</span>&nbsp;<span class="op" id="5335340">=</span>&nbsp;<span class="ident" id="5335342">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335348">continue</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335369">if</span>&nbsp;<span class="ident" id="5335372">v</span><span class="op" id="5335373">.</span><span class="ident" id="5335374">Kind</span><span class="op" id="5335378">(</span><span class="op" id="5335379">)</span>&nbsp;<span class="op" id="5335381">!=</span>&nbsp;<span class="ident" id="5335384">reflect</span><span class="op" id="5335391">.</span><span class="ident" id="5335392">Ptr</span>&nbsp;<span class="op" id="5335396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335401">break</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335414">if</span>&nbsp;<span class="ident" id="5335417">v</span><span class="op" id="5335418">.</span><span class="ident" id="5335419">Elem</span><span class="op" id="5335423">(</span><span class="op" id="5335424">)</span><span class="op" id="5335425">.</span><span class="ident" id="5335426">Kind</span><span class="op" id="5335430">(</span><span class="op" id="5335431">)</span>&nbsp;<span class="op" id="5335433">!=</span>&nbsp;<span class="ident" id="5335436">reflect</span><span class="op" id="5335443">.</span><span class="ident" id="5335444">Ptr</span>&nbsp;<span class="op" id="5335448">&amp;&amp;</span>&nbsp;<span class="ident" id="5335451">decodingNull</span>&nbsp;<span class="op" id="5335464">&amp;&amp;</span>&nbsp;<span class="ident" id="5335467">v</span><span class="op" id="5335468">.</span><span class="ident" id="5335469">CanSet</span><span class="op" id="5335475">(</span><span class="op" id="5335476">)</span>&nbsp;<span class="op" id="5335478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335483">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335491">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335495">if</span>&nbsp;<span class="ident" id="5335498">v</span><span class="op" id="5335499">.</span><span class="ident" id="5335500">IsNil</span><span class="op" id="5335505">(</span><span class="op" id="5335506">)</span>&nbsp;<span class="op" id="5335508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5335513">v</span><span class="op" id="5335514">.</span><span class="ident" id="5335515">Set</span><span class="op" id="5335518">(</span><span class="ident" id="5335519">reflect</span><span class="op" id="5335526">.</span><span class="ident" id="5335527">New</span><span class="op" id="5335530">(</span><span class="ident" id="5335531">v</span><span class="op" id="5335532">.</span><span class="ident" id="5335533">Type</span><span class="op" id="5335537">(</span><span class="op" id="5335538">)</span><span class="op" id="5335539">.</span><span class="ident" id="5335540">Elem</span><span class="op" id="5335544">(</span><span class="op" id="5335545">)</span><span class="op" id="5335546">)</span><span class="op" id="5335547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335555">if</span>&nbsp;<span class="ident" id="5335558">v</span><span class="op" id="5335559">.</span><span class="ident" id="5335560">Type</span><span class="op" id="5335564">(</span><span class="op" id="5335565">)</span><span class="op" id="5335566">.</span><span class="ident" id="5335567">NumMethod</span><span class="op" id="5335576">(</span><span class="op" id="5335577">)</span>&nbsp;<span class="op" id="5335579">&gt;</span>&nbsp;<span class="num" id="5335581">0</span>&nbsp;<span class="op" id="5335583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335588">if</span>&nbsp;<span class="ident" id="5335591">u</span><span class="op" id="5335592">,</span>&nbsp;<span class="ident" id="5335594">ok</span>&nbsp;<span class="op" id="5335597">:=</span>&nbsp;<span class="ident" id="5335600">v</span><span class="op" id="5335601">.</span><span class="ident" id="5335602">Interface</span><span class="op" id="5335611">(</span><span class="op" id="5335612">)</span><span class="op" id="5335613">.</span><span class="op" id="5335614">(</span><span class="ident" id="5335615">Unmarshaler</span><span class="op" id="5335626">)</span><span class="op" id="5335627">;</span>&nbsp;<span class="ident" id="5335629">ok</span>&nbsp;<span class="op" id="5335632">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335638">return</span>&nbsp;<span class="ident" id="5335645">u</span><span class="op" id="5335646">,</span>&nbsp;<span class="builtintype" id="5335648">nil</span><span class="op" id="5335651">,</span>&nbsp;<span class="ident" id="5335653">reflect</span><span class="op" id="5335660">.</span><span class="ident" id="5335661">Value</span><span class="op" id="5335666">{</span><span class="op" id="5335667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335677">if</span>&nbsp;<span class="ident" id="5335680">u</span><span class="op" id="5335681">,</span>&nbsp;<span class="ident" id="5335683">ok</span>&nbsp;<span class="op" id="5335686">:=</span>&nbsp;<span class="ident" id="5335689">v</span><span class="op" id="5335690">.</span><span class="ident" id="5335691">Interface</span><span class="op" id="5335700">(</span><span class="op" id="5335701">)</span><span class="op" id="5335702">.</span><span class="op" id="5335703">(</span><span class="ident" id="5335704">encoding</span><span class="op" id="5335712">.</span><span class="ident" id="5335713">TextUnmarshaler</span><span class="op" id="5335728">)</span><span class="op" id="5335729">;</span>&nbsp;<span class="ident" id="5335731">ok</span>&nbsp;<span class="op" id="5335734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335740">return</span>&nbsp;<span class="builtintype" id="5335747">nil</span><span class="op" id="5335750">,</span>&nbsp;<span class="ident" id="5335752">u</span><span class="op" id="5335753">,</span>&nbsp;<span class="ident" id="5335755">reflect</span><span class="op" id="5335762">.</span><span class="ident" id="5335763">Value</span><span class="op" id="5335768">{</span><span class="op" id="5335769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335774">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5335782">v</span>&nbsp;<span class="op" id="5335784">=</span>&nbsp;<span class="ident" id="5335786">v</span><span class="op" id="5335787">.</span><span class="ident" id="5335788">Elem</span><span class="op" id="5335792">(</span><span class="op" id="5335793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5335796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5335799">return</span>&nbsp;<span class="builtintype" id="5335806">nil</span><span class="op" id="5335809">,</span>&nbsp;<span class="builtintype" id="5335811">nil</span><span class="op" id="5335814">,</span>&nbsp;<span class="ident" id="5335816">v</span><br>
<span class="lineno"></span><span class="op" id="5335818">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="5335821">//&nbsp;array&nbsp;consumes&nbsp;an&nbsp;array&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="5335898">//&nbsp;the&nbsp;first&nbsp;byte&nbsp;of&nbsp;the&nbsp;array&nbsp;(&#39;[&#39;)&nbsp;has&nbsp;been&nbsp;read&nbsp;already.</span><br>
<span class="lineno"></span><span class="keyword" id="5335958">func</span>&nbsp;<span class="op" id="5335963">(</span><span class="ident" id="5335964">d</span>&nbsp;<span class="op" id="5335966">*</span><span class="ident" id="5335967">decodeState</span><span class="op" id="5335978">)</span>&nbsp;<span class="ident" id="5335980">array</span><span class="op" id="5335985">(</span><span class="ident" id="5335986">v</span>&nbsp;<span class="ident" id="5335988">reflect</span><span class="op" id="5335995">.</span><span class="ident" id="5335996">Value</span><span class="op" id="5336001">)</span>&nbsp;<span class="op" id="5336003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5336006">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336033">u</span><span class="op" id="5336034">,</span>&nbsp;<span class="ident" id="5336036">ut</span><span class="op" id="5336038">,</span>&nbsp;<span class="ident" id="5336040">pv</span>&nbsp;<span class="op" id="5336043">:=</span>&nbsp;<span class="ident" id="5336046">d</span><span class="op" id="5336047">.</span><span class="ident" id="5336048">indirect</span><span class="op" id="5336056">(</span><span class="ident" id="5336057">v</span><span class="op" id="5336058">,</span>&nbsp;<span class="builtintype" id="5336060">false</span><span class="op" id="5336065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336068">if</span>&nbsp;<span class="ident" id="5336071">u</span>&nbsp;<span class="op" id="5336073">!=</span>&nbsp;<span class="builtintype" id="5336076">nil</span>&nbsp;<span class="op" id="5336080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336084">d</span><span class="op" id="5336085">.</span><span class="ident" id="5336086">off</span><span class="op" id="5336089">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336094">err</span>&nbsp;<span class="op" id="5336098">:=</span>&nbsp;<span class="ident" id="5336101">u</span><span class="op" id="5336102">.</span><span class="ident" id="5336103">UnmarshalJSON</span><span class="op" id="5336116">(</span><span class="ident" id="5336117">d</span><span class="op" id="5336118">.</span><span class="ident" id="5336119">next</span><span class="op" id="5336123">(</span><span class="op" id="5336124">)</span><span class="op" id="5336125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336129">if</span>&nbsp;<span class="ident" id="5336132">err</span>&nbsp;<span class="op" id="5336136">!=</span>&nbsp;<span class="builtintype" id="5336139">nil</span>&nbsp;<span class="op" id="5336143">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336148">d</span><span class="op" id="5336149">.</span><span class="builtintype" id="5336150">error</span><span class="op" id="5336155">(</span><span class="ident" id="5336156">err</span><span class="op" id="5336159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5336163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336167">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5336175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336178">if</span>&nbsp;<span class="ident" id="5336181">ut</span>&nbsp;<span class="op" id="5336184">!=</span>&nbsp;<span class="builtintype" id="5336187">nil</span>&nbsp;<span class="op" id="5336191">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336195">d</span><span class="op" id="5336196">.</span><span class="ident" id="5336197">saveError</span><span class="op" id="5336206">(</span><span class="op" id="5336207">&amp;</span><span class="ident" id="5336208">UnmarshalTypeError</span><span class="op" id="5336226">{</span><span class="string" id="5336227">&#34;array&#34;</span><span class="op" id="5336234">,</span>&nbsp;<span class="ident" id="5336236">v</span><span class="op" id="5336237">.</span><span class="ident" id="5336238">Type</span><span class="op" id="5336242">(</span><span class="op" id="5336243">)</span><span class="op" id="5336244">}</span><span class="op" id="5336245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336249">d</span><span class="op" id="5336250">.</span><span class="ident" id="5336251">off</span><span class="op" id="5336254">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336259">d</span><span class="op" id="5336260">.</span><span class="ident" id="5336261">next</span><span class="op" id="5336265">(</span><span class="op" id="5336266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336270">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5336278">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336282">v</span>&nbsp;<span class="op" id="5336284">=</span>&nbsp;<span class="ident" id="5336286">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5336291">//&nbsp;Check&nbsp;type&nbsp;of&nbsp;target.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336317">switch</span>&nbsp;<span class="ident" id="5336324">v</span><span class="op" id="5336325">.</span><span class="ident" id="5336326">Kind</span><span class="op" id="5336330">(</span><span class="op" id="5336331">)</span>&nbsp;<span class="op" id="5336333">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336336">case</span>&nbsp;<span class="ident" id="5336341">reflect</span><span class="op" id="5336348">.</span><span class="ident" id="5336349">Interface</span><span class="op" id="5336358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336362">if</span>&nbsp;<span class="ident" id="5336365">v</span><span class="op" id="5336366">.</span><span class="ident" id="5336367">NumMethod</span><span class="op" id="5336376">(</span><span class="op" id="5336377">)</span>&nbsp;<span class="op" id="5336379">==</span>&nbsp;<span class="num" id="5336382">0</span>&nbsp;<span class="op" id="5336384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5336389">//&nbsp;Decoding&nbsp;into&nbsp;nil&nbsp;interface?&nbsp;&nbsp;Switch&nbsp;to&nbsp;non-reflect&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336453">v</span><span class="op" id="5336454">.</span><span class="ident" id="5336455">Set</span><span class="op" id="5336458">(</span><span class="ident" id="5336459">reflect</span><span class="op" id="5336466">.</span><span class="ident" id="5336467">ValueOf</span><span class="op" id="5336474">(</span><span class="ident" id="5336475">d</span><span class="op" id="5336476">.</span><span class="ident" id="5336477">arrayInterface</span><span class="op" id="5336491">(</span><span class="op" id="5336492">)</span><span class="op" id="5336493">)</span><span class="op" id="5336494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336499">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5336508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5336512">//&nbsp;Otherwise&nbsp;it&#39;s&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336541">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336554">default</span><span class="op" id="5336561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336565">d</span><span class="op" id="5336566">.</span><span class="ident" id="5336567">saveError</span><span class="op" id="5336576">(</span><span class="op" id="5336577">&amp;</span><span class="ident" id="5336578">UnmarshalTypeError</span><span class="op" id="5336596">{</span><span class="string" id="5336597">&#34;array&#34;</span><span class="op" id="5336604">,</span>&nbsp;<span class="ident" id="5336606">v</span><span class="op" id="5336607">.</span><span class="ident" id="5336608">Type</span><span class="op" id="5336612">(</span><span class="op" id="5336613">)</span><span class="op" id="5336614">}</span><span class="op" id="5336615">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336619">d</span><span class="op" id="5336620">.</span><span class="ident" id="5336621">off</span><span class="op" id="5336624">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336629">d</span><span class="op" id="5336630">.</span><span class="ident" id="5336631">next</span><span class="op" id="5336635">(</span><span class="op" id="5336636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336640">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336648">case</span>&nbsp;<span class="ident" id="5336653">reflect</span><span class="op" id="5336660">.</span><span class="ident" id="5336661">Array</span><span class="op" id="5336666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336669">case</span>&nbsp;<span class="ident" id="5336674">reflect</span><span class="op" id="5336681">.</span><span class="ident" id="5336682">Slice</span><span class="op" id="5336687">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336691">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5336698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336702">i</span>&nbsp;<span class="op" id="5336704">:=</span>&nbsp;<span class="num" id="5336707">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336710">for</span>&nbsp;<span class="op" id="5336714">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5336718">//&nbsp;Look&nbsp;ahead&nbsp;for&nbsp;]&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336778">op</span>&nbsp;<span class="op" id="5336781">:=</span>&nbsp;<span class="ident" id="5336784">d</span><span class="op" id="5336785">.</span><span class="ident" id="5336786">scanWhile</span><span class="op" id="5336795">(</span><span class="ident" id="5336796">scanSkipSpace</span><span class="op" id="5336809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336813">if</span>&nbsp;<span class="ident" id="5336816">op</span>&nbsp;<span class="op" id="5336819">==</span>&nbsp;<span class="ident" id="5336822">scanEndArray</span>&nbsp;<span class="op" id="5336835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336840">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5336848">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5336853">//&nbsp;Back&nbsp;up&nbsp;so&nbsp;d.value&nbsp;can&nbsp;have&nbsp;the&nbsp;byte&nbsp;we&nbsp;just&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336909">d</span><span class="op" id="5336910">.</span><span class="ident" id="5336911">off</span><span class="op" id="5336914">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5336919">d</span><span class="op" id="5336920">.</span><span class="ident" id="5336921">scan</span><span class="op" id="5336925">.</span><span class="ident" id="5336926">undo</span><span class="op" id="5336930">(</span><span class="ident" id="5336931">op</span><span class="op" id="5336933">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5336938">//&nbsp;Get&nbsp;element&nbsp;of&nbsp;array,&nbsp;growing&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5336987">if</span>&nbsp;<span class="ident" id="5336990">v</span><span class="op" id="5336991">.</span><span class="ident" id="5336992">Kind</span><span class="op" id="5336996">(</span><span class="op" id="5336997">)</span>&nbsp;<span class="op" id="5336999">==</span>&nbsp;<span class="ident" id="5337002">reflect</span><span class="op" id="5337009">.</span><span class="ident" id="5337010">Slice</span>&nbsp;<span class="op" id="5337016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5337021">//&nbsp;Grow&nbsp;slice&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337051">if</span>&nbsp;<span class="ident" id="5337054">i</span>&nbsp;<span class="op" id="5337056">&gt;=</span>&nbsp;<span class="ident" id="5337059">v</span><span class="op" id="5337060">.</span><span class="ident" id="5337061">Cap</span><span class="op" id="5337064">(</span><span class="op" id="5337065">)</span>&nbsp;<span class="op" id="5337067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337073">newcap</span>&nbsp;<span class="op" id="5337080">:=</span>&nbsp;<span class="ident" id="5337083">v</span><span class="op" id="5337084">.</span><span class="ident" id="5337085">Cap</span><span class="op" id="5337088">(</span><span class="op" id="5337089">)</span>&nbsp;<span class="op" id="5337091">+</span>&nbsp;<span class="ident" id="5337093">v</span><span class="op" id="5337094">.</span><span class="ident" id="5337095">Cap</span><span class="op" id="5337098">(</span><span class="op" id="5337099">)</span><span class="op" id="5337100">/</span><span class="num" id="5337101">2</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337107">if</span>&nbsp;<span class="ident" id="5337110">newcap</span>&nbsp;<span class="op" id="5337117">&lt;</span>&nbsp;<span class="num" id="5337119">4</span>&nbsp;<span class="op" id="5337121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337128">newcap</span>&nbsp;<span class="op" id="5337135">=</span>&nbsp;<span class="num" id="5337137">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337149">newv</span>&nbsp;<span class="op" id="5337154">:=</span>&nbsp;<span class="ident" id="5337157">reflect</span><span class="op" id="5337164">.</span><span class="ident" id="5337165">MakeSlice</span><span class="op" id="5337174">(</span><span class="ident" id="5337175">v</span><span class="op" id="5337176">.</span><span class="ident" id="5337177">Type</span><span class="op" id="5337181">(</span><span class="op" id="5337182">)</span><span class="op" id="5337183">,</span>&nbsp;<span class="ident" id="5337185">v</span><span class="op" id="5337186">.</span><span class="ident" id="5337187">Len</span><span class="op" id="5337190">(</span><span class="op" id="5337191">)</span><span class="op" id="5337192">,</span>&nbsp;<span class="ident" id="5337194">newcap</span><span class="op" id="5337200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337206">reflect</span><span class="op" id="5337213">.</span><span class="ident" id="5337214">Copy</span><span class="op" id="5337218">(</span><span class="ident" id="5337219">newv</span><span class="op" id="5337223">,</span>&nbsp;<span class="ident" id="5337225">v</span><span class="op" id="5337226">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337232">v</span><span class="op" id="5337233">.</span><span class="ident" id="5337234">Set</span><span class="op" id="5337237">(</span><span class="ident" id="5337238">newv</span><span class="op" id="5337242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337252">if</span>&nbsp;<span class="ident" id="5337255">i</span>&nbsp;<span class="op" id="5337257">&gt;=</span>&nbsp;<span class="ident" id="5337260">v</span><span class="op" id="5337261">.</span><span class="ident" id="5337262">Len</span><span class="op" id="5337265">(</span><span class="op" id="5337266">)</span>&nbsp;<span class="op" id="5337268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337274">v</span><span class="op" id="5337275">.</span><span class="ident" id="5337276">SetLen</span><span class="op" id="5337282">(</span><span class="ident" id="5337283">i</span>&nbsp;<span class="op" id="5337285">+</span>&nbsp;<span class="num" id="5337287">1</span><span class="op" id="5337288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337293">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337302">if</span>&nbsp;<span class="ident" id="5337305">i</span>&nbsp;<span class="op" id="5337307">&lt;</span>&nbsp;<span class="ident" id="5337309">v</span><span class="op" id="5337310">.</span><span class="ident" id="5337311">Len</span><span class="op" id="5337314">(</span><span class="op" id="5337315">)</span>&nbsp;<span class="op" id="5337317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5337322">//&nbsp;Decode&nbsp;into&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337349">d</span><span class="op" id="5337350">.</span><span class="ident" id="5337351">value</span><span class="op" id="5337356">(</span><span class="ident" id="5337357">v</span><span class="op" id="5337358">.</span><span class="ident" id="5337359">Index</span><span class="op" id="5337364">(</span><span class="ident" id="5337365">i</span><span class="op" id="5337366">)</span><span class="op" id="5337367">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337371">}</span>&nbsp;<span class="keyword" id="5337373">else</span>&nbsp;<span class="op" id="5337378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5337383">//&nbsp;Ran&nbsp;out&nbsp;of&nbsp;fixed&nbsp;array:&nbsp;skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337419">d</span><span class="op" id="5337420">.</span><span class="ident" id="5337421">value</span><span class="op" id="5337426">(</span><span class="ident" id="5337427">reflect</span><span class="op" id="5337434">.</span><span class="ident" id="5337435">Value</span><span class="op" id="5337440">{</span><span class="op" id="5337441">}</span><span class="op" id="5337442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337450">i</span><span class="op" id="5337451">++</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5337457">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337489">op</span>&nbsp;<span class="op" id="5337492">=</span>&nbsp;<span class="ident" id="5337494">d</span><span class="op" id="5337495">.</span><span class="ident" id="5337496">scanWhile</span><span class="op" id="5337505">(</span><span class="ident" id="5337506">scanSkipSpace</span><span class="op" id="5337519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337523">if</span>&nbsp;<span class="ident" id="5337526">op</span>&nbsp;<span class="op" id="5337529">==</span>&nbsp;<span class="ident" id="5337532">scanEndArray</span>&nbsp;<span class="op" id="5337545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337550">break</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337562">if</span>&nbsp;<span class="ident" id="5337565">op</span>&nbsp;<span class="op" id="5337568">!=</span>&nbsp;<span class="ident" id="5337571">scanArrayValue</span>&nbsp;<span class="op" id="5337586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337591">d</span><span class="op" id="5337592">.</span><span class="builtintype" id="5337593">error</span><span class="op" id="5337598">(</span><span class="ident" id="5337599">errPhase</span><span class="op" id="5337607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337614">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337618">if</span>&nbsp;<span class="ident" id="5337621">i</span>&nbsp;<span class="op" id="5337623">&lt;</span>&nbsp;<span class="ident" id="5337625">v</span><span class="op" id="5337626">.</span><span class="ident" id="5337627">Len</span><span class="op" id="5337630">(</span><span class="op" id="5337631">)</span>&nbsp;<span class="op" id="5337633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337637">if</span>&nbsp;<span class="ident" id="5337640">v</span><span class="op" id="5337641">.</span><span class="ident" id="5337642">Kind</span><span class="op" id="5337646">(</span><span class="op" id="5337647">)</span>&nbsp;<span class="op" id="5337649">==</span>&nbsp;<span class="ident" id="5337652">reflect</span><span class="op" id="5337659">.</span><span class="ident" id="5337660">Array</span>&nbsp;<span class="op" id="5337666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5337671">//&nbsp;Array.&nbsp;&nbsp;Zero&nbsp;the&nbsp;rest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337700">z</span>&nbsp;<span class="op" id="5337702">:=</span>&nbsp;<span class="ident" id="5337705">reflect</span><span class="op" id="5337712">.</span><span class="ident" id="5337713">Zero</span><span class="op" id="5337717">(</span><span class="ident" id="5337718">v</span><span class="op" id="5337719">.</span><span class="ident" id="5337720">Type</span><span class="op" id="5337724">(</span><span class="op" id="5337725">)</span><span class="op" id="5337726">.</span><span class="ident" id="5337727">Elem</span><span class="op" id="5337731">(</span><span class="op" id="5337732">)</span><span class="op" id="5337733">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337738">for</span>&nbsp;<span class="op" id="5337742">;</span>&nbsp;<span class="ident" id="5337744">i</span>&nbsp;<span class="op" id="5337746">&lt;</span>&nbsp;<span class="ident" id="5337748">v</span><span class="op" id="5337749">.</span><span class="ident" id="5337750">Len</span><span class="op" id="5337753">(</span><span class="op" id="5337754">)</span><span class="op" id="5337755">;</span>&nbsp;<span class="ident" id="5337757">i</span><span class="op" id="5337758">++</span>&nbsp;<span class="op" id="5337761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337767">v</span><span class="op" id="5337768">.</span><span class="ident" id="5337769">Index</span><span class="op" id="5337774">(</span><span class="ident" id="5337775">i</span><span class="op" id="5337776">)</span><span class="op" id="5337777">.</span><span class="ident" id="5337778">Set</span><span class="op" id="5337781">(</span><span class="ident" id="5337782">z</span><span class="op" id="5337783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337792">}</span>&nbsp;<span class="keyword" id="5337794">else</span>&nbsp;<span class="op" id="5337799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337804">v</span><span class="op" id="5337805">.</span><span class="ident" id="5337806">SetLen</span><span class="op" id="5337812">(</span><span class="ident" id="5337813">i</span><span class="op" id="5337814">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5337824">if</span>&nbsp;<span class="ident" id="5337827">i</span>&nbsp;<span class="op" id="5337829">==</span>&nbsp;<span class="num" id="5337832">0</span>&nbsp;<span class="op" id="5337834">&amp;&amp;</span>&nbsp;<span class="ident" id="5337837">v</span><span class="op" id="5337838">.</span><span class="ident" id="5337839">Kind</span><span class="op" id="5337843">(</span><span class="op" id="5337844">)</span>&nbsp;<span class="op" id="5337846">==</span>&nbsp;<span class="ident" id="5337849">reflect</span><span class="op" id="5337856">.</span><span class="ident" id="5337857">Slice</span>&nbsp;<span class="op" id="5337863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5337867">v</span><span class="op" id="5337868">.</span><span class="ident" id="5337869">Set</span><span class="op" id="5337872">(</span><span class="ident" id="5337873">reflect</span><span class="op" id="5337880">.</span><span class="ident" id="5337881">MakeSlice</span><span class="op" id="5337890">(</span><span class="ident" id="5337891">v</span><span class="op" id="5337892">.</span><span class="ident" id="5337893">Type</span><span class="op" id="5337897">(</span><span class="op" id="5337898">)</span><span class="op" id="5337899">,</span>&nbsp;<span class="num" id="5337901">0</span><span class="op" id="5337902">,</span>&nbsp;<span class="num" id="5337904">0</span><span class="op" id="5337905">)</span><span class="op" id="5337906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5337909">}</span><br>
<span class="lineno">470</span><span class="op" id="5337911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5337914">var</span>&nbsp;<span class="ident" id="5337918">nullLiteral</span>&nbsp;<span class="op" id="5337930">=</span>&nbsp;<span class="op" id="5337932">[</span><span class="op" id="5337933">]</span><span class="builtintype" id="5337934">byte</span><span class="op" id="5337938">(</span><span class="string" id="5337939">&#34;null&#34;</span><span class="op" id="5337945">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5337948">//&nbsp;object&nbsp;consumes&nbsp;an&nbsp;object&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno">475</span><span class="comment" id="5338027">//&nbsp;the&nbsp;first&nbsp;byte&nbsp;(&#39;{&#39;)&nbsp;of&nbsp;the&nbsp;object&nbsp;has&nbsp;been&nbsp;read&nbsp;already.</span><br>
<span class="lineno"></span><span class="keyword" id="5338088">func</span>&nbsp;<span class="op" id="5338093">(</span><span class="ident" id="5338094">d</span>&nbsp;<span class="op" id="5338096">*</span><span class="ident" id="5338097">decodeState</span><span class="op" id="5338108">)</span>&nbsp;<span class="ident" id="5338110">object</span><span class="op" id="5338116">(</span><span class="ident" id="5338117">v</span>&nbsp;<span class="ident" id="5338119">reflect</span><span class="op" id="5338126">.</span><span class="ident" id="5338127">Value</span><span class="op" id="5338132">)</span>&nbsp;<span class="op" id="5338134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5338137">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338164">u</span><span class="op" id="5338165">,</span>&nbsp;<span class="ident" id="5338167">ut</span><span class="op" id="5338169">,</span>&nbsp;<span class="ident" id="5338171">pv</span>&nbsp;<span class="op" id="5338174">:=</span>&nbsp;<span class="ident" id="5338177">d</span><span class="op" id="5338178">.</span><span class="ident" id="5338179">indirect</span><span class="op" id="5338187">(</span><span class="ident" id="5338188">v</span><span class="op" id="5338189">,</span>&nbsp;<span class="builtintype" id="5338191">false</span><span class="op" id="5338196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338199">if</span>&nbsp;<span class="ident" id="5338202">u</span>&nbsp;<span class="op" id="5338204">!=</span>&nbsp;<span class="builtintype" id="5338207">nil</span>&nbsp;<span class="op" id="5338211">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338215">d</span><span class="op" id="5338216">.</span><span class="ident" id="5338217">off</span><span class="op" id="5338220">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338225">err</span>&nbsp;<span class="op" id="5338229">:=</span>&nbsp;<span class="ident" id="5338232">u</span><span class="op" id="5338233">.</span><span class="ident" id="5338234">UnmarshalJSON</span><span class="op" id="5338247">(</span><span class="ident" id="5338248">d</span><span class="op" id="5338249">.</span><span class="ident" id="5338250">next</span><span class="op" id="5338254">(</span><span class="op" id="5338255">)</span><span class="op" id="5338256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338260">if</span>&nbsp;<span class="ident" id="5338263">err</span>&nbsp;<span class="op" id="5338267">!=</span>&nbsp;<span class="builtintype" id="5338270">nil</span>&nbsp;<span class="op" id="5338274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338279">d</span><span class="op" id="5338280">.</span><span class="builtintype" id="5338281">error</span><span class="op" id="5338286">(</span><span class="ident" id="5338287">err</span><span class="op" id="5338290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5338294">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338298">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5338306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338309">if</span>&nbsp;<span class="ident" id="5338312">ut</span>&nbsp;<span class="op" id="5338315">!=</span>&nbsp;<span class="builtintype" id="5338318">nil</span>&nbsp;<span class="op" id="5338322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338326">d</span><span class="op" id="5338327">.</span><span class="ident" id="5338328">saveError</span><span class="op" id="5338337">(</span><span class="op" id="5338338">&amp;</span><span class="ident" id="5338339">UnmarshalTypeError</span><span class="op" id="5338357">{</span><span class="string" id="5338358">&#34;object&#34;</span><span class="op" id="5338366">,</span>&nbsp;<span class="ident" id="5338368">v</span><span class="op" id="5338369">.</span><span class="ident" id="5338370">Type</span><span class="op" id="5338374">(</span><span class="op" id="5338375">)</span><span class="op" id="5338376">}</span><span class="op" id="5338377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338381">d</span><span class="op" id="5338382">.</span><span class="ident" id="5338383">off</span><span class="op" id="5338386">--</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338391">d</span><span class="op" id="5338392">.</span><span class="ident" id="5338393">next</span><span class="op" id="5338397">(</span><span class="op" id="5338398">)</span>&nbsp;<span class="comment" id="5338400">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338428">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5338436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338439">v</span>&nbsp;<span class="op" id="5338441">=</span>&nbsp;<span class="ident" id="5338443">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5338448">//&nbsp;Decoding&nbsp;into&nbsp;nil&nbsp;interface?&nbsp;&nbsp;Switch&nbsp;to&nbsp;non-reflect&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338510">if</span>&nbsp;<span class="ident" id="5338513">v</span><span class="op" id="5338514">.</span><span class="ident" id="5338515">Kind</span><span class="op" id="5338519">(</span><span class="op" id="5338520">)</span>&nbsp;<span class="op" id="5338522">==</span>&nbsp;<span class="ident" id="5338525">reflect</span><span class="op" id="5338532">.</span><span class="ident" id="5338533">Interface</span>&nbsp;<span class="op" id="5338543">&amp;&amp;</span>&nbsp;<span class="ident" id="5338546">v</span><span class="op" id="5338547">.</span><span class="ident" id="5338548">NumMethod</span><span class="op" id="5338557">(</span><span class="op" id="5338558">)</span>&nbsp;<span class="op" id="5338560">==</span>&nbsp;<span class="num" id="5338563">0</span>&nbsp;<span class="op" id="5338565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338569">v</span><span class="op" id="5338570">.</span><span class="ident" id="5338571">Set</span><span class="op" id="5338574">(</span><span class="ident" id="5338575">reflect</span><span class="op" id="5338582">.</span><span class="ident" id="5338583">ValueOf</span><span class="op" id="5338590">(</span><span class="ident" id="5338591">d</span><span class="op" id="5338592">.</span><span class="ident" id="5338593">objectInterface</span><span class="op" id="5338608">(</span><span class="op" id="5338609">)</span><span class="op" id="5338610">)</span><span class="op" id="5338611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338615">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5338623">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5338627">//&nbsp;Check&nbsp;type&nbsp;of&nbsp;target:&nbsp;struct&nbsp;or&nbsp;map[string]T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338676">switch</span>&nbsp;<span class="ident" id="5338683">v</span><span class="op" id="5338684">.</span><span class="ident" id="5338685">Kind</span><span class="op" id="5338689">(</span><span class="op" id="5338690">)</span>&nbsp;<span class="op" id="5338692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338695">case</span>&nbsp;<span class="ident" id="5338700">reflect</span><span class="op" id="5338707">.</span><span class="ident" id="5338708">Map</span><span class="op" id="5338711">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5338715">//&nbsp;map&nbsp;must&nbsp;have&nbsp;string&nbsp;kind</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338746">t</span>&nbsp;<span class="op" id="5338748">:=</span>&nbsp;<span class="ident" id="5338751">v</span><span class="op" id="5338752">.</span><span class="ident" id="5338753">Type</span><span class="op" id="5338757">(</span><span class="op" id="5338758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338762">if</span>&nbsp;<span class="ident" id="5338765">t</span><span class="op" id="5338766">.</span><span class="ident" id="5338767">Key</span><span class="op" id="5338770">(</span><span class="op" id="5338771">)</span><span class="op" id="5338772">.</span><span class="ident" id="5338773">Kind</span><span class="op" id="5338777">(</span><span class="op" id="5338778">)</span>&nbsp;<span class="op" id="5338780">!=</span>&nbsp;<span class="ident" id="5338783">reflect</span><span class="op" id="5338790">.</span><span class="ident" id="5338791">String</span>&nbsp;<span class="op" id="5338798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338803">d</span><span class="op" id="5338804">.</span><span class="ident" id="5338805">saveError</span><span class="op" id="5338814">(</span><span class="op" id="5338815">&amp;</span><span class="ident" id="5338816">UnmarshalTypeError</span><span class="op" id="5338834">{</span><span class="string" id="5338835">&#34;object&#34;</span><span class="op" id="5338843">,</span>&nbsp;<span class="ident" id="5338845">v</span><span class="op" id="5338846">.</span><span class="ident" id="5338847">Type</span><span class="op" id="5338851">(</span><span class="op" id="5338852">)</span><span class="op" id="5338853">}</span><span class="op" id="5338854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338859">d</span><span class="op" id="5338860">.</span><span class="ident" id="5338861">off</span><span class="op" id="5338864">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338870">d</span><span class="op" id="5338871">.</span><span class="ident" id="5338872">next</span><span class="op" id="5338876">(</span><span class="op" id="5338877">)</span>&nbsp;<span class="comment" id="5338879">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338908">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5338917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338921">if</span>&nbsp;<span class="ident" id="5338924">v</span><span class="op" id="5338925">.</span><span class="ident" id="5338926">IsNil</span><span class="op" id="5338931">(</span><span class="op" id="5338932">)</span>&nbsp;<span class="op" id="5338934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5338939">v</span><span class="op" id="5338940">.</span><span class="ident" id="5338941">Set</span><span class="op" id="5338944">(</span><span class="ident" id="5338945">reflect</span><span class="op" id="5338952">.</span><span class="ident" id="5338953">MakeMap</span><span class="op" id="5338960">(</span><span class="ident" id="5338961">t</span><span class="op" id="5338962">)</span><span class="op" id="5338963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5338967">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338970">case</span>&nbsp;<span class="ident" id="5338975">reflect</span><span class="op" id="5338982">.</span><span class="ident" id="5338983">Struct</span><span class="op" id="5338989">:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5338993">default</span><span class="op" id="5339000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339004">d</span><span class="op" id="5339005">.</span><span class="ident" id="5339006">saveError</span><span class="op" id="5339015">(</span><span class="op" id="5339016">&amp;</span><span class="ident" id="5339017">UnmarshalTypeError</span><span class="op" id="5339035">{</span><span class="string" id="5339036">&#34;object&#34;</span><span class="op" id="5339044">,</span>&nbsp;<span class="ident" id="5339046">v</span><span class="op" id="5339047">.</span><span class="ident" id="5339048">Type</span><span class="op" id="5339052">(</span><span class="op" id="5339053">)</span><span class="op" id="5339054">}</span><span class="op" id="5339055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339059">d</span><span class="op" id="5339060">.</span><span class="ident" id="5339061">off</span><span class="op" id="5339064">--</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339069">d</span><span class="op" id="5339070">.</span><span class="ident" id="5339071">next</span><span class="op" id="5339075">(</span><span class="op" id="5339076">)</span>&nbsp;<span class="comment" id="5339078">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339106">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5339114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339118">var</span>&nbsp;<span class="ident" id="5339122">mapElem</span>&nbsp;<span class="ident" id="5339130">reflect</span><span class="op" id="5339137">.</span><span class="ident" id="5339138">Value</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339146">for</span>&nbsp;<span class="op" id="5339150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5339154">//&nbsp;Read&nbsp;opening&nbsp;&#34;&nbsp;of&nbsp;string&nbsp;key&nbsp;or&nbsp;closing&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339202">op</span>&nbsp;<span class="op" id="5339205">:=</span>&nbsp;<span class="ident" id="5339208">d</span><span class="op" id="5339209">.</span><span class="ident" id="5339210">scanWhile</span><span class="op" id="5339219">(</span><span class="ident" id="5339220">scanSkipSpace</span><span class="op" id="5339233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339237">if</span>&nbsp;<span class="ident" id="5339240">op</span>&nbsp;<span class="op" id="5339243">==</span>&nbsp;<span class="ident" id="5339246">scanEndObject</span>&nbsp;<span class="op" id="5339260">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5339265">//&nbsp;closing&nbsp;}&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339319">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5339327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339331">if</span>&nbsp;<span class="ident" id="5339334">op</span>&nbsp;<span class="op" id="5339337">!=</span>&nbsp;<span class="ident" id="5339340">scanBeginLiteral</span>&nbsp;<span class="op" id="5339357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339362">d</span><span class="op" id="5339363">.</span><span class="builtintype" id="5339364">error</span><span class="op" id="5339369">(</span><span class="ident" id="5339370">errPhase</span><span class="op" id="5339378">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5339382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5339387">//&nbsp;Read&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339402">start</span>&nbsp;<span class="op" id="5339408">:=</span>&nbsp;<span class="ident" id="5339411">d</span><span class="op" id="5339412">.</span><span class="ident" id="5339413">off</span>&nbsp;<span class="op" id="5339417">-</span>&nbsp;<span class="num" id="5339419">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339423">op</span>&nbsp;<span class="op" id="5339426">=</span>&nbsp;<span class="ident" id="5339428">d</span><span class="op" id="5339429">.</span><span class="ident" id="5339430">scanWhile</span><span class="op" id="5339439">(</span><span class="ident" id="5339440">scanContinue</span><span class="op" id="5339452">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339456">item</span>&nbsp;<span class="op" id="5339461">:=</span>&nbsp;<span class="ident" id="5339464">d</span><span class="op" id="5339465">.</span><span class="ident" id="5339466">data</span><span class="op" id="5339470">[</span><span class="ident" id="5339471">start</span>&nbsp;<span class="op" id="5339477">:</span>&nbsp;<span class="ident" id="5339479">d</span><span class="op" id="5339480">.</span><span class="ident" id="5339481">off</span><span class="op" id="5339484">-</span><span class="num" id="5339485">1</span><span class="op" id="5339486">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339490">key</span><span class="op" id="5339493">,</span>&nbsp;<span class="ident" id="5339495">ok</span>&nbsp;<span class="op" id="5339498">:=</span>&nbsp;<span class="ident" id="5339501">unquoteBytes</span><span class="op" id="5339513">(</span><span class="ident" id="5339514">item</span><span class="op" id="5339518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339522">if</span>&nbsp;<span class="op" id="5339525">!</span><span class="ident" id="5339526">ok</span>&nbsp;<span class="op" id="5339529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339534">d</span><span class="op" id="5339535">.</span><span class="builtintype" id="5339536">error</span><span class="op" id="5339541">(</span><span class="ident" id="5339542">errPhase</span><span class="op" id="5339550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5339554">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5339559">//&nbsp;Figure&nbsp;out&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339603">var</span>&nbsp;<span class="ident" id="5339607">subv</span>&nbsp;<span class="ident" id="5339612">reflect</span><span class="op" id="5339619">.</span><span class="ident" id="5339620">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339628">destring</span>&nbsp;<span class="op" id="5339637">:=</span>&nbsp;<span class="builtintype" id="5339640">false</span>&nbsp;<span class="comment" id="5339646">//&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;wrapped&nbsp;in&nbsp;a&nbsp;string&nbsp;to&nbsp;be&nbsp;decoded&nbsp;first</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339713">if</span>&nbsp;<span class="ident" id="5339716">v</span><span class="op" id="5339717">.</span><span class="ident" id="5339718">Kind</span><span class="op" id="5339722">(</span><span class="op" id="5339723">)</span>&nbsp;<span class="op" id="5339725">==</span>&nbsp;<span class="ident" id="5339728">reflect</span><span class="op" id="5339735">.</span><span class="ident" id="5339736">Map</span>&nbsp;<span class="op" id="5339740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339745">elemType</span>&nbsp;<span class="op" id="5339754">:=</span>&nbsp;<span class="ident" id="5339757">v</span><span class="op" id="5339758">.</span><span class="ident" id="5339759">Type</span><span class="op" id="5339763">(</span><span class="op" id="5339764">)</span><span class="op" id="5339765">.</span><span class="ident" id="5339766">Elem</span><span class="op" id="5339770">(</span><span class="op" id="5339771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339776">if</span>&nbsp;<span class="op" id="5339779">!</span><span class="ident" id="5339780">mapElem</span><span class="op" id="5339787">.</span><span class="ident" id="5339788">IsValid</span><span class="op" id="5339795">(</span><span class="op" id="5339796">)</span>&nbsp;<span class="op" id="5339798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339804">mapElem</span>&nbsp;<span class="op" id="5339812">=</span>&nbsp;<span class="ident" id="5339814">reflect</span><span class="op" id="5339821">.</span><span class="ident" id="5339822">New</span><span class="op" id="5339825">(</span><span class="ident" id="5339826">elemType</span><span class="op" id="5339834">)</span><span class="op" id="5339835">.</span><span class="ident" id="5339836">Elem</span><span class="op" id="5339840">(</span><span class="op" id="5339841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5339846">}</span>&nbsp;<span class="keyword" id="5339848">else</span>&nbsp;<span class="op" id="5339853">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339859">mapElem</span><span class="op" id="5339866">.</span><span class="ident" id="5339867">Set</span><span class="op" id="5339870">(</span><span class="ident" id="5339871">reflect</span><span class="op" id="5339878">.</span><span class="ident" id="5339879">Zero</span><span class="op" id="5339883">(</span><span class="ident" id="5339884">elemType</span><span class="op" id="5339892">)</span><span class="op" id="5339893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5339898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339903">subv</span>&nbsp;<span class="op" id="5339908">=</span>&nbsp;<span class="ident" id="5339910">mapElem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5339920">}</span>&nbsp;<span class="keyword" id="5339922">else</span>&nbsp;<span class="op" id="5339927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339932">var</span>&nbsp;<span class="ident" id="5339936">f</span>&nbsp;<span class="op" id="5339938">*</span><span class="ident" id="5339939">field</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5339948">fields</span>&nbsp;<span class="op" id="5339955">:=</span>&nbsp;<span class="ident" id="5339958">cachedTypeFields</span><span class="op" id="5339974">(</span><span class="ident" id="5339975">v</span><span class="op" id="5339976">.</span><span class="ident" id="5339977">Type</span><span class="op" id="5339981">(</span><span class="op" id="5339982">)</span><span class="op" id="5339983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5339988">for</span>&nbsp;<span class="ident" id="5339992">i</span>&nbsp;<span class="op" id="5339994">:=</span>&nbsp;<span class="keyword" id="5339997">range</span>&nbsp;<span class="ident" id="5340003">fields</span>&nbsp;<span class="op" id="5340010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340016">ff</span>&nbsp;<span class="op" id="5340019">:=</span>&nbsp;<span class="op" id="5340022">&amp;</span><span class="ident" id="5340023">fields</span><span class="op" id="5340029">[</span><span class="ident" id="5340030">i</span><span class="op" id="5340031">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340037">if</span>&nbsp;<span class="ident" id="5340040">bytes</span><span class="op" id="5340045">.</span><span class="ident" id="5340046">Equal</span><span class="op" id="5340051">(</span><span class="ident" id="5340052">ff</span><span class="op" id="5340054">.</span><span class="ident" id="5340055">nameBytes</span><span class="op" id="5340064">,</span>&nbsp;<span class="ident" id="5340066">key</span><span class="op" id="5340069">)</span>&nbsp;<span class="op" id="5340071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340078">f</span>&nbsp;<span class="op" id="5340080">=</span>&nbsp;<span class="ident" id="5340082">ff</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340090">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340106">if</span>&nbsp;<span class="ident" id="5340109">f</span>&nbsp;<span class="op" id="5340111">==</span>&nbsp;<span class="builtintype" id="5340114">nil</span>&nbsp;<span class="op" id="5340118">&amp;&amp;</span>&nbsp;<span class="ident" id="5340121">ff</span><span class="op" id="5340123">.</span><span class="ident" id="5340124">equalFold</span><span class="op" id="5340133">(</span><span class="ident" id="5340134">ff</span><span class="op" id="5340136">.</span><span class="ident" id="5340137">nameBytes</span><span class="op" id="5340146">,</span>&nbsp;<span class="ident" id="5340148">key</span><span class="op" id="5340151">)</span>&nbsp;<span class="op" id="5340153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340160">f</span>&nbsp;<span class="op" id="5340162">=</span>&nbsp;<span class="ident" id="5340164">ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340171">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340181">if</span>&nbsp;<span class="ident" id="5340184">f</span>&nbsp;<span class="op" id="5340186">!=</span>&nbsp;<span class="builtintype" id="5340189">nil</span>&nbsp;<span class="op" id="5340193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340199">subv</span>&nbsp;<span class="op" id="5340204">=</span>&nbsp;<span class="ident" id="5340206">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340212">destring</span>&nbsp;<span class="op" id="5340221">=</span>&nbsp;<span class="ident" id="5340223">f</span><span class="op" id="5340224">.</span><span class="ident" id="5340225">quoted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340236">for</span>&nbsp;<span class="ident" id="5340240">_</span><span class="op" id="5340241">,</span>&nbsp;<span class="ident" id="5340243">i</span>&nbsp;<span class="op" id="5340245">:=</span>&nbsp;<span class="keyword" id="5340248">range</span>&nbsp;<span class="ident" id="5340254">f</span><span class="op" id="5340255">.</span><span class="ident" id="5340256">index</span>&nbsp;<span class="op" id="5340262">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340269">if</span>&nbsp;<span class="ident" id="5340272">subv</span><span class="op" id="5340276">.</span><span class="ident" id="5340277">Kind</span><span class="op" id="5340281">(</span><span class="op" id="5340282">)</span>&nbsp;<span class="op" id="5340284">==</span>&nbsp;<span class="ident" id="5340287">reflect</span><span class="op" id="5340294">.</span><span class="ident" id="5340295">Ptr</span>&nbsp;<span class="op" id="5340299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340307">if</span>&nbsp;<span class="ident" id="5340310">subv</span><span class="op" id="5340314">.</span><span class="ident" id="5340315">IsNil</span><span class="op" id="5340320">(</span><span class="op" id="5340321">)</span>&nbsp;<span class="op" id="5340323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340332">subv</span><span class="op" id="5340336">.</span><span class="ident" id="5340337">Set</span><span class="op" id="5340340">(</span><span class="ident" id="5340341">reflect</span><span class="op" id="5340348">.</span><span class="ident" id="5340349">New</span><span class="op" id="5340352">(</span><span class="ident" id="5340353">subv</span><span class="op" id="5340357">.</span><span class="ident" id="5340358">Type</span><span class="op" id="5340362">(</span><span class="op" id="5340363">)</span><span class="op" id="5340364">.</span><span class="ident" id="5340365">Elem</span><span class="op" id="5340369">(</span><span class="op" id="5340370">)</span><span class="op" id="5340371">)</span><span class="op" id="5340372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340388">subv</span>&nbsp;<span class="op" id="5340393">=</span>&nbsp;<span class="ident" id="5340395">subv</span><span class="op" id="5340399">.</span><span class="ident" id="5340400">Elem</span><span class="op" id="5340404">(</span><span class="op" id="5340405">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340419">subv</span>&nbsp;<span class="op" id="5340424">=</span>&nbsp;<span class="ident" id="5340426">subv</span><span class="op" id="5340430">.</span><span class="ident" id="5340431">Field</span><span class="op" id="5340436">(</span><span class="ident" id="5340437">i</span><span class="op" id="5340438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340453">}</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5340458">//&nbsp;Read&nbsp;:&nbsp;before&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340484">if</span>&nbsp;<span class="ident" id="5340487">op</span>&nbsp;<span class="op" id="5340490">==</span>&nbsp;<span class="ident" id="5340493">scanSkipSpace</span>&nbsp;<span class="op" id="5340507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340512">op</span>&nbsp;<span class="op" id="5340515">=</span>&nbsp;<span class="ident" id="5340517">d</span><span class="op" id="5340518">.</span><span class="ident" id="5340519">scanWhile</span><span class="op" id="5340528">(</span><span class="ident" id="5340529">scanSkipSpace</span><span class="op" id="5340542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340546">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340550">if</span>&nbsp;<span class="ident" id="5340553">op</span>&nbsp;<span class="op" id="5340556">!=</span>&nbsp;<span class="ident" id="5340559">scanObjectKey</span>&nbsp;<span class="op" id="5340573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340578">d</span><span class="op" id="5340579">.</span><span class="builtintype" id="5340580">error</span><span class="op" id="5340585">(</span><span class="ident" id="5340586">errPhase</span><span class="op" id="5340594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5340603">//&nbsp;Read&nbsp;value.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340620">if</span>&nbsp;<span class="ident" id="5340623">destring</span>&nbsp;<span class="op" id="5340632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340637">switch</span>&nbsp;<span class="ident" id="5340644">qv</span>&nbsp;<span class="op" id="5340647">:=</span>&nbsp;<span class="ident" id="5340650">d</span><span class="op" id="5340651">.</span><span class="ident" id="5340652">valueQuoted</span><span class="op" id="5340663">(</span><span class="op" id="5340664">)</span><span class="op" id="5340665">.</span><span class="op" id="5340666">(</span><span class="keyword" id="5340667">type</span><span class="op" id="5340671">)</span>&nbsp;<span class="op" id="5340673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340678">case</span>&nbsp;<span class="builtintype" id="5340683">nil</span><span class="op" id="5340686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340692">d</span><span class="op" id="5340693">.</span><span class="ident" id="5340694">literalStore</span><span class="op" id="5340706">(</span><span class="ident" id="5340707">nullLiteral</span><span class="op" id="5340718">,</span>&nbsp;<span class="ident" id="5340720">subv</span><span class="op" id="5340724">,</span>&nbsp;<span class="builtintype" id="5340726">false</span><span class="op" id="5340731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340736">case</span>&nbsp;<span class="builtintype" id="5340741">string</span><span class="op" id="5340747">:</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340753">d</span><span class="op" id="5340754">.</span><span class="ident" id="5340755">literalStore</span><span class="op" id="5340767">(</span><span class="op" id="5340768">[</span><span class="op" id="5340769">]</span><span class="builtintype" id="5340770">byte</span><span class="op" id="5340774">(</span><span class="ident" id="5340775">qv</span><span class="op" id="5340777">)</span><span class="op" id="5340778">,</span>&nbsp;<span class="ident" id="5340780">subv</span><span class="op" id="5340784">,</span>&nbsp;<span class="builtintype" id="5340786">true</span><span class="op" id="5340790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5340795">default</span><span class="op" id="5340802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340808">d</span><span class="op" id="5340809">.</span><span class="ident" id="5340810">saveError</span><span class="op" id="5340819">(</span><span class="ident" id="5340820">fmt</span><span class="op" id="5340823">.</span><span class="ident" id="5340824">Errorf</span><span class="op" id="5340830">(</span><span class="string" id="5340831">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;unquoted&nbsp;value&nbsp;into&nbsp;%v&#34;</span><span class="op" id="5340916">,</span>&nbsp;<span class="ident" id="5340918">item</span><span class="op" id="5340922">,</span>&nbsp;<span class="ident" id="5340924">v</span><span class="op" id="5340925">.</span><span class="ident" id="5340926">Type</span><span class="op" id="5340930">(</span><span class="op" id="5340931">)</span><span class="op" id="5340932">)</span><span class="op" id="5340933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340942">}</span>&nbsp;<span class="keyword" id="5340944">else</span>&nbsp;<span class="op" id="5340949">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5340954">d</span><span class="op" id="5340955">.</span><span class="ident" id="5340956">value</span><span class="op" id="5340961">(</span><span class="ident" id="5340962">subv</span><span class="op" id="5340966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5340970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5340975">//&nbsp;Write&nbsp;value&nbsp;back&nbsp;to&nbsp;map;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5341005">//&nbsp;if&nbsp;using&nbsp;struct,&nbsp;subv&nbsp;points&nbsp;into&nbsp;struct&nbsp;already.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5341060">if</span>&nbsp;<span class="ident" id="5341063">v</span><span class="op" id="5341064">.</span><span class="ident" id="5341065">Kind</span><span class="op" id="5341069">(</span><span class="op" id="5341070">)</span>&nbsp;<span class="op" id="5341072">==</span>&nbsp;<span class="ident" id="5341075">reflect</span><span class="op" id="5341082">.</span><span class="ident" id="5341083">Map</span>&nbsp;<span class="op" id="5341087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341092">kv</span>&nbsp;<span class="op" id="5341095">:=</span>&nbsp;<span class="ident" id="5341098">reflect</span><span class="op" id="5341105">.</span><span class="ident" id="5341106">ValueOf</span><span class="op" id="5341113">(</span><span class="ident" id="5341114">key</span><span class="op" id="5341117">)</span><span class="op" id="5341118">.</span><span class="ident" id="5341119">Convert</span><span class="op" id="5341126">(</span><span class="ident" id="5341127">v</span><span class="op" id="5341128">.</span><span class="ident" id="5341129">Type</span><span class="op" id="5341133">(</span><span class="op" id="5341134">)</span><span class="op" id="5341135">.</span><span class="ident" id="5341136">Key</span><span class="op" id="5341139">(</span><span class="op" id="5341140">)</span><span class="op" id="5341141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341146">v</span><span class="op" id="5341147">.</span><span class="ident" id="5341148">SetMapIndex</span><span class="op" id="5341159">(</span><span class="ident" id="5341160">kv</span><span class="op" id="5341162">,</span>&nbsp;<span class="ident" id="5341164">subv</span><span class="op" id="5341168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5341172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5341177">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341209">op</span>&nbsp;<span class="op" id="5341212">=</span>&nbsp;<span class="ident" id="5341214">d</span><span class="op" id="5341215">.</span><span class="ident" id="5341216">scanWhile</span><span class="op" id="5341225">(</span><span class="ident" id="5341226">scanSkipSpace</span><span class="op" id="5341239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5341243">if</span>&nbsp;<span class="ident" id="5341246">op</span>&nbsp;<span class="op" id="5341249">==</span>&nbsp;<span class="ident" id="5341252">scanEndObject</span>&nbsp;<span class="op" id="5341266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5341271">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5341279">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5341283">if</span>&nbsp;<span class="ident" id="5341286">op</span>&nbsp;<span class="op" id="5341289">!=</span>&nbsp;<span class="ident" id="5341292">scanObjectValue</span>&nbsp;<span class="op" id="5341308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341313">d</span><span class="op" id="5341314">.</span><span class="builtintype" id="5341315">error</span><span class="op" id="5341320">(</span><span class="ident" id="5341321">errPhase</span><span class="op" id="5341329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5341333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5341336">}</span><br>
<span class="lineno"></span><span class="op" id="5341338">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="comment" id="5341341">//&nbsp;literal&nbsp;consumes&nbsp;a&nbsp;literal&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="5341421">//&nbsp;The&nbsp;first&nbsp;byte&nbsp;of&nbsp;the&nbsp;literal&nbsp;has&nbsp;been&nbsp;read&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="5341476">//&nbsp;(that&#39;s&nbsp;how&nbsp;the&nbsp;caller&nbsp;knows&nbsp;it&#39;s&nbsp;a&nbsp;literal).</span><br>
<span class="lineno"></span><span class="keyword" id="5341525">func</span>&nbsp;<span class="op" id="5341530">(</span><span class="ident" id="5341531">d</span>&nbsp;<span class="op" id="5341533">*</span><span class="ident" id="5341534">decodeState</span><span class="op" id="5341545">)</span>&nbsp;<span class="ident" id="5341547">literal</span><span class="op" id="5341554">(</span><span class="ident" id="5341555">v</span>&nbsp;<span class="ident" id="5341557">reflect</span><span class="op" id="5341564">.</span><span class="ident" id="5341565">Value</span><span class="op" id="5341570">)</span>&nbsp;<span class="op" id="5341572">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5341575">//&nbsp;All&nbsp;bytes&nbsp;inside&nbsp;literal&nbsp;return&nbsp;scanContinue&nbsp;op&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341633">start</span>&nbsp;<span class="op" id="5341639">:=</span>&nbsp;<span class="ident" id="5341642">d</span><span class="op" id="5341643">.</span><span class="ident" id="5341644">off</span>&nbsp;<span class="op" id="5341648">-</span>&nbsp;<span class="num" id="5341650">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341653">op</span>&nbsp;<span class="op" id="5341656">:=</span>&nbsp;<span class="ident" id="5341659">d</span><span class="op" id="5341660">.</span><span class="ident" id="5341661">scanWhile</span><span class="op" id="5341670">(</span><span class="ident" id="5341671">scanContinue</span><span class="op" id="5341683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5341687">//&nbsp;Scan&nbsp;read&nbsp;one&nbsp;byte&nbsp;too&nbsp;far;&nbsp;back&nbsp;up.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341728">d</span><span class="op" id="5341729">.</span><span class="ident" id="5341730">off</span><span class="op" id="5341733">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341737">d</span><span class="op" id="5341738">.</span><span class="ident" id="5341739">scan</span><span class="op" id="5341743">.</span><span class="ident" id="5341744">undo</span><span class="op" id="5341748">(</span><span class="ident" id="5341749">op</span><span class="op" id="5341751">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5341755">d</span><span class="op" id="5341756">.</span><span class="ident" id="5341757">literalStore</span><span class="op" id="5341769">(</span><span class="ident" id="5341770">d</span><span class="op" id="5341771">.</span><span class="ident" id="5341772">data</span><span class="op" id="5341776">[</span><span class="ident" id="5341777">start</span><span class="op" id="5341782">:</span><span class="ident" id="5341783">d</span><span class="op" id="5341784">.</span><span class="ident" id="5341785">off</span><span class="op" id="5341788">]</span><span class="op" id="5341789">,</span>&nbsp;<span class="ident" id="5341791">v</span><span class="op" id="5341792">,</span>&nbsp;<span class="builtintype" id="5341794">false</span><span class="op" id="5341799">)</span><br>
<span class="lineno"></span><span class="op" id="5341801">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="5341804">//&nbsp;convertNumber&nbsp;converts&nbsp;the&nbsp;number&nbsp;literal&nbsp;s&nbsp;to&nbsp;a&nbsp;float64&nbsp;or&nbsp;a&nbsp;Number</span><br>
<span class="lineno"></span><span class="comment" id="5341876">//&nbsp;depending&nbsp;on&nbsp;the&nbsp;setting&nbsp;of&nbsp;d.useNumber.</span><br>
<span class="lineno"></span><span class="keyword" id="5341920">func</span>&nbsp;<span class="op" id="5341925">(</span><span class="ident" id="5341926">d</span>&nbsp;<span class="op" id="5341928">*</span><span class="ident" id="5341929">decodeState</span><span class="op" id="5341940">)</span>&nbsp;<span class="ident" id="5341942">convertNumber</span><span class="op" id="5341955">(</span><span class="ident" id="5341956">s</span>&nbsp;<span class="builtintype" id="5341958">string</span><span class="op" id="5341964">)</span>&nbsp;<span class="op" id="5341966">(</span><span class="keyword" id="5341967">interface</span><span class="op" id="5341976">{</span><span class="op" id="5341977">}</span><span class="op" id="5341978">,</span>&nbsp;<span class="builtintype" id="5341980">error</span><span class="op" id="5341985">)</span>&nbsp;<span class="op" id="5341987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5341990">if</span>&nbsp;<span class="ident" id="5341993">d</span><span class="op" id="5341994">.</span><span class="ident" id="5341995">useNumber</span>&nbsp;<span class="op" id="5342005">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342009">return</span>&nbsp;<span class="ident" id="5342016">Number</span><span class="op" id="5342022">(</span><span class="ident" id="5342023">s</span><span class="op" id="5342024">)</span><span class="op" id="5342025">,</span>&nbsp;<span class="builtintype" id="5342027">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5342032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5342035">f</span><span class="op" id="5342036">,</span>&nbsp;<span class="ident" id="5342038">err</span>&nbsp;<span class="op" id="5342042">:=</span>&nbsp;<span class="ident" id="5342045">strconv</span><span class="op" id="5342052">.</span><span class="ident" id="5342053">ParseFloat</span><span class="op" id="5342063">(</span><span class="ident" id="5342064">s</span><span class="op" id="5342065">,</span>&nbsp;<span class="num" id="5342067">64</span><span class="op" id="5342069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342072">if</span>&nbsp;<span class="ident" id="5342075">err</span>&nbsp;<span class="op" id="5342079">!=</span>&nbsp;<span class="builtintype" id="5342082">nil</span>&nbsp;<span class="op" id="5342086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342090">return</span>&nbsp;<span class="builtintype" id="5342097">nil</span><span class="op" id="5342100">,</span>&nbsp;<span class="op" id="5342102">&amp;</span><span class="ident" id="5342103">UnmarshalTypeError</span><span class="op" id="5342121">{</span><span class="string" id="5342122">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="5342132">+</span>&nbsp;<span class="ident" id="5342134">s</span><span class="op" id="5342135">,</span>&nbsp;<span class="ident" id="5342137">reflect</span><span class="op" id="5342144">.</span><span class="ident" id="5342145">TypeOf</span><span class="op" id="5342151">(</span><span class="num" id="5342152">0.0</span><span class="op" id="5342155">)</span><span class="op" id="5342156">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5342159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342162">return</span>&nbsp;<span class="ident" id="5342169">f</span><span class="op" id="5342170">,</span>&nbsp;<span class="builtintype" id="5342172">nil</span><br>
<span class="lineno"></span><span class="op" id="5342176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5342179">var</span>&nbsp;<span class="ident" id="5342183">numberType</span>&nbsp;<span class="op" id="5342194">=</span>&nbsp;<span class="ident" id="5342196">reflect</span><span class="op" id="5342203">.</span><span class="ident" id="5342204">TypeOf</span><span class="op" id="5342210">(</span><span class="ident" id="5342211">Number</span><span class="op" id="5342217">(</span><span class="string" id="5342218">&#34;&#34;</span><span class="op" id="5342220">)</span><span class="op" id="5342221">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span><span class="comment" id="5342224">//&nbsp;literalStore&nbsp;decodes&nbsp;a&nbsp;literal&nbsp;stored&nbsp;in&nbsp;item&nbsp;into&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="5342281">//</span><br>
<span class="lineno"></span><span class="comment" id="5342284">//&nbsp;fromQuoted&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;literal&nbsp;came&nbsp;from&nbsp;unwrapping&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5342352">//&nbsp;string&nbsp;from&nbsp;the&nbsp;&#34;,string&#34;&nbsp;struct&nbsp;tag&nbsp;option.&nbsp;this&nbsp;is&nbsp;used&nbsp;only&nbsp;to</span><br>
<span class="lineno">660</span><span class="comment" id="5342421">//&nbsp;produce&nbsp;more&nbsp;helpful&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="5342461">func</span>&nbsp;<span class="op" id="5342466">(</span><span class="ident" id="5342467">d</span>&nbsp;<span class="op" id="5342469">*</span><span class="ident" id="5342470">decodeState</span><span class="op" id="5342481">)</span>&nbsp;<span class="ident" id="5342483">literalStore</span><span class="op" id="5342495">(</span><span class="ident" id="5342496">item</span>&nbsp;<span class="op" id="5342501">[</span><span class="op" id="5342502">]</span><span class="builtintype" id="5342503">byte</span><span class="op" id="5342507">,</span>&nbsp;<span class="ident" id="5342509">v</span>&nbsp;<span class="ident" id="5342511">reflect</span><span class="op" id="5342518">.</span><span class="ident" id="5342519">Value</span><span class="op" id="5342524">,</span>&nbsp;<span class="ident" id="5342526">fromQuoted</span>&nbsp;<span class="builtintype" id="5342537">bool</span><span class="op" id="5342541">)</span>&nbsp;<span class="op" id="5342543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5342546">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342573">if</span>&nbsp;<span class="builtinfunc" id="5342576">len</span><span class="op" id="5342579">(</span><span class="ident" id="5342580">item</span><span class="op" id="5342584">)</span>&nbsp;<span class="op" id="5342586">==</span>&nbsp;<span class="num" id="5342589">0</span>&nbsp;<span class="op" id="5342591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5342595">//Empty&nbsp;string&nbsp;given</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5342618">d</span><span class="op" id="5342619">.</span><span class="ident" id="5342620">saveError</span><span class="op" id="5342629">(</span><span class="ident" id="5342630">fmt</span><span class="op" id="5342633">.</span><span class="ident" id="5342634">Errorf</span><span class="op" id="5342640">(</span><span class="string" id="5342641">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="5342714">,</span>&nbsp;<span class="ident" id="5342716">item</span><span class="op" id="5342720">,</span>&nbsp;<span class="ident" id="5342722">v</span><span class="op" id="5342723">.</span><span class="ident" id="5342724">Type</span><span class="op" id="5342728">(</span><span class="op" id="5342729">)</span><span class="op" id="5342730">)</span><span class="op" id="5342731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342735">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5342743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5342746">wantptr</span>&nbsp;<span class="op" id="5342754">:=</span>&nbsp;<span class="ident" id="5342757">item</span><span class="op" id="5342761">[</span><span class="num" id="5342762">0</span><span class="op" id="5342763">]</span>&nbsp;<span class="op" id="5342765">==</span>&nbsp;<span class="string" id="5342768">&#39;n&#39;</span>&nbsp;<span class="comment" id="5342772">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5342781">u</span><span class="op" id="5342782">,</span>&nbsp;<span class="ident" id="5342784">ut</span><span class="op" id="5342786">,</span>&nbsp;<span class="ident" id="5342788">pv</span>&nbsp;<span class="op" id="5342791">:=</span>&nbsp;<span class="ident" id="5342794">d</span><span class="op" id="5342795">.</span><span class="ident" id="5342796">indirect</span><span class="op" id="5342804">(</span><span class="ident" id="5342805">v</span><span class="op" id="5342806">,</span>&nbsp;<span class="ident" id="5342808">wantptr</span><span class="op" id="5342815">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342818">if</span>&nbsp;<span class="ident" id="5342821">u</span>&nbsp;<span class="op" id="5342823">!=</span>&nbsp;<span class="builtintype" id="5342826">nil</span>&nbsp;<span class="op" id="5342830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5342834">err</span>&nbsp;<span class="op" id="5342838">:=</span>&nbsp;<span class="ident" id="5342841">u</span><span class="op" id="5342842">.</span><span class="ident" id="5342843">UnmarshalJSON</span><span class="op" id="5342856">(</span><span class="ident" id="5342857">item</span><span class="op" id="5342861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342865">if</span>&nbsp;<span class="ident" id="5342868">err</span>&nbsp;<span class="op" id="5342872">!=</span>&nbsp;<span class="builtintype" id="5342875">nil</span>&nbsp;<span class="op" id="5342879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5342884">d</span><span class="op" id="5342885">.</span><span class="builtintype" id="5342886">error</span><span class="op" id="5342891">(</span><span class="ident" id="5342892">err</span><span class="op" id="5342895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5342899">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5342911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342914">if</span>&nbsp;<span class="ident" id="5342917">ut</span>&nbsp;<span class="op" id="5342920">!=</span>&nbsp;<span class="builtintype" id="5342923">nil</span>&nbsp;<span class="op" id="5342927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342931">if</span>&nbsp;<span class="ident" id="5342934">item</span><span class="op" id="5342938">[</span><span class="num" id="5342939">0</span><span class="op" id="5342940">]</span>&nbsp;<span class="op" id="5342942">!=</span>&nbsp;<span class="string" id="5342945">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5342949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5342954">if</span>&nbsp;<span class="ident" id="5342957">fromQuoted</span>&nbsp;<span class="op" id="5342968">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5342974">d</span><span class="op" id="5342975">.</span><span class="ident" id="5342976">saveError</span><span class="op" id="5342985">(</span><span class="ident" id="5342986">fmt</span><span class="op" id="5342989">.</span><span class="ident" id="5342990">Errorf</span><span class="op" id="5342996">(</span><span class="string" id="5342997">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="5343070">,</span>&nbsp;<span class="ident" id="5343072">item</span><span class="op" id="5343076">,</span>&nbsp;<span class="ident" id="5343078">v</span><span class="op" id="5343079">.</span><span class="ident" id="5343080">Type</span><span class="op" id="5343084">(</span><span class="op" id="5343085">)</span><span class="op" id="5343086">)</span><span class="op" id="5343087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343092">}</span>&nbsp;<span class="keyword" id="5343094">else</span>&nbsp;<span class="op" id="5343099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343105">d</span><span class="op" id="5343106">.</span><span class="ident" id="5343107">saveError</span><span class="op" id="5343116">(</span><span class="op" id="5343117">&amp;</span><span class="ident" id="5343118">UnmarshalTypeError</span><span class="op" id="5343136">{</span><span class="string" id="5343137">&#34;string&#34;</span><span class="op" id="5343145">,</span>&nbsp;<span class="ident" id="5343147">v</span><span class="op" id="5343148">.</span><span class="ident" id="5343149">Type</span><span class="op" id="5343153">(</span><span class="op" id="5343154">)</span><span class="op" id="5343155">}</span><span class="op" id="5343156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343165">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343169">s</span><span class="op" id="5343170">,</span>&nbsp;<span class="ident" id="5343172">ok</span>&nbsp;<span class="op" id="5343175">:=</span>&nbsp;<span class="ident" id="5343178">unquoteBytes</span><span class="op" id="5343190">(</span><span class="ident" id="5343191">item</span><span class="op" id="5343195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343199">if</span>&nbsp;<span class="op" id="5343202">!</span><span class="ident" id="5343203">ok</span>&nbsp;<span class="op" id="5343206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343211">if</span>&nbsp;<span class="ident" id="5343214">fromQuoted</span>&nbsp;<span class="op" id="5343225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343231">d</span><span class="op" id="5343232">.</span><span class="builtintype" id="5343233">error</span><span class="op" id="5343238">(</span><span class="ident" id="5343239">fmt</span><span class="op" id="5343242">.</span><span class="ident" id="5343243">Errorf</span><span class="op" id="5343249">(</span><span class="string" id="5343250">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="5343323">,</span>&nbsp;<span class="ident" id="5343325">item</span><span class="op" id="5343329">,</span>&nbsp;<span class="ident" id="5343331">v</span><span class="op" id="5343332">.</span><span class="ident" id="5343333">Type</span><span class="op" id="5343337">(</span><span class="op" id="5343338">)</span><span class="op" id="5343339">)</span><span class="op" id="5343340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343345">}</span>&nbsp;<span class="keyword" id="5343347">else</span>&nbsp;<span class="op" id="5343352">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343358">d</span><span class="op" id="5343359">.</span><span class="builtintype" id="5343360">error</span><span class="op" id="5343365">(</span><span class="ident" id="5343366">errPhase</span><span class="op" id="5343374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343387">err</span>&nbsp;<span class="op" id="5343391">:=</span>&nbsp;<span class="ident" id="5343394">ut</span><span class="op" id="5343396">.</span><span class="ident" id="5343397">UnmarshalText</span><span class="op" id="5343410">(</span><span class="ident" id="5343411">s</span><span class="op" id="5343412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343416">if</span>&nbsp;<span class="ident" id="5343419">err</span>&nbsp;<span class="op" id="5343423">!=</span>&nbsp;<span class="builtintype" id="5343426">nil</span>&nbsp;<span class="op" id="5343430">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343435">d</span><span class="op" id="5343436">.</span><span class="builtintype" id="5343437">error</span><span class="op" id="5343442">(</span><span class="ident" id="5343443">err</span><span class="op" id="5343446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343454">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343466">v</span>&nbsp;<span class="op" id="5343468">=</span>&nbsp;<span class="ident" id="5343470">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343475">switch</span>&nbsp;<span class="ident" id="5343482">c</span>&nbsp;<span class="op" id="5343484">:=</span>&nbsp;<span class="ident" id="5343487">item</span><span class="op" id="5343491">[</span><span class="num" id="5343492">0</span><span class="op" id="5343493">]</span><span class="op" id="5343494">;</span>&nbsp;<span class="ident" id="5343496">c</span>&nbsp;<span class="op" id="5343498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343501">case</span>&nbsp;<span class="string" id="5343506">&#39;n&#39;</span><span class="op" id="5343509">:</span>&nbsp;<span class="comment" id="5343511">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343521">switch</span>&nbsp;<span class="ident" id="5343528">v</span><span class="op" id="5343529">.</span><span class="ident" id="5343530">Kind</span><span class="op" id="5343534">(</span><span class="op" id="5343535">)</span>&nbsp;<span class="op" id="5343537">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343541">case</span>&nbsp;<span class="ident" id="5343546">reflect</span><span class="op" id="5343553">.</span><span class="ident" id="5343554">Interface</span><span class="op" id="5343563">,</span>&nbsp;<span class="ident" id="5343565">reflect</span><span class="op" id="5343572">.</span><span class="ident" id="5343573">Ptr</span><span class="op" id="5343576">,</span>&nbsp;<span class="ident" id="5343578">reflect</span><span class="op" id="5343585">.</span><span class="ident" id="5343586">Map</span><span class="op" id="5343589">,</span>&nbsp;<span class="ident" id="5343591">reflect</span><span class="op" id="5343598">.</span><span class="ident" id="5343599">Slice</span><span class="op" id="5343604">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343609">v</span><span class="op" id="5343610">.</span><span class="ident" id="5343611">Set</span><span class="op" id="5343614">(</span><span class="ident" id="5343615">reflect</span><span class="op" id="5343622">.</span><span class="ident" id="5343623">Zero</span><span class="op" id="5343627">(</span><span class="ident" id="5343628">v</span><span class="op" id="5343629">.</span><span class="ident" id="5343630">Type</span><span class="op" id="5343634">(</span><span class="op" id="5343635">)</span><span class="op" id="5343636">)</span><span class="op" id="5343637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5343642">//&nbsp;otherwise,&nbsp;ignore&nbsp;null&nbsp;for&nbsp;primitives/string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343695">case</span>&nbsp;<span class="string" id="5343700">&#39;t&#39;</span><span class="op" id="5343703">,</span>&nbsp;<span class="string" id="5343705">&#39;f&#39;</span><span class="op" id="5343708">:</span>&nbsp;<span class="comment" id="5343710">//&nbsp;true,&nbsp;false</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343727">value</span>&nbsp;<span class="op" id="5343733">:=</span>&nbsp;<span class="ident" id="5343736">c</span>&nbsp;<span class="op" id="5343738">==</span>&nbsp;<span class="string" id="5343741">&#39;t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343747">switch</span>&nbsp;<span class="ident" id="5343754">v</span><span class="op" id="5343755">.</span><span class="ident" id="5343756">Kind</span><span class="op" id="5343760">(</span><span class="op" id="5343761">)</span>&nbsp;<span class="op" id="5343763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343767">default</span><span class="op" id="5343774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343779">if</span>&nbsp;<span class="ident" id="5343782">fromQuoted</span>&nbsp;<span class="op" id="5343793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343799">d</span><span class="op" id="5343800">.</span><span class="ident" id="5343801">saveError</span><span class="op" id="5343810">(</span><span class="ident" id="5343811">fmt</span><span class="op" id="5343814">.</span><span class="ident" id="5343815">Errorf</span><span class="op" id="5343821">(</span><span class="string" id="5343822">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="5343895">,</span>&nbsp;<span class="ident" id="5343897">item</span><span class="op" id="5343901">,</span>&nbsp;<span class="ident" id="5343903">v</span><span class="op" id="5343904">.</span><span class="ident" id="5343905">Type</span><span class="op" id="5343909">(</span><span class="op" id="5343910">)</span><span class="op" id="5343911">)</span><span class="op" id="5343912">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343917">}</span>&nbsp;<span class="keyword" id="5343919">else</span>&nbsp;<span class="op" id="5343924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5343930">d</span><span class="op" id="5343931">.</span><span class="ident" id="5343932">saveError</span><span class="op" id="5343941">(</span><span class="op" id="5343942">&amp;</span><span class="ident" id="5343943">UnmarshalTypeError</span><span class="op" id="5343961">{</span><span class="string" id="5343962">&#34;bool&#34;</span><span class="op" id="5343968">,</span>&nbsp;<span class="ident" id="5343970">v</span><span class="op" id="5343971">.</span><span class="ident" id="5343972">Type</span><span class="op" id="5343976">(</span><span class="op" id="5343977">)</span><span class="op" id="5343978">}</span><span class="op" id="5343979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5343984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5343988">case</span>&nbsp;<span class="ident" id="5343993">reflect</span><span class="op" id="5344000">.</span><span class="ident" id="5344001">Bool</span><span class="op" id="5344005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344010">v</span><span class="op" id="5344011">.</span><span class="ident" id="5344012">SetBool</span><span class="op" id="5344019">(</span><span class="ident" id="5344020">value</span><span class="op" id="5344025">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344029">case</span>&nbsp;<span class="ident" id="5344034">reflect</span><span class="op" id="5344041">.</span><span class="ident" id="5344042">Interface</span><span class="op" id="5344051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344056">if</span>&nbsp;<span class="ident" id="5344059">v</span><span class="op" id="5344060">.</span><span class="ident" id="5344061">NumMethod</span><span class="op" id="5344070">(</span><span class="op" id="5344071">)</span>&nbsp;<span class="op" id="5344073">==</span>&nbsp;<span class="num" id="5344076">0</span>&nbsp;<span class="op" id="5344078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344084">v</span><span class="op" id="5344085">.</span><span class="ident" id="5344086">Set</span><span class="op" id="5344089">(</span><span class="ident" id="5344090">reflect</span><span class="op" id="5344097">.</span><span class="ident" id="5344098">ValueOf</span><span class="op" id="5344105">(</span><span class="ident" id="5344106">value</span><span class="op" id="5344111">)</span><span class="op" id="5344112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344117">}</span>&nbsp;<span class="keyword" id="5344119">else</span>&nbsp;<span class="op" id="5344124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344130">d</span><span class="op" id="5344131">.</span><span class="ident" id="5344132">saveError</span><span class="op" id="5344141">(</span><span class="op" id="5344142">&amp;</span><span class="ident" id="5344143">UnmarshalTypeError</span><span class="op" id="5344161">{</span><span class="string" id="5344162">&#34;bool&#34;</span><span class="op" id="5344168">,</span>&nbsp;<span class="ident" id="5344170">v</span><span class="op" id="5344171">.</span><span class="ident" id="5344172">Type</span><span class="op" id="5344176">(</span><span class="op" id="5344177">)</span><span class="op" id="5344178">}</span><span class="op" id="5344179">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344192">case</span>&nbsp;<span class="string" id="5344197">&#39;&#34;&#39;</span><span class="op" id="5344200">:</span>&nbsp;<span class="comment" id="5344202">//&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344214">s</span><span class="op" id="5344215">,</span>&nbsp;<span class="ident" id="5344217">ok</span>&nbsp;<span class="op" id="5344220">:=</span>&nbsp;<span class="ident" id="5344223">unquoteBytes</span><span class="op" id="5344235">(</span><span class="ident" id="5344236">item</span><span class="op" id="5344240">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344244">if</span>&nbsp;<span class="op" id="5344247">!</span><span class="ident" id="5344248">ok</span>&nbsp;<span class="op" id="5344251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344256">if</span>&nbsp;<span class="ident" id="5344259">fromQuoted</span>&nbsp;<span class="op" id="5344270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344276">d</span><span class="op" id="5344277">.</span><span class="builtintype" id="5344278">error</span><span class="op" id="5344283">(</span><span class="ident" id="5344284">fmt</span><span class="op" id="5344287">.</span><span class="ident" id="5344288">Errorf</span><span class="op" id="5344294">(</span><span class="string" id="5344295">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="5344368">,</span>&nbsp;<span class="ident" id="5344370">item</span><span class="op" id="5344374">,</span>&nbsp;<span class="ident" id="5344376">v</span><span class="op" id="5344377">.</span><span class="ident" id="5344378">Type</span><span class="op" id="5344382">(</span><span class="op" id="5344383">)</span><span class="op" id="5344384">)</span><span class="op" id="5344385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344390">}</span>&nbsp;<span class="keyword" id="5344392">else</span>&nbsp;<span class="op" id="5344397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344403">d</span><span class="op" id="5344404">.</span><span class="builtintype" id="5344405">error</span><span class="op" id="5344410">(</span><span class="ident" id="5344411">errPhase</span><span class="op" id="5344419">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344432">switch</span>&nbsp;<span class="ident" id="5344439">v</span><span class="op" id="5344440">.</span><span class="ident" id="5344441">Kind</span><span class="op" id="5344445">(</span><span class="op" id="5344446">)</span>&nbsp;<span class="op" id="5344448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344452">default</span><span class="op" id="5344459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344464">d</span><span class="op" id="5344465">.</span><span class="ident" id="5344466">saveError</span><span class="op" id="5344475">(</span><span class="op" id="5344476">&amp;</span><span class="ident" id="5344477">UnmarshalTypeError</span><span class="op" id="5344495">{</span><span class="string" id="5344496">&#34;string&#34;</span><span class="op" id="5344504">,</span>&nbsp;<span class="ident" id="5344506">v</span><span class="op" id="5344507">.</span><span class="ident" id="5344508">Type</span><span class="op" id="5344512">(</span><span class="op" id="5344513">)</span><span class="op" id="5344514">}</span><span class="op" id="5344515">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344519">case</span>&nbsp;<span class="ident" id="5344524">reflect</span><span class="op" id="5344531">.</span><span class="ident" id="5344532">Slice</span><span class="op" id="5344537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344542">if</span>&nbsp;<span class="ident" id="5344545">v</span><span class="op" id="5344546">.</span><span class="ident" id="5344547">Type</span><span class="op" id="5344551">(</span><span class="op" id="5344552">)</span>&nbsp;<span class="op" id="5344554">!=</span>&nbsp;<span class="ident" id="5344557">byteSliceType</span>&nbsp;<span class="op" id="5344571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344577">d</span><span class="op" id="5344578">.</span><span class="ident" id="5344579">saveError</span><span class="op" id="5344588">(</span><span class="op" id="5344589">&amp;</span><span class="ident" id="5344590">UnmarshalTypeError</span><span class="op" id="5344608">{</span><span class="string" id="5344609">&#34;string&#34;</span><span class="op" id="5344617">,</span>&nbsp;<span class="ident" id="5344619">v</span><span class="op" id="5344620">.</span><span class="ident" id="5344621">Type</span><span class="op" id="5344625">(</span><span class="op" id="5344626">)</span><span class="op" id="5344627">}</span><span class="op" id="5344628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344634">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344643">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344648">b</span>&nbsp;<span class="op" id="5344650">:=</span>&nbsp;<span class="builtinfunc" id="5344653">make</span><span class="op" id="5344657">(</span><span class="op" id="5344658">[</span><span class="op" id="5344659">]</span><span class="builtintype" id="5344660">byte</span><span class="op" id="5344664">,</span>&nbsp;<span class="ident" id="5344666">base64</span><span class="op" id="5344672">.</span><span class="ident" id="5344673">StdEncoding</span><span class="op" id="5344684">.</span><span class="ident" id="5344685">DecodedLen</span><span class="op" id="5344695">(</span><span class="builtinfunc" id="5344696">len</span><span class="op" id="5344699">(</span><span class="ident" id="5344700">s</span><span class="op" id="5344701">)</span><span class="op" id="5344702">)</span><span class="op" id="5344703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344708">n</span><span class="op" id="5344709">,</span>&nbsp;<span class="ident" id="5344711">err</span>&nbsp;<span class="op" id="5344715">:=</span>&nbsp;<span class="ident" id="5344718">base64</span><span class="op" id="5344724">.</span><span class="ident" id="5344725">StdEncoding</span><span class="op" id="5344736">.</span><span class="ident" id="5344737">Decode</span><span class="op" id="5344743">(</span><span class="ident" id="5344744">b</span><span class="op" id="5344745">,</span>&nbsp;<span class="ident" id="5344747">s</span><span class="op" id="5344748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344753">if</span>&nbsp;<span class="ident" id="5344756">err</span>&nbsp;<span class="op" id="5344760">!=</span>&nbsp;<span class="builtintype" id="5344763">nil</span>&nbsp;<span class="op" id="5344767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344773">d</span><span class="op" id="5344774">.</span><span class="ident" id="5344775">saveError</span><span class="op" id="5344784">(</span><span class="ident" id="5344785">err</span><span class="op" id="5344788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344794">break</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344808">v</span><span class="op" id="5344809">.</span><span class="ident" id="5344810">Set</span><span class="op" id="5344813">(</span><span class="ident" id="5344814">reflect</span><span class="op" id="5344821">.</span><span class="ident" id="5344822">ValueOf</span><span class="op" id="5344829">(</span><span class="ident" id="5344830">b</span><span class="op" id="5344831">[</span><span class="num" id="5344832">0</span><span class="op" id="5344833">:</span><span class="ident" id="5344834">n</span><span class="op" id="5344835">]</span><span class="op" id="5344836">)</span><span class="op" id="5344837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344841">case</span>&nbsp;<span class="ident" id="5344846">reflect</span><span class="op" id="5344853">.</span><span class="ident" id="5344854">String</span><span class="op" id="5344860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344865">v</span><span class="op" id="5344866">.</span><span class="ident" id="5344867">SetString</span><span class="op" id="5344876">(</span><span class="builtintype" id="5344877">string</span><span class="op" id="5344883">(</span><span class="ident" id="5344884">s</span><span class="op" id="5344885">)</span><span class="op" id="5344886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344890">case</span>&nbsp;<span class="ident" id="5344895">reflect</span><span class="op" id="5344902">.</span><span class="ident" id="5344903">Interface</span><span class="op" id="5344912">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5344917">if</span>&nbsp;<span class="ident" id="5344920">v</span><span class="op" id="5344921">.</span><span class="ident" id="5344922">NumMethod</span><span class="op" id="5344931">(</span><span class="op" id="5344932">)</span>&nbsp;<span class="op" id="5344934">==</span>&nbsp;<span class="num" id="5344937">0</span>&nbsp;<span class="op" id="5344939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344945">v</span><span class="op" id="5344946">.</span><span class="ident" id="5344947">Set</span><span class="op" id="5344950">(</span><span class="ident" id="5344951">reflect</span><span class="op" id="5344958">.</span><span class="ident" id="5344959">ValueOf</span><span class="op" id="5344966">(</span><span class="builtintype" id="5344967">string</span><span class="op" id="5344973">(</span><span class="ident" id="5344974">s</span><span class="op" id="5344975">)</span><span class="op" id="5344976">)</span><span class="op" id="5344977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5344982">}</span>&nbsp;<span class="keyword" id="5344984">else</span>&nbsp;<span class="op" id="5344989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5344995">d</span><span class="op" id="5344996">.</span><span class="ident" id="5344997">saveError</span><span class="op" id="5345006">(</span><span class="op" id="5345007">&amp;</span><span class="ident" id="5345008">UnmarshalTypeError</span><span class="op" id="5345026">{</span><span class="string" id="5345027">&#34;string&#34;</span><span class="op" id="5345035">,</span>&nbsp;<span class="ident" id="5345037">v</span><span class="op" id="5345038">.</span><span class="ident" id="5345039">Type</span><span class="op" id="5345043">(</span><span class="op" id="5345044">)</span><span class="op" id="5345045">}</span><span class="op" id="5345046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345051">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345059">default</span><span class="op" id="5345066">:</span>&nbsp;<span class="comment" id="5345068">//&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345080">if</span>&nbsp;<span class="ident" id="5345083">c</span>&nbsp;<span class="op" id="5345085">!=</span>&nbsp;<span class="string" id="5345088">&#39;-&#39;</span>&nbsp;<span class="op" id="5345092">&amp;&amp;</span>&nbsp;<span class="op" id="5345095">(</span><span class="ident" id="5345096">c</span>&nbsp;<span class="op" id="5345098">&lt;</span>&nbsp;<span class="string" id="5345100">&#39;0&#39;</span>&nbsp;<span class="op" id="5345104">||</span>&nbsp;<span class="ident" id="5345107">c</span>&nbsp;<span class="op" id="5345109">&gt;</span>&nbsp;<span class="string" id="5345111">&#39;9&#39;</span><span class="op" id="5345114">)</span>&nbsp;<span class="op" id="5345116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345121">if</span>&nbsp;<span class="ident" id="5345124">fromQuoted</span>&nbsp;<span class="op" id="5345135">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345141">d</span><span class="op" id="5345142">.</span><span class="builtintype" id="5345143">error</span><span class="op" id="5345148">(</span><span class="ident" id="5345149">fmt</span><span class="op" id="5345152">.</span><span class="ident" id="5345153">Errorf</span><span class="op" id="5345159">(</span><span class="string" id="5345160">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="5345233">,</span>&nbsp;<span class="ident" id="5345235">item</span><span class="op" id="5345239">,</span>&nbsp;<span class="ident" id="5345241">v</span><span class="op" id="5345242">.</span><span class="ident" id="5345243">Type</span><span class="op" id="5345247">(</span><span class="op" id="5345248">)</span><span class="op" id="5345249">)</span><span class="op" id="5345250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345255">}</span>&nbsp;<span class="keyword" id="5345257">else</span>&nbsp;<span class="op" id="5345262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345268">d</span><span class="op" id="5345269">.</span><span class="builtintype" id="5345270">error</span><span class="op" id="5345275">(</span><span class="ident" id="5345276">errPhase</span><span class="op" id="5345284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345293">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345297">s</span>&nbsp;<span class="op" id="5345299">:=</span>&nbsp;<span class="builtintype" id="5345302">string</span><span class="op" id="5345308">(</span><span class="ident" id="5345309">item</span><span class="op" id="5345313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345317">switch</span>&nbsp;<span class="ident" id="5345324">v</span><span class="op" id="5345325">.</span><span class="ident" id="5345326">Kind</span><span class="op" id="5345330">(</span><span class="op" id="5345331">)</span>&nbsp;<span class="op" id="5345333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345337">default</span><span class="op" id="5345344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345349">if</span>&nbsp;<span class="ident" id="5345352">v</span><span class="op" id="5345353">.</span><span class="ident" id="5345354">Kind</span><span class="op" id="5345358">(</span><span class="op" id="5345359">)</span>&nbsp;<span class="op" id="5345361">==</span>&nbsp;<span class="ident" id="5345364">reflect</span><span class="op" id="5345371">.</span><span class="ident" id="5345372">String</span>&nbsp;<span class="op" id="5345379">&amp;&amp;</span>&nbsp;<span class="ident" id="5345382">v</span><span class="op" id="5345383">.</span><span class="ident" id="5345384">Type</span><span class="op" id="5345388">(</span><span class="op" id="5345389">)</span>&nbsp;<span class="op" id="5345391">==</span>&nbsp;<span class="ident" id="5345394">numberType</span>&nbsp;<span class="op" id="5345405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345411">v</span><span class="op" id="5345412">.</span><span class="ident" id="5345413">SetString</span><span class="op" id="5345422">(</span><span class="ident" id="5345423">s</span><span class="op" id="5345424">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345430">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345444">if</span>&nbsp;<span class="ident" id="5345447">fromQuoted</span>&nbsp;<span class="op" id="5345458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345464">d</span><span class="op" id="5345465">.</span><span class="builtintype" id="5345466">error</span><span class="op" id="5345471">(</span><span class="ident" id="5345472">fmt</span><span class="op" id="5345475">.</span><span class="ident" id="5345476">Errorf</span><span class="op" id="5345482">(</span><span class="string" id="5345483">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="5345556">,</span>&nbsp;<span class="ident" id="5345558">item</span><span class="op" id="5345562">,</span>&nbsp;<span class="ident" id="5345564">v</span><span class="op" id="5345565">.</span><span class="ident" id="5345566">Type</span><span class="op" id="5345570">(</span><span class="op" id="5345571">)</span><span class="op" id="5345572">)</span><span class="op" id="5345573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345578">}</span>&nbsp;<span class="keyword" id="5345580">else</span>&nbsp;<span class="op" id="5345585">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345591">d</span><span class="op" id="5345592">.</span><span class="builtintype" id="5345593">error</span><span class="op" id="5345598">(</span><span class="op" id="5345599">&amp;</span><span class="ident" id="5345600">UnmarshalTypeError</span><span class="op" id="5345618">{</span><span class="string" id="5345619">&#34;number&#34;</span><span class="op" id="5345627">,</span>&nbsp;<span class="ident" id="5345629">v</span><span class="op" id="5345630">.</span><span class="ident" id="5345631">Type</span><span class="op" id="5345635">(</span><span class="op" id="5345636">)</span><span class="op" id="5345637">}</span><span class="op" id="5345638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345647">case</span>&nbsp;<span class="ident" id="5345652">reflect</span><span class="op" id="5345659">.</span><span class="ident" id="5345660">Interface</span><span class="op" id="5345669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345674">n</span><span class="op" id="5345675">,</span>&nbsp;<span class="ident" id="5345677">err</span>&nbsp;<span class="op" id="5345681">:=</span>&nbsp;<span class="ident" id="5345684">d</span><span class="op" id="5345685">.</span><span class="ident" id="5345686">convertNumber</span><span class="op" id="5345699">(</span><span class="ident" id="5345700">s</span><span class="op" id="5345701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345706">if</span>&nbsp;<span class="ident" id="5345709">err</span>&nbsp;<span class="op" id="5345713">!=</span>&nbsp;<span class="builtintype" id="5345716">nil</span>&nbsp;<span class="op" id="5345720">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345726">d</span><span class="op" id="5345727">.</span><span class="ident" id="5345728">saveError</span><span class="op" id="5345737">(</span><span class="ident" id="5345738">err</span><span class="op" id="5345741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345747">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345761">if</span>&nbsp;<span class="ident" id="5345764">v</span><span class="op" id="5345765">.</span><span class="ident" id="5345766">NumMethod</span><span class="op" id="5345775">(</span><span class="op" id="5345776">)</span>&nbsp;<span class="op" id="5345778">!=</span>&nbsp;<span class="num" id="5345781">0</span>&nbsp;<span class="op" id="5345783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345789">d</span><span class="op" id="5345790">.</span><span class="ident" id="5345791">saveError</span><span class="op" id="5345800">(</span><span class="op" id="5345801">&amp;</span><span class="ident" id="5345802">UnmarshalTypeError</span><span class="op" id="5345820">{</span><span class="string" id="5345821">&#34;number&#34;</span><span class="op" id="5345829">,</span>&nbsp;<span class="ident" id="5345831">v</span><span class="op" id="5345832">.</span><span class="ident" id="5345833">Type</span><span class="op" id="5345837">(</span><span class="op" id="5345838">)</span><span class="op" id="5345839">}</span><span class="op" id="5345840">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345846">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5345855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345860">v</span><span class="op" id="5345861">.</span><span class="ident" id="5345862">Set</span><span class="op" id="5345865">(</span><span class="ident" id="5345866">reflect</span><span class="op" id="5345873">.</span><span class="ident" id="5345874">ValueOf</span><span class="op" id="5345881">(</span><span class="ident" id="5345882">n</span><span class="op" id="5345883">)</span><span class="op" id="5345884">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5345889">case</span>&nbsp;<span class="ident" id="5345894">reflect</span><span class="op" id="5345901">.</span><span class="ident" id="5345902">Int</span><span class="op" id="5345905">,</span>&nbsp;<span class="ident" id="5345907">reflect</span><span class="op" id="5345914">.</span><span class="ident" id="5345915">Int8</span><span class="op" id="5345919">,</span>&nbsp;<span class="ident" id="5345921">reflect</span><span class="op" id="5345928">.</span><span class="ident" id="5345929">Int16</span><span class="op" id="5345934">,</span>&nbsp;<span class="ident" id="5345936">reflect</span><span class="op" id="5345943">.</span><span class="ident" id="5345944">Int32</span><span class="op" id="5345949">,</span>&nbsp;<span class="ident" id="5345951">reflect</span><span class="op" id="5345958">.</span><span class="ident" id="5345959">Int64</span><span class="op" id="5345964">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5345969">n</span><span class="op" id="5345970">,</span>&nbsp;<span class="ident" id="5345972">err</span>&nbsp;<span class="op" id="5345976">:=</span>&nbsp;<span class="ident" id="5345979">strconv</span><span class="op" id="5345986">.</span><span class="ident" id="5345987">ParseInt</span><span class="op" id="5345995">(</span><span class="ident" id="5345996">s</span><span class="op" id="5345997">,</span>&nbsp;<span class="num" id="5345999">10</span><span class="op" id="5346001">,</span>&nbsp;<span class="num" id="5346003">64</span><span class="op" id="5346005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346010">if</span>&nbsp;<span class="ident" id="5346013">err</span>&nbsp;<span class="op" id="5346017">!=</span>&nbsp;<span class="builtintype" id="5346020">nil</span>&nbsp;<span class="op" id="5346024">||</span>&nbsp;<span class="ident" id="5346027">v</span><span class="op" id="5346028">.</span><span class="ident" id="5346029">OverflowInt</span><span class="op" id="5346040">(</span><span class="ident" id="5346041">n</span><span class="op" id="5346042">)</span>&nbsp;<span class="op" id="5346044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346050">d</span><span class="op" id="5346051">.</span><span class="ident" id="5346052">saveError</span><span class="op" id="5346061">(</span><span class="op" id="5346062">&amp;</span><span class="ident" id="5346063">UnmarshalTypeError</span><span class="op" id="5346081">{</span><span class="string" id="5346082">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="5346092">+</span>&nbsp;<span class="ident" id="5346094">s</span><span class="op" id="5346095">,</span>&nbsp;<span class="ident" id="5346097">v</span><span class="op" id="5346098">.</span><span class="ident" id="5346099">Type</span><span class="op" id="5346103">(</span><span class="op" id="5346104">)</span><span class="op" id="5346105">}</span><span class="op" id="5346106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346112">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5346121">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346126">v</span><span class="op" id="5346127">.</span><span class="ident" id="5346128">SetInt</span><span class="op" id="5346134">(</span><span class="ident" id="5346135">n</span><span class="op" id="5346136">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346141">case</span>&nbsp;<span class="ident" id="5346146">reflect</span><span class="op" id="5346153">.</span><span class="ident" id="5346154">Uint</span><span class="op" id="5346158">,</span>&nbsp;<span class="ident" id="5346160">reflect</span><span class="op" id="5346167">.</span><span class="ident" id="5346168">Uint8</span><span class="op" id="5346173">,</span>&nbsp;<span class="ident" id="5346175">reflect</span><span class="op" id="5346182">.</span><span class="ident" id="5346183">Uint16</span><span class="op" id="5346189">,</span>&nbsp;<span class="ident" id="5346191">reflect</span><span class="op" id="5346198">.</span><span class="ident" id="5346199">Uint32</span><span class="op" id="5346205">,</span>&nbsp;<span class="ident" id="5346207">reflect</span><span class="op" id="5346214">.</span><span class="ident" id="5346215">Uint64</span><span class="op" id="5346221">,</span>&nbsp;<span class="ident" id="5346223">reflect</span><span class="op" id="5346230">.</span><span class="ident" id="5346231">Uintptr</span><span class="op" id="5346238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346243">n</span><span class="op" id="5346244">,</span>&nbsp;<span class="ident" id="5346246">err</span>&nbsp;<span class="op" id="5346250">:=</span>&nbsp;<span class="ident" id="5346253">strconv</span><span class="op" id="5346260">.</span><span class="ident" id="5346261">ParseUint</span><span class="op" id="5346270">(</span><span class="ident" id="5346271">s</span><span class="op" id="5346272">,</span>&nbsp;<span class="num" id="5346274">10</span><span class="op" id="5346276">,</span>&nbsp;<span class="num" id="5346278">64</span><span class="op" id="5346280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346285">if</span>&nbsp;<span class="ident" id="5346288">err</span>&nbsp;<span class="op" id="5346292">!=</span>&nbsp;<span class="builtintype" id="5346295">nil</span>&nbsp;<span class="op" id="5346299">||</span>&nbsp;<span class="ident" id="5346302">v</span><span class="op" id="5346303">.</span><span class="ident" id="5346304">OverflowUint</span><span class="op" id="5346316">(</span><span class="ident" id="5346317">n</span><span class="op" id="5346318">)</span>&nbsp;<span class="op" id="5346320">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346326">d</span><span class="op" id="5346327">.</span><span class="ident" id="5346328">saveError</span><span class="op" id="5346337">(</span><span class="op" id="5346338">&amp;</span><span class="ident" id="5346339">UnmarshalTypeError</span><span class="op" id="5346357">{</span><span class="string" id="5346358">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="5346368">+</span>&nbsp;<span class="ident" id="5346370">s</span><span class="op" id="5346371">,</span>&nbsp;<span class="ident" id="5346373">v</span><span class="op" id="5346374">.</span><span class="ident" id="5346375">Type</span><span class="op" id="5346379">(</span><span class="op" id="5346380">)</span><span class="op" id="5346381">}</span><span class="op" id="5346382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346388">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5346397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346402">v</span><span class="op" id="5346403">.</span><span class="ident" id="5346404">SetUint</span><span class="op" id="5346411">(</span><span class="ident" id="5346412">n</span><span class="op" id="5346413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346418">case</span>&nbsp;<span class="ident" id="5346423">reflect</span><span class="op" id="5346430">.</span><span class="ident" id="5346431">Float32</span><span class="op" id="5346438">,</span>&nbsp;<span class="ident" id="5346440">reflect</span><span class="op" id="5346447">.</span><span class="ident" id="5346448">Float64</span><span class="op" id="5346455">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346460">n</span><span class="op" id="5346461">,</span>&nbsp;<span class="ident" id="5346463">err</span>&nbsp;<span class="op" id="5346467">:=</span>&nbsp;<span class="ident" id="5346470">strconv</span><span class="op" id="5346477">.</span><span class="ident" id="5346478">ParseFloat</span><span class="op" id="5346488">(</span><span class="ident" id="5346489">s</span><span class="op" id="5346490">,</span>&nbsp;<span class="ident" id="5346492">v</span><span class="op" id="5346493">.</span><span class="ident" id="5346494">Type</span><span class="op" id="5346498">(</span><span class="op" id="5346499">)</span><span class="op" id="5346500">.</span><span class="ident" id="5346501">Bits</span><span class="op" id="5346505">(</span><span class="op" id="5346506">)</span><span class="op" id="5346507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346512">if</span>&nbsp;<span class="ident" id="5346515">err</span>&nbsp;<span class="op" id="5346519">!=</span>&nbsp;<span class="builtintype" id="5346522">nil</span>&nbsp;<span class="op" id="5346526">||</span>&nbsp;<span class="ident" id="5346529">v</span><span class="op" id="5346530">.</span><span class="ident" id="5346531">OverflowFloat</span><span class="op" id="5346544">(</span><span class="ident" id="5346545">n</span><span class="op" id="5346546">)</span>&nbsp;<span class="op" id="5346548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346554">d</span><span class="op" id="5346555">.</span><span class="ident" id="5346556">saveError</span><span class="op" id="5346565">(</span><span class="op" id="5346566">&amp;</span><span class="ident" id="5346567">UnmarshalTypeError</span><span class="op" id="5346585">{</span><span class="string" id="5346586">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="5346596">+</span>&nbsp;<span class="ident" id="5346598">s</span><span class="op" id="5346599">,</span>&nbsp;<span class="ident" id="5346601">v</span><span class="op" id="5346602">.</span><span class="ident" id="5346603">Type</span><span class="op" id="5346607">(</span><span class="op" id="5346608">)</span><span class="op" id="5346609">}</span><span class="op" id="5346610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346616">break</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5346625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346630">v</span><span class="op" id="5346631">.</span><span class="ident" id="5346632">SetFloat</span><span class="op" id="5346640">(</span><span class="ident" id="5346641">n</span><span class="op" id="5346642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5346646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5346649">}</span><br>
<span class="lineno"></span><span class="op" id="5346651">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="comment" id="5346654">//&nbsp;The&nbsp;xxxInterface&nbsp;routines&nbsp;build&nbsp;up&nbsp;a&nbsp;value&nbsp;to&nbsp;be&nbsp;stored</span><br>
<span class="lineno"></span><span class="comment" id="5346713">//&nbsp;in&nbsp;an&nbsp;empty&nbsp;interface.&nbsp;&nbsp;They&nbsp;are&nbsp;not&nbsp;strictly&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="5346773">//&nbsp;but&nbsp;they&nbsp;avoid&nbsp;the&nbsp;weight&nbsp;of&nbsp;reflection&nbsp;in&nbsp;this&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="5346838">//&nbsp;valueInterface&nbsp;is&nbsp;like&nbsp;value&nbsp;but&nbsp;returns&nbsp;interface{}</span><br>
<span class="lineno"></span><span class="keyword" id="5346894">func</span>&nbsp;<span class="op" id="5346899">(</span><span class="ident" id="5346900">d</span>&nbsp;<span class="op" id="5346902">*</span><span class="ident" id="5346903">decodeState</span><span class="op" id="5346914">)</span>&nbsp;<span class="ident" id="5346916">valueInterface</span><span class="op" id="5346930">(</span><span class="op" id="5346931">)</span>&nbsp;<span class="keyword" id="5346933">interface</span><span class="op" id="5346942">{</span><span class="op" id="5346943">}</span>&nbsp;<span class="op" id="5346945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346948">switch</span>&nbsp;<span class="ident" id="5346955">d</span><span class="op" id="5346956">.</span><span class="ident" id="5346957">scanWhile</span><span class="op" id="5346966">(</span><span class="ident" id="5346967">scanSkipSpace</span><span class="op" id="5346980">)</span>&nbsp;<span class="op" id="5346982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5346985">default</span><span class="op" id="5346992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5346996">d</span><span class="op" id="5346997">.</span><span class="builtintype" id="5346998">error</span><span class="op" id="5347003">(</span><span class="ident" id="5347004">errPhase</span><span class="op" id="5347012">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5347016">panic</span><span class="op" id="5347021">(</span><span class="string" id="5347022">&#34;unreachable&#34;</span><span class="op" id="5347035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347038">case</span>&nbsp;<span class="ident" id="5347043">scanBeginArray</span><span class="op" id="5347057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347061">return</span>&nbsp;<span class="ident" id="5347068">d</span><span class="op" id="5347069">.</span><span class="ident" id="5347070">arrayInterface</span><span class="op" id="5347084">(</span><span class="op" id="5347085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347088">case</span>&nbsp;<span class="ident" id="5347093">scanBeginObject</span><span class="op" id="5347108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347112">return</span>&nbsp;<span class="ident" id="5347119">d</span><span class="op" id="5347120">.</span><span class="ident" id="5347121">objectInterface</span><span class="op" id="5347136">(</span><span class="op" id="5347137">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347140">case</span>&nbsp;<span class="ident" id="5347145">scanBeginLiteral</span><span class="op" id="5347161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347165">return</span>&nbsp;<span class="ident" id="5347172">d</span><span class="op" id="5347173">.</span><span class="ident" id="5347174">literalInterface</span><span class="op" id="5347190">(</span><span class="op" id="5347191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5347194">}</span><br>
<span class="lineno"></span><span class="op" id="5347196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="5347199">//&nbsp;arrayInterface&nbsp;is&nbsp;like&nbsp;array&nbsp;but&nbsp;returns&nbsp;[]interface{}.</span><br>
<span class="lineno"></span><span class="keyword" id="5347258">func</span>&nbsp;<span class="op" id="5347263">(</span><span class="ident" id="5347264">d</span>&nbsp;<span class="op" id="5347266">*</span><span class="ident" id="5347267">decodeState</span><span class="op" id="5347278">)</span>&nbsp;<span class="ident" id="5347280">arrayInterface</span><span class="op" id="5347294">(</span><span class="op" id="5347295">)</span>&nbsp;<span class="op" id="5347297">[</span><span class="op" id="5347298">]</span><span class="keyword" id="5347299">interface</span><span class="op" id="5347308">{</span><span class="op" id="5347309">}</span>&nbsp;<span class="op" id="5347311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347314">var</span>&nbsp;<span class="ident" id="5347318">v</span>&nbsp;<span class="op" id="5347320">=</span>&nbsp;<span class="builtinfunc" id="5347322">make</span><span class="op" id="5347326">(</span><span class="op" id="5347327">[</span><span class="op" id="5347328">]</span><span class="keyword" id="5347329">interface</span><span class="op" id="5347338">{</span><span class="op" id="5347339">}</span><span class="op" id="5347340">,</span>&nbsp;<span class="num" id="5347342">0</span><span class="op" id="5347343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347346">for</span>&nbsp;<span class="op" id="5347350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347354">//&nbsp;Look&nbsp;ahead&nbsp;for&nbsp;]&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5347414">op</span>&nbsp;<span class="op" id="5347417">:=</span>&nbsp;<span class="ident" id="5347420">d</span><span class="op" id="5347421">.</span><span class="ident" id="5347422">scanWhile</span><span class="op" id="5347431">(</span><span class="ident" id="5347432">scanSkipSpace</span><span class="op" id="5347445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347449">if</span>&nbsp;<span class="ident" id="5347452">op</span>&nbsp;<span class="op" id="5347455">==</span>&nbsp;<span class="ident" id="5347458">scanEndArray</span>&nbsp;<span class="op" id="5347471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347476">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5347484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347489">//&nbsp;Back&nbsp;up&nbsp;so&nbsp;d.value&nbsp;can&nbsp;have&nbsp;the&nbsp;byte&nbsp;we&nbsp;just&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5347545">d</span><span class="op" id="5347546">.</span><span class="ident" id="5347547">off</span><span class="op" id="5347550">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5347555">d</span><span class="op" id="5347556">.</span><span class="ident" id="5347557">scan</span><span class="op" id="5347561">.</span><span class="ident" id="5347562">undo</span><span class="op" id="5347566">(</span><span class="ident" id="5347567">op</span><span class="op" id="5347569">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5347574">v</span>&nbsp;<span class="op" id="5347576">=</span>&nbsp;<span class="builtinfunc" id="5347578">append</span><span class="op" id="5347584">(</span><span class="ident" id="5347585">v</span><span class="op" id="5347586">,</span>&nbsp;<span class="ident" id="5347588">d</span><span class="op" id="5347589">.</span><span class="ident" id="5347590">valueInterface</span><span class="op" id="5347604">(</span><span class="op" id="5347605">)</span><span class="op" id="5347606">)</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347611">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5347643">op</span>&nbsp;<span class="op" id="5347646">=</span>&nbsp;<span class="ident" id="5347648">d</span><span class="op" id="5347649">.</span><span class="ident" id="5347650">scanWhile</span><span class="op" id="5347659">(</span><span class="ident" id="5347660">scanSkipSpace</span><span class="op" id="5347673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347677">if</span>&nbsp;<span class="ident" id="5347680">op</span>&nbsp;<span class="op" id="5347683">==</span>&nbsp;<span class="ident" id="5347686">scanEndArray</span>&nbsp;<span class="op" id="5347699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347704">break</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5347712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347716">if</span>&nbsp;<span class="ident" id="5347719">op</span>&nbsp;<span class="op" id="5347722">!=</span>&nbsp;<span class="ident" id="5347725">scanArrayValue</span>&nbsp;<span class="op" id="5347740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5347745">d</span><span class="op" id="5347746">.</span><span class="builtintype" id="5347747">error</span><span class="op" id="5347752">(</span><span class="ident" id="5347753">errPhase</span><span class="op" id="5347761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5347765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5347768">}</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347771">return</span>&nbsp;<span class="ident" id="5347778">v</span><br>
<span class="lineno"></span><span class="op" id="5347780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5347783">//&nbsp;objectInterface&nbsp;is&nbsp;like&nbsp;object&nbsp;but&nbsp;returns&nbsp;map[string]interface{}.</span><br>
<span class="lineno"></span><span class="keyword" id="5347853">func</span>&nbsp;<span class="op" id="5347858">(</span><span class="ident" id="5347859">d</span>&nbsp;<span class="op" id="5347861">*</span><span class="ident" id="5347862">decodeState</span><span class="op" id="5347873">)</span>&nbsp;<span class="ident" id="5347875">objectInterface</span><span class="op" id="5347890">(</span><span class="op" id="5347891">)</span>&nbsp;<span class="keyword" id="5347893">map</span><span class="op" id="5347896">[</span><span class="builtintype" id="5347897">string</span><span class="op" id="5347903">]</span><span class="keyword" id="5347904">interface</span><span class="op" id="5347913">{</span><span class="op" id="5347914">}</span>&nbsp;<span class="op" id="5347916">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5347919">m</span>&nbsp;<span class="op" id="5347921">:=</span>&nbsp;<span class="builtinfunc" id="5347924">make</span><span class="op" id="5347928">(</span><span class="keyword" id="5347929">map</span><span class="op" id="5347932">[</span><span class="builtintype" id="5347933">string</span><span class="op" id="5347939">]</span><span class="keyword" id="5347940">interface</span><span class="op" id="5347949">{</span><span class="op" id="5347950">}</span><span class="op" id="5347951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5347954">for</span>&nbsp;<span class="op" id="5347958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5347962">//&nbsp;Read&nbsp;opening&nbsp;&#34;&nbsp;of&nbsp;string&nbsp;key&nbsp;or&nbsp;closing&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348010">op</span>&nbsp;<span class="op" id="5348013">:=</span>&nbsp;<span class="ident" id="5348016">d</span><span class="op" id="5348017">.</span><span class="ident" id="5348018">scanWhile</span><span class="op" id="5348027">(</span><span class="ident" id="5348028">scanSkipSpace</span><span class="op" id="5348041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348045">if</span>&nbsp;<span class="ident" id="5348048">op</span>&nbsp;<span class="op" id="5348051">==</span>&nbsp;<span class="ident" id="5348054">scanEndObject</span>&nbsp;<span class="op" id="5348068">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348073">//&nbsp;closing&nbsp;}&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348127">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5348135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348139">if</span>&nbsp;<span class="ident" id="5348142">op</span>&nbsp;<span class="op" id="5348145">!=</span>&nbsp;<span class="ident" id="5348148">scanBeginLiteral</span>&nbsp;<span class="op" id="5348165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348170">d</span><span class="op" id="5348171">.</span><span class="builtintype" id="5348172">error</span><span class="op" id="5348177">(</span><span class="ident" id="5348178">errPhase</span><span class="op" id="5348186">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5348190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348195">//&nbsp;Read&nbsp;string&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348217">start</span>&nbsp;<span class="op" id="5348223">:=</span>&nbsp;<span class="ident" id="5348226">d</span><span class="op" id="5348227">.</span><span class="ident" id="5348228">off</span>&nbsp;<span class="op" id="5348232">-</span>&nbsp;<span class="num" id="5348234">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348238">op</span>&nbsp;<span class="op" id="5348241">=</span>&nbsp;<span class="ident" id="5348243">d</span><span class="op" id="5348244">.</span><span class="ident" id="5348245">scanWhile</span><span class="op" id="5348254">(</span><span class="ident" id="5348255">scanContinue</span><span class="op" id="5348267">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348271">item</span>&nbsp;<span class="op" id="5348276">:=</span>&nbsp;<span class="ident" id="5348279">d</span><span class="op" id="5348280">.</span><span class="ident" id="5348281">data</span><span class="op" id="5348285">[</span><span class="ident" id="5348286">start</span>&nbsp;<span class="op" id="5348292">:</span>&nbsp;<span class="ident" id="5348294">d</span><span class="op" id="5348295">.</span><span class="ident" id="5348296">off</span><span class="op" id="5348299">-</span><span class="num" id="5348300">1</span><span class="op" id="5348301">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348305">key</span><span class="op" id="5348308">,</span>&nbsp;<span class="ident" id="5348310">ok</span>&nbsp;<span class="op" id="5348313">:=</span>&nbsp;<span class="ident" id="5348316">unquote</span><span class="op" id="5348323">(</span><span class="ident" id="5348324">item</span><span class="op" id="5348328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348332">if</span>&nbsp;<span class="op" id="5348335">!</span><span class="ident" id="5348336">ok</span>&nbsp;<span class="op" id="5348339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348344">d</span><span class="op" id="5348345">.</span><span class="builtintype" id="5348346">error</span><span class="op" id="5348351">(</span><span class="ident" id="5348352">errPhase</span><span class="op" id="5348360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5348364">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348369">//&nbsp;Read&nbsp;:&nbsp;before&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348395">if</span>&nbsp;<span class="ident" id="5348398">op</span>&nbsp;<span class="op" id="5348401">==</span>&nbsp;<span class="ident" id="5348404">scanSkipSpace</span>&nbsp;<span class="op" id="5348418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348423">op</span>&nbsp;<span class="op" id="5348426">=</span>&nbsp;<span class="ident" id="5348428">d</span><span class="op" id="5348429">.</span><span class="ident" id="5348430">scanWhile</span><span class="op" id="5348439">(</span><span class="ident" id="5348440">scanSkipSpace</span><span class="op" id="5348453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5348457">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348461">if</span>&nbsp;<span class="ident" id="5348464">op</span>&nbsp;<span class="op" id="5348467">!=</span>&nbsp;<span class="ident" id="5348470">scanObjectKey</span>&nbsp;<span class="op" id="5348484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348489">d</span><span class="op" id="5348490">.</span><span class="builtintype" id="5348491">error</span><span class="op" id="5348496">(</span><span class="ident" id="5348497">errPhase</span><span class="op" id="5348505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5348509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348514">//&nbsp;Read&nbsp;value.</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348531">m</span><span class="op" id="5348532">[</span><span class="ident" id="5348533">key</span><span class="op" id="5348536">]</span>&nbsp;<span class="op" id="5348538">=</span>&nbsp;<span class="ident" id="5348540">d</span><span class="op" id="5348541">.</span><span class="ident" id="5348542">valueInterface</span><span class="op" id="5348556">(</span><span class="op" id="5348557">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348562">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348594">op</span>&nbsp;<span class="op" id="5348597">=</span>&nbsp;<span class="ident" id="5348599">d</span><span class="op" id="5348600">.</span><span class="ident" id="5348601">scanWhile</span><span class="op" id="5348610">(</span><span class="ident" id="5348611">scanSkipSpace</span><span class="op" id="5348624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348628">if</span>&nbsp;<span class="ident" id="5348631">op</span>&nbsp;<span class="op" id="5348634">==</span>&nbsp;<span class="ident" id="5348637">scanEndObject</span>&nbsp;<span class="op" id="5348651">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348656">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5348664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348668">if</span>&nbsp;<span class="ident" id="5348671">op</span>&nbsp;<span class="op" id="5348674">!=</span>&nbsp;<span class="ident" id="5348677">scanObjectValue</span>&nbsp;<span class="op" id="5348693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348698">d</span><span class="op" id="5348699">.</span><span class="builtintype" id="5348700">error</span><span class="op" id="5348705">(</span><span class="ident" id="5348706">errPhase</span><span class="op" id="5348714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5348718">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5348721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5348724">return</span>&nbsp;<span class="ident" id="5348731">m</span><br>
<span class="lineno"></span><span class="op" id="5348733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5348736">//&nbsp;literalInterface&nbsp;is&nbsp;like&nbsp;literal&nbsp;but&nbsp;returns&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno">915</span><span class="keyword" id="5348804">func</span>&nbsp;<span class="op" id="5348809">(</span><span class="ident" id="5348810">d</span>&nbsp;<span class="op" id="5348812">*</span><span class="ident" id="5348813">decodeState</span><span class="op" id="5348824">)</span>&nbsp;<span class="ident" id="5348826">literalInterface</span><span class="op" id="5348842">(</span><span class="op" id="5348843">)</span>&nbsp;<span class="keyword" id="5348845">interface</span><span class="op" id="5348854">{</span><span class="op" id="5348855">}</span>&nbsp;<span class="op" id="5348857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348860">//&nbsp;All&nbsp;bytes&nbsp;inside&nbsp;literal&nbsp;return&nbsp;scanContinue&nbsp;op&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348918">start</span>&nbsp;<span class="op" id="5348924">:=</span>&nbsp;<span class="ident" id="5348927">d</span><span class="op" id="5348928">.</span><span class="ident" id="5348929">off</span>&nbsp;<span class="op" id="5348933">-</span>&nbsp;<span class="num" id="5348935">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5348938">op</span>&nbsp;<span class="op" id="5348941">:=</span>&nbsp;<span class="ident" id="5348944">d</span><span class="op" id="5348945">.</span><span class="ident" id="5348946">scanWhile</span><span class="op" id="5348955">(</span><span class="ident" id="5348956">scanContinue</span><span class="op" id="5348968">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5348972">//&nbsp;Scan&nbsp;read&nbsp;one&nbsp;byte&nbsp;too&nbsp;far;&nbsp;back&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349013">d</span><span class="op" id="5349014">.</span><span class="ident" id="5349015">off</span><span class="op" id="5349018">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349022">d</span><span class="op" id="5349023">.</span><span class="ident" id="5349024">scan</span><span class="op" id="5349028">.</span><span class="ident" id="5349029">undo</span><span class="op" id="5349033">(</span><span class="ident" id="5349034">op</span><span class="op" id="5349036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349039">item</span>&nbsp;<span class="op" id="5349044">:=</span>&nbsp;<span class="ident" id="5349047">d</span><span class="op" id="5349048">.</span><span class="ident" id="5349049">data</span><span class="op" id="5349053">[</span><span class="ident" id="5349054">start</span><span class="op" id="5349059">:</span><span class="ident" id="5349060">d</span><span class="op" id="5349061">.</span><span class="ident" id="5349062">off</span><span class="op" id="5349065">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349069">switch</span>&nbsp;<span class="ident" id="5349076">c</span>&nbsp;<span class="op" id="5349078">:=</span>&nbsp;<span class="ident" id="5349081">item</span><span class="op" id="5349085">[</span><span class="num" id="5349086">0</span><span class="op" id="5349087">]</span><span class="op" id="5349088">;</span>&nbsp;<span class="ident" id="5349090">c</span>&nbsp;<span class="op" id="5349092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349095">case</span>&nbsp;<span class="string" id="5349100">&#39;n&#39;</span><span class="op" id="5349103">:</span>&nbsp;<span class="comment" id="5349105">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349115">return</span>&nbsp;<span class="builtintype" id="5349122">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349128">case</span>&nbsp;<span class="string" id="5349133">&#39;t&#39;</span><span class="op" id="5349136">,</span>&nbsp;<span class="string" id="5349138">&#39;f&#39;</span><span class="op" id="5349141">:</span>&nbsp;<span class="comment" id="5349143">//&nbsp;true,&nbsp;false</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349160">return</span>&nbsp;<span class="ident" id="5349167">c</span>&nbsp;<span class="op" id="5349169">==</span>&nbsp;<span class="string" id="5349172">&#39;t&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349178">case</span>&nbsp;<span class="string" id="5349183">&#39;&#34;&#39;</span><span class="op" id="5349186">:</span>&nbsp;<span class="comment" id="5349188">//&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349200">s</span><span class="op" id="5349201">,</span>&nbsp;<span class="ident" id="5349203">ok</span>&nbsp;<span class="op" id="5349206">:=</span>&nbsp;<span class="ident" id="5349209">unquote</span><span class="op" id="5349216">(</span><span class="ident" id="5349217">item</span><span class="op" id="5349221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349225">if</span>&nbsp;<span class="op" id="5349228">!</span><span class="ident" id="5349229">ok</span>&nbsp;<span class="op" id="5349232">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349237">d</span><span class="op" id="5349238">.</span><span class="builtintype" id="5349239">error</span><span class="op" id="5349244">(</span><span class="ident" id="5349245">errPhase</span><span class="op" id="5349253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5349257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349261">return</span>&nbsp;<span class="ident" id="5349268">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349272">default</span><span class="op" id="5349279">:</span>&nbsp;<span class="comment" id="5349281">//&nbsp;number</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349293">if</span>&nbsp;<span class="ident" id="5349296">c</span>&nbsp;<span class="op" id="5349298">!=</span>&nbsp;<span class="string" id="5349301">&#39;-&#39;</span>&nbsp;<span class="op" id="5349305">&amp;&amp;</span>&nbsp;<span class="op" id="5349308">(</span><span class="ident" id="5349309">c</span>&nbsp;<span class="op" id="5349311">&lt;</span>&nbsp;<span class="string" id="5349313">&#39;0&#39;</span>&nbsp;<span class="op" id="5349317">||</span>&nbsp;<span class="ident" id="5349320">c</span>&nbsp;<span class="op" id="5349322">&gt;</span>&nbsp;<span class="string" id="5349324">&#39;9&#39;</span><span class="op" id="5349327">)</span>&nbsp;<span class="op" id="5349329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349334">d</span><span class="op" id="5349335">.</span><span class="builtintype" id="5349336">error</span><span class="op" id="5349341">(</span><span class="ident" id="5349342">errPhase</span><span class="op" id="5349350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5349354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349358">n</span><span class="op" id="5349359">,</span>&nbsp;<span class="ident" id="5349361">err</span>&nbsp;<span class="op" id="5349365">:=</span>&nbsp;<span class="ident" id="5349368">d</span><span class="op" id="5349369">.</span><span class="ident" id="5349370">convertNumber</span><span class="op" id="5349383">(</span><span class="builtintype" id="5349384">string</span><span class="op" id="5349390">(</span><span class="ident" id="5349391">item</span><span class="op" id="5349395">)</span><span class="op" id="5349396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349400">if</span>&nbsp;<span class="ident" id="5349403">err</span>&nbsp;<span class="op" id="5349407">!=</span>&nbsp;<span class="builtintype" id="5349410">nil</span>&nbsp;<span class="op" id="5349414">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349419">d</span><span class="op" id="5349420">.</span><span class="ident" id="5349421">saveError</span><span class="op" id="5349430">(</span><span class="ident" id="5349431">err</span><span class="op" id="5349434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5349438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349442">return</span>&nbsp;<span class="ident" id="5349449">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5349452">}</span><br>
<span class="lineno"></span><span class="op" id="5349454">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="comment" id="5349457">//&nbsp;getu4&nbsp;decodes&nbsp;\uXXXX&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s,&nbsp;returning&nbsp;the&nbsp;hex&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5349531">//&nbsp;or&nbsp;it&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="5349552">func</span>&nbsp;<span class="ident" id="5349557">getu4</span><span class="op" id="5349562">(</span><span class="ident" id="5349563">s</span>&nbsp;<span class="op" id="5349565">[</span><span class="op" id="5349566">]</span><span class="builtintype" id="5349567">byte</span><span class="op" id="5349571">)</span>&nbsp;<span class="builtintype" id="5349573">rune</span>&nbsp;<span class="op" id="5349578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349581">if</span>&nbsp;<span class="builtinfunc" id="5349584">len</span><span class="op" id="5349587">(</span><span class="ident" id="5349588">s</span><span class="op" id="5349589">)</span>&nbsp;<span class="op" id="5349591">&lt;</span>&nbsp;<span class="num" id="5349593">6</span>&nbsp;<span class="op" id="5349595">||</span>&nbsp;<span class="ident" id="5349598">s</span><span class="op" id="5349599">[</span><span class="num" id="5349600">0</span><span class="op" id="5349601">]</span>&nbsp;<span class="op" id="5349603">!=</span>&nbsp;<span class="string" id="5349606">&#39;\\&#39;</span>&nbsp;<span class="op" id="5349611">||</span>&nbsp;<span class="ident" id="5349614">s</span><span class="op" id="5349615">[</span><span class="num" id="5349616">1</span><span class="op" id="5349617">]</span>&nbsp;<span class="op" id="5349619">!=</span>&nbsp;<span class="string" id="5349622">&#39;u&#39;</span>&nbsp;<span class="op" id="5349626">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349630">return</span>&nbsp;<span class="op" id="5349637">-</span><span class="num" id="5349638">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5349641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349644">r</span><span class="op" id="5349645">,</span>&nbsp;<span class="ident" id="5349647">err</span>&nbsp;<span class="op" id="5349651">:=</span>&nbsp;<span class="ident" id="5349654">strconv</span><span class="op" id="5349661">.</span><span class="ident" id="5349662">ParseUint</span><span class="op" id="5349671">(</span><span class="builtintype" id="5349672">string</span><span class="op" id="5349678">(</span><span class="ident" id="5349679">s</span><span class="op" id="5349680">[</span><span class="num" id="5349681">2</span><span class="op" id="5349682">:</span><span class="num" id="5349683">6</span><span class="op" id="5349684">]</span><span class="op" id="5349685">)</span><span class="op" id="5349686">,</span>&nbsp;<span class="num" id="5349688">16</span><span class="op" id="5349690">,</span>&nbsp;<span class="num" id="5349692">64</span><span class="op" id="5349694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349697">if</span>&nbsp;<span class="ident" id="5349700">err</span>&nbsp;<span class="op" id="5349704">!=</span>&nbsp;<span class="builtintype" id="5349707">nil</span>&nbsp;<span class="op" id="5349711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349715">return</span>&nbsp;<span class="op" id="5349722">-</span><span class="num" id="5349723">1</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5349726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349729">return</span>&nbsp;<span class="builtintype" id="5349736">rune</span><span class="op" id="5349740">(</span><span class="ident" id="5349741">r</span><span class="op" id="5349742">)</span><br>
<span class="lineno"></span><span class="op" id="5349744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5349747">//&nbsp;unquote&nbsp;converts&nbsp;a&nbsp;quoted&nbsp;JSON&nbsp;string&nbsp;literal&nbsp;s&nbsp;into&nbsp;an&nbsp;actual&nbsp;string&nbsp;t.</span><br>
<span class="lineno">965</span><span class="comment" id="5349823">//&nbsp;The&nbsp;rules&nbsp;are&nbsp;different&nbsp;than&nbsp;for&nbsp;Go,&nbsp;so&nbsp;cannot&nbsp;use&nbsp;strconv.Unquote.</span><br>
<span class="lineno"></span><span class="keyword" id="5349894">func</span>&nbsp;<span class="ident" id="5349899">unquote</span><span class="op" id="5349906">(</span><span class="ident" id="5349907">s</span>&nbsp;<span class="op" id="5349909">[</span><span class="op" id="5349910">]</span><span class="builtintype" id="5349911">byte</span><span class="op" id="5349915">)</span>&nbsp;<span class="op" id="5349917">(</span><span class="ident" id="5349918">t</span>&nbsp;<span class="builtintype" id="5349920">string</span><span class="op" id="5349926">,</span>&nbsp;<span class="ident" id="5349928">ok</span>&nbsp;<span class="builtintype" id="5349931">bool</span><span class="op" id="5349935">)</span>&nbsp;<span class="op" id="5349937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349940">s</span><span class="op" id="5349941">,</span>&nbsp;<span class="ident" id="5349943">ok</span>&nbsp;<span class="op" id="5349946">=</span>&nbsp;<span class="ident" id="5349948">unquoteBytes</span><span class="op" id="5349960">(</span><span class="ident" id="5349961">s</span><span class="op" id="5349962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5349965">t</span>&nbsp;<span class="op" id="5349967">=</span>&nbsp;<span class="builtintype" id="5349969">string</span><span class="op" id="5349975">(</span><span class="ident" id="5349976">s</span><span class="op" id="5349977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5349980">return</span><br>
<span class="lineno">970</span><span class="op" id="5349987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5349990">func</span>&nbsp;<span class="ident" id="5349995">unquoteBytes</span><span class="op" id="5350007">(</span><span class="ident" id="5350008">s</span>&nbsp;<span class="op" id="5350010">[</span><span class="op" id="5350011">]</span><span class="builtintype" id="5350012">byte</span><span class="op" id="5350016">)</span>&nbsp;<span class="op" id="5350018">(</span><span class="ident" id="5350019">t</span>&nbsp;<span class="op" id="5350021">[</span><span class="op" id="5350022">]</span><span class="builtintype" id="5350023">byte</span><span class="op" id="5350027">,</span>&nbsp;<span class="ident" id="5350029">ok</span>&nbsp;<span class="builtintype" id="5350032">bool</span><span class="op" id="5350036">)</span>&nbsp;<span class="op" id="5350038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350041">if</span>&nbsp;<span class="builtinfunc" id="5350044">len</span><span class="op" id="5350047">(</span><span class="ident" id="5350048">s</span><span class="op" id="5350049">)</span>&nbsp;<span class="op" id="5350051">&lt;</span>&nbsp;<span class="num" id="5350053">2</span>&nbsp;<span class="op" id="5350055">||</span>&nbsp;<span class="ident" id="5350058">s</span><span class="op" id="5350059">[</span><span class="num" id="5350060">0</span><span class="op" id="5350061">]</span>&nbsp;<span class="op" id="5350063">!=</span>&nbsp;<span class="string" id="5350066">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5350070">||</span>&nbsp;<span class="ident" id="5350073">s</span><span class="op" id="5350074">[</span><span class="builtinfunc" id="5350075">len</span><span class="op" id="5350078">(</span><span class="ident" id="5350079">s</span><span class="op" id="5350080">)</span><span class="op" id="5350081">-</span><span class="num" id="5350082">1</span><span class="op" id="5350083">]</span>&nbsp;<span class="op" id="5350085">!=</span>&nbsp;<span class="string" id="5350088">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5350092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350096">return</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5350104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350107">s</span>&nbsp;<span class="op" id="5350109">=</span>&nbsp;<span class="ident" id="5350111">s</span><span class="op" id="5350112">[</span><span class="num" id="5350113">1</span>&nbsp;<span class="op" id="5350115">:</span>&nbsp;<span class="builtinfunc" id="5350117">len</span><span class="op" id="5350120">(</span><span class="ident" id="5350121">s</span><span class="op" id="5350122">)</span><span class="op" id="5350123">-</span><span class="num" id="5350124">1</span><span class="op" id="5350125">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5350129">//&nbsp;Check&nbsp;for&nbsp;unusual&nbsp;characters.&nbsp;If&nbsp;there&nbsp;are&nbsp;none,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5350182">//&nbsp;then&nbsp;no&nbsp;unquoting&nbsp;is&nbsp;needed,&nbsp;so&nbsp;return&nbsp;a&nbsp;slice&nbsp;of&nbsp;the</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5350240">//&nbsp;original&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350260">r</span>&nbsp;<span class="op" id="5350262">:=</span>&nbsp;<span class="num" id="5350265">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350268">for</span>&nbsp;<span class="ident" id="5350272">r</span>&nbsp;<span class="op" id="5350274">&lt;</span>&nbsp;<span class="builtinfunc" id="5350276">len</span><span class="op" id="5350279">(</span><span class="ident" id="5350280">s</span><span class="op" id="5350281">)</span>&nbsp;<span class="op" id="5350283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350287">c</span>&nbsp;<span class="op" id="5350289">:=</span>&nbsp;<span class="ident" id="5350292">s</span><span class="op" id="5350293">[</span><span class="ident" id="5350294">r</span><span class="op" id="5350295">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350299">if</span>&nbsp;<span class="ident" id="5350302">c</span>&nbsp;<span class="op" id="5350304">==</span>&nbsp;<span class="string" id="5350307">&#39;\\&#39;</span>&nbsp;<span class="op" id="5350312">||</span>&nbsp;<span class="ident" id="5350315">c</span>&nbsp;<span class="op" id="5350317">==</span>&nbsp;<span class="string" id="5350320">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5350324">||</span>&nbsp;<span class="ident" id="5350327">c</span>&nbsp;<span class="op" id="5350329">&lt;</span>&nbsp;<span class="string" id="5350331">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5350335">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350340">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5350348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350352">if</span>&nbsp;<span class="ident" id="5350355">c</span>&nbsp;<span class="op" id="5350357">&lt;</span>&nbsp;<span class="ident" id="5350359">utf8</span><span class="op" id="5350363">.</span><span class="ident" id="5350364">RuneSelf</span>&nbsp;<span class="op" id="5350373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350378">r</span><span class="op" id="5350379">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350385">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5350396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350400">rr</span><span class="op" id="5350402">,</span>&nbsp;<span class="ident" id="5350404">size</span>&nbsp;<span class="op" id="5350409">:=</span>&nbsp;<span class="ident" id="5350412">utf8</span><span class="op" id="5350416">.</span><span class="ident" id="5350417">DecodeRune</span><span class="op" id="5350427">(</span><span class="ident" id="5350428">s</span><span class="op" id="5350429">[</span><span class="ident" id="5350430">r</span><span class="op" id="5350431">:</span><span class="op" id="5350432">]</span><span class="op" id="5350433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350437">if</span>&nbsp;<span class="ident" id="5350440">rr</span>&nbsp;<span class="op" id="5350443">==</span>&nbsp;<span class="ident" id="5350446">utf8</span><span class="op" id="5350450">.</span><span class="ident" id="5350451">RuneError</span>&nbsp;<span class="op" id="5350461">&amp;&amp;</span>&nbsp;<span class="ident" id="5350464">size</span>&nbsp;<span class="op" id="5350469">==</span>&nbsp;<span class="num" id="5350472">1</span>&nbsp;<span class="op" id="5350474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350479">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5350487">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350491">r</span>&nbsp;<span class="op" id="5350493">+=</span>&nbsp;<span class="ident" id="5350496">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5350502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350505">if</span>&nbsp;<span class="ident" id="5350508">r</span>&nbsp;<span class="op" id="5350510">==</span>&nbsp;<span class="builtinfunc" id="5350513">len</span><span class="op" id="5350516">(</span><span class="ident" id="5350517">s</span><span class="op" id="5350518">)</span>&nbsp;<span class="op" id="5350520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350524">return</span>&nbsp;<span class="ident" id="5350531">s</span><span class="op" id="5350532">,</span>&nbsp;<span class="builtintype" id="5350534">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5350540">}</span><br>
<span class="lineno">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350544">b</span>&nbsp;<span class="op" id="5350546">:=</span>&nbsp;<span class="builtinfunc" id="5350549">make</span><span class="op" id="5350553">(</span><span class="op" id="5350554">[</span><span class="op" id="5350555">]</span><span class="builtintype" id="5350556">byte</span><span class="op" id="5350560">,</span>&nbsp;<span class="builtinfunc" id="5350562">len</span><span class="op" id="5350565">(</span><span class="ident" id="5350566">s</span><span class="op" id="5350567">)</span><span class="op" id="5350568">+</span><span class="num" id="5350569">2</span><span class="op" id="5350570">*</span><span class="ident" id="5350571">utf8</span><span class="op" id="5350575">.</span><span class="ident" id="5350576">UTFMax</span><span class="op" id="5350582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350585">w</span>&nbsp;<span class="op" id="5350587">:=</span>&nbsp;<span class="builtinfunc" id="5350590">copy</span><span class="op" id="5350594">(</span><span class="ident" id="5350595">b</span><span class="op" id="5350596">,</span>&nbsp;<span class="ident" id="5350598">s</span><span class="op" id="5350599">[</span><span class="num" id="5350600">0</span><span class="op" id="5350601">:</span><span class="ident" id="5350602">r</span><span class="op" id="5350603">]</span><span class="op" id="5350604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350607">for</span>&nbsp;<span class="ident" id="5350611">r</span>&nbsp;<span class="op" id="5350613">&lt;</span>&nbsp;<span class="builtinfunc" id="5350615">len</span><span class="op" id="5350618">(</span><span class="ident" id="5350619">s</span><span class="op" id="5350620">)</span>&nbsp;<span class="op" id="5350622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5350626">//&nbsp;Out&nbsp;of&nbsp;room?&nbsp;&nbsp;Can&nbsp;only&nbsp;happen&nbsp;if&nbsp;s&nbsp;is&nbsp;full&nbsp;of</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5350677">//&nbsp;malformed&nbsp;UTF-8&nbsp;and&nbsp;we&#39;re&nbsp;replacing&nbsp;each</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5350723">//&nbsp;byte&nbsp;with&nbsp;RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350749">if</span>&nbsp;<span class="ident" id="5350752">w</span>&nbsp;<span class="op" id="5350754">&gt;=</span>&nbsp;<span class="builtinfunc" id="5350757">len</span><span class="op" id="5350760">(</span><span class="ident" id="5350761">b</span><span class="op" id="5350762">)</span><span class="op" id="5350763">-</span><span class="num" id="5350764">2</span><span class="op" id="5350765">*</span><span class="ident" id="5350766">utf8</span><span class="op" id="5350770">.</span><span class="ident" id="5350771">UTFMax</span>&nbsp;<span class="op" id="5350778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350783">nb</span>&nbsp;<span class="op" id="5350786">:=</span>&nbsp;<span class="builtinfunc" id="5350789">make</span><span class="op" id="5350793">(</span><span class="op" id="5350794">[</span><span class="op" id="5350795">]</span><span class="builtintype" id="5350796">byte</span><span class="op" id="5350800">,</span>&nbsp;<span class="op" id="5350802">(</span><span class="builtinfunc" id="5350803">len</span><span class="op" id="5350806">(</span><span class="ident" id="5350807">b</span><span class="op" id="5350808">)</span><span class="op" id="5350809">+</span><span class="ident" id="5350810">utf8</span><span class="op" id="5350814">.</span><span class="ident" id="5350815">UTFMax</span><span class="op" id="5350821">)</span><span class="op" id="5350822">*</span><span class="num" id="5350823">2</span><span class="op" id="5350824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5350829">copy</span><span class="op" id="5350833">(</span><span class="ident" id="5350834">nb</span><span class="op" id="5350836">,</span>&nbsp;<span class="ident" id="5350838">b</span><span class="op" id="5350839">[</span><span class="num" id="5350840">0</span><span class="op" id="5350841">:</span><span class="ident" id="5350842">w</span><span class="op" id="5350843">]</span><span class="op" id="5350844">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350849">b</span>&nbsp;<span class="op" id="5350851">=</span>&nbsp;<span class="ident" id="5350853">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5350858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350862">switch</span>&nbsp;<span class="ident" id="5350869">c</span>&nbsp;<span class="op" id="5350871">:=</span>&nbsp;<span class="ident" id="5350874">s</span><span class="op" id="5350875">[</span><span class="ident" id="5350876">r</span><span class="op" id="5350877">]</span><span class="op" id="5350878">;</span>&nbsp;<span class="op" id="5350880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350884">case</span>&nbsp;<span class="ident" id="5350889">c</span>&nbsp;<span class="op" id="5350891">==</span>&nbsp;<span class="string" id="5350894">&#39;\\&#39;</span><span class="op" id="5350898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350903">r</span><span class="op" id="5350904">++</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350910">if</span>&nbsp;<span class="ident" id="5350913">r</span>&nbsp;<span class="op" id="5350915">&gt;=</span>&nbsp;<span class="builtinfunc" id="5350918">len</span><span class="op" id="5350921">(</span><span class="ident" id="5350922">s</span><span class="op" id="5350923">)</span>&nbsp;<span class="op" id="5350925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350931">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5350941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350946">switch</span>&nbsp;<span class="ident" id="5350953">s</span><span class="op" id="5350954">[</span><span class="ident" id="5350955">r</span><span class="op" id="5350956">]</span>&nbsp;<span class="op" id="5350958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350963">default</span><span class="op" id="5350970">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350976">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5350986">case</span>&nbsp;<span class="string" id="5350991">&#39;&#34;&#39;</span><span class="op" id="5350994">,</span>&nbsp;<span class="string" id="5350996">&#39;\\&#39;</span><span class="op" id="5351000">,</span>&nbsp;<span class="string" id="5351002">&#39;/&#39;</span><span class="op" id="5351005">,</span>&nbsp;<span class="string" id="5351007">&#39;\&#39;&#39;</span><span class="op" id="5351011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351017">b</span><span class="op" id="5351018">[</span><span class="ident" id="5351019">w</span><span class="op" id="5351020">]</span>&nbsp;<span class="op" id="5351022">=</span>&nbsp;<span class="ident" id="5351024">s</span><span class="op" id="5351025">[</span><span class="ident" id="5351026">r</span><span class="op" id="5351027">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351033">r</span><span class="op" id="5351034">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351041">w</span><span class="op" id="5351042">++</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351048">case</span>&nbsp;<span class="string" id="5351053">&#39;b&#39;</span><span class="op" id="5351056">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351062">b</span><span class="op" id="5351063">[</span><span class="ident" id="5351064">w</span><span class="op" id="5351065">]</span>&nbsp;<span class="op" id="5351067">=</span>&nbsp;<span class="string" id="5351069">&#39;\b&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351078">r</span><span class="op" id="5351079">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351086">w</span><span class="op" id="5351087">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351093">case</span>&nbsp;<span class="string" id="5351098">&#39;f&#39;</span><span class="op" id="5351101">:</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351107">b</span><span class="op" id="5351108">[</span><span class="ident" id="5351109">w</span><span class="op" id="5351110">]</span>&nbsp;<span class="op" id="5351112">=</span>&nbsp;<span class="string" id="5351114">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351123">r</span><span class="op" id="5351124">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351131">w</span><span class="op" id="5351132">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351138">case</span>&nbsp;<span class="string" id="5351143">&#39;n&#39;</span><span class="op" id="5351146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351152">b</span><span class="op" id="5351153">[</span><span class="ident" id="5351154">w</span><span class="op" id="5351155">]</span>&nbsp;<span class="op" id="5351157">=</span>&nbsp;<span class="string" id="5351159">&#39;\n&#39;</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351168">r</span><span class="op" id="5351169">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351176">w</span><span class="op" id="5351177">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351183">case</span>&nbsp;<span class="string" id="5351188">&#39;r&#39;</span><span class="op" id="5351191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351197">b</span><span class="op" id="5351198">[</span><span class="ident" id="5351199">w</span><span class="op" id="5351200">]</span>&nbsp;<span class="op" id="5351202">=</span>&nbsp;<span class="string" id="5351204">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351213">r</span><span class="op" id="5351214">++</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351221">w</span><span class="op" id="5351222">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351228">case</span>&nbsp;<span class="string" id="5351233">&#39;t&#39;</span><span class="op" id="5351236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351242">b</span><span class="op" id="5351243">[</span><span class="ident" id="5351244">w</span><span class="op" id="5351245">]</span>&nbsp;<span class="op" id="5351247">=</span>&nbsp;<span class="string" id="5351249">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351258">r</span><span class="op" id="5351259">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351266">w</span><span class="op" id="5351267">++</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351273">case</span>&nbsp;<span class="string" id="5351278">&#39;u&#39;</span><span class="op" id="5351281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351287">r</span><span class="op" id="5351288">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351295">rr</span>&nbsp;<span class="op" id="5351298">:=</span>&nbsp;<span class="ident" id="5351301">getu4</span><span class="op" id="5351306">(</span><span class="ident" id="5351307">s</span><span class="op" id="5351308">[</span><span class="ident" id="5351309">r</span><span class="op" id="5351310">:</span><span class="op" id="5351311">]</span><span class="op" id="5351312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351318">if</span>&nbsp;<span class="ident" id="5351321">rr</span>&nbsp;<span class="op" id="5351324">&lt;</span>&nbsp;<span class="num" id="5351326">0</span>&nbsp;<span class="op" id="5351328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351335">return</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5351346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351352">r</span>&nbsp;<span class="op" id="5351354">+=</span>&nbsp;<span class="num" id="5351357">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351363">if</span>&nbsp;<span class="ident" id="5351366">utf16</span><span class="op" id="5351371">.</span><span class="ident" id="5351372">IsSurrogate</span><span class="op" id="5351383">(</span><span class="ident" id="5351384">rr</span><span class="op" id="5351386">)</span>&nbsp;<span class="op" id="5351388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351395">rr1</span>&nbsp;<span class="op" id="5351399">:=</span>&nbsp;<span class="ident" id="5351402">getu4</span><span class="op" id="5351407">(</span><span class="ident" id="5351408">s</span><span class="op" id="5351409">[</span><span class="ident" id="5351410">r</span><span class="op" id="5351411">:</span><span class="op" id="5351412">]</span><span class="op" id="5351413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351420">if</span>&nbsp;<span class="ident" id="5351423">dec</span>&nbsp;<span class="op" id="5351427">:=</span>&nbsp;<span class="ident" id="5351430">utf16</span><span class="op" id="5351435">.</span><span class="ident" id="5351436">DecodeRune</span><span class="op" id="5351446">(</span><span class="ident" id="5351447">rr</span><span class="op" id="5351449">,</span>&nbsp;<span class="ident" id="5351451">rr1</span><span class="op" id="5351454">)</span><span class="op" id="5351455">;</span>&nbsp;<span class="ident" id="5351457">dec</span>&nbsp;<span class="op" id="5351461">!=</span>&nbsp;<span class="ident" id="5351464">unicode</span><span class="op" id="5351471">.</span><span class="ident" id="5351472">ReplacementChar</span>&nbsp;<span class="op" id="5351488">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5351496">//&nbsp;A&nbsp;valid&nbsp;pair;&nbsp;consume.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351528">r</span>&nbsp;<span class="op" id="5351530">+=</span>&nbsp;<span class="num" id="5351533">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351541">w</span>&nbsp;<span class="op" id="5351543">+=</span>&nbsp;<span class="ident" id="5351546">utf8</span><span class="op" id="5351550">.</span><span class="ident" id="5351551">EncodeRune</span><span class="op" id="5351561">(</span><span class="ident" id="5351562">b</span><span class="op" id="5351563">[</span><span class="ident" id="5351564">w</span><span class="op" id="5351565">:</span><span class="op" id="5351566">]</span><span class="op" id="5351567">,</span>&nbsp;<span class="ident" id="5351569">dec</span><span class="op" id="5351572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351580">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5351591">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5351598">//&nbsp;Invalid&nbsp;surrogate;&nbsp;fall&nbsp;back&nbsp;to&nbsp;replacement&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351656">rr</span>&nbsp;<span class="op" id="5351659">=</span>&nbsp;<span class="ident" id="5351661">unicode</span><span class="op" id="5351668">.</span><span class="ident" id="5351669">ReplacementChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5351689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351695">w</span>&nbsp;<span class="op" id="5351697">+=</span>&nbsp;<span class="ident" id="5351700">utf8</span><span class="op" id="5351704">.</span><span class="ident" id="5351705">EncodeRune</span><span class="op" id="5351715">(</span><span class="ident" id="5351716">b</span><span class="op" id="5351717">[</span><span class="ident" id="5351718">w</span><span class="op" id="5351719">:</span><span class="op" id="5351720">]</span><span class="op" id="5351721">,</span>&nbsp;<span class="ident" id="5351723">rr</span><span class="op" id="5351725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5351730">}</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5351735">//&nbsp;Quote,&nbsp;control&nbsp;characters&nbsp;are&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351779">case</span>&nbsp;<span class="ident" id="5351784">c</span>&nbsp;<span class="op" id="5351786">==</span>&nbsp;<span class="string" id="5351789">&#39;&#34;&#39;</span><span class="op" id="5351792">,</span>&nbsp;<span class="ident" id="5351794">c</span>&nbsp;<span class="op" id="5351796">&lt;</span>&nbsp;<span class="string" id="5351798">&#39;&nbsp;&#39;</span><span class="op" id="5351801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351806">return</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5351816">//&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351827">case</span>&nbsp;<span class="ident" id="5351832">c</span>&nbsp;<span class="op" id="5351834">&lt;</span>&nbsp;<span class="ident" id="5351836">utf8</span><span class="op" id="5351840">.</span><span class="ident" id="5351841">RuneSelf</span><span class="op" id="5351849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351854">b</span><span class="op" id="5351855">[</span><span class="ident" id="5351856">w</span><span class="op" id="5351857">]</span>&nbsp;<span class="op" id="5351859">=</span>&nbsp;<span class="ident" id="5351861">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351866">r</span><span class="op" id="5351867">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351873">w</span><span class="op" id="5351874">++</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5351880">//&nbsp;Coerce&nbsp;to&nbsp;well-formed&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5351914">default</span><span class="op" id="5351921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351926">rr</span><span class="op" id="5351928">,</span>&nbsp;<span class="ident" id="5351930">size</span>&nbsp;<span class="op" id="5351935">:=</span>&nbsp;<span class="ident" id="5351938">utf8</span><span class="op" id="5351942">.</span><span class="ident" id="5351943">DecodeRune</span><span class="op" id="5351953">(</span><span class="ident" id="5351954">s</span><span class="op" id="5351955">[</span><span class="ident" id="5351956">r</span><span class="op" id="5351957">:</span><span class="op" id="5351958">]</span><span class="op" id="5351959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351964">r</span>&nbsp;<span class="op" id="5351966">+=</span>&nbsp;<span class="ident" id="5351969">size</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351977">w</span>&nbsp;<span class="op" id="5351979">+=</span>&nbsp;<span class="ident" id="5351982">utf8</span><span class="op" id="5351986">.</span><span class="ident" id="5351987">EncodeRune</span><span class="op" id="5351997">(</span><span class="ident" id="5351998">b</span><span class="op" id="5351999">[</span><span class="ident" id="5352000">w</span><span class="op" id="5352001">:</span><span class="op" id="5352002">]</span><span class="op" id="5352003">,</span>&nbsp;<span class="ident" id="5352005">rr</span><span class="op" id="5352007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5352011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5352014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5352017">return</span>&nbsp;<span class="ident" id="5352024">b</span><span class="op" id="5352025">[</span><span class="num" id="5352026">0</span><span class="op" id="5352027">:</span><span class="ident" id="5352028">w</span><span class="op" id="5352029">]</span><span class="op" id="5352030">,</span>&nbsp;<span class="builtintype" id="5352032">true</span><br>
<span class="lineno"></span><span class="op" id="5352037">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
