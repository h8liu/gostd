<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5924577">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5924632">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5924686">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5924737">package</span>&nbsp;<span class="ident" id="5924745">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5924750">import</span>&nbsp;<span class="op" id="5924757">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924760">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924772">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924782">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924789">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924795">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924806">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924814">&#34;sync/atomic&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924829">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5924840">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5924855">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5924858">//&nbsp;userTypeInfo&nbsp;stores&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;a&nbsp;type&nbsp;the&nbsp;user&nbsp;has&nbsp;handed</span><br>
<span class="lineno">20</span><span class="comment" id="5924940">//&nbsp;to&nbsp;the&nbsp;package.&nbsp;&nbsp;It&#39;s&nbsp;computed&nbsp;once&nbsp;and&nbsp;stored&nbsp;in&nbsp;a&nbsp;map&nbsp;keyed&nbsp;by&nbsp;reflection</span><br>
<span class="lineno"></span><span class="comment" id="5925019">//&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5925028">type</span>&nbsp;<span class="ident" id="5925033">userTypeInfo</span>&nbsp;<span class="keyword" id="5925046">struct</span>&nbsp;<span class="op" id="5925053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925056">user</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5925068"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5925075">.</span><span class="ident" id="5925076">Type</span>&nbsp;<span class="comment" id="5925081">//&nbsp;the&nbsp;type&nbsp;the&nbsp;user&nbsp;handed&nbsp;us</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925113">base</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5925125"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5925132">.</span><span class="ident" id="5925133">Type</span>&nbsp;<span class="comment" id="5925138">//&nbsp;the&nbsp;base&nbsp;type&nbsp;after&nbsp;all&nbsp;indirections</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925179">indir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5925191">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5925204">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925254">externalEnc</span>&nbsp;<span class="builtintype" id="5925266">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5925279">//&nbsp;xGob,&nbsp;xBinary,&nbsp;or&nbsp;xText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925307">externalDec</span>&nbsp;<span class="builtintype" id="5925319">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5925332">//&nbsp;xGob,&nbsp;xBinary&nbsp;or&nbsp;xText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925359">encIndir</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5925371">int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5925384">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;receiver&nbsp;type;&nbsp;may&nbsp;be&nbsp;negative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925455">decIndir</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5925467">int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5925480">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;receiver&nbsp;type;&nbsp;may&nbsp;be&nbsp;negative</span><br>
<span class="lineno">30</span><span class="op" id="5925550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5925553">//&nbsp;externalEncoding&nbsp;bits</span><br>
<span class="lineno"></span><span class="keyword" id="5925578">const</span>&nbsp;<span class="op" id="5925584">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925587">xGob</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5925595">=</span>&nbsp;<span class="num" id="5925597">1</span>&nbsp;<span class="op" id="5925599">+</span>&nbsp;<span class="ident" id="5925601">iota</span>&nbsp;<span class="comment" id="5925606">//&nbsp;GobEncoder&nbsp;or&nbsp;GobDecoder</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925635">xBinary</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5925654">//&nbsp;encoding.BinaryMarshaler&nbsp;or&nbsp;encoding.BinaryUnmarshaler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925713">xText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5925732">//&nbsp;encoding.TextMarshaler&nbsp;or&nbsp;encoding.TextUnmarshaler</span><br>
<span class="lineno"></span><span class="op" id="5925786">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5925789">var</span>&nbsp;<span class="op" id="5925793">(</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5925796">//&nbsp;Protected&nbsp;by&nbsp;an&nbsp;RWMutex&nbsp;because&nbsp;we&nbsp;read&nbsp;it&nbsp;a&nbsp;lot&nbsp;and&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5925859">//&nbsp;it&nbsp;only&nbsp;when&nbsp;we&nbsp;see&nbsp;a&nbsp;new&nbsp;type,&nbsp;typically&nbsp;when&nbsp;compiling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925921">userTypeLock</span>&nbsp;&nbsp;<span class="ident" id="5925935"><a href="/encoding/gob/type.go.html#5924806">sync</a></span><span class="op" id="5925939">.</span><span class="ident" id="5925940">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5925949">userTypeCache</span>&nbsp;<span class="op" id="5925963">=</span>&nbsp;<span class="builtinfunc" id="5925965">make</span><span class="op" id="5925969">(</span><span class="keyword" id="5925970">map</span><span class="op" id="5925973">[</span><span class="ident" id="5925974"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5925981">.</span><span class="ident" id="5925982">Type</span><span class="op" id="5925986">]</span><span class="op" id="5925987">*</span><span class="ident" id="5925988"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span><span class="op" id="5926000">)</span><br>
<span class="lineno"></span><span class="op" id="5926002">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5926005">//&nbsp;validType&nbsp;returns,&nbsp;and&nbsp;saves,&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;user-provided&nbsp;type&nbsp;rt.</span><br>
<span class="lineno"></span><span class="comment" id="5926093">//&nbsp;If&nbsp;the&nbsp;user&nbsp;type&nbsp;is&nbsp;not&nbsp;valid,&nbsp;err&nbsp;will&nbsp;be&nbsp;non-nil.&nbsp;&nbsp;To&nbsp;be&nbsp;used&nbsp;when&nbsp;the&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span><span class="comment" id="5926183">//&nbsp;is&nbsp;not&nbsp;set&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="5926201">func</span>&nbsp;<span class="ident" id="5926206">validUserType</span><span class="op" id="5926219">(</span><span class="ident" id="5926220">rt</span>&nbsp;<span class="ident" id="5926223"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5926230">.</span><span class="ident" id="5926231">Type</span><span class="op" id="5926235">)</span>&nbsp;<span class="op" id="5926237">(</span><span class="ident" id="5926238">ut</span>&nbsp;<span class="op" id="5926241">*</span><span class="ident" id="5926242"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span><span class="op" id="5926254">,</span>&nbsp;<span class="ident" id="5926256">err</span>&nbsp;<span class="builtintype" id="5926260">error</span><span class="op" id="5926265">)</span>&nbsp;<span class="op" id="5926267">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926270"><a href="/encoding/gob/type.go.html#5925921">userTypeLock</a></span><span class="op" id="5926282">.</span><span class="ident" id="5926283">RLock</span><span class="op" id="5926288">(</span><span class="op" id="5926289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926292"><a href="/encoding/gob/type.go.html#5926238">ut</a></span>&nbsp;<span class="op" id="5926295">=</span>&nbsp;<span class="ident" id="5926297"><a href="/encoding/gob/type.go.html#5925949">userTypeCache</a></span><span class="op" id="5926310">[</span><span class="ident" id="5926311"><a href="/encoding/gob/type.go.html#5926220">rt</a></span><span class="op" id="5926313">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926316"><a href="/encoding/gob/type.go.html#5925921">userTypeLock</a></span><span class="op" id="5926328">.</span><span class="ident" id="5926329">RUnlock</span><span class="op" id="5926336">(</span><span class="op" id="5926337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5926340">if</span>&nbsp;<span class="ident" id="5926343"><a href="/encoding/gob/type.go.html#5926238">ut</a></span>&nbsp;<span class="op" id="5926346">!=</span>&nbsp;<span class="ident" id="5926349">nil</span>&nbsp;<span class="op" id="5926353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5926357">return</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5926365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926368">//&nbsp;Now&nbsp;set&nbsp;the&nbsp;value&nbsp;under&nbsp;the&nbsp;write&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926412"><a href="/encoding/gob/type.go.html#5925921">userTypeLock</a></span><span class="op" id="5926424">.</span><span class="ident" id="5926425">Lock</span><span class="op" id="5926429">(</span><span class="op" id="5926430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5926433">defer</span>&nbsp;<span class="ident" id="5926439"><a href="/encoding/gob/type.go.html#5925921">userTypeLock</a></span><span class="op" id="5926451">.</span><span class="ident" id="5926452">Unlock</span><span class="op" id="5926458">(</span><span class="op" id="5926459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5926462">if</span>&nbsp;<span class="ident" id="5926465"><a href="/encoding/gob/type.go.html#5926238">ut</a></span>&nbsp;<span class="op" id="5926468">=</span>&nbsp;<span class="ident" id="5926470"><a href="/encoding/gob/type.go.html#5925949">userTypeCache</a></span><span class="op" id="5926483">[</span><span class="ident" id="5926484"><a href="/encoding/gob/type.go.html#5926220">rt</a></span><span class="op" id="5926486">]</span><span class="op" id="5926487">;</span>&nbsp;<span class="ident" id="5926489"><a href="/encoding/gob/type.go.html#5926238">ut</a></span>&nbsp;<span class="op" id="5926492">!=</span>&nbsp;<span class="ident" id="5926495">nil</span>&nbsp;<span class="op" id="5926499">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926503">//&nbsp;Lost&nbsp;the&nbsp;race;&nbsp;not&nbsp;a&nbsp;problem.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5926538">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5926546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926549"><a href="/encoding/gob/type.go.html#5926238">ut</a></span>&nbsp;<span class="op" id="5926552">=</span>&nbsp;<span class="builtinfunc" id="5926554">new</span><span class="op" id="5926557">(</span><span class="ident" id="5926558"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span><span class="op" id="5926570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926573"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5926575">.</span><span class="ident" id="5926576">base</span>&nbsp;<span class="op" id="5926581">=</span>&nbsp;<span class="ident" id="5926583"><a href="/encoding/gob/type.go.html#5926220">rt</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926587"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5926589">.</span><span class="ident" id="5926590">user</span>&nbsp;<span class="op" id="5926595">=</span>&nbsp;<span class="ident" id="5926597"><a href="/encoding/gob/type.go.html#5926220">rt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926601">//&nbsp;A&nbsp;type&nbsp;that&nbsp;is&nbsp;just&nbsp;a&nbsp;cycle&nbsp;of&nbsp;pointers&nbsp;(such&nbsp;as&nbsp;type&nbsp;T&nbsp;*T)&nbsp;cannot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926672">//&nbsp;be&nbsp;represented&nbsp;in&nbsp;gobs,&nbsp;which&nbsp;need&nbsp;some&nbsp;concrete&nbsp;data.&nbsp;&nbsp;We&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926741">//&nbsp;cycle&nbsp;detection&nbsp;algorithm&nbsp;from&nbsp;Knuth,&nbsp;Vol&nbsp;2,&nbsp;Section&nbsp;3.1,&nbsp;Ex&nbsp;6,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926809">//&nbsp;pp&nbsp;539-540.&nbsp;&nbsp;As&nbsp;we&nbsp;step&nbsp;through&nbsp;indirections,&nbsp;run&nbsp;another&nbsp;type&nbsp;at</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5926879">//&nbsp;half&nbsp;speed.&nbsp;If&nbsp;they&nbsp;meet&nbsp;up,&nbsp;there&#39;s&nbsp;a&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926929">slowpoke</span>&nbsp;<span class="op" id="5926938">:=</span>&nbsp;<span class="ident" id="5926941"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5926943">.</span><span class="ident" id="5926944">base</span>&nbsp;<span class="comment" id="5926949">//&nbsp;walks&nbsp;half&nbsp;as&nbsp;fast&nbsp;as&nbsp;ut.base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5926983">for</span>&nbsp;<span class="op" id="5926987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5926991">pt</span>&nbsp;<span class="op" id="5926994">:=</span>&nbsp;<span class="ident" id="5926997"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5926999">.</span><span class="ident" id="5927000">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5927007">if</span>&nbsp;<span class="ident" id="5927010"><a href="/encoding/gob/type.go.html#5926991">pt</a></span><span class="op" id="5927012">.</span><span class="ident" id="5927013">Kind</span><span class="op" id="5927017">(</span><span class="op" id="5927018">)</span>&nbsp;<span class="op" id="5927020">!=</span>&nbsp;<span class="ident" id="5927023"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5927030">.</span><span class="ident" id="5927031">Ptr</span>&nbsp;<span class="op" id="5927035">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5927040">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5927048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927052"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927054">.</span><span class="ident" id="5927055">base</span>&nbsp;<span class="op" id="5927060">=</span>&nbsp;<span class="ident" id="5927062"><a href="/encoding/gob/type.go.html#5926991">pt</a></span><span class="op" id="5927064">.</span><span class="ident" id="5927065">Elem</span><span class="op" id="5927069">(</span><span class="op" id="5927070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5927074">if</span>&nbsp;<span class="ident" id="5927077"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927079">.</span><span class="ident" id="5927080">base</span>&nbsp;<span class="op" id="5927085">==</span>&nbsp;<span class="ident" id="5927088"><a href="/encoding/gob/type.go.html#5926929">slowpoke</a></span>&nbsp;<span class="op" id="5927097">{</span>&nbsp;<span class="comment" id="5927099">//&nbsp;ut.base&nbsp;lapped&nbsp;slowpoke</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927129">//&nbsp;recursive&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5927159">return</span>&nbsp;<span class="ident" id="5927166">nil</span><span class="op" id="5927169">,</span>&nbsp;<span class="ident" id="5927171"><a href="/encoding/gob/type.go.html#5924772">errors</a></span><span class="op" id="5927177">.</span><span class="ident" id="5927178">New</span><span class="op" id="5927181">(</span><span class="string" id="5927182">&#34;can&#39;t&nbsp;represent&nbsp;recursive&nbsp;pointer&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="5927224">+</span>&nbsp;<span class="ident" id="5927226"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927228">.</span><span class="ident" id="5927229">base</span><span class="op" id="5927233">.</span><span class="ident" id="5927234">String</span><span class="op" id="5927240">(</span><span class="op" id="5927241">)</span><span class="op" id="5927242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5927246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5927250">if</span>&nbsp;<span class="ident" id="5927253"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927255">.</span><span class="ident" id="5927256">indir</span><span class="op" id="5927261">%</span><span class="num" id="5927262">2</span>&nbsp;<span class="op" id="5927264">==</span>&nbsp;<span class="num" id="5927267">0</span>&nbsp;<span class="op" id="5927269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927274"><a href="/encoding/gob/type.go.html#5926929">slowpoke</a></span>&nbsp;<span class="op" id="5927283">=</span>&nbsp;<span class="ident" id="5927285"><a href="/encoding/gob/type.go.html#5926929">slowpoke</a></span><span class="op" id="5927293">.</span><span class="ident" id="5927294">Elem</span><span class="op" id="5927298">(</span><span class="op" id="5927299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5927303">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927307"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927309">.</span><span class="ident" id="5927310">indir</span><span class="op" id="5927315">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5927319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5927323">if</span>&nbsp;<span class="ident" id="5927326">ok</span><span class="op" id="5927328">,</span>&nbsp;<span class="ident" id="5927330">indir</span>&nbsp;<span class="op" id="5927336">:=</span>&nbsp;<span class="ident" id="5927339"><a href="/encoding/gob/type.go.html#5929054">implementsInterface</a></span><span class="op" id="5927358">(</span><span class="ident" id="5927359"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927361">.</span><span class="ident" id="5927362">user</span><span class="op" id="5927366">,</span>&nbsp;<span class="ident" id="5927368"><a href="/encoding/gob/type.go.html#5928348">gobEncoderInterfaceType</a></span><span class="op" id="5927391">)</span><span class="op" id="5927392">;</span>&nbsp;<span class="ident" id="5927394"><a href="/encoding/gob/type.go.html#5927326">ok</a></span>&nbsp;<span class="op" id="5927397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927401"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927403">.</span><span class="ident" id="5927404">externalEnc</span><span class="op" id="5927415">,</span>&nbsp;<span class="ident" id="5927417"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927419">.</span><span class="ident" id="5927420">encIndir</span>&nbsp;<span class="op" id="5927429">=</span>&nbsp;<span class="ident" id="5927431"><a href="/encoding/gob/type.go.html#5925587">xGob</a></span><span class="op" id="5927435">,</span>&nbsp;<span class="ident" id="5927437"><a href="/encoding/gob/type.go.html#5927330">indir</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5927444">}</span>&nbsp;<span class="keyword" id="5927446">else</span>&nbsp;<span class="keyword" id="5927451">if</span>&nbsp;<span class="ident" id="5927454">ok</span><span class="op" id="5927456">,</span>&nbsp;<span class="ident" id="5927458">indir</span>&nbsp;<span class="op" id="5927464">:=</span>&nbsp;<span class="ident" id="5927467"><a href="/encoding/gob/type.go.html#5929054">implementsInterface</a></span><span class="op" id="5927486">(</span><span class="ident" id="5927487"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927489">.</span><span class="ident" id="5927490">user</span><span class="op" id="5927494">,</span>&nbsp;<span class="ident" id="5927496"><a href="/encoding/gob/type.go.html#5928500">binaryMarshalerInterfaceType</a></span><span class="op" id="5927524">)</span><span class="op" id="5927525">;</span>&nbsp;<span class="ident" id="5927527"><a href="/encoding/gob/type.go.html#5927454">ok</a></span>&nbsp;<span class="op" id="5927530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927534"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927536">.</span><span class="ident" id="5927537">externalEnc</span><span class="op" id="5927548">,</span>&nbsp;<span class="ident" id="5927550"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927552">.</span><span class="ident" id="5927553">encIndir</span>&nbsp;<span class="op" id="5927562">=</span>&nbsp;<span class="ident" id="5927564"><a href="/encoding/gob/type.go.html#5925635">xBinary</a></span><span class="op" id="5927571">,</span>&nbsp;<span class="ident" id="5927573"><a href="/encoding/gob/type.go.html#5927458">indir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5927580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927584">//&nbsp;NOTE(rsc):&nbsp;Would&nbsp;like&nbsp;to&nbsp;allow&nbsp;MarshalText&nbsp;here,&nbsp;but&nbsp;results&nbsp;in&nbsp;incompatibility</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927668">//&nbsp;with&nbsp;older&nbsp;encodings&nbsp;for&nbsp;net.IP.&nbsp;See&nbsp;golang.org/issue/6760.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927732">//&nbsp;}&nbsp;else&nbsp;if&nbsp;ok,&nbsp;indir&nbsp;:=&nbsp;implementsInterface(ut.user,&nbsp;textMarshalerInterfaceType);&nbsp;ok&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927822">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsput.externalEnc,&nbsp;ut.encIndir&nbsp;=&nbsp;xText,&nbsp;indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5927870">//&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5927877">if</span>&nbsp;<span class="ident" id="5927880">ok</span><span class="op" id="5927882">,</span>&nbsp;<span class="ident" id="5927884">indir</span>&nbsp;<span class="op" id="5927890">:=</span>&nbsp;<span class="ident" id="5927893"><a href="/encoding/gob/type.go.html#5929054">implementsInterface</a></span><span class="op" id="5927912">(</span><span class="ident" id="5927913"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927915">.</span><span class="ident" id="5927916">user</span><span class="op" id="5927920">,</span>&nbsp;<span class="ident" id="5927922"><a href="/encoding/gob/type.go.html#5928424">gobDecoderInterfaceType</a></span><span class="op" id="5927945">)</span><span class="op" id="5927946">;</span>&nbsp;<span class="ident" id="5927948"><a href="/encoding/gob/type.go.html#5927880">ok</a></span>&nbsp;<span class="op" id="5927951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5927955"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927957">.</span><span class="ident" id="5927958">externalDec</span><span class="op" id="5927969">,</span>&nbsp;<span class="ident" id="5927971"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5927973">.</span><span class="ident" id="5927974">decIndir</span>&nbsp;<span class="op" id="5927983">=</span>&nbsp;<span class="ident" id="5927985"><a href="/encoding/gob/type.go.html#5925587">xGob</a></span><span class="op" id="5927989">,</span>&nbsp;<span class="ident" id="5927991"><a href="/encoding/gob/type.go.html#5927884">indir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5927998">}</span>&nbsp;<span class="keyword" id="5928000">else</span>&nbsp;<span class="keyword" id="5928005">if</span>&nbsp;<span class="ident" id="5928008">ok</span><span class="op" id="5928010">,</span>&nbsp;<span class="ident" id="5928012">indir</span>&nbsp;<span class="op" id="5928018">:=</span>&nbsp;<span class="ident" id="5928021"><a href="/encoding/gob/type.go.html#5929054">implementsInterface</a></span><span class="op" id="5928040">(</span><span class="ident" id="5928041"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5928043">.</span><span class="ident" id="5928044">user</span><span class="op" id="5928048">,</span>&nbsp;<span class="ident" id="5928050"><a href="/encoding/gob/type.go.html#5928590">binaryUnmarshalerInterfaceType</a></span><span class="op" id="5928080">)</span><span class="op" id="5928081">;</span>&nbsp;<span class="ident" id="5928083"><a href="/encoding/gob/type.go.html#5928008">ok</a></span>&nbsp;<span class="op" id="5928086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928090"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5928092">.</span><span class="ident" id="5928093">externalDec</span><span class="op" id="5928104">,</span>&nbsp;<span class="ident" id="5928106"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><span class="op" id="5928108">.</span><span class="ident" id="5928109">decIndir</span>&nbsp;<span class="op" id="5928118">=</span>&nbsp;<span class="ident" id="5928120"><a href="/encoding/gob/type.go.html#5925635">xBinary</a></span><span class="op" id="5928127">,</span>&nbsp;<span class="ident" id="5928129"><a href="/encoding/gob/type.go.html#5928012">indir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5928136">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928140">//&nbsp;See&nbsp;note&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928160">//&nbsp;}&nbsp;else&nbsp;if&nbsp;ok,&nbsp;indir&nbsp;:=&nbsp;implementsInterface(ut.user,&nbsp;textUnmarshalerInterfaceType);&nbsp;ok&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928252">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsput.externalDec,&nbsp;ut.decIndir&nbsp;=&nbsp;xText,&nbsp;indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5928300">//&nbsp;}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928307"><a href="/encoding/gob/type.go.html#5925949">userTypeCache</a></span><span class="op" id="5928320">[</span><span class="ident" id="5928321"><a href="/encoding/gob/type.go.html#5926220">rt</a></span><span class="op" id="5928323">]</span>&nbsp;<span class="op" id="5928325">=</span>&nbsp;<span class="ident" id="5928327"><a href="/encoding/gob/type.go.html#5926238">ut</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5928331">return</span><br>
<span class="lineno"></span><span class="op" id="5928338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="5928341">var</span>&nbsp;<span class="op" id="5928345">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928348">gobEncoderInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5928379">=</span>&nbsp;<span class="ident" id="5928381"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5928388">.</span><span class="ident" id="5928389">TypeOf</span><span class="op" id="5928395">(</span><span class="op" id="5928396">(</span><span class="op" id="5928397">*</span><span class="ident" id="5928398"><a href="/encoding/gob/type.go.html#5947934">GobEncoder</a></span><span class="op" id="5928408">)</span><span class="op" id="5928409">(</span><span class="ident" id="5928410">nil</span><span class="op" id="5928413">)</span><span class="op" id="5928414">)</span><span class="op" id="5928415">.</span><span class="ident" id="5928416">Elem</span><span class="op" id="5928420">(</span><span class="op" id="5928421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928424">gobDecoderInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5928455">=</span>&nbsp;<span class="ident" id="5928457"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5928464">.</span><span class="ident" id="5928465">TypeOf</span><span class="op" id="5928471">(</span><span class="op" id="5928472">(</span><span class="op" id="5928473">*</span><span class="ident" id="5928474"><a href="/encoding/gob/type.go.html#5948282">GobDecoder</a></span><span class="op" id="5928484">)</span><span class="op" id="5928485">(</span><span class="ident" id="5928486">nil</span><span class="op" id="5928489">)</span><span class="op" id="5928490">)</span><span class="op" id="5928491">.</span><span class="ident" id="5928492">Elem</span><span class="op" id="5928496">(</span><span class="op" id="5928497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928500">binaryMarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5928531">=</span>&nbsp;<span class="ident" id="5928533"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5928540">.</span><span class="ident" id="5928541">TypeOf</span><span class="op" id="5928547">(</span><span class="op" id="5928548">(</span><span class="op" id="5928549">*</span><span class="ident" id="5928550"><a href="/encoding/gob/type.go.html#5924760">encoding</a></span><span class="op" id="5928558">.</span><span class="ident" id="5928559">BinaryMarshaler</span><span class="op" id="5928574">)</span><span class="op" id="5928575">(</span><span class="ident" id="5928576">nil</span><span class="op" id="5928579">)</span><span class="op" id="5928580">)</span><span class="op" id="5928581">.</span><span class="ident" id="5928582">Elem</span><span class="op" id="5928586">(</span><span class="op" id="5928587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928590">binaryUnmarshalerInterfaceType</span>&nbsp;<span class="op" id="5928621">=</span>&nbsp;<span class="ident" id="5928623"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5928630">.</span><span class="ident" id="5928631">TypeOf</span><span class="op" id="5928637">(</span><span class="op" id="5928638">(</span><span class="op" id="5928639">*</span><span class="ident" id="5928640"><a href="/encoding/gob/type.go.html#5924760">encoding</a></span><span class="op" id="5928648">.</span><span class="ident" id="5928649">BinaryUnmarshaler</span><span class="op" id="5928666">)</span><span class="op" id="5928667">(</span><span class="ident" id="5928668">nil</span><span class="op" id="5928671">)</span><span class="op" id="5928672">)</span><span class="op" id="5928673">.</span><span class="ident" id="5928674">Elem</span><span class="op" id="5928678">(</span><span class="op" id="5928679">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928682">textMarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5928713">=</span>&nbsp;<span class="ident" id="5928715"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5928722">.</span><span class="ident" id="5928723">TypeOf</span><span class="op" id="5928729">(</span><span class="op" id="5928730">(</span><span class="op" id="5928731">*</span><span class="ident" id="5928732"><a href="/encoding/gob/type.go.html#5924760">encoding</a></span><span class="op" id="5928740">.</span><span class="ident" id="5928741">TextMarshaler</span><span class="op" id="5928754">)</span><span class="op" id="5928755">(</span><span class="ident" id="5928756">nil</span><span class="op" id="5928759">)</span><span class="op" id="5928760">)</span><span class="op" id="5928761">.</span><span class="ident" id="5928762">Elem</span><span class="op" id="5928766">(</span><span class="op" id="5928767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928770">textUnmarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5928801">=</span>&nbsp;<span class="ident" id="5928803"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5928810">.</span><span class="ident" id="5928811">TypeOf</span><span class="op" id="5928817">(</span><span class="op" id="5928818">(</span><span class="op" id="5928819">*</span><span class="ident" id="5928820"><a href="/encoding/gob/type.go.html#5924760">encoding</a></span><span class="op" id="5928828">.</span><span class="ident" id="5928829">TextUnmarshaler</span><span class="op" id="5928844">)</span><span class="op" id="5928845">(</span><span class="ident" id="5928846">nil</span><span class="op" id="5928849">)</span><span class="op" id="5928850">)</span><span class="op" id="5928851">.</span><span class="ident" id="5928852">Elem</span><span class="op" id="5928856">(</span><span class="op" id="5928857">)</span><br>
<span class="lineno"></span><span class="op" id="5928859">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5928862">//&nbsp;implementsInterface&nbsp;reports&nbsp;whether&nbsp;the&nbsp;type&nbsp;implements&nbsp;the</span><br>
<span class="lineno">125</span><span class="comment" id="5928925">//&nbsp;gobEncoder/gobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="5928961">//&nbsp;It&nbsp;also&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;indirections&nbsp;required&nbsp;to&nbsp;get&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5929030">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="keyword" id="5929049">func</span>&nbsp;<span class="ident" id="5929054">implementsInterface</span><span class="op" id="5929073">(</span><span class="ident" id="5929074">typ</span><span class="op" id="5929077">,</span>&nbsp;<span class="ident" id="5929079">gobEncDecType</span>&nbsp;<span class="ident" id="5929093"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5929100">.</span><span class="ident" id="5929101">Type</span><span class="op" id="5929105">)</span>&nbsp;<span class="op" id="5929107">(</span><span class="ident" id="5929108">success</span>&nbsp;<span class="builtintype" id="5929116">bool</span><span class="op" id="5929120">,</span>&nbsp;<span class="ident" id="5929122">indir</span>&nbsp;<span class="builtintype" id="5929128">int8</span><span class="op" id="5929132">)</span>&nbsp;<span class="op" id="5929134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929137">if</span>&nbsp;<span class="ident" id="5929140"><a href="/encoding/gob/type.go.html#5929074">typ</a></span>&nbsp;<span class="op" id="5929144">==</span>&nbsp;<span class="ident" id="5929147">nil</span>&nbsp;<span class="op" id="5929151">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929155">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929166">rt</span>&nbsp;<span class="op" id="5929169">:=</span>&nbsp;<span class="ident" id="5929172"><a href="/encoding/gob/type.go.html#5929074">typ</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929177">//&nbsp;The&nbsp;type&nbsp;might&nbsp;be&nbsp;a&nbsp;pointer&nbsp;and&nbsp;we&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929229">//&nbsp;dereferencing&nbsp;to&nbsp;the&nbsp;base&nbsp;type&nbsp;until&nbsp;we&nbsp;find&nbsp;an&nbsp;implementation.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929297">for</span>&nbsp;<span class="op" id="5929301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929305">if</span>&nbsp;<span class="ident" id="5929308"><a href="/encoding/gob/type.go.html#5929166">rt</a></span><span class="op" id="5929310">.</span><span class="ident" id="5929311">Implements</span><span class="op" id="5929321">(</span><span class="ident" id="5929322"><a href="/encoding/gob/type.go.html#5929079">gobEncDecType</a></span><span class="op" id="5929335">)</span>&nbsp;<span class="op" id="5929337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929342">return</span>&nbsp;<span class="builtintype" id="5929349">true</span><span class="op" id="5929353">,</span>&nbsp;<span class="ident" id="5929355"><a href="/encoding/gob/type.go.html#5929122">indir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929367">if</span>&nbsp;<span class="ident" id="5929370">p</span>&nbsp;<span class="op" id="5929372">:=</span>&nbsp;<span class="ident" id="5929375"><a href="/encoding/gob/type.go.html#5929166">rt</a></span><span class="op" id="5929377">;</span>&nbsp;<span class="ident" id="5929379"><a href="/encoding/gob/type.go.html#5929370">p</a></span><span class="op" id="5929380">.</span><span class="ident" id="5929381">Kind</span><span class="op" id="5929385">(</span><span class="op" id="5929386">)</span>&nbsp;<span class="op" id="5929388">==</span>&nbsp;<span class="ident" id="5929391"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5929398">.</span><span class="ident" id="5929399">Ptr</span>&nbsp;<span class="op" id="5929403">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929408"><a href="/encoding/gob/type.go.html#5929122">indir</a></span><span class="op" id="5929413">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929419">if</span>&nbsp;<span class="ident" id="5929422"><a href="/encoding/gob/type.go.html#5929122">indir</a></span>&nbsp;<span class="op" id="5929428">&gt;</span>&nbsp;<span class="num" id="5929430">100</span>&nbsp;<span class="op" id="5929434">{</span>&nbsp;<span class="comment" id="5929436">//&nbsp;insane&nbsp;number&nbsp;of&nbsp;indirections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929473">return</span>&nbsp;<span class="builtintype" id="5929480">false</span><span class="op" id="5929485">,</span>&nbsp;<span class="num" id="5929487">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929497"><a href="/encoding/gob/type.go.html#5929166">rt</a></span>&nbsp;<span class="op" id="5929500">=</span>&nbsp;<span class="ident" id="5929502"><a href="/encoding/gob/type.go.html#5929370">p</a></span><span class="op" id="5929503">.</span><span class="ident" id="5929504">Elem</span><span class="op" id="5929508">(</span><span class="op" id="5929509">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929514">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929529">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929539">//&nbsp;No&nbsp;luck&nbsp;yet,&nbsp;but&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;base&nbsp;type&nbsp;(non-pointer),&nbsp;the&nbsp;pointer&nbsp;might&nbsp;satisfy.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929625">if</span>&nbsp;<span class="ident" id="5929628"><a href="/encoding/gob/type.go.html#5929074">typ</a></span><span class="op" id="5929631">.</span><span class="ident" id="5929632">Kind</span><span class="op" id="5929636">(</span><span class="op" id="5929637">)</span>&nbsp;<span class="op" id="5929639">!=</span>&nbsp;<span class="ident" id="5929642"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5929649">.</span><span class="ident" id="5929650">Ptr</span>&nbsp;<span class="op" id="5929654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929658">//&nbsp;Not&nbsp;a&nbsp;pointer,&nbsp;but&nbsp;does&nbsp;the&nbsp;pointer&nbsp;work?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929705">if</span>&nbsp;<span class="ident" id="5929708"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5929715">.</span><span class="ident" id="5929716">PtrTo</span><span class="op" id="5929721">(</span><span class="ident" id="5929722"><a href="/encoding/gob/type.go.html#5929074">typ</a></span><span class="op" id="5929725">)</span><span class="op" id="5929726">.</span><span class="ident" id="5929727">Implements</span><span class="op" id="5929737">(</span><span class="ident" id="5929738"><a href="/encoding/gob/type.go.html#5929079">gobEncDecType</a></span><span class="op" id="5929751">)</span>&nbsp;<span class="op" id="5929753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929758">return</span>&nbsp;<span class="builtintype" id="5929765">true</span><span class="op" id="5929769">,</span>&nbsp;<span class="op" id="5929771">-</span><span class="num" id="5929772">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929776">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929782">return</span>&nbsp;<span class="builtintype" id="5929789">false</span><span class="op" id="5929794">,</span>&nbsp;<span class="num" id="5929796">0</span><br>
<span class="lineno"></span><span class="op" id="5929798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5929801">//&nbsp;userType&nbsp;returns,&nbsp;and&nbsp;saves,&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;user-provided&nbsp;type&nbsp;rt.</span><br>
<span class="lineno">160</span><span class="comment" id="5929888">//&nbsp;If&nbsp;the&nbsp;user&nbsp;type&nbsp;is&nbsp;not&nbsp;valid,&nbsp;it&nbsp;calls&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5929938">func</span>&nbsp;<span class="ident" id="5929943">userType</span><span class="op" id="5929951">(</span><span class="ident" id="5929952">rt</span>&nbsp;<span class="ident" id="5929955"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5929962">.</span><span class="ident" id="5929963">Type</span><span class="op" id="5929967">)</span>&nbsp;<span class="op" id="5929969">*</span><span class="ident" id="5929970"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span>&nbsp;<span class="op" id="5929983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929986">ut</span><span class="op" id="5929988">,</span>&nbsp;<span class="ident" id="5929990">err</span>&nbsp;<span class="op" id="5929994">:=</span>&nbsp;<span class="ident" id="5929997"><a href="/encoding/gob/type.go.html#5926206">validUserType</a></span><span class="op" id="5930010">(</span><span class="ident" id="5930011"><a href="/encoding/gob/type.go.html#5929952">rt</a></span><span class="op" id="5930013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930016">if</span>&nbsp;<span class="ident" id="5930019"><a href="/encoding/gob/type.go.html#5929990">err</a></span>&nbsp;<span class="op" id="5930023">!=</span>&nbsp;<span class="ident" id="5930026">nil</span>&nbsp;<span class="op" id="5930030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930034"><a href="/encoding/gob/error.go.html#5924211">error_</a></span><span class="op" id="5930040">(</span><span class="ident" id="5930041"><a href="/encoding/gob/type.go.html#5929990">err</a></span><span class="op" id="5930044">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5930047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930050">return</span>&nbsp;<span class="ident" id="5930057"><a href="/encoding/gob/type.go.html#5929986">ut</a></span><br>
<span class="lineno"></span><span class="op" id="5930060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5930063">//&nbsp;A&nbsp;typeId&nbsp;represents&nbsp;a&nbsp;gob&nbsp;Type&nbsp;as&nbsp;an&nbsp;integer&nbsp;that&nbsp;can&nbsp;be&nbsp;passed&nbsp;on&nbsp;the&nbsp;wire.</span><br>
<span class="lineno">170</span><span class="comment" id="5930143">//&nbsp;Internally,&nbsp;typeIds&nbsp;are&nbsp;used&nbsp;as&nbsp;keys&nbsp;to&nbsp;a&nbsp;map&nbsp;to&nbsp;recover&nbsp;the&nbsp;underlying&nbsp;type&nbsp;info.</span><br>
<span class="lineno"></span><span class="keyword" id="5930229">type</span>&nbsp;<span class="ident" id="5930234">typeId</span>&nbsp;<span class="builtintype" id="5930241">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5930248">var</span>&nbsp;<span class="ident" id="5930252">nextId</span>&nbsp;<span class="ident" id="5930259"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5930272">//&nbsp;incremented&nbsp;for&nbsp;each&nbsp;new&nbsp;type&nbsp;we&nbsp;build</span><br>
<span class="lineno"></span><span class="keyword" id="5930314">var</span>&nbsp;<span class="ident" id="5930318">typeLock</span>&nbsp;<span class="ident" id="5930327"><a href="/encoding/gob/type.go.html#5924806">sync</a></span><span class="op" id="5930331">.</span><span class="ident" id="5930332">Mutex</span>&nbsp;<span class="comment" id="5930338">//&nbsp;set&nbsp;while&nbsp;building&nbsp;a&nbsp;type</span><br>
<span class="lineno">175</span><span class="keyword" id="5930367">const</span>&nbsp;<span class="ident" id="5930373">firstUserId</span>&nbsp;<span class="op" id="5930385">=</span>&nbsp;<span class="num" id="5930387">64</span>&nbsp;&nbsp;<span class="comment" id="5930391">//&nbsp;lowest&nbsp;id&nbsp;number&nbsp;granted&nbsp;to&nbsp;user</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5930428">type</span>&nbsp;<span class="ident" id="5930433">gobType</span>&nbsp;<span class="keyword" id="5930441">interface</span>&nbsp;<span class="op" id="5930451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930454">id</span><span class="op" id="5930456">(</span><span class="op" id="5930457">)</span>&nbsp;<span class="ident" id="5930459"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930467">setId</span><span class="op" id="5930472">(</span><span class="ident" id="5930473">id</span>&nbsp;<span class="ident" id="5930476"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5930482">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930485">name</span><span class="op" id="5930489">(</span><span class="op" id="5930490">)</span>&nbsp;<span class="builtintype" id="5930492">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5930500">string</span><span class="op" id="5930506">(</span><span class="op" id="5930507">)</span>&nbsp;<span class="builtintype" id="5930509">string</span>&nbsp;<span class="comment" id="5930516">//&nbsp;not&nbsp;public;&nbsp;only&nbsp;for&nbsp;debugging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930551">safeString</span><span class="op" id="5930561">(</span><span class="ident" id="5930562">seen</span>&nbsp;<span class="keyword" id="5930567">map</span><span class="op" id="5930570">[</span><span class="ident" id="5930571"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5930577">]</span><span class="builtintype" id="5930578">bool</span><span class="op" id="5930582">)</span>&nbsp;<span class="builtintype" id="5930584">string</span><br>
<span class="lineno"></span><span class="op" id="5930591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="5930594">var</span>&nbsp;<span class="ident" id="5930598">types</span>&nbsp;<span class="op" id="5930604">=</span>&nbsp;<span class="builtinfunc" id="5930606">make</span><span class="op" id="5930610">(</span><span class="keyword" id="5930611">map</span><span class="op" id="5930614">[</span><span class="ident" id="5930615"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5930622">.</span><span class="ident" id="5930623">Type</span><span class="op" id="5930627">]</span><span class="ident" id="5930628"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5930635">)</span><br>
<span class="lineno"></span><span class="keyword" id="5930637">var</span>&nbsp;<span class="ident" id="5930641">idToType</span>&nbsp;<span class="op" id="5930650">=</span>&nbsp;<span class="builtinfunc" id="5930652">make</span><span class="op" id="5930656">(</span><span class="keyword" id="5930657">map</span><span class="op" id="5930660">[</span><span class="ident" id="5930661"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5930667">]</span><span class="ident" id="5930668"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5930675">)</span><br>
<span class="lineno"></span><span class="keyword" id="5930677">var</span>&nbsp;<span class="ident" id="5930681">builtinIdToType</span>&nbsp;<span class="keyword" id="5930697">map</span><span class="op" id="5930700">[</span><span class="ident" id="5930701"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5930707">]</span><span class="ident" id="5930708"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span>&nbsp;<span class="comment" id="5930716">//&nbsp;set&nbsp;in&nbsp;init()&nbsp;after&nbsp;builtins&nbsp;are&nbsp;established</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5930765">func</span>&nbsp;<span class="ident" id="5930770">setTypeId</span><span class="op" id="5930779">(</span><span class="ident" id="5930780">typ</span>&nbsp;<span class="ident" id="5930784"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5930791">)</span>&nbsp;<span class="op" id="5930793">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5930796">//&nbsp;When&nbsp;building&nbsp;recursive&nbsp;types,&nbsp;someone&nbsp;may&nbsp;get&nbsp;there&nbsp;before&nbsp;us.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930864">if</span>&nbsp;<span class="ident" id="5930867"><a href="/encoding/gob/type.go.html#5930780">typ</a></span><span class="op" id="5930870">.</span><span class="ident" id="5930871">id</span><span class="op" id="5930873">(</span><span class="op" id="5930874">)</span>&nbsp;<span class="op" id="5930876">!=</span>&nbsp;<span class="num" id="5930879">0</span>&nbsp;<span class="op" id="5930881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5930893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930896"><a href="/encoding/gob/type.go.html#5930252">nextId</a></span><span class="op" id="5930902">++</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930906"><a href="/encoding/gob/type.go.html#5930780">typ</a></span><span class="op" id="5930909">.</span><span class="ident" id="5930910">setId</span><span class="op" id="5930915">(</span><span class="ident" id="5930916"><a href="/encoding/gob/type.go.html#5930252">nextId</a></span><span class="op" id="5930922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930925"><a href="/encoding/gob/type.go.html#5930641">idToType</a></span><span class="op" id="5930933">[</span><span class="ident" id="5930934"><a href="/encoding/gob/type.go.html#5930252">nextId</a></span><span class="op" id="5930940">]</span>&nbsp;<span class="op" id="5930942">=</span>&nbsp;<span class="ident" id="5930944"><a href="/encoding/gob/type.go.html#5930780">typ</a></span><br>
<span class="lineno"></span><span class="op" id="5930948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5930951">func</span>&nbsp;<span class="op" id="5930956">(</span><span class="ident" id="5930957">t</span>&nbsp;<span class="ident" id="5930959"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5930965">)</span>&nbsp;<span class="ident" id="5930967">gobType</span><span class="op" id="5930974">(</span><span class="op" id="5930975">)</span>&nbsp;<span class="ident" id="5930977"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span>&nbsp;<span class="op" id="5930985">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930988">if</span>&nbsp;<span class="ident" id="5930991"><a href="/encoding/gob/type.go.html#5930957">t</a></span>&nbsp;<span class="op" id="5930993">==</span>&nbsp;<span class="num" id="5930996">0</span>&nbsp;<span class="op" id="5930998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931002">return</span>&nbsp;<span class="ident" id="5931009">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931017">return</span>&nbsp;<span class="ident" id="5931024"><a href="/encoding/gob/type.go.html#5930641">idToType</a></span><span class="op" id="5931032">[</span><span class="ident" id="5931033"><a href="/encoding/gob/type.go.html#5930957">t</a></span><span class="op" id="5931034">]</span><br>
<span class="lineno"></span><span class="op" id="5931036">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="5931039">//&nbsp;string&nbsp;returns&nbsp;the&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type&nbsp;associated&nbsp;with&nbsp;the&nbsp;typeId.</span><br>
<span class="lineno"></span><span class="keyword" id="5931123">func</span>&nbsp;<span class="op" id="5931128">(</span><span class="ident" id="5931129">t</span>&nbsp;<span class="ident" id="5931131"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5931137">)</span>&nbsp;<span class="builtintype" id="5931139">string</span><span class="op" id="5931145">(</span><span class="op" id="5931146">)</span>&nbsp;<span class="builtintype" id="5931148">string</span>&nbsp;<span class="op" id="5931155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931158">if</span>&nbsp;<span class="ident" id="5931161"><a href="/encoding/gob/type.go.html#5931129">t</a></span><span class="op" id="5931162">.</span><span class="ident" id="5931163">gobType</span><span class="op" id="5931170">(</span><span class="op" id="5931171">)</span>&nbsp;<span class="op" id="5931173">==</span>&nbsp;<span class="ident" id="5931176">nil</span>&nbsp;<span class="op" id="5931180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931184">return</span>&nbsp;<span class="string" id="5931191">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931203">return</span>&nbsp;<span class="ident" id="5931210"><a href="/encoding/gob/type.go.html#5931129">t</a></span><span class="op" id="5931211">.</span><span class="ident" id="5931212">gobType</span><span class="op" id="5931219">(</span><span class="op" id="5931220">)</span><span class="op" id="5931221">.</span><span class="builtintype" id="5931222">string</span><span class="op" id="5931228">(</span><span class="op" id="5931229">)</span><br>
<span class="lineno"></span><span class="op" id="5931231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5931234">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;type&nbsp;associated&nbsp;with&nbsp;the&nbsp;typeId.</span><br>
<span class="lineno">215</span><span class="keyword" id="5931299">func</span>&nbsp;<span class="op" id="5931304">(</span><span class="ident" id="5931305">t</span>&nbsp;<span class="ident" id="5931307"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5931313">)</span>&nbsp;<span class="ident" id="5931315">name</span><span class="op" id="5931319">(</span><span class="op" id="5931320">)</span>&nbsp;<span class="builtintype" id="5931322">string</span>&nbsp;<span class="op" id="5931329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931332">if</span>&nbsp;<span class="ident" id="5931335"><a href="/encoding/gob/type.go.html#5931305">t</a></span><span class="op" id="5931336">.</span><span class="ident" id="5931337">gobType</span><span class="op" id="5931344">(</span><span class="op" id="5931345">)</span>&nbsp;<span class="op" id="5931347">==</span>&nbsp;<span class="ident" id="5931350">nil</span>&nbsp;<span class="op" id="5931354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931358">return</span>&nbsp;<span class="string" id="5931365">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931377">return</span>&nbsp;<span class="ident" id="5931384"><a href="/encoding/gob/type.go.html#5931305">t</a></span><span class="op" id="5931385">.</span><span class="ident" id="5931386">gobType</span><span class="op" id="5931393">(</span><span class="op" id="5931394">)</span><span class="op" id="5931395">.</span><span class="ident" id="5931396">name</span><span class="op" id="5931400">(</span><span class="op" id="5931401">)</span><br>
<span class="lineno">220</span><span class="op" id="5931403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5931406">//&nbsp;CommonType&nbsp;holds&nbsp;elements&nbsp;of&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="5931449">//&nbsp;It&nbsp;is&nbsp;a&nbsp;historical&nbsp;artifact,&nbsp;kept&nbsp;for&nbsp;binary&nbsp;compatibility&nbsp;and&nbsp;exported</span><br>
<span class="lineno"></span><span class="comment" id="5931524">//&nbsp;only&nbsp;for&nbsp;the&nbsp;benefit&nbsp;of&nbsp;the&nbsp;package&#39;s&nbsp;encoding&nbsp;of&nbsp;type&nbsp;descriptors.&nbsp;It&nbsp;is</span><br>
<span class="lineno">225</span><span class="comment" id="5931601">//&nbsp;not&nbsp;intended&nbsp;for&nbsp;direct&nbsp;use&nbsp;by&nbsp;clients.</span><br>
<span class="lineno"></span><span class="keyword" id="5931644">type</span>&nbsp;<span class="ident" id="5931649">CommonType</span>&nbsp;<span class="keyword" id="5931660">struct</span>&nbsp;<span class="op" id="5931667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931670">Name</span>&nbsp;<span class="builtintype" id="5931675">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931683">Id</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5931688"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><br>
<span class="lineno"></span><span class="op" id="5931695">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="5931698">func</span>&nbsp;<span class="op" id="5931703">(</span><span class="ident" id="5931704">t</span>&nbsp;<span class="op" id="5931706">*</span><span class="ident" id="5931707"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5931717">)</span>&nbsp;<span class="ident" id="5931719">id</span><span class="op" id="5931721">(</span><span class="op" id="5931722">)</span>&nbsp;<span class="ident" id="5931724"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span>&nbsp;<span class="op" id="5931731">{</span>&nbsp;<span class="keyword" id="5931733">return</span>&nbsp;<span class="ident" id="5931740"><a href="/encoding/gob/type.go.html#5931704">t</a></span><span class="op" id="5931741">.</span><span class="ident" id="5931742">Id</span>&nbsp;<span class="op" id="5931745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5931748">func</span>&nbsp;<span class="op" id="5931753">(</span><span class="ident" id="5931754">t</span>&nbsp;<span class="op" id="5931756">*</span><span class="ident" id="5931757"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5931767">)</span>&nbsp;<span class="ident" id="5931769">setId</span><span class="op" id="5931774">(</span><span class="ident" id="5931775">id</span>&nbsp;<span class="ident" id="5931778"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5931784">)</span>&nbsp;<span class="op" id="5931786">{</span>&nbsp;<span class="ident" id="5931788"><a href="/encoding/gob/type.go.html#5931754">t</a></span><span class="op" id="5931789">.</span><span class="ident" id="5931790">Id</span>&nbsp;<span class="op" id="5931793">=</span>&nbsp;<span class="ident" id="5931795"><a href="/encoding/gob/type.go.html#5931775">id</a></span>&nbsp;<span class="op" id="5931798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="5931801">func</span>&nbsp;<span class="op" id="5931806">(</span><span class="ident" id="5931807">t</span>&nbsp;<span class="op" id="5931809">*</span><span class="ident" id="5931810"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5931820">)</span>&nbsp;<span class="builtintype" id="5931822">string</span><span class="op" id="5931828">(</span><span class="op" id="5931829">)</span>&nbsp;<span class="builtintype" id="5931831">string</span>&nbsp;<span class="op" id="5931838">{</span>&nbsp;<span class="keyword" id="5931840">return</span>&nbsp;<span class="ident" id="5931847"><a href="/encoding/gob/type.go.html#5931807">t</a></span><span class="op" id="5931848">.</span><span class="ident" id="5931849">Name</span>&nbsp;<span class="op" id="5931854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5931857">func</span>&nbsp;<span class="op" id="5931862">(</span><span class="ident" id="5931863">t</span>&nbsp;<span class="op" id="5931865">*</span><span class="ident" id="5931866"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5931876">)</span>&nbsp;<span class="ident" id="5931878">safeString</span><span class="op" id="5931888">(</span><span class="ident" id="5931889">seen</span>&nbsp;<span class="keyword" id="5931894">map</span><span class="op" id="5931897">[</span><span class="ident" id="5931898"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5931904">]</span><span class="builtintype" id="5931905">bool</span><span class="op" id="5931909">)</span>&nbsp;<span class="builtintype" id="5931911">string</span>&nbsp;<span class="op" id="5931918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931921">return</span>&nbsp;<span class="ident" id="5931928"><a href="/encoding/gob/type.go.html#5931863">t</a></span><span class="op" id="5931929">.</span><span class="ident" id="5931930">Name</span><br>
<span class="lineno"></span><span class="op" id="5931935">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="5931938">func</span>&nbsp;<span class="op" id="5931943">(</span><span class="ident" id="5931944">t</span>&nbsp;<span class="op" id="5931946">*</span><span class="ident" id="5931947"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5931957">)</span>&nbsp;<span class="ident" id="5931959">name</span><span class="op" id="5931963">(</span><span class="op" id="5931964">)</span>&nbsp;<span class="builtintype" id="5931966">string</span>&nbsp;<span class="op" id="5931973">{</span>&nbsp;<span class="keyword" id="5931975">return</span>&nbsp;<span class="ident" id="5931982"><a href="/encoding/gob/type.go.html#5931944">t</a></span><span class="op" id="5931983">.</span><span class="ident" id="5931984">Name</span>&nbsp;<span class="op" id="5931989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5931992">//&nbsp;Create&nbsp;and&nbsp;check&nbsp;predefined&nbsp;types</span><br>
<span class="lineno"></span><span class="comment" id="5932029">//&nbsp;The&nbsp;string&nbsp;for&nbsp;tBytes&nbsp;is&nbsp;&#34;bytes&#34;&nbsp;not&nbsp;&#34;[]byte&#34;&nbsp;to&nbsp;signify&nbsp;its&nbsp;specialness.</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5932107">var</span>&nbsp;<span class="op" id="5932111">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5932114">//&nbsp;Primordial&nbsp;types,&nbsp;needed&nbsp;during&nbsp;initialization.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5932166">//&nbsp;Always&nbsp;passed&nbsp;as&nbsp;pointers&nbsp;so&nbsp;the&nbsp;interface{}&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5932220">//&nbsp;goes&nbsp;through&nbsp;without&nbsp;losing&nbsp;its&nbsp;interfaceness.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932271">tBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932282">=</span>&nbsp;<span class="ident" id="5932284"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932297">(</span><span class="string" id="5932298">&#34;bool&#34;</span><span class="op" id="5932304">,</span>&nbsp;<span class="op" id="5932306">(</span><span class="op" id="5932307">*</span><span class="builtintype" id="5932308">bool</span><span class="op" id="5932312">)</span><span class="op" id="5932313">(</span><span class="ident" id="5932314">nil</span><span class="op" id="5932317">)</span><span class="op" id="5932318">,</span>&nbsp;<span class="num" id="5932320">1</span><span class="op" id="5932321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932324">tInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932335">=</span>&nbsp;<span class="ident" id="5932337"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932350">(</span><span class="string" id="5932351">&#34;int&#34;</span><span class="op" id="5932356">,</span>&nbsp;<span class="op" id="5932358">(</span><span class="op" id="5932359">*</span><span class="builtintype" id="5932360">int</span><span class="op" id="5932363">)</span><span class="op" id="5932364">(</span><span class="ident" id="5932365">nil</span><span class="op" id="5932368">)</span><span class="op" id="5932369">,</span>&nbsp;<span class="num" id="5932371">2</span><span class="op" id="5932372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932375">tUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932386">=</span>&nbsp;<span class="ident" id="5932388"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932401">(</span><span class="string" id="5932402">&#34;uint&#34;</span><span class="op" id="5932408">,</span>&nbsp;<span class="op" id="5932410">(</span><span class="op" id="5932411">*</span><span class="builtintype" id="5932412">uint</span><span class="op" id="5932416">)</span><span class="op" id="5932417">(</span><span class="ident" id="5932418">nil</span><span class="op" id="5932421">)</span><span class="op" id="5932422">,</span>&nbsp;<span class="num" id="5932424">3</span><span class="op" id="5932425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932428">tFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932439">=</span>&nbsp;<span class="ident" id="5932441"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932454">(</span><span class="string" id="5932455">&#34;float&#34;</span><span class="op" id="5932462">,</span>&nbsp;<span class="op" id="5932464">(</span><span class="op" id="5932465">*</span><span class="builtintype" id="5932466">float64</span><span class="op" id="5932473">)</span><span class="op" id="5932474">(</span><span class="ident" id="5932475">nil</span><span class="op" id="5932478">)</span><span class="op" id="5932479">,</span>&nbsp;<span class="num" id="5932481">4</span><span class="op" id="5932482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932485">tBytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932496">=</span>&nbsp;<span class="ident" id="5932498"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932511">(</span><span class="string" id="5932512">&#34;bytes&#34;</span><span class="op" id="5932519">,</span>&nbsp;<span class="op" id="5932521">(</span><span class="op" id="5932522">*</span><span class="op" id="5932523">[</span><span class="op" id="5932524">]</span><span class="builtintype" id="5932525">byte</span><span class="op" id="5932529">)</span><span class="op" id="5932530">(</span><span class="ident" id="5932531">nil</span><span class="op" id="5932534">)</span><span class="op" id="5932535">,</span>&nbsp;<span class="num" id="5932537">5</span><span class="op" id="5932538">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932541">tString</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932552">=</span>&nbsp;<span class="ident" id="5932554"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932567">(</span><span class="string" id="5932568">&#34;string&#34;</span><span class="op" id="5932576">,</span>&nbsp;<span class="op" id="5932578">(</span><span class="op" id="5932579">*</span><span class="builtintype" id="5932580">string</span><span class="op" id="5932586">)</span><span class="op" id="5932587">(</span><span class="ident" id="5932588">nil</span><span class="op" id="5932591">)</span><span class="op" id="5932592">,</span>&nbsp;<span class="num" id="5932594">6</span><span class="op" id="5932595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932598">tComplex</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5932609">=</span>&nbsp;<span class="ident" id="5932611"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932624">(</span><span class="string" id="5932625">&#34;complex&#34;</span><span class="op" id="5932634">,</span>&nbsp;<span class="op" id="5932636">(</span><span class="op" id="5932637">*</span><span class="builtintype" id="5932638">complex128</span><span class="op" id="5932648">)</span><span class="op" id="5932649">(</span><span class="ident" id="5932650">nil</span><span class="op" id="5932653">)</span><span class="op" id="5932654">,</span>&nbsp;<span class="num" id="5932656">7</span><span class="op" id="5932657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932660">tInterface</span>&nbsp;<span class="op" id="5932671">=</span>&nbsp;<span class="ident" id="5932673"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932686">(</span><span class="string" id="5932687">&#34;interface&#34;</span><span class="op" id="5932698">,</span>&nbsp;<span class="op" id="5932700">(</span><span class="op" id="5932701">*</span><span class="keyword" id="5932702">interface</span><span class="op" id="5932711">{</span><span class="op" id="5932712">}</span><span class="op" id="5932713">)</span><span class="op" id="5932714">(</span><span class="ident" id="5932715">nil</span><span class="op" id="5932718">)</span><span class="op" id="5932719">,</span>&nbsp;<span class="num" id="5932721">8</span><span class="op" id="5932722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5932725">//&nbsp;Reserve&nbsp;some&nbsp;Ids&nbsp;for&nbsp;compatible&nbsp;expansion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932771">tReserved7</span>&nbsp;<span class="op" id="5932782">=</span>&nbsp;<span class="ident" id="5932784"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932797">(</span><span class="string" id="5932798">&#34;_reserved1&#34;</span><span class="op" id="5932810">,</span>&nbsp;<span class="op" id="5932812">(</span><span class="op" id="5932813">*</span><span class="keyword" id="5932814">struct</span><span class="op" id="5932820">{</span>&nbsp;<span class="ident" id="5932822">r7</span>&nbsp;<span class="builtintype" id="5932825">int</span>&nbsp;<span class="op" id="5932829">}</span><span class="op" id="5932830">)</span><span class="op" id="5932831">(</span><span class="ident" id="5932832">nil</span><span class="op" id="5932835">)</span><span class="op" id="5932836">,</span>&nbsp;<span class="num" id="5932838">9</span><span class="op" id="5932839">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932842">tReserved6</span>&nbsp;<span class="op" id="5932853">=</span>&nbsp;<span class="ident" id="5932855"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932868">(</span><span class="string" id="5932869">&#34;_reserved1&#34;</span><span class="op" id="5932881">,</span>&nbsp;<span class="op" id="5932883">(</span><span class="op" id="5932884">*</span><span class="keyword" id="5932885">struct</span><span class="op" id="5932891">{</span>&nbsp;<span class="ident" id="5932893">r6</span>&nbsp;<span class="builtintype" id="5932896">int</span>&nbsp;<span class="op" id="5932900">}</span><span class="op" id="5932901">)</span><span class="op" id="5932902">(</span><span class="ident" id="5932903">nil</span><span class="op" id="5932906">)</span><span class="op" id="5932907">,</span>&nbsp;<span class="num" id="5932909">10</span><span class="op" id="5932911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932914">tReserved5</span>&nbsp;<span class="op" id="5932925">=</span>&nbsp;<span class="ident" id="5932927"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5932940">(</span><span class="string" id="5932941">&#34;_reserved1&#34;</span><span class="op" id="5932953">,</span>&nbsp;<span class="op" id="5932955">(</span><span class="op" id="5932956">*</span><span class="keyword" id="5932957">struct</span><span class="op" id="5932963">{</span>&nbsp;<span class="ident" id="5932965">r5</span>&nbsp;<span class="builtintype" id="5932968">int</span>&nbsp;<span class="op" id="5932972">}</span><span class="op" id="5932973">)</span><span class="op" id="5932974">(</span><span class="ident" id="5932975">nil</span><span class="op" id="5932978">)</span><span class="op" id="5932979">,</span>&nbsp;<span class="num" id="5932981">11</span><span class="op" id="5932983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5932986">tReserved4</span>&nbsp;<span class="op" id="5932997">=</span>&nbsp;<span class="ident" id="5932999"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5933012">(</span><span class="string" id="5933013">&#34;_reserved1&#34;</span><span class="op" id="5933025">,</span>&nbsp;<span class="op" id="5933027">(</span><span class="op" id="5933028">*</span><span class="keyword" id="5933029">struct</span><span class="op" id="5933035">{</span>&nbsp;<span class="ident" id="5933037">r4</span>&nbsp;<span class="builtintype" id="5933040">int</span>&nbsp;<span class="op" id="5933044">}</span><span class="op" id="5933045">)</span><span class="op" id="5933046">(</span><span class="ident" id="5933047">nil</span><span class="op" id="5933050">)</span><span class="op" id="5933051">,</span>&nbsp;<span class="num" id="5933053">12</span><span class="op" id="5933055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933058">tReserved3</span>&nbsp;<span class="op" id="5933069">=</span>&nbsp;<span class="ident" id="5933071"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5933084">(</span><span class="string" id="5933085">&#34;_reserved1&#34;</span><span class="op" id="5933097">,</span>&nbsp;<span class="op" id="5933099">(</span><span class="op" id="5933100">*</span><span class="keyword" id="5933101">struct</span><span class="op" id="5933107">{</span>&nbsp;<span class="ident" id="5933109">r3</span>&nbsp;<span class="builtintype" id="5933112">int</span>&nbsp;<span class="op" id="5933116">}</span><span class="op" id="5933117">)</span><span class="op" id="5933118">(</span><span class="ident" id="5933119">nil</span><span class="op" id="5933122">)</span><span class="op" id="5933123">,</span>&nbsp;<span class="num" id="5933125">13</span><span class="op" id="5933127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933130">tReserved2</span>&nbsp;<span class="op" id="5933141">=</span>&nbsp;<span class="ident" id="5933143"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5933156">(</span><span class="string" id="5933157">&#34;_reserved1&#34;</span><span class="op" id="5933169">,</span>&nbsp;<span class="op" id="5933171">(</span><span class="op" id="5933172">*</span><span class="keyword" id="5933173">struct</span><span class="op" id="5933179">{</span>&nbsp;<span class="ident" id="5933181">r2</span>&nbsp;<span class="builtintype" id="5933184">int</span>&nbsp;<span class="op" id="5933188">}</span><span class="op" id="5933189">)</span><span class="op" id="5933190">(</span><span class="ident" id="5933191">nil</span><span class="op" id="5933194">)</span><span class="op" id="5933195">,</span>&nbsp;<span class="num" id="5933197">14</span><span class="op" id="5933199">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933202">tReserved1</span>&nbsp;<span class="op" id="5933213">=</span>&nbsp;<span class="ident" id="5933215"><a href="/encoding/gob/type.go.html#5942842">bootstrapType</a></span><span class="op" id="5933228">(</span><span class="string" id="5933229">&#34;_reserved1&#34;</span><span class="op" id="5933241">,</span>&nbsp;<span class="op" id="5933243">(</span><span class="op" id="5933244">*</span><span class="keyword" id="5933245">struct</span><span class="op" id="5933251">{</span>&nbsp;<span class="ident" id="5933253">r1</span>&nbsp;<span class="builtintype" id="5933256">int</span>&nbsp;<span class="op" id="5933260">}</span><span class="op" id="5933261">)</span><span class="op" id="5933262">(</span><span class="ident" id="5933263">nil</span><span class="op" id="5933266">)</span><span class="op" id="5933267">,</span>&nbsp;<span class="num" id="5933269">15</span><span class="op" id="5933271">)</span><br>
<span class="lineno"></span><span class="op" id="5933273">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5933276">//&nbsp;Predefined&nbsp;because&nbsp;it&#39;s&nbsp;needed&nbsp;by&nbsp;the&nbsp;Decoder</span><br>
<span class="lineno"></span><span class="keyword" id="5933325">var</span>&nbsp;<span class="ident" id="5933329">tWireType</span>&nbsp;<span class="op" id="5933339">=</span>&nbsp;<span class="ident" id="5933341"><a href="/encoding/gob/type.go.html#5947129">mustGetTypeInfo</a></span><span class="op" id="5933356">(</span><span class="ident" id="5933357"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5933364">.</span><span class="ident" id="5933365">TypeOf</span><span class="op" id="5933371">(</span><span class="ident" id="5933372"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5933380">{</span><span class="op" id="5933381">}</span><span class="op" id="5933382">)</span><span class="op" id="5933383">)</span><span class="op" id="5933384">.</span><span class="ident" id="5933385">id</span><br>
<span class="lineno">270</span><span class="keyword" id="5933388">var</span>&nbsp;<span class="ident" id="5933392">wireTypeUserInfo</span>&nbsp;<span class="op" id="5933409">*</span><span class="ident" id="5933410"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span>&nbsp;<span class="comment" id="5933423">//&nbsp;userTypeInfo&nbsp;of&nbsp;(*wireType)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5933455">func</span>&nbsp;<span class="ident" id="5933460">init</span><span class="op" id="5933464">(</span><span class="op" id="5933465">)</span>&nbsp;<span class="op" id="5933467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933470">//&nbsp;Some&nbsp;magic&nbsp;numbers&nbsp;to&nbsp;make&nbsp;sure&nbsp;there&nbsp;are&nbsp;no&nbsp;surprises.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933530"><a href="/encoding/gob/type.go.html#5942494">checkId</a></span><span class="op" id="5933537">(</span><span class="num" id="5933538">16</span><span class="op" id="5933540">,</span>&nbsp;<span class="ident" id="5933542"><a href="/encoding/gob/type.go.html#5933329">tWireType</a></span><span class="op" id="5933551">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933554"><a href="/encoding/gob/type.go.html#5942494">checkId</a></span><span class="op" id="5933561">(</span><span class="num" id="5933562">17</span><span class="op" id="5933564">,</span>&nbsp;<span class="ident" id="5933566"><a href="/encoding/gob/type.go.html#5947129">mustGetTypeInfo</a></span><span class="op" id="5933581">(</span><span class="ident" id="5933582"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5933589">.</span><span class="ident" id="5933590">TypeOf</span><span class="op" id="5933596">(</span><span class="ident" id="5933597"><a href="/encoding/gob/type.go.html#5934346">arrayType</a></span><span class="op" id="5933606">{</span><span class="op" id="5933607">}</span><span class="op" id="5933608">)</span><span class="op" id="5933609">)</span><span class="op" id="5933610">.</span><span class="ident" id="5933611">id</span><span class="op" id="5933613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933616"><a href="/encoding/gob/type.go.html#5942494">checkId</a></span><span class="op" id="5933623">(</span><span class="num" id="5933624">18</span><span class="op" id="5933626">,</span>&nbsp;<span class="ident" id="5933628"><a href="/encoding/gob/type.go.html#5947129">mustGetTypeInfo</a></span><span class="op" id="5933643">(</span><span class="ident" id="5933644"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5933651">.</span><span class="ident" id="5933652">TypeOf</span><span class="op" id="5933658">(</span><span class="ident" id="5933659"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5933669">{</span><span class="op" id="5933670">}</span><span class="op" id="5933671">)</span><span class="op" id="5933672">)</span><span class="op" id="5933673">.</span><span class="ident" id="5933674">id</span><span class="op" id="5933676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933679"><a href="/encoding/gob/type.go.html#5942494">checkId</a></span><span class="op" id="5933686">(</span><span class="num" id="5933687">19</span><span class="op" id="5933689">,</span>&nbsp;<span class="ident" id="5933691"><a href="/encoding/gob/type.go.html#5947129">mustGetTypeInfo</a></span><span class="op" id="5933706">(</span><span class="ident" id="5933707"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5933714">.</span><span class="ident" id="5933715">TypeOf</span><span class="op" id="5933721">(</span><span class="ident" id="5933722"><a href="/encoding/gob/type.go.html#5936040">sliceType</a></span><span class="op" id="5933731">{</span><span class="op" id="5933732">}</span><span class="op" id="5933733">)</span><span class="op" id="5933734">)</span><span class="op" id="5933735">.</span><span class="ident" id="5933736">id</span><span class="op" id="5933738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933741"><a href="/encoding/gob/type.go.html#5942494">checkId</a></span><span class="op" id="5933748">(</span><span class="num" id="5933749">20</span><span class="op" id="5933751">,</span>&nbsp;<span class="ident" id="5933753"><a href="/encoding/gob/type.go.html#5947129">mustGetTypeInfo</a></span><span class="op" id="5933768">(</span><span class="ident" id="5933769"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5933776">.</span><span class="ident" id="5933777">TypeOf</span><span class="op" id="5933783">(</span><span class="ident" id="5933784"><a href="/encoding/gob/type.go.html#5936823">structType</a></span><span class="op" id="5933794">{</span><span class="op" id="5933795">}</span><span class="op" id="5933796">)</span><span class="op" id="5933797">)</span><span class="op" id="5933798">.</span><span class="ident" id="5933799">id</span><span class="op" id="5933801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933804"><a href="/encoding/gob/type.go.html#5942494">checkId</a></span><span class="op" id="5933811">(</span><span class="num" id="5933812">21</span><span class="op" id="5933814">,</span>&nbsp;<span class="ident" id="5933816"><a href="/encoding/gob/type.go.html#5947129">mustGetTypeInfo</a></span><span class="op" id="5933831">(</span><span class="ident" id="5933832"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5933839">.</span><span class="ident" id="5933840">TypeOf</span><span class="op" id="5933846">(</span><span class="ident" id="5933847"><a href="/encoding/gob/type.go.html#5936770">fieldType</a></span><span class="op" id="5933856">{</span><span class="op" id="5933857">}</span><span class="op" id="5933858">)</span><span class="op" id="5933859">)</span><span class="op" id="5933860">.</span><span class="ident" id="5933861">id</span><span class="op" id="5933863">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933866"><a href="/encoding/gob/type.go.html#5942494">checkId</a></span><span class="op" id="5933873">(</span><span class="num" id="5933874">23</span><span class="op" id="5933876">,</span>&nbsp;<span class="ident" id="5933878"><a href="/encoding/gob/type.go.html#5947129">mustGetTypeInfo</a></span><span class="op" id="5933893">(</span><span class="ident" id="5933894"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5933901">.</span><span class="ident" id="5933902">TypeOf</span><span class="op" id="5933908">(</span><span class="ident" id="5933909"><a href="/encoding/gob/type.go.html#5935363">mapType</a></span><span class="op" id="5933916">{</span><span class="op" id="5933917">}</span><span class="op" id="5933918">)</span><span class="op" id="5933919">)</span><span class="op" id="5933920">.</span><span class="ident" id="5933921">id</span><span class="op" id="5933923">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933927"><a href="/encoding/gob/type.go.html#5930681">builtinIdToType</a></span>&nbsp;<span class="op" id="5933943">=</span>&nbsp;<span class="builtinfunc" id="5933945">make</span><span class="op" id="5933949">(</span><span class="keyword" id="5933950">map</span><span class="op" id="5933953">[</span><span class="ident" id="5933954"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5933960">]</span><span class="ident" id="5933961"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5933968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933971">for</span>&nbsp;<span class="ident" id="5933975">k</span><span class="op" id="5933976">,</span>&nbsp;<span class="ident" id="5933978">v</span>&nbsp;<span class="op" id="5933980">:=</span>&nbsp;<span class="keyword" id="5933983">range</span>&nbsp;<span class="ident" id="5933989"><a href="/encoding/gob/type.go.html#5930641">idToType</a></span>&nbsp;<span class="op" id="5933998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934002"><a href="/encoding/gob/type.go.html#5930681">builtinIdToType</a></span><span class="op" id="5934017">[</span><span class="ident" id="5934018"><a href="/encoding/gob/type.go.html#5933975">k</a></span><span class="op" id="5934019">]</span>&nbsp;<span class="op" id="5934021">=</span>&nbsp;<span class="ident" id="5934023"><a href="/encoding/gob/type.go.html#5933978">v</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934030">//&nbsp;Move&nbsp;the&nbsp;id&nbsp;space&nbsp;upwards&nbsp;to&nbsp;allow&nbsp;for&nbsp;growth&nbsp;in&nbsp;the&nbsp;predefined&nbsp;world</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934104">//&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934141">if</span>&nbsp;<span class="ident" id="5934144"><a href="/encoding/gob/type.go.html#5930252">nextId</a></span>&nbsp;<span class="op" id="5934151">&gt;</span>&nbsp;<span class="ident" id="5934153"><a href="/encoding/gob/type.go.html#5930373">firstUserId</a></span>&nbsp;<span class="op" id="5934165">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5934169">panic</span><span class="op" id="5934174">(</span><span class="ident" id="5934175"><a href="/encoding/gob/type.go.html#5924782">fmt</a></span><span class="op" id="5934178">.</span><span class="ident" id="5934179">Sprintln</span><span class="op" id="5934187">(</span><span class="string" id="5934188">&#34;nextId&nbsp;too&nbsp;large:&#34;</span><span class="op" id="5934207">,</span>&nbsp;<span class="ident" id="5934209"><a href="/encoding/gob/type.go.html#5930252">nextId</a></span><span class="op" id="5934215">)</span><span class="op" id="5934216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934222"><a href="/encoding/gob/type.go.html#5930252">nextId</a></span>&nbsp;<span class="op" id="5934229">=</span>&nbsp;<span class="ident" id="5934231"><a href="/encoding/gob/type.go.html#5930373">firstUserId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934244"><a href="/encoding/gob/type.go.html#5951246">registerBasics</a></span><span class="op" id="5934258">(</span><span class="op" id="5934259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934262"><a href="/encoding/gob/type.go.html#5933392">wireTypeUserInfo</a></span>&nbsp;<span class="op" id="5934279">=</span>&nbsp;<span class="ident" id="5934281"><a href="/encoding/gob/type.go.html#5929943">userType</a></span><span class="op" id="5934289">(</span><span class="ident" id="5934290"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5934297">.</span><span class="ident" id="5934298">TypeOf</span><span class="op" id="5934304">(</span><span class="op" id="5934305">(</span><span class="op" id="5934306">*</span><span class="ident" id="5934307"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5934315">)</span><span class="op" id="5934316">(</span><span class="ident" id="5934317">nil</span><span class="op" id="5934320">)</span><span class="op" id="5934321">)</span><span class="op" id="5934322">)</span><br>
<span class="lineno">295</span><span class="op" id="5934324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5934327">//&nbsp;Array&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="5934341">type</span>&nbsp;<span class="ident" id="5934346">arrayType</span>&nbsp;<span class="keyword" id="5934356">struct</span>&nbsp;<span class="op" id="5934363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934366"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934378">Elem</span>&nbsp;<span class="ident" id="5934383"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934391">Len</span>&nbsp;&nbsp;<span class="builtintype" id="5934396">int</span><br>
<span class="lineno"></span><span class="op" id="5934400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5934403">func</span>&nbsp;<span class="ident" id="5934408">newArrayType</span><span class="op" id="5934420">(</span><span class="ident" id="5934421">name</span>&nbsp;<span class="builtintype" id="5934426">string</span><span class="op" id="5934432">)</span>&nbsp;<span class="op" id="5934434">*</span><span class="ident" id="5934435"><a href="/encoding/gob/type.go.html#5934346">arrayType</a></span>&nbsp;<span class="op" id="5934445">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934448">a</span>&nbsp;<span class="op" id="5934450">:=</span>&nbsp;<span class="op" id="5934453">&amp;</span><span class="ident" id="5934454"><a href="/encoding/gob/type.go.html#5934346">arrayType</a></span><span class="op" id="5934463">{</span><span class="ident" id="5934464"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5934474">{</span><span class="ident" id="5934475">Name</span><span class="op" id="5934479">:</span>&nbsp;<span class="ident" id="5934481"><a href="/encoding/gob/type.go.html#5934421">name</a></span><span class="op" id="5934485">}</span><span class="op" id="5934486">,</span>&nbsp;<span class="num" id="5934488">0</span><span class="op" id="5934489">,</span>&nbsp;<span class="num" id="5934491">0</span><span class="op" id="5934492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934495">return</span>&nbsp;<span class="ident" id="5934502"><a href="/encoding/gob/type.go.html#5934448">a</a></span><br>
<span class="lineno"></span><span class="op" id="5934504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5934507">func</span>&nbsp;<span class="op" id="5934512">(</span><span class="ident" id="5934513">a</span>&nbsp;<span class="op" id="5934515">*</span><span class="ident" id="5934516"><a href="/encoding/gob/type.go.html#5934346">arrayType</a></span><span class="op" id="5934525">)</span>&nbsp;<span class="ident" id="5934527">init</span><span class="op" id="5934531">(</span><span class="ident" id="5934532">elem</span>&nbsp;<span class="ident" id="5934537"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5934544">,</span>&nbsp;<span class="builtinfunc" id="5934546">len</span>&nbsp;<span class="builtintype" id="5934550">int</span><span class="op" id="5934553">)</span>&nbsp;<span class="op" id="5934555">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934558">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934633"><a href="/encoding/gob/type.go.html#5930770">setTypeId</a></span><span class="op" id="5934642">(</span><span class="ident" id="5934643"><a href="/encoding/gob/type.go.html#5934513">a</a></span><span class="op" id="5934644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934647"><a href="/encoding/gob/type.go.html#5934513">a</a></span><span class="op" id="5934648">.</span><span class="ident" id="5934649">Elem</span>&nbsp;<span class="op" id="5934654">=</span>&nbsp;<span class="ident" id="5934656"><a href="/encoding/gob/type.go.html#5934532">elem</a></span><span class="op" id="5934660">.</span><span class="ident" id="5934661">id</span><span class="op" id="5934663">(</span><span class="op" id="5934664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934667"><a href="/encoding/gob/type.go.html#5934513">a</a></span><span class="op" id="5934668">.</span><span class="ident" id="5934669">Len</span>&nbsp;<span class="op" id="5934673">=</span>&nbsp;<span class="builtinfunc" id="5934675"><a href="/encoding/gob/type.go.html#5934546">len</a></span><br>
<span class="lineno"></span><span class="op" id="5934679">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5934682">func</span>&nbsp;<span class="op" id="5934687">(</span><span class="ident" id="5934688">a</span>&nbsp;<span class="op" id="5934690">*</span><span class="ident" id="5934691"><a href="/encoding/gob/type.go.html#5934346">arrayType</a></span><span class="op" id="5934700">)</span>&nbsp;<span class="ident" id="5934702">safeString</span><span class="op" id="5934712">(</span><span class="ident" id="5934713">seen</span>&nbsp;<span class="keyword" id="5934718">map</span><span class="op" id="5934721">[</span><span class="ident" id="5934722"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5934728">]</span><span class="builtintype" id="5934729">bool</span><span class="op" id="5934733">)</span>&nbsp;<span class="builtintype" id="5934735">string</span>&nbsp;<span class="op" id="5934742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934745">if</span>&nbsp;<span class="ident" id="5934748"><a href="/encoding/gob/type.go.html#5934713">seen</a></span><span class="op" id="5934752">[</span><span class="ident" id="5934753"><a href="/encoding/gob/type.go.html#5934688">a</a></span><span class="op" id="5934754">.</span><span class="ident" id="5934755">Id</span><span class="op" id="5934757">]</span>&nbsp;<span class="op" id="5934759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934763">return</span>&nbsp;<span class="ident" id="5934770"><a href="/encoding/gob/type.go.html#5934688">a</a></span><span class="op" id="5934771">.</span><span class="ident" id="5934772">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934778">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934781"><a href="/encoding/gob/type.go.html#5934713">seen</a></span><span class="op" id="5934785">[</span><span class="ident" id="5934786"><a href="/encoding/gob/type.go.html#5934688">a</a></span><span class="op" id="5934787">.</span><span class="ident" id="5934788">Id</span><span class="op" id="5934790">]</span>&nbsp;<span class="op" id="5934792">=</span>&nbsp;<span class="builtintype" id="5934794">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934800">return</span>&nbsp;<span class="ident" id="5934807"><a href="/encoding/gob/type.go.html#5924782">fmt</a></span><span class="op" id="5934810">.</span><span class="ident" id="5934811">Sprintf</span><span class="op" id="5934818">(</span><span class="string" id="5934819">&#34;[%d]%s&#34;</span><span class="op" id="5934827">,</span>&nbsp;<span class="ident" id="5934829"><a href="/encoding/gob/type.go.html#5934688">a</a></span><span class="op" id="5934830">.</span><span class="ident" id="5934831">Len</span><span class="op" id="5934834">,</span>&nbsp;<span class="ident" id="5934836"><a href="/encoding/gob/type.go.html#5934688">a</a></span><span class="op" id="5934837">.</span><span class="ident" id="5934838">Elem</span><span class="op" id="5934842">.</span><span class="ident" id="5934843">gobType</span><span class="op" id="5934850">(</span><span class="op" id="5934851">)</span><span class="op" id="5934852">.</span><span class="ident" id="5934853">safeString</span><span class="op" id="5934863">(</span><span class="ident" id="5934864"><a href="/encoding/gob/type.go.html#5934713">seen</a></span><span class="op" id="5934868">)</span><span class="op" id="5934869">)</span><br>
<span class="lineno"></span><span class="op" id="5934871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5934874">func</span>&nbsp;<span class="op" id="5934879">(</span><span class="ident" id="5934880">a</span>&nbsp;<span class="op" id="5934882">*</span><span class="ident" id="5934883"><a href="/encoding/gob/type.go.html#5934346">arrayType</a></span><span class="op" id="5934892">)</span>&nbsp;<span class="builtintype" id="5934894">string</span><span class="op" id="5934900">(</span><span class="op" id="5934901">)</span>&nbsp;<span class="builtintype" id="5934903">string</span>&nbsp;<span class="op" id="5934910">{</span>&nbsp;<span class="keyword" id="5934912">return</span>&nbsp;<span class="ident" id="5934919"><a href="/encoding/gob/type.go.html#5934880">a</a></span><span class="op" id="5934920">.</span><span class="ident" id="5934921">safeString</span><span class="op" id="5934931">(</span><span class="builtinfunc" id="5934932">make</span><span class="op" id="5934936">(</span><span class="keyword" id="5934937">map</span><span class="op" id="5934940">[</span><span class="ident" id="5934941"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5934947">]</span><span class="builtintype" id="5934948">bool</span><span class="op" id="5934952">)</span><span class="op" id="5934953">)</span>&nbsp;<span class="op" id="5934955">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="comment" id="5934958">//&nbsp;GobEncoder&nbsp;type&nbsp;(something&nbsp;that&nbsp;implements&nbsp;the&nbsp;GobEncoder&nbsp;interface)</span><br>
<span class="lineno"></span><span class="keyword" id="5935030">type</span>&nbsp;<span class="ident" id="5935035">gobEncoderType</span>&nbsp;<span class="keyword" id="5935050">struct</span>&nbsp;<span class="op" id="5935057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935060"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><br>
<span class="lineno"></span><span class="op" id="5935071">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5935074">func</span>&nbsp;<span class="ident" id="5935079">newGobEncoderType</span><span class="op" id="5935096">(</span><span class="ident" id="5935097">name</span>&nbsp;<span class="builtintype" id="5935102">string</span><span class="op" id="5935108">)</span>&nbsp;<span class="op" id="5935110">*</span><span class="ident" id="5935111"><a href="/encoding/gob/type.go.html#5935035">gobEncoderType</a></span>&nbsp;<span class="op" id="5935126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935129">g</span>&nbsp;<span class="op" id="5935131">:=</span>&nbsp;<span class="op" id="5935134">&amp;</span><span class="ident" id="5935135"><a href="/encoding/gob/type.go.html#5935035">gobEncoderType</a></span><span class="op" id="5935149">{</span><span class="ident" id="5935150"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5935160">{</span><span class="ident" id="5935161">Name</span><span class="op" id="5935165">:</span>&nbsp;<span class="ident" id="5935167"><a href="/encoding/gob/type.go.html#5935097">name</a></span><span class="op" id="5935171">}</span><span class="op" id="5935172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935175"><a href="/encoding/gob/type.go.html#5930770">setTypeId</a></span><span class="op" id="5935184">(</span><span class="ident" id="5935185"><a href="/encoding/gob/type.go.html#5935129">g</a></span><span class="op" id="5935186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935189">return</span>&nbsp;<span class="ident" id="5935196"><a href="/encoding/gob/type.go.html#5935129">g</a></span><br>
<span class="lineno">335</span><span class="op" id="5935198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5935201">func</span>&nbsp;<span class="op" id="5935206">(</span><span class="ident" id="5935207">g</span>&nbsp;<span class="op" id="5935209">*</span><span class="ident" id="5935210"><a href="/encoding/gob/type.go.html#5935035">gobEncoderType</a></span><span class="op" id="5935224">)</span>&nbsp;<span class="ident" id="5935226">safeString</span><span class="op" id="5935236">(</span><span class="ident" id="5935237">seen</span>&nbsp;<span class="keyword" id="5935242">map</span><span class="op" id="5935245">[</span><span class="ident" id="5935246"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5935252">]</span><span class="builtintype" id="5935253">bool</span><span class="op" id="5935257">)</span>&nbsp;<span class="builtintype" id="5935259">string</span>&nbsp;<span class="op" id="5935266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935269">return</span>&nbsp;<span class="ident" id="5935276"><a href="/encoding/gob/type.go.html#5935207">g</a></span><span class="op" id="5935277">.</span><span class="ident" id="5935278">Name</span><br>
<span class="lineno"></span><span class="op" id="5935283">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="5935286">func</span>&nbsp;<span class="op" id="5935291">(</span><span class="ident" id="5935292">g</span>&nbsp;<span class="op" id="5935294">*</span><span class="ident" id="5935295"><a href="/encoding/gob/type.go.html#5935035">gobEncoderType</a></span><span class="op" id="5935309">)</span>&nbsp;<span class="builtintype" id="5935311">string</span><span class="op" id="5935317">(</span><span class="op" id="5935318">)</span>&nbsp;<span class="builtintype" id="5935320">string</span>&nbsp;<span class="op" id="5935327">{</span>&nbsp;<span class="keyword" id="5935329">return</span>&nbsp;<span class="ident" id="5935336"><a href="/encoding/gob/type.go.html#5935292">g</a></span><span class="op" id="5935337">.</span><span class="ident" id="5935338">Name</span>&nbsp;<span class="op" id="5935343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5935346">//&nbsp;Map&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="5935358">type</span>&nbsp;<span class="ident" id="5935363">mapType</span>&nbsp;<span class="keyword" id="5935371">struct</span>&nbsp;<span class="op" id="5935378">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935381"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935393">Key</span>&nbsp;&nbsp;<span class="ident" id="5935398"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935406">Elem</span>&nbsp;<span class="ident" id="5935411"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><br>
<span class="lineno"></span><span class="op" id="5935418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5935421">func</span>&nbsp;<span class="ident" id="5935426">newMapType</span><span class="op" id="5935436">(</span><span class="ident" id="5935437">name</span>&nbsp;<span class="builtintype" id="5935442">string</span><span class="op" id="5935448">)</span>&nbsp;<span class="op" id="5935450">*</span><span class="ident" id="5935451"><a href="/encoding/gob/type.go.html#5935363">mapType</a></span>&nbsp;<span class="op" id="5935459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935462">m</span>&nbsp;<span class="op" id="5935464">:=</span>&nbsp;<span class="op" id="5935467">&amp;</span><span class="ident" id="5935468"><a href="/encoding/gob/type.go.html#5935363">mapType</a></span><span class="op" id="5935475">{</span><span class="ident" id="5935476"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5935486">{</span><span class="ident" id="5935487">Name</span><span class="op" id="5935491">:</span>&nbsp;<span class="ident" id="5935493"><a href="/encoding/gob/type.go.html#5935437">name</a></span><span class="op" id="5935497">}</span><span class="op" id="5935498">,</span>&nbsp;<span class="num" id="5935500">0</span><span class="op" id="5935501">,</span>&nbsp;<span class="num" id="5935503">0</span><span class="op" id="5935504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935507">return</span>&nbsp;<span class="ident" id="5935514"><a href="/encoding/gob/type.go.html#5935462">m</a></span><br>
<span class="lineno"></span><span class="op" id="5935516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5935519">func</span>&nbsp;<span class="op" id="5935524">(</span><span class="ident" id="5935525">m</span>&nbsp;<span class="op" id="5935527">*</span><span class="ident" id="5935528"><a href="/encoding/gob/type.go.html#5935363">mapType</a></span><span class="op" id="5935535">)</span>&nbsp;<span class="ident" id="5935537">init</span><span class="op" id="5935541">(</span><span class="ident" id="5935542">key</span><span class="op" id="5935545">,</span>&nbsp;<span class="ident" id="5935547">elem</span>&nbsp;<span class="ident" id="5935552"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5935559">)</span>&nbsp;<span class="op" id="5935561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5935564">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935639"><a href="/encoding/gob/type.go.html#5930770">setTypeId</a></span><span class="op" id="5935648">(</span><span class="ident" id="5935649"><a href="/encoding/gob/type.go.html#5935525">m</a></span><span class="op" id="5935650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935653"><a href="/encoding/gob/type.go.html#5935525">m</a></span><span class="op" id="5935654">.</span><span class="ident" id="5935655">Key</span>&nbsp;<span class="op" id="5935659">=</span>&nbsp;<span class="ident" id="5935661"><a href="/encoding/gob/type.go.html#5935542">key</a></span><span class="op" id="5935664">.</span><span class="ident" id="5935665">id</span><span class="op" id="5935667">(</span><span class="op" id="5935668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935671"><a href="/encoding/gob/type.go.html#5935525">m</a></span><span class="op" id="5935672">.</span><span class="ident" id="5935673">Elem</span>&nbsp;<span class="op" id="5935678">=</span>&nbsp;<span class="ident" id="5935680"><a href="/encoding/gob/type.go.html#5935547">elem</a></span><span class="op" id="5935684">.</span><span class="ident" id="5935685">id</span><span class="op" id="5935687">(</span><span class="op" id="5935688">)</span><br>
<span class="lineno">360</span><span class="op" id="5935690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5935693">func</span>&nbsp;<span class="op" id="5935698">(</span><span class="ident" id="5935699">m</span>&nbsp;<span class="op" id="5935701">*</span><span class="ident" id="5935702"><a href="/encoding/gob/type.go.html#5935363">mapType</a></span><span class="op" id="5935709">)</span>&nbsp;<span class="ident" id="5935711">safeString</span><span class="op" id="5935721">(</span><span class="ident" id="5935722">seen</span>&nbsp;<span class="keyword" id="5935727">map</span><span class="op" id="5935730">[</span><span class="ident" id="5935731"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5935737">]</span><span class="builtintype" id="5935738">bool</span><span class="op" id="5935742">)</span>&nbsp;<span class="builtintype" id="5935744">string</span>&nbsp;<span class="op" id="5935751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935754">if</span>&nbsp;<span class="ident" id="5935757"><a href="/encoding/gob/type.go.html#5935722">seen</a></span><span class="op" id="5935761">[</span><span class="ident" id="5935762"><a href="/encoding/gob/type.go.html#5935699">m</a></span><span class="op" id="5935763">.</span><span class="ident" id="5935764">Id</span><span class="op" id="5935766">]</span>&nbsp;<span class="op" id="5935768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935772">return</span>&nbsp;<span class="ident" id="5935779"><a href="/encoding/gob/type.go.html#5935699">m</a></span><span class="op" id="5935780">.</span><span class="ident" id="5935781">Name</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5935787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935790"><a href="/encoding/gob/type.go.html#5935722">seen</a></span><span class="op" id="5935794">[</span><span class="ident" id="5935795"><a href="/encoding/gob/type.go.html#5935699">m</a></span><span class="op" id="5935796">.</span><span class="ident" id="5935797">Id</span><span class="op" id="5935799">]</span>&nbsp;<span class="op" id="5935801">=</span>&nbsp;<span class="builtintype" id="5935803">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935809">key</span>&nbsp;<span class="op" id="5935813">:=</span>&nbsp;<span class="ident" id="5935816"><a href="/encoding/gob/type.go.html#5935699">m</a></span><span class="op" id="5935817">.</span><span class="ident" id="5935818">Key</span><span class="op" id="5935821">.</span><span class="ident" id="5935822">gobType</span><span class="op" id="5935829">(</span><span class="op" id="5935830">)</span><span class="op" id="5935831">.</span><span class="ident" id="5935832">safeString</span><span class="op" id="5935842">(</span><span class="ident" id="5935843"><a href="/encoding/gob/type.go.html#5935722">seen</a></span><span class="op" id="5935847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935850">elem</span>&nbsp;<span class="op" id="5935855">:=</span>&nbsp;<span class="ident" id="5935858"><a href="/encoding/gob/type.go.html#5935699">m</a></span><span class="op" id="5935859">.</span><span class="ident" id="5935860">Elem</span><span class="op" id="5935864">.</span><span class="ident" id="5935865">gobType</span><span class="op" id="5935872">(</span><span class="op" id="5935873">)</span><span class="op" id="5935874">.</span><span class="ident" id="5935875">safeString</span><span class="op" id="5935885">(</span><span class="ident" id="5935886"><a href="/encoding/gob/type.go.html#5935722">seen</a></span><span class="op" id="5935890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935893">return</span>&nbsp;<span class="ident" id="5935900"><a href="/encoding/gob/type.go.html#5924782">fmt</a></span><span class="op" id="5935903">.</span><span class="ident" id="5935904">Sprintf</span><span class="op" id="5935911">(</span><span class="string" id="5935912">&#34;map[%s]%s&#34;</span><span class="op" id="5935923">,</span>&nbsp;<span class="ident" id="5935925"><a href="/encoding/gob/type.go.html#5935809">key</a></span><span class="op" id="5935928">,</span>&nbsp;<span class="ident" id="5935930"><a href="/encoding/gob/type.go.html#5935850">elem</a></span><span class="op" id="5935934">)</span><br>
<span class="lineno">370</span><span class="op" id="5935936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5935939">func</span>&nbsp;<span class="op" id="5935944">(</span><span class="ident" id="5935945">m</span>&nbsp;<span class="op" id="5935947">*</span><span class="ident" id="5935948"><a href="/encoding/gob/type.go.html#5935363">mapType</a></span><span class="op" id="5935955">)</span>&nbsp;<span class="builtintype" id="5935957">string</span><span class="op" id="5935963">(</span><span class="op" id="5935964">)</span>&nbsp;<span class="builtintype" id="5935966">string</span>&nbsp;<span class="op" id="5935973">{</span>&nbsp;<span class="keyword" id="5935975">return</span>&nbsp;<span class="ident" id="5935982"><a href="/encoding/gob/type.go.html#5935945">m</a></span><span class="op" id="5935983">.</span><span class="ident" id="5935984">safeString</span><span class="op" id="5935994">(</span><span class="builtinfunc" id="5935995">make</span><span class="op" id="5935999">(</span><span class="keyword" id="5936000">map</span><span class="op" id="5936003">[</span><span class="ident" id="5936004"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5936010">]</span><span class="builtintype" id="5936011">bool</span><span class="op" id="5936015">)</span><span class="op" id="5936016">)</span>&nbsp;<span class="op" id="5936018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5936021">//&nbsp;Slice&nbsp;type</span><br>
<span class="lineno">375</span><span class="keyword" id="5936035">type</span>&nbsp;<span class="ident" id="5936040">sliceType</span>&nbsp;<span class="keyword" id="5936050">struct</span>&nbsp;<span class="op" id="5936057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936060"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936072">Elem</span>&nbsp;<span class="ident" id="5936077"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><br>
<span class="lineno"></span><span class="op" id="5936084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="5936087">func</span>&nbsp;<span class="ident" id="5936092">newSliceType</span><span class="op" id="5936104">(</span><span class="ident" id="5936105">name</span>&nbsp;<span class="builtintype" id="5936110">string</span><span class="op" id="5936116">)</span>&nbsp;<span class="op" id="5936118">*</span><span class="ident" id="5936119"><a href="/encoding/gob/type.go.html#5936040">sliceType</a></span>&nbsp;<span class="op" id="5936129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936132">s</span>&nbsp;<span class="op" id="5936134">:=</span>&nbsp;<span class="op" id="5936137">&amp;</span><span class="ident" id="5936138"><a href="/encoding/gob/type.go.html#5936040">sliceType</a></span><span class="op" id="5936147">{</span><span class="ident" id="5936148"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5936158">{</span><span class="ident" id="5936159">Name</span><span class="op" id="5936163">:</span>&nbsp;<span class="ident" id="5936165"><a href="/encoding/gob/type.go.html#5936105">name</a></span><span class="op" id="5936169">}</span><span class="op" id="5936170">,</span>&nbsp;<span class="num" id="5936172">0</span><span class="op" id="5936173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936176">return</span>&nbsp;<span class="ident" id="5936183"><a href="/encoding/gob/type.go.html#5936132">s</a></span><br>
<span class="lineno"></span><span class="op" id="5936185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5936188">func</span>&nbsp;<span class="op" id="5936193">(</span><span class="ident" id="5936194">s</span>&nbsp;<span class="op" id="5936196">*</span><span class="ident" id="5936197"><a href="/encoding/gob/type.go.html#5936040">sliceType</a></span><span class="op" id="5936206">)</span>&nbsp;<span class="ident" id="5936208">init</span><span class="op" id="5936212">(</span><span class="ident" id="5936213">elem</span>&nbsp;<span class="ident" id="5936218"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5936225">)</span>&nbsp;<span class="op" id="5936227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5936230">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936305"><a href="/encoding/gob/type.go.html#5930770">setTypeId</a></span><span class="op" id="5936314">(</span><span class="ident" id="5936315"><a href="/encoding/gob/type.go.html#5936194">s</a></span><span class="op" id="5936316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5936319">//&nbsp;See&nbsp;the&nbsp;comments&nbsp;about&nbsp;ids&nbsp;in&nbsp;newTypeObject.&nbsp;Only&nbsp;slices&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5936384">//&nbsp;structs&nbsp;have&nbsp;mutual&nbsp;recursion.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936419">if</span>&nbsp;<span class="ident" id="5936422"><a href="/encoding/gob/type.go.html#5936213">elem</a></span><span class="op" id="5936426">.</span><span class="ident" id="5936427">id</span><span class="op" id="5936429">(</span><span class="op" id="5936430">)</span>&nbsp;<span class="op" id="5936432">==</span>&nbsp;<span class="num" id="5936435">0</span>&nbsp;<span class="op" id="5936437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936441"><a href="/encoding/gob/type.go.html#5930770">setTypeId</a></span><span class="op" id="5936450">(</span><span class="ident" id="5936451"><a href="/encoding/gob/type.go.html#5936213">elem</a></span><span class="op" id="5936455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936461"><a href="/encoding/gob/type.go.html#5936194">s</a></span><span class="op" id="5936462">.</span><span class="ident" id="5936463">Elem</span>&nbsp;<span class="op" id="5936468">=</span>&nbsp;<span class="ident" id="5936470"><a href="/encoding/gob/type.go.html#5936213">elem</a></span><span class="op" id="5936474">.</span><span class="ident" id="5936475">id</span><span class="op" id="5936477">(</span><span class="op" id="5936478">)</span><br>
<span class="lineno"></span><span class="op" id="5936480">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="5936483">func</span>&nbsp;<span class="op" id="5936488">(</span><span class="ident" id="5936489">s</span>&nbsp;<span class="op" id="5936491">*</span><span class="ident" id="5936492"><a href="/encoding/gob/type.go.html#5936040">sliceType</a></span><span class="op" id="5936501">)</span>&nbsp;<span class="ident" id="5936503">safeString</span><span class="op" id="5936513">(</span><span class="ident" id="5936514">seen</span>&nbsp;<span class="keyword" id="5936519">map</span><span class="op" id="5936522">[</span><span class="ident" id="5936523"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5936529">]</span><span class="builtintype" id="5936530">bool</span><span class="op" id="5936534">)</span>&nbsp;<span class="builtintype" id="5936536">string</span>&nbsp;<span class="op" id="5936543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936546">if</span>&nbsp;<span class="ident" id="5936549"><a href="/encoding/gob/type.go.html#5936514">seen</a></span><span class="op" id="5936553">[</span><span class="ident" id="5936554"><a href="/encoding/gob/type.go.html#5936489">s</a></span><span class="op" id="5936555">.</span><span class="ident" id="5936556">Id</span><span class="op" id="5936558">]</span>&nbsp;<span class="op" id="5936560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936564">return</span>&nbsp;<span class="ident" id="5936571"><a href="/encoding/gob/type.go.html#5936489">s</a></span><span class="op" id="5936572">.</span><span class="ident" id="5936573">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936579">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936582"><a href="/encoding/gob/type.go.html#5936514">seen</a></span><span class="op" id="5936586">[</span><span class="ident" id="5936587"><a href="/encoding/gob/type.go.html#5936489">s</a></span><span class="op" id="5936588">.</span><span class="ident" id="5936589">Id</span><span class="op" id="5936591">]</span>&nbsp;<span class="op" id="5936593">=</span>&nbsp;<span class="builtintype" id="5936595">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936601">return</span>&nbsp;<span class="ident" id="5936608"><a href="/encoding/gob/type.go.html#5924782">fmt</a></span><span class="op" id="5936611">.</span><span class="ident" id="5936612">Sprintf</span><span class="op" id="5936619">(</span><span class="string" id="5936620">&#34;[]%s&#34;</span><span class="op" id="5936626">,</span>&nbsp;<span class="ident" id="5936628"><a href="/encoding/gob/type.go.html#5936489">s</a></span><span class="op" id="5936629">.</span><span class="ident" id="5936630">Elem</span><span class="op" id="5936634">.</span><span class="ident" id="5936635">gobType</span><span class="op" id="5936642">(</span><span class="op" id="5936643">)</span><span class="op" id="5936644">.</span><span class="ident" id="5936645">safeString</span><span class="op" id="5936655">(</span><span class="ident" id="5936656"><a href="/encoding/gob/type.go.html#5936514">seen</a></span><span class="op" id="5936660">)</span><span class="op" id="5936661">)</span><br>
<span class="lineno"></span><span class="op" id="5936663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5936666">func</span>&nbsp;<span class="op" id="5936671">(</span><span class="ident" id="5936672">s</span>&nbsp;<span class="op" id="5936674">*</span><span class="ident" id="5936675"><a href="/encoding/gob/type.go.html#5936040">sliceType</a></span><span class="op" id="5936684">)</span>&nbsp;<span class="builtintype" id="5936686">string</span><span class="op" id="5936692">(</span><span class="op" id="5936693">)</span>&nbsp;<span class="builtintype" id="5936695">string</span>&nbsp;<span class="op" id="5936702">{</span>&nbsp;<span class="keyword" id="5936704">return</span>&nbsp;<span class="ident" id="5936711"><a href="/encoding/gob/type.go.html#5936672">s</a></span><span class="op" id="5936712">.</span><span class="ident" id="5936713">safeString</span><span class="op" id="5936723">(</span><span class="builtinfunc" id="5936724">make</span><span class="op" id="5936728">(</span><span class="keyword" id="5936729">map</span><span class="op" id="5936732">[</span><span class="ident" id="5936733"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5936739">]</span><span class="builtintype" id="5936740">bool</span><span class="op" id="5936744">)</span><span class="op" id="5936745">)</span>&nbsp;<span class="op" id="5936747">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="5936750">//&nbsp;Struct&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="5936765">type</span>&nbsp;<span class="ident" id="5936770">fieldType</span>&nbsp;<span class="keyword" id="5936780">struct</span>&nbsp;<span class="op" id="5936787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936790">Name</span>&nbsp;<span class="builtintype" id="5936795">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936803">Id</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5936808"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><br>
<span class="lineno">410</span><span class="op" id="5936815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5936818">type</span>&nbsp;<span class="ident" id="5936823">structType</span>&nbsp;<span class="keyword" id="5936834">struct</span>&nbsp;<span class="op" id="5936841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936844"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936856">Field</span>&nbsp;<span class="op" id="5936862">[</span><span class="op" id="5936863">]</span><span class="op" id="5936864">*</span><span class="ident" id="5936865"><a href="/encoding/gob/type.go.html#5936770">fieldType</a></span><br>
<span class="lineno">415</span><span class="op" id="5936875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5936878">func</span>&nbsp;<span class="op" id="5936883">(</span><span class="ident" id="5936884">s</span>&nbsp;<span class="op" id="5936886">*</span><span class="ident" id="5936887"><a href="/encoding/gob/type.go.html#5936823">structType</a></span><span class="op" id="5936897">)</span>&nbsp;<span class="ident" id="5936899">safeString</span><span class="op" id="5936909">(</span><span class="ident" id="5936910">seen</span>&nbsp;<span class="keyword" id="5936915">map</span><span class="op" id="5936918">[</span><span class="ident" id="5936919"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5936925">]</span><span class="builtintype" id="5936926">bool</span><span class="op" id="5936930">)</span>&nbsp;<span class="builtintype" id="5936932">string</span>&nbsp;<span class="op" id="5936939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936942">if</span>&nbsp;<span class="ident" id="5936945"><a href="/encoding/gob/type.go.html#5936884">s</a></span>&nbsp;<span class="op" id="5936947">==</span>&nbsp;<span class="ident" id="5936950">nil</span>&nbsp;<span class="op" id="5936954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936958">return</span>&nbsp;<span class="string" id="5936965">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936977">if</span>&nbsp;<span class="ident" id="5936980">_</span><span class="op" id="5936981">,</span>&nbsp;<span class="ident" id="5936983">ok</span>&nbsp;<span class="op" id="5936986">:=</span>&nbsp;<span class="ident" id="5936989"><a href="/encoding/gob/type.go.html#5936910">seen</a></span><span class="op" id="5936993">[</span><span class="ident" id="5936994"><a href="/encoding/gob/type.go.html#5936884">s</a></span><span class="op" id="5936995">.</span><span class="ident" id="5936996">Id</span><span class="op" id="5936998">]</span><span class="op" id="5936999">;</span>&nbsp;<span class="ident" id="5937001"><a href="/encoding/gob/type.go.html#5936983">ok</a></span>&nbsp;<span class="op" id="5937004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937008">return</span>&nbsp;<span class="ident" id="5937015"><a href="/encoding/gob/type.go.html#5936884">s</a></span><span class="op" id="5937016">.</span><span class="ident" id="5937017">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5937023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937026"><a href="/encoding/gob/type.go.html#5936910">seen</a></span><span class="op" id="5937030">[</span><span class="ident" id="5937031"><a href="/encoding/gob/type.go.html#5936884">s</a></span><span class="op" id="5937032">.</span><span class="ident" id="5937033">Id</span><span class="op" id="5937035">]</span>&nbsp;<span class="op" id="5937037">=</span>&nbsp;<span class="builtintype" id="5937039">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937045">str</span>&nbsp;<span class="op" id="5937049">:=</span>&nbsp;<span class="ident" id="5937052"><a href="/encoding/gob/type.go.html#5936884">s</a></span><span class="op" id="5937053">.</span><span class="ident" id="5937054">Name</span>&nbsp;<span class="op" id="5937059">+</span>&nbsp;<span class="string" id="5937061">&#34;&nbsp;=&nbsp;struct&nbsp;{&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937077">for</span>&nbsp;<span class="ident" id="5937081">_</span><span class="op" id="5937082">,</span>&nbsp;<span class="ident" id="5937084">f</span>&nbsp;<span class="op" id="5937086">:=</span>&nbsp;<span class="keyword" id="5937089">range</span>&nbsp;<span class="ident" id="5937095"><a href="/encoding/gob/type.go.html#5936884">s</a></span><span class="op" id="5937096">.</span><span class="ident" id="5937097">Field</span>&nbsp;<span class="op" id="5937103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937107"><a href="/encoding/gob/type.go.html#5937045">str</a></span>&nbsp;<span class="op" id="5937111">+=</span>&nbsp;<span class="ident" id="5937114"><a href="/encoding/gob/type.go.html#5924782">fmt</a></span><span class="op" id="5937117">.</span><span class="ident" id="5937118">Sprintf</span><span class="op" id="5937125">(</span><span class="string" id="5937126">&#34;%s&nbsp;%s;&nbsp;&#34;</span><span class="op" id="5937135">,</span>&nbsp;<span class="ident" id="5937137"><a href="/encoding/gob/type.go.html#5937084">f</a></span><span class="op" id="5937138">.</span><span class="ident" id="5937139">Name</span><span class="op" id="5937143">,</span>&nbsp;<span class="ident" id="5937145"><a href="/encoding/gob/type.go.html#5937084">f</a></span><span class="op" id="5937146">.</span><span class="ident" id="5937147">Id</span><span class="op" id="5937149">.</span><span class="ident" id="5937150">gobType</span><span class="op" id="5937157">(</span><span class="op" id="5937158">)</span><span class="op" id="5937159">.</span><span class="ident" id="5937160">safeString</span><span class="op" id="5937170">(</span><span class="ident" id="5937171"><a href="/encoding/gob/type.go.html#5936910">seen</a></span><span class="op" id="5937175">)</span><span class="op" id="5937176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5937179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937182"><a href="/encoding/gob/type.go.html#5937045">str</a></span>&nbsp;<span class="op" id="5937186">+=</span>&nbsp;<span class="string" id="5937189">&#34;}&#34;</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937194">return</span>&nbsp;<span class="ident" id="5937201"><a href="/encoding/gob/type.go.html#5937045">str</a></span><br>
<span class="lineno"></span><span class="op" id="5937205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5937208">func</span>&nbsp;<span class="op" id="5937213">(</span><span class="ident" id="5937214">s</span>&nbsp;<span class="op" id="5937216">*</span><span class="ident" id="5937217"><a href="/encoding/gob/type.go.html#5936823">structType</a></span><span class="op" id="5937227">)</span>&nbsp;<span class="builtintype" id="5937229">string</span><span class="op" id="5937235">(</span><span class="op" id="5937236">)</span>&nbsp;<span class="builtintype" id="5937238">string</span>&nbsp;<span class="op" id="5937245">{</span>&nbsp;<span class="keyword" id="5937247">return</span>&nbsp;<span class="ident" id="5937254"><a href="/encoding/gob/type.go.html#5937214">s</a></span><span class="op" id="5937255">.</span><span class="ident" id="5937256">safeString</span><span class="op" id="5937266">(</span><span class="builtinfunc" id="5937267">make</span><span class="op" id="5937271">(</span><span class="keyword" id="5937272">map</span><span class="op" id="5937275">[</span><span class="ident" id="5937276"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5937282">]</span><span class="builtintype" id="5937283">bool</span><span class="op" id="5937287">)</span><span class="op" id="5937288">)</span>&nbsp;<span class="op" id="5937290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="5937293">func</span>&nbsp;<span class="ident" id="5937298">newStructType</span><span class="op" id="5937311">(</span><span class="ident" id="5937312">name</span>&nbsp;<span class="builtintype" id="5937317">string</span><span class="op" id="5937323">)</span>&nbsp;<span class="op" id="5937325">*</span><span class="ident" id="5937326"><a href="/encoding/gob/type.go.html#5936823">structType</a></span>&nbsp;<span class="op" id="5937337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937340">s</span>&nbsp;<span class="op" id="5937342">:=</span>&nbsp;<span class="op" id="5937345">&amp;</span><span class="ident" id="5937346"><a href="/encoding/gob/type.go.html#5936823">structType</a></span><span class="op" id="5937356">{</span><span class="ident" id="5937357"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5937367">{</span><span class="ident" id="5937368">Name</span><span class="op" id="5937372">:</span>&nbsp;<span class="ident" id="5937374"><a href="/encoding/gob/type.go.html#5937312">name</a></span><span class="op" id="5937378">}</span><span class="op" id="5937379">,</span>&nbsp;<span class="ident" id="5937381">nil</span><span class="op" id="5937384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5937387">//&nbsp;For&nbsp;historical&nbsp;reasons&nbsp;we&nbsp;set&nbsp;the&nbsp;id&nbsp;here&nbsp;rather&nbsp;than&nbsp;init.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5937451">//&nbsp;See&nbsp;the&nbsp;comment&nbsp;in&nbsp;newTypeObject&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937501"><a href="/encoding/gob/type.go.html#5930770">setTypeId</a></span><span class="op" id="5937510">(</span><span class="ident" id="5937511"><a href="/encoding/gob/type.go.html#5937340">s</a></span><span class="op" id="5937512">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937515">return</span>&nbsp;<span class="ident" id="5937522"><a href="/encoding/gob/type.go.html#5937340">s</a></span><br>
<span class="lineno"></span><span class="op" id="5937524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5937527">//&nbsp;newTypeObject&nbsp;allocates&nbsp;a&nbsp;gobType&nbsp;for&nbsp;the&nbsp;reflection&nbsp;type&nbsp;rt.</span><br>
<span class="lineno"></span><span class="comment" id="5937592">//&nbsp;Unless&nbsp;ut&nbsp;represents&nbsp;a&nbsp;GobEncoder,&nbsp;rt&nbsp;should&nbsp;be&nbsp;the&nbsp;base&nbsp;type</span><br>
<span class="lineno">445</span><span class="comment" id="5937657">//&nbsp;of&nbsp;ut.</span><br>
<span class="lineno"></span><span class="comment" id="5937667">//&nbsp;This&nbsp;is&nbsp;only&nbsp;called&nbsp;from&nbsp;the&nbsp;encoding&nbsp;side.&nbsp;The&nbsp;decoding&nbsp;side</span><br>
<span class="lineno"></span><span class="comment" id="5937732">//&nbsp;works&nbsp;through&nbsp;typeIds&nbsp;and&nbsp;userTypeInfos&nbsp;alone.</span><br>
<span class="lineno"></span><span class="keyword" id="5937782">func</span>&nbsp;<span class="ident" id="5937787">newTypeObject</span><span class="op" id="5937800">(</span><span class="ident" id="5937801">name</span>&nbsp;<span class="builtintype" id="5937806">string</span><span class="op" id="5937812">,</span>&nbsp;<span class="ident" id="5937814">ut</span>&nbsp;<span class="op" id="5937817">*</span><span class="ident" id="5937818"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span><span class="op" id="5937830">,</span>&nbsp;<span class="ident" id="5937832">rt</span>&nbsp;<span class="ident" id="5937835"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5937842">.</span><span class="ident" id="5937843">Type</span><span class="op" id="5937847">)</span>&nbsp;<span class="op" id="5937849">(</span><span class="ident" id="5937850"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5937857">,</span>&nbsp;<span class="builtintype" id="5937859">error</span><span class="op" id="5937864">)</span>&nbsp;<span class="op" id="5937866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5937869">//&nbsp;Does&nbsp;this&nbsp;type&nbsp;implement&nbsp;GobEncoder?</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937910">if</span>&nbsp;<span class="ident" id="5937913"><a href="/encoding/gob/type.go.html#5937814">ut</a></span><span class="op" id="5937915">.</span><span class="ident" id="5937916">externalEnc</span>&nbsp;<span class="op" id="5937928">!=</span>&nbsp;<span class="num" id="5937931">0</span>&nbsp;<span class="op" id="5937933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937937">return</span>&nbsp;<span class="ident" id="5937944"><a href="/encoding/gob/type.go.html#5935079">newGobEncoderType</a></span><span class="op" id="5937961">(</span><span class="ident" id="5937962"><a href="/encoding/gob/type.go.html#5937801">name</a></span><span class="op" id="5937966">)</span><span class="op" id="5937967">,</span>&nbsp;<span class="ident" id="5937969">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5937974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937977">var</span>&nbsp;<span class="ident" id="5937981">err</span>&nbsp;<span class="builtintype" id="5937985">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937992">var</span>&nbsp;<span class="ident" id="5937996">type0</span><span class="op" id="5938001">,</span>&nbsp;<span class="ident" id="5938003">type1</span>&nbsp;<span class="ident" id="5938009"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938018">defer</span>&nbsp;<span class="keyword" id="5938024">func</span><span class="op" id="5938028">(</span><span class="op" id="5938029">)</span>&nbsp;<span class="op" id="5938031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938035">if</span>&nbsp;<span class="ident" id="5938038"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5938042">!=</span>&nbsp;<span class="ident" id="5938045">nil</span>&nbsp;<span class="op" id="5938049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5938054">delete</span><span class="op" id="5938060">(</span><span class="ident" id="5938061"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5938066">,</span>&nbsp;<span class="ident" id="5938068"><a href="/encoding/gob/type.go.html#5937832">rt</a></span><span class="op" id="5938070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5938074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5938077">}</span><span class="op" id="5938078">(</span><span class="op" id="5938079">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5938082">//&nbsp;Install&nbsp;the&nbsp;top-level&nbsp;type&nbsp;before&nbsp;the&nbsp;subtypes&nbsp;(e.g.&nbsp;struct&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5938153">//&nbsp;fields)&nbsp;so&nbsp;recursive&nbsp;types&nbsp;can&nbsp;be&nbsp;constructed&nbsp;safely.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938211">switch</span>&nbsp;<span class="ident" id="5938218">t</span>&nbsp;<span class="op" id="5938220">:=</span>&nbsp;<span class="ident" id="5938223"><a href="/encoding/gob/type.go.html#5937832">rt</a></span><span class="op" id="5938225">;</span>&nbsp;<span class="ident" id="5938227"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5938228">.</span><span class="ident" id="5938229">Kind</span><span class="op" id="5938233">(</span><span class="op" id="5938234">)</span>&nbsp;<span class="op" id="5938236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5938239">//&nbsp;All&nbsp;basic&nbsp;types&nbsp;are&nbsp;easy:&nbsp;they&nbsp;are&nbsp;predefined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938290">case</span>&nbsp;<span class="ident" id="5938295"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938302">.</span><span class="ident" id="5938303">Bool</span><span class="op" id="5938307">:</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938311">return</span>&nbsp;<span class="ident" id="5938318"><a href="/encoding/gob/type.go.html#5932271">tBool</a></span><span class="op" id="5938323">.</span><span class="ident" id="5938324">gobType</span><span class="op" id="5938331">(</span><span class="op" id="5938332">)</span><span class="op" id="5938333">,</span>&nbsp;<span class="ident" id="5938335">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938341">case</span>&nbsp;<span class="ident" id="5938346"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938353">.</span><span class="ident" id="5938354">Int</span><span class="op" id="5938357">,</span>&nbsp;<span class="ident" id="5938359"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938366">.</span><span class="ident" id="5938367">Int8</span><span class="op" id="5938371">,</span>&nbsp;<span class="ident" id="5938373"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938380">.</span><span class="ident" id="5938381">Int16</span><span class="op" id="5938386">,</span>&nbsp;<span class="ident" id="5938388"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938395">.</span><span class="ident" id="5938396">Int32</span><span class="op" id="5938401">,</span>&nbsp;<span class="ident" id="5938403"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938410">.</span><span class="ident" id="5938411">Int64</span><span class="op" id="5938416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938420">return</span>&nbsp;<span class="ident" id="5938427"><a href="/encoding/gob/type.go.html#5932324">tInt</a></span><span class="op" id="5938431">.</span><span class="ident" id="5938432">gobType</span><span class="op" id="5938439">(</span><span class="op" id="5938440">)</span><span class="op" id="5938441">,</span>&nbsp;<span class="ident" id="5938443">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938449">case</span>&nbsp;<span class="ident" id="5938454"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938461">.</span><span class="ident" id="5938462">Uint</span><span class="op" id="5938466">,</span>&nbsp;<span class="ident" id="5938468"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938475">.</span><span class="ident" id="5938476">Uint8</span><span class="op" id="5938481">,</span>&nbsp;<span class="ident" id="5938483"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938490">.</span><span class="ident" id="5938491">Uint16</span><span class="op" id="5938497">,</span>&nbsp;<span class="ident" id="5938499"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938506">.</span><span class="ident" id="5938507">Uint32</span><span class="op" id="5938513">,</span>&nbsp;<span class="ident" id="5938515"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938522">.</span><span class="ident" id="5938523">Uint64</span><span class="op" id="5938529">,</span>&nbsp;<span class="ident" id="5938531"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938538">.</span><span class="ident" id="5938539">Uintptr</span><span class="op" id="5938546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938550">return</span>&nbsp;<span class="ident" id="5938557"><a href="/encoding/gob/type.go.html#5932375">tUint</a></span><span class="op" id="5938562">.</span><span class="ident" id="5938563">gobType</span><span class="op" id="5938570">(</span><span class="op" id="5938571">)</span><span class="op" id="5938572">,</span>&nbsp;<span class="ident" id="5938574">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938580">case</span>&nbsp;<span class="ident" id="5938585"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938592">.</span><span class="ident" id="5938593">Float32</span><span class="op" id="5938600">,</span>&nbsp;<span class="ident" id="5938602"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938609">.</span><span class="ident" id="5938610">Float64</span><span class="op" id="5938617">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938621">return</span>&nbsp;<span class="ident" id="5938628"><a href="/encoding/gob/type.go.html#5932428">tFloat</a></span><span class="op" id="5938634">.</span><span class="ident" id="5938635">gobType</span><span class="op" id="5938642">(</span><span class="op" id="5938643">)</span><span class="op" id="5938644">,</span>&nbsp;<span class="ident" id="5938646">nil</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938652">case</span>&nbsp;<span class="ident" id="5938657"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938664">.</span><span class="ident" id="5938665">Complex64</span><span class="op" id="5938674">,</span>&nbsp;<span class="ident" id="5938676"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938683">.</span><span class="ident" id="5938684">Complex128</span><span class="op" id="5938694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938698">return</span>&nbsp;<span class="ident" id="5938705"><a href="/encoding/gob/type.go.html#5932598">tComplex</a></span><span class="op" id="5938713">.</span><span class="ident" id="5938714">gobType</span><span class="op" id="5938721">(</span><span class="op" id="5938722">)</span><span class="op" id="5938723">,</span>&nbsp;<span class="ident" id="5938725">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938731">case</span>&nbsp;<span class="ident" id="5938736"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938743">.</span><span class="ident" id="5938744">String</span><span class="op" id="5938750">:</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938754">return</span>&nbsp;<span class="ident" id="5938761"><a href="/encoding/gob/type.go.html#5932541">tString</a></span><span class="op" id="5938768">.</span><span class="ident" id="5938769">gobType</span><span class="op" id="5938776">(</span><span class="op" id="5938777">)</span><span class="op" id="5938778">,</span>&nbsp;<span class="ident" id="5938780">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938786">case</span>&nbsp;<span class="ident" id="5938791"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938798">.</span><span class="ident" id="5938799">Interface</span><span class="op" id="5938808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938812">return</span>&nbsp;<span class="ident" id="5938819"><a href="/encoding/gob/type.go.html#5932660">tInterface</a></span><span class="op" id="5938829">.</span><span class="ident" id="5938830">gobType</span><span class="op" id="5938837">(</span><span class="op" id="5938838">)</span><span class="op" id="5938839">,</span>&nbsp;<span class="ident" id="5938841">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938847">case</span>&nbsp;<span class="ident" id="5938852"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5938859">.</span><span class="ident" id="5938860">Array</span><span class="op" id="5938865">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5938869">at</span>&nbsp;<span class="op" id="5938872">:=</span>&nbsp;<span class="ident" id="5938875"><a href="/encoding/gob/type.go.html#5934408">newArrayType</a></span><span class="op" id="5938887">(</span><span class="ident" id="5938888"><a href="/encoding/gob/type.go.html#5937801">name</a></span><span class="op" id="5938892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5938896"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5938901">[</span><span class="ident" id="5938902"><a href="/encoding/gob/type.go.html#5937832">rt</a></span><span class="op" id="5938904">]</span>&nbsp;<span class="op" id="5938906">=</span>&nbsp;<span class="ident" id="5938908"><a href="/encoding/gob/type.go.html#5938869">at</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5938913"><a href="/encoding/gob/type.go.html#5937996">type0</a></span><span class="op" id="5938918">,</span>&nbsp;<span class="ident" id="5938920"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5938924">=</span>&nbsp;<span class="ident" id="5938926"><a href="/encoding/gob/type.go.html#5941877">getBaseType</a></span><span class="op" id="5938937">(</span><span class="string" id="5938938">&#34;&#34;</span><span class="op" id="5938940">,</span>&nbsp;<span class="ident" id="5938942"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5938943">.</span><span class="ident" id="5938944">Elem</span><span class="op" id="5938948">(</span><span class="op" id="5938949">)</span><span class="op" id="5938950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938954">if</span>&nbsp;<span class="ident" id="5938957"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5938961">!=</span>&nbsp;<span class="ident" id="5938964">nil</span>&nbsp;<span class="op" id="5938968">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938973">return</span>&nbsp;<span class="ident" id="5938980">nil</span><span class="op" id="5938983">,</span>&nbsp;<span class="ident" id="5938985"><a href="/encoding/gob/type.go.html#5937981">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5938991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5938995">//&nbsp;Historical&nbsp;aside:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5939018">//&nbsp;For&nbsp;arrays,&nbsp;maps,&nbsp;and&nbsp;slices,&nbsp;we&nbsp;set&nbsp;the&nbsp;type&nbsp;id&nbsp;after&nbsp;the&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5939091">//&nbsp;are&nbsp;constructed.&nbsp;This&nbsp;is&nbsp;to&nbsp;retain&nbsp;the&nbsp;order&nbsp;of&nbsp;type&nbsp;id&nbsp;allocation&nbsp;after</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5939169">//&nbsp;a&nbsp;fix&nbsp;made&nbsp;to&nbsp;handle&nbsp;recursive&nbsp;types,&nbsp;which&nbsp;changed&nbsp;the&nbsp;order&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5939239">//&nbsp;which&nbsp;types&nbsp;are&nbsp;built.&nbsp;&nbsp;Delaying&nbsp;the&nbsp;setting&nbsp;in&nbsp;this&nbsp;way&nbsp;preserves</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5939311">//&nbsp;type&nbsp;ids&nbsp;while&nbsp;allowing&nbsp;recursive&nbsp;types&nbsp;to&nbsp;be&nbsp;described.&nbsp;Structs,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5939382">//&nbsp;done&nbsp;below,&nbsp;were&nbsp;already&nbsp;handling&nbsp;recursion&nbsp;correctly&nbsp;so&nbsp;they</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5939449">//&nbsp;assign&nbsp;the&nbsp;top-level&nbsp;id&nbsp;before&nbsp;those&nbsp;of&nbsp;the&nbsp;field.</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939505"><a href="/encoding/gob/type.go.html#5938869">at</a></span><span class="op" id="5939507">.</span><span class="ident" id="5939508">init</span><span class="op" id="5939512">(</span><span class="ident" id="5939513"><a href="/encoding/gob/type.go.html#5937996">type0</a></span><span class="op" id="5939518">,</span>&nbsp;<span class="ident" id="5939520"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5939521">.</span><span class="ident" id="5939522">Len</span><span class="op" id="5939525">(</span><span class="op" id="5939526">)</span><span class="op" id="5939527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939531">return</span>&nbsp;<span class="ident" id="5939538"><a href="/encoding/gob/type.go.html#5938869">at</a></span><span class="op" id="5939540">,</span>&nbsp;<span class="ident" id="5939542">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939548">case</span>&nbsp;<span class="ident" id="5939553"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5939560">.</span><span class="ident" id="5939561">Map</span><span class="op" id="5939564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939568">mt</span>&nbsp;<span class="op" id="5939571">:=</span>&nbsp;<span class="ident" id="5939574"><a href="/encoding/gob/type.go.html#5935426">newMapType</a></span><span class="op" id="5939584">(</span><span class="ident" id="5939585"><a href="/encoding/gob/type.go.html#5937801">name</a></span><span class="op" id="5939589">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939593"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5939598">[</span><span class="ident" id="5939599"><a href="/encoding/gob/type.go.html#5937832">rt</a></span><span class="op" id="5939601">]</span>&nbsp;<span class="op" id="5939603">=</span>&nbsp;<span class="ident" id="5939605"><a href="/encoding/gob/type.go.html#5939568">mt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939610"><a href="/encoding/gob/type.go.html#5937996">type0</a></span><span class="op" id="5939615">,</span>&nbsp;<span class="ident" id="5939617"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5939621">=</span>&nbsp;<span class="ident" id="5939623"><a href="/encoding/gob/type.go.html#5941877">getBaseType</a></span><span class="op" id="5939634">(</span><span class="string" id="5939635">&#34;&#34;</span><span class="op" id="5939637">,</span>&nbsp;<span class="ident" id="5939639"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5939640">.</span><span class="ident" id="5939641">Key</span><span class="op" id="5939644">(</span><span class="op" id="5939645">)</span><span class="op" id="5939646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939650">if</span>&nbsp;<span class="ident" id="5939653"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5939657">!=</span>&nbsp;<span class="ident" id="5939660">nil</span>&nbsp;<span class="op" id="5939664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939669">return</span>&nbsp;<span class="ident" id="5939676">nil</span><span class="op" id="5939679">,</span>&nbsp;<span class="ident" id="5939681"><a href="/encoding/gob/type.go.html#5937981">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5939687">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939691"><a href="/encoding/gob/type.go.html#5938003">type1</a></span><span class="op" id="5939696">,</span>&nbsp;<span class="ident" id="5939698"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5939702">=</span>&nbsp;<span class="ident" id="5939704"><a href="/encoding/gob/type.go.html#5941877">getBaseType</a></span><span class="op" id="5939715">(</span><span class="string" id="5939716">&#34;&#34;</span><span class="op" id="5939718">,</span>&nbsp;<span class="ident" id="5939720"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5939721">.</span><span class="ident" id="5939722">Elem</span><span class="op" id="5939726">(</span><span class="op" id="5939727">)</span><span class="op" id="5939728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939732">if</span>&nbsp;<span class="ident" id="5939735"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5939739">!=</span>&nbsp;<span class="ident" id="5939742">nil</span>&nbsp;<span class="op" id="5939746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939751">return</span>&nbsp;<span class="ident" id="5939758">nil</span><span class="op" id="5939761">,</span>&nbsp;<span class="ident" id="5939763"><a href="/encoding/gob/type.go.html#5937981">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5939769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939773"><a href="/encoding/gob/type.go.html#5939568">mt</a></span><span class="op" id="5939775">.</span><span class="ident" id="5939776">init</span><span class="op" id="5939780">(</span><span class="ident" id="5939781"><a href="/encoding/gob/type.go.html#5937996">type0</a></span><span class="op" id="5939786">,</span>&nbsp;<span class="ident" id="5939788"><a href="/encoding/gob/type.go.html#5938003">type1</a></span><span class="op" id="5939793">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939797">return</span>&nbsp;<span class="ident" id="5939804"><a href="/encoding/gob/type.go.html#5939568">mt</a></span><span class="op" id="5939806">,</span>&nbsp;<span class="ident" id="5939808">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939814">case</span>&nbsp;<span class="ident" id="5939819"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5939826">.</span><span class="ident" id="5939827">Slice</span><span class="op" id="5939832">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5939836">//&nbsp;[]byte&nbsp;==&nbsp;[]uint8&nbsp;is&nbsp;a&nbsp;special&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939877">if</span>&nbsp;<span class="ident" id="5939880"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5939881">.</span><span class="ident" id="5939882">Elem</span><span class="op" id="5939886">(</span><span class="op" id="5939887">)</span><span class="op" id="5939888">.</span><span class="ident" id="5939889">Kind</span><span class="op" id="5939893">(</span><span class="op" id="5939894">)</span>&nbsp;<span class="op" id="5939896">==</span>&nbsp;<span class="ident" id="5939899"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5939906">.</span><span class="ident" id="5939907">Uint8</span>&nbsp;<span class="op" id="5939913">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939918">return</span>&nbsp;<span class="ident" id="5939925"><a href="/encoding/gob/type.go.html#5932485">tBytes</a></span><span class="op" id="5939931">.</span><span class="ident" id="5939932">gobType</span><span class="op" id="5939939">(</span><span class="op" id="5939940">)</span><span class="op" id="5939941">,</span>&nbsp;<span class="ident" id="5939943">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5939949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939953">st</span>&nbsp;<span class="op" id="5939956">:=</span>&nbsp;<span class="ident" id="5939959"><a href="/encoding/gob/type.go.html#5936092">newSliceType</a></span><span class="op" id="5939971">(</span><span class="ident" id="5939972"><a href="/encoding/gob/type.go.html#5937801">name</a></span><span class="op" id="5939976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939980"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5939985">[</span><span class="ident" id="5939986"><a href="/encoding/gob/type.go.html#5937832">rt</a></span><span class="op" id="5939988">]</span>&nbsp;<span class="op" id="5939990">=</span>&nbsp;<span class="ident" id="5939992"><a href="/encoding/gob/type.go.html#5939953">st</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939997"><a href="/encoding/gob/type.go.html#5937996">type0</a></span><span class="op" id="5940002">,</span>&nbsp;<span class="ident" id="5940004"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5940008">=</span>&nbsp;<span class="ident" id="5940010"><a href="/encoding/gob/type.go.html#5941877">getBaseType</a></span><span class="op" id="5940021">(</span><span class="ident" id="5940022"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5940023">.</span><span class="ident" id="5940024">Elem</span><span class="op" id="5940028">(</span><span class="op" id="5940029">)</span><span class="op" id="5940030">.</span><span class="ident" id="5940031">Name</span><span class="op" id="5940035">(</span><span class="op" id="5940036">)</span><span class="op" id="5940037">,</span>&nbsp;<span class="ident" id="5940039"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5940040">.</span><span class="ident" id="5940041">Elem</span><span class="op" id="5940045">(</span><span class="op" id="5940046">)</span><span class="op" id="5940047">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940051">if</span>&nbsp;<span class="ident" id="5940054"><a href="/encoding/gob/type.go.html#5937981">err</a></span>&nbsp;<span class="op" id="5940058">!=</span>&nbsp;<span class="ident" id="5940061">nil</span>&nbsp;<span class="op" id="5940065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940070">return</span>&nbsp;<span class="ident" id="5940077">nil</span><span class="op" id="5940080">,</span>&nbsp;<span class="ident" id="5940082"><a href="/encoding/gob/type.go.html#5937981">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940092"><a href="/encoding/gob/type.go.html#5939953">st</a></span><span class="op" id="5940094">.</span><span class="ident" id="5940095">init</span><span class="op" id="5940099">(</span><span class="ident" id="5940100"><a href="/encoding/gob/type.go.html#5937996">type0</a></span><span class="op" id="5940105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940109">return</span>&nbsp;<span class="ident" id="5940116"><a href="/encoding/gob/type.go.html#5939953">st</a></span><span class="op" id="5940118">,</span>&nbsp;<span class="ident" id="5940120">nil</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940126">case</span>&nbsp;<span class="ident" id="5940131"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5940138">.</span><span class="ident" id="5940139">Struct</span><span class="op" id="5940145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940149">st</span>&nbsp;<span class="op" id="5940152">:=</span>&nbsp;<span class="ident" id="5940155"><a href="/encoding/gob/type.go.html#5937298">newStructType</a></span><span class="op" id="5940168">(</span><span class="ident" id="5940169"><a href="/encoding/gob/type.go.html#5937801">name</a></span><span class="op" id="5940173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940177"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5940182">[</span><span class="ident" id="5940183"><a href="/encoding/gob/type.go.html#5937832">rt</a></span><span class="op" id="5940185">]</span>&nbsp;<span class="op" id="5940187">=</span>&nbsp;<span class="ident" id="5940189"><a href="/encoding/gob/type.go.html#5940149">st</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940194"><a href="/encoding/gob/type.go.html#5930641">idToType</a></span><span class="op" id="5940202">[</span><span class="ident" id="5940203"><a href="/encoding/gob/type.go.html#5940149">st</a></span><span class="op" id="5940205">.</span><span class="ident" id="5940206">id</span><span class="op" id="5940208">(</span><span class="op" id="5940209">)</span><span class="op" id="5940210">]</span>&nbsp;<span class="op" id="5940212">=</span>&nbsp;<span class="ident" id="5940214"><a href="/encoding/gob/type.go.html#5940149">st</a></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940219">for</span>&nbsp;<span class="ident" id="5940223">i</span>&nbsp;<span class="op" id="5940225">:=</span>&nbsp;<span class="num" id="5940228">0</span><span class="op" id="5940229">;</span>&nbsp;<span class="ident" id="5940231"><a href="/encoding/gob/type.go.html#5940223">i</a></span>&nbsp;<span class="op" id="5940233">&lt;</span>&nbsp;<span class="ident" id="5940235"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5940236">.</span><span class="ident" id="5940237">NumField</span><span class="op" id="5940245">(</span><span class="op" id="5940246">)</span><span class="op" id="5940247">;</span>&nbsp;<span class="ident" id="5940249"><a href="/encoding/gob/type.go.html#5940223">i</a></span><span class="op" id="5940250">++</span>&nbsp;<span class="op" id="5940253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940258">f</span>&nbsp;<span class="op" id="5940260">:=</span>&nbsp;<span class="ident" id="5940263"><a href="/encoding/gob/type.go.html#5938218">t</a></span><span class="op" id="5940264">.</span><span class="ident" id="5940265">Field</span><span class="op" id="5940270">(</span><span class="ident" id="5940271"><a href="/encoding/gob/type.go.html#5940223">i</a></span><span class="op" id="5940272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940277">if</span>&nbsp;<span class="op" id="5940280">!</span><span class="ident" id="5940281"><a href="/encoding/gob/type.go.html#5941384">isSent</a></span><span class="op" id="5940287">(</span><span class="op" id="5940288">&amp;</span><span class="ident" id="5940289"><a href="/encoding/gob/type.go.html#5940258">f</a></span><span class="op" id="5940290">)</span>&nbsp;<span class="op" id="5940292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940298">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940310">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940315">typ</span>&nbsp;<span class="op" id="5940319">:=</span>&nbsp;<span class="ident" id="5940322"><a href="/encoding/gob/type.go.html#5929943">userType</a></span><span class="op" id="5940330">(</span><span class="ident" id="5940331"><a href="/encoding/gob/type.go.html#5940258">f</a></span><span class="op" id="5940332">.</span><span class="ident" id="5940333">Type</span><span class="op" id="5940337">)</span><span class="op" id="5940338">.</span><span class="ident" id="5940339">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940347">tname</span>&nbsp;<span class="op" id="5940353">:=</span>&nbsp;<span class="ident" id="5940356"><a href="/encoding/gob/type.go.html#5940315">typ</a></span><span class="op" id="5940359">.</span><span class="ident" id="5940360">Name</span><span class="op" id="5940364">(</span><span class="op" id="5940365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940370">if</span>&nbsp;<span class="ident" id="5940373"><a href="/encoding/gob/type.go.html#5940347">tname</a></span>&nbsp;<span class="op" id="5940379">==</span>&nbsp;<span class="string" id="5940382">&#34;&#34;</span>&nbsp;<span class="op" id="5940385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940391">t</span>&nbsp;<span class="op" id="5940393">:=</span>&nbsp;<span class="ident" id="5940396"><a href="/encoding/gob/type.go.html#5929943">userType</a></span><span class="op" id="5940404">(</span><span class="ident" id="5940405"><a href="/encoding/gob/type.go.html#5940258">f</a></span><span class="op" id="5940406">.</span><span class="ident" id="5940407">Type</span><span class="op" id="5940411">)</span><span class="op" id="5940412">.</span><span class="ident" id="5940413">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940422"><a href="/encoding/gob/type.go.html#5940347">tname</a></span>&nbsp;<span class="op" id="5940428">=</span>&nbsp;<span class="ident" id="5940430"><a href="/encoding/gob/type.go.html#5940391">t</a></span><span class="op" id="5940431">.</span><span class="ident" id="5940432">String</span><span class="op" id="5940438">(</span><span class="op" id="5940439">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940449">gt</span><span class="op" id="5940451">,</span>&nbsp;<span class="ident" id="5940453">err</span>&nbsp;<span class="op" id="5940457">:=</span>&nbsp;<span class="ident" id="5940460"><a href="/encoding/gob/type.go.html#5941877">getBaseType</a></span><span class="op" id="5940471">(</span><span class="ident" id="5940472"><a href="/encoding/gob/type.go.html#5940347">tname</a></span><span class="op" id="5940477">,</span>&nbsp;<span class="ident" id="5940479"><a href="/encoding/gob/type.go.html#5940258">f</a></span><span class="op" id="5940480">.</span><span class="ident" id="5940481">Type</span><span class="op" id="5940485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940490">if</span>&nbsp;<span class="ident" id="5940493"><a href="/encoding/gob/type.go.html#5940453">err</a></span>&nbsp;<span class="op" id="5940497">!=</span>&nbsp;<span class="ident" id="5940500">nil</span>&nbsp;<span class="op" id="5940504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940510">return</span>&nbsp;<span class="ident" id="5940517">nil</span><span class="op" id="5940520">,</span>&nbsp;<span class="ident" id="5940522"><a href="/encoding/gob/type.go.html#5940453">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940529">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5940534">//&nbsp;Some&nbsp;mutually&nbsp;recursive&nbsp;types&nbsp;can&nbsp;cause&nbsp;us&nbsp;to&nbsp;be&nbsp;here&nbsp;while</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5940600">//&nbsp;still&nbsp;defining&nbsp;the&nbsp;element.&nbsp;Fix&nbsp;the&nbsp;element&nbsp;type&nbsp;id&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5940664">//&nbsp;We&nbsp;could&nbsp;do&nbsp;this&nbsp;more&nbsp;neatly&nbsp;by&nbsp;setting&nbsp;the&nbsp;id&nbsp;at&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5940733">//&nbsp;building&nbsp;every&nbsp;type,&nbsp;but&nbsp;that&nbsp;would&nbsp;break&nbsp;binary&nbsp;compatibility.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940803">if</span>&nbsp;<span class="ident" id="5940806"><a href="/encoding/gob/type.go.html#5940449">gt</a></span><span class="op" id="5940808">.</span><span class="ident" id="5940809">id</span><span class="op" id="5940811">(</span><span class="op" id="5940812">)</span>&nbsp;<span class="op" id="5940814">==</span>&nbsp;<span class="num" id="5940817">0</span>&nbsp;<span class="op" id="5940819">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940825"><a href="/encoding/gob/type.go.html#5930770">setTypeId</a></span><span class="op" id="5940834">(</span><span class="ident" id="5940835"><a href="/encoding/gob/type.go.html#5940449">gt</a></span><span class="op" id="5940837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940847"><a href="/encoding/gob/type.go.html#5940149">st</a></span><span class="op" id="5940849">.</span><span class="ident" id="5940850">Field</span>&nbsp;<span class="op" id="5940856">=</span>&nbsp;<span class="builtinfunc" id="5940858">append</span><span class="op" id="5940864">(</span><span class="ident" id="5940865"><a href="/encoding/gob/type.go.html#5940149">st</a></span><span class="op" id="5940867">.</span><span class="ident" id="5940868">Field</span><span class="op" id="5940873">,</span>&nbsp;<span class="op" id="5940875">&amp;</span><span class="ident" id="5940876"><a href="/encoding/gob/type.go.html#5936770">fieldType</a></span><span class="op" id="5940885">{</span><span class="ident" id="5940886"><a href="/encoding/gob/type.go.html#5940258">f</a></span><span class="op" id="5940887">.</span><span class="ident" id="5940888">Name</span><span class="op" id="5940892">,</span>&nbsp;<span class="ident" id="5940894"><a href="/encoding/gob/type.go.html#5940449">gt</a></span><span class="op" id="5940896">.</span><span class="ident" id="5940897">id</span><span class="op" id="5940899">(</span><span class="op" id="5940900">)</span><span class="op" id="5940901">}</span><span class="op" id="5940902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940910">return</span>&nbsp;<span class="ident" id="5940917"><a href="/encoding/gob/type.go.html#5940149">st</a></span><span class="op" id="5940919">,</span>&nbsp;<span class="ident" id="5940921">nil</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940927">default</span><span class="op" id="5940934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940938">return</span>&nbsp;<span class="ident" id="5940945">nil</span><span class="op" id="5940948">,</span>&nbsp;<span class="ident" id="5940950"><a href="/encoding/gob/type.go.html#5924772">errors</a></span><span class="op" id="5940956">.</span><span class="ident" id="5940957">New</span><span class="op" id="5940960">(</span><span class="string" id="5940961">&#34;gob&nbsp;NewTypeObject&nbsp;can&#39;t&nbsp;handle&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="5941001">+</span>&nbsp;<span class="ident" id="5941003"><a href="/encoding/gob/type.go.html#5937832">rt</a></span><span class="op" id="5941005">.</span><span class="ident" id="5941006">String</span><span class="op" id="5941012">(</span><span class="op" id="5941013">)</span><span class="op" id="5941014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5941017">}</span><br>
<span class="lineno"></span><span class="op" id="5941019">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span><span class="comment" id="5941022">//&nbsp;isExported&nbsp;reports&nbsp;whether&nbsp;this&nbsp;is&nbsp;an&nbsp;exported&nbsp;-&nbsp;upper&nbsp;case&nbsp;-&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5941093">func</span>&nbsp;<span class="ident" id="5941098">isExported</span><span class="op" id="5941108">(</span><span class="ident" id="5941109">name</span>&nbsp;<span class="builtintype" id="5941114">string</span><span class="op" id="5941120">)</span>&nbsp;<span class="builtintype" id="5941122">bool</span>&nbsp;<span class="op" id="5941127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5941130">rune</span><span class="op" id="5941134">,</span>&nbsp;<span class="ident" id="5941136">_</span>&nbsp;<span class="op" id="5941138">:=</span>&nbsp;<span class="ident" id="5941141"><a href="/encoding/gob/type.go.html#5924840">utf8</a></span><span class="op" id="5941145">.</span><span class="ident" id="5941146">DecodeRuneInString</span><span class="op" id="5941164">(</span><span class="ident" id="5941165"><a href="/encoding/gob/type.go.html#5941109">name</a></span><span class="op" id="5941169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941172">return</span>&nbsp;<span class="ident" id="5941179"><a href="/encoding/gob/type.go.html#5924829">unicode</a></span><span class="op" id="5941186">.</span><span class="ident" id="5941187">IsUpper</span><span class="op" id="5941194">(</span><span class="builtintype" id="5941195"><a href="/encoding/gob/type.go.html#5941130">rune</a></span><span class="op" id="5941199">)</span><br>
<span class="lineno">570</span><span class="op" id="5941201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5941204">//&nbsp;isSent&nbsp;reports&nbsp;whether&nbsp;this&nbsp;struct&nbsp;field&nbsp;is&nbsp;to&nbsp;be&nbsp;transmitted.</span><br>
<span class="lineno"></span><span class="comment" id="5941270">//&nbsp;It&nbsp;will&nbsp;be&nbsp;transmitted&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;exported&nbsp;and&nbsp;not&nbsp;a&nbsp;chan&nbsp;or&nbsp;func&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="5941348">//&nbsp;or&nbsp;pointer&nbsp;to&nbsp;chan&nbsp;or&nbsp;func.</span><br>
<span class="lineno">575</span><span class="keyword" id="5941379">func</span>&nbsp;<span class="ident" id="5941384">isSent</span><span class="op" id="5941390">(</span><span class="ident" id="5941391">field</span>&nbsp;<span class="op" id="5941397">*</span><span class="ident" id="5941398"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5941405">.</span><span class="ident" id="5941406">StructField</span><span class="op" id="5941417">)</span>&nbsp;<span class="builtintype" id="5941419">bool</span>&nbsp;<span class="op" id="5941424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941427">if</span>&nbsp;<span class="op" id="5941430">!</span><span class="ident" id="5941431"><a href="/encoding/gob/type.go.html#5941098">isExported</a></span><span class="op" id="5941441">(</span><span class="ident" id="5941442"><a href="/encoding/gob/type.go.html#5941391">field</a></span><span class="op" id="5941447">.</span><span class="ident" id="5941448">Name</span><span class="op" id="5941452">)</span>&nbsp;<span class="op" id="5941454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941458">return</span>&nbsp;<span class="builtintype" id="5941465">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5941472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941475">//&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;a&nbsp;chan&nbsp;or&nbsp;func&nbsp;or&nbsp;pointer&nbsp;thereto,&nbsp;don&#39;t&nbsp;send&nbsp;it.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941545">//&nbsp;That&nbsp;is,&nbsp;treat&nbsp;it&nbsp;like&nbsp;an&nbsp;unexported&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5941593">typ</span>&nbsp;<span class="op" id="5941597">:=</span>&nbsp;<span class="ident" id="5941600"><a href="/encoding/gob/type.go.html#5941391">field</a></span><span class="op" id="5941605">.</span><span class="ident" id="5941606">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941612">for</span>&nbsp;<span class="ident" id="5941616"><a href="/encoding/gob/type.go.html#5941593">typ</a></span><span class="op" id="5941619">.</span><span class="ident" id="5941620">Kind</span><span class="op" id="5941624">(</span><span class="op" id="5941625">)</span>&nbsp;<span class="op" id="5941627">==</span>&nbsp;<span class="ident" id="5941630"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5941637">.</span><span class="ident" id="5941638">Ptr</span>&nbsp;<span class="op" id="5941642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5941646"><a href="/encoding/gob/type.go.html#5941593">typ</a></span>&nbsp;<span class="op" id="5941650">=</span>&nbsp;<span class="ident" id="5941652"><a href="/encoding/gob/type.go.html#5941593">typ</a></span><span class="op" id="5941655">.</span><span class="ident" id="5941656">Elem</span><span class="op" id="5941660">(</span><span class="op" id="5941661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5941664">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941667">if</span>&nbsp;<span class="ident" id="5941670"><a href="/encoding/gob/type.go.html#5941593">typ</a></span><span class="op" id="5941673">.</span><span class="ident" id="5941674">Kind</span><span class="op" id="5941678">(</span><span class="op" id="5941679">)</span>&nbsp;<span class="op" id="5941681">==</span>&nbsp;<span class="ident" id="5941684"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5941691">.</span><span class="ident" id="5941692">Chan</span>&nbsp;<span class="op" id="5941697">||</span>&nbsp;<span class="ident" id="5941700"><a href="/encoding/gob/type.go.html#5941593">typ</a></span><span class="op" id="5941703">.</span><span class="ident" id="5941704">Kind</span><span class="op" id="5941708">(</span><span class="op" id="5941709">)</span>&nbsp;<span class="op" id="5941711">==</span>&nbsp;<span class="ident" id="5941714"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5941721">.</span><span class="ident" id="5941722">Func</span>&nbsp;<span class="op" id="5941727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941731">return</span>&nbsp;<span class="builtintype" id="5941738">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5941745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941748">return</span>&nbsp;<span class="builtintype" id="5941755">true</span><br>
<span class="lineno"></span><span class="op" id="5941760">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="5941763">//&nbsp;getBaseType&nbsp;returns&nbsp;the&nbsp;Gob&nbsp;type&nbsp;describing&nbsp;the&nbsp;given&nbsp;reflect.Type&#39;s&nbsp;base&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="5941846">//&nbsp;typeLock&nbsp;must&nbsp;be&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="5941872">func</span>&nbsp;<span class="ident" id="5941877">getBaseType</span><span class="op" id="5941888">(</span><span class="ident" id="5941889">name</span>&nbsp;<span class="builtintype" id="5941894">string</span><span class="op" id="5941900">,</span>&nbsp;<span class="ident" id="5941902">rt</span>&nbsp;<span class="ident" id="5941905"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5941912">.</span><span class="ident" id="5941913">Type</span><span class="op" id="5941917">)</span>&nbsp;<span class="op" id="5941919">(</span><span class="ident" id="5941920"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5941927">,</span>&nbsp;<span class="builtintype" id="5941929">error</span><span class="op" id="5941934">)</span>&nbsp;<span class="op" id="5941936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5941939">ut</span>&nbsp;<span class="op" id="5941942">:=</span>&nbsp;<span class="ident" id="5941945"><a href="/encoding/gob/type.go.html#5929943">userType</a></span><span class="op" id="5941953">(</span><span class="ident" id="5941954"><a href="/encoding/gob/type.go.html#5941902">rt</a></span><span class="op" id="5941956">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941959">return</span>&nbsp;<span class="ident" id="5941966"><a href="/encoding/gob/type.go.html#5942253">getType</a></span><span class="op" id="5941973">(</span><span class="ident" id="5941974"><a href="/encoding/gob/type.go.html#5941889">name</a></span><span class="op" id="5941978">,</span>&nbsp;<span class="ident" id="5941980"><a href="/encoding/gob/type.go.html#5941939">ut</a></span><span class="op" id="5941982">,</span>&nbsp;<span class="ident" id="5941984"><a href="/encoding/gob/type.go.html#5941939">ut</a></span><span class="op" id="5941986">.</span><span class="ident" id="5941987">base</span><span class="op" id="5941991">)</span><br>
<span class="lineno"></span><span class="op" id="5941993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5941996">//&nbsp;getType&nbsp;returns&nbsp;the&nbsp;Gob&nbsp;type&nbsp;describing&nbsp;the&nbsp;given&nbsp;reflect.Type.</span><br>
<span class="lineno"></span><span class="comment" id="5942063">//&nbsp;Should&nbsp;be&nbsp;called&nbsp;only&nbsp;when&nbsp;handling&nbsp;GobEncoders/Decoders,</span><br>
<span class="lineno">600</span><span class="comment" id="5942124">//&nbsp;which&nbsp;may&nbsp;be&nbsp;pointers.&nbsp;&nbsp;All&nbsp;other&nbsp;types&nbsp;are&nbsp;handled&nbsp;through&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5942191">//&nbsp;base&nbsp;type,&nbsp;never&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="comment" id="5942222">//&nbsp;typeLock&nbsp;must&nbsp;be&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="5942248">func</span>&nbsp;<span class="ident" id="5942253">getType</span><span class="op" id="5942260">(</span><span class="ident" id="5942261">name</span>&nbsp;<span class="builtintype" id="5942266">string</span><span class="op" id="5942272">,</span>&nbsp;<span class="ident" id="5942274">ut</span>&nbsp;<span class="op" id="5942277">*</span><span class="ident" id="5942278"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span><span class="op" id="5942290">,</span>&nbsp;<span class="ident" id="5942292">rt</span>&nbsp;<span class="ident" id="5942295"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5942302">.</span><span class="ident" id="5942303">Type</span><span class="op" id="5942307">)</span>&nbsp;<span class="op" id="5942309">(</span><span class="ident" id="5942310"><a href="/encoding/gob/type.go.html#5930433">gobType</a></span><span class="op" id="5942317">,</span>&nbsp;<span class="builtintype" id="5942319">error</span><span class="op" id="5942324">)</span>&nbsp;<span class="op" id="5942326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5942329">typ</span><span class="op" id="5942332">,</span>&nbsp;<span class="ident" id="5942334">present</span>&nbsp;<span class="op" id="5942342">:=</span>&nbsp;<span class="ident" id="5942345"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5942350">[</span><span class="ident" id="5942351"><a href="/encoding/gob/type.go.html#5942292">rt</a></span><span class="op" id="5942353">]</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5942356">if</span>&nbsp;<span class="ident" id="5942359"><a href="/encoding/gob/type.go.html#5942334">present</a></span>&nbsp;<span class="op" id="5942367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5942371">return</span>&nbsp;<span class="ident" id="5942378"><a href="/encoding/gob/type.go.html#5942329">typ</a></span><span class="op" id="5942381">,</span>&nbsp;<span class="ident" id="5942383">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5942388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5942391"><a href="/encoding/gob/type.go.html#5942329">typ</a></span><span class="op" id="5942394">,</span>&nbsp;<span class="ident" id="5942396">err</span>&nbsp;<span class="op" id="5942400">:=</span>&nbsp;<span class="ident" id="5942403"><a href="/encoding/gob/type.go.html#5937787">newTypeObject</a></span><span class="op" id="5942416">(</span><span class="ident" id="5942417"><a href="/encoding/gob/type.go.html#5942261">name</a></span><span class="op" id="5942421">,</span>&nbsp;<span class="ident" id="5942423"><a href="/encoding/gob/type.go.html#5942274">ut</a></span><span class="op" id="5942425">,</span>&nbsp;<span class="ident" id="5942427"><a href="/encoding/gob/type.go.html#5942292">rt</a></span><span class="op" id="5942429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5942432">if</span>&nbsp;<span class="ident" id="5942435"><a href="/encoding/gob/type.go.html#5942396">err</a></span>&nbsp;<span class="op" id="5942439">==</span>&nbsp;<span class="ident" id="5942442">nil</span>&nbsp;<span class="op" id="5942446">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5942450"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5942455">[</span><span class="ident" id="5942456"><a href="/encoding/gob/type.go.html#5942292">rt</a></span><span class="op" id="5942458">]</span>&nbsp;<span class="op" id="5942460">=</span>&nbsp;<span class="ident" id="5942462"><a href="/encoding/gob/type.go.html#5942329">typ</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5942467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5942470">return</span>&nbsp;<span class="ident" id="5942477"><a href="/encoding/gob/type.go.html#5942329">typ</a></span><span class="op" id="5942480">,</span>&nbsp;<span class="ident" id="5942482"><a href="/encoding/gob/type.go.html#5942396">err</a></span><br>
<span class="lineno"></span><span class="op" id="5942486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="5942489">func</span>&nbsp;<span class="ident" id="5942494">checkId</span><span class="op" id="5942501">(</span><span class="ident" id="5942502">want</span><span class="op" id="5942506">,</span>&nbsp;<span class="ident" id="5942508">got</span>&nbsp;<span class="ident" id="5942512"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5942518">)</span>&nbsp;<span class="op" id="5942520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5942523">if</span>&nbsp;<span class="ident" id="5942526"><a href="/encoding/gob/type.go.html#5942502">want</a></span>&nbsp;<span class="op" id="5942531">!=</span>&nbsp;<span class="ident" id="5942534"><a href="/encoding/gob/type.go.html#5942508">got</a></span>&nbsp;<span class="op" id="5942538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5942542"><a href="/encoding/gob/type.go.html#5924782">fmt</a></span><span class="op" id="5942545">.</span><span class="ident" id="5942546">Fprintf</span><span class="op" id="5942553">(</span><span class="ident" id="5942554"><a href="/encoding/gob/type.go.html#5924789">os</a></span><span class="op" id="5942556">.</span><span class="ident" id="5942557">Stderr</span><span class="op" id="5942563">,</span>&nbsp;<span class="string" id="5942565">&#34;checkId:&nbsp;%d&nbsp;should&nbsp;be&nbsp;%d\n&#34;</span><span class="op" id="5942593">,</span>&nbsp;<span class="builtintype" id="5942595">int</span><span class="op" id="5942598">(</span><span class="ident" id="5942599"><a href="/encoding/gob/type.go.html#5942508">got</a></span><span class="op" id="5942602">)</span><span class="op" id="5942603">,</span>&nbsp;<span class="builtintype" id="5942605">int</span><span class="op" id="5942608">(</span><span class="ident" id="5942609"><a href="/encoding/gob/type.go.html#5942502">want</a></span><span class="op" id="5942613">)</span><span class="op" id="5942614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5942618">panic</span><span class="op" id="5942623">(</span><span class="string" id="5942624">&#34;bootstrap&nbsp;type&nbsp;wrong&nbsp;id:&nbsp;&#34;</span>&nbsp;<span class="op" id="5942652">+</span>&nbsp;<span class="ident" id="5942654"><a href="/encoding/gob/type.go.html#5942508">got</a></span><span class="op" id="5942657">.</span><span class="ident" id="5942658">name</span><span class="op" id="5942662">(</span><span class="op" id="5942663">)</span>&nbsp;<span class="op" id="5942665">+</span>&nbsp;<span class="string" id="5942667">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="5942671">+</span>&nbsp;<span class="ident" id="5942673"><a href="/encoding/gob/type.go.html#5942508">got</a></span><span class="op" id="5942676">.</span><span class="builtintype" id="5942677">string</span><span class="op" id="5942683">(</span><span class="op" id="5942684">)</span>&nbsp;<span class="op" id="5942686">+</span>&nbsp;<span class="string" id="5942688">&#34;&nbsp;not&nbsp;&#34;</span>&nbsp;<span class="op" id="5942696">+</span>&nbsp;<span class="ident" id="5942698"><a href="/encoding/gob/type.go.html#5942502">want</a></span><span class="op" id="5942702">.</span><span class="builtintype" id="5942703">string</span><span class="op" id="5942709">(</span><span class="op" id="5942710">)</span><span class="op" id="5942711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5942714">}</span><br>
<span class="lineno">620</span><span class="op" id="5942716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5942719">//&nbsp;used&nbsp;for&nbsp;building&nbsp;the&nbsp;basic&nbsp;types;&nbsp;called&nbsp;only&nbsp;from&nbsp;init().&nbsp;&nbsp;the&nbsp;incoming</span><br>
<span class="lineno"></span><span class="comment" id="5942796">//&nbsp;interface&nbsp;always&nbsp;refers&nbsp;to&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="keyword" id="5942837">func</span>&nbsp;<span class="ident" id="5942842">bootstrapType</span><span class="op" id="5942855">(</span><span class="ident" id="5942856">name</span>&nbsp;<span class="builtintype" id="5942861">string</span><span class="op" id="5942867">,</span>&nbsp;<span class="ident" id="5942869">e</span>&nbsp;<span class="keyword" id="5942871">interface</span><span class="op" id="5942880">{</span><span class="op" id="5942881">}</span><span class="op" id="5942882">,</span>&nbsp;<span class="ident" id="5942884">expect</span>&nbsp;<span class="ident" id="5942891"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><span class="op" id="5942897">)</span>&nbsp;<span class="ident" id="5942899"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span>&nbsp;<span class="op" id="5942906">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5942909">rt</span>&nbsp;<span class="op" id="5942912">:=</span>&nbsp;<span class="ident" id="5942915"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5942922">.</span><span class="ident" id="5942923">TypeOf</span><span class="op" id="5942929">(</span><span class="ident" id="5942930"><a href="/encoding/gob/type.go.html#5942869">e</a></span><span class="op" id="5942931">)</span><span class="op" id="5942932">.</span><span class="ident" id="5942933">Elem</span><span class="op" id="5942937">(</span><span class="op" id="5942938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5942941">_</span><span class="op" id="5942942">,</span>&nbsp;<span class="ident" id="5942944">present</span>&nbsp;<span class="op" id="5942952">:=</span>&nbsp;<span class="ident" id="5942955"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5942960">[</span><span class="ident" id="5942961"><a href="/encoding/gob/type.go.html#5942909">rt</a></span><span class="op" id="5942963">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5942966">if</span>&nbsp;<span class="ident" id="5942969"><a href="/encoding/gob/type.go.html#5942944">present</a></span>&nbsp;<span class="op" id="5942977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5942981">panic</span><span class="op" id="5942986">(</span><span class="string" id="5942987">&#34;bootstrap&nbsp;type&nbsp;already&nbsp;present:&nbsp;&#34;</span>&nbsp;<span class="op" id="5943022">+</span>&nbsp;<span class="ident" id="5943024"><a href="/encoding/gob/type.go.html#5942856">name</a></span>&nbsp;<span class="op" id="5943029">+</span>&nbsp;<span class="string" id="5943031">&#34;,&nbsp;&#34;</span>&nbsp;<span class="op" id="5943036">+</span>&nbsp;<span class="ident" id="5943038"><a href="/encoding/gob/type.go.html#5942909">rt</a></span><span class="op" id="5943040">.</span><span class="ident" id="5943041">String</span><span class="op" id="5943047">(</span><span class="op" id="5943048">)</span><span class="op" id="5943049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5943052">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943055">typ</span>&nbsp;<span class="op" id="5943059">:=</span>&nbsp;<span class="op" id="5943062">&amp;</span><span class="ident" id="5943063"><a href="/encoding/gob/type.go.html#5931649">CommonType</a></span><span class="op" id="5943073">{</span><span class="ident" id="5943074">Name</span><span class="op" id="5943078">:</span>&nbsp;<span class="ident" id="5943080"><a href="/encoding/gob/type.go.html#5942856">name</a></span><span class="op" id="5943084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943087"><a href="/encoding/gob/type.go.html#5930598">types</a></span><span class="op" id="5943092">[</span><span class="ident" id="5943093"><a href="/encoding/gob/type.go.html#5942909">rt</a></span><span class="op" id="5943095">]</span>&nbsp;<span class="op" id="5943097">=</span>&nbsp;<span class="ident" id="5943099"><a href="/encoding/gob/type.go.html#5943055">typ</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943104"><a href="/encoding/gob/type.go.html#5930770">setTypeId</a></span><span class="op" id="5943113">(</span><span class="ident" id="5943114"><a href="/encoding/gob/type.go.html#5943055">typ</a></span><span class="op" id="5943117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943120"><a href="/encoding/gob/type.go.html#5942494">checkId</a></span><span class="op" id="5943127">(</span><span class="ident" id="5943128"><a href="/encoding/gob/type.go.html#5942884">expect</a></span><span class="op" id="5943134">,</span>&nbsp;<span class="ident" id="5943136"><a href="/encoding/gob/type.go.html#5930252">nextId</a></span><span class="op" id="5943142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943145"><a href="/encoding/gob/type.go.html#5929943">userType</a></span><span class="op" id="5943153">(</span><span class="ident" id="5943154"><a href="/encoding/gob/type.go.html#5942909">rt</a></span><span class="op" id="5943156">)</span>&nbsp;<span class="comment" id="5943158">//&nbsp;might&nbsp;as&nbsp;well&nbsp;cache&nbsp;it&nbsp;now</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5943189">return</span>&nbsp;<span class="ident" id="5943196"><a href="/encoding/gob/type.go.html#5930252">nextId</a></span><br>
<span class="lineno"></span><span class="op" id="5943203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5943206">//&nbsp;Representation&nbsp;of&nbsp;the&nbsp;information&nbsp;we&nbsp;send&nbsp;and&nbsp;receive&nbsp;about&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="5943280">//&nbsp;Each&nbsp;value&nbsp;we&nbsp;send&nbsp;is&nbsp;preceded&nbsp;by&nbsp;its&nbsp;type&nbsp;definition:&nbsp;an&nbsp;encoded&nbsp;int.</span><br>
<span class="lineno">640</span><span class="comment" id="5943354">//&nbsp;However,&nbsp;the&nbsp;very&nbsp;first&nbsp;time&nbsp;we&nbsp;send&nbsp;the&nbsp;value,&nbsp;we&nbsp;first&nbsp;send&nbsp;the&nbsp;pair</span><br>
<span class="lineno"></span><span class="comment" id="5943428">//&nbsp;(-id,&nbsp;wireType).</span><br>
<span class="lineno"></span><span class="comment" id="5943448">//&nbsp;For&nbsp;bootstrapping&nbsp;purposes,&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;recipient&nbsp;knows&nbsp;how</span><br>
<span class="lineno"></span><span class="comment" id="5943518">//&nbsp;to&nbsp;decode&nbsp;a&nbsp;wireType;&nbsp;it&nbsp;is&nbsp;exactly&nbsp;the&nbsp;wireType&nbsp;struct&nbsp;here,&nbsp;interpreted</span><br>
<span class="lineno"></span><span class="comment" id="5943595">//&nbsp;using&nbsp;the&nbsp;gob&nbsp;rules&nbsp;for&nbsp;sending&nbsp;a&nbsp;structure,&nbsp;except&nbsp;that&nbsp;we&nbsp;assume&nbsp;the</span><br>
<span class="lineno">645</span><span class="comment" id="5943669">//&nbsp;ids&nbsp;for&nbsp;wireType&nbsp;and&nbsp;structType&nbsp;etc.&nbsp;are&nbsp;known.&nbsp;&nbsp;The&nbsp;relevant&nbsp;pieces</span><br>
<span class="lineno"></span><span class="comment" id="5943741">//&nbsp;are&nbsp;built&nbsp;in&nbsp;encode.go&#39;s&nbsp;init()&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5943786">//&nbsp;To&nbsp;maintain&nbsp;binary&nbsp;compatibility,&nbsp;if&nbsp;you&nbsp;extend&nbsp;this&nbsp;type,&nbsp;always&nbsp;put</span><br>
<span class="lineno"></span><span class="comment" id="5943859">//&nbsp;the&nbsp;new&nbsp;fields&nbsp;last.</span><br>
<span class="lineno"></span><span class="keyword" id="5943883">type</span>&nbsp;<span class="ident" id="5943888">wireType</span>&nbsp;<span class="keyword" id="5943897">struct</span>&nbsp;<span class="op" id="5943904">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943907">ArrayT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5943924">*</span><span class="ident" id="5943925"><a href="/encoding/gob/type.go.html#5934346">arrayType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943936">SliceT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5943953">*</span><span class="ident" id="5943954"><a href="/encoding/gob/type.go.html#5936040">sliceType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943965">StructT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5943982">*</span><span class="ident" id="5943983"><a href="/encoding/gob/type.go.html#5936823">structType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5943995">MapT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5944012">*</span><span class="ident" id="5944013"><a href="/encoding/gob/type.go.html#5935363">mapType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5944022">GobEncoderT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5944039">*</span><span class="ident" id="5944040"><a href="/encoding/gob/type.go.html#5935035">gobEncoderType</a></span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5944056">BinaryMarshalerT</span>&nbsp;<span class="op" id="5944073">*</span><span class="ident" id="5944074"><a href="/encoding/gob/type.go.html#5935035">gobEncoderType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5944090">TextMarshalerT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5944107">*</span><span class="ident" id="5944108"><a href="/encoding/gob/type.go.html#5935035">gobEncoderType</a></span><br>
<span class="lineno"></span><span class="op" id="5944123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5944126">func</span>&nbsp;<span class="op" id="5944131">(</span><span class="ident" id="5944132">w</span>&nbsp;<span class="op" id="5944134">*</span><span class="ident" id="5944135"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5944143">)</span>&nbsp;<span class="builtintype" id="5944145">string</span><span class="op" id="5944151">(</span><span class="op" id="5944152">)</span>&nbsp;<span class="builtintype" id="5944154">string</span>&nbsp;<span class="op" id="5944161">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944164">const</span>&nbsp;<span class="ident" id="5944170">unknown</span>&nbsp;<span class="op" id="5944178">=</span>&nbsp;<span class="string" id="5944180">&#34;unknown&nbsp;type&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944196">if</span>&nbsp;<span class="ident" id="5944199"><a href="/encoding/gob/type.go.html#5944132">w</a></span>&nbsp;<span class="op" id="5944201">==</span>&nbsp;<span class="ident" id="5944204">nil</span>&nbsp;<span class="op" id="5944208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944212">return</span>&nbsp;<span class="ident" id="5944219"><a href="/encoding/gob/type.go.html#5944170">unknown</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5944228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944231">switch</span>&nbsp;<span class="op" id="5944238">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944241">case</span>&nbsp;<span class="ident" id="5944246"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944247">.</span><span class="ident" id="5944248">ArrayT</span>&nbsp;<span class="op" id="5944255">!=</span>&nbsp;<span class="ident" id="5944258">nil</span><span class="op" id="5944261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944265">return</span>&nbsp;<span class="ident" id="5944272"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944273">.</span><span class="ident" id="5944274">ArrayT</span><span class="op" id="5944280">.</span><span class="ident" id="5944281">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944287">case</span>&nbsp;<span class="ident" id="5944292"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944293">.</span><span class="ident" id="5944294">SliceT</span>&nbsp;<span class="op" id="5944301">!=</span>&nbsp;<span class="ident" id="5944304">nil</span><span class="op" id="5944307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944311">return</span>&nbsp;<span class="ident" id="5944318"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944319">.</span><span class="ident" id="5944320">SliceT</span><span class="op" id="5944326">.</span><span class="ident" id="5944327">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944333">case</span>&nbsp;<span class="ident" id="5944338"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944339">.</span><span class="ident" id="5944340">StructT</span>&nbsp;<span class="op" id="5944348">!=</span>&nbsp;<span class="ident" id="5944351">nil</span><span class="op" id="5944354">:</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944358">return</span>&nbsp;<span class="ident" id="5944365"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944366">.</span><span class="ident" id="5944367">StructT</span><span class="op" id="5944374">.</span><span class="ident" id="5944375">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944381">case</span>&nbsp;<span class="ident" id="5944386"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944387">.</span><span class="ident" id="5944388">MapT</span>&nbsp;<span class="op" id="5944393">!=</span>&nbsp;<span class="ident" id="5944396">nil</span><span class="op" id="5944399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944403">return</span>&nbsp;<span class="ident" id="5944410"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944411">.</span><span class="ident" id="5944412">MapT</span><span class="op" id="5944416">.</span><span class="ident" id="5944417">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944423">case</span>&nbsp;<span class="ident" id="5944428"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944429">.</span><span class="ident" id="5944430">GobEncoderT</span>&nbsp;<span class="op" id="5944442">!=</span>&nbsp;<span class="ident" id="5944445">nil</span><span class="op" id="5944448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944452">return</span>&nbsp;<span class="ident" id="5944459"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944460">.</span><span class="ident" id="5944461">GobEncoderT</span><span class="op" id="5944472">.</span><span class="ident" id="5944473">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944479">case</span>&nbsp;<span class="ident" id="5944484"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944485">.</span><span class="ident" id="5944486">BinaryMarshalerT</span>&nbsp;<span class="op" id="5944503">!=</span>&nbsp;<span class="ident" id="5944506">nil</span><span class="op" id="5944509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944513">return</span>&nbsp;<span class="ident" id="5944520"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944521">.</span><span class="ident" id="5944522">BinaryMarshalerT</span><span class="op" id="5944538">.</span><span class="ident" id="5944539">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944545">case</span>&nbsp;<span class="ident" id="5944550"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944551">.</span><span class="ident" id="5944552">TextMarshalerT</span>&nbsp;<span class="op" id="5944567">!=</span>&nbsp;<span class="ident" id="5944570">nil</span><span class="op" id="5944573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944577">return</span>&nbsp;<span class="ident" id="5944584"><a href="/encoding/gob/type.go.html#5944132">w</a></span><span class="op" id="5944585">.</span><span class="ident" id="5944586">TextMarshalerT</span><span class="op" id="5944600">.</span><span class="ident" id="5944601">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5944607">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5944610">return</span>&nbsp;<span class="ident" id="5944617"><a href="/encoding/gob/type.go.html#5944170">unknown</a></span><br>
<span class="lineno"></span><span class="op" id="5944625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5944628">type</span>&nbsp;<span class="ident" id="5944633">typeInfo</span>&nbsp;<span class="keyword" id="5944642">struct</span>&nbsp;<span class="op" id="5944649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5944652">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5944660"><a href="/encoding/gob/type.go.html#5930234">typeId</a></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5944668">encInit</span>&nbsp;<span class="ident" id="5944676"><a href="/encoding/gob/type.go.html#5924806">sync</a></span><span class="op" id="5944680">.</span><span class="ident" id="5944681">Mutex</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5944689">//&nbsp;protects&nbsp;creation&nbsp;of&nbsp;encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5944722">encoder</span>&nbsp;<span class="ident" id="5944730"><a href="/encoding/gob/type.go.html#5924814">atomic</a></span><span class="op" id="5944736">.</span><span class="ident" id="5944737">Value</span>&nbsp;<span class="comment" id="5944743">//&nbsp;*encEngine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5944758">wire</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5944766">*</span><span class="ident" id="5944767"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><br>
<span class="lineno"></span><span class="op" id="5944776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="comment" id="5944779">//&nbsp;typeInfoMap&nbsp;is&nbsp;an&nbsp;atomic&nbsp;pointer&nbsp;to&nbsp;map[reflect.Type]*typeInfo.</span><br>
<span class="lineno"></span><span class="comment" id="5944846">//&nbsp;It&#39;s&nbsp;updated&nbsp;copy-on-write.&nbsp;Readers&nbsp;just&nbsp;do&nbsp;an&nbsp;atomic&nbsp;load</span><br>
<span class="lineno"></span><span class="comment" id="5944908">//&nbsp;to&nbsp;get&nbsp;the&nbsp;current&nbsp;version&nbsp;of&nbsp;the&nbsp;map.&nbsp;Writers&nbsp;make&nbsp;a&nbsp;full&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5944978">//&nbsp;the&nbsp;map&nbsp;and&nbsp;atomically&nbsp;update&nbsp;the&nbsp;pointer&nbsp;to&nbsp;point&nbsp;to&nbsp;the&nbsp;new&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5945048">//&nbsp;Under&nbsp;heavy&nbsp;read&nbsp;contention,&nbsp;this&nbsp;is&nbsp;significantly&nbsp;faster&nbsp;than&nbsp;a&nbsp;map</span><br>
<span class="lineno">695</span><span class="comment" id="5945120">//&nbsp;protected&nbsp;by&nbsp;a&nbsp;mutex.</span><br>
<span class="lineno"></span><span class="keyword" id="5945145">var</span>&nbsp;<span class="ident" id="5945149">typeInfoMap</span>&nbsp;<span class="ident" id="5945161"><a href="/encoding/gob/type.go.html#5924814">atomic</a></span><span class="op" id="5945167">.</span><span class="ident" id="5945168">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5945175">func</span>&nbsp;<span class="ident" id="5945180">lookupTypeInfo</span><span class="op" id="5945194">(</span><span class="ident" id="5945195">rt</span>&nbsp;<span class="ident" id="5945198"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5945205">.</span><span class="ident" id="5945206">Type</span><span class="op" id="5945210">)</span>&nbsp;<span class="op" id="5945212">*</span><span class="ident" id="5945213"><a href="/encoding/gob/type.go.html#5944633">typeInfo</a></span>&nbsp;<span class="op" id="5945222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5945225">m</span><span class="op" id="5945226">,</span>&nbsp;<span class="ident" id="5945228">_</span>&nbsp;<span class="op" id="5945230">:=</span>&nbsp;<span class="ident" id="5945233"><a href="/encoding/gob/type.go.html#5945149">typeInfoMap</a></span><span class="op" id="5945244">.</span><span class="ident" id="5945245">Load</span><span class="op" id="5945249">(</span><span class="op" id="5945250">)</span><span class="op" id="5945251">.</span><span class="op" id="5945252">(</span><span class="keyword" id="5945253">map</span><span class="op" id="5945256">[</span><span class="ident" id="5945257"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5945264">.</span><span class="ident" id="5945265">Type</span><span class="op" id="5945269">]</span><span class="op" id="5945270">*</span><span class="ident" id="5945271"><a href="/encoding/gob/type.go.html#5944633">typeInfo</a></span><span class="op" id="5945279">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945282">return</span>&nbsp;<span class="ident" id="5945289"><a href="/encoding/gob/type.go.html#5945225">m</a></span><span class="op" id="5945290">[</span><span class="ident" id="5945291"><a href="/encoding/gob/type.go.html#5945195">rt</a></span><span class="op" id="5945293">]</span><br>
<span class="lineno"></span><span class="op" id="5945295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5945298">func</span>&nbsp;<span class="ident" id="5945303">getTypeInfo</span><span class="op" id="5945314">(</span><span class="ident" id="5945315">ut</span>&nbsp;<span class="op" id="5945318">*</span><span class="ident" id="5945319"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span><span class="op" id="5945331">)</span>&nbsp;<span class="op" id="5945333">(</span><span class="op" id="5945334">*</span><span class="ident" id="5945335"><a href="/encoding/gob/type.go.html#5944633">typeInfo</a></span><span class="op" id="5945343">,</span>&nbsp;<span class="builtintype" id="5945345">error</span><span class="op" id="5945350">)</span>&nbsp;<span class="op" id="5945352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5945355">rt</span>&nbsp;<span class="op" id="5945358">:=</span>&nbsp;<span class="ident" id="5945361"><a href="/encoding/gob/type.go.html#5945315">ut</a></span><span class="op" id="5945363">.</span><span class="ident" id="5945364">base</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945370">if</span>&nbsp;<span class="ident" id="5945373"><a href="/encoding/gob/type.go.html#5945315">ut</a></span><span class="op" id="5945375">.</span><span class="ident" id="5945376">externalEnc</span>&nbsp;<span class="op" id="5945388">!=</span>&nbsp;<span class="num" id="5945391">0</span>&nbsp;<span class="op" id="5945393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5945397">//&nbsp;We&nbsp;want&nbsp;the&nbsp;user&nbsp;type,&nbsp;not&nbsp;the&nbsp;base&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5945444"><a href="/encoding/gob/type.go.html#5945355">rt</a></span>&nbsp;<span class="op" id="5945447">=</span>&nbsp;<span class="ident" id="5945449"><a href="/encoding/gob/type.go.html#5945315">ut</a></span><span class="op" id="5945451">.</span><span class="ident" id="5945452">user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5945458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945461">if</span>&nbsp;<span class="ident" id="5945464">info</span>&nbsp;<span class="op" id="5945469">:=</span>&nbsp;<span class="ident" id="5945472"><a href="/encoding/gob/type.go.html#5945180">lookupTypeInfo</a></span><span class="op" id="5945486">(</span><span class="ident" id="5945487"><a href="/encoding/gob/type.go.html#5945355">rt</a></span><span class="op" id="5945489">)</span><span class="op" id="5945490">;</span>&nbsp;<span class="ident" id="5945492"><a href="/encoding/gob/type.go.html#5945464">info</a></span>&nbsp;<span class="op" id="5945497">!=</span>&nbsp;<span class="ident" id="5945500">nil</span>&nbsp;<span class="op" id="5945504">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945508">return</span>&nbsp;<span class="ident" id="5945515"><a href="/encoding/gob/type.go.html#5945464">info</a></span><span class="op" id="5945519">,</span>&nbsp;<span class="ident" id="5945521">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5945526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945529">return</span>&nbsp;<span class="ident" id="5945536"><a href="/encoding/gob/type.go.html#5945667">buildTypeInfo</a></span><span class="op" id="5945549">(</span><span class="ident" id="5945550"><a href="/encoding/gob/type.go.html#5945315">ut</a></span><span class="op" id="5945552">,</span>&nbsp;<span class="ident" id="5945554"><a href="/encoding/gob/type.go.html#5945355">rt</a></span><span class="op" id="5945556">)</span><br>
<span class="lineno"></span><span class="op" id="5945558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="5945561">//&nbsp;buildTypeInfo&nbsp;constructs&nbsp;the&nbsp;type&nbsp;information&nbsp;for&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5945623">//&nbsp;and&nbsp;stores&nbsp;it&nbsp;in&nbsp;the&nbsp;type&nbsp;info&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="5945662">func</span>&nbsp;<span class="ident" id="5945667">buildTypeInfo</span><span class="op" id="5945680">(</span><span class="ident" id="5945681">ut</span>&nbsp;<span class="op" id="5945684">*</span><span class="ident" id="5945685"><a href="/encoding/gob/type.go.html#5925033">userTypeInfo</a></span><span class="op" id="5945697">,</span>&nbsp;<span class="ident" id="5945699">rt</span>&nbsp;<span class="ident" id="5945702"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5945709">.</span><span class="ident" id="5945710">Type</span><span class="op" id="5945714">)</span>&nbsp;<span class="op" id="5945716">(</span><span class="op" id="5945717">*</span><span class="ident" id="5945718"><a href="/encoding/gob/type.go.html#5944633">typeInfo</a></span><span class="op" id="5945726">,</span>&nbsp;<span class="builtintype" id="5945728">error</span><span class="op" id="5945733">)</span>&nbsp;<span class="op" id="5945735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5945738"><a href="/encoding/gob/type.go.html#5930318">typeLock</a></span><span class="op" id="5945746">.</span><span class="ident" id="5945747">Lock</span><span class="op" id="5945751">(</span><span class="op" id="5945752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945755">defer</span>&nbsp;<span class="ident" id="5945761"><a href="/encoding/gob/type.go.html#5930318">typeLock</a></span><span class="op" id="5945769">.</span><span class="ident" id="5945770">Unlock</span><span class="op" id="5945776">(</span><span class="op" id="5945777">)</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945781">if</span>&nbsp;<span class="ident" id="5945784">info</span>&nbsp;<span class="op" id="5945789">:=</span>&nbsp;<span class="ident" id="5945792"><a href="/encoding/gob/type.go.html#5945180">lookupTypeInfo</a></span><span class="op" id="5945806">(</span><span class="ident" id="5945807"><a href="/encoding/gob/type.go.html#5945699">rt</a></span><span class="op" id="5945809">)</span><span class="op" id="5945810">;</span>&nbsp;<span class="ident" id="5945812"><a href="/encoding/gob/type.go.html#5945784">info</a></span>&nbsp;<span class="op" id="5945817">!=</span>&nbsp;<span class="ident" id="5945820">nil</span>&nbsp;<span class="op" id="5945824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945828">return</span>&nbsp;<span class="ident" id="5945835"><a href="/encoding/gob/type.go.html#5945784">info</a></span><span class="op" id="5945839">,</span>&nbsp;<span class="ident" id="5945841">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5945846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5945850">gt</span><span class="op" id="5945852">,</span>&nbsp;<span class="ident" id="5945854">err</span>&nbsp;<span class="op" id="5945858">:=</span>&nbsp;<span class="ident" id="5945861"><a href="/encoding/gob/type.go.html#5941877">getBaseType</a></span><span class="op" id="5945872">(</span><span class="ident" id="5945873"><a href="/encoding/gob/type.go.html#5945699">rt</a></span><span class="op" id="5945875">.</span><span class="ident" id="5945876">Name</span><span class="op" id="5945880">(</span><span class="op" id="5945881">)</span><span class="op" id="5945882">,</span>&nbsp;<span class="ident" id="5945884"><a href="/encoding/gob/type.go.html#5945699">rt</a></span><span class="op" id="5945886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945889">if</span>&nbsp;<span class="ident" id="5945892"><a href="/encoding/gob/type.go.html#5945854">err</a></span>&nbsp;<span class="op" id="5945896">!=</span>&nbsp;<span class="ident" id="5945899">nil</span>&nbsp;<span class="op" id="5945903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945907">return</span>&nbsp;<span class="ident" id="5945914">nil</span><span class="op" id="5945917">,</span>&nbsp;<span class="ident" id="5945919"><a href="/encoding/gob/type.go.html#5945854">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5945924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5945927">info</span>&nbsp;<span class="op" id="5945932">:=</span>&nbsp;<span class="op" id="5945935">&amp;</span><span class="ident" id="5945936"><a href="/encoding/gob/type.go.html#5944633">typeInfo</a></span><span class="op" id="5945944">{</span><span class="ident" id="5945945">id</span><span class="op" id="5945947">:</span>&nbsp;<span class="ident" id="5945949"><a href="/encoding/gob/type.go.html#5945850">gt</a></span><span class="op" id="5945951">.</span><span class="ident" id="5945952">id</span><span class="op" id="5945954">(</span><span class="op" id="5945955">)</span><span class="op" id="5945956">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5945960">if</span>&nbsp;<span class="ident" id="5945963"><a href="/encoding/gob/type.go.html#5945681">ut</a></span><span class="op" id="5945965">.</span><span class="ident" id="5945966">externalEnc</span>&nbsp;<span class="op" id="5945978">!=</span>&nbsp;<span class="num" id="5945981">0</span>&nbsp;<span class="op" id="5945983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5945987">userType</span><span class="op" id="5945995">,</span>&nbsp;<span class="ident" id="5945997">err</span>&nbsp;<span class="op" id="5946001">:=</span>&nbsp;<span class="ident" id="5946004"><a href="/encoding/gob/type.go.html#5942253">getType</a></span><span class="op" id="5946011">(</span><span class="ident" id="5946012"><a href="/encoding/gob/type.go.html#5945699">rt</a></span><span class="op" id="5946014">.</span><span class="ident" id="5946015">Name</span><span class="op" id="5946019">(</span><span class="op" id="5946020">)</span><span class="op" id="5946021">,</span>&nbsp;<span class="ident" id="5946023"><a href="/encoding/gob/type.go.html#5945681">ut</a></span><span class="op" id="5946025">,</span>&nbsp;<span class="ident" id="5946027"><a href="/encoding/gob/type.go.html#5945699">rt</a></span><span class="op" id="5946029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946033">if</span>&nbsp;<span class="ident" id="5946036"><a href="/encoding/gob/type.go.html#5945997">err</a></span>&nbsp;<span class="op" id="5946040">!=</span>&nbsp;<span class="ident" id="5946043">nil</span>&nbsp;<span class="op" id="5946047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946052">return</span>&nbsp;<span class="ident" id="5946059">nil</span><span class="op" id="5946062">,</span>&nbsp;<span class="ident" id="5946064"><a href="/encoding/gob/type.go.html#5945997">err</a></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5946070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946074">gt</span>&nbsp;<span class="op" id="5946077">:=</span>&nbsp;<span class="ident" id="5946080"><a href="/encoding/gob/type.go.html#5945987">userType</a></span><span class="op" id="5946088">.</span><span class="ident" id="5946089">id</span><span class="op" id="5946091">(</span><span class="op" id="5946092">)</span><span class="op" id="5946093">.</span><span class="ident" id="5946094">gobType</span><span class="op" id="5946101">(</span><span class="op" id="5946102">)</span><span class="op" id="5946103">.</span><span class="op" id="5946104">(</span><span class="op" id="5946105">*</span><span class="ident" id="5946106"><a href="/encoding/gob/type.go.html#5935035">gobEncoderType</a></span><span class="op" id="5946120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946124">switch</span>&nbsp;<span class="ident" id="5946131"><a href="/encoding/gob/type.go.html#5945681">ut</a></span><span class="op" id="5946133">.</span><span class="ident" id="5946134">externalEnc</span>&nbsp;<span class="op" id="5946146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946150">case</span>&nbsp;<span class="ident" id="5946155"><a href="/encoding/gob/type.go.html#5925587">xGob</a></span><span class="op" id="5946159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946164"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5946168">.</span><span class="ident" id="5946169">wire</span>&nbsp;<span class="op" id="5946174">=</span>&nbsp;<span class="op" id="5946176">&amp;</span><span class="ident" id="5946177"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5946185">{</span><span class="ident" id="5946186">GobEncoderT</span><span class="op" id="5946197">:</span>&nbsp;<span class="ident" id="5946199"><a href="/encoding/gob/type.go.html#5946074">gt</a></span><span class="op" id="5946201">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946205">case</span>&nbsp;<span class="ident" id="5946210"><a href="/encoding/gob/type.go.html#5925635">xBinary</a></span><span class="op" id="5946217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946222"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5946226">.</span><span class="ident" id="5946227">wire</span>&nbsp;<span class="op" id="5946232">=</span>&nbsp;<span class="op" id="5946234">&amp;</span><span class="ident" id="5946235"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5946243">{</span><span class="ident" id="5946244">BinaryMarshalerT</span><span class="op" id="5946260">:</span>&nbsp;<span class="ident" id="5946262"><a href="/encoding/gob/type.go.html#5946074">gt</a></span><span class="op" id="5946264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946268">case</span>&nbsp;<span class="ident" id="5946273"><a href="/encoding/gob/type.go.html#5925713">xText</a></span><span class="op" id="5946278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946283"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5946287">.</span><span class="ident" id="5946288">wire</span>&nbsp;<span class="op" id="5946293">=</span>&nbsp;<span class="op" id="5946295">&amp;</span><span class="ident" id="5946296"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5946304">{</span><span class="ident" id="5946305">TextMarshalerT</span><span class="op" id="5946319">:</span>&nbsp;<span class="ident" id="5946321"><a href="/encoding/gob/type.go.html#5946074">gt</a></span><span class="op" id="5946323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5946327">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946331"><a href="/encoding/gob/type.go.html#5945699">rt</a></span>&nbsp;<span class="op" id="5946334">=</span>&nbsp;<span class="ident" id="5946336"><a href="/encoding/gob/type.go.html#5945681">ut</a></span><span class="op" id="5946338">.</span><span class="ident" id="5946339">user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5946345">}</span>&nbsp;<span class="keyword" id="5946347">else</span>&nbsp;<span class="op" id="5946352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946356">t</span>&nbsp;<span class="op" id="5946358">:=</span>&nbsp;<span class="ident" id="5946361"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5946365">.</span><span class="ident" id="5946366">id</span><span class="op" id="5946368">.</span><span class="ident" id="5946369">gobType</span><span class="op" id="5946376">(</span><span class="op" id="5946377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946381">switch</span>&nbsp;<span class="ident" id="5946388">typ</span>&nbsp;<span class="op" id="5946392">:=</span>&nbsp;<span class="ident" id="5946395"><a href="/encoding/gob/type.go.html#5945699">rt</a></span><span class="op" id="5946397">;</span>&nbsp;<span class="ident" id="5946399"><a href="/encoding/gob/type.go.html#5946388">typ</a></span><span class="op" id="5946402">.</span><span class="ident" id="5946403">Kind</span><span class="op" id="5946407">(</span><span class="op" id="5946408">)</span>&nbsp;<span class="op" id="5946410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946414">case</span>&nbsp;<span class="ident" id="5946419"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5946426">.</span><span class="ident" id="5946427">Array</span><span class="op" id="5946432">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946437"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5946441">.</span><span class="ident" id="5946442">wire</span>&nbsp;<span class="op" id="5946447">=</span>&nbsp;<span class="op" id="5946449">&amp;</span><span class="ident" id="5946450"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5946458">{</span><span class="ident" id="5946459">ArrayT</span><span class="op" id="5946465">:</span>&nbsp;<span class="ident" id="5946467"><a href="/encoding/gob/type.go.html#5946356">t</a></span><span class="op" id="5946468">.</span><span class="op" id="5946469">(</span><span class="op" id="5946470">*</span><span class="ident" id="5946471"><a href="/encoding/gob/type.go.html#5934346">arrayType</a></span><span class="op" id="5946480">)</span><span class="op" id="5946481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946485">case</span>&nbsp;<span class="ident" id="5946490"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5946497">.</span><span class="ident" id="5946498">Map</span><span class="op" id="5946501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946506"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5946510">.</span><span class="ident" id="5946511">wire</span>&nbsp;<span class="op" id="5946516">=</span>&nbsp;<span class="op" id="5946518">&amp;</span><span class="ident" id="5946519"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5946527">{</span><span class="ident" id="5946528">MapT</span><span class="op" id="5946532">:</span>&nbsp;<span class="ident" id="5946534"><a href="/encoding/gob/type.go.html#5946356">t</a></span><span class="op" id="5946535">.</span><span class="op" id="5946536">(</span><span class="op" id="5946537">*</span><span class="ident" id="5946538"><a href="/encoding/gob/type.go.html#5935363">mapType</a></span><span class="op" id="5946545">)</span><span class="op" id="5946546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946550">case</span>&nbsp;<span class="ident" id="5946555"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5946562">.</span><span class="ident" id="5946563">Slice</span><span class="op" id="5946568">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5946573">//&nbsp;[]byte&nbsp;==&nbsp;[]uint8&nbsp;is&nbsp;a&nbsp;special&nbsp;case&nbsp;handled&nbsp;separately</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946634">if</span>&nbsp;<span class="ident" id="5946637"><a href="/encoding/gob/type.go.html#5946388">typ</a></span><span class="op" id="5946640">.</span><span class="ident" id="5946641">Elem</span><span class="op" id="5946645">(</span><span class="op" id="5946646">)</span><span class="op" id="5946647">.</span><span class="ident" id="5946648">Kind</span><span class="op" id="5946652">(</span><span class="op" id="5946653">)</span>&nbsp;<span class="op" id="5946655">!=</span>&nbsp;<span class="ident" id="5946658"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5946665">.</span><span class="ident" id="5946666">Uint8</span>&nbsp;<span class="op" id="5946672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946678"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5946682">.</span><span class="ident" id="5946683">wire</span>&nbsp;<span class="op" id="5946688">=</span>&nbsp;<span class="op" id="5946690">&amp;</span><span class="ident" id="5946691"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5946699">{</span><span class="ident" id="5946700">SliceT</span><span class="op" id="5946706">:</span>&nbsp;<span class="ident" id="5946708"><a href="/encoding/gob/type.go.html#5946356">t</a></span><span class="op" id="5946709">.</span><span class="op" id="5946710">(</span><span class="op" id="5946711">*</span><span class="ident" id="5946712"><a href="/encoding/gob/type.go.html#5936040">sliceType</a></span><span class="op" id="5946721">)</span><span class="op" id="5946722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5946727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946731">case</span>&nbsp;<span class="ident" id="5946736"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5946743">.</span><span class="ident" id="5946744">Struct</span><span class="op" id="5946750">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946755"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5946759">.</span><span class="ident" id="5946760">wire</span>&nbsp;<span class="op" id="5946765">=</span>&nbsp;<span class="op" id="5946767">&amp;</span><span class="ident" id="5946768"><a href="/encoding/gob/type.go.html#5943888">wireType</a></span><span class="op" id="5946776">{</span><span class="ident" id="5946777">StructT</span><span class="op" id="5946784">:</span>&nbsp;<span class="ident" id="5946786"><a href="/encoding/gob/type.go.html#5946356">t</a></span><span class="op" id="5946787">.</span><span class="op" id="5946788">(</span><span class="op" id="5946789">*</span><span class="ident" id="5946790"><a href="/encoding/gob/type.go.html#5936823">structType</a></span><span class="op" id="5946800">)</span><span class="op" id="5946801">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5946805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5946808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5946812">//&nbsp;Create&nbsp;new&nbsp;map&nbsp;with&nbsp;old&nbsp;contents&nbsp;plus&nbsp;new&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946865">newm</span>&nbsp;<span class="op" id="5946870">:=</span>&nbsp;<span class="builtinfunc" id="5946873">make</span><span class="op" id="5946877">(</span><span class="keyword" id="5946878">map</span><span class="op" id="5946881">[</span><span class="ident" id="5946882"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5946889">.</span><span class="ident" id="5946890">Type</span><span class="op" id="5946894">]</span><span class="op" id="5946895">*</span><span class="ident" id="5946896"><a href="/encoding/gob/type.go.html#5944633">typeInfo</a></span><span class="op" id="5946904">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946907">m</span><span class="op" id="5946908">,</span>&nbsp;<span class="ident" id="5946910">_</span>&nbsp;<span class="op" id="5946912">:=</span>&nbsp;<span class="ident" id="5946915"><a href="/encoding/gob/type.go.html#5945149">typeInfoMap</a></span><span class="op" id="5946926">.</span><span class="ident" id="5946927">Load</span><span class="op" id="5946931">(</span><span class="op" id="5946932">)</span><span class="op" id="5946933">.</span><span class="op" id="5946934">(</span><span class="keyword" id="5946935">map</span><span class="op" id="5946938">[</span><span class="ident" id="5946939"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5946946">.</span><span class="ident" id="5946947">Type</span><span class="op" id="5946951">]</span><span class="op" id="5946952">*</span><span class="ident" id="5946953"><a href="/encoding/gob/type.go.html#5944633">typeInfo</a></span><span class="op" id="5946961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5946964">for</span>&nbsp;<span class="ident" id="5946968">k</span><span class="op" id="5946969">,</span>&nbsp;<span class="ident" id="5946971">v</span>&nbsp;<span class="op" id="5946973">:=</span>&nbsp;<span class="keyword" id="5946976">range</span>&nbsp;<span class="ident" id="5946982"><a href="/encoding/gob/type.go.html#5946907">m</a></span>&nbsp;<span class="op" id="5946984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946988"><a href="/encoding/gob/type.go.html#5946865">newm</a></span><span class="op" id="5946992">[</span><span class="ident" id="5946993"><a href="/encoding/gob/type.go.html#5946968">k</a></span><span class="op" id="5946994">]</span>&nbsp;<span class="op" id="5946996">=</span>&nbsp;<span class="ident" id="5946998"><a href="/encoding/gob/type.go.html#5946971">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5947001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947004"><a href="/encoding/gob/type.go.html#5946865">newm</a></span><span class="op" id="5947008">[</span><span class="ident" id="5947009"><a href="/encoding/gob/type.go.html#5945699">rt</a></span><span class="op" id="5947011">]</span>&nbsp;<span class="op" id="5947013">=</span>&nbsp;<span class="ident" id="5947015"><a href="/encoding/gob/type.go.html#5945927">info</a></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947021"><a href="/encoding/gob/type.go.html#5945149">typeInfoMap</a></span><span class="op" id="5947032">.</span><span class="ident" id="5947033">Store</span><span class="op" id="5947038">(</span><span class="ident" id="5947039"><a href="/encoding/gob/type.go.html#5946865">newm</a></span><span class="op" id="5947043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947046">return</span>&nbsp;<span class="ident" id="5947053"><a href="/encoding/gob/type.go.html#5945927">info</a></span><span class="op" id="5947057">,</span>&nbsp;<span class="ident" id="5947059">nil</span><br>
<span class="lineno"></span><span class="op" id="5947063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5947066">//&nbsp;Called&nbsp;only&nbsp;when&nbsp;a&nbsp;panic&nbsp;is&nbsp;acceptable&nbsp;and&nbsp;unexpected.</span><br>
<span class="lineno">775</span><span class="keyword" id="5947124">func</span>&nbsp;<span class="ident" id="5947129">mustGetTypeInfo</span><span class="op" id="5947144">(</span><span class="ident" id="5947145">rt</span>&nbsp;<span class="ident" id="5947148"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5947155">.</span><span class="ident" id="5947156">Type</span><span class="op" id="5947160">)</span>&nbsp;<span class="op" id="5947162">*</span><span class="ident" id="5947163"><a href="/encoding/gob/type.go.html#5944633">typeInfo</a></span>&nbsp;<span class="op" id="5947172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947175">t</span><span class="op" id="5947176">,</span>&nbsp;<span class="ident" id="5947178">err</span>&nbsp;<span class="op" id="5947182">:=</span>&nbsp;<span class="ident" id="5947185"><a href="/encoding/gob/type.go.html#5945303">getTypeInfo</a></span><span class="op" id="5947196">(</span><span class="ident" id="5947197"><a href="/encoding/gob/type.go.html#5929943">userType</a></span><span class="op" id="5947205">(</span><span class="ident" id="5947206"><a href="/encoding/gob/type.go.html#5947145">rt</a></span><span class="op" id="5947208">)</span><span class="op" id="5947209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947212">if</span>&nbsp;<span class="ident" id="5947215"><a href="/encoding/gob/type.go.html#5947178">err</a></span>&nbsp;<span class="op" id="5947219">!=</span>&nbsp;<span class="ident" id="5947222">nil</span>&nbsp;<span class="op" id="5947226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5947230">panic</span><span class="op" id="5947235">(</span><span class="string" id="5947236">&#34;getTypeInfo:&nbsp;&#34;</span>&nbsp;<span class="op" id="5947252">+</span>&nbsp;<span class="ident" id="5947254"><a href="/encoding/gob/type.go.html#5947178">err</a></span><span class="op" id="5947257">.</span><span class="ident" id="5947258">Error</span><span class="op" id="5947263">(</span><span class="op" id="5947264">)</span><span class="op" id="5947265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5947268">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947271">return</span>&nbsp;<span class="ident" id="5947278"><a href="/encoding/gob/type.go.html#5947175">t</a></span><br>
<span class="lineno"></span><span class="op" id="5947280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5947283">//&nbsp;GobEncoder&nbsp;is&nbsp;the&nbsp;interface&nbsp;describing&nbsp;data&nbsp;that&nbsp;provides&nbsp;its&nbsp;own</span><br>
<span class="lineno"></span><span class="comment" id="5947352">//&nbsp;representation&nbsp;for&nbsp;encoding&nbsp;values&nbsp;for&nbsp;transmission&nbsp;to&nbsp;a&nbsp;GobDecoder.</span><br>
<span class="lineno">785</span><span class="comment" id="5947424">//&nbsp;A&nbsp;type&nbsp;that&nbsp;implements&nbsp;GobEncoder&nbsp;and&nbsp;GobDecoder&nbsp;has&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="5947489">//&nbsp;control&nbsp;over&nbsp;the&nbsp;representation&nbsp;of&nbsp;its&nbsp;data&nbsp;and&nbsp;may&nbsp;therefore</span><br>
<span class="lineno"></span><span class="comment" id="5947554">//&nbsp;contain&nbsp;things&nbsp;such&nbsp;as&nbsp;private&nbsp;fields,&nbsp;channels,&nbsp;and&nbsp;functions,</span><br>
<span class="lineno"></span><span class="comment" id="5947621">//&nbsp;which&nbsp;are&nbsp;not&nbsp;usually&nbsp;transmissible&nbsp;in&nbsp;gob&nbsp;streams.</span><br>
<span class="lineno"></span><span class="comment" id="5947676">//</span><br>
<span class="lineno">790</span><span class="comment" id="5947679">//&nbsp;Note:&nbsp;Since&nbsp;gobs&nbsp;can&nbsp;be&nbsp;stored&nbsp;permanently,&nbsp;It&nbsp;is&nbsp;good&nbsp;design</span><br>
<span class="lineno"></span><span class="comment" id="5947744">//&nbsp;to&nbsp;guarantee&nbsp;the&nbsp;encoding&nbsp;used&nbsp;by&nbsp;a&nbsp;GobEncoder&nbsp;is&nbsp;stable&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5947811">//&nbsp;software&nbsp;evolves.&nbsp;&nbsp;For&nbsp;instance,&nbsp;it&nbsp;might&nbsp;make&nbsp;sense&nbsp;for&nbsp;GobEncode</span><br>
<span class="lineno"></span><span class="comment" id="5947881">//&nbsp;to&nbsp;include&nbsp;a&nbsp;version&nbsp;number&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="5947929">type</span>&nbsp;<span class="ident" id="5947934">GobEncoder</span>&nbsp;<span class="keyword" id="5947945">interface</span>&nbsp;<span class="op" id="5947955">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5947958">//&nbsp;GobEncode&nbsp;returns&nbsp;a&nbsp;byte&nbsp;slice&nbsp;representing&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5948026">//&nbsp;receiver&nbsp;for&nbsp;transmission&nbsp;to&nbsp;a&nbsp;GobDecoder,&nbsp;usually&nbsp;of&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5948093">//&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5948112">GobEncode</span><span class="op" id="5948121">(</span><span class="op" id="5948122">)</span>&nbsp;<span class="op" id="5948124">(</span><span class="op" id="5948125">[</span><span class="op" id="5948126">]</span><span class="builtintype" id="5948127">byte</span><span class="op" id="5948131">,</span>&nbsp;<span class="builtintype" id="5948133">error</span><span class="op" id="5948138">)</span><br>
<span class="lineno"></span><span class="op" id="5948140">}</span><br>
<span class="lineno">800</span><br>
<span class="lineno"></span><span class="comment" id="5948143">//&nbsp;GobDecoder&nbsp;is&nbsp;the&nbsp;interface&nbsp;describing&nbsp;data&nbsp;that&nbsp;provides&nbsp;its&nbsp;own</span><br>
<span class="lineno"></span><span class="comment" id="5948212">//&nbsp;routine&nbsp;for&nbsp;decoding&nbsp;transmitted&nbsp;values&nbsp;sent&nbsp;by&nbsp;a&nbsp;GobEncoder.</span><br>
<span class="lineno"></span><span class="keyword" id="5948277">type</span>&nbsp;<span class="ident" id="5948282">GobDecoder</span>&nbsp;<span class="keyword" id="5948293">interface</span>&nbsp;<span class="op" id="5948303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5948306">//&nbsp;GobDecode&nbsp;overwrites&nbsp;the&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer,</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5948370">//&nbsp;with&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;the&nbsp;byte&nbsp;slice,&nbsp;which&nbsp;was&nbsp;written</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5948438">//&nbsp;by&nbsp;GobEncode,&nbsp;usually&nbsp;for&nbsp;the&nbsp;same&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5948492">GobDecode</span><span class="op" id="5948501">(</span><span class="op" id="5948502">[</span><span class="op" id="5948503">]</span><span class="builtintype" id="5948504">byte</span><span class="op" id="5948508">)</span>&nbsp;<span class="builtintype" id="5948510">error</span><br>
<span class="lineno"></span><span class="op" id="5948516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span><span class="keyword" id="5948519">var</span>&nbsp;<span class="op" id="5948523">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5948526">registerLock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5948545"><a href="/encoding/gob/type.go.html#5924806">sync</a></span><span class="op" id="5948549">.</span><span class="ident" id="5948550">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5948559">nameToConcreteType</span>&nbsp;<span class="op" id="5948578">=</span>&nbsp;<span class="builtinfunc" id="5948580">make</span><span class="op" id="5948584">(</span><span class="keyword" id="5948585">map</span><span class="op" id="5948588">[</span><span class="builtintype" id="5948589">string</span><span class="op" id="5948595">]</span><span class="ident" id="5948596"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5948603">.</span><span class="ident" id="5948604">Type</span><span class="op" id="5948608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5948611">concreteTypeToName</span>&nbsp;<span class="op" id="5948630">=</span>&nbsp;<span class="builtinfunc" id="5948632">make</span><span class="op" id="5948636">(</span><span class="keyword" id="5948637">map</span><span class="op" id="5948640">[</span><span class="ident" id="5948641"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5948648">.</span><span class="ident" id="5948649">Type</span><span class="op" id="5948653">]</span><span class="builtintype" id="5948654">string</span><span class="op" id="5948660">)</span><br>
<span class="lineno"></span><span class="op" id="5948662">)</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="comment" id="5948665">//&nbsp;RegisterName&nbsp;is&nbsp;like&nbsp;Register&nbsp;but&nbsp;uses&nbsp;the&nbsp;provided&nbsp;name&nbsp;rather&nbsp;than&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5948741">//&nbsp;type&#39;s&nbsp;default.</span><br>
<span class="lineno"></span><span class="keyword" id="5948760">func</span>&nbsp;<span class="ident" id="5948765">RegisterName</span><span class="op" id="5948777">(</span><span class="ident" id="5948778">name</span>&nbsp;<span class="builtintype" id="5948783">string</span><span class="op" id="5948789">,</span>&nbsp;<span class="ident" id="5948791">value</span>&nbsp;<span class="keyword" id="5948797">interface</span><span class="op" id="5948806">{</span><span class="op" id="5948807">}</span><span class="op" id="5948808">)</span>&nbsp;<span class="op" id="5948810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5948813">if</span>&nbsp;<span class="ident" id="5948816"><a href="/encoding/gob/type.go.html#5948778">name</a></span>&nbsp;<span class="op" id="5948821">==</span>&nbsp;<span class="string" id="5948824">&#34;&#34;</span>&nbsp;<span class="op" id="5948827">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5948831">//&nbsp;reserved&nbsp;for&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5948853">panic</span><span class="op" id="5948858">(</span><span class="string" id="5948859">&#34;attempt&nbsp;to&nbsp;register&nbsp;empty&nbsp;name&#34;</span><span class="op" id="5948891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5948894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5948897"><a href="/encoding/gob/type.go.html#5948526">registerLock</a></span><span class="op" id="5948909">.</span><span class="ident" id="5948910">Lock</span><span class="op" id="5948914">(</span><span class="op" id="5948915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5948918">defer</span>&nbsp;<span class="ident" id="5948924"><a href="/encoding/gob/type.go.html#5948526">registerLock</a></span><span class="op" id="5948936">.</span><span class="ident" id="5948937">Unlock</span><span class="op" id="5948943">(</span><span class="op" id="5948944">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5948947">ut</span>&nbsp;<span class="op" id="5948950">:=</span>&nbsp;<span class="ident" id="5948953"><a href="/encoding/gob/type.go.html#5929943">userType</a></span><span class="op" id="5948961">(</span><span class="ident" id="5948962"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5948969">.</span><span class="ident" id="5948970">TypeOf</span><span class="op" id="5948976">(</span><span class="ident" id="5948977"><a href="/encoding/gob/type.go.html#5948791">value</a></span><span class="op" id="5948982">)</span><span class="op" id="5948983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5948986">//&nbsp;Check&nbsp;for&nbsp;incompatible&nbsp;duplicates.&nbsp;The&nbsp;name&nbsp;must&nbsp;refer&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5949052">//&nbsp;same&nbsp;user&nbsp;type,&nbsp;and&nbsp;vice&nbsp;versa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5949088">if</span>&nbsp;<span class="ident" id="5949091">t</span><span class="op" id="5949092">,</span>&nbsp;<span class="ident" id="5949094">ok</span>&nbsp;<span class="op" id="5949097">:=</span>&nbsp;<span class="ident" id="5949100"><a href="/encoding/gob/type.go.html#5948559">nameToConcreteType</a></span><span class="op" id="5949118">[</span><span class="ident" id="5949119"><a href="/encoding/gob/type.go.html#5948778">name</a></span><span class="op" id="5949123">]</span><span class="op" id="5949124">;</span>&nbsp;<span class="ident" id="5949126"><a href="/encoding/gob/type.go.html#5949094">ok</a></span>&nbsp;<span class="op" id="5949129">&amp;&amp;</span>&nbsp;<span class="ident" id="5949132"><a href="/encoding/gob/type.go.html#5949091">t</a></span>&nbsp;<span class="op" id="5949134">!=</span>&nbsp;<span class="ident" id="5949137"><a href="/encoding/gob/type.go.html#5948947">ut</a></span><span class="op" id="5949139">.</span><span class="ident" id="5949140">user</span>&nbsp;<span class="op" id="5949145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5949149">panic</span><span class="op" id="5949154">(</span><span class="ident" id="5949155"><a href="/encoding/gob/type.go.html#5924782">fmt</a></span><span class="op" id="5949158">.</span><span class="ident" id="5949159">Sprintf</span><span class="op" id="5949166">(</span><span class="string" id="5949167">&#34;gob:&nbsp;registering&nbsp;duplicate&nbsp;types&nbsp;for&nbsp;%q:&nbsp;%s&nbsp;!=&nbsp;%s&#34;</span><span class="op" id="5949218">,</span>&nbsp;<span class="ident" id="5949220"><a href="/encoding/gob/type.go.html#5948778">name</a></span><span class="op" id="5949224">,</span>&nbsp;<span class="ident" id="5949226"><a href="/encoding/gob/type.go.html#5949091">t</a></span><span class="op" id="5949227">,</span>&nbsp;<span class="ident" id="5949229"><a href="/encoding/gob/type.go.html#5948947">ut</a></span><span class="op" id="5949231">.</span><span class="ident" id="5949232">user</span><span class="op" id="5949236">)</span><span class="op" id="5949237">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5949240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5949243">if</span>&nbsp;<span class="ident" id="5949246">n</span><span class="op" id="5949247">,</span>&nbsp;<span class="ident" id="5949249">ok</span>&nbsp;<span class="op" id="5949252">:=</span>&nbsp;<span class="ident" id="5949255"><a href="/encoding/gob/type.go.html#5948611">concreteTypeToName</a></span><span class="op" id="5949273">[</span><span class="ident" id="5949274"><a href="/encoding/gob/type.go.html#5948947">ut</a></span><span class="op" id="5949276">.</span><span class="ident" id="5949277">base</span><span class="op" id="5949281">]</span><span class="op" id="5949282">;</span>&nbsp;<span class="ident" id="5949284"><a href="/encoding/gob/type.go.html#5949249">ok</a></span>&nbsp;<span class="op" id="5949287">&amp;&amp;</span>&nbsp;<span class="ident" id="5949290"><a href="/encoding/gob/type.go.html#5949246">n</a></span>&nbsp;<span class="op" id="5949292">!=</span>&nbsp;<span class="ident" id="5949295"><a href="/encoding/gob/type.go.html#5948778">name</a></span>&nbsp;<span class="op" id="5949300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5949304">panic</span><span class="op" id="5949309">(</span><span class="ident" id="5949310"><a href="/encoding/gob/type.go.html#5924782">fmt</a></span><span class="op" id="5949313">.</span><span class="ident" id="5949314">Sprintf</span><span class="op" id="5949321">(</span><span class="string" id="5949322">&#34;gob:&nbsp;registering&nbsp;duplicate&nbsp;names&nbsp;for&nbsp;%s:&nbsp;%q&nbsp;!=&nbsp;%q&#34;</span><span class="op" id="5949373">,</span>&nbsp;<span class="ident" id="5949375"><a href="/encoding/gob/type.go.html#5948947">ut</a></span><span class="op" id="5949377">.</span><span class="ident" id="5949378">user</span><span class="op" id="5949382">,</span>&nbsp;<span class="ident" id="5949384"><a href="/encoding/gob/type.go.html#5949246">n</a></span><span class="op" id="5949385">,</span>&nbsp;<span class="ident" id="5949387"><a href="/encoding/gob/type.go.html#5948778">name</a></span><span class="op" id="5949391">)</span><span class="op" id="5949392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5949395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5949398">//&nbsp;Store&nbsp;the&nbsp;name&nbsp;and&nbsp;type&nbsp;provided&nbsp;by&nbsp;the&nbsp;user....</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5949451"><a href="/encoding/gob/type.go.html#5948559">nameToConcreteType</a></span><span class="op" id="5949469">[</span><span class="ident" id="5949470"><a href="/encoding/gob/type.go.html#5948778">name</a></span><span class="op" id="5949474">]</span>&nbsp;<span class="op" id="5949476">=</span>&nbsp;<span class="ident" id="5949478"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5949485">.</span><span class="ident" id="5949486">TypeOf</span><span class="op" id="5949492">(</span><span class="ident" id="5949493"><a href="/encoding/gob/type.go.html#5948791">value</a></span><span class="op" id="5949498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5949501">//&nbsp;but&nbsp;the&nbsp;flattened&nbsp;type&nbsp;in&nbsp;the&nbsp;type&nbsp;table,&nbsp;since&nbsp;that&#39;s&nbsp;what&nbsp;decode&nbsp;needs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5949579"><a href="/encoding/gob/type.go.html#5948611">concreteTypeToName</a></span><span class="op" id="5949597">[</span><span class="ident" id="5949598"><a href="/encoding/gob/type.go.html#5948947">ut</a></span><span class="op" id="5949600">.</span><span class="ident" id="5949601">base</span><span class="op" id="5949605">]</span>&nbsp;<span class="op" id="5949607">=</span>&nbsp;<span class="ident" id="5949609"><a href="/encoding/gob/type.go.html#5948778">name</a></span><br>
<span class="lineno"></span><span class="op" id="5949614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="5949617">//&nbsp;Register&nbsp;records&nbsp;a&nbsp;type,&nbsp;identified&nbsp;by&nbsp;a&nbsp;value&nbsp;for&nbsp;that&nbsp;type,&nbsp;under&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5949692">//&nbsp;internal&nbsp;type&nbsp;name.&nbsp;&nbsp;That&nbsp;name&nbsp;will&nbsp;identify&nbsp;the&nbsp;concrete&nbsp;type&nbsp;of&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5949769">//&nbsp;sent&nbsp;or&nbsp;received&nbsp;as&nbsp;an&nbsp;interface&nbsp;variable.&nbsp;&nbsp;Only&nbsp;types&nbsp;that&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5949840">//&nbsp;transferred&nbsp;as&nbsp;implementations&nbsp;of&nbsp;interface&nbsp;values&nbsp;need&nbsp;to&nbsp;be&nbsp;registered.</span><br>
<span class="lineno"></span><span class="comment" id="5949917">//&nbsp;Expecting&nbsp;to&nbsp;be&nbsp;used&nbsp;only&nbsp;during&nbsp;initialization,&nbsp;it&nbsp;panics&nbsp;if&nbsp;the&nbsp;mapping</span><br>
<span class="lineno">845</span><span class="comment" id="5949994">//&nbsp;between&nbsp;types&nbsp;and&nbsp;names&nbsp;is&nbsp;not&nbsp;a&nbsp;bijection.</span><br>
<span class="lineno"></span><span class="keyword" id="5950041">func</span>&nbsp;<span class="ident" id="5950046">Register</span><span class="op" id="5950054">(</span><span class="ident" id="5950055">value</span>&nbsp;<span class="keyword" id="5950061">interface</span><span class="op" id="5950070">{</span><span class="op" id="5950071">}</span><span class="op" id="5950072">)</span>&nbsp;<span class="op" id="5950074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950077">//&nbsp;Default&nbsp;to&nbsp;printed&nbsp;representation&nbsp;for&nbsp;unnamed&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5950133">rt</span>&nbsp;<span class="op" id="5950136">:=</span>&nbsp;<span class="ident" id="5950139"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5950146">.</span><span class="ident" id="5950147">TypeOf</span><span class="op" id="5950153">(</span><span class="ident" id="5950154"><a href="/encoding/gob/type.go.html#5950055">value</a></span><span class="op" id="5950159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5950162">name</span>&nbsp;<span class="op" id="5950167">:=</span>&nbsp;<span class="ident" id="5950170"><a href="/encoding/gob/type.go.html#5950133">rt</a></span><span class="op" id="5950172">.</span><span class="ident" id="5950173">String</span><span class="op" id="5950179">(</span><span class="op" id="5950180">)</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950184">//&nbsp;But&nbsp;for&nbsp;named&nbsp;types&nbsp;(or&nbsp;pointers&nbsp;to&nbsp;them),&nbsp;qualify&nbsp;with&nbsp;import&nbsp;path&nbsp;(but&nbsp;see&nbsp;inner&nbsp;comment).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950281">//&nbsp;Dereference&nbsp;one&nbsp;pointer&nbsp;looking&nbsp;for&nbsp;a&nbsp;named&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5950335">star</span>&nbsp;<span class="op" id="5950340">:=</span>&nbsp;<span class="string" id="5950343">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5950347">if</span>&nbsp;<span class="ident" id="5950350"><a href="/encoding/gob/type.go.html#5950133">rt</a></span><span class="op" id="5950352">.</span><span class="ident" id="5950353">Name</span><span class="op" id="5950357">(</span><span class="op" id="5950358">)</span>&nbsp;<span class="op" id="5950360">==</span>&nbsp;<span class="string" id="5950363">&#34;&#34;</span>&nbsp;<span class="op" id="5950366">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5950370">if</span>&nbsp;<span class="ident" id="5950373">pt</span>&nbsp;<span class="op" id="5950376">:=</span>&nbsp;<span class="ident" id="5950379"><a href="/encoding/gob/type.go.html#5950133">rt</a></span><span class="op" id="5950381">;</span>&nbsp;<span class="ident" id="5950383"><a href="/encoding/gob/type.go.html#5950373">pt</a></span><span class="op" id="5950385">.</span><span class="ident" id="5950386">Kind</span><span class="op" id="5950390">(</span><span class="op" id="5950391">)</span>&nbsp;<span class="op" id="5950393">==</span>&nbsp;<span class="ident" id="5950396"><a href="/encoding/gob/type.go.html#5924795">reflect</a></span><span class="op" id="5950403">.</span><span class="ident" id="5950404">Ptr</span>&nbsp;<span class="op" id="5950408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5950413"><a href="/encoding/gob/type.go.html#5950335">star</a></span>&nbsp;<span class="op" id="5950418">=</span>&nbsp;<span class="string" id="5950420">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950427">//&nbsp;NOTE:&nbsp;The&nbsp;following&nbsp;line&nbsp;should&nbsp;be&nbsp;rt&nbsp;=&nbsp;pt.Elem()&nbsp;to&nbsp;implement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950496">//&nbsp;what&nbsp;the&nbsp;comment&nbsp;above&nbsp;claims,&nbsp;but&nbsp;fixing&nbsp;it&nbsp;would&nbsp;break&nbsp;compatibility</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950573">//&nbsp;with&nbsp;existing&nbsp;gobs.</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950599">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950605">//&nbsp;Given&nbsp;package&nbsp;p&nbsp;imported&nbsp;as&nbsp;&#34;full/p&#34;&nbsp;with&nbsp;these&nbsp;definitions:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950672">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950692">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;T1&nbsp;struct&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950725">//&nbsp;this&nbsp;table&nbsp;shows&nbsp;the&nbsp;intended&nbsp;and&nbsp;actual&nbsp;strings&nbsp;used&nbsp;by&nbsp;gob&nbsp;to</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950795">//&nbsp;name&nbsp;the&nbsp;types:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950817">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950823">//&nbsp;Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Correct&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Actual&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950872">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950878">//&nbsp;T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full/p.T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full/p.T1</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950923">//&nbsp;*T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*full/p.T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*p.T1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950964">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5950970">//&nbsp;The&nbsp;missing&nbsp;full&nbsp;path&nbsp;cannot&nbsp;be&nbsp;fixed&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;gob&nbsp;decoders.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951054"><a href="/encoding/gob/type.go.html#5950133">rt</a></span>&nbsp;<span class="op" id="5951057">=</span>&nbsp;<span class="ident" id="5951059"><a href="/encoding/gob/type.go.html#5950373">pt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5951064">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5951067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5951070">if</span>&nbsp;<span class="ident" id="5951073"><a href="/encoding/gob/type.go.html#5950133">rt</a></span><span class="op" id="5951075">.</span><span class="ident" id="5951076">Name</span><span class="op" id="5951080">(</span><span class="op" id="5951081">)</span>&nbsp;<span class="op" id="5951083">!=</span>&nbsp;<span class="string" id="5951086">&#34;&#34;</span>&nbsp;<span class="op" id="5951089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5951093">if</span>&nbsp;<span class="ident" id="5951096"><a href="/encoding/gob/type.go.html#5950133">rt</a></span><span class="op" id="5951098">.</span><span class="ident" id="5951099">PkgPath</span><span class="op" id="5951106">(</span><span class="op" id="5951107">)</span>&nbsp;<span class="op" id="5951109">==</span>&nbsp;<span class="string" id="5951112">&#34;&#34;</span>&nbsp;<span class="op" id="5951115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951120"><a href="/encoding/gob/type.go.html#5950162">name</a></span>&nbsp;<span class="op" id="5951125">=</span>&nbsp;<span class="ident" id="5951127"><a href="/encoding/gob/type.go.html#5950335">star</a></span>&nbsp;<span class="op" id="5951132">+</span>&nbsp;<span class="ident" id="5951134"><a href="/encoding/gob/type.go.html#5950133">rt</a></span><span class="op" id="5951136">.</span><span class="ident" id="5951137">Name</span><span class="op" id="5951141">(</span><span class="op" id="5951142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5951146">}</span>&nbsp;<span class="keyword" id="5951148">else</span>&nbsp;<span class="op" id="5951153">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951158"><a href="/encoding/gob/type.go.html#5950162">name</a></span>&nbsp;<span class="op" id="5951163">=</span>&nbsp;<span class="ident" id="5951165"><a href="/encoding/gob/type.go.html#5950335">star</a></span>&nbsp;<span class="op" id="5951170">+</span>&nbsp;<span class="ident" id="5951172"><a href="/encoding/gob/type.go.html#5950133">rt</a></span><span class="op" id="5951174">.</span><span class="ident" id="5951175">PkgPath</span><span class="op" id="5951182">(</span><span class="op" id="5951183">)</span>&nbsp;<span class="op" id="5951185">+</span>&nbsp;<span class="string" id="5951187">&#34;.&#34;</span>&nbsp;<span class="op" id="5951191">+</span>&nbsp;<span class="ident" id="5951193"><a href="/encoding/gob/type.go.html#5950133">rt</a></span><span class="op" id="5951195">.</span><span class="ident" id="5951196">Name</span><span class="op" id="5951200">(</span><span class="op" id="5951201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5951205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5951208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951212"><a href="/encoding/gob/type.go.html#5948765">RegisterName</a></span><span class="op" id="5951224">(</span><span class="ident" id="5951225"><a href="/encoding/gob/type.go.html#5950162">name</a></span><span class="op" id="5951229">,</span>&nbsp;<span class="ident" id="5951231"><a href="/encoding/gob/type.go.html#5950055">value</a></span><span class="op" id="5951236">)</span><br>
<span class="lineno">885</span><span class="op" id="5951238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5951241">func</span>&nbsp;<span class="ident" id="5951246">registerBasics</span><span class="op" id="5951260">(</span><span class="op" id="5951261">)</span>&nbsp;<span class="op" id="5951263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951266"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951274">(</span><span class="builtintype" id="5951275">int</span><span class="op" id="5951278">(</span><span class="num" id="5951279">0</span><span class="op" id="5951280">)</span><span class="op" id="5951281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951284"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951292">(</span><span class="builtintype" id="5951293">int8</span><span class="op" id="5951297">(</span><span class="num" id="5951298">0</span><span class="op" id="5951299">)</span><span class="op" id="5951300">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951303"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951311">(</span><span class="builtintype" id="5951312">int16</span><span class="op" id="5951317">(</span><span class="num" id="5951318">0</span><span class="op" id="5951319">)</span><span class="op" id="5951320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951323"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951331">(</span><span class="builtintype" id="5951332">int32</span><span class="op" id="5951337">(</span><span class="num" id="5951338">0</span><span class="op" id="5951339">)</span><span class="op" id="5951340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951343"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951351">(</span><span class="ident" id="5951352">int64</span><span class="op" id="5951357">(</span><span class="num" id="5951358">0</span><span class="op" id="5951359">)</span><span class="op" id="5951360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951363"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951371">(</span><span class="builtintype" id="5951372">uint</span><span class="op" id="5951376">(</span><span class="num" id="5951377">0</span><span class="op" id="5951378">)</span><span class="op" id="5951379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951382"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951390">(</span><span class="builtintype" id="5951391">uint8</span><span class="op" id="5951396">(</span><span class="num" id="5951397">0</span><span class="op" id="5951398">)</span><span class="op" id="5951399">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951402"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951410">(</span><span class="builtintype" id="5951411">uint16</span><span class="op" id="5951417">(</span><span class="num" id="5951418">0</span><span class="op" id="5951419">)</span><span class="op" id="5951420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951423"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951431">(</span><span class="builtintype" id="5951432">uint32</span><span class="op" id="5951438">(</span><span class="num" id="5951439">0</span><span class="op" id="5951440">)</span><span class="op" id="5951441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951444"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951452">(</span><span class="ident" id="5951453">uint64</span><span class="op" id="5951459">(</span><span class="num" id="5951460">0</span><span class="op" id="5951461">)</span><span class="op" id="5951462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951465"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951473">(</span><span class="builtintype" id="5951474">float32</span><span class="op" id="5951481">(</span><span class="num" id="5951482">0</span><span class="op" id="5951483">)</span><span class="op" id="5951484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951487"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951495">(</span><span class="builtintype" id="5951496">float64</span><span class="op" id="5951503">(</span><span class="num" id="5951504">0</span><span class="op" id="5951505">)</span><span class="op" id="5951506">)</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951509"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951517">(</span><span class="builtintype" id="5951518">complex64</span><span class="op" id="5951527">(</span><span class="num" id="5951528">0i</span><span class="op" id="5951530">)</span><span class="op" id="5951531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951534"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951542">(</span><span class="builtintype" id="5951543">complex128</span><span class="op" id="5951553">(</span><span class="num" id="5951554">0i</span><span class="op" id="5951556">)</span><span class="op" id="5951557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951560"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951568">(</span><span class="builtintype" id="5951569">uintptr</span><span class="op" id="5951576">(</span><span class="num" id="5951577">0</span><span class="op" id="5951578">)</span><span class="op" id="5951579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951582"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951590">(</span><span class="builtintype" id="5951591">false</span><span class="op" id="5951596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951599"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951607">(</span><span class="string" id="5951608">&#34;&#34;</span><span class="op" id="5951610">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951613"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951621">(</span><span class="op" id="5951622">[</span><span class="op" id="5951623">]</span><span class="builtintype" id="5951624">byte</span><span class="op" id="5951628">(</span><span class="ident" id="5951629">nil</span><span class="op" id="5951632">)</span><span class="op" id="5951633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951636"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951644">(</span><span class="op" id="5951645">[</span><span class="op" id="5951646">]</span><span class="builtintype" id="5951647">int</span><span class="op" id="5951650">(</span><span class="ident" id="5951651">nil</span><span class="op" id="5951654">)</span><span class="op" id="5951655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951658"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951666">(</span><span class="op" id="5951667">[</span><span class="op" id="5951668">]</span><span class="builtintype" id="5951669">int8</span><span class="op" id="5951673">(</span><span class="ident" id="5951674">nil</span><span class="op" id="5951677">)</span><span class="op" id="5951678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951681"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951689">(</span><span class="op" id="5951690">[</span><span class="op" id="5951691">]</span><span class="builtintype" id="5951692">int16</span><span class="op" id="5951697">(</span><span class="ident" id="5951698">nil</span><span class="op" id="5951701">)</span><span class="op" id="5951702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951705"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951713">(</span><span class="op" id="5951714">[</span><span class="op" id="5951715">]</span><span class="builtintype" id="5951716">int32</span><span class="op" id="5951721">(</span><span class="ident" id="5951722">nil</span><span class="op" id="5951725">)</span><span class="op" id="5951726">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951729"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951737">(</span><span class="op" id="5951738">[</span><span class="op" id="5951739">]</span><span class="ident" id="5951740">int64</span><span class="op" id="5951745">(</span><span class="ident" id="5951746">nil</span><span class="op" id="5951749">)</span><span class="op" id="5951750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951753"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951761">(</span><span class="op" id="5951762">[</span><span class="op" id="5951763">]</span><span class="builtintype" id="5951764">uint</span><span class="op" id="5951768">(</span><span class="ident" id="5951769">nil</span><span class="op" id="5951772">)</span><span class="op" id="5951773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951776"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951784">(</span><span class="op" id="5951785">[</span><span class="op" id="5951786">]</span><span class="builtintype" id="5951787">uint8</span><span class="op" id="5951792">(</span><span class="ident" id="5951793">nil</span><span class="op" id="5951796">)</span><span class="op" id="5951797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951800"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951808">(</span><span class="op" id="5951809">[</span><span class="op" id="5951810">]</span><span class="builtintype" id="5951811">uint16</span><span class="op" id="5951817">(</span><span class="ident" id="5951818">nil</span><span class="op" id="5951821">)</span><span class="op" id="5951822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951825"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951833">(</span><span class="op" id="5951834">[</span><span class="op" id="5951835">]</span><span class="builtintype" id="5951836">uint32</span><span class="op" id="5951842">(</span><span class="ident" id="5951843">nil</span><span class="op" id="5951846">)</span><span class="op" id="5951847">)</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951850"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951858">(</span><span class="op" id="5951859">[</span><span class="op" id="5951860">]</span><span class="ident" id="5951861">uint64</span><span class="op" id="5951867">(</span><span class="ident" id="5951868">nil</span><span class="op" id="5951871">)</span><span class="op" id="5951872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951875"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951883">(</span><span class="op" id="5951884">[</span><span class="op" id="5951885">]</span><span class="builtintype" id="5951886">float32</span><span class="op" id="5951893">(</span><span class="ident" id="5951894">nil</span><span class="op" id="5951897">)</span><span class="op" id="5951898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951901"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951909">(</span><span class="op" id="5951910">[</span><span class="op" id="5951911">]</span><span class="builtintype" id="5951912">float64</span><span class="op" id="5951919">(</span><span class="ident" id="5951920">nil</span><span class="op" id="5951923">)</span><span class="op" id="5951924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951927"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951935">(</span><span class="op" id="5951936">[</span><span class="op" id="5951937">]</span><span class="builtintype" id="5951938">complex64</span><span class="op" id="5951947">(</span><span class="ident" id="5951948">nil</span><span class="op" id="5951951">)</span><span class="op" id="5951952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951955"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951963">(</span><span class="op" id="5951964">[</span><span class="op" id="5951965">]</span><span class="builtintype" id="5951966">complex128</span><span class="op" id="5951976">(</span><span class="ident" id="5951977">nil</span><span class="op" id="5951980">)</span><span class="op" id="5951981">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5951984"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5951992">(</span><span class="op" id="5951993">[</span><span class="op" id="5951994">]</span><span class="builtintype" id="5951995">uintptr</span><span class="op" id="5952002">(</span><span class="ident" id="5952003">nil</span><span class="op" id="5952006">)</span><span class="op" id="5952007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5952010"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5952018">(</span><span class="op" id="5952019">[</span><span class="op" id="5952020">]</span><span class="builtintype" id="5952021">bool</span><span class="op" id="5952025">(</span><span class="ident" id="5952026">nil</span><span class="op" id="5952029">)</span><span class="op" id="5952030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5952033"><a href="/encoding/gob/type.go.html#5950046">Register</a></span><span class="op" id="5952041">(</span><span class="op" id="5952042">[</span><span class="op" id="5952043">]</span><span class="builtintype" id="5952044">string</span><span class="op" id="5952050">(</span><span class="ident" id="5952051">nil</span><span class="op" id="5952054">)</span><span class="op" id="5952055">)</span><br>
<span class="lineno"></span><span class="op" id="5952057">}</span>
</div>
</body>
</html>
