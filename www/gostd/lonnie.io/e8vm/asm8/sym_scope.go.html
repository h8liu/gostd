<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4891190">package</span>&nbsp;<span class="ident" id="4891198">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4891204">//&nbsp;SymScope&nbsp;is&nbsp;a&nbsp;stack&nbsp;of&nbsp;symbol&nbsp;tables.</span><br>
<span class="lineno"></span><span class="keyword" id="4891245">type</span>&nbsp;<span class="ident" id="4891250">symScope</span>&nbsp;<span class="keyword" id="4891259">struct</span>&nbsp;<span class="op" id="4891266">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891269">stack</span>&nbsp;<span class="op" id="4891275">[</span><span class="op" id="4891276">]</span><span class="op" id="4891277">*</span><span class="ident" id="4891278">symTabel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891288">top</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4891294">*</span><span class="ident" id="4891295">symTabel</span>&nbsp;<span class="comment" id="4891304">//&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="op" id="4891315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4891318">//&nbsp;NewSymScope&nbsp;creates&nbsp;a&nbsp;new&nbsp;symbole&nbsp;scope&nbsp;with&nbsp;one&nbsp;symbol&nbsp;table&nbsp;at&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="4891390">//&nbsp;bottom.</span><br>
<span class="lineno"></span><span class="keyword" id="4891401">func</span>&nbsp;<span class="ident" id="4891406">newSymScope</span><span class="op" id="4891417">(</span><span class="op" id="4891418">)</span>&nbsp;<span class="op" id="4891420">*</span><span class="ident" id="4891421">symScope</span>&nbsp;<span class="op" id="4891430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891433">ret</span>&nbsp;<span class="op" id="4891437">:=</span>&nbsp;<span class="builtinfunc" id="4891440">new</span><span class="op" id="4891443">(</span><span class="ident" id="4891444">symScope</span><span class="op" id="4891452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891455">ret</span><span class="op" id="4891458">.</span><span class="ident" id="4891459">Push</span><span class="op" id="4891463">(</span><span class="op" id="4891464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891468">return</span>&nbsp;<span class="ident" id="4891475">ret</span><br>
<span class="lineno"></span><span class="op" id="4891479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4891482">//&nbsp;Push&nbsp;adds&nbsp;a&nbsp;new&nbsp;symbol&nbsp;table&nbsp;on&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="4891539">func</span>&nbsp;<span class="op" id="4891544">(</span><span class="ident" id="4891545">s</span>&nbsp;<span class="op" id="4891547">*</span><span class="ident" id="4891548">symScope</span><span class="op" id="4891556">)</span>&nbsp;<span class="ident" id="4891558">Push</span><span class="op" id="4891562">(</span><span class="op" id="4891563">)</span>&nbsp;<span class="op" id="4891565">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891568">tab</span>&nbsp;<span class="op" id="4891572">:=</span>&nbsp;<span class="ident" id="4891575">newSymTable</span><span class="op" id="4891586">(</span><span class="op" id="4891587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891590">s</span><span class="op" id="4891591">.</span><span class="ident" id="4891592">top</span>&nbsp;<span class="op" id="4891596">=</span>&nbsp;<span class="ident" id="4891598">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891603">s</span><span class="op" id="4891604">.</span><span class="ident" id="4891605">stack</span>&nbsp;<span class="op" id="4891611">=</span>&nbsp;<span class="builtinfunc" id="4891613">append</span><span class="op" id="4891619">(</span><span class="ident" id="4891620">s</span><span class="op" id="4891621">.</span><span class="ident" id="4891622">stack</span><span class="op" id="4891627">,</span>&nbsp;<span class="ident" id="4891629">tab</span><span class="op" id="4891632">)</span><br>
<span class="lineno"></span><span class="op" id="4891634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4891637">//&nbsp;Pop&nbsp;removes&nbsp;a&nbsp;symbol&nbsp;table&nbsp;from&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="4891694">//&nbsp;It&nbsp;panics&nbsp;when&nbsp;the&nbsp;stack&nbsp;is&nbsp;empty&nbsp;after&nbsp;the&nbsp;pop.</span><br>
<span class="lineno"></span><span class="keyword" id="4891746">func</span>&nbsp;<span class="op" id="4891751">(</span><span class="ident" id="4891752">s</span>&nbsp;<span class="op" id="4891754">*</span><span class="ident" id="4891755">symScope</span><span class="op" id="4891763">)</span>&nbsp;<span class="ident" id="4891765">Pop</span><span class="op" id="4891768">(</span><span class="op" id="4891769">)</span>&nbsp;<span class="op" id="4891771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891774">n</span>&nbsp;<span class="op" id="4891776">:=</span>&nbsp;<span class="builtinfunc" id="4891779">len</span><span class="op" id="4891782">(</span><span class="ident" id="4891783">s</span><span class="op" id="4891784">.</span><span class="ident" id="4891785">stack</span><span class="op" id="4891790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891793">if</span>&nbsp;<span class="ident" id="4891796">n</span>&nbsp;<span class="op" id="4891798">&lt;</span>&nbsp;<span class="num" id="4891800">2</span>&nbsp;<span class="op" id="4891802">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4891806">panic</span><span class="op" id="4891811">(</span><span class="string" id="4891812">&#34;stack&nbsp;empty&nbsp;after&nbsp;pop&#34;</span><span class="op" id="4891835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4891838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891842">s</span><span class="op" id="4891843">.</span><span class="ident" id="4891844">stack</span>&nbsp;<span class="op" id="4891850">=</span>&nbsp;<span class="ident" id="4891852">s</span><span class="op" id="4891853">.</span><span class="ident" id="4891854">stack</span><span class="op" id="4891859">[</span><span class="op" id="4891860">:</span><span class="ident" id="4891861">n</span><span class="op" id="4891862">-</span><span class="num" id="4891863">1</span><span class="op" id="4891864">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4891867">s</span><span class="op" id="4891868">.</span><span class="ident" id="4891869">top</span>&nbsp;<span class="op" id="4891873">=</span>&nbsp;<span class="ident" id="4891875">s</span><span class="op" id="4891876">.</span><span class="ident" id="4891877">stack</span><span class="op" id="4891882">[</span><span class="ident" id="4891883">n</span><span class="op" id="4891884">-</span><span class="num" id="4891885">2</span><span class="op" id="4891886">]</span><br>
<span class="lineno">35</span><span class="op" id="4891888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4891891">//&nbsp;Depth&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;scopes&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="4891943">func</span>&nbsp;<span class="op" id="4891948">(</span><span class="ident" id="4891949">s</span>&nbsp;<span class="op" id="4891951">*</span><span class="ident" id="4891952">symScope</span><span class="op" id="4891960">)</span>&nbsp;<span class="ident" id="4891962">Depth</span><span class="op" id="4891967">(</span><span class="op" id="4891968">)</span>&nbsp;<span class="builtintype" id="4891970">int</span>&nbsp;<span class="op" id="4891974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4891977">return</span>&nbsp;<span class="builtinfunc" id="4891984">len</span><span class="op" id="4891987">(</span><span class="ident" id="4891988">s</span><span class="op" id="4891989">.</span><span class="ident" id="4891990">stack</span><span class="op" id="4891995">)</span><br>
<span class="lineno">40</span><span class="op" id="4891997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4892000">//&nbsp;Query&nbsp;searches&nbsp;for&nbsp;the&nbsp;top&nbsp;visible&nbsp;symbol&nbsp;with&nbsp;a&nbsp;particular&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4892069">func</span>&nbsp;<span class="op" id="4892074">(</span><span class="ident" id="4892075">s</span>&nbsp;<span class="op" id="4892077">*</span><span class="ident" id="4892078">symScope</span><span class="op" id="4892086">)</span>&nbsp;<span class="ident" id="4892088">Query</span><span class="op" id="4892093">(</span><span class="ident" id="4892094">n</span>&nbsp;<span class="builtintype" id="4892096">string</span><span class="op" id="4892102">)</span>&nbsp;<span class="op" id="4892104">*</span><span class="ident" id="4892105">symbol</span>&nbsp;<span class="op" id="4892112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892115">d</span>&nbsp;<span class="op" id="4892117">:=</span>&nbsp;<span class="builtinfunc" id="4892120">len</span><span class="op" id="4892123">(</span><span class="ident" id="4892124">s</span><span class="op" id="4892125">.</span><span class="ident" id="4892126">stack</span><span class="op" id="4892131">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892135">for</span>&nbsp;<span class="ident" id="4892139">i</span>&nbsp;<span class="op" id="4892141">:=</span>&nbsp;<span class="ident" id="4892144">d</span>&nbsp;<span class="op" id="4892146">-</span>&nbsp;<span class="num" id="4892148">1</span><span class="op" id="4892149">;</span>&nbsp;<span class="ident" id="4892151">i</span>&nbsp;<span class="op" id="4892153">&gt;=</span>&nbsp;<span class="num" id="4892156">0</span><span class="op" id="4892157">;</span>&nbsp;<span class="ident" id="4892159">i</span><span class="op" id="4892160">--</span>&nbsp;<span class="op" id="4892163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892167">tab</span>&nbsp;<span class="op" id="4892171">:=</span>&nbsp;<span class="ident" id="4892174">s</span><span class="op" id="4892175">.</span><span class="ident" id="4892176">stack</span><span class="op" id="4892181">[</span><span class="ident" id="4892182">i</span><span class="op" id="4892183">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4892187">ret</span>&nbsp;<span class="op" id="4892191">:=</span>&nbsp;<span class="ident" id="4892194">tab</span><span class="op" id="4892197">.</span><span class="ident" id="4892198">Query</span><span class="op" id="4892203">(</span><span class="ident" id="4892204">n</span><span class="op" id="4892205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892209">if</span>&nbsp;<span class="ident" id="4892212">ret</span>&nbsp;<span class="op" id="4892216">!=</span>&nbsp;<span class="ident" id="4892219">nil</span>&nbsp;<span class="op" id="4892223">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892228">return</span>&nbsp;<span class="ident" id="4892235">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4892241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4892244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892248">return</span>&nbsp;<span class="ident" id="4892255">nil</span><br>
<span class="lineno">55</span><span class="op" id="4892259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4892262">//&nbsp;Declare&nbsp;declares&nbsp;a&nbsp;symbole&nbsp;on&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="4892330">//&nbsp;It&nbsp;returns&nbsp;nil&nbsp;on&nbsp;successful,&nbsp;and&nbsp;returns&nbsp;the&nbsp;conflict&nbsp;symbol&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="4892400">//&nbsp;it&nbsp;is&nbsp;already&nbsp;declared.</span><br>
<span class="lineno">60</span><span class="keyword" id="4892427">func</span>&nbsp;<span class="op" id="4892432">(</span><span class="ident" id="4892433">s</span>&nbsp;<span class="op" id="4892435">*</span><span class="ident" id="4892436">symScope</span><span class="op" id="4892444">)</span>&nbsp;<span class="ident" id="4892446">Declare</span><span class="op" id="4892453">(</span><span class="ident" id="4892454">sym</span>&nbsp;<span class="op" id="4892458">*</span><span class="ident" id="4892459">symbol</span><span class="op" id="4892465">)</span>&nbsp;<span class="op" id="4892467">*</span><span class="ident" id="4892468">symbol</span>&nbsp;<span class="op" id="4892475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4892478">return</span>&nbsp;<span class="ident" id="4892485">s</span><span class="op" id="4892486">.</span><span class="ident" id="4892487">top</span><span class="op" id="4892490">.</span><span class="ident" id="4892491">Declare</span><span class="op" id="4892498">(</span><span class="ident" id="4892499">sym</span><span class="op" id="4892502">)</span><br>
<span class="lineno"></span><span class="op" id="4892504">}</span>
</div>
</body>
</html>
