<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html" class="current">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6672976">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6673031">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6673085">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6673136">package</span>&nbsp;<span class="ident" id="6673144">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6673149">import</span>&nbsp;<span class="op" id="6673156">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6673159">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6673165">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6673178">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6673184">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6673195">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6673206">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6673213">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6673216">func</span>&nbsp;<span class="ident" id="6673221">TestShutdown</span><span class="op" id="6673233">(</span><span class="ident" id="6673234">t</span>&nbsp;<span class="op" id="6673236">*</span><span class="ident" id="6673237">testing</span><span class="op" id="6673244">.</span><span class="ident" id="6673245">T</span><span class="op" id="6673246">)</span>&nbsp;<span class="op" id="6673248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673251">if</span>&nbsp;<span class="ident" id="6673254">runtime</span><span class="op" id="6673261">.</span><span class="ident" id="6673262">GOOS</span>&nbsp;<span class="op" id="6673267">==</span>&nbsp;<span class="string" id="6673270">&#34;plan9&#34;</span>&nbsp;<span class="op" id="6673278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673282">t</span><span class="op" id="6673283">.</span><span class="ident" id="6673284">Skipf</span><span class="op" id="6673289">(</span><span class="string" id="6673290">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6673311">,</span>&nbsp;<span class="ident" id="6673313">runtime</span><span class="op" id="6673320">.</span><span class="ident" id="6673321">GOOS</span><span class="op" id="6673325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673328">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673331">ln</span><span class="op" id="6673333">,</span>&nbsp;<span class="ident" id="6673335">err</span>&nbsp;<span class="op" id="6673339">:=</span>&nbsp;<span class="ident" id="6673342">Listen</span><span class="op" id="6673348">(</span><span class="string" id="6673349">&#34;tcp&#34;</span><span class="op" id="6673354">,</span>&nbsp;<span class="string" id="6673356">&#34;127.0.0.1:0&#34;</span><span class="op" id="6673369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673372">if</span>&nbsp;<span class="ident" id="6673375">err</span>&nbsp;<span class="op" id="6673379">!=</span>&nbsp;<span class="ident" id="6673382">nil</span>&nbsp;<span class="op" id="6673386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673390">if</span>&nbsp;<span class="ident" id="6673393">ln</span><span class="op" id="6673395">,</span>&nbsp;<span class="ident" id="6673397">err</span>&nbsp;<span class="op" id="6673401">=</span>&nbsp;<span class="ident" id="6673403">Listen</span><span class="op" id="6673409">(</span><span class="string" id="6673410">&#34;tcp6&#34;</span><span class="op" id="6673416">,</span>&nbsp;<span class="string" id="6673418">&#34;[::1]:0&#34;</span><span class="op" id="6673427">)</span><span class="op" id="6673428">;</span>&nbsp;<span class="ident" id="6673430">err</span>&nbsp;<span class="op" id="6673434">!=</span>&nbsp;<span class="ident" id="6673437">nil</span>&nbsp;<span class="op" id="6673441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673446">t</span><span class="op" id="6673447">.</span><span class="ident" id="6673448">Fatalf</span><span class="op" id="6673454">(</span><span class="string" id="6673455">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="6673476">,</span>&nbsp;<span class="ident" id="6673478">err</span><span class="op" id="6673481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673485">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673492">go</span>&nbsp;<span class="keyword" id="6673495">func</span><span class="op" id="6673499">(</span><span class="op" id="6673500">)</span>&nbsp;<span class="op" id="6673502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673506">defer</span>&nbsp;<span class="ident" id="6673512">ln</span><span class="op" id="6673514">.</span><span class="ident" id="6673515">Close</span><span class="op" id="6673520">(</span><span class="op" id="6673521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673525">c</span><span class="op" id="6673526">,</span>&nbsp;<span class="ident" id="6673528">err</span>&nbsp;<span class="op" id="6673532">:=</span>&nbsp;<span class="ident" id="6673535">ln</span><span class="op" id="6673537">.</span><span class="ident" id="6673538">Accept</span><span class="op" id="6673544">(</span><span class="op" id="6673545">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673549">if</span>&nbsp;<span class="ident" id="6673552">err</span>&nbsp;<span class="op" id="6673556">!=</span>&nbsp;<span class="ident" id="6673559">nil</span>&nbsp;<span class="op" id="6673563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673568">t</span><span class="op" id="6673569">.</span><span class="ident" id="6673570">Errorf</span><span class="op" id="6673576">(</span><span class="string" id="6673577">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6673589">,</span>&nbsp;<span class="ident" id="6673591">err</span><span class="op" id="6673594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673599">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673612">var</span>&nbsp;<span class="ident" id="6673616">buf</span>&nbsp;<span class="op" id="6673620">[</span><span class="num" id="6673621">10</span><span class="op" id="6673623">]</span><span class="builtintype" id="6673624">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673631">n</span><span class="op" id="6673632">,</span>&nbsp;<span class="ident" id="6673634">err</span>&nbsp;<span class="op" id="6673638">:=</span>&nbsp;<span class="ident" id="6673641">c</span><span class="op" id="6673642">.</span><span class="ident" id="6673643">Read</span><span class="op" id="6673647">(</span><span class="ident" id="6673648">buf</span><span class="op" id="6673651">[</span><span class="op" id="6673652">:</span><span class="op" id="6673653">]</span><span class="op" id="6673654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673658">if</span>&nbsp;<span class="ident" id="6673661">n</span>&nbsp;<span class="op" id="6673663">!=</span>&nbsp;<span class="num" id="6673666">0</span>&nbsp;<span class="op" id="6673668">||</span>&nbsp;<span class="ident" id="6673671">err</span>&nbsp;<span class="op" id="6673675">!=</span>&nbsp;<span class="ident" id="6673678">io</span><span class="op" id="6673680">.</span><span class="ident" id="6673681">EOF</span>&nbsp;<span class="op" id="6673685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673690">t</span><span class="op" id="6673691">.</span><span class="ident" id="6673692">Errorf</span><span class="op" id="6673698">(</span><span class="string" id="6673699">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6673737">,</span>&nbsp;<span class="ident" id="6673739">n</span><span class="op" id="6673740">,</span>&nbsp;<span class="ident" id="6673742">err</span><span class="op" id="6673745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673750">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673759">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673763">c</span><span class="op" id="6673764">.</span><span class="ident" id="6673765">Write</span><span class="op" id="6673770">(</span><span class="op" id="6673771">[</span><span class="op" id="6673772">]</span><span class="builtintype" id="6673773">byte</span><span class="op" id="6673777">(</span><span class="string" id="6673778">&#34;response&#34;</span><span class="op" id="6673788">)</span><span class="op" id="6673789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673793">c</span><span class="op" id="6673794">.</span><span class="ident" id="6673795">Close</span><span class="op" id="6673800">(</span><span class="op" id="6673801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673804">}</span><span class="op" id="6673805">(</span><span class="op" id="6673806">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673810">c</span><span class="op" id="6673811">,</span>&nbsp;<span class="ident" id="6673813">err</span>&nbsp;<span class="op" id="6673817">:=</span>&nbsp;<span class="ident" id="6673820">Dial</span><span class="op" id="6673824">(</span><span class="string" id="6673825">&#34;tcp&#34;</span><span class="op" id="6673830">,</span>&nbsp;<span class="ident" id="6673832">ln</span><span class="op" id="6673834">.</span><span class="ident" id="6673835">Addr</span><span class="op" id="6673839">(</span><span class="op" id="6673840">)</span><span class="op" id="6673841">.</span><span class="ident" id="6673842">String</span><span class="op" id="6673848">(</span><span class="op" id="6673849">)</span><span class="op" id="6673850">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673853">if</span>&nbsp;<span class="ident" id="6673856">err</span>&nbsp;<span class="op" id="6673860">!=</span>&nbsp;<span class="ident" id="6673863">nil</span>&nbsp;<span class="op" id="6673867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673871">t</span><span class="op" id="6673872">.</span><span class="ident" id="6673873">Fatalf</span><span class="op" id="6673879">(</span><span class="string" id="6673880">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6673890">,</span>&nbsp;<span class="ident" id="6673892">err</span><span class="op" id="6673895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6673898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673901">defer</span>&nbsp;<span class="ident" id="6673907">c</span><span class="op" id="6673908">.</span><span class="ident" id="6673909">Close</span><span class="op" id="6673914">(</span><span class="op" id="6673915">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673919">err</span>&nbsp;<span class="op" id="6673923">=</span>&nbsp;<span class="ident" id="6673925">c</span><span class="op" id="6673926">.</span><span class="op" id="6673927">(</span><span class="op" id="6673928">*</span><span class="ident" id="6673929">TCPConn</span><span class="op" id="6673936">)</span><span class="op" id="6673937">.</span><span class="ident" id="6673938">CloseWrite</span><span class="op" id="6673948">(</span><span class="op" id="6673949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6673952">if</span>&nbsp;<span class="ident" id="6673955">err</span>&nbsp;<span class="op" id="6673959">!=</span>&nbsp;<span class="ident" id="6673962">nil</span>&nbsp;<span class="op" id="6673966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6673970">t</span><span class="op" id="6673971">.</span><span class="ident" id="6673972">Fatalf</span><span class="op" id="6673978">(</span><span class="string" id="6673979">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6673995">,</span>&nbsp;<span class="ident" id="6673997">err</span><span class="op" id="6674000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674006">var</span>&nbsp;<span class="ident" id="6674010">buf</span>&nbsp;<span class="op" id="6674014">[</span><span class="num" id="6674015">10</span><span class="op" id="6674017">]</span><span class="builtintype" id="6674018">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674024">n</span><span class="op" id="6674025">,</span>&nbsp;<span class="ident" id="6674027">err</span>&nbsp;<span class="op" id="6674031">:=</span>&nbsp;<span class="ident" id="6674034">c</span><span class="op" id="6674035">.</span><span class="ident" id="6674036">Read</span><span class="op" id="6674040">(</span><span class="ident" id="6674041">buf</span><span class="op" id="6674044">[</span><span class="op" id="6674045">:</span><span class="op" id="6674046">]</span><span class="op" id="6674047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674050">if</span>&nbsp;<span class="ident" id="6674053">err</span>&nbsp;<span class="op" id="6674057">!=</span>&nbsp;<span class="ident" id="6674060">nil</span>&nbsp;<span class="op" id="6674064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674068">t</span><span class="op" id="6674069">.</span><span class="ident" id="6674070">Fatalf</span><span class="op" id="6674076">(</span><span class="string" id="6674077">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6674098">,</span>&nbsp;<span class="ident" id="6674100">n</span><span class="op" id="6674101">,</span>&nbsp;<span class="ident" id="6674103">err</span><span class="op" id="6674106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674112">got</span>&nbsp;<span class="op" id="6674116">:=</span>&nbsp;<span class="builtintype" id="6674119">string</span><span class="op" id="6674125">(</span><span class="ident" id="6674126">buf</span><span class="op" id="6674129">[</span><span class="op" id="6674130">:</span><span class="ident" id="6674131">n</span><span class="op" id="6674132">]</span><span class="op" id="6674133">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674136">if</span>&nbsp;<span class="ident" id="6674139">got</span>&nbsp;<span class="op" id="6674143">!=</span>&nbsp;<span class="string" id="6674146">&#34;response&#34;</span>&nbsp;<span class="op" id="6674157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674161">t</span><span class="op" id="6674162">.</span><span class="ident" id="6674163">Errorf</span><span class="op" id="6674169">(</span><span class="string" id="6674170">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6674200">,</span>&nbsp;<span class="ident" id="6674202">got</span><span class="op" id="6674205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674208">}</span><br>
<span class="lineno"></span><span class="op" id="6674210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6674213">func</span>&nbsp;<span class="ident" id="6674218">TestShutdownUnix</span><span class="op" id="6674234">(</span><span class="ident" id="6674235">t</span>&nbsp;<span class="op" id="6674237">*</span><span class="ident" id="6674238">testing</span><span class="op" id="6674245">.</span><span class="ident" id="6674246">T</span><span class="op" id="6674247">)</span>&nbsp;<span class="op" id="6674249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674252">switch</span>&nbsp;<span class="ident" id="6674259">runtime</span><span class="op" id="6674266">.</span><span class="ident" id="6674267">GOOS</span>&nbsp;<span class="op" id="6674272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674275">case</span>&nbsp;<span class="string" id="6674280">&#34;nacl&#34;</span><span class="op" id="6674286">,</span>&nbsp;<span class="string" id="6674288">&#34;plan9&#34;</span><span class="op" id="6674295">,</span>&nbsp;<span class="string" id="6674297">&#34;windows&#34;</span><span class="op" id="6674306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674310">t</span><span class="op" id="6674311">.</span><span class="ident" id="6674312">Skipf</span><span class="op" id="6674317">(</span><span class="string" id="6674318">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6674339">,</span>&nbsp;<span class="ident" id="6674341">runtime</span><span class="op" id="6674348">.</span><span class="ident" id="6674349">GOOS</span><span class="op" id="6674353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674356">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674359">f</span><span class="op" id="6674360">,</span>&nbsp;<span class="ident" id="6674362">err</span>&nbsp;<span class="op" id="6674366">:=</span>&nbsp;<span class="ident" id="6674369">ioutil</span><span class="op" id="6674375">.</span><span class="ident" id="6674376">TempFile</span><span class="op" id="6674384">(</span><span class="string" id="6674385">&#34;&#34;</span><span class="op" id="6674387">,</span>&nbsp;<span class="string" id="6674389">&#34;go_net_unixtest&#34;</span><span class="op" id="6674406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674409">if</span>&nbsp;<span class="ident" id="6674412">err</span>&nbsp;<span class="op" id="6674416">!=</span>&nbsp;<span class="ident" id="6674419">nil</span>&nbsp;<span class="op" id="6674423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674427">t</span><span class="op" id="6674428">.</span><span class="ident" id="6674429">Fatalf</span><span class="op" id="6674435">(</span><span class="string" id="6674436">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="6674450">,</span>&nbsp;<span class="ident" id="6674452">err</span><span class="op" id="6674455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674461">f</span><span class="op" id="6674462">.</span><span class="ident" id="6674463">Close</span><span class="op" id="6674468">(</span><span class="op" id="6674469">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674472">tmpname</span>&nbsp;<span class="op" id="6674480">:=</span>&nbsp;<span class="ident" id="6674483">f</span><span class="op" id="6674484">.</span><span class="ident" id="6674485">Name</span><span class="op" id="6674489">(</span><span class="op" id="6674490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674493">os</span><span class="op" id="6674495">.</span><span class="ident" id="6674496">Remove</span><span class="op" id="6674502">(</span><span class="ident" id="6674503">tmpname</span><span class="op" id="6674510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674513">ln</span><span class="op" id="6674515">,</span>&nbsp;<span class="ident" id="6674517">err</span>&nbsp;<span class="op" id="6674521">:=</span>&nbsp;<span class="ident" id="6674524">Listen</span><span class="op" id="6674530">(</span><span class="string" id="6674531">&#34;unix&#34;</span><span class="op" id="6674537">,</span>&nbsp;<span class="ident" id="6674539">tmpname</span><span class="op" id="6674546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674549">if</span>&nbsp;<span class="ident" id="6674552">err</span>&nbsp;<span class="op" id="6674556">!=</span>&nbsp;<span class="ident" id="6674559">nil</span>&nbsp;<span class="op" id="6674563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674567">t</span><span class="op" id="6674568">.</span><span class="ident" id="6674569">Fatalf</span><span class="op" id="6674575">(</span><span class="string" id="6674576">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="6674598">,</span>&nbsp;<span class="ident" id="6674600">tmpname</span><span class="op" id="6674607">,</span>&nbsp;<span class="ident" id="6674609">err</span><span class="op" id="6674612">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674618">defer</span>&nbsp;<span class="keyword" id="6674624">func</span><span class="op" id="6674628">(</span><span class="op" id="6674629">)</span>&nbsp;<span class="op" id="6674631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674635">ln</span><span class="op" id="6674637">.</span><span class="ident" id="6674638">Close</span><span class="op" id="6674643">(</span><span class="op" id="6674644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674648">os</span><span class="op" id="6674650">.</span><span class="ident" id="6674651">Remove</span><span class="op" id="6674657">(</span><span class="ident" id="6674658">tmpname</span><span class="op" id="6674665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674668">}</span><span class="op" id="6674669">(</span><span class="op" id="6674670">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674674">go</span>&nbsp;<span class="keyword" id="6674677">func</span><span class="op" id="6674681">(</span><span class="op" id="6674682">)</span>&nbsp;<span class="op" id="6674684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674688">c</span><span class="op" id="6674689">,</span>&nbsp;<span class="ident" id="6674691">err</span>&nbsp;<span class="op" id="6674695">:=</span>&nbsp;<span class="ident" id="6674698">ln</span><span class="op" id="6674700">.</span><span class="ident" id="6674701">Accept</span><span class="op" id="6674707">(</span><span class="op" id="6674708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674712">if</span>&nbsp;<span class="ident" id="6674715">err</span>&nbsp;<span class="op" id="6674719">!=</span>&nbsp;<span class="ident" id="6674722">nil</span>&nbsp;<span class="op" id="6674726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674731">t</span><span class="op" id="6674732">.</span><span class="ident" id="6674733">Errorf</span><span class="op" id="6674739">(</span><span class="string" id="6674740">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6674752">,</span>&nbsp;<span class="ident" id="6674754">err</span><span class="op" id="6674757">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674762">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674775">var</span>&nbsp;<span class="ident" id="6674779">buf</span>&nbsp;<span class="op" id="6674783">[</span><span class="num" id="6674784">10</span><span class="op" id="6674786">]</span><span class="builtintype" id="6674787">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674794">n</span><span class="op" id="6674795">,</span>&nbsp;<span class="ident" id="6674797">err</span>&nbsp;<span class="op" id="6674801">:=</span>&nbsp;<span class="ident" id="6674804">c</span><span class="op" id="6674805">.</span><span class="ident" id="6674806">Read</span><span class="op" id="6674810">(</span><span class="ident" id="6674811">buf</span><span class="op" id="6674814">[</span><span class="op" id="6674815">:</span><span class="op" id="6674816">]</span><span class="op" id="6674817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674821">if</span>&nbsp;<span class="ident" id="6674824">n</span>&nbsp;<span class="op" id="6674826">!=</span>&nbsp;<span class="num" id="6674829">0</span>&nbsp;<span class="op" id="6674831">||</span>&nbsp;<span class="ident" id="6674834">err</span>&nbsp;<span class="op" id="6674838">!=</span>&nbsp;<span class="ident" id="6674841">io</span><span class="op" id="6674843">.</span><span class="ident" id="6674844">EOF</span>&nbsp;<span class="op" id="6674848">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674853">t</span><span class="op" id="6674854">.</span><span class="ident" id="6674855">Errorf</span><span class="op" id="6674861">(</span><span class="string" id="6674862">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6674900">,</span>&nbsp;<span class="ident" id="6674902">n</span><span class="op" id="6674903">,</span>&nbsp;<span class="ident" id="6674905">err</span><span class="op" id="6674908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6674913">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674926">c</span><span class="op" id="6674927">.</span><span class="ident" id="6674928">Write</span><span class="op" id="6674933">(</span><span class="op" id="6674934">[</span><span class="op" id="6674935">]</span><span class="builtintype" id="6674936">byte</span><span class="op" id="6674940">(</span><span class="string" id="6674941">&#34;response&#34;</span><span class="op" id="6674951">)</span><span class="op" id="6674952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674956">c</span><span class="op" id="6674957">.</span><span class="ident" id="6674958">Close</span><span class="op" id="6674963">(</span><span class="op" id="6674964">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6674967">}</span><span class="op" id="6674968">(</span><span class="op" id="6674969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6674973">c</span><span class="op" id="6674974">,</span>&nbsp;<span class="ident" id="6674976">err</span>&nbsp;<span class="op" id="6674980">:=</span>&nbsp;<span class="ident" id="6674983">Dial</span><span class="op" id="6674987">(</span><span class="string" id="6674988">&#34;unix&#34;</span><span class="op" id="6674994">,</span>&nbsp;<span class="ident" id="6674996">tmpname</span><span class="op" id="6675003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675006">if</span>&nbsp;<span class="ident" id="6675009">err</span>&nbsp;<span class="op" id="6675013">!=</span>&nbsp;<span class="ident" id="6675016">nil</span>&nbsp;<span class="op" id="6675020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675024">t</span><span class="op" id="6675025">.</span><span class="ident" id="6675026">Fatalf</span><span class="op" id="6675032">(</span><span class="string" id="6675033">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6675043">,</span>&nbsp;<span class="ident" id="6675045">err</span><span class="op" id="6675048">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675054">defer</span>&nbsp;<span class="ident" id="6675060">c</span><span class="op" id="6675061">.</span><span class="ident" id="6675062">Close</span><span class="op" id="6675067">(</span><span class="op" id="6675068">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675072">err</span>&nbsp;<span class="op" id="6675076">=</span>&nbsp;<span class="ident" id="6675078">c</span><span class="op" id="6675079">.</span><span class="op" id="6675080">(</span><span class="op" id="6675081">*</span><span class="ident" id="6675082">UnixConn</span><span class="op" id="6675090">)</span><span class="op" id="6675091">.</span><span class="ident" id="6675092">CloseWrite</span><span class="op" id="6675102">(</span><span class="op" id="6675103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675106">if</span>&nbsp;<span class="ident" id="6675109">err</span>&nbsp;<span class="op" id="6675113">!=</span>&nbsp;<span class="ident" id="6675116">nil</span>&nbsp;<span class="op" id="6675120">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675124">t</span><span class="op" id="6675125">.</span><span class="ident" id="6675126">Fatalf</span><span class="op" id="6675132">(</span><span class="string" id="6675133">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6675149">,</span>&nbsp;<span class="ident" id="6675151">err</span><span class="op" id="6675154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675160">var</span>&nbsp;<span class="ident" id="6675164">buf</span>&nbsp;<span class="op" id="6675168">[</span><span class="num" id="6675169">10</span><span class="op" id="6675171">]</span><span class="builtintype" id="6675172">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675178">n</span><span class="op" id="6675179">,</span>&nbsp;<span class="ident" id="6675181">err</span>&nbsp;<span class="op" id="6675185">:=</span>&nbsp;<span class="ident" id="6675188">c</span><span class="op" id="6675189">.</span><span class="ident" id="6675190">Read</span><span class="op" id="6675194">(</span><span class="ident" id="6675195">buf</span><span class="op" id="6675198">[</span><span class="op" id="6675199">:</span><span class="op" id="6675200">]</span><span class="op" id="6675201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675204">if</span>&nbsp;<span class="ident" id="6675207">err</span>&nbsp;<span class="op" id="6675211">!=</span>&nbsp;<span class="ident" id="6675214">nil</span>&nbsp;<span class="op" id="6675218">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675222">t</span><span class="op" id="6675223">.</span><span class="ident" id="6675224">Fatalf</span><span class="op" id="6675230">(</span><span class="string" id="6675231">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6675252">,</span>&nbsp;<span class="ident" id="6675254">n</span><span class="op" id="6675255">,</span>&nbsp;<span class="ident" id="6675257">err</span><span class="op" id="6675260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675266">got</span>&nbsp;<span class="op" id="6675270">:=</span>&nbsp;<span class="builtintype" id="6675273">string</span><span class="op" id="6675279">(</span><span class="ident" id="6675280">buf</span><span class="op" id="6675283">[</span><span class="op" id="6675284">:</span><span class="ident" id="6675285">n</span><span class="op" id="6675286">]</span><span class="op" id="6675287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675290">if</span>&nbsp;<span class="ident" id="6675293">got</span>&nbsp;<span class="op" id="6675297">!=</span>&nbsp;<span class="string" id="6675300">&#34;response&#34;</span>&nbsp;<span class="op" id="6675311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675315">t</span><span class="op" id="6675316">.</span><span class="ident" id="6675317">Errorf</span><span class="op" id="6675323">(</span><span class="string" id="6675324">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6675354">,</span>&nbsp;<span class="ident" id="6675356">got</span><span class="op" id="6675359">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675362">}</span><br>
<span class="lineno"></span><span class="op" id="6675364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6675367">func</span>&nbsp;<span class="ident" id="6675372">TestTCPListenClose</span><span class="op" id="6675390">(</span><span class="ident" id="6675391">t</span>&nbsp;<span class="op" id="6675393">*</span><span class="ident" id="6675394">testing</span><span class="op" id="6675401">.</span><span class="ident" id="6675402">T</span><span class="op" id="6675403">)</span>&nbsp;<span class="op" id="6675405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675408">ln</span><span class="op" id="6675410">,</span>&nbsp;<span class="ident" id="6675412">err</span>&nbsp;<span class="op" id="6675416">:=</span>&nbsp;<span class="ident" id="6675419">Listen</span><span class="op" id="6675425">(</span><span class="string" id="6675426">&#34;tcp&#34;</span><span class="op" id="6675431">,</span>&nbsp;<span class="string" id="6675433">&#34;127.0.0.1:0&#34;</span><span class="op" id="6675446">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675449">if</span>&nbsp;<span class="ident" id="6675452">err</span>&nbsp;<span class="op" id="6675456">!=</span>&nbsp;<span class="ident" id="6675459">nil</span>&nbsp;<span class="op" id="6675463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675467">t</span><span class="op" id="6675468">.</span><span class="ident" id="6675469">Fatalf</span><span class="op" id="6675475">(</span><span class="string" id="6675476">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6675495">,</span>&nbsp;<span class="ident" id="6675497">err</span><span class="op" id="6675500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675507">done</span>&nbsp;<span class="op" id="6675512">:=</span>&nbsp;<span class="builtinfunc" id="6675515">make</span><span class="op" id="6675519">(</span><span class="keyword" id="6675520">chan</span>&nbsp;<span class="builtintype" id="6675525">bool</span><span class="op" id="6675529">,</span>&nbsp;<span class="num" id="6675531">1</span><span class="op" id="6675532">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675535">go</span>&nbsp;<span class="keyword" id="6675538">func</span><span class="op" id="6675542">(</span><span class="op" id="6675543">)</span>&nbsp;<span class="op" id="6675545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675549">time</span><span class="op" id="6675553">.</span><span class="ident" id="6675554">Sleep</span><span class="op" id="6675559">(</span><span class="num" id="6675560">100</span>&nbsp;<span class="op" id="6675564">*</span>&nbsp;<span class="ident" id="6675566">time</span><span class="op" id="6675570">.</span><span class="ident" id="6675571">Millisecond</span><span class="op" id="6675582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675586">ln</span><span class="op" id="6675588">.</span><span class="ident" id="6675589">Close</span><span class="op" id="6675594">(</span><span class="op" id="6675595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675598">}</span><span class="op" id="6675599">(</span><span class="op" id="6675600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675603">go</span>&nbsp;<span class="keyword" id="6675606">func</span><span class="op" id="6675610">(</span><span class="op" id="6675611">)</span>&nbsp;<span class="op" id="6675613">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675617">c</span><span class="op" id="6675618">,</span>&nbsp;<span class="ident" id="6675620">err</span>&nbsp;<span class="op" id="6675624">:=</span>&nbsp;<span class="ident" id="6675627">ln</span><span class="op" id="6675629">.</span><span class="ident" id="6675630">Accept</span><span class="op" id="6675636">(</span><span class="op" id="6675637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675641">if</span>&nbsp;<span class="ident" id="6675644">err</span>&nbsp;<span class="op" id="6675648">==</span>&nbsp;<span class="ident" id="6675651">nil</span>&nbsp;<span class="op" id="6675655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675660">c</span><span class="op" id="6675661">.</span><span class="ident" id="6675662">Close</span><span class="op" id="6675667">(</span><span class="op" id="6675668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675673">t</span><span class="op" id="6675674">.</span><span class="ident" id="6675675">Error</span><span class="op" id="6675680">(</span><span class="string" id="6675681">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="6675699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675703">}</span>&nbsp;<span class="keyword" id="6675705">else</span>&nbsp;<span class="op" id="6675710">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675715">t</span><span class="op" id="6675716">.</span><span class="ident" id="6675717">Logf</span><span class="op" id="6675721">(</span><span class="string" id="6675722">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6675768">,</span>&nbsp;<span class="ident" id="6675770">err</span><span class="op" id="6675773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675781">done</span>&nbsp;<span class="op" id="6675786">&lt;-</span>&nbsp;<span class="builtintype" id="6675789">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675795">}</span><span class="op" id="6675796">(</span><span class="op" id="6675797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675800">select</span>&nbsp;<span class="op" id="6675807">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675810">case</span>&nbsp;<span class="op" id="6675815">&lt;-</span><span class="ident" id="6675817">done</span><span class="op" id="6675821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675824">case</span>&nbsp;<span class="op" id="6675829">&lt;-</span><span class="ident" id="6675831">time</span><span class="op" id="6675835">.</span><span class="ident" id="6675836">After</span><span class="op" id="6675841">(</span><span class="num" id="6675842">2</span>&nbsp;<span class="op" id="6675844">*</span>&nbsp;<span class="ident" id="6675846">time</span><span class="op" id="6675850">.</span><span class="ident" id="6675851">Second</span><span class="op" id="6675857">)</span><span class="op" id="6675858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675862">t</span><span class="op" id="6675863">.</span><span class="ident" id="6675864">Fatal</span><span class="op" id="6675869">(</span><span class="string" id="6675870">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="6675901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6675904">}</span><br>
<span class="lineno"></span><span class="op" id="6675906">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6675909">func</span>&nbsp;<span class="ident" id="6675914">TestUDPListenClose</span><span class="op" id="6675932">(</span><span class="ident" id="6675933">t</span>&nbsp;<span class="op" id="6675935">*</span><span class="ident" id="6675936">testing</span><span class="op" id="6675943">.</span><span class="ident" id="6675944">T</span><span class="op" id="6675945">)</span>&nbsp;<span class="op" id="6675947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675950">switch</span>&nbsp;<span class="ident" id="6675957">runtime</span><span class="op" id="6675964">.</span><span class="ident" id="6675965">GOOS</span>&nbsp;<span class="op" id="6675970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6675973">case</span>&nbsp;<span class="string" id="6675978">&#34;plan9&#34;</span><span class="op" id="6675985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6675989">t</span><span class="op" id="6675990">.</span><span class="ident" id="6675991">Skipf</span><span class="op" id="6675996">(</span><span class="string" id="6675997">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6676018">,</span>&nbsp;<span class="ident" id="6676020">runtime</span><span class="op" id="6676027">.</span><span class="ident" id="6676028">GOOS</span><span class="op" id="6676032">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676038">ln</span><span class="op" id="6676040">,</span>&nbsp;<span class="ident" id="6676042">err</span>&nbsp;<span class="op" id="6676046">:=</span>&nbsp;<span class="ident" id="6676049">ListenPacket</span><span class="op" id="6676061">(</span><span class="string" id="6676062">&#34;udp&#34;</span><span class="op" id="6676067">,</span>&nbsp;<span class="string" id="6676069">&#34;127.0.0.1:0&#34;</span><span class="op" id="6676082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676085">if</span>&nbsp;<span class="ident" id="6676088">err</span>&nbsp;<span class="op" id="6676092">!=</span>&nbsp;<span class="ident" id="6676095">nil</span>&nbsp;<span class="op" id="6676099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676103">t</span><span class="op" id="6676104">.</span><span class="ident" id="6676105">Fatalf</span><span class="op" id="6676111">(</span><span class="string" id="6676112">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6676131">,</span>&nbsp;<span class="ident" id="6676133">err</span><span class="op" id="6676136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676139">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676143">buf</span>&nbsp;<span class="op" id="6676147">:=</span>&nbsp;<span class="builtinfunc" id="6676150">make</span><span class="op" id="6676154">(</span><span class="op" id="6676155">[</span><span class="op" id="6676156">]</span><span class="builtintype" id="6676157">byte</span><span class="op" id="6676161">,</span>&nbsp;<span class="num" id="6676163">1000</span><span class="op" id="6676167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676170">done</span>&nbsp;<span class="op" id="6676175">:=</span>&nbsp;<span class="builtinfunc" id="6676178">make</span><span class="op" id="6676182">(</span><span class="keyword" id="6676183">chan</span>&nbsp;<span class="builtintype" id="6676188">bool</span><span class="op" id="6676192">,</span>&nbsp;<span class="num" id="6676194">1</span><span class="op" id="6676195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676198">go</span>&nbsp;<span class="keyword" id="6676201">func</span><span class="op" id="6676205">(</span><span class="op" id="6676206">)</span>&nbsp;<span class="op" id="6676208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676212">time</span><span class="op" id="6676216">.</span><span class="ident" id="6676217">Sleep</span><span class="op" id="6676222">(</span><span class="num" id="6676223">100</span>&nbsp;<span class="op" id="6676227">*</span>&nbsp;<span class="ident" id="6676229">time</span><span class="op" id="6676233">.</span><span class="ident" id="6676234">Millisecond</span><span class="op" id="6676245">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676249">ln</span><span class="op" id="6676251">.</span><span class="ident" id="6676252">Close</span><span class="op" id="6676257">(</span><span class="op" id="6676258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676261">}</span><span class="op" id="6676262">(</span><span class="op" id="6676263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676266">go</span>&nbsp;<span class="keyword" id="6676269">func</span><span class="op" id="6676273">(</span><span class="op" id="6676274">)</span>&nbsp;<span class="op" id="6676276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676280">_</span><span class="op" id="6676281">,</span>&nbsp;<span class="ident" id="6676283">_</span><span class="op" id="6676284">,</span>&nbsp;<span class="ident" id="6676286">err</span>&nbsp;<span class="op" id="6676290">=</span>&nbsp;<span class="ident" id="6676292">ln</span><span class="op" id="6676294">.</span><span class="ident" id="6676295">ReadFrom</span><span class="op" id="6676303">(</span><span class="ident" id="6676304">buf</span><span class="op" id="6676307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676311">if</span>&nbsp;<span class="ident" id="6676314">err</span>&nbsp;<span class="op" id="6676318">==</span>&nbsp;<span class="ident" id="6676321">nil</span>&nbsp;<span class="op" id="6676325">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676330">t</span><span class="op" id="6676331">.</span><span class="ident" id="6676332">Error</span><span class="op" id="6676337">(</span><span class="string" id="6676338">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="6676358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676362">}</span>&nbsp;<span class="keyword" id="6676364">else</span>&nbsp;<span class="op" id="6676369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676374">t</span><span class="op" id="6676375">.</span><span class="ident" id="6676376">Logf</span><span class="op" id="6676380">(</span><span class="string" id="6676381">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6676429">,</span>&nbsp;<span class="ident" id="6676431">err</span><span class="op" id="6676434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676442">done</span>&nbsp;<span class="op" id="6676447">&lt;-</span>&nbsp;<span class="builtintype" id="6676450">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676456">}</span><span class="op" id="6676457">(</span><span class="op" id="6676458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676461">select</span>&nbsp;<span class="op" id="6676468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676471">case</span>&nbsp;<span class="op" id="6676476">&lt;-</span><span class="ident" id="6676478">done</span><span class="op" id="6676482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676485">case</span>&nbsp;<span class="op" id="6676490">&lt;-</span><span class="ident" id="6676492">time</span><span class="op" id="6676496">.</span><span class="ident" id="6676497">After</span><span class="op" id="6676502">(</span><span class="num" id="6676503">2</span>&nbsp;<span class="op" id="6676505">*</span>&nbsp;<span class="ident" id="6676507">time</span><span class="op" id="6676511">.</span><span class="ident" id="6676512">Second</span><span class="op" id="6676518">)</span><span class="op" id="6676519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676523">t</span><span class="op" id="6676524">.</span><span class="ident" id="6676525">Fatal</span><span class="op" id="6676530">(</span><span class="string" id="6676531">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="6676562">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676565">}</span><br>
<span class="lineno"></span><span class="op" id="6676567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6676570">func</span>&nbsp;<span class="ident" id="6676575">TestTCPClose</span><span class="op" id="6676587">(</span><span class="ident" id="6676588">t</span>&nbsp;<span class="op" id="6676590">*</span><span class="ident" id="6676591">testing</span><span class="op" id="6676598">.</span><span class="ident" id="6676599">T</span><span class="op" id="6676600">)</span>&nbsp;<span class="op" id="6676602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676605">switch</span>&nbsp;<span class="ident" id="6676612">runtime</span><span class="op" id="6676619">.</span><span class="ident" id="6676620">GOOS</span>&nbsp;<span class="op" id="6676625">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676628">case</span>&nbsp;<span class="string" id="6676633">&#34;plan9&#34;</span><span class="op" id="6676640">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676644">t</span><span class="op" id="6676645">.</span><span class="ident" id="6676646">Skipf</span><span class="op" id="6676651">(</span><span class="string" id="6676652">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6676673">,</span>&nbsp;<span class="ident" id="6676675">runtime</span><span class="op" id="6676682">.</span><span class="ident" id="6676683">GOOS</span><span class="op" id="6676687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676693">l</span><span class="op" id="6676694">,</span>&nbsp;<span class="ident" id="6676696">err</span>&nbsp;<span class="op" id="6676700">:=</span>&nbsp;<span class="ident" id="6676703">Listen</span><span class="op" id="6676709">(</span><span class="string" id="6676710">&#34;tcp&#34;</span><span class="op" id="6676715">,</span>&nbsp;<span class="string" id="6676717">&#34;127.0.0.1:0&#34;</span><span class="op" id="6676730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676733">if</span>&nbsp;<span class="ident" id="6676736">err</span>&nbsp;<span class="op" id="6676740">!=</span>&nbsp;<span class="ident" id="6676743">nil</span>&nbsp;<span class="op" id="6676747">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676751">t</span><span class="op" id="6676752">.</span><span class="ident" id="6676753">Fatal</span><span class="op" id="6676758">(</span><span class="ident" id="6676759">err</span><span class="op" id="6676762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676768">defer</span>&nbsp;<span class="ident" id="6676774">l</span><span class="op" id="6676775">.</span><span class="ident" id="6676776">Close</span><span class="op" id="6676781">(</span><span class="op" id="6676782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676786">read</span>&nbsp;<span class="op" id="6676791">:=</span>&nbsp;<span class="keyword" id="6676794">func</span><span class="op" id="6676798">(</span><span class="ident" id="6676799">r</span>&nbsp;<span class="ident" id="6676801">io</span><span class="op" id="6676803">.</span><span class="ident" id="6676804">Reader</span><span class="op" id="6676810">)</span>&nbsp;<span class="builtintype" id="6676812">error</span>&nbsp;<span class="op" id="6676818">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676822">var</span>&nbsp;<span class="ident" id="6676826">m</span>&nbsp;<span class="op" id="6676828">[</span><span class="num" id="6676829">1</span><span class="op" id="6676830">]</span><span class="builtintype" id="6676831">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676838">_</span><span class="op" id="6676839">,</span>&nbsp;<span class="ident" id="6676841">err</span>&nbsp;<span class="op" id="6676845">:=</span>&nbsp;<span class="ident" id="6676848">r</span><span class="op" id="6676849">.</span><span class="ident" id="6676850">Read</span><span class="op" id="6676854">(</span><span class="ident" id="6676855">m</span><span class="op" id="6676856">[</span><span class="op" id="6676857">:</span><span class="op" id="6676858">]</span><span class="op" id="6676859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676863">return</span>&nbsp;<span class="ident" id="6676870">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676879">go</span>&nbsp;<span class="keyword" id="6676882">func</span><span class="op" id="6676886">(</span><span class="op" id="6676887">)</span>&nbsp;<span class="op" id="6676889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676893">c</span><span class="op" id="6676894">,</span>&nbsp;<span class="ident" id="6676896">err</span>&nbsp;<span class="op" id="6676900">:=</span>&nbsp;<span class="ident" id="6676903">Dial</span><span class="op" id="6676907">(</span><span class="string" id="6676908">&#34;tcp&#34;</span><span class="op" id="6676913">,</span>&nbsp;<span class="ident" id="6676915">l</span><span class="op" id="6676916">.</span><span class="ident" id="6676917">Addr</span><span class="op" id="6676921">(</span><span class="op" id="6676922">)</span><span class="op" id="6676923">.</span><span class="ident" id="6676924">String</span><span class="op" id="6676930">(</span><span class="op" id="6676931">)</span><span class="op" id="6676932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676936">if</span>&nbsp;<span class="ident" id="6676939">err</span>&nbsp;<span class="op" id="6676943">!=</span>&nbsp;<span class="ident" id="6676946">nil</span>&nbsp;<span class="op" id="6676950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6676955">t</span><span class="op" id="6676956">.</span><span class="ident" id="6676957">Errorf</span><span class="op" id="6676963">(</span><span class="string" id="6676964">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6676974">,</span>&nbsp;<span class="ident" id="6676976">err</span><span class="op" id="6676979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676984">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6676993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6676998">go</span>&nbsp;<span class="ident" id="6677001">read</span><span class="op" id="6677005">(</span><span class="ident" id="6677006">c</span><span class="op" id="6677007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677012">time</span><span class="op" id="6677016">.</span><span class="ident" id="6677017">Sleep</span><span class="op" id="6677022">(</span><span class="num" id="6677023">10</span>&nbsp;<span class="op" id="6677026">*</span>&nbsp;<span class="ident" id="6677028">time</span><span class="op" id="6677032">.</span><span class="ident" id="6677033">Millisecond</span><span class="op" id="6677044">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677048">c</span><span class="op" id="6677049">.</span><span class="ident" id="6677050">Close</span><span class="op" id="6677055">(</span><span class="op" id="6677056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677059">}</span><span class="op" id="6677060">(</span><span class="op" id="6677061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677065">c</span><span class="op" id="6677066">,</span>&nbsp;<span class="ident" id="6677068">err</span>&nbsp;<span class="op" id="6677072">:=</span>&nbsp;<span class="ident" id="6677075">l</span><span class="op" id="6677076">.</span><span class="ident" id="6677077">Accept</span><span class="op" id="6677083">(</span><span class="op" id="6677084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677087">if</span>&nbsp;<span class="ident" id="6677090">err</span>&nbsp;<span class="op" id="6677094">!=</span>&nbsp;<span class="ident" id="6677097">nil</span>&nbsp;<span class="op" id="6677101">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677105">t</span><span class="op" id="6677106">.</span><span class="ident" id="6677107">Fatal</span><span class="op" id="6677112">(</span><span class="ident" id="6677113">err</span><span class="op" id="6677116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677122">defer</span>&nbsp;<span class="ident" id="6677128">c</span><span class="op" id="6677129">.</span><span class="ident" id="6677130">Close</span><span class="op" id="6677135">(</span><span class="op" id="6677136">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677140">for</span>&nbsp;<span class="ident" id="6677144">err</span>&nbsp;<span class="op" id="6677148">==</span>&nbsp;<span class="ident" id="6677151">nil</span>&nbsp;<span class="op" id="6677155">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677159">err</span>&nbsp;<span class="op" id="6677163">=</span>&nbsp;<span class="ident" id="6677165">read</span><span class="op" id="6677169">(</span><span class="ident" id="6677170">c</span><span class="op" id="6677171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677177">if</span>&nbsp;<span class="ident" id="6677180">err</span>&nbsp;<span class="op" id="6677184">!=</span>&nbsp;<span class="ident" id="6677187">nil</span>&nbsp;<span class="op" id="6677191">&amp;&amp;</span>&nbsp;<span class="ident" id="6677194">err</span>&nbsp;<span class="op" id="6677198">!=</span>&nbsp;<span class="ident" id="6677201">io</span><span class="op" id="6677203">.</span><span class="ident" id="6677204">EOF</span>&nbsp;<span class="op" id="6677208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677212">t</span><span class="op" id="6677213">.</span><span class="ident" id="6677214">Fatal</span><span class="op" id="6677219">(</span><span class="ident" id="6677220">err</span><span class="op" id="6677223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677226">}</span><br>
<span class="lineno">225</span><span class="op" id="6677228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6677231">func</span>&nbsp;<span class="ident" id="6677236">TestErrorNil</span><span class="op" id="6677248">(</span><span class="ident" id="6677249">t</span>&nbsp;<span class="op" id="6677251">*</span><span class="ident" id="6677252">testing</span><span class="op" id="6677259">.</span><span class="ident" id="6677260">T</span><span class="op" id="6677261">)</span>&nbsp;<span class="op" id="6677263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677266">c</span><span class="op" id="6677267">,</span>&nbsp;<span class="ident" id="6677269">err</span>&nbsp;<span class="op" id="6677273">:=</span>&nbsp;<span class="ident" id="6677276">Dial</span><span class="op" id="6677280">(</span><span class="string" id="6677281">&#34;tcp&#34;</span><span class="op" id="6677286">,</span>&nbsp;<span class="string" id="6677288">&#34;127.0.0.1:65535&#34;</span><span class="op" id="6677305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677308">if</span>&nbsp;<span class="ident" id="6677311">err</span>&nbsp;<span class="op" id="6677315">==</span>&nbsp;<span class="ident" id="6677318">nil</span>&nbsp;<span class="op" id="6677322">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677326">t</span><span class="op" id="6677327">.</span><span class="ident" id="6677328">Fatal</span><span class="op" id="6677333">(</span><span class="string" id="6677334">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="6677366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677372">if</span>&nbsp;<span class="ident" id="6677375">c</span>&nbsp;<span class="op" id="6677377">!=</span>&nbsp;<span class="ident" id="6677380">nil</span>&nbsp;<span class="op" id="6677384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677388">t</span><span class="op" id="6677389">.</span><span class="ident" id="6677390">Fatalf</span><span class="op" id="6677396">(</span><span class="string" id="6677397">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6677453">,</span>&nbsp;<span class="ident" id="6677455">c</span><span class="op" id="6677456">,</span>&nbsp;<span class="ident" id="6677458">c</span><span class="op" id="6677459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677462">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6677466">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677523">l</span><span class="op" id="6677524">,</span>&nbsp;<span class="ident" id="6677526">err</span>&nbsp;<span class="op" id="6677530">:=</span>&nbsp;<span class="ident" id="6677533">Listen</span><span class="op" id="6677539">(</span><span class="string" id="6677540">&#34;tcp&#34;</span><span class="op" id="6677545">,</span>&nbsp;<span class="string" id="6677547">&#34;127.0.0.1:0&#34;</span><span class="op" id="6677560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677563">if</span>&nbsp;<span class="ident" id="6677566">err</span>&nbsp;<span class="op" id="6677570">!=</span>&nbsp;<span class="ident" id="6677573">nil</span>&nbsp;<span class="op" id="6677577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677581">t</span><span class="op" id="6677582">.</span><span class="ident" id="6677583">Fatalf</span><span class="op" id="6677589">(</span><span class="string" id="6677590">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6677614">,</span>&nbsp;<span class="ident" id="6677616">err</span><span class="op" id="6677619">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677625">defer</span>&nbsp;<span class="ident" id="6677631">l</span><span class="op" id="6677632">.</span><span class="ident" id="6677633">Close</span><span class="op" id="6677638">(</span><span class="op" id="6677639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677642">l1</span><span class="op" id="6677644">,</span>&nbsp;<span class="ident" id="6677646">err</span>&nbsp;<span class="op" id="6677650">:=</span>&nbsp;<span class="ident" id="6677653">Listen</span><span class="op" id="6677659">(</span><span class="string" id="6677660">&#34;tcp&#34;</span><span class="op" id="6677665">,</span>&nbsp;<span class="ident" id="6677667">l</span><span class="op" id="6677668">.</span><span class="ident" id="6677669">Addr</span><span class="op" id="6677673">(</span><span class="op" id="6677674">)</span><span class="op" id="6677675">.</span><span class="ident" id="6677676">String</span><span class="op" id="6677682">(</span><span class="op" id="6677683">)</span><span class="op" id="6677684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677687">if</span>&nbsp;<span class="ident" id="6677690">err</span>&nbsp;<span class="op" id="6677694">==</span>&nbsp;<span class="ident" id="6677697">nil</span>&nbsp;<span class="op" id="6677701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677705">t</span><span class="op" id="6677706">.</span><span class="ident" id="6677707">Fatalf</span><span class="op" id="6677713">(</span><span class="string" id="6677714">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6677736">,</span>&nbsp;<span class="ident" id="6677738">l</span><span class="op" id="6677739">.</span><span class="ident" id="6677740">Addr</span><span class="op" id="6677744">(</span><span class="op" id="6677745">)</span><span class="op" id="6677746">,</span>&nbsp;<span class="ident" id="6677748">err</span><span class="op" id="6677751">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677757">if</span>&nbsp;<span class="ident" id="6677760">l1</span>&nbsp;<span class="op" id="6677763">!=</span>&nbsp;<span class="ident" id="6677766">nil</span>&nbsp;<span class="op" id="6677770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677774">t</span><span class="op" id="6677775">.</span><span class="ident" id="6677776">Fatalf</span><span class="op" id="6677782">(</span><span class="string" id="6677783">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6677841">,</span>&nbsp;<span class="ident" id="6677843">l1</span><span class="op" id="6677845">,</span>&nbsp;<span class="ident" id="6677847">l1</span><span class="op" id="6677849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6677856">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677919">lp</span><span class="op" id="6677921">,</span>&nbsp;<span class="ident" id="6677923">err</span>&nbsp;<span class="op" id="6677927">:=</span>&nbsp;<span class="ident" id="6677930">ListenPacket</span><span class="op" id="6677942">(</span><span class="string" id="6677943">&#34;udp&#34;</span><span class="op" id="6677948">,</span>&nbsp;<span class="string" id="6677950">&#34;127.0.0.1:0&#34;</span><span class="op" id="6677963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677966">if</span>&nbsp;<span class="ident" id="6677969">err</span>&nbsp;<span class="op" id="6677973">!=</span>&nbsp;<span class="ident" id="6677976">nil</span>&nbsp;<span class="op" id="6677980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677984">t</span><span class="op" id="6677985">.</span><span class="ident" id="6677986">Fatalf</span><span class="op" id="6677992">(</span><span class="string" id="6677993">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6678017">,</span>&nbsp;<span class="ident" id="6678019">err</span><span class="op" id="6678022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678025">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678028">defer</span>&nbsp;<span class="ident" id="6678034">lp</span><span class="op" id="6678036">.</span><span class="ident" id="6678037">Close</span><span class="op" id="6678042">(</span><span class="op" id="6678043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678046">lp1</span><span class="op" id="6678049">,</span>&nbsp;<span class="ident" id="6678051">err</span>&nbsp;<span class="op" id="6678055">:=</span>&nbsp;<span class="ident" id="6678058">ListenPacket</span><span class="op" id="6678070">(</span><span class="string" id="6678071">&#34;udp&#34;</span><span class="op" id="6678076">,</span>&nbsp;<span class="ident" id="6678078">lp</span><span class="op" id="6678080">.</span><span class="ident" id="6678081">LocalAddr</span><span class="op" id="6678090">(</span><span class="op" id="6678091">)</span><span class="op" id="6678092">.</span><span class="ident" id="6678093">String</span><span class="op" id="6678099">(</span><span class="op" id="6678100">)</span><span class="op" id="6678101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678104">if</span>&nbsp;<span class="ident" id="6678107">err</span>&nbsp;<span class="op" id="6678111">==</span>&nbsp;<span class="ident" id="6678114">nil</span>&nbsp;<span class="op" id="6678118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678122">t</span><span class="op" id="6678123">.</span><span class="ident" id="6678124">Fatalf</span><span class="op" id="6678130">(</span><span class="string" id="6678131">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6678153">,</span>&nbsp;<span class="ident" id="6678155">lp</span><span class="op" id="6678157">.</span><span class="ident" id="6678158">LocalAddr</span><span class="op" id="6678167">(</span><span class="op" id="6678168">)</span><span class="op" id="6678169">,</span>&nbsp;<span class="ident" id="6678171">err</span><span class="op" id="6678174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678177">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6678180">if</span>&nbsp;<span class="ident" id="6678183">lp1</span>&nbsp;<span class="op" id="6678187">!=</span>&nbsp;<span class="ident" id="6678190">nil</span>&nbsp;<span class="op" id="6678194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6678198">t</span><span class="op" id="6678199">.</span><span class="ident" id="6678200">Fatalf</span><span class="op" id="6678206">(</span><span class="string" id="6678207">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6678271">,</span>&nbsp;<span class="ident" id="6678273">lp1</span><span class="op" id="6678276">,</span>&nbsp;<span class="ident" id="6678278">lp1</span><span class="op" id="6678281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6678284">}</span><br>
<span class="lineno"></span><span class="op" id="6678286">}</span>
</div>
</body>
</html>
