<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4068881">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4068936">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4068990">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4069041">package</span>&nbsp;<span class="ident" id="4069049">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4069057">import</span>&nbsp;<span class="op" id="4069064">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4069067">&#34;crypto/subtle&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4069084">&#34;errors&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4069093">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4069096">//&nbsp;AEAD&nbsp;is&nbsp;a&nbsp;cipher&nbsp;mode&nbsp;providing&nbsp;authenticated&nbsp;encryption&nbsp;with&nbsp;associated</span><br>
<span class="lineno"></span><span class="comment" id="4069172">//&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4069181">type</span>&nbsp;<span class="ident" id="4069186">AEAD</span>&nbsp;<span class="keyword" id="4069191">interface</span>&nbsp;<span class="op" id="4069201">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069204">//&nbsp;NonceSize&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;nonce&nbsp;that&nbsp;must&nbsp;be&nbsp;passed&nbsp;to&nbsp;Seal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069276">//&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069290">NonceSize</span><span class="op" id="4069299">(</span><span class="op" id="4069300">)</span>&nbsp;<span class="builtintype" id="4069302">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069308">//&nbsp;Overhead&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;difference&nbsp;between&nbsp;the&nbsp;lengths&nbsp;of&nbsp;a</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069377">//&nbsp;plaintext&nbsp;and&nbsp;ciphertext.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069407">Overhead</span><span class="op" id="4069415">(</span><span class="op" id="4069416">)</span>&nbsp;<span class="builtintype" id="4069418">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069424">//&nbsp;Seal&nbsp;encrypts&nbsp;and&nbsp;authenticates&nbsp;plaintext,&nbsp;authenticates&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069489">//&nbsp;additional&nbsp;data&nbsp;and&nbsp;appends&nbsp;the&nbsp;result&nbsp;to&nbsp;dst,&nbsp;returning&nbsp;the&nbsp;updated</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069562">//&nbsp;slice.&nbsp;The&nbsp;nonce&nbsp;must&nbsp;be&nbsp;NonceSize()&nbsp;bytes&nbsp;long&nbsp;and&nbsp;unique&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069633">//&nbsp;time,&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069660">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069664">//&nbsp;The&nbsp;plaintext&nbsp;and&nbsp;dst&nbsp;may&nbsp;alias&nbsp;exactly&nbsp;or&nbsp;not&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069723">Seal</span><span class="op" id="4069727">(</span><span class="ident" id="4069728">dst</span><span class="op" id="4069731">,</span>&nbsp;<span class="ident" id="4069733">nonce</span><span class="op" id="4069738">,</span>&nbsp;<span class="ident" id="4069740">plaintext</span><span class="op" id="4069749">,</span>&nbsp;<span class="ident" id="4069751">data</span>&nbsp;<span class="op" id="4069756">[</span><span class="op" id="4069757">]</span><span class="builtintype" id="4069758">byte</span><span class="op" id="4069762">)</span>&nbsp;<span class="op" id="4069764">[</span><span class="op" id="4069765">]</span><span class="builtintype" id="4069766">byte</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069773">//&nbsp;Open&nbsp;decrypts&nbsp;and&nbsp;authenticates&nbsp;ciphertext,&nbsp;authenticates&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069839">//&nbsp;additional&nbsp;data&nbsp;and,&nbsp;if&nbsp;successful,&nbsp;appends&nbsp;the&nbsp;resulting&nbsp;plaintext</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069911">//&nbsp;to&nbsp;dst,&nbsp;returning&nbsp;the&nbsp;updated&nbsp;slice.&nbsp;The&nbsp;nonce&nbsp;must&nbsp;be&nbsp;NonceSize()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4069982">//&nbsp;bytes&nbsp;long&nbsp;and&nbsp;both&nbsp;it&nbsp;and&nbsp;the&nbsp;additional&nbsp;data&nbsp;must&nbsp;match&nbsp;the</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4070048">//&nbsp;value&nbsp;passed&nbsp;to&nbsp;Seal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4070074">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4070078">//&nbsp;The&nbsp;ciphertext&nbsp;and&nbsp;dst&nbsp;may&nbsp;alias&nbsp;exactly&nbsp;or&nbsp;not&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070138">Open</span><span class="op" id="4070142">(</span><span class="ident" id="4070143">dst</span><span class="op" id="4070146">,</span>&nbsp;<span class="ident" id="4070148">nonce</span><span class="op" id="4070153">,</span>&nbsp;<span class="ident" id="4070155">ciphertext</span><span class="op" id="4070165">,</span>&nbsp;<span class="ident" id="4070167">data</span>&nbsp;<span class="op" id="4070172">[</span><span class="op" id="4070173">]</span><span class="builtintype" id="4070174">byte</span><span class="op" id="4070178">)</span>&nbsp;<span class="op" id="4070180">(</span><span class="op" id="4070181">[</span><span class="op" id="4070182">]</span><span class="builtintype" id="4070183">byte</span><span class="op" id="4070187">,</span>&nbsp;<span class="builtintype" id="4070189">error</span><span class="op" id="4070194">)</span><br>
<span class="lineno"></span><span class="op" id="4070196">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4070199">//&nbsp;gcmFieldElement&nbsp;represents&nbsp;a&nbsp;value&nbsp;in&nbsp;GF(2¹²⁸).&nbsp;In&nbsp;order&nbsp;to&nbsp;reflect&nbsp;the&nbsp;GCM</span><br>
<span class="lineno"></span><span class="comment" id="4070282">//&nbsp;standard&nbsp;and&nbsp;make&nbsp;getUint64&nbsp;suitable&nbsp;for&nbsp;marshaling&nbsp;these&nbsp;values,&nbsp;the&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="4070360">//&nbsp;are&nbsp;stored&nbsp;backwards.&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="4070398">//&nbsp;&nbsp;&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;x⁰&nbsp;can&nbsp;be&nbsp;obtained&nbsp;by&nbsp;v.low&nbsp;&gt;&gt;&nbsp;63.</span><br>
<span class="lineno">45</span><span class="comment" id="4070459">//&nbsp;&nbsp;&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;x⁶³&nbsp;can&nbsp;be&nbsp;obtained&nbsp;by&nbsp;v.low&nbsp;&amp;&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4070520">//&nbsp;&nbsp;&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;x⁶⁴&nbsp;can&nbsp;be&nbsp;obtained&nbsp;by&nbsp;v.high&nbsp;&gt;&gt;&nbsp;63.</span><br>
<span class="lineno"></span><span class="comment" id="4070585">//&nbsp;&nbsp;&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;x¹²⁷&nbsp;can&nbsp;be&nbsp;obtained&nbsp;by&nbsp;v.high&nbsp;&amp;&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="4070649">type</span>&nbsp;<span class="ident" id="4070654">gcmFieldElement</span>&nbsp;<span class="keyword" id="4070670">struct</span>&nbsp;<span class="op" id="4070677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070680">low</span><span class="op" id="4070683">,</span>&nbsp;<span class="ident" id="4070685">high</span>&nbsp;<span class="ident" id="4070690">uint64</span><br>
<span class="lineno">50</span><span class="op" id="4070697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4070700">//&nbsp;gcm&nbsp;represents&nbsp;a&nbsp;Galois&nbsp;Counter&nbsp;Mode&nbsp;with&nbsp;a&nbsp;specific&nbsp;key.&nbsp;See</span><br>
<span class="lineno"></span><span class="comment" id="4070765">//&nbsp;http://csrc.nist.gov/groups/ST/toolkit/BCM/documents/proposedmodes/gcm/gcm-revised-spec.pdf</span><br>
<span class="lineno"></span><span class="keyword" id="4070860">type</span>&nbsp;<span class="ident" id="4070865">gcm</span>&nbsp;<span class="keyword" id="4070869">struct</span>&nbsp;<span class="op" id="4070876">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070879">cipher</span>&nbsp;<span class="ident" id="4070886"><a href="/crypto/cipher/cipher.go.html#4066162">Block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4070893">//&nbsp;productTable&nbsp;contains&nbsp;the&nbsp;first&nbsp;sixteen&nbsp;powers&nbsp;of&nbsp;the&nbsp;key,&nbsp;H.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4070959">//&nbsp;However,&nbsp;they&nbsp;are&nbsp;in&nbsp;bit&nbsp;reversed&nbsp;order.&nbsp;See&nbsp;NewGCM.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071016">productTable</span>&nbsp;<span class="op" id="4071029">[</span><span class="num" id="4071030">16</span><span class="op" id="4071032">]</span><span class="ident" id="4071033"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><br>
<span class="lineno"></span><span class="op" id="4071049">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4071052">//&nbsp;NewGCM&nbsp;returns&nbsp;the&nbsp;given&nbsp;128-bit,&nbsp;block&nbsp;cipher&nbsp;wrapped&nbsp;in&nbsp;Galois&nbsp;Counter&nbsp;Mode.</span><br>
<span class="lineno"></span><span class="keyword" id="4071134">func</span>&nbsp;<span class="ident" id="4071139">NewGCM</span><span class="op" id="4071145">(</span><span class="ident" id="4071146">cipher</span>&nbsp;<span class="ident" id="4071153"><a href="/crypto/cipher/cipher.go.html#4066162">Block</a></span><span class="op" id="4071158">)</span>&nbsp;<span class="op" id="4071160">(</span><span class="ident" id="4071161"><a href="/crypto/cipher/gcm.go.html#4069186">AEAD</a></span><span class="op" id="4071165">,</span>&nbsp;<span class="builtintype" id="4071167">error</span><span class="op" id="4071172">)</span>&nbsp;<span class="op" id="4071174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071177">if</span>&nbsp;<span class="ident" id="4071180"><a href="/crypto/cipher/gcm.go.html#4071146">cipher</a></span><span class="op" id="4071186">.</span><span class="ident" id="4071187">BlockSize</span><span class="op" id="4071196">(</span><span class="op" id="4071197">)</span>&nbsp;<span class="op" id="4071199">!=</span>&nbsp;<span class="ident" id="4071202"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span>&nbsp;<span class="op" id="4071215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071219">return</span>&nbsp;<span class="ident" id="4071226">nil</span><span class="op" id="4071229">,</span>&nbsp;<span class="ident" id="4071231"><a href="/crypto/cipher/gcm.go.html#4069084">errors</a></span><span class="op" id="4071237">.</span><span class="ident" id="4071238">New</span><span class="op" id="4071241">(</span><span class="string" id="4071242">&#34;cipher:&nbsp;NewGCM&nbsp;requires&nbsp;128-bit&nbsp;block&nbsp;cipher&#34;</span><span class="op" id="4071288">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071295">var</span>&nbsp;<span class="ident" id="4071299">key</span>&nbsp;<span class="op" id="4071303">[</span><span class="ident" id="4071304"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4071316">]</span><span class="builtintype" id="4071317">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071323"><a href="/crypto/cipher/gcm.go.html#4071146">cipher</a></span><span class="op" id="4071329">.</span><span class="ident" id="4071330">Encrypt</span><span class="op" id="4071337">(</span><span class="ident" id="4071338"><a href="/crypto/cipher/gcm.go.html#4071299">key</a></span><span class="op" id="4071341">[</span><span class="op" id="4071342">:</span><span class="op" id="4071343">]</span><span class="op" id="4071344">,</span>&nbsp;<span class="ident" id="4071346"><a href="/crypto/cipher/gcm.go.html#4071299">key</a></span><span class="op" id="4071349">[</span><span class="op" id="4071350">:</span><span class="op" id="4071351">]</span><span class="op" id="4071352">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071356">g</span>&nbsp;<span class="op" id="4071358">:=</span>&nbsp;<span class="op" id="4071361">&amp;</span><span class="ident" id="4071362"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4071365">{</span><span class="ident" id="4071366">cipher</span><span class="op" id="4071372">:</span>&nbsp;<span class="ident" id="4071374"><a href="/crypto/cipher/gcm.go.html#4071146">cipher</a></span><span class="op" id="4071380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071384">//&nbsp;We&nbsp;precompute&nbsp;16&nbsp;multiples&nbsp;of&nbsp;|key|.&nbsp;However,&nbsp;when&nbsp;we&nbsp;do&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071453">//&nbsp;into&nbsp;this&nbsp;table&nbsp;we&#39;ll&nbsp;be&nbsp;using&nbsp;bits&nbsp;from&nbsp;a&nbsp;field&nbsp;element&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071518">//&nbsp;therefore&nbsp;the&nbsp;bits&nbsp;will&nbsp;be&nbsp;in&nbsp;the&nbsp;reverse&nbsp;order.&nbsp;So&nbsp;normally&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071587">//&nbsp;would&nbsp;expect,&nbsp;say,&nbsp;4*key&nbsp;to&nbsp;be&nbsp;in&nbsp;index&nbsp;4&nbsp;of&nbsp;the&nbsp;table&nbsp;but&nbsp;due&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071657">//&nbsp;this&nbsp;bit&nbsp;ordering&nbsp;it&nbsp;will&nbsp;actually&nbsp;be&nbsp;in&nbsp;index&nbsp;0010&nbsp;(base&nbsp;2)&nbsp;=&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071727">x</span>&nbsp;<span class="op" id="4071729">:=</span>&nbsp;<span class="ident" id="4071732"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><span class="op" id="4071747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071751"><a href="/crypto/cipher/gcm.go.html#4078211">getUint64</a></span><span class="op" id="4071760">(</span><span class="ident" id="4071761"><a href="/crypto/cipher/gcm.go.html#4071299">key</a></span><span class="op" id="4071764">[</span><span class="op" id="4071765">:</span><span class="num" id="4071766">8</span><span class="op" id="4071767">]</span><span class="op" id="4071768">)</span><span class="op" id="4071769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071773"><a href="/crypto/cipher/gcm.go.html#4078211">getUint64</a></span><span class="op" id="4071782">(</span><span class="ident" id="4071783"><a href="/crypto/cipher/gcm.go.html#4071299">key</a></span><span class="op" id="4071786">[</span><span class="num" id="4071787">8</span><span class="op" id="4071788">:</span><span class="op" id="4071789">]</span><span class="op" id="4071790">)</span><span class="op" id="4071791">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071797"><a href="/crypto/cipher/gcm.go.html#4071356">g</a></span><span class="op" id="4071798">.</span><span class="ident" id="4071799">productTable</span><span class="op" id="4071811">[</span><span class="ident" id="4071812"><a href="/crypto/cipher/gcm.go.html#4073697">reverseBits</a></span><span class="op" id="4071823">(</span><span class="num" id="4071824">1</span><span class="op" id="4071825">)</span><span class="op" id="4071826">]</span>&nbsp;<span class="op" id="4071828">=</span>&nbsp;<span class="ident" id="4071830"><a href="/crypto/cipher/gcm.go.html#4071727">x</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071834">for</span>&nbsp;<span class="ident" id="4071838">i</span>&nbsp;<span class="op" id="4071840">:=</span>&nbsp;<span class="num" id="4071843">2</span><span class="op" id="4071844">;</span>&nbsp;<span class="ident" id="4071846"><a href="/crypto/cipher/gcm.go.html#4071838">i</a></span>&nbsp;<span class="op" id="4071848">&lt;</span>&nbsp;<span class="num" id="4071850">16</span><span class="op" id="4071852">;</span>&nbsp;<span class="ident" id="4071854"><a href="/crypto/cipher/gcm.go.html#4071838">i</a></span>&nbsp;<span class="op" id="4071856">+=</span>&nbsp;<span class="num" id="4071859">2</span>&nbsp;<span class="op" id="4071861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071865"><a href="/crypto/cipher/gcm.go.html#4071356">g</a></span><span class="op" id="4071866">.</span><span class="ident" id="4071867">productTable</span><span class="op" id="4071879">[</span><span class="ident" id="4071880"><a href="/crypto/cipher/gcm.go.html#4073697">reverseBits</a></span><span class="op" id="4071891">(</span><span class="ident" id="4071892"><a href="/crypto/cipher/gcm.go.html#4071838">i</a></span><span class="op" id="4071893">)</span><span class="op" id="4071894">]</span>&nbsp;<span class="op" id="4071896">=</span>&nbsp;<span class="ident" id="4071898"><a href="/crypto/cipher/gcm.go.html#4074125">gcmDouble</a></span><span class="op" id="4071907">(</span><span class="op" id="4071908">&amp;</span><span class="ident" id="4071909"><a href="/crypto/cipher/gcm.go.html#4071356">g</a></span><span class="op" id="4071910">.</span><span class="ident" id="4071911">productTable</span><span class="op" id="4071923">[</span><span class="ident" id="4071924"><a href="/crypto/cipher/gcm.go.html#4073697">reverseBits</a></span><span class="op" id="4071935">(</span><span class="ident" id="4071936"><a href="/crypto/cipher/gcm.go.html#4071838">i</a></span><span class="op" id="4071937">/</span><span class="num" id="4071938">2</span><span class="op" id="4071939">)</span><span class="op" id="4071940">]</span><span class="op" id="4071941">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071945"><a href="/crypto/cipher/gcm.go.html#4071356">g</a></span><span class="op" id="4071946">.</span><span class="ident" id="4071947">productTable</span><span class="op" id="4071959">[</span><span class="ident" id="4071960"><a href="/crypto/cipher/gcm.go.html#4073697">reverseBits</a></span><span class="op" id="4071971">(</span><span class="ident" id="4071972"><a href="/crypto/cipher/gcm.go.html#4071838">i</a></span><span class="op" id="4071973">+</span><span class="num" id="4071974">1</span><span class="op" id="4071975">)</span><span class="op" id="4071976">]</span>&nbsp;<span class="op" id="4071978">=</span>&nbsp;<span class="ident" id="4071980"><a href="/crypto/cipher/gcm.go.html#4073887">gcmAdd</a></span><span class="op" id="4071986">(</span><span class="op" id="4071987">&amp;</span><span class="ident" id="4071988"><a href="/crypto/cipher/gcm.go.html#4071356">g</a></span><span class="op" id="4071989">.</span><span class="ident" id="4071990">productTable</span><span class="op" id="4072002">[</span><span class="ident" id="4072003"><a href="/crypto/cipher/gcm.go.html#4073697">reverseBits</a></span><span class="op" id="4072014">(</span><span class="ident" id="4072015"><a href="/crypto/cipher/gcm.go.html#4071838">i</a></span><span class="op" id="4072016">)</span><span class="op" id="4072017">]</span><span class="op" id="4072018">,</span>&nbsp;<span class="op" id="4072020">&amp;</span><span class="ident" id="4072021"><a href="/crypto/cipher/gcm.go.html#4071727">x</a></span><span class="op" id="4072022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072029">return</span>&nbsp;<span class="ident" id="4072036"><a href="/crypto/cipher/gcm.go.html#4071356">g</a></span><span class="op" id="4072037">,</span>&nbsp;<span class="ident" id="4072039">nil</span><br>
<span class="lineno"></span><span class="op" id="4072043">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="4072046">const</span>&nbsp;<span class="op" id="4072052">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072055">gcmBlockSize</span>&nbsp;<span class="op" id="4072068">=</span>&nbsp;<span class="num" id="4072070">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072074">gcmTagSize</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4072087">=</span>&nbsp;<span class="num" id="4072089">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072093">gcmNonceSize</span>&nbsp;<span class="op" id="4072106">=</span>&nbsp;<span class="num" id="4072108">12</span><br>
<span class="lineno">95</span><span class="op" id="4072111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4072114">func</span>&nbsp;<span class="op" id="4072119">(</span><span class="op" id="4072120">*</span><span class="ident" id="4072121"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4072124">)</span>&nbsp;<span class="ident" id="4072126">NonceSize</span><span class="op" id="4072135">(</span><span class="op" id="4072136">)</span>&nbsp;<span class="builtintype" id="4072138">int</span>&nbsp;<span class="op" id="4072142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072145">return</span>&nbsp;<span class="ident" id="4072152"><a href="/crypto/cipher/gcm.go.html#4072093">gcmNonceSize</a></span><br>
<span class="lineno"></span><span class="op" id="4072165">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4072168">func</span>&nbsp;<span class="op" id="4072173">(</span><span class="op" id="4072174">*</span><span class="ident" id="4072175"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4072178">)</span>&nbsp;<span class="ident" id="4072180">Overhead</span><span class="op" id="4072188">(</span><span class="op" id="4072189">)</span>&nbsp;<span class="builtintype" id="4072191">int</span>&nbsp;<span class="op" id="4072195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072198">return</span>&nbsp;<span class="ident" id="4072205"><a href="/crypto/cipher/gcm.go.html#4072074">gcmTagSize</a></span><br>
<span class="lineno"></span><span class="op" id="4072216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4072219">func</span>&nbsp;<span class="op" id="4072224">(</span><span class="ident" id="4072225">g</span>&nbsp;<span class="op" id="4072227">*</span><span class="ident" id="4072228"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4072231">)</span>&nbsp;<span class="ident" id="4072233">Seal</span><span class="op" id="4072237">(</span><span class="ident" id="4072238">dst</span><span class="op" id="4072241">,</span>&nbsp;<span class="ident" id="4072243">nonce</span><span class="op" id="4072248">,</span>&nbsp;<span class="ident" id="4072250">plaintext</span><span class="op" id="4072259">,</span>&nbsp;<span class="ident" id="4072261">data</span>&nbsp;<span class="op" id="4072266">[</span><span class="op" id="4072267">]</span><span class="builtintype" id="4072268">byte</span><span class="op" id="4072272">)</span>&nbsp;<span class="op" id="4072274">[</span><span class="op" id="4072275">]</span><span class="builtintype" id="4072276">byte</span>&nbsp;<span class="op" id="4072281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072284">if</span>&nbsp;<span class="builtinfunc" id="4072287">len</span><span class="op" id="4072290">(</span><span class="ident" id="4072291"><a href="/crypto/cipher/gcm.go.html#4072243">nonce</a></span><span class="op" id="4072296">)</span>&nbsp;<span class="op" id="4072298">!=</span>&nbsp;<span class="ident" id="4072301"><a href="/crypto/cipher/gcm.go.html#4072093">gcmNonceSize</a></span>&nbsp;<span class="op" id="4072314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4072318">panic</span><span class="op" id="4072323">(</span><span class="string" id="4072324">&#34;cipher:&nbsp;incorrect&nbsp;nonce&nbsp;length&nbsp;given&nbsp;to&nbsp;GCM&#34;</span><span class="op" id="4072369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072376">ret</span><span class="op" id="4072379">,</span>&nbsp;<span class="ident" id="4072381">out</span>&nbsp;<span class="op" id="4072385">:=</span>&nbsp;<span class="ident" id="4072388"><a href="/crypto/cipher/gcm.go.html#4077068">sliceForAppend</a></span><span class="op" id="4072402">(</span><span class="ident" id="4072403"><a href="/crypto/cipher/gcm.go.html#4072238">dst</a></span><span class="op" id="4072406">,</span>&nbsp;<span class="builtinfunc" id="4072408">len</span><span class="op" id="4072411">(</span><span class="ident" id="4072412"><a href="/crypto/cipher/gcm.go.html#4072250">plaintext</a></span><span class="op" id="4072421">)</span><span class="op" id="4072422">+</span><span class="ident" id="4072423"><a href="/crypto/cipher/gcm.go.html#4072074">gcmTagSize</a></span><span class="op" id="4072433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4072437">//&nbsp;See&nbsp;GCM&nbsp;spec,&nbsp;section&nbsp;7.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072468">var</span>&nbsp;<span class="ident" id="4072472">counter</span><span class="op" id="4072479">,</span>&nbsp;<span class="ident" id="4072481">tagMask</span>&nbsp;<span class="op" id="4072489">[</span><span class="ident" id="4072490"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4072502">]</span><span class="builtintype" id="4072503">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4072509">copy</span><span class="op" id="4072513">(</span><span class="ident" id="4072514"><a href="/crypto/cipher/gcm.go.html#4072472">counter</a></span><span class="op" id="4072521">[</span><span class="op" id="4072522">:</span><span class="op" id="4072523">]</span><span class="op" id="4072524">,</span>&nbsp;<span class="ident" id="4072526"><a href="/crypto/cipher/gcm.go.html#4072243">nonce</a></span><span class="op" id="4072531">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072534"><a href="/crypto/cipher/gcm.go.html#4072472">counter</a></span><span class="op" id="4072541">[</span><span class="ident" id="4072542"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4072554">-</span><span class="num" id="4072555">1</span><span class="op" id="4072556">]</span>&nbsp;<span class="op" id="4072558">=</span>&nbsp;<span class="num" id="4072560">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072564"><a href="/crypto/cipher/gcm.go.html#4072225">g</a></span><span class="op" id="4072565">.</span><span class="ident" id="4072566">cipher</span><span class="op" id="4072572">.</span><span class="ident" id="4072573">Encrypt</span><span class="op" id="4072580">(</span><span class="ident" id="4072581"><a href="/crypto/cipher/gcm.go.html#4072481">tagMask</a></span><span class="op" id="4072588">[</span><span class="op" id="4072589">:</span><span class="op" id="4072590">]</span><span class="op" id="4072591">,</span>&nbsp;<span class="ident" id="4072593"><a href="/crypto/cipher/gcm.go.html#4072472">counter</a></span><span class="op" id="4072600">[</span><span class="op" id="4072601">:</span><span class="op" id="4072602">]</span><span class="op" id="4072603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072606"><a href="/crypto/cipher/gcm.go.html#4076594">gcmInc32</a></span><span class="op" id="4072614">(</span><span class="op" id="4072615">&amp;</span><span class="ident" id="4072616"><a href="/crypto/cipher/gcm.go.html#4072472">counter</a></span><span class="op" id="4072623">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072627"><a href="/crypto/cipher/gcm.go.html#4072225">g</a></span><span class="op" id="4072628">.</span><span class="ident" id="4072629">counterCrypt</span><span class="op" id="4072641">(</span><span class="ident" id="4072642"><a href="/crypto/cipher/gcm.go.html#4072381">out</a></span><span class="op" id="4072645">,</span>&nbsp;<span class="ident" id="4072647"><a href="/crypto/cipher/gcm.go.html#4072250">plaintext</a></span><span class="op" id="4072656">,</span>&nbsp;<span class="op" id="4072658">&amp;</span><span class="ident" id="4072659"><a href="/crypto/cipher/gcm.go.html#4072472">counter</a></span><span class="op" id="4072666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072669"><a href="/crypto/cipher/gcm.go.html#4072225">g</a></span><span class="op" id="4072670">.</span><span class="ident" id="4072671">auth</span><span class="op" id="4072675">(</span><span class="ident" id="4072676"><a href="/crypto/cipher/gcm.go.html#4072381">out</a></span><span class="op" id="4072679">[</span><span class="builtinfunc" id="4072680">len</span><span class="op" id="4072683">(</span><span class="ident" id="4072684"><a href="/crypto/cipher/gcm.go.html#4072250">plaintext</a></span><span class="op" id="4072693">)</span><span class="op" id="4072694">:</span><span class="op" id="4072695">]</span><span class="op" id="4072696">,</span>&nbsp;<span class="ident" id="4072698"><a href="/crypto/cipher/gcm.go.html#4072381">out</a></span><span class="op" id="4072701">[</span><span class="op" id="4072702">:</span><span class="builtinfunc" id="4072703">len</span><span class="op" id="4072706">(</span><span class="ident" id="4072707"><a href="/crypto/cipher/gcm.go.html#4072250">plaintext</a></span><span class="op" id="4072716">)</span><span class="op" id="4072717">]</span><span class="op" id="4072718">,</span>&nbsp;<span class="ident" id="4072720"><a href="/crypto/cipher/gcm.go.html#4072261">data</a></span><span class="op" id="4072724">,</span>&nbsp;<span class="op" id="4072726">&amp;</span><span class="ident" id="4072727"><a href="/crypto/cipher/gcm.go.html#4072481">tagMask</a></span><span class="op" id="4072734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072738">return</span>&nbsp;<span class="ident" id="4072745"><a href="/crypto/cipher/gcm.go.html#4072376">ret</a></span><br>
<span class="lineno"></span><span class="op" id="4072749">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="4072752">var</span>&nbsp;<span class="ident" id="4072756">errOpen</span>&nbsp;<span class="op" id="4072764">=</span>&nbsp;<span class="ident" id="4072766"><a href="/crypto/cipher/gcm.go.html#4069084">errors</a></span><span class="op" id="4072772">.</span><span class="ident" id="4072773">New</span><span class="op" id="4072776">(</span><span class="string" id="4072777">&#34;cipher:&nbsp;message&nbsp;authentication&nbsp;failed&#34;</span><span class="op" id="4072816">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4072819">func</span>&nbsp;<span class="op" id="4072824">(</span><span class="ident" id="4072825">g</span>&nbsp;<span class="op" id="4072827">*</span><span class="ident" id="4072828"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4072831">)</span>&nbsp;<span class="ident" id="4072833">Open</span><span class="op" id="4072837">(</span><span class="ident" id="4072838">dst</span><span class="op" id="4072841">,</span>&nbsp;<span class="ident" id="4072843">nonce</span><span class="op" id="4072848">,</span>&nbsp;<span class="ident" id="4072850">ciphertext</span><span class="op" id="4072860">,</span>&nbsp;<span class="ident" id="4072862">data</span>&nbsp;<span class="op" id="4072867">[</span><span class="op" id="4072868">]</span><span class="builtintype" id="4072869">byte</span><span class="op" id="4072873">)</span>&nbsp;<span class="op" id="4072875">(</span><span class="op" id="4072876">[</span><span class="op" id="4072877">]</span><span class="builtintype" id="4072878">byte</span><span class="op" id="4072882">,</span>&nbsp;<span class="builtintype" id="4072884">error</span><span class="op" id="4072889">)</span>&nbsp;<span class="op" id="4072891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072894">if</span>&nbsp;<span class="builtinfunc" id="4072897">len</span><span class="op" id="4072900">(</span><span class="ident" id="4072901"><a href="/crypto/cipher/gcm.go.html#4072843">nonce</a></span><span class="op" id="4072906">)</span>&nbsp;<span class="op" id="4072908">!=</span>&nbsp;<span class="ident" id="4072911"><a href="/crypto/cipher/gcm.go.html#4072093">gcmNonceSize</a></span>&nbsp;<span class="op" id="4072924">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4072928">panic</span><span class="op" id="4072933">(</span><span class="string" id="4072934">&#34;cipher:&nbsp;incorrect&nbsp;nonce&nbsp;length&nbsp;given&nbsp;to&nbsp;GCM&#34;</span><span class="op" id="4072979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072986">if</span>&nbsp;<span class="builtinfunc" id="4072989">len</span><span class="op" id="4072992">(</span><span class="ident" id="4072993"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span><span class="op" id="4073003">)</span>&nbsp;<span class="op" id="4073005">&lt;</span>&nbsp;<span class="ident" id="4073007"><a href="/crypto/cipher/gcm.go.html#4072074">gcmTagSize</a></span>&nbsp;<span class="op" id="4073018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073022">return</span>&nbsp;<span class="ident" id="4073029">nil</span><span class="op" id="4073032">,</span>&nbsp;<span class="ident" id="4073034"><a href="/crypto/cipher/gcm.go.html#4072756">errOpen</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073046">tag</span>&nbsp;<span class="op" id="4073050">:=</span>&nbsp;<span class="ident" id="4073053"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span><span class="op" id="4073063">[</span><span class="builtinfunc" id="4073064">len</span><span class="op" id="4073067">(</span><span class="ident" id="4073068"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span><span class="op" id="4073078">)</span><span class="op" id="4073079">-</span><span class="ident" id="4073080"><a href="/crypto/cipher/gcm.go.html#4072074">gcmTagSize</a></span><span class="op" id="4073090">:</span><span class="op" id="4073091">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073094"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span>&nbsp;<span class="op" id="4073105">=</span>&nbsp;<span class="ident" id="4073107"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span><span class="op" id="4073117">[</span><span class="op" id="4073118">:</span><span class="builtinfunc" id="4073119">len</span><span class="op" id="4073122">(</span><span class="ident" id="4073123"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span><span class="op" id="4073133">)</span><span class="op" id="4073134">-</span><span class="ident" id="4073135"><a href="/crypto/cipher/gcm.go.html#4072074">gcmTagSize</a></span><span class="op" id="4073145">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4073149">//&nbsp;See&nbsp;GCM&nbsp;spec,&nbsp;section&nbsp;7.1.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073180">var</span>&nbsp;<span class="ident" id="4073184">counter</span><span class="op" id="4073191">,</span>&nbsp;<span class="ident" id="4073193">tagMask</span>&nbsp;<span class="op" id="4073201">[</span><span class="ident" id="4073202"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4073214">]</span><span class="builtintype" id="4073215">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4073221">copy</span><span class="op" id="4073225">(</span><span class="ident" id="4073226"><a href="/crypto/cipher/gcm.go.html#4073184">counter</a></span><span class="op" id="4073233">[</span><span class="op" id="4073234">:</span><span class="op" id="4073235">]</span><span class="op" id="4073236">,</span>&nbsp;<span class="ident" id="4073238"><a href="/crypto/cipher/gcm.go.html#4072843">nonce</a></span><span class="op" id="4073243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073246"><a href="/crypto/cipher/gcm.go.html#4073184">counter</a></span><span class="op" id="4073253">[</span><span class="ident" id="4073254"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4073266">-</span><span class="num" id="4073267">1</span><span class="op" id="4073268">]</span>&nbsp;<span class="op" id="4073270">=</span>&nbsp;<span class="num" id="4073272">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073276"><a href="/crypto/cipher/gcm.go.html#4072825">g</a></span><span class="op" id="4073277">.</span><span class="ident" id="4073278">cipher</span><span class="op" id="4073284">.</span><span class="ident" id="4073285">Encrypt</span><span class="op" id="4073292">(</span><span class="ident" id="4073293"><a href="/crypto/cipher/gcm.go.html#4073193">tagMask</a></span><span class="op" id="4073300">[</span><span class="op" id="4073301">:</span><span class="op" id="4073302">]</span><span class="op" id="4073303">,</span>&nbsp;<span class="ident" id="4073305"><a href="/crypto/cipher/gcm.go.html#4073184">counter</a></span><span class="op" id="4073312">[</span><span class="op" id="4073313">:</span><span class="op" id="4073314">]</span><span class="op" id="4073315">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073318"><a href="/crypto/cipher/gcm.go.html#4076594">gcmInc32</a></span><span class="op" id="4073326">(</span><span class="op" id="4073327">&amp;</span><span class="ident" id="4073328"><a href="/crypto/cipher/gcm.go.html#4073184">counter</a></span><span class="op" id="4073335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073339">var</span>&nbsp;<span class="ident" id="4073343">expectedTag</span>&nbsp;<span class="op" id="4073355">[</span><span class="ident" id="4073356"><a href="/crypto/cipher/gcm.go.html#4072074">gcmTagSize</a></span><span class="op" id="4073366">]</span><span class="builtintype" id="4073367">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073373"><a href="/crypto/cipher/gcm.go.html#4072825">g</a></span><span class="op" id="4073374">.</span><span class="ident" id="4073375">auth</span><span class="op" id="4073379">(</span><span class="ident" id="4073380"><a href="/crypto/cipher/gcm.go.html#4073343">expectedTag</a></span><span class="op" id="4073391">[</span><span class="op" id="4073392">:</span><span class="op" id="4073393">]</span><span class="op" id="4073394">,</span>&nbsp;<span class="ident" id="4073396"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span><span class="op" id="4073406">,</span>&nbsp;<span class="ident" id="4073408"><a href="/crypto/cipher/gcm.go.html#4072862">data</a></span><span class="op" id="4073412">,</span>&nbsp;<span class="op" id="4073414">&amp;</span><span class="ident" id="4073415"><a href="/crypto/cipher/gcm.go.html#4073193">tagMask</a></span><span class="op" id="4073422">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073426">if</span>&nbsp;<span class="ident" id="4073429"><a href="/crypto/cipher/gcm.go.html#4069067">subtle</a></span><span class="op" id="4073435">.</span><span class="ident" id="4073436">ConstantTimeCompare</span><span class="op" id="4073455">(</span><span class="ident" id="4073456"><a href="/crypto/cipher/gcm.go.html#4073343">expectedTag</a></span><span class="op" id="4073467">[</span><span class="op" id="4073468">:</span><span class="op" id="4073469">]</span><span class="op" id="4073470">,</span>&nbsp;<span class="ident" id="4073472"><a href="/crypto/cipher/gcm.go.html#4073046">tag</a></span><span class="op" id="4073475">)</span>&nbsp;<span class="op" id="4073477">!=</span>&nbsp;<span class="num" id="4073480">1</span>&nbsp;<span class="op" id="4073482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073486">return</span>&nbsp;<span class="ident" id="4073493">nil</span><span class="op" id="4073496">,</span>&nbsp;<span class="ident" id="4073498"><a href="/crypto/cipher/gcm.go.html#4072756">errOpen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073511">ret</span><span class="op" id="4073514">,</span>&nbsp;<span class="ident" id="4073516">out</span>&nbsp;<span class="op" id="4073520">:=</span>&nbsp;<span class="ident" id="4073523"><a href="/crypto/cipher/gcm.go.html#4077068">sliceForAppend</a></span><span class="op" id="4073537">(</span><span class="ident" id="4073538"><a href="/crypto/cipher/gcm.go.html#4072838">dst</a></span><span class="op" id="4073541">,</span>&nbsp;<span class="builtinfunc" id="4073543">len</span><span class="op" id="4073546">(</span><span class="ident" id="4073547"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span><span class="op" id="4073557">)</span><span class="op" id="4073558">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073561"><a href="/crypto/cipher/gcm.go.html#4072825">g</a></span><span class="op" id="4073562">.</span><span class="ident" id="4073563">counterCrypt</span><span class="op" id="4073575">(</span><span class="ident" id="4073576"><a href="/crypto/cipher/gcm.go.html#4073516">out</a></span><span class="op" id="4073579">,</span>&nbsp;<span class="ident" id="4073581"><a href="/crypto/cipher/gcm.go.html#4072850">ciphertext</a></span><span class="op" id="4073591">,</span>&nbsp;<span class="op" id="4073593">&amp;</span><span class="ident" id="4073594"><a href="/crypto/cipher/gcm.go.html#4073184">counter</a></span><span class="op" id="4073601">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073605">return</span>&nbsp;<span class="ident" id="4073612"><a href="/crypto/cipher/gcm.go.html#4073511">ret</a></span><span class="op" id="4073615">,</span>&nbsp;<span class="ident" id="4073617">nil</span><br>
<span class="lineno"></span><span class="op" id="4073621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="4073624">//&nbsp;reverseBits&nbsp;reverses&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;bits&nbsp;of&nbsp;4-bit&nbsp;number&nbsp;in&nbsp;i.</span><br>
<span class="lineno"></span><span class="keyword" id="4073692">func</span>&nbsp;<span class="ident" id="4073697">reverseBits</span><span class="op" id="4073708">(</span><span class="ident" id="4073709">i</span>&nbsp;<span class="builtintype" id="4073711">int</span><span class="op" id="4073714">)</span>&nbsp;<span class="builtintype" id="4073716">int</span>&nbsp;<span class="op" id="4073720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073723"><a href="/crypto/cipher/gcm.go.html#4073709">i</a></span>&nbsp;<span class="op" id="4073725">=</span>&nbsp;<span class="op" id="4073727">(</span><span class="op" id="4073728">(</span><span class="ident" id="4073729"><a href="/crypto/cipher/gcm.go.html#4073709">i</a></span>&nbsp;<span class="op" id="4073731">&lt;&lt;</span>&nbsp;<span class="num" id="4073734">2</span><span class="op" id="4073735">)</span>&nbsp;<span class="op" id="4073737">&amp;</span>&nbsp;<span class="num" id="4073739">0xc</span><span class="op" id="4073742">)</span>&nbsp;<span class="op" id="4073744">|</span>&nbsp;<span class="op" id="4073746">(</span><span class="op" id="4073747">(</span><span class="ident" id="4073748"><a href="/crypto/cipher/gcm.go.html#4073709">i</a></span>&nbsp;<span class="op" id="4073750">&gt;&gt;</span>&nbsp;<span class="num" id="4073753">2</span><span class="op" id="4073754">)</span>&nbsp;<span class="op" id="4073756">&amp;</span>&nbsp;<span class="num" id="4073758">0x3</span><span class="op" id="4073761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073764"><a href="/crypto/cipher/gcm.go.html#4073709">i</a></span>&nbsp;<span class="op" id="4073766">=</span>&nbsp;<span class="op" id="4073768">(</span><span class="op" id="4073769">(</span><span class="ident" id="4073770"><a href="/crypto/cipher/gcm.go.html#4073709">i</a></span>&nbsp;<span class="op" id="4073772">&lt;&lt;</span>&nbsp;<span class="num" id="4073775">1</span><span class="op" id="4073776">)</span>&nbsp;<span class="op" id="4073778">&amp;</span>&nbsp;<span class="num" id="4073780">0xa</span><span class="op" id="4073783">)</span>&nbsp;<span class="op" id="4073785">|</span>&nbsp;<span class="op" id="4073787">(</span><span class="op" id="4073788">(</span><span class="ident" id="4073789"><a href="/crypto/cipher/gcm.go.html#4073709">i</a></span>&nbsp;<span class="op" id="4073791">&gt;&gt;</span>&nbsp;<span class="num" id="4073794">1</span><span class="op" id="4073795">)</span>&nbsp;<span class="op" id="4073797">&amp;</span>&nbsp;<span class="num" id="4073799">0x5</span><span class="op" id="4073802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073805">return</span>&nbsp;<span class="ident" id="4073812"><a href="/crypto/cipher/gcm.go.html#4073709">i</a></span><br>
<span class="lineno">165</span><span class="op" id="4073814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4073817">//&nbsp;gcmAdd&nbsp;adds&nbsp;two&nbsp;elements&nbsp;of&nbsp;GF(2¹²⁸)&nbsp;and&nbsp;returns&nbsp;the&nbsp;sum.</span><br>
<span class="lineno"></span><span class="keyword" id="4073882">func</span>&nbsp;<span class="ident" id="4073887">gcmAdd</span><span class="op" id="4073893">(</span><span class="ident" id="4073894">x</span><span class="op" id="4073895">,</span>&nbsp;<span class="ident" id="4073897">y</span>&nbsp;<span class="op" id="4073899">*</span><span class="ident" id="4073900"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><span class="op" id="4073915">)</span>&nbsp;<span class="ident" id="4073917"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span>&nbsp;<span class="op" id="4073933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4073936">//&nbsp;Addition&nbsp;in&nbsp;a&nbsp;characteristic&nbsp;2&nbsp;field&nbsp;is&nbsp;just&nbsp;XOR.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073990">return</span>&nbsp;<span class="ident" id="4073997"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><span class="op" id="4074012">{</span><span class="ident" id="4074013"><a href="/crypto/cipher/gcm.go.html#4073894">x</a></span><span class="op" id="4074014">.</span><span class="ident" id="4074015">low</span>&nbsp;<span class="op" id="4074019">^</span>&nbsp;<span class="ident" id="4074021"><a href="/crypto/cipher/gcm.go.html#4073897">y</a></span><span class="op" id="4074022">.</span><span class="ident" id="4074023">low</span><span class="op" id="4074026">,</span>&nbsp;<span class="ident" id="4074028"><a href="/crypto/cipher/gcm.go.html#4073894">x</a></span><span class="op" id="4074029">.</span><span class="ident" id="4074030">high</span>&nbsp;<span class="op" id="4074035">^</span>&nbsp;<span class="ident" id="4074037"><a href="/crypto/cipher/gcm.go.html#4073897">y</a></span><span class="op" id="4074038">.</span><span class="ident" id="4074039">high</span><span class="op" id="4074043">}</span><br>
<span class="lineno"></span><span class="op" id="4074045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4074048">//&nbsp;gcmDouble&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;doubling&nbsp;an&nbsp;element&nbsp;of&nbsp;GF(2¹²⁸).</span><br>
<span class="lineno"></span><span class="keyword" id="4074120">func</span>&nbsp;<span class="ident" id="4074125">gcmDouble</span><span class="op" id="4074134">(</span><span class="ident" id="4074135">x</span>&nbsp;<span class="op" id="4074137">*</span><span class="ident" id="4074138"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><span class="op" id="4074153">)</span>&nbsp;<span class="op" id="4074155">(</span><span class="ident" id="4074156">double</span>&nbsp;<span class="ident" id="4074163"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><span class="op" id="4074178">)</span>&nbsp;<span class="op" id="4074180">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074183">msbSet</span>&nbsp;<span class="op" id="4074190">:=</span>&nbsp;<span class="ident" id="4074193"><a href="/crypto/cipher/gcm.go.html#4074135">x</a></span><span class="op" id="4074194">.</span><span class="ident" id="4074195">high</span><span class="op" id="4074199">&amp;</span><span class="num" id="4074200">1</span>&nbsp;<span class="op" id="4074202">==</span>&nbsp;<span class="num" id="4074205">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074209">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;bit-ordering,&nbsp;doubling&nbsp;is&nbsp;actually&nbsp;a&nbsp;right&nbsp;shift.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074278"><a href="/crypto/cipher/gcm.go.html#4074156">double</a></span><span class="op" id="4074284">.</span><span class="ident" id="4074285">high</span>&nbsp;<span class="op" id="4074290">=</span>&nbsp;<span class="ident" id="4074292"><a href="/crypto/cipher/gcm.go.html#4074135">x</a></span><span class="op" id="4074293">.</span><span class="ident" id="4074294">high</span>&nbsp;<span class="op" id="4074299">&gt;&gt;</span>&nbsp;<span class="num" id="4074302">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074305"><a href="/crypto/cipher/gcm.go.html#4074156">double</a></span><span class="op" id="4074311">.</span><span class="ident" id="4074312">high</span>&nbsp;<span class="op" id="4074317">|=</span>&nbsp;<span class="ident" id="4074320"><a href="/crypto/cipher/gcm.go.html#4074135">x</a></span><span class="op" id="4074321">.</span><span class="ident" id="4074322">low</span>&nbsp;<span class="op" id="4074326">&lt;&lt;</span>&nbsp;<span class="num" id="4074329">63</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074333"><a href="/crypto/cipher/gcm.go.html#4074156">double</a></span><span class="op" id="4074339">.</span><span class="ident" id="4074340">low</span>&nbsp;<span class="op" id="4074344">=</span>&nbsp;<span class="ident" id="4074346"><a href="/crypto/cipher/gcm.go.html#4074135">x</a></span><span class="op" id="4074347">.</span><span class="ident" id="4074348">low</span>&nbsp;<span class="op" id="4074352">&gt;&gt;</span>&nbsp;<span class="num" id="4074355">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074359">//&nbsp;If&nbsp;the&nbsp;most-significant&nbsp;bit&nbsp;was&nbsp;set&nbsp;before&nbsp;shifting&nbsp;then&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074424">//&nbsp;conceptually,&nbsp;becomes&nbsp;a&nbsp;term&nbsp;of&nbsp;x^128.&nbsp;This&nbsp;is&nbsp;greater&nbsp;than&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074492">//&nbsp;irreducible&nbsp;polynomial&nbsp;so&nbsp;the&nbsp;result&nbsp;has&nbsp;to&nbsp;be&nbsp;reduced.&nbsp;The</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074556">//&nbsp;irreducible&nbsp;polynomial&nbsp;is&nbsp;1+x+x^2+x^7+x^128.&nbsp;We&nbsp;can&nbsp;subtract&nbsp;that&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074629">//&nbsp;eliminate&nbsp;the&nbsp;term&nbsp;at&nbsp;x^128&nbsp;which&nbsp;also&nbsp;means&nbsp;subtracting&nbsp;the&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074700">//&nbsp;four&nbsp;terms.&nbsp;In&nbsp;characteristic&nbsp;2&nbsp;fields,&nbsp;subtraction&nbsp;==&nbsp;addition&nbsp;==</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074771">//&nbsp;XOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074780">if</span>&nbsp;<span class="ident" id="4074783"><a href="/crypto/cipher/gcm.go.html#4074183">msbSet</a></span>&nbsp;<span class="op" id="4074790">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074794"><a href="/crypto/cipher/gcm.go.html#4074156">double</a></span><span class="op" id="4074800">.</span><span class="ident" id="4074801">low</span>&nbsp;<span class="op" id="4074805">^=</span>&nbsp;<span class="num" id="4074808">0xe100000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074832">return</span><br>
<span class="lineno"></span><span class="op" id="4074839">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="4074842">var</span>&nbsp;<span class="ident" id="4074846">gcmReductionTable</span>&nbsp;<span class="op" id="4074864">=</span>&nbsp;<span class="op" id="4074866">[</span><span class="op" id="4074867">]</span><span class="builtintype" id="4074868">uint16</span><span class="op" id="4074874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4074877">0x0000</span><span class="op" id="4074883">,</span>&nbsp;<span class="num" id="4074885">0x1c20</span><span class="op" id="4074891">,</span>&nbsp;<span class="num" id="4074893">0x3840</span><span class="op" id="4074899">,</span>&nbsp;<span class="num" id="4074901">0x2460</span><span class="op" id="4074907">,</span>&nbsp;<span class="num" id="4074909">0x7080</span><span class="op" id="4074915">,</span>&nbsp;<span class="num" id="4074917">0x6ca0</span><span class="op" id="4074923">,</span>&nbsp;<span class="num" id="4074925">0x48c0</span><span class="op" id="4074931">,</span>&nbsp;<span class="num" id="4074933">0x54e0</span><span class="op" id="4074939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4074942">0xe100</span><span class="op" id="4074948">,</span>&nbsp;<span class="num" id="4074950">0xfd20</span><span class="op" id="4074956">,</span>&nbsp;<span class="num" id="4074958">0xd940</span><span class="op" id="4074964">,</span>&nbsp;<span class="num" id="4074966">0xc560</span><span class="op" id="4074972">,</span>&nbsp;<span class="num" id="4074974">0x9180</span><span class="op" id="4074980">,</span>&nbsp;<span class="num" id="4074982">0x8da0</span><span class="op" id="4074988">,</span>&nbsp;<span class="num" id="4074990">0xa9c0</span><span class="op" id="4074996">,</span>&nbsp;<span class="num" id="4074998">0xb5e0</span><span class="op" id="4075004">,</span><br>
<span class="lineno"></span><span class="op" id="4075006">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="4075009">//&nbsp;mul&nbsp;sets&nbsp;y&nbsp;to&nbsp;y*H,&nbsp;where&nbsp;H&nbsp;is&nbsp;the&nbsp;GCM&nbsp;key,&nbsp;fixed&nbsp;during&nbsp;NewGCM.</span><br>
<span class="lineno"></span><span class="keyword" id="4075076">func</span>&nbsp;<span class="op" id="4075081">(</span><span class="ident" id="4075082">g</span>&nbsp;<span class="op" id="4075084">*</span><span class="ident" id="4075085"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4075088">)</span>&nbsp;<span class="ident" id="4075090">mul</span><span class="op" id="4075093">(</span><span class="ident" id="4075094">y</span>&nbsp;<span class="op" id="4075096">*</span><span class="ident" id="4075097"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><span class="op" id="4075112">)</span>&nbsp;<span class="op" id="4075114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075117">var</span>&nbsp;<span class="ident" id="4075121">z</span>&nbsp;<span class="ident" id="4075123"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075141">for</span>&nbsp;<span class="ident" id="4075145">i</span>&nbsp;<span class="op" id="4075147">:=</span>&nbsp;<span class="num" id="4075150">0</span><span class="op" id="4075151">;</span>&nbsp;<span class="ident" id="4075153"><a href="/crypto/cipher/gcm.go.html#4075145">i</a></span>&nbsp;<span class="op" id="4075155">&lt;</span>&nbsp;<span class="num" id="4075157">2</span><span class="op" id="4075158">;</span>&nbsp;<span class="ident" id="4075160"><a href="/crypto/cipher/gcm.go.html#4075145">i</a></span><span class="op" id="4075161">++</span>&nbsp;<span class="op" id="4075164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075168">word</span>&nbsp;<span class="op" id="4075173">:=</span>&nbsp;<span class="ident" id="4075176"><a href="/crypto/cipher/gcm.go.html#4075094">y</a></span><span class="op" id="4075177">.</span><span class="ident" id="4075178">high</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075185">if</span>&nbsp;<span class="ident" id="4075188"><a href="/crypto/cipher/gcm.go.html#4075145">i</a></span>&nbsp;<span class="op" id="4075190">==</span>&nbsp;<span class="num" id="4075193">1</span>&nbsp;<span class="op" id="4075195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075200"><a href="/crypto/cipher/gcm.go.html#4075168">word</a></span>&nbsp;<span class="op" id="4075205">=</span>&nbsp;<span class="ident" id="4075207"><a href="/crypto/cipher/gcm.go.html#4075094">y</a></span><span class="op" id="4075208">.</span><span class="ident" id="4075209">low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075215">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4075220">//&nbsp;Multiplication&nbsp;works&nbsp;by&nbsp;multiplying&nbsp;z&nbsp;by&nbsp;16&nbsp;and&nbsp;adding&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4075283">//&nbsp;one&nbsp;of&nbsp;the&nbsp;precomputed&nbsp;multiples&nbsp;of&nbsp;H.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075327">for</span>&nbsp;<span class="ident" id="4075331">j</span>&nbsp;<span class="op" id="4075333">:=</span>&nbsp;<span class="num" id="4075336">0</span><span class="op" id="4075337">;</span>&nbsp;<span class="ident" id="4075339"><a href="/crypto/cipher/gcm.go.html#4075331">j</a></span>&nbsp;<span class="op" id="4075341">&lt;</span>&nbsp;<span class="num" id="4075343">64</span><span class="op" id="4075345">;</span>&nbsp;<span class="ident" id="4075347"><a href="/crypto/cipher/gcm.go.html#4075331">j</a></span>&nbsp;<span class="op" id="4075349">+=</span>&nbsp;<span class="num" id="4075352">4</span>&nbsp;<span class="op" id="4075354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075359">msw</span>&nbsp;<span class="op" id="4075363">:=</span>&nbsp;<span class="ident" id="4075366"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><span class="op" id="4075367">.</span><span class="ident" id="4075368">high</span>&nbsp;<span class="op" id="4075373">&amp;</span>&nbsp;<span class="num" id="4075375">0xf</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075382"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><span class="op" id="4075383">.</span><span class="ident" id="4075384">high</span>&nbsp;<span class="op" id="4075389">&gt;&gt;=</span>&nbsp;<span class="num" id="4075393">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075398"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><span class="op" id="4075399">.</span><span class="ident" id="4075400">high</span>&nbsp;<span class="op" id="4075405">|=</span>&nbsp;<span class="ident" id="4075408"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><span class="op" id="4075409">.</span><span class="ident" id="4075410">low</span>&nbsp;<span class="op" id="4075414">&lt;&lt;</span>&nbsp;<span class="num" id="4075417">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075423"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><span class="op" id="4075424">.</span><span class="ident" id="4075425">low</span>&nbsp;<span class="op" id="4075429">&gt;&gt;=</span>&nbsp;<span class="num" id="4075433">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075438"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><span class="op" id="4075439">.</span><span class="ident" id="4075440">low</span>&nbsp;<span class="op" id="4075444">^=</span>&nbsp;<span class="ident" id="4075447">uint64</span><span class="op" id="4075453">(</span><span class="ident" id="4075454"><a href="/crypto/cipher/gcm.go.html#4074846">gcmReductionTable</a></span><span class="op" id="4075471">[</span><span class="ident" id="4075472"><a href="/crypto/cipher/gcm.go.html#4075359">msw</a></span><span class="op" id="4075475">]</span><span class="op" id="4075476">)</span>&nbsp;<span class="op" id="4075478">&lt;&lt;</span>&nbsp;<span class="num" id="4075481">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4075488">//&nbsp;the&nbsp;values&nbsp;in&nbsp;|table|&nbsp;are&nbsp;ordered&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4075532">//&nbsp;little-endian&nbsp;bit&nbsp;positions.&nbsp;See&nbsp;the&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4075583">//&nbsp;in&nbsp;NewGCM.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075600">t</span>&nbsp;<span class="op" id="4075602">:=</span>&nbsp;<span class="op" id="4075605">&amp;</span><span class="ident" id="4075606"><a href="/crypto/cipher/gcm.go.html#4075082">g</a></span><span class="op" id="4075607">.</span><span class="ident" id="4075608">productTable</span><span class="op" id="4075620">[</span><span class="ident" id="4075621"><a href="/crypto/cipher/gcm.go.html#4075168">word</a></span><span class="op" id="4075625">&amp;</span><span class="num" id="4075626">0xf</span><span class="op" id="4075629">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075635"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><span class="op" id="4075636">.</span><span class="ident" id="4075637">low</span>&nbsp;<span class="op" id="4075641">^=</span>&nbsp;<span class="ident" id="4075644"><a href="/crypto/cipher/gcm.go.html#4075600">t</a></span><span class="op" id="4075645">.</span><span class="ident" id="4075646">low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075653"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><span class="op" id="4075654">.</span><span class="ident" id="4075655">high</span>&nbsp;<span class="op" id="4075660">^=</span>&nbsp;<span class="ident" id="4075663"><a href="/crypto/cipher/gcm.go.html#4075600">t</a></span><span class="op" id="4075664">.</span><span class="ident" id="4075665">high</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075673"><a href="/crypto/cipher/gcm.go.html#4075168">word</a></span>&nbsp;<span class="op" id="4075678">&gt;&gt;=</span>&nbsp;<span class="num" id="4075682">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075689">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075693">*</span><span class="ident" id="4075694"><a href="/crypto/cipher/gcm.go.html#4075094">y</a></span>&nbsp;<span class="op" id="4075696">=</span>&nbsp;<span class="ident" id="4075698"><a href="/crypto/cipher/gcm.go.html#4075121">z</a></span><br>
<span class="lineno"></span><span class="op" id="4075700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4075703">//&nbsp;updateBlocks&nbsp;extends&nbsp;y&nbsp;with&nbsp;more&nbsp;polynomial&nbsp;terms&nbsp;from&nbsp;blocks,&nbsp;based&nbsp;on</span><br>
<span class="lineno">235</span><span class="comment" id="4075778">//&nbsp;Horner&#39;s&nbsp;rule.&nbsp;There&nbsp;must&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;gcmBlockSize&nbsp;bytes&nbsp;in&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="4075854">func</span>&nbsp;<span class="op" id="4075859">(</span><span class="ident" id="4075860">g</span>&nbsp;<span class="op" id="4075862">*</span><span class="ident" id="4075863"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4075866">)</span>&nbsp;<span class="ident" id="4075868">updateBlocks</span><span class="op" id="4075880">(</span><span class="ident" id="4075881">y</span>&nbsp;<span class="op" id="4075883">*</span><span class="ident" id="4075884"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><span class="op" id="4075899">,</span>&nbsp;<span class="ident" id="4075901">blocks</span>&nbsp;<span class="op" id="4075908">[</span><span class="op" id="4075909">]</span><span class="builtintype" id="4075910">byte</span><span class="op" id="4075914">)</span>&nbsp;<span class="op" id="4075916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075919">for</span>&nbsp;<span class="builtinfunc" id="4075923">len</span><span class="op" id="4075926">(</span><span class="ident" id="4075927"><a href="/crypto/cipher/gcm.go.html#4075901">blocks</a></span><span class="op" id="4075933">)</span>&nbsp;<span class="op" id="4075935">&gt;</span>&nbsp;<span class="num" id="4075937">0</span>&nbsp;<span class="op" id="4075939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075943"><a href="/crypto/cipher/gcm.go.html#4075881">y</a></span><span class="op" id="4075944">.</span><span class="ident" id="4075945">low</span>&nbsp;<span class="op" id="4075949">^=</span>&nbsp;<span class="ident" id="4075952"><a href="/crypto/cipher/gcm.go.html#4078211">getUint64</a></span><span class="op" id="4075961">(</span><span class="ident" id="4075962"><a href="/crypto/cipher/gcm.go.html#4075901">blocks</a></span><span class="op" id="4075968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075972"><a href="/crypto/cipher/gcm.go.html#4075881">y</a></span><span class="op" id="4075973">.</span><span class="ident" id="4075974">high</span>&nbsp;<span class="op" id="4075979">^=</span>&nbsp;<span class="ident" id="4075982"><a href="/crypto/cipher/gcm.go.html#4078211">getUint64</a></span><span class="op" id="4075991">(</span><span class="ident" id="4075992"><a href="/crypto/cipher/gcm.go.html#4075901">blocks</a></span><span class="op" id="4075998">[</span><span class="num" id="4075999">8</span><span class="op" id="4076000">:</span><span class="op" id="4076001">]</span><span class="op" id="4076002">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076006"><a href="/crypto/cipher/gcm.go.html#4075860">g</a></span><span class="op" id="4076007">.</span><span class="ident" id="4076008">mul</span><span class="op" id="4076011">(</span><span class="ident" id="4076012"><a href="/crypto/cipher/gcm.go.html#4075881">y</a></span><span class="op" id="4076013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076017"><a href="/crypto/cipher/gcm.go.html#4075901">blocks</a></span>&nbsp;<span class="op" id="4076024">=</span>&nbsp;<span class="ident" id="4076026"><a href="/crypto/cipher/gcm.go.html#4075901">blocks</a></span><span class="op" id="4076032">[</span><span class="ident" id="4076033"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4076045">:</span><span class="op" id="4076046">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076049">}</span><br>
<span class="lineno"></span><span class="op" id="4076051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="4076054">//&nbsp;update&nbsp;extends&nbsp;y&nbsp;with&nbsp;more&nbsp;polynomial&nbsp;terms&nbsp;from&nbsp;data.&nbsp;If&nbsp;data&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4076129">//&nbsp;multiple&nbsp;of&nbsp;gcmBlockSize&nbsp;bytes&nbsp;long&nbsp;then&nbsp;the&nbsp;remainder&nbsp;is&nbsp;zero&nbsp;padded.</span><br>
<span class="lineno"></span><span class="keyword" id="4076203">func</span>&nbsp;<span class="op" id="4076208">(</span><span class="ident" id="4076209">g</span>&nbsp;<span class="op" id="4076211">*</span><span class="ident" id="4076212"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4076215">)</span>&nbsp;<span class="ident" id="4076217">update</span><span class="op" id="4076223">(</span><span class="ident" id="4076224">y</span>&nbsp;<span class="op" id="4076226">*</span><span class="ident" id="4076227"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><span class="op" id="4076242">,</span>&nbsp;<span class="ident" id="4076244">data</span>&nbsp;<span class="op" id="4076249">[</span><span class="op" id="4076250">]</span><span class="builtintype" id="4076251">byte</span><span class="op" id="4076255">)</span>&nbsp;<span class="op" id="4076257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076260">fullBlocks</span>&nbsp;<span class="op" id="4076271">:=</span>&nbsp;<span class="op" id="4076274">(</span><span class="builtinfunc" id="4076275">len</span><span class="op" id="4076278">(</span><span class="ident" id="4076279"><a href="/crypto/cipher/gcm.go.html#4076244">data</a></span><span class="op" id="4076283">)</span>&nbsp;<span class="op" id="4076285">&gt;&gt;</span>&nbsp;<span class="num" id="4076288">4</span><span class="op" id="4076289">)</span>&nbsp;<span class="op" id="4076291">&lt;&lt;</span>&nbsp;<span class="num" id="4076294">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076297"><a href="/crypto/cipher/gcm.go.html#4076209">g</a></span><span class="op" id="4076298">.</span><span class="ident" id="4076299">updateBlocks</span><span class="op" id="4076311">(</span><span class="ident" id="4076312"><a href="/crypto/cipher/gcm.go.html#4076224">y</a></span><span class="op" id="4076313">,</span>&nbsp;<span class="ident" id="4076315"><a href="/crypto/cipher/gcm.go.html#4076244">data</a></span><span class="op" id="4076319">[</span><span class="op" id="4076320">:</span><span class="ident" id="4076321"><a href="/crypto/cipher/gcm.go.html#4076260">fullBlocks</a></span><span class="op" id="4076331">]</span><span class="op" id="4076332">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076336">if</span>&nbsp;<span class="builtinfunc" id="4076339">len</span><span class="op" id="4076342">(</span><span class="ident" id="4076343"><a href="/crypto/cipher/gcm.go.html#4076244">data</a></span><span class="op" id="4076347">)</span>&nbsp;<span class="op" id="4076349">!=</span>&nbsp;<span class="ident" id="4076352"><a href="/crypto/cipher/gcm.go.html#4076260">fullBlocks</a></span>&nbsp;<span class="op" id="4076363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076367">var</span>&nbsp;<span class="ident" id="4076371">partialBlock</span>&nbsp;<span class="op" id="4076384">[</span><span class="ident" id="4076385"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4076397">]</span><span class="builtintype" id="4076398">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4076405">copy</span><span class="op" id="4076409">(</span><span class="ident" id="4076410"><a href="/crypto/cipher/gcm.go.html#4076371">partialBlock</a></span><span class="op" id="4076422">[</span><span class="op" id="4076423">:</span><span class="op" id="4076424">]</span><span class="op" id="4076425">,</span>&nbsp;<span class="ident" id="4076427"><a href="/crypto/cipher/gcm.go.html#4076244">data</a></span><span class="op" id="4076431">[</span><span class="ident" id="4076432"><a href="/crypto/cipher/gcm.go.html#4076260">fullBlocks</a></span><span class="op" id="4076442">:</span><span class="op" id="4076443">]</span><span class="op" id="4076444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076448"><a href="/crypto/cipher/gcm.go.html#4076209">g</a></span><span class="op" id="4076449">.</span><span class="ident" id="4076450">updateBlocks</span><span class="op" id="4076462">(</span><span class="ident" id="4076463"><a href="/crypto/cipher/gcm.go.html#4076224">y</a></span><span class="op" id="4076464">,</span>&nbsp;<span class="ident" id="4076466"><a href="/crypto/cipher/gcm.go.html#4076371">partialBlock</a></span><span class="op" id="4076478">[</span><span class="op" id="4076479">:</span><span class="op" id="4076480">]</span><span class="op" id="4076481">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076484">}</span><br>
<span class="lineno"></span><span class="op" id="4076486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4076489">//&nbsp;gcmInc32&nbsp;treats&nbsp;the&nbsp;final&nbsp;four&nbsp;bytes&nbsp;of&nbsp;counterBlock&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4076567">//&nbsp;and&nbsp;increments&nbsp;it.</span><br>
<span class="lineno">260</span><span class="keyword" id="4076589">func</span>&nbsp;<span class="ident" id="4076594">gcmInc32</span><span class="op" id="4076602">(</span><span class="ident" id="4076603">counterBlock</span>&nbsp;<span class="op" id="4076616">*</span><span class="op" id="4076617">[</span><span class="num" id="4076618">16</span><span class="op" id="4076620">]</span><span class="builtintype" id="4076621">byte</span><span class="op" id="4076625">)</span>&nbsp;<span class="op" id="4076627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076630">for</span>&nbsp;<span class="ident" id="4076634">i</span>&nbsp;<span class="op" id="4076636">:=</span>&nbsp;<span class="ident" id="4076639"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span>&nbsp;<span class="op" id="4076652">-</span>&nbsp;<span class="num" id="4076654">1</span><span class="op" id="4076655">;</span>&nbsp;<span class="ident" id="4076657"><a href="/crypto/cipher/gcm.go.html#4076634">i</a></span>&nbsp;<span class="op" id="4076659">&gt;=</span>&nbsp;<span class="ident" id="4076662"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4076674">-</span><span class="num" id="4076675">4</span><span class="op" id="4076676">;</span>&nbsp;<span class="ident" id="4076678"><a href="/crypto/cipher/gcm.go.html#4076634">i</a></span><span class="op" id="4076679">--</span>&nbsp;<span class="op" id="4076682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076686"><a href="/crypto/cipher/gcm.go.html#4076603">counterBlock</a></span><span class="op" id="4076698">[</span><span class="ident" id="4076699"><a href="/crypto/cipher/gcm.go.html#4076634">i</a></span><span class="op" id="4076700">]</span><span class="op" id="4076701">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076706">if</span>&nbsp;<span class="ident" id="4076709"><a href="/crypto/cipher/gcm.go.html#4076603">counterBlock</a></span><span class="op" id="4076721">[</span><span class="ident" id="4076722"><a href="/crypto/cipher/gcm.go.html#4076634">i</a></span><span class="op" id="4076723">]</span>&nbsp;<span class="op" id="4076725">!=</span>&nbsp;<span class="num" id="4076728">0</span>&nbsp;<span class="op" id="4076730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076735">break</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076746">}</span><br>
<span class="lineno"></span><span class="op" id="4076748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4076751">//&nbsp;sliceForAppend&nbsp;takes&nbsp;a&nbsp;slice&nbsp;and&nbsp;a&nbsp;requested&nbsp;number&nbsp;of&nbsp;bytes.&nbsp;It&nbsp;returns&nbsp;a</span><br>
<span class="lineno">270</span><span class="comment" id="4076829">//&nbsp;slice&nbsp;with&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;given&nbsp;slice&nbsp;followed&nbsp;by&nbsp;that&nbsp;many&nbsp;bytes&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4076909">//&nbsp;second&nbsp;slice&nbsp;that&nbsp;aliases&nbsp;into&nbsp;it&nbsp;and&nbsp;contains&nbsp;only&nbsp;the&nbsp;extra&nbsp;bytes.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4076988">//&nbsp;original&nbsp;slice&nbsp;has&nbsp;sufficient&nbsp;capacity&nbsp;then&nbsp;no&nbsp;allocation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="4077063">func</span>&nbsp;<span class="ident" id="4077068">sliceForAppend</span><span class="op" id="4077082">(</span><span class="ident" id="4077083">in</span>&nbsp;<span class="op" id="4077086">[</span><span class="op" id="4077087">]</span><span class="builtintype" id="4077088">byte</span><span class="op" id="4077092">,</span>&nbsp;<span class="ident" id="4077094">n</span>&nbsp;<span class="builtintype" id="4077096">int</span><span class="op" id="4077099">)</span>&nbsp;<span class="op" id="4077101">(</span><span class="ident" id="4077102">head</span><span class="op" id="4077106">,</span>&nbsp;<span class="ident" id="4077108">tail</span>&nbsp;<span class="op" id="4077113">[</span><span class="op" id="4077114">]</span><span class="builtintype" id="4077115">byte</span><span class="op" id="4077119">)</span>&nbsp;<span class="op" id="4077121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077124">if</span>&nbsp;<span class="ident" id="4077127">total</span>&nbsp;<span class="op" id="4077133">:=</span>&nbsp;<span class="builtinfunc" id="4077136">len</span><span class="op" id="4077139">(</span><span class="ident" id="4077140"><a href="/crypto/cipher/gcm.go.html#4077083">in</a></span><span class="op" id="4077142">)</span>&nbsp;<span class="op" id="4077144">+</span>&nbsp;<span class="ident" id="4077146"><a href="/crypto/cipher/gcm.go.html#4077094">n</a></span><span class="op" id="4077147">;</span>&nbsp;<span class="builtinfunc" id="4077149">cap</span><span class="op" id="4077152">(</span><span class="ident" id="4077153"><a href="/crypto/cipher/gcm.go.html#4077083">in</a></span><span class="op" id="4077155">)</span>&nbsp;<span class="op" id="4077157">&gt;=</span>&nbsp;<span class="ident" id="4077160"><a href="/crypto/cipher/gcm.go.html#4077127">total</a></span>&nbsp;<span class="op" id="4077166">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077170"><a href="/crypto/cipher/gcm.go.html#4077102">head</a></span>&nbsp;<span class="op" id="4077175">=</span>&nbsp;<span class="ident" id="4077177"><a href="/crypto/cipher/gcm.go.html#4077083">in</a></span><span class="op" id="4077179">[</span><span class="op" id="4077180">:</span><span class="ident" id="4077181"><a href="/crypto/cipher/gcm.go.html#4077127">total</a></span><span class="op" id="4077186">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077189">}</span>&nbsp;<span class="keyword" id="4077191">else</span>&nbsp;<span class="op" id="4077196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077200"><a href="/crypto/cipher/gcm.go.html#4077102">head</a></span>&nbsp;<span class="op" id="4077205">=</span>&nbsp;<span class="builtinfunc" id="4077207">make</span><span class="op" id="4077211">(</span><span class="op" id="4077212">[</span><span class="op" id="4077213">]</span><span class="builtintype" id="4077214">byte</span><span class="op" id="4077218">,</span>&nbsp;<span class="ident" id="4077220"><a href="/crypto/cipher/gcm.go.html#4077127">total</a></span><span class="op" id="4077225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4077229">copy</span><span class="op" id="4077233">(</span><span class="ident" id="4077234"><a href="/crypto/cipher/gcm.go.html#4077102">head</a></span><span class="op" id="4077238">,</span>&nbsp;<span class="ident" id="4077240"><a href="/crypto/cipher/gcm.go.html#4077083">in</a></span><span class="op" id="4077242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077245">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077248"><a href="/crypto/cipher/gcm.go.html#4077108">tail</a></span>&nbsp;<span class="op" id="4077253">=</span>&nbsp;<span class="ident" id="4077255"><a href="/crypto/cipher/gcm.go.html#4077102">head</a></span><span class="op" id="4077259">[</span><span class="builtinfunc" id="4077260">len</span><span class="op" id="4077263">(</span><span class="ident" id="4077264"><a href="/crypto/cipher/gcm.go.html#4077083">in</a></span><span class="op" id="4077266">)</span><span class="op" id="4077267">:</span><span class="op" id="4077268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077271">return</span><br>
<span class="lineno"></span><span class="op" id="4077278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4077281">//&nbsp;counterCrypt&nbsp;crypts&nbsp;in&nbsp;to&nbsp;out&nbsp;using&nbsp;g.cipher&nbsp;in&nbsp;counter&nbsp;mode.</span><br>
<span class="lineno">285</span><span class="keyword" id="4077346">func</span>&nbsp;<span class="op" id="4077351">(</span><span class="ident" id="4077352">g</span>&nbsp;<span class="op" id="4077354">*</span><span class="ident" id="4077355"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4077358">)</span>&nbsp;<span class="ident" id="4077360">counterCrypt</span><span class="op" id="4077372">(</span><span class="ident" id="4077373">out</span><span class="op" id="4077376">,</span>&nbsp;<span class="ident" id="4077378">in</span>&nbsp;<span class="op" id="4077381">[</span><span class="op" id="4077382">]</span><span class="builtintype" id="4077383">byte</span><span class="op" id="4077387">,</span>&nbsp;<span class="ident" id="4077389">counter</span>&nbsp;<span class="op" id="4077397">*</span><span class="op" id="4077398">[</span><span class="ident" id="4077399"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4077411">]</span><span class="builtintype" id="4077412">byte</span><span class="op" id="4077416">)</span>&nbsp;<span class="op" id="4077418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077421">var</span>&nbsp;<span class="ident" id="4077425">mask</span>&nbsp;<span class="op" id="4077430">[</span><span class="ident" id="4077431"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4077443">]</span><span class="builtintype" id="4077444">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077451">for</span>&nbsp;<span class="builtinfunc" id="4077455">len</span><span class="op" id="4077458">(</span><span class="ident" id="4077459"><a href="/crypto/cipher/gcm.go.html#4077378">in</a></span><span class="op" id="4077461">)</span>&nbsp;<span class="op" id="4077463">&gt;=</span>&nbsp;<span class="ident" id="4077466"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span>&nbsp;<span class="op" id="4077479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077483"><a href="/crypto/cipher/gcm.go.html#4077352">g</a></span><span class="op" id="4077484">.</span><span class="ident" id="4077485">cipher</span><span class="op" id="4077491">.</span><span class="ident" id="4077492">Encrypt</span><span class="op" id="4077499">(</span><span class="ident" id="4077500"><a href="/crypto/cipher/gcm.go.html#4077425">mask</a></span><span class="op" id="4077504">[</span><span class="op" id="4077505">:</span><span class="op" id="4077506">]</span><span class="op" id="4077507">,</span>&nbsp;<span class="ident" id="4077509"><a href="/crypto/cipher/gcm.go.html#4077389">counter</a></span><span class="op" id="4077516">[</span><span class="op" id="4077517">:</span><span class="op" id="4077518">]</span><span class="op" id="4077519">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077523"><a href="/crypto/cipher/gcm.go.html#4076594">gcmInc32</a></span><span class="op" id="4077531">(</span><span class="ident" id="4077532"><a href="/crypto/cipher/gcm.go.html#4077389">counter</a></span><span class="op" id="4077539">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077544"><a href="/crypto/cipher/xor.go.html#4083408">xorWords</a></span><span class="op" id="4077552">(</span><span class="ident" id="4077553"><a href="/crypto/cipher/gcm.go.html#4077373">out</a></span><span class="op" id="4077556">,</span>&nbsp;<span class="ident" id="4077558"><a href="/crypto/cipher/gcm.go.html#4077378">in</a></span><span class="op" id="4077560">,</span>&nbsp;<span class="ident" id="4077562"><a href="/crypto/cipher/gcm.go.html#4077425">mask</a></span><span class="op" id="4077566">[</span><span class="op" id="4077567">:</span><span class="op" id="4077568">]</span><span class="op" id="4077569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077573"><a href="/crypto/cipher/gcm.go.html#4077373">out</a></span>&nbsp;<span class="op" id="4077577">=</span>&nbsp;<span class="ident" id="4077579"><a href="/crypto/cipher/gcm.go.html#4077373">out</a></span><span class="op" id="4077582">[</span><span class="ident" id="4077583"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4077595">:</span><span class="op" id="4077596">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077600"><a href="/crypto/cipher/gcm.go.html#4077378">in</a></span>&nbsp;<span class="op" id="4077603">=</span>&nbsp;<span class="ident" id="4077605"><a href="/crypto/cipher/gcm.go.html#4077378">in</a></span><span class="op" id="4077607">[</span><span class="ident" id="4077608"><a href="/crypto/cipher/gcm.go.html#4072055">gcmBlockSize</a></span><span class="op" id="4077620">:</span><span class="op" id="4077621">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077628">if</span>&nbsp;<span class="builtinfunc" id="4077631">len</span><span class="op" id="4077634">(</span><span class="ident" id="4077635"><a href="/crypto/cipher/gcm.go.html#4077378">in</a></span><span class="op" id="4077637">)</span>&nbsp;<span class="op" id="4077639">&gt;</span>&nbsp;<span class="num" id="4077641">0</span>&nbsp;<span class="op" id="4077643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077647"><a href="/crypto/cipher/gcm.go.html#4077352">g</a></span><span class="op" id="4077648">.</span><span class="ident" id="4077649">cipher</span><span class="op" id="4077655">.</span><span class="ident" id="4077656">Encrypt</span><span class="op" id="4077663">(</span><span class="ident" id="4077664"><a href="/crypto/cipher/gcm.go.html#4077425">mask</a></span><span class="op" id="4077668">[</span><span class="op" id="4077669">:</span><span class="op" id="4077670">]</span><span class="op" id="4077671">,</span>&nbsp;<span class="ident" id="4077673"><a href="/crypto/cipher/gcm.go.html#4077389">counter</a></span><span class="op" id="4077680">[</span><span class="op" id="4077681">:</span><span class="op" id="4077682">]</span><span class="op" id="4077683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077687"><a href="/crypto/cipher/gcm.go.html#4076594">gcmInc32</a></span><span class="op" id="4077695">(</span><span class="ident" id="4077696"><a href="/crypto/cipher/gcm.go.html#4077389">counter</a></span><span class="op" id="4077703">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077707"><a href="/crypto/cipher/xor.go.html#4082665">xorBytes</a></span><span class="op" id="4077715">(</span><span class="ident" id="4077716"><a href="/crypto/cipher/gcm.go.html#4077373">out</a></span><span class="op" id="4077719">,</span>&nbsp;<span class="ident" id="4077721"><a href="/crypto/cipher/gcm.go.html#4077378">in</a></span><span class="op" id="4077723">,</span>&nbsp;<span class="ident" id="4077725"><a href="/crypto/cipher/gcm.go.html#4077425">mask</a></span><span class="op" id="4077729">[</span><span class="op" id="4077730">:</span><span class="op" id="4077731">]</span><span class="op" id="4077732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077735">}</span><br>
<span class="lineno"></span><span class="op" id="4077737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4077740">//&nbsp;auth&nbsp;calculates&nbsp;GHASH(ciphertext,&nbsp;additionalData),&nbsp;masks&nbsp;the&nbsp;result&nbsp;with</span><br>
<span class="lineno">305</span><span class="comment" id="4077816">//&nbsp;tagMask&nbsp;and&nbsp;writes&nbsp;the&nbsp;result&nbsp;to&nbsp;out.</span><br>
<span class="lineno"></span><span class="keyword" id="4077857">func</span>&nbsp;<span class="op" id="4077862">(</span><span class="ident" id="4077863">g</span>&nbsp;<span class="op" id="4077865">*</span><span class="ident" id="4077866"><a href="/crypto/cipher/gcm.go.html#4070865">gcm</a></span><span class="op" id="4077869">)</span>&nbsp;<span class="ident" id="4077871">auth</span><span class="op" id="4077875">(</span><span class="ident" id="4077876">out</span><span class="op" id="4077879">,</span>&nbsp;<span class="ident" id="4077881">ciphertext</span><span class="op" id="4077891">,</span>&nbsp;<span class="ident" id="4077893">additionalData</span>&nbsp;<span class="op" id="4077908">[</span><span class="op" id="4077909">]</span><span class="builtintype" id="4077910">byte</span><span class="op" id="4077914">,</span>&nbsp;<span class="ident" id="4077916">tagMask</span>&nbsp;<span class="op" id="4077924">*</span><span class="op" id="4077925">[</span><span class="ident" id="4077926"><a href="/crypto/cipher/gcm.go.html#4072074">gcmTagSize</a></span><span class="op" id="4077936">]</span><span class="builtintype" id="4077937">byte</span><span class="op" id="4077941">)</span>&nbsp;<span class="op" id="4077943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077946">var</span>&nbsp;<span class="ident" id="4077950">y</span>&nbsp;<span class="ident" id="4077952"><a href="/crypto/cipher/gcm.go.html#4070654">gcmFieldElement</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077969"><a href="/crypto/cipher/gcm.go.html#4077863">g</a></span><span class="op" id="4077970">.</span><span class="ident" id="4077971">update</span><span class="op" id="4077977">(</span><span class="op" id="4077978">&amp;</span><span class="ident" id="4077979"><a href="/crypto/cipher/gcm.go.html#4077950">y</a></span><span class="op" id="4077980">,</span>&nbsp;<span class="ident" id="4077982"><a href="/crypto/cipher/gcm.go.html#4077893">additionalData</a></span><span class="op" id="4077996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077999"><a href="/crypto/cipher/gcm.go.html#4077863">g</a></span><span class="op" id="4078000">.</span><span class="ident" id="4078001">update</span><span class="op" id="4078007">(</span><span class="op" id="4078008">&amp;</span><span class="ident" id="4078009"><a href="/crypto/cipher/gcm.go.html#4077950">y</a></span><span class="op" id="4078010">,</span>&nbsp;<span class="ident" id="4078012"><a href="/crypto/cipher/gcm.go.html#4077881">ciphertext</a></span><span class="op" id="4078022">)</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078026"><a href="/crypto/cipher/gcm.go.html#4077950">y</a></span><span class="op" id="4078027">.</span><span class="ident" id="4078028">low</span>&nbsp;<span class="op" id="4078032">^=</span>&nbsp;<span class="ident" id="4078035">uint64</span><span class="op" id="4078041">(</span><span class="builtinfunc" id="4078042">len</span><span class="op" id="4078045">(</span><span class="ident" id="4078046"><a href="/crypto/cipher/gcm.go.html#4077893">additionalData</a></span><span class="op" id="4078060">)</span><span class="op" id="4078061">)</span>&nbsp;<span class="op" id="4078063">*</span>&nbsp;<span class="num" id="4078065">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078068"><a href="/crypto/cipher/gcm.go.html#4077950">y</a></span><span class="op" id="4078069">.</span><span class="ident" id="4078070">high</span>&nbsp;<span class="op" id="4078075">^=</span>&nbsp;<span class="ident" id="4078078">uint64</span><span class="op" id="4078084">(</span><span class="builtinfunc" id="4078085">len</span><span class="op" id="4078088">(</span><span class="ident" id="4078089"><a href="/crypto/cipher/gcm.go.html#4077881">ciphertext</a></span><span class="op" id="4078099">)</span><span class="op" id="4078100">)</span>&nbsp;<span class="op" id="4078102">*</span>&nbsp;<span class="num" id="4078104">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078108"><a href="/crypto/cipher/gcm.go.html#4077863">g</a></span><span class="op" id="4078109">.</span><span class="ident" id="4078110">mul</span><span class="op" id="4078113">(</span><span class="op" id="4078114">&amp;</span><span class="ident" id="4078115"><a href="/crypto/cipher/gcm.go.html#4077950">y</a></span><span class="op" id="4078116">)</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078120"><a href="/crypto/cipher/gcm.go.html#4078450">putUint64</a></span><span class="op" id="4078129">(</span><span class="ident" id="4078130"><a href="/crypto/cipher/gcm.go.html#4077876">out</a></span><span class="op" id="4078133">,</span>&nbsp;<span class="ident" id="4078135"><a href="/crypto/cipher/gcm.go.html#4077950">y</a></span><span class="op" id="4078136">.</span><span class="ident" id="4078137">low</span><span class="op" id="4078140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078143"><a href="/crypto/cipher/gcm.go.html#4078450">putUint64</a></span><span class="op" id="4078152">(</span><span class="ident" id="4078153"><a href="/crypto/cipher/gcm.go.html#4077876">out</a></span><span class="op" id="4078156">[</span><span class="num" id="4078157">8</span><span class="op" id="4078158">:</span><span class="op" id="4078159">]</span><span class="op" id="4078160">,</span>&nbsp;<span class="ident" id="4078162"><a href="/crypto/cipher/gcm.go.html#4077950">y</a></span><span class="op" id="4078163">.</span><span class="ident" id="4078164">high</span><span class="op" id="4078168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078172"><a href="/crypto/cipher/xor.go.html#4083408">xorWords</a></span><span class="op" id="4078180">(</span><span class="ident" id="4078181"><a href="/crypto/cipher/gcm.go.html#4077876">out</a></span><span class="op" id="4078184">,</span>&nbsp;<span class="ident" id="4078186"><a href="/crypto/cipher/gcm.go.html#4077876">out</a></span><span class="op" id="4078189">,</span>&nbsp;<span class="ident" id="4078191"><a href="/crypto/cipher/gcm.go.html#4077916">tagMask</a></span><span class="op" id="4078198">[</span><span class="op" id="4078199">:</span><span class="op" id="4078200">]</span><span class="op" id="4078201">)</span><br>
<span class="lineno">320</span><span class="op" id="4078203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4078206">func</span>&nbsp;<span class="ident" id="4078211">getUint64</span><span class="op" id="4078220">(</span><span class="ident" id="4078221">data</span>&nbsp;<span class="op" id="4078226">[</span><span class="op" id="4078227">]</span><span class="builtintype" id="4078228">byte</span><span class="op" id="4078232">)</span>&nbsp;<span class="ident" id="4078234">uint64</span>&nbsp;<span class="op" id="4078241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078244">r</span>&nbsp;<span class="op" id="4078246">:=</span>&nbsp;<span class="ident" id="4078249">uint64</span><span class="op" id="4078255">(</span><span class="ident" id="4078256"><a href="/crypto/cipher/gcm.go.html#4078221">data</a></span><span class="op" id="4078260">[</span><span class="num" id="4078261">0</span><span class="op" id="4078262">]</span><span class="op" id="4078263">)</span><span class="op" id="4078264">&lt;&lt;</span><span class="num" id="4078266">56</span>&nbsp;<span class="op" id="4078269">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078273">uint64</span><span class="op" id="4078279">(</span><span class="ident" id="4078280"><a href="/crypto/cipher/gcm.go.html#4078221">data</a></span><span class="op" id="4078284">[</span><span class="num" id="4078285">1</span><span class="op" id="4078286">]</span><span class="op" id="4078287">)</span><span class="op" id="4078288">&lt;&lt;</span><span class="num" id="4078290">48</span>&nbsp;<span class="op" id="4078293">|</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078297">uint64</span><span class="op" id="4078303">(</span><span class="ident" id="4078304"><a href="/crypto/cipher/gcm.go.html#4078221">data</a></span><span class="op" id="4078308">[</span><span class="num" id="4078309">2</span><span class="op" id="4078310">]</span><span class="op" id="4078311">)</span><span class="op" id="4078312">&lt;&lt;</span><span class="num" id="4078314">40</span>&nbsp;<span class="op" id="4078317">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078321">uint64</span><span class="op" id="4078327">(</span><span class="ident" id="4078328"><a href="/crypto/cipher/gcm.go.html#4078221">data</a></span><span class="op" id="4078332">[</span><span class="num" id="4078333">3</span><span class="op" id="4078334">]</span><span class="op" id="4078335">)</span><span class="op" id="4078336">&lt;&lt;</span><span class="num" id="4078338">32</span>&nbsp;<span class="op" id="4078341">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078345">uint64</span><span class="op" id="4078351">(</span><span class="ident" id="4078352"><a href="/crypto/cipher/gcm.go.html#4078221">data</a></span><span class="op" id="4078356">[</span><span class="num" id="4078357">4</span><span class="op" id="4078358">]</span><span class="op" id="4078359">)</span><span class="op" id="4078360">&lt;&lt;</span><span class="num" id="4078362">24</span>&nbsp;<span class="op" id="4078365">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078369">uint64</span><span class="op" id="4078375">(</span><span class="ident" id="4078376"><a href="/crypto/cipher/gcm.go.html#4078221">data</a></span><span class="op" id="4078380">[</span><span class="num" id="4078381">5</span><span class="op" id="4078382">]</span><span class="op" id="4078383">)</span><span class="op" id="4078384">&lt;&lt;</span><span class="num" id="4078386">16</span>&nbsp;<span class="op" id="4078389">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078393">uint64</span><span class="op" id="4078399">(</span><span class="ident" id="4078400"><a href="/crypto/cipher/gcm.go.html#4078221">data</a></span><span class="op" id="4078404">[</span><span class="num" id="4078405">6</span><span class="op" id="4078406">]</span><span class="op" id="4078407">)</span><span class="op" id="4078408">&lt;&lt;</span><span class="num" id="4078410">8</span>&nbsp;<span class="op" id="4078412">|</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078416">uint64</span><span class="op" id="4078422">(</span><span class="ident" id="4078423"><a href="/crypto/cipher/gcm.go.html#4078221">data</a></span><span class="op" id="4078427">[</span><span class="num" id="4078428">7</span><span class="op" id="4078429">]</span><span class="op" id="4078430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078433">return</span>&nbsp;<span class="ident" id="4078440"><a href="/crypto/cipher/gcm.go.html#4078244">r</a></span><br>
<span class="lineno"></span><span class="op" id="4078442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4078445">func</span>&nbsp;<span class="ident" id="4078450">putUint64</span><span class="op" id="4078459">(</span><span class="ident" id="4078460">out</span>&nbsp;<span class="op" id="4078464">[</span><span class="op" id="4078465">]</span><span class="builtintype" id="4078466">byte</span><span class="op" id="4078470">,</span>&nbsp;<span class="ident" id="4078472">v</span>&nbsp;<span class="ident" id="4078474">uint64</span><span class="op" id="4078480">)</span>&nbsp;<span class="op" id="4078482">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078485"><a href="/crypto/cipher/gcm.go.html#4078460">out</a></span><span class="op" id="4078488">[</span><span class="num" id="4078489">0</span><span class="op" id="4078490">]</span>&nbsp;<span class="op" id="4078492">=</span>&nbsp;<span class="builtintype" id="4078494">byte</span><span class="op" id="4078498">(</span><span class="ident" id="4078499"><a href="/crypto/cipher/gcm.go.html#4078472">v</a></span>&nbsp;<span class="op" id="4078501">&gt;&gt;</span>&nbsp;<span class="num" id="4078504">56</span><span class="op" id="4078506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078509"><a href="/crypto/cipher/gcm.go.html#4078460">out</a></span><span class="op" id="4078512">[</span><span class="num" id="4078513">1</span><span class="op" id="4078514">]</span>&nbsp;<span class="op" id="4078516">=</span>&nbsp;<span class="builtintype" id="4078518">byte</span><span class="op" id="4078522">(</span><span class="ident" id="4078523"><a href="/crypto/cipher/gcm.go.html#4078472">v</a></span>&nbsp;<span class="op" id="4078525">&gt;&gt;</span>&nbsp;<span class="num" id="4078528">48</span><span class="op" id="4078530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078533"><a href="/crypto/cipher/gcm.go.html#4078460">out</a></span><span class="op" id="4078536">[</span><span class="num" id="4078537">2</span><span class="op" id="4078538">]</span>&nbsp;<span class="op" id="4078540">=</span>&nbsp;<span class="builtintype" id="4078542">byte</span><span class="op" id="4078546">(</span><span class="ident" id="4078547"><a href="/crypto/cipher/gcm.go.html#4078472">v</a></span>&nbsp;<span class="op" id="4078549">&gt;&gt;</span>&nbsp;<span class="num" id="4078552">40</span><span class="op" id="4078554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078557"><a href="/crypto/cipher/gcm.go.html#4078460">out</a></span><span class="op" id="4078560">[</span><span class="num" id="4078561">3</span><span class="op" id="4078562">]</span>&nbsp;<span class="op" id="4078564">=</span>&nbsp;<span class="builtintype" id="4078566">byte</span><span class="op" id="4078570">(</span><span class="ident" id="4078571"><a href="/crypto/cipher/gcm.go.html#4078472">v</a></span>&nbsp;<span class="op" id="4078573">&gt;&gt;</span>&nbsp;<span class="num" id="4078576">32</span><span class="op" id="4078578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078581"><a href="/crypto/cipher/gcm.go.html#4078460">out</a></span><span class="op" id="4078584">[</span><span class="num" id="4078585">4</span><span class="op" id="4078586">]</span>&nbsp;<span class="op" id="4078588">=</span>&nbsp;<span class="builtintype" id="4078590">byte</span><span class="op" id="4078594">(</span><span class="ident" id="4078595"><a href="/crypto/cipher/gcm.go.html#4078472">v</a></span>&nbsp;<span class="op" id="4078597">&gt;&gt;</span>&nbsp;<span class="num" id="4078600">24</span><span class="op" id="4078602">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078605"><a href="/crypto/cipher/gcm.go.html#4078460">out</a></span><span class="op" id="4078608">[</span><span class="num" id="4078609">5</span><span class="op" id="4078610">]</span>&nbsp;<span class="op" id="4078612">=</span>&nbsp;<span class="builtintype" id="4078614">byte</span><span class="op" id="4078618">(</span><span class="ident" id="4078619"><a href="/crypto/cipher/gcm.go.html#4078472">v</a></span>&nbsp;<span class="op" id="4078621">&gt;&gt;</span>&nbsp;<span class="num" id="4078624">16</span><span class="op" id="4078626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078629"><a href="/crypto/cipher/gcm.go.html#4078460">out</a></span><span class="op" id="4078632">[</span><span class="num" id="4078633">6</span><span class="op" id="4078634">]</span>&nbsp;<span class="op" id="4078636">=</span>&nbsp;<span class="builtintype" id="4078638">byte</span><span class="op" id="4078642">(</span><span class="ident" id="4078643"><a href="/crypto/cipher/gcm.go.html#4078472">v</a></span>&nbsp;<span class="op" id="4078645">&gt;&gt;</span>&nbsp;<span class="num" id="4078648">8</span><span class="op" id="4078649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078652"><a href="/crypto/cipher/gcm.go.html#4078460">out</a></span><span class="op" id="4078655">[</span><span class="num" id="4078656">7</span><span class="op" id="4078657">]</span>&nbsp;<span class="op" id="4078659">=</span>&nbsp;<span class="builtintype" id="4078661">byte</span><span class="op" id="4078665">(</span><span class="ident" id="4078666"><a href="/crypto/cipher/gcm.go.html#4078472">v</a></span><span class="op" id="4078667">)</span><br>
<span class="lineno"></span><span class="op" id="4078669">}</span>
</div>
</body>
</html>
