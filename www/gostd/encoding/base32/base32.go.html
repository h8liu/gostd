<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5927431">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5927486">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5927540">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5927591">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5927662">package</span>&nbsp;<span class="ident" id="5927670">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5927678">import</span>&nbsp;<span class="op" id="5927685">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5927688">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5927697">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5927703">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5927714">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5927724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5927727">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5927748">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5927816">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5927884">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="5927944">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="5928001">type</span>&nbsp;<span class="ident" id="5928006">Encoding</span>&nbsp;<span class="keyword" id="5928015">struct</span>&nbsp;<span class="op" id="5928022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928025">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5928035">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928043">decodeMap</span>&nbsp;<span class="op" id="5928053">[</span><span class="num" id="5928054">256</span><span class="op" id="5928057">]</span><span class="builtintype" id="5928058">byte</span><br>
<span class="lineno"></span><span class="op" id="5928063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5928066">const</span>&nbsp;<span class="ident" id="5928072">encodeStd</span>&nbsp;<span class="op" id="5928082">=</span>&nbsp;<span class="string" id="5928084">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="5928119">const</span>&nbsp;<span class="ident" id="5928125">encodeHex</span>&nbsp;<span class="op" id="5928135">=</span>&nbsp;<span class="string" id="5928137">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5928173">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="5928242">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5928277">func</span>&nbsp;<span class="ident" id="5928282">NewEncoding</span><span class="op" id="5928293">(</span><span class="ident" id="5928294">encoder</span>&nbsp;<span class="builtintype" id="5928302">string</span><span class="op" id="5928308">)</span>&nbsp;<span class="op" id="5928310">*</span><span class="ident" id="5928311">Encoding</span>&nbsp;<span class="op" id="5928320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928323">e</span>&nbsp;<span class="op" id="5928325">:=</span>&nbsp;<span class="builtinfunc" id="5928328">new</span><span class="op" id="5928331">(</span><span class="ident" id="5928332">Encoding</span><span class="op" id="5928340">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928343">e</span><span class="op" id="5928344">.</span><span class="ident" id="5928345">encode</span>&nbsp;<span class="op" id="5928352">=</span>&nbsp;<span class="ident" id="5928354">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5928363">for</span>&nbsp;<span class="ident" id="5928367">i</span>&nbsp;<span class="op" id="5928369">:=</span>&nbsp;<span class="num" id="5928372">0</span><span class="op" id="5928373">;</span>&nbsp;<span class="ident" id="5928375">i</span>&nbsp;<span class="op" id="5928377">&lt;</span>&nbsp;<span class="builtinfunc" id="5928379">len</span><span class="op" id="5928382">(</span><span class="ident" id="5928383">e</span><span class="op" id="5928384">.</span><span class="ident" id="5928385">decodeMap</span><span class="op" id="5928394">)</span><span class="op" id="5928395">;</span>&nbsp;<span class="ident" id="5928397">i</span><span class="op" id="5928398">++</span>&nbsp;<span class="op" id="5928401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928405">e</span><span class="op" id="5928406">.</span><span class="ident" id="5928407">decodeMap</span><span class="op" id="5928416">[</span><span class="ident" id="5928417">i</span><span class="op" id="5928418">]</span>&nbsp;<span class="op" id="5928420">=</span>&nbsp;<span class="num" id="5928422">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5928428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5928431">for</span>&nbsp;<span class="ident" id="5928435">i</span>&nbsp;<span class="op" id="5928437">:=</span>&nbsp;<span class="num" id="5928440">0</span><span class="op" id="5928441">;</span>&nbsp;<span class="ident" id="5928443">i</span>&nbsp;<span class="op" id="5928445">&lt;</span>&nbsp;<span class="builtinfunc" id="5928447">len</span><span class="op" id="5928450">(</span><span class="ident" id="5928451">encoder</span><span class="op" id="5928458">)</span><span class="op" id="5928459">;</span>&nbsp;<span class="ident" id="5928461">i</span><span class="op" id="5928462">++</span>&nbsp;<span class="op" id="5928465">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5928469">e</span><span class="op" id="5928470">.</span><span class="ident" id="5928471">decodeMap</span><span class="op" id="5928480">[</span><span class="ident" id="5928481">encoder</span><span class="op" id="5928488">[</span><span class="ident" id="5928489">i</span><span class="op" id="5928490">]</span><span class="op" id="5928491">]</span>&nbsp;<span class="op" id="5928493">=</span>&nbsp;<span class="builtintype" id="5928495">byte</span><span class="op" id="5928499">(</span><span class="ident" id="5928500">i</span><span class="op" id="5928501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5928504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5928507">return</span>&nbsp;<span class="ident" id="5928514">e</span><br>
<span class="lineno"></span><span class="op" id="5928516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5928519">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5928581">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5928594">var</span>&nbsp;<span class="ident" id="5928598">StdEncoding</span>&nbsp;<span class="op" id="5928610">=</span>&nbsp;<span class="ident" id="5928612">NewEncoding</span><span class="op" id="5928623">(</span><span class="ident" id="5928624">encodeStd</span><span class="op" id="5928633">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5928636">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="5928705">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="5928737">var</span>&nbsp;<span class="ident" id="5928741">HexEncoding</span>&nbsp;<span class="op" id="5928753">=</span>&nbsp;<span class="ident" id="5928755">NewEncoding</span><span class="op" id="5928766">(</span><span class="ident" id="5928767">encodeHex</span><span class="op" id="5928776">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5928779">var</span>&nbsp;<span class="ident" id="5928783">removeNewlinesMapper</span>&nbsp;<span class="op" id="5928804">=</span>&nbsp;<span class="keyword" id="5928806">func</span><span class="op" id="5928810">(</span><span class="ident" id="5928811">r</span>&nbsp;<span class="builtintype" id="5928813">rune</span><span class="op" id="5928817">)</span>&nbsp;<span class="builtintype" id="5928819">rune</span>&nbsp;<span class="op" id="5928824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5928827">if</span>&nbsp;<span class="ident" id="5928830">r</span>&nbsp;<span class="op" id="5928832">==</span>&nbsp;<span class="string" id="5928835">&#39;\r&#39;</span>&nbsp;<span class="op" id="5928840">||</span>&nbsp;<span class="ident" id="5928843">r</span>&nbsp;<span class="op" id="5928845">==</span>&nbsp;<span class="string" id="5928848">&#39;\n&#39;</span>&nbsp;<span class="op" id="5928853">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5928857">return</span>&nbsp;<span class="op" id="5928864">-</span><span class="num" id="5928865">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5928868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5928871">return</span>&nbsp;<span class="ident" id="5928878">r</span><br>
<span class="lineno"></span><span class="op" id="5928880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="5928883">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5928902">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="5928956">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="5928994">//</span><br>
<span class="lineno"></span><span class="comment" id="5928997">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="5929055">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="5929116">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="5929170">func</span>&nbsp;<span class="op" id="5929175">(</span><span class="ident" id="5929176">enc</span>&nbsp;<span class="op" id="5929180">*</span><span class="ident" id="5929181">Encoding</span><span class="op" id="5929189">)</span>&nbsp;<span class="ident" id="5929191">Encode</span><span class="op" id="5929197">(</span><span class="ident" id="5929198">dst</span><span class="op" id="5929201">,</span>&nbsp;<span class="ident" id="5929203">src</span>&nbsp;<span class="op" id="5929207">[</span><span class="op" id="5929208">]</span><span class="builtintype" id="5929209">byte</span><span class="op" id="5929213">)</span>&nbsp;<span class="op" id="5929215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929218">if</span>&nbsp;<span class="builtinfunc" id="5929221">len</span><span class="op" id="5929224">(</span><span class="ident" id="5929225">src</span><span class="op" id="5929228">)</span>&nbsp;<span class="op" id="5929230">==</span>&nbsp;<span class="num" id="5929233">0</span>&nbsp;<span class="op" id="5929235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929239">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929251">for</span>&nbsp;<span class="builtinfunc" id="5929255">len</span><span class="op" id="5929258">(</span><span class="ident" id="5929259">src</span><span class="op" id="5929262">)</span>&nbsp;<span class="op" id="5929264">&gt;</span>&nbsp;<span class="num" id="5929266">0</span>&nbsp;<span class="op" id="5929268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929272">var</span>&nbsp;<span class="ident" id="5929276">b0</span><span class="op" id="5929278">,</span>&nbsp;<span class="ident" id="5929280">b1</span><span class="op" id="5929282">,</span>&nbsp;<span class="ident" id="5929284">b2</span><span class="op" id="5929286">,</span>&nbsp;<span class="ident" id="5929288">b3</span><span class="op" id="5929290">,</span>&nbsp;<span class="ident" id="5929292">b4</span><span class="op" id="5929294">,</span>&nbsp;<span class="ident" id="5929296">b5</span><span class="op" id="5929298">,</span>&nbsp;<span class="ident" id="5929300">b6</span><span class="op" id="5929302">,</span>&nbsp;<span class="ident" id="5929304">b7</span>&nbsp;<span class="builtintype" id="5929307">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929315">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929364">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929389">switch</span>&nbsp;<span class="builtinfunc" id="5929396">len</span><span class="op" id="5929399">(</span><span class="ident" id="5929400">src</span><span class="op" id="5929403">)</span>&nbsp;<span class="op" id="5929405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929409">default</span><span class="op" id="5929416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929421">b7</span>&nbsp;<span class="op" id="5929424">=</span>&nbsp;<span class="ident" id="5929426">src</span><span class="op" id="5929429">[</span><span class="num" id="5929430">4</span><span class="op" id="5929431">]</span>&nbsp;<span class="op" id="5929433">&amp;</span>&nbsp;<span class="num" id="5929435">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929443">b6</span>&nbsp;<span class="op" id="5929446">=</span>&nbsp;<span class="ident" id="5929448">src</span><span class="op" id="5929451">[</span><span class="num" id="5929452">4</span><span class="op" id="5929453">]</span>&nbsp;<span class="op" id="5929455">&gt;&gt;</span>&nbsp;<span class="num" id="5929458">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929463">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929477">case</span>&nbsp;<span class="num" id="5929482">4</span><span class="op" id="5929483">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929488">b6</span>&nbsp;<span class="op" id="5929491">|=</span>&nbsp;<span class="op" id="5929494">(</span><span class="ident" id="5929495">src</span><span class="op" id="5929498">[</span><span class="num" id="5929499">3</span><span class="op" id="5929500">]</span>&nbsp;<span class="op" id="5929502">&lt;&lt;</span>&nbsp;<span class="num" id="5929505">3</span><span class="op" id="5929506">)</span>&nbsp;<span class="op" id="5929508">&amp;</span>&nbsp;<span class="num" id="5929510">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929518">b5</span>&nbsp;<span class="op" id="5929521">=</span>&nbsp;<span class="op" id="5929523">(</span><span class="ident" id="5929524">src</span><span class="op" id="5929527">[</span><span class="num" id="5929528">3</span><span class="op" id="5929529">]</span>&nbsp;<span class="op" id="5929531">&gt;&gt;</span>&nbsp;<span class="num" id="5929534">2</span><span class="op" id="5929535">)</span>&nbsp;<span class="op" id="5929537">&amp;</span>&nbsp;<span class="num" id="5929539">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929547">b4</span>&nbsp;<span class="op" id="5929550">=</span>&nbsp;<span class="ident" id="5929552">src</span><span class="op" id="5929555">[</span><span class="num" id="5929556">3</span><span class="op" id="5929557">]</span>&nbsp;<span class="op" id="5929559">&gt;&gt;</span>&nbsp;<span class="num" id="5929562">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929567">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929581">case</span>&nbsp;<span class="num" id="5929586">3</span><span class="op" id="5929587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929592">b4</span>&nbsp;<span class="op" id="5929595">|=</span>&nbsp;<span class="op" id="5929598">(</span><span class="ident" id="5929599">src</span><span class="op" id="5929602">[</span><span class="num" id="5929603">2</span><span class="op" id="5929604">]</span>&nbsp;<span class="op" id="5929606">&lt;&lt;</span>&nbsp;<span class="num" id="5929609">1</span><span class="op" id="5929610">)</span>&nbsp;<span class="op" id="5929612">&amp;</span>&nbsp;<span class="num" id="5929614">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929622">b3</span>&nbsp;<span class="op" id="5929625">=</span>&nbsp;<span class="op" id="5929627">(</span><span class="ident" id="5929628">src</span><span class="op" id="5929631">[</span><span class="num" id="5929632">2</span><span class="op" id="5929633">]</span>&nbsp;<span class="op" id="5929635">&gt;&gt;</span>&nbsp;<span class="num" id="5929638">4</span><span class="op" id="5929639">)</span>&nbsp;<span class="op" id="5929641">&amp;</span>&nbsp;<span class="num" id="5929643">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929651">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929665">case</span>&nbsp;<span class="num" id="5929670">2</span><span class="op" id="5929671">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929676">b3</span>&nbsp;<span class="op" id="5929679">|=</span>&nbsp;<span class="op" id="5929682">(</span><span class="ident" id="5929683">src</span><span class="op" id="5929686">[</span><span class="num" id="5929687">1</span><span class="op" id="5929688">]</span>&nbsp;<span class="op" id="5929690">&lt;&lt;</span>&nbsp;<span class="num" id="5929693">4</span><span class="op" id="5929694">)</span>&nbsp;<span class="op" id="5929696">&amp;</span>&nbsp;<span class="num" id="5929698">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929706">b2</span>&nbsp;<span class="op" id="5929709">=</span>&nbsp;<span class="op" id="5929711">(</span><span class="ident" id="5929712">src</span><span class="op" id="5929715">[</span><span class="num" id="5929716">1</span><span class="op" id="5929717">]</span>&nbsp;<span class="op" id="5929719">&gt;&gt;</span>&nbsp;<span class="num" id="5929722">1</span><span class="op" id="5929723">)</span>&nbsp;<span class="op" id="5929725">&amp;</span>&nbsp;<span class="num" id="5929727">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929735">b1</span>&nbsp;<span class="op" id="5929738">=</span>&nbsp;<span class="op" id="5929740">(</span><span class="ident" id="5929741">src</span><span class="op" id="5929744">[</span><span class="num" id="5929745">1</span><span class="op" id="5929746">]</span>&nbsp;<span class="op" id="5929748">&gt;&gt;</span>&nbsp;<span class="num" id="5929751">6</span><span class="op" id="5929752">)</span>&nbsp;<span class="op" id="5929754">&amp;</span>&nbsp;<span class="num" id="5929756">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929764">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5929778">case</span>&nbsp;<span class="num" id="5929783">1</span><span class="op" id="5929784">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929789">b1</span>&nbsp;<span class="op" id="5929792">|=</span>&nbsp;<span class="op" id="5929795">(</span><span class="ident" id="5929796">src</span><span class="op" id="5929799">[</span><span class="num" id="5929800">0</span><span class="op" id="5929801">]</span>&nbsp;<span class="op" id="5929803">&lt;&lt;</span>&nbsp;<span class="num" id="5929806">2</span><span class="op" id="5929807">)</span>&nbsp;<span class="op" id="5929809">&amp;</span>&nbsp;<span class="num" id="5929811">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929819">b0</span>&nbsp;<span class="op" id="5929822">=</span>&nbsp;<span class="ident" id="5929824">src</span><span class="op" id="5929827">[</span><span class="num" id="5929828">0</span><span class="op" id="5929829">]</span>&nbsp;<span class="op" id="5929831">&gt;&gt;</span>&nbsp;<span class="num" id="5929834">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5929838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5929843">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929894">dst</span><span class="op" id="5929897">[</span><span class="num" id="5929898">0</span><span class="op" id="5929899">]</span>&nbsp;<span class="op" id="5929901">=</span>&nbsp;<span class="ident" id="5929903">enc</span><span class="op" id="5929906">.</span><span class="ident" id="5929907">encode</span><span class="op" id="5929913">[</span><span class="ident" id="5929914">b0</span><span class="op" id="5929916">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929920">dst</span><span class="op" id="5929923">[</span><span class="num" id="5929924">1</span><span class="op" id="5929925">]</span>&nbsp;<span class="op" id="5929927">=</span>&nbsp;<span class="ident" id="5929929">enc</span><span class="op" id="5929932">.</span><span class="ident" id="5929933">encode</span><span class="op" id="5929939">[</span><span class="ident" id="5929940">b1</span><span class="op" id="5929942">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929946">dst</span><span class="op" id="5929949">[</span><span class="num" id="5929950">2</span><span class="op" id="5929951">]</span>&nbsp;<span class="op" id="5929953">=</span>&nbsp;<span class="ident" id="5929955">enc</span><span class="op" id="5929958">.</span><span class="ident" id="5929959">encode</span><span class="op" id="5929965">[</span><span class="ident" id="5929966">b2</span><span class="op" id="5929968">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929972">dst</span><span class="op" id="5929975">[</span><span class="num" id="5929976">3</span><span class="op" id="5929977">]</span>&nbsp;<span class="op" id="5929979">=</span>&nbsp;<span class="ident" id="5929981">enc</span><span class="op" id="5929984">.</span><span class="ident" id="5929985">encode</span><span class="op" id="5929991">[</span><span class="ident" id="5929992">b3</span><span class="op" id="5929994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5929998">dst</span><span class="op" id="5930001">[</span><span class="num" id="5930002">4</span><span class="op" id="5930003">]</span>&nbsp;<span class="op" id="5930005">=</span>&nbsp;<span class="ident" id="5930007">enc</span><span class="op" id="5930010">.</span><span class="ident" id="5930011">encode</span><span class="op" id="5930017">[</span><span class="ident" id="5930018">b4</span><span class="op" id="5930020">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930024">dst</span><span class="op" id="5930027">[</span><span class="num" id="5930028">5</span><span class="op" id="5930029">]</span>&nbsp;<span class="op" id="5930031">=</span>&nbsp;<span class="ident" id="5930033">enc</span><span class="op" id="5930036">.</span><span class="ident" id="5930037">encode</span><span class="op" id="5930043">[</span><span class="ident" id="5930044">b5</span><span class="op" id="5930046">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930050">dst</span><span class="op" id="5930053">[</span><span class="num" id="5930054">6</span><span class="op" id="5930055">]</span>&nbsp;<span class="op" id="5930057">=</span>&nbsp;<span class="ident" id="5930059">enc</span><span class="op" id="5930062">.</span><span class="ident" id="5930063">encode</span><span class="op" id="5930069">[</span><span class="ident" id="5930070">b6</span><span class="op" id="5930072">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930076">dst</span><span class="op" id="5930079">[</span><span class="num" id="5930080">7</span><span class="op" id="5930081">]</span>&nbsp;<span class="op" id="5930083">=</span>&nbsp;<span class="ident" id="5930085">enc</span><span class="op" id="5930088">.</span><span class="ident" id="5930089">encode</span><span class="op" id="5930095">[</span><span class="ident" id="5930096">b7</span><span class="op" id="5930098">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5930103">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930130">if</span>&nbsp;<span class="builtinfunc" id="5930133">len</span><span class="op" id="5930136">(</span><span class="ident" id="5930137">src</span><span class="op" id="5930140">)</span>&nbsp;<span class="op" id="5930142">&lt;</span>&nbsp;<span class="num" id="5930144">5</span>&nbsp;<span class="op" id="5930146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930151">dst</span><span class="op" id="5930154">[</span><span class="num" id="5930155">7</span><span class="op" id="5930156">]</span>&nbsp;<span class="op" id="5930158">=</span>&nbsp;<span class="string" id="5930160">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930167">if</span>&nbsp;<span class="builtinfunc" id="5930170">len</span><span class="op" id="5930173">(</span><span class="ident" id="5930174">src</span><span class="op" id="5930177">)</span>&nbsp;<span class="op" id="5930179">&lt;</span>&nbsp;<span class="num" id="5930181">4</span>&nbsp;<span class="op" id="5930183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930189">dst</span><span class="op" id="5930192">[</span><span class="num" id="5930193">6</span><span class="op" id="5930194">]</span>&nbsp;<span class="op" id="5930196">=</span>&nbsp;<span class="string" id="5930198">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930206">dst</span><span class="op" id="5930209">[</span><span class="num" id="5930210">5</span><span class="op" id="5930211">]</span>&nbsp;<span class="op" id="5930213">=</span>&nbsp;<span class="string" id="5930215">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930223">if</span>&nbsp;<span class="builtinfunc" id="5930226">len</span><span class="op" id="5930229">(</span><span class="ident" id="5930230">src</span><span class="op" id="5930233">)</span>&nbsp;<span class="op" id="5930235">&lt;</span>&nbsp;<span class="num" id="5930237">3</span>&nbsp;<span class="op" id="5930239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930246">dst</span><span class="op" id="5930249">[</span><span class="num" id="5930250">4</span><span class="op" id="5930251">]</span>&nbsp;<span class="op" id="5930253">=</span>&nbsp;<span class="string" id="5930255">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930264">if</span>&nbsp;<span class="builtinfunc" id="5930267">len</span><span class="op" id="5930270">(</span><span class="ident" id="5930271">src</span><span class="op" id="5930274">)</span>&nbsp;<span class="op" id="5930276">&lt;</span>&nbsp;<span class="num" id="5930278">2</span>&nbsp;<span class="op" id="5930280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930288">dst</span><span class="op" id="5930291">[</span><span class="num" id="5930292">3</span><span class="op" id="5930293">]</span>&nbsp;<span class="op" id="5930295">=</span>&nbsp;<span class="string" id="5930297">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930307">dst</span><span class="op" id="5930310">[</span><span class="num" id="5930311">2</span><span class="op" id="5930312">]</span>&nbsp;<span class="op" id="5930314">=</span>&nbsp;<span class="string" id="5930316">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5930325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5930331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5930336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930341">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5930349">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930353">src</span>&nbsp;<span class="op" id="5930357">=</span>&nbsp;<span class="ident" id="5930359">src</span><span class="op" id="5930362">[</span><span class="num" id="5930363">5</span><span class="op" id="5930364">:</span><span class="op" id="5930365">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930369">dst</span>&nbsp;<span class="op" id="5930373">=</span>&nbsp;<span class="ident" id="5930375">dst</span><span class="op" id="5930378">[</span><span class="num" id="5930379">8</span><span class="op" id="5930380">:</span><span class="op" id="5930381">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5930384">}</span><br>
<span class="lineno"></span><span class="op" id="5930386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5930389">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="5930443">func</span>&nbsp;<span class="op" id="5930448">(</span><span class="ident" id="5930449">enc</span>&nbsp;<span class="op" id="5930453">*</span><span class="ident" id="5930454">Encoding</span><span class="op" id="5930462">)</span>&nbsp;<span class="ident" id="5930464">EncodeToString</span><span class="op" id="5930478">(</span><span class="ident" id="5930479">src</span>&nbsp;<span class="op" id="5930483">[</span><span class="op" id="5930484">]</span><span class="builtintype" id="5930485">byte</span><span class="op" id="5930489">)</span>&nbsp;<span class="builtintype" id="5930491">string</span>&nbsp;<span class="op" id="5930498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930501">buf</span>&nbsp;<span class="op" id="5930505">:=</span>&nbsp;<span class="builtinfunc" id="5930508">make</span><span class="op" id="5930512">(</span><span class="op" id="5930513">[</span><span class="op" id="5930514">]</span><span class="builtintype" id="5930515">byte</span><span class="op" id="5930519">,</span>&nbsp;<span class="ident" id="5930521">enc</span><span class="op" id="5930524">.</span><span class="ident" id="5930525">EncodedLen</span><span class="op" id="5930535">(</span><span class="builtinfunc" id="5930536">len</span><span class="op" id="5930539">(</span><span class="ident" id="5930540">src</span><span class="op" id="5930543">)</span><span class="op" id="5930544">)</span><span class="op" id="5930545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930548">enc</span><span class="op" id="5930551">.</span><span class="ident" id="5930552">Encode</span><span class="op" id="5930558">(</span><span class="ident" id="5930559">buf</span><span class="op" id="5930562">,</span>&nbsp;<span class="ident" id="5930564">src</span><span class="op" id="5930567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930570">return</span>&nbsp;<span class="builtintype" id="5930577">string</span><span class="op" id="5930583">(</span><span class="ident" id="5930584">buf</span><span class="op" id="5930587">)</span><br>
<span class="lineno">140</span><span class="op" id="5930589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5930592">type</span>&nbsp;<span class="ident" id="5930597">encoder</span>&nbsp;<span class="keyword" id="5930605">struct</span>&nbsp;<span class="op" id="5930612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930615">err</span>&nbsp;&nbsp;<span class="builtintype" id="5930620">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930627">enc</span>&nbsp;&nbsp;<span class="op" id="5930632">*</span><span class="ident" id="5930633">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930643">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930648">io</span><span class="op" id="5930650">.</span><span class="ident" id="5930651">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930659">buf</span>&nbsp;&nbsp;<span class="op" id="5930664">[</span><span class="num" id="5930665">5</span><span class="op" id="5930666">]</span><span class="builtintype" id="5930667">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5930675">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930715">nbuf</span>&nbsp;<span class="builtintype" id="5930720">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5930731">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930758">out</span>&nbsp;&nbsp;<span class="op" id="5930763">[</span><span class="num" id="5930764">1024</span><span class="op" id="5930768">]</span><span class="builtintype" id="5930769">byte</span>&nbsp;<span class="comment" id="5930774">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="5930791">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="5930794">func</span>&nbsp;<span class="op" id="5930799">(</span><span class="ident" id="5930800">e</span>&nbsp;<span class="op" id="5930802">*</span><span class="ident" id="5930803">encoder</span><span class="op" id="5930810">)</span>&nbsp;<span class="ident" id="5930812">Write</span><span class="op" id="5930817">(</span><span class="ident" id="5930818">p</span>&nbsp;<span class="op" id="5930820">[</span><span class="op" id="5930821">]</span><span class="builtintype" id="5930822">byte</span><span class="op" id="5930826">)</span>&nbsp;<span class="op" id="5930828">(</span><span class="ident" id="5930829">n</span>&nbsp;<span class="builtintype" id="5930831">int</span><span class="op" id="5930834">,</span>&nbsp;<span class="ident" id="5930836">err</span>&nbsp;<span class="builtintype" id="5930840">error</span><span class="op" id="5930845">)</span>&nbsp;<span class="op" id="5930847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930850">if</span>&nbsp;<span class="ident" id="5930853">e</span><span class="op" id="5930854">.</span><span class="ident" id="5930855">err</span>&nbsp;<span class="op" id="5930859">!=</span>&nbsp;<span class="ident" id="5930862">nil</span>&nbsp;<span class="op" id="5930866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930870">return</span>&nbsp;<span class="num" id="5930877">0</span><span class="op" id="5930878">,</span>&nbsp;<span class="ident" id="5930880">e</span><span class="op" id="5930881">.</span><span class="ident" id="5930882">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5930887">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5930891">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930911">if</span>&nbsp;<span class="ident" id="5930914">e</span><span class="op" id="5930915">.</span><span class="ident" id="5930916">nbuf</span>&nbsp;<span class="op" id="5930921">&gt;</span>&nbsp;<span class="num" id="5930923">0</span>&nbsp;<span class="op" id="5930925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930929">var</span>&nbsp;<span class="ident" id="5930933">i</span>&nbsp;<span class="builtintype" id="5930935">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5930941">for</span>&nbsp;<span class="ident" id="5930945">i</span>&nbsp;<span class="op" id="5930947">=</span>&nbsp;<span class="num" id="5930949">0</span><span class="op" id="5930950">;</span>&nbsp;<span class="ident" id="5930952">i</span>&nbsp;<span class="op" id="5930954">&lt;</span>&nbsp;<span class="builtinfunc" id="5930956">len</span><span class="op" id="5930959">(</span><span class="ident" id="5930960">p</span><span class="op" id="5930961">)</span>&nbsp;<span class="op" id="5930963">&amp;&amp;</span>&nbsp;<span class="ident" id="5930966">e</span><span class="op" id="5930967">.</span><span class="ident" id="5930968">nbuf</span>&nbsp;<span class="op" id="5930973">&lt;</span>&nbsp;<span class="num" id="5930975">5</span><span class="op" id="5930976">;</span>&nbsp;<span class="ident" id="5930978">i</span><span class="op" id="5930979">++</span>&nbsp;<span class="op" id="5930982">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5930987">e</span><span class="op" id="5930988">.</span><span class="ident" id="5930989">buf</span><span class="op" id="5930992">[</span><span class="ident" id="5930993">e</span><span class="op" id="5930994">.</span><span class="ident" id="5930995">nbuf</span><span class="op" id="5930999">]</span>&nbsp;<span class="op" id="5931001">=</span>&nbsp;<span class="ident" id="5931003">p</span><span class="op" id="5931004">[</span><span class="ident" id="5931005">i</span><span class="op" id="5931006">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931011">e</span><span class="op" id="5931012">.</span><span class="ident" id="5931013">nbuf</span><span class="op" id="5931017">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931026">n</span>&nbsp;<span class="op" id="5931028">+=</span>&nbsp;<span class="ident" id="5931031">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931035">p</span>&nbsp;<span class="op" id="5931037">=</span>&nbsp;<span class="ident" id="5931039">p</span><span class="op" id="5931040">[</span><span class="ident" id="5931041">i</span><span class="op" id="5931042">:</span><span class="op" id="5931043">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931047">if</span>&nbsp;<span class="ident" id="5931050">e</span><span class="op" id="5931051">.</span><span class="ident" id="5931052">nbuf</span>&nbsp;<span class="op" id="5931057">&lt;</span>&nbsp;<span class="num" id="5931059">5</span>&nbsp;<span class="op" id="5931061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931066">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931079">e</span><span class="op" id="5931080">.</span><span class="ident" id="5931081">enc</span><span class="op" id="5931084">.</span><span class="ident" id="5931085">Encode</span><span class="op" id="5931091">(</span><span class="ident" id="5931092">e</span><span class="op" id="5931093">.</span><span class="ident" id="5931094">out</span><span class="op" id="5931097">[</span><span class="num" id="5931098">0</span><span class="op" id="5931099">:</span><span class="op" id="5931100">]</span><span class="op" id="5931101">,</span>&nbsp;<span class="ident" id="5931103">e</span><span class="op" id="5931104">.</span><span class="ident" id="5931105">buf</span><span class="op" id="5931108">[</span><span class="num" id="5931109">0</span><span class="op" id="5931110">:</span><span class="op" id="5931111">]</span><span class="op" id="5931112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931116">if</span>&nbsp;<span class="ident" id="5931119">_</span><span class="op" id="5931120">,</span>&nbsp;<span class="ident" id="5931122">e</span><span class="op" id="5931123">.</span><span class="ident" id="5931124">err</span>&nbsp;<span class="op" id="5931128">=</span>&nbsp;<span class="ident" id="5931130">e</span><span class="op" id="5931131">.</span><span class="ident" id="5931132">w</span><span class="op" id="5931133">.</span><span class="ident" id="5931134">Write</span><span class="op" id="5931139">(</span><span class="ident" id="5931140">e</span><span class="op" id="5931141">.</span><span class="ident" id="5931142">out</span><span class="op" id="5931145">[</span><span class="num" id="5931146">0</span><span class="op" id="5931147">:</span><span class="num" id="5931148">8</span><span class="op" id="5931149">]</span><span class="op" id="5931150">)</span><span class="op" id="5931151">;</span>&nbsp;<span class="ident" id="5931153">e</span><span class="op" id="5931154">.</span><span class="ident" id="5931155">err</span>&nbsp;<span class="op" id="5931159">!=</span>&nbsp;<span class="ident" id="5931162">nil</span>&nbsp;<span class="op" id="5931166">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931171">return</span>&nbsp;<span class="ident" id="5931178">n</span><span class="op" id="5931179">,</span>&nbsp;<span class="ident" id="5931181">e</span><span class="op" id="5931182">.</span><span class="ident" id="5931183">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931193">e</span><span class="op" id="5931194">.</span><span class="ident" id="5931195">nbuf</span>&nbsp;<span class="op" id="5931200">=</span>&nbsp;<span class="num" id="5931202">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5931209">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931236">for</span>&nbsp;<span class="builtinfunc" id="5931240">len</span><span class="op" id="5931243">(</span><span class="ident" id="5931244">p</span><span class="op" id="5931245">)</span>&nbsp;<span class="op" id="5931247">&gt;=</span>&nbsp;<span class="num" id="5931250">5</span>&nbsp;<span class="op" id="5931252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931256">nn</span>&nbsp;<span class="op" id="5931259">:=</span>&nbsp;<span class="builtinfunc" id="5931262">len</span><span class="op" id="5931265">(</span><span class="ident" id="5931266">e</span><span class="op" id="5931267">.</span><span class="ident" id="5931268">out</span><span class="op" id="5931271">)</span>&nbsp;<span class="op" id="5931273">/</span>&nbsp;<span class="num" id="5931275">8</span>&nbsp;<span class="op" id="5931277">*</span>&nbsp;<span class="num" id="5931279">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931283">if</span>&nbsp;<span class="ident" id="5931286">nn</span>&nbsp;<span class="op" id="5931289">&gt;</span>&nbsp;<span class="builtinfunc" id="5931291">len</span><span class="op" id="5931294">(</span><span class="ident" id="5931295">p</span><span class="op" id="5931296">)</span>&nbsp;<span class="op" id="5931298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931303">nn</span>&nbsp;<span class="op" id="5931306">=</span>&nbsp;<span class="builtinfunc" id="5931308">len</span><span class="op" id="5931311">(</span><span class="ident" id="5931312">p</span><span class="op" id="5931313">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931318">nn</span>&nbsp;<span class="op" id="5931321">-=</span>&nbsp;<span class="ident" id="5931324">nn</span>&nbsp;<span class="op" id="5931327">%</span>&nbsp;<span class="num" id="5931329">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931337">e</span><span class="op" id="5931338">.</span><span class="ident" id="5931339">enc</span><span class="op" id="5931342">.</span><span class="ident" id="5931343">Encode</span><span class="op" id="5931349">(</span><span class="ident" id="5931350">e</span><span class="op" id="5931351">.</span><span class="ident" id="5931352">out</span><span class="op" id="5931355">[</span><span class="num" id="5931356">0</span><span class="op" id="5931357">:</span><span class="op" id="5931358">]</span><span class="op" id="5931359">,</span>&nbsp;<span class="ident" id="5931361">p</span><span class="op" id="5931362">[</span><span class="num" id="5931363">0</span><span class="op" id="5931364">:</span><span class="ident" id="5931365">nn</span><span class="op" id="5931367">]</span><span class="op" id="5931368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931372">if</span>&nbsp;<span class="ident" id="5931375">_</span><span class="op" id="5931376">,</span>&nbsp;<span class="ident" id="5931378">e</span><span class="op" id="5931379">.</span><span class="ident" id="5931380">err</span>&nbsp;<span class="op" id="5931384">=</span>&nbsp;<span class="ident" id="5931386">e</span><span class="op" id="5931387">.</span><span class="ident" id="5931388">w</span><span class="op" id="5931389">.</span><span class="ident" id="5931390">Write</span><span class="op" id="5931395">(</span><span class="ident" id="5931396">e</span><span class="op" id="5931397">.</span><span class="ident" id="5931398">out</span><span class="op" id="5931401">[</span><span class="num" id="5931402">0</span>&nbsp;<span class="op" id="5931404">:</span>&nbsp;<span class="ident" id="5931406">nn</span><span class="op" id="5931408">/</span><span class="num" id="5931409">5</span><span class="op" id="5931410">*</span><span class="num" id="5931411">8</span><span class="op" id="5931412">]</span><span class="op" id="5931413">)</span><span class="op" id="5931414">;</span>&nbsp;<span class="ident" id="5931416">e</span><span class="op" id="5931417">.</span><span class="ident" id="5931418">err</span>&nbsp;<span class="op" id="5931422">!=</span>&nbsp;<span class="ident" id="5931425">nil</span>&nbsp;<span class="op" id="5931429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931434">return</span>&nbsp;<span class="ident" id="5931441">n</span><span class="op" id="5931442">,</span>&nbsp;<span class="ident" id="5931444">e</span><span class="op" id="5931445">.</span><span class="ident" id="5931446">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931456">n</span>&nbsp;<span class="op" id="5931458">+=</span>&nbsp;<span class="ident" id="5931461">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931466">p</span>&nbsp;<span class="op" id="5931468">=</span>&nbsp;<span class="ident" id="5931470">p</span><span class="op" id="5931471">[</span><span class="ident" id="5931472">nn</span><span class="op" id="5931474">:</span><span class="op" id="5931475">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5931482">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931503">for</span>&nbsp;<span class="ident" id="5931507">i</span>&nbsp;<span class="op" id="5931509">:=</span>&nbsp;<span class="num" id="5931512">0</span><span class="op" id="5931513">;</span>&nbsp;<span class="ident" id="5931515">i</span>&nbsp;<span class="op" id="5931517">&lt;</span>&nbsp;<span class="builtinfunc" id="5931519">len</span><span class="op" id="5931522">(</span><span class="ident" id="5931523">p</span><span class="op" id="5931524">)</span><span class="op" id="5931525">;</span>&nbsp;<span class="ident" id="5931527">i</span><span class="op" id="5931528">++</span>&nbsp;<span class="op" id="5931531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931535">e</span><span class="op" id="5931536">.</span><span class="ident" id="5931537">buf</span><span class="op" id="5931540">[</span><span class="ident" id="5931541">i</span><span class="op" id="5931542">]</span>&nbsp;<span class="op" id="5931544">=</span>&nbsp;<span class="ident" id="5931546">p</span><span class="op" id="5931547">[</span><span class="ident" id="5931548">i</span><span class="op" id="5931549">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931555">e</span><span class="op" id="5931556">.</span><span class="ident" id="5931557">nbuf</span>&nbsp;<span class="op" id="5931562">=</span>&nbsp;<span class="builtinfunc" id="5931564">len</span><span class="op" id="5931567">(</span><span class="ident" id="5931568">p</span><span class="op" id="5931569">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931572">n</span>&nbsp;<span class="op" id="5931574">+=</span>&nbsp;<span class="builtinfunc" id="5931577">len</span><span class="op" id="5931580">(</span><span class="ident" id="5931581">p</span><span class="op" id="5931582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931585">return</span><br>
<span class="lineno"></span><span class="op" id="5931592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5931595">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="5931649">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5931702">func</span>&nbsp;<span class="op" id="5931707">(</span><span class="ident" id="5931708">e</span>&nbsp;<span class="op" id="5931710">*</span><span class="ident" id="5931711">encoder</span><span class="op" id="5931718">)</span>&nbsp;<span class="ident" id="5931720">Close</span><span class="op" id="5931725">(</span><span class="op" id="5931726">)</span>&nbsp;<span class="builtintype" id="5931728">error</span>&nbsp;<span class="op" id="5931734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5931737">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931794">if</span>&nbsp;<span class="ident" id="5931797">e</span><span class="op" id="5931798">.</span><span class="ident" id="5931799">err</span>&nbsp;<span class="op" id="5931803">==</span>&nbsp;<span class="ident" id="5931806">nil</span>&nbsp;<span class="op" id="5931810">&amp;&amp;</span>&nbsp;<span class="ident" id="5931813">e</span><span class="op" id="5931814">.</span><span class="ident" id="5931815">nbuf</span>&nbsp;<span class="op" id="5931820">&gt;</span>&nbsp;<span class="num" id="5931822">0</span>&nbsp;<span class="op" id="5931824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931828">e</span><span class="op" id="5931829">.</span><span class="ident" id="5931830">enc</span><span class="op" id="5931833">.</span><span class="ident" id="5931834">Encode</span><span class="op" id="5931840">(</span><span class="ident" id="5931841">e</span><span class="op" id="5931842">.</span><span class="ident" id="5931843">out</span><span class="op" id="5931846">[</span><span class="num" id="5931847">0</span><span class="op" id="5931848">:</span><span class="op" id="5931849">]</span><span class="op" id="5931850">,</span>&nbsp;<span class="ident" id="5931852">e</span><span class="op" id="5931853">.</span><span class="ident" id="5931854">buf</span><span class="op" id="5931857">[</span><span class="num" id="5931858">0</span><span class="op" id="5931859">:</span><span class="ident" id="5931860">e</span><span class="op" id="5931861">.</span><span class="ident" id="5931862">nbuf</span><span class="op" id="5931866">]</span><span class="op" id="5931867">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931871">e</span><span class="op" id="5931872">.</span><span class="ident" id="5931873">nbuf</span>&nbsp;<span class="op" id="5931878">=</span>&nbsp;<span class="num" id="5931880">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5931884">_</span><span class="op" id="5931885">,</span>&nbsp;<span class="ident" id="5931887">e</span><span class="op" id="5931888">.</span><span class="ident" id="5931889">err</span>&nbsp;<span class="op" id="5931893">=</span>&nbsp;<span class="ident" id="5931895">e</span><span class="op" id="5931896">.</span><span class="ident" id="5931897">w</span><span class="op" id="5931898">.</span><span class="ident" id="5931899">Write</span><span class="op" id="5931904">(</span><span class="ident" id="5931905">e</span><span class="op" id="5931906">.</span><span class="ident" id="5931907">out</span><span class="op" id="5931910">[</span><span class="num" id="5931911">0</span><span class="op" id="5931912">:</span><span class="num" id="5931913">8</span><span class="op" id="5931914">]</span><span class="op" id="5931915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5931918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5931921">return</span>&nbsp;<span class="ident" id="5931928">e</span><span class="op" id="5931929">.</span><span class="ident" id="5931930">err</span><br>
<span class="lineno"></span><span class="op" id="5931934">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5931937">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5932005">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5932077">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="5932137">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="5932205">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="5932234">func</span>&nbsp;<span class="ident" id="5932239">NewEncoder</span><span class="op" id="5932249">(</span><span class="ident" id="5932250">enc</span>&nbsp;<span class="op" id="5932254">*</span><span class="ident" id="5932255">Encoding</span><span class="op" id="5932263">,</span>&nbsp;<span class="ident" id="5932265">w</span>&nbsp;<span class="ident" id="5932267">io</span><span class="op" id="5932269">.</span><span class="ident" id="5932270">Writer</span><span class="op" id="5932276">)</span>&nbsp;<span class="ident" id="5932278">io</span><span class="op" id="5932280">.</span><span class="ident" id="5932281">WriteCloser</span>&nbsp;<span class="op" id="5932293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5932296">return</span>&nbsp;<span class="op" id="5932303">&amp;</span><span class="ident" id="5932304">encoder</span><span class="op" id="5932311">{</span><span class="ident" id="5932312">enc</span><span class="op" id="5932315">:</span>&nbsp;<span class="ident" id="5932317">enc</span><span class="op" id="5932320">,</span>&nbsp;<span class="ident" id="5932322">w</span><span class="op" id="5932323">:</span>&nbsp;<span class="ident" id="5932325">w</span><span class="op" id="5932326">}</span><br>
<span class="lineno"></span><span class="op" id="5932328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5932331">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5932396">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="5932431">func</span>&nbsp;<span class="op" id="5932436">(</span><span class="ident" id="5932437">enc</span>&nbsp;<span class="op" id="5932441">*</span><span class="ident" id="5932442">Encoding</span><span class="op" id="5932450">)</span>&nbsp;<span class="ident" id="5932452">EncodedLen</span><span class="op" id="5932462">(</span><span class="ident" id="5932463">n</span>&nbsp;<span class="builtintype" id="5932465">int</span><span class="op" id="5932468">)</span>&nbsp;<span class="builtintype" id="5932470">int</span>&nbsp;<span class="op" id="5932474">{</span>&nbsp;<span class="keyword" id="5932476">return</span>&nbsp;<span class="op" id="5932483">(</span><span class="ident" id="5932484">n</span>&nbsp;<span class="op" id="5932486">+</span>&nbsp;<span class="num" id="5932488">4</span><span class="op" id="5932489">)</span>&nbsp;<span class="op" id="5932491">/</span>&nbsp;<span class="num" id="5932493">5</span>&nbsp;<span class="op" id="5932495">*</span>&nbsp;<span class="num" id="5932497">8</span>&nbsp;<span class="op" id="5932499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5932502">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5932521">type</span>&nbsp;<span class="ident" id="5932526">CorruptInputError</span>&nbsp;<span class="ident" id="5932544">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="5932551">func</span>&nbsp;<span class="op" id="5932556">(</span><span class="ident" id="5932557">e</span>&nbsp;<span class="ident" id="5932559">CorruptInputError</span><span class="op" id="5932576">)</span>&nbsp;<span class="ident" id="5932578">Error</span><span class="op" id="5932583">(</span><span class="op" id="5932584">)</span>&nbsp;<span class="builtintype" id="5932586">string</span>&nbsp;<span class="op" id="5932593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5932596">return</span>&nbsp;<span class="string" id="5932603">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="5932640">+</span>&nbsp;<span class="ident" id="5932642">strconv</span><span class="op" id="5932649">.</span><span class="ident" id="5932650">FormatInt</span><span class="op" id="5932659">(</span><span class="ident" id="5932660">int64</span><span class="op" id="5932665">(</span><span class="ident" id="5932666">e</span><span class="op" id="5932667">)</span><span class="op" id="5932668">,</span>&nbsp;<span class="num" id="5932670">10</span><span class="op" id="5932672">)</span><br>
<span class="lineno"></span><span class="op" id="5932674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5932677">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="5932747">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5932815">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="5932885">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="5932942">func</span>&nbsp;<span class="op" id="5932947">(</span><span class="ident" id="5932948">enc</span>&nbsp;<span class="op" id="5932952">*</span><span class="ident" id="5932953">Encoding</span><span class="op" id="5932961">)</span>&nbsp;<span class="ident" id="5932963">decode</span><span class="op" id="5932969">(</span><span class="ident" id="5932970">dst</span><span class="op" id="5932973">,</span>&nbsp;<span class="ident" id="5932975">src</span>&nbsp;<span class="op" id="5932979">[</span><span class="op" id="5932980">]</span><span class="builtintype" id="5932981">byte</span><span class="op" id="5932985">)</span>&nbsp;<span class="op" id="5932987">(</span><span class="ident" id="5932988">n</span>&nbsp;<span class="builtintype" id="5932990">int</span><span class="op" id="5932993">,</span>&nbsp;<span class="ident" id="5932995">end</span>&nbsp;<span class="builtintype" id="5932999">bool</span><span class="op" id="5933003">,</span>&nbsp;<span class="ident" id="5933005">err</span>&nbsp;<span class="builtintype" id="5933009">error</span><span class="op" id="5933014">)</span>&nbsp;<span class="op" id="5933016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933019">olen</span>&nbsp;<span class="op" id="5933024">:=</span>&nbsp;<span class="builtinfunc" id="5933027">len</span><span class="op" id="5933030">(</span><span class="ident" id="5933031">src</span><span class="op" id="5933034">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933037">for</span>&nbsp;<span class="builtinfunc" id="5933041">len</span><span class="op" id="5933044">(</span><span class="ident" id="5933045">src</span><span class="op" id="5933048">)</span>&nbsp;<span class="op" id="5933050">&gt;</span>&nbsp;<span class="num" id="5933052">0</span>&nbsp;<span class="op" id="5933054">&amp;&amp;</span>&nbsp;<span class="op" id="5933057">!</span><span class="ident" id="5933058">end</span>&nbsp;<span class="op" id="5933062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933066">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933112">var</span>&nbsp;<span class="ident" id="5933116">dbuf</span>&nbsp;<span class="op" id="5933121">[</span><span class="num" id="5933122">8</span><span class="op" id="5933123">]</span><span class="builtintype" id="5933124">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933131">dlen</span>&nbsp;<span class="op" id="5933136">:=</span>&nbsp;<span class="num" id="5933139">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933144">for</span>&nbsp;<span class="ident" id="5933148">j</span>&nbsp;<span class="op" id="5933150">:=</span>&nbsp;<span class="num" id="5933153">0</span><span class="op" id="5933154">;</span>&nbsp;<span class="ident" id="5933156">j</span>&nbsp;<span class="op" id="5933158">&lt;</span>&nbsp;<span class="num" id="5933160">8</span><span class="op" id="5933161">;</span>&nbsp;<span class="op" id="5933163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933168">if</span>&nbsp;<span class="builtinfunc" id="5933171">len</span><span class="op" id="5933174">(</span><span class="ident" id="5933175">src</span><span class="op" id="5933178">)</span>&nbsp;<span class="op" id="5933180">==</span>&nbsp;<span class="num" id="5933183">0</span>&nbsp;<span class="op" id="5933185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933191">return</span>&nbsp;<span class="ident" id="5933198">n</span><span class="op" id="5933199">,</span>&nbsp;<span class="builtintype" id="5933201">false</span><span class="op" id="5933206">,</span>&nbsp;<span class="ident" id="5933208">CorruptInputError</span><span class="op" id="5933225">(</span><span class="ident" id="5933226">olen</span>&nbsp;<span class="op" id="5933231">-</span>&nbsp;<span class="builtinfunc" id="5933233">len</span><span class="op" id="5933236">(</span><span class="ident" id="5933237">src</span><span class="op" id="5933240">)</span>&nbsp;<span class="op" id="5933242">-</span>&nbsp;<span class="ident" id="5933244">j</span><span class="op" id="5933245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5933250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933255">in</span>&nbsp;<span class="op" id="5933258">:=</span>&nbsp;<span class="ident" id="5933261">src</span><span class="op" id="5933264">[</span><span class="num" id="5933265">0</span><span class="op" id="5933266">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933271">src</span>&nbsp;<span class="op" id="5933275">=</span>&nbsp;<span class="ident" id="5933277">src</span><span class="op" id="5933280">[</span><span class="num" id="5933281">1</span><span class="op" id="5933282">:</span><span class="op" id="5933283">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933288">if</span>&nbsp;<span class="ident" id="5933291">in</span>&nbsp;<span class="op" id="5933294">==</span>&nbsp;<span class="string" id="5933297">&#39;=&#39;</span>&nbsp;<span class="op" id="5933301">&amp;&amp;</span>&nbsp;<span class="ident" id="5933304">j</span>&nbsp;<span class="op" id="5933306">&gt;=</span>&nbsp;<span class="num" id="5933309">2</span>&nbsp;<span class="op" id="5933311">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5933314">len</span><span class="op" id="5933317">(</span><span class="ident" id="5933318">src</span><span class="op" id="5933321">)</span>&nbsp;<span class="op" id="5933323">&lt;</span>&nbsp;<span class="num" id="5933325">8</span>&nbsp;<span class="op" id="5933327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933333">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933382">if</span>&nbsp;<span class="builtinfunc" id="5933385">len</span><span class="op" id="5933388">(</span><span class="ident" id="5933389">src</span><span class="op" id="5933392">)</span><span class="op" id="5933393">+</span><span class="ident" id="5933394">j</span>&nbsp;<span class="op" id="5933396">&lt;</span>&nbsp;<span class="num" id="5933398">8</span><span class="op" id="5933399">-</span><span class="num" id="5933400">1</span>&nbsp;<span class="op" id="5933402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933409">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933436">return</span>&nbsp;<span class="ident" id="5933443">n</span><span class="op" id="5933444">,</span>&nbsp;<span class="builtintype" id="5933446">false</span><span class="op" id="5933451">,</span>&nbsp;<span class="ident" id="5933453">CorruptInputError</span><span class="op" id="5933470">(</span><span class="ident" id="5933471">olen</span><span class="op" id="5933475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5933481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933487">for</span>&nbsp;<span class="ident" id="5933491">k</span>&nbsp;<span class="op" id="5933493">:=</span>&nbsp;<span class="num" id="5933496">0</span><span class="op" id="5933497">;</span>&nbsp;<span class="ident" id="5933499">k</span>&nbsp;<span class="op" id="5933501">&lt;</span>&nbsp;<span class="num" id="5933503">8</span><span class="op" id="5933504">-</span><span class="num" id="5933505">1</span><span class="op" id="5933506">-</span><span class="ident" id="5933507">j</span><span class="op" id="5933508">;</span>&nbsp;<span class="ident" id="5933510">k</span><span class="op" id="5933511">++</span>&nbsp;<span class="op" id="5933514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933521">if</span>&nbsp;<span class="builtinfunc" id="5933524">len</span><span class="op" id="5933527">(</span><span class="ident" id="5933528">src</span><span class="op" id="5933531">)</span>&nbsp;<span class="op" id="5933533">&gt;</span>&nbsp;<span class="ident" id="5933535">k</span>&nbsp;<span class="op" id="5933537">&amp;&amp;</span>&nbsp;<span class="ident" id="5933540">src</span><span class="op" id="5933543">[</span><span class="ident" id="5933544">k</span><span class="op" id="5933545">]</span>&nbsp;<span class="op" id="5933547">!=</span>&nbsp;<span class="string" id="5933550">&#39;=&#39;</span>&nbsp;<span class="op" id="5933554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933562">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5933589">return</span>&nbsp;<span class="ident" id="5933596">n</span><span class="op" id="5933597">,</span>&nbsp;<span class="builtintype" id="5933599">false</span><span class="op" id="5933604">,</span>&nbsp;<span class="ident" id="5933606">CorruptInputError</span><span class="op" id="5933623">(</span><span class="ident" id="5933624">olen</span>&nbsp;<span class="op" id="5933629">-</span>&nbsp;<span class="builtinfunc" id="5933631">len</span><span class="op" id="5933634">(</span><span class="ident" id="5933635">src</span><span class="op" id="5933638">)</span>&nbsp;<span class="op" id="5933640">+</span>&nbsp;<span class="ident" id="5933642">k</span>&nbsp;<span class="op" id="5933644">-</span>&nbsp;<span class="num" id="5933646">1</span><span class="op" id="5933647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5933654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5933660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933666">dlen</span><span class="op" id="5933670">,</span>&nbsp;<span class="ident" id="5933672">end</span>&nbsp;<span class="op" id="5933676">=</span>&nbsp;<span class="ident" id="5933678">j</span><span class="op" id="5933679">,</span>&nbsp;<span class="builtintype" id="5933681">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933690">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933765">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933841">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933913">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5933986">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934057">if</span>&nbsp;<span class="ident" id="5934060">dlen</span>&nbsp;<span class="op" id="5934065">==</span>&nbsp;<span class="num" id="5934068">1</span>&nbsp;<span class="op" id="5934070">||</span>&nbsp;<span class="ident" id="5934073">dlen</span>&nbsp;<span class="op" id="5934078">==</span>&nbsp;<span class="num" id="5934081">3</span>&nbsp;<span class="op" id="5934083">||</span>&nbsp;<span class="ident" id="5934086">dlen</span>&nbsp;<span class="op" id="5934091">==</span>&nbsp;<span class="num" id="5934094">6</span>&nbsp;<span class="op" id="5934096">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934103">return</span>&nbsp;<span class="ident" id="5934110">n</span><span class="op" id="5934111">,</span>&nbsp;<span class="builtintype" id="5934113">false</span><span class="op" id="5934118">,</span>&nbsp;<span class="ident" id="5934120">CorruptInputError</span><span class="op" id="5934137">(</span><span class="ident" id="5934138">olen</span>&nbsp;<span class="op" id="5934143">-</span>&nbsp;<span class="builtinfunc" id="5934145">len</span><span class="op" id="5934148">(</span><span class="ident" id="5934149">src</span><span class="op" id="5934152">)</span>&nbsp;<span class="op" id="5934154">-</span>&nbsp;<span class="num" id="5934156">1</span><span class="op" id="5934157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934169">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934183">dbuf</span><span class="op" id="5934187">[</span><span class="ident" id="5934188">j</span><span class="op" id="5934189">]</span>&nbsp;<span class="op" id="5934191">=</span>&nbsp;<span class="ident" id="5934193">enc</span><span class="op" id="5934196">.</span><span class="ident" id="5934197">decodeMap</span><span class="op" id="5934206">[</span><span class="ident" id="5934207">in</span><span class="op" id="5934209">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934214">if</span>&nbsp;<span class="ident" id="5934217">dbuf</span><span class="op" id="5934221">[</span><span class="ident" id="5934222">j</span><span class="op" id="5934223">]</span>&nbsp;<span class="op" id="5934225">==</span>&nbsp;<span class="num" id="5934228">0xFF</span>&nbsp;<span class="op" id="5934233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934239">return</span>&nbsp;<span class="ident" id="5934246">n</span><span class="op" id="5934247">,</span>&nbsp;<span class="builtintype" id="5934249">false</span><span class="op" id="5934254">,</span>&nbsp;<span class="ident" id="5934256">CorruptInputError</span><span class="op" id="5934273">(</span><span class="ident" id="5934274">olen</span>&nbsp;<span class="op" id="5934279">-</span>&nbsp;<span class="builtinfunc" id="5934281">len</span><span class="op" id="5934284">(</span><span class="ident" id="5934285">src</span><span class="op" id="5934288">)</span>&nbsp;<span class="op" id="5934290">-</span>&nbsp;<span class="num" id="5934292">1</span><span class="op" id="5934293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934303">j</span><span class="op" id="5934304">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934309">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934314">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934371">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934384">switch</span>&nbsp;<span class="ident" id="5934391">dlen</span>&nbsp;<span class="op" id="5934396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934400">case</span>&nbsp;<span class="num" id="5934405">8</span><span class="op" id="5934406">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934411">dst</span><span class="op" id="5934414">[</span><span class="num" id="5934415">4</span><span class="op" id="5934416">]</span>&nbsp;<span class="op" id="5934418">=</span>&nbsp;<span class="ident" id="5934420">dbuf</span><span class="op" id="5934424">[</span><span class="num" id="5934425">6</span><span class="op" id="5934426">]</span><span class="op" id="5934427">&lt;&lt;</span><span class="num" id="5934429">5</span>&nbsp;<span class="op" id="5934431">|</span>&nbsp;<span class="ident" id="5934433">dbuf</span><span class="op" id="5934437">[</span><span class="num" id="5934438">7</span><span class="op" id="5934439">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934444">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934458">case</span>&nbsp;<span class="num" id="5934463">7</span><span class="op" id="5934464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934469">dst</span><span class="op" id="5934472">[</span><span class="num" id="5934473">3</span><span class="op" id="5934474">]</span>&nbsp;<span class="op" id="5934476">=</span>&nbsp;<span class="ident" id="5934478">dbuf</span><span class="op" id="5934482">[</span><span class="num" id="5934483">4</span><span class="op" id="5934484">]</span><span class="op" id="5934485">&lt;&lt;</span><span class="num" id="5934487">7</span>&nbsp;<span class="op" id="5934489">|</span>&nbsp;<span class="ident" id="5934491">dbuf</span><span class="op" id="5934495">[</span><span class="num" id="5934496">5</span><span class="op" id="5934497">]</span><span class="op" id="5934498">&lt;&lt;</span><span class="num" id="5934500">2</span>&nbsp;<span class="op" id="5934502">|</span>&nbsp;<span class="ident" id="5934504">dbuf</span><span class="op" id="5934508">[</span><span class="num" id="5934509">6</span><span class="op" id="5934510">]</span><span class="op" id="5934511">&gt;&gt;</span><span class="num" id="5934513">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934518">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934532">case</span>&nbsp;<span class="num" id="5934537">5</span><span class="op" id="5934538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934543">dst</span><span class="op" id="5934546">[</span><span class="num" id="5934547">2</span><span class="op" id="5934548">]</span>&nbsp;<span class="op" id="5934550">=</span>&nbsp;<span class="ident" id="5934552">dbuf</span><span class="op" id="5934556">[</span><span class="num" id="5934557">3</span><span class="op" id="5934558">]</span><span class="op" id="5934559">&lt;&lt;</span><span class="num" id="5934561">4</span>&nbsp;<span class="op" id="5934563">|</span>&nbsp;<span class="ident" id="5934565">dbuf</span><span class="op" id="5934569">[</span><span class="num" id="5934570">4</span><span class="op" id="5934571">]</span><span class="op" id="5934572">&gt;&gt;</span><span class="num" id="5934574">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934579">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934593">case</span>&nbsp;<span class="num" id="5934598">4</span><span class="op" id="5934599">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934604">dst</span><span class="op" id="5934607">[</span><span class="num" id="5934608">1</span><span class="op" id="5934609">]</span>&nbsp;<span class="op" id="5934611">=</span>&nbsp;<span class="ident" id="5934613">dbuf</span><span class="op" id="5934617">[</span><span class="num" id="5934618">1</span><span class="op" id="5934619">]</span><span class="op" id="5934620">&lt;&lt;</span><span class="num" id="5934622">6</span>&nbsp;<span class="op" id="5934624">|</span>&nbsp;<span class="ident" id="5934626">dbuf</span><span class="op" id="5934630">[</span><span class="num" id="5934631">2</span><span class="op" id="5934632">]</span><span class="op" id="5934633">&lt;&lt;</span><span class="num" id="5934635">1</span>&nbsp;<span class="op" id="5934637">|</span>&nbsp;<span class="ident" id="5934639">dbuf</span><span class="op" id="5934643">[</span><span class="num" id="5934644">3</span><span class="op" id="5934645">]</span><span class="op" id="5934646">&gt;&gt;</span><span class="num" id="5934648">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934653">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934667">case</span>&nbsp;<span class="num" id="5934672">2</span><span class="op" id="5934673">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934678">dst</span><span class="op" id="5934681">[</span><span class="num" id="5934682">0</span><span class="op" id="5934683">]</span>&nbsp;<span class="op" id="5934685">=</span>&nbsp;<span class="ident" id="5934687">dbuf</span><span class="op" id="5934691">[</span><span class="num" id="5934692">0</span><span class="op" id="5934693">]</span><span class="op" id="5934694">&lt;&lt;</span><span class="num" id="5934696">3</span>&nbsp;<span class="op" id="5934698">|</span>&nbsp;<span class="ident" id="5934700">dbuf</span><span class="op" id="5934704">[</span><span class="num" id="5934705">1</span><span class="op" id="5934706">]</span><span class="op" id="5934707">&gt;&gt;</span><span class="num" id="5934709">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934717">dst</span>&nbsp;<span class="op" id="5934721">=</span>&nbsp;<span class="ident" id="5934723">dst</span><span class="op" id="5934726">[</span><span class="num" id="5934727">5</span><span class="op" id="5934728">:</span><span class="op" id="5934729">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934733">switch</span>&nbsp;<span class="ident" id="5934740">dlen</span>&nbsp;<span class="op" id="5934745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934749">case</span>&nbsp;<span class="num" id="5934754">2</span><span class="op" id="5934755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934760">n</span>&nbsp;<span class="op" id="5934762">+=</span>&nbsp;<span class="num" id="5934765">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934769">case</span>&nbsp;<span class="num" id="5934774">4</span><span class="op" id="5934775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934780">n</span>&nbsp;<span class="op" id="5934782">+=</span>&nbsp;<span class="num" id="5934785">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934789">case</span>&nbsp;<span class="num" id="5934794">5</span><span class="op" id="5934795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934800">n</span>&nbsp;<span class="op" id="5934802">+=</span>&nbsp;<span class="num" id="5934805">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934809">case</span>&nbsp;<span class="num" id="5934814">7</span><span class="op" id="5934815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934820">n</span>&nbsp;<span class="op" id="5934822">+=</span>&nbsp;<span class="num" id="5934825">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934829">case</span>&nbsp;<span class="num" id="5934834">8</span><span class="op" id="5934835">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934840">n</span>&nbsp;<span class="op" id="5934842">+=</span>&nbsp;<span class="num" id="5934845">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934855">return</span>&nbsp;<span class="ident" id="5934862">n</span><span class="op" id="5934863">,</span>&nbsp;<span class="ident" id="5934865">end</span><span class="op" id="5934868">,</span>&nbsp;<span class="ident" id="5934870">nil</span><br>
<span class="lineno"></span><span class="op" id="5934874">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="5934877">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="5934942">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="5935011">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5935080">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="5935143">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="5935191">func</span>&nbsp;<span class="op" id="5935196">(</span><span class="ident" id="5935197">enc</span>&nbsp;<span class="op" id="5935201">*</span><span class="ident" id="5935202">Encoding</span><span class="op" id="5935210">)</span>&nbsp;<span class="ident" id="5935212">Decode</span><span class="op" id="5935218">(</span><span class="ident" id="5935219">dst</span><span class="op" id="5935222">,</span>&nbsp;<span class="ident" id="5935224">src</span>&nbsp;<span class="op" id="5935228">[</span><span class="op" id="5935229">]</span><span class="builtintype" id="5935230">byte</span><span class="op" id="5935234">)</span>&nbsp;<span class="op" id="5935236">(</span><span class="ident" id="5935237">n</span>&nbsp;<span class="builtintype" id="5935239">int</span><span class="op" id="5935242">,</span>&nbsp;<span class="ident" id="5935244">err</span>&nbsp;<span class="builtintype" id="5935248">error</span><span class="op" id="5935253">)</span>&nbsp;<span class="op" id="5935255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935258">src</span>&nbsp;<span class="op" id="5935262">=</span>&nbsp;<span class="ident" id="5935264">bytes</span><span class="op" id="5935269">.</span><span class="ident" id="5935270">Map</span><span class="op" id="5935273">(</span><span class="ident" id="5935274">removeNewlinesMapper</span><span class="op" id="5935294">,</span>&nbsp;<span class="ident" id="5935296">src</span><span class="op" id="5935299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935302">n</span><span class="op" id="5935303">,</span>&nbsp;<span class="ident" id="5935305">_</span><span class="op" id="5935306">,</span>&nbsp;<span class="ident" id="5935308">err</span>&nbsp;<span class="op" id="5935312">=</span>&nbsp;<span class="ident" id="5935314">enc</span><span class="op" id="5935317">.</span><span class="ident" id="5935318">decode</span><span class="op" id="5935324">(</span><span class="ident" id="5935325">dst</span><span class="op" id="5935328">,</span>&nbsp;<span class="ident" id="5935330">src</span><span class="op" id="5935333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935336">return</span><br>
<span class="lineno">325</span><span class="op" id="5935343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5935346">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5935416">func</span>&nbsp;<span class="op" id="5935421">(</span><span class="ident" id="5935422">enc</span>&nbsp;<span class="op" id="5935426">*</span><span class="ident" id="5935427">Encoding</span><span class="op" id="5935435">)</span>&nbsp;<span class="ident" id="5935437">DecodeString</span><span class="op" id="5935449">(</span><span class="ident" id="5935450">s</span>&nbsp;<span class="builtintype" id="5935452">string</span><span class="op" id="5935458">)</span>&nbsp;<span class="op" id="5935460">(</span><span class="op" id="5935461">[</span><span class="op" id="5935462">]</span><span class="builtintype" id="5935463">byte</span><span class="op" id="5935467">,</span>&nbsp;<span class="builtintype" id="5935469">error</span><span class="op" id="5935474">)</span>&nbsp;<span class="op" id="5935476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935479">s</span>&nbsp;<span class="op" id="5935481">=</span>&nbsp;<span class="ident" id="5935483">strings</span><span class="op" id="5935490">.</span><span class="ident" id="5935491">Map</span><span class="op" id="5935494">(</span><span class="ident" id="5935495">removeNewlinesMapper</span><span class="op" id="5935515">,</span>&nbsp;<span class="ident" id="5935517">s</span><span class="op" id="5935518">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935521">dbuf</span>&nbsp;<span class="op" id="5935526">:=</span>&nbsp;<span class="builtinfunc" id="5935529">make</span><span class="op" id="5935533">(</span><span class="op" id="5935534">[</span><span class="op" id="5935535">]</span><span class="builtintype" id="5935536">byte</span><span class="op" id="5935540">,</span>&nbsp;<span class="ident" id="5935542">enc</span><span class="op" id="5935545">.</span><span class="ident" id="5935546">DecodedLen</span><span class="op" id="5935556">(</span><span class="builtinfunc" id="5935557">len</span><span class="op" id="5935560">(</span><span class="ident" id="5935561">s</span><span class="op" id="5935562">)</span><span class="op" id="5935563">)</span><span class="op" id="5935564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935567">n</span><span class="op" id="5935568">,</span>&nbsp;<span class="ident" id="5935570">_</span><span class="op" id="5935571">,</span>&nbsp;<span class="ident" id="5935573">err</span>&nbsp;<span class="op" id="5935577">:=</span>&nbsp;<span class="ident" id="5935580">enc</span><span class="op" id="5935583">.</span><span class="ident" id="5935584">decode</span><span class="op" id="5935590">(</span><span class="ident" id="5935591">dbuf</span><span class="op" id="5935595">,</span>&nbsp;<span class="op" id="5935597">[</span><span class="op" id="5935598">]</span><span class="builtintype" id="5935599">byte</span><span class="op" id="5935603">(</span><span class="ident" id="5935604">s</span><span class="op" id="5935605">)</span><span class="op" id="5935606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935609">return</span>&nbsp;<span class="ident" id="5935616">dbuf</span><span class="op" id="5935620">[</span><span class="op" id="5935621">:</span><span class="ident" id="5935622">n</span><span class="op" id="5935623">]</span><span class="op" id="5935624">,</span>&nbsp;<span class="ident" id="5935626">err</span><br>
<span class="lineno"></span><span class="op" id="5935630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5935633">type</span>&nbsp;<span class="ident" id="5935638">decoder</span>&nbsp;<span class="keyword" id="5935646">struct</span>&nbsp;<span class="op" id="5935653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935656">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5935663">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935670">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5935677">*</span><span class="ident" id="5935678">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935688">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5935695">io</span><span class="op" id="5935697">.</span><span class="ident" id="5935698">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935706">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5935713">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5935724">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935747">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5935754">[</span><span class="num" id="5935755">1024</span><span class="op" id="5935759">]</span><span class="builtintype" id="5935760">byte</span>&nbsp;<span class="comment" id="5935765">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935784">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5935791">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935796">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5935803">[</span><span class="op" id="5935804">]</span><span class="builtintype" id="5935805">byte</span>&nbsp;<span class="comment" id="5935810">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935838">outbuf</span>&nbsp;<span class="op" id="5935845">[</span><span class="num" id="5935846">1024</span>&nbsp;<span class="op" id="5935851">/</span>&nbsp;<span class="num" id="5935853">8</span>&nbsp;<span class="op" id="5935855">*</span>&nbsp;<span class="num" id="5935857">5</span><span class="op" id="5935858">]</span><span class="builtintype" id="5935859">byte</span><br>
<span class="lineno"></span><span class="op" id="5935864">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="5935867">func</span>&nbsp;<span class="op" id="5935872">(</span><span class="ident" id="5935873">d</span>&nbsp;<span class="op" id="5935875">*</span><span class="ident" id="5935876">decoder</span><span class="op" id="5935883">)</span>&nbsp;<span class="ident" id="5935885">Read</span><span class="op" id="5935889">(</span><span class="ident" id="5935890">p</span>&nbsp;<span class="op" id="5935892">[</span><span class="op" id="5935893">]</span><span class="builtintype" id="5935894">byte</span><span class="op" id="5935898">)</span>&nbsp;<span class="op" id="5935900">(</span><span class="ident" id="5935901">n</span>&nbsp;<span class="builtintype" id="5935903">int</span><span class="op" id="5935906">,</span>&nbsp;<span class="ident" id="5935908">err</span>&nbsp;<span class="builtintype" id="5935912">error</span><span class="op" id="5935917">)</span>&nbsp;<span class="op" id="5935919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935922">if</span>&nbsp;<span class="ident" id="5935925">d</span><span class="op" id="5935926">.</span><span class="ident" id="5935927">err</span>&nbsp;<span class="op" id="5935931">!=</span>&nbsp;<span class="ident" id="5935934">nil</span>&nbsp;<span class="op" id="5935938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935942">return</span>&nbsp;<span class="num" id="5935949">0</span><span class="op" id="5935950">,</span>&nbsp;<span class="ident" id="5935952">d</span><span class="op" id="5935953">.</span><span class="ident" id="5935954">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5935959">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5935963">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936011">if</span>&nbsp;<span class="builtinfunc" id="5936014">len</span><span class="op" id="5936017">(</span><span class="ident" id="5936018">d</span><span class="op" id="5936019">.</span><span class="ident" id="5936020">out</span><span class="op" id="5936023">)</span>&nbsp;<span class="op" id="5936025">&gt;</span>&nbsp;<span class="num" id="5936027">0</span>&nbsp;<span class="op" id="5936029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936033">n</span>&nbsp;<span class="op" id="5936035">=</span>&nbsp;<span class="builtinfunc" id="5936037">copy</span><span class="op" id="5936041">(</span><span class="ident" id="5936042">p</span><span class="op" id="5936043">,</span>&nbsp;<span class="ident" id="5936045">d</span><span class="op" id="5936046">.</span><span class="ident" id="5936047">out</span><span class="op" id="5936050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936054">d</span><span class="op" id="5936055">.</span><span class="ident" id="5936056">out</span>&nbsp;<span class="op" id="5936060">=</span>&nbsp;<span class="ident" id="5936062">d</span><span class="op" id="5936063">.</span><span class="ident" id="5936064">out</span><span class="op" id="5936067">[</span><span class="ident" id="5936068">n</span><span class="op" id="5936069">:</span><span class="op" id="5936070">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936074">return</span>&nbsp;<span class="ident" id="5936081">n</span><span class="op" id="5936082">,</span>&nbsp;<span class="ident" id="5936084">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5936093">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936111">nn</span>&nbsp;<span class="op" id="5936114">:=</span>&nbsp;<span class="builtinfunc" id="5936117">len</span><span class="op" id="5936120">(</span><span class="ident" id="5936121">p</span><span class="op" id="5936122">)</span>&nbsp;<span class="op" id="5936124">/</span>&nbsp;<span class="num" id="5936126">5</span>&nbsp;<span class="op" id="5936128">*</span>&nbsp;<span class="num" id="5936130">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936133">if</span>&nbsp;<span class="ident" id="5936136">nn</span>&nbsp;<span class="op" id="5936139">&lt;</span>&nbsp;<span class="num" id="5936141">8</span>&nbsp;<span class="op" id="5936143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936147">nn</span>&nbsp;<span class="op" id="5936150">=</span>&nbsp;<span class="num" id="5936152">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936158">if</span>&nbsp;<span class="ident" id="5936161">nn</span>&nbsp;<span class="op" id="5936164">&gt;</span>&nbsp;<span class="builtinfunc" id="5936166">len</span><span class="op" id="5936169">(</span><span class="ident" id="5936170">d</span><span class="op" id="5936171">.</span><span class="ident" id="5936172">buf</span><span class="op" id="5936175">)</span>&nbsp;<span class="op" id="5936177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936181">nn</span>&nbsp;<span class="op" id="5936184">=</span>&nbsp;<span class="builtinfunc" id="5936186">len</span><span class="op" id="5936189">(</span><span class="ident" id="5936190">d</span><span class="op" id="5936191">.</span><span class="ident" id="5936192">buf</span><span class="op" id="5936195">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936201">nn</span><span class="op" id="5936203">,</span>&nbsp;<span class="ident" id="5936205">d</span><span class="op" id="5936206">.</span><span class="ident" id="5936207">err</span>&nbsp;<span class="op" id="5936211">=</span>&nbsp;<span class="ident" id="5936213">io</span><span class="op" id="5936215">.</span><span class="ident" id="5936216">ReadAtLeast</span><span class="op" id="5936227">(</span><span class="ident" id="5936228">d</span><span class="op" id="5936229">.</span><span class="ident" id="5936230">r</span><span class="op" id="5936231">,</span>&nbsp;<span class="ident" id="5936233">d</span><span class="op" id="5936234">.</span><span class="ident" id="5936235">buf</span><span class="op" id="5936238">[</span><span class="ident" id="5936239">d</span><span class="op" id="5936240">.</span><span class="ident" id="5936241">nbuf</span><span class="op" id="5936245">:</span><span class="ident" id="5936246">nn</span><span class="op" id="5936248">]</span><span class="op" id="5936249">,</span>&nbsp;<span class="num" id="5936251">8</span><span class="op" id="5936252">-</span><span class="ident" id="5936253">d</span><span class="op" id="5936254">.</span><span class="ident" id="5936255">nbuf</span><span class="op" id="5936259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936262">d</span><span class="op" id="5936263">.</span><span class="ident" id="5936264">nbuf</span>&nbsp;<span class="op" id="5936269">+=</span>&nbsp;<span class="ident" id="5936272">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936276">if</span>&nbsp;<span class="ident" id="5936279">d</span><span class="op" id="5936280">.</span><span class="ident" id="5936281">nbuf</span>&nbsp;<span class="op" id="5936286">&lt;</span>&nbsp;<span class="num" id="5936288">8</span>&nbsp;<span class="op" id="5936290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936294">return</span>&nbsp;<span class="num" id="5936301">0</span><span class="op" id="5936302">,</span>&nbsp;<span class="ident" id="5936304">d</span><span class="op" id="5936305">.</span><span class="ident" id="5936306">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5936315">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936379">nr</span>&nbsp;<span class="op" id="5936382">:=</span>&nbsp;<span class="ident" id="5936385">d</span><span class="op" id="5936386">.</span><span class="ident" id="5936387">nbuf</span>&nbsp;<span class="op" id="5936392">/</span>&nbsp;<span class="num" id="5936394">8</span>&nbsp;<span class="op" id="5936396">*</span>&nbsp;<span class="num" id="5936398">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936401">nw</span>&nbsp;<span class="op" id="5936404">:=</span>&nbsp;<span class="ident" id="5936407">d</span><span class="op" id="5936408">.</span><span class="ident" id="5936409">nbuf</span>&nbsp;<span class="op" id="5936414">/</span>&nbsp;<span class="num" id="5936416">8</span>&nbsp;<span class="op" id="5936418">*</span>&nbsp;<span class="num" id="5936420">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936423">if</span>&nbsp;<span class="ident" id="5936426">nw</span>&nbsp;<span class="op" id="5936429">&gt;</span>&nbsp;<span class="builtinfunc" id="5936431">len</span><span class="op" id="5936434">(</span><span class="ident" id="5936435">p</span><span class="op" id="5936436">)</span>&nbsp;<span class="op" id="5936438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936442">nw</span><span class="op" id="5936444">,</span>&nbsp;<span class="ident" id="5936446">d</span><span class="op" id="5936447">.</span><span class="ident" id="5936448">end</span><span class="op" id="5936451">,</span>&nbsp;<span class="ident" id="5936453">d</span><span class="op" id="5936454">.</span><span class="ident" id="5936455">err</span>&nbsp;<span class="op" id="5936459">=</span>&nbsp;<span class="ident" id="5936461">d</span><span class="op" id="5936462">.</span><span class="ident" id="5936463">enc</span><span class="op" id="5936466">.</span><span class="ident" id="5936467">decode</span><span class="op" id="5936473">(</span><span class="ident" id="5936474">d</span><span class="op" id="5936475">.</span><span class="ident" id="5936476">outbuf</span><span class="op" id="5936482">[</span><span class="num" id="5936483">0</span><span class="op" id="5936484">:</span><span class="op" id="5936485">]</span><span class="op" id="5936486">,</span>&nbsp;<span class="ident" id="5936488">d</span><span class="op" id="5936489">.</span><span class="ident" id="5936490">buf</span><span class="op" id="5936493">[</span><span class="num" id="5936494">0</span><span class="op" id="5936495">:</span><span class="ident" id="5936496">nr</span><span class="op" id="5936498">]</span><span class="op" id="5936499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936503">d</span><span class="op" id="5936504">.</span><span class="ident" id="5936505">out</span>&nbsp;<span class="op" id="5936509">=</span>&nbsp;<span class="ident" id="5936511">d</span><span class="op" id="5936512">.</span><span class="ident" id="5936513">outbuf</span><span class="op" id="5936519">[</span><span class="num" id="5936520">0</span><span class="op" id="5936521">:</span><span class="ident" id="5936522">nw</span><span class="op" id="5936524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936528">n</span>&nbsp;<span class="op" id="5936530">=</span>&nbsp;<span class="builtinfunc" id="5936532">copy</span><span class="op" id="5936536">(</span><span class="ident" id="5936537">p</span><span class="op" id="5936538">,</span>&nbsp;<span class="ident" id="5936540">d</span><span class="op" id="5936541">.</span><span class="ident" id="5936542">out</span><span class="op" id="5936545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936549">d</span><span class="op" id="5936550">.</span><span class="ident" id="5936551">out</span>&nbsp;<span class="op" id="5936555">=</span>&nbsp;<span class="ident" id="5936557">d</span><span class="op" id="5936558">.</span><span class="ident" id="5936559">out</span><span class="op" id="5936562">[</span><span class="ident" id="5936563">n</span><span class="op" id="5936564">:</span><span class="op" id="5936565">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936568">}</span>&nbsp;<span class="keyword" id="5936570">else</span>&nbsp;<span class="op" id="5936575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936579">n</span><span class="op" id="5936580">,</span>&nbsp;<span class="ident" id="5936582">d</span><span class="op" id="5936583">.</span><span class="ident" id="5936584">end</span><span class="op" id="5936587">,</span>&nbsp;<span class="ident" id="5936589">d</span><span class="op" id="5936590">.</span><span class="ident" id="5936591">err</span>&nbsp;<span class="op" id="5936595">=</span>&nbsp;<span class="ident" id="5936597">d</span><span class="op" id="5936598">.</span><span class="ident" id="5936599">enc</span><span class="op" id="5936602">.</span><span class="ident" id="5936603">decode</span><span class="op" id="5936609">(</span><span class="ident" id="5936610">p</span><span class="op" id="5936611">,</span>&nbsp;<span class="ident" id="5936613">d</span><span class="op" id="5936614">.</span><span class="ident" id="5936615">buf</span><span class="op" id="5936618">[</span><span class="num" id="5936619">0</span><span class="op" id="5936620">:</span><span class="ident" id="5936621">nr</span><span class="op" id="5936623">]</span><span class="op" id="5936624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936630">d</span><span class="op" id="5936631">.</span><span class="ident" id="5936632">nbuf</span>&nbsp;<span class="op" id="5936637">-=</span>&nbsp;<span class="ident" id="5936640">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936644">for</span>&nbsp;<span class="ident" id="5936648">i</span>&nbsp;<span class="op" id="5936650">:=</span>&nbsp;<span class="num" id="5936653">0</span><span class="op" id="5936654">;</span>&nbsp;<span class="ident" id="5936656">i</span>&nbsp;<span class="op" id="5936658">&lt;</span>&nbsp;<span class="ident" id="5936660">d</span><span class="op" id="5936661">.</span><span class="ident" id="5936662">nbuf</span><span class="op" id="5936666">;</span>&nbsp;<span class="ident" id="5936668">i</span><span class="op" id="5936669">++</span>&nbsp;<span class="op" id="5936672">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936676">d</span><span class="op" id="5936677">.</span><span class="ident" id="5936678">buf</span><span class="op" id="5936681">[</span><span class="ident" id="5936682">i</span><span class="op" id="5936683">]</span>&nbsp;<span class="op" id="5936685">=</span>&nbsp;<span class="ident" id="5936687">d</span><span class="op" id="5936688">.</span><span class="ident" id="5936689">buf</span><span class="op" id="5936692">[</span><span class="ident" id="5936693">i</span><span class="op" id="5936694">+</span><span class="ident" id="5936695">nr</span><span class="op" id="5936697">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936704">if</span>&nbsp;<span class="ident" id="5936707">d</span><span class="op" id="5936708">.</span><span class="ident" id="5936709">err</span>&nbsp;<span class="op" id="5936713">==</span>&nbsp;<span class="ident" id="5936716">nil</span>&nbsp;<span class="op" id="5936720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936724">d</span><span class="op" id="5936725">.</span><span class="ident" id="5936726">err</span>&nbsp;<span class="op" id="5936730">=</span>&nbsp;<span class="ident" id="5936732">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936740">return</span>&nbsp;<span class="ident" id="5936747">n</span><span class="op" id="5936748">,</span>&nbsp;<span class="ident" id="5936750">d</span><span class="op" id="5936751">.</span><span class="ident" id="5936752">err</span><br>
<span class="lineno"></span><span class="op" id="5936756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5936759">type</span>&nbsp;<span class="ident" id="5936764">newlineFilteringReader</span>&nbsp;<span class="keyword" id="5936787">struct</span>&nbsp;<span class="op" id="5936794">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936797">wrapped</span>&nbsp;<span class="ident" id="5936805">io</span><span class="op" id="5936807">.</span><span class="ident" id="5936808">Reader</span><br>
<span class="lineno"></span><span class="op" id="5936815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5936818">func</span>&nbsp;<span class="op" id="5936823">(</span><span class="ident" id="5936824">r</span>&nbsp;<span class="op" id="5936826">*</span><span class="ident" id="5936827">newlineFilteringReader</span><span class="op" id="5936849">)</span>&nbsp;<span class="ident" id="5936851">Read</span><span class="op" id="5936855">(</span><span class="ident" id="5936856">p</span>&nbsp;<span class="op" id="5936858">[</span><span class="op" id="5936859">]</span><span class="builtintype" id="5936860">byte</span><span class="op" id="5936864">)</span>&nbsp;<span class="op" id="5936866">(</span><span class="builtintype" id="5936867">int</span><span class="op" id="5936870">,</span>&nbsp;<span class="builtintype" id="5936872">error</span><span class="op" id="5936877">)</span>&nbsp;<span class="op" id="5936879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936882">n</span><span class="op" id="5936883">,</span>&nbsp;<span class="ident" id="5936885">err</span>&nbsp;<span class="op" id="5936889">:=</span>&nbsp;<span class="ident" id="5936892">r</span><span class="op" id="5936893">.</span><span class="ident" id="5936894">wrapped</span><span class="op" id="5936901">.</span><span class="ident" id="5936902">Read</span><span class="op" id="5936906">(</span><span class="ident" id="5936907">p</span><span class="op" id="5936908">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936911">for</span>&nbsp;<span class="ident" id="5936915">n</span>&nbsp;<span class="op" id="5936917">&gt;</span>&nbsp;<span class="num" id="5936919">0</span>&nbsp;<span class="op" id="5936921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936925">offset</span>&nbsp;<span class="op" id="5936932">:=</span>&nbsp;<span class="num" id="5936935">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936939">for</span>&nbsp;<span class="ident" id="5936943">i</span><span class="op" id="5936944">,</span>&nbsp;<span class="ident" id="5936946">b</span>&nbsp;<span class="op" id="5936948">:=</span>&nbsp;<span class="keyword" id="5936951">range</span>&nbsp;<span class="ident" id="5936957">p</span><span class="op" id="5936958">[</span><span class="num" id="5936959">0</span><span class="op" id="5936960">:</span><span class="ident" id="5936961">n</span><span class="op" id="5936962">]</span>&nbsp;<span class="op" id="5936964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936969">if</span>&nbsp;<span class="ident" id="5936972">b</span>&nbsp;<span class="op" id="5936974">!=</span>&nbsp;<span class="string" id="5936977">&#39;\r&#39;</span>&nbsp;<span class="op" id="5936982">&amp;&amp;</span>&nbsp;<span class="ident" id="5936985">b</span>&nbsp;<span class="op" id="5936987">!=</span>&nbsp;<span class="string" id="5936990">&#39;\n&#39;</span>&nbsp;<span class="op" id="5936995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937001">if</span>&nbsp;<span class="ident" id="5937004">i</span>&nbsp;<span class="op" id="5937006">!=</span>&nbsp;<span class="ident" id="5937009">offset</span>&nbsp;<span class="op" id="5937016">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937023">p</span><span class="op" id="5937024">[</span><span class="ident" id="5937025">offset</span><span class="op" id="5937031">]</span>&nbsp;<span class="op" id="5937033">=</span>&nbsp;<span class="ident" id="5937035">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5937041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937047">offset</span><span class="op" id="5937053">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5937059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5937063">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937067">if</span>&nbsp;<span class="ident" id="5937070">offset</span>&nbsp;<span class="op" id="5937077">&gt;</span>&nbsp;<span class="num" id="5937079">0</span>&nbsp;<span class="op" id="5937081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937086">return</span>&nbsp;<span class="ident" id="5937093">offset</span><span class="op" id="5937099">,</span>&nbsp;<span class="ident" id="5937101">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5937107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5937111">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937164">n</span><span class="op" id="5937165">,</span>&nbsp;<span class="ident" id="5937167">err</span>&nbsp;<span class="op" id="5937171">=</span>&nbsp;<span class="ident" id="5937173">r</span><span class="op" id="5937174">.</span><span class="ident" id="5937175">wrapped</span><span class="op" id="5937182">.</span><span class="ident" id="5937183">Read</span><span class="op" id="5937187">(</span><span class="ident" id="5937188">p</span><span class="op" id="5937189">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5937192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937195">return</span>&nbsp;<span class="ident" id="5937202">n</span><span class="op" id="5937203">,</span>&nbsp;<span class="ident" id="5937205">err</span><br>
<span class="lineno"></span><span class="op" id="5937209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5937212">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="5937266">func</span>&nbsp;<span class="ident" id="5937271">NewDecoder</span><span class="op" id="5937281">(</span><span class="ident" id="5937282">enc</span>&nbsp;<span class="op" id="5937286">*</span><span class="ident" id="5937287">Encoding</span><span class="op" id="5937295">,</span>&nbsp;<span class="ident" id="5937297">r</span>&nbsp;<span class="ident" id="5937299">io</span><span class="op" id="5937301">.</span><span class="ident" id="5937302">Reader</span><span class="op" id="5937308">)</span>&nbsp;<span class="ident" id="5937310">io</span><span class="op" id="5937312">.</span><span class="ident" id="5937313">Reader</span>&nbsp;<span class="op" id="5937320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937323">return</span>&nbsp;<span class="op" id="5937330">&amp;</span><span class="ident" id="5937331">decoder</span><span class="op" id="5937338">{</span><span class="ident" id="5937339">enc</span><span class="op" id="5937342">:</span>&nbsp;<span class="ident" id="5937344">enc</span><span class="op" id="5937347">,</span>&nbsp;<span class="ident" id="5937349">r</span><span class="op" id="5937350">:</span>&nbsp;<span class="op" id="5937352">&amp;</span><span class="ident" id="5937353">newlineFilteringReader</span><span class="op" id="5937375">{</span><span class="ident" id="5937376">r</span><span class="op" id="5937377">}</span><span class="op" id="5937378">}</span><br>
<span class="lineno"></span><span class="op" id="5937380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5937383">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="5937453">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5937505">func</span>&nbsp;<span class="op" id="5937510">(</span><span class="ident" id="5937511">enc</span>&nbsp;<span class="op" id="5937515">*</span><span class="ident" id="5937516">Encoding</span><span class="op" id="5937524">)</span>&nbsp;<span class="ident" id="5937526">DecodedLen</span><span class="op" id="5937536">(</span><span class="ident" id="5937537">n</span>&nbsp;<span class="builtintype" id="5937539">int</span><span class="op" id="5937542">)</span>&nbsp;<span class="builtintype" id="5937544">int</span>&nbsp;<span class="op" id="5937548">{</span>&nbsp;<span class="keyword" id="5937550">return</span>&nbsp;<span class="ident" id="5937557">n</span>&nbsp;<span class="op" id="5937559">/</span>&nbsp;<span class="num" id="5937561">8</span>&nbsp;<span class="op" id="5937563">*</span>&nbsp;<span class="num" id="5937565">5</span>&nbsp;<span class="op" id="5937567">}</span>
</div>
</body>
</html>
