<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3354012">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3354068">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3354122">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3354173">package</span>&nbsp;<span class="ident" id="3354181">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3354186">import</span>&nbsp;<span class="op" id="3354193">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3354196">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3354202">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3354213">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3354222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3354225">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3354291">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3354360">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3354374">func</span>&nbsp;<span class="ident" id="3354379">interfaceTable</span><span class="op" id="3354393">(</span><span class="ident" id="3354394">ifindex</span>&nbsp;<span class="builtintype" id="3354402">int</span><span class="op" id="3354405">)</span>&nbsp;<span class="op" id="3354407">(</span><span class="op" id="3354408">[</span><span class="op" id="3354409">]</span><span class="ident" id="3354410">Interface</span><span class="op" id="3354419">,</span>&nbsp;<span class="builtintype" id="3354421">error</span><span class="op" id="3354426">)</span>&nbsp;<span class="op" id="3354428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354431">tab</span><span class="op" id="3354434">,</span>&nbsp;<span class="ident" id="3354436">err</span>&nbsp;<span class="op" id="3354440">:=</span>&nbsp;<span class="ident" id="3354443">syscall</span><span class="op" id="3354450">.</span><span class="ident" id="3354451">NetlinkRIB</span><span class="op" id="3354461">(</span><span class="ident" id="3354462">syscall</span><span class="op" id="3354469">.</span><span class="ident" id="3354470">RTM_GETLINK</span><span class="op" id="3354481">,</span>&nbsp;<span class="ident" id="3354483">syscall</span><span class="op" id="3354490">.</span><span class="ident" id="3354491">AF_UNSPEC</span><span class="op" id="3354500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354503">if</span>&nbsp;<span class="ident" id="3354506">err</span>&nbsp;<span class="op" id="3354510">!=</span>&nbsp;<span class="ident" id="3354513">nil</span>&nbsp;<span class="op" id="3354517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354521">return</span>&nbsp;<span class="ident" id="3354528">nil</span><span class="op" id="3354531">,</span>&nbsp;<span class="ident" id="3354533">os</span><span class="op" id="3354535">.</span><span class="ident" id="3354536">NewSyscallError</span><span class="op" id="3354551">(</span><span class="string" id="3354552">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3354565">,</span>&nbsp;<span class="ident" id="3354567">err</span><span class="op" id="3354570">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354576">msgs</span><span class="op" id="3354580">,</span>&nbsp;<span class="ident" id="3354582">err</span>&nbsp;<span class="op" id="3354586">:=</span>&nbsp;<span class="ident" id="3354589">syscall</span><span class="op" id="3354596">.</span><span class="ident" id="3354597">ParseNetlinkMessage</span><span class="op" id="3354616">(</span><span class="ident" id="3354617">tab</span><span class="op" id="3354620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354623">if</span>&nbsp;<span class="ident" id="3354626">err</span>&nbsp;<span class="op" id="3354630">!=</span>&nbsp;<span class="ident" id="3354633">nil</span>&nbsp;<span class="op" id="3354637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354641">return</span>&nbsp;<span class="ident" id="3354648">nil</span><span class="op" id="3354651">,</span>&nbsp;<span class="ident" id="3354653">os</span><span class="op" id="3354655">.</span><span class="ident" id="3354656">NewSyscallError</span><span class="op" id="3354671">(</span><span class="string" id="3354672">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3354689">,</span>&nbsp;<span class="ident" id="3354691">err</span><span class="op" id="3354694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354697">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354700">var</span>&nbsp;<span class="ident" id="3354704">ift</span>&nbsp;<span class="op" id="3354708">[</span><span class="op" id="3354709">]</span><span class="ident" id="3354710">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3354720">loop</span><span class="op" id="3354724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354727">for</span>&nbsp;<span class="ident" id="3354731">_</span><span class="op" id="3354732">,</span>&nbsp;<span class="ident" id="3354734">m</span>&nbsp;<span class="op" id="3354736">:=</span>&nbsp;<span class="keyword" id="3354739">range</span>&nbsp;<span class="ident" id="3354745">msgs</span>&nbsp;<span class="op" id="3354750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354754">switch</span>&nbsp;<span class="ident" id="3354761">m</span><span class="op" id="3354762">.</span><span class="ident" id="3354763">Header</span><span class="op" id="3354769">.</span><span class="ident" id="3354770">Type</span>&nbsp;<span class="op" id="3354775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354779">case</span>&nbsp;<span class="ident" id="3354784">syscall</span><span class="op" id="3354791">.</span><span class="ident" id="3354792">NLMSG_DONE</span><span class="op" id="3354802">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354807">break</span>&nbsp;<span class="ident" id="3354813">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354820">case</span>&nbsp;<span class="ident" id="3354825">syscall</span><span class="op" id="3354832">.</span><span class="ident" id="3354833">RTM_NEWLINK</span><span class="op" id="3354844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354849">ifim</span>&nbsp;<span class="op" id="3354854">:=</span>&nbsp;<span class="op" id="3354857">(</span><span class="op" id="3354858">*</span><span class="ident" id="3354859">syscall</span><span class="op" id="3354866">.</span><span class="ident" id="3354867">IfInfomsg</span><span class="op" id="3354876">)</span><span class="op" id="3354877">(</span><span class="ident" id="3354878">unsafe</span><span class="op" id="3354884">.</span><span class="ident" id="3354885">Pointer</span><span class="op" id="3354892">(</span><span class="op" id="3354893">&amp;</span><span class="ident" id="3354894">m</span><span class="op" id="3354895">.</span><span class="ident" id="3354896">Data</span><span class="op" id="3354900">[</span><span class="num" id="3354901">0</span><span class="op" id="3354902">]</span><span class="op" id="3354903">)</span><span class="op" id="3354904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354909">if</span>&nbsp;<span class="ident" id="3354912">ifindex</span>&nbsp;<span class="op" id="3354920">==</span>&nbsp;<span class="num" id="3354923">0</span>&nbsp;<span class="op" id="3354925">||</span>&nbsp;<span class="ident" id="3354928">ifindex</span>&nbsp;<span class="op" id="3354936">==</span>&nbsp;<span class="builtintype" id="3354939">int</span><span class="op" id="3354942">(</span><span class="ident" id="3354943">ifim</span><span class="op" id="3354947">.</span><span class="ident" id="3354948">Index</span><span class="op" id="3354953">)</span>&nbsp;<span class="op" id="3354955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354961">attrs</span><span class="op" id="3354966">,</span>&nbsp;<span class="ident" id="3354968">err</span>&nbsp;<span class="op" id="3354972">:=</span>&nbsp;<span class="ident" id="3354975">syscall</span><span class="op" id="3354982">.</span><span class="ident" id="3354983">ParseNetlinkRouteAttr</span><span class="op" id="3355004">(</span><span class="op" id="3355005">&amp;</span><span class="ident" id="3355006">m</span><span class="op" id="3355007">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355013">if</span>&nbsp;<span class="ident" id="3355016">err</span>&nbsp;<span class="op" id="3355020">!=</span>&nbsp;<span class="ident" id="3355023">nil</span>&nbsp;<span class="op" id="3355027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355034">return</span>&nbsp;<span class="ident" id="3355041">nil</span><span class="op" id="3355044">,</span>&nbsp;<span class="ident" id="3355046">os</span><span class="op" id="3355048">.</span><span class="ident" id="3355049">NewSyscallError</span><span class="op" id="3355064">(</span><span class="string" id="3355065">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3355084">,</span>&nbsp;<span class="ident" id="3355086">err</span><span class="op" id="3355089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355101">ift</span>&nbsp;<span class="op" id="3355105">=</span>&nbsp;<span class="builtinfunc" id="3355107">append</span><span class="op" id="3355113">(</span><span class="ident" id="3355114">ift</span><span class="op" id="3355117">,</span>&nbsp;<span class="op" id="3355119">*</span><span class="ident" id="3355120">newLink</span><span class="op" id="3355127">(</span><span class="ident" id="3355128">ifim</span><span class="op" id="3355132">,</span>&nbsp;<span class="ident" id="3355134">attrs</span><span class="op" id="3355139">)</span><span class="op" id="3355140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355146">if</span>&nbsp;<span class="ident" id="3355149">ifindex</span>&nbsp;<span class="op" id="3355157">==</span>&nbsp;<span class="builtintype" id="3355160">int</span><span class="op" id="3355163">(</span><span class="ident" id="3355164">ifim</span><span class="op" id="3355168">.</span><span class="ident" id="3355169">Index</span><span class="op" id="3355174">)</span>&nbsp;<span class="op" id="3355176">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355183">break</span>&nbsp;<span class="ident" id="3355189">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355210">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355213">return</span>&nbsp;<span class="ident" id="3355220">ift</span><span class="op" id="3355223">,</span>&nbsp;<span class="ident" id="3355225">nil</span><br>
<span class="lineno"></span><span class="op" id="3355229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3355232">const</span>&nbsp;<span class="op" id="3355238">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3355241">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3355265">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355327">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3355350">=</span>&nbsp;<span class="num" id="3355352">768</span>&nbsp;<span class="comment" id="3355356">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355385">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3355408">=</span>&nbsp;<span class="num" id="3355410">769</span>&nbsp;<span class="comment" id="3355414">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355443">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3355466">=</span>&nbsp;<span class="num" id="3355468">776</span>&nbsp;<span class="comment" id="3355472">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355501">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3355524">=</span>&nbsp;<span class="num" id="3355526">778</span>&nbsp;<span class="comment" id="3355530">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355567">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3355590">=</span>&nbsp;<span class="num" id="3355592">823</span>&nbsp;<span class="comment" id="3355596">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3355632">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3355635">func</span>&nbsp;<span class="ident" id="3355640">newLink</span><span class="op" id="3355647">(</span><span class="ident" id="3355648">ifim</span>&nbsp;<span class="op" id="3355653">*</span><span class="ident" id="3355654">syscall</span><span class="op" id="3355661">.</span><span class="ident" id="3355662">IfInfomsg</span><span class="op" id="3355671">,</span>&nbsp;<span class="ident" id="3355673">attrs</span>&nbsp;<span class="op" id="3355679">[</span><span class="op" id="3355680">]</span><span class="ident" id="3355681">syscall</span><span class="op" id="3355688">.</span><span class="ident" id="3355689">NetlinkRouteAttr</span><span class="op" id="3355705">)</span>&nbsp;<span class="op" id="3355707">*</span><span class="ident" id="3355708">Interface</span>&nbsp;<span class="op" id="3355718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355721">ifi</span>&nbsp;<span class="op" id="3355725">:=</span>&nbsp;<span class="op" id="3355728">&amp;</span><span class="ident" id="3355729">Interface</span><span class="op" id="3355738">{</span><span class="ident" id="3355739">Index</span><span class="op" id="3355744">:</span>&nbsp;<span class="builtintype" id="3355746">int</span><span class="op" id="3355749">(</span><span class="ident" id="3355750">ifim</span><span class="op" id="3355754">.</span><span class="ident" id="3355755">Index</span><span class="op" id="3355760">)</span><span class="op" id="3355761">,</span>&nbsp;<span class="ident" id="3355763">Flags</span><span class="op" id="3355768">:</span>&nbsp;<span class="ident" id="3355770">linkFlags</span><span class="op" id="3355779">(</span><span class="ident" id="3355780">ifim</span><span class="op" id="3355784">.</span><span class="ident" id="3355785">Flags</span><span class="op" id="3355790">)</span><span class="op" id="3355791">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355794">for</span>&nbsp;<span class="ident" id="3355798">_</span><span class="op" id="3355799">,</span>&nbsp;<span class="ident" id="3355801">a</span>&nbsp;<span class="op" id="3355803">:=</span>&nbsp;<span class="keyword" id="3355806">range</span>&nbsp;<span class="ident" id="3355812">attrs</span>&nbsp;<span class="op" id="3355818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355822">switch</span>&nbsp;<span class="ident" id="3355829">a</span><span class="op" id="3355830">.</span><span class="ident" id="3355831">Attr</span><span class="op" id="3355835">.</span><span class="ident" id="3355836">Type</span>&nbsp;<span class="op" id="3355841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355845">case</span>&nbsp;<span class="ident" id="3355850">syscall</span><span class="op" id="3355857">.</span><span class="ident" id="3355858">IFLA_ADDRESS</span><span class="op" id="3355870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3355875">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3355924">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3355971">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355995">switch</span>&nbsp;<span class="builtinfunc" id="3356002">len</span><span class="op" id="3356005">(</span><span class="ident" id="3356006">a</span><span class="op" id="3356007">.</span><span class="ident" id="3356008">Value</span><span class="op" id="3356013">)</span>&nbsp;<span class="op" id="3356015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356020">case</span>&nbsp;<span class="ident" id="3356025">IPv4len</span><span class="op" id="3356032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356038">switch</span>&nbsp;<span class="ident" id="3356045">ifim</span><span class="op" id="3356049">.</span><span class="ident" id="3356050">Type</span>&nbsp;<span class="op" id="3356055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356061">case</span>&nbsp;<span class="ident" id="3356066">sysARPHardwareIPv4IPv4</span><span class="op" id="3356088">,</span>&nbsp;<span class="ident" id="3356090">sysARPHardwareGREIPv4</span><span class="op" id="3356111">,</span>&nbsp;<span class="ident" id="3356113">sysARPHardwareIPv6IPv4</span><span class="op" id="3356135">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356142">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356160">case</span>&nbsp;<span class="ident" id="3356165">IPv6len</span><span class="op" id="3356172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356178">switch</span>&nbsp;<span class="ident" id="3356185">ifim</span><span class="op" id="3356189">.</span><span class="ident" id="3356190">Type</span>&nbsp;<span class="op" id="3356195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356201">case</span>&nbsp;<span class="ident" id="3356206">sysARPHardwareIPv6IPv6</span><span class="op" id="3356228">,</span>&nbsp;<span class="ident" id="3356230">sysARPHardwareGREIPv6</span><span class="op" id="3356251">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356258">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356281">var</span>&nbsp;<span class="ident" id="3356285">nonzero</span>&nbsp;<span class="builtintype" id="3356293">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356301">for</span>&nbsp;<span class="ident" id="3356305">_</span><span class="op" id="3356306">,</span>&nbsp;<span class="ident" id="3356308">b</span>&nbsp;<span class="op" id="3356310">:=</span>&nbsp;<span class="keyword" id="3356313">range</span>&nbsp;<span class="ident" id="3356319">a</span><span class="op" id="3356320">.</span><span class="ident" id="3356321">Value</span>&nbsp;<span class="op" id="3356327">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356333">if</span>&nbsp;<span class="ident" id="3356336">b</span>&nbsp;<span class="op" id="3356338">!=</span>&nbsp;<span class="num" id="3356341">0</span>&nbsp;<span class="op" id="3356343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356350">nonzero</span>&nbsp;<span class="op" id="3356358">=</span>&nbsp;<span class="ident" id="3356360">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356370">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356385">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356390">if</span>&nbsp;<span class="ident" id="3356393">nonzero</span>&nbsp;<span class="op" id="3356401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356407">ifi</span><span class="op" id="3356410">.</span><span class="ident" id="3356411">HardwareAddr</span>&nbsp;<span class="op" id="3356424">=</span>&nbsp;<span class="ident" id="3356426">a</span><span class="op" id="3356427">.</span><span class="ident" id="3356428">Value</span><span class="op" id="3356433">[</span><span class="op" id="3356434">:</span><span class="op" id="3356435">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356444">case</span>&nbsp;<span class="ident" id="3356449">syscall</span><span class="op" id="3356456">.</span><span class="ident" id="3356457">IFLA_IFNAME</span><span class="op" id="3356468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356473">ifi</span><span class="op" id="3356476">.</span><span class="ident" id="3356477">Name</span>&nbsp;<span class="op" id="3356482">=</span>&nbsp;<span class="builtintype" id="3356484">string</span><span class="op" id="3356490">(</span><span class="ident" id="3356491">a</span><span class="op" id="3356492">.</span><span class="ident" id="3356493">Value</span><span class="op" id="3356498">[</span><span class="op" id="3356499">:</span><span class="builtinfunc" id="3356500">len</span><span class="op" id="3356503">(</span><span class="ident" id="3356504">a</span><span class="op" id="3356505">.</span><span class="ident" id="3356506">Value</span><span class="op" id="3356511">)</span><span class="op" id="3356512">-</span><span class="num" id="3356513">1</span><span class="op" id="3356514">]</span><span class="op" id="3356515">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356519">case</span>&nbsp;<span class="ident" id="3356524">syscall</span><span class="op" id="3356531">.</span><span class="ident" id="3356532">IFLA_MTU</span><span class="op" id="3356540">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356545">ifi</span><span class="op" id="3356548">.</span><span class="ident" id="3356549">MTU</span>&nbsp;<span class="op" id="3356553">=</span>&nbsp;<span class="builtintype" id="3356555">int</span><span class="op" id="3356558">(</span><span class="op" id="3356559">*</span><span class="op" id="3356560">(</span><span class="op" id="3356561">*</span><span class="builtintype" id="3356562">uint32</span><span class="op" id="3356568">)</span><span class="op" id="3356569">(</span><span class="ident" id="3356570">unsafe</span><span class="op" id="3356576">.</span><span class="ident" id="3356577">Pointer</span><span class="op" id="3356584">(</span><span class="op" id="3356585">&amp;</span><span class="ident" id="3356586">a</span><span class="op" id="3356587">.</span><span class="ident" id="3356588">Value</span><span class="op" id="3356593">[</span><span class="op" id="3356594">:</span><span class="num" id="3356595">4</span><span class="op" id="3356596">]</span><span class="op" id="3356597">[</span><span class="num" id="3356598">0</span><span class="op" id="3356599">]</span><span class="op" id="3356600">)</span><span class="op" id="3356601">)</span><span class="op" id="3356602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356612">return</span>&nbsp;<span class="ident" id="3356619">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3356623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3356626">func</span>&nbsp;<span class="ident" id="3356631">linkFlags</span><span class="op" id="3356640">(</span><span class="ident" id="3356641">rawFlags</span>&nbsp;<span class="builtintype" id="3356650">uint32</span><span class="op" id="3356656">)</span>&nbsp;<span class="ident" id="3356658">Flags</span>&nbsp;<span class="op" id="3356664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356667">var</span>&nbsp;<span class="ident" id="3356671">f</span>&nbsp;<span class="ident" id="3356673">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356680">if</span>&nbsp;<span class="ident" id="3356683">rawFlags</span><span class="op" id="3356691">&amp;</span><span class="ident" id="3356692">syscall</span><span class="op" id="3356699">.</span><span class="ident" id="3356700">IFF_UP</span>&nbsp;<span class="op" id="3356707">!=</span>&nbsp;<span class="num" id="3356710">0</span>&nbsp;<span class="op" id="3356712">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356716">f</span>&nbsp;<span class="op" id="3356718">|=</span>&nbsp;<span class="ident" id="3356721">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356732">if</span>&nbsp;<span class="ident" id="3356735">rawFlags</span><span class="op" id="3356743">&amp;</span><span class="ident" id="3356744">syscall</span><span class="op" id="3356751">.</span><span class="ident" id="3356752">IFF_BROADCAST</span>&nbsp;<span class="op" id="3356766">!=</span>&nbsp;<span class="num" id="3356769">0</span>&nbsp;<span class="op" id="3356771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356775">f</span>&nbsp;<span class="op" id="3356777">|=</span>&nbsp;<span class="ident" id="3356780">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356795">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356798">if</span>&nbsp;<span class="ident" id="3356801">rawFlags</span><span class="op" id="3356809">&amp;</span><span class="ident" id="3356810">syscall</span><span class="op" id="3356817">.</span><span class="ident" id="3356818">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3356831">!=</span>&nbsp;<span class="num" id="3356834">0</span>&nbsp;<span class="op" id="3356836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356840">f</span>&nbsp;<span class="op" id="3356842">|=</span>&nbsp;<span class="ident" id="3356845">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356862">if</span>&nbsp;<span class="ident" id="3356865">rawFlags</span><span class="op" id="3356873">&amp;</span><span class="ident" id="3356874">syscall</span><span class="op" id="3356881">.</span><span class="ident" id="3356882">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3356898">!=</span>&nbsp;<span class="num" id="3356901">0</span>&nbsp;<span class="op" id="3356903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356907">f</span>&nbsp;<span class="op" id="3356909">|=</span>&nbsp;<span class="ident" id="3356912">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356933">if</span>&nbsp;<span class="ident" id="3356936">rawFlags</span><span class="op" id="3356944">&amp;</span><span class="ident" id="3356945">syscall</span><span class="op" id="3356952">.</span><span class="ident" id="3356953">IFF_MULTICAST</span>&nbsp;<span class="op" id="3356967">!=</span>&nbsp;<span class="num" id="3356970">0</span>&nbsp;<span class="op" id="3356972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3356976">f</span>&nbsp;<span class="op" id="3356978">|=</span>&nbsp;<span class="ident" id="3356981">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3356996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3356999">return</span>&nbsp;<span class="ident" id="3357006">f</span><br>
<span class="lineno">115</span><span class="op" id="3357008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3357011">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3357078">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3357148">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3357162">func</span>&nbsp;<span class="ident" id="3357167">interfaceAddrTable</span><span class="op" id="3357185">(</span><span class="ident" id="3357186">ifi</span>&nbsp;<span class="op" id="3357190">*</span><span class="ident" id="3357191">Interface</span><span class="op" id="3357200">)</span>&nbsp;<span class="op" id="3357202">(</span><span class="op" id="3357203">[</span><span class="op" id="3357204">]</span><span class="ident" id="3357205">Addr</span><span class="op" id="3357209">,</span>&nbsp;<span class="builtintype" id="3357211">error</span><span class="op" id="3357216">)</span>&nbsp;<span class="op" id="3357218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3357221">tab</span><span class="op" id="3357224">,</span>&nbsp;<span class="ident" id="3357226">err</span>&nbsp;<span class="op" id="3357230">:=</span>&nbsp;<span class="ident" id="3357233">syscall</span><span class="op" id="3357240">.</span><span class="ident" id="3357241">NetlinkRIB</span><span class="op" id="3357251">(</span><span class="ident" id="3357252">syscall</span><span class="op" id="3357259">.</span><span class="ident" id="3357260">RTM_GETADDR</span><span class="op" id="3357271">,</span>&nbsp;<span class="ident" id="3357273">syscall</span><span class="op" id="3357280">.</span><span class="ident" id="3357281">AF_UNSPEC</span><span class="op" id="3357290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357293">if</span>&nbsp;<span class="ident" id="3357296">err</span>&nbsp;<span class="op" id="3357300">!=</span>&nbsp;<span class="ident" id="3357303">nil</span>&nbsp;<span class="op" id="3357307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357311">return</span>&nbsp;<span class="ident" id="3357318">nil</span><span class="op" id="3357321">,</span>&nbsp;<span class="ident" id="3357323">os</span><span class="op" id="3357325">.</span><span class="ident" id="3357326">NewSyscallError</span><span class="op" id="3357341">(</span><span class="string" id="3357342">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3357355">,</span>&nbsp;<span class="ident" id="3357357">err</span><span class="op" id="3357360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3357363">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3357366">msgs</span><span class="op" id="3357370">,</span>&nbsp;<span class="ident" id="3357372">err</span>&nbsp;<span class="op" id="3357376">:=</span>&nbsp;<span class="ident" id="3357379">syscall</span><span class="op" id="3357386">.</span><span class="ident" id="3357387">ParseNetlinkMessage</span><span class="op" id="3357406">(</span><span class="ident" id="3357407">tab</span><span class="op" id="3357410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357413">if</span>&nbsp;<span class="ident" id="3357416">err</span>&nbsp;<span class="op" id="3357420">!=</span>&nbsp;<span class="ident" id="3357423">nil</span>&nbsp;<span class="op" id="3357427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357431">return</span>&nbsp;<span class="ident" id="3357438">nil</span><span class="op" id="3357441">,</span>&nbsp;<span class="ident" id="3357443">os</span><span class="op" id="3357445">.</span><span class="ident" id="3357446">NewSyscallError</span><span class="op" id="3357461">(</span><span class="string" id="3357462">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3357479">,</span>&nbsp;<span class="ident" id="3357481">err</span><span class="op" id="3357484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3357487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357490">var</span>&nbsp;<span class="ident" id="3357494">ift</span>&nbsp;<span class="op" id="3357498">[</span><span class="op" id="3357499">]</span><span class="ident" id="3357500">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357511">if</span>&nbsp;<span class="ident" id="3357514">ifi</span>&nbsp;<span class="op" id="3357518">==</span>&nbsp;<span class="ident" id="3357521">nil</span>&nbsp;<span class="op" id="3357525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357529">var</span>&nbsp;<span class="ident" id="3357533">err</span>&nbsp;<span class="builtintype" id="3357537">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3357545">ift</span><span class="op" id="3357548">,</span>&nbsp;<span class="ident" id="3357550">err</span>&nbsp;<span class="op" id="3357554">=</span>&nbsp;<span class="ident" id="3357556">interfaceTable</span><span class="op" id="3357570">(</span><span class="num" id="3357571">0</span><span class="op" id="3357572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357576">if</span>&nbsp;<span class="ident" id="3357579">err</span>&nbsp;<span class="op" id="3357583">!=</span>&nbsp;<span class="ident" id="3357586">nil</span>&nbsp;<span class="op" id="3357590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357595">return</span>&nbsp;<span class="ident" id="3357602">nil</span><span class="op" id="3357605">,</span>&nbsp;<span class="ident" id="3357607">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3357613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3357616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3357619">ifat</span><span class="op" id="3357623">,</span>&nbsp;<span class="ident" id="3357625">err</span>&nbsp;<span class="op" id="3357629">:=</span>&nbsp;<span class="ident" id="3357632">addrTable</span><span class="op" id="3357641">(</span><span class="ident" id="3357642">ift</span><span class="op" id="3357645">,</span>&nbsp;<span class="ident" id="3357647">ifi</span><span class="op" id="3357650">,</span>&nbsp;<span class="ident" id="3357652">msgs</span><span class="op" id="3357656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357659">if</span>&nbsp;<span class="ident" id="3357662">err</span>&nbsp;<span class="op" id="3357666">!=</span>&nbsp;<span class="ident" id="3357669">nil</span>&nbsp;<span class="op" id="3357673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357677">return</span>&nbsp;<span class="ident" id="3357684">nil</span><span class="op" id="3357687">,</span>&nbsp;<span class="ident" id="3357689">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3357694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357697">return</span>&nbsp;<span class="ident" id="3357704">ifat</span><span class="op" id="3357708">,</span>&nbsp;<span class="ident" id="3357710">nil</span><br>
<span class="lineno"></span><span class="op" id="3357714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3357717">func</span>&nbsp;<span class="ident" id="3357722">addrTable</span><span class="op" id="3357731">(</span><span class="ident" id="3357732">ift</span>&nbsp;<span class="op" id="3357736">[</span><span class="op" id="3357737">]</span><span class="ident" id="3357738">Interface</span><span class="op" id="3357747">,</span>&nbsp;<span class="ident" id="3357749">ifi</span>&nbsp;<span class="op" id="3357753">*</span><span class="ident" id="3357754">Interface</span><span class="op" id="3357763">,</span>&nbsp;<span class="ident" id="3357765">msgs</span>&nbsp;<span class="op" id="3357770">[</span><span class="op" id="3357771">]</span><span class="ident" id="3357772">syscall</span><span class="op" id="3357779">.</span><span class="ident" id="3357780">NetlinkMessage</span><span class="op" id="3357794">)</span>&nbsp;<span class="op" id="3357796">(</span><span class="op" id="3357797">[</span><span class="op" id="3357798">]</span><span class="ident" id="3357799">Addr</span><span class="op" id="3357803">,</span>&nbsp;<span class="builtintype" id="3357805">error</span><span class="op" id="3357810">)</span>&nbsp;<span class="op" id="3357812">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357815">var</span>&nbsp;<span class="ident" id="3357819">ifat</span>&nbsp;<span class="op" id="3357824">[</span><span class="op" id="3357825">]</span><span class="ident" id="3357826">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3357831">loop</span><span class="op" id="3357835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357838">for</span>&nbsp;<span class="ident" id="3357842">_</span><span class="op" id="3357843">,</span>&nbsp;<span class="ident" id="3357845">m</span>&nbsp;<span class="op" id="3357847">:=</span>&nbsp;<span class="keyword" id="3357850">range</span>&nbsp;<span class="ident" id="3357856">msgs</span>&nbsp;<span class="op" id="3357861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357865">switch</span>&nbsp;<span class="ident" id="3357872">m</span><span class="op" id="3357873">.</span><span class="ident" id="3357874">Header</span><span class="op" id="3357880">.</span><span class="ident" id="3357881">Type</span>&nbsp;<span class="op" id="3357886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357890">case</span>&nbsp;<span class="ident" id="3357895">syscall</span><span class="op" id="3357902">.</span><span class="ident" id="3357903">NLMSG_DONE</span><span class="op" id="3357913">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357918">break</span>&nbsp;<span class="ident" id="3357924">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3357931">case</span>&nbsp;<span class="ident" id="3357936">syscall</span><span class="op" id="3357943">.</span><span class="ident" id="3357944">RTM_NEWADDR</span><span class="op" id="3357955">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3357960">ifam</span>&nbsp;<span class="op" id="3357965">:=</span>&nbsp;<span class="op" id="3357968">(</span><span class="op" id="3357969">*</span><span class="ident" id="3357970">syscall</span><span class="op" id="3357977">.</span><span class="ident" id="3357978">IfAddrmsg</span><span class="op" id="3357987">)</span><span class="op" id="3357988">(</span><span class="ident" id="3357989">unsafe</span><span class="op" id="3357995">.</span><span class="ident" id="3357996">Pointer</span><span class="op" id="3358003">(</span><span class="op" id="3358004">&amp;</span><span class="ident" id="3358005">m</span><span class="op" id="3358006">.</span><span class="ident" id="3358007">Data</span><span class="op" id="3358011">[</span><span class="num" id="3358012">0</span><span class="op" id="3358013">]</span><span class="op" id="3358014">)</span><span class="op" id="3358015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358020">if</span>&nbsp;<span class="builtinfunc" id="3358023">len</span><span class="op" id="3358026">(</span><span class="ident" id="3358027">ift</span><span class="op" id="3358030">)</span>&nbsp;<span class="op" id="3358032">!=</span>&nbsp;<span class="num" id="3358035">0</span>&nbsp;<span class="op" id="3358037">||</span>&nbsp;<span class="ident" id="3358040">ifi</span><span class="op" id="3358043">.</span><span class="ident" id="3358044">Index</span>&nbsp;<span class="op" id="3358050">==</span>&nbsp;<span class="builtintype" id="3358053">int</span><span class="op" id="3358056">(</span><span class="ident" id="3358057">ifam</span><span class="op" id="3358061">.</span><span class="ident" id="3358062">Index</span><span class="op" id="3358067">)</span>&nbsp;<span class="op" id="3358069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358075">if</span>&nbsp;<span class="builtinfunc" id="3358078">len</span><span class="op" id="3358081">(</span><span class="ident" id="3358082">ift</span><span class="op" id="3358085">)</span>&nbsp;<span class="op" id="3358087">!=</span>&nbsp;<span class="num" id="3358090">0</span>&nbsp;<span class="op" id="3358092">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358099">var</span>&nbsp;<span class="ident" id="3358103">err</span>&nbsp;<span class="builtintype" id="3358107">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3358118">ifi</span><span class="op" id="3358121">,</span>&nbsp;<span class="ident" id="3358123">err</span>&nbsp;<span class="op" id="3358127">=</span>&nbsp;<span class="ident" id="3358129">interfaceByIndex</span><span class="op" id="3358145">(</span><span class="ident" id="3358146">ift</span><span class="op" id="3358149">,</span>&nbsp;<span class="builtintype" id="3358151">int</span><span class="op" id="3358154">(</span><span class="ident" id="3358155">ifam</span><span class="op" id="3358159">.</span><span class="ident" id="3358160">Index</span><span class="op" id="3358165">)</span><span class="op" id="3358166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358173">if</span>&nbsp;<span class="ident" id="3358176">err</span>&nbsp;<span class="op" id="3358180">!=</span>&nbsp;<span class="ident" id="3358183">nil</span>&nbsp;<span class="op" id="3358187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358195">return</span>&nbsp;<span class="ident" id="3358202">nil</span><span class="op" id="3358205">,</span>&nbsp;<span class="ident" id="3358207">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358216">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3358228">attrs</span><span class="op" id="3358233">,</span>&nbsp;<span class="ident" id="3358235">err</span>&nbsp;<span class="op" id="3358239">:=</span>&nbsp;<span class="ident" id="3358242">syscall</span><span class="op" id="3358249">.</span><span class="ident" id="3358250">ParseNetlinkRouteAttr</span><span class="op" id="3358271">(</span><span class="op" id="3358272">&amp;</span><span class="ident" id="3358273">m</span><span class="op" id="3358274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358280">if</span>&nbsp;<span class="ident" id="3358283">err</span>&nbsp;<span class="op" id="3358287">!=</span>&nbsp;<span class="ident" id="3358290">nil</span>&nbsp;<span class="op" id="3358294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358301">return</span>&nbsp;<span class="ident" id="3358308">nil</span><span class="op" id="3358311">,</span>&nbsp;<span class="ident" id="3358313">os</span><span class="op" id="3358315">.</span><span class="ident" id="3358316">NewSyscallError</span><span class="op" id="3358331">(</span><span class="string" id="3358332">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3358351">,</span>&nbsp;<span class="ident" id="3358353">err</span><span class="op" id="3358356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358362">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3358368">ifa</span>&nbsp;<span class="op" id="3358372">:=</span>&nbsp;<span class="ident" id="3358375">newAddr</span><span class="op" id="3358382">(</span><span class="ident" id="3358383">ifi</span><span class="op" id="3358386">,</span>&nbsp;<span class="ident" id="3358388">ifam</span><span class="op" id="3358392">,</span>&nbsp;<span class="ident" id="3358394">attrs</span><span class="op" id="3358399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358405">if</span>&nbsp;<span class="ident" id="3358408">ifa</span>&nbsp;<span class="op" id="3358412">!=</span>&nbsp;<span class="ident" id="3358415">nil</span>&nbsp;<span class="op" id="3358419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3358426">ifat</span>&nbsp;<span class="op" id="3358431">=</span>&nbsp;<span class="builtinfunc" id="3358433">append</span><span class="op" id="3358439">(</span><span class="ident" id="3358440">ifat</span><span class="op" id="3358444">,</span>&nbsp;<span class="ident" id="3358446">ifa</span><span class="op" id="3358449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358460">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358470">return</span>&nbsp;<span class="ident" id="3358477">ifat</span><span class="op" id="3358481">,</span>&nbsp;<span class="ident" id="3358483">nil</span><br>
<span class="lineno"></span><span class="op" id="3358487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3358490">func</span>&nbsp;<span class="ident" id="3358495">newAddr</span><span class="op" id="3358502">(</span><span class="ident" id="3358503">ifi</span>&nbsp;<span class="op" id="3358507">*</span><span class="ident" id="3358508">Interface</span><span class="op" id="3358517">,</span>&nbsp;<span class="ident" id="3358519">ifam</span>&nbsp;<span class="op" id="3358524">*</span><span class="ident" id="3358525">syscall</span><span class="op" id="3358532">.</span><span class="ident" id="3358533">IfAddrmsg</span><span class="op" id="3358542">,</span>&nbsp;<span class="ident" id="3358544">attrs</span>&nbsp;<span class="op" id="3358550">[</span><span class="op" id="3358551">]</span><span class="ident" id="3358552">syscall</span><span class="op" id="3358559">.</span><span class="ident" id="3358560">NetlinkRouteAttr</span><span class="op" id="3358576">)</span>&nbsp;<span class="ident" id="3358578">Addr</span>&nbsp;<span class="op" id="3358583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358586">var</span>&nbsp;<span class="ident" id="3358590">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3358605">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3358611">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3358672">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3358735">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358790">if</span>&nbsp;<span class="ident" id="3358793">ifi</span><span class="op" id="3358796">.</span><span class="ident" id="3358797">Flags</span><span class="op" id="3358802">&amp;</span><span class="ident" id="3358803">FlagPointToPoint</span>&nbsp;<span class="op" id="3358820">!=</span>&nbsp;<span class="num" id="3358823">0</span>&nbsp;<span class="op" id="3358825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358829">for</span>&nbsp;<span class="ident" id="3358833">_</span><span class="op" id="3358834">,</span>&nbsp;<span class="ident" id="3358836">a</span>&nbsp;<span class="op" id="3358838">:=</span>&nbsp;<span class="keyword" id="3358841">range</span>&nbsp;<span class="ident" id="3358847">attrs</span>&nbsp;<span class="op" id="3358853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358858">if</span>&nbsp;<span class="ident" id="3358861">a</span><span class="op" id="3358862">.</span><span class="ident" id="3358863">Attr</span><span class="op" id="3358867">.</span><span class="ident" id="3358868">Type</span>&nbsp;<span class="op" id="3358873">==</span>&nbsp;<span class="ident" id="3358876">syscall</span><span class="op" id="3358883">.</span><span class="ident" id="3358884">IFA_LOCAL</span>&nbsp;<span class="op" id="3358894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3358900">ipPointToPoint</span>&nbsp;<span class="op" id="3358915">=</span>&nbsp;<span class="ident" id="3358917">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358926">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3358942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358945">for</span>&nbsp;<span class="ident" id="3358949">_</span><span class="op" id="3358950">,</span>&nbsp;<span class="ident" id="3358952">a</span>&nbsp;<span class="op" id="3358954">:=</span>&nbsp;<span class="keyword" id="3358957">range</span>&nbsp;<span class="ident" id="3358963">attrs</span>&nbsp;<span class="op" id="3358969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3358973">if</span>&nbsp;<span class="ident" id="3358976">ipPointToPoint</span>&nbsp;<span class="op" id="3358991">&amp;&amp;</span>&nbsp;<span class="ident" id="3358994">a</span><span class="op" id="3358995">.</span><span class="ident" id="3358996">Attr</span><span class="op" id="3359000">.</span><span class="ident" id="3359001">Type</span>&nbsp;<span class="op" id="3359006">==</span>&nbsp;<span class="ident" id="3359009">syscall</span><span class="op" id="3359016">.</span><span class="ident" id="3359017">IFA_ADDRESS</span>&nbsp;<span class="op" id="3359029">||</span>&nbsp;<span class="op" id="3359032">!</span><span class="ident" id="3359033">ipPointToPoint</span>&nbsp;<span class="op" id="3359048">&amp;&amp;</span>&nbsp;<span class="ident" id="3359051">a</span><span class="op" id="3359052">.</span><span class="ident" id="3359053">Attr</span><span class="op" id="3359057">.</span><span class="ident" id="3359058">Type</span>&nbsp;<span class="op" id="3359063">==</span>&nbsp;<span class="ident" id="3359066">syscall</span><span class="op" id="3359073">.</span><span class="ident" id="3359074">IFA_LOCAL</span>&nbsp;<span class="op" id="3359084">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359089">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3359100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359104">switch</span>&nbsp;<span class="ident" id="3359111">ifam</span><span class="op" id="3359115">.</span><span class="ident" id="3359116">Family</span>&nbsp;<span class="op" id="3359123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359127">case</span>&nbsp;<span class="ident" id="3359132">syscall</span><span class="op" id="3359139">.</span><span class="ident" id="3359140">AF_INET</span><span class="op" id="3359147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359152">return</span>&nbsp;<span class="op" id="3359159">&amp;</span><span class="ident" id="3359160">IPNet</span><span class="op" id="3359165">{</span><span class="ident" id="3359166">IP</span><span class="op" id="3359168">:</span>&nbsp;<span class="ident" id="3359170">IPv4</span><span class="op" id="3359174">(</span><span class="ident" id="3359175">a</span><span class="op" id="3359176">.</span><span class="ident" id="3359177">Value</span><span class="op" id="3359182">[</span><span class="num" id="3359183">0</span><span class="op" id="3359184">]</span><span class="op" id="3359185">,</span>&nbsp;<span class="ident" id="3359187">a</span><span class="op" id="3359188">.</span><span class="ident" id="3359189">Value</span><span class="op" id="3359194">[</span><span class="num" id="3359195">1</span><span class="op" id="3359196">]</span><span class="op" id="3359197">,</span>&nbsp;<span class="ident" id="3359199">a</span><span class="op" id="3359200">.</span><span class="ident" id="3359201">Value</span><span class="op" id="3359206">[</span><span class="num" id="3359207">2</span><span class="op" id="3359208">]</span><span class="op" id="3359209">,</span>&nbsp;<span class="ident" id="3359211">a</span><span class="op" id="3359212">.</span><span class="ident" id="3359213">Value</span><span class="op" id="3359218">[</span><span class="num" id="3359219">3</span><span class="op" id="3359220">]</span><span class="op" id="3359221">)</span><span class="op" id="3359222">,</span>&nbsp;<span class="ident" id="3359224">Mask</span><span class="op" id="3359228">:</span>&nbsp;<span class="ident" id="3359230">CIDRMask</span><span class="op" id="3359238">(</span><span class="builtintype" id="3359239">int</span><span class="op" id="3359242">(</span><span class="ident" id="3359243">ifam</span><span class="op" id="3359247">.</span><span class="ident" id="3359248">Prefixlen</span><span class="op" id="3359257">)</span><span class="op" id="3359258">,</span>&nbsp;<span class="num" id="3359260">8</span><span class="op" id="3359261">*</span><span class="ident" id="3359262">IPv4len</span><span class="op" id="3359269">)</span><span class="op" id="3359270">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359274">case</span>&nbsp;<span class="ident" id="3359279">syscall</span><span class="op" id="3359286">.</span><span class="ident" id="3359287">AF_INET6</span><span class="op" id="3359295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3359300">ifa</span>&nbsp;<span class="op" id="3359304">:=</span>&nbsp;<span class="op" id="3359307">&amp;</span><span class="ident" id="3359308">IPNet</span><span class="op" id="3359313">{</span><span class="ident" id="3359314">IP</span><span class="op" id="3359316">:</span>&nbsp;<span class="builtinfunc" id="3359318">make</span><span class="op" id="3359322">(</span><span class="ident" id="3359323">IP</span><span class="op" id="3359325">,</span>&nbsp;<span class="ident" id="3359327">IPv6len</span><span class="op" id="3359334">)</span><span class="op" id="3359335">,</span>&nbsp;<span class="ident" id="3359337">Mask</span><span class="op" id="3359341">:</span>&nbsp;<span class="ident" id="3359343">CIDRMask</span><span class="op" id="3359351">(</span><span class="builtintype" id="3359352">int</span><span class="op" id="3359355">(</span><span class="ident" id="3359356">ifam</span><span class="op" id="3359360">.</span><span class="ident" id="3359361">Prefixlen</span><span class="op" id="3359370">)</span><span class="op" id="3359371">,</span>&nbsp;<span class="num" id="3359373">8</span><span class="op" id="3359374">*</span><span class="ident" id="3359375">IPv6len</span><span class="op" id="3359382">)</span><span class="op" id="3359383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3359388">copy</span><span class="op" id="3359392">(</span><span class="ident" id="3359393">ifa</span><span class="op" id="3359396">.</span><span class="ident" id="3359397">IP</span><span class="op" id="3359399">,</span>&nbsp;<span class="ident" id="3359401">a</span><span class="op" id="3359402">.</span><span class="ident" id="3359403">Value</span><span class="op" id="3359408">[</span><span class="op" id="3359409">:</span><span class="op" id="3359410">]</span><span class="op" id="3359411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359416">return</span>&nbsp;<span class="ident" id="3359423">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3359429">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3359432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359435">return</span>&nbsp;<span class="ident" id="3359442">nil</span><br>
<span class="lineno"></span><span class="op" id="3359446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3359449">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3359513">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3359527">func</span>&nbsp;<span class="ident" id="3359532">interfaceMulticastAddrTable</span><span class="op" id="3359559">(</span><span class="ident" id="3359560">ifi</span>&nbsp;<span class="op" id="3359564">*</span><span class="ident" id="3359565">Interface</span><span class="op" id="3359574">)</span>&nbsp;<span class="op" id="3359576">(</span><span class="op" id="3359577">[</span><span class="op" id="3359578">]</span><span class="ident" id="3359579">Addr</span><span class="op" id="3359583">,</span>&nbsp;<span class="builtintype" id="3359585">error</span><span class="op" id="3359590">)</span>&nbsp;<span class="op" id="3359592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3359595">ifmat4</span>&nbsp;<span class="op" id="3359602">:=</span>&nbsp;<span class="ident" id="3359605">parseProcNetIGMP</span><span class="op" id="3359621">(</span><span class="string" id="3359622">&#34;/proc/net/igmp&#34;</span><span class="op" id="3359638">,</span>&nbsp;<span class="ident" id="3359640">ifi</span><span class="op" id="3359643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3359646">ifmat6</span>&nbsp;<span class="op" id="3359653">:=</span>&nbsp;<span class="ident" id="3359656">parseProcNetIGMP6</span><span class="op" id="3359673">(</span><span class="string" id="3359674">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3359691">,</span>&nbsp;<span class="ident" id="3359693">ifi</span><span class="op" id="3359696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359699">return</span>&nbsp;<span class="builtinfunc" id="3359706">append</span><span class="op" id="3359712">(</span><span class="ident" id="3359713">ifmat4</span><span class="op" id="3359719">,</span>&nbsp;<span class="ident" id="3359721">ifmat6</span><span class="op" id="3359727">...</span><span class="op" id="3359730">)</span><span class="op" id="3359731">,</span>&nbsp;<span class="ident" id="3359733">nil</span><br>
<span class="lineno">210</span><span class="op" id="3359737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3359740">func</span>&nbsp;<span class="ident" id="3359745">parseProcNetIGMP</span><span class="op" id="3359761">(</span><span class="ident" id="3359762">path</span>&nbsp;<span class="builtintype" id="3359767">string</span><span class="op" id="3359773">,</span>&nbsp;<span class="ident" id="3359775">ifi</span>&nbsp;<span class="op" id="3359779">*</span><span class="ident" id="3359780">Interface</span><span class="op" id="3359789">)</span>&nbsp;<span class="op" id="3359791">[</span><span class="op" id="3359792">]</span><span class="ident" id="3359793">Addr</span>&nbsp;<span class="op" id="3359798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3359801">fd</span><span class="op" id="3359803">,</span>&nbsp;<span class="ident" id="3359805">err</span>&nbsp;<span class="op" id="3359809">:=</span>&nbsp;<span class="ident" id="3359812">open</span><span class="op" id="3359816">(</span><span class="ident" id="3359817">path</span><span class="op" id="3359821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359824">if</span>&nbsp;<span class="ident" id="3359827">err</span>&nbsp;<span class="op" id="3359831">!=</span>&nbsp;<span class="ident" id="3359834">nil</span>&nbsp;<span class="op" id="3359838">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359842">return</span>&nbsp;<span class="ident" id="3359849">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3359854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359857">defer</span>&nbsp;<span class="ident" id="3359863">fd</span><span class="op" id="3359865">.</span><span class="builtinfunc" id="3359866">close</span><span class="op" id="3359871">(</span><span class="op" id="3359872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359875">var</span>&nbsp;<span class="op" id="3359879">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3359883">ifmat</span>&nbsp;<span class="op" id="3359889">[</span><span class="op" id="3359890">]</span><span class="ident" id="3359891">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3359898">name</span>&nbsp;&nbsp;<span class="builtintype" id="3359904">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3359912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3359915">fd</span><span class="op" id="3359917">.</span><span class="ident" id="3359918">readLine</span><span class="op" id="3359926">(</span><span class="op" id="3359927">)</span>&nbsp;<span class="comment" id="3359929">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3359949">b</span>&nbsp;<span class="op" id="3359951">:=</span>&nbsp;<span class="builtinfunc" id="3359954">make</span><span class="op" id="3359958">(</span><span class="op" id="3359959">[</span><span class="op" id="3359960">]</span><span class="builtintype" id="3359961">byte</span><span class="op" id="3359965">,</span>&nbsp;<span class="ident" id="3359967">IPv4len</span><span class="op" id="3359974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3359977">for</span>&nbsp;<span class="ident" id="3359981">l</span><span class="op" id="3359982">,</span>&nbsp;<span class="ident" id="3359984">ok</span>&nbsp;<span class="op" id="3359987">:=</span>&nbsp;<span class="ident" id="3359990">fd</span><span class="op" id="3359992">.</span><span class="ident" id="3359993">readLine</span><span class="op" id="3360001">(</span><span class="op" id="3360002">)</span><span class="op" id="3360003">;</span>&nbsp;<span class="ident" id="3360005">ok</span><span class="op" id="3360007">;</span>&nbsp;<span class="ident" id="3360009">l</span><span class="op" id="3360010">,</span>&nbsp;<span class="ident" id="3360012">ok</span>&nbsp;<span class="op" id="3360015">=</span>&nbsp;<span class="ident" id="3360017">fd</span><span class="op" id="3360019">.</span><span class="ident" id="3360020">readLine</span><span class="op" id="3360028">(</span><span class="op" id="3360029">)</span>&nbsp;<span class="op" id="3360031">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360035">f</span>&nbsp;<span class="op" id="3360037">:=</span>&nbsp;<span class="ident" id="3360040">splitAtBytes</span><span class="op" id="3360052">(</span><span class="ident" id="3360053">l</span><span class="op" id="3360054">,</span>&nbsp;<span class="string" id="3360056">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3360066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360070">if</span>&nbsp;<span class="builtinfunc" id="3360073">len</span><span class="op" id="3360076">(</span><span class="ident" id="3360077">f</span><span class="op" id="3360078">)</span>&nbsp;<span class="op" id="3360080">&lt;</span>&nbsp;<span class="num" id="3360082">4</span>&nbsp;<span class="op" id="3360084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360089">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3360100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360104">switch</span>&nbsp;<span class="op" id="3360111">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360115">case</span>&nbsp;<span class="ident" id="3360120">l</span><span class="op" id="3360121">[</span><span class="num" id="3360122">0</span><span class="op" id="3360123">]</span>&nbsp;<span class="op" id="3360125">!=</span>&nbsp;<span class="string" id="3360128">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3360132">&amp;&amp;</span>&nbsp;<span class="ident" id="3360135">l</span><span class="op" id="3360136">[</span><span class="num" id="3360137">0</span><span class="op" id="3360138">]</span>&nbsp;<span class="op" id="3360140">!=</span>&nbsp;<span class="string" id="3360143">&#39;\t&#39;</span><span class="op" id="3360147">:</span>&nbsp;<span class="comment" id="3360149">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360174">name</span>&nbsp;<span class="op" id="3360179">=</span>&nbsp;<span class="ident" id="3360181">f</span><span class="op" id="3360182">[</span><span class="num" id="3360183">1</span><span class="op" id="3360184">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360188">case</span>&nbsp;<span class="builtinfunc" id="3360193">len</span><span class="op" id="3360196">(</span><span class="ident" id="3360197">f</span><span class="op" id="3360198">[</span><span class="num" id="3360199">0</span><span class="op" id="3360200">]</span><span class="op" id="3360201">)</span>&nbsp;<span class="op" id="3360203">==</span>&nbsp;<span class="num" id="3360206">8</span><span class="op" id="3360207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360212">if</span>&nbsp;<span class="ident" id="3360215">ifi</span>&nbsp;<span class="op" id="3360219">==</span>&nbsp;<span class="ident" id="3360222">nil</span>&nbsp;<span class="op" id="3360226">||</span>&nbsp;<span class="ident" id="3360229">name</span>&nbsp;<span class="op" id="3360234">==</span>&nbsp;<span class="ident" id="3360237">ifi</span><span class="op" id="3360240">.</span><span class="ident" id="3360241">Name</span>&nbsp;<span class="op" id="3360246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3360252">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3360288">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3360331">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360350">for</span>&nbsp;<span class="ident" id="3360354">i</span>&nbsp;<span class="op" id="3360356">:=</span>&nbsp;<span class="num" id="3360359">0</span><span class="op" id="3360360">;</span>&nbsp;<span class="ident" id="3360362">i</span><span class="op" id="3360363">+</span><span class="num" id="3360364">1</span>&nbsp;<span class="op" id="3360366">&lt;</span>&nbsp;<span class="builtinfunc" id="3360368">len</span><span class="op" id="3360371">(</span><span class="ident" id="3360372">f</span><span class="op" id="3360373">[</span><span class="num" id="3360374">0</span><span class="op" id="3360375">]</span><span class="op" id="3360376">)</span><span class="op" id="3360377">;</span>&nbsp;<span class="ident" id="3360379">i</span>&nbsp;<span class="op" id="3360381">+=</span>&nbsp;<span class="num" id="3360384">2</span>&nbsp;<span class="op" id="3360386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360393">b</span><span class="op" id="3360394">[</span><span class="ident" id="3360395">i</span><span class="op" id="3360396">/</span><span class="num" id="3360397">2</span><span class="op" id="3360398">]</span><span class="op" id="3360399">,</span>&nbsp;<span class="ident" id="3360401">_</span>&nbsp;<span class="op" id="3360403">=</span>&nbsp;<span class="ident" id="3360405">xtoi2</span><span class="op" id="3360410">(</span><span class="ident" id="3360411">f</span><span class="op" id="3360412">[</span><span class="num" id="3360413">0</span><span class="op" id="3360414">]</span><span class="op" id="3360415">[</span><span class="ident" id="3360416">i</span><span class="op" id="3360417">:</span><span class="ident" id="3360418">i</span><span class="op" id="3360419">+</span><span class="num" id="3360420">2</span><span class="op" id="3360421">]</span><span class="op" id="3360422">,</span>&nbsp;<span class="num" id="3360424">0</span><span class="op" id="3360425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3360431">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360437">i</span>&nbsp;<span class="op" id="3360439">:=</span>&nbsp;<span class="op" id="3360442">*</span><span class="op" id="3360443">(</span><span class="op" id="3360444">*</span><span class="builtintype" id="3360445">uint32</span><span class="op" id="3360451">)</span><span class="op" id="3360452">(</span><span class="ident" id="3360453">unsafe</span><span class="op" id="3360459">.</span><span class="ident" id="3360460">Pointer</span><span class="op" id="3360467">(</span><span class="op" id="3360468">&amp;</span><span class="ident" id="3360469">b</span><span class="op" id="3360470">[</span><span class="op" id="3360471">:</span><span class="num" id="3360472">4</span><span class="op" id="3360473">]</span><span class="op" id="3360474">[</span><span class="num" id="3360475">0</span><span class="op" id="3360476">]</span><span class="op" id="3360477">)</span><span class="op" id="3360478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360484">ifma</span>&nbsp;<span class="op" id="3360489">:=</span>&nbsp;<span class="ident" id="3360492">IPAddr</span><span class="op" id="3360498">{</span><span class="ident" id="3360499">IP</span><span class="op" id="3360501">:</span>&nbsp;<span class="ident" id="3360503">IPv4</span><span class="op" id="3360507">(</span><span class="builtintype" id="3360508">byte</span><span class="op" id="3360512">(</span><span class="ident" id="3360513">i</span><span class="op" id="3360514">&gt;&gt;</span><span class="num" id="3360516">24</span><span class="op" id="3360518">)</span><span class="op" id="3360519">,</span>&nbsp;<span class="builtintype" id="3360521">byte</span><span class="op" id="3360525">(</span><span class="ident" id="3360526">i</span><span class="op" id="3360527">&gt;&gt;</span><span class="num" id="3360529">16</span><span class="op" id="3360531">)</span><span class="op" id="3360532">,</span>&nbsp;<span class="builtintype" id="3360534">byte</span><span class="op" id="3360538">(</span><span class="ident" id="3360539">i</span><span class="op" id="3360540">&gt;&gt;</span><span class="num" id="3360542">8</span><span class="op" id="3360543">)</span><span class="op" id="3360544">,</span>&nbsp;<span class="builtintype" id="3360546">byte</span><span class="op" id="3360550">(</span><span class="ident" id="3360551">i</span><span class="op" id="3360552">)</span><span class="op" id="3360553">)</span><span class="op" id="3360554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360560">ifmat</span>&nbsp;<span class="op" id="3360566">=</span>&nbsp;<span class="builtinfunc" id="3360568">append</span><span class="op" id="3360574">(</span><span class="ident" id="3360575">ifmat</span><span class="op" id="3360580">,</span>&nbsp;<span class="ident" id="3360582">ifma</span><span class="op" id="3360586">.</span><span class="ident" id="3360587">toAddr</span><span class="op" id="3360593">(</span><span class="op" id="3360594">)</span><span class="op" id="3360595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3360600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3360604">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3360607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360610">return</span>&nbsp;<span class="ident" id="3360617">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3360623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3360626">func</span>&nbsp;<span class="ident" id="3360631">parseProcNetIGMP6</span><span class="op" id="3360648">(</span><span class="ident" id="3360649">path</span>&nbsp;<span class="builtintype" id="3360654">string</span><span class="op" id="3360660">,</span>&nbsp;<span class="ident" id="3360662">ifi</span>&nbsp;<span class="op" id="3360666">*</span><span class="ident" id="3360667">Interface</span><span class="op" id="3360676">)</span>&nbsp;<span class="op" id="3360678">[</span><span class="op" id="3360679">]</span><span class="ident" id="3360680">Addr</span>&nbsp;<span class="op" id="3360685">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360688">fd</span><span class="op" id="3360690">,</span>&nbsp;<span class="ident" id="3360692">err</span>&nbsp;<span class="op" id="3360696">:=</span>&nbsp;<span class="ident" id="3360699">open</span><span class="op" id="3360703">(</span><span class="ident" id="3360704">path</span><span class="op" id="3360708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360711">if</span>&nbsp;<span class="ident" id="3360714">err</span>&nbsp;<span class="op" id="3360718">!=</span>&nbsp;<span class="ident" id="3360721">nil</span>&nbsp;<span class="op" id="3360725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360729">return</span>&nbsp;<span class="ident" id="3360736">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3360741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360744">defer</span>&nbsp;<span class="ident" id="3360750">fd</span><span class="op" id="3360752">.</span><span class="builtinfunc" id="3360753">close</span><span class="op" id="3360758">(</span><span class="op" id="3360759">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360762">var</span>&nbsp;<span class="ident" id="3360766">ifmat</span>&nbsp;<span class="op" id="3360772">[</span><span class="op" id="3360773">]</span><span class="ident" id="3360774">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360780">b</span>&nbsp;<span class="op" id="3360782">:=</span>&nbsp;<span class="builtinfunc" id="3360785">make</span><span class="op" id="3360789">(</span><span class="op" id="3360790">[</span><span class="op" id="3360791">]</span><span class="builtintype" id="3360792">byte</span><span class="op" id="3360796">,</span>&nbsp;<span class="ident" id="3360798">IPv6len</span><span class="op" id="3360805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360808">for</span>&nbsp;<span class="ident" id="3360812">l</span><span class="op" id="3360813">,</span>&nbsp;<span class="ident" id="3360815">ok</span>&nbsp;<span class="op" id="3360818">:=</span>&nbsp;<span class="ident" id="3360821">fd</span><span class="op" id="3360823">.</span><span class="ident" id="3360824">readLine</span><span class="op" id="3360832">(</span><span class="op" id="3360833">)</span><span class="op" id="3360834">;</span>&nbsp;<span class="ident" id="3360836">ok</span><span class="op" id="3360838">;</span>&nbsp;<span class="ident" id="3360840">l</span><span class="op" id="3360841">,</span>&nbsp;<span class="ident" id="3360843">ok</span>&nbsp;<span class="op" id="3360846">=</span>&nbsp;<span class="ident" id="3360848">fd</span><span class="op" id="3360850">.</span><span class="ident" id="3360851">readLine</span><span class="op" id="3360859">(</span><span class="op" id="3360860">)</span>&nbsp;<span class="op" id="3360862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3360866">f</span>&nbsp;<span class="op" id="3360868">:=</span>&nbsp;<span class="ident" id="3360871">splitAtBytes</span><span class="op" id="3360883">(</span><span class="ident" id="3360884">l</span><span class="op" id="3360885">,</span>&nbsp;<span class="string" id="3360887">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3360896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360900">if</span>&nbsp;<span class="builtinfunc" id="3360903">len</span><span class="op" id="3360906">(</span><span class="ident" id="3360907">f</span><span class="op" id="3360908">)</span>&nbsp;<span class="op" id="3360910">&lt;</span>&nbsp;<span class="num" id="3360912">6</span>&nbsp;<span class="op" id="3360914">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360919">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3360930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360934">if</span>&nbsp;<span class="ident" id="3360937">ifi</span>&nbsp;<span class="op" id="3360941">==</span>&nbsp;<span class="ident" id="3360944">nil</span>&nbsp;<span class="op" id="3360948">||</span>&nbsp;<span class="ident" id="3360951">f</span><span class="op" id="3360952">[</span><span class="num" id="3360953">1</span><span class="op" id="3360954">]</span>&nbsp;<span class="op" id="3360956">==</span>&nbsp;<span class="ident" id="3360959">ifi</span><span class="op" id="3360962">.</span><span class="ident" id="3360963">Name</span>&nbsp;<span class="op" id="3360968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3360973">for</span>&nbsp;<span class="ident" id="3360977">i</span>&nbsp;<span class="op" id="3360979">:=</span>&nbsp;<span class="num" id="3360982">0</span><span class="op" id="3360983">;</span>&nbsp;<span class="ident" id="3360985">i</span><span class="op" id="3360986">+</span><span class="num" id="3360987">1</span>&nbsp;<span class="op" id="3360989">&lt;</span>&nbsp;<span class="builtinfunc" id="3360991">len</span><span class="op" id="3360994">(</span><span class="ident" id="3360995">f</span><span class="op" id="3360996">[</span><span class="num" id="3360997">2</span><span class="op" id="3360998">]</span><span class="op" id="3360999">)</span><span class="op" id="3361000">;</span>&nbsp;<span class="ident" id="3361002">i</span>&nbsp;<span class="op" id="3361004">+=</span>&nbsp;<span class="num" id="3361007">2</span>&nbsp;<span class="op" id="3361009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3361015">b</span><span class="op" id="3361016">[</span><span class="ident" id="3361017">i</span><span class="op" id="3361018">/</span><span class="num" id="3361019">2</span><span class="op" id="3361020">]</span><span class="op" id="3361021">,</span>&nbsp;<span class="ident" id="3361023">_</span>&nbsp;<span class="op" id="3361025">=</span>&nbsp;<span class="ident" id="3361027">xtoi2</span><span class="op" id="3361032">(</span><span class="ident" id="3361033">f</span><span class="op" id="3361034">[</span><span class="num" id="3361035">2</span><span class="op" id="3361036">]</span><span class="op" id="3361037">[</span><span class="ident" id="3361038">i</span><span class="op" id="3361039">:</span><span class="ident" id="3361040">i</span><span class="op" id="3361041">+</span><span class="num" id="3361042">2</span><span class="op" id="3361043">]</span><span class="op" id="3361044">,</span>&nbsp;<span class="num" id="3361046">0</span><span class="op" id="3361047">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3361052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3361057">ifma</span>&nbsp;<span class="op" id="3361062">:=</span>&nbsp;<span class="ident" id="3361065">IPAddr</span><span class="op" id="3361071">{</span><span class="ident" id="3361072">IP</span><span class="op" id="3361074">:</span>&nbsp;<span class="ident" id="3361076">IP</span><span class="op" id="3361078">{</span><span class="ident" id="3361079">b</span><span class="op" id="3361080">[</span><span class="num" id="3361081">0</span><span class="op" id="3361082">]</span><span class="op" id="3361083">,</span>&nbsp;<span class="ident" id="3361085">b</span><span class="op" id="3361086">[</span><span class="num" id="3361087">1</span><span class="op" id="3361088">]</span><span class="op" id="3361089">,</span>&nbsp;<span class="ident" id="3361091">b</span><span class="op" id="3361092">[</span><span class="num" id="3361093">2</span><span class="op" id="3361094">]</span><span class="op" id="3361095">,</span>&nbsp;<span class="ident" id="3361097">b</span><span class="op" id="3361098">[</span><span class="num" id="3361099">3</span><span class="op" id="3361100">]</span><span class="op" id="3361101">,</span>&nbsp;<span class="ident" id="3361103">b</span><span class="op" id="3361104">[</span><span class="num" id="3361105">4</span><span class="op" id="3361106">]</span><span class="op" id="3361107">,</span>&nbsp;<span class="ident" id="3361109">b</span><span class="op" id="3361110">[</span><span class="num" id="3361111">5</span><span class="op" id="3361112">]</span><span class="op" id="3361113">,</span>&nbsp;<span class="ident" id="3361115">b</span><span class="op" id="3361116">[</span><span class="num" id="3361117">6</span><span class="op" id="3361118">]</span><span class="op" id="3361119">,</span>&nbsp;<span class="ident" id="3361121">b</span><span class="op" id="3361122">[</span><span class="num" id="3361123">7</span><span class="op" id="3361124">]</span><span class="op" id="3361125">,</span>&nbsp;<span class="ident" id="3361127">b</span><span class="op" id="3361128">[</span><span class="num" id="3361129">8</span><span class="op" id="3361130">]</span><span class="op" id="3361131">,</span>&nbsp;<span class="ident" id="3361133">b</span><span class="op" id="3361134">[</span><span class="num" id="3361135">9</span><span class="op" id="3361136">]</span><span class="op" id="3361137">,</span>&nbsp;<span class="ident" id="3361139">b</span><span class="op" id="3361140">[</span><span class="num" id="3361141">10</span><span class="op" id="3361143">]</span><span class="op" id="3361144">,</span>&nbsp;<span class="ident" id="3361146">b</span><span class="op" id="3361147">[</span><span class="num" id="3361148">11</span><span class="op" id="3361150">]</span><span class="op" id="3361151">,</span>&nbsp;<span class="ident" id="3361153">b</span><span class="op" id="3361154">[</span><span class="num" id="3361155">12</span><span class="op" id="3361157">]</span><span class="op" id="3361158">,</span>&nbsp;<span class="ident" id="3361160">b</span><span class="op" id="3361161">[</span><span class="num" id="3361162">13</span><span class="op" id="3361164">]</span><span class="op" id="3361165">,</span>&nbsp;<span class="ident" id="3361167">b</span><span class="op" id="3361168">[</span><span class="num" id="3361169">14</span><span class="op" id="3361171">]</span><span class="op" id="3361172">,</span>&nbsp;<span class="ident" id="3361174">b</span><span class="op" id="3361175">[</span><span class="num" id="3361176">15</span><span class="op" id="3361178">]</span><span class="op" id="3361179">}</span><span class="op" id="3361180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3361185">ifmat</span>&nbsp;<span class="op" id="3361191">=</span>&nbsp;<span class="builtinfunc" id="3361193">append</span><span class="op" id="3361199">(</span><span class="ident" id="3361200">ifmat</span><span class="op" id="3361205">,</span>&nbsp;<span class="ident" id="3361207">ifma</span><span class="op" id="3361211">.</span><span class="ident" id="3361212">toAddr</span><span class="op" id="3361218">(</span><span class="op" id="3361219">)</span><span class="op" id="3361220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3361224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3361227">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3361230">return</span>&nbsp;<span class="ident" id="3361237">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3361243">}</span>
</div>
</body>
</html>
