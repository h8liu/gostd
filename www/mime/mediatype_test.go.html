<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8372790">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8372845">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8372899">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8372950">package</span>&nbsp;<span class="ident" id="8372958">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8372964">import</span>&nbsp;<span class="op" id="8372971">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8372974">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8372985">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8372995">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8372998">func</span>&nbsp;<span class="ident" id="8373003">TestConsumeToken</span><span class="op" id="8373019">(</span><span class="ident" id="8373020">t</span>&nbsp;<span class="op" id="8373022">*</span><span class="ident" id="8373023">testing</span><span class="op" id="8373030">.</span><span class="ident" id="8373031">T</span><span class="op" id="8373032">)</span>&nbsp;<span class="op" id="8373034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373037">tests</span>&nbsp;<span class="op" id="8373043">:=</span>&nbsp;<span class="op" id="8373046">[</span><span class="op" id="8373047">...</span><span class="op" id="8373050">]</span><span class="op" id="8373051">[</span><span class="num" id="8373052">3</span><span class="op" id="8373053">]</span><span class="builtintype" id="8373054">string</span><span class="op" id="8373060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373064">{</span><span class="string" id="8373065">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8373074">,</span>&nbsp;<span class="string" id="8373076">&#34;foo&#34;</span><span class="op" id="8373081">,</span>&nbsp;<span class="string" id="8373083">&#34;&nbsp;bar&#34;</span><span class="op" id="8373089">}</span><span class="op" id="8373090">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373094">{</span><span class="string" id="8373095">&#34;bar&#34;</span><span class="op" id="8373100">,</span>&nbsp;<span class="string" id="8373102">&#34;bar&#34;</span><span class="op" id="8373107">,</span>&nbsp;<span class="string" id="8373109">&#34;&#34;</span><span class="op" id="8373111">}</span><span class="op" id="8373112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373116">{</span><span class="string" id="8373117">&#34;&#34;</span><span class="op" id="8373119">,</span>&nbsp;<span class="string" id="8373121">&#34;&#34;</span><span class="op" id="8373123">,</span>&nbsp;<span class="string" id="8373125">&#34;&#34;</span><span class="op" id="8373127">}</span><span class="op" id="8373128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373132">{</span><span class="string" id="8373133">&#34;&nbsp;foo&#34;</span><span class="op" id="8373139">,</span>&nbsp;<span class="string" id="8373141">&#34;&#34;</span><span class="op" id="8373143">,</span>&nbsp;<span class="string" id="8373145">&#34;&nbsp;foo&#34;</span><span class="op" id="8373151">}</span><span class="op" id="8373152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373158">for</span>&nbsp;<span class="ident" id="8373162">_</span><span class="op" id="8373163">,</span>&nbsp;<span class="ident" id="8373165">test</span>&nbsp;<span class="op" id="8373170">:=</span>&nbsp;<span class="keyword" id="8373173">range</span>&nbsp;<span class="ident" id="8373179">tests</span>&nbsp;<span class="op" id="8373185">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373189">token</span><span class="op" id="8373194">,</span>&nbsp;<span class="ident" id="8373196">rest</span>&nbsp;<span class="op" id="8373201">:=</span>&nbsp;<span class="ident" id="8373204">consumeToken</span><span class="op" id="8373216">(</span><span class="ident" id="8373217">test</span><span class="op" id="8373221">[</span><span class="num" id="8373222">0</span><span class="op" id="8373223">]</span><span class="op" id="8373224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373228">expectedToken</span>&nbsp;<span class="op" id="8373242">:=</span>&nbsp;<span class="ident" id="8373245">test</span><span class="op" id="8373249">[</span><span class="num" id="8373250">1</span><span class="op" id="8373251">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373255">expectedRest</span>&nbsp;<span class="op" id="8373268">:=</span>&nbsp;<span class="ident" id="8373271">test</span><span class="op" id="8373275">[</span><span class="num" id="8373276">2</span><span class="op" id="8373277">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373281">if</span>&nbsp;<span class="ident" id="8373284">token</span>&nbsp;<span class="op" id="8373290">!=</span>&nbsp;<span class="ident" id="8373293">expectedToken</span>&nbsp;<span class="op" id="8373307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373312">t</span><span class="op" id="8373313">.</span><span class="ident" id="8373314">Errorf</span><span class="op" id="8373320">(</span><span class="string" id="8373321">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8373373">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373379">expectedToken</span><span class="op" id="8373392">,</span>&nbsp;<span class="ident" id="8373394">token</span><span class="op" id="8373399">,</span>&nbsp;<span class="ident" id="8373401">test</span><span class="op" id="8373405">[</span><span class="num" id="8373406">0</span><span class="op" id="8373407">]</span><span class="op" id="8373408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373412">}</span>&nbsp;<span class="keyword" id="8373414">else</span>&nbsp;<span class="keyword" id="8373419">if</span>&nbsp;<span class="ident" id="8373422">rest</span>&nbsp;<span class="op" id="8373427">!=</span>&nbsp;<span class="ident" id="8373430">expectedRest</span>&nbsp;<span class="op" id="8373443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373448">t</span><span class="op" id="8373449">.</span><span class="ident" id="8373450">Errorf</span><span class="op" id="8373456">(</span><span class="string" id="8373457">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8373530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373536">expectedRest</span><span class="op" id="8373548">,</span>&nbsp;<span class="ident" id="8373550">rest</span><span class="op" id="8373554">,</span>&nbsp;<span class="ident" id="8373556">token</span><span class="op" id="8373561">,</span>&nbsp;<span class="ident" id="8373563">test</span><span class="op" id="8373567">[</span><span class="num" id="8373568">0</span><span class="op" id="8373569">]</span><span class="op" id="8373570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373574">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373577">}</span><br>
<span class="lineno"></span><span class="op" id="8373579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8373582">func</span>&nbsp;<span class="ident" id="8373587">TestConsumeValue</span><span class="op" id="8373603">(</span><span class="ident" id="8373604">t</span>&nbsp;<span class="op" id="8373606">*</span><span class="ident" id="8373607">testing</span><span class="op" id="8373614">.</span><span class="ident" id="8373615">T</span><span class="op" id="8373616">)</span>&nbsp;<span class="op" id="8373618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373621">tests</span>&nbsp;<span class="op" id="8373627">:=</span>&nbsp;<span class="op" id="8373630">[</span><span class="op" id="8373631">...</span><span class="op" id="8373634">]</span><span class="op" id="8373635">[</span><span class="num" id="8373636">3</span><span class="op" id="8373637">]</span><span class="builtintype" id="8373638">string</span><span class="op" id="8373644">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373648">{</span><span class="string" id="8373649">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8373658">,</span>&nbsp;<span class="string" id="8373660">&#34;foo&#34;</span><span class="op" id="8373665">,</span>&nbsp;<span class="string" id="8373667">&#34;&nbsp;bar&#34;</span><span class="op" id="8373673">}</span><span class="op" id="8373674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373678">{</span><span class="string" id="8373679">&#34;bar&#34;</span><span class="op" id="8373684">,</span>&nbsp;<span class="string" id="8373686">&#34;bar&#34;</span><span class="op" id="8373691">,</span>&nbsp;<span class="string" id="8373693">&#34;&#34;</span><span class="op" id="8373695">}</span><span class="op" id="8373696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373700">{</span><span class="string" id="8373701">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8373708">,</span>&nbsp;<span class="string" id="8373710">&#34;&#34;</span><span class="op" id="8373712">,</span>&nbsp;<span class="string" id="8373714">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8373721">}</span><span class="op" id="8373722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373726">{</span><span class="string" id="8373727">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="8373742">,</span>&nbsp;<span class="string" id="8373744">&#34;My&nbsp;value&#34;</span><span class="op" id="8373754">,</span>&nbsp;<span class="string" id="8373756">&#34;end&#34;</span><span class="op" id="8373761">}</span><span class="op" id="8373762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373766">{</span><span class="string" id="8373767">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="8373783">,</span>&nbsp;<span class="string" id="8373785">&#34;My&nbsp;value&#34;</span><span class="op" id="8373795">,</span>&nbsp;<span class="string" id="8373797">&#34;&nbsp;end&#34;</span><span class="op" id="8373803">}</span><span class="op" id="8373804">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373808">{</span><span class="string" id="8373809">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="8373820">,</span>&nbsp;<span class="string" id="8373822">&#34;\\&#34;</span><span class="op" id="8373826">,</span>&nbsp;<span class="string" id="8373828">&#34;&nbsp;rest&#34;</span><span class="op" id="8373835">}</span><span class="op" id="8373836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373840">{</span><span class="string" id="8373841">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="8373859">,</span>&nbsp;<span class="string" id="8373861">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="8373874">,</span>&nbsp;<span class="string" id="8373876">&#34;end&#34;</span><span class="op" id="8373881">}</span><span class="op" id="8373882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373886">{</span><span class="string" id="8373887">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8373897">,</span>&nbsp;<span class="string" id="8373899">&#34;&#34;</span><span class="op" id="8373901">,</span>&nbsp;<span class="string" id="8373903">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8373913">}</span><span class="op" id="8373914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8373917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8373920">for</span>&nbsp;<span class="ident" id="8373924">_</span><span class="op" id="8373925">,</span>&nbsp;<span class="ident" id="8373927">test</span>&nbsp;<span class="op" id="8373932">:=</span>&nbsp;<span class="keyword" id="8373935">range</span>&nbsp;<span class="ident" id="8373941">tests</span>&nbsp;<span class="op" id="8373947">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373951">value</span><span class="op" id="8373956">,</span>&nbsp;<span class="ident" id="8373958">rest</span>&nbsp;<span class="op" id="8373963">:=</span>&nbsp;<span class="ident" id="8373966">consumeValue</span><span class="op" id="8373978">(</span><span class="ident" id="8373979">test</span><span class="op" id="8373983">[</span><span class="num" id="8373984">0</span><span class="op" id="8373985">]</span><span class="op" id="8373986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8373990">expectedValue</span>&nbsp;<span class="op" id="8374004">:=</span>&nbsp;<span class="ident" id="8374007">test</span><span class="op" id="8374011">[</span><span class="num" id="8374012">1</span><span class="op" id="8374013">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374017">expectedRest</span>&nbsp;<span class="op" id="8374030">:=</span>&nbsp;<span class="ident" id="8374033">test</span><span class="op" id="8374037">[</span><span class="num" id="8374038">2</span><span class="op" id="8374039">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374043">if</span>&nbsp;<span class="ident" id="8374046">value</span>&nbsp;<span class="op" id="8374052">!=</span>&nbsp;<span class="ident" id="8374055">expectedValue</span>&nbsp;<span class="op" id="8374069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374074">t</span><span class="op" id="8374075">.</span><span class="ident" id="8374076">Errorf</span><span class="op" id="8374082">(</span><span class="string" id="8374083">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8374135">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374141">expectedValue</span><span class="op" id="8374154">,</span>&nbsp;<span class="ident" id="8374156">value</span><span class="op" id="8374161">,</span>&nbsp;<span class="ident" id="8374163">test</span><span class="op" id="8374167">[</span><span class="num" id="8374168">0</span><span class="op" id="8374169">]</span><span class="op" id="8374170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374174">}</span>&nbsp;<span class="keyword" id="8374176">else</span>&nbsp;<span class="keyword" id="8374181">if</span>&nbsp;<span class="ident" id="8374184">rest</span>&nbsp;<span class="op" id="8374189">!=</span>&nbsp;<span class="ident" id="8374192">expectedRest</span>&nbsp;<span class="op" id="8374205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374210">t</span><span class="op" id="8374211">.</span><span class="ident" id="8374212">Errorf</span><span class="op" id="8374218">(</span><span class="string" id="8374219">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8374292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374298">expectedRest</span><span class="op" id="8374310">,</span>&nbsp;<span class="ident" id="8374312">rest</span><span class="op" id="8374316">,</span>&nbsp;<span class="ident" id="8374318">value</span><span class="op" id="8374323">,</span>&nbsp;<span class="ident" id="8374325">test</span><span class="op" id="8374329">[</span><span class="num" id="8374330">0</span><span class="op" id="8374331">]</span><span class="op" id="8374332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374336">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374339">}</span><br>
<span class="lineno"></span><span class="op" id="8374341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8374344">func</span>&nbsp;<span class="ident" id="8374349">TestConsumeMediaParam</span><span class="op" id="8374370">(</span><span class="ident" id="8374371">t</span>&nbsp;<span class="op" id="8374373">*</span><span class="ident" id="8374374">testing</span><span class="op" id="8374381">.</span><span class="ident" id="8374382">T</span><span class="op" id="8374383">)</span>&nbsp;<span class="op" id="8374385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374388">tests</span>&nbsp;<span class="op" id="8374394">:=</span>&nbsp;<span class="op" id="8374397">[</span><span class="op" id="8374398">...</span><span class="op" id="8374401">]</span><span class="op" id="8374402">[</span><span class="num" id="8374403">4</span><span class="op" id="8374404">]</span><span class="builtintype" id="8374405">string</span><span class="op" id="8374411">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374415">{</span><span class="string" id="8374416">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="8374428">,</span>&nbsp;<span class="string" id="8374430">&#34;foo&#34;</span><span class="op" id="8374435">,</span>&nbsp;<span class="string" id="8374437">&#34;bar&#34;</span><span class="op" id="8374442">,</span>&nbsp;<span class="string" id="8374444">&#34;&#34;</span><span class="op" id="8374446">}</span><span class="op" id="8374447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374451">{</span><span class="string" id="8374452">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="8374463">,</span>&nbsp;<span class="string" id="8374465">&#34;foo&#34;</span><span class="op" id="8374470">,</span>&nbsp;<span class="string" id="8374472">&#34;bar&#34;</span><span class="op" id="8374477">,</span>&nbsp;<span class="string" id="8374479">&#34;&#34;</span><span class="op" id="8374481">}</span><span class="op" id="8374482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374486">{</span><span class="string" id="8374487">&#34;;foo=bar&#34;</span><span class="op" id="8374497">,</span>&nbsp;<span class="string" id="8374499">&#34;foo&#34;</span><span class="op" id="8374504">,</span>&nbsp;<span class="string" id="8374506">&#34;bar&#34;</span><span class="op" id="8374511">,</span>&nbsp;<span class="string" id="8374513">&#34;&#34;</span><span class="op" id="8374515">}</span><span class="op" id="8374516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374520">{</span><span class="string" id="8374521">&#34;;FOO=bar&#34;</span><span class="op" id="8374531">,</span>&nbsp;<span class="string" id="8374533">&#34;foo&#34;</span><span class="op" id="8374538">,</span>&nbsp;<span class="string" id="8374540">&#34;bar&#34;</span><span class="op" id="8374545">,</span>&nbsp;<span class="string" id="8374547">&#34;&#34;</span><span class="op" id="8374549">}</span><span class="op" id="8374550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374554">{</span><span class="string" id="8374555">`;foo=&#34;bar&#34;`</span><span class="op" id="8374567">,</span>&nbsp;<span class="string" id="8374569">&#34;foo&#34;</span><span class="op" id="8374574">,</span>&nbsp;<span class="string" id="8374576">&#34;bar&#34;</span><span class="op" id="8374581">,</span>&nbsp;<span class="string" id="8374583">&#34;&#34;</span><span class="op" id="8374585">}</span><span class="op" id="8374586">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374590">{</span><span class="string" id="8374591">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="8374605">,</span>&nbsp;<span class="string" id="8374607">&#34;foo&#34;</span><span class="op" id="8374612">,</span>&nbsp;<span class="string" id="8374614">&#34;bar&#34;</span><span class="op" id="8374619">,</span>&nbsp;<span class="string" id="8374621">&#34;;&nbsp;&#34;</span><span class="op" id="8374625">}</span><span class="op" id="8374626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374630">{</span><span class="string" id="8374631">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="8374652">,</span>&nbsp;<span class="string" id="8374654">&#34;foo&#34;</span><span class="op" id="8374659">,</span>&nbsp;<span class="string" id="8374661">&#34;bar&#34;</span><span class="op" id="8374666">,</span>&nbsp;<span class="string" id="8374668">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="8374679">}</span><span class="op" id="8374680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374684">{</span><span class="string" id="8374685">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="8374707">,</span>&nbsp;<span class="string" id="8374709">&#34;boundary&#34;</span><span class="op" id="8374719">,</span>&nbsp;<span class="string" id="8374721">&#34;----CUT&#34;</span><span class="op" id="8374730">,</span>&nbsp;<span class="string" id="8374732">&#34;;&#34;</span><span class="op" id="8374735">}</span><span class="op" id="8374736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374740">{</span><span class="string" id="8374741">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8374782">,</span>&nbsp;<span class="string" id="8374784">&#34;key&#34;</span><span class="op" id="8374789">,</span>&nbsp;<span class="string" id="8374791">&#34;value&#34;</span><span class="op" id="8374798">,</span>&nbsp;<span class="string" id="8374800">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8374829">}</span><span class="op" id="8374830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374834">{</span><span class="string" id="8374835">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8374864">,</span>&nbsp;<span class="string" id="8374866">&#34;blah&#34;</span><span class="op" id="8374872">,</span>&nbsp;<span class="string" id="8374874">&#34;value&#34;</span><span class="op" id="8374881">,</span>&nbsp;<span class="string" id="8374883">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8374897">}</span><span class="op" id="8374898">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374902">{</span><span class="string" id="8374903">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8374917">,</span>&nbsp;<span class="string" id="8374919">&#34;name&#34;</span><span class="op" id="8374925">,</span>&nbsp;<span class="string" id="8374927">&#34;foo&#34;</span><span class="op" id="8374932">,</span>&nbsp;<span class="string" id="8374934">`&nbsp;`</span><span class="op" id="8374937">}</span><span class="op" id="8374938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374944">for</span>&nbsp;<span class="ident" id="8374948">_</span><span class="op" id="8374949">,</span>&nbsp;<span class="ident" id="8374951">test</span>&nbsp;<span class="op" id="8374956">:=</span>&nbsp;<span class="keyword" id="8374959">range</span>&nbsp;<span class="ident" id="8374965">tests</span>&nbsp;<span class="op" id="8374971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374975">param</span><span class="op" id="8374980">,</span>&nbsp;<span class="ident" id="8374982">value</span><span class="op" id="8374987">,</span>&nbsp;<span class="ident" id="8374989">rest</span>&nbsp;<span class="op" id="8374994">:=</span>&nbsp;<span class="ident" id="8374997">consumeMediaParam</span><span class="op" id="8375014">(</span><span class="ident" id="8375015">test</span><span class="op" id="8375019">[</span><span class="num" id="8375020">0</span><span class="op" id="8375021">]</span><span class="op" id="8375022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375026">expectedParam</span>&nbsp;<span class="op" id="8375040">:=</span>&nbsp;<span class="ident" id="8375043">test</span><span class="op" id="8375047">[</span><span class="num" id="8375048">1</span><span class="op" id="8375049">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375053">expectedValue</span>&nbsp;<span class="op" id="8375067">:=</span>&nbsp;<span class="ident" id="8375070">test</span><span class="op" id="8375074">[</span><span class="num" id="8375075">2</span><span class="op" id="8375076">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375080">expectedRest</span>&nbsp;<span class="op" id="8375093">:=</span>&nbsp;<span class="ident" id="8375096">test</span><span class="op" id="8375100">[</span><span class="num" id="8375101">3</span><span class="op" id="8375102">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375106">if</span>&nbsp;<span class="ident" id="8375109">param</span>&nbsp;<span class="op" id="8375115">!=</span>&nbsp;<span class="ident" id="8375118">expectedParam</span>&nbsp;<span class="op" id="8375132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375137">t</span><span class="op" id="8375138">.</span><span class="ident" id="8375139">Errorf</span><span class="op" id="8375145">(</span><span class="string" id="8375146">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8375198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375204">expectedParam</span><span class="op" id="8375217">,</span>&nbsp;<span class="ident" id="8375219">param</span><span class="op" id="8375224">,</span>&nbsp;<span class="ident" id="8375226">test</span><span class="op" id="8375230">[</span><span class="num" id="8375231">0</span><span class="op" id="8375232">]</span><span class="op" id="8375233">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375237">}</span>&nbsp;<span class="keyword" id="8375239">else</span>&nbsp;<span class="keyword" id="8375244">if</span>&nbsp;<span class="ident" id="8375247">value</span>&nbsp;<span class="op" id="8375253">!=</span>&nbsp;<span class="ident" id="8375256">expectedValue</span>&nbsp;<span class="op" id="8375270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375275">t</span><span class="op" id="8375276">.</span><span class="ident" id="8375277">Errorf</span><span class="op" id="8375283">(</span><span class="string" id="8375284">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8375336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375342">expectedValue</span><span class="op" id="8375355">,</span>&nbsp;<span class="ident" id="8375357">value</span><span class="op" id="8375362">,</span>&nbsp;<span class="ident" id="8375364">test</span><span class="op" id="8375368">[</span><span class="num" id="8375369">0</span><span class="op" id="8375370">]</span><span class="op" id="8375371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375375">}</span>&nbsp;<span class="keyword" id="8375377">else</span>&nbsp;<span class="keyword" id="8375382">if</span>&nbsp;<span class="ident" id="8375385">rest</span>&nbsp;<span class="op" id="8375390">!=</span>&nbsp;<span class="ident" id="8375393">expectedRest</span>&nbsp;<span class="op" id="8375406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375411">t</span><span class="op" id="8375412">.</span><span class="ident" id="8375413">Errorf</span><span class="op" id="8375419">(</span><span class="string" id="8375420">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8375490">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375496">expectedRest</span><span class="op" id="8375508">,</span>&nbsp;<span class="ident" id="8375510">rest</span><span class="op" id="8375514">,</span>&nbsp;<span class="ident" id="8375516">param</span><span class="op" id="8375521">,</span>&nbsp;<span class="ident" id="8375523">value</span><span class="op" id="8375528">,</span>&nbsp;<span class="ident" id="8375530">test</span><span class="op" id="8375534">[</span><span class="num" id="8375535">0</span><span class="op" id="8375536">]</span><span class="op" id="8375537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375544">}</span><br>
<span class="lineno"></span><span class="op" id="8375546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8375549">type</span>&nbsp;<span class="ident" id="8375554">mediaTypeTest</span>&nbsp;<span class="keyword" id="8375568">struct</span>&nbsp;<span class="op" id="8375575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375578">in</span>&nbsp;<span class="builtintype" id="8375581">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375589">t</span>&nbsp;&nbsp;<span class="builtintype" id="8375592">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375600">p</span>&nbsp;&nbsp;<span class="keyword" id="8375603">map</span><span class="op" id="8375606">[</span><span class="builtintype" id="8375607">string</span><span class="op" id="8375613">]</span><span class="builtintype" id="8375614">string</span><br>
<span class="lineno"></span><span class="op" id="8375621">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="8375624">func</span>&nbsp;<span class="ident" id="8375629">TestParseMediaType</span><span class="op" id="8375647">(</span><span class="ident" id="8375648">t</span>&nbsp;<span class="op" id="8375650">*</span><span class="ident" id="8375651">testing</span><span class="op" id="8375658">.</span><span class="ident" id="8375659">T</span><span class="op" id="8375660">)</span>&nbsp;<span class="op" id="8375662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375665">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375697">m</span>&nbsp;<span class="op" id="8375699">:=</span>&nbsp;<span class="keyword" id="8375702">func</span><span class="op" id="8375706">(</span><span class="ident" id="8375707">s</span>&nbsp;<span class="op" id="8375709">...</span><span class="builtintype" id="8375712">string</span><span class="op" id="8375718">)</span>&nbsp;<span class="keyword" id="8375720">map</span><span class="op" id="8375723">[</span><span class="builtintype" id="8375724">string</span><span class="op" id="8375730">]</span><span class="builtintype" id="8375731">string</span>&nbsp;<span class="op" id="8375738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375742">sm</span>&nbsp;<span class="op" id="8375745">:=</span>&nbsp;<span class="builtinfunc" id="8375748">make</span><span class="op" id="8375752">(</span><span class="keyword" id="8375753">map</span><span class="op" id="8375756">[</span><span class="builtintype" id="8375757">string</span><span class="op" id="8375763">]</span><span class="builtintype" id="8375764">string</span><span class="op" id="8375770">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375774">for</span>&nbsp;<span class="ident" id="8375778">i</span>&nbsp;<span class="op" id="8375780">:=</span>&nbsp;<span class="num" id="8375783">0</span><span class="op" id="8375784">;</span>&nbsp;<span class="ident" id="8375786">i</span>&nbsp;<span class="op" id="8375788">&lt;</span>&nbsp;<span class="builtinfunc" id="8375790">len</span><span class="op" id="8375793">(</span><span class="ident" id="8375794">s</span><span class="op" id="8375795">)</span><span class="op" id="8375796">;</span>&nbsp;<span class="ident" id="8375798">i</span>&nbsp;<span class="op" id="8375800">+=</span>&nbsp;<span class="num" id="8375803">2</span>&nbsp;<span class="op" id="8375805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375810">sm</span><span class="op" id="8375812">[</span><span class="ident" id="8375813">s</span><span class="op" id="8375814">[</span><span class="ident" id="8375815">i</span><span class="op" id="8375816">]</span><span class="op" id="8375817">]</span>&nbsp;<span class="op" id="8375819">=</span>&nbsp;<span class="ident" id="8375821">s</span><span class="op" id="8375822">[</span><span class="ident" id="8375823">i</span><span class="op" id="8375824">+</span><span class="num" id="8375825">1</span><span class="op" id="8375826">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375834">return</span>&nbsp;<span class="ident" id="8375841">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375845">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375849">nameFoo</span>&nbsp;<span class="op" id="8375857">:=</span>&nbsp;<span class="keyword" id="8375860">map</span><span class="op" id="8375863">[</span><span class="builtintype" id="8375864">string</span><span class="op" id="8375870">]</span><span class="builtintype" id="8375871">string</span><span class="op" id="8375877">{</span><span class="string" id="8375878">&#34;name&#34;</span><span class="op" id="8375884">:</span>&nbsp;<span class="string" id="8375886">&#34;foo&#34;</span><span class="op" id="8375891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375894">tests</span>&nbsp;<span class="op" id="8375900">:=</span>&nbsp;<span class="op" id="8375903">[</span><span class="op" id="8375904">]</span><span class="ident" id="8375905">mediaTypeTest</span><span class="op" id="8375918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375922">{</span><span class="string" id="8375923">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8375946">,</span>&nbsp;<span class="string" id="8375948">&#34;form-data&#34;</span><span class="op" id="8375959">,</span>&nbsp;<span class="ident" id="8375961">nameFoo</span><span class="op" id="8375968">}</span><span class="op" id="8375969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375973">{</span><span class="string" id="8375974">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="8375997">,</span>&nbsp;<span class="string" id="8375999">&#34;form-data&#34;</span><span class="op" id="8376010">,</span>&nbsp;<span class="ident" id="8376012">nameFoo</span><span class="op" id="8376019">}</span><span class="op" id="8376020">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376024">{</span><span class="string" id="8376025">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="8376047">,</span>&nbsp;<span class="string" id="8376049">&#34;form-data&#34;</span><span class="op" id="8376060">,</span>&nbsp;<span class="ident" id="8376062">nameFoo</span><span class="op" id="8376069">}</span><span class="op" id="8376070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376074">{</span><span class="string" id="8376075">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8376100">,</span>&nbsp;<span class="string" id="8376102">&#34;form-data&#34;</span><span class="op" id="8376113">,</span>&nbsp;<span class="ident" id="8376115">nameFoo</span><span class="op" id="8376122">}</span><span class="op" id="8376123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376127">{</span><span class="string" id="8376128">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8376153">,</span>&nbsp;<span class="string" id="8376155">&#34;form-data&#34;</span><span class="op" id="8376166">,</span>&nbsp;<span class="ident" id="8376168">nameFoo</span><span class="op" id="8376175">}</span><span class="op" id="8376176">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376181">{</span><span class="string" id="8376182">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8376231">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376236">&#34;form-data&#34;</span><span class="op" id="8376247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376252">m</span><span class="op" id="8376253">(</span><span class="string" id="8376254">&#34;key&#34;</span><span class="op" id="8376259">,</span>&nbsp;<span class="string" id="8376261">&#34;value&#34;</span><span class="op" id="8376268">,</span>&nbsp;<span class="string" id="8376270">&#34;blah&#34;</span><span class="op" id="8376276">,</span>&nbsp;<span class="string" id="8376278">&#34;value&#34;</span><span class="op" id="8376285">,</span>&nbsp;<span class="string" id="8376287">&#34;name&#34;</span><span class="op" id="8376293">,</span>&nbsp;<span class="string" id="8376295">&#34;foo&#34;</span><span class="op" id="8376300">)</span><span class="op" id="8376301">}</span><span class="op" id="8376302">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376307">{</span><span class="string" id="8376308">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="8376365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376370">&#34;&#34;</span><span class="op" id="8376372">,</span>&nbsp;<span class="ident" id="8376374">m</span><span class="op" id="8376375">(</span><span class="op" id="8376376">)</span><span class="op" id="8376377">}</span><span class="op" id="8376378">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8376383">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376403">{</span><span class="string" id="8376404">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="8376482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376487">&#34;application/x-stuff&#34;</span><span class="op" id="8376508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376513">m</span><span class="op" id="8376514">(</span><span class="string" id="8376515">&#34;title&#34;</span><span class="op" id="8376522">,</span>&nbsp;<span class="string" id="8376524">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="8376543">)</span><span class="op" id="8376544">}</span><span class="op" id="8376545">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376550">{</span><span class="string" id="8376551">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="8376594">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376599">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="8376617">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376622">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="8376680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376685">&#34;message/external-body&#34;</span><span class="op" id="8376708">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376713">m</span><span class="op" id="8376714">(</span><span class="string" id="8376715">&#34;access-type&#34;</span><span class="op" id="8376728">,</span>&nbsp;<span class="string" id="8376730">&#34;URL&#34;</span><span class="op" id="8376735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376741">&#34;url&#34;</span><span class="op" id="8376746">,</span>&nbsp;<span class="string" id="8376748">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="8376804">)</span><span class="op" id="8376805">}</span><span class="op" id="8376806">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376811">{</span><span class="string" id="8376812">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="8376836">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376841">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="8376893">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376898">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="8376936">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376941">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="8376962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376967">&#34;application/x-stuff&#34;</span><span class="op" id="8376988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376993">m</span><span class="op" id="8376994">(</span><span class="string" id="8376995">&#34;title&#34;</span><span class="op" id="8377002">,</span>&nbsp;<span class="string" id="8377004">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="8377043">)</span><span class="op" id="8377044">}</span><span class="op" id="8377045">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8377050">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8377100">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377163">{</span><span class="string" id="8377164">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="8377198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377203">&#34;attachment&#34;</span><span class="op" id="8377215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377220">m</span><span class="op" id="8377221">(</span><span class="string" id="8377222">&#34;filename&#34;</span><span class="op" id="8377232">,</span>&nbsp;<span class="string" id="8377234">&#34;foo.html&#34;</span><span class="op" id="8377244">)</span><span class="op" id="8377245">}</span><span class="op" id="8377246">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377250">{</span><span class="string" id="8377251">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="8377299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377304">&#34;attachment&#34;</span><span class="op" id="8377316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377321">m</span><span class="op" id="8377322">(</span><span class="string" id="8377323">&#34;filename&#34;</span><span class="op" id="8377333">,</span>&nbsp;<span class="string" id="8377335">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="8377358">)</span><span class="op" id="8377359">}</span><span class="op" id="8377360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377364">{</span><span class="string" id="8377365">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="8377414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377419">&#34;attachment&#34;</span><span class="op" id="8377431">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377436">m</span><span class="op" id="8377437">(</span><span class="string" id="8377438">&#34;filename&#34;</span><span class="op" id="8377448">,</span>&nbsp;<span class="string" id="8377450">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="8377476">)</span><span class="op" id="8377477">}</span><span class="op" id="8377478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377482">{</span><span class="string" id="8377483">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="8377527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377532">&#34;attachment&#34;</span><span class="op" id="8377544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377549">m</span><span class="op" id="8377550">(</span><span class="string" id="8377551">&#34;foo&#34;</span><span class="op" id="8377556">,</span>&nbsp;<span class="string" id="8377558">&#34;\&#34;\\&#34;</span><span class="op" id="8377564">,</span>&nbsp;<span class="string" id="8377566">&#34;filename&#34;</span><span class="op" id="8377576">,</span>&nbsp;<span class="string" id="8377578">&#34;foo.html&#34;</span><span class="op" id="8377588">)</span><span class="op" id="8377589">}</span><span class="op" id="8377590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377594">{</span><span class="string" id="8377595">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="8377626">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377631">&#34;attachment&#34;</span><span class="op" id="8377643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377648">m</span><span class="op" id="8377649">(</span><span class="string" id="8377650">&#34;filename&#34;</span><span class="op" id="8377660">,</span>&nbsp;<span class="string" id="8377662">&#34;foo.html&#34;</span><span class="op" id="8377672">)</span><span class="op" id="8377673">}</span><span class="op" id="8377674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377678">{</span><span class="string" id="8377679">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="8377712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377717">&#34;attachment&#34;</span><span class="op" id="8377729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377734">m</span><span class="op" id="8377735">(</span><span class="string" id="8377736">&#34;filename&#34;</span><span class="op" id="8377746">,</span>&nbsp;<span class="string" id="8377748">&#34;foo.html&#34;</span><span class="op" id="8377758">)</span><span class="op" id="8377759">}</span><span class="op" id="8377760">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377764">{</span><span class="string" id="8377765">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="8377798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377803">&#34;attachment&#34;</span><span class="op" id="8377815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377820">m</span><span class="op" id="8377821">(</span><span class="string" id="8377822">&#34;filename&#34;</span><span class="op" id="8377832">,</span>&nbsp;<span class="string" id="8377834">&#34;foo.html&#34;</span><span class="op" id="8377844">)</span><span class="op" id="8377845">}</span><span class="op" id="8377846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377850">{</span><span class="string" id="8377851">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="8377888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377893">&#34;attachment&#34;</span><span class="op" id="8377905">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377910">m</span><span class="op" id="8377911">(</span><span class="string" id="8377912">&#34;filename&#34;</span><span class="op" id="8377922">,</span>&nbsp;<span class="string" id="8377924">&#34;foo-%41.html&#34;</span><span class="op" id="8377938">)</span><span class="op" id="8377939">}</span><span class="op" id="8377940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377944">{</span><span class="string" id="8377945">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="8377983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377988">&#34;attachment&#34;</span><span class="op" id="8378000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378005">m</span><span class="op" id="8378006">(</span><span class="string" id="8378007">&#34;filename&#34;</span><span class="op" id="8378017">,</span>&nbsp;<span class="string" id="8378019">&#34;foo-%41.html&#34;</span><span class="op" id="8378033">)</span><span class="op" id="8378034">}</span><span class="op" id="8378035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378039">{</span><span class="string" id="8378040">`filename=foo.html`</span><span class="op" id="8378059">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378064">&#34;&#34;</span><span class="op" id="8378066">,</span>&nbsp;<span class="ident" id="8378068">m</span><span class="op" id="8378069">(</span><span class="op" id="8378070">)</span><span class="op" id="8378071">}</span><span class="op" id="8378072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378076">{</span><span class="string" id="8378077">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="8378101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378106">&#34;&#34;</span><span class="op" id="8378108">,</span>&nbsp;<span class="ident" id="8378110">m</span><span class="op" id="8378111">(</span><span class="op" id="8378112">)</span><span class="op" id="8378113">}</span><span class="op" id="8378114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378118">{</span><span class="string" id="8378119">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="8378158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378163">&#34;&#34;</span><span class="op" id="8378165">,</span>&nbsp;<span class="ident" id="8378167">m</span><span class="op" id="8378168">(</span><span class="op" id="8378169">)</span><span class="op" id="8378170">}</span><span class="op" id="8378171">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378175">{</span><span class="string" id="8378176">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="8378215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378220">&#34;&#34;</span><span class="op" id="8378222">,</span>&nbsp;<span class="ident" id="8378224">m</span><span class="op" id="8378225">(</span><span class="op" id="8378226">)</span><span class="op" id="8378227">}</span><span class="op" id="8378228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378232">{</span><span class="string" id="8378233">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="8378270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378275">&#34;&#34;</span><span class="op" id="8378277">,</span>&nbsp;<span class="ident" id="8378279">m</span><span class="op" id="8378280">(</span><span class="op" id="8378281">)</span><span class="op" id="8378282">}</span><span class="op" id="8378283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378287">{</span><span class="string" id="8378288">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="8378315">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378320">&#34;&#34;</span><span class="op" id="8378322">,</span>&nbsp;<span class="ident" id="8378324">m</span><span class="op" id="8378325">(</span><span class="op" id="8378326">)</span><span class="op" id="8378327">}</span><span class="op" id="8378328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378332">{</span><span class="string" id="8378333">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="8378394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378399">&#34;attachment&#34;</span><span class="op" id="8378411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378416">m</span><span class="op" id="8378417">(</span><span class="string" id="8378418">&#34;creation-date&#34;</span><span class="op" id="8378433">,</span>&nbsp;<span class="string" id="8378435">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="8378468">)</span><span class="op" id="8378469">}</span><span class="op" id="8378470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378474">{</span><span class="string" id="8378475">`foobar`</span><span class="op" id="8378483">,</span>&nbsp;<span class="string" id="8378485">&#34;foobar&#34;</span><span class="op" id="8378493">,</span>&nbsp;<span class="ident" id="8378495">m</span><span class="op" id="8378496">(</span><span class="op" id="8378497">)</span><span class="op" id="8378498">}</span><span class="op" id="8378499">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378503">{</span><span class="string" id="8378504">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8378551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378556">&#34;attachment&#34;</span><span class="op" id="8378568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378573">m</span><span class="op" id="8378574">(</span><span class="string" id="8378575">&#34;filename&#34;</span><span class="op" id="8378585">,</span>&nbsp;<span class="string" id="8378587">&#34;foo-ä.html&#34;</span><span class="op" id="8378600">)</span><span class="op" id="8378601">}</span><span class="op" id="8378602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378606">{</span><span class="string" id="8378607">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="8378650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378655">&#34;attachment&#34;</span><span class="op" id="8378667">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378672">m</span><span class="op" id="8378673">(</span><span class="string" id="8378674">&#34;filename&#34;</span><span class="op" id="8378684">,</span>&nbsp;<span class="string" id="8378686">&#34;A-%41.html&#34;</span><span class="op" id="8378698">)</span><span class="op" id="8378699">}</span><span class="op" id="8378700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378704">{</span><span class="string" id="8378705">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="8378755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378760">&#34;attachment&#34;</span><span class="op" id="8378772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378777">m</span><span class="op" id="8378778">(</span><span class="string" id="8378779">&#34;filename&#34;</span><span class="op" id="8378789">,</span>&nbsp;<span class="string" id="8378791">&#34;foo.html&#34;</span><span class="op" id="8378801">)</span><span class="op" id="8378802">}</span><span class="op" id="8378803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378807">{</span><span class="string" id="8378808">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="8378871">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378876">&#34;attachment&#34;</span><span class="op" id="8378888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378893">m</span><span class="op" id="8378894">(</span><span class="string" id="8378895">&#34;filename&#34;</span><span class="op" id="8378905">,</span>&nbsp;<span class="string" id="8378907">&#34;foo-ä.html&#34;</span><span class="op" id="8378920">)</span><span class="op" id="8378921">}</span><span class="op" id="8378922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378926">{</span><span class="string" id="8378927">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="8378976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378981">&#34;attachment&#34;</span><span class="op" id="8378993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378998">m</span><span class="op" id="8378999">(</span><span class="string" id="8379000">&#34;filename&#34;</span><span class="op" id="8379010">,</span>&nbsp;<span class="string" id="8379012">&#34;foo&#34;</span><span class="op" id="8379017">)</span><span class="op" id="8379018">}</span><span class="op" id="8379019">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379023">{</span><span class="string" id="8379024">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8379072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379077">&#34;attachment&#34;</span><span class="op" id="8379089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379094">m</span><span class="op" id="8379095">(</span><span class="string" id="8379096">&#34;filename&#34;</span><span class="op" id="8379106">,</span>&nbsp;<span class="string" id="8379108">&#34;foo&#34;</span><span class="op" id="8379113">)</span><span class="op" id="8379114">}</span><span class="op" id="8379115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379119">{</span><span class="string" id="8379120">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8379168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379173">&#34;attachment&#34;</span><span class="op" id="8379185">,</span>&nbsp;<span class="ident" id="8379187">m</span><span class="op" id="8379188">(</span><span class="op" id="8379189">)</span><span class="op" id="8379190">}</span><span class="op" id="8379191">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379195">{</span><span class="string" id="8379196">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="8379244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379249">&#34;attachment&#34;</span><span class="op" id="8379261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379266">m</span><span class="op" id="8379267">(</span><span class="string" id="8379268">&#34;filename&#34;</span><span class="op" id="8379278">,</span>&nbsp;<span class="string" id="8379280">&#34;foobar&#34;</span><span class="op" id="8379288">)</span><span class="op" id="8379289">}</span><span class="op" id="8379290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379294">{</span><span class="string" id="8379295">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8379365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379370">&#34;attachment&#34;</span><span class="op" id="8379382">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379387">m</span><span class="op" id="8379388">(</span><span class="string" id="8379389">&#34;filename&#34;</span><span class="op" id="8379399">,</span>&nbsp;<span class="string" id="8379401">&#34;foo-ä.html&#34;</span><span class="op" id="8379414">)</span><span class="op" id="8379415">}</span><span class="op" id="8379416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379420">{</span><span class="string" id="8379421">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="8379491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379496">&#34;attachment&#34;</span><span class="op" id="8379508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379513">m</span><span class="op" id="8379514">(</span><span class="string" id="8379515">&#34;filename&#34;</span><span class="op" id="8379525">,</span>&nbsp;<span class="string" id="8379527">&#34;foo-ä.html&#34;</span><span class="op" id="8379540">)</span><span class="op" id="8379541">}</span><span class="op" id="8379542">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8379547">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8379609">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379666">{</span><span class="string" id="8379667">`form-data;&nbsp;firstname=&#34;Брэд&#34;;&nbsp;lastname=&#34;Фицпатрик&#34;`</span><span class="op" id="8379731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379736">&#34;form-data&#34;</span><span class="op" id="8379747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379752">m</span><span class="op" id="8379753">(</span><span class="string" id="8379754">&#34;firstname&#34;</span><span class="op" id="8379765">,</span>&nbsp;<span class="string" id="8379767">&#34;Брэд&#34;</span><span class="op" id="8379777">,</span>&nbsp;<span class="string" id="8379779">&#34;lastname&#34;</span><span class="op" id="8379789">,</span>&nbsp;<span class="string" id="8379791">&#34;Фицпатрик&#34;</span><span class="op" id="8379811">)</span><span class="op" id="8379812">}</span><span class="op" id="8379813">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8379819">for</span>&nbsp;<span class="ident" id="8379823">_</span><span class="op" id="8379824">,</span>&nbsp;<span class="ident" id="8379826">test</span>&nbsp;<span class="op" id="8379831">:=</span>&nbsp;<span class="keyword" id="8379834">range</span>&nbsp;<span class="ident" id="8379840">tests</span>&nbsp;<span class="op" id="8379846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379850">mt</span><span class="op" id="8379852">,</span>&nbsp;<span class="ident" id="8379854">params</span><span class="op" id="8379860">,</span>&nbsp;<span class="ident" id="8379862">err</span>&nbsp;<span class="op" id="8379866">:=</span>&nbsp;<span class="ident" id="8379869">ParseMediaType</span><span class="op" id="8379883">(</span><span class="ident" id="8379884">test</span><span class="op" id="8379888">.</span><span class="ident" id="8379889">in</span><span class="op" id="8379891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8379895">if</span>&nbsp;<span class="ident" id="8379898">err</span>&nbsp;<span class="op" id="8379902">!=</span>&nbsp;<span class="ident" id="8379905">nil</span>&nbsp;<span class="op" id="8379909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8379914">if</span>&nbsp;<span class="ident" id="8379917">test</span><span class="op" id="8379921">.</span><span class="ident" id="8379922">t</span>&nbsp;<span class="op" id="8379924">!=</span>&nbsp;<span class="string" id="8379927">&#34;&#34;</span>&nbsp;<span class="op" id="8379930">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379936">t</span><span class="op" id="8379937">.</span><span class="ident" id="8379938">Errorf</span><span class="op" id="8379944">(</span><span class="string" id="8379945">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8379981">,</span>&nbsp;<span class="ident" id="8379983">test</span><span class="op" id="8379987">.</span><span class="ident" id="8379988">in</span><span class="op" id="8379990">,</span>&nbsp;<span class="ident" id="8379992">err</span><span class="op" id="8379995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380001">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380018">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380029">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380033">if</span>&nbsp;<span class="ident" id="8380036">g</span><span class="op" id="8380037">,</span>&nbsp;<span class="ident" id="8380039">e</span>&nbsp;<span class="op" id="8380041">:=</span>&nbsp;<span class="ident" id="8380044">mt</span><span class="op" id="8380046">,</span>&nbsp;<span class="ident" id="8380048">test</span><span class="op" id="8380052">.</span><span class="ident" id="8380053">t</span><span class="op" id="8380054">;</span>&nbsp;<span class="ident" id="8380056">g</span>&nbsp;<span class="op" id="8380058">!=</span>&nbsp;<span class="ident" id="8380061">e</span>&nbsp;<span class="op" id="8380063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380068">t</span><span class="op" id="8380069">.</span><span class="ident" id="8380070">Errorf</span><span class="op" id="8380076">(</span><span class="string" id="8380077">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8380117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380123">test</span><span class="op" id="8380127">.</span><span class="ident" id="8380128">in</span><span class="op" id="8380130">,</span>&nbsp;<span class="ident" id="8380132">e</span><span class="op" id="8380133">,</span>&nbsp;<span class="ident" id="8380135">g</span><span class="op" id="8380136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380141">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380152">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380156">if</span>&nbsp;<span class="builtinfunc" id="8380159">len</span><span class="op" id="8380162">(</span><span class="ident" id="8380163">params</span><span class="op" id="8380169">)</span>&nbsp;<span class="op" id="8380171">==</span>&nbsp;<span class="num" id="8380174">0</span>&nbsp;<span class="op" id="8380176">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8380179">len</span><span class="op" id="8380182">(</span><span class="ident" id="8380183">test</span><span class="op" id="8380187">.</span><span class="ident" id="8380188">p</span><span class="op" id="8380189">)</span>&nbsp;<span class="op" id="8380191">==</span>&nbsp;<span class="num" id="8380194">0</span>&nbsp;<span class="op" id="8380196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380201">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380216">if</span>&nbsp;<span class="op" id="8380219">!</span><span class="ident" id="8380220">reflect</span><span class="op" id="8380227">.</span><span class="ident" id="8380228">DeepEqual</span><span class="op" id="8380237">(</span><span class="ident" id="8380238">params</span><span class="op" id="8380244">,</span>&nbsp;<span class="ident" id="8380246">test</span><span class="op" id="8380250">.</span><span class="ident" id="8380251">p</span><span class="op" id="8380252">)</span>&nbsp;<span class="op" id="8380254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380259">t</span><span class="op" id="8380260">.</span><span class="ident" id="8380261">Errorf</span><span class="op" id="8380267">(</span><span class="string" id="8380268">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="8380299">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8380305">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="8380322">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8380328">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="8380343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380349">test</span><span class="op" id="8380353">.</span><span class="ident" id="8380354">in</span><span class="op" id="8380356">,</span>&nbsp;<span class="ident" id="8380358">test</span><span class="op" id="8380362">.</span><span class="ident" id="8380363">p</span><span class="op" id="8380364">,</span>&nbsp;<span class="ident" id="8380366">params</span><span class="op" id="8380372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380379">}</span><br>
<span class="lineno">245</span><span class="op" id="8380381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8380384">type</span>&nbsp;<span class="ident" id="8380389">badMediaTypeTest</span>&nbsp;<span class="keyword" id="8380406">struct</span>&nbsp;<span class="op" id="8380413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380416">in</span>&nbsp;&nbsp;<span class="builtintype" id="8380420">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380428">err</span>&nbsp;<span class="builtintype" id="8380432">string</span><br>
<span class="lineno">250</span><span class="op" id="8380439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8380442">var</span>&nbsp;<span class="ident" id="8380446">badMediaTypeTests</span>&nbsp;<span class="op" id="8380464">=</span>&nbsp;<span class="op" id="8380466">[</span><span class="op" id="8380467">]</span><span class="ident" id="8380468">badMediaTypeTest</span><span class="op" id="8380484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380487">{</span><span class="string" id="8380488">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="8380506">,</span>&nbsp;<span class="string" id="8380508">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="8380539">}</span><span class="op" id="8380540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380543">{</span><span class="string" id="8380544">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8380574">,</span>&nbsp;<span class="string" id="8380576">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="8380610">}</span><span class="op" id="8380611">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380614">{</span><span class="string" id="8380615">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8380650">,</span>&nbsp;<span class="string" id="8380652">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="8380698">}</span><span class="op" id="8380699">,</span><br>
<span class="lineno"></span><span class="op" id="8380701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8380704">func</span>&nbsp;<span class="ident" id="8380709">TestParseMediaTypeBogus</span><span class="op" id="8380732">(</span><span class="ident" id="8380733">t</span>&nbsp;<span class="op" id="8380735">*</span><span class="ident" id="8380736">testing</span><span class="op" id="8380743">.</span><span class="ident" id="8380744">T</span><span class="op" id="8380745">)</span>&nbsp;<span class="op" id="8380747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380750">for</span>&nbsp;<span class="ident" id="8380754">_</span><span class="op" id="8380755">,</span>&nbsp;<span class="ident" id="8380757">tt</span>&nbsp;<span class="op" id="8380760">:=</span>&nbsp;<span class="keyword" id="8380763">range</span>&nbsp;<span class="ident" id="8380769">badMediaTypeTests</span>&nbsp;<span class="op" id="8380787">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380791">mt</span><span class="op" id="8380793">,</span>&nbsp;<span class="ident" id="8380795">params</span><span class="op" id="8380801">,</span>&nbsp;<span class="ident" id="8380803">err</span>&nbsp;<span class="op" id="8380807">:=</span>&nbsp;<span class="ident" id="8380810">ParseMediaType</span><span class="op" id="8380824">(</span><span class="ident" id="8380825">tt</span><span class="op" id="8380827">.</span><span class="ident" id="8380828">in</span><span class="op" id="8380830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380834">if</span>&nbsp;<span class="ident" id="8380837">err</span>&nbsp;<span class="op" id="8380841">==</span>&nbsp;<span class="ident" id="8380844">nil</span>&nbsp;<span class="op" id="8380848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380853">t</span><span class="op" id="8380854">.</span><span class="ident" id="8380855">Errorf</span><span class="op" id="8380861">(</span><span class="string" id="8380862">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="8380912">,</span>&nbsp;<span class="ident" id="8380914">tt</span><span class="op" id="8380916">.</span><span class="ident" id="8380917">in</span><span class="op" id="8380919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380924">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380935">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8380939">if</span>&nbsp;<span class="ident" id="8380942">err</span><span class="op" id="8380945">.</span><span class="ident" id="8380946">Error</span><span class="op" id="8380951">(</span><span class="op" id="8380952">)</span>&nbsp;<span class="op" id="8380954">!=</span>&nbsp;<span class="ident" id="8380957">tt</span><span class="op" id="8380959">.</span><span class="ident" id="8380960">err</span>&nbsp;<span class="op" id="8380964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380969">t</span><span class="op" id="8380970">.</span><span class="ident" id="8380971">Errorf</span><span class="op" id="8380977">(</span><span class="string" id="8380978">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8381016">,</span>&nbsp;<span class="ident" id="8381018">tt</span><span class="op" id="8381020">.</span><span class="ident" id="8381021">in</span><span class="op" id="8381023">,</span>&nbsp;<span class="ident" id="8381025">err</span><span class="op" id="8381028">.</span><span class="ident" id="8381029">Error</span><span class="op" id="8381034">(</span><span class="op" id="8381035">)</span><span class="op" id="8381036">,</span>&nbsp;<span class="ident" id="8381038">tt</span><span class="op" id="8381040">.</span><span class="ident" id="8381041">err</span><span class="op" id="8381044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8381052">if</span>&nbsp;<span class="ident" id="8381055">params</span>&nbsp;<span class="op" id="8381062">!=</span>&nbsp;<span class="ident" id="8381065">nil</span>&nbsp;<span class="op" id="8381069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381074">t</span><span class="op" id="8381075">.</span><span class="ident" id="8381076">Errorf</span><span class="op" id="8381082">(</span><span class="string" id="8381083">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="8381132">,</span>&nbsp;<span class="ident" id="8381134">tt</span><span class="op" id="8381136">.</span><span class="ident" id="8381137">in</span><span class="op" id="8381139">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8381147">if</span>&nbsp;<span class="ident" id="8381150">mt</span>&nbsp;<span class="op" id="8381153">!=</span>&nbsp;<span class="string" id="8381156">&#34;&#34;</span>&nbsp;<span class="op" id="8381159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381164">t</span><span class="op" id="8381165">.</span><span class="ident" id="8381166">Errorf</span><span class="op" id="8381172">(</span><span class="string" id="8381173">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="8381235">,</span>&nbsp;<span class="ident" id="8381237">tt</span><span class="op" id="8381239">.</span><span class="ident" id="8381240">in</span><span class="op" id="8381242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381249">}</span><br>
<span class="lineno">275</span><span class="op" id="8381251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8381254">type</span>&nbsp;<span class="ident" id="8381259">formatTest</span>&nbsp;<span class="keyword" id="8381270">struct</span>&nbsp;<span class="op" id="8381277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381280">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8381287">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381295">params</span>&nbsp;<span class="keyword" id="8381302">map</span><span class="op" id="8381305">[</span><span class="builtintype" id="8381306">string</span><span class="op" id="8381312">]</span><span class="builtintype" id="8381313">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381321">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8381328">string</span><br>
<span class="lineno"></span><span class="op" id="8381335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8381338">var</span>&nbsp;<span class="ident" id="8381342">formatTests</span>&nbsp;<span class="op" id="8381354">=</span>&nbsp;<span class="op" id="8381356">[</span><span class="op" id="8381357">]</span><span class="ident" id="8381358">formatTest</span><span class="op" id="8381368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381371">{</span><span class="string" id="8381372">&#34;noslash&#34;</span><span class="op" id="8381381">,</span>&nbsp;<span class="ident" id="8381383">nil</span><span class="op" id="8381386">,</span>&nbsp;<span class="string" id="8381388">&#34;&#34;</span><span class="op" id="8381390">}</span><span class="op" id="8381391">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381394">{</span><span class="string" id="8381395">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="8381408">,</span>&nbsp;<span class="ident" id="8381410">nil</span><span class="op" id="8381413">,</span>&nbsp;<span class="string" id="8381415">&#34;&#34;</span><span class="op" id="8381417">}</span><span class="op" id="8381418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381421">{</span><span class="string" id="8381422">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="8381435">,</span>&nbsp;<span class="ident" id="8381437">nil</span><span class="op" id="8381440">,</span>&nbsp;<span class="string" id="8381442">&#34;&#34;</span><span class="op" id="8381444">}</span><span class="op" id="8381445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381448">{</span><span class="string" id="8381449">&#34;foo/BAR&#34;</span><span class="op" id="8381458">,</span>&nbsp;<span class="ident" id="8381460">nil</span><span class="op" id="8381463">,</span>&nbsp;<span class="string" id="8381465">&#34;foo/bar&#34;</span><span class="op" id="8381474">}</span><span class="op" id="8381475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381478">{</span><span class="string" id="8381479">&#34;foo/BAR&#34;</span><span class="op" id="8381488">,</span>&nbsp;<span class="keyword" id="8381490">map</span><span class="op" id="8381493">[</span><span class="builtintype" id="8381494">string</span><span class="op" id="8381500">]</span><span class="builtintype" id="8381501">string</span><span class="op" id="8381507">{</span><span class="string" id="8381508">&#34;X&#34;</span><span class="op" id="8381511">:</span>&nbsp;<span class="string" id="8381513">&#34;Y&#34;</span><span class="op" id="8381516">}</span><span class="op" id="8381517">,</span>&nbsp;<span class="string" id="8381519">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="8381533">}</span><span class="op" id="8381534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381537">{</span><span class="string" id="8381538">&#34;foo/BAR&#34;</span><span class="op" id="8381547">,</span>&nbsp;<span class="keyword" id="8381549">map</span><span class="op" id="8381552">[</span><span class="builtintype" id="8381553">string</span><span class="op" id="8381559">]</span><span class="builtintype" id="8381560">string</span><span class="op" id="8381566">{</span><span class="string" id="8381567">&#34;space&#34;</span><span class="op" id="8381574">:</span>&nbsp;<span class="string" id="8381576">&#34;With&nbsp;space&#34;</span><span class="op" id="8381588">}</span><span class="op" id="8381589">,</span>&nbsp;<span class="string" id="8381591">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="8381620">}</span><span class="op" id="8381621">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381624">{</span><span class="string" id="8381625">&#34;foo/BAR&#34;</span><span class="op" id="8381634">,</span>&nbsp;<span class="keyword" id="8381636">map</span><span class="op" id="8381639">[</span><span class="builtintype" id="8381640">string</span><span class="op" id="8381646">]</span><span class="builtintype" id="8381647">string</span><span class="op" id="8381653">{</span><span class="string" id="8381654">&#34;quote&#34;</span><span class="op" id="8381661">:</span>&nbsp;<span class="string" id="8381663">`With&nbsp;&#34;quote`</span><span class="op" id="8381676">}</span><span class="op" id="8381677">,</span>&nbsp;<span class="string" id="8381679">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="8381710">}</span><span class="op" id="8381711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381714">{</span><span class="string" id="8381715">&#34;foo/BAR&#34;</span><span class="op" id="8381724">,</span>&nbsp;<span class="keyword" id="8381726">map</span><span class="op" id="8381729">[</span><span class="builtintype" id="8381730">string</span><span class="op" id="8381736">]</span><span class="builtintype" id="8381737">string</span><span class="op" id="8381743">{</span><span class="string" id="8381744">&#34;bslash&#34;</span><span class="op" id="8381752">:</span>&nbsp;<span class="string" id="8381754">`With&nbsp;\backslash`</span><span class="op" id="8381771">}</span><span class="op" id="8381772">,</span>&nbsp;<span class="string" id="8381774">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="8381810">}</span><span class="op" id="8381811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381814">{</span><span class="string" id="8381815">&#34;foo/BAR&#34;</span><span class="op" id="8381824">,</span>&nbsp;<span class="keyword" id="8381826">map</span><span class="op" id="8381829">[</span><span class="builtintype" id="8381830">string</span><span class="op" id="8381836">]</span><span class="builtintype" id="8381837">string</span><span class="op" id="8381843">{</span><span class="string" id="8381844">&#34;both&#34;</span><span class="op" id="8381850">:</span>&nbsp;<span class="string" id="8381852">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="8381880">}</span><span class="op" id="8381881">,</span>&nbsp;<span class="string" id="8381883">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="8381929">}</span><span class="op" id="8381930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381933">{</span><span class="string" id="8381934">&#34;foo/BAR&#34;</span><span class="op" id="8381943">,</span>&nbsp;<span class="keyword" id="8381945">map</span><span class="op" id="8381948">[</span><span class="builtintype" id="8381949">string</span><span class="op" id="8381955">]</span><span class="builtintype" id="8381956">string</span><span class="op" id="8381962">{</span><span class="string" id="8381963">&#34;&#34;</span><span class="op" id="8381965">:</span>&nbsp;<span class="string" id="8381967">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="8381984">}</span><span class="op" id="8381985">,</span>&nbsp;<span class="string" id="8381987">&#34;&#34;</span><span class="op" id="8381989">}</span><span class="op" id="8381990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381993">{</span><span class="string" id="8381994">&#34;foo/BAR&#34;</span><span class="op" id="8382003">,</span>&nbsp;<span class="keyword" id="8382005">map</span><span class="op" id="8382008">[</span><span class="builtintype" id="8382009">string</span><span class="op" id="8382015">]</span><span class="builtintype" id="8382016">string</span><span class="op" id="8382022">{</span><span class="string" id="8382023">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="8382038">:</span>&nbsp;<span class="string" id="8382040">&#34;baz&#34;</span><span class="op" id="8382045">}</span><span class="op" id="8382046">,</span>&nbsp;<span class="string" id="8382048">&#34;&#34;</span><span class="op" id="8382050">}</span><span class="op" id="8382051">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382054">{</span><span class="string" id="8382055">&#34;foo/BAR&#34;</span><span class="op" id="8382064">,</span>&nbsp;<span class="keyword" id="8382066">map</span><span class="op" id="8382069">[</span><span class="builtintype" id="8382070">string</span><span class="op" id="8382076">]</span><span class="builtintype" id="8382077">string</span><span class="op" id="8382083">{</span><span class="string" id="8382084">&#34;nonascii&#34;</span><span class="op" id="8382094">:</span>&nbsp;<span class="string" id="8382096">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;ä&#34;</span><span class="op" id="8382124">}</span><span class="op" id="8382125">,</span>&nbsp;<span class="string" id="8382127">&#34;&#34;</span><span class="op" id="8382129">}</span><span class="op" id="8382130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382133">{</span><span class="string" id="8382134">&#34;foo/bar&#34;</span><span class="op" id="8382143">,</span>&nbsp;<span class="keyword" id="8382145">map</span><span class="op" id="8382148">[</span><span class="builtintype" id="8382149">string</span><span class="op" id="8382155">]</span><span class="builtintype" id="8382156">string</span><span class="op" id="8382162">{</span><span class="string" id="8382163">&#34;a&#34;</span><span class="op" id="8382166">:</span>&nbsp;<span class="string" id="8382168">&#34;av&#34;</span><span class="op" id="8382172">,</span>&nbsp;<span class="string" id="8382174">&#34;b&#34;</span><span class="op" id="8382177">:</span>&nbsp;<span class="string" id="8382179">&#34;bv&#34;</span><span class="op" id="8382183">,</span>&nbsp;<span class="string" id="8382185">&#34;c&#34;</span><span class="op" id="8382188">:</span>&nbsp;<span class="string" id="8382190">&#34;cv&#34;</span><span class="op" id="8382194">}</span><span class="op" id="8382195">,</span>&nbsp;<span class="string" id="8382197">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="8382224">}</span><span class="op" id="8382225">,</span><br>
<span class="lineno"></span><span class="op" id="8382227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8382230">func</span>&nbsp;<span class="ident" id="8382235">TestFormatMediaType</span><span class="op" id="8382254">(</span><span class="ident" id="8382255">t</span>&nbsp;<span class="op" id="8382257">*</span><span class="ident" id="8382258">testing</span><span class="op" id="8382265">.</span><span class="ident" id="8382266">T</span><span class="op" id="8382267">)</span>&nbsp;<span class="op" id="8382269">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382272">for</span>&nbsp;<span class="ident" id="8382276">i</span><span class="op" id="8382277">,</span>&nbsp;<span class="ident" id="8382279">tt</span>&nbsp;<span class="op" id="8382282">:=</span>&nbsp;<span class="keyword" id="8382285">range</span>&nbsp;<span class="ident" id="8382291">formatTests</span>&nbsp;<span class="op" id="8382303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382307">got</span>&nbsp;<span class="op" id="8382311">:=</span>&nbsp;<span class="ident" id="8382314">FormatMediaType</span><span class="op" id="8382329">(</span><span class="ident" id="8382330">tt</span><span class="op" id="8382332">.</span><span class="ident" id="8382333">typ</span><span class="op" id="8382336">,</span>&nbsp;<span class="ident" id="8382338">tt</span><span class="op" id="8382340">.</span><span class="ident" id="8382341">params</span><span class="op" id="8382347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382351">if</span>&nbsp;<span class="ident" id="8382354">got</span>&nbsp;<span class="op" id="8382358">!=</span>&nbsp;<span class="ident" id="8382361">tt</span><span class="op" id="8382363">.</span><span class="ident" id="8382364">want</span>&nbsp;<span class="op" id="8382369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382374">t</span><span class="op" id="8382375">.</span><span class="ident" id="8382376">Errorf</span><span class="op" id="8382382">(</span><span class="string" id="8382383">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8382426">,</span>&nbsp;<span class="ident" id="8382428">i</span><span class="op" id="8382429">,</span>&nbsp;<span class="ident" id="8382431">tt</span><span class="op" id="8382433">.</span><span class="ident" id="8382434">typ</span><span class="op" id="8382437">,</span>&nbsp;<span class="ident" id="8382439">tt</span><span class="op" id="8382441">.</span><span class="ident" id="8382442">params</span><span class="op" id="8382448">,</span>&nbsp;<span class="ident" id="8382450">got</span><span class="op" id="8382453">,</span>&nbsp;<span class="ident" id="8382455">tt</span><span class="op" id="8382457">.</span><span class="ident" id="8382458">want</span><span class="op" id="8382462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382466">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382469">}</span><br>
<span class="lineno"></span><span class="op" id="8382471">}</span>
</div>
</body>
</html>
