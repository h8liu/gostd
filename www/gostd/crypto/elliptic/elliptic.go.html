<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html" class="current">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4547081">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4547136">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4547190">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4547241">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4547316">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4547327">package</span>&nbsp;<span class="ident" id="4547335">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4547345">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4547420">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4547495">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4547575">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4547650">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4547724">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4547789">import</span>&nbsp;<span class="op" id="4547796">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4547799">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4547805">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4547817">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4547824">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4547827">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4547891">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4547952">type</span>&nbsp;<span class="ident" id="4547957">Curve</span>&nbsp;<span class="keyword" id="4547963">interface</span>&nbsp;<span class="op" id="4547973">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4547976">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548025">Params</span><span class="op" id="4548031">(</span><span class="op" id="4548032">)</span>&nbsp;<span class="op" id="4548034">*</span><span class="ident" id="4548035">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548048">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548113">IsOnCurve</span><span class="op" id="4548122">(</span><span class="ident" id="4548123">x</span><span class="op" id="4548124">,</span>&nbsp;<span class="ident" id="4548126">y</span>&nbsp;<span class="op" id="4548128">*</span><span class="ident" id="4548129">big</span><span class="op" id="4548132">.</span><span class="ident" id="4548133">Int</span><span class="op" id="4548136">)</span>&nbsp;<span class="builtintype" id="4548138">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548144">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548191">Add</span><span class="op" id="4548194">(</span><span class="ident" id="4548195">x1</span><span class="op" id="4548197">,</span>&nbsp;<span class="ident" id="4548199">y1</span><span class="op" id="4548201">,</span>&nbsp;<span class="ident" id="4548203">x2</span><span class="op" id="4548205">,</span>&nbsp;<span class="ident" id="4548207">y2</span>&nbsp;<span class="op" id="4548210">*</span><span class="ident" id="4548211">big</span><span class="op" id="4548214">.</span><span class="ident" id="4548215">Int</span><span class="op" id="4548218">)</span>&nbsp;<span class="op" id="4548220">(</span><span class="ident" id="4548221">x</span><span class="op" id="4548222">,</span>&nbsp;<span class="ident" id="4548224">y</span>&nbsp;<span class="op" id="4548226">*</span><span class="ident" id="4548227">big</span><span class="op" id="4548230">.</span><span class="ident" id="4548231">Int</span><span class="op" id="4548234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548237">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548264">Double</span><span class="op" id="4548270">(</span><span class="ident" id="4548271">x1</span><span class="op" id="4548273">,</span>&nbsp;<span class="ident" id="4548275">y1</span>&nbsp;<span class="op" id="4548278">*</span><span class="ident" id="4548279">big</span><span class="op" id="4548282">.</span><span class="ident" id="4548283">Int</span><span class="op" id="4548286">)</span>&nbsp;<span class="op" id="4548288">(</span><span class="ident" id="4548289">x</span><span class="op" id="4548290">,</span>&nbsp;<span class="ident" id="4548292">y</span>&nbsp;<span class="op" id="4548294">*</span><span class="ident" id="4548295">big</span><span class="op" id="4548298">.</span><span class="ident" id="4548299">Int</span><span class="op" id="4548302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548305">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548378">ScalarMult</span><span class="op" id="4548388">(</span><span class="ident" id="4548389">x1</span><span class="op" id="4548391">,</span>&nbsp;<span class="ident" id="4548393">y1</span>&nbsp;<span class="op" id="4548396">*</span><span class="ident" id="4548397">big</span><span class="op" id="4548400">.</span><span class="ident" id="4548401">Int</span><span class="op" id="4548404">,</span>&nbsp;<span class="ident" id="4548406">k</span>&nbsp;<span class="op" id="4548408">[</span><span class="op" id="4548409">]</span><span class="builtintype" id="4548410">byte</span><span class="op" id="4548414">)</span>&nbsp;<span class="op" id="4548416">(</span><span class="ident" id="4548417">x</span><span class="op" id="4548418">,</span>&nbsp;<span class="ident" id="4548420">y</span>&nbsp;<span class="op" id="4548422">*</span><span class="ident" id="4548423">big</span><span class="op" id="4548426">.</span><span class="ident" id="4548427">Int</span><span class="op" id="4548430">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548433">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548504">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548548">ScalarBaseMult</span><span class="op" id="4548562">(</span><span class="ident" id="4548563">k</span>&nbsp;<span class="op" id="4548565">[</span><span class="op" id="4548566">]</span><span class="builtintype" id="4548567">byte</span><span class="op" id="4548571">)</span>&nbsp;<span class="op" id="4548573">(</span><span class="ident" id="4548574">x</span><span class="op" id="4548575">,</span>&nbsp;<span class="ident" id="4548577">y</span>&nbsp;<span class="op" id="4548579">*</span><span class="ident" id="4548580">big</span><span class="op" id="4548583">.</span><span class="ident" id="4548584">Int</span><span class="op" id="4548587">)</span><br>
<span class="lineno"></span><span class="op" id="4548589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4548592">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4548670">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4548727">type</span>&nbsp;<span class="ident" id="4548732">CurveParams</span>&nbsp;<span class="keyword" id="4548744">struct</span>&nbsp;<span class="op" id="4548751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548754">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4548762">*</span><span class="ident" id="4548763">big</span><span class="op" id="4548766">.</span><span class="ident" id="4548767">Int</span>&nbsp;<span class="comment" id="4548771">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548809">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4548817">*</span><span class="ident" id="4548818">big</span><span class="op" id="4548821">.</span><span class="ident" id="4548822">Int</span>&nbsp;<span class="comment" id="4548826">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548858">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4548866">*</span><span class="ident" id="4548867">big</span><span class="op" id="4548870">.</span><span class="ident" id="4548871">Int</span>&nbsp;<span class="comment" id="4548875">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548914">Gx</span><span class="op" id="4548916">,</span>&nbsp;<span class="ident" id="4548918">Gy</span>&nbsp;&nbsp;<span class="op" id="4548922">*</span><span class="ident" id="4548923">big</span><span class="op" id="4548926">.</span><span class="ident" id="4548927">Int</span>&nbsp;<span class="comment" id="4548931">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4548959">BitSize</span>&nbsp;<span class="builtintype" id="4548967">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4548976">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4549012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4549015">func</span>&nbsp;<span class="op" id="4549020">(</span><span class="ident" id="4549021">curve</span>&nbsp;<span class="op" id="4549027">*</span><span class="ident" id="4549028">CurveParams</span><span class="op" id="4549039">)</span>&nbsp;<span class="ident" id="4549041">Params</span><span class="op" id="4549047">(</span><span class="op" id="4549048">)</span>&nbsp;<span class="op" id="4549050">*</span><span class="ident" id="4549051">CurveParams</span>&nbsp;<span class="op" id="4549063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549066">return</span>&nbsp;<span class="ident" id="4549073">curve</span><br>
<span class="lineno"></span><span class="op" id="4549079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4549082">func</span>&nbsp;<span class="op" id="4549087">(</span><span class="ident" id="4549088">curve</span>&nbsp;<span class="op" id="4549094">*</span><span class="ident" id="4549095">CurveParams</span><span class="op" id="4549106">)</span>&nbsp;<span class="ident" id="4549108">IsOnCurve</span><span class="op" id="4549117">(</span><span class="ident" id="4549118">x</span><span class="op" id="4549119">,</span>&nbsp;<span class="ident" id="4549121">y</span>&nbsp;<span class="op" id="4549123">*</span><span class="ident" id="4549124">big</span><span class="op" id="4549127">.</span><span class="ident" id="4549128">Int</span><span class="op" id="4549131">)</span>&nbsp;<span class="builtintype" id="4549133">bool</span>&nbsp;<span class="op" id="4549138">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4549141">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549164">y2</span>&nbsp;<span class="op" id="4549167">:=</span>&nbsp;<span class="builtinfunc" id="4549170">new</span><span class="op" id="4549173">(</span><span class="ident" id="4549174">big</span><span class="op" id="4549177">.</span><span class="ident" id="4549178">Int</span><span class="op" id="4549181">)</span><span class="op" id="4549182">.</span><span class="ident" id="4549183">Mul</span><span class="op" id="4549186">(</span><span class="ident" id="4549187">y</span><span class="op" id="4549188">,</span>&nbsp;<span class="ident" id="4549190">y</span><span class="op" id="4549191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549194">y2</span><span class="op" id="4549196">.</span><span class="ident" id="4549197">Mod</span><span class="op" id="4549200">(</span><span class="ident" id="4549201">y2</span><span class="op" id="4549203">,</span>&nbsp;<span class="ident" id="4549205">curve</span><span class="op" id="4549210">.</span><span class="ident" id="4549211">P</span><span class="op" id="4549212">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549216">x3</span>&nbsp;<span class="op" id="4549219">:=</span>&nbsp;<span class="builtinfunc" id="4549222">new</span><span class="op" id="4549225">(</span><span class="ident" id="4549226">big</span><span class="op" id="4549229">.</span><span class="ident" id="4549230">Int</span><span class="op" id="4549233">)</span><span class="op" id="4549234">.</span><span class="ident" id="4549235">Mul</span><span class="op" id="4549238">(</span><span class="ident" id="4549239">x</span><span class="op" id="4549240">,</span>&nbsp;<span class="ident" id="4549242">x</span><span class="op" id="4549243">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549246">x3</span><span class="op" id="4549248">.</span><span class="ident" id="4549249">Mul</span><span class="op" id="4549252">(</span><span class="ident" id="4549253">x3</span><span class="op" id="4549255">,</span>&nbsp;<span class="ident" id="4549257">x</span><span class="op" id="4549258">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549262">threeX</span>&nbsp;<span class="op" id="4549269">:=</span>&nbsp;<span class="builtinfunc" id="4549272">new</span><span class="op" id="4549275">(</span><span class="ident" id="4549276">big</span><span class="op" id="4549279">.</span><span class="ident" id="4549280">Int</span><span class="op" id="4549283">)</span><span class="op" id="4549284">.</span><span class="ident" id="4549285">Lsh</span><span class="op" id="4549288">(</span><span class="ident" id="4549289">x</span><span class="op" id="4549290">,</span>&nbsp;<span class="num" id="4549292">1</span><span class="op" id="4549293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549296">threeX</span><span class="op" id="4549302">.</span><span class="ident" id="4549303">Add</span><span class="op" id="4549306">(</span><span class="ident" id="4549307">threeX</span><span class="op" id="4549313">,</span>&nbsp;<span class="ident" id="4549315">x</span><span class="op" id="4549316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549320">x3</span><span class="op" id="4549322">.</span><span class="ident" id="4549323">Sub</span><span class="op" id="4549326">(</span><span class="ident" id="4549327">x3</span><span class="op" id="4549329">,</span>&nbsp;<span class="ident" id="4549331">threeX</span><span class="op" id="4549337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549340">x3</span><span class="op" id="4549342">.</span><span class="ident" id="4549343">Add</span><span class="op" id="4549346">(</span><span class="ident" id="4549347">x3</span><span class="op" id="4549349">,</span>&nbsp;<span class="ident" id="4549351">curve</span><span class="op" id="4549356">.</span><span class="ident" id="4549357">B</span><span class="op" id="4549358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549361">x3</span><span class="op" id="4549363">.</span><span class="ident" id="4549364">Mod</span><span class="op" id="4549367">(</span><span class="ident" id="4549368">x3</span><span class="op" id="4549370">,</span>&nbsp;<span class="ident" id="4549372">curve</span><span class="op" id="4549377">.</span><span class="ident" id="4549378">P</span><span class="op" id="4549379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549383">return</span>&nbsp;<span class="ident" id="4549390">x3</span><span class="op" id="4549392">.</span><span class="ident" id="4549393">Cmp</span><span class="op" id="4549396">(</span><span class="ident" id="4549397">y2</span><span class="op" id="4549399">)</span>&nbsp;<span class="op" id="4549401">==</span>&nbsp;<span class="num" id="4549404">0</span><br>
<span class="lineno">70</span><span class="op" id="4549406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4549409">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4549488">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4549568">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4549620">func</span>&nbsp;<span class="ident" id="4549625">zForAffine</span><span class="op" id="4549635">(</span><span class="ident" id="4549636">x</span><span class="op" id="4549637">,</span>&nbsp;<span class="ident" id="4549639">y</span>&nbsp;<span class="op" id="4549641">*</span><span class="ident" id="4549642">big</span><span class="op" id="4549645">.</span><span class="ident" id="4549646">Int</span><span class="op" id="4549649">)</span>&nbsp;<span class="op" id="4549651">*</span><span class="ident" id="4549652">big</span><span class="op" id="4549655">.</span><span class="ident" id="4549656">Int</span>&nbsp;<span class="op" id="4549660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549663">z</span>&nbsp;<span class="op" id="4549665">:=</span>&nbsp;<span class="builtinfunc" id="4549668">new</span><span class="op" id="4549671">(</span><span class="ident" id="4549672">big</span><span class="op" id="4549675">.</span><span class="ident" id="4549676">Int</span><span class="op" id="4549679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549682">if</span>&nbsp;<span class="ident" id="4549685">x</span><span class="op" id="4549686">.</span><span class="ident" id="4549687">Sign</span><span class="op" id="4549691">(</span><span class="op" id="4549692">)</span>&nbsp;<span class="op" id="4549694">!=</span>&nbsp;<span class="num" id="4549697">0</span>&nbsp;<span class="op" id="4549699">||</span>&nbsp;<span class="ident" id="4549702">y</span><span class="op" id="4549703">.</span><span class="ident" id="4549704">Sign</span><span class="op" id="4549708">(</span><span class="op" id="4549709">)</span>&nbsp;<span class="op" id="4549711">!=</span>&nbsp;<span class="num" id="4549714">0</span>&nbsp;<span class="op" id="4549716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4549720">z</span><span class="op" id="4549721">.</span><span class="ident" id="4549722">SetInt64</span><span class="op" id="4549730">(</span><span class="num" id="4549731">1</span><span class="op" id="4549732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4549735">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549738">return</span>&nbsp;<span class="ident" id="4549745">z</span><br>
<span class="lineno"></span><span class="op" id="4549747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4549750">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4549828">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4549885">func</span>&nbsp;<span class="op" id="4549890">(</span><span class="ident" id="4549891">curve</span>&nbsp;<span class="op" id="4549897">*</span><span class="ident" id="4549898">CurveParams</span><span class="op" id="4549909">)</span>&nbsp;<span class="ident" id="4549911">affineFromJacobian</span><span class="op" id="4549929">(</span><span class="ident" id="4549930">x</span><span class="op" id="4549931">,</span>&nbsp;<span class="ident" id="4549933">y</span><span class="op" id="4549934">,</span>&nbsp;<span class="ident" id="4549936">z</span>&nbsp;<span class="op" id="4549938">*</span><span class="ident" id="4549939">big</span><span class="op" id="4549942">.</span><span class="ident" id="4549943">Int</span><span class="op" id="4549946">)</span>&nbsp;<span class="op" id="4549948">(</span><span class="ident" id="4549949">xOut</span><span class="op" id="4549953">,</span>&nbsp;<span class="ident" id="4549955">yOut</span>&nbsp;<span class="op" id="4549960">*</span><span class="ident" id="4549961">big</span><span class="op" id="4549964">.</span><span class="ident" id="4549965">Int</span><span class="op" id="4549968">)</span>&nbsp;<span class="op" id="4549970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549973">if</span>&nbsp;<span class="ident" id="4549976">z</span><span class="op" id="4549977">.</span><span class="ident" id="4549978">Sign</span><span class="op" id="4549982">(</span><span class="op" id="4549983">)</span>&nbsp;<span class="op" id="4549985">==</span>&nbsp;<span class="num" id="4549988">0</span>&nbsp;<span class="op" id="4549990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4549994">return</span>&nbsp;<span class="builtinfunc" id="4550001">new</span><span class="op" id="4550004">(</span><span class="ident" id="4550005">big</span><span class="op" id="4550008">.</span><span class="ident" id="4550009">Int</span><span class="op" id="4550012">)</span><span class="op" id="4550013">,</span>&nbsp;<span class="builtinfunc" id="4550015">new</span><span class="op" id="4550018">(</span><span class="ident" id="4550019">big</span><span class="op" id="4550022">.</span><span class="ident" id="4550023">Int</span><span class="op" id="4550026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550033">zinv</span>&nbsp;<span class="op" id="4550038">:=</span>&nbsp;<span class="builtinfunc" id="4550041">new</span><span class="op" id="4550044">(</span><span class="ident" id="4550045">big</span><span class="op" id="4550048">.</span><span class="ident" id="4550049">Int</span><span class="op" id="4550052">)</span><span class="op" id="4550053">.</span><span class="ident" id="4550054">ModInverse</span><span class="op" id="4550064">(</span><span class="ident" id="4550065">z</span><span class="op" id="4550066">,</span>&nbsp;<span class="ident" id="4550068">curve</span><span class="op" id="4550073">.</span><span class="ident" id="4550074">P</span><span class="op" id="4550075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550078">zinvsq</span>&nbsp;<span class="op" id="4550085">:=</span>&nbsp;<span class="builtinfunc" id="4550088">new</span><span class="op" id="4550091">(</span><span class="ident" id="4550092">big</span><span class="op" id="4550095">.</span><span class="ident" id="4550096">Int</span><span class="op" id="4550099">)</span><span class="op" id="4550100">.</span><span class="ident" id="4550101">Mul</span><span class="op" id="4550104">(</span><span class="ident" id="4550105">zinv</span><span class="op" id="4550109">,</span>&nbsp;<span class="ident" id="4550111">zinv</span><span class="op" id="4550115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550119">xOut</span>&nbsp;<span class="op" id="4550124">=</span>&nbsp;<span class="builtinfunc" id="4550126">new</span><span class="op" id="4550129">(</span><span class="ident" id="4550130">big</span><span class="op" id="4550133">.</span><span class="ident" id="4550134">Int</span><span class="op" id="4550137">)</span><span class="op" id="4550138">.</span><span class="ident" id="4550139">Mul</span><span class="op" id="4550142">(</span><span class="ident" id="4550143">x</span><span class="op" id="4550144">,</span>&nbsp;<span class="ident" id="4550146">zinvsq</span><span class="op" id="4550152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550155">xOut</span><span class="op" id="4550159">.</span><span class="ident" id="4550160">Mod</span><span class="op" id="4550163">(</span><span class="ident" id="4550164">xOut</span><span class="op" id="4550168">,</span>&nbsp;<span class="ident" id="4550170">curve</span><span class="op" id="4550175">.</span><span class="ident" id="4550176">P</span><span class="op" id="4550177">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550180">zinvsq</span><span class="op" id="4550186">.</span><span class="ident" id="4550187">Mul</span><span class="op" id="4550190">(</span><span class="ident" id="4550191">zinvsq</span><span class="op" id="4550197">,</span>&nbsp;<span class="ident" id="4550199">zinv</span><span class="op" id="4550203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550206">yOut</span>&nbsp;<span class="op" id="4550211">=</span>&nbsp;<span class="builtinfunc" id="4550213">new</span><span class="op" id="4550216">(</span><span class="ident" id="4550217">big</span><span class="op" id="4550220">.</span><span class="ident" id="4550221">Int</span><span class="op" id="4550224">)</span><span class="op" id="4550225">.</span><span class="ident" id="4550226">Mul</span><span class="op" id="4550229">(</span><span class="ident" id="4550230">y</span><span class="op" id="4550231">,</span>&nbsp;<span class="ident" id="4550233">zinvsq</span><span class="op" id="4550239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550242">yOut</span><span class="op" id="4550246">.</span><span class="ident" id="4550247">Mod</span><span class="op" id="4550250">(</span><span class="ident" id="4550251">yOut</span><span class="op" id="4550255">,</span>&nbsp;<span class="ident" id="4550257">curve</span><span class="op" id="4550262">.</span><span class="ident" id="4550263">P</span><span class="op" id="4550264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550267">return</span><br>
<span class="lineno"></span><span class="op" id="4550274">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4550277">func</span>&nbsp;<span class="op" id="4550282">(</span><span class="ident" id="4550283">curve</span>&nbsp;<span class="op" id="4550289">*</span><span class="ident" id="4550290">CurveParams</span><span class="op" id="4550301">)</span>&nbsp;<span class="ident" id="4550303">Add</span><span class="op" id="4550306">(</span><span class="ident" id="4550307">x1</span><span class="op" id="4550309">,</span>&nbsp;<span class="ident" id="4550311">y1</span><span class="op" id="4550313">,</span>&nbsp;<span class="ident" id="4550315">x2</span><span class="op" id="4550317">,</span>&nbsp;<span class="ident" id="4550319">y2</span>&nbsp;<span class="op" id="4550322">*</span><span class="ident" id="4550323">big</span><span class="op" id="4550326">.</span><span class="ident" id="4550327">Int</span><span class="op" id="4550330">)</span>&nbsp;<span class="op" id="4550332">(</span><span class="op" id="4550333">*</span><span class="ident" id="4550334">big</span><span class="op" id="4550337">.</span><span class="ident" id="4550338">Int</span><span class="op" id="4550341">,</span>&nbsp;<span class="op" id="4550343">*</span><span class="ident" id="4550344">big</span><span class="op" id="4550347">.</span><span class="ident" id="4550348">Int</span><span class="op" id="4550351">)</span>&nbsp;<span class="op" id="4550353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550356">z1</span>&nbsp;<span class="op" id="4550359">:=</span>&nbsp;<span class="ident" id="4550362">zForAffine</span><span class="op" id="4550372">(</span><span class="ident" id="4550373">x1</span><span class="op" id="4550375">,</span>&nbsp;<span class="ident" id="4550377">y1</span><span class="op" id="4550379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550382">z2</span>&nbsp;<span class="op" id="4550385">:=</span>&nbsp;<span class="ident" id="4550388">zForAffine</span><span class="op" id="4550398">(</span><span class="ident" id="4550399">x2</span><span class="op" id="4550401">,</span>&nbsp;<span class="ident" id="4550403">y2</span><span class="op" id="4550405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550408">return</span>&nbsp;<span class="ident" id="4550415">curve</span><span class="op" id="4550420">.</span><span class="ident" id="4550421">affineFromJacobian</span><span class="op" id="4550439">(</span><span class="ident" id="4550440">curve</span><span class="op" id="4550445">.</span><span class="ident" id="4550446">addJacobian</span><span class="op" id="4550457">(</span><span class="ident" id="4550458">x1</span><span class="op" id="4550460">,</span>&nbsp;<span class="ident" id="4550462">y1</span><span class="op" id="4550464">,</span>&nbsp;<span class="ident" id="4550466">z1</span><span class="op" id="4550468">,</span>&nbsp;<span class="ident" id="4550470">x2</span><span class="op" id="4550472">,</span>&nbsp;<span class="ident" id="4550474">y2</span><span class="op" id="4550476">,</span>&nbsp;<span class="ident" id="4550478">z2</span><span class="op" id="4550480">)</span><span class="op" id="4550481">)</span><br>
<span class="lineno">105</span><span class="op" id="4550483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4550486">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4550560">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4550622">func</span>&nbsp;<span class="op" id="4550627">(</span><span class="ident" id="4550628">curve</span>&nbsp;<span class="op" id="4550634">*</span><span class="ident" id="4550635">CurveParams</span><span class="op" id="4550646">)</span>&nbsp;<span class="ident" id="4550648">addJacobian</span><span class="op" id="4550659">(</span><span class="ident" id="4550660">x1</span><span class="op" id="4550662">,</span>&nbsp;<span class="ident" id="4550664">y1</span><span class="op" id="4550666">,</span>&nbsp;<span class="ident" id="4550668">z1</span><span class="op" id="4550670">,</span>&nbsp;<span class="ident" id="4550672">x2</span><span class="op" id="4550674">,</span>&nbsp;<span class="ident" id="4550676">y2</span><span class="op" id="4550678">,</span>&nbsp;<span class="ident" id="4550680">z2</span>&nbsp;<span class="op" id="4550683">*</span><span class="ident" id="4550684">big</span><span class="op" id="4550687">.</span><span class="ident" id="4550688">Int</span><span class="op" id="4550691">)</span>&nbsp;<span class="op" id="4550693">(</span><span class="op" id="4550694">*</span><span class="ident" id="4550695">big</span><span class="op" id="4550698">.</span><span class="ident" id="4550699">Int</span><span class="op" id="4550702">,</span>&nbsp;<span class="op" id="4550704">*</span><span class="ident" id="4550705">big</span><span class="op" id="4550708">.</span><span class="ident" id="4550709">Int</span><span class="op" id="4550712">,</span>&nbsp;<span class="op" id="4550714">*</span><span class="ident" id="4550715">big</span><span class="op" id="4550718">.</span><span class="ident" id="4550719">Int</span><span class="op" id="4550722">)</span>&nbsp;<span class="op" id="4550724">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4550727">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550817">x3</span><span class="op" id="4550819">,</span>&nbsp;<span class="ident" id="4550821">y3</span><span class="op" id="4550823">,</span>&nbsp;<span class="ident" id="4550825">z3</span>&nbsp;<span class="op" id="4550828">:=</span>&nbsp;<span class="builtinfunc" id="4550831">new</span><span class="op" id="4550834">(</span><span class="ident" id="4550835">big</span><span class="op" id="4550838">.</span><span class="ident" id="4550839">Int</span><span class="op" id="4550842">)</span><span class="op" id="4550843">,</span>&nbsp;<span class="builtinfunc" id="4550845">new</span><span class="op" id="4550848">(</span><span class="ident" id="4550849">big</span><span class="op" id="4550852">.</span><span class="ident" id="4550853">Int</span><span class="op" id="4550856">)</span><span class="op" id="4550857">,</span>&nbsp;<span class="builtinfunc" id="4550859">new</span><span class="op" id="4550862">(</span><span class="ident" id="4550863">big</span><span class="op" id="4550866">.</span><span class="ident" id="4550867">Int</span><span class="op" id="4550870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550873">if</span>&nbsp;<span class="ident" id="4550876">z1</span><span class="op" id="4550878">.</span><span class="ident" id="4550879">Sign</span><span class="op" id="4550883">(</span><span class="op" id="4550884">)</span>&nbsp;<span class="op" id="4550886">==</span>&nbsp;<span class="num" id="4550889">0</span>&nbsp;<span class="op" id="4550891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550895">x3</span><span class="op" id="4550897">.</span><span class="ident" id="4550898">Set</span><span class="op" id="4550901">(</span><span class="ident" id="4550902">x2</span><span class="op" id="4550904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550908">y3</span><span class="op" id="4550910">.</span><span class="ident" id="4550911">Set</span><span class="op" id="4550914">(</span><span class="ident" id="4550915">y2</span><span class="op" id="4550917">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550921">z3</span><span class="op" id="4550923">.</span><span class="ident" id="4550924">Set</span><span class="op" id="4550927">(</span><span class="ident" id="4550928">z2</span><span class="op" id="4550930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550934">return</span>&nbsp;<span class="ident" id="4550941">x3</span><span class="op" id="4550943">,</span>&nbsp;<span class="ident" id="4550945">y3</span><span class="op" id="4550947">,</span>&nbsp;<span class="ident" id="4550949">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4550953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4550956">if</span>&nbsp;<span class="ident" id="4550959">z2</span><span class="op" id="4550961">.</span><span class="ident" id="4550962">Sign</span><span class="op" id="4550966">(</span><span class="op" id="4550967">)</span>&nbsp;<span class="op" id="4550969">==</span>&nbsp;<span class="num" id="4550972">0</span>&nbsp;<span class="op" id="4550974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550978">x3</span><span class="op" id="4550980">.</span><span class="ident" id="4550981">Set</span><span class="op" id="4550984">(</span><span class="ident" id="4550985">x1</span><span class="op" id="4550987">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4550991">y3</span><span class="op" id="4550993">.</span><span class="ident" id="4550994">Set</span><span class="op" id="4550997">(</span><span class="ident" id="4550998">y1</span><span class="op" id="4551000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551004">z3</span><span class="op" id="4551006">.</span><span class="ident" id="4551007">Set</span><span class="op" id="4551010">(</span><span class="ident" id="4551011">z1</span><span class="op" id="4551013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4551017">return</span>&nbsp;<span class="ident" id="4551024">x3</span><span class="op" id="4551026">,</span>&nbsp;<span class="ident" id="4551028">y3</span><span class="op" id="4551030">,</span>&nbsp;<span class="ident" id="4551032">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4551036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551040">z1z1</span>&nbsp;<span class="op" id="4551045">:=</span>&nbsp;<span class="builtinfunc" id="4551048">new</span><span class="op" id="4551051">(</span><span class="ident" id="4551052">big</span><span class="op" id="4551055">.</span><span class="ident" id="4551056">Int</span><span class="op" id="4551059">)</span><span class="op" id="4551060">.</span><span class="ident" id="4551061">Mul</span><span class="op" id="4551064">(</span><span class="ident" id="4551065">z1</span><span class="op" id="4551067">,</span>&nbsp;<span class="ident" id="4551069">z1</span><span class="op" id="4551071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551074">z1z1</span><span class="op" id="4551078">.</span><span class="ident" id="4551079">Mod</span><span class="op" id="4551082">(</span><span class="ident" id="4551083">z1z1</span><span class="op" id="4551087">,</span>&nbsp;<span class="ident" id="4551089">curve</span><span class="op" id="4551094">.</span><span class="ident" id="4551095">P</span><span class="op" id="4551096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551099">z2z2</span>&nbsp;<span class="op" id="4551104">:=</span>&nbsp;<span class="builtinfunc" id="4551107">new</span><span class="op" id="4551110">(</span><span class="ident" id="4551111">big</span><span class="op" id="4551114">.</span><span class="ident" id="4551115">Int</span><span class="op" id="4551118">)</span><span class="op" id="4551119">.</span><span class="ident" id="4551120">Mul</span><span class="op" id="4551123">(</span><span class="ident" id="4551124">z2</span><span class="op" id="4551126">,</span>&nbsp;<span class="ident" id="4551128">z2</span><span class="op" id="4551130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551133">z2z2</span><span class="op" id="4551137">.</span><span class="ident" id="4551138">Mod</span><span class="op" id="4551141">(</span><span class="ident" id="4551142">z2z2</span><span class="op" id="4551146">,</span>&nbsp;<span class="ident" id="4551148">curve</span><span class="op" id="4551153">.</span><span class="ident" id="4551154">P</span><span class="op" id="4551155">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551159">u1</span>&nbsp;<span class="op" id="4551162">:=</span>&nbsp;<span class="builtinfunc" id="4551165">new</span><span class="op" id="4551168">(</span><span class="ident" id="4551169">big</span><span class="op" id="4551172">.</span><span class="ident" id="4551173">Int</span><span class="op" id="4551176">)</span><span class="op" id="4551177">.</span><span class="ident" id="4551178">Mul</span><span class="op" id="4551181">(</span><span class="ident" id="4551182">x1</span><span class="op" id="4551184">,</span>&nbsp;<span class="ident" id="4551186">z2z2</span><span class="op" id="4551190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551193">u1</span><span class="op" id="4551195">.</span><span class="ident" id="4551196">Mod</span><span class="op" id="4551199">(</span><span class="ident" id="4551200">u1</span><span class="op" id="4551202">,</span>&nbsp;<span class="ident" id="4551204">curve</span><span class="op" id="4551209">.</span><span class="ident" id="4551210">P</span><span class="op" id="4551211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551214">u2</span>&nbsp;<span class="op" id="4551217">:=</span>&nbsp;<span class="builtinfunc" id="4551220">new</span><span class="op" id="4551223">(</span><span class="ident" id="4551224">big</span><span class="op" id="4551227">.</span><span class="ident" id="4551228">Int</span><span class="op" id="4551231">)</span><span class="op" id="4551232">.</span><span class="ident" id="4551233">Mul</span><span class="op" id="4551236">(</span><span class="ident" id="4551237">x2</span><span class="op" id="4551239">,</span>&nbsp;<span class="ident" id="4551241">z1z1</span><span class="op" id="4551245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551248">u2</span><span class="op" id="4551250">.</span><span class="ident" id="4551251">Mod</span><span class="op" id="4551254">(</span><span class="ident" id="4551255">u2</span><span class="op" id="4551257">,</span>&nbsp;<span class="ident" id="4551259">curve</span><span class="op" id="4551264">.</span><span class="ident" id="4551265">P</span><span class="op" id="4551266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551269">h</span>&nbsp;<span class="op" id="4551271">:=</span>&nbsp;<span class="builtinfunc" id="4551274">new</span><span class="op" id="4551277">(</span><span class="ident" id="4551278">big</span><span class="op" id="4551281">.</span><span class="ident" id="4551282">Int</span><span class="op" id="4551285">)</span><span class="op" id="4551286">.</span><span class="ident" id="4551287">Sub</span><span class="op" id="4551290">(</span><span class="ident" id="4551291">u2</span><span class="op" id="4551293">,</span>&nbsp;<span class="ident" id="4551295">u1</span><span class="op" id="4551297">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551300">xEqual</span>&nbsp;<span class="op" id="4551307">:=</span>&nbsp;<span class="ident" id="4551310">h</span><span class="op" id="4551311">.</span><span class="ident" id="4551312">Sign</span><span class="op" id="4551316">(</span><span class="op" id="4551317">)</span>&nbsp;<span class="op" id="4551319">==</span>&nbsp;<span class="num" id="4551322">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4551325">if</span>&nbsp;<span class="ident" id="4551328">h</span><span class="op" id="4551329">.</span><span class="ident" id="4551330">Sign</span><span class="op" id="4551334">(</span><span class="op" id="4551335">)</span>&nbsp;<span class="op" id="4551337">==</span>&nbsp;<span class="op" id="4551340">-</span><span class="num" id="4551341">1</span>&nbsp;<span class="op" id="4551343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551347">h</span><span class="op" id="4551348">.</span><span class="ident" id="4551349">Add</span><span class="op" id="4551352">(</span><span class="ident" id="4551353">h</span><span class="op" id="4551354">,</span>&nbsp;<span class="ident" id="4551356">curve</span><span class="op" id="4551361">.</span><span class="ident" id="4551362">P</span><span class="op" id="4551363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4551366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551369">i</span>&nbsp;<span class="op" id="4551371">:=</span>&nbsp;<span class="builtinfunc" id="4551374">new</span><span class="op" id="4551377">(</span><span class="ident" id="4551378">big</span><span class="op" id="4551381">.</span><span class="ident" id="4551382">Int</span><span class="op" id="4551385">)</span><span class="op" id="4551386">.</span><span class="ident" id="4551387">Lsh</span><span class="op" id="4551390">(</span><span class="ident" id="4551391">h</span><span class="op" id="4551392">,</span>&nbsp;<span class="num" id="4551394">1</span><span class="op" id="4551395">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551398">i</span><span class="op" id="4551399">.</span><span class="ident" id="4551400">Mul</span><span class="op" id="4551403">(</span><span class="ident" id="4551404">i</span><span class="op" id="4551405">,</span>&nbsp;<span class="ident" id="4551407">i</span><span class="op" id="4551408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551411">j</span>&nbsp;<span class="op" id="4551413">:=</span>&nbsp;<span class="builtinfunc" id="4551416">new</span><span class="op" id="4551419">(</span><span class="ident" id="4551420">big</span><span class="op" id="4551423">.</span><span class="ident" id="4551424">Int</span><span class="op" id="4551427">)</span><span class="op" id="4551428">.</span><span class="ident" id="4551429">Mul</span><span class="op" id="4551432">(</span><span class="ident" id="4551433">h</span><span class="op" id="4551434">,</span>&nbsp;<span class="ident" id="4551436">i</span><span class="op" id="4551437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551441">s1</span>&nbsp;<span class="op" id="4551444">:=</span>&nbsp;<span class="builtinfunc" id="4551447">new</span><span class="op" id="4551450">(</span><span class="ident" id="4551451">big</span><span class="op" id="4551454">.</span><span class="ident" id="4551455">Int</span><span class="op" id="4551458">)</span><span class="op" id="4551459">.</span><span class="ident" id="4551460">Mul</span><span class="op" id="4551463">(</span><span class="ident" id="4551464">y1</span><span class="op" id="4551466">,</span>&nbsp;<span class="ident" id="4551468">z2</span><span class="op" id="4551470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551473">s1</span><span class="op" id="4551475">.</span><span class="ident" id="4551476">Mul</span><span class="op" id="4551479">(</span><span class="ident" id="4551480">s1</span><span class="op" id="4551482">,</span>&nbsp;<span class="ident" id="4551484">z2z2</span><span class="op" id="4551488">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551491">s1</span><span class="op" id="4551493">.</span><span class="ident" id="4551494">Mod</span><span class="op" id="4551497">(</span><span class="ident" id="4551498">s1</span><span class="op" id="4551500">,</span>&nbsp;<span class="ident" id="4551502">curve</span><span class="op" id="4551507">.</span><span class="ident" id="4551508">P</span><span class="op" id="4551509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551512">s2</span>&nbsp;<span class="op" id="4551515">:=</span>&nbsp;<span class="builtinfunc" id="4551518">new</span><span class="op" id="4551521">(</span><span class="ident" id="4551522">big</span><span class="op" id="4551525">.</span><span class="ident" id="4551526">Int</span><span class="op" id="4551529">)</span><span class="op" id="4551530">.</span><span class="ident" id="4551531">Mul</span><span class="op" id="4551534">(</span><span class="ident" id="4551535">y2</span><span class="op" id="4551537">,</span>&nbsp;<span class="ident" id="4551539">z1</span><span class="op" id="4551541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551544">s2</span><span class="op" id="4551546">.</span><span class="ident" id="4551547">Mul</span><span class="op" id="4551550">(</span><span class="ident" id="4551551">s2</span><span class="op" id="4551553">,</span>&nbsp;<span class="ident" id="4551555">z1z1</span><span class="op" id="4551559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551562">s2</span><span class="op" id="4551564">.</span><span class="ident" id="4551565">Mod</span><span class="op" id="4551568">(</span><span class="ident" id="4551569">s2</span><span class="op" id="4551571">,</span>&nbsp;<span class="ident" id="4551573">curve</span><span class="op" id="4551578">.</span><span class="ident" id="4551579">P</span><span class="op" id="4551580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551583">r</span>&nbsp;<span class="op" id="4551585">:=</span>&nbsp;<span class="builtinfunc" id="4551588">new</span><span class="op" id="4551591">(</span><span class="ident" id="4551592">big</span><span class="op" id="4551595">.</span><span class="ident" id="4551596">Int</span><span class="op" id="4551599">)</span><span class="op" id="4551600">.</span><span class="ident" id="4551601">Sub</span><span class="op" id="4551604">(</span><span class="ident" id="4551605">s2</span><span class="op" id="4551607">,</span>&nbsp;<span class="ident" id="4551609">s1</span><span class="op" id="4551611">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4551614">if</span>&nbsp;<span class="ident" id="4551617">r</span><span class="op" id="4551618">.</span><span class="ident" id="4551619">Sign</span><span class="op" id="4551623">(</span><span class="op" id="4551624">)</span>&nbsp;<span class="op" id="4551626">==</span>&nbsp;<span class="op" id="4551629">-</span><span class="num" id="4551630">1</span>&nbsp;<span class="op" id="4551632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551636">r</span><span class="op" id="4551637">.</span><span class="ident" id="4551638">Add</span><span class="op" id="4551641">(</span><span class="ident" id="4551642">r</span><span class="op" id="4551643">,</span>&nbsp;<span class="ident" id="4551645">curve</span><span class="op" id="4551650">.</span><span class="ident" id="4551651">P</span><span class="op" id="4551652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4551655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551658">yEqual</span>&nbsp;<span class="op" id="4551665">:=</span>&nbsp;<span class="ident" id="4551668">r</span><span class="op" id="4551669">.</span><span class="ident" id="4551670">Sign</span><span class="op" id="4551674">(</span><span class="op" id="4551675">)</span>&nbsp;<span class="op" id="4551677">==</span>&nbsp;<span class="num" id="4551680">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4551683">if</span>&nbsp;<span class="ident" id="4551686">xEqual</span>&nbsp;<span class="op" id="4551693">&amp;&amp;</span>&nbsp;<span class="ident" id="4551696">yEqual</span>&nbsp;<span class="op" id="4551703">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4551707">return</span>&nbsp;<span class="ident" id="4551714">curve</span><span class="op" id="4551719">.</span><span class="ident" id="4551720">doubleJacobian</span><span class="op" id="4551734">(</span><span class="ident" id="4551735">x1</span><span class="op" id="4551737">,</span>&nbsp;<span class="ident" id="4551739">y1</span><span class="op" id="4551741">,</span>&nbsp;<span class="ident" id="4551743">z1</span><span class="op" id="4551745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4551748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551751">r</span><span class="op" id="4551752">.</span><span class="ident" id="4551753">Lsh</span><span class="op" id="4551756">(</span><span class="ident" id="4551757">r</span><span class="op" id="4551758">,</span>&nbsp;<span class="num" id="4551760">1</span><span class="op" id="4551761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551764">v</span>&nbsp;<span class="op" id="4551766">:=</span>&nbsp;<span class="builtinfunc" id="4551769">new</span><span class="op" id="4551772">(</span><span class="ident" id="4551773">big</span><span class="op" id="4551776">.</span><span class="ident" id="4551777">Int</span><span class="op" id="4551780">)</span><span class="op" id="4551781">.</span><span class="ident" id="4551782">Mul</span><span class="op" id="4551785">(</span><span class="ident" id="4551786">u1</span><span class="op" id="4551788">,</span>&nbsp;<span class="ident" id="4551790">i</span><span class="op" id="4551791">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551795">x3</span><span class="op" id="4551797">.</span><span class="ident" id="4551798">Set</span><span class="op" id="4551801">(</span><span class="ident" id="4551802">r</span><span class="op" id="4551803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551806">x3</span><span class="op" id="4551808">.</span><span class="ident" id="4551809">Mul</span><span class="op" id="4551812">(</span><span class="ident" id="4551813">x3</span><span class="op" id="4551815">,</span>&nbsp;<span class="ident" id="4551817">x3</span><span class="op" id="4551819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551822">x3</span><span class="op" id="4551824">.</span><span class="ident" id="4551825">Sub</span><span class="op" id="4551828">(</span><span class="ident" id="4551829">x3</span><span class="op" id="4551831">,</span>&nbsp;<span class="ident" id="4551833">j</span><span class="op" id="4551834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551837">x3</span><span class="op" id="4551839">.</span><span class="ident" id="4551840">Sub</span><span class="op" id="4551843">(</span><span class="ident" id="4551844">x3</span><span class="op" id="4551846">,</span>&nbsp;<span class="ident" id="4551848">v</span><span class="op" id="4551849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551852">x3</span><span class="op" id="4551854">.</span><span class="ident" id="4551855">Sub</span><span class="op" id="4551858">(</span><span class="ident" id="4551859">x3</span><span class="op" id="4551861">,</span>&nbsp;<span class="ident" id="4551863">v</span><span class="op" id="4551864">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551867">x3</span><span class="op" id="4551869">.</span><span class="ident" id="4551870">Mod</span><span class="op" id="4551873">(</span><span class="ident" id="4551874">x3</span><span class="op" id="4551876">,</span>&nbsp;<span class="ident" id="4551878">curve</span><span class="op" id="4551883">.</span><span class="ident" id="4551884">P</span><span class="op" id="4551885">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551889">y3</span><span class="op" id="4551891">.</span><span class="ident" id="4551892">Set</span><span class="op" id="4551895">(</span><span class="ident" id="4551896">r</span><span class="op" id="4551897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551900">v</span><span class="op" id="4551901">.</span><span class="ident" id="4551902">Sub</span><span class="op" id="4551905">(</span><span class="ident" id="4551906">v</span><span class="op" id="4551907">,</span>&nbsp;<span class="ident" id="4551909">x3</span><span class="op" id="4551911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551914">y3</span><span class="op" id="4551916">.</span><span class="ident" id="4551917">Mul</span><span class="op" id="4551920">(</span><span class="ident" id="4551921">y3</span><span class="op" id="4551923">,</span>&nbsp;<span class="ident" id="4551925">v</span><span class="op" id="4551926">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551929">s1</span><span class="op" id="4551931">.</span><span class="ident" id="4551932">Mul</span><span class="op" id="4551935">(</span><span class="ident" id="4551936">s1</span><span class="op" id="4551938">,</span>&nbsp;<span class="ident" id="4551940">j</span><span class="op" id="4551941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551944">s1</span><span class="op" id="4551946">.</span><span class="ident" id="4551947">Lsh</span><span class="op" id="4551950">(</span><span class="ident" id="4551951">s1</span><span class="op" id="4551953">,</span>&nbsp;<span class="num" id="4551955">1</span><span class="op" id="4551956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551959">y3</span><span class="op" id="4551961">.</span><span class="ident" id="4551962">Sub</span><span class="op" id="4551965">(</span><span class="ident" id="4551966">y3</span><span class="op" id="4551968">,</span>&nbsp;<span class="ident" id="4551970">s1</span><span class="op" id="4551972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551975">y3</span><span class="op" id="4551977">.</span><span class="ident" id="4551978">Mod</span><span class="op" id="4551981">(</span><span class="ident" id="4551982">y3</span><span class="op" id="4551984">,</span>&nbsp;<span class="ident" id="4551986">curve</span><span class="op" id="4551991">.</span><span class="ident" id="4551992">P</span><span class="op" id="4551993">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4551997">z3</span><span class="op" id="4551999">.</span><span class="ident" id="4552000">Add</span><span class="op" id="4552003">(</span><span class="ident" id="4552004">z1</span><span class="op" id="4552006">,</span>&nbsp;<span class="ident" id="4552008">z2</span><span class="op" id="4552010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552013">z3</span><span class="op" id="4552015">.</span><span class="ident" id="4552016">Mul</span><span class="op" id="4552019">(</span><span class="ident" id="4552020">z3</span><span class="op" id="4552022">,</span>&nbsp;<span class="ident" id="4552024">z3</span><span class="op" id="4552026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552029">z3</span><span class="op" id="4552031">.</span><span class="ident" id="4552032">Sub</span><span class="op" id="4552035">(</span><span class="ident" id="4552036">z3</span><span class="op" id="4552038">,</span>&nbsp;<span class="ident" id="4552040">z1z1</span><span class="op" id="4552044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552047">z3</span><span class="op" id="4552049">.</span><span class="ident" id="4552050">Sub</span><span class="op" id="4552053">(</span><span class="ident" id="4552054">z3</span><span class="op" id="4552056">,</span>&nbsp;<span class="ident" id="4552058">z2z2</span><span class="op" id="4552062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552065">z3</span><span class="op" id="4552067">.</span><span class="ident" id="4552068">Mul</span><span class="op" id="4552071">(</span><span class="ident" id="4552072">z3</span><span class="op" id="4552074">,</span>&nbsp;<span class="ident" id="4552076">h</span><span class="op" id="4552077">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552080">z3</span><span class="op" id="4552082">.</span><span class="ident" id="4552083">Mod</span><span class="op" id="4552086">(</span><span class="ident" id="4552087">z3</span><span class="op" id="4552089">,</span>&nbsp;<span class="ident" id="4552091">curve</span><span class="op" id="4552096">.</span><span class="ident" id="4552097">P</span><span class="op" id="4552098">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552102">return</span>&nbsp;<span class="ident" id="4552109">x3</span><span class="op" id="4552111">,</span>&nbsp;<span class="ident" id="4552113">y3</span><span class="op" id="4552115">,</span>&nbsp;<span class="ident" id="4552117">z3</span><br>
<span class="lineno"></span><span class="op" id="4552120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4552123">func</span>&nbsp;<span class="op" id="4552128">(</span><span class="ident" id="4552129">curve</span>&nbsp;<span class="op" id="4552135">*</span><span class="ident" id="4552136">CurveParams</span><span class="op" id="4552147">)</span>&nbsp;<span class="ident" id="4552149">Double</span><span class="op" id="4552155">(</span><span class="ident" id="4552156">x1</span><span class="op" id="4552158">,</span>&nbsp;<span class="ident" id="4552160">y1</span>&nbsp;<span class="op" id="4552163">*</span><span class="ident" id="4552164">big</span><span class="op" id="4552167">.</span><span class="ident" id="4552168">Int</span><span class="op" id="4552171">)</span>&nbsp;<span class="op" id="4552173">(</span><span class="op" id="4552174">*</span><span class="ident" id="4552175">big</span><span class="op" id="4552178">.</span><span class="ident" id="4552179">Int</span><span class="op" id="4552182">,</span>&nbsp;<span class="op" id="4552184">*</span><span class="ident" id="4552185">big</span><span class="op" id="4552188">.</span><span class="ident" id="4552189">Int</span><span class="op" id="4552192">)</span>&nbsp;<span class="op" id="4552194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552197">z1</span>&nbsp;<span class="op" id="4552200">:=</span>&nbsp;<span class="ident" id="4552203">zForAffine</span><span class="op" id="4552213">(</span><span class="ident" id="4552214">x1</span><span class="op" id="4552216">,</span>&nbsp;<span class="ident" id="4552218">y1</span><span class="op" id="4552220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552223">return</span>&nbsp;<span class="ident" id="4552230">curve</span><span class="op" id="4552235">.</span><span class="ident" id="4552236">affineFromJacobian</span><span class="op" id="4552254">(</span><span class="ident" id="4552255">curve</span><span class="op" id="4552260">.</span><span class="ident" id="4552261">doubleJacobian</span><span class="op" id="4552275">(</span><span class="ident" id="4552276">x1</span><span class="op" id="4552278">,</span>&nbsp;<span class="ident" id="4552280">y1</span><span class="op" id="4552282">,</span>&nbsp;<span class="ident" id="4552284">z1</span><span class="op" id="4552286">)</span><span class="op" id="4552287">)</span><br>
<span class="lineno"></span><span class="op" id="4552289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4552292">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4552364">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4552410">func</span>&nbsp;<span class="op" id="4552415">(</span><span class="ident" id="4552416">curve</span>&nbsp;<span class="op" id="4552422">*</span><span class="ident" id="4552423">CurveParams</span><span class="op" id="4552434">)</span>&nbsp;<span class="ident" id="4552436">doubleJacobian</span><span class="op" id="4552450">(</span><span class="ident" id="4552451">x</span><span class="op" id="4552452">,</span>&nbsp;<span class="ident" id="4552454">y</span><span class="op" id="4552455">,</span>&nbsp;<span class="ident" id="4552457">z</span>&nbsp;<span class="op" id="4552459">*</span><span class="ident" id="4552460">big</span><span class="op" id="4552463">.</span><span class="ident" id="4552464">Int</span><span class="op" id="4552467">)</span>&nbsp;<span class="op" id="4552469">(</span><span class="op" id="4552470">*</span><span class="ident" id="4552471">big</span><span class="op" id="4552474">.</span><span class="ident" id="4552475">Int</span><span class="op" id="4552478">,</span>&nbsp;<span class="op" id="4552480">*</span><span class="ident" id="4552481">big</span><span class="op" id="4552484">.</span><span class="ident" id="4552485">Int</span><span class="op" id="4552488">,</span>&nbsp;<span class="op" id="4552490">*</span><span class="ident" id="4552491">big</span><span class="op" id="4552494">.</span><span class="ident" id="4552495">Int</span><span class="op" id="4552498">)</span>&nbsp;<span class="op" id="4552500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4552503">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552592">delta</span>&nbsp;<span class="op" id="4552598">:=</span>&nbsp;<span class="builtinfunc" id="4552601">new</span><span class="op" id="4552604">(</span><span class="ident" id="4552605">big</span><span class="op" id="4552608">.</span><span class="ident" id="4552609">Int</span><span class="op" id="4552612">)</span><span class="op" id="4552613">.</span><span class="ident" id="4552614">Mul</span><span class="op" id="4552617">(</span><span class="ident" id="4552618">z</span><span class="op" id="4552619">,</span>&nbsp;<span class="ident" id="4552621">z</span><span class="op" id="4552622">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552625">delta</span><span class="op" id="4552630">.</span><span class="ident" id="4552631">Mod</span><span class="op" id="4552634">(</span><span class="ident" id="4552635">delta</span><span class="op" id="4552640">,</span>&nbsp;<span class="ident" id="4552642">curve</span><span class="op" id="4552647">.</span><span class="ident" id="4552648">P</span><span class="op" id="4552649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552652">gamma</span>&nbsp;<span class="op" id="4552658">:=</span>&nbsp;<span class="builtinfunc" id="4552661">new</span><span class="op" id="4552664">(</span><span class="ident" id="4552665">big</span><span class="op" id="4552668">.</span><span class="ident" id="4552669">Int</span><span class="op" id="4552672">)</span><span class="op" id="4552673">.</span><span class="ident" id="4552674">Mul</span><span class="op" id="4552677">(</span><span class="ident" id="4552678">y</span><span class="op" id="4552679">,</span>&nbsp;<span class="ident" id="4552681">y</span><span class="op" id="4552682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552685">gamma</span><span class="op" id="4552690">.</span><span class="ident" id="4552691">Mod</span><span class="op" id="4552694">(</span><span class="ident" id="4552695">gamma</span><span class="op" id="4552700">,</span>&nbsp;<span class="ident" id="4552702">curve</span><span class="op" id="4552707">.</span><span class="ident" id="4552708">P</span><span class="op" id="4552709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552712">alpha</span>&nbsp;<span class="op" id="4552718">:=</span>&nbsp;<span class="builtinfunc" id="4552721">new</span><span class="op" id="4552724">(</span><span class="ident" id="4552725">big</span><span class="op" id="4552728">.</span><span class="ident" id="4552729">Int</span><span class="op" id="4552732">)</span><span class="op" id="4552733">.</span><span class="ident" id="4552734">Sub</span><span class="op" id="4552737">(</span><span class="ident" id="4552738">x</span><span class="op" id="4552739">,</span>&nbsp;<span class="ident" id="4552741">delta</span><span class="op" id="4552746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4552749">if</span>&nbsp;<span class="ident" id="4552752">alpha</span><span class="op" id="4552757">.</span><span class="ident" id="4552758">Sign</span><span class="op" id="4552762">(</span><span class="op" id="4552763">)</span>&nbsp;<span class="op" id="4552765">==</span>&nbsp;<span class="op" id="4552768">-</span><span class="num" id="4552769">1</span>&nbsp;<span class="op" id="4552771">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552775">alpha</span><span class="op" id="4552780">.</span><span class="ident" id="4552781">Add</span><span class="op" id="4552784">(</span><span class="ident" id="4552785">alpha</span><span class="op" id="4552790">,</span>&nbsp;<span class="ident" id="4552792">curve</span><span class="op" id="4552797">.</span><span class="ident" id="4552798">P</span><span class="op" id="4552799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4552802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552805">alpha2</span>&nbsp;<span class="op" id="4552812">:=</span>&nbsp;<span class="builtinfunc" id="4552815">new</span><span class="op" id="4552818">(</span><span class="ident" id="4552819">big</span><span class="op" id="4552822">.</span><span class="ident" id="4552823">Int</span><span class="op" id="4552826">)</span><span class="op" id="4552827">.</span><span class="ident" id="4552828">Add</span><span class="op" id="4552831">(</span><span class="ident" id="4552832">x</span><span class="op" id="4552833">,</span>&nbsp;<span class="ident" id="4552835">delta</span><span class="op" id="4552840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552843">alpha</span><span class="op" id="4552848">.</span><span class="ident" id="4552849">Mul</span><span class="op" id="4552852">(</span><span class="ident" id="4552853">alpha</span><span class="op" id="4552858">,</span>&nbsp;<span class="ident" id="4552860">alpha2</span><span class="op" id="4552866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552869">alpha2</span><span class="op" id="4552875">.</span><span class="ident" id="4552876">Set</span><span class="op" id="4552879">(</span><span class="ident" id="4552880">alpha</span><span class="op" id="4552885">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552888">alpha</span><span class="op" id="4552893">.</span><span class="ident" id="4552894">Lsh</span><span class="op" id="4552897">(</span><span class="ident" id="4552898">alpha</span><span class="op" id="4552903">,</span>&nbsp;<span class="num" id="4552905">1</span><span class="op" id="4552906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552909">alpha</span><span class="op" id="4552914">.</span><span class="ident" id="4552915">Add</span><span class="op" id="4552918">(</span><span class="ident" id="4552919">alpha</span><span class="op" id="4552924">,</span>&nbsp;<span class="ident" id="4552926">alpha2</span><span class="op" id="4552932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552936">beta</span>&nbsp;<span class="op" id="4552941">:=</span>&nbsp;<span class="ident" id="4552944">alpha2</span><span class="op" id="4552950">.</span><span class="ident" id="4552951">Mul</span><span class="op" id="4552954">(</span><span class="ident" id="4552955">x</span><span class="op" id="4552956">,</span>&nbsp;<span class="ident" id="4552958">gamma</span><span class="op" id="4552963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4552967">x3</span>&nbsp;<span class="op" id="4552970">:=</span>&nbsp;<span class="builtinfunc" id="4552973">new</span><span class="op" id="4552976">(</span><span class="ident" id="4552977">big</span><span class="op" id="4552980">.</span><span class="ident" id="4552981">Int</span><span class="op" id="4552984">)</span><span class="op" id="4552985">.</span><span class="ident" id="4552986">Mul</span><span class="op" id="4552989">(</span><span class="ident" id="4552990">alpha</span><span class="op" id="4552995">,</span>&nbsp;<span class="ident" id="4552997">alpha</span><span class="op" id="4553002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553005">beta8</span>&nbsp;<span class="op" id="4553011">:=</span>&nbsp;<span class="builtinfunc" id="4553014">new</span><span class="op" id="4553017">(</span><span class="ident" id="4553018">big</span><span class="op" id="4553021">.</span><span class="ident" id="4553022">Int</span><span class="op" id="4553025">)</span><span class="op" id="4553026">.</span><span class="ident" id="4553027">Lsh</span><span class="op" id="4553030">(</span><span class="ident" id="4553031">beta</span><span class="op" id="4553035">,</span>&nbsp;<span class="num" id="4553037">3</span><span class="op" id="4553038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553041">x3</span><span class="op" id="4553043">.</span><span class="ident" id="4553044">Sub</span><span class="op" id="4553047">(</span><span class="ident" id="4553048">x3</span><span class="op" id="4553050">,</span>&nbsp;<span class="ident" id="4553052">beta8</span><span class="op" id="4553057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553060">for</span>&nbsp;<span class="ident" id="4553064">x3</span><span class="op" id="4553066">.</span><span class="ident" id="4553067">Sign</span><span class="op" id="4553071">(</span><span class="op" id="4553072">)</span>&nbsp;<span class="op" id="4553074">==</span>&nbsp;<span class="op" id="4553077">-</span><span class="num" id="4553078">1</span>&nbsp;<span class="op" id="4553080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553084">x3</span><span class="op" id="4553086">.</span><span class="ident" id="4553087">Add</span><span class="op" id="4553090">(</span><span class="ident" id="4553091">x3</span><span class="op" id="4553093">,</span>&nbsp;<span class="ident" id="4553095">curve</span><span class="op" id="4553100">.</span><span class="ident" id="4553101">P</span><span class="op" id="4553102">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553108">x3</span><span class="op" id="4553110">.</span><span class="ident" id="4553111">Mod</span><span class="op" id="4553114">(</span><span class="ident" id="4553115">x3</span><span class="op" id="4553117">,</span>&nbsp;<span class="ident" id="4553119">curve</span><span class="op" id="4553124">.</span><span class="ident" id="4553125">P</span><span class="op" id="4553126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553130">z3</span>&nbsp;<span class="op" id="4553133">:=</span>&nbsp;<span class="builtinfunc" id="4553136">new</span><span class="op" id="4553139">(</span><span class="ident" id="4553140">big</span><span class="op" id="4553143">.</span><span class="ident" id="4553144">Int</span><span class="op" id="4553147">)</span><span class="op" id="4553148">.</span><span class="ident" id="4553149">Add</span><span class="op" id="4553152">(</span><span class="ident" id="4553153">y</span><span class="op" id="4553154">,</span>&nbsp;<span class="ident" id="4553156">z</span><span class="op" id="4553157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553160">z3</span><span class="op" id="4553162">.</span><span class="ident" id="4553163">Mul</span><span class="op" id="4553166">(</span><span class="ident" id="4553167">z3</span><span class="op" id="4553169">,</span>&nbsp;<span class="ident" id="4553171">z3</span><span class="op" id="4553173">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553176">z3</span><span class="op" id="4553178">.</span><span class="ident" id="4553179">Sub</span><span class="op" id="4553182">(</span><span class="ident" id="4553183">z3</span><span class="op" id="4553185">,</span>&nbsp;<span class="ident" id="4553187">gamma</span><span class="op" id="4553192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553195">if</span>&nbsp;<span class="ident" id="4553198">z3</span><span class="op" id="4553200">.</span><span class="ident" id="4553201">Sign</span><span class="op" id="4553205">(</span><span class="op" id="4553206">)</span>&nbsp;<span class="op" id="4553208">==</span>&nbsp;<span class="op" id="4553211">-</span><span class="num" id="4553212">1</span>&nbsp;<span class="op" id="4553214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553218">z3</span><span class="op" id="4553220">.</span><span class="ident" id="4553221">Add</span><span class="op" id="4553224">(</span><span class="ident" id="4553225">z3</span><span class="op" id="4553227">,</span>&nbsp;<span class="ident" id="4553229">curve</span><span class="op" id="4553234">.</span><span class="ident" id="4553235">P</span><span class="op" id="4553236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553242">z3</span><span class="op" id="4553244">.</span><span class="ident" id="4553245">Sub</span><span class="op" id="4553248">(</span><span class="ident" id="4553249">z3</span><span class="op" id="4553251">,</span>&nbsp;<span class="ident" id="4553253">delta</span><span class="op" id="4553258">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553261">if</span>&nbsp;<span class="ident" id="4553264">z3</span><span class="op" id="4553266">.</span><span class="ident" id="4553267">Sign</span><span class="op" id="4553271">(</span><span class="op" id="4553272">)</span>&nbsp;<span class="op" id="4553274">==</span>&nbsp;<span class="op" id="4553277">-</span><span class="num" id="4553278">1</span>&nbsp;<span class="op" id="4553280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553284">z3</span><span class="op" id="4553286">.</span><span class="ident" id="4553287">Add</span><span class="op" id="4553290">(</span><span class="ident" id="4553291">z3</span><span class="op" id="4553293">,</span>&nbsp;<span class="ident" id="4553295">curve</span><span class="op" id="4553300">.</span><span class="ident" id="4553301">P</span><span class="op" id="4553302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553308">z3</span><span class="op" id="4553310">.</span><span class="ident" id="4553311">Mod</span><span class="op" id="4553314">(</span><span class="ident" id="4553315">z3</span><span class="op" id="4553317">,</span>&nbsp;<span class="ident" id="4553319">curve</span><span class="op" id="4553324">.</span><span class="ident" id="4553325">P</span><span class="op" id="4553326">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553330">beta</span><span class="op" id="4553334">.</span><span class="ident" id="4553335">Lsh</span><span class="op" id="4553338">(</span><span class="ident" id="4553339">beta</span><span class="op" id="4553343">,</span>&nbsp;<span class="num" id="4553345">2</span><span class="op" id="4553346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553349">beta</span><span class="op" id="4553353">.</span><span class="ident" id="4553354">Sub</span><span class="op" id="4553357">(</span><span class="ident" id="4553358">beta</span><span class="op" id="4553362">,</span>&nbsp;<span class="ident" id="4553364">x3</span><span class="op" id="4553366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553369">if</span>&nbsp;<span class="ident" id="4553372">beta</span><span class="op" id="4553376">.</span><span class="ident" id="4553377">Sign</span><span class="op" id="4553381">(</span><span class="op" id="4553382">)</span>&nbsp;<span class="op" id="4553384">==</span>&nbsp;<span class="op" id="4553387">-</span><span class="num" id="4553388">1</span>&nbsp;<span class="op" id="4553390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553394">beta</span><span class="op" id="4553398">.</span><span class="ident" id="4553399">Add</span><span class="op" id="4553402">(</span><span class="ident" id="4553403">beta</span><span class="op" id="4553407">,</span>&nbsp;<span class="ident" id="4553409">curve</span><span class="op" id="4553414">.</span><span class="ident" id="4553415">P</span><span class="op" id="4553416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553419">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553422">y3</span>&nbsp;<span class="op" id="4553425">:=</span>&nbsp;<span class="ident" id="4553428">alpha</span><span class="op" id="4553433">.</span><span class="ident" id="4553434">Mul</span><span class="op" id="4553437">(</span><span class="ident" id="4553438">alpha</span><span class="op" id="4553443">,</span>&nbsp;<span class="ident" id="4553445">beta</span><span class="op" id="4553449">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553453">gamma</span><span class="op" id="4553458">.</span><span class="ident" id="4553459">Mul</span><span class="op" id="4553462">(</span><span class="ident" id="4553463">gamma</span><span class="op" id="4553468">,</span>&nbsp;<span class="ident" id="4553470">gamma</span><span class="op" id="4553475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553478">gamma</span><span class="op" id="4553483">.</span><span class="ident" id="4553484">Lsh</span><span class="op" id="4553487">(</span><span class="ident" id="4553488">gamma</span><span class="op" id="4553493">,</span>&nbsp;<span class="num" id="4553495">3</span><span class="op" id="4553496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553499">gamma</span><span class="op" id="4553504">.</span><span class="ident" id="4553505">Mod</span><span class="op" id="4553508">(</span><span class="ident" id="4553509">gamma</span><span class="op" id="4553514">,</span>&nbsp;<span class="ident" id="4553516">curve</span><span class="op" id="4553521">.</span><span class="ident" id="4553522">P</span><span class="op" id="4553523">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553527">y3</span><span class="op" id="4553529">.</span><span class="ident" id="4553530">Sub</span><span class="op" id="4553533">(</span><span class="ident" id="4553534">y3</span><span class="op" id="4553536">,</span>&nbsp;<span class="ident" id="4553538">gamma</span><span class="op" id="4553543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553546">if</span>&nbsp;<span class="ident" id="4553549">y3</span><span class="op" id="4553551">.</span><span class="ident" id="4553552">Sign</span><span class="op" id="4553556">(</span><span class="op" id="4553557">)</span>&nbsp;<span class="op" id="4553559">==</span>&nbsp;<span class="op" id="4553562">-</span><span class="num" id="4553563">1</span>&nbsp;<span class="op" id="4553565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553569">y3</span><span class="op" id="4553571">.</span><span class="ident" id="4553572">Add</span><span class="op" id="4553575">(</span><span class="ident" id="4553576">y3</span><span class="op" id="4553578">,</span>&nbsp;<span class="ident" id="4553580">curve</span><span class="op" id="4553585">.</span><span class="ident" id="4553586">P</span><span class="op" id="4553587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4553590">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553593">y3</span><span class="op" id="4553595">.</span><span class="ident" id="4553596">Mod</span><span class="op" id="4553599">(</span><span class="ident" id="4553600">y3</span><span class="op" id="4553602">,</span>&nbsp;<span class="ident" id="4553604">curve</span><span class="op" id="4553609">.</span><span class="ident" id="4553610">P</span><span class="op" id="4553611">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553615">return</span>&nbsp;<span class="ident" id="4553622">x3</span><span class="op" id="4553624">,</span>&nbsp;<span class="ident" id="4553626">y3</span><span class="op" id="4553628">,</span>&nbsp;<span class="ident" id="4553630">z3</span><br>
<span class="lineno"></span><span class="op" id="4553633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4553636">func</span>&nbsp;<span class="op" id="4553641">(</span><span class="ident" id="4553642">curve</span>&nbsp;<span class="op" id="4553648">*</span><span class="ident" id="4553649">CurveParams</span><span class="op" id="4553660">)</span>&nbsp;<span class="ident" id="4553662">ScalarMult</span><span class="op" id="4553672">(</span><span class="ident" id="4553673">Bx</span><span class="op" id="4553675">,</span>&nbsp;<span class="ident" id="4553677">By</span>&nbsp;<span class="op" id="4553680">*</span><span class="ident" id="4553681">big</span><span class="op" id="4553684">.</span><span class="ident" id="4553685">Int</span><span class="op" id="4553688">,</span>&nbsp;<span class="ident" id="4553690">k</span>&nbsp;<span class="op" id="4553692">[</span><span class="op" id="4553693">]</span><span class="builtintype" id="4553694">byte</span><span class="op" id="4553698">)</span>&nbsp;<span class="op" id="4553700">(</span><span class="op" id="4553701">*</span><span class="ident" id="4553702">big</span><span class="op" id="4553705">.</span><span class="ident" id="4553706">Int</span><span class="op" id="4553709">,</span>&nbsp;<span class="op" id="4553711">*</span><span class="ident" id="4553712">big</span><span class="op" id="4553715">.</span><span class="ident" id="4553716">Int</span><span class="op" id="4553719">)</span>&nbsp;<span class="op" id="4553721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553724">Bz</span>&nbsp;<span class="op" id="4553727">:=</span>&nbsp;<span class="builtinfunc" id="4553730">new</span><span class="op" id="4553733">(</span><span class="ident" id="4553734">big</span><span class="op" id="4553737">.</span><span class="ident" id="4553738">Int</span><span class="op" id="4553741">)</span><span class="op" id="4553742">.</span><span class="ident" id="4553743">SetInt64</span><span class="op" id="4553751">(</span><span class="num" id="4553752">1</span><span class="op" id="4553753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553756">x</span><span class="op" id="4553757">,</span>&nbsp;<span class="ident" id="4553759">y</span><span class="op" id="4553760">,</span>&nbsp;<span class="ident" id="4553762">z</span>&nbsp;<span class="op" id="4553764">:=</span>&nbsp;<span class="builtinfunc" id="4553767">new</span><span class="op" id="4553770">(</span><span class="ident" id="4553771">big</span><span class="op" id="4553774">.</span><span class="ident" id="4553775">Int</span><span class="op" id="4553778">)</span><span class="op" id="4553779">,</span>&nbsp;<span class="builtinfunc" id="4553781">new</span><span class="op" id="4553784">(</span><span class="ident" id="4553785">big</span><span class="op" id="4553788">.</span><span class="ident" id="4553789">Int</span><span class="op" id="4553792">)</span><span class="op" id="4553793">,</span>&nbsp;<span class="builtinfunc" id="4553795">new</span><span class="op" id="4553798">(</span><span class="ident" id="4553799">big</span><span class="op" id="4553802">.</span><span class="ident" id="4553803">Int</span><span class="op" id="4553806">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553810">for</span>&nbsp;<span class="ident" id="4553814">_</span><span class="op" id="4553815">,</span>&nbsp;<span class="builtintype" id="4553817">byte</span>&nbsp;<span class="op" id="4553822">:=</span>&nbsp;<span class="keyword" id="4553825">range</span>&nbsp;<span class="ident" id="4553831">k</span>&nbsp;<span class="op" id="4553833">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553837">for</span>&nbsp;<span class="ident" id="4553841">bitNum</span>&nbsp;<span class="op" id="4553848">:=</span>&nbsp;<span class="num" id="4553851">0</span><span class="op" id="4553852">;</span>&nbsp;<span class="ident" id="4553854">bitNum</span>&nbsp;<span class="op" id="4553861">&lt;</span>&nbsp;<span class="num" id="4553863">8</span><span class="op" id="4553864">;</span>&nbsp;<span class="ident" id="4553866">bitNum</span><span class="op" id="4553872">++</span>&nbsp;<span class="op" id="4553875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553880">x</span><span class="op" id="4553881">,</span>&nbsp;<span class="ident" id="4553883">y</span><span class="op" id="4553884">,</span>&nbsp;<span class="ident" id="4553886">z</span>&nbsp;<span class="op" id="4553888">=</span>&nbsp;<span class="ident" id="4553890">curve</span><span class="op" id="4553895">.</span><span class="ident" id="4553896">doubleJacobian</span><span class="op" id="4553910">(</span><span class="ident" id="4553911">x</span><span class="op" id="4553912">,</span>&nbsp;<span class="ident" id="4553914">y</span><span class="op" id="4553915">,</span>&nbsp;<span class="ident" id="4553917">z</span><span class="op" id="4553918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4553923">if</span>&nbsp;<span class="builtintype" id="4553926">byte</span><span class="op" id="4553930">&amp;</span><span class="num" id="4553931">0x80</span>&nbsp;<span class="op" id="4553936">==</span>&nbsp;<span class="num" id="4553939">0x80</span>&nbsp;<span class="op" id="4553944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4553950">x</span><span class="op" id="4553951">,</span>&nbsp;<span class="ident" id="4553953">y</span><span class="op" id="4553954">,</span>&nbsp;<span class="ident" id="4553956">z</span>&nbsp;<span class="op" id="4553958">=</span>&nbsp;<span class="ident" id="4553960">curve</span><span class="op" id="4553965">.</span><span class="ident" id="4553966">addJacobian</span><span class="op" id="4553977">(</span><span class="ident" id="4553978">Bx</span><span class="op" id="4553980">,</span>&nbsp;<span class="ident" id="4553982">By</span><span class="op" id="4553984">,</span>&nbsp;<span class="ident" id="4553986">Bz</span><span class="op" id="4553988">,</span>&nbsp;<span class="ident" id="4553990">x</span><span class="op" id="4553991">,</span>&nbsp;<span class="ident" id="4553993">y</span><span class="op" id="4553994">,</span>&nbsp;<span class="ident" id="4553996">z</span><span class="op" id="4553997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4554002">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4554007">byte</span>&nbsp;<span class="op" id="4554012">&lt;&lt;=</span>&nbsp;<span class="num" id="4554016">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4554020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4554023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554027">return</span>&nbsp;<span class="ident" id="4554034">curve</span><span class="op" id="4554039">.</span><span class="ident" id="4554040">affineFromJacobian</span><span class="op" id="4554058">(</span><span class="ident" id="4554059">x</span><span class="op" id="4554060">,</span>&nbsp;<span class="ident" id="4554062">y</span><span class="op" id="4554063">,</span>&nbsp;<span class="ident" id="4554065">z</span><span class="op" id="4554066">)</span><br>
<span class="lineno">265</span><span class="op" id="4554068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4554071">func</span>&nbsp;<span class="op" id="4554076">(</span><span class="ident" id="4554077">curve</span>&nbsp;<span class="op" id="4554083">*</span><span class="ident" id="4554084">CurveParams</span><span class="op" id="4554095">)</span>&nbsp;<span class="ident" id="4554097">ScalarBaseMult</span><span class="op" id="4554111">(</span><span class="ident" id="4554112">k</span>&nbsp;<span class="op" id="4554114">[</span><span class="op" id="4554115">]</span><span class="builtintype" id="4554116">byte</span><span class="op" id="4554120">)</span>&nbsp;<span class="op" id="4554122">(</span><span class="op" id="4554123">*</span><span class="ident" id="4554124">big</span><span class="op" id="4554127">.</span><span class="ident" id="4554128">Int</span><span class="op" id="4554131">,</span>&nbsp;<span class="op" id="4554133">*</span><span class="ident" id="4554134">big</span><span class="op" id="4554137">.</span><span class="ident" id="4554138">Int</span><span class="op" id="4554141">)</span>&nbsp;<span class="op" id="4554143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554146">return</span>&nbsp;<span class="ident" id="4554153">curve</span><span class="op" id="4554158">.</span><span class="ident" id="4554159">ScalarMult</span><span class="op" id="4554169">(</span><span class="ident" id="4554170">curve</span><span class="op" id="4554175">.</span><span class="ident" id="4554176">Gx</span><span class="op" id="4554178">,</span>&nbsp;<span class="ident" id="4554180">curve</span><span class="op" id="4554185">.</span><span class="ident" id="4554186">Gy</span><span class="op" id="4554188">,</span>&nbsp;<span class="ident" id="4554190">k</span><span class="op" id="4554191">)</span><br>
<span class="lineno"></span><span class="op" id="4554193">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4554196">var</span>&nbsp;<span class="ident" id="4554200">mask</span>&nbsp;<span class="op" id="4554205">=</span>&nbsp;<span class="op" id="4554207">[</span><span class="op" id="4554208">]</span><span class="builtintype" id="4554209">byte</span><span class="op" id="4554213">{</span><span class="num" id="4554214">0xff</span><span class="op" id="4554218">,</span>&nbsp;<span class="num" id="4554220">0x1</span><span class="op" id="4554223">,</span>&nbsp;<span class="num" id="4554225">0x3</span><span class="op" id="4554228">,</span>&nbsp;<span class="num" id="4554230">0x7</span><span class="op" id="4554233">,</span>&nbsp;<span class="num" id="4554235">0xf</span><span class="op" id="4554238">,</span>&nbsp;<span class="num" id="4554240">0x1f</span><span class="op" id="4554244">,</span>&nbsp;<span class="num" id="4554246">0x3f</span><span class="op" id="4554250">,</span>&nbsp;<span class="num" id="4554252">0x7f</span><span class="op" id="4554256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4554259">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4554328">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4554396">func</span>&nbsp;<span class="ident" id="4554401">GenerateKey</span><span class="op" id="4554412">(</span><span class="ident" id="4554413">curve</span>&nbsp;<span class="ident" id="4554419">Curve</span><span class="op" id="4554424">,</span>&nbsp;<span class="ident" id="4554426">rand</span>&nbsp;<span class="ident" id="4554431">io</span><span class="op" id="4554433">.</span><span class="ident" id="4554434">Reader</span><span class="op" id="4554440">)</span>&nbsp;<span class="op" id="4554442">(</span><span class="ident" id="4554443">priv</span>&nbsp;<span class="op" id="4554448">[</span><span class="op" id="4554449">]</span><span class="builtintype" id="4554450">byte</span><span class="op" id="4554454">,</span>&nbsp;<span class="ident" id="4554456">x</span><span class="op" id="4554457">,</span>&nbsp;<span class="ident" id="4554459">y</span>&nbsp;<span class="op" id="4554461">*</span><span class="ident" id="4554462">big</span><span class="op" id="4554465">.</span><span class="ident" id="4554466">Int</span><span class="op" id="4554469">,</span>&nbsp;<span class="ident" id="4554471">err</span>&nbsp;<span class="builtintype" id="4554475">error</span><span class="op" id="4554480">)</span>&nbsp;<span class="op" id="4554482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4554485">bitSize</span>&nbsp;<span class="op" id="4554493">:=</span>&nbsp;<span class="ident" id="4554496">curve</span><span class="op" id="4554501">.</span><span class="ident" id="4554502">Params</span><span class="op" id="4554508">(</span><span class="op" id="4554509">)</span><span class="op" id="4554510">.</span><span class="ident" id="4554511">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4554520">byteLen</span>&nbsp;<span class="op" id="4554528">:=</span>&nbsp;<span class="op" id="4554531">(</span><span class="ident" id="4554532">bitSize</span>&nbsp;<span class="op" id="4554540">+</span>&nbsp;<span class="num" id="4554542">7</span><span class="op" id="4554543">)</span>&nbsp;<span class="op" id="4554545">&gt;&gt;</span>&nbsp;<span class="num" id="4554548">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4554551">priv</span>&nbsp;<span class="op" id="4554556">=</span>&nbsp;<span class="builtinfunc" id="4554558">make</span><span class="op" id="4554562">(</span><span class="op" id="4554563">[</span><span class="op" id="4554564">]</span><span class="builtintype" id="4554565">byte</span><span class="op" id="4554569">,</span>&nbsp;<span class="ident" id="4554571">byteLen</span><span class="op" id="4554578">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554582">for</span>&nbsp;<span class="ident" id="4554586">x</span>&nbsp;<span class="op" id="4554588">==</span>&nbsp;<span class="builtintype" id="4554591">nil</span>&nbsp;<span class="op" id="4554595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4554599">_</span><span class="op" id="4554600">,</span>&nbsp;<span class="ident" id="4554602">err</span>&nbsp;<span class="op" id="4554606">=</span>&nbsp;<span class="ident" id="4554608">io</span><span class="op" id="4554610">.</span><span class="ident" id="4554611">ReadFull</span><span class="op" id="4554619">(</span><span class="ident" id="4554620">rand</span><span class="op" id="4554624">,</span>&nbsp;<span class="ident" id="4554626">priv</span><span class="op" id="4554630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554634">if</span>&nbsp;<span class="ident" id="4554637">err</span>&nbsp;<span class="op" id="4554641">!=</span>&nbsp;<span class="builtintype" id="4554644">nil</span>&nbsp;<span class="op" id="4554648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4554653">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4554662">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554666">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554740">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4554794">priv</span><span class="op" id="4554798">[</span><span class="num" id="4554799">0</span><span class="op" id="4554800">]</span>&nbsp;<span class="op" id="4554802">&amp;=</span>&nbsp;<span class="ident" id="4554805">mask</span><span class="op" id="4554809">[</span><span class="ident" id="4554810">bitSize</span><span class="op" id="4554817">%</span><span class="num" id="4554818">8</span><span class="op" id="4554819">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554823">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4554895">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4554952">priv</span><span class="op" id="4554956">[</span><span class="num" id="4554957">1</span><span class="op" id="4554958">]</span>&nbsp;<span class="op" id="4554960">^=</span>&nbsp;<span class="num" id="4554963">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4554970">x</span><span class="op" id="4554971">,</span>&nbsp;<span class="ident" id="4554973">y</span>&nbsp;<span class="op" id="4554975">=</span>&nbsp;<span class="ident" id="4554977">curve</span><span class="op" id="4554982">.</span><span class="ident" id="4554983">ScalarBaseMult</span><span class="op" id="4554997">(</span><span class="ident" id="4554998">priv</span><span class="op" id="4555002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4555005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555008">return</span><br>
<span class="lineno"></span><span class="op" id="4555015">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4555018">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4555102">func</span>&nbsp;<span class="ident" id="4555107">Marshal</span><span class="op" id="4555114">(</span><span class="ident" id="4555115">curve</span>&nbsp;<span class="ident" id="4555121">Curve</span><span class="op" id="4555126">,</span>&nbsp;<span class="ident" id="4555128">x</span><span class="op" id="4555129">,</span>&nbsp;<span class="ident" id="4555131">y</span>&nbsp;<span class="op" id="4555133">*</span><span class="ident" id="4555134">big</span><span class="op" id="4555137">.</span><span class="ident" id="4555138">Int</span><span class="op" id="4555141">)</span>&nbsp;<span class="op" id="4555143">[</span><span class="op" id="4555144">]</span><span class="builtintype" id="4555145">byte</span>&nbsp;<span class="op" id="4555150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555153">byteLen</span>&nbsp;<span class="op" id="4555161">:=</span>&nbsp;<span class="op" id="4555164">(</span><span class="ident" id="4555165">curve</span><span class="op" id="4555170">.</span><span class="ident" id="4555171">Params</span><span class="op" id="4555177">(</span><span class="op" id="4555178">)</span><span class="op" id="4555179">.</span><span class="ident" id="4555180">BitSize</span>&nbsp;<span class="op" id="4555188">+</span>&nbsp;<span class="num" id="4555190">7</span><span class="op" id="4555191">)</span>&nbsp;<span class="op" id="4555193">&gt;&gt;</span>&nbsp;<span class="num" id="4555196">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555200">ret</span>&nbsp;<span class="op" id="4555204">:=</span>&nbsp;<span class="builtinfunc" id="4555207">make</span><span class="op" id="4555211">(</span><span class="op" id="4555212">[</span><span class="op" id="4555213">]</span><span class="builtintype" id="4555214">byte</span><span class="op" id="4555218">,</span>&nbsp;<span class="num" id="4555220">1</span><span class="op" id="4555221">+</span><span class="num" id="4555222">2</span><span class="op" id="4555223">*</span><span class="ident" id="4555224">byteLen</span><span class="op" id="4555231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555234">ret</span><span class="op" id="4555237">[</span><span class="num" id="4555238">0</span><span class="op" id="4555239">]</span>&nbsp;<span class="op" id="4555241">=</span>&nbsp;<span class="num" id="4555243">4</span>&nbsp;<span class="comment" id="4555245">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555269">xBytes</span>&nbsp;<span class="op" id="4555276">:=</span>&nbsp;<span class="ident" id="4555279">x</span><span class="op" id="4555280">.</span><span class="ident" id="4555281">Bytes</span><span class="op" id="4555286">(</span><span class="op" id="4555287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4555290">copy</span><span class="op" id="4555294">(</span><span class="ident" id="4555295">ret</span><span class="op" id="4555298">[</span><span class="num" id="4555299">1</span><span class="op" id="4555300">+</span><span class="ident" id="4555301">byteLen</span><span class="op" id="4555308">-</span><span class="builtinfunc" id="4555309">len</span><span class="op" id="4555312">(</span><span class="ident" id="4555313">xBytes</span><span class="op" id="4555319">)</span><span class="op" id="4555320">:</span><span class="op" id="4555321">]</span><span class="op" id="4555322">,</span>&nbsp;<span class="ident" id="4555324">xBytes</span><span class="op" id="4555330">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555333">yBytes</span>&nbsp;<span class="op" id="4555340">:=</span>&nbsp;<span class="ident" id="4555343">y</span><span class="op" id="4555344">.</span><span class="ident" id="4555345">Bytes</span><span class="op" id="4555350">(</span><span class="op" id="4555351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4555354">copy</span><span class="op" id="4555358">(</span><span class="ident" id="4555359">ret</span><span class="op" id="4555362">[</span><span class="num" id="4555363">1</span><span class="op" id="4555364">+</span><span class="num" id="4555365">2</span><span class="op" id="4555366">*</span><span class="ident" id="4555367">byteLen</span><span class="op" id="4555374">-</span><span class="builtinfunc" id="4555375">len</span><span class="op" id="4555378">(</span><span class="ident" id="4555379">yBytes</span><span class="op" id="4555385">)</span><span class="op" id="4555386">:</span><span class="op" id="4555387">]</span><span class="op" id="4555388">,</span>&nbsp;<span class="ident" id="4555390">yBytes</span><span class="op" id="4555396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555399">return</span>&nbsp;<span class="ident" id="4555406">ret</span><br>
<span class="lineno"></span><span class="op" id="4555410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4555413">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4555505">func</span>&nbsp;<span class="ident" id="4555510">Unmarshal</span><span class="op" id="4555519">(</span><span class="ident" id="4555520">curve</span>&nbsp;<span class="ident" id="4555526">Curve</span><span class="op" id="4555531">,</span>&nbsp;<span class="ident" id="4555533">data</span>&nbsp;<span class="op" id="4555538">[</span><span class="op" id="4555539">]</span><span class="builtintype" id="4555540">byte</span><span class="op" id="4555544">)</span>&nbsp;<span class="op" id="4555546">(</span><span class="ident" id="4555547">x</span><span class="op" id="4555548">,</span>&nbsp;<span class="ident" id="4555550">y</span>&nbsp;<span class="op" id="4555552">*</span><span class="ident" id="4555553">big</span><span class="op" id="4555556">.</span><span class="ident" id="4555557">Int</span><span class="op" id="4555560">)</span>&nbsp;<span class="op" id="4555562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555565">byteLen</span>&nbsp;<span class="op" id="4555573">:=</span>&nbsp;<span class="op" id="4555576">(</span><span class="ident" id="4555577">curve</span><span class="op" id="4555582">.</span><span class="ident" id="4555583">Params</span><span class="op" id="4555589">(</span><span class="op" id="4555590">)</span><span class="op" id="4555591">.</span><span class="ident" id="4555592">BitSize</span>&nbsp;<span class="op" id="4555600">+</span>&nbsp;<span class="num" id="4555602">7</span><span class="op" id="4555603">)</span>&nbsp;<span class="op" id="4555605">&gt;&gt;</span>&nbsp;<span class="num" id="4555608">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555611">if</span>&nbsp;<span class="builtinfunc" id="4555614">len</span><span class="op" id="4555617">(</span><span class="ident" id="4555618">data</span><span class="op" id="4555622">)</span>&nbsp;<span class="op" id="4555624">!=</span>&nbsp;<span class="num" id="4555627">1</span><span class="op" id="4555628">+</span><span class="num" id="4555629">2</span><span class="op" id="4555630">*</span><span class="ident" id="4555631">byteLen</span>&nbsp;<span class="op" id="4555639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555643">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4555651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555654">if</span>&nbsp;<span class="ident" id="4555657">data</span><span class="op" id="4555661">[</span><span class="num" id="4555662">0</span><span class="op" id="4555663">]</span>&nbsp;<span class="op" id="4555665">!=</span>&nbsp;<span class="num" id="4555668">4</span>&nbsp;<span class="op" id="4555670">{</span>&nbsp;<span class="comment" id="4555672">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555695">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4555703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555706">x</span>&nbsp;<span class="op" id="4555708">=</span>&nbsp;<span class="builtinfunc" id="4555710">new</span><span class="op" id="4555713">(</span><span class="ident" id="4555714">big</span><span class="op" id="4555717">.</span><span class="ident" id="4555718">Int</span><span class="op" id="4555721">)</span><span class="op" id="4555722">.</span><span class="ident" id="4555723">SetBytes</span><span class="op" id="4555731">(</span><span class="ident" id="4555732">data</span><span class="op" id="4555736">[</span><span class="num" id="4555737">1</span>&nbsp;<span class="op" id="4555739">:</span>&nbsp;<span class="num" id="4555741">1</span><span class="op" id="4555742">+</span><span class="ident" id="4555743">byteLen</span><span class="op" id="4555750">]</span><span class="op" id="4555751">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555754">y</span>&nbsp;<span class="op" id="4555756">=</span>&nbsp;<span class="builtinfunc" id="4555758">new</span><span class="op" id="4555761">(</span><span class="ident" id="4555762">big</span><span class="op" id="4555765">.</span><span class="ident" id="4555766">Int</span><span class="op" id="4555769">)</span><span class="op" id="4555770">.</span><span class="ident" id="4555771">SetBytes</span><span class="op" id="4555779">(</span><span class="ident" id="4555780">data</span><span class="op" id="4555784">[</span><span class="num" id="4555785">1</span><span class="op" id="4555786">+</span><span class="ident" id="4555787">byteLen</span><span class="op" id="4555794">:</span><span class="op" id="4555795">]</span><span class="op" id="4555796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4555799">return</span><br>
<span class="lineno"></span><span class="op" id="4555806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4555809">var</span>&nbsp;<span class="ident" id="4555813">initonce</span>&nbsp;<span class="ident" id="4555822">sync</span><span class="op" id="4555826">.</span><span class="ident" id="4555827">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4555832">var</span>&nbsp;<span class="ident" id="4555836">p384</span>&nbsp;<span class="op" id="4555841">*</span><span class="ident" id="4555842">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4555854">var</span>&nbsp;<span class="ident" id="4555858">p521</span>&nbsp;<span class="op" id="4555863">*</span><span class="ident" id="4555864">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4555877">func</span>&nbsp;<span class="ident" id="4555882">initAll</span><span class="op" id="4555889">(</span><span class="op" id="4555890">)</span>&nbsp;<span class="op" id="4555892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555895">initP224</span><span class="op" id="4555903">(</span><span class="op" id="4555904">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555907">initP256</span><span class="op" id="4555915">(</span><span class="op" id="4555916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555919">initP384</span><span class="op" id="4555927">(</span><span class="op" id="4555928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555931">initP521</span><span class="op" id="4555939">(</span><span class="op" id="4555940">)</span><br>
<span class="lineno"></span><span class="op" id="4555942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4555945">func</span>&nbsp;<span class="ident" id="4555950">initP384</span><span class="op" id="4555958">(</span><span class="op" id="4555959">)</span>&nbsp;<span class="op" id="4555961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4555964">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4555998">p384</span>&nbsp;<span class="op" id="4556003">=</span>&nbsp;<span class="builtinfunc" id="4556005">new</span><span class="op" id="4556008">(</span><span class="ident" id="4556009">CurveParams</span><span class="op" id="4556020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556023">p384</span><span class="op" id="4556027">.</span><span class="ident" id="4556028">P</span><span class="op" id="4556029">,</span>&nbsp;<span class="ident" id="4556031">_</span>&nbsp;<span class="op" id="4556033">=</span>&nbsp;<span class="builtinfunc" id="4556035">new</span><span class="op" id="4556038">(</span><span class="ident" id="4556039">big</span><span class="op" id="4556042">.</span><span class="ident" id="4556043">Int</span><span class="op" id="4556046">)</span><span class="op" id="4556047">.</span><span class="ident" id="4556048">SetString</span><span class="op" id="4556057">(</span><span class="string" id="4556058">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4556176">,</span>&nbsp;<span class="num" id="4556178">10</span><span class="op" id="4556180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556183">p384</span><span class="op" id="4556187">.</span><span class="ident" id="4556188">N</span><span class="op" id="4556189">,</span>&nbsp;<span class="ident" id="4556191">_</span>&nbsp;<span class="op" id="4556193">=</span>&nbsp;<span class="builtinfunc" id="4556195">new</span><span class="op" id="4556198">(</span><span class="ident" id="4556199">big</span><span class="op" id="4556202">.</span><span class="ident" id="4556203">Int</span><span class="op" id="4556206">)</span><span class="op" id="4556207">.</span><span class="ident" id="4556208">SetString</span><span class="op" id="4556217">(</span><span class="string" id="4556218">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4556336">,</span>&nbsp;<span class="num" id="4556338">10</span><span class="op" id="4556340">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556343">p384</span><span class="op" id="4556347">.</span><span class="ident" id="4556348">B</span><span class="op" id="4556349">,</span>&nbsp;<span class="ident" id="4556351">_</span>&nbsp;<span class="op" id="4556353">=</span>&nbsp;<span class="builtinfunc" id="4556355">new</span><span class="op" id="4556358">(</span><span class="ident" id="4556359">big</span><span class="op" id="4556362">.</span><span class="ident" id="4556363">Int</span><span class="op" id="4556366">)</span><span class="op" id="4556367">.</span><span class="ident" id="4556368">SetString</span><span class="op" id="4556377">(</span><span class="string" id="4556378">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4556476">,</span>&nbsp;<span class="num" id="4556478">16</span><span class="op" id="4556480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556483">p384</span><span class="op" id="4556487">.</span><span class="ident" id="4556488">Gx</span><span class="op" id="4556490">,</span>&nbsp;<span class="ident" id="4556492">_</span>&nbsp;<span class="op" id="4556494">=</span>&nbsp;<span class="builtinfunc" id="4556496">new</span><span class="op" id="4556499">(</span><span class="ident" id="4556500">big</span><span class="op" id="4556503">.</span><span class="ident" id="4556504">Int</span><span class="op" id="4556507">)</span><span class="op" id="4556508">.</span><span class="ident" id="4556509">SetString</span><span class="op" id="4556518">(</span><span class="string" id="4556519">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4556617">,</span>&nbsp;<span class="num" id="4556619">16</span><span class="op" id="4556621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556624">p384</span><span class="op" id="4556628">.</span><span class="ident" id="4556629">Gy</span><span class="op" id="4556631">,</span>&nbsp;<span class="ident" id="4556633">_</span>&nbsp;<span class="op" id="4556635">=</span>&nbsp;<span class="builtinfunc" id="4556637">new</span><span class="op" id="4556640">(</span><span class="ident" id="4556641">big</span><span class="op" id="4556644">.</span><span class="ident" id="4556645">Int</span><span class="op" id="4556648">)</span><span class="op" id="4556649">.</span><span class="ident" id="4556650">SetString</span><span class="op" id="4556659">(</span><span class="string" id="4556660">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4556758">,</span>&nbsp;<span class="num" id="4556760">16</span><span class="op" id="4556762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556765">p384</span><span class="op" id="4556769">.</span><span class="ident" id="4556770">BitSize</span>&nbsp;<span class="op" id="4556778">=</span>&nbsp;<span class="num" id="4556780">384</span><br>
<span class="lineno"></span><span class="op" id="4556784">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4556787">func</span>&nbsp;<span class="ident" id="4556792">initP521</span><span class="op" id="4556800">(</span><span class="op" id="4556801">)</span>&nbsp;<span class="op" id="4556803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4556806">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556840">p521</span>&nbsp;<span class="op" id="4556845">=</span>&nbsp;<span class="builtinfunc" id="4556847">new</span><span class="op" id="4556850">(</span><span class="ident" id="4556851">CurveParams</span><span class="op" id="4556862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4556865">p521</span><span class="op" id="4556869">.</span><span class="ident" id="4556870">P</span><span class="op" id="4556871">,</span>&nbsp;<span class="ident" id="4556873">_</span>&nbsp;<span class="op" id="4556875">=</span>&nbsp;<span class="builtinfunc" id="4556877">new</span><span class="op" id="4556880">(</span><span class="ident" id="4556881">big</span><span class="op" id="4556884">.</span><span class="ident" id="4556885">Int</span><span class="op" id="4556888">)</span><span class="op" id="4556889">.</span><span class="ident" id="4556890">SetString</span><span class="op" id="4556899">(</span><span class="string" id="4556900">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4557059">,</span>&nbsp;<span class="num" id="4557061">10</span><span class="op" id="4557063">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557066">p521</span><span class="op" id="4557070">.</span><span class="ident" id="4557071">N</span><span class="op" id="4557072">,</span>&nbsp;<span class="ident" id="4557074">_</span>&nbsp;<span class="op" id="4557076">=</span>&nbsp;<span class="builtinfunc" id="4557078">new</span><span class="op" id="4557081">(</span><span class="ident" id="4557082">big</span><span class="op" id="4557085">.</span><span class="ident" id="4557086">Int</span><span class="op" id="4557089">)</span><span class="op" id="4557090">.</span><span class="ident" id="4557091">SetString</span><span class="op" id="4557100">(</span><span class="string" id="4557101">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4557260">,</span>&nbsp;<span class="num" id="4557262">10</span><span class="op" id="4557264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557267">p521</span><span class="op" id="4557271">.</span><span class="ident" id="4557272">B</span><span class="op" id="4557273">,</span>&nbsp;<span class="ident" id="4557275">_</span>&nbsp;<span class="op" id="4557277">=</span>&nbsp;<span class="builtinfunc" id="4557279">new</span><span class="op" id="4557282">(</span><span class="ident" id="4557283">big</span><span class="op" id="4557286">.</span><span class="ident" id="4557287">Int</span><span class="op" id="4557290">)</span><span class="op" id="4557291">.</span><span class="ident" id="4557292">SetString</span><span class="op" id="4557301">(</span><span class="string" id="4557302">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4557435">,</span>&nbsp;<span class="num" id="4557437">16</span><span class="op" id="4557439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557442">p521</span><span class="op" id="4557446">.</span><span class="ident" id="4557447">Gx</span><span class="op" id="4557449">,</span>&nbsp;<span class="ident" id="4557451">_</span>&nbsp;<span class="op" id="4557453">=</span>&nbsp;<span class="builtinfunc" id="4557455">new</span><span class="op" id="4557458">(</span><span class="ident" id="4557459">big</span><span class="op" id="4557462">.</span><span class="ident" id="4557463">Int</span><span class="op" id="4557466">)</span><span class="op" id="4557467">.</span><span class="ident" id="4557468">SetString</span><span class="op" id="4557477">(</span><span class="string" id="4557478">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4557610">,</span>&nbsp;<span class="num" id="4557612">16</span><span class="op" id="4557614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557617">p521</span><span class="op" id="4557621">.</span><span class="ident" id="4557622">Gy</span><span class="op" id="4557624">,</span>&nbsp;<span class="ident" id="4557626">_</span>&nbsp;<span class="op" id="4557628">=</span>&nbsp;<span class="builtinfunc" id="4557630">new</span><span class="op" id="4557633">(</span><span class="ident" id="4557634">big</span><span class="op" id="4557637">.</span><span class="ident" id="4557638">Int</span><span class="op" id="4557641">)</span><span class="op" id="4557642">.</span><span class="ident" id="4557643">SetString</span><span class="op" id="4557652">(</span><span class="string" id="4557653">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4557786">,</span>&nbsp;<span class="num" id="4557788">16</span><span class="op" id="4557790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557793">p521</span><span class="op" id="4557797">.</span><span class="ident" id="4557798">BitSize</span>&nbsp;<span class="op" id="4557806">=</span>&nbsp;<span class="num" id="4557808">521</span><br>
<span class="lineno">355</span><span class="op" id="4557812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4557815">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4557894">func</span>&nbsp;<span class="ident" id="4557899">P256</span><span class="op" id="4557903">(</span><span class="op" id="4557904">)</span>&nbsp;<span class="ident" id="4557906">Curve</span>&nbsp;<span class="op" id="4557912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4557915">initonce</span><span class="op" id="4557923">.</span><span class="ident" id="4557924">Do</span><span class="op" id="4557926">(</span><span class="ident" id="4557927">initAll</span><span class="op" id="4557934">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4557937">return</span>&nbsp;<span class="ident" id="4557944">p256</span><br>
<span class="lineno"></span><span class="op" id="4557949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4557952">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4558031">func</span>&nbsp;<span class="ident" id="4558036">P384</span><span class="op" id="4558040">(</span><span class="op" id="4558041">)</span>&nbsp;<span class="ident" id="4558043">Curve</span>&nbsp;<span class="op" id="4558049">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4558052">initonce</span><span class="op" id="4558060">.</span><span class="ident" id="4558061">Do</span><span class="op" id="4558063">(</span><span class="ident" id="4558064">initAll</span><span class="op" id="4558071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558074">return</span>&nbsp;<span class="ident" id="4558081">p384</span><br>
<span class="lineno"></span><span class="op" id="4558086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4558089">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4558168">func</span>&nbsp;<span class="ident" id="4558173">P521</span><span class="op" id="4558177">(</span><span class="op" id="4558178">)</span>&nbsp;<span class="ident" id="4558180">Curve</span>&nbsp;<span class="op" id="4558186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4558189">initonce</span><span class="op" id="4558197">.</span><span class="ident" id="4558198">Do</span><span class="op" id="4558200">(</span><span class="ident" id="4558201">initAll</span><span class="op" id="4558208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4558211">return</span>&nbsp;<span class="ident" id="4558218">p521</span><br>
<span class="lineno"></span><span class="op" id="4558223">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
