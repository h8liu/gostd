<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1409014">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1409070">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1409124">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1409175">package</span>&nbsp;<span class="ident" id="1409183">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1409188">import</span>&nbsp;<span class="op" id="1409195">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1409198">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1409204">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1409215">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1409224">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1409227">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="1409293">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="1409362">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="1409376">func</span>&nbsp;<span class="ident" id="1409381">interfaceTable</span><span class="op" id="1409395">(</span><span class="ident" id="1409396">ifindex</span>&nbsp;<span class="builtintype" id="1409404">int</span><span class="op" id="1409407">)</span>&nbsp;<span class="op" id="1409409">(</span><span class="op" id="1409410">[</span><span class="op" id="1409411">]</span><span class="ident" id="1409412"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1409421">,</span>&nbsp;<span class="builtintype" id="1409423">error</span><span class="op" id="1409428">)</span>&nbsp;<span class="op" id="1409430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1409433">tab</span><span class="op" id="1409436">,</span>&nbsp;<span class="ident" id="1409438">err</span>&nbsp;<span class="op" id="1409442">:=</span>&nbsp;<span class="ident" id="1409445"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1409452">.</span><span class="ident" id="1409453">NetlinkRIB</span><span class="op" id="1409463">(</span><span class="ident" id="1409464"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1409471">.</span><span class="ident" id="1409472">RTM_GETLINK</span><span class="op" id="1409483">,</span>&nbsp;<span class="ident" id="1409485"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1409492">.</span><span class="ident" id="1409493">AF_UNSPEC</span><span class="op" id="1409502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409505">if</span>&nbsp;<span class="ident" id="1409508"><a href="/net/interface_linux.go.html#1409438">err</a></span>&nbsp;<span class="op" id="1409512">!=</span>&nbsp;<span class="ident" id="1409515">nil</span>&nbsp;<span class="op" id="1409519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409523">return</span>&nbsp;<span class="ident" id="1409530">nil</span><span class="op" id="1409533">,</span>&nbsp;<span class="ident" id="1409535"><a href="/net/interface_linux.go.html#1409198">os</a></span><span class="op" id="1409537">.</span><span class="ident" id="1409538">NewSyscallError</span><span class="op" id="1409553">(</span><span class="string" id="1409554">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="1409567">,</span>&nbsp;<span class="ident" id="1409569"><a href="/net/interface_linux.go.html#1409438">err</a></span><span class="op" id="1409572">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1409575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1409578">msgs</span><span class="op" id="1409582">,</span>&nbsp;<span class="ident" id="1409584"><a href="/net/interface_linux.go.html#1409438">err</a></span>&nbsp;<span class="op" id="1409588">:=</span>&nbsp;<span class="ident" id="1409591"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1409598">.</span><span class="ident" id="1409599">ParseNetlinkMessage</span><span class="op" id="1409618">(</span><span class="ident" id="1409619"><a href="/net/interface_linux.go.html#1409433">tab</a></span><span class="op" id="1409622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409625">if</span>&nbsp;<span class="ident" id="1409628"><a href="/net/interface_linux.go.html#1409438">err</a></span>&nbsp;<span class="op" id="1409632">!=</span>&nbsp;<span class="ident" id="1409635">nil</span>&nbsp;<span class="op" id="1409639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409643">return</span>&nbsp;<span class="ident" id="1409650">nil</span><span class="op" id="1409653">,</span>&nbsp;<span class="ident" id="1409655"><a href="/net/interface_linux.go.html#1409198">os</a></span><span class="op" id="1409657">.</span><span class="ident" id="1409658">NewSyscallError</span><span class="op" id="1409673">(</span><span class="string" id="1409674">&#34;netlink&nbsp;message&#34;</span><span class="op" id="1409691">,</span>&nbsp;<span class="ident" id="1409693"><a href="/net/interface_linux.go.html#1409438">err</a></span><span class="op" id="1409696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1409699">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409702">var</span>&nbsp;<span class="ident" id="1409706">ift</span>&nbsp;<span class="op" id="1409710">[</span><span class="op" id="1409711">]</span><span class="ident" id="1409712"><a href="/net/interface.go.html#1406383">Interface</a></span><br>
<span class="lineno"></span><span class="ident" id="1409722">loop</span><span class="op" id="1409726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409729">for</span>&nbsp;<span class="ident" id="1409733">_</span><span class="op" id="1409734">,</span>&nbsp;<span class="ident" id="1409736">m</span>&nbsp;<span class="op" id="1409738">:=</span>&nbsp;<span class="keyword" id="1409741">range</span>&nbsp;<span class="ident" id="1409747"><a href="/net/interface_linux.go.html#1409578">msgs</a></span>&nbsp;<span class="op" id="1409752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409756">switch</span>&nbsp;<span class="ident" id="1409763"><a href="/net/interface_linux.go.html#1409736">m</a></span><span class="op" id="1409764">.</span><span class="ident" id="1409765">Header</span><span class="op" id="1409771">.</span><span class="ident" id="1409772">Type</span>&nbsp;<span class="op" id="1409777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409781">case</span>&nbsp;<span class="ident" id="1409786"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1409793">.</span><span class="ident" id="1409794">NLMSG_DONE</span><span class="op" id="1409804">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409809">break</span>&nbsp;<span class="ident" id="1409815">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409822">case</span>&nbsp;<span class="ident" id="1409827"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1409834">.</span><span class="ident" id="1409835">RTM_NEWLINK</span><span class="op" id="1409846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1409851">ifim</span>&nbsp;<span class="op" id="1409856">:=</span>&nbsp;<span class="op" id="1409859">(</span><span class="op" id="1409860">*</span><span class="ident" id="1409861"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1409868">.</span><span class="ident" id="1409869">IfInfomsg</span><span class="op" id="1409878">)</span><span class="op" id="1409879">(</span><span class="ident" id="1409880"><a href="/net/interface_linux.go.html#1409215">unsafe</a></span><span class="op" id="1409886">.</span><span class="ident" id="1409887">Pointer</span><span class="op" id="1409894">(</span><span class="op" id="1409895">&amp;</span><span class="ident" id="1409896"><a href="/net/interface_linux.go.html#1409736">m</a></span><span class="op" id="1409897">.</span><span class="ident" id="1409898">Data</span><span class="op" id="1409902">[</span><span class="num" id="1409903">0</span><span class="op" id="1409904">]</span><span class="op" id="1409905">)</span><span class="op" id="1409906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1409911">if</span>&nbsp;<span class="ident" id="1409914"><a href="/net/interface_linux.go.html#1409396">ifindex</a></span>&nbsp;<span class="op" id="1409922">==</span>&nbsp;<span class="num" id="1409925">0</span>&nbsp;<span class="op" id="1409927">||</span>&nbsp;<span class="ident" id="1409930"><a href="/net/interface_linux.go.html#1409396">ifindex</a></span>&nbsp;<span class="op" id="1409938">==</span>&nbsp;<span class="builtintype" id="1409941">int</span><span class="op" id="1409944">(</span><span class="ident" id="1409945"><a href="/net/interface_linux.go.html#1409851">ifim</a></span><span class="op" id="1409949">.</span><span class="ident" id="1409950">Index</span><span class="op" id="1409955">)</span>&nbsp;<span class="op" id="1409957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1409963">attrs</span><span class="op" id="1409968">,</span>&nbsp;<span class="ident" id="1409970">err</span>&nbsp;<span class="op" id="1409974">:=</span>&nbsp;<span class="ident" id="1409977"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1409984">.</span><span class="ident" id="1409985">ParseNetlinkRouteAttr</span><span class="op" id="1410006">(</span><span class="op" id="1410007">&amp;</span><span class="ident" id="1410008"><a href="/net/interface_linux.go.html#1409736">m</a></span><span class="op" id="1410009">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410015">if</span>&nbsp;<span class="ident" id="1410018"><a href="/net/interface_linux.go.html#1409970">err</a></span>&nbsp;<span class="op" id="1410022">!=</span>&nbsp;<span class="ident" id="1410025">nil</span>&nbsp;<span class="op" id="1410029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410036">return</span>&nbsp;<span class="ident" id="1410043">nil</span><span class="op" id="1410046">,</span>&nbsp;<span class="ident" id="1410048"><a href="/net/interface_linux.go.html#1409198">os</a></span><span class="op" id="1410050">.</span><span class="ident" id="1410051">NewSyscallError</span><span class="op" id="1410066">(</span><span class="string" id="1410067">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="1410086">,</span>&nbsp;<span class="ident" id="1410088"><a href="/net/interface_linux.go.html#1409970">err</a></span><span class="op" id="1410091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1410097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1410103"><a href="/net/interface_linux.go.html#1409706">ift</a></span>&nbsp;<span class="op" id="1410107">=</span>&nbsp;<span class="builtinfunc" id="1410109">append</span><span class="op" id="1410115">(</span><span class="ident" id="1410116"><a href="/net/interface_linux.go.html#1409706">ift</a></span><span class="op" id="1410119">,</span>&nbsp;<span class="op" id="1410121">*</span><span class="ident" id="1410122"><a href="/net/interface_linux.go.html#1410642">newLink</a></span><span class="op" id="1410129">(</span><span class="ident" id="1410130"><a href="/net/interface_linux.go.html#1409851">ifim</a></span><span class="op" id="1410134">,</span>&nbsp;<span class="ident" id="1410136"><a href="/net/interface_linux.go.html#1409963">attrs</a></span><span class="op" id="1410141">)</span><span class="op" id="1410142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410148">if</span>&nbsp;<span class="ident" id="1410151"><a href="/net/interface_linux.go.html#1409396">ifindex</a></span>&nbsp;<span class="op" id="1410159">==</span>&nbsp;<span class="builtintype" id="1410162">int</span><span class="op" id="1410165">(</span><span class="ident" id="1410166"><a href="/net/interface_linux.go.html#1409851">ifim</a></span><span class="op" id="1410170">.</span><span class="ident" id="1410171">Index</span><span class="op" id="1410176">)</span>&nbsp;<span class="op" id="1410178">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410185">break</span>&nbsp;<span class="ident" id="1410191">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1410200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1410205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1410209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1410212">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410215">return</span>&nbsp;<span class="ident" id="1410222"><a href="/net/interface_linux.go.html#1409706">ift</a></span><span class="op" id="1410225">,</span>&nbsp;<span class="ident" id="1410227">nil</span><br>
<span class="lineno"></span><span class="op" id="1410231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1410234">const</span>&nbsp;<span class="op" id="1410240">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1410243">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1410267">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1410329">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="1410352">=</span>&nbsp;<span class="num" id="1410354">768</span>&nbsp;<span class="comment" id="1410358">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1410387">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="1410410">=</span>&nbsp;<span class="num" id="1410412">769</span>&nbsp;<span class="comment" id="1410416">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1410445">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="1410468">=</span>&nbsp;<span class="num" id="1410470">776</span>&nbsp;<span class="comment" id="1410474">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1410503">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="1410526">=</span>&nbsp;<span class="num" id="1410528">778</span>&nbsp;<span class="comment" id="1410532">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1410569">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="1410592">=</span>&nbsp;<span class="num" id="1410594">823</span>&nbsp;<span class="comment" id="1410598">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="1410634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1410637">func</span>&nbsp;<span class="ident" id="1410642">newLink</span><span class="op" id="1410649">(</span><span class="ident" id="1410650">ifim</span>&nbsp;<span class="op" id="1410655">*</span><span class="ident" id="1410656"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1410663">.</span><span class="ident" id="1410664">IfInfomsg</span><span class="op" id="1410673">,</span>&nbsp;<span class="ident" id="1410675">attrs</span>&nbsp;<span class="op" id="1410681">[</span><span class="op" id="1410682">]</span><span class="ident" id="1410683"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1410690">.</span><span class="ident" id="1410691">NetlinkRouteAttr</span><span class="op" id="1410707">)</span>&nbsp;<span class="op" id="1410709">*</span><span class="ident" id="1410710"><a href="/net/interface.go.html#1406383">Interface</a></span>&nbsp;<span class="op" id="1410720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1410723">ifi</span>&nbsp;<span class="op" id="1410727">:=</span>&nbsp;<span class="op" id="1410730">&amp;</span><span class="ident" id="1410731"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1410740">{</span><span class="ident" id="1410741">Index</span><span class="op" id="1410746">:</span>&nbsp;<span class="builtintype" id="1410748">int</span><span class="op" id="1410751">(</span><span class="ident" id="1410752"><a href="/net/interface_linux.go.html#1410650">ifim</a></span><span class="op" id="1410756">.</span><span class="ident" id="1410757">Index</span><span class="op" id="1410762">)</span><span class="op" id="1410763">,</span>&nbsp;<span class="ident" id="1410765">Flags</span><span class="op" id="1410770">:</span>&nbsp;<span class="ident" id="1410772"><a href="/net/interface_linux.go.html#1411633">linkFlags</a></span><span class="op" id="1410781">(</span><span class="ident" id="1410782"><a href="/net/interface_linux.go.html#1410650">ifim</a></span><span class="op" id="1410786">.</span><span class="ident" id="1410787">Flags</span><span class="op" id="1410792">)</span><span class="op" id="1410793">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410796">for</span>&nbsp;<span class="ident" id="1410800">_</span><span class="op" id="1410801">,</span>&nbsp;<span class="ident" id="1410803">a</span>&nbsp;<span class="op" id="1410805">:=</span>&nbsp;<span class="keyword" id="1410808">range</span>&nbsp;<span class="ident" id="1410814"><a href="/net/interface_linux.go.html#1410675">attrs</a></span>&nbsp;<span class="op" id="1410820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410824">switch</span>&nbsp;<span class="ident" id="1410831"><a href="/net/interface_linux.go.html#1410803">a</a></span><span class="op" id="1410832">.</span><span class="ident" id="1410833">Attr</span><span class="op" id="1410837">.</span><span class="ident" id="1410838">Type</span>&nbsp;<span class="op" id="1410843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410847">case</span>&nbsp;<span class="ident" id="1410852"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1410859">.</span><span class="ident" id="1410860">IFLA_ADDRESS</span><span class="op" id="1410872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1410877">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1410926">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1410973">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1410997">switch</span>&nbsp;<span class="builtinfunc" id="1411004">len</span><span class="op" id="1411007">(</span><span class="ident" id="1411008"><a href="/net/interface_linux.go.html#1410803">a</a></span><span class="op" id="1411009">.</span><span class="ident" id="1411010">Value</span><span class="op" id="1411015">)</span>&nbsp;<span class="op" id="1411017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411022">case</span>&nbsp;<span class="ident" id="1411027"><a href="/net/ip.go.html#1416769">IPv4len</a></span><span class="op" id="1411034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411040">switch</span>&nbsp;<span class="ident" id="1411047"><a href="/net/interface_linux.go.html#1410650">ifim</a></span><span class="op" id="1411051">.</span><span class="ident" id="1411052">Type</span>&nbsp;<span class="op" id="1411057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411063">case</span>&nbsp;<span class="ident" id="1411068"><a href="/net/interface_linux.go.html#1410329">sysARPHardwareIPv4IPv4</a></span><span class="op" id="1411090">,</span>&nbsp;<span class="ident" id="1411092"><a href="/net/interface_linux.go.html#1410503">sysARPHardwareGREIPv4</a></span><span class="op" id="1411113">,</span>&nbsp;<span class="ident" id="1411115"><a href="/net/interface_linux.go.html#1410445">sysARPHardwareIPv6IPv4</a></span><span class="op" id="1411137">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411144">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411162">case</span>&nbsp;<span class="ident" id="1411167"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1411174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411180">switch</span>&nbsp;<span class="ident" id="1411187"><a href="/net/interface_linux.go.html#1410650">ifim</a></span><span class="op" id="1411191">.</span><span class="ident" id="1411192">Type</span>&nbsp;<span class="op" id="1411197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411203">case</span>&nbsp;<span class="ident" id="1411208"><a href="/net/interface_linux.go.html#1410387">sysARPHardwareIPv6IPv6</a></span><span class="op" id="1411230">,</span>&nbsp;<span class="ident" id="1411232"><a href="/net/interface_linux.go.html#1410569">sysARPHardwareGREIPv6</a></span><span class="op" id="1411253">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411260">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411283">var</span>&nbsp;<span class="ident" id="1411287">nonzero</span>&nbsp;<span class="builtintype" id="1411295">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411303">for</span>&nbsp;<span class="ident" id="1411307">_</span><span class="op" id="1411308">,</span>&nbsp;<span class="ident" id="1411310">b</span>&nbsp;<span class="op" id="1411312">:=</span>&nbsp;<span class="keyword" id="1411315">range</span>&nbsp;<span class="ident" id="1411321"><a href="/net/interface_linux.go.html#1410803">a</a></span><span class="op" id="1411322">.</span><span class="ident" id="1411323">Value</span>&nbsp;<span class="op" id="1411329">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411335">if</span>&nbsp;<span class="ident" id="1411338"><a href="/net/interface_linux.go.html#1411310">b</a></span>&nbsp;<span class="op" id="1411340">!=</span>&nbsp;<span class="num" id="1411343">0</span>&nbsp;<span class="op" id="1411345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411352"><a href="/net/interface_linux.go.html#1411287">nonzero</a></span>&nbsp;<span class="op" id="1411360">=</span>&nbsp;<span class="builtintype" id="1411362">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411372">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411387">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411392">if</span>&nbsp;<span class="ident" id="1411395"><a href="/net/interface_linux.go.html#1411287">nonzero</a></span>&nbsp;<span class="op" id="1411403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411409"><a href="/net/interface_linux.go.html#1410723">ifi</a></span><span class="op" id="1411412">.</span><span class="ident" id="1411413">HardwareAddr</span>&nbsp;<span class="op" id="1411426">=</span>&nbsp;<span class="ident" id="1411428"><a href="/net/interface_linux.go.html#1410803">a</a></span><span class="op" id="1411429">.</span><span class="ident" id="1411430">Value</span><span class="op" id="1411435">[</span><span class="op" id="1411436">:</span><span class="op" id="1411437">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411446">case</span>&nbsp;<span class="ident" id="1411451"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1411458">.</span><span class="ident" id="1411459">IFLA_IFNAME</span><span class="op" id="1411470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411475"><a href="/net/interface_linux.go.html#1410723">ifi</a></span><span class="op" id="1411478">.</span><span class="ident" id="1411479">Name</span>&nbsp;<span class="op" id="1411484">=</span>&nbsp;<span class="builtintype" id="1411486">string</span><span class="op" id="1411492">(</span><span class="ident" id="1411493"><a href="/net/interface_linux.go.html#1410803">a</a></span><span class="op" id="1411494">.</span><span class="ident" id="1411495">Value</span><span class="op" id="1411500">[</span><span class="op" id="1411501">:</span><span class="builtinfunc" id="1411502">len</span><span class="op" id="1411505">(</span><span class="ident" id="1411506"><a href="/net/interface_linux.go.html#1410803">a</a></span><span class="op" id="1411507">.</span><span class="ident" id="1411508">Value</span><span class="op" id="1411513">)</span><span class="op" id="1411514">-</span><span class="num" id="1411515">1</span><span class="op" id="1411516">]</span><span class="op" id="1411517">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411521">case</span>&nbsp;<span class="ident" id="1411526"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1411533">.</span><span class="ident" id="1411534">IFLA_MTU</span><span class="op" id="1411542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411547"><a href="/net/interface_linux.go.html#1410723">ifi</a></span><span class="op" id="1411550">.</span><span class="ident" id="1411551">MTU</span>&nbsp;<span class="op" id="1411555">=</span>&nbsp;<span class="builtintype" id="1411557">int</span><span class="op" id="1411560">(</span><span class="op" id="1411561">*</span><span class="op" id="1411562">(</span><span class="op" id="1411563">*</span><span class="builtintype" id="1411564">uint32</span><span class="op" id="1411570">)</span><span class="op" id="1411571">(</span><span class="ident" id="1411572"><a href="/net/interface_linux.go.html#1409215">unsafe</a></span><span class="op" id="1411578">.</span><span class="ident" id="1411579">Pointer</span><span class="op" id="1411586">(</span><span class="op" id="1411587">&amp;</span><span class="ident" id="1411588"><a href="/net/interface_linux.go.html#1410803">a</a></span><span class="op" id="1411589">.</span><span class="ident" id="1411590">Value</span><span class="op" id="1411595">[</span><span class="op" id="1411596">:</span><span class="num" id="1411597">4</span><span class="op" id="1411598">]</span><span class="op" id="1411599">[</span><span class="num" id="1411600">0</span><span class="op" id="1411601">]</span><span class="op" id="1411602">)</span><span class="op" id="1411603">)</span><span class="op" id="1411604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411614">return</span>&nbsp;<span class="ident" id="1411621"><a href="/net/interface_linux.go.html#1410723">ifi</a></span><br>
<span class="lineno">95</span><span class="op" id="1411625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1411628">func</span>&nbsp;<span class="ident" id="1411633">linkFlags</span><span class="op" id="1411642">(</span><span class="ident" id="1411643">rawFlags</span>&nbsp;<span class="builtintype" id="1411652">uint32</span><span class="op" id="1411658">)</span>&nbsp;<span class="ident" id="1411660"><a href="/net/interface.go.html#1406751">Flags</a></span>&nbsp;<span class="op" id="1411666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411669">var</span>&nbsp;<span class="ident" id="1411673">f</span>&nbsp;<span class="ident" id="1411675"><a href="/net/interface.go.html#1406751">Flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411682">if</span>&nbsp;<span class="ident" id="1411685"><a href="/net/interface_linux.go.html#1411643">rawFlags</a></span><span class="op" id="1411693">&amp;</span><span class="ident" id="1411694"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1411701">.</span><span class="ident" id="1411702">IFF_UP</span>&nbsp;<span class="op" id="1411709">!=</span>&nbsp;<span class="num" id="1411712">0</span>&nbsp;<span class="op" id="1411714">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411718"><a href="/net/interface_linux.go.html#1411673">f</a></span>&nbsp;<span class="op" id="1411720">|=</span>&nbsp;<span class="ident" id="1411723"><a href="/net/interface.go.html#1406772">FlagUp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411734">if</span>&nbsp;<span class="ident" id="1411737"><a href="/net/interface_linux.go.html#1411643">rawFlags</a></span><span class="op" id="1411745">&amp;</span><span class="ident" id="1411746"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1411753">.</span><span class="ident" id="1411754">IFF_BROADCAST</span>&nbsp;<span class="op" id="1411768">!=</span>&nbsp;<span class="num" id="1411771">0</span>&nbsp;<span class="op" id="1411773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411777"><a href="/net/interface_linux.go.html#1411673">f</a></span>&nbsp;<span class="op" id="1411779">|=</span>&nbsp;<span class="ident" id="1411782"><a href="/net/interface.go.html#1406827">FlagBroadcast</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411797">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411800">if</span>&nbsp;<span class="ident" id="1411803"><a href="/net/interface_linux.go.html#1411643">rawFlags</a></span><span class="op" id="1411811">&amp;</span><span class="ident" id="1411812"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1411819">.</span><span class="ident" id="1411820">IFF_LOOPBACK</span>&nbsp;<span class="op" id="1411833">!=</span>&nbsp;<span class="num" id="1411836">0</span>&nbsp;<span class="op" id="1411838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411842"><a href="/net/interface_linux.go.html#1411673">f</a></span>&nbsp;<span class="op" id="1411844">|=</span>&nbsp;<span class="ident" id="1411847"><a href="/net/interface.go.html#1406913">FlagLoopback</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411864">if</span>&nbsp;<span class="ident" id="1411867"><a href="/net/interface_linux.go.html#1411643">rawFlags</a></span><span class="op" id="1411875">&amp;</span><span class="ident" id="1411876"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1411883">.</span><span class="ident" id="1411884">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="1411900">!=</span>&nbsp;<span class="num" id="1411903">0</span>&nbsp;<span class="op" id="1411905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411909"><a href="/net/interface_linux.go.html#1411673">f</a></span>&nbsp;<span class="op" id="1411911">|=</span>&nbsp;<span class="ident" id="1411914"><a href="/net/interface.go.html#1406986">FlagPointToPoint</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1411935">if</span>&nbsp;<span class="ident" id="1411938"><a href="/net/interface_linux.go.html#1411643">rawFlags</a></span><span class="op" id="1411946">&amp;</span><span class="ident" id="1411947"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1411954">.</span><span class="ident" id="1411955">IFF_MULTICAST</span>&nbsp;<span class="op" id="1411969">!=</span>&nbsp;<span class="num" id="1411972">0</span>&nbsp;<span class="op" id="1411974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411978"><a href="/net/interface_linux.go.html#1411673">f</a></span>&nbsp;<span class="op" id="1411980">|=</span>&nbsp;<span class="ident" id="1411983"><a href="/net/interface.go.html#1407068">FlagMulticast</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1411998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412001">return</span>&nbsp;<span class="ident" id="1412008"><a href="/net/interface_linux.go.html#1411673">f</a></span><br>
<span class="lineno">115</span><span class="op" id="1412010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1412013">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="1412080">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="1412150">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="1412164">func</span>&nbsp;<span class="ident" id="1412169">interfaceAddrTable</span><span class="op" id="1412187">(</span><span class="ident" id="1412188">ifi</span>&nbsp;<span class="op" id="1412192">*</span><span class="ident" id="1412193"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1412202">)</span>&nbsp;<span class="op" id="1412204">(</span><span class="op" id="1412205">[</span><span class="op" id="1412206">]</span><span class="ident" id="1412207"><a href="/net/net.go.html#1465097">Addr</a></span><span class="op" id="1412211">,</span>&nbsp;<span class="builtintype" id="1412213">error</span><span class="op" id="1412218">)</span>&nbsp;<span class="op" id="1412220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1412223">tab</span><span class="op" id="1412226">,</span>&nbsp;<span class="ident" id="1412228">err</span>&nbsp;<span class="op" id="1412232">:=</span>&nbsp;<span class="ident" id="1412235"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1412242">.</span><span class="ident" id="1412243">NetlinkRIB</span><span class="op" id="1412253">(</span><span class="ident" id="1412254"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1412261">.</span><span class="ident" id="1412262">RTM_GETADDR</span><span class="op" id="1412273">,</span>&nbsp;<span class="ident" id="1412275"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1412282">.</span><span class="ident" id="1412283">AF_UNSPEC</span><span class="op" id="1412292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412295">if</span>&nbsp;<span class="ident" id="1412298"><a href="/net/interface_linux.go.html#1412228">err</a></span>&nbsp;<span class="op" id="1412302">!=</span>&nbsp;<span class="ident" id="1412305">nil</span>&nbsp;<span class="op" id="1412309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412313">return</span>&nbsp;<span class="ident" id="1412320">nil</span><span class="op" id="1412323">,</span>&nbsp;<span class="ident" id="1412325"><a href="/net/interface_linux.go.html#1409198">os</a></span><span class="op" id="1412327">.</span><span class="ident" id="1412328">NewSyscallError</span><span class="op" id="1412343">(</span><span class="string" id="1412344">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="1412357">,</span>&nbsp;<span class="ident" id="1412359"><a href="/net/interface_linux.go.html#1412228">err</a></span><span class="op" id="1412362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1412365">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1412368">msgs</span><span class="op" id="1412372">,</span>&nbsp;<span class="ident" id="1412374"><a href="/net/interface_linux.go.html#1412228">err</a></span>&nbsp;<span class="op" id="1412378">:=</span>&nbsp;<span class="ident" id="1412381"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1412388">.</span><span class="ident" id="1412389">ParseNetlinkMessage</span><span class="op" id="1412408">(</span><span class="ident" id="1412409"><a href="/net/interface_linux.go.html#1412223">tab</a></span><span class="op" id="1412412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412415">if</span>&nbsp;<span class="ident" id="1412418"><a href="/net/interface_linux.go.html#1412228">err</a></span>&nbsp;<span class="op" id="1412422">!=</span>&nbsp;<span class="ident" id="1412425">nil</span>&nbsp;<span class="op" id="1412429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412433">return</span>&nbsp;<span class="ident" id="1412440">nil</span><span class="op" id="1412443">,</span>&nbsp;<span class="ident" id="1412445"><a href="/net/interface_linux.go.html#1409198">os</a></span><span class="op" id="1412447">.</span><span class="ident" id="1412448">NewSyscallError</span><span class="op" id="1412463">(</span><span class="string" id="1412464">&#34;netlink&nbsp;message&#34;</span><span class="op" id="1412481">,</span>&nbsp;<span class="ident" id="1412483"><a href="/net/interface_linux.go.html#1412228">err</a></span><span class="op" id="1412486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1412489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412492">var</span>&nbsp;<span class="ident" id="1412496">ift</span>&nbsp;<span class="op" id="1412500">[</span><span class="op" id="1412501">]</span><span class="ident" id="1412502"><a href="/net/interface.go.html#1406383">Interface</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412513">if</span>&nbsp;<span class="ident" id="1412516"><a href="/net/interface_linux.go.html#1412188">ifi</a></span>&nbsp;<span class="op" id="1412520">==</span>&nbsp;<span class="ident" id="1412523">nil</span>&nbsp;<span class="op" id="1412527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412531">var</span>&nbsp;<span class="ident" id="1412535">err</span>&nbsp;<span class="builtintype" id="1412539">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1412547"><a href="/net/interface_linux.go.html#1412496">ift</a></span><span class="op" id="1412550">,</span>&nbsp;<span class="ident" id="1412552"><a href="/net/interface_linux.go.html#1412535">err</a></span>&nbsp;<span class="op" id="1412556">=</span>&nbsp;<span class="ident" id="1412558"><a href="/net/interface_linux.go.html#1409381">interfaceTable</a></span><span class="op" id="1412572">(</span><span class="num" id="1412573">0</span><span class="op" id="1412574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412578">if</span>&nbsp;<span class="ident" id="1412581"><a href="/net/interface_linux.go.html#1412535">err</a></span>&nbsp;<span class="op" id="1412585">!=</span>&nbsp;<span class="ident" id="1412588">nil</span>&nbsp;<span class="op" id="1412592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412597">return</span>&nbsp;<span class="ident" id="1412604">nil</span><span class="op" id="1412607">,</span>&nbsp;<span class="ident" id="1412609"><a href="/net/interface_linux.go.html#1412535">err</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1412615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1412618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1412621">ifat</span><span class="op" id="1412625">,</span>&nbsp;<span class="ident" id="1412627"><a href="/net/interface_linux.go.html#1412228">err</a></span>&nbsp;<span class="op" id="1412631">:=</span>&nbsp;<span class="ident" id="1412634"><a href="/net/interface_linux.go.html#1412724">addrTable</a></span><span class="op" id="1412643">(</span><span class="ident" id="1412644"><a href="/net/interface_linux.go.html#1412496">ift</a></span><span class="op" id="1412647">,</span>&nbsp;<span class="ident" id="1412649"><a href="/net/interface_linux.go.html#1412188">ifi</a></span><span class="op" id="1412652">,</span>&nbsp;<span class="ident" id="1412654"><a href="/net/interface_linux.go.html#1412368">msgs</a></span><span class="op" id="1412658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412661">if</span>&nbsp;<span class="ident" id="1412664"><a href="/net/interface_linux.go.html#1412228">err</a></span>&nbsp;<span class="op" id="1412668">!=</span>&nbsp;<span class="ident" id="1412671">nil</span>&nbsp;<span class="op" id="1412675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412679">return</span>&nbsp;<span class="ident" id="1412686">nil</span><span class="op" id="1412689">,</span>&nbsp;<span class="ident" id="1412691"><a href="/net/interface_linux.go.html#1412228">err</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1412696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412699">return</span>&nbsp;<span class="ident" id="1412706"><a href="/net/interface_linux.go.html#1412621">ifat</a></span><span class="op" id="1412710">,</span>&nbsp;<span class="ident" id="1412712">nil</span><br>
<span class="lineno"></span><span class="op" id="1412716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1412719">func</span>&nbsp;<span class="ident" id="1412724">addrTable</span><span class="op" id="1412733">(</span><span class="ident" id="1412734">ift</span>&nbsp;<span class="op" id="1412738">[</span><span class="op" id="1412739">]</span><span class="ident" id="1412740"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1412749">,</span>&nbsp;<span class="ident" id="1412751">ifi</span>&nbsp;<span class="op" id="1412755">*</span><span class="ident" id="1412756"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1412765">,</span>&nbsp;<span class="ident" id="1412767">msgs</span>&nbsp;<span class="op" id="1412772">[</span><span class="op" id="1412773">]</span><span class="ident" id="1412774"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1412781">.</span><span class="ident" id="1412782">NetlinkMessage</span><span class="op" id="1412796">)</span>&nbsp;<span class="op" id="1412798">(</span><span class="op" id="1412799">[</span><span class="op" id="1412800">]</span><span class="ident" id="1412801"><a href="/net/net.go.html#1465097">Addr</a></span><span class="op" id="1412805">,</span>&nbsp;<span class="builtintype" id="1412807">error</span><span class="op" id="1412812">)</span>&nbsp;<span class="op" id="1412814">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412817">var</span>&nbsp;<span class="ident" id="1412821">ifat</span>&nbsp;<span class="op" id="1412826">[</span><span class="op" id="1412827">]</span><span class="ident" id="1412828"><a href="/net/net.go.html#1465097">Addr</a></span><br>
<span class="lineno"></span><span class="ident" id="1412833">loop</span><span class="op" id="1412837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412840">for</span>&nbsp;<span class="ident" id="1412844">_</span><span class="op" id="1412845">,</span>&nbsp;<span class="ident" id="1412847">m</span>&nbsp;<span class="op" id="1412849">:=</span>&nbsp;<span class="keyword" id="1412852">range</span>&nbsp;<span class="ident" id="1412858"><a href="/net/interface_linux.go.html#1412767">msgs</a></span>&nbsp;<span class="op" id="1412863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412867">switch</span>&nbsp;<span class="ident" id="1412874"><a href="/net/interface_linux.go.html#1412847">m</a></span><span class="op" id="1412875">.</span><span class="ident" id="1412876">Header</span><span class="op" id="1412882">.</span><span class="ident" id="1412883">Type</span>&nbsp;<span class="op" id="1412888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412892">case</span>&nbsp;<span class="ident" id="1412897"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1412904">.</span><span class="ident" id="1412905">NLMSG_DONE</span><span class="op" id="1412915">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412920">break</span>&nbsp;<span class="ident" id="1412926">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1412933">case</span>&nbsp;<span class="ident" id="1412938"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1412945">.</span><span class="ident" id="1412946">RTM_NEWADDR</span><span class="op" id="1412957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1412962">ifam</span>&nbsp;<span class="op" id="1412967">:=</span>&nbsp;<span class="op" id="1412970">(</span><span class="op" id="1412971">*</span><span class="ident" id="1412972"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1412979">.</span><span class="ident" id="1412980">IfAddrmsg</span><span class="op" id="1412989">)</span><span class="op" id="1412990">(</span><span class="ident" id="1412991"><a href="/net/interface_linux.go.html#1409215">unsafe</a></span><span class="op" id="1412997">.</span><span class="ident" id="1412998">Pointer</span><span class="op" id="1413005">(</span><span class="op" id="1413006">&amp;</span><span class="ident" id="1413007"><a href="/net/interface_linux.go.html#1412847">m</a></span><span class="op" id="1413008">.</span><span class="ident" id="1413009">Data</span><span class="op" id="1413013">[</span><span class="num" id="1413014">0</span><span class="op" id="1413015">]</span><span class="op" id="1413016">)</span><span class="op" id="1413017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413022">if</span>&nbsp;<span class="builtinfunc" id="1413025">len</span><span class="op" id="1413028">(</span><span class="ident" id="1413029"><a href="/net/interface_linux.go.html#1412734">ift</a></span><span class="op" id="1413032">)</span>&nbsp;<span class="op" id="1413034">!=</span>&nbsp;<span class="num" id="1413037">0</span>&nbsp;<span class="op" id="1413039">||</span>&nbsp;<span class="ident" id="1413042"><a href="/net/interface_linux.go.html#1412751">ifi</a></span><span class="op" id="1413045">.</span><span class="ident" id="1413046">Index</span>&nbsp;<span class="op" id="1413052">==</span>&nbsp;<span class="builtintype" id="1413055">int</span><span class="op" id="1413058">(</span><span class="ident" id="1413059"><a href="/net/interface_linux.go.html#1412962">ifam</a></span><span class="op" id="1413063">.</span><span class="ident" id="1413064">Index</span><span class="op" id="1413069">)</span>&nbsp;<span class="op" id="1413071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413077">if</span>&nbsp;<span class="builtinfunc" id="1413080">len</span><span class="op" id="1413083">(</span><span class="ident" id="1413084"><a href="/net/interface_linux.go.html#1412734">ift</a></span><span class="op" id="1413087">)</span>&nbsp;<span class="op" id="1413089">!=</span>&nbsp;<span class="num" id="1413092">0</span>&nbsp;<span class="op" id="1413094">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413101">var</span>&nbsp;<span class="ident" id="1413105">err</span>&nbsp;<span class="builtintype" id="1413109">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413120"><a href="/net/interface_linux.go.html#1412751">ifi</a></span><span class="op" id="1413123">,</span>&nbsp;<span class="ident" id="1413125"><a href="/net/interface_linux.go.html#1413105">err</a></span>&nbsp;<span class="op" id="1413129">=</span>&nbsp;<span class="ident" id="1413131"><a href="/net/interface.go.html#1408476">interfaceByIndex</a></span><span class="op" id="1413147">(</span><span class="ident" id="1413148"><a href="/net/interface_linux.go.html#1412734">ift</a></span><span class="op" id="1413151">,</span>&nbsp;<span class="builtintype" id="1413153">int</span><span class="op" id="1413156">(</span><span class="ident" id="1413157"><a href="/net/interface_linux.go.html#1412962">ifam</a></span><span class="op" id="1413161">.</span><span class="ident" id="1413162">Index</span><span class="op" id="1413167">)</span><span class="op" id="1413168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413175">if</span>&nbsp;<span class="ident" id="1413178"><a href="/net/interface_linux.go.html#1413105">err</a></span>&nbsp;<span class="op" id="1413182">!=</span>&nbsp;<span class="ident" id="1413185">nil</span>&nbsp;<span class="op" id="1413189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413197">return</span>&nbsp;<span class="ident" id="1413204">nil</span><span class="op" id="1413207">,</span>&nbsp;<span class="ident" id="1413209"><a href="/net/interface_linux.go.html#1413105">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413218">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413230">attrs</span><span class="op" id="1413235">,</span>&nbsp;<span class="ident" id="1413237">err</span>&nbsp;<span class="op" id="1413241">:=</span>&nbsp;<span class="ident" id="1413244"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1413251">.</span><span class="ident" id="1413252">ParseNetlinkRouteAttr</span><span class="op" id="1413273">(</span><span class="op" id="1413274">&amp;</span><span class="ident" id="1413275"><a href="/net/interface_linux.go.html#1412847">m</a></span><span class="op" id="1413276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413282">if</span>&nbsp;<span class="ident" id="1413285"><a href="/net/interface_linux.go.html#1413237">err</a></span>&nbsp;<span class="op" id="1413289">!=</span>&nbsp;<span class="ident" id="1413292">nil</span>&nbsp;<span class="op" id="1413296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413303">return</span>&nbsp;<span class="ident" id="1413310">nil</span><span class="op" id="1413313">,</span>&nbsp;<span class="ident" id="1413315"><a href="/net/interface_linux.go.html#1409198">os</a></span><span class="op" id="1413317">.</span><span class="ident" id="1413318">NewSyscallError</span><span class="op" id="1413333">(</span><span class="string" id="1413334">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="1413353">,</span>&nbsp;<span class="ident" id="1413355"><a href="/net/interface_linux.go.html#1413237">err</a></span><span class="op" id="1413358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413364">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413370">ifa</span>&nbsp;<span class="op" id="1413374">:=</span>&nbsp;<span class="ident" id="1413377"><a href="/net/interface_linux.go.html#1413497">newAddr</a></span><span class="op" id="1413384">(</span><span class="ident" id="1413385"><a href="/net/interface_linux.go.html#1412751">ifi</a></span><span class="op" id="1413388">,</span>&nbsp;<span class="ident" id="1413390"><a href="/net/interface_linux.go.html#1412962">ifam</a></span><span class="op" id="1413394">,</span>&nbsp;<span class="ident" id="1413396"><a href="/net/interface_linux.go.html#1413230">attrs</a></span><span class="op" id="1413401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413407">if</span>&nbsp;<span class="ident" id="1413410"><a href="/net/interface_linux.go.html#1413370">ifa</a></span>&nbsp;<span class="op" id="1413414">!=</span>&nbsp;<span class="ident" id="1413417">nil</span>&nbsp;<span class="op" id="1413421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413428"><a href="/net/interface_linux.go.html#1412821">ifat</a></span>&nbsp;<span class="op" id="1413433">=</span>&nbsp;<span class="builtinfunc" id="1413435">append</span><span class="op" id="1413441">(</span><span class="ident" id="1413442"><a href="/net/interface_linux.go.html#1412821">ifat</a></span><span class="op" id="1413446">,</span>&nbsp;<span class="ident" id="1413448"><a href="/net/interface_linux.go.html#1413370">ifa</a></span><span class="op" id="1413451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413462">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413472">return</span>&nbsp;<span class="ident" id="1413479"><a href="/net/interface_linux.go.html#1412821">ifat</a></span><span class="op" id="1413483">,</span>&nbsp;<span class="ident" id="1413485">nil</span><br>
<span class="lineno"></span><span class="op" id="1413489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="1413492">func</span>&nbsp;<span class="ident" id="1413497">newAddr</span><span class="op" id="1413504">(</span><span class="ident" id="1413505">ifi</span>&nbsp;<span class="op" id="1413509">*</span><span class="ident" id="1413510"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1413519">,</span>&nbsp;<span class="ident" id="1413521">ifam</span>&nbsp;<span class="op" id="1413526">*</span><span class="ident" id="1413527"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1413534">.</span><span class="ident" id="1413535">IfAddrmsg</span><span class="op" id="1413544">,</span>&nbsp;<span class="ident" id="1413546">attrs</span>&nbsp;<span class="op" id="1413552">[</span><span class="op" id="1413553">]</span><span class="ident" id="1413554"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1413561">.</span><span class="ident" id="1413562">NetlinkRouteAttr</span><span class="op" id="1413578">)</span>&nbsp;<span class="ident" id="1413580"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1413585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413588">var</span>&nbsp;<span class="ident" id="1413592">ipPointToPoint</span>&nbsp;<span class="builtintype" id="1413607">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1413613">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1413674">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1413737">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413792">if</span>&nbsp;<span class="ident" id="1413795"><a href="/net/interface_linux.go.html#1413505">ifi</a></span><span class="op" id="1413798">.</span><span class="ident" id="1413799">Flags</span><span class="op" id="1413804">&amp;</span><span class="ident" id="1413805"><a href="/net/interface.go.html#1406986">FlagPointToPoint</a></span>&nbsp;<span class="op" id="1413822">!=</span>&nbsp;<span class="num" id="1413825">0</span>&nbsp;<span class="op" id="1413827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413831">for</span>&nbsp;<span class="ident" id="1413835">_</span><span class="op" id="1413836">,</span>&nbsp;<span class="ident" id="1413838">a</span>&nbsp;<span class="op" id="1413840">:=</span>&nbsp;<span class="keyword" id="1413843">range</span>&nbsp;<span class="ident" id="1413849"><a href="/net/interface_linux.go.html#1413546">attrs</a></span>&nbsp;<span class="op" id="1413855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413860">if</span>&nbsp;<span class="ident" id="1413863"><a href="/net/interface_linux.go.html#1413838">a</a></span><span class="op" id="1413864">.</span><span class="ident" id="1413865">Attr</span><span class="op" id="1413869">.</span><span class="ident" id="1413870">Type</span>&nbsp;<span class="op" id="1413875">==</span>&nbsp;<span class="ident" id="1413878"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1413885">.</span><span class="ident" id="1413886">IFA_LOCAL</span>&nbsp;<span class="op" id="1413896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413902"><a href="/net/interface_linux.go.html#1413592">ipPointToPoint</a></span>&nbsp;<span class="op" id="1413917">=</span>&nbsp;<span class="builtintype" id="1413919">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413928">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1413944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413947">for</span>&nbsp;<span class="ident" id="1413951">_</span><span class="op" id="1413952">,</span>&nbsp;<span class="ident" id="1413954">a</span>&nbsp;<span class="op" id="1413956">:=</span>&nbsp;<span class="keyword" id="1413959">range</span>&nbsp;<span class="ident" id="1413965"><a href="/net/interface_linux.go.html#1413546">attrs</a></span>&nbsp;<span class="op" id="1413971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1413975">if</span>&nbsp;<span class="ident" id="1413978"><a href="/net/interface_linux.go.html#1413592">ipPointToPoint</a></span>&nbsp;<span class="op" id="1413993">&amp;&amp;</span>&nbsp;<span class="ident" id="1413996"><a href="/net/interface_linux.go.html#1413954">a</a></span><span class="op" id="1413997">.</span><span class="ident" id="1413998">Attr</span><span class="op" id="1414002">.</span><span class="ident" id="1414003">Type</span>&nbsp;<span class="op" id="1414008">==</span>&nbsp;<span class="ident" id="1414011"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1414018">.</span><span class="ident" id="1414019">IFA_ADDRESS</span>&nbsp;<span class="op" id="1414031">||</span>&nbsp;<span class="op" id="1414034">!</span><span class="ident" id="1414035"><a href="/net/interface_linux.go.html#1413592">ipPointToPoint</a></span>&nbsp;<span class="op" id="1414050">&amp;&amp;</span>&nbsp;<span class="ident" id="1414053"><a href="/net/interface_linux.go.html#1413954">a</a></span><span class="op" id="1414054">.</span><span class="ident" id="1414055">Attr</span><span class="op" id="1414059">.</span><span class="ident" id="1414060">Type</span>&nbsp;<span class="op" id="1414065">==</span>&nbsp;<span class="ident" id="1414068"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1414075">.</span><span class="ident" id="1414076">IFA_LOCAL</span>&nbsp;<span class="op" id="1414086">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414091">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1414102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414106">switch</span>&nbsp;<span class="ident" id="1414113"><a href="/net/interface_linux.go.html#1413521">ifam</a></span><span class="op" id="1414117">.</span><span class="ident" id="1414118">Family</span>&nbsp;<span class="op" id="1414125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414129">case</span>&nbsp;<span class="ident" id="1414134"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1414141">.</span><span class="ident" id="1414142">AF_INET</span><span class="op" id="1414149">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414154">return</span>&nbsp;<span class="op" id="1414161">&amp;</span><span class="ident" id="1414162"><a href="/net/ip.go.html#1417295">IPNet</a></span><span class="op" id="1414167">{</span><span class="ident" id="1414168">IP</span><span class="op" id="1414170">:</span>&nbsp;<span class="ident" id="1414172"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1414176">(</span><span class="ident" id="1414177"><a href="/net/interface_linux.go.html#1413954">a</a></span><span class="op" id="1414178">.</span><span class="ident" id="1414179">Value</span><span class="op" id="1414184">[</span><span class="num" id="1414185">0</span><span class="op" id="1414186">]</span><span class="op" id="1414187">,</span>&nbsp;<span class="ident" id="1414189"><a href="/net/interface_linux.go.html#1413954">a</a></span><span class="op" id="1414190">.</span><span class="ident" id="1414191">Value</span><span class="op" id="1414196">[</span><span class="num" id="1414197">1</span><span class="op" id="1414198">]</span><span class="op" id="1414199">,</span>&nbsp;<span class="ident" id="1414201"><a href="/net/interface_linux.go.html#1413954">a</a></span><span class="op" id="1414202">.</span><span class="ident" id="1414203">Value</span><span class="op" id="1414208">[</span><span class="num" id="1414209">2</span><span class="op" id="1414210">]</span><span class="op" id="1414211">,</span>&nbsp;<span class="ident" id="1414213"><a href="/net/interface_linux.go.html#1413954">a</a></span><span class="op" id="1414214">.</span><span class="ident" id="1414215">Value</span><span class="op" id="1414220">[</span><span class="num" id="1414221">3</span><span class="op" id="1414222">]</span><span class="op" id="1414223">)</span><span class="op" id="1414224">,</span>&nbsp;<span class="ident" id="1414226">Mask</span><span class="op" id="1414230">:</span>&nbsp;<span class="ident" id="1414232"><a href="/net/ip.go.html#1418044">CIDRMask</a></span><span class="op" id="1414240">(</span><span class="builtintype" id="1414241">int</span><span class="op" id="1414244">(</span><span class="ident" id="1414245"><a href="/net/interface_linux.go.html#1413521">ifam</a></span><span class="op" id="1414249">.</span><span class="ident" id="1414250">Prefixlen</span><span class="op" id="1414259">)</span><span class="op" id="1414260">,</span>&nbsp;<span class="num" id="1414262">8</span><span class="op" id="1414263">*</span><span class="ident" id="1414264"><a href="/net/ip.go.html#1416769">IPv4len</a></span><span class="op" id="1414271">)</span><span class="op" id="1414272">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414276">case</span>&nbsp;<span class="ident" id="1414281"><a href="/net/interface_linux.go.html#1409204">syscall</a></span><span class="op" id="1414288">.</span><span class="ident" id="1414289">AF_INET6</span><span class="op" id="1414297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414302">ifa</span>&nbsp;<span class="op" id="1414306">:=</span>&nbsp;<span class="op" id="1414309">&amp;</span><span class="ident" id="1414310"><a href="/net/ip.go.html#1417295">IPNet</a></span><span class="op" id="1414315">{</span><span class="ident" id="1414316">IP</span><span class="op" id="1414318">:</span>&nbsp;<span class="builtinfunc" id="1414320">make</span><span class="op" id="1414324">(</span><span class="ident" id="1414325"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1414327">,</span>&nbsp;<span class="ident" id="1414329"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1414336">)</span><span class="op" id="1414337">,</span>&nbsp;<span class="ident" id="1414339">Mask</span><span class="op" id="1414343">:</span>&nbsp;<span class="ident" id="1414345"><a href="/net/ip.go.html#1418044">CIDRMask</a></span><span class="op" id="1414353">(</span><span class="builtintype" id="1414354">int</span><span class="op" id="1414357">(</span><span class="ident" id="1414358"><a href="/net/interface_linux.go.html#1413521">ifam</a></span><span class="op" id="1414362">.</span><span class="ident" id="1414363">Prefixlen</span><span class="op" id="1414372">)</span><span class="op" id="1414373">,</span>&nbsp;<span class="num" id="1414375">8</span><span class="op" id="1414376">*</span><span class="ident" id="1414377"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1414384">)</span><span class="op" id="1414385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1414390">copy</span><span class="op" id="1414394">(</span><span class="ident" id="1414395"><a href="/net/interface_linux.go.html#1414302">ifa</a></span><span class="op" id="1414398">.</span><span class="ident" id="1414399">IP</span><span class="op" id="1414401">,</span>&nbsp;<span class="ident" id="1414403"><a href="/net/interface_linux.go.html#1413954">a</a></span><span class="op" id="1414404">.</span><span class="ident" id="1414405">Value</span><span class="op" id="1414410">[</span><span class="op" id="1414411">:</span><span class="op" id="1414412">]</span><span class="op" id="1414413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414418">return</span>&nbsp;<span class="ident" id="1414425"><a href="/net/interface_linux.go.html#1414302">ifa</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1414431">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1414434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414437">return</span>&nbsp;<span class="ident" id="1414444">nil</span><br>
<span class="lineno"></span><span class="op" id="1414448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1414451">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="1414515">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="1414529">func</span>&nbsp;<span class="ident" id="1414534">interfaceMulticastAddrTable</span><span class="op" id="1414561">(</span><span class="ident" id="1414562">ifi</span>&nbsp;<span class="op" id="1414566">*</span><span class="ident" id="1414567"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1414576">)</span>&nbsp;<span class="op" id="1414578">(</span><span class="op" id="1414579">[</span><span class="op" id="1414580">]</span><span class="ident" id="1414581"><a href="/net/net.go.html#1465097">Addr</a></span><span class="op" id="1414585">,</span>&nbsp;<span class="builtintype" id="1414587">error</span><span class="op" id="1414592">)</span>&nbsp;<span class="op" id="1414594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414597">ifmat4</span>&nbsp;<span class="op" id="1414604">:=</span>&nbsp;<span class="ident" id="1414607"><a href="/net/interface_linux.go.html#1414747">parseProcNetIGMP</a></span><span class="op" id="1414623">(</span><span class="string" id="1414624">&#34;/proc/net/igmp&#34;</span><span class="op" id="1414640">,</span>&nbsp;<span class="ident" id="1414642"><a href="/net/interface_linux.go.html#1414562">ifi</a></span><span class="op" id="1414645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414648">ifmat6</span>&nbsp;<span class="op" id="1414655">:=</span>&nbsp;<span class="ident" id="1414658"><a href="/net/interface_linux.go.html#1415633">parseProcNetIGMP6</a></span><span class="op" id="1414675">(</span><span class="string" id="1414676">&#34;/proc/net/igmp6&#34;</span><span class="op" id="1414693">,</span>&nbsp;<span class="ident" id="1414695"><a href="/net/interface_linux.go.html#1414562">ifi</a></span><span class="op" id="1414698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414701">return</span>&nbsp;<span class="builtinfunc" id="1414708">append</span><span class="op" id="1414714">(</span><span class="ident" id="1414715"><a href="/net/interface_linux.go.html#1414597">ifmat4</a></span><span class="op" id="1414721">,</span>&nbsp;<span class="ident" id="1414723"><a href="/net/interface_linux.go.html#1414648">ifmat6</a></span><span class="op" id="1414729">...</span><span class="op" id="1414732">)</span><span class="op" id="1414733">,</span>&nbsp;<span class="ident" id="1414735">nil</span><br>
<span class="lineno">210</span><span class="op" id="1414739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1414742">func</span>&nbsp;<span class="ident" id="1414747">parseProcNetIGMP</span><span class="op" id="1414763">(</span><span class="ident" id="1414764">path</span>&nbsp;<span class="builtintype" id="1414769">string</span><span class="op" id="1414775">,</span>&nbsp;<span class="ident" id="1414777">ifi</span>&nbsp;<span class="op" id="1414781">*</span><span class="ident" id="1414782"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1414791">)</span>&nbsp;<span class="op" id="1414793">[</span><span class="op" id="1414794">]</span><span class="ident" id="1414795"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1414800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414803">fd</span><span class="op" id="1414805">,</span>&nbsp;<span class="ident" id="1414807">err</span>&nbsp;<span class="op" id="1414811">:=</span>&nbsp;<span class="ident" id="1414814"><a href="/net/parse.go.html#1476797">open</a></span><span class="op" id="1414818">(</span><span class="ident" id="1414819"><a href="/net/interface_linux.go.html#1414764">path</a></span><span class="op" id="1414823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414826">if</span>&nbsp;<span class="ident" id="1414829"><a href="/net/interface_linux.go.html#1414807">err</a></span>&nbsp;<span class="op" id="1414833">!=</span>&nbsp;<span class="ident" id="1414836">nil</span>&nbsp;<span class="op" id="1414840">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414844">return</span>&nbsp;<span class="ident" id="1414851">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1414856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414859">defer</span>&nbsp;<span class="ident" id="1414865"><a href="/net/interface_linux.go.html#1414803">fd</a></span><span class="op" id="1414867">.</span><span class="builtinfunc" id="1414868">close</span><span class="op" id="1414873">(</span><span class="op" id="1414874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414877">var</span>&nbsp;<span class="op" id="1414881">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414885">ifmat</span>&nbsp;<span class="op" id="1414891">[</span><span class="op" id="1414892">]</span><span class="ident" id="1414893"><a href="/net/net.go.html#1465097">Addr</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414900">name</span>&nbsp;&nbsp;<span class="builtintype" id="1414906">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1414914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414917"><a href="/net/interface_linux.go.html#1414803">fd</a></span><span class="op" id="1414919">.</span><span class="ident" id="1414920">readLine</span><span class="op" id="1414928">(</span><span class="op" id="1414929">)</span>&nbsp;<span class="comment" id="1414931">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414951">b</span>&nbsp;<span class="op" id="1414953">:=</span>&nbsp;<span class="builtinfunc" id="1414956">make</span><span class="op" id="1414960">(</span><span class="op" id="1414961">[</span><span class="op" id="1414962">]</span><span class="builtintype" id="1414963">byte</span><span class="op" id="1414967">,</span>&nbsp;<span class="ident" id="1414969"><a href="/net/ip.go.html#1416769">IPv4len</a></span><span class="op" id="1414976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1414979">for</span>&nbsp;<span class="ident" id="1414983">l</span><span class="op" id="1414984">,</span>&nbsp;<span class="ident" id="1414986">ok</span>&nbsp;<span class="op" id="1414989">:=</span>&nbsp;<span class="ident" id="1414992"><a href="/net/interface_linux.go.html#1414803">fd</a></span><span class="op" id="1414994">.</span><span class="ident" id="1414995">readLine</span><span class="op" id="1415003">(</span><span class="op" id="1415004">)</span><span class="op" id="1415005">;</span>&nbsp;<span class="ident" id="1415007"><a href="/net/interface_linux.go.html#1414986">ok</a></span><span class="op" id="1415009">;</span>&nbsp;<span class="ident" id="1415011"><a href="/net/interface_linux.go.html#1414983">l</a></span><span class="op" id="1415012">,</span>&nbsp;<span class="ident" id="1415014"><a href="/net/interface_linux.go.html#1414986">ok</a></span>&nbsp;<span class="op" id="1415017">=</span>&nbsp;<span class="ident" id="1415019"><a href="/net/interface_linux.go.html#1414803">fd</a></span><span class="op" id="1415021">.</span><span class="ident" id="1415022">readLine</span><span class="op" id="1415030">(</span><span class="op" id="1415031">)</span>&nbsp;<span class="op" id="1415033">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415037">f</span>&nbsp;<span class="op" id="1415039">:=</span>&nbsp;<span class="ident" id="1415042"><a href="/net/parse.go.html#1477305">splitAtBytes</a></span><span class="op" id="1415054">(</span><span class="ident" id="1415055"><a href="/net/interface_linux.go.html#1414983">l</a></span><span class="op" id="1415056">,</span>&nbsp;<span class="string" id="1415058">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="1415068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415072">if</span>&nbsp;<span class="builtinfunc" id="1415075">len</span><span class="op" id="1415078">(</span><span class="ident" id="1415079"><a href="/net/interface_linux.go.html#1415037">f</a></span><span class="op" id="1415080">)</span>&nbsp;<span class="op" id="1415082">&lt;</span>&nbsp;<span class="num" id="1415084">4</span>&nbsp;<span class="op" id="1415086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415091">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1415102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415106">switch</span>&nbsp;<span class="op" id="1415113">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415117">case</span>&nbsp;<span class="ident" id="1415122"><a href="/net/interface_linux.go.html#1414983">l</a></span><span class="op" id="1415123">[</span><span class="num" id="1415124">0</span><span class="op" id="1415125">]</span>&nbsp;<span class="op" id="1415127">!=</span>&nbsp;<span class="string" id="1415130">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="1415134">&amp;&amp;</span>&nbsp;<span class="ident" id="1415137"><a href="/net/interface_linux.go.html#1414983">l</a></span><span class="op" id="1415138">[</span><span class="num" id="1415139">0</span><span class="op" id="1415140">]</span>&nbsp;<span class="op" id="1415142">!=</span>&nbsp;<span class="string" id="1415145">&#39;\t&#39;</span><span class="op" id="1415149">:</span>&nbsp;<span class="comment" id="1415151">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415176"><a href="/net/interface_linux.go.html#1414900">name</a></span>&nbsp;<span class="op" id="1415181">=</span>&nbsp;<span class="ident" id="1415183"><a href="/net/interface_linux.go.html#1415037">f</a></span><span class="op" id="1415184">[</span><span class="num" id="1415185">1</span><span class="op" id="1415186">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415190">case</span>&nbsp;<span class="builtinfunc" id="1415195">len</span><span class="op" id="1415198">(</span><span class="ident" id="1415199"><a href="/net/interface_linux.go.html#1415037">f</a></span><span class="op" id="1415200">[</span><span class="num" id="1415201">0</span><span class="op" id="1415202">]</span><span class="op" id="1415203">)</span>&nbsp;<span class="op" id="1415205">==</span>&nbsp;<span class="num" id="1415208">8</span><span class="op" id="1415209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415214">if</span>&nbsp;<span class="ident" id="1415217"><a href="/net/interface_linux.go.html#1414777">ifi</a></span>&nbsp;<span class="op" id="1415221">==</span>&nbsp;<span class="ident" id="1415224">nil</span>&nbsp;<span class="op" id="1415228">||</span>&nbsp;<span class="ident" id="1415231"><a href="/net/interface_linux.go.html#1414900">name</a></span>&nbsp;<span class="op" id="1415236">==</span>&nbsp;<span class="ident" id="1415239"><a href="/net/interface_linux.go.html#1414777">ifi</a></span><span class="op" id="1415242">.</span><span class="ident" id="1415243">Name</span>&nbsp;<span class="op" id="1415248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1415254">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1415290">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1415333">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415352">for</span>&nbsp;<span class="ident" id="1415356">i</span>&nbsp;<span class="op" id="1415358">:=</span>&nbsp;<span class="num" id="1415361">0</span><span class="op" id="1415362">;</span>&nbsp;<span class="ident" id="1415364"><a href="/net/interface_linux.go.html#1415356">i</a></span><span class="op" id="1415365">+</span><span class="num" id="1415366">1</span>&nbsp;<span class="op" id="1415368">&lt;</span>&nbsp;<span class="builtinfunc" id="1415370">len</span><span class="op" id="1415373">(</span><span class="ident" id="1415374"><a href="/net/interface_linux.go.html#1415037">f</a></span><span class="op" id="1415375">[</span><span class="num" id="1415376">0</span><span class="op" id="1415377">]</span><span class="op" id="1415378">)</span><span class="op" id="1415379">;</span>&nbsp;<span class="ident" id="1415381"><a href="/net/interface_linux.go.html#1415356">i</a></span>&nbsp;<span class="op" id="1415383">+=</span>&nbsp;<span class="num" id="1415386">2</span>&nbsp;<span class="op" id="1415388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415395"><a href="/net/interface_linux.go.html#1414951">b</a></span><span class="op" id="1415396">[</span><span class="ident" id="1415397"><a href="/net/interface_linux.go.html#1415356">i</a></span><span class="op" id="1415398">/</span><span class="num" id="1415399">2</span><span class="op" id="1415400">]</span><span class="op" id="1415401">,</span>&nbsp;<span class="ident" id="1415403">_</span>&nbsp;<span class="op" id="1415405">=</span>&nbsp;<span class="ident" id="1415407"><a href="/net/parse.go.html#1478888">xtoi2</a></span><span class="op" id="1415412">(</span><span class="ident" id="1415413"><a href="/net/interface_linux.go.html#1415037">f</a></span><span class="op" id="1415414">[</span><span class="num" id="1415415">0</span><span class="op" id="1415416">]</span><span class="op" id="1415417">[</span><span class="ident" id="1415418"><a href="/net/interface_linux.go.html#1415356">i</a></span><span class="op" id="1415419">:</span><span class="ident" id="1415420"><a href="/net/interface_linux.go.html#1415356">i</a></span><span class="op" id="1415421">+</span><span class="num" id="1415422">2</span><span class="op" id="1415423">]</span><span class="op" id="1415424">,</span>&nbsp;<span class="num" id="1415426">0</span><span class="op" id="1415427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1415433">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415439">i</span>&nbsp;<span class="op" id="1415441">:=</span>&nbsp;<span class="op" id="1415444">*</span><span class="op" id="1415445">(</span><span class="op" id="1415446">*</span><span class="builtintype" id="1415447">uint32</span><span class="op" id="1415453">)</span><span class="op" id="1415454">(</span><span class="ident" id="1415455"><a href="/net/interface_linux.go.html#1409215">unsafe</a></span><span class="op" id="1415461">.</span><span class="ident" id="1415462">Pointer</span><span class="op" id="1415469">(</span><span class="op" id="1415470">&amp;</span><span class="ident" id="1415471"><a href="/net/interface_linux.go.html#1414951">b</a></span><span class="op" id="1415472">[</span><span class="op" id="1415473">:</span><span class="num" id="1415474">4</span><span class="op" id="1415475">]</span><span class="op" id="1415476">[</span><span class="num" id="1415477">0</span><span class="op" id="1415478">]</span><span class="op" id="1415479">)</span><span class="op" id="1415480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415486">ifma</span>&nbsp;<span class="op" id="1415491">:=</span>&nbsp;<span class="ident" id="1415494"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1415500">{</span><span class="ident" id="1415501">IP</span><span class="op" id="1415503">:</span>&nbsp;<span class="ident" id="1415505"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1415509">(</span><span class="builtintype" id="1415510">byte</span><span class="op" id="1415514">(</span><span class="ident" id="1415515"><a href="/net/interface_linux.go.html#1415439">i</a></span><span class="op" id="1415516">&gt;&gt;</span><span class="num" id="1415518">24</span><span class="op" id="1415520">)</span><span class="op" id="1415521">,</span>&nbsp;<span class="builtintype" id="1415523">byte</span><span class="op" id="1415527">(</span><span class="ident" id="1415528"><a href="/net/interface_linux.go.html#1415439">i</a></span><span class="op" id="1415529">&gt;&gt;</span><span class="num" id="1415531">16</span><span class="op" id="1415533">)</span><span class="op" id="1415534">,</span>&nbsp;<span class="builtintype" id="1415536">byte</span><span class="op" id="1415540">(</span><span class="ident" id="1415541"><a href="/net/interface_linux.go.html#1415439">i</a></span><span class="op" id="1415542">&gt;&gt;</span><span class="num" id="1415544">8</span><span class="op" id="1415545">)</span><span class="op" id="1415546">,</span>&nbsp;<span class="builtintype" id="1415548">byte</span><span class="op" id="1415552">(</span><span class="ident" id="1415553"><a href="/net/interface_linux.go.html#1415439">i</a></span><span class="op" id="1415554">)</span><span class="op" id="1415555">)</span><span class="op" id="1415556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415562"><a href="/net/interface_linux.go.html#1414885">ifmat</a></span>&nbsp;<span class="op" id="1415568">=</span>&nbsp;<span class="builtinfunc" id="1415570">append</span><span class="op" id="1415576">(</span><span class="ident" id="1415577"><a href="/net/interface_linux.go.html#1414885">ifmat</a></span><span class="op" id="1415582">,</span>&nbsp;<span class="ident" id="1415584"><a href="/net/interface_linux.go.html#1415486">ifma</a></span><span class="op" id="1415588">.</span><span class="ident" id="1415589">toAddr</span><span class="op" id="1415595">(</span><span class="op" id="1415596">)</span><span class="op" id="1415597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1415602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1415606">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1415609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415612">return</span>&nbsp;<span class="ident" id="1415619"><a href="/net/interface_linux.go.html#1414885">ifmat</a></span><br>
<span class="lineno"></span><span class="op" id="1415625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1415628">func</span>&nbsp;<span class="ident" id="1415633">parseProcNetIGMP6</span><span class="op" id="1415650">(</span><span class="ident" id="1415651">path</span>&nbsp;<span class="builtintype" id="1415656">string</span><span class="op" id="1415662">,</span>&nbsp;<span class="ident" id="1415664">ifi</span>&nbsp;<span class="op" id="1415668">*</span><span class="ident" id="1415669"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="1415678">)</span>&nbsp;<span class="op" id="1415680">[</span><span class="op" id="1415681">]</span><span class="ident" id="1415682"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1415687">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415690">fd</span><span class="op" id="1415692">,</span>&nbsp;<span class="ident" id="1415694">err</span>&nbsp;<span class="op" id="1415698">:=</span>&nbsp;<span class="ident" id="1415701"><a href="/net/parse.go.html#1476797">open</a></span><span class="op" id="1415705">(</span><span class="ident" id="1415706"><a href="/net/interface_linux.go.html#1415651">path</a></span><span class="op" id="1415710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415713">if</span>&nbsp;<span class="ident" id="1415716"><a href="/net/interface_linux.go.html#1415694">err</a></span>&nbsp;<span class="op" id="1415720">!=</span>&nbsp;<span class="ident" id="1415723">nil</span>&nbsp;<span class="op" id="1415727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415731">return</span>&nbsp;<span class="ident" id="1415738">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1415743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415746">defer</span>&nbsp;<span class="ident" id="1415752"><a href="/net/interface_linux.go.html#1415690">fd</a></span><span class="op" id="1415754">.</span><span class="builtinfunc" id="1415755">close</span><span class="op" id="1415760">(</span><span class="op" id="1415761">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415764">var</span>&nbsp;<span class="ident" id="1415768">ifmat</span>&nbsp;<span class="op" id="1415774">[</span><span class="op" id="1415775">]</span><span class="ident" id="1415776"><a href="/net/net.go.html#1465097">Addr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415782">b</span>&nbsp;<span class="op" id="1415784">:=</span>&nbsp;<span class="builtinfunc" id="1415787">make</span><span class="op" id="1415791">(</span><span class="op" id="1415792">[</span><span class="op" id="1415793">]</span><span class="builtintype" id="1415794">byte</span><span class="op" id="1415798">,</span>&nbsp;<span class="ident" id="1415800"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1415807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415810">for</span>&nbsp;<span class="ident" id="1415814">l</span><span class="op" id="1415815">,</span>&nbsp;<span class="ident" id="1415817">ok</span>&nbsp;<span class="op" id="1415820">:=</span>&nbsp;<span class="ident" id="1415823"><a href="/net/interface_linux.go.html#1415690">fd</a></span><span class="op" id="1415825">.</span><span class="ident" id="1415826">readLine</span><span class="op" id="1415834">(</span><span class="op" id="1415835">)</span><span class="op" id="1415836">;</span>&nbsp;<span class="ident" id="1415838"><a href="/net/interface_linux.go.html#1415817">ok</a></span><span class="op" id="1415840">;</span>&nbsp;<span class="ident" id="1415842"><a href="/net/interface_linux.go.html#1415814">l</a></span><span class="op" id="1415843">,</span>&nbsp;<span class="ident" id="1415845"><a href="/net/interface_linux.go.html#1415817">ok</a></span>&nbsp;<span class="op" id="1415848">=</span>&nbsp;<span class="ident" id="1415850"><a href="/net/interface_linux.go.html#1415690">fd</a></span><span class="op" id="1415852">.</span><span class="ident" id="1415853">readLine</span><span class="op" id="1415861">(</span><span class="op" id="1415862">)</span>&nbsp;<span class="op" id="1415864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415868">f</span>&nbsp;<span class="op" id="1415870">:=</span>&nbsp;<span class="ident" id="1415873"><a href="/net/parse.go.html#1477305">splitAtBytes</a></span><span class="op" id="1415885">(</span><span class="ident" id="1415886"><a href="/net/interface_linux.go.html#1415814">l</a></span><span class="op" id="1415887">,</span>&nbsp;<span class="string" id="1415889">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="1415898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415902">if</span>&nbsp;<span class="builtinfunc" id="1415905">len</span><span class="op" id="1415908">(</span><span class="ident" id="1415909"><a href="/net/interface_linux.go.html#1415868">f</a></span><span class="op" id="1415910">)</span>&nbsp;<span class="op" id="1415912">&lt;</span>&nbsp;<span class="num" id="1415914">6</span>&nbsp;<span class="op" id="1415916">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415921">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1415932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415936">if</span>&nbsp;<span class="ident" id="1415939"><a href="/net/interface_linux.go.html#1415664">ifi</a></span>&nbsp;<span class="op" id="1415943">==</span>&nbsp;<span class="ident" id="1415946">nil</span>&nbsp;<span class="op" id="1415950">||</span>&nbsp;<span class="ident" id="1415953"><a href="/net/interface_linux.go.html#1415868">f</a></span><span class="op" id="1415954">[</span><span class="num" id="1415955">1</span><span class="op" id="1415956">]</span>&nbsp;<span class="op" id="1415958">==</span>&nbsp;<span class="ident" id="1415961"><a href="/net/interface_linux.go.html#1415664">ifi</a></span><span class="op" id="1415964">.</span><span class="ident" id="1415965">Name</span>&nbsp;<span class="op" id="1415970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1415975">for</span>&nbsp;<span class="ident" id="1415979">i</span>&nbsp;<span class="op" id="1415981">:=</span>&nbsp;<span class="num" id="1415984">0</span><span class="op" id="1415985">;</span>&nbsp;<span class="ident" id="1415987"><a href="/net/interface_linux.go.html#1415979">i</a></span><span class="op" id="1415988">+</span><span class="num" id="1415989">1</span>&nbsp;<span class="op" id="1415991">&lt;</span>&nbsp;<span class="builtinfunc" id="1415993">len</span><span class="op" id="1415996">(</span><span class="ident" id="1415997"><a href="/net/interface_linux.go.html#1415868">f</a></span><span class="op" id="1415998">[</span><span class="num" id="1415999">2</span><span class="op" id="1416000">]</span><span class="op" id="1416001">)</span><span class="op" id="1416002">;</span>&nbsp;<span class="ident" id="1416004"><a href="/net/interface_linux.go.html#1415979">i</a></span>&nbsp;<span class="op" id="1416006">+=</span>&nbsp;<span class="num" id="1416009">2</span>&nbsp;<span class="op" id="1416011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1416017"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416018">[</span><span class="ident" id="1416019"><a href="/net/interface_linux.go.html#1415979">i</a></span><span class="op" id="1416020">/</span><span class="num" id="1416021">2</span><span class="op" id="1416022">]</span><span class="op" id="1416023">,</span>&nbsp;<span class="ident" id="1416025">_</span>&nbsp;<span class="op" id="1416027">=</span>&nbsp;<span class="ident" id="1416029"><a href="/net/parse.go.html#1478888">xtoi2</a></span><span class="op" id="1416034">(</span><span class="ident" id="1416035"><a href="/net/interface_linux.go.html#1415868">f</a></span><span class="op" id="1416036">[</span><span class="num" id="1416037">2</span><span class="op" id="1416038">]</span><span class="op" id="1416039">[</span><span class="ident" id="1416040"><a href="/net/interface_linux.go.html#1415979">i</a></span><span class="op" id="1416041">:</span><span class="ident" id="1416042"><a href="/net/interface_linux.go.html#1415979">i</a></span><span class="op" id="1416043">+</span><span class="num" id="1416044">2</span><span class="op" id="1416045">]</span><span class="op" id="1416046">,</span>&nbsp;<span class="num" id="1416048">0</span><span class="op" id="1416049">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1416054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1416059">ifma</span>&nbsp;<span class="op" id="1416064">:=</span>&nbsp;<span class="ident" id="1416067"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1416073">{</span><span class="ident" id="1416074">IP</span><span class="op" id="1416076">:</span>&nbsp;<span class="ident" id="1416078"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1416080">{</span><span class="ident" id="1416081"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416082">[</span><span class="num" id="1416083">0</span><span class="op" id="1416084">]</span><span class="op" id="1416085">,</span>&nbsp;<span class="ident" id="1416087"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416088">[</span><span class="num" id="1416089">1</span><span class="op" id="1416090">]</span><span class="op" id="1416091">,</span>&nbsp;<span class="ident" id="1416093"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416094">[</span><span class="num" id="1416095">2</span><span class="op" id="1416096">]</span><span class="op" id="1416097">,</span>&nbsp;<span class="ident" id="1416099"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416100">[</span><span class="num" id="1416101">3</span><span class="op" id="1416102">]</span><span class="op" id="1416103">,</span>&nbsp;<span class="ident" id="1416105"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416106">[</span><span class="num" id="1416107">4</span><span class="op" id="1416108">]</span><span class="op" id="1416109">,</span>&nbsp;<span class="ident" id="1416111"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416112">[</span><span class="num" id="1416113">5</span><span class="op" id="1416114">]</span><span class="op" id="1416115">,</span>&nbsp;<span class="ident" id="1416117"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416118">[</span><span class="num" id="1416119">6</span><span class="op" id="1416120">]</span><span class="op" id="1416121">,</span>&nbsp;<span class="ident" id="1416123"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416124">[</span><span class="num" id="1416125">7</span><span class="op" id="1416126">]</span><span class="op" id="1416127">,</span>&nbsp;<span class="ident" id="1416129"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416130">[</span><span class="num" id="1416131">8</span><span class="op" id="1416132">]</span><span class="op" id="1416133">,</span>&nbsp;<span class="ident" id="1416135"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416136">[</span><span class="num" id="1416137">9</span><span class="op" id="1416138">]</span><span class="op" id="1416139">,</span>&nbsp;<span class="ident" id="1416141"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416142">[</span><span class="num" id="1416143">10</span><span class="op" id="1416145">]</span><span class="op" id="1416146">,</span>&nbsp;<span class="ident" id="1416148"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416149">[</span><span class="num" id="1416150">11</span><span class="op" id="1416152">]</span><span class="op" id="1416153">,</span>&nbsp;<span class="ident" id="1416155"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416156">[</span><span class="num" id="1416157">12</span><span class="op" id="1416159">]</span><span class="op" id="1416160">,</span>&nbsp;<span class="ident" id="1416162"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416163">[</span><span class="num" id="1416164">13</span><span class="op" id="1416166">]</span><span class="op" id="1416167">,</span>&nbsp;<span class="ident" id="1416169"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416170">[</span><span class="num" id="1416171">14</span><span class="op" id="1416173">]</span><span class="op" id="1416174">,</span>&nbsp;<span class="ident" id="1416176"><a href="/net/interface_linux.go.html#1415782">b</a></span><span class="op" id="1416177">[</span><span class="num" id="1416178">15</span><span class="op" id="1416180">]</span><span class="op" id="1416181">}</span><span class="op" id="1416182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1416187"><a href="/net/interface_linux.go.html#1415768">ifmat</a></span>&nbsp;<span class="op" id="1416193">=</span>&nbsp;<span class="builtinfunc" id="1416195">append</span><span class="op" id="1416201">(</span><span class="ident" id="1416202"><a href="/net/interface_linux.go.html#1415768">ifmat</a></span><span class="op" id="1416207">,</span>&nbsp;<span class="ident" id="1416209"><a href="/net/interface_linux.go.html#1416059">ifma</a></span><span class="op" id="1416213">.</span><span class="ident" id="1416214">toAddr</span><span class="op" id="1416220">(</span><span class="op" id="1416221">)</span><span class="op" id="1416222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1416226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1416229">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1416232">return</span>&nbsp;<span class="ident" id="1416239"><a href="/net/interface_linux.go.html#1415768">ifmat</a></span><br>
<span class="lineno"></span><span class="op" id="1416245">}</span>
</div>
</body>
</html>
