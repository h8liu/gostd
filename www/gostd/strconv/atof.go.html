<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html" class="current">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2234976">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2235031">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2235085">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2235136">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="2235213">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="2235237">package</span>&nbsp;<span class="ident" id="2235245">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2235254">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="2235302">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2235316">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="2235363">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="2235436">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2235496">import</span>&nbsp;<span class="string" id="2235503">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2235511">var</span>&nbsp;<span class="ident" id="2235515">optimize</span>&nbsp;<span class="op" id="2235524">=</span>&nbsp;<span class="builtintype" id="2235526">true</span>&nbsp;<span class="comment" id="2235531">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2235558">func</span>&nbsp;<span class="ident" id="2235563">equalIgnoreCase</span><span class="op" id="2235578">(</span><span class="ident" id="2235579">s1</span><span class="op" id="2235581">,</span>&nbsp;<span class="ident" id="2235583">s2</span>&nbsp;<span class="builtintype" id="2235586">string</span><span class="op" id="2235592">)</span>&nbsp;<span class="builtintype" id="2235594">bool</span>&nbsp;<span class="op" id="2235599">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235602">if</span>&nbsp;<span class="builtinfunc" id="2235605">len</span><span class="op" id="2235608">(</span><span class="ident" id="2235609">s1</span><span class="op" id="2235611">)</span>&nbsp;<span class="op" id="2235613">!=</span>&nbsp;<span class="builtinfunc" id="2235616">len</span><span class="op" id="2235619">(</span><span class="ident" id="2235620">s2</span><span class="op" id="2235622">)</span>&nbsp;<span class="op" id="2235624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235628">return</span>&nbsp;<span class="builtintype" id="2235635">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235645">for</span>&nbsp;<span class="ident" id="2235649">i</span>&nbsp;<span class="op" id="2235651">:=</span>&nbsp;<span class="num" id="2235654">0</span><span class="op" id="2235655">;</span>&nbsp;<span class="ident" id="2235657">i</span>&nbsp;<span class="op" id="2235659">&lt;</span>&nbsp;<span class="builtinfunc" id="2235661">len</span><span class="op" id="2235664">(</span><span class="ident" id="2235665">s1</span><span class="op" id="2235667">)</span><span class="op" id="2235668">;</span>&nbsp;<span class="ident" id="2235670">i</span><span class="op" id="2235671">++</span>&nbsp;<span class="op" id="2235674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235678">c1</span>&nbsp;<span class="op" id="2235681">:=</span>&nbsp;<span class="ident" id="2235684">s1</span><span class="op" id="2235686">[</span><span class="ident" id="2235687">i</span><span class="op" id="2235688">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235692">if</span>&nbsp;<span class="string" id="2235695">&#39;A&#39;</span>&nbsp;<span class="op" id="2235699">&lt;=</span>&nbsp;<span class="ident" id="2235702">c1</span>&nbsp;<span class="op" id="2235705">&amp;&amp;</span>&nbsp;<span class="ident" id="2235708">c1</span>&nbsp;<span class="op" id="2235711">&lt;=</span>&nbsp;<span class="string" id="2235714">&#39;Z&#39;</span>&nbsp;<span class="op" id="2235718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235723">c1</span>&nbsp;<span class="op" id="2235726">+=</span>&nbsp;<span class="string" id="2235729">&#39;a&#39;</span>&nbsp;<span class="op" id="2235733">-</span>&nbsp;<span class="string" id="2235735">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235745">c2</span>&nbsp;<span class="op" id="2235748">:=</span>&nbsp;<span class="ident" id="2235751">s2</span><span class="op" id="2235753">[</span><span class="ident" id="2235754">i</span><span class="op" id="2235755">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235759">if</span>&nbsp;<span class="string" id="2235762">&#39;A&#39;</span>&nbsp;<span class="op" id="2235766">&lt;=</span>&nbsp;<span class="ident" id="2235769">c2</span>&nbsp;<span class="op" id="2235772">&amp;&amp;</span>&nbsp;<span class="ident" id="2235775">c2</span>&nbsp;<span class="op" id="2235778">&lt;=</span>&nbsp;<span class="string" id="2235781">&#39;Z&#39;</span>&nbsp;<span class="op" id="2235785">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235790">c2</span>&nbsp;<span class="op" id="2235793">+=</span>&nbsp;<span class="string" id="2235796">&#39;a&#39;</span>&nbsp;<span class="op" id="2235800">-</span>&nbsp;<span class="string" id="2235802">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235812">if</span>&nbsp;<span class="ident" id="2235815">c1</span>&nbsp;<span class="op" id="2235818">!=</span>&nbsp;<span class="ident" id="2235821">c2</span>&nbsp;<span class="op" id="2235824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235829">return</span>&nbsp;<span class="builtintype" id="2235836">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235844">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235850">return</span>&nbsp;<span class="builtintype" id="2235857">true</span><br>
<span class="lineno"></span><span class="op" id="2235862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2235865">func</span>&nbsp;<span class="ident" id="2235870">special</span><span class="op" id="2235877">(</span><span class="ident" id="2235878">s</span>&nbsp;<span class="builtintype" id="2235880">string</span><span class="op" id="2235886">)</span>&nbsp;<span class="op" id="2235888">(</span><span class="ident" id="2235889">f</span>&nbsp;<span class="builtintype" id="2235891">float64</span><span class="op" id="2235898">,</span>&nbsp;<span class="ident" id="2235900">ok</span>&nbsp;<span class="builtintype" id="2235903">bool</span><span class="op" id="2235907">)</span>&nbsp;<span class="op" id="2235909">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235912">if</span>&nbsp;<span class="builtinfunc" id="2235915">len</span><span class="op" id="2235918">(</span><span class="ident" id="2235919">s</span><span class="op" id="2235920">)</span>&nbsp;<span class="op" id="2235922">==</span>&nbsp;<span class="num" id="2235925">0</span>&nbsp;<span class="op" id="2235927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235931">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235942">switch</span>&nbsp;<span class="ident" id="2235949">s</span><span class="op" id="2235950">[</span><span class="num" id="2235951">0</span><span class="op" id="2235952">]</span>&nbsp;<span class="op" id="2235954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235957">default</span><span class="op" id="2235964">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235968">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235976">case</span>&nbsp;<span class="string" id="2235981">&#39;+&#39;</span><span class="op" id="2235984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235988">if</span>&nbsp;<span class="ident" id="2235991">equalIgnoreCase</span><span class="op" id="2236006">(</span><span class="ident" id="2236007">s</span><span class="op" id="2236008">,</span>&nbsp;<span class="string" id="2236010">&#34;+inf&#34;</span><span class="op" id="2236016">)</span>&nbsp;<span class="op" id="2236018">||</span>&nbsp;<span class="ident" id="2236021">equalIgnoreCase</span><span class="op" id="2236036">(</span><span class="ident" id="2236037">s</span><span class="op" id="2236038">,</span>&nbsp;<span class="string" id="2236040">&#34;+infinity&#34;</span><span class="op" id="2236051">)</span>&nbsp;<span class="op" id="2236053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236058">return</span>&nbsp;<span class="ident" id="2236065">math</span><span class="op" id="2236069">.</span><span class="ident" id="2236070">Inf</span><span class="op" id="2236073">(</span><span class="num" id="2236074">1</span><span class="op" id="2236075">)</span><span class="op" id="2236076">,</span>&nbsp;<span class="builtintype" id="2236078">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236085">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236088">case</span>&nbsp;<span class="string" id="2236093">&#39;-&#39;</span><span class="op" id="2236096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236100">if</span>&nbsp;<span class="ident" id="2236103">equalIgnoreCase</span><span class="op" id="2236118">(</span><span class="ident" id="2236119">s</span><span class="op" id="2236120">,</span>&nbsp;<span class="string" id="2236122">&#34;-inf&#34;</span><span class="op" id="2236128">)</span>&nbsp;<span class="op" id="2236130">||</span>&nbsp;<span class="ident" id="2236133">equalIgnoreCase</span><span class="op" id="2236148">(</span><span class="ident" id="2236149">s</span><span class="op" id="2236150">,</span>&nbsp;<span class="string" id="2236152">&#34;-infinity&#34;</span><span class="op" id="2236163">)</span>&nbsp;<span class="op" id="2236165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236170">return</span>&nbsp;<span class="ident" id="2236177">math</span><span class="op" id="2236181">.</span><span class="ident" id="2236182">Inf</span><span class="op" id="2236185">(</span><span class="op" id="2236186">-</span><span class="num" id="2236187">1</span><span class="op" id="2236188">)</span><span class="op" id="2236189">,</span>&nbsp;<span class="builtintype" id="2236191">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236201">case</span>&nbsp;<span class="string" id="2236206">&#39;n&#39;</span><span class="op" id="2236209">,</span>&nbsp;<span class="string" id="2236211">&#39;N&#39;</span><span class="op" id="2236214">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236218">if</span>&nbsp;<span class="ident" id="2236221">equalIgnoreCase</span><span class="op" id="2236236">(</span><span class="ident" id="2236237">s</span><span class="op" id="2236238">,</span>&nbsp;<span class="string" id="2236240">&#34;nan&#34;</span><span class="op" id="2236245">)</span>&nbsp;<span class="op" id="2236247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236252">return</span>&nbsp;<span class="ident" id="2236259">math</span><span class="op" id="2236263">.</span><span class="ident" id="2236264">NaN</span><span class="op" id="2236267">(</span><span class="op" id="2236268">)</span><span class="op" id="2236269">,</span>&nbsp;<span class="builtintype" id="2236271">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236281">case</span>&nbsp;<span class="string" id="2236286">&#39;i&#39;</span><span class="op" id="2236289">,</span>&nbsp;<span class="string" id="2236291">&#39;I&#39;</span><span class="op" id="2236294">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236298">if</span>&nbsp;<span class="ident" id="2236301">equalIgnoreCase</span><span class="op" id="2236316">(</span><span class="ident" id="2236317">s</span><span class="op" id="2236318">,</span>&nbsp;<span class="string" id="2236320">&#34;inf&#34;</span><span class="op" id="2236325">)</span>&nbsp;<span class="op" id="2236327">||</span>&nbsp;<span class="ident" id="2236330">equalIgnoreCase</span><span class="op" id="2236345">(</span><span class="ident" id="2236346">s</span><span class="op" id="2236347">,</span>&nbsp;<span class="string" id="2236349">&#34;infinity&#34;</span><span class="op" id="2236359">)</span>&nbsp;<span class="op" id="2236361">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236366">return</span>&nbsp;<span class="ident" id="2236373">math</span><span class="op" id="2236377">.</span><span class="ident" id="2236378">Inf</span><span class="op" id="2236381">(</span><span class="num" id="2236382">1</span><span class="op" id="2236383">)</span><span class="op" id="2236384">,</span>&nbsp;<span class="builtintype" id="2236386">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236399">return</span><br>
<span class="lineno"></span><span class="op" id="2236406">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2236409">func</span>&nbsp;<span class="op" id="2236414">(</span><span class="ident" id="2236415">b</span>&nbsp;<span class="op" id="2236417">*</span><span class="ident" id="2236418">decimal</span><span class="op" id="2236425">)</span>&nbsp;<span class="ident" id="2236427">set</span><span class="op" id="2236430">(</span><span class="ident" id="2236431">s</span>&nbsp;<span class="builtintype" id="2236433">string</span><span class="op" id="2236439">)</span>&nbsp;<span class="op" id="2236441">(</span><span class="ident" id="2236442">ok</span>&nbsp;<span class="builtintype" id="2236445">bool</span><span class="op" id="2236449">)</span>&nbsp;<span class="op" id="2236451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236454">i</span>&nbsp;<span class="op" id="2236456">:=</span>&nbsp;<span class="num" id="2236459">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236462">b</span><span class="op" id="2236463">.</span><span class="ident" id="2236464">neg</span>&nbsp;<span class="op" id="2236468">=</span>&nbsp;<span class="builtintype" id="2236470">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236477">b</span><span class="op" id="2236478">.</span><span class="ident" id="2236479">trunc</span>&nbsp;<span class="op" id="2236485">=</span>&nbsp;<span class="builtintype" id="2236487">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2236495">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236513">if</span>&nbsp;<span class="ident" id="2236516">i</span>&nbsp;<span class="op" id="2236518">&gt;=</span>&nbsp;<span class="builtinfunc" id="2236521">len</span><span class="op" id="2236524">(</span><span class="ident" id="2236525">s</span><span class="op" id="2236526">)</span>&nbsp;<span class="op" id="2236528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236532">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236540">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236543">switch</span>&nbsp;<span class="op" id="2236550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236553">case</span>&nbsp;<span class="ident" id="2236558">s</span><span class="op" id="2236559">[</span><span class="ident" id="2236560">i</span><span class="op" id="2236561">]</span>&nbsp;<span class="op" id="2236563">==</span>&nbsp;<span class="string" id="2236566">&#39;+&#39;</span><span class="op" id="2236569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236573">i</span><span class="op" id="2236574">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236578">case</span>&nbsp;<span class="ident" id="2236583">s</span><span class="op" id="2236584">[</span><span class="ident" id="2236585">i</span><span class="op" id="2236586">]</span>&nbsp;<span class="op" id="2236588">==</span>&nbsp;<span class="string" id="2236591">&#39;-&#39;</span><span class="op" id="2236594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236598">b</span><span class="op" id="2236599">.</span><span class="ident" id="2236600">neg</span>&nbsp;<span class="op" id="2236604">=</span>&nbsp;<span class="builtintype" id="2236606">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236613">i</span><span class="op" id="2236614">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2236622">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236633">sawdot</span>&nbsp;<span class="op" id="2236640">:=</span>&nbsp;<span class="builtintype" id="2236643">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236650">sawdigits</span>&nbsp;<span class="op" id="2236660">:=</span>&nbsp;<span class="builtintype" id="2236663">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236670">for</span>&nbsp;<span class="op" id="2236674">;</span>&nbsp;<span class="ident" id="2236676">i</span>&nbsp;<span class="op" id="2236678">&lt;</span>&nbsp;<span class="builtinfunc" id="2236680">len</span><span class="op" id="2236683">(</span><span class="ident" id="2236684">s</span><span class="op" id="2236685">)</span><span class="op" id="2236686">;</span>&nbsp;<span class="ident" id="2236688">i</span><span class="op" id="2236689">++</span>&nbsp;<span class="op" id="2236692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236696">switch</span>&nbsp;<span class="op" id="2236703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236707">case</span>&nbsp;<span class="ident" id="2236712">s</span><span class="op" id="2236713">[</span><span class="ident" id="2236714">i</span><span class="op" id="2236715">]</span>&nbsp;<span class="op" id="2236717">==</span>&nbsp;<span class="string" id="2236720">&#39;.&#39;</span><span class="op" id="2236723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236728">if</span>&nbsp;<span class="ident" id="2236731">sawdot</span>&nbsp;<span class="op" id="2236738">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236744">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236759">sawdot</span>&nbsp;<span class="op" id="2236766">=</span>&nbsp;<span class="builtintype" id="2236768">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236776">b</span><span class="op" id="2236777">.</span><span class="ident" id="2236778">dp</span>&nbsp;<span class="op" id="2236781">=</span>&nbsp;<span class="ident" id="2236783">b</span><span class="op" id="2236784">.</span><span class="ident" id="2236785">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236791">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236803">case</span>&nbsp;<span class="string" id="2236808">&#39;0&#39;</span>&nbsp;<span class="op" id="2236812">&lt;=</span>&nbsp;<span class="ident" id="2236815">s</span><span class="op" id="2236816">[</span><span class="ident" id="2236817">i</span><span class="op" id="2236818">]</span>&nbsp;<span class="op" id="2236820">&amp;&amp;</span>&nbsp;<span class="ident" id="2236823">s</span><span class="op" id="2236824">[</span><span class="ident" id="2236825">i</span><span class="op" id="2236826">]</span>&nbsp;<span class="op" id="2236828">&lt;=</span>&nbsp;<span class="string" id="2236831">&#39;9&#39;</span><span class="op" id="2236834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236839">sawdigits</span>&nbsp;<span class="op" id="2236849">=</span>&nbsp;<span class="builtintype" id="2236851">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236859">if</span>&nbsp;<span class="ident" id="2236862">s</span><span class="op" id="2236863">[</span><span class="ident" id="2236864">i</span><span class="op" id="2236865">]</span>&nbsp;<span class="op" id="2236867">==</span>&nbsp;<span class="string" id="2236870">&#39;0&#39;</span>&nbsp;<span class="op" id="2236874">&amp;&amp;</span>&nbsp;<span class="ident" id="2236877">b</span><span class="op" id="2236878">.</span><span class="ident" id="2236879">nd</span>&nbsp;<span class="op" id="2236882">==</span>&nbsp;<span class="num" id="2236885">0</span>&nbsp;<span class="op" id="2236887">{</span>&nbsp;<span class="comment" id="2236889">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236917">b</span><span class="op" id="2236918">.</span><span class="ident" id="2236919">dp</span><span class="op" id="2236921">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236928">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236945">if</span>&nbsp;<span class="ident" id="2236948">b</span><span class="op" id="2236949">.</span><span class="ident" id="2236950">nd</span>&nbsp;<span class="op" id="2236953">&lt;</span>&nbsp;<span class="builtinfunc" id="2236955">len</span><span class="op" id="2236958">(</span><span class="ident" id="2236959">b</span><span class="op" id="2236960">.</span><span class="ident" id="2236961">d</span><span class="op" id="2236962">)</span>&nbsp;<span class="op" id="2236964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236970">b</span><span class="op" id="2236971">.</span><span class="ident" id="2236972">d</span><span class="op" id="2236973">[</span><span class="ident" id="2236974">b</span><span class="op" id="2236975">.</span><span class="ident" id="2236976">nd</span><span class="op" id="2236978">]</span>&nbsp;<span class="op" id="2236980">=</span>&nbsp;<span class="ident" id="2236982">s</span><span class="op" id="2236983">[</span><span class="ident" id="2236984">i</span><span class="op" id="2236985">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236991">b</span><span class="op" id="2236992">.</span><span class="ident" id="2236993">nd</span><span class="op" id="2236995">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237001">}</span>&nbsp;<span class="keyword" id="2237003">else</span>&nbsp;<span class="keyword" id="2237008">if</span>&nbsp;<span class="ident" id="2237011">s</span><span class="op" id="2237012">[</span><span class="ident" id="2237013">i</span><span class="op" id="2237014">]</span>&nbsp;<span class="op" id="2237016">!=</span>&nbsp;<span class="string" id="2237019">&#39;0&#39;</span>&nbsp;<span class="op" id="2237023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237029">b</span><span class="op" id="2237030">.</span><span class="ident" id="2237031">trunc</span>&nbsp;<span class="op" id="2237037">=</span>&nbsp;<span class="builtintype" id="2237039">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237052">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237063">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237067">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237077">if</span>&nbsp;<span class="op" id="2237080">!</span><span class="ident" id="2237081">sawdigits</span>&nbsp;<span class="op" id="2237091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237095">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237103">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237106">if</span>&nbsp;<span class="op" id="2237109">!</span><span class="ident" id="2237110">sawdot</span>&nbsp;<span class="op" id="2237117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237121">b</span><span class="op" id="2237122">.</span><span class="ident" id="2237123">dp</span>&nbsp;<span class="op" id="2237126">=</span>&nbsp;<span class="ident" id="2237128">b</span><span class="op" id="2237129">.</span><span class="ident" id="2237130">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2237138">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2237181">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2237228">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2237274">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2237326">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237352">if</span>&nbsp;<span class="ident" id="2237355">i</span>&nbsp;<span class="op" id="2237357">&lt;</span>&nbsp;<span class="builtinfunc" id="2237359">len</span><span class="op" id="2237362">(</span><span class="ident" id="2237363">s</span><span class="op" id="2237364">)</span>&nbsp;<span class="op" id="2237366">&amp;&amp;</span>&nbsp;<span class="op" id="2237369">(</span><span class="ident" id="2237370">s</span><span class="op" id="2237371">[</span><span class="ident" id="2237372">i</span><span class="op" id="2237373">]</span>&nbsp;<span class="op" id="2237375">==</span>&nbsp;<span class="string" id="2237378">&#39;e&#39;</span>&nbsp;<span class="op" id="2237382">||</span>&nbsp;<span class="ident" id="2237385">s</span><span class="op" id="2237386">[</span><span class="ident" id="2237387">i</span><span class="op" id="2237388">]</span>&nbsp;<span class="op" id="2237390">==</span>&nbsp;<span class="string" id="2237393">&#39;E&#39;</span><span class="op" id="2237396">)</span>&nbsp;<span class="op" id="2237398">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237402">i</span><span class="op" id="2237403">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237408">if</span>&nbsp;<span class="ident" id="2237411">i</span>&nbsp;<span class="op" id="2237413">&gt;=</span>&nbsp;<span class="builtinfunc" id="2237416">len</span><span class="op" id="2237419">(</span><span class="ident" id="2237420">s</span><span class="op" id="2237421">)</span>&nbsp;<span class="op" id="2237423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237428">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237441">esign</span>&nbsp;<span class="op" id="2237447">:=</span>&nbsp;<span class="num" id="2237450">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237454">if</span>&nbsp;<span class="ident" id="2237457">s</span><span class="op" id="2237458">[</span><span class="ident" id="2237459">i</span><span class="op" id="2237460">]</span>&nbsp;<span class="op" id="2237462">==</span>&nbsp;<span class="string" id="2237465">&#39;+&#39;</span>&nbsp;<span class="op" id="2237469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237474">i</span><span class="op" id="2237475">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237480">}</span>&nbsp;<span class="keyword" id="2237482">else</span>&nbsp;<span class="keyword" id="2237487">if</span>&nbsp;<span class="ident" id="2237490">s</span><span class="op" id="2237491">[</span><span class="ident" id="2237492">i</span><span class="op" id="2237493">]</span>&nbsp;<span class="op" id="2237495">==</span>&nbsp;<span class="string" id="2237498">&#39;-&#39;</span>&nbsp;<span class="op" id="2237502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237507">i</span><span class="op" id="2237508">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237514">esign</span>&nbsp;<span class="op" id="2237520">=</span>&nbsp;<span class="op" id="2237522">-</span><span class="num" id="2237523">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237531">if</span>&nbsp;<span class="ident" id="2237534">i</span>&nbsp;<span class="op" id="2237536">&gt;=</span>&nbsp;<span class="builtinfunc" id="2237539">len</span><span class="op" id="2237542">(</span><span class="ident" id="2237543">s</span><span class="op" id="2237544">)</span>&nbsp;<span class="op" id="2237546">||</span>&nbsp;<span class="ident" id="2237549">s</span><span class="op" id="2237550">[</span><span class="ident" id="2237551">i</span><span class="op" id="2237552">]</span>&nbsp;<span class="op" id="2237554">&lt;</span>&nbsp;<span class="string" id="2237556">&#39;0&#39;</span>&nbsp;<span class="op" id="2237560">||</span>&nbsp;<span class="ident" id="2237563">s</span><span class="op" id="2237564">[</span><span class="ident" id="2237565">i</span><span class="op" id="2237566">]</span>&nbsp;<span class="op" id="2237568">&gt;</span>&nbsp;<span class="string" id="2237570">&#39;9&#39;</span>&nbsp;<span class="op" id="2237574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237579">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237592">e</span>&nbsp;<span class="op" id="2237594">:=</span>&nbsp;<span class="num" id="2237597">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237601">for</span>&nbsp;<span class="op" id="2237605">;</span>&nbsp;<span class="ident" id="2237607">i</span>&nbsp;<span class="op" id="2237609">&lt;</span>&nbsp;<span class="builtinfunc" id="2237611">len</span><span class="op" id="2237614">(</span><span class="ident" id="2237615">s</span><span class="op" id="2237616">)</span>&nbsp;<span class="op" id="2237618">&amp;&amp;</span>&nbsp;<span class="string" id="2237621">&#39;0&#39;</span>&nbsp;<span class="op" id="2237625">&lt;=</span>&nbsp;<span class="ident" id="2237628">s</span><span class="op" id="2237629">[</span><span class="ident" id="2237630">i</span><span class="op" id="2237631">]</span>&nbsp;<span class="op" id="2237633">&amp;&amp;</span>&nbsp;<span class="ident" id="2237636">s</span><span class="op" id="2237637">[</span><span class="ident" id="2237638">i</span><span class="op" id="2237639">]</span>&nbsp;<span class="op" id="2237641">&lt;=</span>&nbsp;<span class="string" id="2237644">&#39;9&#39;</span><span class="op" id="2237647">;</span>&nbsp;<span class="ident" id="2237649">i</span><span class="op" id="2237650">++</span>&nbsp;<span class="op" id="2237653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237658">if</span>&nbsp;<span class="ident" id="2237661">e</span>&nbsp;<span class="op" id="2237663">&lt;</span>&nbsp;<span class="num" id="2237665">10000</span>&nbsp;<span class="op" id="2237671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237677">e</span>&nbsp;<span class="op" id="2237679">=</span>&nbsp;<span class="ident" id="2237681">e</span><span class="op" id="2237682">*</span><span class="num" id="2237683">10</span>&nbsp;<span class="op" id="2237686">+</span>&nbsp;<span class="builtintype" id="2237688">int</span><span class="op" id="2237691">(</span><span class="ident" id="2237692">s</span><span class="op" id="2237693">[</span><span class="ident" id="2237694">i</span><span class="op" id="2237695">]</span><span class="op" id="2237696">)</span>&nbsp;<span class="op" id="2237698">-</span>&nbsp;<span class="string" id="2237700">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237711">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237715">b</span><span class="op" id="2237716">.</span><span class="ident" id="2237717">dp</span>&nbsp;<span class="op" id="2237720">+=</span>&nbsp;<span class="ident" id="2237723">e</span>&nbsp;<span class="op" id="2237725">*</span>&nbsp;<span class="ident" id="2237727">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237738">if</span>&nbsp;<span class="ident" id="2237741">i</span>&nbsp;<span class="op" id="2237743">!=</span>&nbsp;<span class="builtinfunc" id="2237746">len</span><span class="op" id="2237749">(</span><span class="ident" id="2237750">s</span><span class="op" id="2237751">)</span>&nbsp;<span class="op" id="2237753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237757">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237769">ok</span>&nbsp;<span class="op" id="2237772">=</span>&nbsp;<span class="builtintype" id="2237774">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237780">return</span><br>
<span class="lineno"></span><span class="op" id="2237787">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2237790">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="2237854">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="2237920">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2237959">func</span>&nbsp;<span class="ident" id="2237964">readFloat</span><span class="op" id="2237973">(</span><span class="ident" id="2237974">s</span>&nbsp;<span class="builtintype" id="2237976">string</span><span class="op" id="2237982">)</span>&nbsp;<span class="op" id="2237984">(</span><span class="ident" id="2237985">mantissa</span>&nbsp;<span class="ident" id="2237994">uint64</span><span class="op" id="2238000">,</span>&nbsp;<span class="ident" id="2238002">exp</span>&nbsp;<span class="builtintype" id="2238006">int</span><span class="op" id="2238009">,</span>&nbsp;<span class="ident" id="2238011">neg</span><span class="op" id="2238014">,</span>&nbsp;<span class="ident" id="2238016">trunc</span><span class="op" id="2238021">,</span>&nbsp;<span class="ident" id="2238023">ok</span>&nbsp;<span class="builtintype" id="2238026">bool</span><span class="op" id="2238030">)</span>&nbsp;<span class="op" id="2238032">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238035">const</span>&nbsp;<span class="ident" id="2238041">uint64digits</span>&nbsp;<span class="op" id="2238054">=</span>&nbsp;<span class="num" id="2238056">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238060">i</span>&nbsp;<span class="op" id="2238062">:=</span>&nbsp;<span class="num" id="2238065">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238069">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238087">if</span>&nbsp;<span class="ident" id="2238090">i</span>&nbsp;<span class="op" id="2238092">&gt;=</span>&nbsp;<span class="builtinfunc" id="2238095">len</span><span class="op" id="2238098">(</span><span class="ident" id="2238099">s</span><span class="op" id="2238100">)</span>&nbsp;<span class="op" id="2238102">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238106">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238117">switch</span>&nbsp;<span class="op" id="2238124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238127">case</span>&nbsp;<span class="ident" id="2238132">s</span><span class="op" id="2238133">[</span><span class="ident" id="2238134">i</span><span class="op" id="2238135">]</span>&nbsp;<span class="op" id="2238137">==</span>&nbsp;<span class="string" id="2238140">&#39;+&#39;</span><span class="op" id="2238143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238147">i</span><span class="op" id="2238148">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238152">case</span>&nbsp;<span class="ident" id="2238157">s</span><span class="op" id="2238158">[</span><span class="ident" id="2238159">i</span><span class="op" id="2238160">]</span>&nbsp;<span class="op" id="2238162">==</span>&nbsp;<span class="string" id="2238165">&#39;-&#39;</span><span class="op" id="2238168">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238172">neg</span>&nbsp;<span class="op" id="2238176">=</span>&nbsp;<span class="builtintype" id="2238178">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238185">i</span><span class="op" id="2238186">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238194">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238205">sawdot</span>&nbsp;<span class="op" id="2238212">:=</span>&nbsp;<span class="builtintype" id="2238215">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238222">sawdigits</span>&nbsp;<span class="op" id="2238232">:=</span>&nbsp;<span class="builtintype" id="2238235">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238242">nd</span>&nbsp;<span class="op" id="2238245">:=</span>&nbsp;<span class="num" id="2238248">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238251">ndMant</span>&nbsp;<span class="op" id="2238258">:=</span>&nbsp;<span class="num" id="2238261">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238264">dp</span>&nbsp;<span class="op" id="2238267">:=</span>&nbsp;<span class="num" id="2238270">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238273">for</span>&nbsp;<span class="op" id="2238277">;</span>&nbsp;<span class="ident" id="2238279">i</span>&nbsp;<span class="op" id="2238281">&lt;</span>&nbsp;<span class="builtinfunc" id="2238283">len</span><span class="op" id="2238286">(</span><span class="ident" id="2238287">s</span><span class="op" id="2238288">)</span><span class="op" id="2238289">;</span>&nbsp;<span class="ident" id="2238291">i</span><span class="op" id="2238292">++</span>&nbsp;<span class="op" id="2238295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238299">switch</span>&nbsp;<span class="ident" id="2238306">c</span>&nbsp;<span class="op" id="2238308">:=</span>&nbsp;<span class="ident" id="2238311">s</span><span class="op" id="2238312">[</span><span class="ident" id="2238313">i</span><span class="op" id="2238314">]</span><span class="op" id="2238315">;</span>&nbsp;<span class="builtintype" id="2238317">true</span>&nbsp;<span class="op" id="2238322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238326">case</span>&nbsp;<span class="ident" id="2238331">c</span>&nbsp;<span class="op" id="2238333">==</span>&nbsp;<span class="string" id="2238336">&#39;.&#39;</span><span class="op" id="2238339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238344">if</span>&nbsp;<span class="ident" id="2238347">sawdot</span>&nbsp;<span class="op" id="2238354">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238360">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238375">sawdot</span>&nbsp;<span class="op" id="2238382">=</span>&nbsp;<span class="builtintype" id="2238384">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238392">dp</span>&nbsp;<span class="op" id="2238395">=</span>&nbsp;<span class="ident" id="2238397">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238403">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238415">case</span>&nbsp;<span class="string" id="2238420">&#39;0&#39;</span>&nbsp;<span class="op" id="2238424">&lt;=</span>&nbsp;<span class="ident" id="2238427">c</span>&nbsp;<span class="op" id="2238429">&amp;&amp;</span>&nbsp;<span class="ident" id="2238432">c</span>&nbsp;<span class="op" id="2238434">&lt;=</span>&nbsp;<span class="string" id="2238437">&#39;9&#39;</span><span class="op" id="2238440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238445">sawdigits</span>&nbsp;<span class="op" id="2238455">=</span>&nbsp;<span class="builtintype" id="2238457">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238465">if</span>&nbsp;<span class="ident" id="2238468">c</span>&nbsp;<span class="op" id="2238470">==</span>&nbsp;<span class="string" id="2238473">&#39;0&#39;</span>&nbsp;<span class="op" id="2238477">&amp;&amp;</span>&nbsp;<span class="ident" id="2238480">nd</span>&nbsp;<span class="op" id="2238483">==</span>&nbsp;<span class="num" id="2238486">0</span>&nbsp;<span class="op" id="2238488">{</span>&nbsp;<span class="comment" id="2238490">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238518">dp</span><span class="op" id="2238520">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238527">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238544">nd</span><span class="op" id="2238546">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238552">if</span>&nbsp;<span class="ident" id="2238555">ndMant</span>&nbsp;<span class="op" id="2238562">&lt;</span>&nbsp;<span class="ident" id="2238564">uint64digits</span>&nbsp;<span class="op" id="2238577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238583">mantissa</span>&nbsp;<span class="op" id="2238592">*=</span>&nbsp;<span class="num" id="2238595">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238602">mantissa</span>&nbsp;<span class="op" id="2238611">+=</span>&nbsp;<span class="ident" id="2238614">uint64</span><span class="op" id="2238620">(</span><span class="ident" id="2238621">c</span>&nbsp;<span class="op" id="2238623">-</span>&nbsp;<span class="string" id="2238625">&#39;0&#39;</span><span class="op" id="2238628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238634">ndMant</span><span class="op" id="2238640">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238646">}</span>&nbsp;<span class="keyword" id="2238648">else</span>&nbsp;<span class="keyword" id="2238653">if</span>&nbsp;<span class="ident" id="2238656">s</span><span class="op" id="2238657">[</span><span class="ident" id="2238658">i</span><span class="op" id="2238659">]</span>&nbsp;<span class="op" id="2238661">!=</span>&nbsp;<span class="string" id="2238664">&#39;0&#39;</span>&nbsp;<span class="op" id="2238668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238674">trunc</span>&nbsp;<span class="op" id="2238680">=</span>&nbsp;<span class="builtintype" id="2238682">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238690">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238695">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238710">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238720">if</span>&nbsp;<span class="op" id="2238723">!</span><span class="ident" id="2238724">sawdigits</span>&nbsp;<span class="op" id="2238734">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238738">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238749">if</span>&nbsp;<span class="op" id="2238752">!</span><span class="ident" id="2238753">sawdot</span>&nbsp;<span class="op" id="2238760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238764">dp</span>&nbsp;<span class="op" id="2238767">=</span>&nbsp;<span class="ident" id="2238769">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238773">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238777">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238820">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238867">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238913">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238965">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238991">if</span>&nbsp;<span class="ident" id="2238994">i</span>&nbsp;<span class="op" id="2238996">&lt;</span>&nbsp;<span class="builtinfunc" id="2238998">len</span><span class="op" id="2239001">(</span><span class="ident" id="2239002">s</span><span class="op" id="2239003">)</span>&nbsp;<span class="op" id="2239005">&amp;&amp;</span>&nbsp;<span class="op" id="2239008">(</span><span class="ident" id="2239009">s</span><span class="op" id="2239010">[</span><span class="ident" id="2239011">i</span><span class="op" id="2239012">]</span>&nbsp;<span class="op" id="2239014">==</span>&nbsp;<span class="string" id="2239017">&#39;e&#39;</span>&nbsp;<span class="op" id="2239021">||</span>&nbsp;<span class="ident" id="2239024">s</span><span class="op" id="2239025">[</span><span class="ident" id="2239026">i</span><span class="op" id="2239027">]</span>&nbsp;<span class="op" id="2239029">==</span>&nbsp;<span class="string" id="2239032">&#39;E&#39;</span><span class="op" id="2239035">)</span>&nbsp;<span class="op" id="2239037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239041">i</span><span class="op" id="2239042">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239047">if</span>&nbsp;<span class="ident" id="2239050">i</span>&nbsp;<span class="op" id="2239052">&gt;=</span>&nbsp;<span class="builtinfunc" id="2239055">len</span><span class="op" id="2239058">(</span><span class="ident" id="2239059">s</span><span class="op" id="2239060">)</span>&nbsp;<span class="op" id="2239062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239067">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239080">esign</span>&nbsp;<span class="op" id="2239086">:=</span>&nbsp;<span class="num" id="2239089">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239093">if</span>&nbsp;<span class="ident" id="2239096">s</span><span class="op" id="2239097">[</span><span class="ident" id="2239098">i</span><span class="op" id="2239099">]</span>&nbsp;<span class="op" id="2239101">==</span>&nbsp;<span class="string" id="2239104">&#39;+&#39;</span>&nbsp;<span class="op" id="2239108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239113">i</span><span class="op" id="2239114">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239119">}</span>&nbsp;<span class="keyword" id="2239121">else</span>&nbsp;<span class="keyword" id="2239126">if</span>&nbsp;<span class="ident" id="2239129">s</span><span class="op" id="2239130">[</span><span class="ident" id="2239131">i</span><span class="op" id="2239132">]</span>&nbsp;<span class="op" id="2239134">==</span>&nbsp;<span class="string" id="2239137">&#39;-&#39;</span>&nbsp;<span class="op" id="2239141">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239146">i</span><span class="op" id="2239147">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239153">esign</span>&nbsp;<span class="op" id="2239159">=</span>&nbsp;<span class="op" id="2239161">-</span><span class="num" id="2239162">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239170">if</span>&nbsp;<span class="ident" id="2239173">i</span>&nbsp;<span class="op" id="2239175">&gt;=</span>&nbsp;<span class="builtinfunc" id="2239178">len</span><span class="op" id="2239181">(</span><span class="ident" id="2239182">s</span><span class="op" id="2239183">)</span>&nbsp;<span class="op" id="2239185">||</span>&nbsp;<span class="ident" id="2239188">s</span><span class="op" id="2239189">[</span><span class="ident" id="2239190">i</span><span class="op" id="2239191">]</span>&nbsp;<span class="op" id="2239193">&lt;</span>&nbsp;<span class="string" id="2239195">&#39;0&#39;</span>&nbsp;<span class="op" id="2239199">||</span>&nbsp;<span class="ident" id="2239202">s</span><span class="op" id="2239203">[</span><span class="ident" id="2239204">i</span><span class="op" id="2239205">]</span>&nbsp;<span class="op" id="2239207">&gt;</span>&nbsp;<span class="string" id="2239209">&#39;9&#39;</span>&nbsp;<span class="op" id="2239213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239218">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239231">e</span>&nbsp;<span class="op" id="2239233">:=</span>&nbsp;<span class="num" id="2239236">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239240">for</span>&nbsp;<span class="op" id="2239244">;</span>&nbsp;<span class="ident" id="2239246">i</span>&nbsp;<span class="op" id="2239248">&lt;</span>&nbsp;<span class="builtinfunc" id="2239250">len</span><span class="op" id="2239253">(</span><span class="ident" id="2239254">s</span><span class="op" id="2239255">)</span>&nbsp;<span class="op" id="2239257">&amp;&amp;</span>&nbsp;<span class="string" id="2239260">&#39;0&#39;</span>&nbsp;<span class="op" id="2239264">&lt;=</span>&nbsp;<span class="ident" id="2239267">s</span><span class="op" id="2239268">[</span><span class="ident" id="2239269">i</span><span class="op" id="2239270">]</span>&nbsp;<span class="op" id="2239272">&amp;&amp;</span>&nbsp;<span class="ident" id="2239275">s</span><span class="op" id="2239276">[</span><span class="ident" id="2239277">i</span><span class="op" id="2239278">]</span>&nbsp;<span class="op" id="2239280">&lt;=</span>&nbsp;<span class="string" id="2239283">&#39;9&#39;</span><span class="op" id="2239286">;</span>&nbsp;<span class="ident" id="2239288">i</span><span class="op" id="2239289">++</span>&nbsp;<span class="op" id="2239292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239297">if</span>&nbsp;<span class="ident" id="2239300">e</span>&nbsp;<span class="op" id="2239302">&lt;</span>&nbsp;<span class="num" id="2239304">10000</span>&nbsp;<span class="op" id="2239310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239316">e</span>&nbsp;<span class="op" id="2239318">=</span>&nbsp;<span class="ident" id="2239320">e</span><span class="op" id="2239321">*</span><span class="num" id="2239322">10</span>&nbsp;<span class="op" id="2239325">+</span>&nbsp;<span class="builtintype" id="2239327">int</span><span class="op" id="2239330">(</span><span class="ident" id="2239331">s</span><span class="op" id="2239332">[</span><span class="ident" id="2239333">i</span><span class="op" id="2239334">]</span><span class="op" id="2239335">)</span>&nbsp;<span class="op" id="2239337">-</span>&nbsp;<span class="string" id="2239339">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239354">dp</span>&nbsp;<span class="op" id="2239357">+=</span>&nbsp;<span class="ident" id="2239360">e</span>&nbsp;<span class="op" id="2239362">*</span>&nbsp;<span class="ident" id="2239364">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239375">if</span>&nbsp;<span class="ident" id="2239378">i</span>&nbsp;<span class="op" id="2239380">!=</span>&nbsp;<span class="builtinfunc" id="2239383">len</span><span class="op" id="2239386">(</span><span class="ident" id="2239387">s</span><span class="op" id="2239388">)</span>&nbsp;<span class="op" id="2239390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239394">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239406">exp</span>&nbsp;<span class="op" id="2239410">=</span>&nbsp;<span class="ident" id="2239412">dp</span>&nbsp;<span class="op" id="2239415">-</span>&nbsp;<span class="ident" id="2239417">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239425">ok</span>&nbsp;<span class="op" id="2239428">=</span>&nbsp;<span class="builtintype" id="2239430">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239436">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2239444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2239447">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="2239495">var</span>&nbsp;<span class="ident" id="2239499">powtab</span>&nbsp;<span class="op" id="2239506">=</span>&nbsp;<span class="op" id="2239508">[</span><span class="op" id="2239509">]</span><span class="builtintype" id="2239510">int</span><span class="op" id="2239513">{</span><span class="num" id="2239514">1</span><span class="op" id="2239515">,</span>&nbsp;<span class="num" id="2239517">3</span><span class="op" id="2239518">,</span>&nbsp;<span class="num" id="2239520">6</span><span class="op" id="2239521">,</span>&nbsp;<span class="num" id="2239523">9</span><span class="op" id="2239524">,</span>&nbsp;<span class="num" id="2239526">13</span><span class="op" id="2239528">,</span>&nbsp;<span class="num" id="2239530">16</span><span class="op" id="2239532">,</span>&nbsp;<span class="num" id="2239534">19</span><span class="op" id="2239536">,</span>&nbsp;<span class="num" id="2239538">23</span><span class="op" id="2239540">,</span>&nbsp;<span class="num" id="2239542">26</span><span class="op" id="2239544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2239547">func</span>&nbsp;<span class="op" id="2239552">(</span><span class="ident" id="2239553">d</span>&nbsp;<span class="op" id="2239555">*</span><span class="ident" id="2239556">decimal</span><span class="op" id="2239563">)</span>&nbsp;<span class="ident" id="2239565">floatBits</span><span class="op" id="2239574">(</span><span class="ident" id="2239575">flt</span>&nbsp;<span class="op" id="2239579">*</span><span class="ident" id="2239580">floatInfo</span><span class="op" id="2239589">)</span>&nbsp;<span class="op" id="2239591">(</span><span class="ident" id="2239592">b</span>&nbsp;<span class="ident" id="2239594">uint64</span><span class="op" id="2239600">,</span>&nbsp;<span class="ident" id="2239602">overflow</span>&nbsp;<span class="builtintype" id="2239611">bool</span><span class="op" id="2239615">)</span>&nbsp;<span class="op" id="2239617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239620">var</span>&nbsp;<span class="ident" id="2239624">exp</span>&nbsp;<span class="builtintype" id="2239628">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239633">var</span>&nbsp;<span class="ident" id="2239637">mant</span>&nbsp;<span class="ident" id="2239642">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239651">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239686">if</span>&nbsp;<span class="ident" id="2239689">d</span><span class="op" id="2239690">.</span><span class="ident" id="2239691">nd</span>&nbsp;<span class="op" id="2239694">==</span>&nbsp;<span class="num" id="2239697">0</span>&nbsp;<span class="op" id="2239699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239703">mant</span>&nbsp;<span class="op" id="2239708">=</span>&nbsp;<span class="num" id="2239710">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239714">exp</span>&nbsp;<span class="op" id="2239718">=</span>&nbsp;<span class="ident" id="2239720">flt</span><span class="op" id="2239723">.</span><span class="ident" id="2239724">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239731">goto</span>&nbsp;<span class="ident" id="2239736">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239745">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239777">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239817">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239892">if</span>&nbsp;<span class="ident" id="2239895">d</span><span class="op" id="2239896">.</span><span class="ident" id="2239897">dp</span>&nbsp;<span class="op" id="2239900">&gt;</span>&nbsp;<span class="num" id="2239902">310</span>&nbsp;<span class="op" id="2239906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239910">goto</span>&nbsp;<span class="ident" id="2239915">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239925">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239928">if</span>&nbsp;<span class="ident" id="2239931">d</span><span class="op" id="2239932">.</span><span class="ident" id="2239933">dp</span>&nbsp;<span class="op" id="2239936">&lt;</span>&nbsp;<span class="op" id="2239938">-</span><span class="num" id="2239939">330</span>&nbsp;<span class="op" id="2239943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239947">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239957">mant</span>&nbsp;<span class="op" id="2239962">=</span>&nbsp;<span class="num" id="2239964">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239968">exp</span>&nbsp;<span class="op" id="2239972">=</span>&nbsp;<span class="ident" id="2239974">flt</span><span class="op" id="2239977">.</span><span class="ident" id="2239978">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239985">goto</span>&nbsp;<span class="ident" id="2239990">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239999">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240052">exp</span>&nbsp;<span class="op" id="2240056">=</span>&nbsp;<span class="num" id="2240058">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240061">for</span>&nbsp;<span class="ident" id="2240065">d</span><span class="op" id="2240066">.</span><span class="ident" id="2240067">dp</span>&nbsp;<span class="op" id="2240070">&gt;</span>&nbsp;<span class="num" id="2240072">0</span>&nbsp;<span class="op" id="2240074">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240078">var</span>&nbsp;<span class="ident" id="2240082">n</span>&nbsp;<span class="builtintype" id="2240084">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240090">if</span>&nbsp;<span class="ident" id="2240093">d</span><span class="op" id="2240094">.</span><span class="ident" id="2240095">dp</span>&nbsp;<span class="op" id="2240098">&gt;=</span>&nbsp;<span class="builtinfunc" id="2240101">len</span><span class="op" id="2240104">(</span><span class="ident" id="2240105">powtab</span><span class="op" id="2240111">)</span>&nbsp;<span class="op" id="2240113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240118">n</span>&nbsp;<span class="op" id="2240120">=</span>&nbsp;<span class="num" id="2240122">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240127">}</span>&nbsp;<span class="keyword" id="2240129">else</span>&nbsp;<span class="op" id="2240134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240139">n</span>&nbsp;<span class="op" id="2240141">=</span>&nbsp;<span class="ident" id="2240143">powtab</span><span class="op" id="2240149">[</span><span class="ident" id="2240150">d</span><span class="op" id="2240151">.</span><span class="ident" id="2240152">dp</span><span class="op" id="2240154">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240162">d</span><span class="op" id="2240163">.</span><span class="ident" id="2240164">Shift</span><span class="op" id="2240169">(</span><span class="op" id="2240170">-</span><span class="ident" id="2240171">n</span><span class="op" id="2240172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240176">exp</span>&nbsp;<span class="op" id="2240180">+=</span>&nbsp;<span class="ident" id="2240183">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240189">for</span>&nbsp;<span class="ident" id="2240193">d</span><span class="op" id="2240194">.</span><span class="ident" id="2240195">dp</span>&nbsp;<span class="op" id="2240198">&lt;</span>&nbsp;<span class="num" id="2240200">0</span>&nbsp;<span class="op" id="2240202">||</span>&nbsp;<span class="ident" id="2240205">d</span><span class="op" id="2240206">.</span><span class="ident" id="2240207">dp</span>&nbsp;<span class="op" id="2240210">==</span>&nbsp;<span class="num" id="2240213">0</span>&nbsp;<span class="op" id="2240215">&amp;&amp;</span>&nbsp;<span class="ident" id="2240218">d</span><span class="op" id="2240219">.</span><span class="ident" id="2240220">d</span><span class="op" id="2240221">[</span><span class="num" id="2240222">0</span><span class="op" id="2240223">]</span>&nbsp;<span class="op" id="2240225">&lt;</span>&nbsp;<span class="string" id="2240227">&#39;5&#39;</span>&nbsp;<span class="op" id="2240231">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240235">var</span>&nbsp;<span class="ident" id="2240239">n</span>&nbsp;<span class="builtintype" id="2240241">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240247">if</span>&nbsp;<span class="op" id="2240250">-</span><span class="ident" id="2240251">d</span><span class="op" id="2240252">.</span><span class="ident" id="2240253">dp</span>&nbsp;<span class="op" id="2240256">&gt;=</span>&nbsp;<span class="builtinfunc" id="2240259">len</span><span class="op" id="2240262">(</span><span class="ident" id="2240263">powtab</span><span class="op" id="2240269">)</span>&nbsp;<span class="op" id="2240271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240276">n</span>&nbsp;<span class="op" id="2240278">=</span>&nbsp;<span class="num" id="2240280">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240285">}</span>&nbsp;<span class="keyword" id="2240287">else</span>&nbsp;<span class="op" id="2240292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240297">n</span>&nbsp;<span class="op" id="2240299">=</span>&nbsp;<span class="ident" id="2240301">powtab</span><span class="op" id="2240307">[</span><span class="op" id="2240308">-</span><span class="ident" id="2240309">d</span><span class="op" id="2240310">.</span><span class="ident" id="2240311">dp</span><span class="op" id="2240313">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240321">d</span><span class="op" id="2240322">.</span><span class="ident" id="2240323">Shift</span><span class="op" id="2240328">(</span><span class="ident" id="2240329">n</span><span class="op" id="2240330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240334">exp</span>&nbsp;<span class="op" id="2240338">-=</span>&nbsp;<span class="ident" id="2240341">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240348">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240408">exp</span><span class="op" id="2240411">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240416">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240466">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240513">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240539">if</span>&nbsp;<span class="ident" id="2240542">exp</span>&nbsp;<span class="op" id="2240546">&lt;</span>&nbsp;<span class="ident" id="2240548">flt</span><span class="op" id="2240551">.</span><span class="ident" id="2240552">bias</span><span class="op" id="2240556">+</span><span class="num" id="2240557">1</span>&nbsp;<span class="op" id="2240559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240563">n</span>&nbsp;<span class="op" id="2240565">:=</span>&nbsp;<span class="ident" id="2240568">flt</span><span class="op" id="2240571">.</span><span class="ident" id="2240572">bias</span>&nbsp;<span class="op" id="2240577">+</span>&nbsp;<span class="num" id="2240579">1</span>&nbsp;<span class="op" id="2240581">-</span>&nbsp;<span class="ident" id="2240583">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240589">d</span><span class="op" id="2240590">.</span><span class="ident" id="2240591">Shift</span><span class="op" id="2240596">(</span><span class="op" id="2240597">-</span><span class="ident" id="2240598">n</span><span class="op" id="2240599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240603">exp</span>&nbsp;<span class="op" id="2240607">+=</span>&nbsp;<span class="ident" id="2240610">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240617">if</span>&nbsp;<span class="ident" id="2240620">exp</span><span class="op" id="2240623">-</span><span class="ident" id="2240624">flt</span><span class="op" id="2240627">.</span><span class="ident" id="2240628">bias</span>&nbsp;<span class="op" id="2240633">&gt;=</span>&nbsp;<span class="num" id="2240636">1</span><span class="op" id="2240637">&lt;&lt;</span><span class="ident" id="2240639">flt</span><span class="op" id="2240642">.</span><span class="ident" id="2240643">expbits</span><span class="op" id="2240650">-</span><span class="num" id="2240651">1</span>&nbsp;<span class="op" id="2240653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240657">goto</span>&nbsp;<span class="ident" id="2240662">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240672">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240676">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240709">d</span><span class="op" id="2240710">.</span><span class="ident" id="2240711">Shift</span><span class="op" id="2240716">(</span><span class="builtintype" id="2240717">int</span><span class="op" id="2240720">(</span><span class="num" id="2240721">1</span>&nbsp;<span class="op" id="2240723">+</span>&nbsp;<span class="ident" id="2240725">flt</span><span class="op" id="2240728">.</span><span class="ident" id="2240729">mantbits</span><span class="op" id="2240737">)</span><span class="op" id="2240738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240741">mant</span>&nbsp;<span class="op" id="2240746">=</span>&nbsp;<span class="ident" id="2240748">d</span><span class="op" id="2240749">.</span><span class="ident" id="2240750">RoundedInteger</span><span class="op" id="2240764">(</span><span class="op" id="2240765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240769">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240818">if</span>&nbsp;<span class="ident" id="2240821">mant</span>&nbsp;<span class="op" id="2240826">==</span>&nbsp;<span class="num" id="2240829">2</span><span class="op" id="2240830">&lt;&lt;</span><span class="ident" id="2240832">flt</span><span class="op" id="2240835">.</span><span class="ident" id="2240836">mantbits</span>&nbsp;<span class="op" id="2240845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240849">mant</span>&nbsp;<span class="op" id="2240854">&gt;&gt;=</span>&nbsp;<span class="num" id="2240858">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240862">exp</span><span class="op" id="2240865">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240870">if</span>&nbsp;<span class="ident" id="2240873">exp</span><span class="op" id="2240876">-</span><span class="ident" id="2240877">flt</span><span class="op" id="2240880">.</span><span class="ident" id="2240881">bias</span>&nbsp;<span class="op" id="2240886">&gt;=</span>&nbsp;<span class="num" id="2240889">1</span><span class="op" id="2240890">&lt;&lt;</span><span class="ident" id="2240892">flt</span><span class="op" id="2240895">.</span><span class="ident" id="2240896">expbits</span><span class="op" id="2240903">-</span><span class="num" id="2240904">1</span>&nbsp;<span class="op" id="2240906">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240911">goto</span>&nbsp;<span class="ident" id="2240916">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240934">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240952">if</span>&nbsp;<span class="ident" id="2240955">mant</span><span class="op" id="2240959">&amp;</span><span class="op" id="2240960">(</span><span class="num" id="2240961">1</span><span class="op" id="2240962">&lt;&lt;</span><span class="ident" id="2240964">flt</span><span class="op" id="2240967">.</span><span class="ident" id="2240968">mantbits</span><span class="op" id="2240976">)</span>&nbsp;<span class="op" id="2240978">==</span>&nbsp;<span class="num" id="2240981">0</span>&nbsp;<span class="op" id="2240983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240987">exp</span>&nbsp;<span class="op" id="2240991">=</span>&nbsp;<span class="ident" id="2240993">flt</span><span class="op" id="2240996">.</span><span class="ident" id="2240997">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2241003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241006">goto</span>&nbsp;<span class="ident" id="2241011">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="2241016">overflow</span><span class="op" id="2241024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2241027">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241037">mant</span>&nbsp;<span class="op" id="2241042">=</span>&nbsp;<span class="num" id="2241044">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241047">exp</span>&nbsp;<span class="op" id="2241051">=</span>&nbsp;<span class="num" id="2241053">1</span><span class="op" id="2241054">&lt;&lt;</span><span class="ident" id="2241056">flt</span><span class="op" id="2241059">.</span><span class="ident" id="2241060">expbits</span>&nbsp;<span class="op" id="2241068">-</span>&nbsp;<span class="num" id="2241070">1</span>&nbsp;<span class="op" id="2241072">+</span>&nbsp;<span class="ident" id="2241074">flt</span><span class="op" id="2241077">.</span><span class="ident" id="2241078">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241084">overflow</span>&nbsp;<span class="op" id="2241093">=</span>&nbsp;<span class="builtintype" id="2241095">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="2241101">out</span><span class="op" id="2241104">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2241107">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241126">bits</span>&nbsp;<span class="op" id="2241131">:=</span>&nbsp;<span class="ident" id="2241134">mant</span>&nbsp;<span class="op" id="2241139">&amp;</span>&nbsp;<span class="op" id="2241141">(</span><span class="ident" id="2241142">uint64</span><span class="op" id="2241148">(</span><span class="num" id="2241149">1</span><span class="op" id="2241150">)</span><span class="op" id="2241151">&lt;&lt;</span><span class="ident" id="2241153">flt</span><span class="op" id="2241156">.</span><span class="ident" id="2241157">mantbits</span>&nbsp;<span class="op" id="2241166">-</span>&nbsp;<span class="num" id="2241168">1</span><span class="op" id="2241169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241172">bits</span>&nbsp;<span class="op" id="2241177">|=</span>&nbsp;<span class="ident" id="2241180">uint64</span><span class="op" id="2241186">(</span><span class="op" id="2241187">(</span><span class="ident" id="2241188">exp</span><span class="op" id="2241191">-</span><span class="ident" id="2241192">flt</span><span class="op" id="2241195">.</span><span class="ident" id="2241196">bias</span><span class="op" id="2241200">)</span><span class="op" id="2241201">&amp;</span><span class="op" id="2241202">(</span><span class="num" id="2241203">1</span><span class="op" id="2241204">&lt;&lt;</span><span class="ident" id="2241206">flt</span><span class="op" id="2241209">.</span><span class="ident" id="2241210">expbits</span><span class="op" id="2241217">-</span><span class="num" id="2241218">1</span><span class="op" id="2241219">)</span><span class="op" id="2241220">)</span>&nbsp;<span class="op" id="2241222">&lt;&lt;</span>&nbsp;<span class="ident" id="2241225">flt</span><span class="op" id="2241228">.</span><span class="ident" id="2241229">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241239">if</span>&nbsp;<span class="ident" id="2241242">d</span><span class="op" id="2241243">.</span><span class="ident" id="2241244">neg</span>&nbsp;<span class="op" id="2241248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241252">bits</span>&nbsp;<span class="op" id="2241257">|=</span>&nbsp;<span class="num" id="2241260">1</span>&nbsp;<span class="op" id="2241262">&lt;&lt;</span>&nbsp;<span class="ident" id="2241265">flt</span><span class="op" id="2241268">.</span><span class="ident" id="2241269">mantbits</span>&nbsp;<span class="op" id="2241278">&lt;&lt;</span>&nbsp;<span class="ident" id="2241281">flt</span><span class="op" id="2241284">.</span><span class="ident" id="2241285">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2241294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241297">return</span>&nbsp;<span class="ident" id="2241304">bits</span><span class="op" id="2241308">,</span>&nbsp;<span class="ident" id="2241310">overflow</span><br>
<span class="lineno"></span><span class="op" id="2241319">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2241322">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2241345">var</span>&nbsp;<span class="ident" id="2241349">float64pow10</span>&nbsp;<span class="op" id="2241362">=</span>&nbsp;<span class="op" id="2241364">[</span><span class="op" id="2241365">]</span><span class="builtintype" id="2241366">float64</span><span class="op" id="2241373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2241376">1e0</span><span class="op" id="2241379">,</span>&nbsp;<span class="num" id="2241381">1e1</span><span class="op" id="2241384">,</span>&nbsp;<span class="num" id="2241386">1e2</span><span class="op" id="2241389">,</span>&nbsp;<span class="num" id="2241391">1e3</span><span class="op" id="2241394">,</span>&nbsp;<span class="num" id="2241396">1e4</span><span class="op" id="2241399">,</span>&nbsp;<span class="num" id="2241401">1e5</span><span class="op" id="2241404">,</span>&nbsp;<span class="num" id="2241406">1e6</span><span class="op" id="2241409">,</span>&nbsp;<span class="num" id="2241411">1e7</span><span class="op" id="2241414">,</span>&nbsp;<span class="num" id="2241416">1e8</span><span class="op" id="2241419">,</span>&nbsp;<span class="num" id="2241421">1e9</span><span class="op" id="2241424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2241427">1e10</span><span class="op" id="2241431">,</span>&nbsp;<span class="num" id="2241433">1e11</span><span class="op" id="2241437">,</span>&nbsp;<span class="num" id="2241439">1e12</span><span class="op" id="2241443">,</span>&nbsp;<span class="num" id="2241445">1e13</span><span class="op" id="2241449">,</span>&nbsp;<span class="num" id="2241451">1e14</span><span class="op" id="2241455">,</span>&nbsp;<span class="num" id="2241457">1e15</span><span class="op" id="2241461">,</span>&nbsp;<span class="num" id="2241463">1e16</span><span class="op" id="2241467">,</span>&nbsp;<span class="num" id="2241469">1e17</span><span class="op" id="2241473">,</span>&nbsp;<span class="num" id="2241475">1e18</span><span class="op" id="2241479">,</span>&nbsp;<span class="num" id="2241481">1e19</span><span class="op" id="2241485">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2241488">1e20</span><span class="op" id="2241492">,</span>&nbsp;<span class="num" id="2241494">1e21</span><span class="op" id="2241498">,</span>&nbsp;<span class="num" id="2241500">1e22</span><span class="op" id="2241504">,</span><br>
<span class="lineno"></span><span class="op" id="2241506">}</span><br>
<span class="lineno"></span><span class="keyword" id="2241508">var</span>&nbsp;<span class="ident" id="2241512">float32pow10</span>&nbsp;<span class="op" id="2241525">=</span>&nbsp;<span class="op" id="2241527">[</span><span class="op" id="2241528">]</span><span class="builtintype" id="2241529">float32</span><span class="op" id="2241536">{</span><span class="num" id="2241537">1e0</span><span class="op" id="2241540">,</span>&nbsp;<span class="num" id="2241542">1e1</span><span class="op" id="2241545">,</span>&nbsp;<span class="num" id="2241547">1e2</span><span class="op" id="2241550">,</span>&nbsp;<span class="num" id="2241552">1e3</span><span class="op" id="2241555">,</span>&nbsp;<span class="num" id="2241557">1e4</span><span class="op" id="2241560">,</span>&nbsp;<span class="num" id="2241562">1e5</span><span class="op" id="2241565">,</span>&nbsp;<span class="num" id="2241567">1e6</span><span class="op" id="2241570">,</span>&nbsp;<span class="num" id="2241572">1e7</span><span class="op" id="2241575">,</span>&nbsp;<span class="num" id="2241577">1e8</span><span class="op" id="2241580">,</span>&nbsp;<span class="num" id="2241582">1e9</span><span class="op" id="2241585">,</span>&nbsp;<span class="num" id="2241587">1e10</span><span class="op" id="2241591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2241594">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="2241670">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="2241757">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2241780">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2241806">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="2241853">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="2241900">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="2241972">func</span>&nbsp;<span class="ident" id="2241977">atof64exact</span><span class="op" id="2241988">(</span><span class="ident" id="2241989">mantissa</span>&nbsp;<span class="ident" id="2241998">uint64</span><span class="op" id="2242004">,</span>&nbsp;<span class="ident" id="2242006">exp</span>&nbsp;<span class="builtintype" id="2242010">int</span><span class="op" id="2242013">,</span>&nbsp;<span class="ident" id="2242015">neg</span>&nbsp;<span class="builtintype" id="2242019">bool</span><span class="op" id="2242023">)</span>&nbsp;<span class="op" id="2242025">(</span><span class="ident" id="2242026">f</span>&nbsp;<span class="builtintype" id="2242028">float64</span><span class="op" id="2242035">,</span>&nbsp;<span class="ident" id="2242037">ok</span>&nbsp;<span class="builtintype" id="2242040">bool</span><span class="op" id="2242044">)</span>&nbsp;<span class="op" id="2242046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242049">if</span>&nbsp;<span class="ident" id="2242052">mantissa</span><span class="op" id="2242060">&gt;&gt;</span><span class="ident" id="2242062">float64info</span><span class="op" id="2242073">.</span><span class="ident" id="2242074">mantbits</span>&nbsp;<span class="op" id="2242083">!=</span>&nbsp;<span class="num" id="2242086">0</span>&nbsp;<span class="op" id="2242088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242092">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2242100">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242103">f</span>&nbsp;<span class="op" id="2242105">=</span>&nbsp;<span class="builtintype" id="2242107">float64</span><span class="op" id="2242114">(</span><span class="ident" id="2242115">mantissa</span><span class="op" id="2242123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242126">if</span>&nbsp;<span class="ident" id="2242129">neg</span>&nbsp;<span class="op" id="2242133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242137">f</span>&nbsp;<span class="op" id="2242139">=</span>&nbsp;<span class="op" id="2242141">-</span><span class="ident" id="2242142">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2242145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242148">switch</span>&nbsp;<span class="op" id="2242155">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242158">case</span>&nbsp;<span class="ident" id="2242163">exp</span>&nbsp;<span class="op" id="2242167">==</span>&nbsp;<span class="num" id="2242170">0</span><span class="op" id="2242171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2242175">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242192">return</span>&nbsp;<span class="ident" id="2242199">f</span><span class="op" id="2242200">,</span>&nbsp;<span class="builtintype" id="2242202">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2242208">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2242241">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242279">case</span>&nbsp;<span class="ident" id="2242284">exp</span>&nbsp;<span class="op" id="2242288">&gt;</span>&nbsp;<span class="num" id="2242290">0</span>&nbsp;<span class="op" id="2242292">&amp;&amp;</span>&nbsp;<span class="ident" id="2242295">exp</span>&nbsp;<span class="op" id="2242299">&lt;=</span>&nbsp;<span class="num" id="2242302">15</span><span class="op" id="2242304">+</span><span class="num" id="2242305">22</span><span class="op" id="2242307">:</span>&nbsp;<span class="comment" id="2242309">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2242325">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2242378">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242427">if</span>&nbsp;<span class="ident" id="2242430">exp</span>&nbsp;<span class="op" id="2242434">&gt;</span>&nbsp;<span class="num" id="2242436">22</span>&nbsp;<span class="op" id="2242439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242444">f</span>&nbsp;<span class="op" id="2242446">*=</span>&nbsp;<span class="ident" id="2242449">float64pow10</span><span class="op" id="2242461">[</span><span class="ident" id="2242462">exp</span><span class="op" id="2242465">-</span><span class="num" id="2242466">22</span><span class="op" id="2242468">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242473">exp</span>&nbsp;<span class="op" id="2242477">=</span>&nbsp;<span class="num" id="2242479">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2242484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242488">if</span>&nbsp;<span class="ident" id="2242491">f</span>&nbsp;<span class="op" id="2242493">&gt;</span>&nbsp;<span class="num" id="2242495">1e15</span>&nbsp;<span class="op" id="2242500">||</span>&nbsp;<span class="ident" id="2242503">f</span>&nbsp;<span class="op" id="2242505">&lt;</span>&nbsp;<span class="op" id="2242507">-</span><span class="num" id="2242508">1e15</span>&nbsp;<span class="op" id="2242513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2242518">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242559">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2242568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242572">return</span>&nbsp;<span class="ident" id="2242579">f</span>&nbsp;<span class="op" id="2242581">*</span>&nbsp;<span class="ident" id="2242583">float64pow10</span><span class="op" id="2242595">[</span><span class="ident" id="2242596">exp</span><span class="op" id="2242599">]</span><span class="op" id="2242600">,</span>&nbsp;<span class="builtintype" id="2242602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242608">case</span>&nbsp;<span class="ident" id="2242613">exp</span>&nbsp;<span class="op" id="2242617">&lt;</span>&nbsp;<span class="num" id="2242619">0</span>&nbsp;<span class="op" id="2242621">&amp;&amp;</span>&nbsp;<span class="ident" id="2242624">exp</span>&nbsp;<span class="op" id="2242628">&gt;=</span>&nbsp;<span class="op" id="2242631">-</span><span class="num" id="2242632">22</span><span class="op" id="2242634">:</span>&nbsp;<span class="comment" id="2242636">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242652">return</span>&nbsp;<span class="ident" id="2242659">f</span>&nbsp;<span class="op" id="2242661">/</span>&nbsp;<span class="ident" id="2242663">float64pow10</span><span class="op" id="2242675">[</span><span class="op" id="2242676">-</span><span class="ident" id="2242677">exp</span><span class="op" id="2242680">]</span><span class="op" id="2242681">,</span>&nbsp;<span class="builtintype" id="2242683">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2242689">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242692">return</span><br>
<span class="lineno"></span><span class="op" id="2242699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2242702">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="2242771">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="2242844">func</span>&nbsp;<span class="ident" id="2242849">atof32exact</span><span class="op" id="2242860">(</span><span class="ident" id="2242861">mantissa</span>&nbsp;<span class="ident" id="2242870">uint64</span><span class="op" id="2242876">,</span>&nbsp;<span class="ident" id="2242878">exp</span>&nbsp;<span class="builtintype" id="2242882">int</span><span class="op" id="2242885">,</span>&nbsp;<span class="ident" id="2242887">neg</span>&nbsp;<span class="builtintype" id="2242891">bool</span><span class="op" id="2242895">)</span>&nbsp;<span class="op" id="2242897">(</span><span class="ident" id="2242898">f</span>&nbsp;<span class="builtintype" id="2242900">float32</span><span class="op" id="2242907">,</span>&nbsp;<span class="ident" id="2242909">ok</span>&nbsp;<span class="builtintype" id="2242912">bool</span><span class="op" id="2242916">)</span>&nbsp;<span class="op" id="2242918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242921">if</span>&nbsp;<span class="ident" id="2242924">mantissa</span><span class="op" id="2242932">&gt;&gt;</span><span class="ident" id="2242934">float32info</span><span class="op" id="2242945">.</span><span class="ident" id="2242946">mantbits</span>&nbsp;<span class="op" id="2242955">!=</span>&nbsp;<span class="num" id="2242958">0</span>&nbsp;<span class="op" id="2242960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242964">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2242972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242975">f</span>&nbsp;<span class="op" id="2242977">=</span>&nbsp;<span class="builtintype" id="2242979">float32</span><span class="op" id="2242986">(</span><span class="ident" id="2242987">mantissa</span><span class="op" id="2242995">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242998">if</span>&nbsp;<span class="ident" id="2243001">neg</span>&nbsp;<span class="op" id="2243005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243009">f</span>&nbsp;<span class="op" id="2243011">=</span>&nbsp;<span class="op" id="2243013">-</span><span class="ident" id="2243014">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243020">switch</span>&nbsp;<span class="op" id="2243027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243030">case</span>&nbsp;<span class="ident" id="2243035">exp</span>&nbsp;<span class="op" id="2243039">==</span>&nbsp;<span class="num" id="2243042">0</span><span class="op" id="2243043">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243047">return</span>&nbsp;<span class="ident" id="2243054">f</span><span class="op" id="2243055">,</span>&nbsp;<span class="builtintype" id="2243057">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243063">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243095">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243133">case</span>&nbsp;<span class="ident" id="2243138">exp</span>&nbsp;<span class="op" id="2243142">&gt;</span>&nbsp;<span class="num" id="2243144">0</span>&nbsp;<span class="op" id="2243146">&amp;&amp;</span>&nbsp;<span class="ident" id="2243149">exp</span>&nbsp;<span class="op" id="2243153">&lt;=</span>&nbsp;<span class="num" id="2243156">7</span><span class="op" id="2243157">+</span><span class="num" id="2243158">10</span><span class="op" id="2243160">:</span>&nbsp;<span class="comment" id="2243162">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243178">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243231">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243280">if</span>&nbsp;<span class="ident" id="2243283">exp</span>&nbsp;<span class="op" id="2243287">&gt;</span>&nbsp;<span class="num" id="2243289">10</span>&nbsp;<span class="op" id="2243292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243297">f</span>&nbsp;<span class="op" id="2243299">*=</span>&nbsp;<span class="ident" id="2243302">float32pow10</span><span class="op" id="2243314">[</span><span class="ident" id="2243315">exp</span><span class="op" id="2243318">-</span><span class="num" id="2243319">10</span><span class="op" id="2243321">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243326">exp</span>&nbsp;<span class="op" id="2243330">=</span>&nbsp;<span class="num" id="2243332">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243337">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243341">if</span>&nbsp;<span class="ident" id="2243344">f</span>&nbsp;<span class="op" id="2243346">&gt;</span>&nbsp;<span class="num" id="2243348">1e7</span>&nbsp;<span class="op" id="2243352">||</span>&nbsp;<span class="ident" id="2243355">f</span>&nbsp;<span class="op" id="2243357">&lt;</span>&nbsp;<span class="op" id="2243359">-</span><span class="num" id="2243360">1e7</span>&nbsp;<span class="op" id="2243364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243369">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243410">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243423">return</span>&nbsp;<span class="ident" id="2243430">f</span>&nbsp;<span class="op" id="2243432">*</span>&nbsp;<span class="ident" id="2243434">float32pow10</span><span class="op" id="2243446">[</span><span class="ident" id="2243447">exp</span><span class="op" id="2243450">]</span><span class="op" id="2243451">,</span>&nbsp;<span class="builtintype" id="2243453">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243459">case</span>&nbsp;<span class="ident" id="2243464">exp</span>&nbsp;<span class="op" id="2243468">&lt;</span>&nbsp;<span class="num" id="2243470">0</span>&nbsp;<span class="op" id="2243472">&amp;&amp;</span>&nbsp;<span class="ident" id="2243475">exp</span>&nbsp;<span class="op" id="2243479">&gt;=</span>&nbsp;<span class="op" id="2243482">-</span><span class="num" id="2243483">10</span><span class="op" id="2243485">:</span>&nbsp;<span class="comment" id="2243487">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243503">return</span>&nbsp;<span class="ident" id="2243510">f</span>&nbsp;<span class="op" id="2243512">/</span>&nbsp;<span class="ident" id="2243514">float32pow10</span><span class="op" id="2243526">[</span><span class="op" id="2243527">-</span><span class="ident" id="2243528">exp</span><span class="op" id="2243531">]</span><span class="op" id="2243532">,</span>&nbsp;<span class="builtintype" id="2243534">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243543">return</span><br>
<span class="lineno"></span><span class="op" id="2243550">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2243553">const</span>&nbsp;<span class="ident" id="2243559">fnParseFloat</span>&nbsp;<span class="op" id="2243572">=</span>&nbsp;<span class="string" id="2243574">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2243588">func</span>&nbsp;<span class="ident" id="2243593">atof32</span><span class="op" id="2243599">(</span><span class="ident" id="2243600">s</span>&nbsp;<span class="builtintype" id="2243602">string</span><span class="op" id="2243608">)</span>&nbsp;<span class="op" id="2243610">(</span><span class="ident" id="2243611">f</span>&nbsp;<span class="builtintype" id="2243613">float32</span><span class="op" id="2243620">,</span>&nbsp;<span class="ident" id="2243622">err</span>&nbsp;<span class="builtintype" id="2243626">error</span><span class="op" id="2243631">)</span>&nbsp;<span class="op" id="2243633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243636">if</span>&nbsp;<span class="ident" id="2243639">val</span><span class="op" id="2243642">,</span>&nbsp;<span class="ident" id="2243644">ok</span>&nbsp;<span class="op" id="2243647">:=</span>&nbsp;<span class="ident" id="2243650">special</span><span class="op" id="2243657">(</span><span class="ident" id="2243658">s</span><span class="op" id="2243659">)</span><span class="op" id="2243660">;</span>&nbsp;<span class="ident" id="2243662">ok</span>&nbsp;<span class="op" id="2243665">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243669">return</span>&nbsp;<span class="builtintype" id="2243676">float32</span><span class="op" id="2243683">(</span><span class="ident" id="2243684">val</span><span class="op" id="2243687">)</span><span class="op" id="2243688">,</span>&nbsp;<span class="builtintype" id="2243690">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243699">if</span>&nbsp;<span class="ident" id="2243702">optimize</span>&nbsp;<span class="op" id="2243711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243715">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243749">mantissa</span><span class="op" id="2243757">,</span>&nbsp;<span class="ident" id="2243759">exp</span><span class="op" id="2243762">,</span>&nbsp;<span class="ident" id="2243764">neg</span><span class="op" id="2243767">,</span>&nbsp;<span class="ident" id="2243769">trunc</span><span class="op" id="2243774">,</span>&nbsp;<span class="ident" id="2243776">ok</span>&nbsp;<span class="op" id="2243779">:=</span>&nbsp;<span class="ident" id="2243782">readFloat</span><span class="op" id="2243791">(</span><span class="ident" id="2243792">s</span><span class="op" id="2243793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243797">if</span>&nbsp;<span class="ident" id="2243800">ok</span>&nbsp;<span class="op" id="2243803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243808">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243861">if</span>&nbsp;<span class="op" id="2243864">!</span><span class="ident" id="2243865">trunc</span>&nbsp;<span class="op" id="2243871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243877">if</span>&nbsp;<span class="ident" id="2243880">f</span><span class="op" id="2243881">,</span>&nbsp;<span class="ident" id="2243883">ok</span>&nbsp;<span class="op" id="2243886">:=</span>&nbsp;<span class="ident" id="2243889">atof32exact</span><span class="op" id="2243900">(</span><span class="ident" id="2243901">mantissa</span><span class="op" id="2243909">,</span>&nbsp;<span class="ident" id="2243911">exp</span><span class="op" id="2243914">,</span>&nbsp;<span class="ident" id="2243916">neg</span><span class="op" id="2243919">)</span><span class="op" id="2243920">;</span>&nbsp;<span class="ident" id="2243922">ok</span>&nbsp;<span class="op" id="2243925">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243932">return</span>&nbsp;<span class="ident" id="2243939">f</span><span class="op" id="2243940">,</span>&nbsp;<span class="builtintype" id="2243942">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243960">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243989">ext</span>&nbsp;<span class="op" id="2243993">:=</span>&nbsp;<span class="builtinfunc" id="2243996">new</span><span class="op" id="2243999">(</span><span class="ident" id="2244000">extFloat</span><span class="op" id="2244008">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244013">if</span>&nbsp;<span class="ident" id="2244016">ok</span>&nbsp;<span class="op" id="2244019">:=</span>&nbsp;<span class="ident" id="2244022">ext</span><span class="op" id="2244025">.</span><span class="ident" id="2244026">AssignDecimal</span><span class="op" id="2244039">(</span><span class="ident" id="2244040">mantissa</span><span class="op" id="2244048">,</span>&nbsp;<span class="ident" id="2244050">exp</span><span class="op" id="2244053">,</span>&nbsp;<span class="ident" id="2244055">neg</span><span class="op" id="2244058">,</span>&nbsp;<span class="ident" id="2244060">trunc</span><span class="op" id="2244065">,</span>&nbsp;<span class="op" id="2244067">&amp;</span><span class="ident" id="2244068">float32info</span><span class="op" id="2244079">)</span><span class="op" id="2244080">;</span>&nbsp;<span class="ident" id="2244082">ok</span>&nbsp;<span class="op" id="2244085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244091">b</span><span class="op" id="2244092">,</span>&nbsp;<span class="ident" id="2244094">ovf</span>&nbsp;<span class="op" id="2244098">:=</span>&nbsp;<span class="ident" id="2244101">ext</span><span class="op" id="2244104">.</span><span class="ident" id="2244105">floatBits</span><span class="op" id="2244114">(</span><span class="op" id="2244115">&amp;</span><span class="ident" id="2244116">float32info</span><span class="op" id="2244127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244133">f</span>&nbsp;<span class="op" id="2244135">=</span>&nbsp;<span class="ident" id="2244137">math</span><span class="op" id="2244141">.</span><span class="ident" id="2244142">Float32frombits</span><span class="op" id="2244157">(</span><span class="builtintype" id="2244158">uint32</span><span class="op" id="2244164">(</span><span class="ident" id="2244165">b</span><span class="op" id="2244166">)</span><span class="op" id="2244167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244173">if</span>&nbsp;<span class="ident" id="2244176">ovf</span>&nbsp;<span class="op" id="2244180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244187">err</span>&nbsp;<span class="op" id="2244191">=</span>&nbsp;<span class="ident" id="2244193">rangeError</span><span class="op" id="2244203">(</span><span class="ident" id="2244204">fnParseFloat</span><span class="op" id="2244216">,</span>&nbsp;<span class="ident" id="2244218">s</span><span class="op" id="2244219">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244231">return</span>&nbsp;<span class="ident" id="2244238">f</span><span class="op" id="2244239">,</span>&nbsp;<span class="ident" id="2244241">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244255">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244258">var</span>&nbsp;<span class="ident" id="2244262">d</span>&nbsp;<span class="ident" id="2244264">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244273">if</span>&nbsp;<span class="op" id="2244276">!</span><span class="ident" id="2244277">d</span><span class="op" id="2244278">.</span><span class="ident" id="2244279">set</span><span class="op" id="2244282">(</span><span class="ident" id="2244283">s</span><span class="op" id="2244284">)</span>&nbsp;<span class="op" id="2244286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244290">return</span>&nbsp;<span class="num" id="2244297">0</span><span class="op" id="2244298">,</span>&nbsp;<span class="ident" id="2244300">syntaxError</span><span class="op" id="2244311">(</span><span class="ident" id="2244312">fnParseFloat</span><span class="op" id="2244324">,</span>&nbsp;<span class="ident" id="2244326">s</span><span class="op" id="2244327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244333">b</span><span class="op" id="2244334">,</span>&nbsp;<span class="ident" id="2244336">ovf</span>&nbsp;<span class="op" id="2244340">:=</span>&nbsp;<span class="ident" id="2244343">d</span><span class="op" id="2244344">.</span><span class="ident" id="2244345">floatBits</span><span class="op" id="2244354">(</span><span class="op" id="2244355">&amp;</span><span class="ident" id="2244356">float32info</span><span class="op" id="2244367">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244370">f</span>&nbsp;<span class="op" id="2244372">=</span>&nbsp;<span class="ident" id="2244374">math</span><span class="op" id="2244378">.</span><span class="ident" id="2244379">Float32frombits</span><span class="op" id="2244394">(</span><span class="builtintype" id="2244395">uint32</span><span class="op" id="2244401">(</span><span class="ident" id="2244402">b</span><span class="op" id="2244403">)</span><span class="op" id="2244404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244407">if</span>&nbsp;<span class="ident" id="2244410">ovf</span>&nbsp;<span class="op" id="2244414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244418">err</span>&nbsp;<span class="op" id="2244422">=</span>&nbsp;<span class="ident" id="2244424">rangeError</span><span class="op" id="2244434">(</span><span class="ident" id="2244435">fnParseFloat</span><span class="op" id="2244447">,</span>&nbsp;<span class="ident" id="2244449">s</span><span class="op" id="2244450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244456">return</span>&nbsp;<span class="ident" id="2244463">f</span><span class="op" id="2244464">,</span>&nbsp;<span class="ident" id="2244466">err</span><br>
<span class="lineno">475</span><span class="op" id="2244470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2244473">func</span>&nbsp;<span class="ident" id="2244478">atof64</span><span class="op" id="2244484">(</span><span class="ident" id="2244485">s</span>&nbsp;<span class="builtintype" id="2244487">string</span><span class="op" id="2244493">)</span>&nbsp;<span class="op" id="2244495">(</span><span class="ident" id="2244496">f</span>&nbsp;<span class="builtintype" id="2244498">float64</span><span class="op" id="2244505">,</span>&nbsp;<span class="ident" id="2244507">err</span>&nbsp;<span class="builtintype" id="2244511">error</span><span class="op" id="2244516">)</span>&nbsp;<span class="op" id="2244518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244521">if</span>&nbsp;<span class="ident" id="2244524">val</span><span class="op" id="2244527">,</span>&nbsp;<span class="ident" id="2244529">ok</span>&nbsp;<span class="op" id="2244532">:=</span>&nbsp;<span class="ident" id="2244535">special</span><span class="op" id="2244542">(</span><span class="ident" id="2244543">s</span><span class="op" id="2244544">)</span><span class="op" id="2244545">;</span>&nbsp;<span class="ident" id="2244547">ok</span>&nbsp;<span class="op" id="2244550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244554">return</span>&nbsp;<span class="ident" id="2244561">val</span><span class="op" id="2244564">,</span>&nbsp;<span class="builtintype" id="2244566">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244575">if</span>&nbsp;<span class="ident" id="2244578">optimize</span>&nbsp;<span class="op" id="2244587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244591">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244625">mantissa</span><span class="op" id="2244633">,</span>&nbsp;<span class="ident" id="2244635">exp</span><span class="op" id="2244638">,</span>&nbsp;<span class="ident" id="2244640">neg</span><span class="op" id="2244643">,</span>&nbsp;<span class="ident" id="2244645">trunc</span><span class="op" id="2244650">,</span>&nbsp;<span class="ident" id="2244652">ok</span>&nbsp;<span class="op" id="2244655">:=</span>&nbsp;<span class="ident" id="2244658">readFloat</span><span class="op" id="2244667">(</span><span class="ident" id="2244668">s</span><span class="op" id="2244669">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244673">if</span>&nbsp;<span class="ident" id="2244676">ok</span>&nbsp;<span class="op" id="2244679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244684">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244737">if</span>&nbsp;<span class="op" id="2244740">!</span><span class="ident" id="2244741">trunc</span>&nbsp;<span class="op" id="2244747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244753">if</span>&nbsp;<span class="ident" id="2244756">f</span><span class="op" id="2244757">,</span>&nbsp;<span class="ident" id="2244759">ok</span>&nbsp;<span class="op" id="2244762">:=</span>&nbsp;<span class="ident" id="2244765">atof64exact</span><span class="op" id="2244776">(</span><span class="ident" id="2244777">mantissa</span><span class="op" id="2244785">,</span>&nbsp;<span class="ident" id="2244787">exp</span><span class="op" id="2244790">,</span>&nbsp;<span class="ident" id="2244792">neg</span><span class="op" id="2244795">)</span><span class="op" id="2244796">;</span>&nbsp;<span class="ident" id="2244798">ok</span>&nbsp;<span class="op" id="2244801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244808">return</span>&nbsp;<span class="ident" id="2244815">f</span><span class="op" id="2244816">,</span>&nbsp;<span class="builtintype" id="2244818">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2244831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244836">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244865">ext</span>&nbsp;<span class="op" id="2244869">:=</span>&nbsp;<span class="builtinfunc" id="2244872">new</span><span class="op" id="2244875">(</span><span class="ident" id="2244876">extFloat</span><span class="op" id="2244884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2244889">if</span>&nbsp;<span class="ident" id="2244892">ok</span>&nbsp;<span class="op" id="2244895">:=</span>&nbsp;<span class="ident" id="2244898">ext</span><span class="op" id="2244901">.</span><span class="ident" id="2244902">AssignDecimal</span><span class="op" id="2244915">(</span><span class="ident" id="2244916">mantissa</span><span class="op" id="2244924">,</span>&nbsp;<span class="ident" id="2244926">exp</span><span class="op" id="2244929">,</span>&nbsp;<span class="ident" id="2244931">neg</span><span class="op" id="2244934">,</span>&nbsp;<span class="ident" id="2244936">trunc</span><span class="op" id="2244941">,</span>&nbsp;<span class="op" id="2244943">&amp;</span><span class="ident" id="2244944">float64info</span><span class="op" id="2244955">)</span><span class="op" id="2244956">;</span>&nbsp;<span class="ident" id="2244958">ok</span>&nbsp;<span class="op" id="2244961">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2244967">b</span><span class="op" id="2244968">,</span>&nbsp;<span class="ident" id="2244970">ovf</span>&nbsp;<span class="op" id="2244974">:=</span>&nbsp;<span class="ident" id="2244977">ext</span><span class="op" id="2244980">.</span><span class="ident" id="2244981">floatBits</span><span class="op" id="2244990">(</span><span class="op" id="2244991">&amp;</span><span class="ident" id="2244992">float64info</span><span class="op" id="2245003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2245009">f</span>&nbsp;<span class="op" id="2245011">=</span>&nbsp;<span class="ident" id="2245013">math</span><span class="op" id="2245017">.</span><span class="ident" id="2245018">Float64frombits</span><span class="op" id="2245033">(</span><span class="ident" id="2245034">b</span><span class="op" id="2245035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2245041">if</span>&nbsp;<span class="ident" id="2245044">ovf</span>&nbsp;<span class="op" id="2245048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2245055">err</span>&nbsp;<span class="op" id="2245059">=</span>&nbsp;<span class="ident" id="2245061">rangeError</span><span class="op" id="2245071">(</span><span class="ident" id="2245072">fnParseFloat</span><span class="op" id="2245084">,</span>&nbsp;<span class="ident" id="2245086">s</span><span class="op" id="2245087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2245093">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2245099">return</span>&nbsp;<span class="ident" id="2245106">f</span><span class="op" id="2245107">,</span>&nbsp;<span class="ident" id="2245109">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2245116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2245120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2245123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2245126">var</span>&nbsp;<span class="ident" id="2245130">d</span>&nbsp;<span class="ident" id="2245132">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2245141">if</span>&nbsp;<span class="op" id="2245144">!</span><span class="ident" id="2245145">d</span><span class="op" id="2245146">.</span><span class="ident" id="2245147">set</span><span class="op" id="2245150">(</span><span class="ident" id="2245151">s</span><span class="op" id="2245152">)</span>&nbsp;<span class="op" id="2245154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2245158">return</span>&nbsp;<span class="num" id="2245165">0</span><span class="op" id="2245166">,</span>&nbsp;<span class="ident" id="2245168">syntaxError</span><span class="op" id="2245179">(</span><span class="ident" id="2245180">fnParseFloat</span><span class="op" id="2245192">,</span>&nbsp;<span class="ident" id="2245194">s</span><span class="op" id="2245195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2245198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2245201">b</span><span class="op" id="2245202">,</span>&nbsp;<span class="ident" id="2245204">ovf</span>&nbsp;<span class="op" id="2245208">:=</span>&nbsp;<span class="ident" id="2245211">d</span><span class="op" id="2245212">.</span><span class="ident" id="2245213">floatBits</span><span class="op" id="2245222">(</span><span class="op" id="2245223">&amp;</span><span class="ident" id="2245224">float64info</span><span class="op" id="2245235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2245238">f</span>&nbsp;<span class="op" id="2245240">=</span>&nbsp;<span class="ident" id="2245242">math</span><span class="op" id="2245246">.</span><span class="ident" id="2245247">Float64frombits</span><span class="op" id="2245262">(</span><span class="ident" id="2245263">b</span><span class="op" id="2245264">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2245267">if</span>&nbsp;<span class="ident" id="2245270">ovf</span>&nbsp;<span class="op" id="2245274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2245278">err</span>&nbsp;<span class="op" id="2245282">=</span>&nbsp;<span class="ident" id="2245284">rangeError</span><span class="op" id="2245294">(</span><span class="ident" id="2245295">fnParseFloat</span><span class="op" id="2245307">,</span>&nbsp;<span class="ident" id="2245309">s</span><span class="op" id="2245310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2245313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2245316">return</span>&nbsp;<span class="ident" id="2245323">f</span><span class="op" id="2245324">,</span>&nbsp;<span class="ident" id="2245326">err</span><br>
<span class="lineno"></span><span class="op" id="2245330">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2245333">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2245396">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="2245475">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2245545">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="2245599">//</span><br>
<span class="lineno"></span><span class="comment" id="2245602">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2245665">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2245729">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="2245765">//</span><br>
<span class="lineno">525</span><span class="comment" id="2245768">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="2245835">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2245863">//</span><br>
<span class="lineno"></span><span class="comment" id="2245866">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="2245948">//</span><br>
<span class="lineno">530</span><span class="comment" id="2245951">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="2246013">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="2246079">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;±Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="2246132">func</span>&nbsp;<span class="ident" id="2246137">ParseFloat</span><span class="op" id="2246147">(</span><span class="ident" id="2246148">s</span>&nbsp;<span class="builtintype" id="2246150">string</span><span class="op" id="2246156">,</span>&nbsp;<span class="ident" id="2246158">bitSize</span>&nbsp;<span class="builtintype" id="2246166">int</span><span class="op" id="2246169">)</span>&nbsp;<span class="op" id="2246171">(</span><span class="ident" id="2246172">f</span>&nbsp;<span class="builtintype" id="2246174">float64</span><span class="op" id="2246181">,</span>&nbsp;<span class="ident" id="2246183">err</span>&nbsp;<span class="builtintype" id="2246187">error</span><span class="op" id="2246192">)</span>&nbsp;<span class="op" id="2246194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2246197">if</span>&nbsp;<span class="ident" id="2246200">bitSize</span>&nbsp;<span class="op" id="2246208">==</span>&nbsp;<span class="num" id="2246211">32</span>&nbsp;<span class="op" id="2246214">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2246218">f1</span><span class="op" id="2246220">,</span>&nbsp;<span class="ident" id="2246222">err1</span>&nbsp;<span class="op" id="2246227">:=</span>&nbsp;<span class="ident" id="2246230">atof32</span><span class="op" id="2246236">(</span><span class="ident" id="2246237">s</span><span class="op" id="2246238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2246242">return</span>&nbsp;<span class="builtintype" id="2246249">float64</span><span class="op" id="2246256">(</span><span class="ident" id="2246257">f1</span><span class="op" id="2246259">)</span><span class="op" id="2246260">,</span>&nbsp;<span class="ident" id="2246262">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2246268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2246271">f1</span><span class="op" id="2246273">,</span>&nbsp;<span class="ident" id="2246275">err1</span>&nbsp;<span class="op" id="2246280">:=</span>&nbsp;<span class="ident" id="2246283">atof64</span><span class="op" id="2246289">(</span><span class="ident" id="2246290">s</span><span class="op" id="2246291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2246294">return</span>&nbsp;<span class="ident" id="2246301">f1</span><span class="op" id="2246303">,</span>&nbsp;<span class="ident" id="2246305">err1</span><br>
<span class="lineno">540</span><span class="op" id="2246310">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
