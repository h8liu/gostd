<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html" class="current">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3997462">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3997517">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3997571">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3997622">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="3997697">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="3997708">package</span>&nbsp;<span class="ident" id="3997716">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3997726">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="3997801">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="3997876">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="3997956">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3998031">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3998105">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3998170">import</span>&nbsp;<span class="op" id="3998177">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3998180">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3998186">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3998198">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="3998205">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3998208">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="3998272">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="3998333">type</span>&nbsp;<span class="ident" id="3998338">Curve</span>&nbsp;<span class="keyword" id="3998344">interface</span>&nbsp;<span class="op" id="3998354">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3998357">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998406">Params</span><span class="op" id="3998412">(</span><span class="op" id="3998413">)</span>&nbsp;<span class="op" id="3998415">*</span><span class="ident" id="3998416">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3998429">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998494">IsOnCurve</span><span class="op" id="3998503">(</span><span class="ident" id="3998504">x</span><span class="op" id="3998505">,</span>&nbsp;<span class="ident" id="3998507">y</span>&nbsp;<span class="op" id="3998509">*</span><span class="ident" id="3998510">big</span><span class="op" id="3998513">.</span><span class="ident" id="3998514">Int</span><span class="op" id="3998517">)</span>&nbsp;<span class="builtintype" id="3998519">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3998525">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998572">Add</span><span class="op" id="3998575">(</span><span class="ident" id="3998576">x1</span><span class="op" id="3998578">,</span>&nbsp;<span class="ident" id="3998580">y1</span><span class="op" id="3998582">,</span>&nbsp;<span class="ident" id="3998584">x2</span><span class="op" id="3998586">,</span>&nbsp;<span class="ident" id="3998588">y2</span>&nbsp;<span class="op" id="3998591">*</span><span class="ident" id="3998592">big</span><span class="op" id="3998595">.</span><span class="ident" id="3998596">Int</span><span class="op" id="3998599">)</span>&nbsp;<span class="op" id="3998601">(</span><span class="ident" id="3998602">x</span><span class="op" id="3998603">,</span>&nbsp;<span class="ident" id="3998605">y</span>&nbsp;<span class="op" id="3998607">*</span><span class="ident" id="3998608">big</span><span class="op" id="3998611">.</span><span class="ident" id="3998612">Int</span><span class="op" id="3998615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3998618">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998645">Double</span><span class="op" id="3998651">(</span><span class="ident" id="3998652">x1</span><span class="op" id="3998654">,</span>&nbsp;<span class="ident" id="3998656">y1</span>&nbsp;<span class="op" id="3998659">*</span><span class="ident" id="3998660">big</span><span class="op" id="3998663">.</span><span class="ident" id="3998664">Int</span><span class="op" id="3998667">)</span>&nbsp;<span class="op" id="3998669">(</span><span class="ident" id="3998670">x</span><span class="op" id="3998671">,</span>&nbsp;<span class="ident" id="3998673">y</span>&nbsp;<span class="op" id="3998675">*</span><span class="ident" id="3998676">big</span><span class="op" id="3998679">.</span><span class="ident" id="3998680">Int</span><span class="op" id="3998683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3998686">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998759">ScalarMult</span><span class="op" id="3998769">(</span><span class="ident" id="3998770">x1</span><span class="op" id="3998772">,</span>&nbsp;<span class="ident" id="3998774">y1</span>&nbsp;<span class="op" id="3998777">*</span><span class="ident" id="3998778">big</span><span class="op" id="3998781">.</span><span class="ident" id="3998782">Int</span><span class="op" id="3998785">,</span>&nbsp;<span class="ident" id="3998787">k</span>&nbsp;<span class="op" id="3998789">[</span><span class="op" id="3998790">]</span><span class="builtintype" id="3998791">byte</span><span class="op" id="3998795">)</span>&nbsp;<span class="op" id="3998797">(</span><span class="ident" id="3998798">x</span><span class="op" id="3998799">,</span>&nbsp;<span class="ident" id="3998801">y</span>&nbsp;<span class="op" id="3998803">*</span><span class="ident" id="3998804">big</span><span class="op" id="3998807">.</span><span class="ident" id="3998808">Int</span><span class="op" id="3998811">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3998814">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3998885">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998929">ScalarBaseMult</span><span class="op" id="3998943">(</span><span class="ident" id="3998944">k</span>&nbsp;<span class="op" id="3998946">[</span><span class="op" id="3998947">]</span><span class="builtintype" id="3998948">byte</span><span class="op" id="3998952">)</span>&nbsp;<span class="op" id="3998954">(</span><span class="ident" id="3998955">x</span><span class="op" id="3998956">,</span>&nbsp;<span class="ident" id="3998958">y</span>&nbsp;<span class="op" id="3998960">*</span><span class="ident" id="3998961">big</span><span class="op" id="3998964">.</span><span class="ident" id="3998965">Int</span><span class="op" id="3998968">)</span><br>
<span class="lineno"></span><span class="op" id="3998970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="3998973">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="3999051">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="3999108">type</span>&nbsp;<span class="ident" id="3999113">CurveParams</span>&nbsp;<span class="keyword" id="3999125">struct</span>&nbsp;<span class="op" id="3999132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999135">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3999143">*</span><span class="ident" id="3999144">big</span><span class="op" id="3999147">.</span><span class="ident" id="3999148">Int</span>&nbsp;<span class="comment" id="3999152">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999190">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3999198">*</span><span class="ident" id="3999199">big</span><span class="op" id="3999202">.</span><span class="ident" id="3999203">Int</span>&nbsp;<span class="comment" id="3999207">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999239">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3999247">*</span><span class="ident" id="3999248">big</span><span class="op" id="3999251">.</span><span class="ident" id="3999252">Int</span>&nbsp;<span class="comment" id="3999256">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999295">Gx</span><span class="op" id="3999297">,</span>&nbsp;<span class="ident" id="3999299">Gy</span>&nbsp;&nbsp;<span class="op" id="3999303">*</span><span class="ident" id="3999304">big</span><span class="op" id="3999307">.</span><span class="ident" id="3999308">Int</span>&nbsp;<span class="comment" id="3999312">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999340">BitSize</span>&nbsp;<span class="builtintype" id="3999348">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3999357">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="3999393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="3999396">func</span>&nbsp;<span class="op" id="3999401">(</span><span class="ident" id="3999402">curve</span>&nbsp;<span class="op" id="3999408">*</span><span class="ident" id="3999409">CurveParams</span><span class="op" id="3999420">)</span>&nbsp;<span class="ident" id="3999422">Params</span><span class="op" id="3999428">(</span><span class="op" id="3999429">)</span>&nbsp;<span class="op" id="3999431">*</span><span class="ident" id="3999432">CurveParams</span>&nbsp;<span class="op" id="3999444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999447">return</span>&nbsp;<span class="ident" id="3999454">curve</span><br>
<span class="lineno"></span><span class="op" id="3999460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3999463">func</span>&nbsp;<span class="op" id="3999468">(</span><span class="ident" id="3999469">curve</span>&nbsp;<span class="op" id="3999475">*</span><span class="ident" id="3999476">CurveParams</span><span class="op" id="3999487">)</span>&nbsp;<span class="ident" id="3999489">IsOnCurve</span><span class="op" id="3999498">(</span><span class="ident" id="3999499">x</span><span class="op" id="3999500">,</span>&nbsp;<span class="ident" id="3999502">y</span>&nbsp;<span class="op" id="3999504">*</span><span class="ident" id="3999505">big</span><span class="op" id="3999508">.</span><span class="ident" id="3999509">Int</span><span class="op" id="3999512">)</span>&nbsp;<span class="builtintype" id="3999514">bool</span>&nbsp;<span class="op" id="3999519">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3999522">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999545">y2</span>&nbsp;<span class="op" id="3999548">:=</span>&nbsp;<span class="builtinfunc" id="3999551">new</span><span class="op" id="3999554">(</span><span class="ident" id="3999555">big</span><span class="op" id="3999558">.</span><span class="ident" id="3999559">Int</span><span class="op" id="3999562">)</span><span class="op" id="3999563">.</span><span class="ident" id="3999564">Mul</span><span class="op" id="3999567">(</span><span class="ident" id="3999568">y</span><span class="op" id="3999569">,</span>&nbsp;<span class="ident" id="3999571">y</span><span class="op" id="3999572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999575">y2</span><span class="op" id="3999577">.</span><span class="ident" id="3999578">Mod</span><span class="op" id="3999581">(</span><span class="ident" id="3999582">y2</span><span class="op" id="3999584">,</span>&nbsp;<span class="ident" id="3999586">curve</span><span class="op" id="3999591">.</span><span class="ident" id="3999592">P</span><span class="op" id="3999593">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999597">x3</span>&nbsp;<span class="op" id="3999600">:=</span>&nbsp;<span class="builtinfunc" id="3999603">new</span><span class="op" id="3999606">(</span><span class="ident" id="3999607">big</span><span class="op" id="3999610">.</span><span class="ident" id="3999611">Int</span><span class="op" id="3999614">)</span><span class="op" id="3999615">.</span><span class="ident" id="3999616">Mul</span><span class="op" id="3999619">(</span><span class="ident" id="3999620">x</span><span class="op" id="3999621">,</span>&nbsp;<span class="ident" id="3999623">x</span><span class="op" id="3999624">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999627">x3</span><span class="op" id="3999629">.</span><span class="ident" id="3999630">Mul</span><span class="op" id="3999633">(</span><span class="ident" id="3999634">x3</span><span class="op" id="3999636">,</span>&nbsp;<span class="ident" id="3999638">x</span><span class="op" id="3999639">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999643">threeX</span>&nbsp;<span class="op" id="3999650">:=</span>&nbsp;<span class="builtinfunc" id="3999653">new</span><span class="op" id="3999656">(</span><span class="ident" id="3999657">big</span><span class="op" id="3999660">.</span><span class="ident" id="3999661">Int</span><span class="op" id="3999664">)</span><span class="op" id="3999665">.</span><span class="ident" id="3999666">Lsh</span><span class="op" id="3999669">(</span><span class="ident" id="3999670">x</span><span class="op" id="3999671">,</span>&nbsp;<span class="num" id="3999673">1</span><span class="op" id="3999674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999677">threeX</span><span class="op" id="3999683">.</span><span class="ident" id="3999684">Add</span><span class="op" id="3999687">(</span><span class="ident" id="3999688">threeX</span><span class="op" id="3999694">,</span>&nbsp;<span class="ident" id="3999696">x</span><span class="op" id="3999697">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999701">x3</span><span class="op" id="3999703">.</span><span class="ident" id="3999704">Sub</span><span class="op" id="3999707">(</span><span class="ident" id="3999708">x3</span><span class="op" id="3999710">,</span>&nbsp;<span class="ident" id="3999712">threeX</span><span class="op" id="3999718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999721">x3</span><span class="op" id="3999723">.</span><span class="ident" id="3999724">Add</span><span class="op" id="3999727">(</span><span class="ident" id="3999728">x3</span><span class="op" id="3999730">,</span>&nbsp;<span class="ident" id="3999732">curve</span><span class="op" id="3999737">.</span><span class="ident" id="3999738">B</span><span class="op" id="3999739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999742">x3</span><span class="op" id="3999744">.</span><span class="ident" id="3999745">Mod</span><span class="op" id="3999748">(</span><span class="ident" id="3999749">x3</span><span class="op" id="3999751">,</span>&nbsp;<span class="ident" id="3999753">curve</span><span class="op" id="3999758">.</span><span class="ident" id="3999759">P</span><span class="op" id="3999760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999764">return</span>&nbsp;<span class="ident" id="3999771">x3</span><span class="op" id="3999773">.</span><span class="ident" id="3999774">Cmp</span><span class="op" id="3999777">(</span><span class="ident" id="3999778">y2</span><span class="op" id="3999780">)</span>&nbsp;<span class="op" id="3999782">==</span>&nbsp;<span class="num" id="3999785">0</span><br>
<span class="lineno">70</span><span class="op" id="3999787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3999790">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3999869">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="3999949">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4000001">func</span>&nbsp;<span class="ident" id="4000006">zForAffine</span><span class="op" id="4000016">(</span><span class="ident" id="4000017">x</span><span class="op" id="4000018">,</span>&nbsp;<span class="ident" id="4000020">y</span>&nbsp;<span class="op" id="4000022">*</span><span class="ident" id="4000023">big</span><span class="op" id="4000026">.</span><span class="ident" id="4000027">Int</span><span class="op" id="4000030">)</span>&nbsp;<span class="op" id="4000032">*</span><span class="ident" id="4000033">big</span><span class="op" id="4000036">.</span><span class="ident" id="4000037">Int</span>&nbsp;<span class="op" id="4000041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000044">z</span>&nbsp;<span class="op" id="4000046">:=</span>&nbsp;<span class="builtinfunc" id="4000049">new</span><span class="op" id="4000052">(</span><span class="ident" id="4000053">big</span><span class="op" id="4000056">.</span><span class="ident" id="4000057">Int</span><span class="op" id="4000060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000063">if</span>&nbsp;<span class="ident" id="4000066">x</span><span class="op" id="4000067">.</span><span class="ident" id="4000068">Sign</span><span class="op" id="4000072">(</span><span class="op" id="4000073">)</span>&nbsp;<span class="op" id="4000075">!=</span>&nbsp;<span class="num" id="4000078">0</span>&nbsp;<span class="op" id="4000080">||</span>&nbsp;<span class="ident" id="4000083">y</span><span class="op" id="4000084">.</span><span class="ident" id="4000085">Sign</span><span class="op" id="4000089">(</span><span class="op" id="4000090">)</span>&nbsp;<span class="op" id="4000092">!=</span>&nbsp;<span class="num" id="4000095">0</span>&nbsp;<span class="op" id="4000097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000101">z</span><span class="op" id="4000102">.</span><span class="ident" id="4000103">SetInt64</span><span class="op" id="4000111">(</span><span class="num" id="4000112">1</span><span class="op" id="4000113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000116">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000119">return</span>&nbsp;<span class="ident" id="4000126">z</span><br>
<span class="lineno"></span><span class="op" id="4000128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4000131">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4000209">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4000266">func</span>&nbsp;<span class="op" id="4000271">(</span><span class="ident" id="4000272">curve</span>&nbsp;<span class="op" id="4000278">*</span><span class="ident" id="4000279">CurveParams</span><span class="op" id="4000290">)</span>&nbsp;<span class="ident" id="4000292">affineFromJacobian</span><span class="op" id="4000310">(</span><span class="ident" id="4000311">x</span><span class="op" id="4000312">,</span>&nbsp;<span class="ident" id="4000314">y</span><span class="op" id="4000315">,</span>&nbsp;<span class="ident" id="4000317">z</span>&nbsp;<span class="op" id="4000319">*</span><span class="ident" id="4000320">big</span><span class="op" id="4000323">.</span><span class="ident" id="4000324">Int</span><span class="op" id="4000327">)</span>&nbsp;<span class="op" id="4000329">(</span><span class="ident" id="4000330">xOut</span><span class="op" id="4000334">,</span>&nbsp;<span class="ident" id="4000336">yOut</span>&nbsp;<span class="op" id="4000341">*</span><span class="ident" id="4000342">big</span><span class="op" id="4000345">.</span><span class="ident" id="4000346">Int</span><span class="op" id="4000349">)</span>&nbsp;<span class="op" id="4000351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000354">if</span>&nbsp;<span class="ident" id="4000357">z</span><span class="op" id="4000358">.</span><span class="ident" id="4000359">Sign</span><span class="op" id="4000363">(</span><span class="op" id="4000364">)</span>&nbsp;<span class="op" id="4000366">==</span>&nbsp;<span class="num" id="4000369">0</span>&nbsp;<span class="op" id="4000371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000375">return</span>&nbsp;<span class="builtinfunc" id="4000382">new</span><span class="op" id="4000385">(</span><span class="ident" id="4000386">big</span><span class="op" id="4000389">.</span><span class="ident" id="4000390">Int</span><span class="op" id="4000393">)</span><span class="op" id="4000394">,</span>&nbsp;<span class="builtinfunc" id="4000396">new</span><span class="op" id="4000399">(</span><span class="ident" id="4000400">big</span><span class="op" id="4000403">.</span><span class="ident" id="4000404">Int</span><span class="op" id="4000407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000414">zinv</span>&nbsp;<span class="op" id="4000419">:=</span>&nbsp;<span class="builtinfunc" id="4000422">new</span><span class="op" id="4000425">(</span><span class="ident" id="4000426">big</span><span class="op" id="4000429">.</span><span class="ident" id="4000430">Int</span><span class="op" id="4000433">)</span><span class="op" id="4000434">.</span><span class="ident" id="4000435">ModInverse</span><span class="op" id="4000445">(</span><span class="ident" id="4000446">z</span><span class="op" id="4000447">,</span>&nbsp;<span class="ident" id="4000449">curve</span><span class="op" id="4000454">.</span><span class="ident" id="4000455">P</span><span class="op" id="4000456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000459">zinvsq</span>&nbsp;<span class="op" id="4000466">:=</span>&nbsp;<span class="builtinfunc" id="4000469">new</span><span class="op" id="4000472">(</span><span class="ident" id="4000473">big</span><span class="op" id="4000476">.</span><span class="ident" id="4000477">Int</span><span class="op" id="4000480">)</span><span class="op" id="4000481">.</span><span class="ident" id="4000482">Mul</span><span class="op" id="4000485">(</span><span class="ident" id="4000486">zinv</span><span class="op" id="4000490">,</span>&nbsp;<span class="ident" id="4000492">zinv</span><span class="op" id="4000496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000500">xOut</span>&nbsp;<span class="op" id="4000505">=</span>&nbsp;<span class="builtinfunc" id="4000507">new</span><span class="op" id="4000510">(</span><span class="ident" id="4000511">big</span><span class="op" id="4000514">.</span><span class="ident" id="4000515">Int</span><span class="op" id="4000518">)</span><span class="op" id="4000519">.</span><span class="ident" id="4000520">Mul</span><span class="op" id="4000523">(</span><span class="ident" id="4000524">x</span><span class="op" id="4000525">,</span>&nbsp;<span class="ident" id="4000527">zinvsq</span><span class="op" id="4000533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000536">xOut</span><span class="op" id="4000540">.</span><span class="ident" id="4000541">Mod</span><span class="op" id="4000544">(</span><span class="ident" id="4000545">xOut</span><span class="op" id="4000549">,</span>&nbsp;<span class="ident" id="4000551">curve</span><span class="op" id="4000556">.</span><span class="ident" id="4000557">P</span><span class="op" id="4000558">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000561">zinvsq</span><span class="op" id="4000567">.</span><span class="ident" id="4000568">Mul</span><span class="op" id="4000571">(</span><span class="ident" id="4000572">zinvsq</span><span class="op" id="4000578">,</span>&nbsp;<span class="ident" id="4000580">zinv</span><span class="op" id="4000584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000587">yOut</span>&nbsp;<span class="op" id="4000592">=</span>&nbsp;<span class="builtinfunc" id="4000594">new</span><span class="op" id="4000597">(</span><span class="ident" id="4000598">big</span><span class="op" id="4000601">.</span><span class="ident" id="4000602">Int</span><span class="op" id="4000605">)</span><span class="op" id="4000606">.</span><span class="ident" id="4000607">Mul</span><span class="op" id="4000610">(</span><span class="ident" id="4000611">y</span><span class="op" id="4000612">,</span>&nbsp;<span class="ident" id="4000614">zinvsq</span><span class="op" id="4000620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000623">yOut</span><span class="op" id="4000627">.</span><span class="ident" id="4000628">Mod</span><span class="op" id="4000631">(</span><span class="ident" id="4000632">yOut</span><span class="op" id="4000636">,</span>&nbsp;<span class="ident" id="4000638">curve</span><span class="op" id="4000643">.</span><span class="ident" id="4000644">P</span><span class="op" id="4000645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000648">return</span><br>
<span class="lineno"></span><span class="op" id="4000655">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4000658">func</span>&nbsp;<span class="op" id="4000663">(</span><span class="ident" id="4000664">curve</span>&nbsp;<span class="op" id="4000670">*</span><span class="ident" id="4000671">CurveParams</span><span class="op" id="4000682">)</span>&nbsp;<span class="ident" id="4000684">Add</span><span class="op" id="4000687">(</span><span class="ident" id="4000688">x1</span><span class="op" id="4000690">,</span>&nbsp;<span class="ident" id="4000692">y1</span><span class="op" id="4000694">,</span>&nbsp;<span class="ident" id="4000696">x2</span><span class="op" id="4000698">,</span>&nbsp;<span class="ident" id="4000700">y2</span>&nbsp;<span class="op" id="4000703">*</span><span class="ident" id="4000704">big</span><span class="op" id="4000707">.</span><span class="ident" id="4000708">Int</span><span class="op" id="4000711">)</span>&nbsp;<span class="op" id="4000713">(</span><span class="op" id="4000714">*</span><span class="ident" id="4000715">big</span><span class="op" id="4000718">.</span><span class="ident" id="4000719">Int</span><span class="op" id="4000722">,</span>&nbsp;<span class="op" id="4000724">*</span><span class="ident" id="4000725">big</span><span class="op" id="4000728">.</span><span class="ident" id="4000729">Int</span><span class="op" id="4000732">)</span>&nbsp;<span class="op" id="4000734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000737">z1</span>&nbsp;<span class="op" id="4000740">:=</span>&nbsp;<span class="ident" id="4000743">zForAffine</span><span class="op" id="4000753">(</span><span class="ident" id="4000754">x1</span><span class="op" id="4000756">,</span>&nbsp;<span class="ident" id="4000758">y1</span><span class="op" id="4000760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000763">z2</span>&nbsp;<span class="op" id="4000766">:=</span>&nbsp;<span class="ident" id="4000769">zForAffine</span><span class="op" id="4000779">(</span><span class="ident" id="4000780">x2</span><span class="op" id="4000782">,</span>&nbsp;<span class="ident" id="4000784">y2</span><span class="op" id="4000786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000789">return</span>&nbsp;<span class="ident" id="4000796">curve</span><span class="op" id="4000801">.</span><span class="ident" id="4000802">affineFromJacobian</span><span class="op" id="4000820">(</span><span class="ident" id="4000821">curve</span><span class="op" id="4000826">.</span><span class="ident" id="4000827">addJacobian</span><span class="op" id="4000838">(</span><span class="ident" id="4000839">x1</span><span class="op" id="4000841">,</span>&nbsp;<span class="ident" id="4000843">y1</span><span class="op" id="4000845">,</span>&nbsp;<span class="ident" id="4000847">z1</span><span class="op" id="4000849">,</span>&nbsp;<span class="ident" id="4000851">x2</span><span class="op" id="4000853">,</span>&nbsp;<span class="ident" id="4000855">y2</span><span class="op" id="4000857">,</span>&nbsp;<span class="ident" id="4000859">z2</span><span class="op" id="4000861">)</span><span class="op" id="4000862">)</span><br>
<span class="lineno">105</span><span class="op" id="4000864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4000867">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4000941">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4001003">func</span>&nbsp;<span class="op" id="4001008">(</span><span class="ident" id="4001009">curve</span>&nbsp;<span class="op" id="4001015">*</span><span class="ident" id="4001016">CurveParams</span><span class="op" id="4001027">)</span>&nbsp;<span class="ident" id="4001029">addJacobian</span><span class="op" id="4001040">(</span><span class="ident" id="4001041">x1</span><span class="op" id="4001043">,</span>&nbsp;<span class="ident" id="4001045">y1</span><span class="op" id="4001047">,</span>&nbsp;<span class="ident" id="4001049">z1</span><span class="op" id="4001051">,</span>&nbsp;<span class="ident" id="4001053">x2</span><span class="op" id="4001055">,</span>&nbsp;<span class="ident" id="4001057">y2</span><span class="op" id="4001059">,</span>&nbsp;<span class="ident" id="4001061">z2</span>&nbsp;<span class="op" id="4001064">*</span><span class="ident" id="4001065">big</span><span class="op" id="4001068">.</span><span class="ident" id="4001069">Int</span><span class="op" id="4001072">)</span>&nbsp;<span class="op" id="4001074">(</span><span class="op" id="4001075">*</span><span class="ident" id="4001076">big</span><span class="op" id="4001079">.</span><span class="ident" id="4001080">Int</span><span class="op" id="4001083">,</span>&nbsp;<span class="op" id="4001085">*</span><span class="ident" id="4001086">big</span><span class="op" id="4001089">.</span><span class="ident" id="4001090">Int</span><span class="op" id="4001093">,</span>&nbsp;<span class="op" id="4001095">*</span><span class="ident" id="4001096">big</span><span class="op" id="4001099">.</span><span class="ident" id="4001100">Int</span><span class="op" id="4001103">)</span>&nbsp;<span class="op" id="4001105">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001108">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001198">x3</span><span class="op" id="4001200">,</span>&nbsp;<span class="ident" id="4001202">y3</span><span class="op" id="4001204">,</span>&nbsp;<span class="ident" id="4001206">z3</span>&nbsp;<span class="op" id="4001209">:=</span>&nbsp;<span class="builtinfunc" id="4001212">new</span><span class="op" id="4001215">(</span><span class="ident" id="4001216">big</span><span class="op" id="4001219">.</span><span class="ident" id="4001220">Int</span><span class="op" id="4001223">)</span><span class="op" id="4001224">,</span>&nbsp;<span class="builtinfunc" id="4001226">new</span><span class="op" id="4001229">(</span><span class="ident" id="4001230">big</span><span class="op" id="4001233">.</span><span class="ident" id="4001234">Int</span><span class="op" id="4001237">)</span><span class="op" id="4001238">,</span>&nbsp;<span class="builtinfunc" id="4001240">new</span><span class="op" id="4001243">(</span><span class="ident" id="4001244">big</span><span class="op" id="4001247">.</span><span class="ident" id="4001248">Int</span><span class="op" id="4001251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001254">if</span>&nbsp;<span class="ident" id="4001257">z1</span><span class="op" id="4001259">.</span><span class="ident" id="4001260">Sign</span><span class="op" id="4001264">(</span><span class="op" id="4001265">)</span>&nbsp;<span class="op" id="4001267">==</span>&nbsp;<span class="num" id="4001270">0</span>&nbsp;<span class="op" id="4001272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001276">x3</span><span class="op" id="4001278">.</span><span class="ident" id="4001279">Set</span><span class="op" id="4001282">(</span><span class="ident" id="4001283">x2</span><span class="op" id="4001285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001289">y3</span><span class="op" id="4001291">.</span><span class="ident" id="4001292">Set</span><span class="op" id="4001295">(</span><span class="ident" id="4001296">y2</span><span class="op" id="4001298">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001302">z3</span><span class="op" id="4001304">.</span><span class="ident" id="4001305">Set</span><span class="op" id="4001308">(</span><span class="ident" id="4001309">z2</span><span class="op" id="4001311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001315">return</span>&nbsp;<span class="ident" id="4001322">x3</span><span class="op" id="4001324">,</span>&nbsp;<span class="ident" id="4001326">y3</span><span class="op" id="4001328">,</span>&nbsp;<span class="ident" id="4001330">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4001334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001337">if</span>&nbsp;<span class="ident" id="4001340">z2</span><span class="op" id="4001342">.</span><span class="ident" id="4001343">Sign</span><span class="op" id="4001347">(</span><span class="op" id="4001348">)</span>&nbsp;<span class="op" id="4001350">==</span>&nbsp;<span class="num" id="4001353">0</span>&nbsp;<span class="op" id="4001355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001359">x3</span><span class="op" id="4001361">.</span><span class="ident" id="4001362">Set</span><span class="op" id="4001365">(</span><span class="ident" id="4001366">x1</span><span class="op" id="4001368">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001372">y3</span><span class="op" id="4001374">.</span><span class="ident" id="4001375">Set</span><span class="op" id="4001378">(</span><span class="ident" id="4001379">y1</span><span class="op" id="4001381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001385">z3</span><span class="op" id="4001387">.</span><span class="ident" id="4001388">Set</span><span class="op" id="4001391">(</span><span class="ident" id="4001392">z1</span><span class="op" id="4001394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001398">return</span>&nbsp;<span class="ident" id="4001405">x3</span><span class="op" id="4001407">,</span>&nbsp;<span class="ident" id="4001409">y3</span><span class="op" id="4001411">,</span>&nbsp;<span class="ident" id="4001413">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4001417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001421">z1z1</span>&nbsp;<span class="op" id="4001426">:=</span>&nbsp;<span class="builtinfunc" id="4001429">new</span><span class="op" id="4001432">(</span><span class="ident" id="4001433">big</span><span class="op" id="4001436">.</span><span class="ident" id="4001437">Int</span><span class="op" id="4001440">)</span><span class="op" id="4001441">.</span><span class="ident" id="4001442">Mul</span><span class="op" id="4001445">(</span><span class="ident" id="4001446">z1</span><span class="op" id="4001448">,</span>&nbsp;<span class="ident" id="4001450">z1</span><span class="op" id="4001452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001455">z1z1</span><span class="op" id="4001459">.</span><span class="ident" id="4001460">Mod</span><span class="op" id="4001463">(</span><span class="ident" id="4001464">z1z1</span><span class="op" id="4001468">,</span>&nbsp;<span class="ident" id="4001470">curve</span><span class="op" id="4001475">.</span><span class="ident" id="4001476">P</span><span class="op" id="4001477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001480">z2z2</span>&nbsp;<span class="op" id="4001485">:=</span>&nbsp;<span class="builtinfunc" id="4001488">new</span><span class="op" id="4001491">(</span><span class="ident" id="4001492">big</span><span class="op" id="4001495">.</span><span class="ident" id="4001496">Int</span><span class="op" id="4001499">)</span><span class="op" id="4001500">.</span><span class="ident" id="4001501">Mul</span><span class="op" id="4001504">(</span><span class="ident" id="4001505">z2</span><span class="op" id="4001507">,</span>&nbsp;<span class="ident" id="4001509">z2</span><span class="op" id="4001511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001514">z2z2</span><span class="op" id="4001518">.</span><span class="ident" id="4001519">Mod</span><span class="op" id="4001522">(</span><span class="ident" id="4001523">z2z2</span><span class="op" id="4001527">,</span>&nbsp;<span class="ident" id="4001529">curve</span><span class="op" id="4001534">.</span><span class="ident" id="4001535">P</span><span class="op" id="4001536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001540">u1</span>&nbsp;<span class="op" id="4001543">:=</span>&nbsp;<span class="builtinfunc" id="4001546">new</span><span class="op" id="4001549">(</span><span class="ident" id="4001550">big</span><span class="op" id="4001553">.</span><span class="ident" id="4001554">Int</span><span class="op" id="4001557">)</span><span class="op" id="4001558">.</span><span class="ident" id="4001559">Mul</span><span class="op" id="4001562">(</span><span class="ident" id="4001563">x1</span><span class="op" id="4001565">,</span>&nbsp;<span class="ident" id="4001567">z2z2</span><span class="op" id="4001571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001574">u1</span><span class="op" id="4001576">.</span><span class="ident" id="4001577">Mod</span><span class="op" id="4001580">(</span><span class="ident" id="4001581">u1</span><span class="op" id="4001583">,</span>&nbsp;<span class="ident" id="4001585">curve</span><span class="op" id="4001590">.</span><span class="ident" id="4001591">P</span><span class="op" id="4001592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001595">u2</span>&nbsp;<span class="op" id="4001598">:=</span>&nbsp;<span class="builtinfunc" id="4001601">new</span><span class="op" id="4001604">(</span><span class="ident" id="4001605">big</span><span class="op" id="4001608">.</span><span class="ident" id="4001609">Int</span><span class="op" id="4001612">)</span><span class="op" id="4001613">.</span><span class="ident" id="4001614">Mul</span><span class="op" id="4001617">(</span><span class="ident" id="4001618">x2</span><span class="op" id="4001620">,</span>&nbsp;<span class="ident" id="4001622">z1z1</span><span class="op" id="4001626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001629">u2</span><span class="op" id="4001631">.</span><span class="ident" id="4001632">Mod</span><span class="op" id="4001635">(</span><span class="ident" id="4001636">u2</span><span class="op" id="4001638">,</span>&nbsp;<span class="ident" id="4001640">curve</span><span class="op" id="4001645">.</span><span class="ident" id="4001646">P</span><span class="op" id="4001647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001650">h</span>&nbsp;<span class="op" id="4001652">:=</span>&nbsp;<span class="builtinfunc" id="4001655">new</span><span class="op" id="4001658">(</span><span class="ident" id="4001659">big</span><span class="op" id="4001662">.</span><span class="ident" id="4001663">Int</span><span class="op" id="4001666">)</span><span class="op" id="4001667">.</span><span class="ident" id="4001668">Sub</span><span class="op" id="4001671">(</span><span class="ident" id="4001672">u2</span><span class="op" id="4001674">,</span>&nbsp;<span class="ident" id="4001676">u1</span><span class="op" id="4001678">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001681">xEqual</span>&nbsp;<span class="op" id="4001688">:=</span>&nbsp;<span class="ident" id="4001691">h</span><span class="op" id="4001692">.</span><span class="ident" id="4001693">Sign</span><span class="op" id="4001697">(</span><span class="op" id="4001698">)</span>&nbsp;<span class="op" id="4001700">==</span>&nbsp;<span class="num" id="4001703">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001706">if</span>&nbsp;<span class="ident" id="4001709">h</span><span class="op" id="4001710">.</span><span class="ident" id="4001711">Sign</span><span class="op" id="4001715">(</span><span class="op" id="4001716">)</span>&nbsp;<span class="op" id="4001718">==</span>&nbsp;<span class="op" id="4001721">-</span><span class="num" id="4001722">1</span>&nbsp;<span class="op" id="4001724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001728">h</span><span class="op" id="4001729">.</span><span class="ident" id="4001730">Add</span><span class="op" id="4001733">(</span><span class="ident" id="4001734">h</span><span class="op" id="4001735">,</span>&nbsp;<span class="ident" id="4001737">curve</span><span class="op" id="4001742">.</span><span class="ident" id="4001743">P</span><span class="op" id="4001744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4001747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001750">i</span>&nbsp;<span class="op" id="4001752">:=</span>&nbsp;<span class="builtinfunc" id="4001755">new</span><span class="op" id="4001758">(</span><span class="ident" id="4001759">big</span><span class="op" id="4001762">.</span><span class="ident" id="4001763">Int</span><span class="op" id="4001766">)</span><span class="op" id="4001767">.</span><span class="ident" id="4001768">Lsh</span><span class="op" id="4001771">(</span><span class="ident" id="4001772">h</span><span class="op" id="4001773">,</span>&nbsp;<span class="num" id="4001775">1</span><span class="op" id="4001776">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001779">i</span><span class="op" id="4001780">.</span><span class="ident" id="4001781">Mul</span><span class="op" id="4001784">(</span><span class="ident" id="4001785">i</span><span class="op" id="4001786">,</span>&nbsp;<span class="ident" id="4001788">i</span><span class="op" id="4001789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001792">j</span>&nbsp;<span class="op" id="4001794">:=</span>&nbsp;<span class="builtinfunc" id="4001797">new</span><span class="op" id="4001800">(</span><span class="ident" id="4001801">big</span><span class="op" id="4001804">.</span><span class="ident" id="4001805">Int</span><span class="op" id="4001808">)</span><span class="op" id="4001809">.</span><span class="ident" id="4001810">Mul</span><span class="op" id="4001813">(</span><span class="ident" id="4001814">h</span><span class="op" id="4001815">,</span>&nbsp;<span class="ident" id="4001817">i</span><span class="op" id="4001818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001822">s1</span>&nbsp;<span class="op" id="4001825">:=</span>&nbsp;<span class="builtinfunc" id="4001828">new</span><span class="op" id="4001831">(</span><span class="ident" id="4001832">big</span><span class="op" id="4001835">.</span><span class="ident" id="4001836">Int</span><span class="op" id="4001839">)</span><span class="op" id="4001840">.</span><span class="ident" id="4001841">Mul</span><span class="op" id="4001844">(</span><span class="ident" id="4001845">y1</span><span class="op" id="4001847">,</span>&nbsp;<span class="ident" id="4001849">z2</span><span class="op" id="4001851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001854">s1</span><span class="op" id="4001856">.</span><span class="ident" id="4001857">Mul</span><span class="op" id="4001860">(</span><span class="ident" id="4001861">s1</span><span class="op" id="4001863">,</span>&nbsp;<span class="ident" id="4001865">z2z2</span><span class="op" id="4001869">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001872">s1</span><span class="op" id="4001874">.</span><span class="ident" id="4001875">Mod</span><span class="op" id="4001878">(</span><span class="ident" id="4001879">s1</span><span class="op" id="4001881">,</span>&nbsp;<span class="ident" id="4001883">curve</span><span class="op" id="4001888">.</span><span class="ident" id="4001889">P</span><span class="op" id="4001890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001893">s2</span>&nbsp;<span class="op" id="4001896">:=</span>&nbsp;<span class="builtinfunc" id="4001899">new</span><span class="op" id="4001902">(</span><span class="ident" id="4001903">big</span><span class="op" id="4001906">.</span><span class="ident" id="4001907">Int</span><span class="op" id="4001910">)</span><span class="op" id="4001911">.</span><span class="ident" id="4001912">Mul</span><span class="op" id="4001915">(</span><span class="ident" id="4001916">y2</span><span class="op" id="4001918">,</span>&nbsp;<span class="ident" id="4001920">z1</span><span class="op" id="4001922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001925">s2</span><span class="op" id="4001927">.</span><span class="ident" id="4001928">Mul</span><span class="op" id="4001931">(</span><span class="ident" id="4001932">s2</span><span class="op" id="4001934">,</span>&nbsp;<span class="ident" id="4001936">z1z1</span><span class="op" id="4001940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001943">s2</span><span class="op" id="4001945">.</span><span class="ident" id="4001946">Mod</span><span class="op" id="4001949">(</span><span class="ident" id="4001950">s2</span><span class="op" id="4001952">,</span>&nbsp;<span class="ident" id="4001954">curve</span><span class="op" id="4001959">.</span><span class="ident" id="4001960">P</span><span class="op" id="4001961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001964">r</span>&nbsp;<span class="op" id="4001966">:=</span>&nbsp;<span class="builtinfunc" id="4001969">new</span><span class="op" id="4001972">(</span><span class="ident" id="4001973">big</span><span class="op" id="4001976">.</span><span class="ident" id="4001977">Int</span><span class="op" id="4001980">)</span><span class="op" id="4001981">.</span><span class="ident" id="4001982">Sub</span><span class="op" id="4001985">(</span><span class="ident" id="4001986">s2</span><span class="op" id="4001988">,</span>&nbsp;<span class="ident" id="4001990">s1</span><span class="op" id="4001992">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4001995">if</span>&nbsp;<span class="ident" id="4001998">r</span><span class="op" id="4001999">.</span><span class="ident" id="4002000">Sign</span><span class="op" id="4002004">(</span><span class="op" id="4002005">)</span>&nbsp;<span class="op" id="4002007">==</span>&nbsp;<span class="op" id="4002010">-</span><span class="num" id="4002011">1</span>&nbsp;<span class="op" id="4002013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002017">r</span><span class="op" id="4002018">.</span><span class="ident" id="4002019">Add</span><span class="op" id="4002022">(</span><span class="ident" id="4002023">r</span><span class="op" id="4002024">,</span>&nbsp;<span class="ident" id="4002026">curve</span><span class="op" id="4002031">.</span><span class="ident" id="4002032">P</span><span class="op" id="4002033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002039">yEqual</span>&nbsp;<span class="op" id="4002046">:=</span>&nbsp;<span class="ident" id="4002049">r</span><span class="op" id="4002050">.</span><span class="ident" id="4002051">Sign</span><span class="op" id="4002055">(</span><span class="op" id="4002056">)</span>&nbsp;<span class="op" id="4002058">==</span>&nbsp;<span class="num" id="4002061">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002064">if</span>&nbsp;<span class="ident" id="4002067">xEqual</span>&nbsp;<span class="op" id="4002074">&amp;&amp;</span>&nbsp;<span class="ident" id="4002077">yEqual</span>&nbsp;<span class="op" id="4002084">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002088">return</span>&nbsp;<span class="ident" id="4002095">curve</span><span class="op" id="4002100">.</span><span class="ident" id="4002101">doubleJacobian</span><span class="op" id="4002115">(</span><span class="ident" id="4002116">x1</span><span class="op" id="4002118">,</span>&nbsp;<span class="ident" id="4002120">y1</span><span class="op" id="4002122">,</span>&nbsp;<span class="ident" id="4002124">z1</span><span class="op" id="4002126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002132">r</span><span class="op" id="4002133">.</span><span class="ident" id="4002134">Lsh</span><span class="op" id="4002137">(</span><span class="ident" id="4002138">r</span><span class="op" id="4002139">,</span>&nbsp;<span class="num" id="4002141">1</span><span class="op" id="4002142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002145">v</span>&nbsp;<span class="op" id="4002147">:=</span>&nbsp;<span class="builtinfunc" id="4002150">new</span><span class="op" id="4002153">(</span><span class="ident" id="4002154">big</span><span class="op" id="4002157">.</span><span class="ident" id="4002158">Int</span><span class="op" id="4002161">)</span><span class="op" id="4002162">.</span><span class="ident" id="4002163">Mul</span><span class="op" id="4002166">(</span><span class="ident" id="4002167">u1</span><span class="op" id="4002169">,</span>&nbsp;<span class="ident" id="4002171">i</span><span class="op" id="4002172">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002176">x3</span><span class="op" id="4002178">.</span><span class="ident" id="4002179">Set</span><span class="op" id="4002182">(</span><span class="ident" id="4002183">r</span><span class="op" id="4002184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002187">x3</span><span class="op" id="4002189">.</span><span class="ident" id="4002190">Mul</span><span class="op" id="4002193">(</span><span class="ident" id="4002194">x3</span><span class="op" id="4002196">,</span>&nbsp;<span class="ident" id="4002198">x3</span><span class="op" id="4002200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002203">x3</span><span class="op" id="4002205">.</span><span class="ident" id="4002206">Sub</span><span class="op" id="4002209">(</span><span class="ident" id="4002210">x3</span><span class="op" id="4002212">,</span>&nbsp;<span class="ident" id="4002214">j</span><span class="op" id="4002215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002218">x3</span><span class="op" id="4002220">.</span><span class="ident" id="4002221">Sub</span><span class="op" id="4002224">(</span><span class="ident" id="4002225">x3</span><span class="op" id="4002227">,</span>&nbsp;<span class="ident" id="4002229">v</span><span class="op" id="4002230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002233">x3</span><span class="op" id="4002235">.</span><span class="ident" id="4002236">Sub</span><span class="op" id="4002239">(</span><span class="ident" id="4002240">x3</span><span class="op" id="4002242">,</span>&nbsp;<span class="ident" id="4002244">v</span><span class="op" id="4002245">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002248">x3</span><span class="op" id="4002250">.</span><span class="ident" id="4002251">Mod</span><span class="op" id="4002254">(</span><span class="ident" id="4002255">x3</span><span class="op" id="4002257">,</span>&nbsp;<span class="ident" id="4002259">curve</span><span class="op" id="4002264">.</span><span class="ident" id="4002265">P</span><span class="op" id="4002266">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002270">y3</span><span class="op" id="4002272">.</span><span class="ident" id="4002273">Set</span><span class="op" id="4002276">(</span><span class="ident" id="4002277">r</span><span class="op" id="4002278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002281">v</span><span class="op" id="4002282">.</span><span class="ident" id="4002283">Sub</span><span class="op" id="4002286">(</span><span class="ident" id="4002287">v</span><span class="op" id="4002288">,</span>&nbsp;<span class="ident" id="4002290">x3</span><span class="op" id="4002292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002295">y3</span><span class="op" id="4002297">.</span><span class="ident" id="4002298">Mul</span><span class="op" id="4002301">(</span><span class="ident" id="4002302">y3</span><span class="op" id="4002304">,</span>&nbsp;<span class="ident" id="4002306">v</span><span class="op" id="4002307">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002310">s1</span><span class="op" id="4002312">.</span><span class="ident" id="4002313">Mul</span><span class="op" id="4002316">(</span><span class="ident" id="4002317">s1</span><span class="op" id="4002319">,</span>&nbsp;<span class="ident" id="4002321">j</span><span class="op" id="4002322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002325">s1</span><span class="op" id="4002327">.</span><span class="ident" id="4002328">Lsh</span><span class="op" id="4002331">(</span><span class="ident" id="4002332">s1</span><span class="op" id="4002334">,</span>&nbsp;<span class="num" id="4002336">1</span><span class="op" id="4002337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002340">y3</span><span class="op" id="4002342">.</span><span class="ident" id="4002343">Sub</span><span class="op" id="4002346">(</span><span class="ident" id="4002347">y3</span><span class="op" id="4002349">,</span>&nbsp;<span class="ident" id="4002351">s1</span><span class="op" id="4002353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002356">y3</span><span class="op" id="4002358">.</span><span class="ident" id="4002359">Mod</span><span class="op" id="4002362">(</span><span class="ident" id="4002363">y3</span><span class="op" id="4002365">,</span>&nbsp;<span class="ident" id="4002367">curve</span><span class="op" id="4002372">.</span><span class="ident" id="4002373">P</span><span class="op" id="4002374">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002378">z3</span><span class="op" id="4002380">.</span><span class="ident" id="4002381">Add</span><span class="op" id="4002384">(</span><span class="ident" id="4002385">z1</span><span class="op" id="4002387">,</span>&nbsp;<span class="ident" id="4002389">z2</span><span class="op" id="4002391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002394">z3</span><span class="op" id="4002396">.</span><span class="ident" id="4002397">Mul</span><span class="op" id="4002400">(</span><span class="ident" id="4002401">z3</span><span class="op" id="4002403">,</span>&nbsp;<span class="ident" id="4002405">z3</span><span class="op" id="4002407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002410">z3</span><span class="op" id="4002412">.</span><span class="ident" id="4002413">Sub</span><span class="op" id="4002416">(</span><span class="ident" id="4002417">z3</span><span class="op" id="4002419">,</span>&nbsp;<span class="ident" id="4002421">z1z1</span><span class="op" id="4002425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002428">z3</span><span class="op" id="4002430">.</span><span class="ident" id="4002431">Sub</span><span class="op" id="4002434">(</span><span class="ident" id="4002435">z3</span><span class="op" id="4002437">,</span>&nbsp;<span class="ident" id="4002439">z2z2</span><span class="op" id="4002443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002446">z3</span><span class="op" id="4002448">.</span><span class="ident" id="4002449">Mul</span><span class="op" id="4002452">(</span><span class="ident" id="4002453">z3</span><span class="op" id="4002455">,</span>&nbsp;<span class="ident" id="4002457">h</span><span class="op" id="4002458">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002461">z3</span><span class="op" id="4002463">.</span><span class="ident" id="4002464">Mod</span><span class="op" id="4002467">(</span><span class="ident" id="4002468">z3</span><span class="op" id="4002470">,</span>&nbsp;<span class="ident" id="4002472">curve</span><span class="op" id="4002477">.</span><span class="ident" id="4002478">P</span><span class="op" id="4002479">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002483">return</span>&nbsp;<span class="ident" id="4002490">x3</span><span class="op" id="4002492">,</span>&nbsp;<span class="ident" id="4002494">y3</span><span class="op" id="4002496">,</span>&nbsp;<span class="ident" id="4002498">z3</span><br>
<span class="lineno"></span><span class="op" id="4002501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4002504">func</span>&nbsp;<span class="op" id="4002509">(</span><span class="ident" id="4002510">curve</span>&nbsp;<span class="op" id="4002516">*</span><span class="ident" id="4002517">CurveParams</span><span class="op" id="4002528">)</span>&nbsp;<span class="ident" id="4002530">Double</span><span class="op" id="4002536">(</span><span class="ident" id="4002537">x1</span><span class="op" id="4002539">,</span>&nbsp;<span class="ident" id="4002541">y1</span>&nbsp;<span class="op" id="4002544">*</span><span class="ident" id="4002545">big</span><span class="op" id="4002548">.</span><span class="ident" id="4002549">Int</span><span class="op" id="4002552">)</span>&nbsp;<span class="op" id="4002554">(</span><span class="op" id="4002555">*</span><span class="ident" id="4002556">big</span><span class="op" id="4002559">.</span><span class="ident" id="4002560">Int</span><span class="op" id="4002563">,</span>&nbsp;<span class="op" id="4002565">*</span><span class="ident" id="4002566">big</span><span class="op" id="4002569">.</span><span class="ident" id="4002570">Int</span><span class="op" id="4002573">)</span>&nbsp;<span class="op" id="4002575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002578">z1</span>&nbsp;<span class="op" id="4002581">:=</span>&nbsp;<span class="ident" id="4002584">zForAffine</span><span class="op" id="4002594">(</span><span class="ident" id="4002595">x1</span><span class="op" id="4002597">,</span>&nbsp;<span class="ident" id="4002599">y1</span><span class="op" id="4002601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002604">return</span>&nbsp;<span class="ident" id="4002611">curve</span><span class="op" id="4002616">.</span><span class="ident" id="4002617">affineFromJacobian</span><span class="op" id="4002635">(</span><span class="ident" id="4002636">curve</span><span class="op" id="4002641">.</span><span class="ident" id="4002642">doubleJacobian</span><span class="op" id="4002656">(</span><span class="ident" id="4002657">x1</span><span class="op" id="4002659">,</span>&nbsp;<span class="ident" id="4002661">y1</span><span class="op" id="4002663">,</span>&nbsp;<span class="ident" id="4002665">z1</span><span class="op" id="4002667">)</span><span class="op" id="4002668">)</span><br>
<span class="lineno"></span><span class="op" id="4002670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4002673">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4002745">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4002791">func</span>&nbsp;<span class="op" id="4002796">(</span><span class="ident" id="4002797">curve</span>&nbsp;<span class="op" id="4002803">*</span><span class="ident" id="4002804">CurveParams</span><span class="op" id="4002815">)</span>&nbsp;<span class="ident" id="4002817">doubleJacobian</span><span class="op" id="4002831">(</span><span class="ident" id="4002832">x</span><span class="op" id="4002833">,</span>&nbsp;<span class="ident" id="4002835">y</span><span class="op" id="4002836">,</span>&nbsp;<span class="ident" id="4002838">z</span>&nbsp;<span class="op" id="4002840">*</span><span class="ident" id="4002841">big</span><span class="op" id="4002844">.</span><span class="ident" id="4002845">Int</span><span class="op" id="4002848">)</span>&nbsp;<span class="op" id="4002850">(</span><span class="op" id="4002851">*</span><span class="ident" id="4002852">big</span><span class="op" id="4002855">.</span><span class="ident" id="4002856">Int</span><span class="op" id="4002859">,</span>&nbsp;<span class="op" id="4002861">*</span><span class="ident" id="4002862">big</span><span class="op" id="4002865">.</span><span class="ident" id="4002866">Int</span><span class="op" id="4002869">,</span>&nbsp;<span class="op" id="4002871">*</span><span class="ident" id="4002872">big</span><span class="op" id="4002875">.</span><span class="ident" id="4002876">Int</span><span class="op" id="4002879">)</span>&nbsp;<span class="op" id="4002881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4002884">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002973">delta</span>&nbsp;<span class="op" id="4002979">:=</span>&nbsp;<span class="builtinfunc" id="4002982">new</span><span class="op" id="4002985">(</span><span class="ident" id="4002986">big</span><span class="op" id="4002989">.</span><span class="ident" id="4002990">Int</span><span class="op" id="4002993">)</span><span class="op" id="4002994">.</span><span class="ident" id="4002995">Mul</span><span class="op" id="4002998">(</span><span class="ident" id="4002999">z</span><span class="op" id="4003000">,</span>&nbsp;<span class="ident" id="4003002">z</span><span class="op" id="4003003">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003006">delta</span><span class="op" id="4003011">.</span><span class="ident" id="4003012">Mod</span><span class="op" id="4003015">(</span><span class="ident" id="4003016">delta</span><span class="op" id="4003021">,</span>&nbsp;<span class="ident" id="4003023">curve</span><span class="op" id="4003028">.</span><span class="ident" id="4003029">P</span><span class="op" id="4003030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003033">gamma</span>&nbsp;<span class="op" id="4003039">:=</span>&nbsp;<span class="builtinfunc" id="4003042">new</span><span class="op" id="4003045">(</span><span class="ident" id="4003046">big</span><span class="op" id="4003049">.</span><span class="ident" id="4003050">Int</span><span class="op" id="4003053">)</span><span class="op" id="4003054">.</span><span class="ident" id="4003055">Mul</span><span class="op" id="4003058">(</span><span class="ident" id="4003059">y</span><span class="op" id="4003060">,</span>&nbsp;<span class="ident" id="4003062">y</span><span class="op" id="4003063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003066">gamma</span><span class="op" id="4003071">.</span><span class="ident" id="4003072">Mod</span><span class="op" id="4003075">(</span><span class="ident" id="4003076">gamma</span><span class="op" id="4003081">,</span>&nbsp;<span class="ident" id="4003083">curve</span><span class="op" id="4003088">.</span><span class="ident" id="4003089">P</span><span class="op" id="4003090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003093">alpha</span>&nbsp;<span class="op" id="4003099">:=</span>&nbsp;<span class="builtinfunc" id="4003102">new</span><span class="op" id="4003105">(</span><span class="ident" id="4003106">big</span><span class="op" id="4003109">.</span><span class="ident" id="4003110">Int</span><span class="op" id="4003113">)</span><span class="op" id="4003114">.</span><span class="ident" id="4003115">Sub</span><span class="op" id="4003118">(</span><span class="ident" id="4003119">x</span><span class="op" id="4003120">,</span>&nbsp;<span class="ident" id="4003122">delta</span><span class="op" id="4003127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003130">if</span>&nbsp;<span class="ident" id="4003133">alpha</span><span class="op" id="4003138">.</span><span class="ident" id="4003139">Sign</span><span class="op" id="4003143">(</span><span class="op" id="4003144">)</span>&nbsp;<span class="op" id="4003146">==</span>&nbsp;<span class="op" id="4003149">-</span><span class="num" id="4003150">1</span>&nbsp;<span class="op" id="4003152">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003156">alpha</span><span class="op" id="4003161">.</span><span class="ident" id="4003162">Add</span><span class="op" id="4003165">(</span><span class="ident" id="4003166">alpha</span><span class="op" id="4003171">,</span>&nbsp;<span class="ident" id="4003173">curve</span><span class="op" id="4003178">.</span><span class="ident" id="4003179">P</span><span class="op" id="4003180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003186">alpha2</span>&nbsp;<span class="op" id="4003193">:=</span>&nbsp;<span class="builtinfunc" id="4003196">new</span><span class="op" id="4003199">(</span><span class="ident" id="4003200">big</span><span class="op" id="4003203">.</span><span class="ident" id="4003204">Int</span><span class="op" id="4003207">)</span><span class="op" id="4003208">.</span><span class="ident" id="4003209">Add</span><span class="op" id="4003212">(</span><span class="ident" id="4003213">x</span><span class="op" id="4003214">,</span>&nbsp;<span class="ident" id="4003216">delta</span><span class="op" id="4003221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003224">alpha</span><span class="op" id="4003229">.</span><span class="ident" id="4003230">Mul</span><span class="op" id="4003233">(</span><span class="ident" id="4003234">alpha</span><span class="op" id="4003239">,</span>&nbsp;<span class="ident" id="4003241">alpha2</span><span class="op" id="4003247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003250">alpha2</span><span class="op" id="4003256">.</span><span class="ident" id="4003257">Set</span><span class="op" id="4003260">(</span><span class="ident" id="4003261">alpha</span><span class="op" id="4003266">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003269">alpha</span><span class="op" id="4003274">.</span><span class="ident" id="4003275">Lsh</span><span class="op" id="4003278">(</span><span class="ident" id="4003279">alpha</span><span class="op" id="4003284">,</span>&nbsp;<span class="num" id="4003286">1</span><span class="op" id="4003287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003290">alpha</span><span class="op" id="4003295">.</span><span class="ident" id="4003296">Add</span><span class="op" id="4003299">(</span><span class="ident" id="4003300">alpha</span><span class="op" id="4003305">,</span>&nbsp;<span class="ident" id="4003307">alpha2</span><span class="op" id="4003313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003317">beta</span>&nbsp;<span class="op" id="4003322">:=</span>&nbsp;<span class="ident" id="4003325">alpha2</span><span class="op" id="4003331">.</span><span class="ident" id="4003332">Mul</span><span class="op" id="4003335">(</span><span class="ident" id="4003336">x</span><span class="op" id="4003337">,</span>&nbsp;<span class="ident" id="4003339">gamma</span><span class="op" id="4003344">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003348">x3</span>&nbsp;<span class="op" id="4003351">:=</span>&nbsp;<span class="builtinfunc" id="4003354">new</span><span class="op" id="4003357">(</span><span class="ident" id="4003358">big</span><span class="op" id="4003361">.</span><span class="ident" id="4003362">Int</span><span class="op" id="4003365">)</span><span class="op" id="4003366">.</span><span class="ident" id="4003367">Mul</span><span class="op" id="4003370">(</span><span class="ident" id="4003371">alpha</span><span class="op" id="4003376">,</span>&nbsp;<span class="ident" id="4003378">alpha</span><span class="op" id="4003383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003386">beta8</span>&nbsp;<span class="op" id="4003392">:=</span>&nbsp;<span class="builtinfunc" id="4003395">new</span><span class="op" id="4003398">(</span><span class="ident" id="4003399">big</span><span class="op" id="4003402">.</span><span class="ident" id="4003403">Int</span><span class="op" id="4003406">)</span><span class="op" id="4003407">.</span><span class="ident" id="4003408">Lsh</span><span class="op" id="4003411">(</span><span class="ident" id="4003412">beta</span><span class="op" id="4003416">,</span>&nbsp;<span class="num" id="4003418">3</span><span class="op" id="4003419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003422">x3</span><span class="op" id="4003424">.</span><span class="ident" id="4003425">Sub</span><span class="op" id="4003428">(</span><span class="ident" id="4003429">x3</span><span class="op" id="4003431">,</span>&nbsp;<span class="ident" id="4003433">beta8</span><span class="op" id="4003438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003441">for</span>&nbsp;<span class="ident" id="4003445">x3</span><span class="op" id="4003447">.</span><span class="ident" id="4003448">Sign</span><span class="op" id="4003452">(</span><span class="op" id="4003453">)</span>&nbsp;<span class="op" id="4003455">==</span>&nbsp;<span class="op" id="4003458">-</span><span class="num" id="4003459">1</span>&nbsp;<span class="op" id="4003461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003465">x3</span><span class="op" id="4003467">.</span><span class="ident" id="4003468">Add</span><span class="op" id="4003471">(</span><span class="ident" id="4003472">x3</span><span class="op" id="4003474">,</span>&nbsp;<span class="ident" id="4003476">curve</span><span class="op" id="4003481">.</span><span class="ident" id="4003482">P</span><span class="op" id="4003483">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003489">x3</span><span class="op" id="4003491">.</span><span class="ident" id="4003492">Mod</span><span class="op" id="4003495">(</span><span class="ident" id="4003496">x3</span><span class="op" id="4003498">,</span>&nbsp;<span class="ident" id="4003500">curve</span><span class="op" id="4003505">.</span><span class="ident" id="4003506">P</span><span class="op" id="4003507">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003511">z3</span>&nbsp;<span class="op" id="4003514">:=</span>&nbsp;<span class="builtinfunc" id="4003517">new</span><span class="op" id="4003520">(</span><span class="ident" id="4003521">big</span><span class="op" id="4003524">.</span><span class="ident" id="4003525">Int</span><span class="op" id="4003528">)</span><span class="op" id="4003529">.</span><span class="ident" id="4003530">Add</span><span class="op" id="4003533">(</span><span class="ident" id="4003534">y</span><span class="op" id="4003535">,</span>&nbsp;<span class="ident" id="4003537">z</span><span class="op" id="4003538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003541">z3</span><span class="op" id="4003543">.</span><span class="ident" id="4003544">Mul</span><span class="op" id="4003547">(</span><span class="ident" id="4003548">z3</span><span class="op" id="4003550">,</span>&nbsp;<span class="ident" id="4003552">z3</span><span class="op" id="4003554">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003557">z3</span><span class="op" id="4003559">.</span><span class="ident" id="4003560">Sub</span><span class="op" id="4003563">(</span><span class="ident" id="4003564">z3</span><span class="op" id="4003566">,</span>&nbsp;<span class="ident" id="4003568">gamma</span><span class="op" id="4003573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003576">if</span>&nbsp;<span class="ident" id="4003579">z3</span><span class="op" id="4003581">.</span><span class="ident" id="4003582">Sign</span><span class="op" id="4003586">(</span><span class="op" id="4003587">)</span>&nbsp;<span class="op" id="4003589">==</span>&nbsp;<span class="op" id="4003592">-</span><span class="num" id="4003593">1</span>&nbsp;<span class="op" id="4003595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003599">z3</span><span class="op" id="4003601">.</span><span class="ident" id="4003602">Add</span><span class="op" id="4003605">(</span><span class="ident" id="4003606">z3</span><span class="op" id="4003608">,</span>&nbsp;<span class="ident" id="4003610">curve</span><span class="op" id="4003615">.</span><span class="ident" id="4003616">P</span><span class="op" id="4003617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003623">z3</span><span class="op" id="4003625">.</span><span class="ident" id="4003626">Sub</span><span class="op" id="4003629">(</span><span class="ident" id="4003630">z3</span><span class="op" id="4003632">,</span>&nbsp;<span class="ident" id="4003634">delta</span><span class="op" id="4003639">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003642">if</span>&nbsp;<span class="ident" id="4003645">z3</span><span class="op" id="4003647">.</span><span class="ident" id="4003648">Sign</span><span class="op" id="4003652">(</span><span class="op" id="4003653">)</span>&nbsp;<span class="op" id="4003655">==</span>&nbsp;<span class="op" id="4003658">-</span><span class="num" id="4003659">1</span>&nbsp;<span class="op" id="4003661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003665">z3</span><span class="op" id="4003667">.</span><span class="ident" id="4003668">Add</span><span class="op" id="4003671">(</span><span class="ident" id="4003672">z3</span><span class="op" id="4003674">,</span>&nbsp;<span class="ident" id="4003676">curve</span><span class="op" id="4003681">.</span><span class="ident" id="4003682">P</span><span class="op" id="4003683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003689">z3</span><span class="op" id="4003691">.</span><span class="ident" id="4003692">Mod</span><span class="op" id="4003695">(</span><span class="ident" id="4003696">z3</span><span class="op" id="4003698">,</span>&nbsp;<span class="ident" id="4003700">curve</span><span class="op" id="4003705">.</span><span class="ident" id="4003706">P</span><span class="op" id="4003707">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003711">beta</span><span class="op" id="4003715">.</span><span class="ident" id="4003716">Lsh</span><span class="op" id="4003719">(</span><span class="ident" id="4003720">beta</span><span class="op" id="4003724">,</span>&nbsp;<span class="num" id="4003726">2</span><span class="op" id="4003727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003730">beta</span><span class="op" id="4003734">.</span><span class="ident" id="4003735">Sub</span><span class="op" id="4003738">(</span><span class="ident" id="4003739">beta</span><span class="op" id="4003743">,</span>&nbsp;<span class="ident" id="4003745">x3</span><span class="op" id="4003747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003750">if</span>&nbsp;<span class="ident" id="4003753">beta</span><span class="op" id="4003757">.</span><span class="ident" id="4003758">Sign</span><span class="op" id="4003762">(</span><span class="op" id="4003763">)</span>&nbsp;<span class="op" id="4003765">==</span>&nbsp;<span class="op" id="4003768">-</span><span class="num" id="4003769">1</span>&nbsp;<span class="op" id="4003771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003775">beta</span><span class="op" id="4003779">.</span><span class="ident" id="4003780">Add</span><span class="op" id="4003783">(</span><span class="ident" id="4003784">beta</span><span class="op" id="4003788">,</span>&nbsp;<span class="ident" id="4003790">curve</span><span class="op" id="4003795">.</span><span class="ident" id="4003796">P</span><span class="op" id="4003797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003800">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003803">y3</span>&nbsp;<span class="op" id="4003806">:=</span>&nbsp;<span class="ident" id="4003809">alpha</span><span class="op" id="4003814">.</span><span class="ident" id="4003815">Mul</span><span class="op" id="4003818">(</span><span class="ident" id="4003819">alpha</span><span class="op" id="4003824">,</span>&nbsp;<span class="ident" id="4003826">beta</span><span class="op" id="4003830">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003834">gamma</span><span class="op" id="4003839">.</span><span class="ident" id="4003840">Mul</span><span class="op" id="4003843">(</span><span class="ident" id="4003844">gamma</span><span class="op" id="4003849">,</span>&nbsp;<span class="ident" id="4003851">gamma</span><span class="op" id="4003856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003859">gamma</span><span class="op" id="4003864">.</span><span class="ident" id="4003865">Lsh</span><span class="op" id="4003868">(</span><span class="ident" id="4003869">gamma</span><span class="op" id="4003874">,</span>&nbsp;<span class="num" id="4003876">3</span><span class="op" id="4003877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003880">gamma</span><span class="op" id="4003885">.</span><span class="ident" id="4003886">Mod</span><span class="op" id="4003889">(</span><span class="ident" id="4003890">gamma</span><span class="op" id="4003895">,</span>&nbsp;<span class="ident" id="4003897">curve</span><span class="op" id="4003902">.</span><span class="ident" id="4003903">P</span><span class="op" id="4003904">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003908">y3</span><span class="op" id="4003910">.</span><span class="ident" id="4003911">Sub</span><span class="op" id="4003914">(</span><span class="ident" id="4003915">y3</span><span class="op" id="4003917">,</span>&nbsp;<span class="ident" id="4003919">gamma</span><span class="op" id="4003924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003927">if</span>&nbsp;<span class="ident" id="4003930">y3</span><span class="op" id="4003932">.</span><span class="ident" id="4003933">Sign</span><span class="op" id="4003937">(</span><span class="op" id="4003938">)</span>&nbsp;<span class="op" id="4003940">==</span>&nbsp;<span class="op" id="4003943">-</span><span class="num" id="4003944">1</span>&nbsp;<span class="op" id="4003946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003950">y3</span><span class="op" id="4003952">.</span><span class="ident" id="4003953">Add</span><span class="op" id="4003956">(</span><span class="ident" id="4003957">y3</span><span class="op" id="4003959">,</span>&nbsp;<span class="ident" id="4003961">curve</span><span class="op" id="4003966">.</span><span class="ident" id="4003967">P</span><span class="op" id="4003968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003971">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003974">y3</span><span class="op" id="4003976">.</span><span class="ident" id="4003977">Mod</span><span class="op" id="4003980">(</span><span class="ident" id="4003981">y3</span><span class="op" id="4003983">,</span>&nbsp;<span class="ident" id="4003985">curve</span><span class="op" id="4003990">.</span><span class="ident" id="4003991">P</span><span class="op" id="4003992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003996">return</span>&nbsp;<span class="ident" id="4004003">x3</span><span class="op" id="4004005">,</span>&nbsp;<span class="ident" id="4004007">y3</span><span class="op" id="4004009">,</span>&nbsp;<span class="ident" id="4004011">z3</span><br>
<span class="lineno"></span><span class="op" id="4004014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4004017">func</span>&nbsp;<span class="op" id="4004022">(</span><span class="ident" id="4004023">curve</span>&nbsp;<span class="op" id="4004029">*</span><span class="ident" id="4004030">CurveParams</span><span class="op" id="4004041">)</span>&nbsp;<span class="ident" id="4004043">ScalarMult</span><span class="op" id="4004053">(</span><span class="ident" id="4004054">Bx</span><span class="op" id="4004056">,</span>&nbsp;<span class="ident" id="4004058">By</span>&nbsp;<span class="op" id="4004061">*</span><span class="ident" id="4004062">big</span><span class="op" id="4004065">.</span><span class="ident" id="4004066">Int</span><span class="op" id="4004069">,</span>&nbsp;<span class="ident" id="4004071">k</span>&nbsp;<span class="op" id="4004073">[</span><span class="op" id="4004074">]</span><span class="builtintype" id="4004075">byte</span><span class="op" id="4004079">)</span>&nbsp;<span class="op" id="4004081">(</span><span class="op" id="4004082">*</span><span class="ident" id="4004083">big</span><span class="op" id="4004086">.</span><span class="ident" id="4004087">Int</span><span class="op" id="4004090">,</span>&nbsp;<span class="op" id="4004092">*</span><span class="ident" id="4004093">big</span><span class="op" id="4004096">.</span><span class="ident" id="4004097">Int</span><span class="op" id="4004100">)</span>&nbsp;<span class="op" id="4004102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004105">Bz</span>&nbsp;<span class="op" id="4004108">:=</span>&nbsp;<span class="builtinfunc" id="4004111">new</span><span class="op" id="4004114">(</span><span class="ident" id="4004115">big</span><span class="op" id="4004118">.</span><span class="ident" id="4004119">Int</span><span class="op" id="4004122">)</span><span class="op" id="4004123">.</span><span class="ident" id="4004124">SetInt64</span><span class="op" id="4004132">(</span><span class="num" id="4004133">1</span><span class="op" id="4004134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004137">x</span><span class="op" id="4004138">,</span>&nbsp;<span class="ident" id="4004140">y</span><span class="op" id="4004141">,</span>&nbsp;<span class="ident" id="4004143">z</span>&nbsp;<span class="op" id="4004145">:=</span>&nbsp;<span class="builtinfunc" id="4004148">new</span><span class="op" id="4004151">(</span><span class="ident" id="4004152">big</span><span class="op" id="4004155">.</span><span class="ident" id="4004156">Int</span><span class="op" id="4004159">)</span><span class="op" id="4004160">,</span>&nbsp;<span class="builtinfunc" id="4004162">new</span><span class="op" id="4004165">(</span><span class="ident" id="4004166">big</span><span class="op" id="4004169">.</span><span class="ident" id="4004170">Int</span><span class="op" id="4004173">)</span><span class="op" id="4004174">,</span>&nbsp;<span class="builtinfunc" id="4004176">new</span><span class="op" id="4004179">(</span><span class="ident" id="4004180">big</span><span class="op" id="4004183">.</span><span class="ident" id="4004184">Int</span><span class="op" id="4004187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004191">for</span>&nbsp;<span class="ident" id="4004195">_</span><span class="op" id="4004196">,</span>&nbsp;<span class="builtintype" id="4004198">byte</span>&nbsp;<span class="op" id="4004203">:=</span>&nbsp;<span class="keyword" id="4004206">range</span>&nbsp;<span class="ident" id="4004212">k</span>&nbsp;<span class="op" id="4004214">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004218">for</span>&nbsp;<span class="ident" id="4004222">bitNum</span>&nbsp;<span class="op" id="4004229">:=</span>&nbsp;<span class="num" id="4004232">0</span><span class="op" id="4004233">;</span>&nbsp;<span class="ident" id="4004235">bitNum</span>&nbsp;<span class="op" id="4004242">&lt;</span>&nbsp;<span class="num" id="4004244">8</span><span class="op" id="4004245">;</span>&nbsp;<span class="ident" id="4004247">bitNum</span><span class="op" id="4004253">++</span>&nbsp;<span class="op" id="4004256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004261">x</span><span class="op" id="4004262">,</span>&nbsp;<span class="ident" id="4004264">y</span><span class="op" id="4004265">,</span>&nbsp;<span class="ident" id="4004267">z</span>&nbsp;<span class="op" id="4004269">=</span>&nbsp;<span class="ident" id="4004271">curve</span><span class="op" id="4004276">.</span><span class="ident" id="4004277">doubleJacobian</span><span class="op" id="4004291">(</span><span class="ident" id="4004292">x</span><span class="op" id="4004293">,</span>&nbsp;<span class="ident" id="4004295">y</span><span class="op" id="4004296">,</span>&nbsp;<span class="ident" id="4004298">z</span><span class="op" id="4004299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004304">if</span>&nbsp;<span class="builtintype" id="4004307">byte</span><span class="op" id="4004311">&amp;</span><span class="num" id="4004312">0x80</span>&nbsp;<span class="op" id="4004317">==</span>&nbsp;<span class="num" id="4004320">0x80</span>&nbsp;<span class="op" id="4004325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004331">x</span><span class="op" id="4004332">,</span>&nbsp;<span class="ident" id="4004334">y</span><span class="op" id="4004335">,</span>&nbsp;<span class="ident" id="4004337">z</span>&nbsp;<span class="op" id="4004339">=</span>&nbsp;<span class="ident" id="4004341">curve</span><span class="op" id="4004346">.</span><span class="ident" id="4004347">addJacobian</span><span class="op" id="4004358">(</span><span class="ident" id="4004359">Bx</span><span class="op" id="4004361">,</span>&nbsp;<span class="ident" id="4004363">By</span><span class="op" id="4004365">,</span>&nbsp;<span class="ident" id="4004367">Bz</span><span class="op" id="4004369">,</span>&nbsp;<span class="ident" id="4004371">x</span><span class="op" id="4004372">,</span>&nbsp;<span class="ident" id="4004374">y</span><span class="op" id="4004375">,</span>&nbsp;<span class="ident" id="4004377">z</span><span class="op" id="4004378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004383">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4004388">byte</span>&nbsp;<span class="op" id="4004393">&lt;&lt;=</span>&nbsp;<span class="num" id="4004397">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004408">return</span>&nbsp;<span class="ident" id="4004415">curve</span><span class="op" id="4004420">.</span><span class="ident" id="4004421">affineFromJacobian</span><span class="op" id="4004439">(</span><span class="ident" id="4004440">x</span><span class="op" id="4004441">,</span>&nbsp;<span class="ident" id="4004443">y</span><span class="op" id="4004444">,</span>&nbsp;<span class="ident" id="4004446">z</span><span class="op" id="4004447">)</span><br>
<span class="lineno">265</span><span class="op" id="4004449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4004452">func</span>&nbsp;<span class="op" id="4004457">(</span><span class="ident" id="4004458">curve</span>&nbsp;<span class="op" id="4004464">*</span><span class="ident" id="4004465">CurveParams</span><span class="op" id="4004476">)</span>&nbsp;<span class="ident" id="4004478">ScalarBaseMult</span><span class="op" id="4004492">(</span><span class="ident" id="4004493">k</span>&nbsp;<span class="op" id="4004495">[</span><span class="op" id="4004496">]</span><span class="builtintype" id="4004497">byte</span><span class="op" id="4004501">)</span>&nbsp;<span class="op" id="4004503">(</span><span class="op" id="4004504">*</span><span class="ident" id="4004505">big</span><span class="op" id="4004508">.</span><span class="ident" id="4004509">Int</span><span class="op" id="4004512">,</span>&nbsp;<span class="op" id="4004514">*</span><span class="ident" id="4004515">big</span><span class="op" id="4004518">.</span><span class="ident" id="4004519">Int</span><span class="op" id="4004522">)</span>&nbsp;<span class="op" id="4004524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004527">return</span>&nbsp;<span class="ident" id="4004534">curve</span><span class="op" id="4004539">.</span><span class="ident" id="4004540">ScalarMult</span><span class="op" id="4004550">(</span><span class="ident" id="4004551">curve</span><span class="op" id="4004556">.</span><span class="ident" id="4004557">Gx</span><span class="op" id="4004559">,</span>&nbsp;<span class="ident" id="4004561">curve</span><span class="op" id="4004566">.</span><span class="ident" id="4004567">Gy</span><span class="op" id="4004569">,</span>&nbsp;<span class="ident" id="4004571">k</span><span class="op" id="4004572">)</span><br>
<span class="lineno"></span><span class="op" id="4004574">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4004577">var</span>&nbsp;<span class="ident" id="4004581">mask</span>&nbsp;<span class="op" id="4004586">=</span>&nbsp;<span class="op" id="4004588">[</span><span class="op" id="4004589">]</span><span class="builtintype" id="4004590">byte</span><span class="op" id="4004594">{</span><span class="num" id="4004595">0xff</span><span class="op" id="4004599">,</span>&nbsp;<span class="num" id="4004601">0x1</span><span class="op" id="4004604">,</span>&nbsp;<span class="num" id="4004606">0x3</span><span class="op" id="4004609">,</span>&nbsp;<span class="num" id="4004611">0x7</span><span class="op" id="4004614">,</span>&nbsp;<span class="num" id="4004616">0xf</span><span class="op" id="4004619">,</span>&nbsp;<span class="num" id="4004621">0x1f</span><span class="op" id="4004625">,</span>&nbsp;<span class="num" id="4004627">0x3f</span><span class="op" id="4004631">,</span>&nbsp;<span class="num" id="4004633">0x7f</span><span class="op" id="4004637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4004640">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4004709">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4004777">func</span>&nbsp;<span class="ident" id="4004782">GenerateKey</span><span class="op" id="4004793">(</span><span class="ident" id="4004794">curve</span>&nbsp;<span class="ident" id="4004800">Curve</span><span class="op" id="4004805">,</span>&nbsp;<span class="ident" id="4004807">rand</span>&nbsp;<span class="ident" id="4004812">io</span><span class="op" id="4004814">.</span><span class="ident" id="4004815">Reader</span><span class="op" id="4004821">)</span>&nbsp;<span class="op" id="4004823">(</span><span class="ident" id="4004824">priv</span>&nbsp;<span class="op" id="4004829">[</span><span class="op" id="4004830">]</span><span class="builtintype" id="4004831">byte</span><span class="op" id="4004835">,</span>&nbsp;<span class="ident" id="4004837">x</span><span class="op" id="4004838">,</span>&nbsp;<span class="ident" id="4004840">y</span>&nbsp;<span class="op" id="4004842">*</span><span class="ident" id="4004843">big</span><span class="op" id="4004846">.</span><span class="ident" id="4004847">Int</span><span class="op" id="4004850">,</span>&nbsp;<span class="ident" id="4004852">err</span>&nbsp;<span class="builtintype" id="4004856">error</span><span class="op" id="4004861">)</span>&nbsp;<span class="op" id="4004863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004866">bitSize</span>&nbsp;<span class="op" id="4004874">:=</span>&nbsp;<span class="ident" id="4004877">curve</span><span class="op" id="4004882">.</span><span class="ident" id="4004883">Params</span><span class="op" id="4004889">(</span><span class="op" id="4004890">)</span><span class="op" id="4004891">.</span><span class="ident" id="4004892">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004901">byteLen</span>&nbsp;<span class="op" id="4004909">:=</span>&nbsp;<span class="op" id="4004912">(</span><span class="ident" id="4004913">bitSize</span>&nbsp;<span class="op" id="4004921">+</span>&nbsp;<span class="num" id="4004923">7</span><span class="op" id="4004924">)</span>&nbsp;<span class="op" id="4004926">&gt;&gt;</span>&nbsp;<span class="num" id="4004929">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004932">priv</span>&nbsp;<span class="op" id="4004937">=</span>&nbsp;<span class="builtinfunc" id="4004939">make</span><span class="op" id="4004943">(</span><span class="op" id="4004944">[</span><span class="op" id="4004945">]</span><span class="builtintype" id="4004946">byte</span><span class="op" id="4004950">,</span>&nbsp;<span class="ident" id="4004952">byteLen</span><span class="op" id="4004959">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004963">for</span>&nbsp;<span class="ident" id="4004967">x</span>&nbsp;<span class="op" id="4004969">==</span>&nbsp;<span class="ident" id="4004972">nil</span>&nbsp;<span class="op" id="4004976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004980">_</span><span class="op" id="4004981">,</span>&nbsp;<span class="ident" id="4004983">err</span>&nbsp;<span class="op" id="4004987">=</span>&nbsp;<span class="ident" id="4004989">io</span><span class="op" id="4004991">.</span><span class="ident" id="4004992">ReadFull</span><span class="op" id="4005000">(</span><span class="ident" id="4005001">rand</span><span class="op" id="4005005">,</span>&nbsp;<span class="ident" id="4005007">priv</span><span class="op" id="4005011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005015">if</span>&nbsp;<span class="ident" id="4005018">err</span>&nbsp;<span class="op" id="4005022">!=</span>&nbsp;<span class="ident" id="4005025">nil</span>&nbsp;<span class="op" id="4005029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005034">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005043">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005047">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005121">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005175">priv</span><span class="op" id="4005179">[</span><span class="num" id="4005180">0</span><span class="op" id="4005181">]</span>&nbsp;<span class="op" id="4005183">&amp;=</span>&nbsp;<span class="ident" id="4005186">mask</span><span class="op" id="4005190">[</span><span class="ident" id="4005191">bitSize</span><span class="op" id="4005198">%</span><span class="num" id="4005199">8</span><span class="op" id="4005200">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005204">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005276">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005333">priv</span><span class="op" id="4005337">[</span><span class="num" id="4005338">1</span><span class="op" id="4005339">]</span>&nbsp;<span class="op" id="4005341">^=</span>&nbsp;<span class="num" id="4005344">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005351">x</span><span class="op" id="4005352">,</span>&nbsp;<span class="ident" id="4005354">y</span>&nbsp;<span class="op" id="4005356">=</span>&nbsp;<span class="ident" id="4005358">curve</span><span class="op" id="4005363">.</span><span class="ident" id="4005364">ScalarBaseMult</span><span class="op" id="4005378">(</span><span class="ident" id="4005379">priv</span><span class="op" id="4005383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005389">return</span><br>
<span class="lineno"></span><span class="op" id="4005396">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4005399">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4005483">func</span>&nbsp;<span class="ident" id="4005488">Marshal</span><span class="op" id="4005495">(</span><span class="ident" id="4005496">curve</span>&nbsp;<span class="ident" id="4005502">Curve</span><span class="op" id="4005507">,</span>&nbsp;<span class="ident" id="4005509">x</span><span class="op" id="4005510">,</span>&nbsp;<span class="ident" id="4005512">y</span>&nbsp;<span class="op" id="4005514">*</span><span class="ident" id="4005515">big</span><span class="op" id="4005518">.</span><span class="ident" id="4005519">Int</span><span class="op" id="4005522">)</span>&nbsp;<span class="op" id="4005524">[</span><span class="op" id="4005525">]</span><span class="builtintype" id="4005526">byte</span>&nbsp;<span class="op" id="4005531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005534">byteLen</span>&nbsp;<span class="op" id="4005542">:=</span>&nbsp;<span class="op" id="4005545">(</span><span class="ident" id="4005546">curve</span><span class="op" id="4005551">.</span><span class="ident" id="4005552">Params</span><span class="op" id="4005558">(</span><span class="op" id="4005559">)</span><span class="op" id="4005560">.</span><span class="ident" id="4005561">BitSize</span>&nbsp;<span class="op" id="4005569">+</span>&nbsp;<span class="num" id="4005571">7</span><span class="op" id="4005572">)</span>&nbsp;<span class="op" id="4005574">&gt;&gt;</span>&nbsp;<span class="num" id="4005577">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005581">ret</span>&nbsp;<span class="op" id="4005585">:=</span>&nbsp;<span class="builtinfunc" id="4005588">make</span><span class="op" id="4005592">(</span><span class="op" id="4005593">[</span><span class="op" id="4005594">]</span><span class="builtintype" id="4005595">byte</span><span class="op" id="4005599">,</span>&nbsp;<span class="num" id="4005601">1</span><span class="op" id="4005602">+</span><span class="num" id="4005603">2</span><span class="op" id="4005604">*</span><span class="ident" id="4005605">byteLen</span><span class="op" id="4005612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005615">ret</span><span class="op" id="4005618">[</span><span class="num" id="4005619">0</span><span class="op" id="4005620">]</span>&nbsp;<span class="op" id="4005622">=</span>&nbsp;<span class="num" id="4005624">4</span>&nbsp;<span class="comment" id="4005626">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005650">xBytes</span>&nbsp;<span class="op" id="4005657">:=</span>&nbsp;<span class="ident" id="4005660">x</span><span class="op" id="4005661">.</span><span class="ident" id="4005662">Bytes</span><span class="op" id="4005667">(</span><span class="op" id="4005668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4005671">copy</span><span class="op" id="4005675">(</span><span class="ident" id="4005676">ret</span><span class="op" id="4005679">[</span><span class="num" id="4005680">1</span><span class="op" id="4005681">+</span><span class="ident" id="4005682">byteLen</span><span class="op" id="4005689">-</span><span class="builtinfunc" id="4005690">len</span><span class="op" id="4005693">(</span><span class="ident" id="4005694">xBytes</span><span class="op" id="4005700">)</span><span class="op" id="4005701">:</span><span class="op" id="4005702">]</span><span class="op" id="4005703">,</span>&nbsp;<span class="ident" id="4005705">xBytes</span><span class="op" id="4005711">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005714">yBytes</span>&nbsp;<span class="op" id="4005721">:=</span>&nbsp;<span class="ident" id="4005724">y</span><span class="op" id="4005725">.</span><span class="ident" id="4005726">Bytes</span><span class="op" id="4005731">(</span><span class="op" id="4005732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4005735">copy</span><span class="op" id="4005739">(</span><span class="ident" id="4005740">ret</span><span class="op" id="4005743">[</span><span class="num" id="4005744">1</span><span class="op" id="4005745">+</span><span class="num" id="4005746">2</span><span class="op" id="4005747">*</span><span class="ident" id="4005748">byteLen</span><span class="op" id="4005755">-</span><span class="builtinfunc" id="4005756">len</span><span class="op" id="4005759">(</span><span class="ident" id="4005760">yBytes</span><span class="op" id="4005766">)</span><span class="op" id="4005767">:</span><span class="op" id="4005768">]</span><span class="op" id="4005769">,</span>&nbsp;<span class="ident" id="4005771">yBytes</span><span class="op" id="4005777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005780">return</span>&nbsp;<span class="ident" id="4005787">ret</span><br>
<span class="lineno"></span><span class="op" id="4005791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4005794">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4005886">func</span>&nbsp;<span class="ident" id="4005891">Unmarshal</span><span class="op" id="4005900">(</span><span class="ident" id="4005901">curve</span>&nbsp;<span class="ident" id="4005907">Curve</span><span class="op" id="4005912">,</span>&nbsp;<span class="ident" id="4005914">data</span>&nbsp;<span class="op" id="4005919">[</span><span class="op" id="4005920">]</span><span class="builtintype" id="4005921">byte</span><span class="op" id="4005925">)</span>&nbsp;<span class="op" id="4005927">(</span><span class="ident" id="4005928">x</span><span class="op" id="4005929">,</span>&nbsp;<span class="ident" id="4005931">y</span>&nbsp;<span class="op" id="4005933">*</span><span class="ident" id="4005934">big</span><span class="op" id="4005937">.</span><span class="ident" id="4005938">Int</span><span class="op" id="4005941">)</span>&nbsp;<span class="op" id="4005943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005946">byteLen</span>&nbsp;<span class="op" id="4005954">:=</span>&nbsp;<span class="op" id="4005957">(</span><span class="ident" id="4005958">curve</span><span class="op" id="4005963">.</span><span class="ident" id="4005964">Params</span><span class="op" id="4005970">(</span><span class="op" id="4005971">)</span><span class="op" id="4005972">.</span><span class="ident" id="4005973">BitSize</span>&nbsp;<span class="op" id="4005981">+</span>&nbsp;<span class="num" id="4005983">7</span><span class="op" id="4005984">)</span>&nbsp;<span class="op" id="4005986">&gt;&gt;</span>&nbsp;<span class="num" id="4005989">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005992">if</span>&nbsp;<span class="builtinfunc" id="4005995">len</span><span class="op" id="4005998">(</span><span class="ident" id="4005999">data</span><span class="op" id="4006003">)</span>&nbsp;<span class="op" id="4006005">!=</span>&nbsp;<span class="num" id="4006008">1</span><span class="op" id="4006009">+</span><span class="num" id="4006010">2</span><span class="op" id="4006011">*</span><span class="ident" id="4006012">byteLen</span>&nbsp;<span class="op" id="4006020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006024">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006035">if</span>&nbsp;<span class="ident" id="4006038">data</span><span class="op" id="4006042">[</span><span class="num" id="4006043">0</span><span class="op" id="4006044">]</span>&nbsp;<span class="op" id="4006046">!=</span>&nbsp;<span class="num" id="4006049">4</span>&nbsp;<span class="op" id="4006051">{</span>&nbsp;<span class="comment" id="4006053">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006076">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006087">x</span>&nbsp;<span class="op" id="4006089">=</span>&nbsp;<span class="builtinfunc" id="4006091">new</span><span class="op" id="4006094">(</span><span class="ident" id="4006095">big</span><span class="op" id="4006098">.</span><span class="ident" id="4006099">Int</span><span class="op" id="4006102">)</span><span class="op" id="4006103">.</span><span class="ident" id="4006104">SetBytes</span><span class="op" id="4006112">(</span><span class="ident" id="4006113">data</span><span class="op" id="4006117">[</span><span class="num" id="4006118">1</span>&nbsp;<span class="op" id="4006120">:</span>&nbsp;<span class="num" id="4006122">1</span><span class="op" id="4006123">+</span><span class="ident" id="4006124">byteLen</span><span class="op" id="4006131">]</span><span class="op" id="4006132">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006135">y</span>&nbsp;<span class="op" id="4006137">=</span>&nbsp;<span class="builtinfunc" id="4006139">new</span><span class="op" id="4006142">(</span><span class="ident" id="4006143">big</span><span class="op" id="4006146">.</span><span class="ident" id="4006147">Int</span><span class="op" id="4006150">)</span><span class="op" id="4006151">.</span><span class="ident" id="4006152">SetBytes</span><span class="op" id="4006160">(</span><span class="ident" id="4006161">data</span><span class="op" id="4006165">[</span><span class="num" id="4006166">1</span><span class="op" id="4006167">+</span><span class="ident" id="4006168">byteLen</span><span class="op" id="4006175">:</span><span class="op" id="4006176">]</span><span class="op" id="4006177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006180">return</span><br>
<span class="lineno"></span><span class="op" id="4006187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4006190">var</span>&nbsp;<span class="ident" id="4006194">initonce</span>&nbsp;<span class="ident" id="4006203">sync</span><span class="op" id="4006207">.</span><span class="ident" id="4006208">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4006213">var</span>&nbsp;<span class="ident" id="4006217">p384</span>&nbsp;<span class="op" id="4006222">*</span><span class="ident" id="4006223">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4006235">var</span>&nbsp;<span class="ident" id="4006239">p521</span>&nbsp;<span class="op" id="4006244">*</span><span class="ident" id="4006245">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4006258">func</span>&nbsp;<span class="ident" id="4006263">initAll</span><span class="op" id="4006270">(</span><span class="op" id="4006271">)</span>&nbsp;<span class="op" id="4006273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006276">initP224</span><span class="op" id="4006284">(</span><span class="op" id="4006285">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006288">initP256</span><span class="op" id="4006296">(</span><span class="op" id="4006297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006300">initP384</span><span class="op" id="4006308">(</span><span class="op" id="4006309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006312">initP521</span><span class="op" id="4006320">(</span><span class="op" id="4006321">)</span><br>
<span class="lineno"></span><span class="op" id="4006323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4006326">func</span>&nbsp;<span class="ident" id="4006331">initP384</span><span class="op" id="4006339">(</span><span class="op" id="4006340">)</span>&nbsp;<span class="op" id="4006342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4006345">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006379">p384</span>&nbsp;<span class="op" id="4006384">=</span>&nbsp;<span class="builtinfunc" id="4006386">new</span><span class="op" id="4006389">(</span><span class="ident" id="4006390">CurveParams</span><span class="op" id="4006401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006404">p384</span><span class="op" id="4006408">.</span><span class="ident" id="4006409">P</span><span class="op" id="4006410">,</span>&nbsp;<span class="ident" id="4006412">_</span>&nbsp;<span class="op" id="4006414">=</span>&nbsp;<span class="builtinfunc" id="4006416">new</span><span class="op" id="4006419">(</span><span class="ident" id="4006420">big</span><span class="op" id="4006423">.</span><span class="ident" id="4006424">Int</span><span class="op" id="4006427">)</span><span class="op" id="4006428">.</span><span class="ident" id="4006429">SetString</span><span class="op" id="4006438">(</span><span class="string" id="4006439">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4006557">,</span>&nbsp;<span class="num" id="4006559">10</span><span class="op" id="4006561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006564">p384</span><span class="op" id="4006568">.</span><span class="ident" id="4006569">N</span><span class="op" id="4006570">,</span>&nbsp;<span class="ident" id="4006572">_</span>&nbsp;<span class="op" id="4006574">=</span>&nbsp;<span class="builtinfunc" id="4006576">new</span><span class="op" id="4006579">(</span><span class="ident" id="4006580">big</span><span class="op" id="4006583">.</span><span class="ident" id="4006584">Int</span><span class="op" id="4006587">)</span><span class="op" id="4006588">.</span><span class="ident" id="4006589">SetString</span><span class="op" id="4006598">(</span><span class="string" id="4006599">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4006717">,</span>&nbsp;<span class="num" id="4006719">10</span><span class="op" id="4006721">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006724">p384</span><span class="op" id="4006728">.</span><span class="ident" id="4006729">B</span><span class="op" id="4006730">,</span>&nbsp;<span class="ident" id="4006732">_</span>&nbsp;<span class="op" id="4006734">=</span>&nbsp;<span class="builtinfunc" id="4006736">new</span><span class="op" id="4006739">(</span><span class="ident" id="4006740">big</span><span class="op" id="4006743">.</span><span class="ident" id="4006744">Int</span><span class="op" id="4006747">)</span><span class="op" id="4006748">.</span><span class="ident" id="4006749">SetString</span><span class="op" id="4006758">(</span><span class="string" id="4006759">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4006857">,</span>&nbsp;<span class="num" id="4006859">16</span><span class="op" id="4006861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006864">p384</span><span class="op" id="4006868">.</span><span class="ident" id="4006869">Gx</span><span class="op" id="4006871">,</span>&nbsp;<span class="ident" id="4006873">_</span>&nbsp;<span class="op" id="4006875">=</span>&nbsp;<span class="builtinfunc" id="4006877">new</span><span class="op" id="4006880">(</span><span class="ident" id="4006881">big</span><span class="op" id="4006884">.</span><span class="ident" id="4006885">Int</span><span class="op" id="4006888">)</span><span class="op" id="4006889">.</span><span class="ident" id="4006890">SetString</span><span class="op" id="4006899">(</span><span class="string" id="4006900">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4006998">,</span>&nbsp;<span class="num" id="4007000">16</span><span class="op" id="4007002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007005">p384</span><span class="op" id="4007009">.</span><span class="ident" id="4007010">Gy</span><span class="op" id="4007012">,</span>&nbsp;<span class="ident" id="4007014">_</span>&nbsp;<span class="op" id="4007016">=</span>&nbsp;<span class="builtinfunc" id="4007018">new</span><span class="op" id="4007021">(</span><span class="ident" id="4007022">big</span><span class="op" id="4007025">.</span><span class="ident" id="4007026">Int</span><span class="op" id="4007029">)</span><span class="op" id="4007030">.</span><span class="ident" id="4007031">SetString</span><span class="op" id="4007040">(</span><span class="string" id="4007041">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4007139">,</span>&nbsp;<span class="num" id="4007141">16</span><span class="op" id="4007143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007146">p384</span><span class="op" id="4007150">.</span><span class="ident" id="4007151">BitSize</span>&nbsp;<span class="op" id="4007159">=</span>&nbsp;<span class="num" id="4007161">384</span><br>
<span class="lineno"></span><span class="op" id="4007165">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4007168">func</span>&nbsp;<span class="ident" id="4007173">initP521</span><span class="op" id="4007181">(</span><span class="op" id="4007182">)</span>&nbsp;<span class="op" id="4007184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4007187">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007221">p521</span>&nbsp;<span class="op" id="4007226">=</span>&nbsp;<span class="builtinfunc" id="4007228">new</span><span class="op" id="4007231">(</span><span class="ident" id="4007232">CurveParams</span><span class="op" id="4007243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007246">p521</span><span class="op" id="4007250">.</span><span class="ident" id="4007251">P</span><span class="op" id="4007252">,</span>&nbsp;<span class="ident" id="4007254">_</span>&nbsp;<span class="op" id="4007256">=</span>&nbsp;<span class="builtinfunc" id="4007258">new</span><span class="op" id="4007261">(</span><span class="ident" id="4007262">big</span><span class="op" id="4007265">.</span><span class="ident" id="4007266">Int</span><span class="op" id="4007269">)</span><span class="op" id="4007270">.</span><span class="ident" id="4007271">SetString</span><span class="op" id="4007280">(</span><span class="string" id="4007281">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4007440">,</span>&nbsp;<span class="num" id="4007442">10</span><span class="op" id="4007444">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007447">p521</span><span class="op" id="4007451">.</span><span class="ident" id="4007452">N</span><span class="op" id="4007453">,</span>&nbsp;<span class="ident" id="4007455">_</span>&nbsp;<span class="op" id="4007457">=</span>&nbsp;<span class="builtinfunc" id="4007459">new</span><span class="op" id="4007462">(</span><span class="ident" id="4007463">big</span><span class="op" id="4007466">.</span><span class="ident" id="4007467">Int</span><span class="op" id="4007470">)</span><span class="op" id="4007471">.</span><span class="ident" id="4007472">SetString</span><span class="op" id="4007481">(</span><span class="string" id="4007482">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4007641">,</span>&nbsp;<span class="num" id="4007643">10</span><span class="op" id="4007645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007648">p521</span><span class="op" id="4007652">.</span><span class="ident" id="4007653">B</span><span class="op" id="4007654">,</span>&nbsp;<span class="ident" id="4007656">_</span>&nbsp;<span class="op" id="4007658">=</span>&nbsp;<span class="builtinfunc" id="4007660">new</span><span class="op" id="4007663">(</span><span class="ident" id="4007664">big</span><span class="op" id="4007667">.</span><span class="ident" id="4007668">Int</span><span class="op" id="4007671">)</span><span class="op" id="4007672">.</span><span class="ident" id="4007673">SetString</span><span class="op" id="4007682">(</span><span class="string" id="4007683">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4007816">,</span>&nbsp;<span class="num" id="4007818">16</span><span class="op" id="4007820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007823">p521</span><span class="op" id="4007827">.</span><span class="ident" id="4007828">Gx</span><span class="op" id="4007830">,</span>&nbsp;<span class="ident" id="4007832">_</span>&nbsp;<span class="op" id="4007834">=</span>&nbsp;<span class="builtinfunc" id="4007836">new</span><span class="op" id="4007839">(</span><span class="ident" id="4007840">big</span><span class="op" id="4007843">.</span><span class="ident" id="4007844">Int</span><span class="op" id="4007847">)</span><span class="op" id="4007848">.</span><span class="ident" id="4007849">SetString</span><span class="op" id="4007858">(</span><span class="string" id="4007859">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4007991">,</span>&nbsp;<span class="num" id="4007993">16</span><span class="op" id="4007995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007998">p521</span><span class="op" id="4008002">.</span><span class="ident" id="4008003">Gy</span><span class="op" id="4008005">,</span>&nbsp;<span class="ident" id="4008007">_</span>&nbsp;<span class="op" id="4008009">=</span>&nbsp;<span class="builtinfunc" id="4008011">new</span><span class="op" id="4008014">(</span><span class="ident" id="4008015">big</span><span class="op" id="4008018">.</span><span class="ident" id="4008019">Int</span><span class="op" id="4008022">)</span><span class="op" id="4008023">.</span><span class="ident" id="4008024">SetString</span><span class="op" id="4008033">(</span><span class="string" id="4008034">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4008167">,</span>&nbsp;<span class="num" id="4008169">16</span><span class="op" id="4008171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008174">p521</span><span class="op" id="4008178">.</span><span class="ident" id="4008179">BitSize</span>&nbsp;<span class="op" id="4008187">=</span>&nbsp;<span class="num" id="4008189">521</span><br>
<span class="lineno">355</span><span class="op" id="4008193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4008196">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4008275">func</span>&nbsp;<span class="ident" id="4008280">P256</span><span class="op" id="4008284">(</span><span class="op" id="4008285">)</span>&nbsp;<span class="ident" id="4008287">Curve</span>&nbsp;<span class="op" id="4008293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008296">initonce</span><span class="op" id="4008304">.</span><span class="ident" id="4008305">Do</span><span class="op" id="4008307">(</span><span class="ident" id="4008308">initAll</span><span class="op" id="4008315">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008318">return</span>&nbsp;<span class="ident" id="4008325">p256</span><br>
<span class="lineno"></span><span class="op" id="4008330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4008333">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4008412">func</span>&nbsp;<span class="ident" id="4008417">P384</span><span class="op" id="4008421">(</span><span class="op" id="4008422">)</span>&nbsp;<span class="ident" id="4008424">Curve</span>&nbsp;<span class="op" id="4008430">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008433">initonce</span><span class="op" id="4008441">.</span><span class="ident" id="4008442">Do</span><span class="op" id="4008444">(</span><span class="ident" id="4008445">initAll</span><span class="op" id="4008452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008455">return</span>&nbsp;<span class="ident" id="4008462">p384</span><br>
<span class="lineno"></span><span class="op" id="4008467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4008470">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4008549">func</span>&nbsp;<span class="ident" id="4008554">P521</span><span class="op" id="4008558">(</span><span class="op" id="4008559">)</span>&nbsp;<span class="ident" id="4008561">Curve</span>&nbsp;<span class="op" id="4008567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008570">initonce</span><span class="op" id="4008578">.</span><span class="ident" id="4008579">Do</span><span class="op" id="4008581">(</span><span class="ident" id="4008582">initAll</span><span class="op" id="4008589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008592">return</span>&nbsp;<span class="ident" id="4008599">p521</span><br>
<span class="lineno"></span><span class="op" id="4008604">}</span>
</div>
</body>
</html>
