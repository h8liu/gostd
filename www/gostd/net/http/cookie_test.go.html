<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8326869">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8326925">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8326979">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8327030">package</span>&nbsp;<span class="ident" id="8327038">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8327044">import</span>&nbsp;<span class="op" id="8327051">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327054">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327063">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327080">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327087">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327094">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327100">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327111">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327122">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327133">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8327140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8327143">var</span>&nbsp;<span class="ident" id="8327147">writeSetCookiesTests</span>&nbsp;<span class="op" id="8327168">=</span>&nbsp;<span class="op" id="8327170">[</span><span class="op" id="8327171">]</span><span class="keyword" id="8327172">struct</span>&nbsp;<span class="op" id="8327179">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8327182">Cookie</span>&nbsp;<span class="op" id="8327189">*</span><span class="ident" id="8327190">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8327198">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8327205">string</span><br>
<span class="lineno"></span><span class="op" id="8327212">}</span><span class="op" id="8327213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327220">&amp;</span><span class="ident" id="8327221">Cookie</span><span class="op" id="8327227">{</span><span class="ident" id="8327228">Name</span><span class="op" id="8327232">:</span>&nbsp;<span class="string" id="8327234">&#34;cookie-1&#34;</span><span class="op" id="8327244">,</span>&nbsp;<span class="ident" id="8327246">Value</span><span class="op" id="8327251">:</span>&nbsp;<span class="string" id="8327253">&#34;v$1&#34;</span><span class="op" id="8327258">}</span><span class="op" id="8327259">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327263">&#34;cookie-1=v$1&#34;</span><span class="op" id="8327277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327280">}</span><span class="op" id="8327281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327288">&amp;</span><span class="ident" id="8327289">Cookie</span><span class="op" id="8327295">{</span><span class="ident" id="8327296">Name</span><span class="op" id="8327300">:</span>&nbsp;<span class="string" id="8327302">&#34;cookie-2&#34;</span><span class="op" id="8327312">,</span>&nbsp;<span class="ident" id="8327314">Value</span><span class="op" id="8327319">:</span>&nbsp;<span class="string" id="8327321">&#34;two&#34;</span><span class="op" id="8327326">,</span>&nbsp;<span class="ident" id="8327328">MaxAge</span><span class="op" id="8327334">:</span>&nbsp;<span class="num" id="8327336">3600</span><span class="op" id="8327340">}</span><span class="op" id="8327341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327345">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="8327373">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327376">}</span><span class="op" id="8327377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327384">&amp;</span><span class="ident" id="8327385">Cookie</span><span class="op" id="8327391">{</span><span class="ident" id="8327392">Name</span><span class="op" id="8327396">:</span>&nbsp;<span class="string" id="8327398">&#34;cookie-3&#34;</span><span class="op" id="8327408">,</span>&nbsp;<span class="ident" id="8327410">Value</span><span class="op" id="8327415">:</span>&nbsp;<span class="string" id="8327417">&#34;three&#34;</span><span class="op" id="8327424">,</span>&nbsp;<span class="ident" id="8327426">Domain</span><span class="op" id="8327432">:</span>&nbsp;<span class="string" id="8327434">&#34;.example.com&#34;</span><span class="op" id="8327448">}</span><span class="op" id="8327449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327453">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="8327489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327492">}</span><span class="op" id="8327493">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327500">&amp;</span><span class="ident" id="8327501">Cookie</span><span class="op" id="8327507">{</span><span class="ident" id="8327508">Name</span><span class="op" id="8327512">:</span>&nbsp;<span class="string" id="8327514">&#34;cookie-4&#34;</span><span class="op" id="8327524">,</span>&nbsp;<span class="ident" id="8327526">Value</span><span class="op" id="8327531">:</span>&nbsp;<span class="string" id="8327533">&#34;four&#34;</span><span class="op" id="8327539">,</span>&nbsp;<span class="ident" id="8327541">Path</span><span class="op" id="8327545">:</span>&nbsp;<span class="string" id="8327547">&#34;/restricted/&#34;</span><span class="op" id="8327561">}</span><span class="op" id="8327562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327566">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="8327600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327603">}</span><span class="op" id="8327604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327607">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327611">&amp;</span><span class="ident" id="8327612">Cookie</span><span class="op" id="8327618">{</span><span class="ident" id="8327619">Name</span><span class="op" id="8327623">:</span>&nbsp;<span class="string" id="8327625">&#34;cookie-5&#34;</span><span class="op" id="8327635">,</span>&nbsp;<span class="ident" id="8327637">Value</span><span class="op" id="8327642">:</span>&nbsp;<span class="string" id="8327644">&#34;five&#34;</span><span class="op" id="8327650">,</span>&nbsp;<span class="ident" id="8327652">Domain</span><span class="op" id="8327658">:</span>&nbsp;<span class="string" id="8327660">&#34;wrong;bad.abc&#34;</span><span class="op" id="8327675">}</span><span class="op" id="8327676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327680">&#34;cookie-5=five&#34;</span><span class="op" id="8327695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327698">}</span><span class="op" id="8327699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327706">&amp;</span><span class="ident" id="8327707">Cookie</span><span class="op" id="8327713">{</span><span class="ident" id="8327714">Name</span><span class="op" id="8327718">:</span>&nbsp;<span class="string" id="8327720">&#34;cookie-6&#34;</span><span class="op" id="8327730">,</span>&nbsp;<span class="ident" id="8327732">Value</span><span class="op" id="8327737">:</span>&nbsp;<span class="string" id="8327739">&#34;six&#34;</span><span class="op" id="8327744">,</span>&nbsp;<span class="ident" id="8327746">Domain</span><span class="op" id="8327752">:</span>&nbsp;<span class="string" id="8327754">&#34;bad-.abc&#34;</span><span class="op" id="8327764">}</span><span class="op" id="8327765">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327769">&#34;cookie-6=six&#34;</span><span class="op" id="8327783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327786">}</span><span class="op" id="8327787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327794">&amp;</span><span class="ident" id="8327795">Cookie</span><span class="op" id="8327801">{</span><span class="ident" id="8327802">Name</span><span class="op" id="8327806">:</span>&nbsp;<span class="string" id="8327808">&#34;cookie-7&#34;</span><span class="op" id="8327818">,</span>&nbsp;<span class="ident" id="8327820">Value</span><span class="op" id="8327825">:</span>&nbsp;<span class="string" id="8327827">&#34;seven&#34;</span><span class="op" id="8327834">,</span>&nbsp;<span class="ident" id="8327836">Domain</span><span class="op" id="8327842">:</span>&nbsp;<span class="string" id="8327844">&#34;127.0.0.1&#34;</span><span class="op" id="8327855">}</span><span class="op" id="8327856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327860">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="8327894">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327897">}</span><span class="op" id="8327898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327905">&amp;</span><span class="ident" id="8327906">Cookie</span><span class="op" id="8327912">{</span><span class="ident" id="8327913">Name</span><span class="op" id="8327917">:</span>&nbsp;<span class="string" id="8327919">&#34;cookie-8&#34;</span><span class="op" id="8327929">,</span>&nbsp;<span class="ident" id="8327931">Value</span><span class="op" id="8327936">:</span>&nbsp;<span class="string" id="8327938">&#34;eight&#34;</span><span class="op" id="8327945">,</span>&nbsp;<span class="ident" id="8327947">Domain</span><span class="op" id="8327953">:</span>&nbsp;<span class="string" id="8327955">&#34;::1&#34;</span><span class="op" id="8327960">}</span><span class="op" id="8327961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8327965">&#34;cookie-8=eight&#34;</span><span class="op" id="8327981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8327984">}</span><span class="op" id="8327985">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8327988">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8328060">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328123">&amp;</span><span class="ident" id="8328124">Cookie</span><span class="op" id="8328130">{</span><span class="ident" id="8328131">Name</span><span class="op" id="8328135">:</span>&nbsp;<span class="string" id="8328137">&#34;special-1&#34;</span><span class="op" id="8328148">,</span>&nbsp;<span class="ident" id="8328150">Value</span><span class="op" id="8328155">:</span>&nbsp;<span class="string" id="8328157">&#34;a&nbsp;z&#34;</span><span class="op" id="8328162">}</span><span class="op" id="8328163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328167">`special-1=a&nbsp;z`</span><span class="op" id="8328182">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328185">}</span><span class="op" id="8328186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328193">&amp;</span><span class="ident" id="8328194">Cookie</span><span class="op" id="8328200">{</span><span class="ident" id="8328201">Name</span><span class="op" id="8328205">:</span>&nbsp;<span class="string" id="8328207">&#34;special-2&#34;</span><span class="op" id="8328218">,</span>&nbsp;<span class="ident" id="8328220">Value</span><span class="op" id="8328225">:</span>&nbsp;<span class="string" id="8328227">&#34;&nbsp;z&#34;</span><span class="op" id="8328231">}</span><span class="op" id="8328232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328236">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8328252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328255">}</span><span class="op" id="8328256">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328263">&amp;</span><span class="ident" id="8328264">Cookie</span><span class="op" id="8328270">{</span><span class="ident" id="8328271">Name</span><span class="op" id="8328275">:</span>&nbsp;<span class="string" id="8328277">&#34;special-3&#34;</span><span class="op" id="8328288">,</span>&nbsp;<span class="ident" id="8328290">Value</span><span class="op" id="8328295">:</span>&nbsp;<span class="string" id="8328297">&#34;a&nbsp;&#34;</span><span class="op" id="8328301">}</span><span class="op" id="8328302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328306">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8328322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328325">}</span><span class="op" id="8328326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328329">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328333">&amp;</span><span class="ident" id="8328334">Cookie</span><span class="op" id="8328340">{</span><span class="ident" id="8328341">Name</span><span class="op" id="8328345">:</span>&nbsp;<span class="string" id="8328347">&#34;special-4&#34;</span><span class="op" id="8328358">,</span>&nbsp;<span class="ident" id="8328360">Value</span><span class="op" id="8328365">:</span>&nbsp;<span class="string" id="8328367">&#34;&nbsp;&#34;</span><span class="op" id="8328370">}</span><span class="op" id="8328371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328375">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8328390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328393">}</span><span class="op" id="8328394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328401">&amp;</span><span class="ident" id="8328402">Cookie</span><span class="op" id="8328408">{</span><span class="ident" id="8328409">Name</span><span class="op" id="8328413">:</span>&nbsp;<span class="string" id="8328415">&#34;special-5&#34;</span><span class="op" id="8328426">,</span>&nbsp;<span class="ident" id="8328428">Value</span><span class="op" id="8328433">:</span>&nbsp;<span class="string" id="8328435">&#34;a,z&#34;</span><span class="op" id="8328440">}</span><span class="op" id="8328441">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328445">`special-5=a,z`</span><span class="op" id="8328460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328463">}</span><span class="op" id="8328464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328471">&amp;</span><span class="ident" id="8328472">Cookie</span><span class="op" id="8328478">{</span><span class="ident" id="8328479">Name</span><span class="op" id="8328483">:</span>&nbsp;<span class="string" id="8328485">&#34;special-6&#34;</span><span class="op" id="8328496">,</span>&nbsp;<span class="ident" id="8328498">Value</span><span class="op" id="8328503">:</span>&nbsp;<span class="string" id="8328505">&#34;,z&#34;</span><span class="op" id="8328509">}</span><span class="op" id="8328510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328514">`special-6=&#34;,z&#34;`</span><span class="op" id="8328530">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328533">}</span><span class="op" id="8328534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328541">&amp;</span><span class="ident" id="8328542">Cookie</span><span class="op" id="8328548">{</span><span class="ident" id="8328549">Name</span><span class="op" id="8328553">:</span>&nbsp;<span class="string" id="8328555">&#34;special-7&#34;</span><span class="op" id="8328566">,</span>&nbsp;<span class="ident" id="8328568">Value</span><span class="op" id="8328573">:</span>&nbsp;<span class="string" id="8328575">&#34;a,&#34;</span><span class="op" id="8328579">}</span><span class="op" id="8328580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328584">`special-7=&#34;a,&#34;`</span><span class="op" id="8328600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328603">}</span><span class="op" id="8328604">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328611">&amp;</span><span class="ident" id="8328612">Cookie</span><span class="op" id="8328618">{</span><span class="ident" id="8328619">Name</span><span class="op" id="8328623">:</span>&nbsp;<span class="string" id="8328625">&#34;special-8&#34;</span><span class="op" id="8328636">,</span>&nbsp;<span class="ident" id="8328638">Value</span><span class="op" id="8328643">:</span>&nbsp;<span class="string" id="8328645">&#34;,&#34;</span><span class="op" id="8328648">}</span><span class="op" id="8328649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328653">`special-8=&#34;,&#34;`</span><span class="op" id="8328668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328671">}</span><span class="op" id="8328672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328675">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328679">&amp;</span><span class="ident" id="8328680">Cookie</span><span class="op" id="8328686">{</span><span class="ident" id="8328687">Name</span><span class="op" id="8328691">:</span>&nbsp;<span class="string" id="8328693">&#34;empty-value&#34;</span><span class="op" id="8328706">,</span>&nbsp;<span class="ident" id="8328708">Value</span><span class="op" id="8328713">:</span>&nbsp;<span class="string" id="8328715">&#34;&#34;</span><span class="op" id="8328717">}</span><span class="op" id="8328718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8328722">`empty-value=`</span><span class="op" id="8328736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8328739">}</span><span class="op" id="8328740">,</span><br>
<span class="lineno"></span><span class="op" id="8328742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="8328745">func</span>&nbsp;<span class="ident" id="8328750">TestWriteSetCookies</span><span class="op" id="8328769">(</span><span class="ident" id="8328770">t</span>&nbsp;<span class="op" id="8328772">*</span><span class="ident" id="8328773">testing</span><span class="op" id="8328780">.</span><span class="ident" id="8328781">T</span><span class="op" id="8328782">)</span>&nbsp;<span class="op" id="8328784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8328787">defer</span>&nbsp;<span class="ident" id="8328793">log</span><span class="op" id="8328796">.</span><span class="ident" id="8328797">SetOutput</span><span class="op" id="8328806">(</span><span class="ident" id="8328807">os</span><span class="op" id="8328809">.</span><span class="ident" id="8328810">Stderr</span><span class="op" id="8328816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8328819">var</span>&nbsp;<span class="ident" id="8328823">logbuf</span>&nbsp;<span class="ident" id="8328830">bytes</span><span class="op" id="8328835">.</span><span class="ident" id="8328836">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8328844">log</span><span class="op" id="8328847">.</span><span class="ident" id="8328848">SetOutput</span><span class="op" id="8328857">(</span><span class="op" id="8328858">&amp;</span><span class="ident" id="8328859">logbuf</span><span class="op" id="8328865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8328869">for</span>&nbsp;<span class="ident" id="8328873">i</span><span class="op" id="8328874">,</span>&nbsp;<span class="ident" id="8328876">tt</span>&nbsp;<span class="op" id="8328879">:=</span>&nbsp;<span class="keyword" id="8328882">range</span>&nbsp;<span class="ident" id="8328888">writeSetCookiesTests</span>&nbsp;<span class="op" id="8328909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8328913">if</span>&nbsp;<span class="ident" id="8328916">g</span><span class="op" id="8328917">,</span>&nbsp;<span class="ident" id="8328919">e</span>&nbsp;<span class="op" id="8328921">:=</span>&nbsp;<span class="ident" id="8328924">tt</span><span class="op" id="8328926">.</span><span class="ident" id="8328927">Cookie</span><span class="op" id="8328933">.</span><span class="ident" id="8328934">String</span><span class="op" id="8328940">(</span><span class="op" id="8328941">)</span><span class="op" id="8328942">,</span>&nbsp;<span class="ident" id="8328944">tt</span><span class="op" id="8328946">.</span><span class="ident" id="8328947">Raw</span><span class="op" id="8328950">;</span>&nbsp;<span class="ident" id="8328952">g</span>&nbsp;<span class="op" id="8328954">!=</span>&nbsp;<span class="ident" id="8328957">e</span>&nbsp;<span class="op" id="8328959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8328964">t</span><span class="op" id="8328965">.</span><span class="ident" id="8328966">Errorf</span><span class="op" id="8328972">(</span><span class="string" id="8328973">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8329010">,</span>&nbsp;<span class="ident" id="8329012">i</span><span class="op" id="8329013">,</span>&nbsp;<span class="ident" id="8329015">e</span><span class="op" id="8329016">,</span>&nbsp;<span class="ident" id="8329018">g</span><span class="op" id="8329019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8329024">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8329035">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8329038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8329042">if</span>&nbsp;<span class="ident" id="8329045">got</span><span class="op" id="8329048">,</span>&nbsp;<span class="ident" id="8329050">sub</span>&nbsp;<span class="op" id="8329054">:=</span>&nbsp;<span class="ident" id="8329057">logbuf</span><span class="op" id="8329063">.</span><span class="ident" id="8329064">String</span><span class="op" id="8329070">(</span><span class="op" id="8329071">)</span><span class="op" id="8329072">,</span>&nbsp;<span class="string" id="8329074">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="8329101">;</span>&nbsp;<span class="op" id="8329103">!</span><span class="ident" id="8329104">strings</span><span class="op" id="8329111">.</span><span class="ident" id="8329112">Contains</span><span class="op" id="8329120">(</span><span class="ident" id="8329121">got</span><span class="op" id="8329124">,</span>&nbsp;<span class="ident" id="8329126">sub</span><span class="op" id="8329129">)</span>&nbsp;<span class="op" id="8329131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8329135">t</span><span class="op" id="8329136">.</span><span class="ident" id="8329137">Errorf</span><span class="op" id="8329143">(</span><span class="string" id="8329144">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8329191">,</span>&nbsp;<span class="ident" id="8329193">sub</span><span class="op" id="8329196">,</span>&nbsp;<span class="ident" id="8329198">got</span><span class="op" id="8329201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8329204">}</span><br>
<span class="lineno">110</span><span class="op" id="8329206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8329209">type</span>&nbsp;<span class="ident" id="8329214">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="8329239">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8329247">func</span>&nbsp;<span class="op" id="8329252">(</span><span class="ident" id="8329253">ho</span>&nbsp;<span class="ident" id="8329256">headerOnlyResponseWriter</span><span class="op" id="8329280">)</span>&nbsp;<span class="ident" id="8329282">Header</span><span class="op" id="8329288">(</span><span class="op" id="8329289">)</span>&nbsp;<span class="ident" id="8329291">Header</span>&nbsp;<span class="op" id="8329298">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8329301">return</span>&nbsp;<span class="ident" id="8329308">Header</span><span class="op" id="8329314">(</span><span class="ident" id="8329315">ho</span><span class="op" id="8329317">)</span><br>
<span class="lineno"></span><span class="op" id="8329319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8329322">func</span>&nbsp;<span class="op" id="8329327">(</span><span class="ident" id="8329328">ho</span>&nbsp;<span class="ident" id="8329331">headerOnlyResponseWriter</span><span class="op" id="8329355">)</span>&nbsp;<span class="ident" id="8329357">Write</span><span class="op" id="8329362">(</span><span class="op" id="8329363">[</span><span class="op" id="8329364">]</span><span class="builtintype" id="8329365">byte</span><span class="op" id="8329369">)</span>&nbsp;<span class="op" id="8329371">(</span><span class="builtintype" id="8329372">int</span><span class="op" id="8329375">,</span>&nbsp;<span class="builtintype" id="8329377">error</span><span class="op" id="8329382">)</span>&nbsp;<span class="op" id="8329384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8329387">panic</span><span class="op" id="8329392">(</span><span class="string" id="8329393">&#34;NOIMPL&#34;</span><span class="op" id="8329401">)</span><br>
<span class="lineno">120</span><span class="op" id="8329403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8329406">func</span>&nbsp;<span class="op" id="8329411">(</span><span class="ident" id="8329412">ho</span>&nbsp;<span class="ident" id="8329415">headerOnlyResponseWriter</span><span class="op" id="8329439">)</span>&nbsp;<span class="ident" id="8329441">WriteHeader</span><span class="op" id="8329452">(</span><span class="builtintype" id="8329453">int</span><span class="op" id="8329456">)</span>&nbsp;<span class="op" id="8329458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8329461">panic</span><span class="op" id="8329466">(</span><span class="string" id="8329467">&#34;NOIMPL&#34;</span><span class="op" id="8329475">)</span><br>
<span class="lineno"></span><span class="op" id="8329477">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8329480">func</span>&nbsp;<span class="ident" id="8329485">TestSetCookie</span><span class="op" id="8329498">(</span><span class="ident" id="8329499">t</span>&nbsp;<span class="op" id="8329501">*</span><span class="ident" id="8329502">testing</span><span class="op" id="8329509">.</span><span class="ident" id="8329510">T</span><span class="op" id="8329511">)</span>&nbsp;<span class="op" id="8329513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8329516">m</span>&nbsp;<span class="op" id="8329518">:=</span>&nbsp;<span class="builtinfunc" id="8329521">make</span><span class="op" id="8329525">(</span><span class="ident" id="8329526">Header</span><span class="op" id="8329532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8329535">SetCookie</span><span class="op" id="8329544">(</span><span class="ident" id="8329545">headerOnlyResponseWriter</span><span class="op" id="8329569">(</span><span class="ident" id="8329570">m</span><span class="op" id="8329571">)</span><span class="op" id="8329572">,</span>&nbsp;<span class="op" id="8329574">&amp;</span><span class="ident" id="8329575">Cookie</span><span class="op" id="8329581">{</span><span class="ident" id="8329582">Name</span><span class="op" id="8329586">:</span>&nbsp;<span class="string" id="8329588">&#34;cookie-1&#34;</span><span class="op" id="8329598">,</span>&nbsp;<span class="ident" id="8329600">Value</span><span class="op" id="8329605">:</span>&nbsp;<span class="string" id="8329607">&#34;one&#34;</span><span class="op" id="8329612">,</span>&nbsp;<span class="ident" id="8329614">Path</span><span class="op" id="8329618">:</span>&nbsp;<span class="string" id="8329620">&#34;/restricted/&#34;</span><span class="op" id="8329634">}</span><span class="op" id="8329635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8329638">SetCookie</span><span class="op" id="8329647">(</span><span class="ident" id="8329648">headerOnlyResponseWriter</span><span class="op" id="8329672">(</span><span class="ident" id="8329673">m</span><span class="op" id="8329674">)</span><span class="op" id="8329675">,</span>&nbsp;<span class="op" id="8329677">&amp;</span><span class="ident" id="8329678">Cookie</span><span class="op" id="8329684">{</span><span class="ident" id="8329685">Name</span><span class="op" id="8329689">:</span>&nbsp;<span class="string" id="8329691">&#34;cookie-2&#34;</span><span class="op" id="8329701">,</span>&nbsp;<span class="ident" id="8329703">Value</span><span class="op" id="8329708">:</span>&nbsp;<span class="string" id="8329710">&#34;two&#34;</span><span class="op" id="8329715">,</span>&nbsp;<span class="ident" id="8329717">MaxAge</span><span class="op" id="8329723">:</span>&nbsp;<span class="num" id="8329725">3600</span><span class="op" id="8329729">}</span><span class="op" id="8329730">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8329733">if</span>&nbsp;<span class="ident" id="8329736">l</span>&nbsp;<span class="op" id="8329738">:=</span>&nbsp;<span class="builtinfunc" id="8329741">len</span><span class="op" id="8329744">(</span><span class="ident" id="8329745">m</span><span class="op" id="8329746">[</span><span class="string" id="8329747">&#34;Set-Cookie&#34;</span><span class="op" id="8329759">]</span><span class="op" id="8329760">)</span><span class="op" id="8329761">;</span>&nbsp;<span class="ident" id="8329763">l</span>&nbsp;<span class="op" id="8329765">!=</span>&nbsp;<span class="num" id="8329768">2</span>&nbsp;<span class="op" id="8329770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8329774">t</span><span class="op" id="8329775">.</span><span class="ident" id="8329776">Fatalf</span><span class="op" id="8329782">(</span><span class="string" id="8329783">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8329812">,</span>&nbsp;<span class="num" id="8329814">2</span><span class="op" id="8329815">,</span>&nbsp;<span class="ident" id="8329817">l</span><span class="op" id="8329818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8329821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8329824">if</span>&nbsp;<span class="ident" id="8329827">g</span><span class="op" id="8329828">,</span>&nbsp;<span class="ident" id="8329830">e</span>&nbsp;<span class="op" id="8329832">:=</span>&nbsp;<span class="ident" id="8329835">m</span><span class="op" id="8329836">[</span><span class="string" id="8329837">&#34;Set-Cookie&#34;</span><span class="op" id="8329849">]</span><span class="op" id="8329850">[</span><span class="num" id="8329851">0</span><span class="op" id="8329852">]</span><span class="op" id="8329853">,</span>&nbsp;<span class="string" id="8329855">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="8329888">;</span>&nbsp;<span class="ident" id="8329890">g</span>&nbsp;<span class="op" id="8329892">!=</span>&nbsp;<span class="ident" id="8329895">e</span>&nbsp;<span class="op" id="8329897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8329901">t</span><span class="op" id="8329902">.</span><span class="ident" id="8329903">Errorf</span><span class="op" id="8329909">(</span><span class="string" id="8329910">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8329938">,</span>&nbsp;<span class="ident" id="8329940">e</span><span class="op" id="8329941">,</span>&nbsp;<span class="ident" id="8329943">g</span><span class="op" id="8329944">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8329947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8329950">if</span>&nbsp;<span class="ident" id="8329953">g</span><span class="op" id="8329954">,</span>&nbsp;<span class="ident" id="8329956">e</span>&nbsp;<span class="op" id="8329958">:=</span>&nbsp;<span class="ident" id="8329961">m</span><span class="op" id="8329962">[</span><span class="string" id="8329963">&#34;Set-Cookie&#34;</span><span class="op" id="8329975">]</span><span class="op" id="8329976">[</span><span class="num" id="8329977">1</span><span class="op" id="8329978">]</span><span class="op" id="8329979">,</span>&nbsp;<span class="string" id="8329981">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="8330009">;</span>&nbsp;<span class="ident" id="8330011">g</span>&nbsp;<span class="op" id="8330013">!=</span>&nbsp;<span class="ident" id="8330016">e</span>&nbsp;<span class="op" id="8330018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330022">t</span><span class="op" id="8330023">.</span><span class="ident" id="8330024">Errorf</span><span class="op" id="8330030">(</span><span class="string" id="8330031">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8330059">,</span>&nbsp;<span class="ident" id="8330061">e</span><span class="op" id="8330062">,</span>&nbsp;<span class="ident" id="8330064">g</span><span class="op" id="8330065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330068">}</span><br>
<span class="lineno"></span><span class="op" id="8330070">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8330073">var</span>&nbsp;<span class="ident" id="8330077">addCookieTests</span>&nbsp;<span class="op" id="8330092">=</span>&nbsp;<span class="op" id="8330094">[</span><span class="op" id="8330095">]</span><span class="keyword" id="8330096">struct</span>&nbsp;<span class="op" id="8330103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330106">Cookies</span>&nbsp;<span class="op" id="8330114">[</span><span class="op" id="8330115">]</span><span class="op" id="8330116">*</span><span class="ident" id="8330117">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330125">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8330133">string</span><br>
<span class="lineno"></span><span class="op" id="8330140">}</span><span class="op" id="8330141">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330148">[</span><span class="op" id="8330149">]</span><span class="op" id="8330150">*</span><span class="ident" id="8330151">Cookie</span><span class="op" id="8330157">{</span><span class="op" id="8330158">}</span><span class="op" id="8330159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8330163">&#34;&#34;</span><span class="op" id="8330165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330168">}</span><span class="op" id="8330169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330172">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330176">[</span><span class="op" id="8330177">]</span><span class="op" id="8330178">*</span><span class="ident" id="8330179">Cookie</span><span class="op" id="8330185">{</span><span class="op" id="8330186">{</span><span class="ident" id="8330187">Name</span><span class="op" id="8330191">:</span>&nbsp;<span class="string" id="8330193">&#34;cookie-1&#34;</span><span class="op" id="8330203">,</span>&nbsp;<span class="ident" id="8330205">Value</span><span class="op" id="8330210">:</span>&nbsp;<span class="string" id="8330212">&#34;v$1&#34;</span><span class="op" id="8330217">}</span><span class="op" id="8330218">}</span><span class="op" id="8330219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8330223">&#34;cookie-1=v$1&#34;</span><span class="op" id="8330237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330240">}</span><span class="op" id="8330241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330248">[</span><span class="op" id="8330249">]</span><span class="op" id="8330250">*</span><span class="ident" id="8330251">Cookie</span><span class="op" id="8330257">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330262">{</span><span class="ident" id="8330263">Name</span><span class="op" id="8330267">:</span>&nbsp;<span class="string" id="8330269">&#34;cookie-1&#34;</span><span class="op" id="8330279">,</span>&nbsp;<span class="ident" id="8330281">Value</span><span class="op" id="8330286">:</span>&nbsp;<span class="string" id="8330288">&#34;v$1&#34;</span><span class="op" id="8330293">}</span><span class="op" id="8330294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330299">{</span><span class="ident" id="8330300">Name</span><span class="op" id="8330304">:</span>&nbsp;<span class="string" id="8330306">&#34;cookie-2&#34;</span><span class="op" id="8330316">,</span>&nbsp;<span class="ident" id="8330318">Value</span><span class="op" id="8330323">:</span>&nbsp;<span class="string" id="8330325">&#34;v$2&#34;</span><span class="op" id="8330330">}</span><span class="op" id="8330331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330336">{</span><span class="ident" id="8330337">Name</span><span class="op" id="8330341">:</span>&nbsp;<span class="string" id="8330343">&#34;cookie-3&#34;</span><span class="op" id="8330353">,</span>&nbsp;<span class="ident" id="8330355">Value</span><span class="op" id="8330360">:</span>&nbsp;<span class="string" id="8330362">&#34;v$3&#34;</span><span class="op" id="8330367">}</span><span class="op" id="8330368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330372">}</span><span class="op" id="8330373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8330377">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="8330419">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330422">}</span><span class="op" id="8330423">,</span><br>
<span class="lineno"></span><span class="op" id="8330425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8330428">func</span>&nbsp;<span class="ident" id="8330433">TestAddCookie</span><span class="op" id="8330446">(</span><span class="ident" id="8330447">t</span>&nbsp;<span class="op" id="8330449">*</span><span class="ident" id="8330450">testing</span><span class="op" id="8330457">.</span><span class="ident" id="8330458">T</span><span class="op" id="8330459">)</span>&nbsp;<span class="op" id="8330461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8330464">for</span>&nbsp;<span class="ident" id="8330468">i</span><span class="op" id="8330469">,</span>&nbsp;<span class="ident" id="8330471">tt</span>&nbsp;<span class="op" id="8330474">:=</span>&nbsp;<span class="keyword" id="8330477">range</span>&nbsp;<span class="ident" id="8330483">addCookieTests</span>&nbsp;<span class="op" id="8330498">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330502">req</span><span class="op" id="8330505">,</span>&nbsp;<span class="ident" id="8330507">_</span>&nbsp;<span class="op" id="8330509">:=</span>&nbsp;<span class="ident" id="8330512">NewRequest</span><span class="op" id="8330522">(</span><span class="string" id="8330523">&#34;GET&#34;</span><span class="op" id="8330528">,</span>&nbsp;<span class="string" id="8330530">&#34;http://example.com/&#34;</span><span class="op" id="8330551">,</span>&nbsp;<span class="ident" id="8330553">nil</span><span class="op" id="8330556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8330560">for</span>&nbsp;<span class="ident" id="8330564">_</span><span class="op" id="8330565">,</span>&nbsp;<span class="ident" id="8330567">c</span>&nbsp;<span class="op" id="8330569">:=</span>&nbsp;<span class="keyword" id="8330572">range</span>&nbsp;<span class="ident" id="8330578">tt</span><span class="op" id="8330580">.</span><span class="ident" id="8330581">Cookies</span>&nbsp;<span class="op" id="8330589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330594">req</span><span class="op" id="8330597">.</span><span class="ident" id="8330598">AddCookie</span><span class="op" id="8330607">(</span><span class="ident" id="8330608">c</span><span class="op" id="8330609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8330617">if</span>&nbsp;<span class="ident" id="8330620">g</span>&nbsp;<span class="op" id="8330622">:=</span>&nbsp;<span class="ident" id="8330625">req</span><span class="op" id="8330628">.</span><span class="ident" id="8330629">Header</span><span class="op" id="8330635">.</span><span class="ident" id="8330636">Get</span><span class="op" id="8330639">(</span><span class="string" id="8330640">&#34;Cookie&#34;</span><span class="op" id="8330648">)</span><span class="op" id="8330649">;</span>&nbsp;<span class="ident" id="8330651">g</span>&nbsp;<span class="op" id="8330653">!=</span>&nbsp;<span class="ident" id="8330656">tt</span><span class="op" id="8330658">.</span><span class="ident" id="8330659">Raw</span>&nbsp;<span class="op" id="8330663">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330668">t</span><span class="op" id="8330669">.</span><span class="ident" id="8330670">Errorf</span><span class="op" id="8330676">(</span><span class="string" id="8330677">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="8330709">,</span>&nbsp;<span class="ident" id="8330711">i</span><span class="op" id="8330712">,</span>&nbsp;<span class="ident" id="8330714">tt</span><span class="op" id="8330716">.</span><span class="ident" id="8330717">Raw</span><span class="op" id="8330720">,</span>&nbsp;<span class="ident" id="8330722">g</span><span class="op" id="8330723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8330728">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330742">}</span><br>
<span class="lineno"></span><span class="op" id="8330744">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8330747">var</span>&nbsp;<span class="ident" id="8330751">readSetCookiesTests</span>&nbsp;<span class="op" id="8330771">=</span>&nbsp;<span class="op" id="8330773">[</span><span class="op" id="8330774">]</span><span class="keyword" id="8330775">struct</span>&nbsp;<span class="op" id="8330782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330785">Header</span>&nbsp;&nbsp;<span class="ident" id="8330793">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330801">Cookies</span>&nbsp;<span class="op" id="8330809">[</span><span class="op" id="8330810">]</span><span class="op" id="8330811">*</span><span class="ident" id="8330812">Cookie</span><br>
<span class="lineno"></span><span class="op" id="8330819">}</span><span class="op" id="8330820">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330827">Header</span><span class="op" id="8330833">{</span><span class="string" id="8330834">&#34;Set-Cookie&#34;</span><span class="op" id="8330846">:</span>&nbsp;<span class="op" id="8330848">{</span><span class="string" id="8330849">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8330863">}</span><span class="op" id="8330864">}</span><span class="op" id="8330865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330869">[</span><span class="op" id="8330870">]</span><span class="op" id="8330871">*</span><span class="ident" id="8330872">Cookie</span><span class="op" id="8330878">{</span><span class="op" id="8330879">{</span><span class="ident" id="8330880">Name</span><span class="op" id="8330884">:</span>&nbsp;<span class="string" id="8330886">&#34;Cookie-1&#34;</span><span class="op" id="8330896">,</span>&nbsp;<span class="ident" id="8330898">Value</span><span class="op" id="8330903">:</span>&nbsp;<span class="string" id="8330905">&#34;v$1&#34;</span><span class="op" id="8330910">,</span>&nbsp;<span class="ident" id="8330912">Raw</span><span class="op" id="8330915">:</span>&nbsp;<span class="string" id="8330917">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8330931">}</span><span class="op" id="8330932">}</span><span class="op" id="8330933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330936">}</span><span class="op" id="8330937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8330940">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8330944">Header</span><span class="op" id="8330950">{</span><span class="string" id="8330951">&#34;Set-Cookie&#34;</span><span class="op" id="8330963">:</span>&nbsp;<span class="op" id="8330965">{</span><span class="string" id="8330966">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="8331065">}</span><span class="op" id="8331066">}</span><span class="op" id="8331067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331071">[</span><span class="op" id="8331072">]</span><span class="op" id="8331073">*</span><span class="ident" id="8331074">Cookie</span><span class="op" id="8331080">{</span><span class="op" id="8331081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331086">Name</span><span class="op" id="8331090">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331098">&#34;NID&#34;</span><span class="op" id="8331103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331108">Value</span><span class="op" id="8331113">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331120">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="8331139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331144">Path</span><span class="op" id="8331148">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331156">&#34;/&#34;</span><span class="op" id="8331159">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331164">Domain</span><span class="op" id="8331170">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331176">&#34;.google.ch&#34;</span><span class="op" id="8331188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331193">HttpOnly</span><span class="op" id="8331201">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8331205">true</span><span class="op" id="8331209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331214">Expires</span><span class="op" id="8331221">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8331226">time</span><span class="op" id="8331230">.</span><span class="ident" id="8331231">Date</span><span class="op" id="8331235">(</span><span class="num" id="8331236">2011</span><span class="op" id="8331240">,</span>&nbsp;<span class="num" id="8331242">11</span><span class="op" id="8331244">,</span>&nbsp;<span class="num" id="8331246">23</span><span class="op" id="8331248">,</span>&nbsp;<span class="num" id="8331250">1</span><span class="op" id="8331251">,</span>&nbsp;<span class="num" id="8331253">5</span><span class="op" id="8331254">,</span>&nbsp;<span class="num" id="8331256">3</span><span class="op" id="8331257">,</span>&nbsp;<span class="num" id="8331259">0</span><span class="op" id="8331260">,</span>&nbsp;<span class="ident" id="8331262">time</span><span class="op" id="8331266">.</span><span class="ident" id="8331267">UTC</span><span class="op" id="8331270">)</span><span class="op" id="8331271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331276">RawExpires</span><span class="op" id="8331286">:</span>&nbsp;<span class="string" id="8331288">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="8331319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331324">Raw</span><span class="op" id="8331327">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331336">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="8331435">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331439">}</span><span class="op" id="8331440">}</span><span class="op" id="8331441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331444">}</span><span class="op" id="8331445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331452">Header</span><span class="op" id="8331458">{</span><span class="string" id="8331459">&#34;Set-Cookie&#34;</span><span class="op" id="8331471">:</span>&nbsp;<span class="op" id="8331473">{</span><span class="string" id="8331474">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8331548">}</span><span class="op" id="8331549">}</span><span class="op" id="8331550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331554">[</span><span class="op" id="8331555">]</span><span class="op" id="8331556">*</span><span class="ident" id="8331557">Cookie</span><span class="op" id="8331563">{</span><span class="op" id="8331564">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331569">Name</span><span class="op" id="8331573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331581">&#34;.ASPXAUTH&#34;</span><span class="op" id="8331592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331597">Value</span><span class="op" id="8331602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331609">&#34;7E3AA&#34;</span><span class="op" id="8331616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331621">Path</span><span class="op" id="8331625">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331633">&#34;/&#34;</span><span class="op" id="8331636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331641">Expires</span><span class="op" id="8331648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8331653">time</span><span class="op" id="8331657">.</span><span class="ident" id="8331658">Date</span><span class="op" id="8331662">(</span><span class="num" id="8331663">2012</span><span class="op" id="8331667">,</span>&nbsp;<span class="num" id="8331669">3</span><span class="op" id="8331670">,</span>&nbsp;<span class="num" id="8331672">7</span><span class="op" id="8331673">,</span>&nbsp;<span class="num" id="8331675">14</span><span class="op" id="8331677">,</span>&nbsp;<span class="num" id="8331679">25</span><span class="op" id="8331681">,</span>&nbsp;<span class="num" id="8331683">6</span><span class="op" id="8331684">,</span>&nbsp;<span class="num" id="8331686">0</span><span class="op" id="8331687">,</span>&nbsp;<span class="ident" id="8331689">time</span><span class="op" id="8331693">.</span><span class="ident" id="8331694">UTC</span><span class="op" id="8331697">)</span><span class="op" id="8331698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331703">RawExpires</span><span class="op" id="8331713">:</span>&nbsp;<span class="string" id="8331715">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="8331746">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331751">HttpOnly</span><span class="op" id="8331759">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8331763">true</span><span class="op" id="8331767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331772">Raw</span><span class="op" id="8331775">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331784">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8331858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331862">}</span><span class="op" id="8331863">}</span><span class="op" id="8331864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331867">}</span><span class="op" id="8331868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331871">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331875">Header</span><span class="op" id="8331881">{</span><span class="string" id="8331882">&#34;Set-Cookie&#34;</span><span class="op" id="8331894">:</span>&nbsp;<span class="op" id="8331896">{</span><span class="string" id="8331897">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8331938">}</span><span class="op" id="8331939">}</span><span class="op" id="8331940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8331944">[</span><span class="op" id="8331945">]</span><span class="op" id="8331946">*</span><span class="ident" id="8331947">Cookie</span><span class="op" id="8331953">{</span><span class="op" id="8331954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331959">Name</span><span class="op" id="8331963">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8331969">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="8331988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8331993">Value</span><span class="op" id="8331998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8332003">&#34;foo&#34;</span><span class="op" id="8332008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332013">Path</span><span class="op" id="8332017">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8332023">&#34;/&#34;</span><span class="op" id="8332026">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332031">HttpOnly</span><span class="op" id="8332039">:</span>&nbsp;<span class="builtintype" id="8332041">true</span><span class="op" id="8332045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332050">Raw</span><span class="op" id="8332053">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8332060">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8332101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332105">}</span><span class="op" id="8332106">}</span><span class="op" id="8332107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332110">}</span><span class="op" id="8332111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8332114">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8332187">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332235">Header</span><span class="op" id="8332241">{</span><span class="string" id="8332242">&#34;Set-Cookie&#34;</span><span class="op" id="8332254">:</span>&nbsp;<span class="op" id="8332256">{</span><span class="string" id="8332257">`special-1=a&nbsp;z`</span><span class="op" id="8332272">}</span><span class="op" id="8332273">}</span><span class="op" id="8332274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332278">[</span><span class="op" id="8332279">]</span><span class="op" id="8332280">*</span><span class="ident" id="8332281">Cookie</span><span class="op" id="8332287">{</span><span class="op" id="8332288">{</span><span class="ident" id="8332289">Name</span><span class="op" id="8332293">:</span>&nbsp;<span class="string" id="8332295">&#34;special-1&#34;</span><span class="op" id="8332306">,</span>&nbsp;<span class="ident" id="8332308">Value</span><span class="op" id="8332313">:</span>&nbsp;<span class="string" id="8332315">&#34;a&nbsp;z&#34;</span><span class="op" id="8332320">,</span>&nbsp;<span class="ident" id="8332322">Raw</span><span class="op" id="8332325">:</span>&nbsp;<span class="string" id="8332327">`special-1=a&nbsp;z`</span><span class="op" id="8332342">}</span><span class="op" id="8332343">}</span><span class="op" id="8332344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332347">}</span><span class="op" id="8332348">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332355">Header</span><span class="op" id="8332361">{</span><span class="string" id="8332362">&#34;Set-Cookie&#34;</span><span class="op" id="8332374">:</span>&nbsp;<span class="op" id="8332376">{</span><span class="string" id="8332377">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8332393">}</span><span class="op" id="8332394">}</span><span class="op" id="8332395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332399">[</span><span class="op" id="8332400">]</span><span class="op" id="8332401">*</span><span class="ident" id="8332402">Cookie</span><span class="op" id="8332408">{</span><span class="op" id="8332409">{</span><span class="ident" id="8332410">Name</span><span class="op" id="8332414">:</span>&nbsp;<span class="string" id="8332416">&#34;special-2&#34;</span><span class="op" id="8332427">,</span>&nbsp;<span class="ident" id="8332429">Value</span><span class="op" id="8332434">:</span>&nbsp;<span class="string" id="8332436">&#34;&nbsp;z&#34;</span><span class="op" id="8332440">,</span>&nbsp;<span class="ident" id="8332442">Raw</span><span class="op" id="8332445">:</span>&nbsp;<span class="string" id="8332447">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8332463">}</span><span class="op" id="8332464">}</span><span class="op" id="8332465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332468">}</span><span class="op" id="8332469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332472">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332476">Header</span><span class="op" id="8332482">{</span><span class="string" id="8332483">&#34;Set-Cookie&#34;</span><span class="op" id="8332495">:</span>&nbsp;<span class="op" id="8332497">{</span><span class="string" id="8332498">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8332514">}</span><span class="op" id="8332515">}</span><span class="op" id="8332516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332520">[</span><span class="op" id="8332521">]</span><span class="op" id="8332522">*</span><span class="ident" id="8332523">Cookie</span><span class="op" id="8332529">{</span><span class="op" id="8332530">{</span><span class="ident" id="8332531">Name</span><span class="op" id="8332535">:</span>&nbsp;<span class="string" id="8332537">&#34;special-3&#34;</span><span class="op" id="8332548">,</span>&nbsp;<span class="ident" id="8332550">Value</span><span class="op" id="8332555">:</span>&nbsp;<span class="string" id="8332557">&#34;a&nbsp;&#34;</span><span class="op" id="8332561">,</span>&nbsp;<span class="ident" id="8332563">Raw</span><span class="op" id="8332566">:</span>&nbsp;<span class="string" id="8332568">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8332584">}</span><span class="op" id="8332585">}</span><span class="op" id="8332586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332589">}</span><span class="op" id="8332590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332597">Header</span><span class="op" id="8332603">{</span><span class="string" id="8332604">&#34;Set-Cookie&#34;</span><span class="op" id="8332616">:</span>&nbsp;<span class="op" id="8332618">{</span><span class="string" id="8332619">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8332634">}</span><span class="op" id="8332635">}</span><span class="op" id="8332636">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332640">[</span><span class="op" id="8332641">]</span><span class="op" id="8332642">*</span><span class="ident" id="8332643">Cookie</span><span class="op" id="8332649">{</span><span class="op" id="8332650">{</span><span class="ident" id="8332651">Name</span><span class="op" id="8332655">:</span>&nbsp;<span class="string" id="8332657">&#34;special-4&#34;</span><span class="op" id="8332668">,</span>&nbsp;<span class="ident" id="8332670">Value</span><span class="op" id="8332675">:</span>&nbsp;<span class="string" id="8332677">&#34;&nbsp;&#34;</span><span class="op" id="8332680">,</span>&nbsp;<span class="ident" id="8332682">Raw</span><span class="op" id="8332685">:</span>&nbsp;<span class="string" id="8332687">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8332702">}</span><span class="op" id="8332703">}</span><span class="op" id="8332704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332707">}</span><span class="op" id="8332708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332715">Header</span><span class="op" id="8332721">{</span><span class="string" id="8332722">&#34;Set-Cookie&#34;</span><span class="op" id="8332734">:</span>&nbsp;<span class="op" id="8332736">{</span><span class="string" id="8332737">`special-5=a,z`</span><span class="op" id="8332752">}</span><span class="op" id="8332753">}</span><span class="op" id="8332754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332758">[</span><span class="op" id="8332759">]</span><span class="op" id="8332760">*</span><span class="ident" id="8332761">Cookie</span><span class="op" id="8332767">{</span><span class="op" id="8332768">{</span><span class="ident" id="8332769">Name</span><span class="op" id="8332773">:</span>&nbsp;<span class="string" id="8332775">&#34;special-5&#34;</span><span class="op" id="8332786">,</span>&nbsp;<span class="ident" id="8332788">Value</span><span class="op" id="8332793">:</span>&nbsp;<span class="string" id="8332795">&#34;a,z&#34;</span><span class="op" id="8332800">,</span>&nbsp;<span class="ident" id="8332802">Raw</span><span class="op" id="8332805">:</span>&nbsp;<span class="string" id="8332807">`special-5=a,z`</span><span class="op" id="8332822">}</span><span class="op" id="8332823">}</span><span class="op" id="8332824">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332827">}</span><span class="op" id="8332828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332835">Header</span><span class="op" id="8332841">{</span><span class="string" id="8332842">&#34;Set-Cookie&#34;</span><span class="op" id="8332854">:</span>&nbsp;<span class="op" id="8332856">{</span><span class="string" id="8332857">`special-6=&#34;,z&#34;`</span><span class="op" id="8332873">}</span><span class="op" id="8332874">}</span><span class="op" id="8332875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332879">[</span><span class="op" id="8332880">]</span><span class="op" id="8332881">*</span><span class="ident" id="8332882">Cookie</span><span class="op" id="8332888">{</span><span class="op" id="8332889">{</span><span class="ident" id="8332890">Name</span><span class="op" id="8332894">:</span>&nbsp;<span class="string" id="8332896">&#34;special-6&#34;</span><span class="op" id="8332907">,</span>&nbsp;<span class="ident" id="8332909">Value</span><span class="op" id="8332914">:</span>&nbsp;<span class="string" id="8332916">&#34;,z&#34;</span><span class="op" id="8332920">,</span>&nbsp;<span class="ident" id="8332922">Raw</span><span class="op" id="8332925">:</span>&nbsp;<span class="string" id="8332927">`special-6=&#34;,z&#34;`</span><span class="op" id="8332943">}</span><span class="op" id="8332944">}</span><span class="op" id="8332945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332948">}</span><span class="op" id="8332949">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332956">Header</span><span class="op" id="8332962">{</span><span class="string" id="8332963">&#34;Set-Cookie&#34;</span><span class="op" id="8332975">:</span>&nbsp;<span class="op" id="8332977">{</span><span class="string" id="8332978">`special-7=a,`</span><span class="op" id="8332992">}</span><span class="op" id="8332993">}</span><span class="op" id="8332994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332998">[</span><span class="op" id="8332999">]</span><span class="op" id="8333000">*</span><span class="ident" id="8333001">Cookie</span><span class="op" id="8333007">{</span><span class="op" id="8333008">{</span><span class="ident" id="8333009">Name</span><span class="op" id="8333013">:</span>&nbsp;<span class="string" id="8333015">&#34;special-7&#34;</span><span class="op" id="8333026">,</span>&nbsp;<span class="ident" id="8333028">Value</span><span class="op" id="8333033">:</span>&nbsp;<span class="string" id="8333035">&#34;a,&#34;</span><span class="op" id="8333039">,</span>&nbsp;<span class="ident" id="8333041">Raw</span><span class="op" id="8333044">:</span>&nbsp;<span class="string" id="8333046">`special-7=a,`</span><span class="op" id="8333060">}</span><span class="op" id="8333061">}</span><span class="op" id="8333062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333065">}</span><span class="op" id="8333066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333069">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333073">Header</span><span class="op" id="8333079">{</span><span class="string" id="8333080">&#34;Set-Cookie&#34;</span><span class="op" id="8333092">:</span>&nbsp;<span class="op" id="8333094">{</span><span class="string" id="8333095">`special-8=&#34;,&#34;`</span><span class="op" id="8333110">}</span><span class="op" id="8333111">}</span><span class="op" id="8333112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333116">[</span><span class="op" id="8333117">]</span><span class="op" id="8333118">*</span><span class="ident" id="8333119">Cookie</span><span class="op" id="8333125">{</span><span class="op" id="8333126">{</span><span class="ident" id="8333127">Name</span><span class="op" id="8333131">:</span>&nbsp;<span class="string" id="8333133">&#34;special-8&#34;</span><span class="op" id="8333144">,</span>&nbsp;<span class="ident" id="8333146">Value</span><span class="op" id="8333151">:</span>&nbsp;<span class="string" id="8333153">&#34;,&#34;</span><span class="op" id="8333156">,</span>&nbsp;<span class="ident" id="8333158">Raw</span><span class="op" id="8333161">:</span>&nbsp;<span class="string" id="8333163">`special-8=&#34;,&#34;`</span><span class="op" id="8333178">}</span><span class="op" id="8333179">}</span><span class="op" id="8333180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333183">}</span><span class="op" id="8333184">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333188">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333247">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333310">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333374">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333385">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="8333529">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8333532">func</span>&nbsp;<span class="ident" id="8333537">toJSON</span><span class="op" id="8333543">(</span><span class="ident" id="8333544">v</span>&nbsp;<span class="keyword" id="8333546">interface</span><span class="op" id="8333555">{</span><span class="op" id="8333556">}</span><span class="op" id="8333557">)</span>&nbsp;<span class="builtintype" id="8333559">string</span>&nbsp;<span class="op" id="8333566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333569">b</span><span class="op" id="8333570">,</span>&nbsp;<span class="ident" id="8333572">err</span>&nbsp;<span class="op" id="8333576">:=</span>&nbsp;<span class="ident" id="8333579">json</span><span class="op" id="8333583">.</span><span class="ident" id="8333584">Marshal</span><span class="op" id="8333591">(</span><span class="ident" id="8333592">v</span><span class="op" id="8333593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333596">if</span>&nbsp;<span class="ident" id="8333599">err</span>&nbsp;<span class="op" id="8333603">!=</span>&nbsp;<span class="ident" id="8333606">nil</span>&nbsp;<span class="op" id="8333610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333614">return</span>&nbsp;<span class="ident" id="8333621">fmt</span><span class="op" id="8333624">.</span><span class="ident" id="8333625">Sprintf</span><span class="op" id="8333632">(</span><span class="string" id="8333633">&#34;%#v&#34;</span><span class="op" id="8333638">,</span>&nbsp;<span class="ident" id="8333640">v</span><span class="op" id="8333641">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333647">return</span>&nbsp;<span class="builtintype" id="8333654">string</span><span class="op" id="8333660">(</span><span class="ident" id="8333661">b</span><span class="op" id="8333662">)</span><br>
<span class="lineno"></span><span class="op" id="8333664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8333667">func</span>&nbsp;<span class="ident" id="8333672">TestReadSetCookies</span><span class="op" id="8333690">(</span><span class="ident" id="8333691">t</span>&nbsp;<span class="op" id="8333693">*</span><span class="ident" id="8333694">testing</span><span class="op" id="8333701">.</span><span class="ident" id="8333702">T</span><span class="op" id="8333703">)</span>&nbsp;<span class="op" id="8333705">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333708">for</span>&nbsp;<span class="ident" id="8333712">i</span><span class="op" id="8333713">,</span>&nbsp;<span class="ident" id="8333715">tt</span>&nbsp;<span class="op" id="8333718">:=</span>&nbsp;<span class="keyword" id="8333721">range</span>&nbsp;<span class="ident" id="8333727">readSetCookiesTests</span>&nbsp;<span class="op" id="8333747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333751">for</span>&nbsp;<span class="ident" id="8333755">n</span>&nbsp;<span class="op" id="8333757">:=</span>&nbsp;<span class="num" id="8333760">0</span><span class="op" id="8333761">;</span>&nbsp;<span class="ident" id="8333763">n</span>&nbsp;<span class="op" id="8333765">&lt;</span>&nbsp;<span class="num" id="8333767">2</span><span class="op" id="8333768">;</span>&nbsp;<span class="ident" id="8333770">n</span><span class="op" id="8333771">++</span>&nbsp;<span class="op" id="8333774">{</span>&nbsp;<span class="comment" id="8333776">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333832">c</span>&nbsp;<span class="op" id="8333834">:=</span>&nbsp;<span class="ident" id="8333837">readSetCookies</span><span class="op" id="8333851">(</span><span class="ident" id="8333852">tt</span><span class="op" id="8333854">.</span><span class="ident" id="8333855">Header</span><span class="op" id="8333861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333866">if</span>&nbsp;<span class="op" id="8333869">!</span><span class="ident" id="8333870">reflect</span><span class="op" id="8333877">.</span><span class="ident" id="8333878">DeepEqual</span><span class="op" id="8333887">(</span><span class="ident" id="8333888">c</span><span class="op" id="8333889">,</span>&nbsp;<span class="ident" id="8333891">tt</span><span class="op" id="8333893">.</span><span class="ident" id="8333894">Cookies</span><span class="op" id="8333901">)</span>&nbsp;<span class="op" id="8333903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333909">t</span><span class="op" id="8333910">.</span><span class="ident" id="8333911">Errorf</span><span class="op" id="8333917">(</span><span class="string" id="8333918">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="8333960">,</span>&nbsp;<span class="ident" id="8333962">i</span><span class="op" id="8333963">,</span>&nbsp;<span class="ident" id="8333965">toJSON</span><span class="op" id="8333971">(</span><span class="ident" id="8333972">c</span><span class="op" id="8333973">)</span><span class="op" id="8333974">,</span>&nbsp;<span class="ident" id="8333976">toJSON</span><span class="op" id="8333982">(</span><span class="ident" id="8333983">tt</span><span class="op" id="8333985">.</span><span class="ident" id="8333986">Cookies</span><span class="op" id="8333993">)</span><span class="op" id="8333994">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334000">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334019">}</span><br>
<span class="lineno"></span><span class="op" id="8334021">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="8334024">var</span>&nbsp;<span class="ident" id="8334028">readCookiesTests</span>&nbsp;<span class="op" id="8334045">=</span>&nbsp;<span class="op" id="8334047">[</span><span class="op" id="8334048">]</span><span class="keyword" id="8334049">struct</span>&nbsp;<span class="op" id="8334056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334059">Header</span>&nbsp;&nbsp;<span class="ident" id="8334067">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334075">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="8334083">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334091">Cookies</span>&nbsp;<span class="op" id="8334099">[</span><span class="op" id="8334100">]</span><span class="op" id="8334101">*</span><span class="ident" id="8334102">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="8334109">}</span><span class="op" id="8334110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334117">Header</span><span class="op" id="8334123">{</span><span class="string" id="8334124">&#34;Cookie&#34;</span><span class="op" id="8334132">:</span>&nbsp;<span class="op" id="8334134">{</span><span class="string" id="8334135">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8334149">,</span>&nbsp;<span class="string" id="8334151">&#34;c2=v2&#34;</span><span class="op" id="8334158">}</span><span class="op" id="8334159">}</span><span class="op" id="8334160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8334164">&#34;&#34;</span><span class="op" id="8334166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334170">[</span><span class="op" id="8334171">]</span><span class="op" id="8334172">*</span><span class="ident" id="8334173">Cookie</span><span class="op" id="8334179">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334184">{</span><span class="ident" id="8334185">Name</span><span class="op" id="8334189">:</span>&nbsp;<span class="string" id="8334191">&#34;Cookie-1&#34;</span><span class="op" id="8334201">,</span>&nbsp;<span class="ident" id="8334203">Value</span><span class="op" id="8334208">:</span>&nbsp;<span class="string" id="8334210">&#34;v$1&#34;</span><span class="op" id="8334215">}</span><span class="op" id="8334216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334221">{</span><span class="ident" id="8334222">Name</span><span class="op" id="8334226">:</span>&nbsp;<span class="string" id="8334228">&#34;c2&#34;</span><span class="op" id="8334232">,</span>&nbsp;<span class="ident" id="8334234">Value</span><span class="op" id="8334239">:</span>&nbsp;<span class="string" id="8334241">&#34;v2&#34;</span><span class="op" id="8334245">}</span><span class="op" id="8334246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334250">}</span><span class="op" id="8334251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334254">}</span><span class="op" id="8334255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334258">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334262">Header</span><span class="op" id="8334268">{</span><span class="string" id="8334269">&#34;Cookie&#34;</span><span class="op" id="8334277">:</span>&nbsp;<span class="op" id="8334279">{</span><span class="string" id="8334280">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8334294">,</span>&nbsp;<span class="string" id="8334296">&#34;c2=v2&#34;</span><span class="op" id="8334303">}</span><span class="op" id="8334304">}</span><span class="op" id="8334305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8334309">&#34;c2&#34;</span><span class="op" id="8334313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334317">[</span><span class="op" id="8334318">]</span><span class="op" id="8334319">*</span><span class="ident" id="8334320">Cookie</span><span class="op" id="8334326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334331">{</span><span class="ident" id="8334332">Name</span><span class="op" id="8334336">:</span>&nbsp;<span class="string" id="8334338">&#34;c2&#34;</span><span class="op" id="8334342">,</span>&nbsp;<span class="ident" id="8334344">Value</span><span class="op" id="8334349">:</span>&nbsp;<span class="string" id="8334351">&#34;v2&#34;</span><span class="op" id="8334355">}</span><span class="op" id="8334356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334360">}</span><span class="op" id="8334361">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334364">}</span><span class="op" id="8334365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334372">Header</span><span class="op" id="8334378">{</span><span class="string" id="8334379">&#34;Cookie&#34;</span><span class="op" id="8334387">:</span>&nbsp;<span class="op" id="8334389">{</span><span class="string" id="8334390">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="8334411">}</span><span class="op" id="8334412">}</span><span class="op" id="8334413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8334417">&#34;&#34;</span><span class="op" id="8334419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334423">[</span><span class="op" id="8334424">]</span><span class="op" id="8334425">*</span><span class="ident" id="8334426">Cookie</span><span class="op" id="8334432">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334437">{</span><span class="ident" id="8334438">Name</span><span class="op" id="8334442">:</span>&nbsp;<span class="string" id="8334444">&#34;Cookie-1&#34;</span><span class="op" id="8334454">,</span>&nbsp;<span class="ident" id="8334456">Value</span><span class="op" id="8334461">:</span>&nbsp;<span class="string" id="8334463">&#34;v$1&#34;</span><span class="op" id="8334468">}</span><span class="op" id="8334469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334474">{</span><span class="ident" id="8334475">Name</span><span class="op" id="8334479">:</span>&nbsp;<span class="string" id="8334481">&#34;c2&#34;</span><span class="op" id="8334485">,</span>&nbsp;<span class="ident" id="8334487">Value</span><span class="op" id="8334492">:</span>&nbsp;<span class="string" id="8334494">&#34;v2&#34;</span><span class="op" id="8334498">}</span><span class="op" id="8334499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334503">}</span><span class="op" id="8334504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334507">}</span><span class="op" id="8334508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334511">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334515">Header</span><span class="op" id="8334521">{</span><span class="string" id="8334522">&#34;Cookie&#34;</span><span class="op" id="8334530">:</span>&nbsp;<span class="op" id="8334532">{</span><span class="string" id="8334533">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="8334554">}</span><span class="op" id="8334555">}</span><span class="op" id="8334556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8334560">&#34;c2&#34;</span><span class="op" id="8334564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334568">[</span><span class="op" id="8334569">]</span><span class="op" id="8334570">*</span><span class="ident" id="8334571">Cookie</span><span class="op" id="8334577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334582">{</span><span class="ident" id="8334583">Name</span><span class="op" id="8334587">:</span>&nbsp;<span class="string" id="8334589">&#34;c2&#34;</span><span class="op" id="8334593">,</span>&nbsp;<span class="ident" id="8334595">Value</span><span class="op" id="8334600">:</span>&nbsp;<span class="string" id="8334602">&#34;v2&#34;</span><span class="op" id="8334606">}</span><span class="op" id="8334607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334611">}</span><span class="op" id="8334612">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334615">}</span><span class="op" id="8334616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334623">Header</span><span class="op" id="8334629">{</span><span class="string" id="8334630">&#34;Cookie&#34;</span><span class="op" id="8334638">:</span>&nbsp;<span class="op" id="8334640">{</span><span class="string" id="8334641">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="8334666">}</span><span class="op" id="8334667">}</span><span class="op" id="8334668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8334672">&#34;&#34;</span><span class="op" id="8334674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334678">[</span><span class="op" id="8334679">]</span><span class="op" id="8334680">*</span><span class="ident" id="8334681">Cookie</span><span class="op" id="8334687">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334692">{</span><span class="ident" id="8334693">Name</span><span class="op" id="8334697">:</span>&nbsp;<span class="string" id="8334699">&#34;Cookie-1&#34;</span><span class="op" id="8334709">,</span>&nbsp;<span class="ident" id="8334711">Value</span><span class="op" id="8334716">:</span>&nbsp;<span class="string" id="8334718">&#34;v$1&#34;</span><span class="op" id="8334723">}</span><span class="op" id="8334724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334729">{</span><span class="ident" id="8334730">Name</span><span class="op" id="8334734">:</span>&nbsp;<span class="string" id="8334736">&#34;c2&#34;</span><span class="op" id="8334740">,</span>&nbsp;<span class="ident" id="8334742">Value</span><span class="op" id="8334747">:</span>&nbsp;<span class="string" id="8334749">&#34;v2&#34;</span><span class="op" id="8334753">}</span><span class="op" id="8334754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334758">}</span><span class="op" id="8334759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334762">}</span><span class="op" id="8334763">,</span><br>
<span class="lineno"></span><span class="op" id="8334765">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="8334768">func</span>&nbsp;<span class="ident" id="8334773">TestReadCookies</span><span class="op" id="8334788">(</span><span class="ident" id="8334789">t</span>&nbsp;<span class="op" id="8334791">*</span><span class="ident" id="8334792">testing</span><span class="op" id="8334799">.</span><span class="ident" id="8334800">T</span><span class="op" id="8334801">)</span>&nbsp;<span class="op" id="8334803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334806">for</span>&nbsp;<span class="ident" id="8334810">i</span><span class="op" id="8334811">,</span>&nbsp;<span class="ident" id="8334813">tt</span>&nbsp;<span class="op" id="8334816">:=</span>&nbsp;<span class="keyword" id="8334819">range</span>&nbsp;<span class="ident" id="8334825">readCookiesTests</span>&nbsp;<span class="op" id="8334842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334846">for</span>&nbsp;<span class="ident" id="8334850">n</span>&nbsp;<span class="op" id="8334852">:=</span>&nbsp;<span class="num" id="8334855">0</span><span class="op" id="8334856">;</span>&nbsp;<span class="ident" id="8334858">n</span>&nbsp;<span class="op" id="8334860">&lt;</span>&nbsp;<span class="num" id="8334862">2</span><span class="op" id="8334863">;</span>&nbsp;<span class="ident" id="8334865">n</span><span class="op" id="8334866">++</span>&nbsp;<span class="op" id="8334869">{</span>&nbsp;<span class="comment" id="8334871">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334924">c</span>&nbsp;<span class="op" id="8334926">:=</span>&nbsp;<span class="ident" id="8334929">readCookies</span><span class="op" id="8334940">(</span><span class="ident" id="8334941">tt</span><span class="op" id="8334943">.</span><span class="ident" id="8334944">Header</span><span class="op" id="8334950">,</span>&nbsp;<span class="ident" id="8334952">tt</span><span class="op" id="8334954">.</span><span class="ident" id="8334955">Filter</span><span class="op" id="8334961">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334966">if</span>&nbsp;<span class="op" id="8334969">!</span><span class="ident" id="8334970">reflect</span><span class="op" id="8334977">.</span><span class="ident" id="8334978">DeepEqual</span><span class="op" id="8334987">(</span><span class="ident" id="8334988">c</span><span class="op" id="8334989">,</span>&nbsp;<span class="ident" id="8334991">tt</span><span class="op" id="8334993">.</span><span class="ident" id="8334994">Cookies</span><span class="op" id="8335001">)</span>&nbsp;<span class="op" id="8335003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335009">t</span><span class="op" id="8335010">.</span><span class="ident" id="8335011">Errorf</span><span class="op" id="8335017">(</span><span class="string" id="8335018">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="8335058">,</span>&nbsp;<span class="ident" id="8335060">i</span><span class="op" id="8335061">,</span>&nbsp;<span class="ident" id="8335063">toJSON</span><span class="op" id="8335069">(</span><span class="ident" id="8335070">c</span><span class="op" id="8335071">)</span><span class="op" id="8335072">,</span>&nbsp;<span class="ident" id="8335074">toJSON</span><span class="op" id="8335080">(</span><span class="ident" id="8335081">tt</span><span class="op" id="8335083">.</span><span class="ident" id="8335084">Cookies</span><span class="op" id="8335091">)</span><span class="op" id="8335092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335098">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335114">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335117">}</span><br>
<span class="lineno"></span><span class="op" id="8335119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8335122">func</span>&nbsp;<span class="ident" id="8335127">TestSetCookieDoubleQuotes</span><span class="op" id="8335152">(</span><span class="ident" id="8335153">t</span>&nbsp;<span class="op" id="8335155">*</span><span class="ident" id="8335156">testing</span><span class="op" id="8335163">.</span><span class="ident" id="8335164">T</span><span class="op" id="8335165">)</span>&nbsp;<span class="op" id="8335167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335170">res</span>&nbsp;<span class="op" id="8335174">:=</span>&nbsp;<span class="op" id="8335177">&amp;</span><span class="ident" id="8335178">Response</span><span class="op" id="8335186">{</span><span class="ident" id="8335187">Header</span><span class="op" id="8335193">:</span>&nbsp;<span class="ident" id="8335195">Header</span><span class="op" id="8335201">{</span><span class="op" id="8335202">}</span><span class="op" id="8335203">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335206">res</span><span class="op" id="8335209">.</span><span class="ident" id="8335210">Header</span><span class="op" id="8335216">.</span><span class="ident" id="8335217">Add</span><span class="op" id="8335220">(</span><span class="string" id="8335221">&#34;Set-Cookie&#34;</span><span class="op" id="8335233">,</span>&nbsp;<span class="string" id="8335235">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="8335261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335264">res</span><span class="op" id="8335267">.</span><span class="ident" id="8335268">Header</span><span class="op" id="8335274">.</span><span class="ident" id="8335275">Add</span><span class="op" id="8335278">(</span><span class="string" id="8335279">&#34;Set-Cookie&#34;</span><span class="op" id="8335291">,</span>&nbsp;<span class="string" id="8335293">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="8335328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335331">res</span><span class="op" id="8335334">.</span><span class="ident" id="8335335">Header</span><span class="op" id="8335341">.</span><span class="ident" id="8335342">Add</span><span class="op" id="8335345">(</span><span class="string" id="8335346">&#34;Set-Cookie&#34;</span><span class="op" id="8335358">,</span>&nbsp;<span class="string" id="8335360">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="8335392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335395">res</span><span class="op" id="8335398">.</span><span class="ident" id="8335399">Header</span><span class="op" id="8335405">.</span><span class="ident" id="8335406">Add</span><span class="op" id="8335409">(</span><span class="string" id="8335410">&#34;Set-Cookie&#34;</span><span class="op" id="8335422">,</span>&nbsp;<span class="string" id="8335424">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="8335454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335457">got</span>&nbsp;<span class="op" id="8335461">:=</span>&nbsp;<span class="ident" id="8335464">res</span><span class="op" id="8335467">.</span><span class="ident" id="8335468">Cookies</span><span class="op" id="8335475">(</span><span class="op" id="8335476">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335479">want</span>&nbsp;<span class="op" id="8335484">:=</span>&nbsp;<span class="op" id="8335487">[</span><span class="op" id="8335488">]</span><span class="op" id="8335489">*</span><span class="ident" id="8335490">Cookie</span><span class="op" id="8335496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335500">{</span><span class="ident" id="8335501">Name</span><span class="op" id="8335505">:</span>&nbsp;<span class="string" id="8335507">&#34;quoted0&#34;</span><span class="op" id="8335516">,</span>&nbsp;<span class="ident" id="8335518">Value</span><span class="op" id="8335523">:</span>&nbsp;<span class="string" id="8335525">&#34;none&#34;</span><span class="op" id="8335531">,</span>&nbsp;<span class="ident" id="8335533">MaxAge</span><span class="op" id="8335539">:</span>&nbsp;<span class="num" id="8335541">30</span><span class="op" id="8335543">}</span><span class="op" id="8335544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335548">{</span><span class="ident" id="8335549">Name</span><span class="op" id="8335553">:</span>&nbsp;<span class="string" id="8335555">&#34;quoted1&#34;</span><span class="op" id="8335564">,</span>&nbsp;<span class="ident" id="8335566">Value</span><span class="op" id="8335571">:</span>&nbsp;<span class="string" id="8335573">&#34;cookieValue&#34;</span><span class="op" id="8335586">,</span>&nbsp;<span class="ident" id="8335588">MaxAge</span><span class="op" id="8335594">:</span>&nbsp;<span class="num" id="8335596">31</span><span class="op" id="8335598">}</span><span class="op" id="8335599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335603">{</span><span class="ident" id="8335604">Name</span><span class="op" id="8335608">:</span>&nbsp;<span class="string" id="8335610">&#34;quoted2&#34;</span><span class="op" id="8335619">,</span>&nbsp;<span class="ident" id="8335621">Value</span><span class="op" id="8335626">:</span>&nbsp;<span class="string" id="8335628">&#34;cookieAV&#34;</span><span class="op" id="8335638">}</span><span class="op" id="8335639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335643">{</span><span class="ident" id="8335644">Name</span><span class="op" id="8335648">:</span>&nbsp;<span class="string" id="8335650">&#34;quoted3&#34;</span><span class="op" id="8335659">,</span>&nbsp;<span class="ident" id="8335661">Value</span><span class="op" id="8335666">:</span>&nbsp;<span class="string" id="8335668">&#34;both&#34;</span><span class="op" id="8335674">}</span><span class="op" id="8335675">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335681">if</span>&nbsp;<span class="builtinfunc" id="8335684">len</span><span class="op" id="8335687">(</span><span class="ident" id="8335688">got</span><span class="op" id="8335691">)</span>&nbsp;<span class="op" id="8335693">!=</span>&nbsp;<span class="builtinfunc" id="8335696">len</span><span class="op" id="8335699">(</span><span class="ident" id="8335700">want</span><span class="op" id="8335704">)</span>&nbsp;<span class="op" id="8335706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335710">t</span><span class="op" id="8335711">.</span><span class="ident" id="8335712">Fatal</span><span class="op" id="8335717">(</span><span class="string" id="8335718">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8335743">,</span>&nbsp;<span class="builtinfunc" id="8335745">len</span><span class="op" id="8335748">(</span><span class="ident" id="8335749">got</span><span class="op" id="8335752">)</span><span class="op" id="8335753">,</span>&nbsp;<span class="builtinfunc" id="8335755">len</span><span class="op" id="8335758">(</span><span class="ident" id="8335759">want</span><span class="op" id="8335763">)</span><span class="op" id="8335764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335770">for</span>&nbsp;<span class="ident" id="8335774">i</span><span class="op" id="8335775">,</span>&nbsp;<span class="ident" id="8335777">w</span>&nbsp;<span class="op" id="8335779">:=</span>&nbsp;<span class="keyword" id="8335782">range</span>&nbsp;<span class="ident" id="8335788">want</span>&nbsp;<span class="op" id="8335793">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335797">g</span>&nbsp;<span class="op" id="8335799">:=</span>&nbsp;<span class="ident" id="8335802">got</span><span class="op" id="8335805">[</span><span class="ident" id="8335806">i</span><span class="op" id="8335807">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335811">if</span>&nbsp;<span class="ident" id="8335814">g</span><span class="op" id="8335815">.</span><span class="ident" id="8335816">Name</span>&nbsp;<span class="op" id="8335821">!=</span>&nbsp;<span class="ident" id="8335824">w</span><span class="op" id="8335825">.</span><span class="ident" id="8335826">Name</span>&nbsp;<span class="op" id="8335831">||</span>&nbsp;<span class="ident" id="8335834">g</span><span class="op" id="8335835">.</span><span class="ident" id="8335836">Value</span>&nbsp;<span class="op" id="8335842">!=</span>&nbsp;<span class="ident" id="8335845">w</span><span class="op" id="8335846">.</span><span class="ident" id="8335847">Value</span>&nbsp;<span class="op" id="8335853">||</span>&nbsp;<span class="ident" id="8335856">g</span><span class="op" id="8335857">.</span><span class="ident" id="8335858">MaxAge</span>&nbsp;<span class="op" id="8335865">!=</span>&nbsp;<span class="ident" id="8335868">w</span><span class="op" id="8335869">.</span><span class="ident" id="8335870">MaxAge</span>&nbsp;<span class="op" id="8335877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335882">t</span><span class="op" id="8335883">.</span><span class="ident" id="8335884">Errorf</span><span class="op" id="8335890">(</span><span class="string" id="8335891">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="8335922">,</span>&nbsp;<span class="ident" id="8335924">i</span><span class="op" id="8335925">,</span>&nbsp;<span class="ident" id="8335927">g</span><span class="op" id="8335928">,</span>&nbsp;<span class="ident" id="8335930">w</span><span class="op" id="8335931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335938">}</span><br>
<span class="lineno">360</span><span class="op" id="8335940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8335943">func</span>&nbsp;<span class="ident" id="8335948">TestCookieSanitizeValue</span><span class="op" id="8335971">(</span><span class="ident" id="8335972">t</span>&nbsp;<span class="op" id="8335974">*</span><span class="ident" id="8335975">testing</span><span class="op" id="8335982">.</span><span class="ident" id="8335983">T</span><span class="op" id="8335984">)</span>&nbsp;<span class="op" id="8335986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335989">defer</span>&nbsp;<span class="ident" id="8335995">log</span><span class="op" id="8335998">.</span><span class="ident" id="8335999">SetOutput</span><span class="op" id="8336008">(</span><span class="ident" id="8336009">os</span><span class="op" id="8336011">.</span><span class="ident" id="8336012">Stderr</span><span class="op" id="8336018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8336021">var</span>&nbsp;<span class="ident" id="8336025">logbuf</span>&nbsp;<span class="ident" id="8336032">bytes</span><span class="op" id="8336037">.</span><span class="ident" id="8336038">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8336046">log</span><span class="op" id="8336049">.</span><span class="ident" id="8336050">SetOutput</span><span class="op" id="8336059">(</span><span class="op" id="8336060">&amp;</span><span class="ident" id="8336061">logbuf</span><span class="op" id="8336067">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8336071">tests</span>&nbsp;<span class="op" id="8336077">:=</span>&nbsp;<span class="op" id="8336080">[</span><span class="op" id="8336081">]</span><span class="keyword" id="8336082">struct</span>&nbsp;<span class="op" id="8336089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8336093">in</span><span class="op" id="8336095">,</span>&nbsp;<span class="ident" id="8336097">want</span>&nbsp;<span class="builtintype" id="8336102">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336110">}</span><span class="op" id="8336111">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336115">{</span><span class="string" id="8336116">&#34;foo&#34;</span><span class="op" id="8336121">,</span>&nbsp;<span class="string" id="8336123">&#34;foo&#34;</span><span class="op" id="8336128">}</span><span class="op" id="8336129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336133">{</span><span class="string" id="8336134">&#34;foo;bar&#34;</span><span class="op" id="8336143">,</span>&nbsp;<span class="string" id="8336145">&#34;foobar&#34;</span><span class="op" id="8336153">}</span><span class="op" id="8336154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336158">{</span><span class="string" id="8336159">&#34;foo\\bar&#34;</span><span class="op" id="8336169">,</span>&nbsp;<span class="string" id="8336171">&#34;foobar&#34;</span><span class="op" id="8336179">}</span><span class="op" id="8336180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336184">{</span><span class="string" id="8336185">&#34;foo\&#34;bar&#34;</span><span class="op" id="8336195">,</span>&nbsp;<span class="string" id="8336197">&#34;foobar&#34;</span><span class="op" id="8336205">}</span><span class="op" id="8336206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336210">{</span><span class="string" id="8336211">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="8336229">,</span>&nbsp;<span class="string" id="8336231">&#34;\x7e&#34;</span><span class="op" id="8336237">}</span><span class="op" id="8336238">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336242">{</span><span class="string" id="8336243">`&#34;withquotes&#34;`</span><span class="op" id="8336257">,</span>&nbsp;<span class="string" id="8336259">&#34;withquotes&#34;</span><span class="op" id="8336271">}</span><span class="op" id="8336272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336276">{</span><span class="string" id="8336277">&#34;a&nbsp;z&#34;</span><span class="op" id="8336282">,</span>&nbsp;<span class="string" id="8336284">&#34;a&nbsp;z&#34;</span><span class="op" id="8336289">}</span><span class="op" id="8336290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336294">{</span><span class="string" id="8336295">&#34;&nbsp;z&#34;</span><span class="op" id="8336299">,</span>&nbsp;<span class="string" id="8336301">`&#34;&nbsp;z&#34;`</span><span class="op" id="8336307">}</span><span class="op" id="8336308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336312">{</span><span class="string" id="8336313">&#34;a&nbsp;&#34;</span><span class="op" id="8336317">,</span>&nbsp;<span class="string" id="8336319">`&#34;a&nbsp;&#34;`</span><span class="op" id="8336325">}</span><span class="op" id="8336326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336329">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8336332">for</span>&nbsp;<span class="ident" id="8336336">_</span><span class="op" id="8336337">,</span>&nbsp;<span class="ident" id="8336339">tt</span>&nbsp;<span class="op" id="8336342">:=</span>&nbsp;<span class="keyword" id="8336345">range</span>&nbsp;<span class="ident" id="8336351">tests</span>&nbsp;<span class="op" id="8336357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8336361">if</span>&nbsp;<span class="ident" id="8336364">got</span>&nbsp;<span class="op" id="8336368">:=</span>&nbsp;<span class="ident" id="8336371">sanitizeCookieValue</span><span class="op" id="8336390">(</span><span class="ident" id="8336391">tt</span><span class="op" id="8336393">.</span><span class="ident" id="8336394">in</span><span class="op" id="8336396">)</span><span class="op" id="8336397">;</span>&nbsp;<span class="ident" id="8336399">got</span>&nbsp;<span class="op" id="8336403">!=</span>&nbsp;<span class="ident" id="8336406">tt</span><span class="op" id="8336408">.</span><span class="ident" id="8336409">want</span>&nbsp;<span class="op" id="8336414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8336419">t</span><span class="op" id="8336420">.</span><span class="ident" id="8336421">Errorf</span><span class="op" id="8336427">(</span><span class="string" id="8336428">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8336467">,</span>&nbsp;<span class="ident" id="8336469">tt</span><span class="op" id="8336471">.</span><span class="ident" id="8336472">in</span><span class="op" id="8336474">,</span>&nbsp;<span class="ident" id="8336476">got</span><span class="op" id="8336479">,</span>&nbsp;<span class="ident" id="8336481">tt</span><span class="op" id="8336483">.</span><span class="ident" id="8336484">want</span><span class="op" id="8336488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336495">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8336499">if</span>&nbsp;<span class="ident" id="8336502">got</span><span class="op" id="8336505">,</span>&nbsp;<span class="ident" id="8336507">sub</span>&nbsp;<span class="op" id="8336511">:=</span>&nbsp;<span class="ident" id="8336514">logbuf</span><span class="op" id="8336520">.</span><span class="ident" id="8336521">String</span><span class="op" id="8336527">(</span><span class="op" id="8336528">)</span><span class="op" id="8336529">,</span>&nbsp;<span class="string" id="8336531">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="8336555">;</span>&nbsp;<span class="op" id="8336557">!</span><span class="ident" id="8336558">strings</span><span class="op" id="8336565">.</span><span class="ident" id="8336566">Contains</span><span class="op" id="8336574">(</span><span class="ident" id="8336575">got</span><span class="op" id="8336578">,</span>&nbsp;<span class="ident" id="8336580">sub</span><span class="op" id="8336583">)</span>&nbsp;<span class="op" id="8336585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8336589">t</span><span class="op" id="8336590">.</span><span class="ident" id="8336591">Errorf</span><span class="op" id="8336597">(</span><span class="string" id="8336598">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8336645">,</span>&nbsp;<span class="ident" id="8336647">sub</span><span class="op" id="8336650">,</span>&nbsp;<span class="ident" id="8336652">got</span><span class="op" id="8336655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336658">}</span><br>
<span class="lineno"></span><span class="op" id="8336660">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="8336663">func</span>&nbsp;<span class="ident" id="8336668">TestCookieSanitizePath</span><span class="op" id="8336690">(</span><span class="ident" id="8336691">t</span>&nbsp;<span class="op" id="8336693">*</span><span class="ident" id="8336694">testing</span><span class="op" id="8336701">.</span><span class="ident" id="8336702">T</span><span class="op" id="8336703">)</span>&nbsp;<span class="op" id="8336705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8336708">defer</span>&nbsp;<span class="ident" id="8336714">log</span><span class="op" id="8336717">.</span><span class="ident" id="8336718">SetOutput</span><span class="op" id="8336727">(</span><span class="ident" id="8336728">os</span><span class="op" id="8336730">.</span><span class="ident" id="8336731">Stderr</span><span class="op" id="8336737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8336740">var</span>&nbsp;<span class="ident" id="8336744">logbuf</span>&nbsp;<span class="ident" id="8336751">bytes</span><span class="op" id="8336756">.</span><span class="ident" id="8336757">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8336765">log</span><span class="op" id="8336768">.</span><span class="ident" id="8336769">SetOutput</span><span class="op" id="8336778">(</span><span class="op" id="8336779">&amp;</span><span class="ident" id="8336780">logbuf</span><span class="op" id="8336786">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8336790">tests</span>&nbsp;<span class="op" id="8336796">:=</span>&nbsp;<span class="op" id="8336799">[</span><span class="op" id="8336800">]</span><span class="keyword" id="8336801">struct</span>&nbsp;<span class="op" id="8336808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8336812">in</span><span class="op" id="8336814">,</span>&nbsp;<span class="ident" id="8336816">want</span>&nbsp;<span class="builtintype" id="8336821">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336829">}</span><span class="op" id="8336830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336834">{</span><span class="string" id="8336835">&#34;/path&#34;</span><span class="op" id="8336842">,</span>&nbsp;<span class="string" id="8336844">&#34;/path&#34;</span><span class="op" id="8336851">}</span><span class="op" id="8336852">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336856">{</span><span class="string" id="8336857">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="8336876">,</span>&nbsp;<span class="string" id="8336878">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="8336897">}</span><span class="op" id="8336898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336902">{</span><span class="string" id="8336903">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="8336935">,</span>&nbsp;<span class="string" id="8336937">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="8336963">}</span><span class="op" id="8336964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8336967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8336970">for</span>&nbsp;<span class="ident" id="8336974">_</span><span class="op" id="8336975">,</span>&nbsp;<span class="ident" id="8336977">tt</span>&nbsp;<span class="op" id="8336980">:=</span>&nbsp;<span class="keyword" id="8336983">range</span>&nbsp;<span class="ident" id="8336989">tests</span>&nbsp;<span class="op" id="8336995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8336999">if</span>&nbsp;<span class="ident" id="8337002">got</span>&nbsp;<span class="op" id="8337006">:=</span>&nbsp;<span class="ident" id="8337009">sanitizeCookiePath</span><span class="op" id="8337027">(</span><span class="ident" id="8337028">tt</span><span class="op" id="8337030">.</span><span class="ident" id="8337031">in</span><span class="op" id="8337033">)</span><span class="op" id="8337034">;</span>&nbsp;<span class="ident" id="8337036">got</span>&nbsp;<span class="op" id="8337040">!=</span>&nbsp;<span class="ident" id="8337043">tt</span><span class="op" id="8337045">.</span><span class="ident" id="8337046">want</span>&nbsp;<span class="op" id="8337051">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8337056">t</span><span class="op" id="8337057">.</span><span class="ident" id="8337058">Errorf</span><span class="op" id="8337064">(</span><span class="string" id="8337065">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8337103">,</span>&nbsp;<span class="ident" id="8337105">tt</span><span class="op" id="8337107">.</span><span class="ident" id="8337108">in</span><span class="op" id="8337110">,</span>&nbsp;<span class="ident" id="8337112">got</span><span class="op" id="8337115">,</span>&nbsp;<span class="ident" id="8337117">tt</span><span class="op" id="8337119">.</span><span class="ident" id="8337120">want</span><span class="op" id="8337124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8337128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8337131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8337135">if</span>&nbsp;<span class="ident" id="8337138">got</span><span class="op" id="8337141">,</span>&nbsp;<span class="ident" id="8337143">sub</span>&nbsp;<span class="op" id="8337147">:=</span>&nbsp;<span class="ident" id="8337150">logbuf</span><span class="op" id="8337156">.</span><span class="ident" id="8337157">String</span><span class="op" id="8337163">(</span><span class="op" id="8337164">)</span><span class="op" id="8337165">,</span>&nbsp;<span class="string" id="8337167">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="8337191">;</span>&nbsp;<span class="op" id="8337193">!</span><span class="ident" id="8337194">strings</span><span class="op" id="8337201">.</span><span class="ident" id="8337202">Contains</span><span class="op" id="8337210">(</span><span class="ident" id="8337211">got</span><span class="op" id="8337214">,</span>&nbsp;<span class="ident" id="8337216">sub</span><span class="op" id="8337219">)</span>&nbsp;<span class="op" id="8337221">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8337225">t</span><span class="op" id="8337226">.</span><span class="ident" id="8337227">Errorf</span><span class="op" id="8337233">(</span><span class="string" id="8337234">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8337281">,</span>&nbsp;<span class="ident" id="8337283">sub</span><span class="op" id="8337286">,</span>&nbsp;<span class="ident" id="8337288">got</span><span class="op" id="8337291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8337294">}</span><br>
<span class="lineno"></span><span class="op" id="8337296">}</span>
</div>
</body>
</html>
