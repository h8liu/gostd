<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6073334">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6073389">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6073443">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6073494">package</span>&nbsp;<span class="ident" id="6073502">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6073507">import</span>&nbsp;<span class="op" id="6073514">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6073517">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6073526">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6073535">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6073547">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6073554">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6073560">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6073571">&#34;strconv&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6073582">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6073592">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6073595">const</span>&nbsp;<span class="op" id="6073601">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6073604">//&nbsp;A&nbsp;generic&nbsp;XML&nbsp;header&nbsp;suitable&nbsp;for&nbsp;use&nbsp;with&nbsp;the&nbsp;output&nbsp;of&nbsp;Marshal.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6073674">//&nbsp;This&nbsp;is&nbsp;not&nbsp;automatically&nbsp;added&nbsp;to&nbsp;any&nbsp;output&nbsp;of&nbsp;this&nbsp;package,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6073741">//&nbsp;it&nbsp;is&nbsp;provided&nbsp;as&nbsp;a&nbsp;convenience.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6073778">Header</span>&nbsp;<span class="op" id="6073785">=</span>&nbsp;<span class="string" id="6073787">`&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;`</span>&nbsp;<span class="op" id="6073828">+</span>&nbsp;<span class="string" id="6073830">&#34;\n&#34;</span><br>
<span class="lineno"></span><span class="op" id="6073835">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6073838">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="6073880">//</span><br>
<span class="lineno"></span><span class="comment" id="6073883">//&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;array&nbsp;or&nbsp;slice&nbsp;by&nbsp;marshalling&nbsp;each&nbsp;of&nbsp;the&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="6073957">//&nbsp;Marshal&nbsp;handles&nbsp;a&nbsp;pointer&nbsp;by&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;points&nbsp;at&nbsp;or,&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6074035">//&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;by&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;interface&nbsp;value&nbsp;by</span><br>
<span class="lineno">30</span><span class="comment" id="6074113">//&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;contains&nbsp;or,&nbsp;if&nbsp;the&nbsp;interface&nbsp;value&nbsp;is&nbsp;nil,&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6074188">//&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;all&nbsp;other&nbsp;data&nbsp;by&nbsp;writing&nbsp;one&nbsp;or&nbsp;more&nbsp;XML</span><br>
<span class="lineno"></span><span class="comment" id="6074267">//&nbsp;elements&nbsp;containing&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="6074300">//</span><br>
<span class="lineno"></span><span class="comment" id="6074303">//&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;XML&nbsp;elements&nbsp;is&nbsp;taken&nbsp;from,&nbsp;in&nbsp;order&nbsp;of&nbsp;preference:</span><br>
<span class="lineno">35</span><span class="comment" id="6074375">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;on&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;if&nbsp;the&nbsp;data&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="6074438">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;XMLName&nbsp;field&nbsp;of&nbsp;type&nbsp;xml.Name</span><br>
<span class="lineno"></span><span class="comment" id="6074495">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6074556">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6074618">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;marshalled&nbsp;type</span><br>
<span class="lineno">40</span><span class="comment" id="6074659">//</span><br>
<span class="lineno"></span><span class="comment" id="6074662">//&nbsp;The&nbsp;XML&nbsp;element&nbsp;for&nbsp;a&nbsp;struct&nbsp;contains&nbsp;marshalled&nbsp;elements&nbsp;for&nbsp;each&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6074739">//&nbsp;exported&nbsp;fields&nbsp;of&nbsp;the&nbsp;struct,&nbsp;with&nbsp;these&nbsp;exceptions:</span><br>
<span class="lineno"></span><span class="comment" id="6074796">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;described&nbsp;above,&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="comment" id="6074853">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;-&#34;&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno">45</span><span class="comment" id="6074895">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;name,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6074959">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6075003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6075067">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6075107">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,chardata&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;character&nbsp;data,</span><br>
<span class="lineno">50</span><span class="comment" id="6075175">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;as&nbsp;an&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6075207">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,innerxml&#34;&nbsp;is&nbsp;written&nbsp;verbatim,&nbsp;not&nbsp;subject</span><br>
<span class="lineno"></span><span class="comment" id="6075278">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.</span><br>
<span class="lineno"></span><span class="comment" id="6075323">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,comment&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;an&nbsp;XML&nbsp;comment,&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6075394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.&nbsp;It&nbsp;must&nbsp;not&nbsp;contain</span><br>
<span class="lineno">55</span><span class="comment" id="6075467">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;&#34;--&#34;&nbsp;string&nbsp;within&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6075503">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;a&nbsp;tag&nbsp;including&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option&nbsp;is&nbsp;omitted</span><br>
<span class="lineno"></span><span class="comment" id="6075575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;field&nbsp;value&nbsp;is&nbsp;empty.&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6075648">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6075719">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;of&nbsp;length&nbsp;zero.</span><br>
<span class="lineno">60</span><span class="comment" id="6075751">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;is&nbsp;handled&nbsp;as&nbsp;if&nbsp;the&nbsp;fields&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6075821">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;were&nbsp;part&nbsp;of&nbsp;the&nbsp;outer&nbsp;struct.</span><br>
<span class="lineno"></span><span class="comment" id="6075867">//</span><br>
<span class="lineno"></span><span class="comment" id="6075870">//&nbsp;If&nbsp;a&nbsp;field&nbsp;uses&nbsp;a&nbsp;tag&nbsp;&#34;a&gt;b&gt;c&#34;,&nbsp;then&nbsp;the&nbsp;element&nbsp;c&nbsp;will&nbsp;be&nbsp;nested&nbsp;inside</span><br>
<span class="lineno"></span><span class="comment" id="6075945">//&nbsp;parent&nbsp;elements&nbsp;a&nbsp;and&nbsp;b.&nbsp;&nbsp;Fields&nbsp;that&nbsp;appear&nbsp;next&nbsp;to&nbsp;each&nbsp;other&nbsp;that&nbsp;name</span><br>
<span class="lineno">65</span><span class="comment" id="6076022">//&nbsp;the&nbsp;same&nbsp;parent&nbsp;will&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;one&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6076078">//</span><br>
<span class="lineno"></span><span class="comment" id="6076081">//&nbsp;See&nbsp;MarshalIndent&nbsp;for&nbsp;an&nbsp;example.</span><br>
<span class="lineno"></span><span class="comment" id="6076118">//</span><br>
<span class="lineno"></span><span class="comment" id="6076121">//&nbsp;Marshal&nbsp;will&nbsp;return&nbsp;an&nbsp;error&nbsp;if&nbsp;asked&nbsp;to&nbsp;marshal&nbsp;a&nbsp;channel,&nbsp;function,&nbsp;or&nbsp;map.</span><br>
<span class="lineno">70</span><span class="keyword" id="6076202">func</span>&nbsp;<span class="ident" id="6076207">Marshal</span><span class="op" id="6076214">(</span><span class="ident" id="6076215">v</span>&nbsp;<span class="keyword" id="6076217">interface</span><span class="op" id="6076226">{</span><span class="op" id="6076227">}</span><span class="op" id="6076228">)</span>&nbsp;<span class="op" id="6076230">(</span><span class="op" id="6076231">[</span><span class="op" id="6076232">]</span><span class="builtintype" id="6076233">byte</span><span class="op" id="6076237">,</span>&nbsp;<span class="builtintype" id="6076239">error</span><span class="op" id="6076244">)</span>&nbsp;<span class="op" id="6076246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076249">var</span>&nbsp;<span class="ident" id="6076253">b</span>&nbsp;<span class="ident" id="6076255">bytes</span><span class="op" id="6076260">.</span><span class="ident" id="6076261">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076269">if</span>&nbsp;<span class="ident" id="6076272">err</span>&nbsp;<span class="op" id="6076276">:=</span>&nbsp;<span class="ident" id="6076279">NewEncoder</span><span class="op" id="6076289">(</span><span class="op" id="6076290">&amp;</span><span class="ident" id="6076291">b</span><span class="op" id="6076292">)</span><span class="op" id="6076293">.</span><span class="ident" id="6076294">Encode</span><span class="op" id="6076300">(</span><span class="ident" id="6076301">v</span><span class="op" id="6076302">)</span><span class="op" id="6076303">;</span>&nbsp;<span class="ident" id="6076305">err</span>&nbsp;<span class="op" id="6076309">!=</span>&nbsp;<span class="ident" id="6076312">nil</span>&nbsp;<span class="op" id="6076316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076320">return</span>&nbsp;<span class="ident" id="6076327">nil</span><span class="op" id="6076330">,</span>&nbsp;<span class="ident" id="6076332">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6076337">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076340">return</span>&nbsp;<span class="ident" id="6076347">b</span><span class="op" id="6076348">.</span><span class="ident" id="6076349">Bytes</span><span class="op" id="6076354">(</span><span class="op" id="6076355">)</span><span class="op" id="6076356">,</span>&nbsp;<span class="ident" id="6076358">nil</span><br>
<span class="lineno"></span><span class="op" id="6076362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6076365">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="6076435">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno">80</span><span class="comment" id="6076474">//</span><br>
<span class="lineno"></span><span class="comment" id="6076477">//&nbsp;MarshalXML&nbsp;encodes&nbsp;the&nbsp;receiver&nbsp;as&nbsp;zero&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="6076542">//&nbsp;By&nbsp;convention,&nbsp;arrays&nbsp;or&nbsp;slices&nbsp;are&nbsp;typically&nbsp;encoded&nbsp;as&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="6076613">//&nbsp;of&nbsp;elements,&nbsp;one&nbsp;per&nbsp;entry.</span><br>
<span class="lineno"></span><span class="comment" id="6076644">//&nbsp;Using&nbsp;start&nbsp;as&nbsp;the&nbsp;element&nbsp;tag&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno">85</span><span class="comment" id="6076708">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;XML&nbsp;elements&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="6076774">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="6076791">//&nbsp;One&nbsp;common&nbsp;implementation&nbsp;strategy&nbsp;is&nbsp;to&nbsp;construct&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span><span class="comment" id="6076856">//&nbsp;value&nbsp;with&nbsp;a&nbsp;layout&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;desired&nbsp;XML&nbsp;and&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6076921">//&nbsp;to&nbsp;encode&nbsp;it&nbsp;using&nbsp;e.EncodeElement.</span><br>
<span class="lineno">90</span><span class="comment" id="6076960">//&nbsp;Another&nbsp;common&nbsp;strategy&nbsp;is&nbsp;to&nbsp;use&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;e.EncodeToken</span><br>
<span class="lineno"></span><span class="comment" id="6077029">//&nbsp;to&nbsp;generate&nbsp;the&nbsp;XML&nbsp;output&nbsp;one&nbsp;token&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6077080">//&nbsp;The&nbsp;sequence&nbsp;of&nbsp;encoded&nbsp;tokens&nbsp;must&nbsp;make&nbsp;up&nbsp;zero&nbsp;or&nbsp;more&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="6077146">//&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="6077163">type</span>&nbsp;<span class="ident" id="6077168">Marshaler</span>&nbsp;<span class="keyword" id="6077178">interface</span>&nbsp;<span class="op" id="6077188">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6077191">MarshalXML</span><span class="op" id="6077201">(</span><span class="ident" id="6077202">e</span>&nbsp;<span class="op" id="6077204">*</span><span class="ident" id="6077205">Encoder</span><span class="op" id="6077212">,</span>&nbsp;<span class="ident" id="6077214">start</span>&nbsp;<span class="ident" id="6077220">StartElement</span><span class="op" id="6077232">)</span>&nbsp;<span class="builtintype" id="6077234">error</span><br>
<span class="lineno"></span><span class="op" id="6077240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6077243">//&nbsp;MarshalerAttr&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="6077317">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;attributes.</span><br>
<span class="lineno">100</span><span class="comment" id="6077358">//</span><br>
<span class="lineno"></span><span class="comment" id="6077361">//&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;an&nbsp;XML&nbsp;attribute&nbsp;with&nbsp;the&nbsp;encoded&nbsp;value&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="6077444">//&nbsp;Using&nbsp;name&nbsp;as&nbsp;the&nbsp;attribute&nbsp;name&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="6077510">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;attribute&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="6077573">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno">105</span><span class="comment" id="6077590">//&nbsp;If&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;the&nbsp;zero&nbsp;attribute&nbsp;Attr{},&nbsp;no&nbsp;attribute</span><br>
<span class="lineno"></span><span class="comment" id="6077659">//&nbsp;will&nbsp;be&nbsp;generated&nbsp;in&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="6077695">//&nbsp;MarshalXMLAttr&nbsp;is&nbsp;used&nbsp;only&nbsp;for&nbsp;struct&nbsp;fields&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6077753">//&nbsp;&#34;attr&#34;&nbsp;option&nbsp;in&nbsp;the&nbsp;field&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="6077788">type</span>&nbsp;<span class="ident" id="6077793">MarshalerAttr</span>&nbsp;<span class="keyword" id="6077807">interface</span>&nbsp;<span class="op" id="6077817">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6077820">MarshalXMLAttr</span><span class="op" id="6077834">(</span><span class="ident" id="6077835">name</span>&nbsp;<span class="ident" id="6077840">Name</span><span class="op" id="6077844">)</span>&nbsp;<span class="op" id="6077846">(</span><span class="ident" id="6077847">Attr</span><span class="op" id="6077851">,</span>&nbsp;<span class="builtintype" id="6077853">error</span><span class="op" id="6077858">)</span><br>
<span class="lineno"></span><span class="op" id="6077860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6077863">//&nbsp;MarshalIndent&nbsp;works&nbsp;like&nbsp;Marshal,&nbsp;but&nbsp;each&nbsp;XML&nbsp;element&nbsp;begins&nbsp;on&nbsp;a&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="6077937">//&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more</span><br>
<span class="lineno">115</span><span class="comment" id="6078009">//&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6078061">func</span>&nbsp;<span class="ident" id="6078066">MarshalIndent</span><span class="op" id="6078079">(</span><span class="ident" id="6078080">v</span>&nbsp;<span class="keyword" id="6078082">interface</span><span class="op" id="6078091">{</span><span class="op" id="6078092">}</span><span class="op" id="6078093">,</span>&nbsp;<span class="ident" id="6078095">prefix</span><span class="op" id="6078101">,</span>&nbsp;<span class="ident" id="6078103">indent</span>&nbsp;<span class="builtintype" id="6078110">string</span><span class="op" id="6078116">)</span>&nbsp;<span class="op" id="6078118">(</span><span class="op" id="6078119">[</span><span class="op" id="6078120">]</span><span class="builtintype" id="6078121">byte</span><span class="op" id="6078125">,</span>&nbsp;<span class="builtintype" id="6078127">error</span><span class="op" id="6078132">)</span>&nbsp;<span class="op" id="6078134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6078137">var</span>&nbsp;<span class="ident" id="6078141">b</span>&nbsp;<span class="ident" id="6078143">bytes</span><span class="op" id="6078148">.</span><span class="ident" id="6078149">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6078157">enc</span>&nbsp;<span class="op" id="6078161">:=</span>&nbsp;<span class="ident" id="6078164">NewEncoder</span><span class="op" id="6078174">(</span><span class="op" id="6078175">&amp;</span><span class="ident" id="6078176">b</span><span class="op" id="6078177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6078180">enc</span><span class="op" id="6078183">.</span><span class="ident" id="6078184">Indent</span><span class="op" id="6078190">(</span><span class="ident" id="6078191">prefix</span><span class="op" id="6078197">,</span>&nbsp;<span class="ident" id="6078199">indent</span><span class="op" id="6078205">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6078208">if</span>&nbsp;<span class="ident" id="6078211">err</span>&nbsp;<span class="op" id="6078215">:=</span>&nbsp;<span class="ident" id="6078218">enc</span><span class="op" id="6078221">.</span><span class="ident" id="6078222">Encode</span><span class="op" id="6078228">(</span><span class="ident" id="6078229">v</span><span class="op" id="6078230">)</span><span class="op" id="6078231">;</span>&nbsp;<span class="ident" id="6078233">err</span>&nbsp;<span class="op" id="6078237">!=</span>&nbsp;<span class="ident" id="6078240">nil</span>&nbsp;<span class="op" id="6078244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6078248">return</span>&nbsp;<span class="ident" id="6078255">nil</span><span class="op" id="6078258">,</span>&nbsp;<span class="ident" id="6078260">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6078265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6078268">return</span>&nbsp;<span class="ident" id="6078275">b</span><span class="op" id="6078276">.</span><span class="ident" id="6078277">Bytes</span><span class="op" id="6078282">(</span><span class="op" id="6078283">)</span><span class="op" id="6078284">,</span>&nbsp;<span class="ident" id="6078286">nil</span><br>
<span class="lineno"></span><span class="op" id="6078290">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="6078293">//&nbsp;An&nbsp;Encoder&nbsp;writes&nbsp;XML&nbsp;data&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6078344">type</span>&nbsp;<span class="ident" id="6078349">Encoder</span>&nbsp;<span class="keyword" id="6078357">struct</span>&nbsp;<span class="op" id="6078364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6078367">p</span>&nbsp;<span class="ident" id="6078369">printer</span><br>
<span class="lineno"></span><span class="op" id="6078377">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="6078380">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;encoder&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="6078434">func</span>&nbsp;<span class="ident" id="6078439">NewEncoder</span><span class="op" id="6078449">(</span><span class="ident" id="6078450">w</span>&nbsp;<span class="ident" id="6078452">io</span><span class="op" id="6078454">.</span><span class="ident" id="6078455">Writer</span><span class="op" id="6078461">)</span>&nbsp;<span class="op" id="6078463">*</span><span class="ident" id="6078464">Encoder</span>&nbsp;<span class="op" id="6078472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6078475">e</span>&nbsp;<span class="op" id="6078477">:=</span>&nbsp;<span class="op" id="6078480">&amp;</span><span class="ident" id="6078481">Encoder</span><span class="op" id="6078488">{</span><span class="ident" id="6078489">printer</span><span class="op" id="6078496">{</span><span class="ident" id="6078497">Writer</span><span class="op" id="6078503">:</span>&nbsp;<span class="ident" id="6078505">bufio</span><span class="op" id="6078510">.</span><span class="ident" id="6078511">NewWriter</span><span class="op" id="6078520">(</span><span class="ident" id="6078521">w</span><span class="op" id="6078522">)</span><span class="op" id="6078523">}</span><span class="op" id="6078524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6078527">e</span><span class="op" id="6078528">.</span><span class="ident" id="6078529">p</span><span class="op" id="6078530">.</span><span class="ident" id="6078531">encoder</span>&nbsp;<span class="op" id="6078539">=</span>&nbsp;<span class="ident" id="6078541">e</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6078544">return</span>&nbsp;<span class="ident" id="6078551">e</span><br>
<span class="lineno"></span><span class="op" id="6078553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6078556">//&nbsp;Indent&nbsp;sets&nbsp;the&nbsp;encoder&nbsp;to&nbsp;generate&nbsp;XML&nbsp;in&nbsp;which&nbsp;each&nbsp;element</span><br>
<span class="lineno"></span><span class="comment" id="6078621">//&nbsp;begins&nbsp;on&nbsp;a&nbsp;new&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by</span><br>
<span class="lineno">140</span><span class="comment" id="6078697">//&nbsp;one&nbsp;or&nbsp;more&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6078761">func</span>&nbsp;<span class="op" id="6078766">(</span><span class="ident" id="6078767">enc</span>&nbsp;<span class="op" id="6078771">*</span><span class="ident" id="6078772">Encoder</span><span class="op" id="6078779">)</span>&nbsp;<span class="ident" id="6078781">Indent</span><span class="op" id="6078787">(</span><span class="ident" id="6078788">prefix</span><span class="op" id="6078794">,</span>&nbsp;<span class="ident" id="6078796">indent</span>&nbsp;<span class="builtintype" id="6078803">string</span><span class="op" id="6078809">)</span>&nbsp;<span class="op" id="6078811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6078814">enc</span><span class="op" id="6078817">.</span><span class="ident" id="6078818">p</span><span class="op" id="6078819">.</span><span class="ident" id="6078820">prefix</span>&nbsp;<span class="op" id="6078827">=</span>&nbsp;<span class="ident" id="6078829">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6078837">enc</span><span class="op" id="6078840">.</span><span class="ident" id="6078841">p</span><span class="op" id="6078842">.</span><span class="ident" id="6078843">indent</span>&nbsp;<span class="op" id="6078850">=</span>&nbsp;<span class="ident" id="6078852">indent</span><br>
<span class="lineno"></span><span class="op" id="6078859">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="6078862">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="6078916">//</span><br>
<span class="lineno"></span><span class="comment" id="6078919">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="6078989">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">150</span><span class="comment" id="6079013">//</span><br>
<span class="lineno"></span><span class="comment" id="6079016">//&nbsp;Encode&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="6079056">func</span>&nbsp;<span class="op" id="6079061">(</span><span class="ident" id="6079062">enc</span>&nbsp;<span class="op" id="6079066">*</span><span class="ident" id="6079067">Encoder</span><span class="op" id="6079074">)</span>&nbsp;<span class="ident" id="6079076">Encode</span><span class="op" id="6079082">(</span><span class="ident" id="6079083">v</span>&nbsp;<span class="keyword" id="6079085">interface</span><span class="op" id="6079094">{</span><span class="op" id="6079095">}</span><span class="op" id="6079096">)</span>&nbsp;<span class="builtintype" id="6079098">error</span>&nbsp;<span class="op" id="6079104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6079107">err</span>&nbsp;<span class="op" id="6079111">:=</span>&nbsp;<span class="ident" id="6079114">enc</span><span class="op" id="6079117">.</span><span class="ident" id="6079118">p</span><span class="op" id="6079119">.</span><span class="ident" id="6079120">marshalValue</span><span class="op" id="6079132">(</span><span class="ident" id="6079133">reflect</span><span class="op" id="6079140">.</span><span class="ident" id="6079141">ValueOf</span><span class="op" id="6079148">(</span><span class="ident" id="6079149">v</span><span class="op" id="6079150">)</span><span class="op" id="6079151">,</span>&nbsp;<span class="ident" id="6079153">nil</span><span class="op" id="6079156">,</span>&nbsp;<span class="ident" id="6079158">nil</span><span class="op" id="6079161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6079164">if</span>&nbsp;<span class="ident" id="6079167">err</span>&nbsp;<span class="op" id="6079171">!=</span>&nbsp;<span class="ident" id="6079174">nil</span>&nbsp;<span class="op" id="6079178">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6079182">return</span>&nbsp;<span class="ident" id="6079189">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6079194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6079197">return</span>&nbsp;<span class="ident" id="6079204">enc</span><span class="op" id="6079207">.</span><span class="ident" id="6079208">p</span><span class="op" id="6079209">.</span><span class="ident" id="6079210">Flush</span><span class="op" id="6079215">(</span><span class="op" id="6079216">)</span><br>
<span class="lineno"></span><span class="op" id="6079218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="6079221">//&nbsp;EncodeElement&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="6079282">//&nbsp;using&nbsp;start&nbsp;as&nbsp;the&nbsp;outermost&nbsp;tag&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="6079335">//</span><br>
<span class="lineno"></span><span class="comment" id="6079338">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="6079408">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">165</span><span class="comment" id="6079432">//</span><br>
<span class="lineno"></span><span class="comment" id="6079435">//&nbsp;EncodeElement&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="6079482">func</span>&nbsp;<span class="op" id="6079487">(</span><span class="ident" id="6079488">enc</span>&nbsp;<span class="op" id="6079492">*</span><span class="ident" id="6079493">Encoder</span><span class="op" id="6079500">)</span>&nbsp;<span class="ident" id="6079502">EncodeElement</span><span class="op" id="6079515">(</span><span class="ident" id="6079516">v</span>&nbsp;<span class="keyword" id="6079518">interface</span><span class="op" id="6079527">{</span><span class="op" id="6079528">}</span><span class="op" id="6079529">,</span>&nbsp;<span class="ident" id="6079531">start</span>&nbsp;<span class="ident" id="6079537">StartElement</span><span class="op" id="6079549">)</span>&nbsp;<span class="builtintype" id="6079551">error</span>&nbsp;<span class="op" id="6079557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6079560">err</span>&nbsp;<span class="op" id="6079564">:=</span>&nbsp;<span class="ident" id="6079567">enc</span><span class="op" id="6079570">.</span><span class="ident" id="6079571">p</span><span class="op" id="6079572">.</span><span class="ident" id="6079573">marshalValue</span><span class="op" id="6079585">(</span><span class="ident" id="6079586">reflect</span><span class="op" id="6079593">.</span><span class="ident" id="6079594">ValueOf</span><span class="op" id="6079601">(</span><span class="ident" id="6079602">v</span><span class="op" id="6079603">)</span><span class="op" id="6079604">,</span>&nbsp;<span class="ident" id="6079606">nil</span><span class="op" id="6079609">,</span>&nbsp;<span class="op" id="6079611">&amp;</span><span class="ident" id="6079612">start</span><span class="op" id="6079617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6079620">if</span>&nbsp;<span class="ident" id="6079623">err</span>&nbsp;<span class="op" id="6079627">!=</span>&nbsp;<span class="ident" id="6079630">nil</span>&nbsp;<span class="op" id="6079634">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6079638">return</span>&nbsp;<span class="ident" id="6079645">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6079650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6079653">return</span>&nbsp;<span class="ident" id="6079660">enc</span><span class="op" id="6079663">.</span><span class="ident" id="6079664">p</span><span class="op" id="6079665">.</span><span class="ident" id="6079666">Flush</span><span class="op" id="6079671">(</span><span class="op" id="6079672">)</span><br>
<span class="lineno"></span><span class="op" id="6079674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6079677">var</span>&nbsp;<span class="op" id="6079681">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6079684">endComment</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6079697">=</span>&nbsp;<span class="op" id="6079699">[</span><span class="op" id="6079700">]</span><span class="builtintype" id="6079701">byte</span><span class="op" id="6079705">(</span><span class="string" id="6079706">&#34;--&gt;&#34;</span><span class="op" id="6079711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6079714">endProcInst</span>&nbsp;&nbsp;<span class="op" id="6079727">=</span>&nbsp;<span class="op" id="6079729">[</span><span class="op" id="6079730">]</span><span class="builtintype" id="6079731">byte</span><span class="op" id="6079735">(</span><span class="string" id="6079736">&#34;?&gt;&#34;</span><span class="op" id="6079740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6079743">endDirective</span>&nbsp;<span class="op" id="6079756">=</span>&nbsp;<span class="op" id="6079758">[</span><span class="op" id="6079759">]</span><span class="builtintype" id="6079760">byte</span><span class="op" id="6079764">(</span><span class="string" id="6079765">&#34;&gt;&#34;</span><span class="op" id="6079768">)</span><br>
<span class="lineno"></span><span class="op" id="6079770">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="6079773">//&nbsp;EncodeToken&nbsp;writes&nbsp;the&nbsp;given&nbsp;XML&nbsp;token&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="6079830">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;StartElement&nbsp;and&nbsp;EndElement&nbsp;tokens&nbsp;are&nbsp;not&nbsp;properly&nbsp;matched.</span><br>
<span class="lineno"></span><span class="comment" id="6079917">//</span><br>
<span class="lineno"></span><span class="comment" id="6079920">//&nbsp;EncodeToken&nbsp;does&nbsp;not&nbsp;call&nbsp;Flush,&nbsp;because&nbsp;usually&nbsp;it&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;larger&nbsp;operation</span><br>
<span class="lineno">185</span><span class="comment" id="6080005">//&nbsp;such&nbsp;as&nbsp;Encode&nbsp;or&nbsp;EncodeElement&nbsp;(or&nbsp;a&nbsp;custom&nbsp;Marshaler&#39;s&nbsp;MarshalXML&nbsp;invoked</span><br>
<span class="lineno"></span><span class="comment" id="6080084">//&nbsp;during&nbsp;those),&nbsp;and&nbsp;those&nbsp;will&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished.</span><br>
<span class="lineno"></span><span class="comment" id="6080143">//&nbsp;Callers&nbsp;that&nbsp;create&nbsp;an&nbsp;Encoder&nbsp;and&nbsp;then&nbsp;invoke&nbsp;EncodeToken&nbsp;directly,&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="6080223">//&nbsp;using&nbsp;Encode&nbsp;or&nbsp;EncodeElement,&nbsp;need&nbsp;to&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished&nbsp;to&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="6080300">//&nbsp;that&nbsp;the&nbsp;XML&nbsp;is&nbsp;written&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">190</span><span class="comment" id="6080353">//</span><br>
<span class="lineno"></span><span class="comment" id="6080356">//&nbsp;EncodeToken&nbsp;allows&nbsp;writing&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;Target&nbsp;set&nbsp;to&nbsp;&#34;xml&#34;&nbsp;only&nbsp;as&nbsp;the&nbsp;first&nbsp;token</span><br>
<span class="lineno"></span><span class="comment" id="6080446">//&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6080464">func</span>&nbsp;<span class="op" id="6080469">(</span><span class="ident" id="6080470">enc</span>&nbsp;<span class="op" id="6080474">*</span><span class="ident" id="6080475">Encoder</span><span class="op" id="6080482">)</span>&nbsp;<span class="ident" id="6080484">EncodeToken</span><span class="op" id="6080495">(</span><span class="ident" id="6080496">t</span>&nbsp;<span class="ident" id="6080498">Token</span><span class="op" id="6080503">)</span>&nbsp;<span class="builtintype" id="6080505">error</span>&nbsp;<span class="op" id="6080511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080514">p</span>&nbsp;<span class="op" id="6080516">:=</span>&nbsp;<span class="op" id="6080519">&amp;</span><span class="ident" id="6080520">enc</span><span class="op" id="6080523">.</span><span class="ident" id="6080524">p</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080527">switch</span>&nbsp;<span class="ident" id="6080534">t</span>&nbsp;<span class="op" id="6080536">:=</span>&nbsp;<span class="ident" id="6080539">t</span><span class="op" id="6080540">.</span><span class="op" id="6080541">(</span><span class="keyword" id="6080542">type</span><span class="op" id="6080546">)</span>&nbsp;<span class="op" id="6080548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080551">case</span>&nbsp;<span class="ident" id="6080556">StartElement</span><span class="op" id="6080568">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080572">if</span>&nbsp;<span class="ident" id="6080575">err</span>&nbsp;<span class="op" id="6080579">:=</span>&nbsp;<span class="ident" id="6080582">p</span><span class="op" id="6080583">.</span><span class="ident" id="6080584">writeStart</span><span class="op" id="6080594">(</span><span class="op" id="6080595">&amp;</span><span class="ident" id="6080596">t</span><span class="op" id="6080597">)</span><span class="op" id="6080598">;</span>&nbsp;<span class="ident" id="6080600">err</span>&nbsp;<span class="op" id="6080604">!=</span>&nbsp;<span class="ident" id="6080607">nil</span>&nbsp;<span class="op" id="6080611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080616">return</span>&nbsp;<span class="ident" id="6080623">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6080629">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080632">case</span>&nbsp;<span class="ident" id="6080637">EndElement</span><span class="op" id="6080647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080651">if</span>&nbsp;<span class="ident" id="6080654">err</span>&nbsp;<span class="op" id="6080658">:=</span>&nbsp;<span class="ident" id="6080661">p</span><span class="op" id="6080662">.</span><span class="ident" id="6080663">writeEnd</span><span class="op" id="6080671">(</span><span class="ident" id="6080672">t</span><span class="op" id="6080673">.</span><span class="ident" id="6080674">Name</span><span class="op" id="6080678">)</span><span class="op" id="6080679">;</span>&nbsp;<span class="ident" id="6080681">err</span>&nbsp;<span class="op" id="6080685">!=</span>&nbsp;<span class="ident" id="6080688">nil</span>&nbsp;<span class="op" id="6080692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080697">return</span>&nbsp;<span class="ident" id="6080704">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6080710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080713">case</span>&nbsp;<span class="ident" id="6080718">CharData</span><span class="op" id="6080726">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080730">EscapeText</span><span class="op" id="6080740">(</span><span class="ident" id="6080741">p</span><span class="op" id="6080742">,</span>&nbsp;<span class="ident" id="6080744">t</span><span class="op" id="6080745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080748">case</span>&nbsp;<span class="ident" id="6080753">Comment</span><span class="op" id="6080760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080764">if</span>&nbsp;<span class="ident" id="6080767">bytes</span><span class="op" id="6080772">.</span><span class="ident" id="6080773">Contains</span><span class="op" id="6080781">(</span><span class="ident" id="6080782">t</span><span class="op" id="6080783">,</span>&nbsp;<span class="ident" id="6080785">endComment</span><span class="op" id="6080795">)</span>&nbsp;<span class="op" id="6080797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080802">return</span>&nbsp;<span class="ident" id="6080809">fmt</span><span class="op" id="6080812">.</span><span class="ident" id="6080813">Errorf</span><span class="op" id="6080819">(</span><span class="string" id="6080820">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Comment&nbsp;containing&nbsp;--&gt;&nbsp;marker&#34;</span><span class="op" id="6080871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6080875">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080879">p</span><span class="op" id="6080880">.</span><span class="ident" id="6080881">WriteString</span><span class="op" id="6080892">(</span><span class="string" id="6080893">&#34;&lt;!--&#34;</span><span class="op" id="6080899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080903">p</span><span class="op" id="6080904">.</span><span class="ident" id="6080905">Write</span><span class="op" id="6080910">(</span><span class="ident" id="6080911">t</span><span class="op" id="6080912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080916">p</span><span class="op" id="6080917">.</span><span class="ident" id="6080918">WriteString</span><span class="op" id="6080929">(</span><span class="string" id="6080930">&#34;--&gt;&#34;</span><span class="op" id="6080935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080939">return</span>&nbsp;<span class="ident" id="6080946">p</span><span class="op" id="6080947">.</span><span class="ident" id="6080948">cachedWriteError</span><span class="op" id="6080964">(</span><span class="op" id="6080965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080968">case</span>&nbsp;<span class="ident" id="6080973">ProcInst</span><span class="op" id="6080981">:</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6080985">//&nbsp;First&nbsp;token&nbsp;to&nbsp;be&nbsp;encoded&nbsp;which&nbsp;is&nbsp;also&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;target&nbsp;of&nbsp;xml</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081060">//&nbsp;is&nbsp;the&nbsp;xml&nbsp;declaration.&nbsp;&nbsp;The&nbsp;only&nbsp;ProcInst&nbsp;where&nbsp;target&nbsp;of&nbsp;xml&nbsp;is&nbsp;allowed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081140">if</span>&nbsp;<span class="ident" id="6081143">t</span><span class="op" id="6081144">.</span><span class="ident" id="6081145">Target</span>&nbsp;<span class="op" id="6081152">==</span>&nbsp;<span class="string" id="6081155">&#34;xml&#34;</span>&nbsp;<span class="op" id="6081161">&amp;&amp;</span>&nbsp;<span class="ident" id="6081164">p</span><span class="op" id="6081165">.</span><span class="ident" id="6081166">Buffered</span><span class="op" id="6081174">(</span><span class="op" id="6081175">)</span>&nbsp;<span class="op" id="6081177">!=</span>&nbsp;<span class="num" id="6081180">0</span>&nbsp;<span class="op" id="6081182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081187">return</span>&nbsp;<span class="ident" id="6081194">fmt</span><span class="op" id="6081197">.</span><span class="ident" id="6081198">Errorf</span><span class="op" id="6081204">(</span><span class="string" id="6081205">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;xml&nbsp;target&nbsp;only&nbsp;valid&nbsp;for&nbsp;xml&nbsp;declaration,&nbsp;first&nbsp;token&nbsp;encoded&#34;</span><span class="op" id="6081298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081302">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081306">if</span>&nbsp;<span class="op" id="6081309">!</span><span class="ident" id="6081310">isNameString</span><span class="op" id="6081322">(</span><span class="ident" id="6081323">t</span><span class="op" id="6081324">.</span><span class="ident" id="6081325">Target</span><span class="op" id="6081331">)</span>&nbsp;<span class="op" id="6081333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081338">return</span>&nbsp;<span class="ident" id="6081345">fmt</span><span class="op" id="6081348">.</span><span class="ident" id="6081349">Errorf</span><span class="op" id="6081355">(</span><span class="string" id="6081356">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;with&nbsp;invalid&nbsp;Target&#34;</span><span class="op" id="6081406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081414">if</span>&nbsp;<span class="ident" id="6081417">bytes</span><span class="op" id="6081422">.</span><span class="ident" id="6081423">Contains</span><span class="op" id="6081431">(</span><span class="ident" id="6081432">t</span><span class="op" id="6081433">.</span><span class="ident" id="6081434">Inst</span><span class="op" id="6081438">,</span>&nbsp;<span class="ident" id="6081440">endProcInst</span><span class="op" id="6081451">)</span>&nbsp;<span class="op" id="6081453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081458">return</span>&nbsp;<span class="ident" id="6081465">fmt</span><span class="op" id="6081468">.</span><span class="ident" id="6081469">Errorf</span><span class="op" id="6081475">(</span><span class="string" id="6081476">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;containing&nbsp;?&gt;&nbsp;marker&#34;</span><span class="op" id="6081527">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081535">p</span><span class="op" id="6081536">.</span><span class="ident" id="6081537">WriteString</span><span class="op" id="6081548">(</span><span class="string" id="6081549">&#34;&lt;?&#34;</span><span class="op" id="6081553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081557">p</span><span class="op" id="6081558">.</span><span class="ident" id="6081559">WriteString</span><span class="op" id="6081570">(</span><span class="ident" id="6081571">t</span><span class="op" id="6081572">.</span><span class="ident" id="6081573">Target</span><span class="op" id="6081579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081583">if</span>&nbsp;<span class="builtinfunc" id="6081586">len</span><span class="op" id="6081589">(</span><span class="ident" id="6081590">t</span><span class="op" id="6081591">.</span><span class="ident" id="6081592">Inst</span><span class="op" id="6081596">)</span>&nbsp;<span class="op" id="6081598">&gt;</span>&nbsp;<span class="num" id="6081600">0</span>&nbsp;<span class="op" id="6081602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081607">p</span><span class="op" id="6081608">.</span><span class="ident" id="6081609">WriteByte</span><span class="op" id="6081618">(</span><span class="string" id="6081619">&#39;&nbsp;&#39;</span><span class="op" id="6081622">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081627">p</span><span class="op" id="6081628">.</span><span class="ident" id="6081629">Write</span><span class="op" id="6081634">(</span><span class="ident" id="6081635">t</span><span class="op" id="6081636">.</span><span class="ident" id="6081637">Inst</span><span class="op" id="6081641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081649">p</span><span class="op" id="6081650">.</span><span class="ident" id="6081651">WriteString</span><span class="op" id="6081662">(</span><span class="string" id="6081663">&#34;?&gt;&#34;</span><span class="op" id="6081667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081670">case</span>&nbsp;<span class="ident" id="6081675">Directive</span><span class="op" id="6081684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081688">if</span>&nbsp;<span class="ident" id="6081691">bytes</span><span class="op" id="6081696">.</span><span class="ident" id="6081697">Contains</span><span class="op" id="6081705">(</span><span class="ident" id="6081706">t</span><span class="op" id="6081707">,</span>&nbsp;<span class="ident" id="6081709">endDirective</span><span class="op" id="6081721">)</span>&nbsp;<span class="op" id="6081723">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081728">return</span>&nbsp;<span class="ident" id="6081735">fmt</span><span class="op" id="6081738">.</span><span class="ident" id="6081739">Errorf</span><span class="op" id="6081745">(</span><span class="string" id="6081746">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Directive&nbsp;containing&nbsp;&gt;&nbsp;marker&#34;</span><span class="op" id="6081797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081805">p</span><span class="op" id="6081806">.</span><span class="ident" id="6081807">WriteString</span><span class="op" id="6081818">(</span><span class="string" id="6081819">&#34;&lt;!&#34;</span><span class="op" id="6081823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081827">p</span><span class="op" id="6081828">.</span><span class="ident" id="6081829">Write</span><span class="op" id="6081834">(</span><span class="ident" id="6081835">t</span><span class="op" id="6081836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081840">p</span><span class="op" id="6081841">.</span><span class="ident" id="6081842">WriteString</span><span class="op" id="6081853">(</span><span class="string" id="6081854">&#34;&gt;&#34;</span><span class="op" id="6081857">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081863">return</span>&nbsp;<span class="ident" id="6081870">p</span><span class="op" id="6081871">.</span><span class="ident" id="6081872">cachedWriteError</span><span class="op" id="6081888">(</span><span class="op" id="6081889">)</span><br>
<span class="lineno"></span><span class="op" id="6081891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6081894">//&nbsp;Flush&nbsp;flushes&nbsp;any&nbsp;buffered&nbsp;XML&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">245</span><span class="comment" id="6081954">//&nbsp;See&nbsp;the&nbsp;EncodeToken&nbsp;documentation&nbsp;for&nbsp;details&nbsp;about&nbsp;when&nbsp;it&nbsp;is&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="keyword" id="6082031">func</span>&nbsp;<span class="op" id="6082036">(</span><span class="ident" id="6082037">enc</span>&nbsp;<span class="op" id="6082041">*</span><span class="ident" id="6082042">Encoder</span><span class="op" id="6082049">)</span>&nbsp;<span class="ident" id="6082051">Flush</span><span class="op" id="6082056">(</span><span class="op" id="6082057">)</span>&nbsp;<span class="builtintype" id="6082059">error</span>&nbsp;<span class="op" id="6082065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6082068">return</span>&nbsp;<span class="ident" id="6082075">enc</span><span class="op" id="6082078">.</span><span class="ident" id="6082079">p</span><span class="op" id="6082080">.</span><span class="ident" id="6082081">Flush</span><span class="op" id="6082086">(</span><span class="op" id="6082087">)</span><br>
<span class="lineno"></span><span class="op" id="6082089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="6082092">type</span>&nbsp;<span class="ident" id="6082097">printer</span>&nbsp;<span class="keyword" id="6082105">struct</span>&nbsp;<span class="op" id="6082112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6082115">*</span><span class="ident" id="6082116">bufio</span><span class="op" id="6082121">.</span><span class="ident" id="6082122">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082130">encoder</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6082141">*</span><span class="ident" id="6082142">Encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082151">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6082162">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082167">indent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6082178">string</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082186">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6082197">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082205">depth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6082216">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082221">indentedIn</span>&nbsp;<span class="builtintype" id="6082232">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082238">putNewline</span>&nbsp;<span class="builtintype" id="6082249">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082255">attrNS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6082266">map</span><span class="op" id="6082269">[</span><span class="builtintype" id="6082270">string</span><span class="op" id="6082276">]</span><span class="builtintype" id="6082277">string</span>&nbsp;<span class="comment" id="6082284">//&nbsp;map&nbsp;prefix&nbsp;-&gt;&nbsp;name&nbsp;space</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082313">attrPrefix</span>&nbsp;<span class="keyword" id="6082324">map</span><span class="op" id="6082327">[</span><span class="builtintype" id="6082328">string</span><span class="op" id="6082334">]</span><span class="builtintype" id="6082335">string</span>&nbsp;<span class="comment" id="6082342">//&nbsp;map&nbsp;name&nbsp;space&nbsp;-&gt;&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082371">prefixes</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6082382">[</span><span class="op" id="6082383">]</span><span class="builtintype" id="6082384">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082392">tags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6082403">[</span><span class="op" id="6082404">]</span><span class="ident" id="6082405">Name</span><br>
<span class="lineno"></span><span class="op" id="6082410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="6082413">//&nbsp;createAttrPrefix&nbsp;finds&nbsp;the&nbsp;name&nbsp;space&nbsp;prefix&nbsp;attribute&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;given&nbsp;name&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="6082504">//&nbsp;defining&nbsp;a&nbsp;new&nbsp;prefix&nbsp;if&nbsp;necessary.&nbsp;It&nbsp;returns&nbsp;the&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="6082566">func</span>&nbsp;<span class="op" id="6082571">(</span><span class="ident" id="6082572">p</span>&nbsp;<span class="op" id="6082574">*</span><span class="ident" id="6082575">printer</span><span class="op" id="6082582">)</span>&nbsp;<span class="ident" id="6082584">createAttrPrefix</span><span class="op" id="6082600">(</span><span class="ident" id="6082601">url</span>&nbsp;<span class="builtintype" id="6082605">string</span><span class="op" id="6082611">)</span>&nbsp;<span class="builtintype" id="6082613">string</span>&nbsp;<span class="op" id="6082620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6082623">if</span>&nbsp;<span class="ident" id="6082626">prefix</span>&nbsp;<span class="op" id="6082633">:=</span>&nbsp;<span class="ident" id="6082636">p</span><span class="op" id="6082637">.</span><span class="ident" id="6082638">attrPrefix</span><span class="op" id="6082648">[</span><span class="ident" id="6082649">url</span><span class="op" id="6082652">]</span><span class="op" id="6082653">;</span>&nbsp;<span class="ident" id="6082655">prefix</span>&nbsp;<span class="op" id="6082662">!=</span>&nbsp;<span class="string" id="6082665">&#34;&#34;</span>&nbsp;<span class="op" id="6082668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6082672">return</span>&nbsp;<span class="ident" id="6082679">prefix</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6082687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6082691">//&nbsp;The&nbsp;&#34;http://www.w3.org/XML/1998/namespace&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;predefined&nbsp;as&nbsp;&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6082772">//&nbsp;and&nbsp;must&nbsp;be&nbsp;referred&nbsp;to&nbsp;that&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6082810">//&nbsp;(The&nbsp;&#34;http://www.w3.org/2000/xmlns/&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;also&nbsp;predefined&nbsp;as&nbsp;&#34;xmlns&#34;,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6082893">//&nbsp;but&nbsp;users&nbsp;should&nbsp;not&nbsp;be&nbsp;trying&nbsp;to&nbsp;use&nbsp;that&nbsp;one&nbsp;directly&nbsp;-&nbsp;that&#39;s&nbsp;our&nbsp;job.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6082972">if</span>&nbsp;<span class="ident" id="6082975">url</span>&nbsp;<span class="op" id="6082979">==</span>&nbsp;<span class="ident" id="6082982">xmlURL</span>&nbsp;<span class="op" id="6082989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6082993">return</span>&nbsp;<span class="string" id="6083000">&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083011">//&nbsp;Need&nbsp;to&nbsp;define&nbsp;a&nbsp;new&nbsp;name&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083048">if</span>&nbsp;<span class="ident" id="6083051">p</span><span class="op" id="6083052">.</span><span class="ident" id="6083053">attrPrefix</span>&nbsp;<span class="op" id="6083064">==</span>&nbsp;<span class="ident" id="6083067">nil</span>&nbsp;<span class="op" id="6083071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083075">p</span><span class="op" id="6083076">.</span><span class="ident" id="6083077">attrPrefix</span>&nbsp;<span class="op" id="6083088">=</span>&nbsp;<span class="builtinfunc" id="6083090">make</span><span class="op" id="6083094">(</span><span class="keyword" id="6083095">map</span><span class="op" id="6083098">[</span><span class="builtintype" id="6083099">string</span><span class="op" id="6083105">]</span><span class="builtintype" id="6083106">string</span><span class="op" id="6083112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083116">p</span><span class="op" id="6083117">.</span><span class="ident" id="6083118">attrNS</span>&nbsp;<span class="op" id="6083125">=</span>&nbsp;<span class="builtinfunc" id="6083127">make</span><span class="op" id="6083131">(</span><span class="keyword" id="6083132">map</span><span class="op" id="6083135">[</span><span class="builtintype" id="6083136">string</span><span class="op" id="6083142">]</span><span class="builtintype" id="6083143">string</span><span class="op" id="6083149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083152">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083156">//&nbsp;Pick&nbsp;a&nbsp;name.&nbsp;We&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;the&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083217">//&nbsp;but&nbsp;fall&nbsp;back&nbsp;to&nbsp;_.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083241">prefix</span>&nbsp;<span class="op" id="6083248">:=</span>&nbsp;<span class="ident" id="6083251">strings</span><span class="op" id="6083258">.</span><span class="ident" id="6083259">TrimRight</span><span class="op" id="6083268">(</span><span class="ident" id="6083269">url</span><span class="op" id="6083272">,</span>&nbsp;<span class="string" id="6083274">&#34;/&#34;</span><span class="op" id="6083277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083280">if</span>&nbsp;<span class="ident" id="6083283">i</span>&nbsp;<span class="op" id="6083285">:=</span>&nbsp;<span class="ident" id="6083288">strings</span><span class="op" id="6083295">.</span><span class="ident" id="6083296">LastIndex</span><span class="op" id="6083305">(</span><span class="ident" id="6083306">prefix</span><span class="op" id="6083312">,</span>&nbsp;<span class="string" id="6083314">&#34;/&#34;</span><span class="op" id="6083317">)</span><span class="op" id="6083318">;</span>&nbsp;<span class="ident" id="6083320">i</span>&nbsp;<span class="op" id="6083322">&gt;=</span>&nbsp;<span class="num" id="6083325">0</span>&nbsp;<span class="op" id="6083327">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083331">prefix</span>&nbsp;<span class="op" id="6083338">=</span>&nbsp;<span class="ident" id="6083340">prefix</span><span class="op" id="6083346">[</span><span class="ident" id="6083347">i</span><span class="op" id="6083348">+</span><span class="num" id="6083349">1</span><span class="op" id="6083350">:</span><span class="op" id="6083351">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083357">if</span>&nbsp;<span class="ident" id="6083360">prefix</span>&nbsp;<span class="op" id="6083367">==</span>&nbsp;<span class="string" id="6083370">&#34;&#34;</span>&nbsp;<span class="op" id="6083373">||</span>&nbsp;<span class="op" id="6083376">!</span><span class="ident" id="6083377">isName</span><span class="op" id="6083383">(</span><span class="op" id="6083384">[</span><span class="op" id="6083385">]</span><span class="builtintype" id="6083386">byte</span><span class="op" id="6083390">(</span><span class="ident" id="6083391">prefix</span><span class="op" id="6083397">)</span><span class="op" id="6083398">)</span>&nbsp;<span class="op" id="6083400">||</span>&nbsp;<span class="ident" id="6083403">strings</span><span class="op" id="6083410">.</span><span class="ident" id="6083411">Contains</span><span class="op" id="6083419">(</span><span class="ident" id="6083420">prefix</span><span class="op" id="6083426">,</span>&nbsp;<span class="string" id="6083428">&#34;:&#34;</span><span class="op" id="6083431">)</span>&nbsp;<span class="op" id="6083433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083437">prefix</span>&nbsp;<span class="op" id="6083444">=</span>&nbsp;<span class="string" id="6083446">&#34;_&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083451">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083454">if</span>&nbsp;<span class="ident" id="6083457">strings</span><span class="op" id="6083464">.</span><span class="ident" id="6083465">HasPrefix</span><span class="op" id="6083474">(</span><span class="ident" id="6083475">prefix</span><span class="op" id="6083481">,</span>&nbsp;<span class="string" id="6083483">&#34;xml&#34;</span><span class="op" id="6083488">)</span>&nbsp;<span class="op" id="6083490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083494">//&nbsp;xmlanything&nbsp;is&nbsp;reserved.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083524">prefix</span>&nbsp;<span class="op" id="6083531">=</span>&nbsp;<span class="string" id="6083533">&#34;_&#34;</span>&nbsp;<span class="op" id="6083537">+</span>&nbsp;<span class="ident" id="6083539">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083550">if</span>&nbsp;<span class="ident" id="6083553">p</span><span class="op" id="6083554">.</span><span class="ident" id="6083555">attrNS</span><span class="op" id="6083561">[</span><span class="ident" id="6083562">prefix</span><span class="op" id="6083568">]</span>&nbsp;<span class="op" id="6083570">!=</span>&nbsp;<span class="string" id="6083573">&#34;&#34;</span>&nbsp;<span class="op" id="6083576">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083580">//&nbsp;Name&nbsp;is&nbsp;taken.&nbsp;Find&nbsp;a&nbsp;better&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083619">for</span>&nbsp;<span class="ident" id="6083623">p</span><span class="op" id="6083624">.</span><span class="ident" id="6083625">seq</span><span class="op" id="6083628">++</span><span class="op" id="6083630">;</span>&nbsp;<span class="op" id="6083632">;</span>&nbsp;<span class="ident" id="6083634">p</span><span class="op" id="6083635">.</span><span class="ident" id="6083636">seq</span><span class="op" id="6083639">++</span>&nbsp;<span class="op" id="6083642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083647">if</span>&nbsp;<span class="ident" id="6083650">id</span>&nbsp;<span class="op" id="6083653">:=</span>&nbsp;<span class="ident" id="6083656">prefix</span>&nbsp;<span class="op" id="6083663">+</span>&nbsp;<span class="string" id="6083665">&#34;_&#34;</span>&nbsp;<span class="op" id="6083669">+</span>&nbsp;<span class="ident" id="6083671">strconv</span><span class="op" id="6083678">.</span><span class="ident" id="6083679">Itoa</span><span class="op" id="6083683">(</span><span class="ident" id="6083684">p</span><span class="op" id="6083685">.</span><span class="ident" id="6083686">seq</span><span class="op" id="6083689">)</span><span class="op" id="6083690">;</span>&nbsp;<span class="ident" id="6083692">p</span><span class="op" id="6083693">.</span><span class="ident" id="6083694">attrNS</span><span class="op" id="6083700">[</span><span class="ident" id="6083701">id</span><span class="op" id="6083703">]</span>&nbsp;<span class="op" id="6083705">==</span>&nbsp;<span class="string" id="6083708">&#34;&#34;</span>&nbsp;<span class="op" id="6083711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083717">prefix</span>&nbsp;<span class="op" id="6083724">=</span>&nbsp;<span class="ident" id="6083726">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083733">break</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083753">p</span><span class="op" id="6083754">.</span><span class="ident" id="6083755">attrPrefix</span><span class="op" id="6083765">[</span><span class="ident" id="6083766">url</span><span class="op" id="6083769">]</span>&nbsp;<span class="op" id="6083771">=</span>&nbsp;<span class="ident" id="6083773">prefix</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083781">p</span><span class="op" id="6083782">.</span><span class="ident" id="6083783">attrNS</span><span class="op" id="6083789">[</span><span class="ident" id="6083790">prefix</span><span class="op" id="6083796">]</span>&nbsp;<span class="op" id="6083798">=</span>&nbsp;<span class="ident" id="6083800">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083806">p</span><span class="op" id="6083807">.</span><span class="ident" id="6083808">WriteString</span><span class="op" id="6083819">(</span><span class="string" id="6083820">`xmlns:`</span><span class="op" id="6083828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083831">p</span><span class="op" id="6083832">.</span><span class="ident" id="6083833">WriteString</span><span class="op" id="6083844">(</span><span class="ident" id="6083845">prefix</span><span class="op" id="6083851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083854">p</span><span class="op" id="6083855">.</span><span class="ident" id="6083856">WriteString</span><span class="op" id="6083867">(</span><span class="string" id="6083868">`=&#34;`</span><span class="op" id="6083872">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083875">EscapeText</span><span class="op" id="6083885">(</span><span class="ident" id="6083886">p</span><span class="op" id="6083887">,</span>&nbsp;<span class="op" id="6083889">[</span><span class="op" id="6083890">]</span><span class="builtintype" id="6083891">byte</span><span class="op" id="6083895">(</span><span class="ident" id="6083896">url</span><span class="op" id="6083899">)</span><span class="op" id="6083900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083903">p</span><span class="op" id="6083904">.</span><span class="ident" id="6083905">WriteString</span><span class="op" id="6083916">(</span><span class="string" id="6083917">`&#34;&nbsp;`</span><span class="op" id="6083921">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083925">p</span><span class="op" id="6083926">.</span><span class="ident" id="6083927">prefixes</span>&nbsp;<span class="op" id="6083936">=</span>&nbsp;<span class="builtinfunc" id="6083938">append</span><span class="op" id="6083944">(</span><span class="ident" id="6083945">p</span><span class="op" id="6083946">.</span><span class="ident" id="6083947">prefixes</span><span class="op" id="6083955">,</span>&nbsp;<span class="ident" id="6083957">prefix</span><span class="op" id="6083963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083967">return</span>&nbsp;<span class="ident" id="6083974">prefix</span><br>
<span class="lineno"></span><span class="op" id="6083981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6083984">//&nbsp;deleteAttrPrefix&nbsp;removes&nbsp;an&nbsp;attribute&nbsp;name&nbsp;space&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="6084044">func</span>&nbsp;<span class="op" id="6084049">(</span><span class="ident" id="6084050">p</span>&nbsp;<span class="op" id="6084052">*</span><span class="ident" id="6084053">printer</span><span class="op" id="6084060">)</span>&nbsp;<span class="ident" id="6084062">deleteAttrPrefix</span><span class="op" id="6084078">(</span><span class="ident" id="6084079">prefix</span>&nbsp;<span class="builtintype" id="6084086">string</span><span class="op" id="6084092">)</span>&nbsp;<span class="op" id="6084094">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6084097">delete</span><span class="op" id="6084103">(</span><span class="ident" id="6084104">p</span><span class="op" id="6084105">.</span><span class="ident" id="6084106">attrPrefix</span><span class="op" id="6084116">,</span>&nbsp;<span class="ident" id="6084118">p</span><span class="op" id="6084119">.</span><span class="ident" id="6084120">attrNS</span><span class="op" id="6084126">[</span><span class="ident" id="6084127">prefix</span><span class="op" id="6084133">]</span><span class="op" id="6084134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6084137">delete</span><span class="op" id="6084143">(</span><span class="ident" id="6084144">p</span><span class="op" id="6084145">.</span><span class="ident" id="6084146">attrNS</span><span class="op" id="6084152">,</span>&nbsp;<span class="ident" id="6084154">prefix</span><span class="op" id="6084160">)</span><br>
<span class="lineno"></span><span class="op" id="6084162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6084165">func</span>&nbsp;<span class="op" id="6084170">(</span><span class="ident" id="6084171">p</span>&nbsp;<span class="op" id="6084173">*</span><span class="ident" id="6084174">printer</span><span class="op" id="6084181">)</span>&nbsp;<span class="ident" id="6084183">markPrefix</span><span class="op" id="6084193">(</span><span class="op" id="6084194">)</span>&nbsp;<span class="op" id="6084196">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084199">p</span><span class="op" id="6084200">.</span><span class="ident" id="6084201">prefixes</span>&nbsp;<span class="op" id="6084210">=</span>&nbsp;<span class="builtinfunc" id="6084212">append</span><span class="op" id="6084218">(</span><span class="ident" id="6084219">p</span><span class="op" id="6084220">.</span><span class="ident" id="6084221">prefixes</span><span class="op" id="6084229">,</span>&nbsp;<span class="string" id="6084231">&#34;&#34;</span><span class="op" id="6084233">)</span><br>
<span class="lineno"></span><span class="op" id="6084235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6084238">func</span>&nbsp;<span class="op" id="6084243">(</span><span class="ident" id="6084244">p</span>&nbsp;<span class="op" id="6084246">*</span><span class="ident" id="6084247">printer</span><span class="op" id="6084254">)</span>&nbsp;<span class="ident" id="6084256">popPrefix</span><span class="op" id="6084265">(</span><span class="op" id="6084266">)</span>&nbsp;<span class="op" id="6084268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6084271">for</span>&nbsp;<span class="builtinfunc" id="6084275">len</span><span class="op" id="6084278">(</span><span class="ident" id="6084279">p</span><span class="op" id="6084280">.</span><span class="ident" id="6084281">prefixes</span><span class="op" id="6084289">)</span>&nbsp;<span class="op" id="6084291">&gt;</span>&nbsp;<span class="num" id="6084293">0</span>&nbsp;<span class="op" id="6084295">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084299">prefix</span>&nbsp;<span class="op" id="6084306">:=</span>&nbsp;<span class="ident" id="6084309">p</span><span class="op" id="6084310">.</span><span class="ident" id="6084311">prefixes</span><span class="op" id="6084319">[</span><span class="builtinfunc" id="6084320">len</span><span class="op" id="6084323">(</span><span class="ident" id="6084324">p</span><span class="op" id="6084325">.</span><span class="ident" id="6084326">prefixes</span><span class="op" id="6084334">)</span><span class="op" id="6084335">-</span><span class="num" id="6084336">1</span><span class="op" id="6084337">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084341">p</span><span class="op" id="6084342">.</span><span class="ident" id="6084343">prefixes</span>&nbsp;<span class="op" id="6084352">=</span>&nbsp;<span class="ident" id="6084354">p</span><span class="op" id="6084355">.</span><span class="ident" id="6084356">prefixes</span><span class="op" id="6084364">[</span><span class="op" id="6084365">:</span><span class="builtinfunc" id="6084366">len</span><span class="op" id="6084369">(</span><span class="ident" id="6084370">p</span><span class="op" id="6084371">.</span><span class="ident" id="6084372">prefixes</span><span class="op" id="6084380">)</span><span class="op" id="6084381">-</span><span class="num" id="6084382">1</span><span class="op" id="6084383">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6084387">if</span>&nbsp;<span class="ident" id="6084390">prefix</span>&nbsp;<span class="op" id="6084397">==</span>&nbsp;<span class="string" id="6084400">&#34;&#34;</span>&nbsp;<span class="op" id="6084403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6084408">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6084416">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084420">p</span><span class="op" id="6084421">.</span><span class="ident" id="6084422">deleteAttrPrefix</span><span class="op" id="6084438">(</span><span class="ident" id="6084439">prefix</span><span class="op" id="6084445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6084448">}</span><br>
<span class="lineno"></span><span class="op" id="6084450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6084453">var</span>&nbsp;<span class="op" id="6084457">(</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084460">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6084478">=</span>&nbsp;<span class="ident" id="6084480">reflect</span><span class="op" id="6084487">.</span><span class="ident" id="6084488">TypeOf</span><span class="op" id="6084494">(</span><span class="op" id="6084495">(</span><span class="op" id="6084496">*</span><span class="ident" id="6084497">Marshaler</span><span class="op" id="6084506">)</span><span class="op" id="6084507">(</span><span class="ident" id="6084508">nil</span><span class="op" id="6084511">)</span><span class="op" id="6084512">)</span><span class="op" id="6084513">.</span><span class="ident" id="6084514">Elem</span><span class="op" id="6084518">(</span><span class="op" id="6084519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084522">marshalerAttrType</span>&nbsp;<span class="op" id="6084540">=</span>&nbsp;<span class="ident" id="6084542">reflect</span><span class="op" id="6084549">.</span><span class="ident" id="6084550">TypeOf</span><span class="op" id="6084556">(</span><span class="op" id="6084557">(</span><span class="op" id="6084558">*</span><span class="ident" id="6084559">MarshalerAttr</span><span class="op" id="6084572">)</span><span class="op" id="6084573">(</span><span class="ident" id="6084574">nil</span><span class="op" id="6084577">)</span><span class="op" id="6084578">)</span><span class="op" id="6084579">.</span><span class="ident" id="6084580">Elem</span><span class="op" id="6084584">(</span><span class="op" id="6084585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084588">textMarshalerType</span>&nbsp;<span class="op" id="6084606">=</span>&nbsp;<span class="ident" id="6084608">reflect</span><span class="op" id="6084615">.</span><span class="ident" id="6084616">TypeOf</span><span class="op" id="6084622">(</span><span class="op" id="6084623">(</span><span class="op" id="6084624">*</span><span class="ident" id="6084625">encoding</span><span class="op" id="6084633">.</span><span class="ident" id="6084634">TextMarshaler</span><span class="op" id="6084647">)</span><span class="op" id="6084648">(</span><span class="ident" id="6084649">nil</span><span class="op" id="6084652">)</span><span class="op" id="6084653">)</span><span class="op" id="6084654">.</span><span class="ident" id="6084655">Elem</span><span class="op" id="6084659">(</span><span class="op" id="6084660">)</span><br>
<span class="lineno"></span><span class="op" id="6084662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="6084665">//&nbsp;marshalValue&nbsp;writes&nbsp;one&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements&nbsp;representing&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="6084731">//&nbsp;If&nbsp;val&nbsp;was&nbsp;obtained&nbsp;from&nbsp;a&nbsp;struct&nbsp;field,&nbsp;finfo&nbsp;must&nbsp;have&nbsp;its&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="6084804">func</span>&nbsp;<span class="op" id="6084809">(</span><span class="ident" id="6084810">p</span>&nbsp;<span class="op" id="6084812">*</span><span class="ident" id="6084813">printer</span><span class="op" id="6084820">)</span>&nbsp;<span class="ident" id="6084822">marshalValue</span><span class="op" id="6084834">(</span><span class="ident" id="6084835">val</span>&nbsp;<span class="ident" id="6084839">reflect</span><span class="op" id="6084846">.</span><span class="ident" id="6084847">Value</span><span class="op" id="6084852">,</span>&nbsp;<span class="ident" id="6084854">finfo</span>&nbsp;<span class="op" id="6084860">*</span><span class="ident" id="6084861">fieldInfo</span><span class="op" id="6084870">,</span>&nbsp;<span class="ident" id="6084872">startTemplate</span>&nbsp;<span class="op" id="6084886">*</span><span class="ident" id="6084887">StartElement</span><span class="op" id="6084899">)</span>&nbsp;<span class="builtintype" id="6084901">error</span>&nbsp;<span class="op" id="6084907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6084910">if</span>&nbsp;<span class="ident" id="6084913">startTemplate</span>&nbsp;<span class="op" id="6084927">!=</span>&nbsp;<span class="ident" id="6084930">nil</span>&nbsp;<span class="op" id="6084934">&amp;&amp;</span>&nbsp;<span class="ident" id="6084937">startTemplate</span><span class="op" id="6084950">.</span><span class="ident" id="6084951">Name</span><span class="op" id="6084955">.</span><span class="ident" id="6084956">Local</span>&nbsp;<span class="op" id="6084962">==</span>&nbsp;<span class="string" id="6084965">&#34;&#34;</span>&nbsp;<span class="op" id="6084968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6084972">return</span>&nbsp;<span class="ident" id="6084979">fmt</span><span class="op" id="6084982">.</span><span class="ident" id="6084983">Errorf</span><span class="op" id="6084989">(</span><span class="string" id="6084990">&#34;xml:&nbsp;EncodeElement&nbsp;of&nbsp;StartElement&nbsp;with&nbsp;missing&nbsp;name&#34;</span><span class="op" id="6085044">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085051">if</span>&nbsp;<span class="op" id="6085054">!</span><span class="ident" id="6085055">val</span><span class="op" id="6085058">.</span><span class="ident" id="6085059">IsValid</span><span class="op" id="6085066">(</span><span class="op" id="6085067">)</span>&nbsp;<span class="op" id="6085069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085073">return</span>&nbsp;<span class="ident" id="6085080">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085085">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085088">if</span>&nbsp;<span class="ident" id="6085091">finfo</span>&nbsp;<span class="op" id="6085097">!=</span>&nbsp;<span class="ident" id="6085100">nil</span>&nbsp;<span class="op" id="6085104">&amp;&amp;</span>&nbsp;<span class="ident" id="6085107">finfo</span><span class="op" id="6085112">.</span><span class="ident" id="6085113">flags</span><span class="op" id="6085118">&amp;</span><span class="ident" id="6085119">fOmitEmpty</span>&nbsp;<span class="op" id="6085130">!=</span>&nbsp;<span class="num" id="6085133">0</span>&nbsp;<span class="op" id="6085135">&amp;&amp;</span>&nbsp;<span class="ident" id="6085138">isEmptyValue</span><span class="op" id="6085150">(</span><span class="ident" id="6085151">val</span><span class="op" id="6085154">)</span>&nbsp;<span class="op" id="6085156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085160">return</span>&nbsp;<span class="ident" id="6085167">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085176">//&nbsp;Drill&nbsp;into&nbsp;interfaces&nbsp;and&nbsp;pointers.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085216">//&nbsp;This&nbsp;can&nbsp;turn&nbsp;into&nbsp;an&nbsp;infinite&nbsp;loop&nbsp;given&nbsp;a&nbsp;cyclic&nbsp;chain,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085278">//&nbsp;but&nbsp;it&nbsp;matches&nbsp;the&nbsp;Go&nbsp;1&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085316">for</span>&nbsp;<span class="ident" id="6085320">val</span><span class="op" id="6085323">.</span><span class="ident" id="6085324">Kind</span><span class="op" id="6085328">(</span><span class="op" id="6085329">)</span>&nbsp;<span class="op" id="6085331">==</span>&nbsp;<span class="ident" id="6085334">reflect</span><span class="op" id="6085341">.</span><span class="ident" id="6085342">Interface</span>&nbsp;<span class="op" id="6085352">||</span>&nbsp;<span class="ident" id="6085355">val</span><span class="op" id="6085358">.</span><span class="ident" id="6085359">Kind</span><span class="op" id="6085363">(</span><span class="op" id="6085364">)</span>&nbsp;<span class="op" id="6085366">==</span>&nbsp;<span class="ident" id="6085369">reflect</span><span class="op" id="6085376">.</span><span class="ident" id="6085377">Ptr</span>&nbsp;<span class="op" id="6085381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085385">if</span>&nbsp;<span class="ident" id="6085388">val</span><span class="op" id="6085391">.</span><span class="ident" id="6085392">IsNil</span><span class="op" id="6085397">(</span><span class="op" id="6085398">)</span>&nbsp;<span class="op" id="6085400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085405">return</span>&nbsp;<span class="ident" id="6085412">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085422">val</span>&nbsp;<span class="op" id="6085426">=</span>&nbsp;<span class="ident" id="6085428">val</span><span class="op" id="6085431">.</span><span class="ident" id="6085432">Elem</span><span class="op" id="6085436">(</span><span class="op" id="6085437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085444">kind</span>&nbsp;<span class="op" id="6085449">:=</span>&nbsp;<span class="ident" id="6085452">val</span><span class="op" id="6085455">.</span><span class="ident" id="6085456">Kind</span><span class="op" id="6085460">(</span><span class="op" id="6085461">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085464">typ</span>&nbsp;<span class="op" id="6085468">:=</span>&nbsp;<span class="ident" id="6085471">val</span><span class="op" id="6085474">.</span><span class="ident" id="6085475">Type</span><span class="op" id="6085479">(</span><span class="op" id="6085480">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085484">//&nbsp;Check&nbsp;for&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085509">if</span>&nbsp;<span class="ident" id="6085512">val</span><span class="op" id="6085515">.</span><span class="ident" id="6085516">CanInterface</span><span class="op" id="6085528">(</span><span class="op" id="6085529">)</span>&nbsp;<span class="op" id="6085531">&amp;&amp;</span>&nbsp;<span class="ident" id="6085534">typ</span><span class="op" id="6085537">.</span><span class="ident" id="6085538">Implements</span><span class="op" id="6085548">(</span><span class="ident" id="6085549">marshalerType</span><span class="op" id="6085562">)</span>&nbsp;<span class="op" id="6085564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085568">return</span>&nbsp;<span class="ident" id="6085575">p</span><span class="op" id="6085576">.</span><span class="ident" id="6085577">marshalInterface</span><span class="op" id="6085593">(</span><span class="ident" id="6085594">val</span><span class="op" id="6085597">.</span><span class="ident" id="6085598">Interface</span><span class="op" id="6085607">(</span><span class="op" id="6085608">)</span><span class="op" id="6085609">.</span><span class="op" id="6085610">(</span><span class="ident" id="6085611">Marshaler</span><span class="op" id="6085620">)</span><span class="op" id="6085621">,</span>&nbsp;<span class="ident" id="6085623">defaultStart</span><span class="op" id="6085635">(</span><span class="ident" id="6085636">typ</span><span class="op" id="6085639">,</span>&nbsp;<span class="ident" id="6085641">finfo</span><span class="op" id="6085646">,</span>&nbsp;<span class="ident" id="6085648">startTemplate</span><span class="op" id="6085661">)</span><span class="op" id="6085662">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085668">if</span>&nbsp;<span class="ident" id="6085671">val</span><span class="op" id="6085674">.</span><span class="ident" id="6085675">CanAddr</span><span class="op" id="6085682">(</span><span class="op" id="6085683">)</span>&nbsp;<span class="op" id="6085685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085689">pv</span>&nbsp;<span class="op" id="6085692">:=</span>&nbsp;<span class="ident" id="6085695">val</span><span class="op" id="6085698">.</span><span class="ident" id="6085699">Addr</span><span class="op" id="6085703">(</span><span class="op" id="6085704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085708">if</span>&nbsp;<span class="ident" id="6085711">pv</span><span class="op" id="6085713">.</span><span class="ident" id="6085714">CanInterface</span><span class="op" id="6085726">(</span><span class="op" id="6085727">)</span>&nbsp;<span class="op" id="6085729">&amp;&amp;</span>&nbsp;<span class="ident" id="6085732">pv</span><span class="op" id="6085734">.</span><span class="ident" id="6085735">Type</span><span class="op" id="6085739">(</span><span class="op" id="6085740">)</span><span class="op" id="6085741">.</span><span class="ident" id="6085742">Implements</span><span class="op" id="6085752">(</span><span class="ident" id="6085753">marshalerType</span><span class="op" id="6085766">)</span>&nbsp;<span class="op" id="6085768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085773">return</span>&nbsp;<span class="ident" id="6085780">p</span><span class="op" id="6085781">.</span><span class="ident" id="6085782">marshalInterface</span><span class="op" id="6085798">(</span><span class="ident" id="6085799">pv</span><span class="op" id="6085801">.</span><span class="ident" id="6085802">Interface</span><span class="op" id="6085811">(</span><span class="op" id="6085812">)</span><span class="op" id="6085813">.</span><span class="op" id="6085814">(</span><span class="ident" id="6085815">Marshaler</span><span class="op" id="6085824">)</span><span class="op" id="6085825">,</span>&nbsp;<span class="ident" id="6085827">defaultStart</span><span class="op" id="6085839">(</span><span class="ident" id="6085840">pv</span><span class="op" id="6085842">.</span><span class="ident" id="6085843">Type</span><span class="op" id="6085847">(</span><span class="op" id="6085848">)</span><span class="op" id="6085849">,</span>&nbsp;<span class="ident" id="6085851">finfo</span><span class="op" id="6085856">,</span>&nbsp;<span class="ident" id="6085858">startTemplate</span><span class="op" id="6085871">)</span><span class="op" id="6085872">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085883">//&nbsp;Check&nbsp;for&nbsp;text&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085913">if</span>&nbsp;<span class="ident" id="6085916">val</span><span class="op" id="6085919">.</span><span class="ident" id="6085920">CanInterface</span><span class="op" id="6085932">(</span><span class="op" id="6085933">)</span>&nbsp;<span class="op" id="6085935">&amp;&amp;</span>&nbsp;<span class="ident" id="6085938">typ</span><span class="op" id="6085941">.</span><span class="ident" id="6085942">Implements</span><span class="op" id="6085952">(</span><span class="ident" id="6085953">textMarshalerType</span><span class="op" id="6085970">)</span>&nbsp;<span class="op" id="6085972">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085976">return</span>&nbsp;<span class="ident" id="6085983">p</span><span class="op" id="6085984">.</span><span class="ident" id="6085985">marshalTextInterface</span><span class="op" id="6086005">(</span><span class="ident" id="6086006">val</span><span class="op" id="6086009">.</span><span class="ident" id="6086010">Interface</span><span class="op" id="6086019">(</span><span class="op" id="6086020">)</span><span class="op" id="6086021">.</span><span class="op" id="6086022">(</span><span class="ident" id="6086023">encoding</span><span class="op" id="6086031">.</span><span class="ident" id="6086032">TextMarshaler</span><span class="op" id="6086045">)</span><span class="op" id="6086046">,</span>&nbsp;<span class="ident" id="6086048">defaultStart</span><span class="op" id="6086060">(</span><span class="ident" id="6086061">typ</span><span class="op" id="6086064">,</span>&nbsp;<span class="ident" id="6086066">finfo</span><span class="op" id="6086071">,</span>&nbsp;<span class="ident" id="6086073">startTemplate</span><span class="op" id="6086086">)</span><span class="op" id="6086087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086093">if</span>&nbsp;<span class="ident" id="6086096">val</span><span class="op" id="6086099">.</span><span class="ident" id="6086100">CanAddr</span><span class="op" id="6086107">(</span><span class="op" id="6086108">)</span>&nbsp;<span class="op" id="6086110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086114">pv</span>&nbsp;<span class="op" id="6086117">:=</span>&nbsp;<span class="ident" id="6086120">val</span><span class="op" id="6086123">.</span><span class="ident" id="6086124">Addr</span><span class="op" id="6086128">(</span><span class="op" id="6086129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086133">if</span>&nbsp;<span class="ident" id="6086136">pv</span><span class="op" id="6086138">.</span><span class="ident" id="6086139">CanInterface</span><span class="op" id="6086151">(</span><span class="op" id="6086152">)</span>&nbsp;<span class="op" id="6086154">&amp;&amp;</span>&nbsp;<span class="ident" id="6086157">pv</span><span class="op" id="6086159">.</span><span class="ident" id="6086160">Type</span><span class="op" id="6086164">(</span><span class="op" id="6086165">)</span><span class="op" id="6086166">.</span><span class="ident" id="6086167">Implements</span><span class="op" id="6086177">(</span><span class="ident" id="6086178">textMarshalerType</span><span class="op" id="6086195">)</span>&nbsp;<span class="op" id="6086197">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086202">return</span>&nbsp;<span class="ident" id="6086209">p</span><span class="op" id="6086210">.</span><span class="ident" id="6086211">marshalTextInterface</span><span class="op" id="6086231">(</span><span class="ident" id="6086232">pv</span><span class="op" id="6086234">.</span><span class="ident" id="6086235">Interface</span><span class="op" id="6086244">(</span><span class="op" id="6086245">)</span><span class="op" id="6086246">.</span><span class="op" id="6086247">(</span><span class="ident" id="6086248">encoding</span><span class="op" id="6086256">.</span><span class="ident" id="6086257">TextMarshaler</span><span class="op" id="6086270">)</span><span class="op" id="6086271">,</span>&nbsp;<span class="ident" id="6086273">defaultStart</span><span class="op" id="6086285">(</span><span class="ident" id="6086286">pv</span><span class="op" id="6086288">.</span><span class="ident" id="6086289">Type</span><span class="op" id="6086293">(</span><span class="op" id="6086294">)</span><span class="op" id="6086295">,</span>&nbsp;<span class="ident" id="6086297">finfo</span><span class="op" id="6086302">,</span>&nbsp;<span class="ident" id="6086304">startTemplate</span><span class="op" id="6086317">)</span><span class="op" id="6086318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086329">//&nbsp;Slices&nbsp;and&nbsp;arrays&nbsp;iterate&nbsp;over&nbsp;the&nbsp;elements.&nbsp;They&nbsp;do&nbsp;not&nbsp;have&nbsp;an&nbsp;enclosing&nbsp;tag.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086413">if</span>&nbsp;<span class="op" id="6086416">(</span><span class="ident" id="6086417">kind</span>&nbsp;<span class="op" id="6086422">==</span>&nbsp;<span class="ident" id="6086425">reflect</span><span class="op" id="6086432">.</span><span class="ident" id="6086433">Slice</span>&nbsp;<span class="op" id="6086439">||</span>&nbsp;<span class="ident" id="6086442">kind</span>&nbsp;<span class="op" id="6086447">==</span>&nbsp;<span class="ident" id="6086450">reflect</span><span class="op" id="6086457">.</span><span class="ident" id="6086458">Array</span><span class="op" id="6086463">)</span>&nbsp;<span class="op" id="6086465">&amp;&amp;</span>&nbsp;<span class="ident" id="6086468">typ</span><span class="op" id="6086471">.</span><span class="ident" id="6086472">Elem</span><span class="op" id="6086476">(</span><span class="op" id="6086477">)</span><span class="op" id="6086478">.</span><span class="ident" id="6086479">Kind</span><span class="op" id="6086483">(</span><span class="op" id="6086484">)</span>&nbsp;<span class="op" id="6086486">!=</span>&nbsp;<span class="ident" id="6086489">reflect</span><span class="op" id="6086496">.</span><span class="ident" id="6086497">Uint8</span>&nbsp;<span class="op" id="6086503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086507">for</span>&nbsp;<span class="ident" id="6086511">i</span><span class="op" id="6086512">,</span>&nbsp;<span class="ident" id="6086514">n</span>&nbsp;<span class="op" id="6086516">:=</span>&nbsp;<span class="num" id="6086519">0</span><span class="op" id="6086520">,</span>&nbsp;<span class="ident" id="6086522">val</span><span class="op" id="6086525">.</span><span class="ident" id="6086526">Len</span><span class="op" id="6086529">(</span><span class="op" id="6086530">)</span><span class="op" id="6086531">;</span>&nbsp;<span class="ident" id="6086533">i</span>&nbsp;<span class="op" id="6086535">&lt;</span>&nbsp;<span class="ident" id="6086537">n</span><span class="op" id="6086538">;</span>&nbsp;<span class="ident" id="6086540">i</span><span class="op" id="6086541">++</span>&nbsp;<span class="op" id="6086544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086549">if</span>&nbsp;<span class="ident" id="6086552">err</span>&nbsp;<span class="op" id="6086556">:=</span>&nbsp;<span class="ident" id="6086559">p</span><span class="op" id="6086560">.</span><span class="ident" id="6086561">marshalValue</span><span class="op" id="6086573">(</span><span class="ident" id="6086574">val</span><span class="op" id="6086577">.</span><span class="ident" id="6086578">Index</span><span class="op" id="6086583">(</span><span class="ident" id="6086584">i</span><span class="op" id="6086585">)</span><span class="op" id="6086586">,</span>&nbsp;<span class="ident" id="6086588">finfo</span><span class="op" id="6086593">,</span>&nbsp;<span class="ident" id="6086595">startTemplate</span><span class="op" id="6086608">)</span><span class="op" id="6086609">;</span>&nbsp;<span class="ident" id="6086611">err</span>&nbsp;<span class="op" id="6086615">!=</span>&nbsp;<span class="ident" id="6086618">nil</span>&nbsp;<span class="op" id="6086622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086628">return</span>&nbsp;<span class="ident" id="6086635">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086642">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086650">return</span>&nbsp;<span class="ident" id="6086657">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086666">tinfo</span><span class="op" id="6086671">,</span>&nbsp;<span class="ident" id="6086673">err</span>&nbsp;<span class="op" id="6086677">:=</span>&nbsp;<span class="ident" id="6086680">getTypeInfo</span><span class="op" id="6086691">(</span><span class="ident" id="6086692">typ</span><span class="op" id="6086695">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086698">if</span>&nbsp;<span class="ident" id="6086701">err</span>&nbsp;<span class="op" id="6086705">!=</span>&nbsp;<span class="ident" id="6086708">nil</span>&nbsp;<span class="op" id="6086712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086716">return</span>&nbsp;<span class="ident" id="6086723">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086732">//&nbsp;Create&nbsp;start&nbsp;element.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086758">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086802">//&nbsp;0.&nbsp;startTemplate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086823">//&nbsp;1.&nbsp;XMLName&nbsp;field&nbsp;in&nbsp;underlying&nbsp;struct;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086866">//&nbsp;2.&nbsp;field&nbsp;name/tag&nbsp;in&nbsp;the&nbsp;struct&nbsp;field;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086913">//&nbsp;3.&nbsp;type&nbsp;name</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086930">var</span>&nbsp;<span class="ident" id="6086934">start</span>&nbsp;<span class="ident" id="6086940">StartElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086955">if</span>&nbsp;<span class="ident" id="6086958">startTemplate</span>&nbsp;<span class="op" id="6086972">!=</span>&nbsp;<span class="ident" id="6086975">nil</span>&nbsp;<span class="op" id="6086979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086983">start</span><span class="op" id="6086988">.</span><span class="ident" id="6086989">Name</span>&nbsp;<span class="op" id="6086994">=</span>&nbsp;<span class="ident" id="6086996">startTemplate</span><span class="op" id="6087009">.</span><span class="ident" id="6087010">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087017">start</span><span class="op" id="6087022">.</span><span class="ident" id="6087023">Attr</span>&nbsp;<span class="op" id="6087028">=</span>&nbsp;<span class="builtinfunc" id="6087030">append</span><span class="op" id="6087036">(</span><span class="ident" id="6087037">start</span><span class="op" id="6087042">.</span><span class="ident" id="6087043">Attr</span><span class="op" id="6087047">,</span>&nbsp;<span class="ident" id="6087049">startTemplate</span><span class="op" id="6087062">.</span><span class="ident" id="6087063">Attr</span><span class="op" id="6087067">...</span><span class="op" id="6087070">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087073">}</span>&nbsp;<span class="keyword" id="6087075">else</span>&nbsp;<span class="keyword" id="6087080">if</span>&nbsp;<span class="ident" id="6087083">tinfo</span><span class="op" id="6087088">.</span><span class="ident" id="6087089">xmlname</span>&nbsp;<span class="op" id="6087097">!=</span>&nbsp;<span class="ident" id="6087100">nil</span>&nbsp;<span class="op" id="6087104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087108">xmlname</span>&nbsp;<span class="op" id="6087116">:=</span>&nbsp;<span class="ident" id="6087119">tinfo</span><span class="op" id="6087124">.</span><span class="ident" id="6087125">xmlname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087135">if</span>&nbsp;<span class="ident" id="6087138">xmlname</span><span class="op" id="6087145">.</span><span class="ident" id="6087146">name</span>&nbsp;<span class="op" id="6087151">!=</span>&nbsp;<span class="string" id="6087154">&#34;&#34;</span>&nbsp;<span class="op" id="6087157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087162">start</span><span class="op" id="6087167">.</span><span class="ident" id="6087168">Name</span><span class="op" id="6087172">.</span><span class="ident" id="6087173">Space</span><span class="op" id="6087178">,</span>&nbsp;<span class="ident" id="6087180">start</span><span class="op" id="6087185">.</span><span class="ident" id="6087186">Name</span><span class="op" id="6087190">.</span><span class="ident" id="6087191">Local</span>&nbsp;<span class="op" id="6087197">=</span>&nbsp;<span class="ident" id="6087199">xmlname</span><span class="op" id="6087206">.</span><span class="ident" id="6087207">xmlns</span><span class="op" id="6087212">,</span>&nbsp;<span class="ident" id="6087214">xmlname</span><span class="op" id="6087221">.</span><span class="ident" id="6087222">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087229">}</span>&nbsp;<span class="keyword" id="6087231">else</span>&nbsp;<span class="keyword" id="6087236">if</span>&nbsp;<span class="ident" id="6087239">v</span><span class="op" id="6087240">,</span>&nbsp;<span class="ident" id="6087242">ok</span>&nbsp;<span class="op" id="6087245">:=</span>&nbsp;<span class="ident" id="6087248">xmlname</span><span class="op" id="6087255">.</span><span class="ident" id="6087256">value</span><span class="op" id="6087261">(</span><span class="ident" id="6087262">val</span><span class="op" id="6087265">)</span><span class="op" id="6087266">.</span><span class="ident" id="6087267">Interface</span><span class="op" id="6087276">(</span><span class="op" id="6087277">)</span><span class="op" id="6087278">.</span><span class="op" id="6087279">(</span><span class="ident" id="6087280">Name</span><span class="op" id="6087284">)</span><span class="op" id="6087285">;</span>&nbsp;<span class="ident" id="6087287">ok</span>&nbsp;<span class="op" id="6087290">&amp;&amp;</span>&nbsp;<span class="ident" id="6087293">v</span><span class="op" id="6087294">.</span><span class="ident" id="6087295">Local</span>&nbsp;<span class="op" id="6087301">!=</span>&nbsp;<span class="string" id="6087304">&#34;&#34;</span>&nbsp;<span class="op" id="6087307">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087312">start</span><span class="op" id="6087317">.</span><span class="ident" id="6087318">Name</span>&nbsp;<span class="op" id="6087323">=</span>&nbsp;<span class="ident" id="6087325">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087335">if</span>&nbsp;<span class="ident" id="6087338">start</span><span class="op" id="6087343">.</span><span class="ident" id="6087344">Name</span><span class="op" id="6087348">.</span><span class="ident" id="6087349">Local</span>&nbsp;<span class="op" id="6087355">==</span>&nbsp;<span class="string" id="6087358">&#34;&#34;</span>&nbsp;<span class="op" id="6087361">&amp;&amp;</span>&nbsp;<span class="ident" id="6087364">finfo</span>&nbsp;<span class="op" id="6087370">!=</span>&nbsp;<span class="ident" id="6087373">nil</span>&nbsp;<span class="op" id="6087377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087381">start</span><span class="op" id="6087386">.</span><span class="ident" id="6087387">Name</span><span class="op" id="6087391">.</span><span class="ident" id="6087392">Space</span><span class="op" id="6087397">,</span>&nbsp;<span class="ident" id="6087399">start</span><span class="op" id="6087404">.</span><span class="ident" id="6087405">Name</span><span class="op" id="6087409">.</span><span class="ident" id="6087410">Local</span>&nbsp;<span class="op" id="6087416">=</span>&nbsp;<span class="ident" id="6087418">finfo</span><span class="op" id="6087423">.</span><span class="ident" id="6087424">xmlns</span><span class="op" id="6087429">,</span>&nbsp;<span class="ident" id="6087431">finfo</span><span class="op" id="6087436">.</span><span class="ident" id="6087437">name</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087446">if</span>&nbsp;<span class="ident" id="6087449">start</span><span class="op" id="6087454">.</span><span class="ident" id="6087455">Name</span><span class="op" id="6087459">.</span><span class="ident" id="6087460">Local</span>&nbsp;<span class="op" id="6087466">==</span>&nbsp;<span class="string" id="6087469">&#34;&#34;</span>&nbsp;<span class="op" id="6087472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087476">name</span>&nbsp;<span class="op" id="6087481">:=</span>&nbsp;<span class="ident" id="6087484">typ</span><span class="op" id="6087487">.</span><span class="ident" id="6087488">Name</span><span class="op" id="6087492">(</span><span class="op" id="6087493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087497">if</span>&nbsp;<span class="ident" id="6087500">name</span>&nbsp;<span class="op" id="6087505">==</span>&nbsp;<span class="string" id="6087508">&#34;&#34;</span>&nbsp;<span class="op" id="6087511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087516">return</span>&nbsp;<span class="op" id="6087523">&amp;</span><span class="ident" id="6087524">UnsupportedTypeError</span><span class="op" id="6087544">{</span><span class="ident" id="6087545">typ</span><span class="op" id="6087548">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087556">start</span><span class="op" id="6087561">.</span><span class="ident" id="6087562">Name</span><span class="op" id="6087566">.</span><span class="ident" id="6087567">Local</span>&nbsp;<span class="op" id="6087573">=</span>&nbsp;<span class="ident" id="6087575">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6087585">//&nbsp;Attributes</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087600">for</span>&nbsp;<span class="ident" id="6087604">i</span>&nbsp;<span class="op" id="6087606">:=</span>&nbsp;<span class="keyword" id="6087609">range</span>&nbsp;<span class="ident" id="6087615">tinfo</span><span class="op" id="6087620">.</span><span class="ident" id="6087621">fields</span>&nbsp;<span class="op" id="6087628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087632">finfo</span>&nbsp;<span class="op" id="6087638">:=</span>&nbsp;<span class="op" id="6087641">&amp;</span><span class="ident" id="6087642">tinfo</span><span class="op" id="6087647">.</span><span class="ident" id="6087648">fields</span><span class="op" id="6087654">[</span><span class="ident" id="6087655">i</span><span class="op" id="6087656">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087660">if</span>&nbsp;<span class="ident" id="6087663">finfo</span><span class="op" id="6087668">.</span><span class="ident" id="6087669">flags</span><span class="op" id="6087674">&amp;</span><span class="ident" id="6087675">fAttr</span>&nbsp;<span class="op" id="6087681">==</span>&nbsp;<span class="num" id="6087684">0</span>&nbsp;<span class="op" id="6087686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087691">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087702">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087706">fv</span>&nbsp;<span class="op" id="6087709">:=</span>&nbsp;<span class="ident" id="6087712">finfo</span><span class="op" id="6087717">.</span><span class="ident" id="6087718">value</span><span class="op" id="6087723">(</span><span class="ident" id="6087724">val</span><span class="op" id="6087727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087731">name</span>&nbsp;<span class="op" id="6087736">:=</span>&nbsp;<span class="ident" id="6087739">Name</span><span class="op" id="6087743">{</span><span class="ident" id="6087744">Space</span><span class="op" id="6087749">:</span>&nbsp;<span class="ident" id="6087751">finfo</span><span class="op" id="6087756">.</span><span class="ident" id="6087757">xmlns</span><span class="op" id="6087762">,</span>&nbsp;<span class="ident" id="6087764">Local</span><span class="op" id="6087769">:</span>&nbsp;<span class="ident" id="6087771">finfo</span><span class="op" id="6087776">.</span><span class="ident" id="6087777">name</span><span class="op" id="6087781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087786">if</span>&nbsp;<span class="ident" id="6087789">finfo</span><span class="op" id="6087794">.</span><span class="ident" id="6087795">flags</span><span class="op" id="6087800">&amp;</span><span class="ident" id="6087801">fOmitEmpty</span>&nbsp;<span class="op" id="6087812">!=</span>&nbsp;<span class="num" id="6087815">0</span>&nbsp;<span class="op" id="6087817">&amp;&amp;</span>&nbsp;<span class="ident" id="6087820">isEmptyValue</span><span class="op" id="6087832">(</span><span class="ident" id="6087833">fv</span><span class="op" id="6087835">)</span>&nbsp;<span class="op" id="6087837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087842">continue</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087858">if</span>&nbsp;<span class="ident" id="6087861">fv</span><span class="op" id="6087863">.</span><span class="ident" id="6087864">Kind</span><span class="op" id="6087868">(</span><span class="op" id="6087869">)</span>&nbsp;<span class="op" id="6087871">==</span>&nbsp;<span class="ident" id="6087874">reflect</span><span class="op" id="6087881">.</span><span class="ident" id="6087882">Interface</span>&nbsp;<span class="op" id="6087892">&amp;&amp;</span>&nbsp;<span class="ident" id="6087895">fv</span><span class="op" id="6087897">.</span><span class="ident" id="6087898">IsNil</span><span class="op" id="6087903">(</span><span class="op" id="6087904">)</span>&nbsp;<span class="op" id="6087906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087911">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087922">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087927">if</span>&nbsp;<span class="ident" id="6087930">fv</span><span class="op" id="6087932">.</span><span class="ident" id="6087933">CanInterface</span><span class="op" id="6087945">(</span><span class="op" id="6087946">)</span>&nbsp;<span class="op" id="6087948">&amp;&amp;</span>&nbsp;<span class="ident" id="6087951">fv</span><span class="op" id="6087953">.</span><span class="ident" id="6087954">Type</span><span class="op" id="6087958">(</span><span class="op" id="6087959">)</span><span class="op" id="6087960">.</span><span class="ident" id="6087961">Implements</span><span class="op" id="6087971">(</span><span class="ident" id="6087972">marshalerAttrType</span><span class="op" id="6087989">)</span>&nbsp;<span class="op" id="6087991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087996">attr</span><span class="op" id="6088000">,</span>&nbsp;<span class="ident" id="6088002">err</span>&nbsp;<span class="op" id="6088006">:=</span>&nbsp;<span class="ident" id="6088009">fv</span><span class="op" id="6088011">.</span><span class="ident" id="6088012">Interface</span><span class="op" id="6088021">(</span><span class="op" id="6088022">)</span><span class="op" id="6088023">.</span><span class="op" id="6088024">(</span><span class="ident" id="6088025">MarshalerAttr</span><span class="op" id="6088038">)</span><span class="op" id="6088039">.</span><span class="ident" id="6088040">MarshalXMLAttr</span><span class="op" id="6088054">(</span><span class="ident" id="6088055">name</span><span class="op" id="6088059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088064">if</span>&nbsp;<span class="ident" id="6088067">err</span>&nbsp;<span class="op" id="6088071">!=</span>&nbsp;<span class="ident" id="6088074">nil</span>&nbsp;<span class="op" id="6088078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088084">return</span>&nbsp;<span class="ident" id="6088091">err</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088103">if</span>&nbsp;<span class="ident" id="6088106">attr</span><span class="op" id="6088110">.</span><span class="ident" id="6088111">Name</span><span class="op" id="6088115">.</span><span class="ident" id="6088116">Local</span>&nbsp;<span class="op" id="6088122">!=</span>&nbsp;<span class="string" id="6088125">&#34;&#34;</span>&nbsp;<span class="op" id="6088128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088134">start</span><span class="op" id="6088139">.</span><span class="ident" id="6088140">Attr</span>&nbsp;<span class="op" id="6088145">=</span>&nbsp;<span class="builtinfunc" id="6088147">append</span><span class="op" id="6088153">(</span><span class="ident" id="6088154">start</span><span class="op" id="6088159">.</span><span class="ident" id="6088160">Attr</span><span class="op" id="6088164">,</span>&nbsp;<span class="ident" id="6088166">attr</span><span class="op" id="6088170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088180">continue</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088196">if</span>&nbsp;<span class="ident" id="6088199">fv</span><span class="op" id="6088201">.</span><span class="ident" id="6088202">CanAddr</span><span class="op" id="6088209">(</span><span class="op" id="6088210">)</span>&nbsp;<span class="op" id="6088212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088217">pv</span>&nbsp;<span class="op" id="6088220">:=</span>&nbsp;<span class="ident" id="6088223">fv</span><span class="op" id="6088225">.</span><span class="ident" id="6088226">Addr</span><span class="op" id="6088230">(</span><span class="op" id="6088231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088236">if</span>&nbsp;<span class="ident" id="6088239">pv</span><span class="op" id="6088241">.</span><span class="ident" id="6088242">CanInterface</span><span class="op" id="6088254">(</span><span class="op" id="6088255">)</span>&nbsp;<span class="op" id="6088257">&amp;&amp;</span>&nbsp;<span class="ident" id="6088260">pv</span><span class="op" id="6088262">.</span><span class="ident" id="6088263">Type</span><span class="op" id="6088267">(</span><span class="op" id="6088268">)</span><span class="op" id="6088269">.</span><span class="ident" id="6088270">Implements</span><span class="op" id="6088280">(</span><span class="ident" id="6088281">marshalerAttrType</span><span class="op" id="6088298">)</span>&nbsp;<span class="op" id="6088300">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088306">attr</span><span class="op" id="6088310">,</span>&nbsp;<span class="ident" id="6088312">err</span>&nbsp;<span class="op" id="6088316">:=</span>&nbsp;<span class="ident" id="6088319">pv</span><span class="op" id="6088321">.</span><span class="ident" id="6088322">Interface</span><span class="op" id="6088331">(</span><span class="op" id="6088332">)</span><span class="op" id="6088333">.</span><span class="op" id="6088334">(</span><span class="ident" id="6088335">MarshalerAttr</span><span class="op" id="6088348">)</span><span class="op" id="6088349">.</span><span class="ident" id="6088350">MarshalXMLAttr</span><span class="op" id="6088364">(</span><span class="ident" id="6088365">name</span><span class="op" id="6088369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088375">if</span>&nbsp;<span class="ident" id="6088378">err</span>&nbsp;<span class="op" id="6088382">!=</span>&nbsp;<span class="ident" id="6088385">nil</span>&nbsp;<span class="op" id="6088389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088396">return</span>&nbsp;<span class="ident" id="6088403">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088417">if</span>&nbsp;<span class="ident" id="6088420">attr</span><span class="op" id="6088424">.</span><span class="ident" id="6088425">Name</span><span class="op" id="6088429">.</span><span class="ident" id="6088430">Local</span>&nbsp;<span class="op" id="6088436">!=</span>&nbsp;<span class="string" id="6088439">&#34;&#34;</span>&nbsp;<span class="op" id="6088442">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088449">start</span><span class="op" id="6088454">.</span><span class="ident" id="6088455">Attr</span>&nbsp;<span class="op" id="6088460">=</span>&nbsp;<span class="builtinfunc" id="6088462">append</span><span class="op" id="6088468">(</span><span class="ident" id="6088469">start</span><span class="op" id="6088474">.</span><span class="ident" id="6088475">Attr</span><span class="op" id="6088479">,</span>&nbsp;<span class="ident" id="6088481">attr</span><span class="op" id="6088485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088497">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088513">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088518">if</span>&nbsp;<span class="ident" id="6088521">fv</span><span class="op" id="6088523">.</span><span class="ident" id="6088524">CanInterface</span><span class="op" id="6088536">(</span><span class="op" id="6088537">)</span>&nbsp;<span class="op" id="6088539">&amp;&amp;</span>&nbsp;<span class="ident" id="6088542">fv</span><span class="op" id="6088544">.</span><span class="ident" id="6088545">Type</span><span class="op" id="6088549">(</span><span class="op" id="6088550">)</span><span class="op" id="6088551">.</span><span class="ident" id="6088552">Implements</span><span class="op" id="6088562">(</span><span class="ident" id="6088563">textMarshalerType</span><span class="op" id="6088580">)</span>&nbsp;<span class="op" id="6088582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088587">text</span><span class="op" id="6088591">,</span>&nbsp;<span class="ident" id="6088593">err</span>&nbsp;<span class="op" id="6088597">:=</span>&nbsp;<span class="ident" id="6088600">fv</span><span class="op" id="6088602">.</span><span class="ident" id="6088603">Interface</span><span class="op" id="6088612">(</span><span class="op" id="6088613">)</span><span class="op" id="6088614">.</span><span class="op" id="6088615">(</span><span class="ident" id="6088616">encoding</span><span class="op" id="6088624">.</span><span class="ident" id="6088625">TextMarshaler</span><span class="op" id="6088638">)</span><span class="op" id="6088639">.</span><span class="ident" id="6088640">MarshalText</span><span class="op" id="6088651">(</span><span class="op" id="6088652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088657">if</span>&nbsp;<span class="ident" id="6088660">err</span>&nbsp;<span class="op" id="6088664">!=</span>&nbsp;<span class="ident" id="6088667">nil</span>&nbsp;<span class="op" id="6088671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088677">return</span>&nbsp;<span class="ident" id="6088684">err</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088696">start</span><span class="op" id="6088701">.</span><span class="ident" id="6088702">Attr</span>&nbsp;<span class="op" id="6088707">=</span>&nbsp;<span class="builtinfunc" id="6088709">append</span><span class="op" id="6088715">(</span><span class="ident" id="6088716">start</span><span class="op" id="6088721">.</span><span class="ident" id="6088722">Attr</span><span class="op" id="6088726">,</span>&nbsp;<span class="ident" id="6088728">Attr</span><span class="op" id="6088732">{</span><span class="ident" id="6088733">name</span><span class="op" id="6088737">,</span>&nbsp;<span class="builtintype" id="6088739">string</span><span class="op" id="6088745">(</span><span class="ident" id="6088746">text</span><span class="op" id="6088750">)</span><span class="op" id="6088751">}</span><span class="op" id="6088752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088757">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088773">if</span>&nbsp;<span class="ident" id="6088776">fv</span><span class="op" id="6088778">.</span><span class="ident" id="6088779">CanAddr</span><span class="op" id="6088786">(</span><span class="op" id="6088787">)</span>&nbsp;<span class="op" id="6088789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088794">pv</span>&nbsp;<span class="op" id="6088797">:=</span>&nbsp;<span class="ident" id="6088800">fv</span><span class="op" id="6088802">.</span><span class="ident" id="6088803">Addr</span><span class="op" id="6088807">(</span><span class="op" id="6088808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088813">if</span>&nbsp;<span class="ident" id="6088816">pv</span><span class="op" id="6088818">.</span><span class="ident" id="6088819">CanInterface</span><span class="op" id="6088831">(</span><span class="op" id="6088832">)</span>&nbsp;<span class="op" id="6088834">&amp;&amp;</span>&nbsp;<span class="ident" id="6088837">pv</span><span class="op" id="6088839">.</span><span class="ident" id="6088840">Type</span><span class="op" id="6088844">(</span><span class="op" id="6088845">)</span><span class="op" id="6088846">.</span><span class="ident" id="6088847">Implements</span><span class="op" id="6088857">(</span><span class="ident" id="6088858">textMarshalerType</span><span class="op" id="6088875">)</span>&nbsp;<span class="op" id="6088877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088883">text</span><span class="op" id="6088887">,</span>&nbsp;<span class="ident" id="6088889">err</span>&nbsp;<span class="op" id="6088893">:=</span>&nbsp;<span class="ident" id="6088896">pv</span><span class="op" id="6088898">.</span><span class="ident" id="6088899">Interface</span><span class="op" id="6088908">(</span><span class="op" id="6088909">)</span><span class="op" id="6088910">.</span><span class="op" id="6088911">(</span><span class="ident" id="6088912">encoding</span><span class="op" id="6088920">.</span><span class="ident" id="6088921">TextMarshaler</span><span class="op" id="6088934">)</span><span class="op" id="6088935">.</span><span class="ident" id="6088936">MarshalText</span><span class="op" id="6088947">(</span><span class="op" id="6088948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088954">if</span>&nbsp;<span class="ident" id="6088957">err</span>&nbsp;<span class="op" id="6088961">!=</span>&nbsp;<span class="ident" id="6088964">nil</span>&nbsp;<span class="op" id="6088968">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088975">return</span>&nbsp;<span class="ident" id="6088982">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088996">start</span><span class="op" id="6089001">.</span><span class="ident" id="6089002">Attr</span>&nbsp;<span class="op" id="6089007">=</span>&nbsp;<span class="builtinfunc" id="6089009">append</span><span class="op" id="6089015">(</span><span class="ident" id="6089016">start</span><span class="op" id="6089021">.</span><span class="ident" id="6089022">Attr</span><span class="op" id="6089026">,</span>&nbsp;<span class="ident" id="6089028">Attr</span><span class="op" id="6089032">{</span><span class="ident" id="6089033">name</span><span class="op" id="6089037">,</span>&nbsp;<span class="builtintype" id="6089039">string</span><span class="op" id="6089045">(</span><span class="ident" id="6089046">text</span><span class="op" id="6089050">)</span><span class="op" id="6089051">}</span><span class="op" id="6089052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089058">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089070">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6089079">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089135">switch</span>&nbsp;<span class="ident" id="6089142">fv</span><span class="op" id="6089144">.</span><span class="ident" id="6089145">Kind</span><span class="op" id="6089149">(</span><span class="op" id="6089150">)</span>&nbsp;<span class="op" id="6089152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089156">case</span>&nbsp;<span class="ident" id="6089161">reflect</span><span class="op" id="6089168">.</span><span class="ident" id="6089169">Ptr</span><span class="op" id="6089172">,</span>&nbsp;<span class="ident" id="6089174">reflect</span><span class="op" id="6089181">.</span><span class="ident" id="6089182">Interface</span><span class="op" id="6089191">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089196">if</span>&nbsp;<span class="ident" id="6089199">fv</span><span class="op" id="6089201">.</span><span class="ident" id="6089202">IsNil</span><span class="op" id="6089207">(</span><span class="op" id="6089208">)</span>&nbsp;<span class="op" id="6089210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089216">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089233">fv</span>&nbsp;<span class="op" id="6089236">=</span>&nbsp;<span class="ident" id="6089238">fv</span><span class="op" id="6089240">.</span><span class="ident" id="6089241">Elem</span><span class="op" id="6089245">(</span><span class="op" id="6089246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089250">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089255">s</span><span class="op" id="6089256">,</span>&nbsp;<span class="ident" id="6089258">b</span><span class="op" id="6089259">,</span>&nbsp;<span class="ident" id="6089261">err</span>&nbsp;<span class="op" id="6089265">:=</span>&nbsp;<span class="ident" id="6089268">p</span><span class="op" id="6089269">.</span><span class="ident" id="6089270">marshalSimple</span><span class="op" id="6089283">(</span><span class="ident" id="6089284">fv</span><span class="op" id="6089286">.</span><span class="ident" id="6089287">Type</span><span class="op" id="6089291">(</span><span class="op" id="6089292">)</span><span class="op" id="6089293">,</span>&nbsp;<span class="ident" id="6089295">fv</span><span class="op" id="6089297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089301">if</span>&nbsp;<span class="ident" id="6089304">err</span>&nbsp;<span class="op" id="6089308">!=</span>&nbsp;<span class="ident" id="6089311">nil</span>&nbsp;<span class="op" id="6089315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089320">return</span>&nbsp;<span class="ident" id="6089327">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089333">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089337">if</span>&nbsp;<span class="ident" id="6089340">b</span>&nbsp;<span class="op" id="6089342">!=</span>&nbsp;<span class="ident" id="6089345">nil</span>&nbsp;<span class="op" id="6089349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089354">s</span>&nbsp;<span class="op" id="6089356">=</span>&nbsp;<span class="builtintype" id="6089358">string</span><span class="op" id="6089364">(</span><span class="ident" id="6089365">b</span><span class="op" id="6089366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089374">start</span><span class="op" id="6089379">.</span><span class="ident" id="6089380">Attr</span>&nbsp;<span class="op" id="6089385">=</span>&nbsp;<span class="builtinfunc" id="6089387">append</span><span class="op" id="6089393">(</span><span class="ident" id="6089394">start</span><span class="op" id="6089399">.</span><span class="ident" id="6089400">Attr</span><span class="op" id="6089404">,</span>&nbsp;<span class="ident" id="6089406">Attr</span><span class="op" id="6089410">{</span><span class="ident" id="6089411">name</span><span class="op" id="6089415">,</span>&nbsp;<span class="ident" id="6089417">s</span><span class="op" id="6089418">}</span><span class="op" id="6089419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089422">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089426">if</span>&nbsp;<span class="ident" id="6089429">err</span>&nbsp;<span class="op" id="6089433">:=</span>&nbsp;<span class="ident" id="6089436">p</span><span class="op" id="6089437">.</span><span class="ident" id="6089438">writeStart</span><span class="op" id="6089448">(</span><span class="op" id="6089449">&amp;</span><span class="ident" id="6089450">start</span><span class="op" id="6089455">)</span><span class="op" id="6089456">;</span>&nbsp;<span class="ident" id="6089458">err</span>&nbsp;<span class="op" id="6089462">!=</span>&nbsp;<span class="ident" id="6089465">nil</span>&nbsp;<span class="op" id="6089469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089473">return</span>&nbsp;<span class="ident" id="6089480">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089489">if</span>&nbsp;<span class="ident" id="6089492">val</span><span class="op" id="6089495">.</span><span class="ident" id="6089496">Kind</span><span class="op" id="6089500">(</span><span class="op" id="6089501">)</span>&nbsp;<span class="op" id="6089503">==</span>&nbsp;<span class="ident" id="6089506">reflect</span><span class="op" id="6089513">.</span><span class="ident" id="6089514">Struct</span>&nbsp;<span class="op" id="6089521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089525">err</span>&nbsp;<span class="op" id="6089529">=</span>&nbsp;<span class="ident" id="6089531">p</span><span class="op" id="6089532">.</span><span class="ident" id="6089533">marshalStruct</span><span class="op" id="6089546">(</span><span class="ident" id="6089547">tinfo</span><span class="op" id="6089552">,</span>&nbsp;<span class="ident" id="6089554">val</span><span class="op" id="6089557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089560">}</span>&nbsp;<span class="keyword" id="6089562">else</span>&nbsp;<span class="op" id="6089567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089571">s</span><span class="op" id="6089572">,</span>&nbsp;<span class="ident" id="6089574">b</span><span class="op" id="6089575">,</span>&nbsp;<span class="ident" id="6089577">err1</span>&nbsp;<span class="op" id="6089582">:=</span>&nbsp;<span class="ident" id="6089585">p</span><span class="op" id="6089586">.</span><span class="ident" id="6089587">marshalSimple</span><span class="op" id="6089600">(</span><span class="ident" id="6089601">typ</span><span class="op" id="6089604">,</span>&nbsp;<span class="ident" id="6089606">val</span><span class="op" id="6089609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089613">if</span>&nbsp;<span class="ident" id="6089616">err1</span>&nbsp;<span class="op" id="6089621">!=</span>&nbsp;<span class="ident" id="6089624">nil</span>&nbsp;<span class="op" id="6089628">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089633">err</span>&nbsp;<span class="op" id="6089637">=</span>&nbsp;<span class="ident" id="6089639">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089646">}</span>&nbsp;<span class="keyword" id="6089648">else</span>&nbsp;<span class="keyword" id="6089653">if</span>&nbsp;<span class="ident" id="6089656">b</span>&nbsp;<span class="op" id="6089658">!=</span>&nbsp;<span class="ident" id="6089661">nil</span>&nbsp;<span class="op" id="6089665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089670">EscapeText</span><span class="op" id="6089680">(</span><span class="ident" id="6089681">p</span><span class="op" id="6089682">,</span>&nbsp;<span class="ident" id="6089684">b</span><span class="op" id="6089685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089689">}</span>&nbsp;<span class="keyword" id="6089691">else</span>&nbsp;<span class="op" id="6089696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089701">p</span><span class="op" id="6089702">.</span><span class="ident" id="6089703">EscapeString</span><span class="op" id="6089715">(</span><span class="ident" id="6089716">s</span><span class="op" id="6089717">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089727">if</span>&nbsp;<span class="ident" id="6089730">err</span>&nbsp;<span class="op" id="6089734">!=</span>&nbsp;<span class="ident" id="6089737">nil</span>&nbsp;<span class="op" id="6089741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089745">return</span>&nbsp;<span class="ident" id="6089752">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089757">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089761">if</span>&nbsp;<span class="ident" id="6089764">err</span>&nbsp;<span class="op" id="6089768">:=</span>&nbsp;<span class="ident" id="6089771">p</span><span class="op" id="6089772">.</span><span class="ident" id="6089773">writeEnd</span><span class="op" id="6089781">(</span><span class="ident" id="6089782">start</span><span class="op" id="6089787">.</span><span class="ident" id="6089788">Name</span><span class="op" id="6089792">)</span><span class="op" id="6089793">;</span>&nbsp;<span class="ident" id="6089795">err</span>&nbsp;<span class="op" id="6089799">!=</span>&nbsp;<span class="ident" id="6089802">nil</span>&nbsp;<span class="op" id="6089806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089810">return</span>&nbsp;<span class="ident" id="6089817">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089826">return</span>&nbsp;<span class="ident" id="6089833">p</span><span class="op" id="6089834">.</span><span class="ident" id="6089835">cachedWriteError</span><span class="op" id="6089851">(</span><span class="op" id="6089852">)</span><br>
<span class="lineno"></span><span class="op" id="6089854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6089857">//&nbsp;defaultStart&nbsp;returns&nbsp;the&nbsp;default&nbsp;start&nbsp;element&nbsp;to&nbsp;use,</span><br>
<span class="lineno"></span><span class="comment" id="6089915">//&nbsp;given&nbsp;the&nbsp;reflect&nbsp;type,&nbsp;field&nbsp;info,&nbsp;and&nbsp;start&nbsp;template.</span><br>
<span class="lineno">555</span><span class="keyword" id="6089974">func</span>&nbsp;<span class="ident" id="6089979">defaultStart</span><span class="op" id="6089991">(</span><span class="ident" id="6089992">typ</span>&nbsp;<span class="ident" id="6089996">reflect</span><span class="op" id="6090003">.</span><span class="ident" id="6090004">Type</span><span class="op" id="6090008">,</span>&nbsp;<span class="ident" id="6090010">finfo</span>&nbsp;<span class="op" id="6090016">*</span><span class="ident" id="6090017">fieldInfo</span><span class="op" id="6090026">,</span>&nbsp;<span class="ident" id="6090028">startTemplate</span>&nbsp;<span class="op" id="6090042">*</span><span class="ident" id="6090043">StartElement</span><span class="op" id="6090055">)</span>&nbsp;<span class="ident" id="6090057">StartElement</span>&nbsp;<span class="op" id="6090070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090073">var</span>&nbsp;<span class="ident" id="6090077">start</span>&nbsp;<span class="ident" id="6090083">StartElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6090097">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is&nbsp;as&nbsp;above,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6090150">//&nbsp;except&nbsp;that&nbsp;we&nbsp;do&nbsp;not&nbsp;look&nbsp;inside&nbsp;structs&nbsp;for&nbsp;the&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090217">if</span>&nbsp;<span class="ident" id="6090220">startTemplate</span>&nbsp;<span class="op" id="6090234">!=</span>&nbsp;<span class="ident" id="6090237">nil</span>&nbsp;<span class="op" id="6090241">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090245">start</span><span class="op" id="6090250">.</span><span class="ident" id="6090251">Name</span>&nbsp;<span class="op" id="6090256">=</span>&nbsp;<span class="ident" id="6090258">startTemplate</span><span class="op" id="6090271">.</span><span class="ident" id="6090272">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090279">start</span><span class="op" id="6090284">.</span><span class="ident" id="6090285">Attr</span>&nbsp;<span class="op" id="6090290">=</span>&nbsp;<span class="builtinfunc" id="6090292">append</span><span class="op" id="6090298">(</span><span class="ident" id="6090299">start</span><span class="op" id="6090304">.</span><span class="ident" id="6090305">Attr</span><span class="op" id="6090309">,</span>&nbsp;<span class="ident" id="6090311">startTemplate</span><span class="op" id="6090324">.</span><span class="ident" id="6090325">Attr</span><span class="op" id="6090329">...</span><span class="op" id="6090332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090335">}</span>&nbsp;<span class="keyword" id="6090337">else</span>&nbsp;<span class="keyword" id="6090342">if</span>&nbsp;<span class="ident" id="6090345">finfo</span>&nbsp;<span class="op" id="6090351">!=</span>&nbsp;<span class="ident" id="6090354">nil</span>&nbsp;<span class="op" id="6090358">&amp;&amp;</span>&nbsp;<span class="ident" id="6090361">finfo</span><span class="op" id="6090366">.</span><span class="ident" id="6090367">name</span>&nbsp;<span class="op" id="6090372">!=</span>&nbsp;<span class="string" id="6090375">&#34;&#34;</span>&nbsp;<span class="op" id="6090378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090382">start</span><span class="op" id="6090387">.</span><span class="ident" id="6090388">Name</span><span class="op" id="6090392">.</span><span class="ident" id="6090393">Local</span>&nbsp;<span class="op" id="6090399">=</span>&nbsp;<span class="ident" id="6090401">finfo</span><span class="op" id="6090406">.</span><span class="ident" id="6090407">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090414">start</span><span class="op" id="6090419">.</span><span class="ident" id="6090420">Name</span><span class="op" id="6090424">.</span><span class="ident" id="6090425">Space</span>&nbsp;<span class="op" id="6090431">=</span>&nbsp;<span class="ident" id="6090433">finfo</span><span class="op" id="6090438">.</span><span class="ident" id="6090439">xmlns</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090446">}</span>&nbsp;<span class="keyword" id="6090448">else</span>&nbsp;<span class="keyword" id="6090453">if</span>&nbsp;<span class="ident" id="6090456">typ</span><span class="op" id="6090459">.</span><span class="ident" id="6090460">Name</span><span class="op" id="6090464">(</span><span class="op" id="6090465">)</span>&nbsp;<span class="op" id="6090467">!=</span>&nbsp;<span class="string" id="6090470">&#34;&#34;</span>&nbsp;<span class="op" id="6090473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090477">start</span><span class="op" id="6090482">.</span><span class="ident" id="6090483">Name</span><span class="op" id="6090487">.</span><span class="ident" id="6090488">Local</span>&nbsp;<span class="op" id="6090494">=</span>&nbsp;<span class="ident" id="6090496">typ</span><span class="op" id="6090499">.</span><span class="ident" id="6090500">Name</span><span class="op" id="6090504">(</span><span class="op" id="6090505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090508">}</span>&nbsp;<span class="keyword" id="6090510">else</span>&nbsp;<span class="op" id="6090515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6090519">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;named&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6090559">//&nbsp;since&nbsp;it&nbsp;has&nbsp;the&nbsp;Marshaler&nbsp;methods.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090600">start</span><span class="op" id="6090605">.</span><span class="ident" id="6090606">Name</span><span class="op" id="6090610">.</span><span class="ident" id="6090611">Local</span>&nbsp;<span class="op" id="6090617">=</span>&nbsp;<span class="ident" id="6090619">typ</span><span class="op" id="6090622">.</span><span class="ident" id="6090623">Elem</span><span class="op" id="6090627">(</span><span class="op" id="6090628">)</span><span class="op" id="6090629">.</span><span class="ident" id="6090630">Name</span><span class="op" id="6090634">(</span><span class="op" id="6090635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090641">return</span>&nbsp;<span class="ident" id="6090648">start</span><br>
<span class="lineno"></span><span class="op" id="6090654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="6090657">//&nbsp;marshalInterface&nbsp;marshals&nbsp;a&nbsp;Marshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6090715">func</span>&nbsp;<span class="op" id="6090720">(</span><span class="ident" id="6090721">p</span>&nbsp;<span class="op" id="6090723">*</span><span class="ident" id="6090724">printer</span><span class="op" id="6090731">)</span>&nbsp;<span class="ident" id="6090733">marshalInterface</span><span class="op" id="6090749">(</span><span class="ident" id="6090750">val</span>&nbsp;<span class="ident" id="6090754">Marshaler</span><span class="op" id="6090763">,</span>&nbsp;<span class="ident" id="6090765">start</span>&nbsp;<span class="ident" id="6090771">StartElement</span><span class="op" id="6090783">)</span>&nbsp;<span class="builtintype" id="6090785">error</span>&nbsp;<span class="op" id="6090791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6090794">//&nbsp;Push&nbsp;a&nbsp;marker&nbsp;onto&nbsp;the&nbsp;tag&nbsp;stack&nbsp;so&nbsp;that&nbsp;MarshalXML</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6090850">//&nbsp;cannot&nbsp;close&nbsp;the&nbsp;XML&nbsp;tags&nbsp;that&nbsp;it&nbsp;did&nbsp;not&nbsp;open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090902">p</span><span class="op" id="6090903">.</span><span class="ident" id="6090904">tags</span>&nbsp;<span class="op" id="6090909">=</span>&nbsp;<span class="builtinfunc" id="6090911">append</span><span class="op" id="6090917">(</span><span class="ident" id="6090918">p</span><span class="op" id="6090919">.</span><span class="ident" id="6090920">tags</span><span class="op" id="6090924">,</span>&nbsp;<span class="ident" id="6090926">Name</span><span class="op" id="6090930">{</span><span class="op" id="6090931">}</span><span class="op" id="6090932">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090935">n</span>&nbsp;<span class="op" id="6090937">:=</span>&nbsp;<span class="builtinfunc" id="6090940">len</span><span class="op" id="6090943">(</span><span class="ident" id="6090944">p</span><span class="op" id="6090945">.</span><span class="ident" id="6090946">tags</span><span class="op" id="6090950">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090954">err</span>&nbsp;<span class="op" id="6090958">:=</span>&nbsp;<span class="ident" id="6090961">val</span><span class="op" id="6090964">.</span><span class="ident" id="6090965">MarshalXML</span><span class="op" id="6090975">(</span><span class="ident" id="6090976">p</span><span class="op" id="6090977">.</span><span class="ident" id="6090978">encoder</span><span class="op" id="6090985">,</span>&nbsp;<span class="ident" id="6090987">start</span><span class="op" id="6090992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090995">if</span>&nbsp;<span class="ident" id="6090998">err</span>&nbsp;<span class="op" id="6091002">!=</span>&nbsp;<span class="ident" id="6091005">nil</span>&nbsp;<span class="op" id="6091009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091013">return</span>&nbsp;<span class="ident" id="6091020">err</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6091029">//&nbsp;Make&nbsp;sure&nbsp;MarshalXML&nbsp;closed&nbsp;all&nbsp;its&nbsp;tags.&nbsp;p.tags[n-1]&nbsp;is&nbsp;the&nbsp;mark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091100">if</span>&nbsp;<span class="builtinfunc" id="6091103">len</span><span class="op" id="6091106">(</span><span class="ident" id="6091107">p</span><span class="op" id="6091108">.</span><span class="ident" id="6091109">tags</span><span class="op" id="6091113">)</span>&nbsp;<span class="op" id="6091115">&gt;</span>&nbsp;<span class="ident" id="6091117">n</span>&nbsp;<span class="op" id="6091119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091123">return</span>&nbsp;<span class="ident" id="6091130">fmt</span><span class="op" id="6091133">.</span><span class="ident" id="6091134">Errorf</span><span class="op" id="6091140">(</span><span class="string" id="6091141">&#34;xml:&nbsp;%s.MarshalXML&nbsp;wrote&nbsp;invalid&nbsp;XML:&nbsp;&lt;%s&gt;&nbsp;not&nbsp;closed&#34;</span><span class="op" id="6091196">,</span>&nbsp;<span class="ident" id="6091198">receiverType</span><span class="op" id="6091210">(</span><span class="ident" id="6091211">val</span><span class="op" id="6091214">)</span><span class="op" id="6091215">,</span>&nbsp;<span class="ident" id="6091217">p</span><span class="op" id="6091218">.</span><span class="ident" id="6091219">tags</span><span class="op" id="6091223">[</span><span class="builtinfunc" id="6091224">len</span><span class="op" id="6091227">(</span><span class="ident" id="6091228">p</span><span class="op" id="6091229">.</span><span class="ident" id="6091230">tags</span><span class="op" id="6091234">)</span><span class="op" id="6091235">-</span><span class="num" id="6091236">1</span><span class="op" id="6091237">]</span><span class="op" id="6091238">.</span><span class="ident" id="6091239">Local</span><span class="op" id="6091244">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091250">p</span><span class="op" id="6091251">.</span><span class="ident" id="6091252">tags</span>&nbsp;<span class="op" id="6091257">=</span>&nbsp;<span class="ident" id="6091259">p</span><span class="op" id="6091260">.</span><span class="ident" id="6091261">tags</span><span class="op" id="6091265">[</span><span class="op" id="6091266">:</span><span class="ident" id="6091267">n</span><span class="op" id="6091268">-</span><span class="num" id="6091269">1</span><span class="op" id="6091270">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091273">return</span>&nbsp;<span class="ident" id="6091280">nil</span><br>
<span class="lineno"></span><span class="op" id="6091284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="6091287">//&nbsp;marshalTextInterface&nbsp;marshals&nbsp;a&nbsp;TextMarshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6091353">func</span>&nbsp;<span class="op" id="6091358">(</span><span class="ident" id="6091359">p</span>&nbsp;<span class="op" id="6091361">*</span><span class="ident" id="6091362">printer</span><span class="op" id="6091369">)</span>&nbsp;<span class="ident" id="6091371">marshalTextInterface</span><span class="op" id="6091391">(</span><span class="ident" id="6091392">val</span>&nbsp;<span class="ident" id="6091396">encoding</span><span class="op" id="6091404">.</span><span class="ident" id="6091405">TextMarshaler</span><span class="op" id="6091418">,</span>&nbsp;<span class="ident" id="6091420">start</span>&nbsp;<span class="ident" id="6091426">StartElement</span><span class="op" id="6091438">)</span>&nbsp;<span class="builtintype" id="6091440">error</span>&nbsp;<span class="op" id="6091446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091449">if</span>&nbsp;<span class="ident" id="6091452">err</span>&nbsp;<span class="op" id="6091456">:=</span>&nbsp;<span class="ident" id="6091459">p</span><span class="op" id="6091460">.</span><span class="ident" id="6091461">writeStart</span><span class="op" id="6091471">(</span><span class="op" id="6091472">&amp;</span><span class="ident" id="6091473">start</span><span class="op" id="6091478">)</span><span class="op" id="6091479">;</span>&nbsp;<span class="ident" id="6091481">err</span>&nbsp;<span class="op" id="6091485">!=</span>&nbsp;<span class="ident" id="6091488">nil</span>&nbsp;<span class="op" id="6091492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091496">return</span>&nbsp;<span class="ident" id="6091503">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091508">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091511">text</span><span class="op" id="6091515">,</span>&nbsp;<span class="ident" id="6091517">err</span>&nbsp;<span class="op" id="6091521">:=</span>&nbsp;<span class="ident" id="6091524">val</span><span class="op" id="6091527">.</span><span class="ident" id="6091528">MarshalText</span><span class="op" id="6091539">(</span><span class="op" id="6091540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091543">if</span>&nbsp;<span class="ident" id="6091546">err</span>&nbsp;<span class="op" id="6091550">!=</span>&nbsp;<span class="ident" id="6091553">nil</span>&nbsp;<span class="op" id="6091557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091561">return</span>&nbsp;<span class="ident" id="6091568">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091576">EscapeText</span><span class="op" id="6091586">(</span><span class="ident" id="6091587">p</span><span class="op" id="6091588">,</span>&nbsp;<span class="ident" id="6091590">text</span><span class="op" id="6091594">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091597">return</span>&nbsp;<span class="ident" id="6091604">p</span><span class="op" id="6091605">.</span><span class="ident" id="6091606">writeEnd</span><span class="op" id="6091614">(</span><span class="ident" id="6091615">start</span><span class="op" id="6091620">.</span><span class="ident" id="6091621">Name</span><span class="op" id="6091625">)</span><br>
<span class="lineno"></span><span class="op" id="6091627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6091630">//&nbsp;writeStart&nbsp;writes&nbsp;the&nbsp;given&nbsp;start&nbsp;element.</span><br>
<span class="lineno"></span><span class="keyword" id="6091676">func</span>&nbsp;<span class="op" id="6091681">(</span><span class="ident" id="6091682">p</span>&nbsp;<span class="op" id="6091684">*</span><span class="ident" id="6091685">printer</span><span class="op" id="6091692">)</span>&nbsp;<span class="ident" id="6091694">writeStart</span><span class="op" id="6091704">(</span><span class="ident" id="6091705">start</span>&nbsp;<span class="op" id="6091711">*</span><span class="ident" id="6091712">StartElement</span><span class="op" id="6091724">)</span>&nbsp;<span class="builtintype" id="6091726">error</span>&nbsp;<span class="op" id="6091732">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091735">if</span>&nbsp;<span class="ident" id="6091738">start</span><span class="op" id="6091743">.</span><span class="ident" id="6091744">Name</span><span class="op" id="6091748">.</span><span class="ident" id="6091749">Local</span>&nbsp;<span class="op" id="6091755">==</span>&nbsp;<span class="string" id="6091758">&#34;&#34;</span>&nbsp;<span class="op" id="6091761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091765">return</span>&nbsp;<span class="ident" id="6091772">fmt</span><span class="op" id="6091775">.</span><span class="ident" id="6091776">Errorf</span><span class="op" id="6091782">(</span><span class="string" id="6091783">&#34;xml:&nbsp;start&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="6091812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091819">p</span><span class="op" id="6091820">.</span><span class="ident" id="6091821">tags</span>&nbsp;<span class="op" id="6091826">=</span>&nbsp;<span class="builtinfunc" id="6091828">append</span><span class="op" id="6091834">(</span><span class="ident" id="6091835">p</span><span class="op" id="6091836">.</span><span class="ident" id="6091837">tags</span><span class="op" id="6091841">,</span>&nbsp;<span class="ident" id="6091843">start</span><span class="op" id="6091848">.</span><span class="ident" id="6091849">Name</span><span class="op" id="6091853">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091856">p</span><span class="op" id="6091857">.</span><span class="ident" id="6091858">markPrefix</span><span class="op" id="6091868">(</span><span class="op" id="6091869">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091873">p</span><span class="op" id="6091874">.</span><span class="ident" id="6091875">writeIndent</span><span class="op" id="6091886">(</span><span class="num" id="6091887">1</span><span class="op" id="6091888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091891">p</span><span class="op" id="6091892">.</span><span class="ident" id="6091893">WriteByte</span><span class="op" id="6091902">(</span><span class="string" id="6091903">&#39;&lt;&#39;</span><span class="op" id="6091906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091909">p</span><span class="op" id="6091910">.</span><span class="ident" id="6091911">WriteString</span><span class="op" id="6091922">(</span><span class="ident" id="6091923">start</span><span class="op" id="6091928">.</span><span class="ident" id="6091929">Name</span><span class="op" id="6091933">.</span><span class="ident" id="6091934">Local</span><span class="op" id="6091939">)</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091943">if</span>&nbsp;<span class="ident" id="6091946">start</span><span class="op" id="6091951">.</span><span class="ident" id="6091952">Name</span><span class="op" id="6091956">.</span><span class="ident" id="6091957">Space</span>&nbsp;<span class="op" id="6091963">!=</span>&nbsp;<span class="string" id="6091966">&#34;&#34;</span>&nbsp;<span class="op" id="6091969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091973">p</span><span class="op" id="6091974">.</span><span class="ident" id="6091975">WriteString</span><span class="op" id="6091986">(</span><span class="string" id="6091987">`&nbsp;xmlns=&#34;`</span><span class="op" id="6091997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092001">p</span><span class="op" id="6092002">.</span><span class="ident" id="6092003">EscapeString</span><span class="op" id="6092015">(</span><span class="ident" id="6092016">start</span><span class="op" id="6092021">.</span><span class="ident" id="6092022">Name</span><span class="op" id="6092026">.</span><span class="ident" id="6092027">Space</span><span class="op" id="6092032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092036">p</span><span class="op" id="6092037">.</span><span class="ident" id="6092038">WriteByte</span><span class="op" id="6092047">(</span><span class="string" id="6092048">&#39;&#34;&#39;</span><span class="op" id="6092051">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6092058">//&nbsp;Attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092073">for</span>&nbsp;<span class="ident" id="6092077">_</span><span class="op" id="6092078">,</span>&nbsp;<span class="ident" id="6092080">attr</span>&nbsp;<span class="op" id="6092085">:=</span>&nbsp;<span class="keyword" id="6092088">range</span>&nbsp;<span class="ident" id="6092094">start</span><span class="op" id="6092099">.</span><span class="ident" id="6092100">Attr</span>&nbsp;<span class="op" id="6092105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092109">name</span>&nbsp;<span class="op" id="6092114">:=</span>&nbsp;<span class="ident" id="6092117">attr</span><span class="op" id="6092121">.</span><span class="ident" id="6092122">Name</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092129">if</span>&nbsp;<span class="ident" id="6092132">name</span><span class="op" id="6092136">.</span><span class="ident" id="6092137">Local</span>&nbsp;<span class="op" id="6092143">==</span>&nbsp;<span class="string" id="6092146">&#34;&#34;</span>&nbsp;<span class="op" id="6092149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092154">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092169">p</span><span class="op" id="6092170">.</span><span class="ident" id="6092171">WriteByte</span><span class="op" id="6092180">(</span><span class="string" id="6092181">&#39;&nbsp;&#39;</span><span class="op" id="6092184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092188">if</span>&nbsp;<span class="ident" id="6092191">name</span><span class="op" id="6092195">.</span><span class="ident" id="6092196">Space</span>&nbsp;<span class="op" id="6092202">!=</span>&nbsp;<span class="string" id="6092205">&#34;&#34;</span>&nbsp;<span class="op" id="6092208">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092213">p</span><span class="op" id="6092214">.</span><span class="ident" id="6092215">WriteString</span><span class="op" id="6092226">(</span><span class="ident" id="6092227">p</span><span class="op" id="6092228">.</span><span class="ident" id="6092229">createAttrPrefix</span><span class="op" id="6092245">(</span><span class="ident" id="6092246">name</span><span class="op" id="6092250">.</span><span class="ident" id="6092251">Space</span><span class="op" id="6092256">)</span><span class="op" id="6092257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092262">p</span><span class="op" id="6092263">.</span><span class="ident" id="6092264">WriteByte</span><span class="op" id="6092273">(</span><span class="string" id="6092274">&#39;:&#39;</span><span class="op" id="6092277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092285">p</span><span class="op" id="6092286">.</span><span class="ident" id="6092287">WriteString</span><span class="op" id="6092298">(</span><span class="ident" id="6092299">name</span><span class="op" id="6092303">.</span><span class="ident" id="6092304">Local</span><span class="op" id="6092309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092313">p</span><span class="op" id="6092314">.</span><span class="ident" id="6092315">WriteString</span><span class="op" id="6092326">(</span><span class="string" id="6092327">`=&#34;`</span><span class="op" id="6092331">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092335">p</span><span class="op" id="6092336">.</span><span class="ident" id="6092337">EscapeString</span><span class="op" id="6092349">(</span><span class="ident" id="6092350">attr</span><span class="op" id="6092354">.</span><span class="ident" id="6092355">Value</span><span class="op" id="6092360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092364">p</span><span class="op" id="6092365">.</span><span class="ident" id="6092366">WriteByte</span><span class="op" id="6092375">(</span><span class="string" id="6092376">&#39;&#34;&#39;</span><span class="op" id="6092379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092385">p</span><span class="op" id="6092386">.</span><span class="ident" id="6092387">WriteByte</span><span class="op" id="6092396">(</span><span class="string" id="6092397">&#39;&gt;&#39;</span><span class="op" id="6092400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092403">return</span>&nbsp;<span class="ident" id="6092410">nil</span><br>
<span class="lineno">645</span><span class="op" id="6092414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6092417">func</span>&nbsp;<span class="op" id="6092422">(</span><span class="ident" id="6092423">p</span>&nbsp;<span class="op" id="6092425">*</span><span class="ident" id="6092426">printer</span><span class="op" id="6092433">)</span>&nbsp;<span class="ident" id="6092435">writeEnd</span><span class="op" id="6092443">(</span><span class="ident" id="6092444">name</span>&nbsp;<span class="ident" id="6092449">Name</span><span class="op" id="6092453">)</span>&nbsp;<span class="builtintype" id="6092455">error</span>&nbsp;<span class="op" id="6092461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092464">if</span>&nbsp;<span class="ident" id="6092467">name</span><span class="op" id="6092471">.</span><span class="ident" id="6092472">Local</span>&nbsp;<span class="op" id="6092478">==</span>&nbsp;<span class="string" id="6092481">&#34;&#34;</span>&nbsp;<span class="op" id="6092484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092488">return</span>&nbsp;<span class="ident" id="6092495">fmt</span><span class="op" id="6092498">.</span><span class="ident" id="6092499">Errorf</span><span class="op" id="6092505">(</span><span class="string" id="6092506">&#34;xml:&nbsp;end&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="6092533">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092539">if</span>&nbsp;<span class="builtinfunc" id="6092542">len</span><span class="op" id="6092545">(</span><span class="ident" id="6092546">p</span><span class="op" id="6092547">.</span><span class="ident" id="6092548">tags</span><span class="op" id="6092552">)</span>&nbsp;<span class="op" id="6092554">==</span>&nbsp;<span class="num" id="6092557">0</span>&nbsp;<span class="op" id="6092559">||</span>&nbsp;<span class="ident" id="6092562">p</span><span class="op" id="6092563">.</span><span class="ident" id="6092564">tags</span><span class="op" id="6092568">[</span><span class="builtinfunc" id="6092569">len</span><span class="op" id="6092572">(</span><span class="ident" id="6092573">p</span><span class="op" id="6092574">.</span><span class="ident" id="6092575">tags</span><span class="op" id="6092579">)</span><span class="op" id="6092580">-</span><span class="num" id="6092581">1</span><span class="op" id="6092582">]</span><span class="op" id="6092583">.</span><span class="ident" id="6092584">Local</span>&nbsp;<span class="op" id="6092590">==</span>&nbsp;<span class="string" id="6092593">&#34;&#34;</span>&nbsp;<span class="op" id="6092596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092600">return</span>&nbsp;<span class="ident" id="6092607">fmt</span><span class="op" id="6092610">.</span><span class="ident" id="6092611">Errorf</span><span class="op" id="6092617">(</span><span class="string" id="6092618">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;without&nbsp;start&nbsp;tag&#34;</span><span class="op" id="6092656">,</span>&nbsp;<span class="ident" id="6092658">name</span><span class="op" id="6092662">.</span><span class="ident" id="6092663">Local</span><span class="op" id="6092668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092674">if</span>&nbsp;<span class="ident" id="6092677">top</span>&nbsp;<span class="op" id="6092681">:=</span>&nbsp;<span class="ident" id="6092684">p</span><span class="op" id="6092685">.</span><span class="ident" id="6092686">tags</span><span class="op" id="6092690">[</span><span class="builtinfunc" id="6092691">len</span><span class="op" id="6092694">(</span><span class="ident" id="6092695">p</span><span class="op" id="6092696">.</span><span class="ident" id="6092697">tags</span><span class="op" id="6092701">)</span><span class="op" id="6092702">-</span><span class="num" id="6092703">1</span><span class="op" id="6092704">]</span><span class="op" id="6092705">;</span>&nbsp;<span class="ident" id="6092707">top</span>&nbsp;<span class="op" id="6092711">!=</span>&nbsp;<span class="ident" id="6092714">name</span>&nbsp;<span class="op" id="6092719">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092723">if</span>&nbsp;<span class="ident" id="6092726">top</span><span class="op" id="6092729">.</span><span class="ident" id="6092730">Local</span>&nbsp;<span class="op" id="6092736">!=</span>&nbsp;<span class="ident" id="6092739">name</span><span class="op" id="6092743">.</span><span class="ident" id="6092744">Local</span>&nbsp;<span class="op" id="6092750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092755">return</span>&nbsp;<span class="ident" id="6092762">fmt</span><span class="op" id="6092765">.</span><span class="ident" id="6092766">Errorf</span><span class="op" id="6092772">(</span><span class="string" id="6092773">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6092823">,</span>&nbsp;<span class="ident" id="6092825">name</span><span class="op" id="6092829">.</span><span class="ident" id="6092830">Local</span><span class="op" id="6092835">,</span>&nbsp;<span class="ident" id="6092837">top</span><span class="op" id="6092840">.</span><span class="ident" id="6092841">Local</span><span class="op" id="6092846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092854">return</span>&nbsp;<span class="ident" id="6092861">fmt</span><span class="op" id="6092864">.</span><span class="ident" id="6092865">Errorf</span><span class="op" id="6092871">(</span><span class="string" id="6092872">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&#34;</span><span class="op" id="6092954">,</span>&nbsp;<span class="ident" id="6092956">name</span><span class="op" id="6092960">.</span><span class="ident" id="6092961">Local</span><span class="op" id="6092966">,</span>&nbsp;<span class="ident" id="6092968">name</span><span class="op" id="6092972">.</span><span class="ident" id="6092973">Space</span><span class="op" id="6092978">,</span>&nbsp;<span class="ident" id="6092980">top</span><span class="op" id="6092983">.</span><span class="ident" id="6092984">Local</span><span class="op" id="6092989">,</span>&nbsp;<span class="ident" id="6092991">top</span><span class="op" id="6092994">.</span><span class="ident" id="6092995">Space</span><span class="op" id="6093000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093003">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093006">p</span><span class="op" id="6093007">.</span><span class="ident" id="6093008">tags</span>&nbsp;<span class="op" id="6093013">=</span>&nbsp;<span class="ident" id="6093015">p</span><span class="op" id="6093016">.</span><span class="ident" id="6093017">tags</span><span class="op" id="6093021">[</span><span class="op" id="6093022">:</span><span class="builtinfunc" id="6093023">len</span><span class="op" id="6093026">(</span><span class="ident" id="6093027">p</span><span class="op" id="6093028">.</span><span class="ident" id="6093029">tags</span><span class="op" id="6093033">)</span><span class="op" id="6093034">-</span><span class="num" id="6093035">1</span><span class="op" id="6093036">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093040">p</span><span class="op" id="6093041">.</span><span class="ident" id="6093042">writeIndent</span><span class="op" id="6093053">(</span><span class="op" id="6093054">-</span><span class="num" id="6093055">1</span><span class="op" id="6093056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093059">p</span><span class="op" id="6093060">.</span><span class="ident" id="6093061">WriteByte</span><span class="op" id="6093070">(</span><span class="string" id="6093071">&#39;&lt;&#39;</span><span class="op" id="6093074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093077">p</span><span class="op" id="6093078">.</span><span class="ident" id="6093079">WriteByte</span><span class="op" id="6093088">(</span><span class="string" id="6093089">&#39;/&#39;</span><span class="op" id="6093092">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093095">p</span><span class="op" id="6093096">.</span><span class="ident" id="6093097">WriteString</span><span class="op" id="6093108">(</span><span class="ident" id="6093109">name</span><span class="op" id="6093113">.</span><span class="ident" id="6093114">Local</span><span class="op" id="6093119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093122">p</span><span class="op" id="6093123">.</span><span class="ident" id="6093124">WriteByte</span><span class="op" id="6093133">(</span><span class="string" id="6093134">&#39;&gt;&#39;</span><span class="op" id="6093137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093140">p</span><span class="op" id="6093141">.</span><span class="ident" id="6093142">popPrefix</span><span class="op" id="6093151">(</span><span class="op" id="6093152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093155">return</span>&nbsp;<span class="ident" id="6093162">nil</span><br>
<span class="lineno"></span><span class="op" id="6093166">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="6093169">func</span>&nbsp;<span class="op" id="6093174">(</span><span class="ident" id="6093175">p</span>&nbsp;<span class="op" id="6093177">*</span><span class="ident" id="6093178">printer</span><span class="op" id="6093185">)</span>&nbsp;<span class="ident" id="6093187">marshalSimple</span><span class="op" id="6093200">(</span><span class="ident" id="6093201">typ</span>&nbsp;<span class="ident" id="6093205">reflect</span><span class="op" id="6093212">.</span><span class="ident" id="6093213">Type</span><span class="op" id="6093217">,</span>&nbsp;<span class="ident" id="6093219">val</span>&nbsp;<span class="ident" id="6093223">reflect</span><span class="op" id="6093230">.</span><span class="ident" id="6093231">Value</span><span class="op" id="6093236">)</span>&nbsp;<span class="op" id="6093238">(</span><span class="builtintype" id="6093239">string</span><span class="op" id="6093245">,</span>&nbsp;<span class="op" id="6093247">[</span><span class="op" id="6093248">]</span><span class="builtintype" id="6093249">byte</span><span class="op" id="6093253">,</span>&nbsp;<span class="builtintype" id="6093255">error</span><span class="op" id="6093260">)</span>&nbsp;<span class="op" id="6093262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093265">switch</span>&nbsp;<span class="ident" id="6093272">val</span><span class="op" id="6093275">.</span><span class="ident" id="6093276">Kind</span><span class="op" id="6093280">(</span><span class="op" id="6093281">)</span>&nbsp;<span class="op" id="6093283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093286">case</span>&nbsp;<span class="ident" id="6093291">reflect</span><span class="op" id="6093298">.</span><span class="ident" id="6093299">Int</span><span class="op" id="6093302">,</span>&nbsp;<span class="ident" id="6093304">reflect</span><span class="op" id="6093311">.</span><span class="ident" id="6093312">Int8</span><span class="op" id="6093316">,</span>&nbsp;<span class="ident" id="6093318">reflect</span><span class="op" id="6093325">.</span><span class="ident" id="6093326">Int16</span><span class="op" id="6093331">,</span>&nbsp;<span class="ident" id="6093333">reflect</span><span class="op" id="6093340">.</span><span class="ident" id="6093341">Int32</span><span class="op" id="6093346">,</span>&nbsp;<span class="ident" id="6093348">reflect</span><span class="op" id="6093355">.</span><span class="ident" id="6093356">Int64</span><span class="op" id="6093361">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093365">return</span>&nbsp;<span class="ident" id="6093372">strconv</span><span class="op" id="6093379">.</span><span class="ident" id="6093380">FormatInt</span><span class="op" id="6093389">(</span><span class="ident" id="6093390">val</span><span class="op" id="6093393">.</span><span class="ident" id="6093394">Int</span><span class="op" id="6093397">(</span><span class="op" id="6093398">)</span><span class="op" id="6093399">,</span>&nbsp;<span class="num" id="6093401">10</span><span class="op" id="6093403">)</span><span class="op" id="6093404">,</span>&nbsp;<span class="ident" id="6093406">nil</span><span class="op" id="6093409">,</span>&nbsp;<span class="ident" id="6093411">nil</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093416">case</span>&nbsp;<span class="ident" id="6093421">reflect</span><span class="op" id="6093428">.</span><span class="ident" id="6093429">Uint</span><span class="op" id="6093433">,</span>&nbsp;<span class="ident" id="6093435">reflect</span><span class="op" id="6093442">.</span><span class="ident" id="6093443">Uint8</span><span class="op" id="6093448">,</span>&nbsp;<span class="ident" id="6093450">reflect</span><span class="op" id="6093457">.</span><span class="ident" id="6093458">Uint16</span><span class="op" id="6093464">,</span>&nbsp;<span class="ident" id="6093466">reflect</span><span class="op" id="6093473">.</span><span class="ident" id="6093474">Uint32</span><span class="op" id="6093480">,</span>&nbsp;<span class="ident" id="6093482">reflect</span><span class="op" id="6093489">.</span><span class="ident" id="6093490">Uint64</span><span class="op" id="6093496">,</span>&nbsp;<span class="ident" id="6093498">reflect</span><span class="op" id="6093505">.</span><span class="ident" id="6093506">Uintptr</span><span class="op" id="6093513">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093517">return</span>&nbsp;<span class="ident" id="6093524">strconv</span><span class="op" id="6093531">.</span><span class="ident" id="6093532">FormatUint</span><span class="op" id="6093542">(</span><span class="ident" id="6093543">val</span><span class="op" id="6093546">.</span><span class="ident" id="6093547">Uint</span><span class="op" id="6093551">(</span><span class="op" id="6093552">)</span><span class="op" id="6093553">,</span>&nbsp;<span class="num" id="6093555">10</span><span class="op" id="6093557">)</span><span class="op" id="6093558">,</span>&nbsp;<span class="ident" id="6093560">nil</span><span class="op" id="6093563">,</span>&nbsp;<span class="ident" id="6093565">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093570">case</span>&nbsp;<span class="ident" id="6093575">reflect</span><span class="op" id="6093582">.</span><span class="ident" id="6093583">Float32</span><span class="op" id="6093590">,</span>&nbsp;<span class="ident" id="6093592">reflect</span><span class="op" id="6093599">.</span><span class="ident" id="6093600">Float64</span><span class="op" id="6093607">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093611">return</span>&nbsp;<span class="ident" id="6093618">strconv</span><span class="op" id="6093625">.</span><span class="ident" id="6093626">FormatFloat</span><span class="op" id="6093637">(</span><span class="ident" id="6093638">val</span><span class="op" id="6093641">.</span><span class="ident" id="6093642">Float</span><span class="op" id="6093647">(</span><span class="op" id="6093648">)</span><span class="op" id="6093649">,</span>&nbsp;<span class="string" id="6093651">&#39;g&#39;</span><span class="op" id="6093654">,</span>&nbsp;<span class="op" id="6093656">-</span><span class="num" id="6093657">1</span><span class="op" id="6093658">,</span>&nbsp;<span class="ident" id="6093660">val</span><span class="op" id="6093663">.</span><span class="ident" id="6093664">Type</span><span class="op" id="6093668">(</span><span class="op" id="6093669">)</span><span class="op" id="6093670">.</span><span class="ident" id="6093671">Bits</span><span class="op" id="6093675">(</span><span class="op" id="6093676">)</span><span class="op" id="6093677">)</span><span class="op" id="6093678">,</span>&nbsp;<span class="ident" id="6093680">nil</span><span class="op" id="6093683">,</span>&nbsp;<span class="ident" id="6093685">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093690">case</span>&nbsp;<span class="ident" id="6093695">reflect</span><span class="op" id="6093702">.</span><span class="ident" id="6093703">String</span><span class="op" id="6093709">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093713">return</span>&nbsp;<span class="ident" id="6093720">val</span><span class="op" id="6093723">.</span><span class="ident" id="6093724">String</span><span class="op" id="6093730">(</span><span class="op" id="6093731">)</span><span class="op" id="6093732">,</span>&nbsp;<span class="ident" id="6093734">nil</span><span class="op" id="6093737">,</span>&nbsp;<span class="ident" id="6093739">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093744">case</span>&nbsp;<span class="ident" id="6093749">reflect</span><span class="op" id="6093756">.</span><span class="ident" id="6093757">Bool</span><span class="op" id="6093761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093765">return</span>&nbsp;<span class="ident" id="6093772">strconv</span><span class="op" id="6093779">.</span><span class="ident" id="6093780">FormatBool</span><span class="op" id="6093790">(</span><span class="ident" id="6093791">val</span><span class="op" id="6093794">.</span><span class="ident" id="6093795">Bool</span><span class="op" id="6093799">(</span><span class="op" id="6093800">)</span><span class="op" id="6093801">)</span><span class="op" id="6093802">,</span>&nbsp;<span class="ident" id="6093804">nil</span><span class="op" id="6093807">,</span>&nbsp;<span class="ident" id="6093809">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093814">case</span>&nbsp;<span class="ident" id="6093819">reflect</span><span class="op" id="6093826">.</span><span class="ident" id="6093827">Array</span><span class="op" id="6093832">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093836">if</span>&nbsp;<span class="ident" id="6093839">typ</span><span class="op" id="6093842">.</span><span class="ident" id="6093843">Elem</span><span class="op" id="6093847">(</span><span class="op" id="6093848">)</span><span class="op" id="6093849">.</span><span class="ident" id="6093850">Kind</span><span class="op" id="6093854">(</span><span class="op" id="6093855">)</span>&nbsp;<span class="op" id="6093857">!=</span>&nbsp;<span class="ident" id="6093860">reflect</span><span class="op" id="6093867">.</span><span class="ident" id="6093868">Uint8</span>&nbsp;<span class="op" id="6093874">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093879">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6093891">//&nbsp;[...]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093906">var</span>&nbsp;<span class="ident" id="6093910">bytes</span>&nbsp;<span class="op" id="6093916">[</span><span class="op" id="6093917">]</span><span class="builtintype" id="6093918">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093925">if</span>&nbsp;<span class="ident" id="6093928">val</span><span class="op" id="6093931">.</span><span class="ident" id="6093932">CanAddr</span><span class="op" id="6093939">(</span><span class="op" id="6093940">)</span>&nbsp;<span class="op" id="6093942">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093947">bytes</span>&nbsp;<span class="op" id="6093953">=</span>&nbsp;<span class="ident" id="6093955">val</span><span class="op" id="6093958">.</span><span class="ident" id="6093959">Slice</span><span class="op" id="6093964">(</span><span class="num" id="6093965">0</span><span class="op" id="6093966">,</span>&nbsp;<span class="ident" id="6093968">val</span><span class="op" id="6093971">.</span><span class="ident" id="6093972">Len</span><span class="op" id="6093975">(</span><span class="op" id="6093976">)</span><span class="op" id="6093977">)</span><span class="op" id="6093978">.</span><span class="ident" id="6093979">Bytes</span><span class="op" id="6093984">(</span><span class="op" id="6093985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093989">}</span>&nbsp;<span class="keyword" id="6093991">else</span>&nbsp;<span class="op" id="6093996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094001">bytes</span>&nbsp;<span class="op" id="6094007">=</span>&nbsp;<span class="builtinfunc" id="6094009">make</span><span class="op" id="6094013">(</span><span class="op" id="6094014">[</span><span class="op" id="6094015">]</span><span class="builtintype" id="6094016">byte</span><span class="op" id="6094020">,</span>&nbsp;<span class="ident" id="6094022">val</span><span class="op" id="6094025">.</span><span class="ident" id="6094026">Len</span><span class="op" id="6094029">(</span><span class="op" id="6094030">)</span><span class="op" id="6094031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094036">reflect</span><span class="op" id="6094043">.</span><span class="ident" id="6094044">Copy</span><span class="op" id="6094048">(</span><span class="ident" id="6094049">reflect</span><span class="op" id="6094056">.</span><span class="ident" id="6094057">ValueOf</span><span class="op" id="6094064">(</span><span class="ident" id="6094065">bytes</span><span class="op" id="6094070">)</span><span class="op" id="6094071">,</span>&nbsp;<span class="ident" id="6094073">val</span><span class="op" id="6094076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094080">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094084">return</span>&nbsp;<span class="string" id="6094091">&#34;&#34;</span><span class="op" id="6094093">,</span>&nbsp;<span class="ident" id="6094095">bytes</span><span class="op" id="6094100">,</span>&nbsp;<span class="ident" id="6094102">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094107">case</span>&nbsp;<span class="ident" id="6094112">reflect</span><span class="op" id="6094119">.</span><span class="ident" id="6094120">Slice</span><span class="op" id="6094125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094129">if</span>&nbsp;<span class="ident" id="6094132">typ</span><span class="op" id="6094135">.</span><span class="ident" id="6094136">Elem</span><span class="op" id="6094140">(</span><span class="op" id="6094141">)</span><span class="op" id="6094142">.</span><span class="ident" id="6094143">Kind</span><span class="op" id="6094147">(</span><span class="op" id="6094148">)</span>&nbsp;<span class="op" id="6094150">!=</span>&nbsp;<span class="ident" id="6094153">reflect</span><span class="op" id="6094160">.</span><span class="ident" id="6094161">Uint8</span>&nbsp;<span class="op" id="6094167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094172">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094180">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6094184">//&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094196">return</span>&nbsp;<span class="string" id="6094203">&#34;&#34;</span><span class="op" id="6094205">,</span>&nbsp;<span class="ident" id="6094207">val</span><span class="op" id="6094210">.</span><span class="ident" id="6094211">Bytes</span><span class="op" id="6094216">(</span><span class="op" id="6094217">)</span><span class="op" id="6094218">,</span>&nbsp;<span class="ident" id="6094220">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094228">return</span>&nbsp;<span class="string" id="6094235">&#34;&#34;</span><span class="op" id="6094237">,</span>&nbsp;<span class="ident" id="6094239">nil</span><span class="op" id="6094242">,</span>&nbsp;<span class="op" id="6094244">&amp;</span><span class="ident" id="6094245">UnsupportedTypeError</span><span class="op" id="6094265">{</span><span class="ident" id="6094266">typ</span><span class="op" id="6094269">}</span><br>
<span class="lineno"></span><span class="op" id="6094271">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="6094274">var</span>&nbsp;<span class="ident" id="6094278">ddBytes</span>&nbsp;<span class="op" id="6094286">=</span>&nbsp;<span class="op" id="6094288">[</span><span class="op" id="6094289">]</span><span class="builtintype" id="6094290">byte</span><span class="op" id="6094294">(</span><span class="string" id="6094295">&#34;--&#34;</span><span class="op" id="6094299">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6094302">func</span>&nbsp;<span class="op" id="6094307">(</span><span class="ident" id="6094308">p</span>&nbsp;<span class="op" id="6094310">*</span><span class="ident" id="6094311">printer</span><span class="op" id="6094318">)</span>&nbsp;<span class="ident" id="6094320">marshalStruct</span><span class="op" id="6094333">(</span><span class="ident" id="6094334">tinfo</span>&nbsp;<span class="op" id="6094340">*</span><span class="ident" id="6094341">typeInfo</span><span class="op" id="6094349">,</span>&nbsp;<span class="ident" id="6094351">val</span>&nbsp;<span class="ident" id="6094355">reflect</span><span class="op" id="6094362">.</span><span class="ident" id="6094363">Value</span><span class="op" id="6094368">)</span>&nbsp;<span class="builtintype" id="6094370">error</span>&nbsp;<span class="op" id="6094376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094379">s</span>&nbsp;<span class="op" id="6094381">:=</span>&nbsp;<span class="ident" id="6094384">parentStack</span><span class="op" id="6094395">{</span><span class="ident" id="6094396">p</span><span class="op" id="6094397">:</span>&nbsp;<span class="ident" id="6094399">p</span><span class="op" id="6094400">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094403">for</span>&nbsp;<span class="ident" id="6094407">i</span>&nbsp;<span class="op" id="6094409">:=</span>&nbsp;<span class="keyword" id="6094412">range</span>&nbsp;<span class="ident" id="6094418">tinfo</span><span class="op" id="6094423">.</span><span class="ident" id="6094424">fields</span>&nbsp;<span class="op" id="6094431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094435">finfo</span>&nbsp;<span class="op" id="6094441">:=</span>&nbsp;<span class="op" id="6094444">&amp;</span><span class="ident" id="6094445">tinfo</span><span class="op" id="6094450">.</span><span class="ident" id="6094451">fields</span><span class="op" id="6094457">[</span><span class="ident" id="6094458">i</span><span class="op" id="6094459">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094463">if</span>&nbsp;<span class="ident" id="6094466">finfo</span><span class="op" id="6094471">.</span><span class="ident" id="6094472">flags</span><span class="op" id="6094477">&amp;</span><span class="ident" id="6094478">fAttr</span>&nbsp;<span class="op" id="6094484">!=</span>&nbsp;<span class="num" id="6094487">0</span>&nbsp;<span class="op" id="6094489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094494">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094505">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094509">vf</span>&nbsp;<span class="op" id="6094512">:=</span>&nbsp;<span class="ident" id="6094515">finfo</span><span class="op" id="6094520">.</span><span class="ident" id="6094521">value</span><span class="op" id="6094526">(</span><span class="ident" id="6094527">val</span><span class="op" id="6094530">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6094535">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094591">switch</span>&nbsp;<span class="ident" id="6094598">vf</span><span class="op" id="6094600">.</span><span class="ident" id="6094601">Kind</span><span class="op" id="6094605">(</span><span class="op" id="6094606">)</span>&nbsp;<span class="op" id="6094608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094612">case</span>&nbsp;<span class="ident" id="6094617">reflect</span><span class="op" id="6094624">.</span><span class="ident" id="6094625">Ptr</span><span class="op" id="6094628">,</span>&nbsp;<span class="ident" id="6094630">reflect</span><span class="op" id="6094637">.</span><span class="ident" id="6094638">Interface</span><span class="op" id="6094647">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094652">if</span>&nbsp;<span class="op" id="6094655">!</span><span class="ident" id="6094656">vf</span><span class="op" id="6094658">.</span><span class="ident" id="6094659">IsNil</span><span class="op" id="6094664">(</span><span class="op" id="6094665">)</span>&nbsp;<span class="op" id="6094667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094673">vf</span>&nbsp;<span class="op" id="6094676">=</span>&nbsp;<span class="ident" id="6094678">vf</span><span class="op" id="6094680">.</span><span class="ident" id="6094681">Elem</span><span class="op" id="6094685">(</span><span class="op" id="6094686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094700">switch</span>&nbsp;<span class="ident" id="6094707">finfo</span><span class="op" id="6094712">.</span><span class="ident" id="6094713">flags</span>&nbsp;<span class="op" id="6094719">&amp;</span>&nbsp;<span class="ident" id="6094721">fMode</span>&nbsp;<span class="op" id="6094727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094731">case</span>&nbsp;<span class="ident" id="6094736">fCharData</span><span class="op" id="6094745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094750">if</span>&nbsp;<span class="ident" id="6094753">vf</span><span class="op" id="6094755">.</span><span class="ident" id="6094756">CanInterface</span><span class="op" id="6094768">(</span><span class="op" id="6094769">)</span>&nbsp;<span class="op" id="6094771">&amp;&amp;</span>&nbsp;<span class="ident" id="6094774">vf</span><span class="op" id="6094776">.</span><span class="ident" id="6094777">Type</span><span class="op" id="6094781">(</span><span class="op" id="6094782">)</span><span class="op" id="6094783">.</span><span class="ident" id="6094784">Implements</span><span class="op" id="6094794">(</span><span class="ident" id="6094795">textMarshalerType</span><span class="op" id="6094812">)</span>&nbsp;<span class="op" id="6094814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094820">data</span><span class="op" id="6094824">,</span>&nbsp;<span class="ident" id="6094826">err</span>&nbsp;<span class="op" id="6094830">:=</span>&nbsp;<span class="ident" id="6094833">vf</span><span class="op" id="6094835">.</span><span class="ident" id="6094836">Interface</span><span class="op" id="6094845">(</span><span class="op" id="6094846">)</span><span class="op" id="6094847">.</span><span class="op" id="6094848">(</span><span class="ident" id="6094849">encoding</span><span class="op" id="6094857">.</span><span class="ident" id="6094858">TextMarshaler</span><span class="op" id="6094871">)</span><span class="op" id="6094872">.</span><span class="ident" id="6094873">MarshalText</span><span class="op" id="6094884">(</span><span class="op" id="6094885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094891">if</span>&nbsp;<span class="ident" id="6094894">err</span>&nbsp;<span class="op" id="6094898">!=</span>&nbsp;<span class="ident" id="6094901">nil</span>&nbsp;<span class="op" id="6094905">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094912">return</span>&nbsp;<span class="ident" id="6094919">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094933">Escape</span><span class="op" id="6094939">(</span><span class="ident" id="6094940">p</span><span class="op" id="6094941">,</span>&nbsp;<span class="ident" id="6094943">data</span><span class="op" id="6094947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094953">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094965">}</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094970">if</span>&nbsp;<span class="ident" id="6094973">vf</span><span class="op" id="6094975">.</span><span class="ident" id="6094976">CanAddr</span><span class="op" id="6094983">(</span><span class="op" id="6094984">)</span>&nbsp;<span class="op" id="6094986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094992">pv</span>&nbsp;<span class="op" id="6094995">:=</span>&nbsp;<span class="ident" id="6094998">vf</span><span class="op" id="6095000">.</span><span class="ident" id="6095001">Addr</span><span class="op" id="6095005">(</span><span class="op" id="6095006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095012">if</span>&nbsp;<span class="ident" id="6095015">pv</span><span class="op" id="6095017">.</span><span class="ident" id="6095018">CanInterface</span><span class="op" id="6095030">(</span><span class="op" id="6095031">)</span>&nbsp;<span class="op" id="6095033">&amp;&amp;</span>&nbsp;<span class="ident" id="6095036">pv</span><span class="op" id="6095038">.</span><span class="ident" id="6095039">Type</span><span class="op" id="6095043">(</span><span class="op" id="6095044">)</span><span class="op" id="6095045">.</span><span class="ident" id="6095046">Implements</span><span class="op" id="6095056">(</span><span class="ident" id="6095057">textMarshalerType</span><span class="op" id="6095074">)</span>&nbsp;<span class="op" id="6095076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095083">data</span><span class="op" id="6095087">,</span>&nbsp;<span class="ident" id="6095089">err</span>&nbsp;<span class="op" id="6095093">:=</span>&nbsp;<span class="ident" id="6095096">pv</span><span class="op" id="6095098">.</span><span class="ident" id="6095099">Interface</span><span class="op" id="6095108">(</span><span class="op" id="6095109">)</span><span class="op" id="6095110">.</span><span class="op" id="6095111">(</span><span class="ident" id="6095112">encoding</span><span class="op" id="6095120">.</span><span class="ident" id="6095121">TextMarshaler</span><span class="op" id="6095134">)</span><span class="op" id="6095135">.</span><span class="ident" id="6095136">MarshalText</span><span class="op" id="6095147">(</span><span class="op" id="6095148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095155">if</span>&nbsp;<span class="ident" id="6095158">err</span>&nbsp;<span class="op" id="6095162">!=</span>&nbsp;<span class="ident" id="6095165">nil</span>&nbsp;<span class="op" id="6095169">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095177">return</span>&nbsp;<span class="ident" id="6095184">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095200">Escape</span><span class="op" id="6095206">(</span><span class="ident" id="6095207">p</span><span class="op" id="6095208">,</span>&nbsp;<span class="ident" id="6095210">data</span><span class="op" id="6095214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095221">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095234">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095244">var</span>&nbsp;<span class="ident" id="6095248">scratch</span>&nbsp;<span class="op" id="6095256">[</span><span class="num" id="6095257">64</span><span class="op" id="6095259">]</span><span class="builtintype" id="6095260">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095268">switch</span>&nbsp;<span class="ident" id="6095275">vf</span><span class="op" id="6095277">.</span><span class="ident" id="6095278">Kind</span><span class="op" id="6095282">(</span><span class="op" id="6095283">)</span>&nbsp;<span class="op" id="6095285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095290">case</span>&nbsp;<span class="ident" id="6095295">reflect</span><span class="op" id="6095302">.</span><span class="ident" id="6095303">Int</span><span class="op" id="6095306">,</span>&nbsp;<span class="ident" id="6095308">reflect</span><span class="op" id="6095315">.</span><span class="ident" id="6095316">Int8</span><span class="op" id="6095320">,</span>&nbsp;<span class="ident" id="6095322">reflect</span><span class="op" id="6095329">.</span><span class="ident" id="6095330">Int16</span><span class="op" id="6095335">,</span>&nbsp;<span class="ident" id="6095337">reflect</span><span class="op" id="6095344">.</span><span class="ident" id="6095345">Int32</span><span class="op" id="6095350">,</span>&nbsp;<span class="ident" id="6095352">reflect</span><span class="op" id="6095359">.</span><span class="ident" id="6095360">Int64</span><span class="op" id="6095365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095371">Escape</span><span class="op" id="6095377">(</span><span class="ident" id="6095378">p</span><span class="op" id="6095379">,</span>&nbsp;<span class="ident" id="6095381">strconv</span><span class="op" id="6095388">.</span><span class="ident" id="6095389">AppendInt</span><span class="op" id="6095398">(</span><span class="ident" id="6095399">scratch</span><span class="op" id="6095406">[</span><span class="op" id="6095407">:</span><span class="num" id="6095408">0</span><span class="op" id="6095409">]</span><span class="op" id="6095410">,</span>&nbsp;<span class="ident" id="6095412">vf</span><span class="op" id="6095414">.</span><span class="ident" id="6095415">Int</span><span class="op" id="6095418">(</span><span class="op" id="6095419">)</span><span class="op" id="6095420">,</span>&nbsp;<span class="num" id="6095422">10</span><span class="op" id="6095424">)</span><span class="op" id="6095425">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095430">case</span>&nbsp;<span class="ident" id="6095435">reflect</span><span class="op" id="6095442">.</span><span class="ident" id="6095443">Uint</span><span class="op" id="6095447">,</span>&nbsp;<span class="ident" id="6095449">reflect</span><span class="op" id="6095456">.</span><span class="ident" id="6095457">Uint8</span><span class="op" id="6095462">,</span>&nbsp;<span class="ident" id="6095464">reflect</span><span class="op" id="6095471">.</span><span class="ident" id="6095472">Uint16</span><span class="op" id="6095478">,</span>&nbsp;<span class="ident" id="6095480">reflect</span><span class="op" id="6095487">.</span><span class="ident" id="6095488">Uint32</span><span class="op" id="6095494">,</span>&nbsp;<span class="ident" id="6095496">reflect</span><span class="op" id="6095503">.</span><span class="ident" id="6095504">Uint64</span><span class="op" id="6095510">,</span>&nbsp;<span class="ident" id="6095512">reflect</span><span class="op" id="6095519">.</span><span class="ident" id="6095520">Uintptr</span><span class="op" id="6095527">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095533">Escape</span><span class="op" id="6095539">(</span><span class="ident" id="6095540">p</span><span class="op" id="6095541">,</span>&nbsp;<span class="ident" id="6095543">strconv</span><span class="op" id="6095550">.</span><span class="ident" id="6095551">AppendUint</span><span class="op" id="6095561">(</span><span class="ident" id="6095562">scratch</span><span class="op" id="6095569">[</span><span class="op" id="6095570">:</span><span class="num" id="6095571">0</span><span class="op" id="6095572">]</span><span class="op" id="6095573">,</span>&nbsp;<span class="ident" id="6095575">vf</span><span class="op" id="6095577">.</span><span class="ident" id="6095578">Uint</span><span class="op" id="6095582">(</span><span class="op" id="6095583">)</span><span class="op" id="6095584">,</span>&nbsp;<span class="num" id="6095586">10</span><span class="op" id="6095588">)</span><span class="op" id="6095589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095594">case</span>&nbsp;<span class="ident" id="6095599">reflect</span><span class="op" id="6095606">.</span><span class="ident" id="6095607">Float32</span><span class="op" id="6095614">,</span>&nbsp;<span class="ident" id="6095616">reflect</span><span class="op" id="6095623">.</span><span class="ident" id="6095624">Float64</span><span class="op" id="6095631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095637">Escape</span><span class="op" id="6095643">(</span><span class="ident" id="6095644">p</span><span class="op" id="6095645">,</span>&nbsp;<span class="ident" id="6095647">strconv</span><span class="op" id="6095654">.</span><span class="ident" id="6095655">AppendFloat</span><span class="op" id="6095666">(</span><span class="ident" id="6095667">scratch</span><span class="op" id="6095674">[</span><span class="op" id="6095675">:</span><span class="num" id="6095676">0</span><span class="op" id="6095677">]</span><span class="op" id="6095678">,</span>&nbsp;<span class="ident" id="6095680">vf</span><span class="op" id="6095682">.</span><span class="ident" id="6095683">Float</span><span class="op" id="6095688">(</span><span class="op" id="6095689">)</span><span class="op" id="6095690">,</span>&nbsp;<span class="string" id="6095692">&#39;g&#39;</span><span class="op" id="6095695">,</span>&nbsp;<span class="op" id="6095697">-</span><span class="num" id="6095698">1</span><span class="op" id="6095699">,</span>&nbsp;<span class="ident" id="6095701">vf</span><span class="op" id="6095703">.</span><span class="ident" id="6095704">Type</span><span class="op" id="6095708">(</span><span class="op" id="6095709">)</span><span class="op" id="6095710">.</span><span class="ident" id="6095711">Bits</span><span class="op" id="6095715">(</span><span class="op" id="6095716">)</span><span class="op" id="6095717">)</span><span class="op" id="6095718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095723">case</span>&nbsp;<span class="ident" id="6095728">reflect</span><span class="op" id="6095735">.</span><span class="ident" id="6095736">Bool</span><span class="op" id="6095740">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095746">Escape</span><span class="op" id="6095752">(</span><span class="ident" id="6095753">p</span><span class="op" id="6095754">,</span>&nbsp;<span class="ident" id="6095756">strconv</span><span class="op" id="6095763">.</span><span class="ident" id="6095764">AppendBool</span><span class="op" id="6095774">(</span><span class="ident" id="6095775">scratch</span><span class="op" id="6095782">[</span><span class="op" id="6095783">:</span><span class="num" id="6095784">0</span><span class="op" id="6095785">]</span><span class="op" id="6095786">,</span>&nbsp;<span class="ident" id="6095788">vf</span><span class="op" id="6095790">.</span><span class="ident" id="6095791">Bool</span><span class="op" id="6095795">(</span><span class="op" id="6095796">)</span><span class="op" id="6095797">)</span><span class="op" id="6095798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095803">case</span>&nbsp;<span class="ident" id="6095808">reflect</span><span class="op" id="6095815">.</span><span class="ident" id="6095816">String</span><span class="op" id="6095822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095828">if</span>&nbsp;<span class="ident" id="6095831">err</span>&nbsp;<span class="op" id="6095835">:=</span>&nbsp;<span class="ident" id="6095838">EscapeText</span><span class="op" id="6095848">(</span><span class="ident" id="6095849">p</span><span class="op" id="6095850">,</span>&nbsp;<span class="op" id="6095852">[</span><span class="op" id="6095853">]</span><span class="builtintype" id="6095854">byte</span><span class="op" id="6095858">(</span><span class="ident" id="6095859">vf</span><span class="op" id="6095861">.</span><span class="ident" id="6095862">String</span><span class="op" id="6095868">(</span><span class="op" id="6095869">)</span><span class="op" id="6095870">)</span><span class="op" id="6095871">)</span><span class="op" id="6095872">;</span>&nbsp;<span class="ident" id="6095874">err</span>&nbsp;<span class="op" id="6095878">!=</span>&nbsp;<span class="ident" id="6095881">nil</span>&nbsp;<span class="op" id="6095885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095892">return</span>&nbsp;<span class="ident" id="6095899">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095907">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095912">case</span>&nbsp;<span class="ident" id="6095917">reflect</span><span class="op" id="6095924">.</span><span class="ident" id="6095925">Slice</span><span class="op" id="6095930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095936">if</span>&nbsp;<span class="ident" id="6095939">elem</span><span class="op" id="6095943">,</span>&nbsp;<span class="ident" id="6095945">ok</span>&nbsp;<span class="op" id="6095948">:=</span>&nbsp;<span class="ident" id="6095951">vf</span><span class="op" id="6095953">.</span><span class="ident" id="6095954">Interface</span><span class="op" id="6095963">(</span><span class="op" id="6095964">)</span><span class="op" id="6095965">.</span><span class="op" id="6095966">(</span><span class="op" id="6095967">[</span><span class="op" id="6095968">]</span><span class="builtintype" id="6095969">byte</span><span class="op" id="6095973">)</span><span class="op" id="6095974">;</span>&nbsp;<span class="ident" id="6095976">ok</span>&nbsp;<span class="op" id="6095979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095986">if</span>&nbsp;<span class="ident" id="6095989">err</span>&nbsp;<span class="op" id="6095993">:=</span>&nbsp;<span class="ident" id="6095996">EscapeText</span><span class="op" id="6096006">(</span><span class="ident" id="6096007">p</span><span class="op" id="6096008">,</span>&nbsp;<span class="ident" id="6096010">elem</span><span class="op" id="6096014">)</span><span class="op" id="6096015">;</span>&nbsp;<span class="ident" id="6096017">err</span>&nbsp;<span class="op" id="6096021">!=</span>&nbsp;<span class="ident" id="6096024">nil</span>&nbsp;<span class="op" id="6096028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096036">return</span>&nbsp;<span class="ident" id="6096043">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096052">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096068">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096080">case</span>&nbsp;<span class="ident" id="6096085">fComment</span><span class="op" id="6096093">:</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096098">k</span>&nbsp;<span class="op" id="6096100">:=</span>&nbsp;<span class="ident" id="6096103">vf</span><span class="op" id="6096105">.</span><span class="ident" id="6096106">Kind</span><span class="op" id="6096110">(</span><span class="op" id="6096111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096116">if</span>&nbsp;<span class="op" id="6096119">!</span><span class="op" id="6096120">(</span><span class="ident" id="6096121">k</span>&nbsp;<span class="op" id="6096123">==</span>&nbsp;<span class="ident" id="6096126">reflect</span><span class="op" id="6096133">.</span><span class="ident" id="6096134">String</span>&nbsp;<span class="op" id="6096141">||</span>&nbsp;<span class="ident" id="6096144">k</span>&nbsp;<span class="op" id="6096146">==</span>&nbsp;<span class="ident" id="6096149">reflect</span><span class="op" id="6096156">.</span><span class="ident" id="6096157">Slice</span>&nbsp;<span class="op" id="6096163">&amp;&amp;</span>&nbsp;<span class="ident" id="6096166">vf</span><span class="op" id="6096168">.</span><span class="ident" id="6096169">Type</span><span class="op" id="6096173">(</span><span class="op" id="6096174">)</span><span class="op" id="6096175">.</span><span class="ident" id="6096176">Elem</span><span class="op" id="6096180">(</span><span class="op" id="6096181">)</span><span class="op" id="6096182">.</span><span class="ident" id="6096183">Kind</span><span class="op" id="6096187">(</span><span class="op" id="6096188">)</span>&nbsp;<span class="op" id="6096190">==</span>&nbsp;<span class="ident" id="6096193">reflect</span><span class="op" id="6096200">.</span><span class="ident" id="6096201">Uint8</span><span class="op" id="6096206">)</span>&nbsp;<span class="op" id="6096208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096214">return</span>&nbsp;<span class="ident" id="6096221">fmt</span><span class="op" id="6096224">.</span><span class="ident" id="6096225">Errorf</span><span class="op" id="6096231">(</span><span class="string" id="6096232">&#34;xml:&nbsp;bad&nbsp;type&nbsp;for&nbsp;comment&nbsp;field&nbsp;of&nbsp;%s&#34;</span><span class="op" id="6096271">,</span>&nbsp;<span class="ident" id="6096273">val</span><span class="op" id="6096276">.</span><span class="ident" id="6096277">Type</span><span class="op" id="6096281">(</span><span class="op" id="6096282">)</span><span class="op" id="6096283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096293">if</span>&nbsp;<span class="ident" id="6096296">vf</span><span class="op" id="6096298">.</span><span class="ident" id="6096299">Len</span><span class="op" id="6096302">(</span><span class="op" id="6096303">)</span>&nbsp;<span class="op" id="6096305">==</span>&nbsp;<span class="num" id="6096308">0</span>&nbsp;<span class="op" id="6096310">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096316">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096333">p</span><span class="op" id="6096334">.</span><span class="ident" id="6096335">writeIndent</span><span class="op" id="6096346">(</span><span class="num" id="6096347">0</span><span class="op" id="6096348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096353">p</span><span class="op" id="6096354">.</span><span class="ident" id="6096355">WriteString</span><span class="op" id="6096366">(</span><span class="string" id="6096367">&#34;&lt;!--&#34;</span><span class="op" id="6096373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096378">dashDash</span>&nbsp;<span class="op" id="6096387">:=</span>&nbsp;<span class="builtintype" id="6096390">false</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096399">dashLast</span>&nbsp;<span class="op" id="6096408">:=</span>&nbsp;<span class="builtintype" id="6096411">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096420">switch</span>&nbsp;<span class="ident" id="6096427">k</span>&nbsp;<span class="op" id="6096429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096434">case</span>&nbsp;<span class="ident" id="6096439">reflect</span><span class="op" id="6096446">.</span><span class="ident" id="6096447">String</span><span class="op" id="6096453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096459">s</span>&nbsp;<span class="op" id="6096461">:=</span>&nbsp;<span class="ident" id="6096464">vf</span><span class="op" id="6096466">.</span><span class="ident" id="6096467">String</span><span class="op" id="6096473">(</span><span class="op" id="6096474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096480">dashDash</span>&nbsp;<span class="op" id="6096489">=</span>&nbsp;<span class="ident" id="6096491">strings</span><span class="op" id="6096498">.</span><span class="ident" id="6096499">Index</span><span class="op" id="6096504">(</span><span class="ident" id="6096505">s</span><span class="op" id="6096506">,</span>&nbsp;<span class="string" id="6096508">&#34;--&#34;</span><span class="op" id="6096512">)</span>&nbsp;<span class="op" id="6096514">&gt;=</span>&nbsp;<span class="num" id="6096517">0</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096523">dashLast</span>&nbsp;<span class="op" id="6096532">=</span>&nbsp;<span class="ident" id="6096534">s</span><span class="op" id="6096535">[</span><span class="builtinfunc" id="6096536">len</span><span class="op" id="6096539">(</span><span class="ident" id="6096540">s</span><span class="op" id="6096541">)</span><span class="op" id="6096542">-</span><span class="num" id="6096543">1</span><span class="op" id="6096544">]</span>&nbsp;<span class="op" id="6096546">==</span>&nbsp;<span class="string" id="6096549">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096557">if</span>&nbsp;<span class="op" id="6096560">!</span><span class="ident" id="6096561">dashDash</span>&nbsp;<span class="op" id="6096570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096577">p</span><span class="op" id="6096578">.</span><span class="ident" id="6096579">WriteString</span><span class="op" id="6096590">(</span><span class="ident" id="6096591">s</span><span class="op" id="6096592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096603">case</span>&nbsp;<span class="ident" id="6096608">reflect</span><span class="op" id="6096615">.</span><span class="ident" id="6096616">Slice</span><span class="op" id="6096621">:</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096627">b</span>&nbsp;<span class="op" id="6096629">:=</span>&nbsp;<span class="ident" id="6096632">vf</span><span class="op" id="6096634">.</span><span class="ident" id="6096635">Bytes</span><span class="op" id="6096640">(</span><span class="op" id="6096641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096647">dashDash</span>&nbsp;<span class="op" id="6096656">=</span>&nbsp;<span class="ident" id="6096658">bytes</span><span class="op" id="6096663">.</span><span class="ident" id="6096664">Index</span><span class="op" id="6096669">(</span><span class="ident" id="6096670">b</span><span class="op" id="6096671">,</span>&nbsp;<span class="ident" id="6096673">ddBytes</span><span class="op" id="6096680">)</span>&nbsp;<span class="op" id="6096682">&gt;=</span>&nbsp;<span class="num" id="6096685">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096691">dashLast</span>&nbsp;<span class="op" id="6096700">=</span>&nbsp;<span class="ident" id="6096702">b</span><span class="op" id="6096703">[</span><span class="builtinfunc" id="6096704">len</span><span class="op" id="6096707">(</span><span class="ident" id="6096708">b</span><span class="op" id="6096709">)</span><span class="op" id="6096710">-</span><span class="num" id="6096711">1</span><span class="op" id="6096712">]</span>&nbsp;<span class="op" id="6096714">==</span>&nbsp;<span class="string" id="6096717">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096725">if</span>&nbsp;<span class="op" id="6096728">!</span><span class="ident" id="6096729">dashDash</span>&nbsp;<span class="op" id="6096738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096745">p</span><span class="op" id="6096746">.</span><span class="ident" id="6096747">Write</span><span class="op" id="6096752">(</span><span class="ident" id="6096753">b</span><span class="op" id="6096754">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096765">default</span><span class="op" id="6096772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6096778">panic</span><span class="op" id="6096783">(</span><span class="string" id="6096784">&#34;can&#39;t&nbsp;happen&#34;</span><span class="op" id="6096798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096808">if</span>&nbsp;<span class="ident" id="6096811">dashDash</span>&nbsp;<span class="op" id="6096820">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096826">return</span>&nbsp;<span class="ident" id="6096833">fmt</span><span class="op" id="6096836">.</span><span class="ident" id="6096837">Errorf</span><span class="op" id="6096843">(</span><span class="string" id="6096844">`xml:&nbsp;comments&nbsp;must&nbsp;not&nbsp;contain&nbsp;&#34;--&#34;`</span><span class="op" id="6096881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096891">if</span>&nbsp;<span class="ident" id="6096894">dashLast</span>&nbsp;<span class="op" id="6096903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6096909">//&nbsp;&#34;---&gt;&#34;&nbsp;is&nbsp;invalid&nbsp;grammar.&nbsp;Make&nbsp;it&nbsp;&#34;-&nbsp;--&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096959">p</span><span class="op" id="6096960">.</span><span class="ident" id="6096961">WriteByte</span><span class="op" id="6096970">(</span><span class="string" id="6096971">&#39;&nbsp;&#39;</span><span class="op" id="6096974">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6096979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096984">p</span><span class="op" id="6096985">.</span><span class="ident" id="6096986">WriteString</span><span class="op" id="6096997">(</span><span class="string" id="6096998">&#34;--&gt;&#34;</span><span class="op" id="6097003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097008">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097020">case</span>&nbsp;<span class="ident" id="6097025">fInnerXml</span><span class="op" id="6097034">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097039">iface</span>&nbsp;<span class="op" id="6097045">:=</span>&nbsp;<span class="ident" id="6097048">vf</span><span class="op" id="6097050">.</span><span class="ident" id="6097051">Interface</span><span class="op" id="6097060">(</span><span class="op" id="6097061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097066">switch</span>&nbsp;<span class="ident" id="6097073">raw</span>&nbsp;<span class="op" id="6097077">:=</span>&nbsp;<span class="ident" id="6097080">iface</span><span class="op" id="6097085">.</span><span class="op" id="6097086">(</span><span class="keyword" id="6097087">type</span><span class="op" id="6097091">)</span>&nbsp;<span class="op" id="6097093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097098">case</span>&nbsp;<span class="op" id="6097103">[</span><span class="op" id="6097104">]</span><span class="builtintype" id="6097105">byte</span><span class="op" id="6097109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097115">p</span><span class="op" id="6097116">.</span><span class="ident" id="6097117">Write</span><span class="op" id="6097122">(</span><span class="ident" id="6097123">raw</span><span class="op" id="6097126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097132">continue</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097144">case</span>&nbsp;<span class="builtintype" id="6097149">string</span><span class="op" id="6097155">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097161">p</span><span class="op" id="6097162">.</span><span class="ident" id="6097163">WriteString</span><span class="op" id="6097174">(</span><span class="ident" id="6097175">raw</span><span class="op" id="6097178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097184">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097201">case</span>&nbsp;<span class="ident" id="6097206">fElement</span><span class="op" id="6097214">,</span>&nbsp;<span class="ident" id="6097216">fElement</span>&nbsp;<span class="op" id="6097225">|</span>&nbsp;<span class="ident" id="6097227">fAny</span><span class="op" id="6097231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097236">if</span>&nbsp;<span class="ident" id="6097239">err</span>&nbsp;<span class="op" id="6097243">:=</span>&nbsp;<span class="ident" id="6097246">s</span><span class="op" id="6097247">.</span><span class="ident" id="6097248">trim</span><span class="op" id="6097252">(</span><span class="ident" id="6097253">finfo</span><span class="op" id="6097258">.</span><span class="ident" id="6097259">parents</span><span class="op" id="6097266">)</span><span class="op" id="6097267">;</span>&nbsp;<span class="ident" id="6097269">err</span>&nbsp;<span class="op" id="6097273">!=</span>&nbsp;<span class="ident" id="6097276">nil</span>&nbsp;<span class="op" id="6097280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097286">return</span>&nbsp;<span class="ident" id="6097293">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097305">if</span>&nbsp;<span class="builtinfunc" id="6097308">len</span><span class="op" id="6097311">(</span><span class="ident" id="6097312">finfo</span><span class="op" id="6097317">.</span><span class="ident" id="6097318">parents</span><span class="op" id="6097325">)</span>&nbsp;<span class="op" id="6097327">&gt;</span>&nbsp;<span class="builtinfunc" id="6097329">len</span><span class="op" id="6097332">(</span><span class="ident" id="6097333">s</span><span class="op" id="6097334">.</span><span class="ident" id="6097335">stack</span><span class="op" id="6097340">)</span>&nbsp;<span class="op" id="6097342">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097348">if</span>&nbsp;<span class="ident" id="6097351">vf</span><span class="op" id="6097353">.</span><span class="ident" id="6097354">Kind</span><span class="op" id="6097358">(</span><span class="op" id="6097359">)</span>&nbsp;<span class="op" id="6097361">!=</span>&nbsp;<span class="ident" id="6097364">reflect</span><span class="op" id="6097371">.</span><span class="ident" id="6097372">Ptr</span>&nbsp;<span class="op" id="6097376">&amp;&amp;</span>&nbsp;<span class="ident" id="6097379">vf</span><span class="op" id="6097381">.</span><span class="ident" id="6097382">Kind</span><span class="op" id="6097386">(</span><span class="op" id="6097387">)</span>&nbsp;<span class="op" id="6097389">!=</span>&nbsp;<span class="ident" id="6097392">reflect</span><span class="op" id="6097399">.</span><span class="ident" id="6097400">Interface</span>&nbsp;<span class="op" id="6097410">||</span>&nbsp;<span class="op" id="6097413">!</span><span class="ident" id="6097414">vf</span><span class="op" id="6097416">.</span><span class="ident" id="6097417">IsNil</span><span class="op" id="6097422">(</span><span class="op" id="6097423">)</span>&nbsp;<span class="op" id="6097425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097432">if</span>&nbsp;<span class="ident" id="6097435">err</span>&nbsp;<span class="op" id="6097439">:=</span>&nbsp;<span class="ident" id="6097442">s</span><span class="op" id="6097443">.</span><span class="ident" id="6097444">push</span><span class="op" id="6097448">(</span><span class="ident" id="6097449">finfo</span><span class="op" id="6097454">.</span><span class="ident" id="6097455">parents</span><span class="op" id="6097462">[</span><span class="builtinfunc" id="6097463">len</span><span class="op" id="6097466">(</span><span class="ident" id="6097467">s</span><span class="op" id="6097468">.</span><span class="ident" id="6097469">stack</span><span class="op" id="6097474">)</span><span class="op" id="6097475">:</span><span class="op" id="6097476">]</span><span class="op" id="6097477">)</span><span class="op" id="6097478">;</span>&nbsp;<span class="ident" id="6097480">err</span>&nbsp;<span class="op" id="6097484">!=</span>&nbsp;<span class="ident" id="6097487">nil</span>&nbsp;<span class="op" id="6097491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097499">return</span>&nbsp;<span class="ident" id="6097506">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097521">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097534">if</span>&nbsp;<span class="ident" id="6097537">err</span>&nbsp;<span class="op" id="6097541">:=</span>&nbsp;<span class="ident" id="6097544">p</span><span class="op" id="6097545">.</span><span class="ident" id="6097546">marshalValue</span><span class="op" id="6097558">(</span><span class="ident" id="6097559">vf</span><span class="op" id="6097561">,</span>&nbsp;<span class="ident" id="6097563">finfo</span><span class="op" id="6097568">,</span>&nbsp;<span class="ident" id="6097570">nil</span><span class="op" id="6097573">)</span><span class="op" id="6097574">;</span>&nbsp;<span class="ident" id="6097576">err</span>&nbsp;<span class="op" id="6097580">!=</span>&nbsp;<span class="ident" id="6097583">nil</span>&nbsp;<span class="op" id="6097587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097592">return</span>&nbsp;<span class="ident" id="6097599">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097605">}</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097611">s</span><span class="op" id="6097612">.</span><span class="ident" id="6097613">trim</span><span class="op" id="6097617">(</span><span class="ident" id="6097618">nil</span><span class="op" id="6097621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097624">return</span>&nbsp;<span class="ident" id="6097631">p</span><span class="op" id="6097632">.</span><span class="ident" id="6097633">cachedWriteError</span><span class="op" id="6097649">(</span><span class="op" id="6097650">)</span><br>
<span class="lineno"></span><span class="op" id="6097652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="6097655">//&nbsp;return&nbsp;the&nbsp;bufio&nbsp;Writer&#39;s&nbsp;cached&nbsp;write&nbsp;error</span><br>
<span class="lineno"></span><span class="keyword" id="6097703">func</span>&nbsp;<span class="op" id="6097708">(</span><span class="ident" id="6097709">p</span>&nbsp;<span class="op" id="6097711">*</span><span class="ident" id="6097712">printer</span><span class="op" id="6097719">)</span>&nbsp;<span class="ident" id="6097721">cachedWriteError</span><span class="op" id="6097737">(</span><span class="op" id="6097738">)</span>&nbsp;<span class="builtintype" id="6097740">error</span>&nbsp;<span class="op" id="6097746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097749">_</span><span class="op" id="6097750">,</span>&nbsp;<span class="ident" id="6097752">err</span>&nbsp;<span class="op" id="6097756">:=</span>&nbsp;<span class="ident" id="6097759">p</span><span class="op" id="6097760">.</span><span class="ident" id="6097761">Write</span><span class="op" id="6097766">(</span><span class="ident" id="6097767">nil</span><span class="op" id="6097770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097773">return</span>&nbsp;<span class="ident" id="6097780">err</span><br>
<span class="lineno"></span><span class="op" id="6097784">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span><span class="keyword" id="6097787">func</span>&nbsp;<span class="op" id="6097792">(</span><span class="ident" id="6097793">p</span>&nbsp;<span class="op" id="6097795">*</span><span class="ident" id="6097796">printer</span><span class="op" id="6097803">)</span>&nbsp;<span class="ident" id="6097805">writeIndent</span><span class="op" id="6097816">(</span><span class="ident" id="6097817">depthDelta</span>&nbsp;<span class="builtintype" id="6097828">int</span><span class="op" id="6097831">)</span>&nbsp;<span class="op" id="6097833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097836">if</span>&nbsp;<span class="builtinfunc" id="6097839">len</span><span class="op" id="6097842">(</span><span class="ident" id="6097843">p</span><span class="op" id="6097844">.</span><span class="ident" id="6097845">prefix</span><span class="op" id="6097851">)</span>&nbsp;<span class="op" id="6097853">==</span>&nbsp;<span class="num" id="6097856">0</span>&nbsp;<span class="op" id="6097858">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6097861">len</span><span class="op" id="6097864">(</span><span class="ident" id="6097865">p</span><span class="op" id="6097866">.</span><span class="ident" id="6097867">indent</span><span class="op" id="6097873">)</span>&nbsp;<span class="op" id="6097875">==</span>&nbsp;<span class="num" id="6097878">0</span>&nbsp;<span class="op" id="6097880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097884">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097892">}</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097895">if</span>&nbsp;<span class="ident" id="6097898">depthDelta</span>&nbsp;<span class="op" id="6097909">&lt;</span>&nbsp;<span class="num" id="6097911">0</span>&nbsp;<span class="op" id="6097913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097917">p</span><span class="op" id="6097918">.</span><span class="ident" id="6097919">depth</span><span class="op" id="6097924">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097929">if</span>&nbsp;<span class="ident" id="6097932">p</span><span class="op" id="6097933">.</span><span class="ident" id="6097934">indentedIn</span>&nbsp;<span class="op" id="6097945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097950">p</span><span class="op" id="6097951">.</span><span class="ident" id="6097952">indentedIn</span>&nbsp;<span class="op" id="6097963">=</span>&nbsp;<span class="builtintype" id="6097965">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097974">return</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097987">p</span><span class="op" id="6097988">.</span><span class="ident" id="6097989">indentedIn</span>&nbsp;<span class="op" id="6098000">=</span>&nbsp;<span class="builtintype" id="6098002">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098012">if</span>&nbsp;<span class="ident" id="6098015">p</span><span class="op" id="6098016">.</span><span class="ident" id="6098017">putNewline</span>&nbsp;<span class="op" id="6098028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098032">p</span><span class="op" id="6098033">.</span><span class="ident" id="6098034">WriteByte</span><span class="op" id="6098043">(</span><span class="string" id="6098044">&#39;\n&#39;</span><span class="op" id="6098048">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098051">}</span>&nbsp;<span class="keyword" id="6098053">else</span>&nbsp;<span class="op" id="6098058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098062">p</span><span class="op" id="6098063">.</span><span class="ident" id="6098064">putNewline</span>&nbsp;<span class="op" id="6098075">=</span>&nbsp;<span class="builtintype" id="6098077">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098086">if</span>&nbsp;<span class="builtinfunc" id="6098089">len</span><span class="op" id="6098092">(</span><span class="ident" id="6098093">p</span><span class="op" id="6098094">.</span><span class="ident" id="6098095">prefix</span><span class="op" id="6098101">)</span>&nbsp;<span class="op" id="6098103">&gt;</span>&nbsp;<span class="num" id="6098105">0</span>&nbsp;<span class="op" id="6098107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098111">p</span><span class="op" id="6098112">.</span><span class="ident" id="6098113">WriteString</span><span class="op" id="6098124">(</span><span class="ident" id="6098125">p</span><span class="op" id="6098126">.</span><span class="ident" id="6098127">prefix</span><span class="op" id="6098133">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098139">if</span>&nbsp;<span class="builtinfunc" id="6098142">len</span><span class="op" id="6098145">(</span><span class="ident" id="6098146">p</span><span class="op" id="6098147">.</span><span class="ident" id="6098148">indent</span><span class="op" id="6098154">)</span>&nbsp;<span class="op" id="6098156">&gt;</span>&nbsp;<span class="num" id="6098158">0</span>&nbsp;<span class="op" id="6098160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098164">for</span>&nbsp;<span class="ident" id="6098168">i</span>&nbsp;<span class="op" id="6098170">:=</span>&nbsp;<span class="num" id="6098173">0</span><span class="op" id="6098174">;</span>&nbsp;<span class="ident" id="6098176">i</span>&nbsp;<span class="op" id="6098178">&lt;</span>&nbsp;<span class="ident" id="6098180">p</span><span class="op" id="6098181">.</span><span class="ident" id="6098182">depth</span><span class="op" id="6098187">;</span>&nbsp;<span class="ident" id="6098189">i</span><span class="op" id="6098190">++</span>&nbsp;<span class="op" id="6098193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098198">p</span><span class="op" id="6098199">.</span><span class="ident" id="6098200">WriteString</span><span class="op" id="6098211">(</span><span class="ident" id="6098212">p</span><span class="op" id="6098213">.</span><span class="ident" id="6098214">indent</span><span class="op" id="6098220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098224">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098230">if</span>&nbsp;<span class="ident" id="6098233">depthDelta</span>&nbsp;<span class="op" id="6098244">&gt;</span>&nbsp;<span class="num" id="6098246">0</span>&nbsp;<span class="op" id="6098248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098252">p</span><span class="op" id="6098253">.</span><span class="ident" id="6098254">depth</span><span class="op" id="6098259">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098264">p</span><span class="op" id="6098265">.</span><span class="ident" id="6098266">indentedIn</span>&nbsp;<span class="op" id="6098277">=</span>&nbsp;<span class="builtintype" id="6098279">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098285">}</span><br>
<span class="lineno">875</span><span class="op" id="6098287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6098290">type</span>&nbsp;<span class="ident" id="6098295">parentStack</span>&nbsp;<span class="keyword" id="6098307">struct</span>&nbsp;<span class="op" id="6098314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098317">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6098323">*</span><span class="ident" id="6098324">printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098333">stack</span>&nbsp;<span class="op" id="6098339">[</span><span class="op" id="6098340">]</span><span class="builtintype" id="6098341">string</span><br>
<span class="lineno">880</span><span class="op" id="6098348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6098351">//&nbsp;trim&nbsp;updates&nbsp;the&nbsp;XML&nbsp;context&nbsp;to&nbsp;match&nbsp;the&nbsp;longest&nbsp;common&nbsp;prefix&nbsp;of&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="6098431">//&nbsp;and&nbsp;the&nbsp;given&nbsp;parents.&nbsp;&nbsp;A&nbsp;closing&nbsp;tag&nbsp;will&nbsp;be&nbsp;written&nbsp;for&nbsp;every&nbsp;parent</span><br>
<span class="lineno"></span><span class="comment" id="6098505">//&nbsp;popped.&nbsp;&nbsp;Passing&nbsp;a&nbsp;zero&nbsp;slice&nbsp;or&nbsp;nil&nbsp;will&nbsp;close&nbsp;all&nbsp;the&nbsp;elements.</span><br>
<span class="lineno">885</span><span class="keyword" id="6098574">func</span>&nbsp;<span class="op" id="6098579">(</span><span class="ident" id="6098580">s</span>&nbsp;<span class="op" id="6098582">*</span><span class="ident" id="6098583">parentStack</span><span class="op" id="6098594">)</span>&nbsp;<span class="ident" id="6098596">trim</span><span class="op" id="6098600">(</span><span class="ident" id="6098601">parents</span>&nbsp;<span class="op" id="6098609">[</span><span class="op" id="6098610">]</span><span class="builtintype" id="6098611">string</span><span class="op" id="6098617">)</span>&nbsp;<span class="builtintype" id="6098619">error</span>&nbsp;<span class="op" id="6098625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098628">split</span>&nbsp;<span class="op" id="6098634">:=</span>&nbsp;<span class="num" id="6098637">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098640">for</span>&nbsp;<span class="op" id="6098644">;</span>&nbsp;<span class="ident" id="6098646">split</span>&nbsp;<span class="op" id="6098652">&lt;</span>&nbsp;<span class="builtinfunc" id="6098654">len</span><span class="op" id="6098657">(</span><span class="ident" id="6098658">parents</span><span class="op" id="6098665">)</span>&nbsp;<span class="op" id="6098667">&amp;&amp;</span>&nbsp;<span class="ident" id="6098670">split</span>&nbsp;<span class="op" id="6098676">&lt;</span>&nbsp;<span class="builtinfunc" id="6098678">len</span><span class="op" id="6098681">(</span><span class="ident" id="6098682">s</span><span class="op" id="6098683">.</span><span class="ident" id="6098684">stack</span><span class="op" id="6098689">)</span><span class="op" id="6098690">;</span>&nbsp;<span class="ident" id="6098692">split</span><span class="op" id="6098697">++</span>&nbsp;<span class="op" id="6098700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098704">if</span>&nbsp;<span class="ident" id="6098707">parents</span><span class="op" id="6098714">[</span><span class="ident" id="6098715">split</span><span class="op" id="6098720">]</span>&nbsp;<span class="op" id="6098722">!=</span>&nbsp;<span class="ident" id="6098725">s</span><span class="op" id="6098726">.</span><span class="ident" id="6098727">stack</span><span class="op" id="6098732">[</span><span class="ident" id="6098733">split</span><span class="op" id="6098738">]</span>&nbsp;<span class="op" id="6098740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098745">break</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098759">for</span>&nbsp;<span class="ident" id="6098763">i</span>&nbsp;<span class="op" id="6098765">:=</span>&nbsp;<span class="builtinfunc" id="6098768">len</span><span class="op" id="6098771">(</span><span class="ident" id="6098772">s</span><span class="op" id="6098773">.</span><span class="ident" id="6098774">stack</span><span class="op" id="6098779">)</span>&nbsp;<span class="op" id="6098781">-</span>&nbsp;<span class="num" id="6098783">1</span><span class="op" id="6098784">;</span>&nbsp;<span class="ident" id="6098786">i</span>&nbsp;<span class="op" id="6098788">&gt;=</span>&nbsp;<span class="ident" id="6098791">split</span><span class="op" id="6098796">;</span>&nbsp;<span class="ident" id="6098798">i</span><span class="op" id="6098799">--</span>&nbsp;<span class="op" id="6098802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098806">if</span>&nbsp;<span class="ident" id="6098809">err</span>&nbsp;<span class="op" id="6098813">:=</span>&nbsp;<span class="ident" id="6098816">s</span><span class="op" id="6098817">.</span><span class="ident" id="6098818">p</span><span class="op" id="6098819">.</span><span class="ident" id="6098820">writeEnd</span><span class="op" id="6098828">(</span><span class="ident" id="6098829">Name</span><span class="op" id="6098833">{</span><span class="ident" id="6098834">Local</span><span class="op" id="6098839">:</span>&nbsp;<span class="ident" id="6098841">s</span><span class="op" id="6098842">.</span><span class="ident" id="6098843">stack</span><span class="op" id="6098848">[</span><span class="ident" id="6098849">i</span><span class="op" id="6098850">]</span><span class="op" id="6098851">}</span><span class="op" id="6098852">)</span><span class="op" id="6098853">;</span>&nbsp;<span class="ident" id="6098855">err</span>&nbsp;<span class="op" id="6098859">!=</span>&nbsp;<span class="ident" id="6098862">nil</span>&nbsp;<span class="op" id="6098866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098871">return</span>&nbsp;<span class="ident" id="6098878">err</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098890">s</span><span class="op" id="6098891">.</span><span class="ident" id="6098892">stack</span>&nbsp;<span class="op" id="6098898">=</span>&nbsp;<span class="ident" id="6098900">parents</span><span class="op" id="6098907">[</span><span class="op" id="6098908">:</span><span class="ident" id="6098909">split</span><span class="op" id="6098914">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098917">return</span>&nbsp;<span class="ident" id="6098924">nil</span><br>
<span class="lineno"></span><span class="op" id="6098928">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span><span class="comment" id="6098931">//&nbsp;push&nbsp;adds&nbsp;parent&nbsp;elements&nbsp;to&nbsp;the&nbsp;stack&nbsp;and&nbsp;writes&nbsp;open&nbsp;tags.</span><br>
<span class="lineno"></span><span class="keyword" id="6098995">func</span>&nbsp;<span class="op" id="6099000">(</span><span class="ident" id="6099001">s</span>&nbsp;<span class="op" id="6099003">*</span><span class="ident" id="6099004">parentStack</span><span class="op" id="6099015">)</span>&nbsp;<span class="ident" id="6099017">push</span><span class="op" id="6099021">(</span><span class="ident" id="6099022">parents</span>&nbsp;<span class="op" id="6099030">[</span><span class="op" id="6099031">]</span><span class="builtintype" id="6099032">string</span><span class="op" id="6099038">)</span>&nbsp;<span class="builtintype" id="6099040">error</span>&nbsp;<span class="op" id="6099046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099049">for</span>&nbsp;<span class="ident" id="6099053">i</span>&nbsp;<span class="op" id="6099055">:=</span>&nbsp;<span class="num" id="6099058">0</span><span class="op" id="6099059">;</span>&nbsp;<span class="ident" id="6099061">i</span>&nbsp;<span class="op" id="6099063">&lt;</span>&nbsp;<span class="builtinfunc" id="6099065">len</span><span class="op" id="6099068">(</span><span class="ident" id="6099069">parents</span><span class="op" id="6099076">)</span><span class="op" id="6099077">;</span>&nbsp;<span class="ident" id="6099079">i</span><span class="op" id="6099080">++</span>&nbsp;<span class="op" id="6099083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099087">if</span>&nbsp;<span class="ident" id="6099090">err</span>&nbsp;<span class="op" id="6099094">:=</span>&nbsp;<span class="ident" id="6099097">s</span><span class="op" id="6099098">.</span><span class="ident" id="6099099">p</span><span class="op" id="6099100">.</span><span class="ident" id="6099101">writeStart</span><span class="op" id="6099111">(</span><span class="op" id="6099112">&amp;</span><span class="ident" id="6099113">StartElement</span><span class="op" id="6099125">{</span><span class="ident" id="6099126">Name</span><span class="op" id="6099130">:</span>&nbsp;<span class="ident" id="6099132">Name</span><span class="op" id="6099136">{</span><span class="ident" id="6099137">Local</span><span class="op" id="6099142">:</span>&nbsp;<span class="ident" id="6099144">parents</span><span class="op" id="6099151">[</span><span class="ident" id="6099152">i</span><span class="op" id="6099153">]</span><span class="op" id="6099154">}</span><span class="op" id="6099155">}</span><span class="op" id="6099156">)</span><span class="op" id="6099157">;</span>&nbsp;<span class="ident" id="6099159">err</span>&nbsp;<span class="op" id="6099163">!=</span>&nbsp;<span class="ident" id="6099166">nil</span>&nbsp;<span class="op" id="6099170">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099175">return</span>&nbsp;<span class="ident" id="6099182">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6099188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6099191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099194">s</span><span class="op" id="6099195">.</span><span class="ident" id="6099196">stack</span>&nbsp;<span class="op" id="6099202">=</span>&nbsp;<span class="builtinfunc" id="6099204">append</span><span class="op" id="6099210">(</span><span class="ident" id="6099211">s</span><span class="op" id="6099212">.</span><span class="ident" id="6099213">stack</span><span class="op" id="6099218">,</span>&nbsp;<span class="ident" id="6099220">parents</span><span class="op" id="6099227">...</span><span class="op" id="6099230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099233">return</span>&nbsp;<span class="ident" id="6099240">nil</span><br>
<span class="lineno">910</span><span class="op" id="6099244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6099247">//&nbsp;A&nbsp;MarshalXMLError&nbsp;is&nbsp;returned&nbsp;when&nbsp;Marshal&nbsp;encounters&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="6099311">//&nbsp;that&nbsp;cannot&nbsp;be&nbsp;converted&nbsp;into&nbsp;XML.</span><br>
<span class="lineno"></span><span class="keyword" id="6099349">type</span>&nbsp;<span class="ident" id="6099354">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="6099375">struct</span>&nbsp;<span class="op" id="6099382">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099385">Type</span>&nbsp;<span class="ident" id="6099390">reflect</span><span class="op" id="6099397">.</span><span class="ident" id="6099398">Type</span><br>
<span class="lineno"></span><span class="op" id="6099403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6099406">func</span>&nbsp;<span class="op" id="6099411">(</span><span class="ident" id="6099412">e</span>&nbsp;<span class="op" id="6099414">*</span><span class="ident" id="6099415">UnsupportedTypeError</span><span class="op" id="6099435">)</span>&nbsp;<span class="ident" id="6099437">Error</span><span class="op" id="6099442">(</span><span class="op" id="6099443">)</span>&nbsp;<span class="builtintype" id="6099445">string</span>&nbsp;<span class="op" id="6099452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099455">return</span>&nbsp;<span class="string" id="6099462">&#34;xml:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="6099488">+</span>&nbsp;<span class="ident" id="6099490">e</span><span class="op" id="6099491">.</span><span class="ident" id="6099492">Type</span><span class="op" id="6099496">.</span><span class="ident" id="6099497">String</span><span class="op" id="6099503">(</span><span class="op" id="6099504">)</span><br>
<span class="lineno">920</span><span class="op" id="6099506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6099509">func</span>&nbsp;<span class="ident" id="6099514">isEmptyValue</span><span class="op" id="6099526">(</span><span class="ident" id="6099527">v</span>&nbsp;<span class="ident" id="6099529">reflect</span><span class="op" id="6099536">.</span><span class="ident" id="6099537">Value</span><span class="op" id="6099542">)</span>&nbsp;<span class="builtintype" id="6099544">bool</span>&nbsp;<span class="op" id="6099549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099552">switch</span>&nbsp;<span class="ident" id="6099559">v</span><span class="op" id="6099560">.</span><span class="ident" id="6099561">Kind</span><span class="op" id="6099565">(</span><span class="op" id="6099566">)</span>&nbsp;<span class="op" id="6099568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099571">case</span>&nbsp;<span class="ident" id="6099576">reflect</span><span class="op" id="6099583">.</span><span class="ident" id="6099584">Array</span><span class="op" id="6099589">,</span>&nbsp;<span class="ident" id="6099591">reflect</span><span class="op" id="6099598">.</span><span class="ident" id="6099599">Map</span><span class="op" id="6099602">,</span>&nbsp;<span class="ident" id="6099604">reflect</span><span class="op" id="6099611">.</span><span class="ident" id="6099612">Slice</span><span class="op" id="6099617">,</span>&nbsp;<span class="ident" id="6099619">reflect</span><span class="op" id="6099626">.</span><span class="ident" id="6099627">String</span><span class="op" id="6099633">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099637">return</span>&nbsp;<span class="ident" id="6099644">v</span><span class="op" id="6099645">.</span><span class="ident" id="6099646">Len</span><span class="op" id="6099649">(</span><span class="op" id="6099650">)</span>&nbsp;<span class="op" id="6099652">==</span>&nbsp;<span class="num" id="6099655">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099658">case</span>&nbsp;<span class="ident" id="6099663">reflect</span><span class="op" id="6099670">.</span><span class="ident" id="6099671">Bool</span><span class="op" id="6099675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099679">return</span>&nbsp;<span class="op" id="6099686">!</span><span class="ident" id="6099687">v</span><span class="op" id="6099688">.</span><span class="ident" id="6099689">Bool</span><span class="op" id="6099693">(</span><span class="op" id="6099694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099697">case</span>&nbsp;<span class="ident" id="6099702">reflect</span><span class="op" id="6099709">.</span><span class="ident" id="6099710">Int</span><span class="op" id="6099713">,</span>&nbsp;<span class="ident" id="6099715">reflect</span><span class="op" id="6099722">.</span><span class="ident" id="6099723">Int8</span><span class="op" id="6099727">,</span>&nbsp;<span class="ident" id="6099729">reflect</span><span class="op" id="6099736">.</span><span class="ident" id="6099737">Int16</span><span class="op" id="6099742">,</span>&nbsp;<span class="ident" id="6099744">reflect</span><span class="op" id="6099751">.</span><span class="ident" id="6099752">Int32</span><span class="op" id="6099757">,</span>&nbsp;<span class="ident" id="6099759">reflect</span><span class="op" id="6099766">.</span><span class="ident" id="6099767">Int64</span><span class="op" id="6099772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099776">return</span>&nbsp;<span class="ident" id="6099783">v</span><span class="op" id="6099784">.</span><span class="ident" id="6099785">Int</span><span class="op" id="6099788">(</span><span class="op" id="6099789">)</span>&nbsp;<span class="op" id="6099791">==</span>&nbsp;<span class="num" id="6099794">0</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099797">case</span>&nbsp;<span class="ident" id="6099802">reflect</span><span class="op" id="6099809">.</span><span class="ident" id="6099810">Uint</span><span class="op" id="6099814">,</span>&nbsp;<span class="ident" id="6099816">reflect</span><span class="op" id="6099823">.</span><span class="ident" id="6099824">Uint8</span><span class="op" id="6099829">,</span>&nbsp;<span class="ident" id="6099831">reflect</span><span class="op" id="6099838">.</span><span class="ident" id="6099839">Uint16</span><span class="op" id="6099845">,</span>&nbsp;<span class="ident" id="6099847">reflect</span><span class="op" id="6099854">.</span><span class="ident" id="6099855">Uint32</span><span class="op" id="6099861">,</span>&nbsp;<span class="ident" id="6099863">reflect</span><span class="op" id="6099870">.</span><span class="ident" id="6099871">Uint64</span><span class="op" id="6099877">,</span>&nbsp;<span class="ident" id="6099879">reflect</span><span class="op" id="6099886">.</span><span class="ident" id="6099887">Uintptr</span><span class="op" id="6099894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099898">return</span>&nbsp;<span class="ident" id="6099905">v</span><span class="op" id="6099906">.</span><span class="ident" id="6099907">Uint</span><span class="op" id="6099911">(</span><span class="op" id="6099912">)</span>&nbsp;<span class="op" id="6099914">==</span>&nbsp;<span class="num" id="6099917">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099920">case</span>&nbsp;<span class="ident" id="6099925">reflect</span><span class="op" id="6099932">.</span><span class="ident" id="6099933">Float32</span><span class="op" id="6099940">,</span>&nbsp;<span class="ident" id="6099942">reflect</span><span class="op" id="6099949">.</span><span class="ident" id="6099950">Float64</span><span class="op" id="6099957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099961">return</span>&nbsp;<span class="ident" id="6099968">v</span><span class="op" id="6099969">.</span><span class="ident" id="6099970">Float</span><span class="op" id="6099975">(</span><span class="op" id="6099976">)</span>&nbsp;<span class="op" id="6099978">==</span>&nbsp;<span class="num" id="6099981">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099984">case</span>&nbsp;<span class="ident" id="6099989">reflect</span><span class="op" id="6099996">.</span><span class="ident" id="6099997">Interface</span><span class="op" id="6100006">,</span>&nbsp;<span class="ident" id="6100008">reflect</span><span class="op" id="6100015">.</span><span class="ident" id="6100016">Ptr</span><span class="op" id="6100019">:</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100023">return</span>&nbsp;<span class="ident" id="6100030">v</span><span class="op" id="6100031">.</span><span class="ident" id="6100032">IsNil</span><span class="op" id="6100037">(</span><span class="op" id="6100038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6100041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100044">return</span>&nbsp;<span class="builtintype" id="6100051">false</span><br>
<span class="lineno"></span><span class="op" id="6100057">}</span>
</div>
</body>
</html>
