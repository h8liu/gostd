<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1973974">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1974029">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1974083">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1974134">package</span>&nbsp;<span class="ident" id="1974142">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1974148">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspThe&nbsp;algorithm&nbsp;is&nbsp;based&nbsp;in&nbsp;part&nbsp;on&nbsp;&#34;Optimal&nbsp;Partitioning&nbsp;of<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspNewton&#39;s&nbsp;Method&nbsp;for&nbsp;Calculating&nbsp;Roots&#34;,&nbsp;by&nbsp;Gunter&nbsp;Meinardus<br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbspand&nbsp;G.&nbsp;D.&nbsp;Taylor,&nbsp;Mathematics&nbsp;of&nbsp;Computation&nbsp;©&nbsp;1980&nbsp;American<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspMathematical&nbsp;Society.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp(http://www.jstor.org/stable/2006387?seq=9,&nbsp;accessed&nbsp;11-Feb-2010)<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="1974429">//&nbsp;Cbrt&nbsp;returns&nbsp;the&nbsp;cube&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1974465">//</span><br>
<span class="lineno"></span><span class="comment" id="1974468">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1974490">//&nbsp;&nbsp;&nbsp;&nbspCbrt(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1974509">//&nbsp;&nbsp;&nbsp;&nbspCbrt(±Inf)&nbsp;=&nbsp;±Inf</span><br>
<span class="lineno">20</span><span class="comment" id="1974532">//&nbsp;&nbsp;&nbsp;&nbspCbrt(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1974551">func</span>&nbsp;<span class="ident" id="1974556">Cbrt</span><span class="op" id="1974560">(</span><span class="ident" id="1974561">x</span>&nbsp;<span class="builtintype" id="1974563">float64</span><span class="op" id="1974570">)</span>&nbsp;<span class="builtintype" id="1974572">float64</span>&nbsp;<span class="op" id="1974580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974583">const</span>&nbsp;<span class="op" id="1974589">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974593">A1</span>&nbsp;<span class="op" id="1974596">=</span>&nbsp;<span class="num" id="1974598">1.662848358e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974616">A2</span>&nbsp;<span class="op" id="1974619">=</span>&nbsp;<span class="num" id="1974621">1.096040958e+00</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974639">A3</span>&nbsp;<span class="op" id="1974642">=</span>&nbsp;<span class="num" id="1974644">4.105032829e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974662">A4</span>&nbsp;<span class="op" id="1974665">=</span>&nbsp;<span class="num" id="1974667">5.649335816e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974685">B1</span>&nbsp;<span class="op" id="1974688">=</span>&nbsp;<span class="num" id="1974690">2.639607233e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974708">B2</span>&nbsp;<span class="op" id="1974711">=</span>&nbsp;<span class="num" id="1974713">8.699282849e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974731">B3</span>&nbsp;<span class="op" id="1974734">=</span>&nbsp;<span class="num" id="1974736">1.629083358e-01</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974754">B4</span>&nbsp;<span class="op" id="1974757">=</span>&nbsp;<span class="num" id="1974759">2.824667908e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974777">C1</span>&nbsp;<span class="op" id="1974780">=</span>&nbsp;<span class="num" id="1974782">4.190115298e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974800">C2</span>&nbsp;<span class="op" id="1974803">=</span>&nbsp;<span class="num" id="1974805">6.904625373e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974823">C3</span>&nbsp;<span class="op" id="1974826">=</span>&nbsp;<span class="num" id="1974828">6.46502159e-02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974845">C4</span>&nbsp;<span class="op" id="1974848">=</span>&nbsp;<span class="num" id="1974850">1.412333954e-01</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1974870">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974888">switch</span>&nbsp;<span class="op" id="1974895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974898">case</span>&nbsp;<span class="ident" id="1974903">x</span>&nbsp;<span class="op" id="1974905">==</span>&nbsp;<span class="num" id="1974908">0</span>&nbsp;<span class="op" id="1974910">||</span>&nbsp;<span class="ident" id="1974913">IsNaN</span><span class="op" id="1974918">(</span><span class="ident" id="1974919">x</span><span class="op" id="1974920">)</span>&nbsp;<span class="op" id="1974922">||</span>&nbsp;<span class="ident" id="1974925">IsInf</span><span class="op" id="1974930">(</span><span class="ident" id="1974931">x</span><span class="op" id="1974932">,</span>&nbsp;<span class="num" id="1974934">0</span><span class="op" id="1974935">)</span><span class="op" id="1974936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974940">return</span>&nbsp;<span class="ident" id="1974947">x</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974953">sign</span>&nbsp;<span class="op" id="1974958">:=</span>&nbsp;<span class="ident" id="1974961">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974968">if</span>&nbsp;<span class="ident" id="1974971">x</span>&nbsp;<span class="op" id="1974973">&lt;</span>&nbsp;<span class="num" id="1974975">0</span>&nbsp;<span class="op" id="1974977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974981">x</span>&nbsp;<span class="op" id="1974983">=</span>&nbsp;<span class="op" id="1974985">-</span><span class="ident" id="1974986">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974990">sign</span>&nbsp;<span class="op" id="1974995">=</span>&nbsp;<span class="ident" id="1974997">true</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1975006">//&nbsp;Reduce&nbsp;argument&nbsp;and&nbsp;estimate&nbsp;cube&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975049">f</span><span class="op" id="1975050">,</span>&nbsp;<span class="ident" id="1975052">e</span>&nbsp;<span class="op" id="1975054">:=</span>&nbsp;<span class="ident" id="1975057">Frexp</span><span class="op" id="1975062">(</span><span class="ident" id="1975063">x</span><span class="op" id="1975064">)</span>&nbsp;<span class="comment" id="1975066">//&nbsp;0.5&nbsp;&lt;=&nbsp;f&nbsp;&lt;&nbsp;1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975085">m</span>&nbsp;<span class="op" id="1975087">:=</span>&nbsp;<span class="ident" id="1975090">e</span>&nbsp;<span class="op" id="1975092">%</span>&nbsp;<span class="num" id="1975094">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975097">if</span>&nbsp;<span class="ident" id="1975100">m</span>&nbsp;<span class="op" id="1975102">&gt;</span>&nbsp;<span class="num" id="1975104">0</span>&nbsp;<span class="op" id="1975106">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975110">m</span>&nbsp;<span class="op" id="1975112">-=</span>&nbsp;<span class="num" id="1975115">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975119">e</span>&nbsp;<span class="op" id="1975121">-=</span>&nbsp;<span class="ident" id="1975124">m</span>&nbsp;<span class="comment" id="1975126">//&nbsp;e&nbsp;is&nbsp;multiple&nbsp;of&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975152">switch</span>&nbsp;<span class="ident" id="1975159">m</span>&nbsp;<span class="op" id="1975161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975164">case</span>&nbsp;<span class="num" id="1975169">0</span><span class="op" id="1975170">:</span>&nbsp;<span class="comment" id="1975172">//&nbsp;0.5&nbsp;&lt;=&nbsp;f&nbsp;&lt;&nbsp;1.0</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975192">f</span>&nbsp;<span class="op" id="1975194">=</span>&nbsp;<span class="ident" id="1975196">A1</span><span class="op" id="1975198">*</span><span class="ident" id="1975199">f</span>&nbsp;<span class="op" id="1975201">+</span>&nbsp;<span class="ident" id="1975203">A2</span>&nbsp;<span class="op" id="1975206">-</span>&nbsp;<span class="ident" id="1975208">A3</span><span class="op" id="1975210">/</span><span class="op" id="1975211">(</span><span class="ident" id="1975212">A4</span><span class="op" id="1975214">+</span><span class="ident" id="1975215">f</span><span class="op" id="1975216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975219">case</span>&nbsp;<span class="op" id="1975224">-</span><span class="num" id="1975225">1</span><span class="op" id="1975226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975230">f</span>&nbsp;<span class="op" id="1975232">*=</span>&nbsp;<span class="num" id="1975235">0.5</span>&nbsp;<span class="comment" id="1975239">//&nbsp;0.25&nbsp;&lt;=&nbsp;f&nbsp;&lt;&nbsp;0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975260">f</span>&nbsp;<span class="op" id="1975262">=</span>&nbsp;<span class="ident" id="1975264">B1</span><span class="op" id="1975266">*</span><span class="ident" id="1975267">f</span>&nbsp;<span class="op" id="1975269">+</span>&nbsp;<span class="ident" id="1975271">B2</span>&nbsp;<span class="op" id="1975274">-</span>&nbsp;<span class="ident" id="1975276">B3</span><span class="op" id="1975278">/</span><span class="op" id="1975279">(</span><span class="ident" id="1975280">B4</span><span class="op" id="1975282">+</span><span class="ident" id="1975283">f</span><span class="op" id="1975284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975287">default</span><span class="op" id="1975294">:</span>&nbsp;<span class="comment" id="1975296">//&nbsp;m&nbsp;==&nbsp;-2</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975309">f</span>&nbsp;<span class="op" id="1975311">*=</span>&nbsp;<span class="num" id="1975314">0.25</span>&nbsp;<span class="comment" id="1975319">//&nbsp;0.125&nbsp;&lt;=&nbsp;f&nbsp;&lt;&nbsp;0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975342">f</span>&nbsp;<span class="op" id="1975344">=</span>&nbsp;<span class="ident" id="1975346">C1</span><span class="op" id="1975348">*</span><span class="ident" id="1975349">f</span>&nbsp;<span class="op" id="1975351">+</span>&nbsp;<span class="ident" id="1975353">C2</span>&nbsp;<span class="op" id="1975356">-</span>&nbsp;<span class="ident" id="1975358">C3</span><span class="op" id="1975360">/</span><span class="op" id="1975361">(</span><span class="ident" id="1975362">C4</span><span class="op" id="1975364">+</span><span class="ident" id="1975365">f</span><span class="op" id="1975366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975372">y</span>&nbsp;<span class="op" id="1975374">:=</span>&nbsp;<span class="ident" id="1975377">Ldexp</span><span class="op" id="1975382">(</span><span class="ident" id="1975383">f</span><span class="op" id="1975384">,</span>&nbsp;<span class="ident" id="1975386">e</span><span class="op" id="1975387">/</span><span class="num" id="1975388">3</span><span class="op" id="1975389">)</span>&nbsp;<span class="comment" id="1975391">//&nbsp;e/3&nbsp;=&nbsp;exponent&nbsp;of&nbsp;cube&nbsp;root</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1975424">//&nbsp;Iterate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975436">s</span>&nbsp;<span class="op" id="1975438">:=</span>&nbsp;<span class="ident" id="1975441">y</span>&nbsp;<span class="op" id="1975443">*</span>&nbsp;<span class="ident" id="1975445">y</span>&nbsp;<span class="op" id="1975447">*</span>&nbsp;<span class="ident" id="1975449">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975452">t</span>&nbsp;<span class="op" id="1975454">:=</span>&nbsp;<span class="ident" id="1975457">s</span>&nbsp;<span class="op" id="1975459">+</span>&nbsp;<span class="ident" id="1975461">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975464">y</span>&nbsp;<span class="op" id="1975466">*=</span>&nbsp;<span class="op" id="1975469">(</span><span class="ident" id="1975470">t</span>&nbsp;<span class="op" id="1975472">+</span>&nbsp;<span class="ident" id="1975474">x</span><span class="op" id="1975475">)</span>&nbsp;<span class="op" id="1975477">/</span>&nbsp;<span class="op" id="1975479">(</span><span class="ident" id="1975480">s</span>&nbsp;<span class="op" id="1975482">+</span>&nbsp;<span class="ident" id="1975484">t</span><span class="op" id="1975485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1975488">//&nbsp;Reiterate</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975502">s</span>&nbsp;<span class="op" id="1975504">=</span>&nbsp;<span class="op" id="1975506">(</span><span class="ident" id="1975507">y</span><span class="op" id="1975508">*</span><span class="ident" id="1975509">y</span><span class="op" id="1975510">*</span><span class="ident" id="1975511">y</span>&nbsp;<span class="op" id="1975513">-</span>&nbsp;<span class="ident" id="1975515">x</span><span class="op" id="1975516">)</span>&nbsp;<span class="op" id="1975518">/</span>&nbsp;<span class="ident" id="1975520">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975523">y</span>&nbsp;<span class="op" id="1975525">-=</span>&nbsp;<span class="ident" id="1975528">y</span>&nbsp;<span class="op" id="1975530">*</span>&nbsp;<span class="op" id="1975532">(</span><span class="op" id="1975533">(</span><span class="op" id="1975534">(</span><span class="num" id="1975535">14.0</span><span class="op" id="1975539">/</span><span class="num" id="1975540">81.0</span><span class="op" id="1975544">)</span><span class="op" id="1975545">*</span><span class="ident" id="1975546">s</span><span class="op" id="1975547">-</span><span class="op" id="1975548">(</span><span class="num" id="1975549">2.0</span><span class="op" id="1975552">/</span><span class="num" id="1975553">9.0</span><span class="op" id="1975556">)</span><span class="op" id="1975557">)</span><span class="op" id="1975558">*</span><span class="ident" id="1975559">s</span>&nbsp;<span class="op" id="1975561">+</span>&nbsp;<span class="op" id="1975563">(</span><span class="num" id="1975564">1.0</span>&nbsp;<span class="op" id="1975568">/</span>&nbsp;<span class="num" id="1975570">3.0</span><span class="op" id="1975573">)</span><span class="op" id="1975574">)</span>&nbsp;<span class="op" id="1975576">*</span>&nbsp;<span class="ident" id="1975578">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975581">if</span>&nbsp;<span class="ident" id="1975584">sign</span>&nbsp;<span class="op" id="1975589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975593">y</span>&nbsp;<span class="op" id="1975595">=</span>&nbsp;<span class="op" id="1975597">-</span><span class="ident" id="1975598">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975601">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975604">return</span>&nbsp;<span class="ident" id="1975611">y</span><br>
<span class="lineno"></span><span class="op" id="1975613">}</span>
</div>
</body>
</html>
