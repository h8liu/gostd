<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html" class="current">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2058261">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2058316">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2058370">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2058421">package</span>&nbsp;<span class="ident" id="2058429">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2058435">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2058507">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2058561">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2058613">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2058668">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2058698">//</span><br>
<span class="lineno"></span><span class="comment" id="2058701">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2058757">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2058826">//</span><br>
<span class="lineno"></span><span class="comment" id="2058829">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2058888">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2058944">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2059001">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2059018">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2059074">//</span><br>
<span class="lineno">25</span><span class="comment" id="2059077">//</span><br>
<span class="lineno"></span><span class="comment" id="2059080">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2059104">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2059129">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2059160">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2059192">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2059235">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2059266">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2059297">//</span><br>
<span class="lineno"></span><span class="comment" id="2059300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2059327">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2059341">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2059375">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2059414">//</span><br>
<span class="lineno"></span><span class="comment" id="2059417">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2059428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2059463">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2059499">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2059565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2059631">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2059695">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2059737">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2059793">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2059843">//</span><br>
<span class="lineno"></span><span class="comment" id="2059846">//</span><br>
<span class="lineno">50</span><span class="comment" id="2059849">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2059901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2059975">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2059995">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2060062">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2060129">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2060197">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2060267">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2060328">//</span><br>
<span class="lineno"></span><span class="comment" id="2060331">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2060390">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2060447">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2060502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2060558">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2060614">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2060666">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2060733">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2060779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2060828">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2060893">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2060956">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2061016">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2061033">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2061076">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2061119">//</span><br>
<span class="lineno">75</span><span class="comment" id="2061122">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2061168">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2061223">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2061261">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2061278">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2061333">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2061376">//</span><br>
<span class="lineno"></span><span class="comment" id="2061379">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2061411">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2061475">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2061546">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2061607">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2061672">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2061719">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2061736">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2061791">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2061834">//</span><br>
<span class="lineno"></span><span class="comment" id="2061837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2061852">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2061914">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2061959">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2062001">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2062040">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2062103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2062118">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2062176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2062212">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2062272">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2062309">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2062365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2062428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2062483">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2062529">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2062575">//</span><br>
<span class="lineno"></span><span class="comment" id="2062578">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2062607">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2062670">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2062733">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2062775">//</span><br>
<span class="lineno"></span><span class="comment" id="2062778">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2062803">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2062863">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2062923">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2062961">const</span>&nbsp;<span class="op" id="2062967">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062970">erx</span>&nbsp;<span class="op" id="2062974">=</span>&nbsp;<span class="num" id="2062976">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2063003">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2063026">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063085">efx</span>&nbsp;&nbsp;<span class="op" id="2063090">=</span>&nbsp;<span class="num" id="2063092">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2063120">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063143">efx8</span>&nbsp;<span class="op" id="2063148">=</span>&nbsp;<span class="num" id="2063150">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2063178">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063201">pp0</span>&nbsp;&nbsp;<span class="op" id="2063206">=</span>&nbsp;<span class="num" id="2063208">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2063236">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063259">pp1</span>&nbsp;&nbsp;<span class="op" id="2063264">=</span>&nbsp;<span class="op" id="2063266">-</span><span class="num" id="2063267">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2063294">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063317">pp2</span>&nbsp;&nbsp;<span class="op" id="2063322">=</span>&nbsp;<span class="op" id="2063324">-</span><span class="num" id="2063325">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2063352">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063375">pp3</span>&nbsp;&nbsp;<span class="op" id="2063380">=</span>&nbsp;<span class="op" id="2063382">-</span><span class="num" id="2063383">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2063410">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063433">pp4</span>&nbsp;&nbsp;<span class="op" id="2063438">=</span>&nbsp;<span class="op" id="2063440">-</span><span class="num" id="2063441">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2063468">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063491">qq1</span>&nbsp;&nbsp;<span class="op" id="2063496">=</span>&nbsp;<span class="num" id="2063498">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2063526">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063549">qq2</span>&nbsp;&nbsp;<span class="op" id="2063554">=</span>&nbsp;<span class="num" id="2063556">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2063584">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063607">qq3</span>&nbsp;&nbsp;<span class="op" id="2063612">=</span>&nbsp;<span class="num" id="2063614">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2063642">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063665">qq4</span>&nbsp;&nbsp;<span class="op" id="2063670">=</span>&nbsp;<span class="num" id="2063672">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2063700">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063723">qq5</span>&nbsp;&nbsp;<span class="op" id="2063728">=</span>&nbsp;<span class="op" id="2063730">-</span><span class="num" id="2063731">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2063758">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2063781">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063844">pa0</span>&nbsp;<span class="op" id="2063848">=</span>&nbsp;<span class="op" id="2063850">-</span><span class="num" id="2063851">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2063878">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063901">pa1</span>&nbsp;<span class="op" id="2063905">=</span>&nbsp;<span class="num" id="2063907">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2063935">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063958">pa2</span>&nbsp;<span class="op" id="2063962">=</span>&nbsp;<span class="op" id="2063964">-</span><span class="num" id="2063965">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2063992">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064015">pa3</span>&nbsp;<span class="op" id="2064019">=</span>&nbsp;<span class="num" id="2064021">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2064049">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064072">pa4</span>&nbsp;<span class="op" id="2064076">=</span>&nbsp;<span class="op" id="2064078">-</span><span class="num" id="2064079">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2064106">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064129">pa5</span>&nbsp;<span class="op" id="2064133">=</span>&nbsp;<span class="num" id="2064135">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2064163">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064186">pa6</span>&nbsp;<span class="op" id="2064190">=</span>&nbsp;<span class="op" id="2064192">-</span><span class="num" id="2064193">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2064220">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064243">qa1</span>&nbsp;<span class="op" id="2064247">=</span>&nbsp;<span class="num" id="2064249">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2064277">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064300">qa2</span>&nbsp;<span class="op" id="2064304">=</span>&nbsp;<span class="num" id="2064306">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2064334">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064357">qa3</span>&nbsp;<span class="op" id="2064361">=</span>&nbsp;<span class="num" id="2064363">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2064391">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064414">qa4</span>&nbsp;<span class="op" id="2064418">=</span>&nbsp;<span class="num" id="2064420">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2064448">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064471">qa5</span>&nbsp;<span class="op" id="2064475">=</span>&nbsp;<span class="num" id="2064477">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2064505">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064528">qa6</span>&nbsp;<span class="op" id="2064532">=</span>&nbsp;<span class="num" id="2064534">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2064562">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2064585">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064647">ra0</span>&nbsp;<span class="op" id="2064651">=</span>&nbsp;<span class="op" id="2064653">-</span><span class="num" id="2064654">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2064681">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064704">ra1</span>&nbsp;<span class="op" id="2064708">=</span>&nbsp;<span class="op" id="2064710">-</span><span class="num" id="2064711">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2064738">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064761">ra2</span>&nbsp;<span class="op" id="2064765">=</span>&nbsp;<span class="op" id="2064767">-</span><span class="num" id="2064768">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2064795">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064818">ra3</span>&nbsp;<span class="op" id="2064822">=</span>&nbsp;<span class="op" id="2064824">-</span><span class="num" id="2064825">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2064852">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064875">ra4</span>&nbsp;<span class="op" id="2064879">=</span>&nbsp;<span class="op" id="2064881">-</span><span class="num" id="2064882">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2064909">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064932">ra5</span>&nbsp;<span class="op" id="2064936">=</span>&nbsp;<span class="op" id="2064938">-</span><span class="num" id="2064939">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2064966">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064989">ra6</span>&nbsp;<span class="op" id="2064993">=</span>&nbsp;<span class="op" id="2064995">-</span><span class="num" id="2064996">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2065023">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065046">ra7</span>&nbsp;<span class="op" id="2065050">=</span>&nbsp;<span class="op" id="2065052">-</span><span class="num" id="2065053">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2065080">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065103">sa1</span>&nbsp;<span class="op" id="2065107">=</span>&nbsp;<span class="num" id="2065109">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2065137">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065160">sa2</span>&nbsp;<span class="op" id="2065164">=</span>&nbsp;<span class="num" id="2065166">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2065194">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065217">sa3</span>&nbsp;<span class="op" id="2065221">=</span>&nbsp;<span class="num" id="2065223">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2065251">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065274">sa4</span>&nbsp;<span class="op" id="2065278">=</span>&nbsp;<span class="num" id="2065280">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2065308">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065331">sa5</span>&nbsp;<span class="op" id="2065335">=</span>&nbsp;<span class="num" id="2065337">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2065365">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065388">sa6</span>&nbsp;<span class="op" id="2065392">=</span>&nbsp;<span class="num" id="2065394">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2065422">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065445">sa7</span>&nbsp;<span class="op" id="2065449">=</span>&nbsp;<span class="num" id="2065451">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2065479">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065502">sa8</span>&nbsp;<span class="op" id="2065506">=</span>&nbsp;<span class="op" id="2065508">-</span><span class="num" id="2065509">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2065536">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065559">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065618">rb0</span>&nbsp;<span class="op" id="2065622">=</span>&nbsp;<span class="op" id="2065624">-</span><span class="num" id="2065625">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2065652">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065675">rb1</span>&nbsp;<span class="op" id="2065679">=</span>&nbsp;<span class="op" id="2065681">-</span><span class="num" id="2065682">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2065709">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065732">rb2</span>&nbsp;<span class="op" id="2065736">=</span>&nbsp;<span class="op" id="2065738">-</span><span class="num" id="2065739">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2065766">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065789">rb3</span>&nbsp;<span class="op" id="2065793">=</span>&nbsp;<span class="op" id="2065795">-</span><span class="num" id="2065796">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2065823">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065846">rb4</span>&nbsp;<span class="op" id="2065850">=</span>&nbsp;<span class="op" id="2065852">-</span><span class="num" id="2065853">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2065880">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065903">rb5</span>&nbsp;<span class="op" id="2065907">=</span>&nbsp;<span class="op" id="2065909">-</span><span class="num" id="2065910">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2065937">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065960">rb6</span>&nbsp;<span class="op" id="2065964">=</span>&nbsp;<span class="op" id="2065966">-</span><span class="num" id="2065967">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2065994">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066017">sb1</span>&nbsp;<span class="op" id="2066021">=</span>&nbsp;<span class="num" id="2066023">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2066051">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066074">sb2</span>&nbsp;<span class="op" id="2066078">=</span>&nbsp;<span class="num" id="2066080">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2066108">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066131">sb3</span>&nbsp;<span class="op" id="2066135">=</span>&nbsp;<span class="num" id="2066137">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2066165">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066188">sb4</span>&nbsp;<span class="op" id="2066192">=</span>&nbsp;<span class="num" id="2066194">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2066222">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066245">sb5</span>&nbsp;<span class="op" id="2066249">=</span>&nbsp;<span class="num" id="2066251">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2066279">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066302">sb6</span>&nbsp;<span class="op" id="2066306">=</span>&nbsp;<span class="num" id="2066308">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2066336">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066359">sb7</span>&nbsp;<span class="op" id="2066363">=</span>&nbsp;<span class="op" id="2066365">-</span><span class="num" id="2066366">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2066393">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2066415">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2066418">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2066458">//</span><br>
<span class="lineno"></span><span class="comment" id="2066461">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2066483">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2066500">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2066518">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2066536">func</span>&nbsp;<span class="ident" id="2066541">Erf</span><span class="op" id="2066544">(</span><span class="ident" id="2066545">x</span>&nbsp;<span class="builtintype" id="2066547">float64</span><span class="op" id="2066554">)</span>&nbsp;<span class="builtintype" id="2066556">float64</span>&nbsp;<span class="op" id="2066564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066567">const</span>&nbsp;<span class="op" id="2066573">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066577">VeryTiny</span>&nbsp;<span class="op" id="2066586">=</span>&nbsp;<span class="num" id="2066588">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2066611">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066635">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066644">=</span>&nbsp;<span class="num" id="2066646">1.0</span>&nbsp;<span class="op" id="2066650">/</span>&nbsp;<span class="op" id="2066652">(</span><span class="num" id="2066653">1</span>&nbsp;<span class="op" id="2066655">&lt;&lt;</span>&nbsp;<span class="num" id="2066658">28</span><span class="op" id="2066660">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066669">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066683">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066701">switch</span>&nbsp;<span class="op" id="2066708">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066711">case</span>&nbsp;<span class="ident" id="2066716">IsNaN</span><span class="op" id="2066721">(</span><span class="ident" id="2066722">x</span><span class="op" id="2066723">)</span><span class="op" id="2066724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066728">return</span>&nbsp;<span class="ident" id="2066735">NaN</span><span class="op" id="2066738">(</span><span class="op" id="2066739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066742">case</span>&nbsp;<span class="ident" id="2066747">IsInf</span><span class="op" id="2066752">(</span><span class="ident" id="2066753">x</span><span class="op" id="2066754">,</span>&nbsp;<span class="num" id="2066756">1</span><span class="op" id="2066757">)</span><span class="op" id="2066758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066762">return</span>&nbsp;<span class="num" id="2066769">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066772">case</span>&nbsp;<span class="ident" id="2066777">IsInf</span><span class="op" id="2066782">(</span><span class="ident" id="2066783">x</span><span class="op" id="2066784">,</span>&nbsp;<span class="op" id="2066786">-</span><span class="num" id="2066787">1</span><span class="op" id="2066788">)</span><span class="op" id="2066789">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066793">return</span>&nbsp;<span class="op" id="2066800">-</span><span class="num" id="2066801">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066807">sign</span>&nbsp;<span class="op" id="2066812">:=</span>&nbsp;<span class="builtintype" id="2066815">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066822">if</span>&nbsp;<span class="ident" id="2066825">x</span>&nbsp;<span class="op" id="2066827">&lt;</span>&nbsp;<span class="num" id="2066829">0</span>&nbsp;<span class="op" id="2066831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066835">x</span>&nbsp;<span class="op" id="2066837">=</span>&nbsp;<span class="op" id="2066839">-</span><span class="ident" id="2066840">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066844">sign</span>&nbsp;<span class="op" id="2066849">=</span>&nbsp;<span class="builtintype" id="2066851">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066860">if</span>&nbsp;<span class="ident" id="2066863">x</span>&nbsp;<span class="op" id="2066865">&lt;</span>&nbsp;<span class="num" id="2066867">0.84375</span>&nbsp;<span class="op" id="2066875">{</span>&nbsp;<span class="comment" id="2066877">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066896">var</span>&nbsp;<span class="ident" id="2066900">temp</span>&nbsp;<span class="builtintype" id="2066905">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066915">if</span>&nbsp;<span class="ident" id="2066918">x</span>&nbsp;<span class="op" id="2066920">&lt;</span>&nbsp;<span class="ident" id="2066922">Small</span>&nbsp;<span class="op" id="2066928">{</span>&nbsp;<span class="comment" id="2066930">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066949">if</span>&nbsp;<span class="ident" id="2066952">x</span>&nbsp;<span class="op" id="2066954">&lt;</span>&nbsp;<span class="ident" id="2066956">VeryTiny</span>&nbsp;<span class="op" id="2066965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066971">temp</span>&nbsp;<span class="op" id="2066976">=</span>&nbsp;<span class="num" id="2066978">0.125</span>&nbsp;<span class="op" id="2066984">*</span>&nbsp;<span class="op" id="2066986">(</span><span class="num" id="2066987">8.0</span><span class="op" id="2066990">*</span><span class="ident" id="2066991">x</span>&nbsp;<span class="op" id="2066993">+</span>&nbsp;<span class="ident" id="2066995">efx8</span><span class="op" id="2066999">*</span><span class="ident" id="2067000">x</span><span class="op" id="2067001">)</span>&nbsp;<span class="comment" id="2067003">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067025">}</span>&nbsp;<span class="keyword" id="2067027">else</span>&nbsp;<span class="op" id="2067032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067038">temp</span>&nbsp;<span class="op" id="2067043">=</span>&nbsp;<span class="ident" id="2067045">x</span>&nbsp;<span class="op" id="2067047">+</span>&nbsp;<span class="ident" id="2067049">efx</span><span class="op" id="2067052">*</span><span class="ident" id="2067053">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067058">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067062">}</span>&nbsp;<span class="keyword" id="2067064">else</span>&nbsp;<span class="op" id="2067069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067074">z</span>&nbsp;<span class="op" id="2067076">:=</span>&nbsp;<span class="ident" id="2067079">x</span>&nbsp;<span class="op" id="2067081">*</span>&nbsp;<span class="ident" id="2067083">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067088">r</span>&nbsp;<span class="op" id="2067090">:=</span>&nbsp;<span class="ident" id="2067093">pp0</span>&nbsp;<span class="op" id="2067097">+</span>&nbsp;<span class="ident" id="2067099">z</span><span class="op" id="2067100">*</span><span class="op" id="2067101">(</span><span class="ident" id="2067102">pp1</span><span class="op" id="2067105">+</span><span class="ident" id="2067106">z</span><span class="op" id="2067107">*</span><span class="op" id="2067108">(</span><span class="ident" id="2067109">pp2</span><span class="op" id="2067112">+</span><span class="ident" id="2067113">z</span><span class="op" id="2067114">*</span><span class="op" id="2067115">(</span><span class="ident" id="2067116">pp3</span><span class="op" id="2067119">+</span><span class="ident" id="2067120">z</span><span class="op" id="2067121">*</span><span class="ident" id="2067122">pp4</span><span class="op" id="2067125">)</span><span class="op" id="2067126">)</span><span class="op" id="2067127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067132">s</span>&nbsp;<span class="op" id="2067134">:=</span>&nbsp;<span class="num" id="2067137">1</span>&nbsp;<span class="op" id="2067139">+</span>&nbsp;<span class="ident" id="2067141">z</span><span class="op" id="2067142">*</span><span class="op" id="2067143">(</span><span class="ident" id="2067144">qq1</span><span class="op" id="2067147">+</span><span class="ident" id="2067148">z</span><span class="op" id="2067149">*</span><span class="op" id="2067150">(</span><span class="ident" id="2067151">qq2</span><span class="op" id="2067154">+</span><span class="ident" id="2067155">z</span><span class="op" id="2067156">*</span><span class="op" id="2067157">(</span><span class="ident" id="2067158">qq3</span><span class="op" id="2067161">+</span><span class="ident" id="2067162">z</span><span class="op" id="2067163">*</span><span class="op" id="2067164">(</span><span class="ident" id="2067165">qq4</span><span class="op" id="2067168">+</span><span class="ident" id="2067169">z</span><span class="op" id="2067170">*</span><span class="ident" id="2067171">qq5</span><span class="op" id="2067174">)</span><span class="op" id="2067175">)</span><span class="op" id="2067176">)</span><span class="op" id="2067177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067182">y</span>&nbsp;<span class="op" id="2067184">:=</span>&nbsp;<span class="ident" id="2067187">r</span>&nbsp;<span class="op" id="2067189">/</span>&nbsp;<span class="ident" id="2067191">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067196">temp</span>&nbsp;<span class="op" id="2067201">=</span>&nbsp;<span class="ident" id="2067203">x</span>&nbsp;<span class="op" id="2067205">+</span>&nbsp;<span class="ident" id="2067207">x</span><span class="op" id="2067208">*</span><span class="ident" id="2067209">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067217">if</span>&nbsp;<span class="ident" id="2067220">sign</span>&nbsp;<span class="op" id="2067225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067230">return</span>&nbsp;<span class="op" id="2067237">-</span><span class="ident" id="2067238">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067245">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067249">return</span>&nbsp;<span class="ident" id="2067256">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067265">if</span>&nbsp;<span class="ident" id="2067268">x</span>&nbsp;<span class="op" id="2067270">&lt;</span>&nbsp;<span class="num" id="2067272">1.25</span>&nbsp;<span class="op" id="2067277">{</span>&nbsp;<span class="comment" id="2067279">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067306">s</span>&nbsp;<span class="op" id="2067308">:=</span>&nbsp;<span class="ident" id="2067311">x</span>&nbsp;<span class="op" id="2067313">-</span>&nbsp;<span class="num" id="2067315">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067319">P</span>&nbsp;<span class="op" id="2067321">:=</span>&nbsp;<span class="ident" id="2067324">pa0</span>&nbsp;<span class="op" id="2067328">+</span>&nbsp;<span class="ident" id="2067330">s</span><span class="op" id="2067331">*</span><span class="op" id="2067332">(</span><span class="ident" id="2067333">pa1</span><span class="op" id="2067336">+</span><span class="ident" id="2067337">s</span><span class="op" id="2067338">*</span><span class="op" id="2067339">(</span><span class="ident" id="2067340">pa2</span><span class="op" id="2067343">+</span><span class="ident" id="2067344">s</span><span class="op" id="2067345">*</span><span class="op" id="2067346">(</span><span class="ident" id="2067347">pa3</span><span class="op" id="2067350">+</span><span class="ident" id="2067351">s</span><span class="op" id="2067352">*</span><span class="op" id="2067353">(</span><span class="ident" id="2067354">pa4</span><span class="op" id="2067357">+</span><span class="ident" id="2067358">s</span><span class="op" id="2067359">*</span><span class="op" id="2067360">(</span><span class="ident" id="2067361">pa5</span><span class="op" id="2067364">+</span><span class="ident" id="2067365">s</span><span class="op" id="2067366">*</span><span class="ident" id="2067367">pa6</span><span class="op" id="2067370">)</span><span class="op" id="2067371">)</span><span class="op" id="2067372">)</span><span class="op" id="2067373">)</span><span class="op" id="2067374">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067378">Q</span>&nbsp;<span class="op" id="2067380">:=</span>&nbsp;<span class="num" id="2067383">1</span>&nbsp;<span class="op" id="2067385">+</span>&nbsp;<span class="ident" id="2067387">s</span><span class="op" id="2067388">*</span><span class="op" id="2067389">(</span><span class="ident" id="2067390">qa1</span><span class="op" id="2067393">+</span><span class="ident" id="2067394">s</span><span class="op" id="2067395">*</span><span class="op" id="2067396">(</span><span class="ident" id="2067397">qa2</span><span class="op" id="2067400">+</span><span class="ident" id="2067401">s</span><span class="op" id="2067402">*</span><span class="op" id="2067403">(</span><span class="ident" id="2067404">qa3</span><span class="op" id="2067407">+</span><span class="ident" id="2067408">s</span><span class="op" id="2067409">*</span><span class="op" id="2067410">(</span><span class="ident" id="2067411">qa4</span><span class="op" id="2067414">+</span><span class="ident" id="2067415">s</span><span class="op" id="2067416">*</span><span class="op" id="2067417">(</span><span class="ident" id="2067418">qa5</span><span class="op" id="2067421">+</span><span class="ident" id="2067422">s</span><span class="op" id="2067423">*</span><span class="ident" id="2067424">qa6</span><span class="op" id="2067427">)</span><span class="op" id="2067428">)</span><span class="op" id="2067429">)</span><span class="op" id="2067430">)</span><span class="op" id="2067431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067435">if</span>&nbsp;<span class="ident" id="2067438">sign</span>&nbsp;<span class="op" id="2067443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067448">return</span>&nbsp;<span class="op" id="2067455">-</span><span class="ident" id="2067456">erx</span>&nbsp;<span class="op" id="2067460">-</span>&nbsp;<span class="ident" id="2067462">P</span><span class="op" id="2067463">/</span><span class="ident" id="2067464">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067472">return</span>&nbsp;<span class="ident" id="2067479">erx</span>&nbsp;<span class="op" id="2067483">+</span>&nbsp;<span class="ident" id="2067485">P</span><span class="op" id="2067486">/</span><span class="ident" id="2067487">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067493">if</span>&nbsp;<span class="ident" id="2067496">x</span>&nbsp;<span class="op" id="2067498">&gt;=</span>&nbsp;<span class="num" id="2067501">6</span>&nbsp;<span class="op" id="2067503">{</span>&nbsp;<span class="comment" id="2067505">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067525">if</span>&nbsp;<span class="ident" id="2067528">sign</span>&nbsp;<span class="op" id="2067533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067538">return</span>&nbsp;<span class="op" id="2067545">-</span><span class="num" id="2067546">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067550">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067554">return</span>&nbsp;<span class="num" id="2067561">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067567">s</span>&nbsp;<span class="op" id="2067569">:=</span>&nbsp;<span class="num" id="2067572">1</span>&nbsp;<span class="op" id="2067574">/</span>&nbsp;<span class="op" id="2067576">(</span><span class="ident" id="2067577">x</span>&nbsp;<span class="op" id="2067579">*</span>&nbsp;<span class="ident" id="2067581">x</span><span class="op" id="2067582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067585">var</span>&nbsp;<span class="ident" id="2067589">R</span><span class="op" id="2067590">,</span>&nbsp;<span class="ident" id="2067592">S</span>&nbsp;<span class="builtintype" id="2067594">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067603">if</span>&nbsp;<span class="ident" id="2067606">x</span>&nbsp;<span class="op" id="2067608">&lt;</span>&nbsp;<span class="num" id="2067610">1</span><span class="op" id="2067611">/</span><span class="num" id="2067612">0.35</span>&nbsp;<span class="op" id="2067617">{</span>&nbsp;<span class="comment" id="2067619">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067651">R</span>&nbsp;<span class="op" id="2067653">=</span>&nbsp;<span class="ident" id="2067655">ra0</span>&nbsp;<span class="op" id="2067659">+</span>&nbsp;<span class="ident" id="2067661">s</span><span class="op" id="2067662">*</span><span class="op" id="2067663">(</span><span class="ident" id="2067664">ra1</span><span class="op" id="2067667">+</span><span class="ident" id="2067668">s</span><span class="op" id="2067669">*</span><span class="op" id="2067670">(</span><span class="ident" id="2067671">ra2</span><span class="op" id="2067674">+</span><span class="ident" id="2067675">s</span><span class="op" id="2067676">*</span><span class="op" id="2067677">(</span><span class="ident" id="2067678">ra3</span><span class="op" id="2067681">+</span><span class="ident" id="2067682">s</span><span class="op" id="2067683">*</span><span class="op" id="2067684">(</span><span class="ident" id="2067685">ra4</span><span class="op" id="2067688">+</span><span class="ident" id="2067689">s</span><span class="op" id="2067690">*</span><span class="op" id="2067691">(</span><span class="ident" id="2067692">ra5</span><span class="op" id="2067695">+</span><span class="ident" id="2067696">s</span><span class="op" id="2067697">*</span><span class="op" id="2067698">(</span><span class="ident" id="2067699">ra6</span><span class="op" id="2067702">+</span><span class="ident" id="2067703">s</span><span class="op" id="2067704">*</span><span class="ident" id="2067705">ra7</span><span class="op" id="2067708">)</span><span class="op" id="2067709">)</span><span class="op" id="2067710">)</span><span class="op" id="2067711">)</span><span class="op" id="2067712">)</span><span class="op" id="2067713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067717">S</span>&nbsp;<span class="op" id="2067719">=</span>&nbsp;<span class="num" id="2067721">1</span>&nbsp;<span class="op" id="2067723">+</span>&nbsp;<span class="ident" id="2067725">s</span><span class="op" id="2067726">*</span><span class="op" id="2067727">(</span><span class="ident" id="2067728">sa1</span><span class="op" id="2067731">+</span><span class="ident" id="2067732">s</span><span class="op" id="2067733">*</span><span class="op" id="2067734">(</span><span class="ident" id="2067735">sa2</span><span class="op" id="2067738">+</span><span class="ident" id="2067739">s</span><span class="op" id="2067740">*</span><span class="op" id="2067741">(</span><span class="ident" id="2067742">sa3</span><span class="op" id="2067745">+</span><span class="ident" id="2067746">s</span><span class="op" id="2067747">*</span><span class="op" id="2067748">(</span><span class="ident" id="2067749">sa4</span><span class="op" id="2067752">+</span><span class="ident" id="2067753">s</span><span class="op" id="2067754">*</span><span class="op" id="2067755">(</span><span class="ident" id="2067756">sa5</span><span class="op" id="2067759">+</span><span class="ident" id="2067760">s</span><span class="op" id="2067761">*</span><span class="op" id="2067762">(</span><span class="ident" id="2067763">sa6</span><span class="op" id="2067766">+</span><span class="ident" id="2067767">s</span><span class="op" id="2067768">*</span><span class="op" id="2067769">(</span><span class="ident" id="2067770">sa7</span><span class="op" id="2067773">+</span><span class="ident" id="2067774">s</span><span class="op" id="2067775">*</span><span class="ident" id="2067776">sa8</span><span class="op" id="2067779">)</span><span class="op" id="2067780">)</span><span class="op" id="2067781">)</span><span class="op" id="2067782">)</span><span class="op" id="2067783">)</span><span class="op" id="2067784">)</span><span class="op" id="2067785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067788">}</span>&nbsp;<span class="keyword" id="2067790">else</span>&nbsp;<span class="op" id="2067795">{</span>&nbsp;<span class="comment" id="2067797">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067830">R</span>&nbsp;<span class="op" id="2067832">=</span>&nbsp;<span class="ident" id="2067834">rb0</span>&nbsp;<span class="op" id="2067838">+</span>&nbsp;<span class="ident" id="2067840">s</span><span class="op" id="2067841">*</span><span class="op" id="2067842">(</span><span class="ident" id="2067843">rb1</span><span class="op" id="2067846">+</span><span class="ident" id="2067847">s</span><span class="op" id="2067848">*</span><span class="op" id="2067849">(</span><span class="ident" id="2067850">rb2</span><span class="op" id="2067853">+</span><span class="ident" id="2067854">s</span><span class="op" id="2067855">*</span><span class="op" id="2067856">(</span><span class="ident" id="2067857">rb3</span><span class="op" id="2067860">+</span><span class="ident" id="2067861">s</span><span class="op" id="2067862">*</span><span class="op" id="2067863">(</span><span class="ident" id="2067864">rb4</span><span class="op" id="2067867">+</span><span class="ident" id="2067868">s</span><span class="op" id="2067869">*</span><span class="op" id="2067870">(</span><span class="ident" id="2067871">rb5</span><span class="op" id="2067874">+</span><span class="ident" id="2067875">s</span><span class="op" id="2067876">*</span><span class="ident" id="2067877">rb6</span><span class="op" id="2067880">)</span><span class="op" id="2067881">)</span><span class="op" id="2067882">)</span><span class="op" id="2067883">)</span><span class="op" id="2067884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067888">S</span>&nbsp;<span class="op" id="2067890">=</span>&nbsp;<span class="num" id="2067892">1</span>&nbsp;<span class="op" id="2067894">+</span>&nbsp;<span class="ident" id="2067896">s</span><span class="op" id="2067897">*</span><span class="op" id="2067898">(</span><span class="ident" id="2067899">sb1</span><span class="op" id="2067902">+</span><span class="ident" id="2067903">s</span><span class="op" id="2067904">*</span><span class="op" id="2067905">(</span><span class="ident" id="2067906">sb2</span><span class="op" id="2067909">+</span><span class="ident" id="2067910">s</span><span class="op" id="2067911">*</span><span class="op" id="2067912">(</span><span class="ident" id="2067913">sb3</span><span class="op" id="2067916">+</span><span class="ident" id="2067917">s</span><span class="op" id="2067918">*</span><span class="op" id="2067919">(</span><span class="ident" id="2067920">sb4</span><span class="op" id="2067923">+</span><span class="ident" id="2067924">s</span><span class="op" id="2067925">*</span><span class="op" id="2067926">(</span><span class="ident" id="2067927">sb5</span><span class="op" id="2067930">+</span><span class="ident" id="2067931">s</span><span class="op" id="2067932">*</span><span class="op" id="2067933">(</span><span class="ident" id="2067934">sb6</span><span class="op" id="2067937">+</span><span class="ident" id="2067938">s</span><span class="op" id="2067939">*</span><span class="ident" id="2067940">sb7</span><span class="op" id="2067943">)</span><span class="op" id="2067944">)</span><span class="op" id="2067945">)</span><span class="op" id="2067946">)</span><span class="op" id="2067947">)</span><span class="op" id="2067948">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067954">z</span>&nbsp;<span class="op" id="2067956">:=</span>&nbsp;<span class="ident" id="2067959">Float64frombits</span><span class="op" id="2067974">(</span><span class="ident" id="2067975">Float64bits</span><span class="op" id="2067986">(</span><span class="ident" id="2067987">x</span><span class="op" id="2067988">)</span>&nbsp;<span class="op" id="2067990">&amp;</span>&nbsp;<span class="num" id="2067992">0xffffffff00000000</span><span class="op" id="2068010">)</span>&nbsp;<span class="comment" id="2068012">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068051">r</span>&nbsp;<span class="op" id="2068053">:=</span>&nbsp;<span class="ident" id="2068056">Exp</span><span class="op" id="2068059">(</span><span class="op" id="2068060">-</span><span class="ident" id="2068061">z</span><span class="op" id="2068062">*</span><span class="ident" id="2068063">z</span><span class="op" id="2068064">-</span><span class="num" id="2068065">0.5625</span><span class="op" id="2068071">)</span>&nbsp;<span class="op" id="2068073">*</span>&nbsp;<span class="ident" id="2068075">Exp</span><span class="op" id="2068078">(</span><span class="op" id="2068079">(</span><span class="ident" id="2068080">z</span><span class="op" id="2068081">-</span><span class="ident" id="2068082">x</span><span class="op" id="2068083">)</span><span class="op" id="2068084">*</span><span class="op" id="2068085">(</span><span class="ident" id="2068086">z</span><span class="op" id="2068087">+</span><span class="ident" id="2068088">x</span><span class="op" id="2068089">)</span><span class="op" id="2068090">+</span><span class="ident" id="2068091">R</span><span class="op" id="2068092">/</span><span class="ident" id="2068093">S</span><span class="op" id="2068094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068097">if</span>&nbsp;<span class="ident" id="2068100">sign</span>&nbsp;<span class="op" id="2068105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068109">return</span>&nbsp;<span class="ident" id="2068116">r</span><span class="op" id="2068117">/</span><span class="ident" id="2068118">x</span>&nbsp;<span class="op" id="2068120">-</span>&nbsp;<span class="num" id="2068122">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068128">return</span>&nbsp;<span class="num" id="2068135">1</span>&nbsp;<span class="op" id="2068137">-</span>&nbsp;<span class="ident" id="2068139">r</span><span class="op" id="2068140">/</span><span class="ident" id="2068141">x</span><br>
<span class="lineno"></span><span class="op" id="2068143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2068146">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2068201">//</span><br>
<span class="lineno"></span><span class="comment" id="2068204">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2068226">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2068244">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2068262">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2068281">func</span>&nbsp;<span class="ident" id="2068286">Erfc</span><span class="op" id="2068290">(</span><span class="ident" id="2068291">x</span>&nbsp;<span class="builtintype" id="2068293">float64</span><span class="op" id="2068300">)</span>&nbsp;<span class="builtintype" id="2068302">float64</span>&nbsp;<span class="op" id="2068310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068313">const</span>&nbsp;<span class="ident" id="2068319">Tiny</span>&nbsp;<span class="op" id="2068324">=</span>&nbsp;<span class="num" id="2068326">1.0</span>&nbsp;<span class="op" id="2068330">/</span>&nbsp;<span class="op" id="2068332">(</span><span class="num" id="2068333">1</span>&nbsp;<span class="op" id="2068335">&lt;&lt;</span>&nbsp;<span class="num" id="2068338">56</span><span class="op" id="2068340">)</span>&nbsp;<span class="comment" id="2068342">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2068353">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068371">switch</span>&nbsp;<span class="op" id="2068378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068381">case</span>&nbsp;<span class="ident" id="2068386">IsNaN</span><span class="op" id="2068391">(</span><span class="ident" id="2068392">x</span><span class="op" id="2068393">)</span><span class="op" id="2068394">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068398">return</span>&nbsp;<span class="ident" id="2068405">NaN</span><span class="op" id="2068408">(</span><span class="op" id="2068409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068412">case</span>&nbsp;<span class="ident" id="2068417">IsInf</span><span class="op" id="2068422">(</span><span class="ident" id="2068423">x</span><span class="op" id="2068424">,</span>&nbsp;<span class="num" id="2068426">1</span><span class="op" id="2068427">)</span><span class="op" id="2068428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068432">return</span>&nbsp;<span class="num" id="2068439">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068442">case</span>&nbsp;<span class="ident" id="2068447">IsInf</span><span class="op" id="2068452">(</span><span class="ident" id="2068453">x</span><span class="op" id="2068454">,</span>&nbsp;<span class="op" id="2068456">-</span><span class="num" id="2068457">1</span><span class="op" id="2068458">)</span><span class="op" id="2068459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068463">return</span>&nbsp;<span class="num" id="2068470">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068476">sign</span>&nbsp;<span class="op" id="2068481">:=</span>&nbsp;<span class="builtintype" id="2068484">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068491">if</span>&nbsp;<span class="ident" id="2068494">x</span>&nbsp;<span class="op" id="2068496">&lt;</span>&nbsp;<span class="num" id="2068498">0</span>&nbsp;<span class="op" id="2068500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068504">x</span>&nbsp;<span class="op" id="2068506">=</span>&nbsp;<span class="op" id="2068508">-</span><span class="ident" id="2068509">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068513">sign</span>&nbsp;<span class="op" id="2068518">=</span>&nbsp;<span class="builtintype" id="2068520">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068529">if</span>&nbsp;<span class="ident" id="2068532">x</span>&nbsp;<span class="op" id="2068534">&lt;</span>&nbsp;<span class="num" id="2068536">0.84375</span>&nbsp;<span class="op" id="2068544">{</span>&nbsp;<span class="comment" id="2068546">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068565">var</span>&nbsp;<span class="ident" id="2068569">temp</span>&nbsp;<span class="builtintype" id="2068574">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068584">if</span>&nbsp;<span class="ident" id="2068587">x</span>&nbsp;<span class="op" id="2068589">&lt;</span>&nbsp;<span class="ident" id="2068591">Tiny</span>&nbsp;<span class="op" id="2068596">{</span>&nbsp;<span class="comment" id="2068598">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068617">temp</span>&nbsp;<span class="op" id="2068622">=</span>&nbsp;<span class="ident" id="2068624">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068628">}</span>&nbsp;<span class="keyword" id="2068630">else</span>&nbsp;<span class="op" id="2068635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068640">z</span>&nbsp;<span class="op" id="2068642">:=</span>&nbsp;<span class="ident" id="2068645">x</span>&nbsp;<span class="op" id="2068647">*</span>&nbsp;<span class="ident" id="2068649">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068654">r</span>&nbsp;<span class="op" id="2068656">:=</span>&nbsp;<span class="ident" id="2068659">pp0</span>&nbsp;<span class="op" id="2068663">+</span>&nbsp;<span class="ident" id="2068665">z</span><span class="op" id="2068666">*</span><span class="op" id="2068667">(</span><span class="ident" id="2068668">pp1</span><span class="op" id="2068671">+</span><span class="ident" id="2068672">z</span><span class="op" id="2068673">*</span><span class="op" id="2068674">(</span><span class="ident" id="2068675">pp2</span><span class="op" id="2068678">+</span><span class="ident" id="2068679">z</span><span class="op" id="2068680">*</span><span class="op" id="2068681">(</span><span class="ident" id="2068682">pp3</span><span class="op" id="2068685">+</span><span class="ident" id="2068686">z</span><span class="op" id="2068687">*</span><span class="ident" id="2068688">pp4</span><span class="op" id="2068691">)</span><span class="op" id="2068692">)</span><span class="op" id="2068693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068698">s</span>&nbsp;<span class="op" id="2068700">:=</span>&nbsp;<span class="num" id="2068703">1</span>&nbsp;<span class="op" id="2068705">+</span>&nbsp;<span class="ident" id="2068707">z</span><span class="op" id="2068708">*</span><span class="op" id="2068709">(</span><span class="ident" id="2068710">qq1</span><span class="op" id="2068713">+</span><span class="ident" id="2068714">z</span><span class="op" id="2068715">*</span><span class="op" id="2068716">(</span><span class="ident" id="2068717">qq2</span><span class="op" id="2068720">+</span><span class="ident" id="2068721">z</span><span class="op" id="2068722">*</span><span class="op" id="2068723">(</span><span class="ident" id="2068724">qq3</span><span class="op" id="2068727">+</span><span class="ident" id="2068728">z</span><span class="op" id="2068729">*</span><span class="op" id="2068730">(</span><span class="ident" id="2068731">qq4</span><span class="op" id="2068734">+</span><span class="ident" id="2068735">z</span><span class="op" id="2068736">*</span><span class="ident" id="2068737">qq5</span><span class="op" id="2068740">)</span><span class="op" id="2068741">)</span><span class="op" id="2068742">)</span><span class="op" id="2068743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068748">y</span>&nbsp;<span class="op" id="2068750">:=</span>&nbsp;<span class="ident" id="2068753">r</span>&nbsp;<span class="op" id="2068755">/</span>&nbsp;<span class="ident" id="2068757">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068762">if</span>&nbsp;<span class="ident" id="2068765">x</span>&nbsp;<span class="op" id="2068767">&lt;</span>&nbsp;<span class="num" id="2068769">0.25</span>&nbsp;<span class="op" id="2068774">{</span>&nbsp;<span class="comment" id="2068776">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068793">temp</span>&nbsp;<span class="op" id="2068798">=</span>&nbsp;<span class="ident" id="2068800">x</span>&nbsp;<span class="op" id="2068802">+</span>&nbsp;<span class="ident" id="2068804">x</span><span class="op" id="2068805">*</span><span class="ident" id="2068806">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068811">}</span>&nbsp;<span class="keyword" id="2068813">else</span>&nbsp;<span class="op" id="2068818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068824">temp</span>&nbsp;<span class="op" id="2068829">=</span>&nbsp;<span class="num" id="2068831">0.5</span>&nbsp;<span class="op" id="2068835">+</span>&nbsp;<span class="op" id="2068837">(</span><span class="ident" id="2068838">x</span><span class="op" id="2068839">*</span><span class="ident" id="2068840">y</span>&nbsp;<span class="op" id="2068842">+</span>&nbsp;<span class="op" id="2068844">(</span><span class="ident" id="2068845">x</span>&nbsp;<span class="op" id="2068847">-</span>&nbsp;<span class="num" id="2068849">0.5</span><span class="op" id="2068852">)</span><span class="op" id="2068853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068858">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068866">if</span>&nbsp;<span class="ident" id="2068869">sign</span>&nbsp;<span class="op" id="2068874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068879">return</span>&nbsp;<span class="num" id="2068886">1</span>&nbsp;<span class="op" id="2068888">+</span>&nbsp;<span class="ident" id="2068890">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068901">return</span>&nbsp;<span class="num" id="2068908">1</span>&nbsp;<span class="op" id="2068910">-</span>&nbsp;<span class="ident" id="2068912">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068921">if</span>&nbsp;<span class="ident" id="2068924">x</span>&nbsp;<span class="op" id="2068926">&lt;</span>&nbsp;<span class="num" id="2068928">1.25</span>&nbsp;<span class="op" id="2068933">{</span>&nbsp;<span class="comment" id="2068935">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068962">s</span>&nbsp;<span class="op" id="2068964">:=</span>&nbsp;<span class="ident" id="2068967">x</span>&nbsp;<span class="op" id="2068969">-</span>&nbsp;<span class="num" id="2068971">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068975">P</span>&nbsp;<span class="op" id="2068977">:=</span>&nbsp;<span class="ident" id="2068980">pa0</span>&nbsp;<span class="op" id="2068984">+</span>&nbsp;<span class="ident" id="2068986">s</span><span class="op" id="2068987">*</span><span class="op" id="2068988">(</span><span class="ident" id="2068989">pa1</span><span class="op" id="2068992">+</span><span class="ident" id="2068993">s</span><span class="op" id="2068994">*</span><span class="op" id="2068995">(</span><span class="ident" id="2068996">pa2</span><span class="op" id="2068999">+</span><span class="ident" id="2069000">s</span><span class="op" id="2069001">*</span><span class="op" id="2069002">(</span><span class="ident" id="2069003">pa3</span><span class="op" id="2069006">+</span><span class="ident" id="2069007">s</span><span class="op" id="2069008">*</span><span class="op" id="2069009">(</span><span class="ident" id="2069010">pa4</span><span class="op" id="2069013">+</span><span class="ident" id="2069014">s</span><span class="op" id="2069015">*</span><span class="op" id="2069016">(</span><span class="ident" id="2069017">pa5</span><span class="op" id="2069020">+</span><span class="ident" id="2069021">s</span><span class="op" id="2069022">*</span><span class="ident" id="2069023">pa6</span><span class="op" id="2069026">)</span><span class="op" id="2069027">)</span><span class="op" id="2069028">)</span><span class="op" id="2069029">)</span><span class="op" id="2069030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069034">Q</span>&nbsp;<span class="op" id="2069036">:=</span>&nbsp;<span class="num" id="2069039">1</span>&nbsp;<span class="op" id="2069041">+</span>&nbsp;<span class="ident" id="2069043">s</span><span class="op" id="2069044">*</span><span class="op" id="2069045">(</span><span class="ident" id="2069046">qa1</span><span class="op" id="2069049">+</span><span class="ident" id="2069050">s</span><span class="op" id="2069051">*</span><span class="op" id="2069052">(</span><span class="ident" id="2069053">qa2</span><span class="op" id="2069056">+</span><span class="ident" id="2069057">s</span><span class="op" id="2069058">*</span><span class="op" id="2069059">(</span><span class="ident" id="2069060">qa3</span><span class="op" id="2069063">+</span><span class="ident" id="2069064">s</span><span class="op" id="2069065">*</span><span class="op" id="2069066">(</span><span class="ident" id="2069067">qa4</span><span class="op" id="2069070">+</span><span class="ident" id="2069071">s</span><span class="op" id="2069072">*</span><span class="op" id="2069073">(</span><span class="ident" id="2069074">qa5</span><span class="op" id="2069077">+</span><span class="ident" id="2069078">s</span><span class="op" id="2069079">*</span><span class="ident" id="2069080">qa6</span><span class="op" id="2069083">)</span><span class="op" id="2069084">)</span><span class="op" id="2069085">)</span><span class="op" id="2069086">)</span><span class="op" id="2069087">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069091">if</span>&nbsp;<span class="ident" id="2069094">sign</span>&nbsp;<span class="op" id="2069099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069104">return</span>&nbsp;<span class="num" id="2069111">1</span>&nbsp;<span class="op" id="2069113">+</span>&nbsp;<span class="ident" id="2069115">erx</span>&nbsp;<span class="op" id="2069119">+</span>&nbsp;<span class="ident" id="2069121">P</span><span class="op" id="2069122">/</span><span class="ident" id="2069123">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069131">return</span>&nbsp;<span class="num" id="2069138">1</span>&nbsp;<span class="op" id="2069140">-</span>&nbsp;<span class="ident" id="2069142">erx</span>&nbsp;<span class="op" id="2069146">-</span>&nbsp;<span class="ident" id="2069148">P</span><span class="op" id="2069149">/</span><span class="ident" id="2069150">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069157">if</span>&nbsp;<span class="ident" id="2069160">x</span>&nbsp;<span class="op" id="2069162">&lt;</span>&nbsp;<span class="num" id="2069164">28</span>&nbsp;<span class="op" id="2069167">{</span>&nbsp;<span class="comment" id="2069169">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069183">s</span>&nbsp;<span class="op" id="2069185">:=</span>&nbsp;<span class="num" id="2069188">1</span>&nbsp;<span class="op" id="2069190">/</span>&nbsp;<span class="op" id="2069192">(</span><span class="ident" id="2069193">x</span>&nbsp;<span class="op" id="2069195">*</span>&nbsp;<span class="ident" id="2069197">x</span><span class="op" id="2069198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069202">var</span>&nbsp;<span class="ident" id="2069206">R</span><span class="op" id="2069207">,</span>&nbsp;<span class="ident" id="2069209">S</span>&nbsp;<span class="builtintype" id="2069211">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069221">if</span>&nbsp;<span class="ident" id="2069224">x</span>&nbsp;<span class="op" id="2069226">&lt;</span>&nbsp;<span class="num" id="2069228">1</span><span class="op" id="2069229">/</span><span class="num" id="2069230">0.35</span>&nbsp;<span class="op" id="2069235">{</span>&nbsp;<span class="comment" id="2069237">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069269">R</span>&nbsp;<span class="op" id="2069271">=</span>&nbsp;<span class="ident" id="2069273">ra0</span>&nbsp;<span class="op" id="2069277">+</span>&nbsp;<span class="ident" id="2069279">s</span><span class="op" id="2069280">*</span><span class="op" id="2069281">(</span><span class="ident" id="2069282">ra1</span><span class="op" id="2069285">+</span><span class="ident" id="2069286">s</span><span class="op" id="2069287">*</span><span class="op" id="2069288">(</span><span class="ident" id="2069289">ra2</span><span class="op" id="2069292">+</span><span class="ident" id="2069293">s</span><span class="op" id="2069294">*</span><span class="op" id="2069295">(</span><span class="ident" id="2069296">ra3</span><span class="op" id="2069299">+</span><span class="ident" id="2069300">s</span><span class="op" id="2069301">*</span><span class="op" id="2069302">(</span><span class="ident" id="2069303">ra4</span><span class="op" id="2069306">+</span><span class="ident" id="2069307">s</span><span class="op" id="2069308">*</span><span class="op" id="2069309">(</span><span class="ident" id="2069310">ra5</span><span class="op" id="2069313">+</span><span class="ident" id="2069314">s</span><span class="op" id="2069315">*</span><span class="op" id="2069316">(</span><span class="ident" id="2069317">ra6</span><span class="op" id="2069320">+</span><span class="ident" id="2069321">s</span><span class="op" id="2069322">*</span><span class="ident" id="2069323">ra7</span><span class="op" id="2069326">)</span><span class="op" id="2069327">)</span><span class="op" id="2069328">)</span><span class="op" id="2069329">)</span><span class="op" id="2069330">)</span><span class="op" id="2069331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069336">S</span>&nbsp;<span class="op" id="2069338">=</span>&nbsp;<span class="num" id="2069340">1</span>&nbsp;<span class="op" id="2069342">+</span>&nbsp;<span class="ident" id="2069344">s</span><span class="op" id="2069345">*</span><span class="op" id="2069346">(</span><span class="ident" id="2069347">sa1</span><span class="op" id="2069350">+</span><span class="ident" id="2069351">s</span><span class="op" id="2069352">*</span><span class="op" id="2069353">(</span><span class="ident" id="2069354">sa2</span><span class="op" id="2069357">+</span><span class="ident" id="2069358">s</span><span class="op" id="2069359">*</span><span class="op" id="2069360">(</span><span class="ident" id="2069361">sa3</span><span class="op" id="2069364">+</span><span class="ident" id="2069365">s</span><span class="op" id="2069366">*</span><span class="op" id="2069367">(</span><span class="ident" id="2069368">sa4</span><span class="op" id="2069371">+</span><span class="ident" id="2069372">s</span><span class="op" id="2069373">*</span><span class="op" id="2069374">(</span><span class="ident" id="2069375">sa5</span><span class="op" id="2069378">+</span><span class="ident" id="2069379">s</span><span class="op" id="2069380">*</span><span class="op" id="2069381">(</span><span class="ident" id="2069382">sa6</span><span class="op" id="2069385">+</span><span class="ident" id="2069386">s</span><span class="op" id="2069387">*</span><span class="op" id="2069388">(</span><span class="ident" id="2069389">sa7</span><span class="op" id="2069392">+</span><span class="ident" id="2069393">s</span><span class="op" id="2069394">*</span><span class="ident" id="2069395">sa8</span><span class="op" id="2069398">)</span><span class="op" id="2069399">)</span><span class="op" id="2069400">)</span><span class="op" id="2069401">)</span><span class="op" id="2069402">)</span><span class="op" id="2069403">)</span><span class="op" id="2069404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069408">}</span>&nbsp;<span class="keyword" id="2069410">else</span>&nbsp;<span class="op" id="2069415">{</span>&nbsp;<span class="comment" id="2069417">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069450">if</span>&nbsp;<span class="ident" id="2069453">sign</span>&nbsp;<span class="op" id="2069458">&amp;&amp;</span>&nbsp;<span class="ident" id="2069461">x</span>&nbsp;<span class="op" id="2069463">&gt;</span>&nbsp;<span class="num" id="2069465">6</span>&nbsp;<span class="op" id="2069467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069473">return</span>&nbsp;<span class="num" id="2069480">2</span>&nbsp;<span class="comment" id="2069482">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069500">R</span>&nbsp;<span class="op" id="2069502">=</span>&nbsp;<span class="ident" id="2069504">rb0</span>&nbsp;<span class="op" id="2069508">+</span>&nbsp;<span class="ident" id="2069510">s</span><span class="op" id="2069511">*</span><span class="op" id="2069512">(</span><span class="ident" id="2069513">rb1</span><span class="op" id="2069516">+</span><span class="ident" id="2069517">s</span><span class="op" id="2069518">*</span><span class="op" id="2069519">(</span><span class="ident" id="2069520">rb2</span><span class="op" id="2069523">+</span><span class="ident" id="2069524">s</span><span class="op" id="2069525">*</span><span class="op" id="2069526">(</span><span class="ident" id="2069527">rb3</span><span class="op" id="2069530">+</span><span class="ident" id="2069531">s</span><span class="op" id="2069532">*</span><span class="op" id="2069533">(</span><span class="ident" id="2069534">rb4</span><span class="op" id="2069537">+</span><span class="ident" id="2069538">s</span><span class="op" id="2069539">*</span><span class="op" id="2069540">(</span><span class="ident" id="2069541">rb5</span><span class="op" id="2069544">+</span><span class="ident" id="2069545">s</span><span class="op" id="2069546">*</span><span class="ident" id="2069547">rb6</span><span class="op" id="2069550">)</span><span class="op" id="2069551">)</span><span class="op" id="2069552">)</span><span class="op" id="2069553">)</span><span class="op" id="2069554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069559">S</span>&nbsp;<span class="op" id="2069561">=</span>&nbsp;<span class="num" id="2069563">1</span>&nbsp;<span class="op" id="2069565">+</span>&nbsp;<span class="ident" id="2069567">s</span><span class="op" id="2069568">*</span><span class="op" id="2069569">(</span><span class="ident" id="2069570">sb1</span><span class="op" id="2069573">+</span><span class="ident" id="2069574">s</span><span class="op" id="2069575">*</span><span class="op" id="2069576">(</span><span class="ident" id="2069577">sb2</span><span class="op" id="2069580">+</span><span class="ident" id="2069581">s</span><span class="op" id="2069582">*</span><span class="op" id="2069583">(</span><span class="ident" id="2069584">sb3</span><span class="op" id="2069587">+</span><span class="ident" id="2069588">s</span><span class="op" id="2069589">*</span><span class="op" id="2069590">(</span><span class="ident" id="2069591">sb4</span><span class="op" id="2069594">+</span><span class="ident" id="2069595">s</span><span class="op" id="2069596">*</span><span class="op" id="2069597">(</span><span class="ident" id="2069598">sb5</span><span class="op" id="2069601">+</span><span class="ident" id="2069602">s</span><span class="op" id="2069603">*</span><span class="op" id="2069604">(</span><span class="ident" id="2069605">sb6</span><span class="op" id="2069608">+</span><span class="ident" id="2069609">s</span><span class="op" id="2069610">*</span><span class="ident" id="2069611">sb7</span><span class="op" id="2069614">)</span><span class="op" id="2069615">)</span><span class="op" id="2069616">)</span><span class="op" id="2069617">)</span><span class="op" id="2069618">)</span><span class="op" id="2069619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069627">z</span>&nbsp;<span class="op" id="2069629">:=</span>&nbsp;<span class="ident" id="2069632">Float64frombits</span><span class="op" id="2069647">(</span><span class="ident" id="2069648">Float64bits</span><span class="op" id="2069659">(</span><span class="ident" id="2069660">x</span><span class="op" id="2069661">)</span>&nbsp;<span class="op" id="2069663">&amp;</span>&nbsp;<span class="num" id="2069665">0xffffffff00000000</span><span class="op" id="2069683">)</span>&nbsp;<span class="comment" id="2069685">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069725">r</span>&nbsp;<span class="op" id="2069727">:=</span>&nbsp;<span class="ident" id="2069730">Exp</span><span class="op" id="2069733">(</span><span class="op" id="2069734">-</span><span class="ident" id="2069735">z</span><span class="op" id="2069736">*</span><span class="ident" id="2069737">z</span><span class="op" id="2069738">-</span><span class="num" id="2069739">0.5625</span><span class="op" id="2069745">)</span>&nbsp;<span class="op" id="2069747">*</span>&nbsp;<span class="ident" id="2069749">Exp</span><span class="op" id="2069752">(</span><span class="op" id="2069753">(</span><span class="ident" id="2069754">z</span><span class="op" id="2069755">-</span><span class="ident" id="2069756">x</span><span class="op" id="2069757">)</span><span class="op" id="2069758">*</span><span class="op" id="2069759">(</span><span class="ident" id="2069760">z</span><span class="op" id="2069761">+</span><span class="ident" id="2069762">x</span><span class="op" id="2069763">)</span><span class="op" id="2069764">+</span><span class="ident" id="2069765">R</span><span class="op" id="2069766">/</span><span class="ident" id="2069767">S</span><span class="op" id="2069768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069772">if</span>&nbsp;<span class="ident" id="2069775">sign</span>&nbsp;<span class="op" id="2069780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069785">return</span>&nbsp;<span class="num" id="2069792">2</span>&nbsp;<span class="op" id="2069794">-</span>&nbsp;<span class="ident" id="2069796">r</span><span class="op" id="2069797">/</span><span class="ident" id="2069798">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069806">return</span>&nbsp;<span class="ident" id="2069813">r</span>&nbsp;<span class="op" id="2069815">/</span>&nbsp;<span class="ident" id="2069817">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069823">if</span>&nbsp;<span class="ident" id="2069826">sign</span>&nbsp;<span class="op" id="2069831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069835">return</span>&nbsp;<span class="num" id="2069842">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069848">return</span>&nbsp;<span class="num" id="2069855">0</span><br>
<span class="lineno">335</span><span class="op" id="2069857">}</span>
</div>
</body>
</html>
