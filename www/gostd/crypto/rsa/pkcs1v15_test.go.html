<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html" class="current">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8011015">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8011070">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8011124">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8011175">package</span>&nbsp;<span class="ident" id="8011183">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8011188">import</span>&nbsp;<span class="op" id="8011195">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011198">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011207">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011217">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011232">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011247">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011266">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011282">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011288">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011300">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011311">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8011327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8011330">func</span>&nbsp;<span class="ident" id="8011335">decodeBase64</span><span class="op" id="8011347">(</span><span class="ident" id="8011348">in</span>&nbsp;<span class="builtintype" id="8011351">string</span><span class="op" id="8011357">)</span>&nbsp;<span class="op" id="8011359">[</span><span class="op" id="8011360">]</span><span class="builtintype" id="8011361">byte</span>&nbsp;<span class="op" id="8011366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8011369">out</span>&nbsp;<span class="op" id="8011373">:=</span>&nbsp;<span class="builtinfunc" id="8011376">make</span><span class="op" id="8011380">(</span><span class="op" id="8011381">[</span><span class="op" id="8011382">]</span><span class="builtintype" id="8011383">byte</span><span class="op" id="8011387">,</span>&nbsp;<span class="ident" id="8011389">base64</span><span class="op" id="8011395">.</span><span class="ident" id="8011396">StdEncoding</span><span class="op" id="8011407">.</span><span class="ident" id="8011408">DecodedLen</span><span class="op" id="8011418">(</span><span class="builtinfunc" id="8011419">len</span><span class="op" id="8011422">(</span><span class="ident" id="8011423">in</span><span class="op" id="8011425">)</span><span class="op" id="8011426">)</span><span class="op" id="8011427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8011430">n</span><span class="op" id="8011431">,</span>&nbsp;<span class="ident" id="8011433">err</span>&nbsp;<span class="op" id="8011437">:=</span>&nbsp;<span class="ident" id="8011440">base64</span><span class="op" id="8011446">.</span><span class="ident" id="8011447">StdEncoding</span><span class="op" id="8011458">.</span><span class="ident" id="8011459">Decode</span><span class="op" id="8011465">(</span><span class="ident" id="8011466">out</span><span class="op" id="8011469">,</span>&nbsp;<span class="op" id="8011471">[</span><span class="op" id="8011472">]</span><span class="builtintype" id="8011473">byte</span><span class="op" id="8011477">(</span><span class="ident" id="8011478">in</span><span class="op" id="8011480">)</span><span class="op" id="8011481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8011484">if</span>&nbsp;<span class="ident" id="8011487">err</span>&nbsp;<span class="op" id="8011491">!=</span>&nbsp;<span class="ident" id="8011494">nil</span>&nbsp;<span class="op" id="8011498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8011502">return</span>&nbsp;<span class="ident" id="8011509">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8011514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8011517">return</span>&nbsp;<span class="ident" id="8011524">out</span><span class="op" id="8011527">[</span><span class="num" id="8011528">0</span><span class="op" id="8011529">:</span><span class="ident" id="8011530">n</span><span class="op" id="8011531">]</span><br>
<span class="lineno"></span><span class="op" id="8011533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8011536">type</span>&nbsp;<span class="ident" id="8011541">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="8011561">struct</span>&nbsp;<span class="op" id="8011568">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8011571">in</span><span class="op" id="8011573">,</span>&nbsp;<span class="ident" id="8011575">out</span>&nbsp;<span class="builtintype" id="8011579">string</span><br>
<span class="lineno"></span><span class="op" id="8011586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8011589">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8011663">var</span>&nbsp;<span class="ident" id="8011667">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8011688">=</span>&nbsp;<span class="op" id="8011690">[</span><span class="op" id="8011691">]</span><span class="ident" id="8011692">DecryptPKCS1v15Test</span><span class="op" id="8011711">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8011714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011718">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="8011808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011812">&#34;x&#34;</span><span class="op" id="8011815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8011818">}</span><span class="op" id="8011819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8011822">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011826">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="8011916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011920">&#34;testing.&#34;</span><span class="op" id="8011930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8011933">}</span><span class="op" id="8011934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8011937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8011941">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="8012031">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8012035">&#34;testing.\n&#34;</span><span class="op" id="8012047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012050">}</span><span class="op" id="8012051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8012058">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="8012148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8012152">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="8012207">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012210">}</span><span class="op" id="8012211">,</span><br>
<span class="lineno"></span><span class="op" id="8012213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8012216">func</span>&nbsp;<span class="ident" id="8012221">TestDecryptPKCS1v15</span><span class="op" id="8012240">(</span><span class="ident" id="8012241">t</span>&nbsp;<span class="op" id="8012243">*</span><span class="ident" id="8012244">testing</span><span class="op" id="8012251">.</span><span class="ident" id="8012252">T</span><span class="op" id="8012253">)</span>&nbsp;<span class="op" id="8012255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8012258">for</span>&nbsp;<span class="ident" id="8012262">i</span><span class="op" id="8012263">,</span>&nbsp;<span class="ident" id="8012265">test</span>&nbsp;<span class="op" id="8012270">:=</span>&nbsp;<span class="keyword" id="8012273">range</span>&nbsp;<span class="ident" id="8012279">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8012300">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012304">out</span><span class="op" id="8012307">,</span>&nbsp;<span class="ident" id="8012309">err</span>&nbsp;<span class="op" id="8012313">:=</span>&nbsp;<span class="ident" id="8012316">DecryptPKCS1v15</span><span class="op" id="8012331">(</span><span class="ident" id="8012332">nil</span><span class="op" id="8012335">,</span>&nbsp;<span class="ident" id="8012337">rsaPrivateKey</span><span class="op" id="8012350">,</span>&nbsp;<span class="ident" id="8012352">decodeBase64</span><span class="op" id="8012364">(</span><span class="ident" id="8012365">test</span><span class="op" id="8012369">.</span><span class="ident" id="8012370">in</span><span class="op" id="8012372">)</span><span class="op" id="8012373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8012377">if</span>&nbsp;<span class="ident" id="8012380">err</span>&nbsp;<span class="op" id="8012384">!=</span>&nbsp;<span class="ident" id="8012387">nil</span>&nbsp;<span class="op" id="8012391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012396">t</span><span class="op" id="8012397">.</span><span class="ident" id="8012398">Errorf</span><span class="op" id="8012404">(</span><span class="string" id="8012405">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8012427">,</span>&nbsp;<span class="ident" id="8012429">i</span><span class="op" id="8012430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012438">want</span>&nbsp;<span class="op" id="8012443">:=</span>&nbsp;<span class="op" id="8012446">[</span><span class="op" id="8012447">]</span><span class="builtintype" id="8012448">byte</span><span class="op" id="8012452">(</span><span class="ident" id="8012453">test</span><span class="op" id="8012457">.</span><span class="ident" id="8012458">out</span><span class="op" id="8012461">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8012465">if</span>&nbsp;<span class="op" id="8012468">!</span><span class="ident" id="8012469">bytes</span><span class="op" id="8012474">.</span><span class="ident" id="8012475">Equal</span><span class="op" id="8012480">(</span><span class="ident" id="8012481">out</span><span class="op" id="8012484">,</span>&nbsp;<span class="ident" id="8012486">want</span><span class="op" id="8012490">)</span>&nbsp;<span class="op" id="8012492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012497">t</span><span class="op" id="8012498">.</span><span class="ident" id="8012499">Errorf</span><span class="op" id="8012505">(</span><span class="string" id="8012506">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8012528">,</span>&nbsp;<span class="ident" id="8012530">i</span><span class="op" id="8012531">,</span>&nbsp;<span class="ident" id="8012533">out</span><span class="op" id="8012536">,</span>&nbsp;<span class="ident" id="8012538">want</span><span class="op" id="8012542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012549">}</span><br>
<span class="lineno"></span><span class="op" id="8012551">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8012554">func</span>&nbsp;<span class="ident" id="8012559">TestEncryptPKCS1v15</span><span class="op" id="8012578">(</span><span class="ident" id="8012579">t</span>&nbsp;<span class="op" id="8012581">*</span><span class="ident" id="8012582">testing</span><span class="op" id="8012589">.</span><span class="ident" id="8012590">T</span><span class="op" id="8012591">)</span>&nbsp;<span class="op" id="8012593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012596">random</span>&nbsp;<span class="op" id="8012603">:=</span>&nbsp;<span class="ident" id="8012606">rand</span><span class="op" id="8012610">.</span><span class="ident" id="8012611">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012619">k</span>&nbsp;<span class="op" id="8012621">:=</span>&nbsp;<span class="op" id="8012624">(</span><span class="ident" id="8012625">rsaPrivateKey</span><span class="op" id="8012638">.</span><span class="ident" id="8012639">N</span><span class="op" id="8012640">.</span><span class="ident" id="8012641">BitLen</span><span class="op" id="8012647">(</span><span class="op" id="8012648">)</span>&nbsp;<span class="op" id="8012650">+</span>&nbsp;<span class="num" id="8012652">7</span><span class="op" id="8012653">)</span>&nbsp;<span class="op" id="8012655">/</span>&nbsp;<span class="num" id="8012657">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012661">tryEncryptDecrypt</span>&nbsp;<span class="op" id="8012679">:=</span>&nbsp;<span class="keyword" id="8012682">func</span><span class="op" id="8012686">(</span><span class="ident" id="8012687">in</span>&nbsp;<span class="op" id="8012690">[</span><span class="op" id="8012691">]</span><span class="builtintype" id="8012692">byte</span><span class="op" id="8012696">,</span>&nbsp;<span class="ident" id="8012698">blind</span>&nbsp;<span class="builtintype" id="8012704">bool</span><span class="op" id="8012708">)</span>&nbsp;<span class="builtintype" id="8012710">bool</span>&nbsp;<span class="op" id="8012715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8012719">if</span>&nbsp;<span class="builtinfunc" id="8012722">len</span><span class="op" id="8012725">(</span><span class="ident" id="8012726">in</span><span class="op" id="8012728">)</span>&nbsp;<span class="op" id="8012730">&gt;</span>&nbsp;<span class="ident" id="8012732">k</span><span class="op" id="8012733">-</span><span class="num" id="8012734">11</span>&nbsp;<span class="op" id="8012737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012742">in</span>&nbsp;<span class="op" id="8012745">=</span>&nbsp;<span class="ident" id="8012747">in</span><span class="op" id="8012749">[</span><span class="num" id="8012750">0</span>&nbsp;<span class="op" id="8012752">:</span>&nbsp;<span class="ident" id="8012754">k</span><span class="op" id="8012755">-</span><span class="num" id="8012756">11</span><span class="op" id="8012758">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012767">ciphertext</span><span class="op" id="8012777">,</span>&nbsp;<span class="ident" id="8012779">err</span>&nbsp;<span class="op" id="8012783">:=</span>&nbsp;<span class="ident" id="8012786">EncryptPKCS1v15</span><span class="op" id="8012801">(</span><span class="ident" id="8012802">random</span><span class="op" id="8012808">,</span>&nbsp;<span class="op" id="8012810">&amp;</span><span class="ident" id="8012811">rsaPrivateKey</span><span class="op" id="8012824">.</span><span class="ident" id="8012825">PublicKey</span><span class="op" id="8012834">,</span>&nbsp;<span class="ident" id="8012836">in</span><span class="op" id="8012838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8012842">if</span>&nbsp;<span class="ident" id="8012845">err</span>&nbsp;<span class="op" id="8012849">!=</span>&nbsp;<span class="ident" id="8012852">nil</span>&nbsp;<span class="op" id="8012856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012861">t</span><span class="op" id="8012862">.</span><span class="ident" id="8012863">Errorf</span><span class="op" id="8012869">(</span><span class="string" id="8012870">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="8012892">,</span>&nbsp;<span class="ident" id="8012894">err</span><span class="op" id="8012897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8012902">return</span>&nbsp;<span class="builtintype" id="8012909">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012917">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8012922">var</span>&nbsp;<span class="ident" id="8012926">rand</span>&nbsp;<span class="ident" id="8012931">io</span><span class="op" id="8012933">.</span><span class="ident" id="8012934">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8012943">if</span>&nbsp;<span class="op" id="8012946">!</span><span class="ident" id="8012947">blind</span>&nbsp;<span class="op" id="8012953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012958">rand</span>&nbsp;<span class="op" id="8012963">=</span>&nbsp;<span class="ident" id="8012965">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012971">}</span>&nbsp;<span class="keyword" id="8012973">else</span>&nbsp;<span class="op" id="8012978">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8012983">rand</span>&nbsp;<span class="op" id="8012988">=</span>&nbsp;<span class="ident" id="8012990">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8012999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8013003">plaintext</span><span class="op" id="8013012">,</span>&nbsp;<span class="ident" id="8013014">err</span>&nbsp;<span class="op" id="8013018">:=</span>&nbsp;<span class="ident" id="8013021">DecryptPKCS1v15</span><span class="op" id="8013036">(</span><span class="ident" id="8013037">rand</span><span class="op" id="8013041">,</span>&nbsp;<span class="ident" id="8013043">rsaPrivateKey</span><span class="op" id="8013056">,</span>&nbsp;<span class="ident" id="8013058">ciphertext</span><span class="op" id="8013068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8013072">if</span>&nbsp;<span class="ident" id="8013075">err</span>&nbsp;<span class="op" id="8013079">!=</span>&nbsp;<span class="ident" id="8013082">nil</span>&nbsp;<span class="op" id="8013086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8013091">t</span><span class="op" id="8013092">.</span><span class="ident" id="8013093">Errorf</span><span class="op" id="8013099">(</span><span class="string" id="8013100">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="8013122">,</span>&nbsp;<span class="ident" id="8013124">err</span><span class="op" id="8013127">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8013132">return</span>&nbsp;<span class="builtintype" id="8013139">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8013152">if</span>&nbsp;<span class="op" id="8013155">!</span><span class="ident" id="8013156">bytes</span><span class="op" id="8013161">.</span><span class="ident" id="8013162">Equal</span><span class="op" id="8013167">(</span><span class="ident" id="8013168">plaintext</span><span class="op" id="8013177">,</span>&nbsp;<span class="ident" id="8013179">in</span><span class="op" id="8013181">)</span>&nbsp;<span class="op" id="8013183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8013188">t</span><span class="op" id="8013189">.</span><span class="ident" id="8013190">Errorf</span><span class="op" id="8013196">(</span><span class="string" id="8013197">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="8013223">,</span>&nbsp;<span class="ident" id="8013225">plaintext</span><span class="op" id="8013234">,</span>&nbsp;<span class="ident" id="8013236">in</span><span class="op" id="8013238">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8013243">return</span>&nbsp;<span class="builtintype" id="8013250">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8013262">return</span>&nbsp;<span class="builtintype" id="8013269">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8013279">config</span>&nbsp;<span class="op" id="8013286">:=</span>&nbsp;<span class="builtinfunc" id="8013289">new</span><span class="op" id="8013292">(</span><span class="ident" id="8013293">quick</span><span class="op" id="8013298">.</span><span class="ident" id="8013299">Config</span><span class="op" id="8013305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8013308">if</span>&nbsp;<span class="ident" id="8013311">testing</span><span class="op" id="8013318">.</span><span class="ident" id="8013319">Short</span><span class="op" id="8013324">(</span><span class="op" id="8013325">)</span>&nbsp;<span class="op" id="8013327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8013331">config</span><span class="op" id="8013337">.</span><span class="ident" id="8013338">MaxCount</span>&nbsp;<span class="op" id="8013347">=</span>&nbsp;<span class="num" id="8013349">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8013356">quick</span><span class="op" id="8013361">.</span><span class="ident" id="8013362">Check</span><span class="op" id="8013367">(</span><span class="ident" id="8013368">tryEncryptDecrypt</span><span class="op" id="8013385">,</span>&nbsp;<span class="ident" id="8013387">config</span><span class="op" id="8013393">)</span><br>
<span class="lineno">105</span><span class="op" id="8013395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8013398">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8013472">var</span>&nbsp;<span class="ident" id="8013476">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8013507">=</span>&nbsp;<span class="op" id="8013509">[</span><span class="op" id="8013510">]</span><span class="ident" id="8013511">DecryptPKCS1v15Test</span><span class="op" id="8013530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013533">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8013537">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="8013627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8013631">&#34;1234&#34;</span><span class="op" id="8013637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013640">}</span><span class="op" id="8013641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8013648">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="8013738">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8013742">&#34;FAIL&#34;</span><span class="op" id="8013748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013751">}</span><span class="op" id="8013752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8013759">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="8013849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8013853">&#34;abcd&#34;</span><span class="op" id="8013859">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013862">}</span><span class="op" id="8013863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8013870">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="8013960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8013964">&#34;FAIL&#34;</span><span class="op" id="8013970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013973">}</span><span class="op" id="8013974">,</span><br>
<span class="lineno">125</span><span class="op" id="8013976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8013979">func</span>&nbsp;<span class="ident" id="8013984">TestEncryptPKCS1v15SessionKey</span><span class="op" id="8014013">(</span><span class="ident" id="8014014">t</span>&nbsp;<span class="op" id="8014016">*</span><span class="ident" id="8014017">testing</span><span class="op" id="8014024">.</span><span class="ident" id="8014025">T</span><span class="op" id="8014026">)</span>&nbsp;<span class="op" id="8014028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8014031">for</span>&nbsp;<span class="ident" id="8014035">i</span><span class="op" id="8014036">,</span>&nbsp;<span class="ident" id="8014038">test</span>&nbsp;<span class="op" id="8014043">:=</span>&nbsp;<span class="keyword" id="8014046">range</span>&nbsp;<span class="ident" id="8014052">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8014083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014087">key</span>&nbsp;<span class="op" id="8014091">:=</span>&nbsp;<span class="op" id="8014094">[</span><span class="op" id="8014095">]</span><span class="builtintype" id="8014096">byte</span><span class="op" id="8014100">(</span><span class="string" id="8014101">&#34;FAIL&#34;</span><span class="op" id="8014107">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014111">err</span>&nbsp;<span class="op" id="8014115">:=</span>&nbsp;<span class="ident" id="8014118">DecryptPKCS1v15SessionKey</span><span class="op" id="8014143">(</span><span class="ident" id="8014144">nil</span><span class="op" id="8014147">,</span>&nbsp;<span class="ident" id="8014149">rsaPrivateKey</span><span class="op" id="8014162">,</span>&nbsp;<span class="ident" id="8014164">decodeBase64</span><span class="op" id="8014176">(</span><span class="ident" id="8014177">test</span><span class="op" id="8014181">.</span><span class="ident" id="8014182">in</span><span class="op" id="8014184">)</span><span class="op" id="8014185">,</span>&nbsp;<span class="ident" id="8014187">key</span><span class="op" id="8014190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8014194">if</span>&nbsp;<span class="ident" id="8014197">err</span>&nbsp;<span class="op" id="8014201">!=</span>&nbsp;<span class="ident" id="8014204">nil</span>&nbsp;<span class="op" id="8014208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014213">t</span><span class="op" id="8014214">.</span><span class="ident" id="8014215">Errorf</span><span class="op" id="8014221">(</span><span class="string" id="8014222">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8014244">,</span>&nbsp;<span class="ident" id="8014246">i</span><span class="op" id="8014247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014255">want</span>&nbsp;<span class="op" id="8014260">:=</span>&nbsp;<span class="op" id="8014263">[</span><span class="op" id="8014264">]</span><span class="builtintype" id="8014265">byte</span><span class="op" id="8014269">(</span><span class="ident" id="8014270">test</span><span class="op" id="8014274">.</span><span class="ident" id="8014275">out</span><span class="op" id="8014278">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8014282">if</span>&nbsp;<span class="op" id="8014285">!</span><span class="ident" id="8014286">bytes</span><span class="op" id="8014291">.</span><span class="ident" id="8014292">Equal</span><span class="op" id="8014297">(</span><span class="ident" id="8014298">key</span><span class="op" id="8014301">,</span>&nbsp;<span class="ident" id="8014303">want</span><span class="op" id="8014307">)</span>&nbsp;<span class="op" id="8014309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014314">t</span><span class="op" id="8014315">.</span><span class="ident" id="8014316">Errorf</span><span class="op" id="8014322">(</span><span class="string" id="8014323">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8014345">,</span>&nbsp;<span class="ident" id="8014347">i</span><span class="op" id="8014348">,</span>&nbsp;<span class="ident" id="8014350">key</span><span class="op" id="8014353">,</span>&nbsp;<span class="ident" id="8014355">want</span><span class="op" id="8014359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014366">}</span><br>
<span class="lineno"></span><span class="op" id="8014368">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8014371">func</span>&nbsp;<span class="ident" id="8014376">TestNonZeroRandomBytes</span><span class="op" id="8014398">(</span><span class="ident" id="8014399">t</span>&nbsp;<span class="op" id="8014401">*</span><span class="ident" id="8014402">testing</span><span class="op" id="8014409">.</span><span class="ident" id="8014410">T</span><span class="op" id="8014411">)</span>&nbsp;<span class="op" id="8014413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014416">random</span>&nbsp;<span class="op" id="8014423">:=</span>&nbsp;<span class="ident" id="8014426">rand</span><span class="op" id="8014430">.</span><span class="ident" id="8014431">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014440">b</span>&nbsp;<span class="op" id="8014442">:=</span>&nbsp;<span class="builtinfunc" id="8014445">make</span><span class="op" id="8014449">(</span><span class="op" id="8014450">[</span><span class="op" id="8014451">]</span><span class="builtintype" id="8014452">byte</span><span class="op" id="8014456">,</span>&nbsp;<span class="num" id="8014458">512</span><span class="op" id="8014461">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014464">err</span>&nbsp;<span class="op" id="8014468">:=</span>&nbsp;<span class="ident" id="8014471">nonZeroRandomBytes</span><span class="op" id="8014489">(</span><span class="ident" id="8014490">b</span><span class="op" id="8014491">,</span>&nbsp;<span class="ident" id="8014493">random</span><span class="op" id="8014499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8014502">if</span>&nbsp;<span class="ident" id="8014505">err</span>&nbsp;<span class="op" id="8014509">!=</span>&nbsp;<span class="ident" id="8014512">nil</span>&nbsp;<span class="op" id="8014516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014520">t</span><span class="op" id="8014521">.</span><span class="ident" id="8014522">Errorf</span><span class="op" id="8014528">(</span><span class="string" id="8014529">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8014549">,</span>&nbsp;<span class="ident" id="8014551">err</span><span class="op" id="8014554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8014560">for</span>&nbsp;<span class="ident" id="8014564">_</span><span class="op" id="8014565">,</span>&nbsp;<span class="ident" id="8014567">b</span>&nbsp;<span class="op" id="8014569">:=</span>&nbsp;<span class="keyword" id="8014572">range</span>&nbsp;<span class="ident" id="8014578">b</span>&nbsp;<span class="op" id="8014580">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8014584">if</span>&nbsp;<span class="ident" id="8014587">b</span>&nbsp;<span class="op" id="8014589">==</span>&nbsp;<span class="num" id="8014592">0</span>&nbsp;<span class="op" id="8014594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014599">t</span><span class="op" id="8014600">.</span><span class="ident" id="8014601">Errorf</span><span class="op" id="8014607">(</span><span class="string" id="8014608">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="8014626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8014631">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014643">}</span><br>
<span class="lineno">155</span><span class="op" id="8014645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8014648">type</span>&nbsp;<span class="ident" id="8014653">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="8014670">struct</span>&nbsp;<span class="op" id="8014677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8014680">in</span><span class="op" id="8014682">,</span>&nbsp;<span class="ident" id="8014684">out</span>&nbsp;<span class="builtintype" id="8014688">string</span><br>
<span class="lineno"></span><span class="op" id="8014695">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="8014698">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8014737">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="8014804">var</span>&nbsp;<span class="ident" id="8014808">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8014826">=</span>&nbsp;<span class="op" id="8014828">[</span><span class="op" id="8014829">]</span><span class="ident" id="8014830">signPKCS1v15Test</span><span class="op" id="8014846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014849">{</span><span class="string" id="8014850">&#34;Test.\n&#34;</span><span class="op" id="8014859">,</span>&nbsp;<span class="string" id="8014861">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="8014991">}</span><span class="op" id="8014992">,</span><br>
<span class="lineno">165</span><span class="op" id="8014994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8014997">func</span>&nbsp;<span class="ident" id="8015002">TestSignPKCS1v15</span><span class="op" id="8015018">(</span><span class="ident" id="8015019">t</span>&nbsp;<span class="op" id="8015021">*</span><span class="ident" id="8015022">testing</span><span class="op" id="8015029">.</span><span class="ident" id="8015030">T</span><span class="op" id="8015031">)</span>&nbsp;<span class="op" id="8015033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015036">for</span>&nbsp;<span class="ident" id="8015040">i</span><span class="op" id="8015041">,</span>&nbsp;<span class="ident" id="8015043">test</span>&nbsp;<span class="op" id="8015048">:=</span>&nbsp;<span class="keyword" id="8015051">range</span>&nbsp;<span class="ident" id="8015057">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8015075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015079">h</span>&nbsp;<span class="op" id="8015081">:=</span>&nbsp;<span class="ident" id="8015084">sha1</span><span class="op" id="8015088">.</span><span class="ident" id="8015089">New</span><span class="op" id="8015092">(</span><span class="op" id="8015093">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015097">h</span><span class="op" id="8015098">.</span><span class="ident" id="8015099">Write</span><span class="op" id="8015104">(</span><span class="op" id="8015105">[</span><span class="op" id="8015106">]</span><span class="builtintype" id="8015107">byte</span><span class="op" id="8015111">(</span><span class="ident" id="8015112">test</span><span class="op" id="8015116">.</span><span class="ident" id="8015117">in</span><span class="op" id="8015119">)</span><span class="op" id="8015120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015124">digest</span>&nbsp;<span class="op" id="8015131">:=</span>&nbsp;<span class="ident" id="8015134">h</span><span class="op" id="8015135">.</span><span class="ident" id="8015136">Sum</span><span class="op" id="8015139">(</span><span class="ident" id="8015140">nil</span><span class="op" id="8015143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015148">s</span><span class="op" id="8015149">,</span>&nbsp;<span class="ident" id="8015151">err</span>&nbsp;<span class="op" id="8015155">:=</span>&nbsp;<span class="ident" id="8015158">SignPKCS1v15</span><span class="op" id="8015170">(</span><span class="ident" id="8015171">nil</span><span class="op" id="8015174">,</span>&nbsp;<span class="ident" id="8015176">rsaPrivateKey</span><span class="op" id="8015189">,</span>&nbsp;<span class="ident" id="8015191">crypto</span><span class="op" id="8015197">.</span><span class="ident" id="8015198">SHA1</span><span class="op" id="8015202">,</span>&nbsp;<span class="ident" id="8015204">digest</span><span class="op" id="8015210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015214">if</span>&nbsp;<span class="ident" id="8015217">err</span>&nbsp;<span class="op" id="8015221">!=</span>&nbsp;<span class="ident" id="8015224">nil</span>&nbsp;<span class="op" id="8015228">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015233">t</span><span class="op" id="8015234">.</span><span class="ident" id="8015235">Errorf</span><span class="op" id="8015241">(</span><span class="string" id="8015242">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8015250">,</span>&nbsp;<span class="ident" id="8015252">i</span><span class="op" id="8015253">,</span>&nbsp;<span class="ident" id="8015255">err</span><span class="op" id="8015258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015267">expected</span><span class="op" id="8015275">,</span>&nbsp;<span class="ident" id="8015277">_</span>&nbsp;<span class="op" id="8015279">:=</span>&nbsp;<span class="ident" id="8015282">hex</span><span class="op" id="8015285">.</span><span class="ident" id="8015286">DecodeString</span><span class="op" id="8015298">(</span><span class="ident" id="8015299">test</span><span class="op" id="8015303">.</span><span class="ident" id="8015304">out</span><span class="op" id="8015307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015311">if</span>&nbsp;<span class="op" id="8015314">!</span><span class="ident" id="8015315">bytes</span><span class="op" id="8015320">.</span><span class="ident" id="8015321">Equal</span><span class="op" id="8015326">(</span><span class="ident" id="8015327">s</span><span class="op" id="8015328">,</span>&nbsp;<span class="ident" id="8015330">expected</span><span class="op" id="8015338">)</span>&nbsp;<span class="op" id="8015340">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015345">t</span><span class="op" id="8015346">.</span><span class="ident" id="8015347">Errorf</span><span class="op" id="8015353">(</span><span class="string" id="8015354">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="8015376">,</span>&nbsp;<span class="ident" id="8015378">i</span><span class="op" id="8015379">,</span>&nbsp;<span class="ident" id="8015381">s</span><span class="op" id="8015382">,</span>&nbsp;<span class="ident" id="8015384">expected</span><span class="op" id="8015392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015399">}</span><br>
<span class="lineno"></span><span class="op" id="8015401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8015404">func</span>&nbsp;<span class="ident" id="8015409">TestVerifyPKCS1v15</span><span class="op" id="8015427">(</span><span class="ident" id="8015428">t</span>&nbsp;<span class="op" id="8015430">*</span><span class="ident" id="8015431">testing</span><span class="op" id="8015438">.</span><span class="ident" id="8015439">T</span><span class="op" id="8015440">)</span>&nbsp;<span class="op" id="8015442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015445">for</span>&nbsp;<span class="ident" id="8015449">i</span><span class="op" id="8015450">,</span>&nbsp;<span class="ident" id="8015452">test</span>&nbsp;<span class="op" id="8015457">:=</span>&nbsp;<span class="keyword" id="8015460">range</span>&nbsp;<span class="ident" id="8015466">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8015484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015488">h</span>&nbsp;<span class="op" id="8015490">:=</span>&nbsp;<span class="ident" id="8015493">sha1</span><span class="op" id="8015497">.</span><span class="ident" id="8015498">New</span><span class="op" id="8015501">(</span><span class="op" id="8015502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015506">h</span><span class="op" id="8015507">.</span><span class="ident" id="8015508">Write</span><span class="op" id="8015513">(</span><span class="op" id="8015514">[</span><span class="op" id="8015515">]</span><span class="builtintype" id="8015516">byte</span><span class="op" id="8015520">(</span><span class="ident" id="8015521">test</span><span class="op" id="8015525">.</span><span class="ident" id="8015526">in</span><span class="op" id="8015528">)</span><span class="op" id="8015529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015533">digest</span>&nbsp;<span class="op" id="8015540">:=</span>&nbsp;<span class="ident" id="8015543">h</span><span class="op" id="8015544">.</span><span class="ident" id="8015545">Sum</span><span class="op" id="8015548">(</span><span class="ident" id="8015549">nil</span><span class="op" id="8015552">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015557">sig</span><span class="op" id="8015560">,</span>&nbsp;<span class="ident" id="8015562">_</span>&nbsp;<span class="op" id="8015564">:=</span>&nbsp;<span class="ident" id="8015567">hex</span><span class="op" id="8015570">.</span><span class="ident" id="8015571">DecodeString</span><span class="op" id="8015583">(</span><span class="ident" id="8015584">test</span><span class="op" id="8015588">.</span><span class="ident" id="8015589">out</span><span class="op" id="8015592">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015597">err</span>&nbsp;<span class="op" id="8015601">:=</span>&nbsp;<span class="ident" id="8015604">VerifyPKCS1v15</span><span class="op" id="8015618">(</span><span class="op" id="8015619">&amp;</span><span class="ident" id="8015620">rsaPrivateKey</span><span class="op" id="8015633">.</span><span class="ident" id="8015634">PublicKey</span><span class="op" id="8015643">,</span>&nbsp;<span class="ident" id="8015645">crypto</span><span class="op" id="8015651">.</span><span class="ident" id="8015652">SHA1</span><span class="op" id="8015656">,</span>&nbsp;<span class="ident" id="8015658">digest</span><span class="op" id="8015664">,</span>&nbsp;<span class="ident" id="8015666">sig</span><span class="op" id="8015669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015673">if</span>&nbsp;<span class="ident" id="8015676">err</span>&nbsp;<span class="op" id="8015680">!=</span>&nbsp;<span class="ident" id="8015683">nil</span>&nbsp;<span class="op" id="8015687">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015692">t</span><span class="op" id="8015693">.</span><span class="ident" id="8015694">Errorf</span><span class="op" id="8015700">(</span><span class="string" id="8015701">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8015709">,</span>&nbsp;<span class="ident" id="8015711">i</span><span class="op" id="8015712">,</span>&nbsp;<span class="ident" id="8015714">err</span><span class="op" id="8015717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015724">}</span><br>
<span class="lineno"></span><span class="op" id="8015726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="8015729">func</span>&nbsp;<span class="ident" id="8015734">TestOverlongMessagePKCS1v15</span><span class="op" id="8015761">(</span><span class="ident" id="8015762">t</span>&nbsp;<span class="op" id="8015764">*</span><span class="ident" id="8015765">testing</span><span class="op" id="8015772">.</span><span class="ident" id="8015773">T</span><span class="op" id="8015774">)</span>&nbsp;<span class="op" id="8015776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015779">ciphertext</span>&nbsp;<span class="op" id="8015790">:=</span>&nbsp;<span class="ident" id="8015793">decodeBase64</span><span class="op" id="8015805">(</span><span class="string" id="8015806">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="8015898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015901">_</span><span class="op" id="8015902">,</span>&nbsp;<span class="ident" id="8015904">err</span>&nbsp;<span class="op" id="8015908">:=</span>&nbsp;<span class="ident" id="8015911">DecryptPKCS1v15</span><span class="op" id="8015926">(</span><span class="ident" id="8015927">nil</span><span class="op" id="8015930">,</span>&nbsp;<span class="ident" id="8015932">rsaPrivateKey</span><span class="op" id="8015945">,</span>&nbsp;<span class="ident" id="8015947">ciphertext</span><span class="op" id="8015957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015960">if</span>&nbsp;<span class="ident" id="8015963">err</span>&nbsp;<span class="op" id="8015967">==</span>&nbsp;<span class="ident" id="8015970">nil</span>&nbsp;<span class="op" id="8015974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015978">t</span><span class="op" id="8015979">.</span><span class="ident" id="8015980">Error</span><span class="op" id="8015985">(</span><span class="string" id="8015986">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="8016030">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016033">}</span><br>
<span class="lineno"></span><span class="op" id="8016035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8016038">func</span>&nbsp;<span class="ident" id="8016043">TestUnpaddedSignature</span><span class="op" id="8016064">(</span><span class="ident" id="8016065">t</span>&nbsp;<span class="op" id="8016067">*</span><span class="ident" id="8016068">testing</span><span class="op" id="8016075">.</span><span class="ident" id="8016076">T</span><span class="op" id="8016077">)</span>&nbsp;<span class="op" id="8016079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016082">msg</span>&nbsp;<span class="op" id="8016086">:=</span>&nbsp;<span class="op" id="8016089">[</span><span class="op" id="8016090">]</span><span class="builtintype" id="8016091">byte</span><span class="op" id="8016095">(</span><span class="string" id="8016096">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="8016128">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8016131">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8016173">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8016224">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8016289">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8016293">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8016366">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016376">expectedSig</span>&nbsp;<span class="op" id="8016388">:=</span>&nbsp;<span class="ident" id="8016391">decodeBase64</span><span class="op" id="8016403">(</span><span class="string" id="8016404">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="8016494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016498">sig</span><span class="op" id="8016501">,</span>&nbsp;<span class="ident" id="8016503">err</span>&nbsp;<span class="op" id="8016507">:=</span>&nbsp;<span class="ident" id="8016510">SignPKCS1v15</span><span class="op" id="8016522">(</span><span class="ident" id="8016523">nil</span><span class="op" id="8016526">,</span>&nbsp;<span class="ident" id="8016528">rsaPrivateKey</span><span class="op" id="8016541">,</span>&nbsp;<span class="ident" id="8016543">crypto</span><span class="op" id="8016549">.</span><span class="ident" id="8016550">Hash</span><span class="op" id="8016554">(</span><span class="num" id="8016555">0</span><span class="op" id="8016556">)</span><span class="op" id="8016557">,</span>&nbsp;<span class="ident" id="8016559">msg</span><span class="op" id="8016562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016565">if</span>&nbsp;<span class="ident" id="8016568">err</span>&nbsp;<span class="op" id="8016572">!=</span>&nbsp;<span class="ident" id="8016575">nil</span>&nbsp;<span class="op" id="8016579">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016583">t</span><span class="op" id="8016584">.</span><span class="ident" id="8016585">Fatalf</span><span class="op" id="8016591">(</span><span class="string" id="8016592">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8016617">,</span>&nbsp;<span class="ident" id="8016619">err</span><span class="op" id="8016622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016628">if</span>&nbsp;<span class="op" id="8016631">!</span><span class="ident" id="8016632">bytes</span><span class="op" id="8016637">.</span><span class="ident" id="8016638">Equal</span><span class="op" id="8016643">(</span><span class="ident" id="8016644">sig</span><span class="op" id="8016647">,</span>&nbsp;<span class="ident" id="8016649">expectedSig</span><span class="op" id="8016660">)</span>&nbsp;<span class="op" id="8016662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016666">t</span><span class="op" id="8016667">.</span><span class="ident" id="8016668">Fatalf</span><span class="op" id="8016674">(</span><span class="string" id="8016675">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8016725">,</span>&nbsp;<span class="ident" id="8016727">sig</span><span class="op" id="8016730">,</span>&nbsp;<span class="ident" id="8016732">expectedSig</span><span class="op" id="8016743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016746">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016749">if</span>&nbsp;<span class="ident" id="8016752">err</span>&nbsp;<span class="op" id="8016756">:=</span>&nbsp;<span class="ident" id="8016759">VerifyPKCS1v15</span><span class="op" id="8016773">(</span><span class="op" id="8016774">&amp;</span><span class="ident" id="8016775">rsaPrivateKey</span><span class="op" id="8016788">.</span><span class="ident" id="8016789">PublicKey</span><span class="op" id="8016798">,</span>&nbsp;<span class="ident" id="8016800">crypto</span><span class="op" id="8016806">.</span><span class="ident" id="8016807">Hash</span><span class="op" id="8016811">(</span><span class="num" id="8016812">0</span><span class="op" id="8016813">)</span><span class="op" id="8016814">,</span>&nbsp;<span class="ident" id="8016816">msg</span><span class="op" id="8016819">,</span>&nbsp;<span class="ident" id="8016821">sig</span><span class="op" id="8016824">)</span><span class="op" id="8016825">;</span>&nbsp;<span class="ident" id="8016827">err</span>&nbsp;<span class="op" id="8016831">!=</span>&nbsp;<span class="ident" id="8016834">nil</span>&nbsp;<span class="op" id="8016838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016842">t</span><span class="op" id="8016843">.</span><span class="ident" id="8016844">Fatalf</span><span class="op" id="8016850">(</span><span class="string" id="8016851">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="8016883">,</span>&nbsp;<span class="ident" id="8016885">err</span><span class="op" id="8016888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016891">}</span><br>
<span class="lineno"></span><span class="op" id="8016893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="8016896">func</span>&nbsp;<span class="ident" id="8016901">TestShortSessionKey</span><span class="op" id="8016920">(</span><span class="ident" id="8016921">t</span>&nbsp;<span class="op" id="8016923">*</span><span class="ident" id="8016924">testing</span><span class="op" id="8016931">.</span><span class="ident" id="8016932">T</span><span class="op" id="8016933">)</span>&nbsp;<span class="op" id="8016935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8016938">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8017004">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017070">ciphertext</span><span class="op" id="8017080">,</span>&nbsp;<span class="ident" id="8017082">err</span>&nbsp;<span class="op" id="8017086">:=</span>&nbsp;<span class="ident" id="8017089">EncryptPKCS1v15</span><span class="op" id="8017104">(</span><span class="ident" id="8017105">rand</span><span class="op" id="8017109">.</span><span class="ident" id="8017110">Reader</span><span class="op" id="8017116">,</span>&nbsp;<span class="op" id="8017118">&amp;</span><span class="ident" id="8017119">rsaPrivateKey</span><span class="op" id="8017132">.</span><span class="ident" id="8017133">PublicKey</span><span class="op" id="8017142">,</span>&nbsp;<span class="op" id="8017144">[</span><span class="op" id="8017145">]</span><span class="builtintype" id="8017146">byte</span><span class="op" id="8017150">{</span><span class="num" id="8017151">1</span><span class="op" id="8017152">}</span><span class="op" id="8017153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017156">if</span>&nbsp;<span class="ident" id="8017159">err</span>&nbsp;<span class="op" id="8017163">!=</span>&nbsp;<span class="ident" id="8017166">nil</span>&nbsp;<span class="op" id="8017170">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017174">t</span><span class="op" id="8017175">.</span><span class="ident" id="8017176">Fatalf</span><span class="op" id="8017182">(</span><span class="string" id="8017183">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8017220">,</span>&nbsp;<span class="ident" id="8017222">err</span><span class="op" id="8017225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017232">var</span>&nbsp;<span class="ident" id="8017236">key</span>&nbsp;<span class="op" id="8017240">[</span><span class="num" id="8017241">32</span><span class="op" id="8017243">]</span><span class="builtintype" id="8017244">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017250">if</span>&nbsp;<span class="ident" id="8017253">err</span>&nbsp;<span class="op" id="8017257">:=</span>&nbsp;<span class="ident" id="8017260">DecryptPKCS1v15SessionKey</span><span class="op" id="8017285">(</span><span class="ident" id="8017286">nil</span><span class="op" id="8017289">,</span>&nbsp;<span class="ident" id="8017291">rsaPrivateKey</span><span class="op" id="8017304">,</span>&nbsp;<span class="ident" id="8017306">ciphertext</span><span class="op" id="8017316">,</span>&nbsp;<span class="ident" id="8017318">key</span><span class="op" id="8017321">[</span><span class="op" id="8017322">:</span><span class="op" id="8017323">]</span><span class="op" id="8017324">)</span><span class="op" id="8017325">;</span>&nbsp;<span class="ident" id="8017327">err</span>&nbsp;<span class="op" id="8017331">!=</span>&nbsp;<span class="ident" id="8017334">nil</span>&nbsp;<span class="op" id="8017338">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017342">t</span><span class="op" id="8017343">.</span><span class="ident" id="8017344">Fatalf</span><span class="op" id="8017350">(</span><span class="string" id="8017351">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8017388">,</span>&nbsp;<span class="ident" id="8017390">err</span><span class="op" id="8017393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017400">for</span>&nbsp;<span class="ident" id="8017404">_</span><span class="op" id="8017405">,</span>&nbsp;<span class="ident" id="8017407">v</span>&nbsp;<span class="op" id="8017409">:=</span>&nbsp;<span class="keyword" id="8017412">range</span>&nbsp;<span class="ident" id="8017418">key</span>&nbsp;<span class="op" id="8017422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017426">if</span>&nbsp;<span class="ident" id="8017429">v</span>&nbsp;<span class="op" id="8017431">!=</span>&nbsp;<span class="num" id="8017434">0</span>&nbsp;<span class="op" id="8017436">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017441">t</span><span class="op" id="8017442">.</span><span class="ident" id="8017443">Fatal</span><span class="op" id="8017448">(</span><span class="string" id="8017449">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="8017495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017502">}</span><br>
<span class="lineno"></span><span class="op" id="8017504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="8017507">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="8017586">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="8017621">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="8017689">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="8017757">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="8017825">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="8017893">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="8017961">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="8018029">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="8018073">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8018107">var</span>&nbsp;<span class="ident" id="8018111">rsaPrivateKey</span>&nbsp;<span class="op" id="8018125">=</span>&nbsp;<span class="op" id="8018127">&amp;</span><span class="ident" id="8018128">PrivateKey</span><span class="op" id="8018138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018141">PublicKey</span><span class="op" id="8018150">:</span>&nbsp;<span class="ident" id="8018152">PublicKey</span><span class="op" id="8018161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018165">N</span><span class="op" id="8018166">:</span>&nbsp;<span class="ident" id="8018168">fromBase10</span><span class="op" id="8018178">(</span><span class="string" id="8018179">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8018335">)</span><span class="op" id="8018336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018340">E</span><span class="op" id="8018341">:</span>&nbsp;<span class="num" id="8018343">65537</span><span class="op" id="8018348">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018351">}</span><span class="op" id="8018352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018355">D</span><span class="op" id="8018356">:</span>&nbsp;<span class="ident" id="8018358">fromBase10</span><span class="op" id="8018368">(</span><span class="string" id="8018369">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8018525">)</span><span class="op" id="8018526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018529">Primes</span><span class="op" id="8018535">:</span>&nbsp;<span class="op" id="8018537">[</span><span class="op" id="8018538">]</span><span class="op" id="8018539">*</span><span class="ident" id="8018540">big</span><span class="op" id="8018543">.</span><span class="ident" id="8018544">Int</span><span class="op" id="8018547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018551">fromBase10</span><span class="op" id="8018561">(</span><span class="string" id="8018562">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8018641">)</span><span class="op" id="8018642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018646">fromBase10</span><span class="op" id="8018656">(</span><span class="string" id="8018657">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8018736">)</span><span class="op" id="8018737">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018740">}</span><span class="op" id="8018741">,</span><br>
<span class="lineno"></span><span class="op" id="8018743">}</span>
</div>
</body>
</html>
