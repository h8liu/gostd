<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3569165">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3569220">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3569274">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3569325">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3569384">package</span>&nbsp;<span class="ident" id="3569392">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3569400">import</span>&nbsp;<span class="op" id="3569407">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3569410">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3569418">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3569424">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3569434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3569437">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="3569517">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="3569529">type</span>&nbsp;<span class="ident" id="3569534">Hash</span>&nbsp;<span class="builtintype" id="3569539">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3569545">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="3569623">func</span>&nbsp;<span class="op" id="3569628">(</span><span class="ident" id="3569629">h</span>&nbsp;<span class="ident" id="3569631">Hash</span><span class="op" id="3569635">)</span>&nbsp;<span class="ident" id="3569637">HashFunc</span><span class="op" id="3569645">(</span><span class="op" id="3569646">)</span>&nbsp;<span class="ident" id="3569648">Hash</span>&nbsp;<span class="op" id="3569653">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3569656">return</span>&nbsp;<span class="ident" id="3569663">h</span><br>
<span class="lineno"></span><span class="op" id="3569665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3569668">const</span>&nbsp;<span class="op" id="3569674">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569677">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3569687">Hash</span>&nbsp;<span class="op" id="3569692">=</span>&nbsp;<span class="num" id="3569694">1</span>&nbsp;<span class="op" id="3569696">+</span>&nbsp;<span class="ident" id="3569698">iota</span>&nbsp;<span class="comment" id="3569703">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569738">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3569764">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569786">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3569812">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569835">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3569861">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569886">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3569912">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569937">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3569963">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3569988">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3570014">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570039">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3570065">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570114">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3570140">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570181">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3570207">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570243">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3570269">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570305">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3570331">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570367">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3570393">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570429">maxHash</span><br>
<span class="lineno"></span><span class="op" id="3570437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3570440">var</span>&nbsp;<span class="ident" id="3570444">digestSizes</span>&nbsp;<span class="op" id="3570456">=</span>&nbsp;<span class="op" id="3570458">[</span><span class="op" id="3570459">]</span><span class="builtintype" id="3570460">uint8</span><span class="op" id="3570465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570468">MD4</span><span class="op" id="3570471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3570479">16</span><span class="op" id="3570481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570484">MD5</span><span class="op" id="3570487">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3570495">16</span><span class="op" id="3570497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570500">SHA1</span><span class="op" id="3570504">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3570511">20</span><span class="op" id="3570513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570516">SHA224</span><span class="op" id="3570522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3570527">28</span><span class="op" id="3570529">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570532">SHA256</span><span class="op" id="3570538">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3570543">32</span><span class="op" id="3570545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570548">SHA384</span><span class="op" id="3570554">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3570559">48</span><span class="op" id="3570561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570564">SHA512</span><span class="op" id="3570570">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3570575">64</span><span class="op" id="3570577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570580">SHA3_224</span><span class="op" id="3570588">:</span>&nbsp;&nbsp;<span class="num" id="3570591">28</span><span class="op" id="3570593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570596">SHA3_256</span><span class="op" id="3570604">:</span>&nbsp;&nbsp;<span class="num" id="3570607">32</span><span class="op" id="3570609">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570612">SHA3_384</span><span class="op" id="3570620">:</span>&nbsp;&nbsp;<span class="num" id="3570623">48</span><span class="op" id="3570625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570628">SHA3_512</span><span class="op" id="3570636">:</span>&nbsp;&nbsp;<span class="num" id="3570639">64</span><span class="op" id="3570641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570644">MD5SHA1</span><span class="op" id="3570651">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="3570655">36</span><span class="op" id="3570657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3570660">RIPEMD160</span><span class="op" id="3570669">:</span>&nbsp;<span class="num" id="3570671">20</span><span class="op" id="3570673">,</span><br>
<span class="lineno"></span><span class="op" id="3570675">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3570678">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="3570758">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="3570835">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3570856">func</span>&nbsp;<span class="op" id="3570861">(</span><span class="ident" id="3570862">h</span>&nbsp;<span class="ident" id="3570864">Hash</span><span class="op" id="3570868">)</span>&nbsp;<span class="ident" id="3570870">Size</span><span class="op" id="3570874">(</span><span class="op" id="3570875">)</span>&nbsp;<span class="builtintype" id="3570877">int</span>&nbsp;<span class="op" id="3570881">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3570884">if</span>&nbsp;<span class="ident" id="3570887">h</span>&nbsp;<span class="op" id="3570889">&gt;</span>&nbsp;<span class="num" id="3570891">0</span>&nbsp;<span class="op" id="3570893">&amp;&amp;</span>&nbsp;<span class="ident" id="3570896">h</span>&nbsp;<span class="op" id="3570898">&lt;</span>&nbsp;<span class="ident" id="3570900">maxHash</span>&nbsp;<span class="op" id="3570908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3570912">return</span>&nbsp;<span class="builtintype" id="3570919">int</span><span class="op" id="3570922">(</span><span class="ident" id="3570923">digestSizes</span><span class="op" id="3570934">[</span><span class="ident" id="3570935">h</span><span class="op" id="3570936">]</span><span class="op" id="3570937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3570940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3570943">panic</span><span class="op" id="3570948">(</span><span class="string" id="3570949">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3570988">)</span><br>
<span class="lineno"></span><span class="op" id="3570990">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3570993">var</span>&nbsp;<span class="ident" id="3570997">hashes</span>&nbsp;<span class="op" id="3571004">=</span>&nbsp;<span class="builtinfunc" id="3571006">make</span><span class="op" id="3571010">(</span><span class="op" id="3571011">[</span><span class="op" id="3571012">]</span><span class="keyword" id="3571013">func</span><span class="op" id="3571017">(</span><span class="op" id="3571018">)</span>&nbsp;<span class="ident" id="3571020">hash</span><span class="op" id="3571024">.</span><span class="ident" id="3571025">Hash</span><span class="op" id="3571029">,</span>&nbsp;<span class="ident" id="3571031">maxHash</span><span class="op" id="3571038">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3571041">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="3571120">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="3571175">func</span>&nbsp;<span class="op" id="3571180">(</span><span class="ident" id="3571181">h</span>&nbsp;<span class="ident" id="3571183">Hash</span><span class="op" id="3571187">)</span>&nbsp;<span class="ident" id="3571189">New</span><span class="op" id="3571192">(</span><span class="op" id="3571193">)</span>&nbsp;<span class="ident" id="3571195">hash</span><span class="op" id="3571199">.</span><span class="ident" id="3571200">Hash</span>&nbsp;<span class="op" id="3571205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571208">if</span>&nbsp;<span class="ident" id="3571211">h</span>&nbsp;<span class="op" id="3571213">&gt;</span>&nbsp;<span class="num" id="3571215">0</span>&nbsp;<span class="op" id="3571217">&amp;&amp;</span>&nbsp;<span class="ident" id="3571220">h</span>&nbsp;<span class="op" id="3571222">&lt;</span>&nbsp;<span class="ident" id="3571224">maxHash</span>&nbsp;<span class="op" id="3571232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3571236">f</span>&nbsp;<span class="op" id="3571238">:=</span>&nbsp;<span class="ident" id="3571241">hashes</span><span class="op" id="3571247">[</span><span class="ident" id="3571248">h</span><span class="op" id="3571249">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571253">if</span>&nbsp;<span class="ident" id="3571256">f</span>&nbsp;<span class="op" id="3571258">!=</span>&nbsp;<span class="ident" id="3571261">nil</span>&nbsp;<span class="op" id="3571265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571270">return</span>&nbsp;<span class="ident" id="3571277">f</span><span class="op" id="3571278">(</span><span class="op" id="3571279">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3571289">panic</span><span class="op" id="3571294">(</span><span class="string" id="3571295">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="3571331">+</span>&nbsp;<span class="ident" id="3571333">strconv</span><span class="op" id="3571340">.</span><span class="ident" id="3571341">Itoa</span><span class="op" id="3571345">(</span><span class="builtintype" id="3571346">int</span><span class="op" id="3571349">(</span><span class="ident" id="3571350">h</span><span class="op" id="3571351">)</span><span class="op" id="3571352">)</span>&nbsp;<span class="op" id="3571354">+</span>&nbsp;<span class="string" id="3571356">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="3571373">)</span><br>
<span class="lineno"></span><span class="op" id="3571375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3571378">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="3571458">func</span>&nbsp;<span class="op" id="3571463">(</span><span class="ident" id="3571464">h</span>&nbsp;<span class="ident" id="3571466">Hash</span><span class="op" id="3571470">)</span>&nbsp;<span class="ident" id="3571472">Available</span><span class="op" id="3571481">(</span><span class="op" id="3571482">)</span>&nbsp;<span class="builtintype" id="3571484">bool</span>&nbsp;<span class="op" id="3571489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571492">return</span>&nbsp;<span class="ident" id="3571499">h</span>&nbsp;<span class="op" id="3571501">&lt;</span>&nbsp;<span class="ident" id="3571503">maxHash</span>&nbsp;<span class="op" id="3571511">&amp;&amp;</span>&nbsp;<span class="ident" id="3571514">hashes</span><span class="op" id="3571520">[</span><span class="ident" id="3571521">h</span><span class="op" id="3571522">]</span>&nbsp;<span class="op" id="3571524">!=</span>&nbsp;<span class="ident" id="3571527">nil</span><br>
<span class="lineno"></span><span class="op" id="3571531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3571534">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3571612">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3571686">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3571729">func</span>&nbsp;<span class="ident" id="3571734">RegisterHash</span><span class="op" id="3571746">(</span><span class="ident" id="3571747">h</span>&nbsp;<span class="ident" id="3571749">Hash</span><span class="op" id="3571753">,</span>&nbsp;<span class="ident" id="3571755">f</span>&nbsp;<span class="keyword" id="3571757">func</span><span class="op" id="3571761">(</span><span class="op" id="3571762">)</span>&nbsp;<span class="ident" id="3571764">hash</span><span class="op" id="3571768">.</span><span class="ident" id="3571769">Hash</span><span class="op" id="3571773">)</span>&nbsp;<span class="op" id="3571775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3571778">if</span>&nbsp;<span class="ident" id="3571781">h</span>&nbsp;<span class="op" id="3571783">&gt;=</span>&nbsp;<span class="ident" id="3571786">maxHash</span>&nbsp;<span class="op" id="3571794">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3571798">panic</span><span class="op" id="3571803">(</span><span class="string" id="3571804">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3571851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3571854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3571857">hashes</span><span class="op" id="3571863">[</span><span class="ident" id="3571864">h</span><span class="op" id="3571865">]</span>&nbsp;<span class="op" id="3571867">=</span>&nbsp;<span class="ident" id="3571869">f</span><br>
<span class="lineno"></span><span class="op" id="3571871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3571874">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3571943">type</span>&nbsp;<span class="ident" id="3571948">PublicKey</span>&nbsp;<span class="keyword" id="3571958">interface</span><span class="op" id="3571967">{</span><span class="op" id="3571968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3571971">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3572042">type</span>&nbsp;<span class="ident" id="3572047">PrivateKey</span>&nbsp;<span class="keyword" id="3572058">interface</span><span class="op" id="3572067">{</span><span class="op" id="3572068">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3572071">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3572144">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="3572218">type</span>&nbsp;<span class="ident" id="3572223">Signer</span>&nbsp;<span class="keyword" id="3572230">interface</span>&nbsp;<span class="op" id="3572240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572243">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572306">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572323">Public</span><span class="op" id="3572329">(</span><span class="op" id="3572330">)</span>&nbsp;<span class="ident" id="3572332">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572344">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572413">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572482">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572554">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572621">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572625">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572698">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572771">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3572839">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3572911">Sign</span><span class="op" id="3572915">(</span><span class="ident" id="3572916">rand</span>&nbsp;<span class="ident" id="3572921">io</span><span class="op" id="3572923">.</span><span class="ident" id="3572924">Reader</span><span class="op" id="3572930">,</span>&nbsp;<span class="ident" id="3572932">msg</span>&nbsp;<span class="op" id="3572936">[</span><span class="op" id="3572937">]</span><span class="builtintype" id="3572938">byte</span><span class="op" id="3572942">,</span>&nbsp;<span class="ident" id="3572944">opts</span>&nbsp;<span class="ident" id="3572949">SignerOpts</span><span class="op" id="3572959">)</span>&nbsp;<span class="op" id="3572961">(</span><span class="ident" id="3572962">signature</span>&nbsp;<span class="op" id="3572972">[</span><span class="op" id="3572973">]</span><span class="builtintype" id="3572974">byte</span><span class="op" id="3572978">,</span>&nbsp;<span class="ident" id="3572980">err</span>&nbsp;<span class="builtintype" id="3572984">error</span><span class="op" id="3572989">)</span><br>
<span class="lineno"></span><span class="op" id="3572991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3572994">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="3573052">type</span>&nbsp;<span class="ident" id="3573057">SignerOpts</span>&nbsp;<span class="keyword" id="3573068">interface</span>&nbsp;<span class="op" id="3573078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3573081">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3573154">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3573226">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3573248">HashFunc</span><span class="op" id="3573256">(</span><span class="op" id="3573257">)</span>&nbsp;<span class="ident" id="3573259">Hash</span><br>
<span class="lineno"></span><span class="op" id="3573264">}</span>
</div>
</body>
</html>
