<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/dsa</h2>
<ul>
<li><a href="/gostd/crypto/dsa/dsa.go.html">dsa.go</a></li>
<li><a href="/gostd/crypto/dsa/dsa_test.go.html">dsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7547248">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7547303">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7547357">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7547408">package</span>&nbsp;<span class="ident" id="7547416">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7547421">import</span>&nbsp;<span class="op" id="7547428">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7547431">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7547446">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7547458">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7547468">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7547471">func</span>&nbsp;<span class="ident" id="7547476">testSignAndVerify</span><span class="op" id="7547493">(</span><span class="ident" id="7547494">t</span>&nbsp;<span class="op" id="7547496">*</span><span class="ident" id="7547497">testing</span><span class="op" id="7547504">.</span><span class="ident" id="7547505">T</span><span class="op" id="7547506">,</span>&nbsp;<span class="ident" id="7547508">i</span>&nbsp;<span class="builtintype" id="7547510">int</span><span class="op" id="7547513">,</span>&nbsp;<span class="ident" id="7547515">priv</span>&nbsp;<span class="op" id="7547520">*</span><span class="ident" id="7547521">PrivateKey</span><span class="op" id="7547531">)</span>&nbsp;<span class="op" id="7547533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7547536">hashed</span>&nbsp;<span class="op" id="7547543">:=</span>&nbsp;<span class="op" id="7547546">[</span><span class="op" id="7547547">]</span><span class="builtintype" id="7547548">byte</span><span class="op" id="7547552">(</span><span class="string" id="7547553">&#34;testing&#34;</span><span class="op" id="7547562">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7547565">r</span><span class="op" id="7547566">,</span>&nbsp;<span class="ident" id="7547568">s</span><span class="op" id="7547569">,</span>&nbsp;<span class="ident" id="7547571">err</span>&nbsp;<span class="op" id="7547575">:=</span>&nbsp;<span class="ident" id="7547578">Sign</span><span class="op" id="7547582">(</span><span class="ident" id="7547583">rand</span><span class="op" id="7547587">.</span><span class="ident" id="7547588">Reader</span><span class="op" id="7547594">,</span>&nbsp;<span class="ident" id="7547596">priv</span><span class="op" id="7547600">,</span>&nbsp;<span class="ident" id="7547602">hashed</span><span class="op" id="7547608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7547611">if</span>&nbsp;<span class="ident" id="7547614">err</span>&nbsp;<span class="op" id="7547618">!=</span>&nbsp;<span class="ident" id="7547621">nil</span>&nbsp;<span class="op" id="7547625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7547629">t</span><span class="op" id="7547630">.</span><span class="ident" id="7547631">Errorf</span><span class="op" id="7547637">(</span><span class="string" id="7547638">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7547661">,</span>&nbsp;<span class="ident" id="7547663">i</span><span class="op" id="7547664">,</span>&nbsp;<span class="ident" id="7547666">err</span><span class="op" id="7547669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7547673">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7547681">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7547685">if</span>&nbsp;<span class="op" id="7547688">!</span><span class="ident" id="7547689">Verify</span><span class="op" id="7547695">(</span><span class="op" id="7547696">&amp;</span><span class="ident" id="7547697">priv</span><span class="op" id="7547701">.</span><span class="ident" id="7547702">PublicKey</span><span class="op" id="7547711">,</span>&nbsp;<span class="ident" id="7547713">hashed</span><span class="op" id="7547719">,</span>&nbsp;<span class="ident" id="7547721">r</span><span class="op" id="7547722">,</span>&nbsp;<span class="ident" id="7547724">s</span><span class="op" id="7547725">)</span>&nbsp;<span class="op" id="7547727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7547731">t</span><span class="op" id="7547732">.</span><span class="ident" id="7547733">Errorf</span><span class="op" id="7547739">(</span><span class="string" id="7547740">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7547759">,</span>&nbsp;<span class="ident" id="7547761">i</span><span class="op" id="7547762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7547765">}</span><br>
<span class="lineno"></span><span class="op" id="7547767">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="7547770">func</span>&nbsp;<span class="ident" id="7547775">testParameterGeneration</span><span class="op" id="7547798">(</span><span class="ident" id="7547799">t</span>&nbsp;<span class="op" id="7547801">*</span><span class="ident" id="7547802">testing</span><span class="op" id="7547809">.</span><span class="ident" id="7547810">T</span><span class="op" id="7547811">,</span>&nbsp;<span class="ident" id="7547813">sizes</span>&nbsp;<span class="ident" id="7547819">ParameterSizes</span><span class="op" id="7547833">,</span>&nbsp;<span class="ident" id="7547835">L</span><span class="op" id="7547836">,</span>&nbsp;<span class="ident" id="7547838">N</span>&nbsp;<span class="builtintype" id="7547840">int</span><span class="op" id="7547843">)</span>&nbsp;<span class="op" id="7547845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7547848">var</span>&nbsp;<span class="ident" id="7547852">priv</span>&nbsp;<span class="ident" id="7547857">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7547869">params</span>&nbsp;<span class="op" id="7547876">:=</span>&nbsp;<span class="op" id="7547879">&amp;</span><span class="ident" id="7547880">priv</span><span class="op" id="7547884">.</span><span class="ident" id="7547885">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7547898">err</span>&nbsp;<span class="op" id="7547902">:=</span>&nbsp;<span class="ident" id="7547905">GenerateParameters</span><span class="op" id="7547923">(</span><span class="ident" id="7547924">params</span><span class="op" id="7547930">,</span>&nbsp;<span class="ident" id="7547932">rand</span><span class="op" id="7547936">.</span><span class="ident" id="7547937">Reader</span><span class="op" id="7547943">,</span>&nbsp;<span class="ident" id="7547945">sizes</span><span class="op" id="7547950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7547953">if</span>&nbsp;<span class="ident" id="7547956">err</span>&nbsp;<span class="op" id="7547960">!=</span>&nbsp;<span class="ident" id="7547963">nil</span>&nbsp;<span class="op" id="7547967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7547971">t</span><span class="op" id="7547972">.</span><span class="ident" id="7547973">Errorf</span><span class="op" id="7547979">(</span><span class="string" id="7547980">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="7547988">,</span>&nbsp;<span class="builtintype" id="7547990">int</span><span class="op" id="7547993">(</span><span class="ident" id="7547994">sizes</span><span class="op" id="7547999">)</span><span class="op" id="7548000">,</span>&nbsp;<span class="ident" id="7548002">err</span><span class="op" id="7548005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7548009">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7548017">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7548021">if</span>&nbsp;<span class="ident" id="7548024">params</span><span class="op" id="7548030">.</span><span class="ident" id="7548031">P</span><span class="op" id="7548032">.</span><span class="ident" id="7548033">BitLen</span><span class="op" id="7548039">(</span><span class="op" id="7548040">)</span>&nbsp;<span class="op" id="7548042">!=</span>&nbsp;<span class="ident" id="7548045">L</span>&nbsp;<span class="op" id="7548047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548051">t</span><span class="op" id="7548052">.</span><span class="ident" id="7548053">Errorf</span><span class="op" id="7548059">(</span><span class="string" id="7548060">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="7548094">,</span>&nbsp;<span class="builtintype" id="7548096">int</span><span class="op" id="7548099">(</span><span class="ident" id="7548100">sizes</span><span class="op" id="7548105">)</span><span class="op" id="7548106">,</span>&nbsp;<span class="ident" id="7548108">params</span><span class="op" id="7548114">.</span><span class="ident" id="7548115">P</span><span class="op" id="7548116">.</span><span class="ident" id="7548117">BitLen</span><span class="op" id="7548123">(</span><span class="op" id="7548124">)</span><span class="op" id="7548125">,</span>&nbsp;<span class="ident" id="7548127">L</span><span class="op" id="7548128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7548131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7548135">if</span>&nbsp;<span class="ident" id="7548138">params</span><span class="op" id="7548144">.</span><span class="ident" id="7548145">Q</span><span class="op" id="7548146">.</span><span class="ident" id="7548147">BitLen</span><span class="op" id="7548153">(</span><span class="op" id="7548154">)</span>&nbsp;<span class="op" id="7548156">!=</span>&nbsp;<span class="ident" id="7548159">N</span>&nbsp;<span class="op" id="7548161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548165">t</span><span class="op" id="7548166">.</span><span class="ident" id="7548167">Errorf</span><span class="op" id="7548173">(</span><span class="string" id="7548174">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="7548203">,</span>&nbsp;<span class="builtintype" id="7548205">int</span><span class="op" id="7548208">(</span><span class="ident" id="7548209">sizes</span><span class="op" id="7548214">)</span><span class="op" id="7548215">,</span>&nbsp;<span class="ident" id="7548217">params</span><span class="op" id="7548223">.</span><span class="ident" id="7548224">Q</span><span class="op" id="7548225">.</span><span class="ident" id="7548226">BitLen</span><span class="op" id="7548232">(</span><span class="op" id="7548233">)</span><span class="op" id="7548234">,</span>&nbsp;<span class="ident" id="7548236">L</span><span class="op" id="7548237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7548240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548244">one</span>&nbsp;<span class="op" id="7548248">:=</span>&nbsp;<span class="builtinfunc" id="7548251">new</span><span class="op" id="7548254">(</span><span class="ident" id="7548255">big</span><span class="op" id="7548258">.</span><span class="ident" id="7548259">Int</span><span class="op" id="7548262">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548265">one</span><span class="op" id="7548268">.</span><span class="ident" id="7548269">SetInt64</span><span class="op" id="7548277">(</span><span class="num" id="7548278">1</span><span class="op" id="7548279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548282">pm1</span>&nbsp;<span class="op" id="7548286">:=</span>&nbsp;<span class="builtinfunc" id="7548289">new</span><span class="op" id="7548292">(</span><span class="ident" id="7548293">big</span><span class="op" id="7548296">.</span><span class="ident" id="7548297">Int</span><span class="op" id="7548300">)</span><span class="op" id="7548301">.</span><span class="ident" id="7548302">Sub</span><span class="op" id="7548305">(</span><span class="ident" id="7548306">params</span><span class="op" id="7548312">.</span><span class="ident" id="7548313">P</span><span class="op" id="7548314">,</span>&nbsp;<span class="ident" id="7548316">one</span><span class="op" id="7548319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548322">quo</span><span class="op" id="7548325">,</span>&nbsp;<span class="ident" id="7548327">rem</span>&nbsp;<span class="op" id="7548331">:=</span>&nbsp;<span class="builtinfunc" id="7548334">new</span><span class="op" id="7548337">(</span><span class="ident" id="7548338">big</span><span class="op" id="7548341">.</span><span class="ident" id="7548342">Int</span><span class="op" id="7548345">)</span><span class="op" id="7548346">.</span><span class="ident" id="7548347">DivMod</span><span class="op" id="7548353">(</span><span class="ident" id="7548354">pm1</span><span class="op" id="7548357">,</span>&nbsp;<span class="ident" id="7548359">params</span><span class="op" id="7548365">.</span><span class="ident" id="7548366">Q</span><span class="op" id="7548367">,</span>&nbsp;<span class="builtinfunc" id="7548369">new</span><span class="op" id="7548372">(</span><span class="ident" id="7548373">big</span><span class="op" id="7548376">.</span><span class="ident" id="7548377">Int</span><span class="op" id="7548380">)</span><span class="op" id="7548381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7548384">if</span>&nbsp;<span class="ident" id="7548387">rem</span><span class="op" id="7548390">.</span><span class="ident" id="7548391">Sign</span><span class="op" id="7548395">(</span><span class="op" id="7548396">)</span>&nbsp;<span class="op" id="7548398">!=</span>&nbsp;<span class="num" id="7548401">0</span>&nbsp;<span class="op" id="7548403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548407">t</span><span class="op" id="7548408">.</span><span class="ident" id="7548409">Errorf</span><span class="op" id="7548415">(</span><span class="string" id="7548416">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="7548436">,</span>&nbsp;<span class="builtintype" id="7548438">int</span><span class="op" id="7548441">(</span><span class="ident" id="7548442">sizes</span><span class="op" id="7548447">)</span><span class="op" id="7548448">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7548451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548454">x</span>&nbsp;<span class="op" id="7548456">:=</span>&nbsp;<span class="builtinfunc" id="7548459">new</span><span class="op" id="7548462">(</span><span class="ident" id="7548463">big</span><span class="op" id="7548466">.</span><span class="ident" id="7548467">Int</span><span class="op" id="7548470">)</span><span class="op" id="7548471">.</span><span class="ident" id="7548472">Exp</span><span class="op" id="7548475">(</span><span class="ident" id="7548476">params</span><span class="op" id="7548482">.</span><span class="ident" id="7548483">G</span><span class="op" id="7548484">,</span>&nbsp;<span class="ident" id="7548486">quo</span><span class="op" id="7548489">,</span>&nbsp;<span class="ident" id="7548491">params</span><span class="op" id="7548497">.</span><span class="ident" id="7548498">P</span><span class="op" id="7548499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7548502">if</span>&nbsp;<span class="ident" id="7548505">x</span><span class="op" id="7548506">.</span><span class="ident" id="7548507">Cmp</span><span class="op" id="7548510">(</span><span class="ident" id="7548511">one</span><span class="op" id="7548514">)</span>&nbsp;<span class="op" id="7548516">==</span>&nbsp;<span class="num" id="7548519">0</span>&nbsp;<span class="op" id="7548521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548525">t</span><span class="op" id="7548526">.</span><span class="ident" id="7548527">Errorf</span><span class="op" id="7548533">(</span><span class="string" id="7548534">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="7548557">,</span>&nbsp;<span class="builtintype" id="7548559">int</span><span class="op" id="7548562">(</span><span class="ident" id="7548563">sizes</span><span class="op" id="7548568">)</span><span class="op" id="7548569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7548572">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548576">err</span>&nbsp;<span class="op" id="7548580">=</span>&nbsp;<span class="ident" id="7548582">GenerateKey</span><span class="op" id="7548593">(</span><span class="op" id="7548594">&amp;</span><span class="ident" id="7548595">priv</span><span class="op" id="7548599">,</span>&nbsp;<span class="ident" id="7548601">rand</span><span class="op" id="7548605">.</span><span class="ident" id="7548606">Reader</span><span class="op" id="7548612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7548615">if</span>&nbsp;<span class="ident" id="7548618">err</span>&nbsp;<span class="op" id="7548622">!=</span>&nbsp;<span class="ident" id="7548625">nil</span>&nbsp;<span class="op" id="7548629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548633">t</span><span class="op" id="7548634">.</span><span class="ident" id="7548635">Errorf</span><span class="op" id="7548641">(</span><span class="string" id="7548642">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7548668">,</span>&nbsp;<span class="ident" id="7548670">err</span><span class="op" id="7548673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7548677">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7548685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548689">testSignAndVerify</span><span class="op" id="7548706">(</span><span class="ident" id="7548707">t</span><span class="op" id="7548708">,</span>&nbsp;<span class="builtintype" id="7548710">int</span><span class="op" id="7548713">(</span><span class="ident" id="7548714">sizes</span><span class="op" id="7548719">)</span><span class="op" id="7548720">,</span>&nbsp;<span class="op" id="7548722">&amp;</span><span class="ident" id="7548723">priv</span><span class="op" id="7548727">)</span><br>
<span class="lineno"></span><span class="op" id="7548729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7548732">func</span>&nbsp;<span class="ident" id="7548737">TestParameterGeneration</span><span class="op" id="7548760">(</span><span class="ident" id="7548761">t</span>&nbsp;<span class="op" id="7548763">*</span><span class="ident" id="7548764">testing</span><span class="op" id="7548771">.</span><span class="ident" id="7548772">T</span><span class="op" id="7548773">)</span>&nbsp;<span class="op" id="7548775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7548778">if</span>&nbsp;<span class="ident" id="7548781">testing</span><span class="op" id="7548788">.</span><span class="ident" id="7548789">Short</span><span class="op" id="7548794">(</span><span class="op" id="7548795">)</span>&nbsp;<span class="op" id="7548797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548801">t</span><span class="op" id="7548802">.</span><span class="ident" id="7548803">Skip</span><span class="op" id="7548807">(</span><span class="string" id="7548808">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7548858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7548861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548865">testParameterGeneration</span><span class="op" id="7548888">(</span><span class="ident" id="7548889">t</span><span class="op" id="7548890">,</span>&nbsp;<span class="ident" id="7548892">L1024N160</span><span class="op" id="7548901">,</span>&nbsp;<span class="num" id="7548903">1024</span><span class="op" id="7548907">,</span>&nbsp;<span class="num" id="7548909">160</span><span class="op" id="7548912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548915">testParameterGeneration</span><span class="op" id="7548938">(</span><span class="ident" id="7548939">t</span><span class="op" id="7548940">,</span>&nbsp;<span class="ident" id="7548942">L2048N224</span><span class="op" id="7548951">,</span>&nbsp;<span class="num" id="7548953">2048</span><span class="op" id="7548957">,</span>&nbsp;<span class="num" id="7548959">224</span><span class="op" id="7548962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7548965">testParameterGeneration</span><span class="op" id="7548988">(</span><span class="ident" id="7548989">t</span><span class="op" id="7548990">,</span>&nbsp;<span class="ident" id="7548992">L2048N256</span><span class="op" id="7549001">,</span>&nbsp;<span class="num" id="7549003">2048</span><span class="op" id="7549007">,</span>&nbsp;<span class="num" id="7549009">256</span><span class="op" id="7549012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7549015">testParameterGeneration</span><span class="op" id="7549038">(</span><span class="ident" id="7549039">t</span><span class="op" id="7549040">,</span>&nbsp;<span class="ident" id="7549042">L3072N256</span><span class="op" id="7549051">,</span>&nbsp;<span class="num" id="7549053">3072</span><span class="op" id="7549057">,</span>&nbsp;<span class="num" id="7549059">256</span><span class="op" id="7549062">)</span><br>
<span class="lineno"></span><span class="op" id="7549064">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7549067">func</span>&nbsp;<span class="ident" id="7549072">TestSignAndVerify</span><span class="op" id="7549089">(</span><span class="ident" id="7549090">t</span>&nbsp;<span class="op" id="7549092">*</span><span class="ident" id="7549093">testing</span><span class="op" id="7549100">.</span><span class="ident" id="7549101">T</span><span class="op" id="7549102">)</span>&nbsp;<span class="op" id="7549104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7549107">var</span>&nbsp;<span class="ident" id="7549111">priv</span>&nbsp;<span class="ident" id="7549116">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7549128">priv</span><span class="op" id="7549132">.</span><span class="ident" id="7549133">P</span><span class="op" id="7549134">,</span>&nbsp;<span class="ident" id="7549136">_</span>&nbsp;<span class="op" id="7549138">=</span>&nbsp;<span class="builtinfunc" id="7549140">new</span><span class="op" id="7549143">(</span><span class="ident" id="7549144">big</span><span class="op" id="7549147">.</span><span class="ident" id="7549148">Int</span><span class="op" id="7549151">)</span><span class="op" id="7549152">.</span><span class="ident" id="7549153">SetString</span><span class="op" id="7549162">(</span><span class="string" id="7549163">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="7549421">,</span>&nbsp;<span class="num" id="7549423">16</span><span class="op" id="7549425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7549428">priv</span><span class="op" id="7549432">.</span><span class="ident" id="7549433">Q</span><span class="op" id="7549434">,</span>&nbsp;<span class="ident" id="7549436">_</span>&nbsp;<span class="op" id="7549438">=</span>&nbsp;<span class="builtinfunc" id="7549440">new</span><span class="op" id="7549443">(</span><span class="ident" id="7549444">big</span><span class="op" id="7549447">.</span><span class="ident" id="7549448">Int</span><span class="op" id="7549451">)</span><span class="op" id="7549452">.</span><span class="ident" id="7549453">SetString</span><span class="op" id="7549462">(</span><span class="string" id="7549463">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="7549505">,</span>&nbsp;<span class="num" id="7549507">16</span><span class="op" id="7549509">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7549512">priv</span><span class="op" id="7549516">.</span><span class="ident" id="7549517">G</span><span class="op" id="7549518">,</span>&nbsp;<span class="ident" id="7549520">_</span>&nbsp;<span class="op" id="7549522">=</span>&nbsp;<span class="builtinfunc" id="7549524">new</span><span class="op" id="7549527">(</span><span class="ident" id="7549528">big</span><span class="op" id="7549531">.</span><span class="ident" id="7549532">Int</span><span class="op" id="7549535">)</span><span class="op" id="7549536">.</span><span class="ident" id="7549537">SetString</span><span class="op" id="7549546">(</span><span class="string" id="7549547">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="7549805">,</span>&nbsp;<span class="num" id="7549807">16</span><span class="op" id="7549809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7549812">priv</span><span class="op" id="7549816">.</span><span class="ident" id="7549817">Y</span><span class="op" id="7549818">,</span>&nbsp;<span class="ident" id="7549820">_</span>&nbsp;<span class="op" id="7549822">=</span>&nbsp;<span class="builtinfunc" id="7549824">new</span><span class="op" id="7549827">(</span><span class="ident" id="7549828">big</span><span class="op" id="7549831">.</span><span class="ident" id="7549832">Int</span><span class="op" id="7549835">)</span><span class="op" id="7549836">.</span><span class="ident" id="7549837">SetString</span><span class="op" id="7549846">(</span><span class="string" id="7549847">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="7550105">,</span>&nbsp;<span class="num" id="7550107">16</span><span class="op" id="7550109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7550112">priv</span><span class="op" id="7550116">.</span><span class="ident" id="7550117">X</span><span class="op" id="7550118">,</span>&nbsp;<span class="ident" id="7550120">_</span>&nbsp;<span class="op" id="7550122">=</span>&nbsp;<span class="builtinfunc" id="7550124">new</span><span class="op" id="7550127">(</span><span class="ident" id="7550128">big</span><span class="op" id="7550131">.</span><span class="ident" id="7550132">Int</span><span class="op" id="7550135">)</span><span class="op" id="7550136">.</span><span class="ident" id="7550137">SetString</span><span class="op" id="7550146">(</span><span class="string" id="7550147">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="7550189">,</span>&nbsp;<span class="num" id="7550191">16</span><span class="op" id="7550193">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7550197">testSignAndVerify</span><span class="op" id="7550214">(</span><span class="ident" id="7550215">t</span><span class="op" id="7550216">,</span>&nbsp;<span class="num" id="7550218">0</span><span class="op" id="7550219">,</span>&nbsp;<span class="op" id="7550221">&amp;</span><span class="ident" id="7550222">priv</span><span class="op" id="7550226">)</span><br>
<span class="lineno">85</span><span class="op" id="7550228">}</span>
</div>
</body>
</html>
