<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2972057">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2972112">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2972166">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2972217">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="2972256">//</span><br>
<span class="lineno"></span><span class="comment" id="2972259">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="2972319">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="2972358">//</span><br>
<span class="lineno">10</span><span class="comment" id="2972361">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2972421">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="2972486">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="2972553">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="2972577">//</span><br>
<span class="lineno">15</span><span class="comment" id="2972580">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="2972644">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="2972714">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2972777">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="2972810">//</span><br>
<span class="lineno">20</span><span class="comment" id="2972813">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2972889">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2972956">package</span>&nbsp;<span class="ident" id="2972964">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2972969">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2972988">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="2973007">const</span>&nbsp;<span class="op" id="2973013">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2973016">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973068">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973081">=</span>&nbsp;<span class="num" id="2973083">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973086">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973099">=</span>&nbsp;<span class="num" id="2973101">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973104">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973117">=</span>&nbsp;<span class="num" id="2973119">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973122">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973135">=</span>&nbsp;<span class="num" id="2973137">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973140">dnsTypeCNAME</span>&nbsp;<span class="op" id="2973153">=</span>&nbsp;<span class="num" id="2973155">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973158">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2973171">=</span>&nbsp;<span class="num" id="2973173">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973176">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973189">=</span>&nbsp;<span class="num" id="2973191">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973194">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973207">=</span>&nbsp;<span class="num" id="2973209">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973212">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973225">=</span>&nbsp;<span class="num" id="2973227">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973230">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="2973243">=</span>&nbsp;<span class="num" id="2973245">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973249">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2973262">=</span>&nbsp;<span class="num" id="2973264">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973268">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2973281">=</span>&nbsp;<span class="num" id="2973283">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973287">dnsTypeHINFO</span>&nbsp;<span class="op" id="2973300">=</span>&nbsp;<span class="num" id="2973302">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973306">dnsTypeMINFO</span>&nbsp;<span class="op" id="2973319">=</span>&nbsp;<span class="num" id="2973321">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973325">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973338">=</span>&nbsp;<span class="num" id="2973340">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973344">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2973357">=</span>&nbsp;<span class="num" id="2973359">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973363">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="2973376">=</span>&nbsp;<span class="num" id="2973378">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973382">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2973395">=</span>&nbsp;<span class="num" id="2973397">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2973402">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973435">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="2973448">=</span>&nbsp;<span class="num" id="2973450">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973455">dnsTypeMAILB</span>&nbsp;<span class="op" id="2973468">=</span>&nbsp;<span class="num" id="2973470">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973475">dnsTypeMAILA</span>&nbsp;<span class="op" id="2973488">=</span>&nbsp;<span class="num" id="2973490">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973495">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2973508">=</span>&nbsp;<span class="num" id="2973510">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2973516">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973545">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2973560">=</span>&nbsp;<span class="num" id="2973562">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973565">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="2973580">=</span>&nbsp;<span class="num" id="2973582">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973585">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="2973600">=</span>&nbsp;<span class="num" id="2973602">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973605">dnsClassHESIOD</span>&nbsp;<span class="op" id="2973620">=</span>&nbsp;<span class="num" id="2973622">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973625">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973640">=</span>&nbsp;<span class="num" id="2973642">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2973648">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973665">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973688">=</span>&nbsp;<span class="num" id="2973690">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973693">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973716">=</span>&nbsp;<span class="num" id="2973718">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973721">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="2973744">=</span>&nbsp;<span class="num" id="2973746">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973749">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973772">=</span>&nbsp;<span class="num" id="2973774">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973777">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="2973800">=</span>&nbsp;<span class="num" id="2973802">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973805">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973828">=</span>&nbsp;<span class="num" id="2973830">5</span><br>
<span class="lineno"></span><span class="op" id="2973832">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="2973835">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="2973902">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="2973929">type</span>&nbsp;<span class="ident" id="2973934">dnsStruct</span>&nbsp;<span class="keyword" id="2973944">interface</span>&nbsp;<span class="op" id="2973954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2973957">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2974014">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2974072">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2974128">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2974178">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2974234">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2974276">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2974332">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974370">Walk</span><span class="op" id="2974374">(</span><span class="ident" id="2974375">f</span>&nbsp;<span class="keyword" id="2974377">func</span><span class="op" id="2974381">(</span><span class="ident" id="2974382">v</span>&nbsp;<span class="keyword" id="2974384">interface</span><span class="op" id="2974393">{</span><span class="op" id="2974394">}</span><span class="op" id="2974395">,</span>&nbsp;<span class="ident" id="2974397">name</span><span class="op" id="2974401">,</span>&nbsp;<span class="ident" id="2974403">tag</span>&nbsp;<span class="builtintype" id="2974407">string</span><span class="op" id="2974413">)</span>&nbsp;<span class="op" id="2974415">(</span><span class="ident" id="2974416">ok</span>&nbsp;<span class="builtintype" id="2974419">bool</span><span class="op" id="2974423">)</span><span class="op" id="2974424">)</span>&nbsp;<span class="op" id="2974426">(</span><span class="ident" id="2974427">ok</span>&nbsp;<span class="builtintype" id="2974430">bool</span><span class="op" id="2974434">)</span><br>
<span class="lineno"></span><span class="op" id="2974436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="2974439">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="2974485">type</span>&nbsp;<span class="ident" id="2974490">dnsHeader</span>&nbsp;<span class="keyword" id="2974500">struct</span>&nbsp;<span class="op" id="2974507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974510">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2974545">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974553">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2974588">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974596">Qdcount</span><span class="op" id="2974603">,</span>&nbsp;<span class="ident" id="2974605">Ancount</span><span class="op" id="2974612">,</span>&nbsp;<span class="ident" id="2974614">Nscount</span><span class="op" id="2974621">,</span>&nbsp;<span class="ident" id="2974623">Arcount</span>&nbsp;<span class="builtintype" id="2974631">uint16</span><br>
<span class="lineno">90</span><span class="op" id="2974638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2974641">func</span>&nbsp;<span class="op" id="2974646">(</span><span class="ident" id="2974647">h</span>&nbsp;<span class="op" id="2974649">*</span><span class="ident" id="2974650">dnsHeader</span><span class="op" id="2974659">)</span>&nbsp;<span class="ident" id="2974661">Walk</span><span class="op" id="2974665">(</span><span class="ident" id="2974666">f</span>&nbsp;<span class="keyword" id="2974668">func</span><span class="op" id="2974672">(</span><span class="ident" id="2974673">v</span>&nbsp;<span class="keyword" id="2974675">interface</span><span class="op" id="2974684">{</span><span class="op" id="2974685">}</span><span class="op" id="2974686">,</span>&nbsp;<span class="ident" id="2974688">name</span><span class="op" id="2974692">,</span>&nbsp;<span class="ident" id="2974694">tag</span>&nbsp;<span class="builtintype" id="2974698">string</span><span class="op" id="2974704">)</span>&nbsp;<span class="builtintype" id="2974706">bool</span><span class="op" id="2974710">)</span>&nbsp;<span class="builtintype" id="2974712">bool</span>&nbsp;<span class="op" id="2974717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974720">return</span>&nbsp;<span class="ident" id="2974727">f</span><span class="op" id="2974728">(</span><span class="op" id="2974729">&amp;</span><span class="ident" id="2974730">h</span><span class="op" id="2974731">.</span><span class="ident" id="2974732">Id</span><span class="op" id="2974734">,</span>&nbsp;<span class="string" id="2974736">&#34;Id&#34;</span><span class="op" id="2974740">,</span>&nbsp;<span class="string" id="2974742">&#34;&#34;</span><span class="op" id="2974744">)</span>&nbsp;<span class="op" id="2974746">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974751">f</span><span class="op" id="2974752">(</span><span class="op" id="2974753">&amp;</span><span class="ident" id="2974754">h</span><span class="op" id="2974755">.</span><span class="ident" id="2974756">Bits</span><span class="op" id="2974760">,</span>&nbsp;<span class="string" id="2974762">&#34;Bits&#34;</span><span class="op" id="2974768">,</span>&nbsp;<span class="string" id="2974770">&#34;&#34;</span><span class="op" id="2974772">)</span>&nbsp;<span class="op" id="2974774">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974779">f</span><span class="op" id="2974780">(</span><span class="op" id="2974781">&amp;</span><span class="ident" id="2974782">h</span><span class="op" id="2974783">.</span><span class="ident" id="2974784">Qdcount</span><span class="op" id="2974791">,</span>&nbsp;<span class="string" id="2974793">&#34;Qdcount&#34;</span><span class="op" id="2974802">,</span>&nbsp;<span class="string" id="2974804">&#34;&#34;</span><span class="op" id="2974806">)</span>&nbsp;<span class="op" id="2974808">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974813">f</span><span class="op" id="2974814">(</span><span class="op" id="2974815">&amp;</span><span class="ident" id="2974816">h</span><span class="op" id="2974817">.</span><span class="ident" id="2974818">Ancount</span><span class="op" id="2974825">,</span>&nbsp;<span class="string" id="2974827">&#34;Ancount&#34;</span><span class="op" id="2974836">,</span>&nbsp;<span class="string" id="2974838">&#34;&#34;</span><span class="op" id="2974840">)</span>&nbsp;<span class="op" id="2974842">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974847">f</span><span class="op" id="2974848">(</span><span class="op" id="2974849">&amp;</span><span class="ident" id="2974850">h</span><span class="op" id="2974851">.</span><span class="ident" id="2974852">Nscount</span><span class="op" id="2974859">,</span>&nbsp;<span class="string" id="2974861">&#34;Nscount&#34;</span><span class="op" id="2974870">,</span>&nbsp;<span class="string" id="2974872">&#34;&#34;</span><span class="op" id="2974874">)</span>&nbsp;<span class="op" id="2974876">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974881">f</span><span class="op" id="2974882">(</span><span class="op" id="2974883">&amp;</span><span class="ident" id="2974884">h</span><span class="op" id="2974885">.</span><span class="ident" id="2974886">Arcount</span><span class="op" id="2974893">,</span>&nbsp;<span class="string" id="2974895">&#34;Arcount&#34;</span><span class="op" id="2974904">,</span>&nbsp;<span class="string" id="2974906">&#34;&#34;</span><span class="op" id="2974908">)</span><br>
<span class="lineno"></span><span class="op" id="2974910">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="2974913">const</span>&nbsp;<span class="op" id="2974919">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2974922">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974941">_QR</span>&nbsp;<span class="op" id="2974945">=</span>&nbsp;<span class="num" id="2974947">1</span>&nbsp;<span class="op" id="2974949">&lt;&lt;</span>&nbsp;<span class="num" id="2974952">15</span>&nbsp;<span class="comment" id="2974955">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974987">_AA</span>&nbsp;<span class="op" id="2974991">=</span>&nbsp;<span class="num" id="2974993">1</span>&nbsp;<span class="op" id="2974995">&lt;&lt;</span>&nbsp;<span class="num" id="2974998">10</span>&nbsp;<span class="comment" id="2975001">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975019">_TC</span>&nbsp;<span class="op" id="2975023">=</span>&nbsp;<span class="num" id="2975025">1</span>&nbsp;<span class="op" id="2975027">&lt;&lt;</span>&nbsp;<span class="num" id="2975030">9</span>&nbsp;&nbsp;<span class="comment" id="2975033">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975047">_RD</span>&nbsp;<span class="op" id="2975051">=</span>&nbsp;<span class="num" id="2975053">1</span>&nbsp;<span class="op" id="2975055">&lt;&lt;</span>&nbsp;<span class="num" id="2975058">8</span>&nbsp;&nbsp;<span class="comment" id="2975061">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975083">_RA</span>&nbsp;<span class="op" id="2975087">=</span>&nbsp;<span class="num" id="2975089">1</span>&nbsp;<span class="op" id="2975091">&lt;&lt;</span>&nbsp;<span class="num" id="2975094">7</span>&nbsp;&nbsp;<span class="comment" id="2975097">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="2975120">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2975123">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="2975139">type</span>&nbsp;<span class="ident" id="2975144">dnsQuestion</span>&nbsp;<span class="keyword" id="2975156">struct</span>&nbsp;<span class="op" id="2975163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975166">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2975173">string</span>&nbsp;<span class="string" id="2975180">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="2975200">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975262">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="2975269">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975277">Qclass</span>&nbsp;<span class="builtintype" id="2975284">uint16</span><br>
<span class="lineno">115</span><span class="op" id="2975291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2975294">func</span>&nbsp;<span class="op" id="2975299">(</span><span class="ident" id="2975300">q</span>&nbsp;<span class="op" id="2975302">*</span><span class="ident" id="2975303">dnsQuestion</span><span class="op" id="2975314">)</span>&nbsp;<span class="ident" id="2975316">Walk</span><span class="op" id="2975320">(</span><span class="ident" id="2975321">f</span>&nbsp;<span class="keyword" id="2975323">func</span><span class="op" id="2975327">(</span><span class="ident" id="2975328">v</span>&nbsp;<span class="keyword" id="2975330">interface</span><span class="op" id="2975339">{</span><span class="op" id="2975340">}</span><span class="op" id="2975341">,</span>&nbsp;<span class="ident" id="2975343">name</span><span class="op" id="2975347">,</span>&nbsp;<span class="ident" id="2975349">tag</span>&nbsp;<span class="builtintype" id="2975353">string</span><span class="op" id="2975359">)</span>&nbsp;<span class="builtintype" id="2975361">bool</span><span class="op" id="2975365">)</span>&nbsp;<span class="builtintype" id="2975367">bool</span>&nbsp;<span class="op" id="2975372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975375">return</span>&nbsp;<span class="ident" id="2975382">f</span><span class="op" id="2975383">(</span><span class="op" id="2975384">&amp;</span><span class="ident" id="2975385">q</span><span class="op" id="2975386">.</span><span class="ident" id="2975387">Name</span><span class="op" id="2975391">,</span>&nbsp;<span class="string" id="2975393">&#34;Name&#34;</span><span class="op" id="2975399">,</span>&nbsp;<span class="string" id="2975401">&#34;domain&#34;</span><span class="op" id="2975409">)</span>&nbsp;<span class="op" id="2975411">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975416">f</span><span class="op" id="2975417">(</span><span class="op" id="2975418">&amp;</span><span class="ident" id="2975419">q</span><span class="op" id="2975420">.</span><span class="ident" id="2975421">Qtype</span><span class="op" id="2975426">,</span>&nbsp;<span class="string" id="2975428">&#34;Qtype&#34;</span><span class="op" id="2975435">,</span>&nbsp;<span class="string" id="2975437">&#34;&#34;</span><span class="op" id="2975439">)</span>&nbsp;<span class="op" id="2975441">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975446">f</span><span class="op" id="2975447">(</span><span class="op" id="2975448">&amp;</span><span class="ident" id="2975449">q</span><span class="op" id="2975450">.</span><span class="ident" id="2975451">Qclass</span><span class="op" id="2975457">,</span>&nbsp;<span class="string" id="2975459">&#34;Qclass&#34;</span><span class="op" id="2975467">,</span>&nbsp;<span class="string" id="2975469">&#34;&#34;</span><span class="op" id="2975471">)</span><br>
<span class="lineno"></span><span class="op" id="2975473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2975476">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="2975513">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="2975550">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="2975589">type</span>&nbsp;<span class="ident" id="2975594">dnsRR_Header</span>&nbsp;<span class="keyword" id="2975607">struct</span>&nbsp;<span class="op" id="2975614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975617">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2975626">string</span>&nbsp;<span class="string" id="2975633">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975654">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2975663">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975671">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2975680">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975688">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2975697">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975705">Rdlength</span>&nbsp;<span class="builtintype" id="2975714">uint16</span>&nbsp;<span class="comment" id="2975721">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="2975752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2975755">func</span>&nbsp;<span class="op" id="2975760">(</span><span class="ident" id="2975761">h</span>&nbsp;<span class="op" id="2975763">*</span><span class="ident" id="2975764">dnsRR_Header</span><span class="op" id="2975776">)</span>&nbsp;<span class="ident" id="2975778">Header</span><span class="op" id="2975784">(</span><span class="op" id="2975785">)</span>&nbsp;<span class="op" id="2975787">*</span><span class="ident" id="2975788">dnsRR_Header</span>&nbsp;<span class="op" id="2975801">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975804">return</span>&nbsp;<span class="ident" id="2975811">h</span><br>
<span class="lineno"></span><span class="op" id="2975813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2975816">func</span>&nbsp;<span class="op" id="2975821">(</span><span class="ident" id="2975822">h</span>&nbsp;<span class="op" id="2975824">*</span><span class="ident" id="2975825">dnsRR_Header</span><span class="op" id="2975837">)</span>&nbsp;<span class="ident" id="2975839">Walk</span><span class="op" id="2975843">(</span><span class="ident" id="2975844">f</span>&nbsp;<span class="keyword" id="2975846">func</span><span class="op" id="2975850">(</span><span class="ident" id="2975851">v</span>&nbsp;<span class="keyword" id="2975853">interface</span><span class="op" id="2975862">{</span><span class="op" id="2975863">}</span><span class="op" id="2975864">,</span>&nbsp;<span class="ident" id="2975866">name</span><span class="op" id="2975870">,</span>&nbsp;<span class="ident" id="2975872">tag</span>&nbsp;<span class="builtintype" id="2975876">string</span><span class="op" id="2975882">)</span>&nbsp;<span class="builtintype" id="2975884">bool</span><span class="op" id="2975888">)</span>&nbsp;<span class="builtintype" id="2975890">bool</span>&nbsp;<span class="op" id="2975895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975898">return</span>&nbsp;<span class="ident" id="2975905">f</span><span class="op" id="2975906">(</span><span class="op" id="2975907">&amp;</span><span class="ident" id="2975908">h</span><span class="op" id="2975909">.</span><span class="ident" id="2975910">Name</span><span class="op" id="2975914">,</span>&nbsp;<span class="string" id="2975916">&#34;Name&#34;</span><span class="op" id="2975922">,</span>&nbsp;<span class="string" id="2975924">&#34;domain&#34;</span><span class="op" id="2975932">)</span>&nbsp;<span class="op" id="2975934">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975939">f</span><span class="op" id="2975940">(</span><span class="op" id="2975941">&amp;</span><span class="ident" id="2975942">h</span><span class="op" id="2975943">.</span><span class="ident" id="2975944">Rrtype</span><span class="op" id="2975950">,</span>&nbsp;<span class="string" id="2975952">&#34;Rrtype&#34;</span><span class="op" id="2975960">,</span>&nbsp;<span class="string" id="2975962">&#34;&#34;</span><span class="op" id="2975964">)</span>&nbsp;<span class="op" id="2975966">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975971">f</span><span class="op" id="2975972">(</span><span class="op" id="2975973">&amp;</span><span class="ident" id="2975974">h</span><span class="op" id="2975975">.</span><span class="ident" id="2975976">Class</span><span class="op" id="2975981">,</span>&nbsp;<span class="string" id="2975983">&#34;Class&#34;</span><span class="op" id="2975990">,</span>&nbsp;<span class="string" id="2975992">&#34;&#34;</span><span class="op" id="2975994">)</span>&nbsp;<span class="op" id="2975996">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976001">f</span><span class="op" id="2976002">(</span><span class="op" id="2976003">&amp;</span><span class="ident" id="2976004">h</span><span class="op" id="2976005">.</span><span class="ident" id="2976006">Ttl</span><span class="op" id="2976009">,</span>&nbsp;<span class="string" id="2976011">&#34;Ttl&#34;</span><span class="op" id="2976016">,</span>&nbsp;<span class="string" id="2976018">&#34;&#34;</span><span class="op" id="2976020">)</span>&nbsp;<span class="op" id="2976022">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976027">f</span><span class="op" id="2976028">(</span><span class="op" id="2976029">&amp;</span><span class="ident" id="2976030">h</span><span class="op" id="2976031">.</span><span class="ident" id="2976032">Rdlength</span><span class="op" id="2976040">,</span>&nbsp;<span class="string" id="2976042">&#34;Rdlength&#34;</span><span class="op" id="2976052">,</span>&nbsp;<span class="string" id="2976054">&#34;&#34;</span><span class="op" id="2976056">)</span><br>
<span class="lineno"></span><span class="op" id="2976058">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="2976061">type</span>&nbsp;<span class="ident" id="2976066">dnsRR</span>&nbsp;<span class="keyword" id="2976072">interface</span>&nbsp;<span class="op" id="2976082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976085">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976096">Header</span><span class="op" id="2976102">(</span><span class="op" id="2976103">)</span>&nbsp;<span class="op" id="2976105">*</span><span class="ident" id="2976106">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="2976119">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="2976122">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2976171">type</span>&nbsp;<span class="ident" id="2976176">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="2976188">struct</span>&nbsp;<span class="op" id="2976195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976198">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2976204">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976218">Cname</span>&nbsp;<span class="builtintype" id="2976224">string</span>&nbsp;<span class="string" id="2976231">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2976251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2976254">func</span>&nbsp;<span class="op" id="2976259">(</span><span class="ident" id="2976260">rr</span>&nbsp;<span class="op" id="2976263">*</span><span class="ident" id="2976264">dnsRR_CNAME</span><span class="op" id="2976275">)</span>&nbsp;<span class="ident" id="2976277">Header</span><span class="op" id="2976283">(</span><span class="op" id="2976284">)</span>&nbsp;<span class="op" id="2976286">*</span><span class="ident" id="2976287">dnsRR_Header</span>&nbsp;<span class="op" id="2976300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976303">return</span>&nbsp;<span class="op" id="2976310">&amp;</span><span class="ident" id="2976311">rr</span><span class="op" id="2976313">.</span><span class="ident" id="2976314">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="2976318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2976321">func</span>&nbsp;<span class="op" id="2976326">(</span><span class="ident" id="2976327">rr</span>&nbsp;<span class="op" id="2976330">*</span><span class="ident" id="2976331">dnsRR_CNAME</span><span class="op" id="2976342">)</span>&nbsp;<span class="ident" id="2976344">Walk</span><span class="op" id="2976348">(</span><span class="ident" id="2976349">f</span>&nbsp;<span class="keyword" id="2976351">func</span><span class="op" id="2976355">(</span><span class="ident" id="2976356">v</span>&nbsp;<span class="keyword" id="2976358">interface</span><span class="op" id="2976367">{</span><span class="op" id="2976368">}</span><span class="op" id="2976369">,</span>&nbsp;<span class="ident" id="2976371">name</span><span class="op" id="2976375">,</span>&nbsp;<span class="ident" id="2976377">tag</span>&nbsp;<span class="builtintype" id="2976381">string</span><span class="op" id="2976387">)</span>&nbsp;<span class="builtintype" id="2976389">bool</span><span class="op" id="2976393">)</span>&nbsp;<span class="builtintype" id="2976395">bool</span>&nbsp;<span class="op" id="2976400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976403">return</span>&nbsp;<span class="ident" id="2976410">rr</span><span class="op" id="2976412">.</span><span class="ident" id="2976413">Hdr</span><span class="op" id="2976416">.</span><span class="ident" id="2976417">Walk</span><span class="op" id="2976421">(</span><span class="ident" id="2976422">f</span><span class="op" id="2976423">)</span>&nbsp;<span class="op" id="2976425">&amp;&amp;</span>&nbsp;<span class="ident" id="2976428">f</span><span class="op" id="2976429">(</span><span class="op" id="2976430">&amp;</span><span class="ident" id="2976431">rr</span><span class="op" id="2976433">.</span><span class="ident" id="2976434">Cname</span><span class="op" id="2976439">,</span>&nbsp;<span class="string" id="2976441">&#34;Cname&#34;</span><span class="op" id="2976448">,</span>&nbsp;<span class="string" id="2976450">&#34;domain&#34;</span><span class="op" id="2976458">)</span><br>
<span class="lineno"></span><span class="op" id="2976460">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="2976463">type</span>&nbsp;<span class="ident" id="2976468">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="2976480">struct</span>&nbsp;<span class="op" id="2976487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976490">Hdr</span>&nbsp;<span class="ident" id="2976494">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976508">Cpu</span>&nbsp;<span class="builtintype" id="2976512">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976520">Os</span>&nbsp;&nbsp;<span class="builtintype" id="2976524">string</span><br>
<span class="lineno">170</span><span class="op" id="2976531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2976534">func</span>&nbsp;<span class="op" id="2976539">(</span><span class="ident" id="2976540">rr</span>&nbsp;<span class="op" id="2976543">*</span><span class="ident" id="2976544">dnsRR_HINFO</span><span class="op" id="2976555">)</span>&nbsp;<span class="ident" id="2976557">Header</span><span class="op" id="2976563">(</span><span class="op" id="2976564">)</span>&nbsp;<span class="op" id="2976566">*</span><span class="ident" id="2976567">dnsRR_Header</span>&nbsp;<span class="op" id="2976580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976583">return</span>&nbsp;<span class="op" id="2976590">&amp;</span><span class="ident" id="2976591">rr</span><span class="op" id="2976593">.</span><span class="ident" id="2976594">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2976598">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2976601">func</span>&nbsp;<span class="op" id="2976606">(</span><span class="ident" id="2976607">rr</span>&nbsp;<span class="op" id="2976610">*</span><span class="ident" id="2976611">dnsRR_HINFO</span><span class="op" id="2976622">)</span>&nbsp;<span class="ident" id="2976624">Walk</span><span class="op" id="2976628">(</span><span class="ident" id="2976629">f</span>&nbsp;<span class="keyword" id="2976631">func</span><span class="op" id="2976635">(</span><span class="ident" id="2976636">v</span>&nbsp;<span class="keyword" id="2976638">interface</span><span class="op" id="2976647">{</span><span class="op" id="2976648">}</span><span class="op" id="2976649">,</span>&nbsp;<span class="ident" id="2976651">name</span><span class="op" id="2976655">,</span>&nbsp;<span class="ident" id="2976657">tag</span>&nbsp;<span class="builtintype" id="2976661">string</span><span class="op" id="2976667">)</span>&nbsp;<span class="builtintype" id="2976669">bool</span><span class="op" id="2976673">)</span>&nbsp;<span class="builtintype" id="2976675">bool</span>&nbsp;<span class="op" id="2976680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976683">return</span>&nbsp;<span class="ident" id="2976690">rr</span><span class="op" id="2976692">.</span><span class="ident" id="2976693">Hdr</span><span class="op" id="2976696">.</span><span class="ident" id="2976697">Walk</span><span class="op" id="2976701">(</span><span class="ident" id="2976702">f</span><span class="op" id="2976703">)</span>&nbsp;<span class="op" id="2976705">&amp;&amp;</span>&nbsp;<span class="ident" id="2976708">f</span><span class="op" id="2976709">(</span><span class="op" id="2976710">&amp;</span><span class="ident" id="2976711">rr</span><span class="op" id="2976713">.</span><span class="ident" id="2976714">Cpu</span><span class="op" id="2976717">,</span>&nbsp;<span class="string" id="2976719">&#34;Cpu&#34;</span><span class="op" id="2976724">,</span>&nbsp;<span class="string" id="2976726">&#34;&#34;</span><span class="op" id="2976728">)</span>&nbsp;<span class="op" id="2976730">&amp;&amp;</span>&nbsp;<span class="ident" id="2976733">f</span><span class="op" id="2976734">(</span><span class="op" id="2976735">&amp;</span><span class="ident" id="2976736">rr</span><span class="op" id="2976738">.</span><span class="ident" id="2976739">Os</span><span class="op" id="2976741">,</span>&nbsp;<span class="string" id="2976743">&#34;Os&#34;</span><span class="op" id="2976747">,</span>&nbsp;<span class="string" id="2976749">&#34;&#34;</span><span class="op" id="2976751">)</span><br>
<span class="lineno"></span><span class="op" id="2976753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="2976756">type</span>&nbsp;<span class="ident" id="2976761">dnsRR_MB</span>&nbsp;<span class="keyword" id="2976770">struct</span>&nbsp;<span class="op" id="2976777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976780">Hdr</span>&nbsp;<span class="ident" id="2976784">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976798">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="2976802">string</span>&nbsp;<span class="string" id="2976809">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2976829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="2976832">func</span>&nbsp;<span class="op" id="2976837">(</span><span class="ident" id="2976838">rr</span>&nbsp;<span class="op" id="2976841">*</span><span class="ident" id="2976842">dnsRR_MB</span><span class="op" id="2976850">)</span>&nbsp;<span class="ident" id="2976852">Header</span><span class="op" id="2976858">(</span><span class="op" id="2976859">)</span>&nbsp;<span class="op" id="2976861">*</span><span class="ident" id="2976862">dnsRR_Header</span>&nbsp;<span class="op" id="2976875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976878">return</span>&nbsp;<span class="op" id="2976885">&amp;</span><span class="ident" id="2976886">rr</span><span class="op" id="2976888">.</span><span class="ident" id="2976889">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2976893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2976896">func</span>&nbsp;<span class="op" id="2976901">(</span><span class="ident" id="2976902">rr</span>&nbsp;<span class="op" id="2976905">*</span><span class="ident" id="2976906">dnsRR_MB</span><span class="op" id="2976914">)</span>&nbsp;<span class="ident" id="2976916">Walk</span><span class="op" id="2976920">(</span><span class="ident" id="2976921">f</span>&nbsp;<span class="keyword" id="2976923">func</span><span class="op" id="2976927">(</span><span class="ident" id="2976928">v</span>&nbsp;<span class="keyword" id="2976930">interface</span><span class="op" id="2976939">{</span><span class="op" id="2976940">}</span><span class="op" id="2976941">,</span>&nbsp;<span class="ident" id="2976943">name</span><span class="op" id="2976947">,</span>&nbsp;<span class="ident" id="2976949">tag</span>&nbsp;<span class="builtintype" id="2976953">string</span><span class="op" id="2976959">)</span>&nbsp;<span class="builtintype" id="2976961">bool</span><span class="op" id="2976965">)</span>&nbsp;<span class="builtintype" id="2976967">bool</span>&nbsp;<span class="op" id="2976972">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976975">return</span>&nbsp;<span class="ident" id="2976982">rr</span><span class="op" id="2976984">.</span><span class="ident" id="2976985">Hdr</span><span class="op" id="2976988">.</span><span class="ident" id="2976989">Walk</span><span class="op" id="2976993">(</span><span class="ident" id="2976994">f</span><span class="op" id="2976995">)</span>&nbsp;<span class="op" id="2976997">&amp;&amp;</span>&nbsp;<span class="ident" id="2977000">f</span><span class="op" id="2977001">(</span><span class="op" id="2977002">&amp;</span><span class="ident" id="2977003">rr</span><span class="op" id="2977005">.</span><span class="ident" id="2977006">Mb</span><span class="op" id="2977008">,</span>&nbsp;<span class="string" id="2977010">&#34;Mb&#34;</span><span class="op" id="2977014">,</span>&nbsp;<span class="string" id="2977016">&#34;domain&#34;</span><span class="op" id="2977024">)</span><br>
<span class="lineno"></span><span class="op" id="2977026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977029">type</span>&nbsp;<span class="ident" id="2977034">dnsRR_MG</span>&nbsp;<span class="keyword" id="2977043">struct</span>&nbsp;<span class="op" id="2977050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977053">Hdr</span>&nbsp;<span class="ident" id="2977057">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977071">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="2977075">string</span>&nbsp;<span class="string" id="2977082">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2977102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977105">func</span>&nbsp;<span class="op" id="2977110">(</span><span class="ident" id="2977111">rr</span>&nbsp;<span class="op" id="2977114">*</span><span class="ident" id="2977115">dnsRR_MG</span><span class="op" id="2977123">)</span>&nbsp;<span class="ident" id="2977125">Header</span><span class="op" id="2977131">(</span><span class="op" id="2977132">)</span>&nbsp;<span class="op" id="2977134">*</span><span class="ident" id="2977135">dnsRR_Header</span>&nbsp;<span class="op" id="2977148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977151">return</span>&nbsp;<span class="op" id="2977158">&amp;</span><span class="ident" id="2977159">rr</span><span class="op" id="2977161">.</span><span class="ident" id="2977162">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="2977166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977169">func</span>&nbsp;<span class="op" id="2977174">(</span><span class="ident" id="2977175">rr</span>&nbsp;<span class="op" id="2977178">*</span><span class="ident" id="2977179">dnsRR_MG</span><span class="op" id="2977187">)</span>&nbsp;<span class="ident" id="2977189">Walk</span><span class="op" id="2977193">(</span><span class="ident" id="2977194">f</span>&nbsp;<span class="keyword" id="2977196">func</span><span class="op" id="2977200">(</span><span class="ident" id="2977201">v</span>&nbsp;<span class="keyword" id="2977203">interface</span><span class="op" id="2977212">{</span><span class="op" id="2977213">}</span><span class="op" id="2977214">,</span>&nbsp;<span class="ident" id="2977216">name</span><span class="op" id="2977220">,</span>&nbsp;<span class="ident" id="2977222">tag</span>&nbsp;<span class="builtintype" id="2977226">string</span><span class="op" id="2977232">)</span>&nbsp;<span class="builtintype" id="2977234">bool</span><span class="op" id="2977238">)</span>&nbsp;<span class="builtintype" id="2977240">bool</span>&nbsp;<span class="op" id="2977245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977248">return</span>&nbsp;<span class="ident" id="2977255">rr</span><span class="op" id="2977257">.</span><span class="ident" id="2977258">Hdr</span><span class="op" id="2977261">.</span><span class="ident" id="2977262">Walk</span><span class="op" id="2977266">(</span><span class="ident" id="2977267">f</span><span class="op" id="2977268">)</span>&nbsp;<span class="op" id="2977270">&amp;&amp;</span>&nbsp;<span class="ident" id="2977273">f</span><span class="op" id="2977274">(</span><span class="op" id="2977275">&amp;</span><span class="ident" id="2977276">rr</span><span class="op" id="2977278">.</span><span class="ident" id="2977279">Mg</span><span class="op" id="2977281">,</span>&nbsp;<span class="string" id="2977283">&#34;Mg&#34;</span><span class="op" id="2977287">,</span>&nbsp;<span class="string" id="2977289">&#34;domain&#34;</span><span class="op" id="2977297">)</span><br>
<span class="lineno"></span><span class="op" id="2977299">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2977302">type</span>&nbsp;<span class="ident" id="2977307">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="2977319">struct</span>&nbsp;<span class="op" id="2977326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977329">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2977335">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977349">Rmail</span>&nbsp;<span class="builtintype" id="2977355">string</span>&nbsp;<span class="string" id="2977362">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977383">Email</span>&nbsp;<span class="builtintype" id="2977389">string</span>&nbsp;<span class="string" id="2977396">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="2977416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977419">func</span>&nbsp;<span class="op" id="2977424">(</span><span class="ident" id="2977425">rr</span>&nbsp;<span class="op" id="2977428">*</span><span class="ident" id="2977429">dnsRR_MINFO</span><span class="op" id="2977440">)</span>&nbsp;<span class="ident" id="2977442">Header</span><span class="op" id="2977448">(</span><span class="op" id="2977449">)</span>&nbsp;<span class="op" id="2977451">*</span><span class="ident" id="2977452">dnsRR_Header</span>&nbsp;<span class="op" id="2977465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977468">return</span>&nbsp;<span class="op" id="2977475">&amp;</span><span class="ident" id="2977476">rr</span><span class="op" id="2977478">.</span><span class="ident" id="2977479">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2977483">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="2977486">func</span>&nbsp;<span class="op" id="2977491">(</span><span class="ident" id="2977492">rr</span>&nbsp;<span class="op" id="2977495">*</span><span class="ident" id="2977496">dnsRR_MINFO</span><span class="op" id="2977507">)</span>&nbsp;<span class="ident" id="2977509">Walk</span><span class="op" id="2977513">(</span><span class="ident" id="2977514">f</span>&nbsp;<span class="keyword" id="2977516">func</span><span class="op" id="2977520">(</span><span class="ident" id="2977521">v</span>&nbsp;<span class="keyword" id="2977523">interface</span><span class="op" id="2977532">{</span><span class="op" id="2977533">}</span><span class="op" id="2977534">,</span>&nbsp;<span class="ident" id="2977536">name</span><span class="op" id="2977540">,</span>&nbsp;<span class="ident" id="2977542">tag</span>&nbsp;<span class="builtintype" id="2977546">string</span><span class="op" id="2977552">)</span>&nbsp;<span class="builtintype" id="2977554">bool</span><span class="op" id="2977558">)</span>&nbsp;<span class="builtintype" id="2977560">bool</span>&nbsp;<span class="op" id="2977565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977568">return</span>&nbsp;<span class="ident" id="2977575">rr</span><span class="op" id="2977577">.</span><span class="ident" id="2977578">Hdr</span><span class="op" id="2977581">.</span><span class="ident" id="2977582">Walk</span><span class="op" id="2977586">(</span><span class="ident" id="2977587">f</span><span class="op" id="2977588">)</span>&nbsp;<span class="op" id="2977590">&amp;&amp;</span>&nbsp;<span class="ident" id="2977593">f</span><span class="op" id="2977594">(</span><span class="op" id="2977595">&amp;</span><span class="ident" id="2977596">rr</span><span class="op" id="2977598">.</span><span class="ident" id="2977599">Rmail</span><span class="op" id="2977604">,</span>&nbsp;<span class="string" id="2977606">&#34;Rmail&#34;</span><span class="op" id="2977613">,</span>&nbsp;<span class="string" id="2977615">&#34;domain&#34;</span><span class="op" id="2977623">)</span>&nbsp;<span class="op" id="2977625">&amp;&amp;</span>&nbsp;<span class="ident" id="2977628">f</span><span class="op" id="2977629">(</span><span class="op" id="2977630">&amp;</span><span class="ident" id="2977631">rr</span><span class="op" id="2977633">.</span><span class="ident" id="2977634">Email</span><span class="op" id="2977639">,</span>&nbsp;<span class="string" id="2977641">&#34;Email&#34;</span><span class="op" id="2977648">,</span>&nbsp;<span class="string" id="2977650">&#34;domain&#34;</span><span class="op" id="2977658">)</span><br>
<span class="lineno"></span><span class="op" id="2977660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="2977663">type</span>&nbsp;<span class="ident" id="2977668">dnsRR_MR</span>&nbsp;<span class="keyword" id="2977677">struct</span>&nbsp;<span class="op" id="2977684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977687">Hdr</span>&nbsp;<span class="ident" id="2977691">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977705">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="2977709">string</span>&nbsp;<span class="string" id="2977716">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2977736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="2977739">func</span>&nbsp;<span class="op" id="2977744">(</span><span class="ident" id="2977745">rr</span>&nbsp;<span class="op" id="2977748">*</span><span class="ident" id="2977749">dnsRR_MR</span><span class="op" id="2977757">)</span>&nbsp;<span class="ident" id="2977759">Header</span><span class="op" id="2977765">(</span><span class="op" id="2977766">)</span>&nbsp;<span class="op" id="2977768">*</span><span class="ident" id="2977769">dnsRR_Header</span>&nbsp;<span class="op" id="2977782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977785">return</span>&nbsp;<span class="op" id="2977792">&amp;</span><span class="ident" id="2977793">rr</span><span class="op" id="2977795">.</span><span class="ident" id="2977796">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2977800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977803">func</span>&nbsp;<span class="op" id="2977808">(</span><span class="ident" id="2977809">rr</span>&nbsp;<span class="op" id="2977812">*</span><span class="ident" id="2977813">dnsRR_MR</span><span class="op" id="2977821">)</span>&nbsp;<span class="ident" id="2977823">Walk</span><span class="op" id="2977827">(</span><span class="ident" id="2977828">f</span>&nbsp;<span class="keyword" id="2977830">func</span><span class="op" id="2977834">(</span><span class="ident" id="2977835">v</span>&nbsp;<span class="keyword" id="2977837">interface</span><span class="op" id="2977846">{</span><span class="op" id="2977847">}</span><span class="op" id="2977848">,</span>&nbsp;<span class="ident" id="2977850">name</span><span class="op" id="2977854">,</span>&nbsp;<span class="ident" id="2977856">tag</span>&nbsp;<span class="builtintype" id="2977860">string</span><span class="op" id="2977866">)</span>&nbsp;<span class="builtintype" id="2977868">bool</span><span class="op" id="2977872">)</span>&nbsp;<span class="builtintype" id="2977874">bool</span>&nbsp;<span class="op" id="2977879">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977882">return</span>&nbsp;<span class="ident" id="2977889">rr</span><span class="op" id="2977891">.</span><span class="ident" id="2977892">Hdr</span><span class="op" id="2977895">.</span><span class="ident" id="2977896">Walk</span><span class="op" id="2977900">(</span><span class="ident" id="2977901">f</span><span class="op" id="2977902">)</span>&nbsp;<span class="op" id="2977904">&amp;&amp;</span>&nbsp;<span class="ident" id="2977907">f</span><span class="op" id="2977908">(</span><span class="op" id="2977909">&amp;</span><span class="ident" id="2977910">rr</span><span class="op" id="2977912">.</span><span class="ident" id="2977913">Mr</span><span class="op" id="2977915">,</span>&nbsp;<span class="string" id="2977917">&#34;Mr&#34;</span><span class="op" id="2977921">,</span>&nbsp;<span class="string" id="2977923">&#34;domain&#34;</span><span class="op" id="2977931">)</span><br>
<span class="lineno"></span><span class="op" id="2977933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977936">type</span>&nbsp;<span class="ident" id="2977941">dnsRR_MX</span>&nbsp;<span class="keyword" id="2977950">struct</span>&nbsp;<span class="op" id="2977957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977960">Hdr</span>&nbsp;&nbsp;<span class="ident" id="2977965">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977979">Pref</span>&nbsp;<span class="builtintype" id="2977984">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977992">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2977997">string</span>&nbsp;<span class="string" id="2978004">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2978024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2978027">func</span>&nbsp;<span class="op" id="2978032">(</span><span class="ident" id="2978033">rr</span>&nbsp;<span class="op" id="2978036">*</span><span class="ident" id="2978037">dnsRR_MX</span><span class="op" id="2978045">)</span>&nbsp;<span class="ident" id="2978047">Header</span><span class="op" id="2978053">(</span><span class="op" id="2978054">)</span>&nbsp;<span class="op" id="2978056">*</span><span class="ident" id="2978057">dnsRR_Header</span>&nbsp;<span class="op" id="2978070">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2978073">return</span>&nbsp;<span class="op" id="2978080">&amp;</span><span class="ident" id="2978081">rr</span><span class="op" id="2978083">.</span><span class="ident" id="2978084">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2978088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2978091">func</span>&nbsp;<span class="op" id="2978096">(</span><span class="ident" id="2978097">rr</span>&nbsp;<span class="op" id="2978100">*</span><span class="ident" id="2978101">dnsRR_MX</span><span class="op" id="2978109">)</span>&nbsp;<span class="ident" id="2978111">Walk</span><span class="op" id="2978115">(</span><span class="ident" id="2978116">f</span>&nbsp;<span class="keyword" id="2978118">func</span><span class="op" id="2978122">(</span><span class="ident" id="2978123">v</span>&nbsp;<span class="keyword" id="2978125">interface</span><span class="op" id="2978134">{</span><span class="op" id="2978135">}</span><span class="op" id="2978136">,</span>&nbsp;<span class="ident" id="2978138">name</span><span class="op" id="2978142">,</span>&nbsp;<span class="ident" id="2978144">tag</span>&nbsp;<span class="builtintype" id="2978148">string</span><span class="op" id="2978154">)</span>&nbsp;<span class="builtintype" id="2978156">bool</span><span class="op" id="2978160">)</span>&nbsp;<span class="builtintype" id="2978162">bool</span>&nbsp;<span class="op" id="2978167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2978170">return</span>&nbsp;<span class="ident" id="2978177">rr</span><span class="op" id="2978179">.</span><span class="ident" id="2978180">Hdr</span><span class="op" id="2978183">.</span><span class="ident" id="2978184">Walk</span><span class="op" id="2978188">(</span><span class="ident" id="2978189">f</span><span class="op" id="2978190">)</span>&nbsp;<span class="op" id="2978192">&amp;&amp;</span>&nbsp;<span class="ident" id="2978195">f</span><span class="op" id="2978196">(</span><span class="op" id="2978197">&amp;</span><span class="ident" id="2978198">rr</span><span class="op" id="2978200">.</span><span class="ident" id="2978201">Pref</span><span class="op" id="2978205">,</span>&nbsp;<span class="string" id="2978207">&#34;Pref&#34;</span><span class="op" id="2978213">,</span>&nbsp;<span class="string" id="2978215">&#34;&#34;</span><span class="op" id="2978217">)</span>&nbsp;<span class="op" id="2978219">&amp;&amp;</span>&nbsp;<span class="ident" id="2978222">f</span><span class="op" id="2978223">(</span><span class="op" id="2978224">&amp;</span><span class="ident" id="2978225">rr</span><span class="op" id="2978227">.</span><span class="ident" id="2978228">Mx</span><span class="op" id="2978230">,</span>&nbsp;<span class="string" id="2978232">&#34;Mx&#34;</span><span class="op" id="2978236">,</span>&nbsp;<span class="string" id="2978238">&#34;domain&#34;</span><span class="op" id="2978246">)</span><br>
<span class="lineno">245</span><span class="op" id="2978248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2978251">type</span>&nbsp;<span class="ident" id="2978256">dnsRR_NS</span>&nbsp;<span class="keyword" id="2978265">struct</span>&nbsp;<span class="op" id="2978272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978275">Hdr</span>&nbsp;<span class="ident" id="2978279">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978293">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="2978297">string</span>&nbsp;<span class="string" id="2978304">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="2978324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2978327">func</span>&nbsp;<span class="op" id="2978332">(</span><span class="ident" id="2978333">rr</span>&nbsp;<span class="op" id="2978336">*</span><span class="ident" id="2978337">dnsRR_NS</span><span class="op" id="2978345">)</span>&nbsp;<span class="ident" id="2978347">Header</span><span class="op" id="2978353">(</span><span class="op" id="2978354">)</span>&nbsp;<span class="op" id="2978356">*</span><span class="ident" id="2978357">dnsRR_Header</span>&nbsp;<span class="op" id="2978370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2978373">return</span>&nbsp;<span class="op" id="2978380">&amp;</span><span class="ident" id="2978381">rr</span><span class="op" id="2978383">.</span><span class="ident" id="2978384">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2978388">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="2978391">func</span>&nbsp;<span class="op" id="2978396">(</span><span class="ident" id="2978397">rr</span>&nbsp;<span class="op" id="2978400">*</span><span class="ident" id="2978401">dnsRR_NS</span><span class="op" id="2978409">)</span>&nbsp;<span class="ident" id="2978411">Walk</span><span class="op" id="2978415">(</span><span class="ident" id="2978416">f</span>&nbsp;<span class="keyword" id="2978418">func</span><span class="op" id="2978422">(</span><span class="ident" id="2978423">v</span>&nbsp;<span class="keyword" id="2978425">interface</span><span class="op" id="2978434">{</span><span class="op" id="2978435">}</span><span class="op" id="2978436">,</span>&nbsp;<span class="ident" id="2978438">name</span><span class="op" id="2978442">,</span>&nbsp;<span class="ident" id="2978444">tag</span>&nbsp;<span class="builtintype" id="2978448">string</span><span class="op" id="2978454">)</span>&nbsp;<span class="builtintype" id="2978456">bool</span><span class="op" id="2978460">)</span>&nbsp;<span class="builtintype" id="2978462">bool</span>&nbsp;<span class="op" id="2978467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2978470">return</span>&nbsp;<span class="ident" id="2978477">rr</span><span class="op" id="2978479">.</span><span class="ident" id="2978480">Hdr</span><span class="op" id="2978483">.</span><span class="ident" id="2978484">Walk</span><span class="op" id="2978488">(</span><span class="ident" id="2978489">f</span><span class="op" id="2978490">)</span>&nbsp;<span class="op" id="2978492">&amp;&amp;</span>&nbsp;<span class="ident" id="2978495">f</span><span class="op" id="2978496">(</span><span class="op" id="2978497">&amp;</span><span class="ident" id="2978498">rr</span><span class="op" id="2978500">.</span><span class="ident" id="2978501">Ns</span><span class="op" id="2978503">,</span>&nbsp;<span class="string" id="2978505">&#34;Ns&#34;</span><span class="op" id="2978509">,</span>&nbsp;<span class="string" id="2978511">&#34;domain&#34;</span><span class="op" id="2978519">)</span><br>
<span class="lineno"></span><span class="op" id="2978521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="2978524">type</span>&nbsp;<span class="ident" id="2978529">dnsRR_PTR</span>&nbsp;<span class="keyword" id="2978539">struct</span>&nbsp;<span class="op" id="2978546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978549">Hdr</span>&nbsp;<span class="ident" id="2978553">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978567">Ptr</span>&nbsp;<span class="builtintype" id="2978571">string</span>&nbsp;<span class="string" id="2978578">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2978598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="2978601">func</span>&nbsp;<span class="op" id="2978606">(</span><span class="ident" id="2978607">rr</span>&nbsp;<span class="op" id="2978610">*</span><span class="ident" id="2978611">dnsRR_PTR</span><span class="op" id="2978620">)</span>&nbsp;<span class="ident" id="2978622">Header</span><span class="op" id="2978628">(</span><span class="op" id="2978629">)</span>&nbsp;<span class="op" id="2978631">*</span><span class="ident" id="2978632">dnsRR_Header</span>&nbsp;<span class="op" id="2978645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2978648">return</span>&nbsp;<span class="op" id="2978655">&amp;</span><span class="ident" id="2978656">rr</span><span class="op" id="2978658">.</span><span class="ident" id="2978659">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2978663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2978666">func</span>&nbsp;<span class="op" id="2978671">(</span><span class="ident" id="2978672">rr</span>&nbsp;<span class="op" id="2978675">*</span><span class="ident" id="2978676">dnsRR_PTR</span><span class="op" id="2978685">)</span>&nbsp;<span class="ident" id="2978687">Walk</span><span class="op" id="2978691">(</span><span class="ident" id="2978692">f</span>&nbsp;<span class="keyword" id="2978694">func</span><span class="op" id="2978698">(</span><span class="ident" id="2978699">v</span>&nbsp;<span class="keyword" id="2978701">interface</span><span class="op" id="2978710">{</span><span class="op" id="2978711">}</span><span class="op" id="2978712">,</span>&nbsp;<span class="ident" id="2978714">name</span><span class="op" id="2978718">,</span>&nbsp;<span class="ident" id="2978720">tag</span>&nbsp;<span class="builtintype" id="2978724">string</span><span class="op" id="2978730">)</span>&nbsp;<span class="builtintype" id="2978732">bool</span><span class="op" id="2978736">)</span>&nbsp;<span class="builtintype" id="2978738">bool</span>&nbsp;<span class="op" id="2978743">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2978746">return</span>&nbsp;<span class="ident" id="2978753">rr</span><span class="op" id="2978755">.</span><span class="ident" id="2978756">Hdr</span><span class="op" id="2978759">.</span><span class="ident" id="2978760">Walk</span><span class="op" id="2978764">(</span><span class="ident" id="2978765">f</span><span class="op" id="2978766">)</span>&nbsp;<span class="op" id="2978768">&amp;&amp;</span>&nbsp;<span class="ident" id="2978771">f</span><span class="op" id="2978772">(</span><span class="op" id="2978773">&amp;</span><span class="ident" id="2978774">rr</span><span class="op" id="2978776">.</span><span class="ident" id="2978777">Ptr</span><span class="op" id="2978780">,</span>&nbsp;<span class="string" id="2978782">&#34;Ptr&#34;</span><span class="op" id="2978787">,</span>&nbsp;<span class="string" id="2978789">&#34;domain&#34;</span><span class="op" id="2978797">)</span><br>
<span class="lineno"></span><span class="op" id="2978799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2978802">type</span>&nbsp;<span class="ident" id="2978807">dnsRR_SOA</span>&nbsp;<span class="keyword" id="2978817">struct</span>&nbsp;<span class="op" id="2978824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978827">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978835">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978849">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2978857">string</span>&nbsp;<span class="string" id="2978864">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978885">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2978893">string</span>&nbsp;<span class="string" id="2978900">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978921">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="2978929">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978937">Refresh</span>&nbsp;<span class="builtintype" id="2978945">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978953">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2978961">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978969">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="2978977">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2978985">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="2978993">uint32</span><br>
<span class="lineno"></span><span class="op" id="2979000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979003">func</span>&nbsp;<span class="op" id="2979008">(</span><span class="ident" id="2979009">rr</span>&nbsp;<span class="op" id="2979012">*</span><span class="ident" id="2979013">dnsRR_SOA</span><span class="op" id="2979022">)</span>&nbsp;<span class="ident" id="2979024">Header</span><span class="op" id="2979030">(</span><span class="op" id="2979031">)</span>&nbsp;<span class="op" id="2979033">*</span><span class="ident" id="2979034">dnsRR_Header</span>&nbsp;<span class="op" id="2979047">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2979050">return</span>&nbsp;<span class="op" id="2979057">&amp;</span><span class="ident" id="2979058">rr</span><span class="op" id="2979060">.</span><span class="ident" id="2979061">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2979065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979068">func</span>&nbsp;<span class="op" id="2979073">(</span><span class="ident" id="2979074">rr</span>&nbsp;<span class="op" id="2979077">*</span><span class="ident" id="2979078">dnsRR_SOA</span><span class="op" id="2979087">)</span>&nbsp;<span class="ident" id="2979089">Walk</span><span class="op" id="2979093">(</span><span class="ident" id="2979094">f</span>&nbsp;<span class="keyword" id="2979096">func</span><span class="op" id="2979100">(</span><span class="ident" id="2979101">v</span>&nbsp;<span class="keyword" id="2979103">interface</span><span class="op" id="2979112">{</span><span class="op" id="2979113">}</span><span class="op" id="2979114">,</span>&nbsp;<span class="ident" id="2979116">name</span><span class="op" id="2979120">,</span>&nbsp;<span class="ident" id="2979122">tag</span>&nbsp;<span class="builtintype" id="2979126">string</span><span class="op" id="2979132">)</span>&nbsp;<span class="builtintype" id="2979134">bool</span><span class="op" id="2979138">)</span>&nbsp;<span class="builtintype" id="2979140">bool</span>&nbsp;<span class="op" id="2979145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2979148">return</span>&nbsp;<span class="ident" id="2979155">rr</span><span class="op" id="2979157">.</span><span class="ident" id="2979158">Hdr</span><span class="op" id="2979161">.</span><span class="ident" id="2979162">Walk</span><span class="op" id="2979166">(</span><span class="ident" id="2979167">f</span><span class="op" id="2979168">)</span>&nbsp;<span class="op" id="2979170">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979175">f</span><span class="op" id="2979176">(</span><span class="op" id="2979177">&amp;</span><span class="ident" id="2979178">rr</span><span class="op" id="2979180">.</span><span class="ident" id="2979181">Ns</span><span class="op" id="2979183">,</span>&nbsp;<span class="string" id="2979185">&#34;Ns&#34;</span><span class="op" id="2979189">,</span>&nbsp;<span class="string" id="2979191">&#34;domain&#34;</span><span class="op" id="2979199">)</span>&nbsp;<span class="op" id="2979201">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979206">f</span><span class="op" id="2979207">(</span><span class="op" id="2979208">&amp;</span><span class="ident" id="2979209">rr</span><span class="op" id="2979211">.</span><span class="ident" id="2979212">Mbox</span><span class="op" id="2979216">,</span>&nbsp;<span class="string" id="2979218">&#34;Mbox&#34;</span><span class="op" id="2979224">,</span>&nbsp;<span class="string" id="2979226">&#34;domain&#34;</span><span class="op" id="2979234">)</span>&nbsp;<span class="op" id="2979236">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979241">f</span><span class="op" id="2979242">(</span><span class="op" id="2979243">&amp;</span><span class="ident" id="2979244">rr</span><span class="op" id="2979246">.</span><span class="ident" id="2979247">Serial</span><span class="op" id="2979253">,</span>&nbsp;<span class="string" id="2979255">&#34;Serial&#34;</span><span class="op" id="2979263">,</span>&nbsp;<span class="string" id="2979265">&#34;&#34;</span><span class="op" id="2979267">)</span>&nbsp;<span class="op" id="2979269">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979274">f</span><span class="op" id="2979275">(</span><span class="op" id="2979276">&amp;</span><span class="ident" id="2979277">rr</span><span class="op" id="2979279">.</span><span class="ident" id="2979280">Refresh</span><span class="op" id="2979287">,</span>&nbsp;<span class="string" id="2979289">&#34;Refresh&#34;</span><span class="op" id="2979298">,</span>&nbsp;<span class="string" id="2979300">&#34;&#34;</span><span class="op" id="2979302">)</span>&nbsp;<span class="op" id="2979304">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979309">f</span><span class="op" id="2979310">(</span><span class="op" id="2979311">&amp;</span><span class="ident" id="2979312">rr</span><span class="op" id="2979314">.</span><span class="ident" id="2979315">Retry</span><span class="op" id="2979320">,</span>&nbsp;<span class="string" id="2979322">&#34;Retry&#34;</span><span class="op" id="2979329">,</span>&nbsp;<span class="string" id="2979331">&#34;&#34;</span><span class="op" id="2979333">)</span>&nbsp;<span class="op" id="2979335">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979340">f</span><span class="op" id="2979341">(</span><span class="op" id="2979342">&amp;</span><span class="ident" id="2979343">rr</span><span class="op" id="2979345">.</span><span class="ident" id="2979346">Expire</span><span class="op" id="2979352">,</span>&nbsp;<span class="string" id="2979354">&#34;Expire&#34;</span><span class="op" id="2979362">,</span>&nbsp;<span class="string" id="2979364">&#34;&#34;</span><span class="op" id="2979366">)</span>&nbsp;<span class="op" id="2979368">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979373">f</span><span class="op" id="2979374">(</span><span class="op" id="2979375">&amp;</span><span class="ident" id="2979376">rr</span><span class="op" id="2979378">.</span><span class="ident" id="2979379">Minttl</span><span class="op" id="2979385">,</span>&nbsp;<span class="string" id="2979387">&#34;Minttl&#34;</span><span class="op" id="2979395">,</span>&nbsp;<span class="string" id="2979397">&#34;&#34;</span><span class="op" id="2979399">)</span><br>
<span class="lineno"></span><span class="op" id="2979401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979404">type</span>&nbsp;<span class="ident" id="2979409">dnsRR_TXT</span>&nbsp;<span class="keyword" id="2979419">struct</span>&nbsp;<span class="op" id="2979426">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979429">Hdr</span>&nbsp;<span class="ident" id="2979433">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979447">Txt</span>&nbsp;<span class="builtintype" id="2979451">string</span>&nbsp;<span class="comment" id="2979458">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="2979477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979480">func</span>&nbsp;<span class="op" id="2979485">(</span><span class="ident" id="2979486">rr</span>&nbsp;<span class="op" id="2979489">*</span><span class="ident" id="2979490">dnsRR_TXT</span><span class="op" id="2979499">)</span>&nbsp;<span class="ident" id="2979501">Header</span><span class="op" id="2979507">(</span><span class="op" id="2979508">)</span>&nbsp;<span class="op" id="2979510">*</span><span class="ident" id="2979511">dnsRR_Header</span>&nbsp;<span class="op" id="2979524">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2979527">return</span>&nbsp;<span class="op" id="2979534">&amp;</span><span class="ident" id="2979535">rr</span><span class="op" id="2979537">.</span><span class="ident" id="2979538">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2979542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979545">func</span>&nbsp;<span class="op" id="2979550">(</span><span class="ident" id="2979551">rr</span>&nbsp;<span class="op" id="2979554">*</span><span class="ident" id="2979555">dnsRR_TXT</span><span class="op" id="2979564">)</span>&nbsp;<span class="ident" id="2979566">Walk</span><span class="op" id="2979570">(</span><span class="ident" id="2979571">f</span>&nbsp;<span class="keyword" id="2979573">func</span><span class="op" id="2979577">(</span><span class="ident" id="2979578">v</span>&nbsp;<span class="keyword" id="2979580">interface</span><span class="op" id="2979589">{</span><span class="op" id="2979590">}</span><span class="op" id="2979591">,</span>&nbsp;<span class="ident" id="2979593">name</span><span class="op" id="2979597">,</span>&nbsp;<span class="ident" id="2979599">tag</span>&nbsp;<span class="builtintype" id="2979603">string</span><span class="op" id="2979609">)</span>&nbsp;<span class="builtintype" id="2979611">bool</span><span class="op" id="2979615">)</span>&nbsp;<span class="builtintype" id="2979617">bool</span>&nbsp;<span class="op" id="2979622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2979625">return</span>&nbsp;<span class="ident" id="2979632">rr</span><span class="op" id="2979634">.</span><span class="ident" id="2979635">Hdr</span><span class="op" id="2979638">.</span><span class="ident" id="2979639">Walk</span><span class="op" id="2979643">(</span><span class="ident" id="2979644">f</span><span class="op" id="2979645">)</span>&nbsp;<span class="op" id="2979647">&amp;&amp;</span>&nbsp;<span class="ident" id="2979650">f</span><span class="op" id="2979651">(</span><span class="op" id="2979652">&amp;</span><span class="ident" id="2979653">rr</span><span class="op" id="2979655">.</span><span class="ident" id="2979656">Txt</span><span class="op" id="2979659">,</span>&nbsp;<span class="string" id="2979661">&#34;Txt&#34;</span><span class="op" id="2979666">,</span>&nbsp;<span class="string" id="2979668">&#34;&#34;</span><span class="op" id="2979670">)</span><br>
<span class="lineno">310</span><span class="op" id="2979672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979675">type</span>&nbsp;<span class="ident" id="2979680">dnsRR_SRV</span>&nbsp;<span class="keyword" id="2979690">struct</span>&nbsp;<span class="op" id="2979697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979700">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979709">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979723">Priority</span>&nbsp;<span class="builtintype" id="2979732">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979740">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2979749">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979757">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2979766">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979774">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2979783">string</span>&nbsp;<span class="string" id="2979790">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2979810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="2979813">func</span>&nbsp;<span class="op" id="2979818">(</span><span class="ident" id="2979819">rr</span>&nbsp;<span class="op" id="2979822">*</span><span class="ident" id="2979823">dnsRR_SRV</span><span class="op" id="2979832">)</span>&nbsp;<span class="ident" id="2979834">Header</span><span class="op" id="2979840">(</span><span class="op" id="2979841">)</span>&nbsp;<span class="op" id="2979843">*</span><span class="ident" id="2979844">dnsRR_Header</span>&nbsp;<span class="op" id="2979857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2979860">return</span>&nbsp;<span class="op" id="2979867">&amp;</span><span class="ident" id="2979868">rr</span><span class="op" id="2979870">.</span><span class="ident" id="2979871">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2979875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979878">func</span>&nbsp;<span class="op" id="2979883">(</span><span class="ident" id="2979884">rr</span>&nbsp;<span class="op" id="2979887">*</span><span class="ident" id="2979888">dnsRR_SRV</span><span class="op" id="2979897">)</span>&nbsp;<span class="ident" id="2979899">Walk</span><span class="op" id="2979903">(</span><span class="ident" id="2979904">f</span>&nbsp;<span class="keyword" id="2979906">func</span><span class="op" id="2979910">(</span><span class="ident" id="2979911">v</span>&nbsp;<span class="keyword" id="2979913">interface</span><span class="op" id="2979922">{</span><span class="op" id="2979923">}</span><span class="op" id="2979924">,</span>&nbsp;<span class="ident" id="2979926">name</span><span class="op" id="2979930">,</span>&nbsp;<span class="ident" id="2979932">tag</span>&nbsp;<span class="builtintype" id="2979936">string</span><span class="op" id="2979942">)</span>&nbsp;<span class="builtintype" id="2979944">bool</span><span class="op" id="2979948">)</span>&nbsp;<span class="builtintype" id="2979950">bool</span>&nbsp;<span class="op" id="2979955">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2979958">return</span>&nbsp;<span class="ident" id="2979965">rr</span><span class="op" id="2979967">.</span><span class="ident" id="2979968">Hdr</span><span class="op" id="2979971">.</span><span class="ident" id="2979972">Walk</span><span class="op" id="2979976">(</span><span class="ident" id="2979977">f</span><span class="op" id="2979978">)</span>&nbsp;<span class="op" id="2979980">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2979985">f</span><span class="op" id="2979986">(</span><span class="op" id="2979987">&amp;</span><span class="ident" id="2979988">rr</span><span class="op" id="2979990">.</span><span class="ident" id="2979991">Priority</span><span class="op" id="2979999">,</span>&nbsp;<span class="string" id="2980001">&#34;Priority&#34;</span><span class="op" id="2980011">,</span>&nbsp;<span class="string" id="2980013">&#34;&#34;</span><span class="op" id="2980015">)</span>&nbsp;<span class="op" id="2980017">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2980022">f</span><span class="op" id="2980023">(</span><span class="op" id="2980024">&amp;</span><span class="ident" id="2980025">rr</span><span class="op" id="2980027">.</span><span class="ident" id="2980028">Weight</span><span class="op" id="2980034">,</span>&nbsp;<span class="string" id="2980036">&#34;Weight&#34;</span><span class="op" id="2980044">,</span>&nbsp;<span class="string" id="2980046">&#34;&#34;</span><span class="op" id="2980048">)</span>&nbsp;<span class="op" id="2980050">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2980055">f</span><span class="op" id="2980056">(</span><span class="op" id="2980057">&amp;</span><span class="ident" id="2980058">rr</span><span class="op" id="2980060">.</span><span class="ident" id="2980061">Port</span><span class="op" id="2980065">,</span>&nbsp;<span class="string" id="2980067">&#34;Port&#34;</span><span class="op" id="2980073">,</span>&nbsp;<span class="string" id="2980075">&#34;&#34;</span><span class="op" id="2980077">)</span>&nbsp;<span class="op" id="2980079">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2980084">f</span><span class="op" id="2980085">(</span><span class="op" id="2980086">&amp;</span><span class="ident" id="2980087">rr</span><span class="op" id="2980089">.</span><span class="ident" id="2980090">Target</span><span class="op" id="2980096">,</span>&nbsp;<span class="string" id="2980098">&#34;Target&#34;</span><span class="op" id="2980106">,</span>&nbsp;<span class="string" id="2980108">&#34;domain&#34;</span><span class="op" id="2980116">)</span><br>
<span class="lineno">330</span><span class="op" id="2980118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2980121">type</span>&nbsp;<span class="ident" id="2980126">dnsRR_A</span>&nbsp;<span class="keyword" id="2980134">struct</span>&nbsp;<span class="op" id="2980141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2980144">Hdr</span>&nbsp;<span class="ident" id="2980148">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2980162">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2980166">uint32</span>&nbsp;<span class="string" id="2980173">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="2980186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2980189">func</span>&nbsp;<span class="op" id="2980194">(</span><span class="ident" id="2980195">rr</span>&nbsp;<span class="op" id="2980198">*</span><span class="ident" id="2980199">dnsRR_A</span><span class="op" id="2980206">)</span>&nbsp;<span class="ident" id="2980208">Header</span><span class="op" id="2980214">(</span><span class="op" id="2980215">)</span>&nbsp;<span class="op" id="2980217">*</span><span class="ident" id="2980218">dnsRR_Header</span>&nbsp;<span class="op" id="2980231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2980234">return</span>&nbsp;<span class="op" id="2980241">&amp;</span><span class="ident" id="2980242">rr</span><span class="op" id="2980244">.</span><span class="ident" id="2980245">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2980249">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="2980252">func</span>&nbsp;<span class="op" id="2980257">(</span><span class="ident" id="2980258">rr</span>&nbsp;<span class="op" id="2980261">*</span><span class="ident" id="2980262">dnsRR_A</span><span class="op" id="2980269">)</span>&nbsp;<span class="ident" id="2980271">Walk</span><span class="op" id="2980275">(</span><span class="ident" id="2980276">f</span>&nbsp;<span class="keyword" id="2980278">func</span><span class="op" id="2980282">(</span><span class="ident" id="2980283">v</span>&nbsp;<span class="keyword" id="2980285">interface</span><span class="op" id="2980294">{</span><span class="op" id="2980295">}</span><span class="op" id="2980296">,</span>&nbsp;<span class="ident" id="2980298">name</span><span class="op" id="2980302">,</span>&nbsp;<span class="ident" id="2980304">tag</span>&nbsp;<span class="builtintype" id="2980308">string</span><span class="op" id="2980314">)</span>&nbsp;<span class="builtintype" id="2980316">bool</span><span class="op" id="2980320">)</span>&nbsp;<span class="builtintype" id="2980322">bool</span>&nbsp;<span class="op" id="2980327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2980330">return</span>&nbsp;<span class="ident" id="2980337">rr</span><span class="op" id="2980339">.</span><span class="ident" id="2980340">Hdr</span><span class="op" id="2980343">.</span><span class="ident" id="2980344">Walk</span><span class="op" id="2980348">(</span><span class="ident" id="2980349">f</span><span class="op" id="2980350">)</span>&nbsp;<span class="op" id="2980352">&amp;&amp;</span>&nbsp;<span class="ident" id="2980355">f</span><span class="op" id="2980356">(</span><span class="op" id="2980357">&amp;</span><span class="ident" id="2980358">rr</span><span class="op" id="2980360">.</span><span class="ident" id="2980361">A</span><span class="op" id="2980362">,</span>&nbsp;<span class="string" id="2980364">&#34;A&#34;</span><span class="op" id="2980367">,</span>&nbsp;<span class="string" id="2980369">&#34;ipv4&#34;</span><span class="op" id="2980375">)</span><br>
<span class="lineno"></span><span class="op" id="2980377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="2980380">type</span>&nbsp;<span class="ident" id="2980385">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="2980396">struct</span>&nbsp;<span class="op" id="2980403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2980406">Hdr</span>&nbsp;&nbsp;<span class="ident" id="2980411">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2980425">AAAA</span>&nbsp;<span class="op" id="2980430">[</span><span class="num" id="2980431">16</span><span class="op" id="2980433">]</span><span class="builtintype" id="2980434">byte</span>&nbsp;<span class="string" id="2980439">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="2980452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="2980455">func</span>&nbsp;<span class="op" id="2980460">(</span><span class="ident" id="2980461">rr</span>&nbsp;<span class="op" id="2980464">*</span><span class="ident" id="2980465">dnsRR_AAAA</span><span class="op" id="2980475">)</span>&nbsp;<span class="ident" id="2980477">Header</span><span class="op" id="2980483">(</span><span class="op" id="2980484">)</span>&nbsp;<span class="op" id="2980486">*</span><span class="ident" id="2980487">dnsRR_Header</span>&nbsp;<span class="op" id="2980500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2980503">return</span>&nbsp;<span class="op" id="2980510">&amp;</span><span class="ident" id="2980511">rr</span><span class="op" id="2980513">.</span><span class="ident" id="2980514">Hdr</span><br>
<span class="lineno"></span><span class="op" id="2980518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2980521">func</span>&nbsp;<span class="op" id="2980526">(</span><span class="ident" id="2980527">rr</span>&nbsp;<span class="op" id="2980530">*</span><span class="ident" id="2980531">dnsRR_AAAA</span><span class="op" id="2980541">)</span>&nbsp;<span class="ident" id="2980543">Walk</span><span class="op" id="2980547">(</span><span class="ident" id="2980548">f</span>&nbsp;<span class="keyword" id="2980550">func</span><span class="op" id="2980554">(</span><span class="ident" id="2980555">v</span>&nbsp;<span class="keyword" id="2980557">interface</span><span class="op" id="2980566">{</span><span class="op" id="2980567">}</span><span class="op" id="2980568">,</span>&nbsp;<span class="ident" id="2980570">name</span><span class="op" id="2980574">,</span>&nbsp;<span class="ident" id="2980576">tag</span>&nbsp;<span class="builtintype" id="2980580">string</span><span class="op" id="2980586">)</span>&nbsp;<span class="builtintype" id="2980588">bool</span><span class="op" id="2980592">)</span>&nbsp;<span class="builtintype" id="2980594">bool</span>&nbsp;<span class="op" id="2980599">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2980602">return</span>&nbsp;<span class="ident" id="2980609">rr</span><span class="op" id="2980611">.</span><span class="ident" id="2980612">Hdr</span><span class="op" id="2980615">.</span><span class="ident" id="2980616">Walk</span><span class="op" id="2980620">(</span><span class="ident" id="2980621">f</span><span class="op" id="2980622">)</span>&nbsp;<span class="op" id="2980624">&amp;&amp;</span>&nbsp;<span class="ident" id="2980627">f</span><span class="op" id="2980628">(</span><span class="ident" id="2980629">rr</span><span class="op" id="2980631">.</span><span class="ident" id="2980632">AAAA</span><span class="op" id="2980636">[</span><span class="op" id="2980637">:</span><span class="op" id="2980638">]</span><span class="op" id="2980639">,</span>&nbsp;<span class="string" id="2980641">&#34;AAAA&#34;</span><span class="op" id="2980647">,</span>&nbsp;<span class="string" id="2980649">&#34;ipv6&#34;</span><span class="op" id="2980655">)</span><br>
<span class="lineno"></span><span class="op" id="2980657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2980660">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="2980686">//</span><br>
<span class="lineno">360</span><span class="comment" id="2980689">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2980751">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="2980818">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="2980880">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2980946">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="2980968">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2981014">var</span>&nbsp;<span class="ident" id="2981018">rr_mk</span>&nbsp;<span class="op" id="2981024">=</span>&nbsp;<span class="keyword" id="2981026">map</span><span class="op" id="2981029">[</span><span class="builtintype" id="2981030">int</span><span class="op" id="2981033">]</span><span class="keyword" id="2981034">func</span><span class="op" id="2981038">(</span><span class="op" id="2981039">)</span>&nbsp;<span class="ident" id="2981041">dnsRR</span><span class="op" id="2981046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981049">dnsTypeCNAME</span><span class="op" id="2981061">:</span>&nbsp;<span class="keyword" id="2981063">func</span><span class="op" id="2981067">(</span><span class="op" id="2981068">)</span>&nbsp;<span class="ident" id="2981070">dnsRR</span>&nbsp;<span class="op" id="2981076">{</span>&nbsp;<span class="keyword" id="2981078">return</span>&nbsp;<span class="builtinfunc" id="2981085">new</span><span class="op" id="2981088">(</span><span class="ident" id="2981089">dnsRR_CNAME</span><span class="op" id="2981100">)</span>&nbsp;<span class="op" id="2981102">}</span><span class="op" id="2981103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981106">dnsTypeHINFO</span><span class="op" id="2981118">:</span>&nbsp;<span class="keyword" id="2981120">func</span><span class="op" id="2981124">(</span><span class="op" id="2981125">)</span>&nbsp;<span class="ident" id="2981127">dnsRR</span>&nbsp;<span class="op" id="2981133">{</span>&nbsp;<span class="keyword" id="2981135">return</span>&nbsp;<span class="builtinfunc" id="2981142">new</span><span class="op" id="2981145">(</span><span class="ident" id="2981146">dnsRR_HINFO</span><span class="op" id="2981157">)</span>&nbsp;<span class="op" id="2981159">}</span><span class="op" id="2981160">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981163">dnsTypeMB</span><span class="op" id="2981172">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981177">func</span><span class="op" id="2981181">(</span><span class="op" id="2981182">)</span>&nbsp;<span class="ident" id="2981184">dnsRR</span>&nbsp;<span class="op" id="2981190">{</span>&nbsp;<span class="keyword" id="2981192">return</span>&nbsp;<span class="builtinfunc" id="2981199">new</span><span class="op" id="2981202">(</span><span class="ident" id="2981203">dnsRR_MB</span><span class="op" id="2981211">)</span>&nbsp;<span class="op" id="2981213">}</span><span class="op" id="2981214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981217">dnsTypeMG</span><span class="op" id="2981226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981231">func</span><span class="op" id="2981235">(</span><span class="op" id="2981236">)</span>&nbsp;<span class="ident" id="2981238">dnsRR</span>&nbsp;<span class="op" id="2981244">{</span>&nbsp;<span class="keyword" id="2981246">return</span>&nbsp;<span class="builtinfunc" id="2981253">new</span><span class="op" id="2981256">(</span><span class="ident" id="2981257">dnsRR_MG</span><span class="op" id="2981265">)</span>&nbsp;<span class="op" id="2981267">}</span><span class="op" id="2981268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981271">dnsTypeMINFO</span><span class="op" id="2981283">:</span>&nbsp;<span class="keyword" id="2981285">func</span><span class="op" id="2981289">(</span><span class="op" id="2981290">)</span>&nbsp;<span class="ident" id="2981292">dnsRR</span>&nbsp;<span class="op" id="2981298">{</span>&nbsp;<span class="keyword" id="2981300">return</span>&nbsp;<span class="builtinfunc" id="2981307">new</span><span class="op" id="2981310">(</span><span class="ident" id="2981311">dnsRR_MINFO</span><span class="op" id="2981322">)</span>&nbsp;<span class="op" id="2981324">}</span><span class="op" id="2981325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981328">dnsTypeMR</span><span class="op" id="2981337">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981342">func</span><span class="op" id="2981346">(</span><span class="op" id="2981347">)</span>&nbsp;<span class="ident" id="2981349">dnsRR</span>&nbsp;<span class="op" id="2981355">{</span>&nbsp;<span class="keyword" id="2981357">return</span>&nbsp;<span class="builtinfunc" id="2981364">new</span><span class="op" id="2981367">(</span><span class="ident" id="2981368">dnsRR_MR</span><span class="op" id="2981376">)</span>&nbsp;<span class="op" id="2981378">}</span><span class="op" id="2981379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981382">dnsTypeMX</span><span class="op" id="2981391">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981396">func</span><span class="op" id="2981400">(</span><span class="op" id="2981401">)</span>&nbsp;<span class="ident" id="2981403">dnsRR</span>&nbsp;<span class="op" id="2981409">{</span>&nbsp;<span class="keyword" id="2981411">return</span>&nbsp;<span class="builtinfunc" id="2981418">new</span><span class="op" id="2981421">(</span><span class="ident" id="2981422">dnsRR_MX</span><span class="op" id="2981430">)</span>&nbsp;<span class="op" id="2981432">}</span><span class="op" id="2981433">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981436">dnsTypeNS</span><span class="op" id="2981445">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981450">func</span><span class="op" id="2981454">(</span><span class="op" id="2981455">)</span>&nbsp;<span class="ident" id="2981457">dnsRR</span>&nbsp;<span class="op" id="2981463">{</span>&nbsp;<span class="keyword" id="2981465">return</span>&nbsp;<span class="builtinfunc" id="2981472">new</span><span class="op" id="2981475">(</span><span class="ident" id="2981476">dnsRR_NS</span><span class="op" id="2981484">)</span>&nbsp;<span class="op" id="2981486">}</span><span class="op" id="2981487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981490">dnsTypePTR</span><span class="op" id="2981500">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981504">func</span><span class="op" id="2981508">(</span><span class="op" id="2981509">)</span>&nbsp;<span class="ident" id="2981511">dnsRR</span>&nbsp;<span class="op" id="2981517">{</span>&nbsp;<span class="keyword" id="2981519">return</span>&nbsp;<span class="builtinfunc" id="2981526">new</span><span class="op" id="2981529">(</span><span class="ident" id="2981530">dnsRR_PTR</span><span class="op" id="2981539">)</span>&nbsp;<span class="op" id="2981541">}</span><span class="op" id="2981542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981545">dnsTypeSOA</span><span class="op" id="2981555">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981559">func</span><span class="op" id="2981563">(</span><span class="op" id="2981564">)</span>&nbsp;<span class="ident" id="2981566">dnsRR</span>&nbsp;<span class="op" id="2981572">{</span>&nbsp;<span class="keyword" id="2981574">return</span>&nbsp;<span class="builtinfunc" id="2981581">new</span><span class="op" id="2981584">(</span><span class="ident" id="2981585">dnsRR_SOA</span><span class="op" id="2981594">)</span>&nbsp;<span class="op" id="2981596">}</span><span class="op" id="2981597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981600">dnsTypeTXT</span><span class="op" id="2981610">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981614">func</span><span class="op" id="2981618">(</span><span class="op" id="2981619">)</span>&nbsp;<span class="ident" id="2981621">dnsRR</span>&nbsp;<span class="op" id="2981627">{</span>&nbsp;<span class="keyword" id="2981629">return</span>&nbsp;<span class="builtinfunc" id="2981636">new</span><span class="op" id="2981639">(</span><span class="ident" id="2981640">dnsRR_TXT</span><span class="op" id="2981649">)</span>&nbsp;<span class="op" id="2981651">}</span><span class="op" id="2981652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981655">dnsTypeSRV</span><span class="op" id="2981665">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981669">func</span><span class="op" id="2981673">(</span><span class="op" id="2981674">)</span>&nbsp;<span class="ident" id="2981676">dnsRR</span>&nbsp;<span class="op" id="2981682">{</span>&nbsp;<span class="keyword" id="2981684">return</span>&nbsp;<span class="builtinfunc" id="2981691">new</span><span class="op" id="2981694">(</span><span class="ident" id="2981695">dnsRR_SRV</span><span class="op" id="2981704">)</span>&nbsp;<span class="op" id="2981706">}</span><span class="op" id="2981707">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981710">dnsTypeA</span><span class="op" id="2981718">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981724">func</span><span class="op" id="2981728">(</span><span class="op" id="2981729">)</span>&nbsp;<span class="ident" id="2981731">dnsRR</span>&nbsp;<span class="op" id="2981737">{</span>&nbsp;<span class="keyword" id="2981739">return</span>&nbsp;<span class="builtinfunc" id="2981746">new</span><span class="op" id="2981749">(</span><span class="ident" id="2981750">dnsRR_A</span><span class="op" id="2981757">)</span>&nbsp;<span class="op" id="2981759">}</span><span class="op" id="2981760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2981763">dnsTypeAAAA</span><span class="op" id="2981774">:</span>&nbsp;&nbsp;<span class="keyword" id="2981777">func</span><span class="op" id="2981781">(</span><span class="op" id="2981782">)</span>&nbsp;<span class="ident" id="2981784">dnsRR</span>&nbsp;<span class="op" id="2981790">{</span>&nbsp;<span class="keyword" id="2981792">return</span>&nbsp;<span class="builtinfunc" id="2981799">new</span><span class="op" id="2981802">(</span><span class="ident" id="2981803">dnsRR_AAAA</span><span class="op" id="2981813">)</span>&nbsp;<span class="op" id="2981815">}</span><span class="op" id="2981816">,</span><br>
<span class="lineno"></span><span class="op" id="2981818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2981821">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="2981861">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2981911">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2981970">func</span>&nbsp;<span class="ident" id="2981975">packDomainName</span><span class="op" id="2981989">(</span><span class="ident" id="2981990">s</span>&nbsp;<span class="builtintype" id="2981992">string</span><span class="op" id="2981998">,</span>&nbsp;<span class="ident" id="2982000">msg</span>&nbsp;<span class="op" id="2982004">[</span><span class="op" id="2982005">]</span><span class="builtintype" id="2982006">byte</span><span class="op" id="2982010">,</span>&nbsp;<span class="ident" id="2982012">off</span>&nbsp;<span class="builtintype" id="2982016">int</span><span class="op" id="2982019">)</span>&nbsp;<span class="op" id="2982021">(</span><span class="ident" id="2982022">off1</span>&nbsp;<span class="builtintype" id="2982027">int</span><span class="op" id="2982030">,</span>&nbsp;<span class="ident" id="2982032">ok</span>&nbsp;<span class="builtintype" id="2982035">bool</span><span class="op" id="2982039">)</span>&nbsp;<span class="op" id="2982041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2982044">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982087">if</span>&nbsp;<span class="ident" id="2982090">n</span>&nbsp;<span class="op" id="2982092">:=</span>&nbsp;<span class="builtinfunc" id="2982095">len</span><span class="op" id="2982098">(</span><span class="ident" id="2982099">s</span><span class="op" id="2982100">)</span><span class="op" id="2982101">;</span>&nbsp;<span class="ident" id="2982103">n</span>&nbsp;<span class="op" id="2982105">==</span>&nbsp;<span class="num" id="2982108">0</span>&nbsp;<span class="op" id="2982110">||</span>&nbsp;<span class="ident" id="2982113">s</span><span class="op" id="2982114">[</span><span class="ident" id="2982115">n</span><span class="op" id="2982116">-</span><span class="num" id="2982117">1</span><span class="op" id="2982118">]</span>&nbsp;<span class="op" id="2982120">!=</span>&nbsp;<span class="string" id="2982123">&#39;.&#39;</span>&nbsp;<span class="op" id="2982127">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982131">s</span>&nbsp;<span class="op" id="2982133">+=</span>&nbsp;<span class="string" id="2982136">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2982141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2982145">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2982186">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2982232">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2982267">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982313">tot</span>&nbsp;<span class="op" id="2982317">:=</span>&nbsp;<span class="builtinfunc" id="2982320">len</span><span class="op" id="2982323">(</span><span class="ident" id="2982324">s</span><span class="op" id="2982325">)</span>&nbsp;<span class="op" id="2982327">+</span>&nbsp;<span class="num" id="2982329">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982332">if</span>&nbsp;<span class="ident" id="2982335">off</span><span class="op" id="2982338">+</span><span class="ident" id="2982339">tot</span>&nbsp;<span class="op" id="2982343">&gt;</span>&nbsp;<span class="builtinfunc" id="2982345">len</span><span class="op" id="2982348">(</span><span class="ident" id="2982349">msg</span><span class="op" id="2982352">)</span>&nbsp;<span class="op" id="2982354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982358">return</span>&nbsp;<span class="builtinfunc" id="2982365">len</span><span class="op" id="2982368">(</span><span class="ident" id="2982369">msg</span><span class="op" id="2982372">)</span><span class="op" id="2982373">,</span>&nbsp;<span class="builtintype" id="2982375">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2982382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2982386">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982442">begin</span>&nbsp;<span class="op" id="2982448">:=</span>&nbsp;<span class="num" id="2982451">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982454">for</span>&nbsp;<span class="ident" id="2982458">i</span>&nbsp;<span class="op" id="2982460">:=</span>&nbsp;<span class="num" id="2982463">0</span><span class="op" id="2982464">;</span>&nbsp;<span class="ident" id="2982466">i</span>&nbsp;<span class="op" id="2982468">&lt;</span>&nbsp;<span class="builtinfunc" id="2982470">len</span><span class="op" id="2982473">(</span><span class="ident" id="2982474">s</span><span class="op" id="2982475">)</span><span class="op" id="2982476">;</span>&nbsp;<span class="ident" id="2982478">i</span><span class="op" id="2982479">++</span>&nbsp;<span class="op" id="2982482">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982486">if</span>&nbsp;<span class="ident" id="2982489">s</span><span class="op" id="2982490">[</span><span class="ident" id="2982491">i</span><span class="op" id="2982492">]</span>&nbsp;<span class="op" id="2982494">==</span>&nbsp;<span class="string" id="2982497">&#39;.&#39;</span>&nbsp;<span class="op" id="2982501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982506">if</span>&nbsp;<span class="ident" id="2982509">i</span><span class="op" id="2982510">-</span><span class="ident" id="2982511">begin</span>&nbsp;<span class="op" id="2982517">&gt;=</span>&nbsp;<span class="num" id="2982520">1</span><span class="op" id="2982521">&lt;&lt;</span><span class="num" id="2982523">6</span>&nbsp;<span class="op" id="2982525">{</span>&nbsp;<span class="comment" id="2982527">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982571">return</span>&nbsp;<span class="builtinfunc" id="2982578">len</span><span class="op" id="2982581">(</span><span class="ident" id="2982582">msg</span><span class="op" id="2982585">)</span><span class="op" id="2982586">,</span>&nbsp;<span class="builtintype" id="2982588">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2982597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982602">msg</span><span class="op" id="2982605">[</span><span class="ident" id="2982606">off</span><span class="op" id="2982609">]</span>&nbsp;<span class="op" id="2982611">=</span>&nbsp;<span class="builtintype" id="2982613">byte</span><span class="op" id="2982617">(</span><span class="ident" id="2982618">i</span>&nbsp;<span class="op" id="2982620">-</span>&nbsp;<span class="ident" id="2982622">begin</span><span class="op" id="2982627">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982632">off</span><span class="op" id="2982635">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982641">for</span>&nbsp;<span class="ident" id="2982645">j</span>&nbsp;<span class="op" id="2982647">:=</span>&nbsp;<span class="ident" id="2982650">begin</span><span class="op" id="2982655">;</span>&nbsp;<span class="ident" id="2982657">j</span>&nbsp;<span class="op" id="2982659">&lt;</span>&nbsp;<span class="ident" id="2982661">i</span><span class="op" id="2982662">;</span>&nbsp;<span class="ident" id="2982664">j</span><span class="op" id="2982665">++</span>&nbsp;<span class="op" id="2982668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982674">msg</span><span class="op" id="2982677">[</span><span class="ident" id="2982678">off</span><span class="op" id="2982681">]</span>&nbsp;<span class="op" id="2982683">=</span>&nbsp;<span class="ident" id="2982685">s</span><span class="op" id="2982686">[</span><span class="ident" id="2982687">j</span><span class="op" id="2982688">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982694">off</span><span class="op" id="2982697">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2982703">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982708">begin</span>&nbsp;<span class="op" id="2982714">=</span>&nbsp;<span class="ident" id="2982716">i</span>&nbsp;<span class="op" id="2982718">+</span>&nbsp;<span class="num" id="2982720">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2982724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2982727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982730">msg</span><span class="op" id="2982733">[</span><span class="ident" id="2982734">off</span><span class="op" id="2982737">]</span>&nbsp;<span class="op" id="2982739">=</span>&nbsp;<span class="num" id="2982741">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2982744">off</span><span class="op" id="2982747">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2982751">return</span>&nbsp;<span class="ident" id="2982758">off</span><span class="op" id="2982761">,</span>&nbsp;<span class="builtintype" id="2982763">true</span><br>
<span class="lineno"></span><span class="op" id="2982768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2982771">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="2982796">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="2982861">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2982926">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="2982987">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="2983048">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="2983111">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="2983180">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="2983218">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="2983267">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="2983333">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="2983379">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="2983441">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="2983502">func</span>&nbsp;<span class="ident" id="2983507">unpackDomainName</span><span class="op" id="2983523">(</span><span class="ident" id="2983524">msg</span>&nbsp;<span class="op" id="2983528">[</span><span class="op" id="2983529">]</span><span class="builtintype" id="2983530">byte</span><span class="op" id="2983534">,</span>&nbsp;<span class="ident" id="2983536">off</span>&nbsp;<span class="builtintype" id="2983540">int</span><span class="op" id="2983543">)</span>&nbsp;<span class="op" id="2983545">(</span><span class="ident" id="2983546">s</span>&nbsp;<span class="builtintype" id="2983548">string</span><span class="op" id="2983554">,</span>&nbsp;<span class="ident" id="2983556">off1</span>&nbsp;<span class="builtintype" id="2983561">int</span><span class="op" id="2983564">,</span>&nbsp;<span class="ident" id="2983566">ok</span>&nbsp;<span class="builtintype" id="2983569">bool</span><span class="op" id="2983573">)</span>&nbsp;<span class="op" id="2983575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2983578">s</span>&nbsp;<span class="op" id="2983580">=</span>&nbsp;<span class="string" id="2983582">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2983586">ptr</span>&nbsp;<span class="op" id="2983590">:=</span>&nbsp;<span class="num" id="2983593">0</span>&nbsp;<span class="comment" id="2983595">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="2983626">Loop</span><span class="op" id="2983630">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983633">for</span>&nbsp;<span class="op" id="2983637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983641">if</span>&nbsp;<span class="ident" id="2983644">off</span>&nbsp;<span class="op" id="2983648">&gt;=</span>&nbsp;<span class="builtinfunc" id="2983651">len</span><span class="op" id="2983654">(</span><span class="ident" id="2983655">msg</span><span class="op" id="2983658">)</span>&nbsp;<span class="op" id="2983660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983665">return</span>&nbsp;<span class="string" id="2983672">&#34;&#34;</span><span class="op" id="2983674">,</span>&nbsp;<span class="builtinfunc" id="2983676">len</span><span class="op" id="2983679">(</span><span class="ident" id="2983680">msg</span><span class="op" id="2983683">)</span><span class="op" id="2983684">,</span>&nbsp;<span class="builtintype" id="2983686">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2983694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2983698">c</span>&nbsp;<span class="op" id="2983700">:=</span>&nbsp;<span class="builtintype" id="2983703">int</span><span class="op" id="2983706">(</span><span class="ident" id="2983707">msg</span><span class="op" id="2983710">[</span><span class="ident" id="2983711">off</span><span class="op" id="2983714">]</span><span class="op" id="2983715">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2983719">off</span><span class="op" id="2983722">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983727">switch</span>&nbsp;<span class="ident" id="2983734">c</span>&nbsp;<span class="op" id="2983736">&amp;</span>&nbsp;<span class="num" id="2983738">0xC0</span>&nbsp;<span class="op" id="2983743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983747">case</span>&nbsp;<span class="num" id="2983752">0x00</span><span class="op" id="2983756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983761">if</span>&nbsp;<span class="ident" id="2983764">c</span>&nbsp;<span class="op" id="2983766">==</span>&nbsp;<span class="num" id="2983769">0x00</span>&nbsp;<span class="op" id="2983774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2983780">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983799">break</span>&nbsp;<span class="ident" id="2983805">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2983813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2983818">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983839">if</span>&nbsp;<span class="ident" id="2983842">off</span><span class="op" id="2983845">+</span><span class="ident" id="2983846">c</span>&nbsp;<span class="op" id="2983848">&gt;</span>&nbsp;<span class="builtinfunc" id="2983850">len</span><span class="op" id="2983853">(</span><span class="ident" id="2983854">msg</span><span class="op" id="2983857">)</span>&nbsp;<span class="op" id="2983859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983865">return</span>&nbsp;<span class="string" id="2983872">&#34;&#34;</span><span class="op" id="2983874">,</span>&nbsp;<span class="builtinfunc" id="2983876">len</span><span class="op" id="2983879">(</span><span class="ident" id="2983880">msg</span><span class="op" id="2983883">)</span><span class="op" id="2983884">,</span>&nbsp;<span class="builtintype" id="2983886">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2983895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2983900">s</span>&nbsp;<span class="op" id="2983902">+=</span>&nbsp;<span class="builtintype" id="2983905">string</span><span class="op" id="2983911">(</span><span class="ident" id="2983912">msg</span><span class="op" id="2983915">[</span><span class="ident" id="2983916">off</span><span class="op" id="2983919">:</span><span class="ident" id="2983920">off</span><span class="op" id="2983923">+</span><span class="ident" id="2983924">c</span><span class="op" id="2983925">]</span><span class="op" id="2983926">)</span>&nbsp;<span class="op" id="2983928">+</span>&nbsp;<span class="string" id="2983930">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2983937">off</span>&nbsp;<span class="op" id="2983941">+=</span>&nbsp;<span class="ident" id="2983944">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2983948">case</span>&nbsp;<span class="num" id="2983953">0xC0</span><span class="op" id="2983957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2983962">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2984002">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2984043">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2984090">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2984136">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984164">if</span>&nbsp;<span class="ident" id="2984167">off</span>&nbsp;<span class="op" id="2984171">&gt;=</span>&nbsp;<span class="builtinfunc" id="2984174">len</span><span class="op" id="2984177">(</span><span class="ident" id="2984178">msg</span><span class="op" id="2984181">)</span>&nbsp;<span class="op" id="2984183">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984189">return</span>&nbsp;<span class="string" id="2984196">&#34;&#34;</span><span class="op" id="2984198">,</span>&nbsp;<span class="builtinfunc" id="2984200">len</span><span class="op" id="2984203">(</span><span class="ident" id="2984204">msg</span><span class="op" id="2984207">)</span><span class="op" id="2984208">,</span>&nbsp;<span class="builtintype" id="2984210">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2984219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984224">c1</span>&nbsp;<span class="op" id="2984227">:=</span>&nbsp;<span class="ident" id="2984230">msg</span><span class="op" id="2984233">[</span><span class="ident" id="2984234">off</span><span class="op" id="2984237">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984242">off</span><span class="op" id="2984245">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984251">if</span>&nbsp;<span class="ident" id="2984254">ptr</span>&nbsp;<span class="op" id="2984258">==</span>&nbsp;<span class="num" id="2984261">0</span>&nbsp;<span class="op" id="2984263">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984269">off1</span>&nbsp;<span class="op" id="2984274">=</span>&nbsp;<span class="ident" id="2984276">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2984283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984288">if</span>&nbsp;<span class="ident" id="2984291">ptr</span><span class="op" id="2984294">++</span><span class="op" id="2984296">;</span>&nbsp;<span class="ident" id="2984298">ptr</span>&nbsp;<span class="op" id="2984302">&gt;</span>&nbsp;<span class="num" id="2984304">10</span>&nbsp;<span class="op" id="2984307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984313">return</span>&nbsp;<span class="string" id="2984320">&#34;&#34;</span><span class="op" id="2984322">,</span>&nbsp;<span class="builtinfunc" id="2984324">len</span><span class="op" id="2984327">(</span><span class="ident" id="2984328">msg</span><span class="op" id="2984331">)</span><span class="op" id="2984332">,</span>&nbsp;<span class="builtintype" id="2984334">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2984343">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984348">off</span>&nbsp;<span class="op" id="2984352">=</span>&nbsp;<span class="op" id="2984354">(</span><span class="ident" id="2984355">c</span><span class="op" id="2984356">^</span><span class="num" id="2984357">0xC0</span><span class="op" id="2984361">)</span><span class="op" id="2984362">&lt;&lt;</span><span class="num" id="2984364">8</span>&nbsp;<span class="op" id="2984366">|</span>&nbsp;<span class="builtintype" id="2984368">int</span><span class="op" id="2984371">(</span><span class="ident" id="2984372">c1</span><span class="op" id="2984374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984378">default</span><span class="op" id="2984385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2984390">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984423">return</span>&nbsp;<span class="string" id="2984430">&#34;&#34;</span><span class="op" id="2984432">,</span>&nbsp;<span class="builtinfunc" id="2984434">len</span><span class="op" id="2984437">(</span><span class="ident" id="2984438">msg</span><span class="op" id="2984441">)</span><span class="op" id="2984442">,</span>&nbsp;<span class="builtintype" id="2984444">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2984452">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2984455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984458">if</span>&nbsp;<span class="ident" id="2984461">ptr</span>&nbsp;<span class="op" id="2984465">==</span>&nbsp;<span class="num" id="2984468">0</span>&nbsp;<span class="op" id="2984470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984474">off1</span>&nbsp;<span class="op" id="2984479">=</span>&nbsp;<span class="ident" id="2984481">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2984486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984489">return</span>&nbsp;<span class="ident" id="2984496">s</span><span class="op" id="2984497">,</span>&nbsp;<span class="ident" id="2984499">off1</span><span class="op" id="2984503">,</span>&nbsp;<span class="builtintype" id="2984505">true</span><br>
<span class="lineno">485</span><span class="op" id="2984510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2984513">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2984583">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="2984644">func</span>&nbsp;<span class="ident" id="2984649">packStruct</span><span class="op" id="2984659">(</span><span class="ident" id="2984660">any</span>&nbsp;<span class="ident" id="2984664">dnsStruct</span><span class="op" id="2984673">,</span>&nbsp;<span class="ident" id="2984675">msg</span>&nbsp;<span class="op" id="2984679">[</span><span class="op" id="2984680">]</span><span class="builtintype" id="2984681">byte</span><span class="op" id="2984685">,</span>&nbsp;<span class="ident" id="2984687">off</span>&nbsp;<span class="builtintype" id="2984691">int</span><span class="op" id="2984694">)</span>&nbsp;<span class="op" id="2984696">(</span><span class="ident" id="2984697">off1</span>&nbsp;<span class="builtintype" id="2984702">int</span><span class="op" id="2984705">,</span>&nbsp;<span class="ident" id="2984707">ok</span>&nbsp;<span class="builtintype" id="2984710">bool</span><span class="op" id="2984714">)</span>&nbsp;<span class="op" id="2984716">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984719">ok</span>&nbsp;<span class="op" id="2984722">=</span>&nbsp;<span class="ident" id="2984724">any</span><span class="op" id="2984727">.</span><span class="ident" id="2984728">Walk</span><span class="op" id="2984732">(</span><span class="keyword" id="2984733">func</span><span class="op" id="2984737">(</span><span class="ident" id="2984738">field</span>&nbsp;<span class="keyword" id="2984744">interface</span><span class="op" id="2984753">{</span><span class="op" id="2984754">}</span><span class="op" id="2984755">,</span>&nbsp;<span class="ident" id="2984757">name</span><span class="op" id="2984761">,</span>&nbsp;<span class="ident" id="2984763">tag</span>&nbsp;<span class="builtintype" id="2984767">string</span><span class="op" id="2984773">)</span>&nbsp;<span class="builtintype" id="2984775">bool</span>&nbsp;<span class="op" id="2984780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984784">switch</span>&nbsp;<span class="ident" id="2984791">fv</span>&nbsp;<span class="op" id="2984794">:=</span>&nbsp;<span class="ident" id="2984797">field</span><span class="op" id="2984802">.</span><span class="op" id="2984803">(</span><span class="keyword" id="2984804">type</span><span class="op" id="2984808">)</span>&nbsp;<span class="op" id="2984810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984814">default</span><span class="op" id="2984821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2984826">println</span><span class="op" id="2984833">(</span><span class="string" id="2984834">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="2984866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984871">return</span>&nbsp;<span class="builtintype" id="2984878">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984886">case</span>&nbsp;<span class="op" id="2984891">*</span><span class="builtintype" id="2984892">uint16</span><span class="op" id="2984898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984903">i</span>&nbsp;<span class="op" id="2984905">:=</span>&nbsp;<span class="op" id="2984908">*</span><span class="ident" id="2984909">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984915">if</span>&nbsp;<span class="ident" id="2984918">off</span><span class="op" id="2984921">+</span><span class="num" id="2984922">2</span>&nbsp;<span class="op" id="2984924">&gt;</span>&nbsp;<span class="builtinfunc" id="2984926">len</span><span class="op" id="2984929">(</span><span class="ident" id="2984930">msg</span><span class="op" id="2984933">)</span>&nbsp;<span class="op" id="2984935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2984941">return</span>&nbsp;<span class="builtintype" id="2984948">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2984957">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984962">msg</span><span class="op" id="2984965">[</span><span class="ident" id="2984966">off</span><span class="op" id="2984969">]</span>&nbsp;<span class="op" id="2984971">=</span>&nbsp;<span class="builtintype" id="2984973">byte</span><span class="op" id="2984977">(</span><span class="ident" id="2984978">i</span>&nbsp;<span class="op" id="2984980">&gt;&gt;</span>&nbsp;<span class="num" id="2984983">8</span><span class="op" id="2984984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2984989">msg</span><span class="op" id="2984992">[</span><span class="ident" id="2984993">off</span><span class="op" id="2984996">+</span><span class="num" id="2984997">1</span><span class="op" id="2984998">]</span>&nbsp;<span class="op" id="2985000">=</span>&nbsp;<span class="builtintype" id="2985002">byte</span><span class="op" id="2985006">(</span><span class="ident" id="2985007">i</span><span class="op" id="2985008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985013">off</span>&nbsp;<span class="op" id="2985017">+=</span>&nbsp;<span class="num" id="2985020">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985024">case</span>&nbsp;<span class="op" id="2985029">*</span><span class="builtintype" id="2985030">uint32</span><span class="op" id="2985036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985041">i</span>&nbsp;<span class="op" id="2985043">:=</span>&nbsp;<span class="op" id="2985046">*</span><span class="ident" id="2985047">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985053">msg</span><span class="op" id="2985056">[</span><span class="ident" id="2985057">off</span><span class="op" id="2985060">]</span>&nbsp;<span class="op" id="2985062">=</span>&nbsp;<span class="builtintype" id="2985064">byte</span><span class="op" id="2985068">(</span><span class="ident" id="2985069">i</span>&nbsp;<span class="op" id="2985071">&gt;&gt;</span>&nbsp;<span class="num" id="2985074">24</span><span class="op" id="2985076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985081">msg</span><span class="op" id="2985084">[</span><span class="ident" id="2985085">off</span><span class="op" id="2985088">+</span><span class="num" id="2985089">1</span><span class="op" id="2985090">]</span>&nbsp;<span class="op" id="2985092">=</span>&nbsp;<span class="builtintype" id="2985094">byte</span><span class="op" id="2985098">(</span><span class="ident" id="2985099">i</span>&nbsp;<span class="op" id="2985101">&gt;&gt;</span>&nbsp;<span class="num" id="2985104">16</span><span class="op" id="2985106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985111">msg</span><span class="op" id="2985114">[</span><span class="ident" id="2985115">off</span><span class="op" id="2985118">+</span><span class="num" id="2985119">2</span><span class="op" id="2985120">]</span>&nbsp;<span class="op" id="2985122">=</span>&nbsp;<span class="builtintype" id="2985124">byte</span><span class="op" id="2985128">(</span><span class="ident" id="2985129">i</span>&nbsp;<span class="op" id="2985131">&gt;&gt;</span>&nbsp;<span class="num" id="2985134">8</span><span class="op" id="2985135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985140">msg</span><span class="op" id="2985143">[</span><span class="ident" id="2985144">off</span><span class="op" id="2985147">+</span><span class="num" id="2985148">3</span><span class="op" id="2985149">]</span>&nbsp;<span class="op" id="2985151">=</span>&nbsp;<span class="builtintype" id="2985153">byte</span><span class="op" id="2985157">(</span><span class="ident" id="2985158">i</span><span class="op" id="2985159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985164">off</span>&nbsp;<span class="op" id="2985168">+=</span>&nbsp;<span class="num" id="2985171">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985175">case</span>&nbsp;<span class="op" id="2985180">[</span><span class="op" id="2985181">]</span><span class="builtintype" id="2985182">byte</span><span class="op" id="2985186">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985191">n</span>&nbsp;<span class="op" id="2985193">:=</span>&nbsp;<span class="builtinfunc" id="2985196">len</span><span class="op" id="2985199">(</span><span class="ident" id="2985200">fv</span><span class="op" id="2985202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985207">if</span>&nbsp;<span class="ident" id="2985210">off</span><span class="op" id="2985213">+</span><span class="ident" id="2985214">n</span>&nbsp;<span class="op" id="2985216">&gt;</span>&nbsp;<span class="builtinfunc" id="2985218">len</span><span class="op" id="2985221">(</span><span class="ident" id="2985222">msg</span><span class="op" id="2985225">)</span>&nbsp;<span class="op" id="2985227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985233">return</span>&nbsp;<span class="builtintype" id="2985240">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2985249">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2985254">copy</span><span class="op" id="2985258">(</span><span class="ident" id="2985259">msg</span><span class="op" id="2985262">[</span><span class="ident" id="2985263">off</span><span class="op" id="2985266">:</span><span class="ident" id="2985267">off</span><span class="op" id="2985270">+</span><span class="ident" id="2985271">n</span><span class="op" id="2985272">]</span><span class="op" id="2985273">,</span>&nbsp;<span class="ident" id="2985275">fv</span><span class="op" id="2985277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985282">off</span>&nbsp;<span class="op" id="2985286">+=</span>&nbsp;<span class="ident" id="2985289">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985293">case</span>&nbsp;<span class="op" id="2985298">*</span><span class="builtintype" id="2985299">string</span><span class="op" id="2985305">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985310">s</span>&nbsp;<span class="op" id="2985312">:=</span>&nbsp;<span class="op" id="2985315">*</span><span class="ident" id="2985316">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985322">switch</span>&nbsp;<span class="ident" id="2985329">tag</span>&nbsp;<span class="op" id="2985333">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985338">default</span><span class="op" id="2985345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2985351">println</span><span class="op" id="2985358">(</span><span class="string" id="2985359">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="2985389">,</span>&nbsp;<span class="ident" id="2985391">tag</span><span class="op" id="2985394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985400">return</span>&nbsp;<span class="builtintype" id="2985407">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985416">case</span>&nbsp;<span class="string" id="2985421">&#34;domain&#34;</span><span class="op" id="2985429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985435">off</span><span class="op" id="2985438">,</span>&nbsp;<span class="ident" id="2985440">ok</span>&nbsp;<span class="op" id="2985443">=</span>&nbsp;<span class="ident" id="2985445">packDomainName</span><span class="op" id="2985459">(</span><span class="ident" id="2985460">s</span><span class="op" id="2985461">,</span>&nbsp;<span class="ident" id="2985463">msg</span><span class="op" id="2985466">,</span>&nbsp;<span class="ident" id="2985468">off</span><span class="op" id="2985471">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985477">if</span>&nbsp;<span class="op" id="2985480">!</span><span class="ident" id="2985481">ok</span>&nbsp;<span class="op" id="2985484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985491">return</span>&nbsp;<span class="builtintype" id="2985498">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2985508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985513">case</span>&nbsp;<span class="string" id="2985518">&#34;&#34;</span><span class="op" id="2985520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2985526">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985564">if</span>&nbsp;<span class="builtinfunc" id="2985567">len</span><span class="op" id="2985570">(</span><span class="ident" id="2985571">s</span><span class="op" id="2985572">)</span>&nbsp;<span class="op" id="2985574">&gt;</span>&nbsp;<span class="num" id="2985576">255</span>&nbsp;<span class="op" id="2985580">||</span>&nbsp;<span class="ident" id="2985583">off</span><span class="op" id="2985586">+</span><span class="num" id="2985587">1</span><span class="op" id="2985588">+</span><span class="builtinfunc" id="2985589">len</span><span class="op" id="2985592">(</span><span class="ident" id="2985593">s</span><span class="op" id="2985594">)</span>&nbsp;<span class="op" id="2985596">&gt;</span>&nbsp;<span class="builtinfunc" id="2985598">len</span><span class="op" id="2985601">(</span><span class="ident" id="2985602">msg</span><span class="op" id="2985605">)</span>&nbsp;<span class="op" id="2985607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985614">return</span>&nbsp;<span class="builtintype" id="2985621">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2985631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985637">msg</span><span class="op" id="2985640">[</span><span class="ident" id="2985641">off</span><span class="op" id="2985644">]</span>&nbsp;<span class="op" id="2985646">=</span>&nbsp;<span class="builtintype" id="2985648">byte</span><span class="op" id="2985652">(</span><span class="builtinfunc" id="2985653">len</span><span class="op" id="2985656">(</span><span class="ident" id="2985657">s</span><span class="op" id="2985658">)</span><span class="op" id="2985659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985665">off</span><span class="op" id="2985668">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985675">off</span>&nbsp;<span class="op" id="2985679">+=</span>&nbsp;<span class="builtinfunc" id="2985682">copy</span><span class="op" id="2985686">(</span><span class="ident" id="2985687">msg</span><span class="op" id="2985690">[</span><span class="ident" id="2985691">off</span><span class="op" id="2985694">:</span><span class="op" id="2985695">]</span><span class="op" id="2985696">,</span>&nbsp;<span class="ident" id="2985698">s</span><span class="op" id="2985699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2985704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2985708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985712">return</span>&nbsp;<span class="builtintype" id="2985719">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2985725">}</span><span class="op" id="2985726">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985729">if</span>&nbsp;<span class="op" id="2985732">!</span><span class="ident" id="2985733">ok</span>&nbsp;<span class="op" id="2985736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985740">return</span>&nbsp;<span class="builtinfunc" id="2985747">len</span><span class="op" id="2985750">(</span><span class="ident" id="2985751">msg</span><span class="op" id="2985754">)</span><span class="op" id="2985755">,</span>&nbsp;<span class="builtintype" id="2985757">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2985764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2985767">return</span>&nbsp;<span class="ident" id="2985774">off</span><span class="op" id="2985777">,</span>&nbsp;<span class="builtintype" id="2985779">true</span><br>
<span class="lineno"></span><span class="op" id="2985784">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="2985787">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:]into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2985852">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="2985913">func</span>&nbsp;<span class="ident" id="2985918">unpackStruct</span><span class="op" id="2985930">(</span><span class="ident" id="2985931">any</span>&nbsp;<span class="ident" id="2985935">dnsStruct</span><span class="op" id="2985944">,</span>&nbsp;<span class="ident" id="2985946">msg</span>&nbsp;<span class="op" id="2985950">[</span><span class="op" id="2985951">]</span><span class="builtintype" id="2985952">byte</span><span class="op" id="2985956">,</span>&nbsp;<span class="ident" id="2985958">off</span>&nbsp;<span class="builtintype" id="2985962">int</span><span class="op" id="2985965">)</span>&nbsp;<span class="op" id="2985967">(</span><span class="ident" id="2985968">off1</span>&nbsp;<span class="builtintype" id="2985973">int</span><span class="op" id="2985976">,</span>&nbsp;<span class="ident" id="2985978">ok</span>&nbsp;<span class="builtintype" id="2985981">bool</span><span class="op" id="2985985">)</span>&nbsp;<span class="op" id="2985987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2985990">ok</span>&nbsp;<span class="op" id="2985993">=</span>&nbsp;<span class="ident" id="2985995">any</span><span class="op" id="2985998">.</span><span class="ident" id="2985999">Walk</span><span class="op" id="2986003">(</span><span class="keyword" id="2986004">func</span><span class="op" id="2986008">(</span><span class="ident" id="2986009">field</span>&nbsp;<span class="keyword" id="2986015">interface</span><span class="op" id="2986024">{</span><span class="op" id="2986025">}</span><span class="op" id="2986026">,</span>&nbsp;<span class="ident" id="2986028">name</span><span class="op" id="2986032">,</span>&nbsp;<span class="ident" id="2986034">tag</span>&nbsp;<span class="builtintype" id="2986038">string</span><span class="op" id="2986044">)</span>&nbsp;<span class="builtintype" id="2986046">bool</span>&nbsp;<span class="op" id="2986051">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986055">switch</span>&nbsp;<span class="ident" id="2986062">fv</span>&nbsp;<span class="op" id="2986065">:=</span>&nbsp;<span class="ident" id="2986068">field</span><span class="op" id="2986073">.</span><span class="op" id="2986074">(</span><span class="keyword" id="2986075">type</span><span class="op" id="2986079">)</span>&nbsp;<span class="op" id="2986081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986085">default</span><span class="op" id="2986092">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2986097">println</span><span class="op" id="2986104">(</span><span class="string" id="2986105">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="2986137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986142">return</span>&nbsp;<span class="builtintype" id="2986149">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986157">case</span>&nbsp;<span class="op" id="2986162">*</span><span class="builtintype" id="2986163">uint16</span><span class="op" id="2986169">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986174">if</span>&nbsp;<span class="ident" id="2986177">off</span><span class="op" id="2986180">+</span><span class="num" id="2986181">2</span>&nbsp;<span class="op" id="2986183">&gt;</span>&nbsp;<span class="builtinfunc" id="2986185">len</span><span class="op" id="2986188">(</span><span class="ident" id="2986189">msg</span><span class="op" id="2986192">)</span>&nbsp;<span class="op" id="2986194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986200">return</span>&nbsp;<span class="builtintype" id="2986207">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2986216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2986221">*</span><span class="ident" id="2986222">fv</span>&nbsp;<span class="op" id="2986225">=</span>&nbsp;<span class="builtintype" id="2986227">uint16</span><span class="op" id="2986233">(</span><span class="ident" id="2986234">msg</span><span class="op" id="2986237">[</span><span class="ident" id="2986238">off</span><span class="op" id="2986241">]</span><span class="op" id="2986242">)</span><span class="op" id="2986243">&lt;&lt;</span><span class="num" id="2986245">8</span>&nbsp;<span class="op" id="2986247">|</span>&nbsp;<span class="builtintype" id="2986249">uint16</span><span class="op" id="2986255">(</span><span class="ident" id="2986256">msg</span><span class="op" id="2986259">[</span><span class="ident" id="2986260">off</span><span class="op" id="2986263">+</span><span class="num" id="2986264">1</span><span class="op" id="2986265">]</span><span class="op" id="2986266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986271">off</span>&nbsp;<span class="op" id="2986275">+=</span>&nbsp;<span class="num" id="2986278">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986282">case</span>&nbsp;<span class="op" id="2986287">*</span><span class="builtintype" id="2986288">uint32</span><span class="op" id="2986294">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986299">if</span>&nbsp;<span class="ident" id="2986302">off</span><span class="op" id="2986305">+</span><span class="num" id="2986306">4</span>&nbsp;<span class="op" id="2986308">&gt;</span>&nbsp;<span class="builtinfunc" id="2986310">len</span><span class="op" id="2986313">(</span><span class="ident" id="2986314">msg</span><span class="op" id="2986317">)</span>&nbsp;<span class="op" id="2986319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986325">return</span>&nbsp;<span class="builtintype" id="2986332">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2986341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2986346">*</span><span class="ident" id="2986347">fv</span>&nbsp;<span class="op" id="2986350">=</span>&nbsp;<span class="builtintype" id="2986352">uint32</span><span class="op" id="2986358">(</span><span class="ident" id="2986359">msg</span><span class="op" id="2986362">[</span><span class="ident" id="2986363">off</span><span class="op" id="2986366">]</span><span class="op" id="2986367">)</span><span class="op" id="2986368">&lt;&lt;</span><span class="num" id="2986370">24</span>&nbsp;<span class="op" id="2986373">|</span>&nbsp;<span class="builtintype" id="2986375">uint32</span><span class="op" id="2986381">(</span><span class="ident" id="2986382">msg</span><span class="op" id="2986385">[</span><span class="ident" id="2986386">off</span><span class="op" id="2986389">+</span><span class="num" id="2986390">1</span><span class="op" id="2986391">]</span><span class="op" id="2986392">)</span><span class="op" id="2986393">&lt;&lt;</span><span class="num" id="2986395">16</span>&nbsp;<span class="op" id="2986398">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2986404">uint32</span><span class="op" id="2986410">(</span><span class="ident" id="2986411">msg</span><span class="op" id="2986414">[</span><span class="ident" id="2986415">off</span><span class="op" id="2986418">+</span><span class="num" id="2986419">2</span><span class="op" id="2986420">]</span><span class="op" id="2986421">)</span><span class="op" id="2986422">&lt;&lt;</span><span class="num" id="2986424">8</span>&nbsp;<span class="op" id="2986426">|</span>&nbsp;<span class="builtintype" id="2986428">uint32</span><span class="op" id="2986434">(</span><span class="ident" id="2986435">msg</span><span class="op" id="2986438">[</span><span class="ident" id="2986439">off</span><span class="op" id="2986442">+</span><span class="num" id="2986443">3</span><span class="op" id="2986444">]</span><span class="op" id="2986445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986450">off</span>&nbsp;<span class="op" id="2986454">+=</span>&nbsp;<span class="num" id="2986457">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986461">case</span>&nbsp;<span class="op" id="2986466">[</span><span class="op" id="2986467">]</span><span class="builtintype" id="2986468">byte</span><span class="op" id="2986472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986477">n</span>&nbsp;<span class="op" id="2986479">:=</span>&nbsp;<span class="builtinfunc" id="2986482">len</span><span class="op" id="2986485">(</span><span class="ident" id="2986486">fv</span><span class="op" id="2986488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986493">if</span>&nbsp;<span class="ident" id="2986496">off</span><span class="op" id="2986499">+</span><span class="ident" id="2986500">n</span>&nbsp;<span class="op" id="2986502">&gt;</span>&nbsp;<span class="builtinfunc" id="2986504">len</span><span class="op" id="2986507">(</span><span class="ident" id="2986508">msg</span><span class="op" id="2986511">)</span>&nbsp;<span class="op" id="2986513">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986519">return</span>&nbsp;<span class="builtintype" id="2986526">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2986535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2986540">copy</span><span class="op" id="2986544">(</span><span class="ident" id="2986545">fv</span><span class="op" id="2986547">,</span>&nbsp;<span class="ident" id="2986549">msg</span><span class="op" id="2986552">[</span><span class="ident" id="2986553">off</span><span class="op" id="2986556">:</span><span class="ident" id="2986557">off</span><span class="op" id="2986560">+</span><span class="ident" id="2986561">n</span><span class="op" id="2986562">]</span><span class="op" id="2986563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986568">off</span>&nbsp;<span class="op" id="2986572">+=</span>&nbsp;<span class="ident" id="2986575">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986579">case</span>&nbsp;<span class="op" id="2986584">*</span><span class="builtintype" id="2986585">string</span><span class="op" id="2986591">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986596">var</span>&nbsp;<span class="ident" id="2986600">s</span>&nbsp;<span class="builtintype" id="2986602">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986612">switch</span>&nbsp;<span class="ident" id="2986619">tag</span>&nbsp;<span class="op" id="2986623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986628">default</span><span class="op" id="2986635">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2986641">println</span><span class="op" id="2986648">(</span><span class="string" id="2986649">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="2986679">,</span>&nbsp;<span class="ident" id="2986681">tag</span><span class="op" id="2986684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986690">return</span>&nbsp;<span class="builtintype" id="2986697">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986706">case</span>&nbsp;<span class="string" id="2986711">&#34;domain&#34;</span><span class="op" id="2986719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986725">s</span><span class="op" id="2986726">,</span>&nbsp;<span class="ident" id="2986728">off</span><span class="op" id="2986731">,</span>&nbsp;<span class="ident" id="2986733">ok</span>&nbsp;<span class="op" id="2986736">=</span>&nbsp;<span class="ident" id="2986738">unpackDomainName</span><span class="op" id="2986754">(</span><span class="ident" id="2986755">msg</span><span class="op" id="2986758">,</span>&nbsp;<span class="ident" id="2986760">off</span><span class="op" id="2986763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986769">if</span>&nbsp;<span class="op" id="2986772">!</span><span class="ident" id="2986773">ok</span>&nbsp;<span class="op" id="2986776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986783">return</span>&nbsp;<span class="builtintype" id="2986790">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2986800">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986805">case</span>&nbsp;<span class="string" id="2986810">&#34;&#34;</span><span class="op" id="2986812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986818">if</span>&nbsp;<span class="ident" id="2986821">off</span>&nbsp;<span class="op" id="2986825">&gt;=</span>&nbsp;<span class="builtinfunc" id="2986828">len</span><span class="op" id="2986831">(</span><span class="ident" id="2986832">msg</span><span class="op" id="2986835">)</span>&nbsp;<span class="op" id="2986837">||</span>&nbsp;<span class="ident" id="2986840">off</span><span class="op" id="2986843">+</span><span class="num" id="2986844">1</span><span class="op" id="2986845">+</span><span class="builtintype" id="2986846">int</span><span class="op" id="2986849">(</span><span class="ident" id="2986850">msg</span><span class="op" id="2986853">[</span><span class="ident" id="2986854">off</span><span class="op" id="2986857">]</span><span class="op" id="2986858">)</span>&nbsp;<span class="op" id="2986860">&gt;</span>&nbsp;<span class="builtinfunc" id="2986862">len</span><span class="op" id="2986865">(</span><span class="ident" id="2986866">msg</span><span class="op" id="2986869">)</span>&nbsp;<span class="op" id="2986871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986878">return</span>&nbsp;<span class="builtintype" id="2986885">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2986895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986901">n</span>&nbsp;<span class="op" id="2986903">:=</span>&nbsp;<span class="builtintype" id="2986906">int</span><span class="op" id="2986909">(</span><span class="ident" id="2986910">msg</span><span class="op" id="2986913">[</span><span class="ident" id="2986914">off</span><span class="op" id="2986917">]</span><span class="op" id="2986918">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986924">off</span><span class="op" id="2986927">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986934">b</span>&nbsp;<span class="op" id="2986936">:=</span>&nbsp;<span class="builtinfunc" id="2986939">make</span><span class="op" id="2986943">(</span><span class="op" id="2986944">[</span><span class="op" id="2986945">]</span><span class="builtintype" id="2986946">byte</span><span class="op" id="2986950">,</span>&nbsp;<span class="ident" id="2986952">n</span><span class="op" id="2986953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2986959">for</span>&nbsp;<span class="ident" id="2986963">i</span>&nbsp;<span class="op" id="2986965">:=</span>&nbsp;<span class="num" id="2986968">0</span><span class="op" id="2986969">;</span>&nbsp;<span class="ident" id="2986971">i</span>&nbsp;<span class="op" id="2986973">&lt;</span>&nbsp;<span class="ident" id="2986975">n</span><span class="op" id="2986976">;</span>&nbsp;<span class="ident" id="2986978">i</span><span class="op" id="2986979">++</span>&nbsp;<span class="op" id="2986982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2986989">b</span><span class="op" id="2986990">[</span><span class="ident" id="2986991">i</span><span class="op" id="2986992">]</span>&nbsp;<span class="op" id="2986994">=</span>&nbsp;<span class="ident" id="2986996">msg</span><span class="op" id="2986999">[</span><span class="ident" id="2987000">off</span><span class="op" id="2987003">+</span><span class="ident" id="2987004">i</span><span class="op" id="2987005">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987011">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987017">off</span>&nbsp;<span class="op" id="2987021">+=</span>&nbsp;<span class="ident" id="2987024">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987030">s</span>&nbsp;<span class="op" id="2987032">=</span>&nbsp;<span class="builtintype" id="2987034">string</span><span class="op" id="2987040">(</span><span class="ident" id="2987041">b</span><span class="op" id="2987042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987052">*</span><span class="ident" id="2987053">fv</span>&nbsp;<span class="op" id="2987056">=</span>&nbsp;<span class="ident" id="2987058">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987062">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987066">return</span>&nbsp;<span class="builtintype" id="2987073">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987079">}</span><span class="op" id="2987080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987083">if</span>&nbsp;<span class="op" id="2987086">!</span><span class="ident" id="2987087">ok</span>&nbsp;<span class="op" id="2987090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987094">return</span>&nbsp;<span class="builtinfunc" id="2987101">len</span><span class="op" id="2987104">(</span><span class="ident" id="2987105">msg</span><span class="op" id="2987108">)</span><span class="op" id="2987109">,</span>&nbsp;<span class="builtintype" id="2987111">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987118">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987121">return</span>&nbsp;<span class="ident" id="2987128">off</span><span class="op" id="2987131">,</span>&nbsp;<span class="builtintype" id="2987133">true</span><br>
<span class="lineno"></span><span class="op" id="2987138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2987141">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2987208">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="2987228">func</span>&nbsp;<span class="ident" id="2987233">printStruct</span><span class="op" id="2987244">(</span><span class="ident" id="2987245">any</span>&nbsp;<span class="ident" id="2987249">dnsStruct</span><span class="op" id="2987258">)</span>&nbsp;<span class="builtintype" id="2987260">string</span>&nbsp;<span class="op" id="2987267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987270">s</span>&nbsp;<span class="op" id="2987272">:=</span>&nbsp;<span class="string" id="2987275">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987280">i</span>&nbsp;<span class="op" id="2987282">:=</span>&nbsp;<span class="num" id="2987285">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987288">any</span><span class="op" id="2987291">.</span><span class="ident" id="2987292">Walk</span><span class="op" id="2987296">(</span><span class="keyword" id="2987297">func</span><span class="op" id="2987301">(</span><span class="ident" id="2987302">val</span>&nbsp;<span class="keyword" id="2987306">interface</span><span class="op" id="2987315">{</span><span class="op" id="2987316">}</span><span class="op" id="2987317">,</span>&nbsp;<span class="ident" id="2987319">name</span><span class="op" id="2987323">,</span>&nbsp;<span class="ident" id="2987325">tag</span>&nbsp;<span class="builtintype" id="2987329">string</span><span class="op" id="2987335">)</span>&nbsp;<span class="builtintype" id="2987337">bool</span>&nbsp;<span class="op" id="2987342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987346">i</span><span class="op" id="2987347">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987352">if</span>&nbsp;<span class="ident" id="2987355">i</span>&nbsp;<span class="op" id="2987357">&gt;</span>&nbsp;<span class="num" id="2987359">1</span>&nbsp;<span class="op" id="2987361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987366">s</span>&nbsp;<span class="op" id="2987368">+=</span>&nbsp;<span class="string" id="2987371">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987382">s</span>&nbsp;<span class="op" id="2987384">+=</span>&nbsp;<span class="ident" id="2987387">name</span>&nbsp;<span class="op" id="2987392">+</span>&nbsp;<span class="string" id="2987394">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987400">switch</span>&nbsp;<span class="ident" id="2987407">tag</span>&nbsp;<span class="op" id="2987411">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987415">case</span>&nbsp;<span class="string" id="2987420">&#34;ipv4&#34;</span><span class="op" id="2987426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987431">i</span>&nbsp;<span class="op" id="2987433">:=</span>&nbsp;<span class="op" id="2987436">*</span><span class="ident" id="2987437">val</span><span class="op" id="2987440">.</span><span class="op" id="2987441">(</span><span class="op" id="2987442">*</span><span class="builtintype" id="2987443">uint32</span><span class="op" id="2987449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987454">s</span>&nbsp;<span class="op" id="2987456">+=</span>&nbsp;<span class="ident" id="2987459">IPv4</span><span class="op" id="2987463">(</span><span class="builtintype" id="2987464">byte</span><span class="op" id="2987468">(</span><span class="ident" id="2987469">i</span><span class="op" id="2987470">&gt;&gt;</span><span class="num" id="2987472">24</span><span class="op" id="2987474">)</span><span class="op" id="2987475">,</span>&nbsp;<span class="builtintype" id="2987477">byte</span><span class="op" id="2987481">(</span><span class="ident" id="2987482">i</span><span class="op" id="2987483">&gt;&gt;</span><span class="num" id="2987485">16</span><span class="op" id="2987487">)</span><span class="op" id="2987488">,</span>&nbsp;<span class="builtintype" id="2987490">byte</span><span class="op" id="2987494">(</span><span class="ident" id="2987495">i</span><span class="op" id="2987496">&gt;&gt;</span><span class="num" id="2987498">8</span><span class="op" id="2987499">)</span><span class="op" id="2987500">,</span>&nbsp;<span class="builtintype" id="2987502">byte</span><span class="op" id="2987506">(</span><span class="ident" id="2987507">i</span><span class="op" id="2987508">)</span><span class="op" id="2987509">)</span><span class="op" id="2987510">.</span><span class="ident" id="2987511">String</span><span class="op" id="2987517">(</span><span class="op" id="2987518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987522">case</span>&nbsp;<span class="string" id="2987527">&#34;ipv6&#34;</span><span class="op" id="2987533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987538">i</span>&nbsp;<span class="op" id="2987540">:=</span>&nbsp;<span class="ident" id="2987543">val</span><span class="op" id="2987546">.</span><span class="op" id="2987547">(</span><span class="op" id="2987548">[</span><span class="op" id="2987549">]</span><span class="builtintype" id="2987550">byte</span><span class="op" id="2987554">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987559">s</span>&nbsp;<span class="op" id="2987561">+=</span>&nbsp;<span class="ident" id="2987564">IP</span><span class="op" id="2987566">(</span><span class="ident" id="2987567">i</span><span class="op" id="2987568">)</span><span class="op" id="2987569">.</span><span class="ident" id="2987570">String</span><span class="op" id="2987576">(</span><span class="op" id="2987577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987581">default</span><span class="op" id="2987588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987593">var</span>&nbsp;<span class="ident" id="2987597">i</span>&nbsp;<span class="ident" id="2987599">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987608">switch</span>&nbsp;<span class="ident" id="2987615">v</span>&nbsp;<span class="op" id="2987617">:=</span>&nbsp;<span class="ident" id="2987620">val</span><span class="op" id="2987623">.</span><span class="op" id="2987624">(</span><span class="keyword" id="2987625">type</span><span class="op" id="2987629">)</span>&nbsp;<span class="op" id="2987631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987636">default</span><span class="op" id="2987643">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2987649">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987677">s</span>&nbsp;<span class="op" id="2987679">+=</span>&nbsp;<span class="string" id="2987682">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987703">return</span>&nbsp;<span class="builtintype" id="2987710">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987718">case</span>&nbsp;<span class="op" id="2987723">*</span><span class="builtintype" id="2987724">string</span><span class="op" id="2987730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987736">s</span>&nbsp;<span class="op" id="2987738">+=</span>&nbsp;<span class="op" id="2987741">*</span><span class="ident" id="2987742">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987748">return</span>&nbsp;<span class="builtintype" id="2987755">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987763">case</span>&nbsp;<span class="op" id="2987768">[</span><span class="op" id="2987769">]</span><span class="builtintype" id="2987770">byte</span><span class="op" id="2987774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987780">s</span>&nbsp;<span class="op" id="2987782">+=</span>&nbsp;<span class="builtintype" id="2987785">string</span><span class="op" id="2987791">(</span><span class="ident" id="2987792">v</span><span class="op" id="2987793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987799">return</span>&nbsp;<span class="builtintype" id="2987806">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987814">case</span>&nbsp;<span class="op" id="2987819">*</span><span class="builtintype" id="2987820">bool</span><span class="op" id="2987824">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987830">if</span>&nbsp;<span class="op" id="2987833">*</span><span class="ident" id="2987834">v</span>&nbsp;<span class="op" id="2987836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987843">s</span>&nbsp;<span class="op" id="2987845">+=</span>&nbsp;<span class="string" id="2987848">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987859">}</span>&nbsp;<span class="keyword" id="2987861">else</span>&nbsp;<span class="op" id="2987866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987873">s</span>&nbsp;<span class="op" id="2987875">+=</span>&nbsp;<span class="string" id="2987878">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2987890">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987896">return</span>&nbsp;<span class="builtintype" id="2987903">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987911">case</span>&nbsp;<span class="op" id="2987916">*</span><span class="builtintype" id="2987917">int</span><span class="op" id="2987920">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987926">i</span>&nbsp;<span class="op" id="2987928">=</span>&nbsp;<span class="ident" id="2987930">int64</span><span class="op" id="2987935">(</span><span class="op" id="2987936">*</span><span class="ident" id="2987937">v</span><span class="op" id="2987938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987943">case</span>&nbsp;<span class="op" id="2987948">*</span><span class="builtintype" id="2987949">uint</span><span class="op" id="2987953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987959">i</span>&nbsp;<span class="op" id="2987961">=</span>&nbsp;<span class="ident" id="2987963">int64</span><span class="op" id="2987968">(</span><span class="op" id="2987969">*</span><span class="ident" id="2987970">v</span><span class="op" id="2987971">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2987976">case</span>&nbsp;<span class="op" id="2987981">*</span><span class="builtintype" id="2987982">uint8</span><span class="op" id="2987987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2987993">i</span>&nbsp;<span class="op" id="2987995">=</span>&nbsp;<span class="ident" id="2987997">int64</span><span class="op" id="2988002">(</span><span class="op" id="2988003">*</span><span class="ident" id="2988004">v</span><span class="op" id="2988005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988010">case</span>&nbsp;<span class="op" id="2988015">*</span><span class="builtintype" id="2988016">uint16</span><span class="op" id="2988022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988028">i</span>&nbsp;<span class="op" id="2988030">=</span>&nbsp;<span class="ident" id="2988032">int64</span><span class="op" id="2988037">(</span><span class="op" id="2988038">*</span><span class="ident" id="2988039">v</span><span class="op" id="2988040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988045">case</span>&nbsp;<span class="op" id="2988050">*</span><span class="builtintype" id="2988051">uint32</span><span class="op" id="2988057">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988063">i</span>&nbsp;<span class="op" id="2988065">=</span>&nbsp;<span class="ident" id="2988067">int64</span><span class="op" id="2988072">(</span><span class="op" id="2988073">*</span><span class="ident" id="2988074">v</span><span class="op" id="2988075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988080">case</span>&nbsp;<span class="op" id="2988085">*</span><span class="ident" id="2988086">uint64</span><span class="op" id="2988092">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988098">i</span>&nbsp;<span class="op" id="2988100">=</span>&nbsp;<span class="ident" id="2988102">int64</span><span class="op" id="2988107">(</span><span class="op" id="2988108">*</span><span class="ident" id="2988109">v</span><span class="op" id="2988110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988115">case</span>&nbsp;<span class="op" id="2988120">*</span><span class="builtintype" id="2988121">uintptr</span><span class="op" id="2988128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988134">i</span>&nbsp;<span class="op" id="2988136">=</span>&nbsp;<span class="ident" id="2988138">int64</span><span class="op" id="2988143">(</span><span class="op" id="2988144">*</span><span class="ident" id="2988145">v</span><span class="op" id="2988146">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2988151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988156">s</span>&nbsp;<span class="op" id="2988158">+=</span>&nbsp;<span class="ident" id="2988161">itoa</span><span class="op" id="2988165">(</span><span class="builtintype" id="2988166">int</span><span class="op" id="2988169">(</span><span class="ident" id="2988170">i</span><span class="op" id="2988171">)</span><span class="op" id="2988172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2988176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988180">return</span>&nbsp;<span class="builtintype" id="2988187">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2988193">}</span><span class="op" id="2988194">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988197">s</span>&nbsp;<span class="op" id="2988199">+=</span>&nbsp;<span class="string" id="2988202">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988207">return</span>&nbsp;<span class="ident" id="2988214">s</span><br>
<span class="lineno"></span><span class="op" id="2988216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2988219">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="2988246">func</span>&nbsp;<span class="ident" id="2988251">packRR</span><span class="op" id="2988257">(</span><span class="ident" id="2988258">rr</span>&nbsp;<span class="ident" id="2988261">dnsRR</span><span class="op" id="2988266">,</span>&nbsp;<span class="ident" id="2988268">msg</span>&nbsp;<span class="op" id="2988272">[</span><span class="op" id="2988273">]</span><span class="builtintype" id="2988274">byte</span><span class="op" id="2988278">,</span>&nbsp;<span class="ident" id="2988280">off</span>&nbsp;<span class="builtintype" id="2988284">int</span><span class="op" id="2988287">)</span>&nbsp;<span class="op" id="2988289">(</span><span class="ident" id="2988290">off2</span>&nbsp;<span class="builtintype" id="2988295">int</span><span class="op" id="2988298">,</span>&nbsp;<span class="ident" id="2988300">ok</span>&nbsp;<span class="builtintype" id="2988303">bool</span><span class="op" id="2988307">)</span>&nbsp;<span class="op" id="2988309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988312">var</span>&nbsp;<span class="ident" id="2988316">off1</span>&nbsp;<span class="builtintype" id="2988321">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2988326">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2988369">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2988406">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2988462">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2988488">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988510">off1</span><span class="op" id="2988514">,</span>&nbsp;<span class="ident" id="2988516">ok</span>&nbsp;<span class="op" id="2988519">=</span>&nbsp;<span class="ident" id="2988521">packStruct</span><span class="op" id="2988531">(</span><span class="ident" id="2988532">rr</span><span class="op" id="2988534">.</span><span class="ident" id="2988535">Header</span><span class="op" id="2988541">(</span><span class="op" id="2988542">)</span><span class="op" id="2988543">,</span>&nbsp;<span class="ident" id="2988545">msg</span><span class="op" id="2988548">,</span>&nbsp;<span class="ident" id="2988550">off</span><span class="op" id="2988553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988556">off2</span><span class="op" id="2988560">,</span>&nbsp;<span class="ident" id="2988562">ok</span>&nbsp;<span class="op" id="2988565">=</span>&nbsp;<span class="ident" id="2988567">packStruct</span><span class="op" id="2988577">(</span><span class="ident" id="2988578">rr</span><span class="op" id="2988580">,</span>&nbsp;<span class="ident" id="2988582">msg</span><span class="op" id="2988585">,</span>&nbsp;<span class="ident" id="2988587">off</span><span class="op" id="2988590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988593">if</span>&nbsp;<span class="op" id="2988596">!</span><span class="ident" id="2988597">ok</span>&nbsp;<span class="op" id="2988600">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988604">return</span>&nbsp;<span class="builtinfunc" id="2988611">len</span><span class="op" id="2988614">(</span><span class="ident" id="2988615">msg</span><span class="op" id="2988618">)</span><span class="op" id="2988619">,</span>&nbsp;<span class="builtintype" id="2988621">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2988628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2988631">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988691">rr</span><span class="op" id="2988693">.</span><span class="ident" id="2988694">Header</span><span class="op" id="2988700">(</span><span class="op" id="2988701">)</span><span class="op" id="2988702">.</span><span class="ident" id="2988703">Rdlength</span>&nbsp;<span class="op" id="2988712">=</span>&nbsp;<span class="builtintype" id="2988714">uint16</span><span class="op" id="2988720">(</span><span class="ident" id="2988721">off2</span>&nbsp;<span class="op" id="2988726">-</span>&nbsp;<span class="ident" id="2988728">off1</span><span class="op" id="2988732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988735">packStruct</span><span class="op" id="2988745">(</span><span class="ident" id="2988746">rr</span><span class="op" id="2988748">.</span><span class="ident" id="2988749">Header</span><span class="op" id="2988755">(</span><span class="op" id="2988756">)</span><span class="op" id="2988757">,</span>&nbsp;<span class="ident" id="2988759">msg</span><span class="op" id="2988762">,</span>&nbsp;<span class="ident" id="2988764">off</span><span class="op" id="2988767">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988770">return</span>&nbsp;<span class="ident" id="2988777">off2</span><span class="op" id="2988781">,</span>&nbsp;<span class="builtintype" id="2988783">true</span><br>
<span class="lineno"></span><span class="op" id="2988788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2988791">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="2988820">func</span>&nbsp;<span class="ident" id="2988825">unpackRR</span><span class="op" id="2988833">(</span><span class="ident" id="2988834">msg</span>&nbsp;<span class="op" id="2988838">[</span><span class="op" id="2988839">]</span><span class="builtintype" id="2988840">byte</span><span class="op" id="2988844">,</span>&nbsp;<span class="ident" id="2988846">off</span>&nbsp;<span class="builtintype" id="2988850">int</span><span class="op" id="2988853">)</span>&nbsp;<span class="op" id="2988855">(</span><span class="ident" id="2988856">rr</span>&nbsp;<span class="ident" id="2988859">dnsRR</span><span class="op" id="2988864">,</span>&nbsp;<span class="ident" id="2988866">off1</span>&nbsp;<span class="builtintype" id="2988871">int</span><span class="op" id="2988874">,</span>&nbsp;<span class="ident" id="2988876">ok</span>&nbsp;<span class="builtintype" id="2988879">bool</span><span class="op" id="2988883">)</span>&nbsp;<span class="op" id="2988885">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2988888">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988947">var</span>&nbsp;<span class="ident" id="2988951">h</span>&nbsp;<span class="ident" id="2988953">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2988967">off0</span>&nbsp;<span class="op" id="2988972">:=</span>&nbsp;<span class="ident" id="2988975">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2988980">if</span>&nbsp;<span class="ident" id="2988983">off</span><span class="op" id="2988986">,</span>&nbsp;<span class="ident" id="2988988">ok</span>&nbsp;<span class="op" id="2988991">=</span>&nbsp;<span class="ident" id="2988993">unpackStruct</span><span class="op" id="2989005">(</span><span class="op" id="2989006">&amp;</span><span class="ident" id="2989007">h</span><span class="op" id="2989008">,</span>&nbsp;<span class="ident" id="2989010">msg</span><span class="op" id="2989013">,</span>&nbsp;<span class="ident" id="2989015">off</span><span class="op" id="2989018">)</span><span class="op" id="2989019">;</span>&nbsp;<span class="op" id="2989021">!</span><span class="ident" id="2989022">ok</span>&nbsp;<span class="op" id="2989025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2989029">return</span>&nbsp;<span class="ident" id="2989036">nil</span><span class="op" id="2989039">,</span>&nbsp;<span class="builtinfunc" id="2989041">len</span><span class="op" id="2989044">(</span><span class="ident" id="2989045">msg</span><span class="op" id="2989048">)</span><span class="op" id="2989049">,</span>&nbsp;<span class="builtintype" id="2989051">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2989058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989061">end</span>&nbsp;<span class="op" id="2989065">:=</span>&nbsp;<span class="ident" id="2989068">off</span>&nbsp;<span class="op" id="2989072">+</span>&nbsp;<span class="builtintype" id="2989074">int</span><span class="op" id="2989077">(</span><span class="ident" id="2989078">h</span><span class="op" id="2989079">.</span><span class="ident" id="2989080">Rdlength</span><span class="op" id="2989088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2989092">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2989135">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989186">mk</span><span class="op" id="2989188">,</span>&nbsp;<span class="ident" id="2989190">known</span>&nbsp;<span class="op" id="2989196">:=</span>&nbsp;<span class="ident" id="2989199">rr_mk</span><span class="op" id="2989204">[</span><span class="builtintype" id="2989205">int</span><span class="op" id="2989208">(</span><span class="ident" id="2989209">h</span><span class="op" id="2989210">.</span><span class="ident" id="2989211">Rrtype</span><span class="op" id="2989217">)</span><span class="op" id="2989218">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2989221">if</span>&nbsp;<span class="op" id="2989224">!</span><span class="ident" id="2989225">known</span>&nbsp;<span class="op" id="2989231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2989235">return</span>&nbsp;<span class="op" id="2989242">&amp;</span><span class="ident" id="2989243">h</span><span class="op" id="2989244">,</span>&nbsp;<span class="ident" id="2989246">end</span><span class="op" id="2989249">,</span>&nbsp;<span class="builtintype" id="2989251">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2989257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989260">rr</span>&nbsp;<span class="op" id="2989263">=</span>&nbsp;<span class="ident" id="2989265">mk</span><span class="op" id="2989267">(</span><span class="op" id="2989268">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989271">off</span><span class="op" id="2989274">,</span>&nbsp;<span class="ident" id="2989276">ok</span>&nbsp;<span class="op" id="2989279">=</span>&nbsp;<span class="ident" id="2989281">unpackStruct</span><span class="op" id="2989293">(</span><span class="ident" id="2989294">rr</span><span class="op" id="2989296">,</span>&nbsp;<span class="ident" id="2989298">msg</span><span class="op" id="2989301">,</span>&nbsp;<span class="ident" id="2989303">off0</span><span class="op" id="2989307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2989310">if</span>&nbsp;<span class="ident" id="2989313">off</span>&nbsp;<span class="op" id="2989317">!=</span>&nbsp;<span class="ident" id="2989320">end</span>&nbsp;<span class="op" id="2989324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2989328">return</span>&nbsp;<span class="op" id="2989335">&amp;</span><span class="ident" id="2989336">h</span><span class="op" id="2989337">,</span>&nbsp;<span class="ident" id="2989339">end</span><span class="op" id="2989342">,</span>&nbsp;<span class="builtintype" id="2989344">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2989350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2989353">return</span>&nbsp;<span class="ident" id="2989360">rr</span><span class="op" id="2989362">,</span>&nbsp;<span class="ident" id="2989364">off</span><span class="op" id="2989367">,</span>&nbsp;<span class="ident" id="2989369">ok</span><br>
<span class="lineno">710</span><span class="op" id="2989372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2989375">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2989418">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="2989464">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="2989512">type</span>&nbsp;<span class="ident" id="2989517">dnsMsgHdr</span>&nbsp;<span class="keyword" id="2989527">struct</span>&nbsp;<span class="op" id="2989534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989537">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2989557">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989565">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2989585">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989591">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2989611">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989616">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2989636">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989642">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2989662">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989668">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2989688">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989694">recursion_available</span>&nbsp;<span class="builtintype" id="2989714">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989720">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2989740">int</span><br>
<span class="lineno">725</span><span class="op" id="2989744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2989747">func</span>&nbsp;<span class="op" id="2989752">(</span><span class="ident" id="2989753">h</span>&nbsp;<span class="op" id="2989755">*</span><span class="ident" id="2989756">dnsMsgHdr</span><span class="op" id="2989765">)</span>&nbsp;<span class="ident" id="2989767">Walk</span><span class="op" id="2989771">(</span><span class="ident" id="2989772">f</span>&nbsp;<span class="keyword" id="2989774">func</span><span class="op" id="2989778">(</span><span class="ident" id="2989779">v</span>&nbsp;<span class="keyword" id="2989781">interface</span><span class="op" id="2989790">{</span><span class="op" id="2989791">}</span><span class="op" id="2989792">,</span>&nbsp;<span class="ident" id="2989794">name</span><span class="op" id="2989798">,</span>&nbsp;<span class="ident" id="2989800">tag</span>&nbsp;<span class="builtintype" id="2989804">string</span><span class="op" id="2989810">)</span>&nbsp;<span class="builtintype" id="2989812">bool</span><span class="op" id="2989816">)</span>&nbsp;<span class="builtintype" id="2989818">bool</span>&nbsp;<span class="op" id="2989823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2989826">return</span>&nbsp;<span class="ident" id="2989833">f</span><span class="op" id="2989834">(</span><span class="op" id="2989835">&amp;</span><span class="ident" id="2989836">h</span><span class="op" id="2989837">.</span><span class="ident" id="2989838">id</span><span class="op" id="2989840">,</span>&nbsp;<span class="string" id="2989842">&#34;id&#34;</span><span class="op" id="2989846">,</span>&nbsp;<span class="string" id="2989848">&#34;&#34;</span><span class="op" id="2989850">)</span>&nbsp;<span class="op" id="2989852">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989857">f</span><span class="op" id="2989858">(</span><span class="op" id="2989859">&amp;</span><span class="ident" id="2989860">h</span><span class="op" id="2989861">.</span><span class="ident" id="2989862">response</span><span class="op" id="2989870">,</span>&nbsp;<span class="string" id="2989872">&#34;response&#34;</span><span class="op" id="2989882">,</span>&nbsp;<span class="string" id="2989884">&#34;&#34;</span><span class="op" id="2989886">)</span>&nbsp;<span class="op" id="2989888">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989893">f</span><span class="op" id="2989894">(</span><span class="op" id="2989895">&amp;</span><span class="ident" id="2989896">h</span><span class="op" id="2989897">.</span><span class="ident" id="2989898">opcode</span><span class="op" id="2989904">,</span>&nbsp;<span class="string" id="2989906">&#34;opcode&#34;</span><span class="op" id="2989914">,</span>&nbsp;<span class="string" id="2989916">&#34;&#34;</span><span class="op" id="2989918">)</span>&nbsp;<span class="op" id="2989920">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989925">f</span><span class="op" id="2989926">(</span><span class="op" id="2989927">&amp;</span><span class="ident" id="2989928">h</span><span class="op" id="2989929">.</span><span class="ident" id="2989930">authoritative</span><span class="op" id="2989943">,</span>&nbsp;<span class="string" id="2989945">&#34;authoritative&#34;</span><span class="op" id="2989960">,</span>&nbsp;<span class="string" id="2989962">&#34;&#34;</span><span class="op" id="2989964">)</span>&nbsp;<span class="op" id="2989966">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2989971">f</span><span class="op" id="2989972">(</span><span class="op" id="2989973">&amp;</span><span class="ident" id="2989974">h</span><span class="op" id="2989975">.</span><span class="ident" id="2989976">truncated</span><span class="op" id="2989985">,</span>&nbsp;<span class="string" id="2989987">&#34;truncated&#34;</span><span class="op" id="2989998">,</span>&nbsp;<span class="string" id="2990000">&#34;&#34;</span><span class="op" id="2990002">)</span>&nbsp;<span class="op" id="2990004">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990009">f</span><span class="op" id="2990010">(</span><span class="op" id="2990011">&amp;</span><span class="ident" id="2990012">h</span><span class="op" id="2990013">.</span><span class="ident" id="2990014">recursion_desired</span><span class="op" id="2990031">,</span>&nbsp;<span class="string" id="2990033">&#34;recursion_desired&#34;</span><span class="op" id="2990052">,</span>&nbsp;<span class="string" id="2990054">&#34;&#34;</span><span class="op" id="2990056">)</span>&nbsp;<span class="op" id="2990058">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990063">f</span><span class="op" id="2990064">(</span><span class="op" id="2990065">&amp;</span><span class="ident" id="2990066">h</span><span class="op" id="2990067">.</span><span class="ident" id="2990068">recursion_available</span><span class="op" id="2990087">,</span>&nbsp;<span class="string" id="2990089">&#34;recursion_available&#34;</span><span class="op" id="2990110">,</span>&nbsp;<span class="string" id="2990112">&#34;&#34;</span><span class="op" id="2990114">)</span>&nbsp;<span class="op" id="2990116">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990121">f</span><span class="op" id="2990122">(</span><span class="op" id="2990123">&amp;</span><span class="ident" id="2990124">h</span><span class="op" id="2990125">.</span><span class="ident" id="2990126">rcode</span><span class="op" id="2990131">,</span>&nbsp;<span class="string" id="2990133">&#34;rcode&#34;</span><span class="op" id="2990140">,</span>&nbsp;<span class="string" id="2990142">&#34;&#34;</span><span class="op" id="2990144">)</span><br>
<span class="lineno"></span><span class="op" id="2990146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2990149">type</span>&nbsp;<span class="ident" id="2990154">dnsMsg</span>&nbsp;<span class="keyword" id="2990161">struct</span>&nbsp;<span class="op" id="2990168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990171">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990182">question</span>&nbsp;<span class="op" id="2990191">[</span><span class="op" id="2990192">]</span><span class="ident" id="2990193">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990206">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2990215">[</span><span class="op" id="2990216">]</span><span class="ident" id="2990217">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990224">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2990233">[</span><span class="op" id="2990234">]</span><span class="ident" id="2990235">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990242">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2990251">[</span><span class="op" id="2990252">]</span><span class="ident" id="2990253">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="2990259">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="2990262">func</span>&nbsp;<span class="op" id="2990267">(</span><span class="ident" id="2990268">dns</span>&nbsp;<span class="op" id="2990272">*</span><span class="ident" id="2990273">dnsMsg</span><span class="op" id="2990279">)</span>&nbsp;<span class="ident" id="2990281">Pack</span><span class="op" id="2990285">(</span><span class="op" id="2990286">)</span>&nbsp;<span class="op" id="2990288">(</span><span class="ident" id="2990289">msg</span>&nbsp;<span class="op" id="2990293">[</span><span class="op" id="2990294">]</span><span class="builtintype" id="2990295">byte</span><span class="op" id="2990299">,</span>&nbsp;<span class="ident" id="2990301">ok</span>&nbsp;<span class="builtintype" id="2990304">bool</span><span class="op" id="2990308">)</span>&nbsp;<span class="op" id="2990310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2990313">var</span>&nbsp;<span class="ident" id="2990317">dh</span>&nbsp;<span class="ident" id="2990320">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2990332">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990388">dh</span><span class="op" id="2990390">.</span><span class="ident" id="2990391">Id</span>&nbsp;<span class="op" id="2990394">=</span>&nbsp;<span class="ident" id="2990396">dns</span><span class="op" id="2990399">.</span><span class="ident" id="2990400">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990404">dh</span><span class="op" id="2990406">.</span><span class="ident" id="2990407">Bits</span>&nbsp;<span class="op" id="2990412">=</span>&nbsp;<span class="builtintype" id="2990414">uint16</span><span class="op" id="2990420">(</span><span class="ident" id="2990421">dns</span><span class="op" id="2990424">.</span><span class="ident" id="2990425">opcode</span><span class="op" id="2990431">)</span><span class="op" id="2990432">&lt;&lt;</span><span class="num" id="2990434">11</span>&nbsp;<span class="op" id="2990437">|</span>&nbsp;<span class="builtintype" id="2990439">uint16</span><span class="op" id="2990445">(</span><span class="ident" id="2990446">dns</span><span class="op" id="2990449">.</span><span class="ident" id="2990450">rcode</span><span class="op" id="2990455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2990458">if</span>&nbsp;<span class="ident" id="2990461">dns</span><span class="op" id="2990464">.</span><span class="ident" id="2990465">recursion_available</span>&nbsp;<span class="op" id="2990485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990489">dh</span><span class="op" id="2990491">.</span><span class="ident" id="2990492">Bits</span>&nbsp;<span class="op" id="2990497">|=</span>&nbsp;<span class="ident" id="2990500">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2990505">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2990508">if</span>&nbsp;<span class="ident" id="2990511">dns</span><span class="op" id="2990514">.</span><span class="ident" id="2990515">recursion_desired</span>&nbsp;<span class="op" id="2990533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990537">dh</span><span class="op" id="2990539">.</span><span class="ident" id="2990540">Bits</span>&nbsp;<span class="op" id="2990545">|=</span>&nbsp;<span class="ident" id="2990548">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2990553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2990556">if</span>&nbsp;<span class="ident" id="2990559">dns</span><span class="op" id="2990562">.</span><span class="ident" id="2990563">truncated</span>&nbsp;<span class="op" id="2990573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990577">dh</span><span class="op" id="2990579">.</span><span class="ident" id="2990580">Bits</span>&nbsp;<span class="op" id="2990585">|=</span>&nbsp;<span class="ident" id="2990588">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2990593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2990596">if</span>&nbsp;<span class="ident" id="2990599">dns</span><span class="op" id="2990602">.</span><span class="ident" id="2990603">authoritative</span>&nbsp;<span class="op" id="2990617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990621">dh</span><span class="op" id="2990623">.</span><span class="ident" id="2990624">Bits</span>&nbsp;<span class="op" id="2990629">|=</span>&nbsp;<span class="ident" id="2990632">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2990637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2990640">if</span>&nbsp;<span class="ident" id="2990643">dns</span><span class="op" id="2990646">.</span><span class="ident" id="2990647">response</span>&nbsp;<span class="op" id="2990656">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990660">dh</span><span class="op" id="2990662">.</span><span class="ident" id="2990663">Bits</span>&nbsp;<span class="op" id="2990668">|=</span>&nbsp;<span class="ident" id="2990671">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2990676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2990680">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990715">question</span>&nbsp;<span class="op" id="2990724">:=</span>&nbsp;<span class="ident" id="2990727">dns</span><span class="op" id="2990730">.</span><span class="ident" id="2990731">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990741">answer</span>&nbsp;<span class="op" id="2990748">:=</span>&nbsp;<span class="ident" id="2990751">dns</span><span class="op" id="2990754">.</span><span class="ident" id="2990755">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990763">ns</span>&nbsp;<span class="op" id="2990766">:=</span>&nbsp;<span class="ident" id="2990769">dns</span><span class="op" id="2990772">.</span><span class="ident" id="2990773">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990777">extra</span>&nbsp;<span class="op" id="2990783">:=</span>&nbsp;<span class="ident" id="2990786">dns</span><span class="op" id="2990789">.</span><span class="ident" id="2990790">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990798">dh</span><span class="op" id="2990800">.</span><span class="ident" id="2990801">Qdcount</span>&nbsp;<span class="op" id="2990809">=</span>&nbsp;<span class="builtintype" id="2990811">uint16</span><span class="op" id="2990817">(</span><span class="builtinfunc" id="2990818">len</span><span class="op" id="2990821">(</span><span class="ident" id="2990822">question</span><span class="op" id="2990830">)</span><span class="op" id="2990831">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990834">dh</span><span class="op" id="2990836">.</span><span class="ident" id="2990837">Ancount</span>&nbsp;<span class="op" id="2990845">=</span>&nbsp;<span class="builtintype" id="2990847">uint16</span><span class="op" id="2990853">(</span><span class="builtinfunc" id="2990854">len</span><span class="op" id="2990857">(</span><span class="ident" id="2990858">answer</span><span class="op" id="2990864">)</span><span class="op" id="2990865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990868">dh</span><span class="op" id="2990870">.</span><span class="ident" id="2990871">Nscount</span>&nbsp;<span class="op" id="2990879">=</span>&nbsp;<span class="builtintype" id="2990881">uint16</span><span class="op" id="2990887">(</span><span class="builtinfunc" id="2990888">len</span><span class="op" id="2990891">(</span><span class="ident" id="2990892">ns</span><span class="op" id="2990894">)</span><span class="op" id="2990895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2990898">dh</span><span class="op" id="2990900">.</span><span class="ident" id="2990901">Arcount</span>&nbsp;<span class="op" id="2990909">=</span>&nbsp;<span class="builtintype" id="2990911">uint16</span><span class="op" id="2990917">(</span><span class="builtinfunc" id="2990918">len</span><span class="op" id="2990921">(</span><span class="ident" id="2990922">extra</span><span class="op" id="2990927">)</span><span class="op" id="2990928">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2990932">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2990981">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2991027">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991065">msg</span>&nbsp;<span class="op" id="2991069">=</span>&nbsp;<span class="builtinfunc" id="2991071">make</span><span class="op" id="2991075">(</span><span class="op" id="2991076">[</span><span class="op" id="2991077">]</span><span class="builtintype" id="2991078">byte</span><span class="op" id="2991082">,</span>&nbsp;<span class="num" id="2991084">2000</span><span class="op" id="2991088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2991092">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991136">off</span>&nbsp;<span class="op" id="2991140">:=</span>&nbsp;<span class="num" id="2991143">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991146">off</span><span class="op" id="2991149">,</span>&nbsp;<span class="ident" id="2991151">ok</span>&nbsp;<span class="op" id="2991154">=</span>&nbsp;<span class="ident" id="2991156">packStruct</span><span class="op" id="2991166">(</span><span class="op" id="2991167">&amp;</span><span class="ident" id="2991168">dh</span><span class="op" id="2991170">,</span>&nbsp;<span class="ident" id="2991172">msg</span><span class="op" id="2991175">,</span>&nbsp;<span class="ident" id="2991177">off</span><span class="op" id="2991180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991183">for</span>&nbsp;<span class="ident" id="2991187">i</span>&nbsp;<span class="op" id="2991189">:=</span>&nbsp;<span class="num" id="2991192">0</span><span class="op" id="2991193">;</span>&nbsp;<span class="ident" id="2991195">i</span>&nbsp;<span class="op" id="2991197">&lt;</span>&nbsp;<span class="builtinfunc" id="2991199">len</span><span class="op" id="2991202">(</span><span class="ident" id="2991203">question</span><span class="op" id="2991211">)</span><span class="op" id="2991212">;</span>&nbsp;<span class="ident" id="2991214">i</span><span class="op" id="2991215">++</span>&nbsp;<span class="op" id="2991218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991222">off</span><span class="op" id="2991225">,</span>&nbsp;<span class="ident" id="2991227">ok</span>&nbsp;<span class="op" id="2991230">=</span>&nbsp;<span class="ident" id="2991232">packStruct</span><span class="op" id="2991242">(</span><span class="op" id="2991243">&amp;</span><span class="ident" id="2991244">question</span><span class="op" id="2991252">[</span><span class="ident" id="2991253">i</span><span class="op" id="2991254">]</span><span class="op" id="2991255">,</span>&nbsp;<span class="ident" id="2991257">msg</span><span class="op" id="2991260">,</span>&nbsp;<span class="ident" id="2991262">off</span><span class="op" id="2991265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2991268">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991271">for</span>&nbsp;<span class="ident" id="2991275">i</span>&nbsp;<span class="op" id="2991277">:=</span>&nbsp;<span class="num" id="2991280">0</span><span class="op" id="2991281">;</span>&nbsp;<span class="ident" id="2991283">i</span>&nbsp;<span class="op" id="2991285">&lt;</span>&nbsp;<span class="builtinfunc" id="2991287">len</span><span class="op" id="2991290">(</span><span class="ident" id="2991291">answer</span><span class="op" id="2991297">)</span><span class="op" id="2991298">;</span>&nbsp;<span class="ident" id="2991300">i</span><span class="op" id="2991301">++</span>&nbsp;<span class="op" id="2991304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991308">off</span><span class="op" id="2991311">,</span>&nbsp;<span class="ident" id="2991313">ok</span>&nbsp;<span class="op" id="2991316">=</span>&nbsp;<span class="ident" id="2991318">packRR</span><span class="op" id="2991324">(</span><span class="ident" id="2991325">answer</span><span class="op" id="2991331">[</span><span class="ident" id="2991332">i</span><span class="op" id="2991333">]</span><span class="op" id="2991334">,</span>&nbsp;<span class="ident" id="2991336">msg</span><span class="op" id="2991339">,</span>&nbsp;<span class="ident" id="2991341">off</span><span class="op" id="2991344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2991347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991350">for</span>&nbsp;<span class="ident" id="2991354">i</span>&nbsp;<span class="op" id="2991356">:=</span>&nbsp;<span class="num" id="2991359">0</span><span class="op" id="2991360">;</span>&nbsp;<span class="ident" id="2991362">i</span>&nbsp;<span class="op" id="2991364">&lt;</span>&nbsp;<span class="builtinfunc" id="2991366">len</span><span class="op" id="2991369">(</span><span class="ident" id="2991370">ns</span><span class="op" id="2991372">)</span><span class="op" id="2991373">;</span>&nbsp;<span class="ident" id="2991375">i</span><span class="op" id="2991376">++</span>&nbsp;<span class="op" id="2991379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991383">off</span><span class="op" id="2991386">,</span>&nbsp;<span class="ident" id="2991388">ok</span>&nbsp;<span class="op" id="2991391">=</span>&nbsp;<span class="ident" id="2991393">packRR</span><span class="op" id="2991399">(</span><span class="ident" id="2991400">ns</span><span class="op" id="2991402">[</span><span class="ident" id="2991403">i</span><span class="op" id="2991404">]</span><span class="op" id="2991405">,</span>&nbsp;<span class="ident" id="2991407">msg</span><span class="op" id="2991410">,</span>&nbsp;<span class="ident" id="2991412">off</span><span class="op" id="2991415">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2991418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991421">for</span>&nbsp;<span class="ident" id="2991425">i</span>&nbsp;<span class="op" id="2991427">:=</span>&nbsp;<span class="num" id="2991430">0</span><span class="op" id="2991431">;</span>&nbsp;<span class="ident" id="2991433">i</span>&nbsp;<span class="op" id="2991435">&lt;</span>&nbsp;<span class="builtinfunc" id="2991437">len</span><span class="op" id="2991440">(</span><span class="ident" id="2991441">extra</span><span class="op" id="2991446">)</span><span class="op" id="2991447">;</span>&nbsp;<span class="ident" id="2991449">i</span><span class="op" id="2991450">++</span>&nbsp;<span class="op" id="2991453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991457">off</span><span class="op" id="2991460">,</span>&nbsp;<span class="ident" id="2991462">ok</span>&nbsp;<span class="op" id="2991465">=</span>&nbsp;<span class="ident" id="2991467">packRR</span><span class="op" id="2991473">(</span><span class="ident" id="2991474">extra</span><span class="op" id="2991479">[</span><span class="ident" id="2991480">i</span><span class="op" id="2991481">]</span><span class="op" id="2991482">,</span>&nbsp;<span class="ident" id="2991484">msg</span><span class="op" id="2991487">,</span>&nbsp;<span class="ident" id="2991489">off</span><span class="op" id="2991492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2991495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991498">if</span>&nbsp;<span class="op" id="2991501">!</span><span class="ident" id="2991502">ok</span>&nbsp;<span class="op" id="2991505">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991509">return</span>&nbsp;<span class="ident" id="2991516">nil</span><span class="op" id="2991519">,</span>&nbsp;<span class="builtintype" id="2991521">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2991528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991531">return</span>&nbsp;<span class="ident" id="2991538">msg</span><span class="op" id="2991541">[</span><span class="num" id="2991542">0</span><span class="op" id="2991543">:</span><span class="ident" id="2991544">off</span><span class="op" id="2991547">]</span><span class="op" id="2991548">,</span>&nbsp;<span class="builtintype" id="2991550">true</span><br>
<span class="lineno"></span><span class="op" id="2991555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="2991558">func</span>&nbsp;<span class="op" id="2991563">(</span><span class="ident" id="2991564">dns</span>&nbsp;<span class="op" id="2991568">*</span><span class="ident" id="2991569">dnsMsg</span><span class="op" id="2991575">)</span>&nbsp;<span class="ident" id="2991577">Unpack</span><span class="op" id="2991583">(</span><span class="ident" id="2991584">msg</span>&nbsp;<span class="op" id="2991588">[</span><span class="op" id="2991589">]</span><span class="builtintype" id="2991590">byte</span><span class="op" id="2991594">)</span>&nbsp;<span class="builtintype" id="2991596">bool</span>&nbsp;<span class="op" id="2991601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2991604">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991616">var</span>&nbsp;<span class="ident" id="2991620">dh</span>&nbsp;<span class="ident" id="2991623">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991634">off</span>&nbsp;<span class="op" id="2991638">:=</span>&nbsp;<span class="num" id="2991641">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991644">var</span>&nbsp;<span class="ident" id="2991648">ok</span>&nbsp;<span class="builtintype" id="2991651">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991657">if</span>&nbsp;<span class="ident" id="2991660">off</span><span class="op" id="2991663">,</span>&nbsp;<span class="ident" id="2991665">ok</span>&nbsp;<span class="op" id="2991668">=</span>&nbsp;<span class="ident" id="2991670">unpackStruct</span><span class="op" id="2991682">(</span><span class="op" id="2991683">&amp;</span><span class="ident" id="2991684">dh</span><span class="op" id="2991686">,</span>&nbsp;<span class="ident" id="2991688">msg</span><span class="op" id="2991691">,</span>&nbsp;<span class="ident" id="2991693">off</span><span class="op" id="2991696">)</span><span class="op" id="2991697">;</span>&nbsp;<span class="op" id="2991699">!</span><span class="ident" id="2991700">ok</span>&nbsp;<span class="op" id="2991703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2991707">return</span>&nbsp;<span class="builtintype" id="2991714">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2991721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991724">dns</span><span class="op" id="2991727">.</span><span class="ident" id="2991728">id</span>&nbsp;<span class="op" id="2991731">=</span>&nbsp;<span class="ident" id="2991733">dh</span><span class="op" id="2991735">.</span><span class="ident" id="2991736">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991740">dns</span><span class="op" id="2991743">.</span><span class="ident" id="2991744">response</span>&nbsp;<span class="op" id="2991753">=</span>&nbsp;<span class="op" id="2991755">(</span><span class="ident" id="2991756">dh</span><span class="op" id="2991758">.</span><span class="ident" id="2991759">Bits</span>&nbsp;<span class="op" id="2991764">&amp;</span>&nbsp;<span class="ident" id="2991766">_QR</span><span class="op" id="2991769">)</span>&nbsp;<span class="op" id="2991771">!=</span>&nbsp;<span class="num" id="2991774">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991777">dns</span><span class="op" id="2991780">.</span><span class="ident" id="2991781">opcode</span>&nbsp;<span class="op" id="2991788">=</span>&nbsp;<span class="builtintype" id="2991790">int</span><span class="op" id="2991793">(</span><span class="ident" id="2991794">dh</span><span class="op" id="2991796">.</span><span class="ident" id="2991797">Bits</span><span class="op" id="2991801">&gt;&gt;</span><span class="num" id="2991803">11</span><span class="op" id="2991805">)</span>&nbsp;<span class="op" id="2991807">&amp;</span>&nbsp;<span class="num" id="2991809">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991814">dns</span><span class="op" id="2991817">.</span><span class="ident" id="2991818">authoritative</span>&nbsp;<span class="op" id="2991832">=</span>&nbsp;<span class="op" id="2991834">(</span><span class="ident" id="2991835">dh</span><span class="op" id="2991837">.</span><span class="ident" id="2991838">Bits</span>&nbsp;<span class="op" id="2991843">&amp;</span>&nbsp;<span class="ident" id="2991845">_AA</span><span class="op" id="2991848">)</span>&nbsp;<span class="op" id="2991850">!=</span>&nbsp;<span class="num" id="2991853">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991856">dns</span><span class="op" id="2991859">.</span><span class="ident" id="2991860">truncated</span>&nbsp;<span class="op" id="2991870">=</span>&nbsp;<span class="op" id="2991872">(</span><span class="ident" id="2991873">dh</span><span class="op" id="2991875">.</span><span class="ident" id="2991876">Bits</span>&nbsp;<span class="op" id="2991881">&amp;</span>&nbsp;<span class="ident" id="2991883">_TC</span><span class="op" id="2991886">)</span>&nbsp;<span class="op" id="2991888">!=</span>&nbsp;<span class="num" id="2991891">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991894">dns</span><span class="op" id="2991897">.</span><span class="ident" id="2991898">recursion_desired</span>&nbsp;<span class="op" id="2991916">=</span>&nbsp;<span class="op" id="2991918">(</span><span class="ident" id="2991919">dh</span><span class="op" id="2991921">.</span><span class="ident" id="2991922">Bits</span>&nbsp;<span class="op" id="2991927">&amp;</span>&nbsp;<span class="ident" id="2991929">_RD</span><span class="op" id="2991932">)</span>&nbsp;<span class="op" id="2991934">!=</span>&nbsp;<span class="num" id="2991937">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991940">dns</span><span class="op" id="2991943">.</span><span class="ident" id="2991944">recursion_available</span>&nbsp;<span class="op" id="2991964">=</span>&nbsp;<span class="op" id="2991966">(</span><span class="ident" id="2991967">dh</span><span class="op" id="2991969">.</span><span class="ident" id="2991970">Bits</span>&nbsp;<span class="op" id="2991975">&amp;</span>&nbsp;<span class="ident" id="2991977">_RA</span><span class="op" id="2991980">)</span>&nbsp;<span class="op" id="2991982">!=</span>&nbsp;<span class="num" id="2991985">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2991988">dns</span><span class="op" id="2991991">.</span><span class="ident" id="2991992">rcode</span>&nbsp;<span class="op" id="2991998">=</span>&nbsp;<span class="builtintype" id="2992000">int</span><span class="op" id="2992003">(</span><span class="ident" id="2992004">dh</span><span class="op" id="2992006">.</span><span class="ident" id="2992007">Bits</span>&nbsp;<span class="op" id="2992012">&amp;</span>&nbsp;<span class="num" id="2992014">0xF</span><span class="op" id="2992017">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2992021">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992033">dns</span><span class="op" id="2992036">.</span><span class="ident" id="2992037">question</span>&nbsp;<span class="op" id="2992046">=</span>&nbsp;<span class="builtinfunc" id="2992048">make</span><span class="op" id="2992052">(</span><span class="op" id="2992053">[</span><span class="op" id="2992054">]</span><span class="ident" id="2992055">dnsQuestion</span><span class="op" id="2992066">,</span>&nbsp;<span class="ident" id="2992068">dh</span><span class="op" id="2992070">.</span><span class="ident" id="2992071">Qdcount</span><span class="op" id="2992078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992081">dns</span><span class="op" id="2992084">.</span><span class="ident" id="2992085">answer</span>&nbsp;<span class="op" id="2992092">=</span>&nbsp;<span class="builtinfunc" id="2992094">make</span><span class="op" id="2992098">(</span><span class="op" id="2992099">[</span><span class="op" id="2992100">]</span><span class="ident" id="2992101">dnsRR</span><span class="op" id="2992106">,</span>&nbsp;<span class="num" id="2992108">0</span><span class="op" id="2992109">,</span>&nbsp;<span class="ident" id="2992111">dh</span><span class="op" id="2992113">.</span><span class="ident" id="2992114">Ancount</span><span class="op" id="2992121">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992124">dns</span><span class="op" id="2992127">.</span><span class="ident" id="2992128">ns</span>&nbsp;<span class="op" id="2992131">=</span>&nbsp;<span class="builtinfunc" id="2992133">make</span><span class="op" id="2992137">(</span><span class="op" id="2992138">[</span><span class="op" id="2992139">]</span><span class="ident" id="2992140">dnsRR</span><span class="op" id="2992145">,</span>&nbsp;<span class="num" id="2992147">0</span><span class="op" id="2992148">,</span>&nbsp;<span class="ident" id="2992150">dh</span><span class="op" id="2992152">.</span><span class="ident" id="2992153">Nscount</span><span class="op" id="2992160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992163">dns</span><span class="op" id="2992166">.</span><span class="ident" id="2992167">extra</span>&nbsp;<span class="op" id="2992173">=</span>&nbsp;<span class="builtinfunc" id="2992175">make</span><span class="op" id="2992179">(</span><span class="op" id="2992180">[</span><span class="op" id="2992181">]</span><span class="ident" id="2992182">dnsRR</span><span class="op" id="2992187">,</span>&nbsp;<span class="num" id="2992189">0</span><span class="op" id="2992190">,</span>&nbsp;<span class="ident" id="2992192">dh</span><span class="op" id="2992194">.</span><span class="ident" id="2992195">Arcount</span><span class="op" id="2992202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992206">var</span>&nbsp;<span class="ident" id="2992210">rec</span>&nbsp;<span class="ident" id="2992214">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992222">for</span>&nbsp;<span class="ident" id="2992226">i</span>&nbsp;<span class="op" id="2992228">:=</span>&nbsp;<span class="num" id="2992231">0</span><span class="op" id="2992232">;</span>&nbsp;<span class="ident" id="2992234">i</span>&nbsp;<span class="op" id="2992236">&lt;</span>&nbsp;<span class="builtinfunc" id="2992238">len</span><span class="op" id="2992241">(</span><span class="ident" id="2992242">dns</span><span class="op" id="2992245">.</span><span class="ident" id="2992246">question</span><span class="op" id="2992254">)</span><span class="op" id="2992255">;</span>&nbsp;<span class="ident" id="2992257">i</span><span class="op" id="2992258">++</span>&nbsp;<span class="op" id="2992261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992265">off</span><span class="op" id="2992268">,</span>&nbsp;<span class="ident" id="2992270">ok</span>&nbsp;<span class="op" id="2992273">=</span>&nbsp;<span class="ident" id="2992275">unpackStruct</span><span class="op" id="2992287">(</span><span class="op" id="2992288">&amp;</span><span class="ident" id="2992289">dns</span><span class="op" id="2992292">.</span><span class="ident" id="2992293">question</span><span class="op" id="2992301">[</span><span class="ident" id="2992302">i</span><span class="op" id="2992303">]</span><span class="op" id="2992304">,</span>&nbsp;<span class="ident" id="2992306">msg</span><span class="op" id="2992309">,</span>&nbsp;<span class="ident" id="2992311">off</span><span class="op" id="2992314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2992317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992320">for</span>&nbsp;<span class="ident" id="2992324">i</span>&nbsp;<span class="op" id="2992326">:=</span>&nbsp;<span class="num" id="2992329">0</span><span class="op" id="2992330">;</span>&nbsp;<span class="ident" id="2992332">i</span>&nbsp;<span class="op" id="2992334">&lt;</span>&nbsp;<span class="builtintype" id="2992336">int</span><span class="op" id="2992339">(</span><span class="ident" id="2992340">dh</span><span class="op" id="2992342">.</span><span class="ident" id="2992343">Ancount</span><span class="op" id="2992350">)</span><span class="op" id="2992351">;</span>&nbsp;<span class="ident" id="2992353">i</span><span class="op" id="2992354">++</span>&nbsp;<span class="op" id="2992357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992361">rec</span><span class="op" id="2992364">,</span>&nbsp;<span class="ident" id="2992366">off</span><span class="op" id="2992369">,</span>&nbsp;<span class="ident" id="2992371">ok</span>&nbsp;<span class="op" id="2992374">=</span>&nbsp;<span class="ident" id="2992376">unpackRR</span><span class="op" id="2992384">(</span><span class="ident" id="2992385">msg</span><span class="op" id="2992388">,</span>&nbsp;<span class="ident" id="2992390">off</span><span class="op" id="2992393">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992397">if</span>&nbsp;<span class="op" id="2992400">!</span><span class="ident" id="2992401">ok</span>&nbsp;<span class="op" id="2992404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992409">return</span>&nbsp;<span class="builtintype" id="2992416">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2992424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992428">dns</span><span class="op" id="2992431">.</span><span class="ident" id="2992432">answer</span>&nbsp;<span class="op" id="2992439">=</span>&nbsp;<span class="builtinfunc" id="2992441">append</span><span class="op" id="2992447">(</span><span class="ident" id="2992448">dns</span><span class="op" id="2992451">.</span><span class="ident" id="2992452">answer</span><span class="op" id="2992458">,</span>&nbsp;<span class="ident" id="2992460">rec</span><span class="op" id="2992463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2992466">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992469">for</span>&nbsp;<span class="ident" id="2992473">i</span>&nbsp;<span class="op" id="2992475">:=</span>&nbsp;<span class="num" id="2992478">0</span><span class="op" id="2992479">;</span>&nbsp;<span class="ident" id="2992481">i</span>&nbsp;<span class="op" id="2992483">&lt;</span>&nbsp;<span class="builtintype" id="2992485">int</span><span class="op" id="2992488">(</span><span class="ident" id="2992489">dh</span><span class="op" id="2992491">.</span><span class="ident" id="2992492">Nscount</span><span class="op" id="2992499">)</span><span class="op" id="2992500">;</span>&nbsp;<span class="ident" id="2992502">i</span><span class="op" id="2992503">++</span>&nbsp;<span class="op" id="2992506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992510">rec</span><span class="op" id="2992513">,</span>&nbsp;<span class="ident" id="2992515">off</span><span class="op" id="2992518">,</span>&nbsp;<span class="ident" id="2992520">ok</span>&nbsp;<span class="op" id="2992523">=</span>&nbsp;<span class="ident" id="2992525">unpackRR</span><span class="op" id="2992533">(</span><span class="ident" id="2992534">msg</span><span class="op" id="2992537">,</span>&nbsp;<span class="ident" id="2992539">off</span><span class="op" id="2992542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992546">if</span>&nbsp;<span class="op" id="2992549">!</span><span class="ident" id="2992550">ok</span>&nbsp;<span class="op" id="2992553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992558">return</span>&nbsp;<span class="builtintype" id="2992565">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2992573">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992577">dns</span><span class="op" id="2992580">.</span><span class="ident" id="2992581">ns</span>&nbsp;<span class="op" id="2992584">=</span>&nbsp;<span class="builtinfunc" id="2992586">append</span><span class="op" id="2992592">(</span><span class="ident" id="2992593">dns</span><span class="op" id="2992596">.</span><span class="ident" id="2992597">ns</span><span class="op" id="2992599">,</span>&nbsp;<span class="ident" id="2992601">rec</span><span class="op" id="2992604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2992607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992610">for</span>&nbsp;<span class="ident" id="2992614">i</span>&nbsp;<span class="op" id="2992616">:=</span>&nbsp;<span class="num" id="2992619">0</span><span class="op" id="2992620">;</span>&nbsp;<span class="ident" id="2992622">i</span>&nbsp;<span class="op" id="2992624">&lt;</span>&nbsp;<span class="builtintype" id="2992626">int</span><span class="op" id="2992629">(</span><span class="ident" id="2992630">dh</span><span class="op" id="2992632">.</span><span class="ident" id="2992633">Arcount</span><span class="op" id="2992640">)</span><span class="op" id="2992641">;</span>&nbsp;<span class="ident" id="2992643">i</span><span class="op" id="2992644">++</span>&nbsp;<span class="op" id="2992647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992651">rec</span><span class="op" id="2992654">,</span>&nbsp;<span class="ident" id="2992656">off</span><span class="op" id="2992659">,</span>&nbsp;<span class="ident" id="2992661">ok</span>&nbsp;<span class="op" id="2992664">=</span>&nbsp;<span class="ident" id="2992666">unpackRR</span><span class="op" id="2992674">(</span><span class="ident" id="2992675">msg</span><span class="op" id="2992678">,</span>&nbsp;<span class="ident" id="2992680">off</span><span class="op" id="2992683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992687">if</span>&nbsp;<span class="op" id="2992690">!</span><span class="ident" id="2992691">ok</span>&nbsp;<span class="op" id="2992694">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992699">return</span>&nbsp;<span class="builtintype" id="2992706">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2992714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992718">dns</span><span class="op" id="2992721">.</span><span class="ident" id="2992722">extra</span>&nbsp;<span class="op" id="2992728">=</span>&nbsp;<span class="builtinfunc" id="2992730">append</span><span class="op" id="2992736">(</span><span class="ident" id="2992737">dns</span><span class="op" id="2992740">.</span><span class="ident" id="2992741">extra</span><span class="op" id="2992746">,</span>&nbsp;<span class="ident" id="2992748">rec</span><span class="op" id="2992751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2992754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2992757">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2992782">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2992845">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992851">return</span>&nbsp;<span class="builtintype" id="2992858">true</span><br>
<span class="lineno"></span><span class="op" id="2992863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="2992866">func</span>&nbsp;<span class="op" id="2992871">(</span><span class="ident" id="2992872">dns</span>&nbsp;<span class="op" id="2992876">*</span><span class="ident" id="2992877">dnsMsg</span><span class="op" id="2992883">)</span>&nbsp;<span class="ident" id="2992885">String</span><span class="op" id="2992891">(</span><span class="op" id="2992892">)</span>&nbsp;<span class="builtintype" id="2992894">string</span>&nbsp;<span class="op" id="2992901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992904">s</span>&nbsp;<span class="op" id="2992906">:=</span>&nbsp;<span class="string" id="2992909">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="2992917">+</span>&nbsp;<span class="ident" id="2992919">printStruct</span><span class="op" id="2992930">(</span><span class="op" id="2992931">&amp;</span><span class="ident" id="2992932">dns</span><span class="op" id="2992935">.</span><span class="ident" id="2992936">dnsMsgHdr</span><span class="op" id="2992945">)</span>&nbsp;<span class="op" id="2992947">+</span>&nbsp;<span class="string" id="2992949">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2992955">if</span>&nbsp;<span class="builtinfunc" id="2992958">len</span><span class="op" id="2992961">(</span><span class="ident" id="2992962">dns</span><span class="op" id="2992965">.</span><span class="ident" id="2992966">question</span><span class="op" id="2992974">)</span>&nbsp;<span class="op" id="2992976">&gt;</span>&nbsp;<span class="num" id="2992978">0</span>&nbsp;<span class="op" id="2992980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2992984">s</span>&nbsp;<span class="op" id="2992986">+=</span>&nbsp;<span class="string" id="2992989">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993008">for</span>&nbsp;<span class="ident" id="2993012">i</span>&nbsp;<span class="op" id="2993014">:=</span>&nbsp;<span class="num" id="2993017">0</span><span class="op" id="2993018">;</span>&nbsp;<span class="ident" id="2993020">i</span>&nbsp;<span class="op" id="2993022">&lt;</span>&nbsp;<span class="builtinfunc" id="2993024">len</span><span class="op" id="2993027">(</span><span class="ident" id="2993028">dns</span><span class="op" id="2993031">.</span><span class="ident" id="2993032">question</span><span class="op" id="2993040">)</span><span class="op" id="2993041">;</span>&nbsp;<span class="ident" id="2993043">i</span><span class="op" id="2993044">++</span>&nbsp;<span class="op" id="2993047">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993052">s</span>&nbsp;<span class="op" id="2993054">+=</span>&nbsp;<span class="ident" id="2993057">printStruct</span><span class="op" id="2993068">(</span><span class="op" id="2993069">&amp;</span><span class="ident" id="2993070">dns</span><span class="op" id="2993073">.</span><span class="ident" id="2993074">question</span><span class="op" id="2993082">[</span><span class="ident" id="2993083">i</span><span class="op" id="2993084">]</span><span class="op" id="2993085">)</span>&nbsp;<span class="op" id="2993087">+</span>&nbsp;<span class="string" id="2993089">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993102">if</span>&nbsp;<span class="builtinfunc" id="2993105">len</span><span class="op" id="2993108">(</span><span class="ident" id="2993109">dns</span><span class="op" id="2993112">.</span><span class="ident" id="2993113">answer</span><span class="op" id="2993119">)</span>&nbsp;<span class="op" id="2993121">&gt;</span>&nbsp;<span class="num" id="2993123">0</span>&nbsp;<span class="op" id="2993125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993129">s</span>&nbsp;<span class="op" id="2993131">+=</span>&nbsp;<span class="string" id="2993134">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993151">for</span>&nbsp;<span class="ident" id="2993155">i</span>&nbsp;<span class="op" id="2993157">:=</span>&nbsp;<span class="num" id="2993160">0</span><span class="op" id="2993161">;</span>&nbsp;<span class="ident" id="2993163">i</span>&nbsp;<span class="op" id="2993165">&lt;</span>&nbsp;<span class="builtinfunc" id="2993167">len</span><span class="op" id="2993170">(</span><span class="ident" id="2993171">dns</span><span class="op" id="2993174">.</span><span class="ident" id="2993175">answer</span><span class="op" id="2993181">)</span><span class="op" id="2993182">;</span>&nbsp;<span class="ident" id="2993184">i</span><span class="op" id="2993185">++</span>&nbsp;<span class="op" id="2993188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993193">s</span>&nbsp;<span class="op" id="2993195">+=</span>&nbsp;<span class="ident" id="2993198">printStruct</span><span class="op" id="2993209">(</span><span class="ident" id="2993210">dns</span><span class="op" id="2993213">.</span><span class="ident" id="2993214">answer</span><span class="op" id="2993220">[</span><span class="ident" id="2993221">i</span><span class="op" id="2993222">]</span><span class="op" id="2993223">)</span>&nbsp;<span class="op" id="2993225">+</span>&nbsp;<span class="string" id="2993227">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993240">if</span>&nbsp;<span class="builtinfunc" id="2993243">len</span><span class="op" id="2993246">(</span><span class="ident" id="2993247">dns</span><span class="op" id="2993250">.</span><span class="ident" id="2993251">ns</span><span class="op" id="2993253">)</span>&nbsp;<span class="op" id="2993255">&gt;</span>&nbsp;<span class="num" id="2993257">0</span>&nbsp;<span class="op" id="2993259">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993263">s</span>&nbsp;<span class="op" id="2993265">+=</span>&nbsp;<span class="string" id="2993268">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993290">for</span>&nbsp;<span class="ident" id="2993294">i</span>&nbsp;<span class="op" id="2993296">:=</span>&nbsp;<span class="num" id="2993299">0</span><span class="op" id="2993300">;</span>&nbsp;<span class="ident" id="2993302">i</span>&nbsp;<span class="op" id="2993304">&lt;</span>&nbsp;<span class="builtinfunc" id="2993306">len</span><span class="op" id="2993309">(</span><span class="ident" id="2993310">dns</span><span class="op" id="2993313">.</span><span class="ident" id="2993314">ns</span><span class="op" id="2993316">)</span><span class="op" id="2993317">;</span>&nbsp;<span class="ident" id="2993319">i</span><span class="op" id="2993320">++</span>&nbsp;<span class="op" id="2993323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993328">s</span>&nbsp;<span class="op" id="2993330">+=</span>&nbsp;<span class="ident" id="2993333">printStruct</span><span class="op" id="2993344">(</span><span class="ident" id="2993345">dns</span><span class="op" id="2993348">.</span><span class="ident" id="2993349">ns</span><span class="op" id="2993351">[</span><span class="ident" id="2993352">i</span><span class="op" id="2993353">]</span><span class="op" id="2993354">)</span>&nbsp;<span class="op" id="2993356">+</span>&nbsp;<span class="string" id="2993358">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993368">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993371">if</span>&nbsp;<span class="builtinfunc" id="2993374">len</span><span class="op" id="2993377">(</span><span class="ident" id="2993378">dns</span><span class="op" id="2993381">.</span><span class="ident" id="2993382">extra</span><span class="op" id="2993387">)</span>&nbsp;<span class="op" id="2993389">&gt;</span>&nbsp;<span class="num" id="2993391">0</span>&nbsp;<span class="op" id="2993393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993397">s</span>&nbsp;<span class="op" id="2993399">+=</span>&nbsp;<span class="string" id="2993402">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993417">for</span>&nbsp;<span class="ident" id="2993421">i</span>&nbsp;<span class="op" id="2993423">:=</span>&nbsp;<span class="num" id="2993426">0</span><span class="op" id="2993427">;</span>&nbsp;<span class="ident" id="2993429">i</span>&nbsp;<span class="op" id="2993431">&lt;</span>&nbsp;<span class="builtinfunc" id="2993433">len</span><span class="op" id="2993436">(</span><span class="ident" id="2993437">dns</span><span class="op" id="2993440">.</span><span class="ident" id="2993441">extra</span><span class="op" id="2993446">)</span><span class="op" id="2993447">;</span>&nbsp;<span class="ident" id="2993449">i</span><span class="op" id="2993450">++</span>&nbsp;<span class="op" id="2993453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993458">s</span>&nbsp;<span class="op" id="2993460">+=</span>&nbsp;<span class="ident" id="2993463">printStruct</span><span class="op" id="2993474">(</span><span class="ident" id="2993475">dns</span><span class="op" id="2993478">.</span><span class="ident" id="2993479">extra</span><span class="op" id="2993484">[</span><span class="ident" id="2993485">i</span><span class="op" id="2993486">]</span><span class="op" id="2993487">)</span>&nbsp;<span class="op" id="2993489">+</span>&nbsp;<span class="string" id="2993491">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993498">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993504">return</span>&nbsp;<span class="ident" id="2993511">s</span><br>
<span class="lineno"></span><span class="op" id="2993513">}</span>
</div>
</body>
</html>
