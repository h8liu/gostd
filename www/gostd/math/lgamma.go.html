<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2169612">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2169667">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2169721">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2169772">package</span>&nbsp;<span class="ident" id="2169780">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2169786">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2169842">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2169896">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2169953">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2170008">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2170038">//</span><br>
<span class="lineno"></span><span class="comment" id="2170041">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2170097">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2170166">//</span><br>
<span class="lineno"></span><span class="comment" id="2170169">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2170228">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2170284">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2170341">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2170358">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2170414">//</span><br>
<span class="lineno">25</span><span class="comment" id="2170417">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2170452">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2170512">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2170568">//</span><br>
<span class="lineno"></span><span class="comment" id="2170571">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2170582">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2170624">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2170684">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2170729">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2170778">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2170799">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2170852">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2170909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2170978">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2171032">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2171102">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2171167">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2171199">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2171267">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2171318">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2171379">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2171423">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2171450">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2171498">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2171520">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2171573">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2171635">//</span><br>
<span class="lineno"></span><span class="comment" id="2171638">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2171702">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2171772">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2171827">//</span><br>
<span class="lineno"></span><span class="comment" id="2171830">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2171897">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2171927">//</span><br>
<span class="lineno"></span><span class="comment" id="2171930">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2171956">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2172028">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2172053">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2172116">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2172159">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2172212">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2172223">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2172284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2172343">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2172357">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2172396">//</span><br>
<span class="lineno"></span><span class="comment" id="2172399">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2172451">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2172497">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2172513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2172562">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2172632">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2172686">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2172730">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2172796">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2172861">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2172904">//</span><br>
<span class="lineno"></span><span class="comment" id="2172907">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2172929">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2172982">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2173020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2173067">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2173113">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2173154">//</span><br>
<span class="lineno"></span><span class="comment" id="2173157">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2173161">var</span>&nbsp;<span class="ident" id="2173165">_lgamA</span>&nbsp;<span class="op" id="2173172">=</span>&nbsp;<span class="op" id="2173174">[</span><span class="op" id="2173175">...</span><span class="op" id="2173178">]</span><span class="builtintype" id="2173179">float64</span><span class="op" id="2173186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173189">7.72156649015328655494e-02</span><span class="op" id="2173215">,</span>&nbsp;<span class="comment" id="2173217">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173240">3.22467033424113591611e-01</span><span class="op" id="2173266">,</span>&nbsp;<span class="comment" id="2173268">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173291">6.73523010531292681824e-02</span><span class="op" id="2173317">,</span>&nbsp;<span class="comment" id="2173319">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173342">2.05808084325167332806e-02</span><span class="op" id="2173368">,</span>&nbsp;<span class="comment" id="2173370">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173393">7.38555086081402883957e-03</span><span class="op" id="2173419">,</span>&nbsp;<span class="comment" id="2173421">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173444">2.89051383673415629091e-03</span><span class="op" id="2173470">,</span>&nbsp;<span class="comment" id="2173472">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173495">1.19270763183362067845e-03</span><span class="op" id="2173521">,</span>&nbsp;<span class="comment" id="2173523">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173546">5.10069792153511336608e-04</span><span class="op" id="2173572">,</span>&nbsp;<span class="comment" id="2173574">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173597">2.20862790713908385557e-04</span><span class="op" id="2173623">,</span>&nbsp;<span class="comment" id="2173625">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173648">1.08011567247583939954e-04</span><span class="op" id="2173674">,</span>&nbsp;<span class="comment" id="2173676">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173699">2.52144565451257326939e-05</span><span class="op" id="2173725">,</span>&nbsp;<span class="comment" id="2173727">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173750">4.48640949618915160150e-05</span><span class="op" id="2173776">,</span>&nbsp;<span class="comment" id="2173778">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2173800">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2173802">var</span>&nbsp;<span class="ident" id="2173806">_lgamR</span>&nbsp;<span class="op" id="2173813">=</span>&nbsp;<span class="op" id="2173815">[</span><span class="op" id="2173816">...</span><span class="op" id="2173819">]</span><span class="builtintype" id="2173820">float64</span><span class="op" id="2173827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173830">1.0</span><span class="op" id="2173833">,</span>&nbsp;<span class="comment" id="2173835">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173851">1.39200533467621045958e+00</span><span class="op" id="2173877">,</span>&nbsp;<span class="comment" id="2173879">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173902">7.21935547567138069525e-01</span><span class="op" id="2173928">,</span>&nbsp;<span class="comment" id="2173930">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2173953">1.71933865632803078993e-01</span><span class="op" id="2173979">,</span>&nbsp;<span class="comment" id="2173981">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174004">1.86459191715652901344e-02</span><span class="op" id="2174030">,</span>&nbsp;<span class="comment" id="2174032">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174055">7.77942496381893596434e-04</span><span class="op" id="2174081">,</span>&nbsp;<span class="comment" id="2174083">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174106">7.32668430744625636189e-06</span><span class="op" id="2174132">,</span>&nbsp;<span class="comment" id="2174134">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2174156">}</span><br>
<span class="lineno"></span><span class="keyword" id="2174158">var</span>&nbsp;<span class="ident" id="2174162">_lgamS</span>&nbsp;<span class="op" id="2174169">=</span>&nbsp;<span class="op" id="2174171">[</span><span class="op" id="2174172">...</span><span class="op" id="2174175">]</span><span class="builtintype" id="2174176">float64</span><span class="op" id="2174183">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174186">-</span><span class="num" id="2174187">7.72156649015328655494e-02</span><span class="op" id="2174213">,</span>&nbsp;<span class="comment" id="2174215">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174238">2.14982415960608852501e-01</span><span class="op" id="2174264">,</span>&nbsp;&nbsp;<span class="comment" id="2174267">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174290">3.25778796408930981787e-01</span><span class="op" id="2174316">,</span>&nbsp;&nbsp;<span class="comment" id="2174319">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174342">1.46350472652464452805e-01</span><span class="op" id="2174368">,</span>&nbsp;&nbsp;<span class="comment" id="2174371">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174394">2.66422703033638609560e-02</span><span class="op" id="2174420">,</span>&nbsp;&nbsp;<span class="comment" id="2174423">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174446">1.84028451407337715652e-03</span><span class="op" id="2174472">,</span>&nbsp;&nbsp;<span class="comment" id="2174475">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174498">3.19475326584100867617e-05</span><span class="op" id="2174524">,</span>&nbsp;&nbsp;<span class="comment" id="2174527">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2174549">}</span><br>
<span class="lineno"></span><span class="keyword" id="2174551">var</span>&nbsp;<span class="ident" id="2174555">_lgamT</span>&nbsp;<span class="op" id="2174562">=</span>&nbsp;<span class="op" id="2174564">[</span><span class="op" id="2174565">...</span><span class="op" id="2174568">]</span><span class="builtintype" id="2174569">float64</span><span class="op" id="2174576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174579">4.83836122723810047042e-01</span><span class="op" id="2174605">,</span>&nbsp;&nbsp;<span class="comment" id="2174608">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174631">-</span><span class="num" id="2174632">1.47587722994593911752e-01</span><span class="op" id="2174658">,</span>&nbsp;<span class="comment" id="2174660">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174683">6.46249402391333854778e-02</span><span class="op" id="2174709">,</span>&nbsp;&nbsp;<span class="comment" id="2174712">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174735">-</span><span class="num" id="2174736">3.27885410759859649565e-02</span><span class="op" id="2174762">,</span>&nbsp;<span class="comment" id="2174764">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174787">1.79706750811820387126e-02</span><span class="op" id="2174813">,</span>&nbsp;&nbsp;<span class="comment" id="2174816">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174839">-</span><span class="num" id="2174840">1.03142241298341437450e-02</span><span class="op" id="2174866">,</span>&nbsp;<span class="comment" id="2174868">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174891">6.10053870246291332635e-03</span><span class="op" id="2174917">,</span>&nbsp;&nbsp;<span class="comment" id="2174920">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174943">-</span><span class="num" id="2174944">3.68452016781138256760e-03</span><span class="op" id="2174970">,</span>&nbsp;<span class="comment" id="2174972">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2174995">2.25964780900612472250e-03</span><span class="op" id="2175021">,</span>&nbsp;&nbsp;<span class="comment" id="2175024">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175047">-</span><span class="num" id="2175048">1.40346469989232843813e-03</span><span class="op" id="2175074">,</span>&nbsp;<span class="comment" id="2175076">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175099">8.81081882437654011382e-04</span><span class="op" id="2175125">,</span>&nbsp;&nbsp;<span class="comment" id="2175128">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175151">-</span><span class="num" id="2175152">5.38595305356740546715e-04</span><span class="op" id="2175178">,</span>&nbsp;<span class="comment" id="2175180">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175203">3.15632070903625950361e-04</span><span class="op" id="2175229">,</span>&nbsp;&nbsp;<span class="comment" id="2175232">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175255">-</span><span class="num" id="2175256">3.12754168375120860518e-04</span><span class="op" id="2175282">,</span>&nbsp;<span class="comment" id="2175284">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175307">3.35529192635519073543e-04</span><span class="op" id="2175333">,</span>&nbsp;&nbsp;<span class="comment" id="2175336">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2175358">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2175360">var</span>&nbsp;<span class="ident" id="2175364">_lgamU</span>&nbsp;<span class="op" id="2175371">=</span>&nbsp;<span class="op" id="2175373">[</span><span class="op" id="2175374">...</span><span class="op" id="2175377">]</span><span class="builtintype" id="2175378">float64</span><span class="op" id="2175385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175388">-</span><span class="num" id="2175389">7.72156649015328655494e-02</span><span class="op" id="2175415">,</span>&nbsp;<span class="comment" id="2175417">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175440">6.32827064025093366517e-01</span><span class="op" id="2175466">,</span>&nbsp;&nbsp;<span class="comment" id="2175469">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175492">1.45492250137234768737e+00</span><span class="op" id="2175518">,</span>&nbsp;&nbsp;<span class="comment" id="2175521">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175544">9.77717527963372745603e-01</span><span class="op" id="2175570">,</span>&nbsp;&nbsp;<span class="comment" id="2175573">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175596">2.28963728064692451092e-01</span><span class="op" id="2175622">,</span>&nbsp;&nbsp;<span class="comment" id="2175625">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175648">1.33810918536787660377e-02</span><span class="op" id="2175674">,</span>&nbsp;&nbsp;<span class="comment" id="2175677">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2175699">}</span><br>
<span class="lineno"></span><span class="keyword" id="2175701">var</span>&nbsp;<span class="ident" id="2175705">_lgamV</span>&nbsp;<span class="op" id="2175712">=</span>&nbsp;<span class="op" id="2175714">[</span><span class="op" id="2175715">...</span><span class="op" id="2175718">]</span><span class="builtintype" id="2175719">float64</span><span class="op" id="2175726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175729">1.0</span><span class="op" id="2175732">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175735">2.45597793713041134822e+00</span><span class="op" id="2175761">,</span>&nbsp;<span class="comment" id="2175763">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175786">2.12848976379893395361e+00</span><span class="op" id="2175812">,</span>&nbsp;<span class="comment" id="2175814">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175837">7.69285150456672783825e-01</span><span class="op" id="2175863">,</span>&nbsp;<span class="comment" id="2175865">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175888">1.04222645593369134254e-01</span><span class="op" id="2175914">,</span>&nbsp;<span class="comment" id="2175916">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2175939">3.21709242282423911810e-03</span><span class="op" id="2175965">,</span>&nbsp;<span class="comment" id="2175967">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2175989">}</span><br>
<span class="lineno"></span><span class="keyword" id="2175991">var</span>&nbsp;<span class="ident" id="2175995">_lgamW</span>&nbsp;<span class="op" id="2176002">=</span>&nbsp;<span class="op" id="2176004">[</span><span class="op" id="2176005">...</span><span class="op" id="2176008">]</span><span class="builtintype" id="2176009">float64</span><span class="op" id="2176016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2176019">4.18938533204672725052e-01</span><span class="op" id="2176045">,</span>&nbsp;&nbsp;<span class="comment" id="2176048">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2176071">8.33333333333329678849e-02</span><span class="op" id="2176097">,</span>&nbsp;&nbsp;<span class="comment" id="2176100">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2176123">-</span><span class="num" id="2176124">2.77777777728775536470e-03</span><span class="op" id="2176150">,</span>&nbsp;<span class="comment" id="2176152">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2176175">7.93650558643019558500e-04</span><span class="op" id="2176201">,</span>&nbsp;&nbsp;<span class="comment" id="2176204">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2176227">-</span><span class="num" id="2176228">5.95187557450339963135e-04</span><span class="op" id="2176254">,</span>&nbsp;<span class="comment" id="2176256">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2176279">8.36339918996282139126e-04</span><span class="op" id="2176305">,</span>&nbsp;&nbsp;<span class="comment" id="2176308">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2176331">-</span><span class="num" id="2176332">1.63092934096575273989e-03</span><span class="op" id="2176358">,</span>&nbsp;<span class="comment" id="2176360">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2176382">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2176385">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2176458">//</span><br>
<span class="lineno"></span><span class="comment" id="2176461">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2176483">//&nbsp;&nbsp;&nbsp;&nbspLgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2176506">//&nbsp;&nbsp;&nbsp;&nbspLgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2176526">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2176553">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2176576">//&nbsp;&nbsp;&nbsp;&nbspLgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2176597">func</span>&nbsp;<span class="ident" id="2176602">Lgamma</span><span class="op" id="2176608">(</span><span class="ident" id="2176609">x</span>&nbsp;<span class="builtintype" id="2176611">float64</span><span class="op" id="2176618">)</span>&nbsp;<span class="op" id="2176620">(</span><span class="ident" id="2176621">lgamma</span>&nbsp;<span class="builtintype" id="2176628">float64</span><span class="op" id="2176635">,</span>&nbsp;<span class="ident" id="2176637">sign</span>&nbsp;<span class="builtintype" id="2176642">int</span><span class="op" id="2176645">)</span>&nbsp;<span class="op" id="2176647">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2176650">const</span>&nbsp;<span class="op" id="2176656">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176660">Ymin</span>&nbsp;&nbsp;<span class="op" id="2176666">=</span>&nbsp;<span class="num" id="2176668">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176691">Two52</span>&nbsp;<span class="op" id="2176697">=</span>&nbsp;<span class="num" id="2176699">1</span>&nbsp;<span class="op" id="2176701">&lt;&lt;</span>&nbsp;<span class="num" id="2176704">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176727">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176763">Two53</span>&nbsp;<span class="op" id="2176769">=</span>&nbsp;<span class="num" id="2176771">1</span>&nbsp;<span class="op" id="2176773">&lt;&lt;</span>&nbsp;<span class="num" id="2176776">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176799">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176835">Two58</span>&nbsp;<span class="op" id="2176841">=</span>&nbsp;<span class="num" id="2176843">1</span>&nbsp;<span class="op" id="2176845">&lt;&lt;</span>&nbsp;<span class="num" id="2176848">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176871">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176907">Tiny</span>&nbsp;&nbsp;<span class="op" id="2176913">=</span>&nbsp;<span class="num" id="2176915">1.0</span>&nbsp;<span class="op" id="2176919">/</span>&nbsp;<span class="op" id="2176921">(</span><span class="num" id="2176922">1</span>&nbsp;<span class="op" id="2176924">&lt;&lt;</span>&nbsp;<span class="num" id="2176927">70</span><span class="op" id="2176929">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176943">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176980">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2176986">=</span>&nbsp;<span class="num" id="2176988">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2177016">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177040">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177046">=</span>&nbsp;<span class="op" id="2177048">-</span><span class="num" id="2177049">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2177076">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2177100">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177124">Tt</span>&nbsp;<span class="op" id="2177127">=</span>&nbsp;<span class="op" id="2177129">-</span><span class="num" id="2177130">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2177157">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2177183">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177201">sign</span>&nbsp;<span class="op" id="2177206">=</span>&nbsp;<span class="num" id="2177208">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177211">switch</span>&nbsp;<span class="op" id="2177218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177221">case</span>&nbsp;<span class="ident" id="2177226">IsNaN</span><span class="op" id="2177231">(</span><span class="ident" id="2177232">x</span><span class="op" id="2177233">)</span><span class="op" id="2177234">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177238">lgamma</span>&nbsp;<span class="op" id="2177245">=</span>&nbsp;<span class="ident" id="2177247">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177251">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177259">case</span>&nbsp;<span class="ident" id="2177264">IsInf</span><span class="op" id="2177269">(</span><span class="ident" id="2177270">x</span><span class="op" id="2177271">,</span>&nbsp;<span class="num" id="2177273">0</span><span class="op" id="2177274">)</span><span class="op" id="2177275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177279">lgamma</span>&nbsp;<span class="op" id="2177286">=</span>&nbsp;<span class="ident" id="2177288">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177292">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177300">case</span>&nbsp;<span class="ident" id="2177305">x</span>&nbsp;<span class="op" id="2177307">==</span>&nbsp;<span class="num" id="2177310">0</span><span class="op" id="2177311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177315">lgamma</span>&nbsp;<span class="op" id="2177322">=</span>&nbsp;<span class="ident" id="2177324">Inf</span><span class="op" id="2177327">(</span><span class="num" id="2177328">1</span><span class="op" id="2177329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177333">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177345">neg</span>&nbsp;<span class="op" id="2177349">:=</span>&nbsp;<span class="builtintype" id="2177352">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177359">if</span>&nbsp;<span class="ident" id="2177362">x</span>&nbsp;<span class="op" id="2177364">&lt;</span>&nbsp;<span class="num" id="2177366">0</span>&nbsp;<span class="op" id="2177368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177372">x</span>&nbsp;<span class="op" id="2177374">=</span>&nbsp;<span class="op" id="2177376">-</span><span class="ident" id="2177377">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177381">neg</span>&nbsp;<span class="op" id="2177385">=</span>&nbsp;<span class="builtintype" id="2177387">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177393">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177397">if</span>&nbsp;<span class="ident" id="2177400">x</span>&nbsp;<span class="op" id="2177402">&lt;</span>&nbsp;<span class="ident" id="2177404">Tiny</span>&nbsp;<span class="op" id="2177409">{</span>&nbsp;<span class="comment" id="2177411">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177450">if</span>&nbsp;<span class="ident" id="2177453">neg</span>&nbsp;<span class="op" id="2177457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177462">sign</span>&nbsp;<span class="op" id="2177467">=</span>&nbsp;<span class="op" id="2177469">-</span><span class="num" id="2177470">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177474">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177478">lgamma</span>&nbsp;<span class="op" id="2177485">=</span>&nbsp;<span class="op" id="2177487">-</span><span class="ident" id="2177488">Log</span><span class="op" id="2177491">(</span><span class="ident" id="2177492">x</span><span class="op" id="2177493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177497">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177508">var</span>&nbsp;<span class="ident" id="2177512">nadj</span>&nbsp;<span class="builtintype" id="2177517">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177526">if</span>&nbsp;<span class="ident" id="2177529">neg</span>&nbsp;<span class="op" id="2177533">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177537">if</span>&nbsp;<span class="ident" id="2177540">x</span>&nbsp;<span class="op" id="2177542">&gt;=</span>&nbsp;<span class="ident" id="2177545">Two52</span>&nbsp;<span class="op" id="2177551">{</span>&nbsp;<span class="comment" id="2177553">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177590">lgamma</span>&nbsp;<span class="op" id="2177597">=</span>&nbsp;<span class="ident" id="2177599">Inf</span><span class="op" id="2177602">(</span><span class="num" id="2177603">1</span><span class="op" id="2177604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177609">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177622">t</span>&nbsp;<span class="op" id="2177624">:=</span>&nbsp;<span class="ident" id="2177627">sinPi</span><span class="op" id="2177632">(</span><span class="ident" id="2177633">x</span><span class="op" id="2177634">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177638">if</span>&nbsp;<span class="ident" id="2177641">t</span>&nbsp;<span class="op" id="2177643">==</span>&nbsp;<span class="num" id="2177646">0</span>&nbsp;<span class="op" id="2177648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177653">lgamma</span>&nbsp;<span class="op" id="2177660">=</span>&nbsp;<span class="ident" id="2177662">Inf</span><span class="op" id="2177665">(</span><span class="num" id="2177666">1</span><span class="op" id="2177667">)</span>&nbsp;<span class="comment" id="2177669">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177684">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177697">nadj</span>&nbsp;<span class="op" id="2177702">=</span>&nbsp;<span class="ident" id="2177704">Log</span><span class="op" id="2177707">(</span><span class="ident" id="2177708">Pi</span>&nbsp;<span class="op" id="2177711">/</span>&nbsp;<span class="ident" id="2177713">Abs</span><span class="op" id="2177716">(</span><span class="ident" id="2177717">t</span><span class="op" id="2177718">*</span><span class="ident" id="2177719">x</span><span class="op" id="2177720">)</span><span class="op" id="2177721">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177725">if</span>&nbsp;<span class="ident" id="2177728">t</span>&nbsp;<span class="op" id="2177730">&lt;</span>&nbsp;<span class="num" id="2177732">0</span>&nbsp;<span class="op" id="2177734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177739">sign</span>&nbsp;<span class="op" id="2177744">=</span>&nbsp;<span class="op" id="2177746">-</span><span class="num" id="2177747">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177758">switch</span>&nbsp;<span class="op" id="2177765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177768">case</span>&nbsp;<span class="ident" id="2177773">x</span>&nbsp;<span class="op" id="2177775">==</span>&nbsp;<span class="num" id="2177778">1</span>&nbsp;<span class="op" id="2177780">||</span>&nbsp;<span class="ident" id="2177783">x</span>&nbsp;<span class="op" id="2177785">==</span>&nbsp;<span class="num" id="2177788">2</span><span class="op" id="2177789">:</span>&nbsp;<span class="comment" id="2177791">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177814">lgamma</span>&nbsp;<span class="op" id="2177821">=</span>&nbsp;<span class="num" id="2177823">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177827">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177835">case</span>&nbsp;<span class="ident" id="2177840">x</span>&nbsp;<span class="op" id="2177842">&lt;</span>&nbsp;<span class="num" id="2177844">2</span><span class="op" id="2177845">:</span>&nbsp;<span class="comment" id="2177847">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177889">var</span>&nbsp;<span class="ident" id="2177893">y</span>&nbsp;<span class="builtintype" id="2177895">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177905">var</span>&nbsp;<span class="ident" id="2177909">i</span>&nbsp;<span class="builtintype" id="2177911">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177917">if</span>&nbsp;<span class="ident" id="2177920">x</span>&nbsp;<span class="op" id="2177922">&lt;=</span>&nbsp;<span class="num" id="2177925">0.9</span>&nbsp;<span class="op" id="2177929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2177934">lgamma</span>&nbsp;<span class="op" id="2177941">=</span>&nbsp;<span class="op" id="2177943">-</span><span class="ident" id="2177944">Log</span><span class="op" id="2177947">(</span><span class="ident" id="2177948">x</span><span class="op" id="2177949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177954">switch</span>&nbsp;<span class="op" id="2177961">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177966">case</span>&nbsp;<span class="ident" id="2177971">x</span>&nbsp;<span class="op" id="2177973">&gt;=</span>&nbsp;<span class="op" id="2177976">(</span><span class="ident" id="2177977">Ymin</span>&nbsp;<span class="op" id="2177982">-</span>&nbsp;<span class="num" id="2177984">1</span>&nbsp;<span class="op" id="2177986">+</span>&nbsp;<span class="num" id="2177988">0.27</span><span class="op" id="2177992">)</span><span class="op" id="2177993">:</span>&nbsp;<span class="comment" id="2177995">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178022">y</span>&nbsp;<span class="op" id="2178024">=</span>&nbsp;<span class="num" id="2178026">1</span>&nbsp;<span class="op" id="2178028">-</span>&nbsp;<span class="ident" id="2178030">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178036">i</span>&nbsp;<span class="op" id="2178038">=</span>&nbsp;<span class="num" id="2178040">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178045">case</span>&nbsp;<span class="ident" id="2178050">x</span>&nbsp;<span class="op" id="2178052">&gt;=</span>&nbsp;<span class="op" id="2178055">(</span><span class="ident" id="2178056">Ymin</span>&nbsp;<span class="op" id="2178061">-</span>&nbsp;<span class="num" id="2178063">1</span>&nbsp;<span class="op" id="2178065">-</span>&nbsp;<span class="num" id="2178067">0.27</span><span class="op" id="2178071">)</span><span class="op" id="2178072">:</span>&nbsp;<span class="comment" id="2178074">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178102">y</span>&nbsp;<span class="op" id="2178104">=</span>&nbsp;<span class="ident" id="2178106">x</span>&nbsp;<span class="op" id="2178108">-</span>&nbsp;<span class="op" id="2178110">(</span><span class="ident" id="2178111">Tc</span>&nbsp;<span class="op" id="2178114">-</span>&nbsp;<span class="num" id="2178116">1</span><span class="op" id="2178117">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178123">i</span>&nbsp;<span class="op" id="2178125">=</span>&nbsp;<span class="num" id="2178127">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178132">default</span><span class="op" id="2178139">:</span>&nbsp;<span class="comment" id="2178141">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178163">y</span>&nbsp;<span class="op" id="2178165">=</span>&nbsp;<span class="ident" id="2178167">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178173">i</span>&nbsp;<span class="op" id="2178175">=</span>&nbsp;<span class="num" id="2178177">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178182">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178186">}</span>&nbsp;<span class="keyword" id="2178188">else</span>&nbsp;<span class="op" id="2178193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178198">lgamma</span>&nbsp;<span class="op" id="2178205">=</span>&nbsp;<span class="num" id="2178207">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178212">switch</span>&nbsp;<span class="op" id="2178219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178224">case</span>&nbsp;<span class="ident" id="2178229">x</span>&nbsp;<span class="op" id="2178231">&gt;=</span>&nbsp;<span class="op" id="2178234">(</span><span class="ident" id="2178235">Ymin</span>&nbsp;<span class="op" id="2178240">+</span>&nbsp;<span class="num" id="2178242">0.27</span><span class="op" id="2178246">)</span><span class="op" id="2178247">:</span>&nbsp;<span class="comment" id="2178249">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178272">y</span>&nbsp;<span class="op" id="2178274">=</span>&nbsp;<span class="num" id="2178276">2</span>&nbsp;<span class="op" id="2178278">-</span>&nbsp;<span class="ident" id="2178280">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178286">i</span>&nbsp;<span class="op" id="2178288">=</span>&nbsp;<span class="num" id="2178290">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178295">case</span>&nbsp;<span class="ident" id="2178300">x</span>&nbsp;<span class="op" id="2178302">&gt;=</span>&nbsp;<span class="op" id="2178305">(</span><span class="ident" id="2178306">Ymin</span>&nbsp;<span class="op" id="2178311">-</span>&nbsp;<span class="num" id="2178313">0.27</span><span class="op" id="2178317">)</span><span class="op" id="2178318">:</span>&nbsp;<span class="comment" id="2178320">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178348">y</span>&nbsp;<span class="op" id="2178350">=</span>&nbsp;<span class="ident" id="2178352">x</span>&nbsp;<span class="op" id="2178354">-</span>&nbsp;<span class="ident" id="2178356">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178363">i</span>&nbsp;<span class="op" id="2178365">=</span>&nbsp;<span class="num" id="2178367">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178372">default</span><span class="op" id="2178379">:</span>&nbsp;<span class="comment" id="2178381">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178405">y</span>&nbsp;<span class="op" id="2178407">=</span>&nbsp;<span class="ident" id="2178409">x</span>&nbsp;<span class="op" id="2178411">-</span>&nbsp;<span class="num" id="2178413">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178419">i</span>&nbsp;<span class="op" id="2178421">=</span>&nbsp;<span class="num" id="2178423">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178436">switch</span>&nbsp;<span class="ident" id="2178443">i</span>&nbsp;<span class="op" id="2178445">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178449">case</span>&nbsp;<span class="num" id="2178454">0</span><span class="op" id="2178455">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178460">z</span>&nbsp;<span class="op" id="2178462">:=</span>&nbsp;<span class="ident" id="2178465">y</span>&nbsp;<span class="op" id="2178467">*</span>&nbsp;<span class="ident" id="2178469">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178474">p1</span>&nbsp;<span class="op" id="2178477">:=</span>&nbsp;<span class="ident" id="2178480">_lgamA</span><span class="op" id="2178486">[</span><span class="num" id="2178487">0</span><span class="op" id="2178488">]</span>&nbsp;<span class="op" id="2178490">+</span>&nbsp;<span class="ident" id="2178492">z</span><span class="op" id="2178493">*</span><span class="op" id="2178494">(</span><span class="ident" id="2178495">_lgamA</span><span class="op" id="2178501">[</span><span class="num" id="2178502">2</span><span class="op" id="2178503">]</span><span class="op" id="2178504">+</span><span class="ident" id="2178505">z</span><span class="op" id="2178506">*</span><span class="op" id="2178507">(</span><span class="ident" id="2178508">_lgamA</span><span class="op" id="2178514">[</span><span class="num" id="2178515">4</span><span class="op" id="2178516">]</span><span class="op" id="2178517">+</span><span class="ident" id="2178518">z</span><span class="op" id="2178519">*</span><span class="op" id="2178520">(</span><span class="ident" id="2178521">_lgamA</span><span class="op" id="2178527">[</span><span class="num" id="2178528">6</span><span class="op" id="2178529">]</span><span class="op" id="2178530">+</span><span class="ident" id="2178531">z</span><span class="op" id="2178532">*</span><span class="op" id="2178533">(</span><span class="ident" id="2178534">_lgamA</span><span class="op" id="2178540">[</span><span class="num" id="2178541">8</span><span class="op" id="2178542">]</span><span class="op" id="2178543">+</span><span class="ident" id="2178544">z</span><span class="op" id="2178545">*</span><span class="ident" id="2178546">_lgamA</span><span class="op" id="2178552">[</span><span class="num" id="2178553">10</span><span class="op" id="2178555">]</span><span class="op" id="2178556">)</span><span class="op" id="2178557">)</span><span class="op" id="2178558">)</span><span class="op" id="2178559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178564">p2</span>&nbsp;<span class="op" id="2178567">:=</span>&nbsp;<span class="ident" id="2178570">z</span>&nbsp;<span class="op" id="2178572">*</span>&nbsp;<span class="op" id="2178574">(</span><span class="ident" id="2178575">_lgamA</span><span class="op" id="2178581">[</span><span class="num" id="2178582">1</span><span class="op" id="2178583">]</span>&nbsp;<span class="op" id="2178585">+</span>&nbsp;<span class="ident" id="2178587">z</span><span class="op" id="2178588">*</span><span class="op" id="2178589">(</span><span class="op" id="2178590">+</span><span class="ident" id="2178591">_lgamA</span><span class="op" id="2178597">[</span><span class="num" id="2178598">3</span><span class="op" id="2178599">]</span><span class="op" id="2178600">+</span><span class="ident" id="2178601">z</span><span class="op" id="2178602">*</span><span class="op" id="2178603">(</span><span class="ident" id="2178604">_lgamA</span><span class="op" id="2178610">[</span><span class="num" id="2178611">5</span><span class="op" id="2178612">]</span><span class="op" id="2178613">+</span><span class="ident" id="2178614">z</span><span class="op" id="2178615">*</span><span class="op" id="2178616">(</span><span class="ident" id="2178617">_lgamA</span><span class="op" id="2178623">[</span><span class="num" id="2178624">7</span><span class="op" id="2178625">]</span><span class="op" id="2178626">+</span><span class="ident" id="2178627">z</span><span class="op" id="2178628">*</span><span class="op" id="2178629">(</span><span class="ident" id="2178630">_lgamA</span><span class="op" id="2178636">[</span><span class="num" id="2178637">9</span><span class="op" id="2178638">]</span><span class="op" id="2178639">+</span><span class="ident" id="2178640">z</span><span class="op" id="2178641">*</span><span class="ident" id="2178642">_lgamA</span><span class="op" id="2178648">[</span><span class="num" id="2178649">11</span><span class="op" id="2178651">]</span><span class="op" id="2178652">)</span><span class="op" id="2178653">)</span><span class="op" id="2178654">)</span><span class="op" id="2178655">)</span><span class="op" id="2178656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178661">p</span>&nbsp;<span class="op" id="2178663">:=</span>&nbsp;<span class="ident" id="2178666">y</span><span class="op" id="2178667">*</span><span class="ident" id="2178668">p1</span>&nbsp;<span class="op" id="2178671">+</span>&nbsp;<span class="ident" id="2178673">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178679">lgamma</span>&nbsp;<span class="op" id="2178686">+=</span>&nbsp;<span class="op" id="2178689">(</span><span class="ident" id="2178690">p</span>&nbsp;<span class="op" id="2178692">-</span>&nbsp;<span class="num" id="2178694">0.5</span><span class="op" id="2178697">*</span><span class="ident" id="2178698">y</span><span class="op" id="2178699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178703">case</span>&nbsp;<span class="num" id="2178708">1</span><span class="op" id="2178709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178714">z</span>&nbsp;<span class="op" id="2178716">:=</span>&nbsp;<span class="ident" id="2178719">y</span>&nbsp;<span class="op" id="2178721">*</span>&nbsp;<span class="ident" id="2178723">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178728">w</span>&nbsp;<span class="op" id="2178730">:=</span>&nbsp;<span class="ident" id="2178733">z</span>&nbsp;<span class="op" id="2178735">*</span>&nbsp;<span class="ident" id="2178737">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178742">p1</span>&nbsp;<span class="op" id="2178745">:=</span>&nbsp;<span class="ident" id="2178748">_lgamT</span><span class="op" id="2178754">[</span><span class="num" id="2178755">0</span><span class="op" id="2178756">]</span>&nbsp;<span class="op" id="2178758">+</span>&nbsp;<span class="ident" id="2178760">w</span><span class="op" id="2178761">*</span><span class="op" id="2178762">(</span><span class="ident" id="2178763">_lgamT</span><span class="op" id="2178769">[</span><span class="num" id="2178770">3</span><span class="op" id="2178771">]</span><span class="op" id="2178772">+</span><span class="ident" id="2178773">w</span><span class="op" id="2178774">*</span><span class="op" id="2178775">(</span><span class="ident" id="2178776">_lgamT</span><span class="op" id="2178782">[</span><span class="num" id="2178783">6</span><span class="op" id="2178784">]</span><span class="op" id="2178785">+</span><span class="ident" id="2178786">w</span><span class="op" id="2178787">*</span><span class="op" id="2178788">(</span><span class="ident" id="2178789">_lgamT</span><span class="op" id="2178795">[</span><span class="num" id="2178796">9</span><span class="op" id="2178797">]</span><span class="op" id="2178798">+</span><span class="ident" id="2178799">w</span><span class="op" id="2178800">*</span><span class="ident" id="2178801">_lgamT</span><span class="op" id="2178807">[</span><span class="num" id="2178808">12</span><span class="op" id="2178810">]</span><span class="op" id="2178811">)</span><span class="op" id="2178812">)</span><span class="op" id="2178813">)</span>&nbsp;<span class="comment" id="2178815">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178835">p2</span>&nbsp;<span class="op" id="2178838">:=</span>&nbsp;<span class="ident" id="2178841">_lgamT</span><span class="op" id="2178847">[</span><span class="num" id="2178848">1</span><span class="op" id="2178849">]</span>&nbsp;<span class="op" id="2178851">+</span>&nbsp;<span class="ident" id="2178853">w</span><span class="op" id="2178854">*</span><span class="op" id="2178855">(</span><span class="ident" id="2178856">_lgamT</span><span class="op" id="2178862">[</span><span class="num" id="2178863">4</span><span class="op" id="2178864">]</span><span class="op" id="2178865">+</span><span class="ident" id="2178866">w</span><span class="op" id="2178867">*</span><span class="op" id="2178868">(</span><span class="ident" id="2178869">_lgamT</span><span class="op" id="2178875">[</span><span class="num" id="2178876">7</span><span class="op" id="2178877">]</span><span class="op" id="2178878">+</span><span class="ident" id="2178879">w</span><span class="op" id="2178880">*</span><span class="op" id="2178881">(</span><span class="ident" id="2178882">_lgamT</span><span class="op" id="2178888">[</span><span class="num" id="2178889">10</span><span class="op" id="2178891">]</span><span class="op" id="2178892">+</span><span class="ident" id="2178893">w</span><span class="op" id="2178894">*</span><span class="ident" id="2178895">_lgamT</span><span class="op" id="2178901">[</span><span class="num" id="2178902">13</span><span class="op" id="2178904">]</span><span class="op" id="2178905">)</span><span class="op" id="2178906">)</span><span class="op" id="2178907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178912">p3</span>&nbsp;<span class="op" id="2178915">:=</span>&nbsp;<span class="ident" id="2178918">_lgamT</span><span class="op" id="2178924">[</span><span class="num" id="2178925">2</span><span class="op" id="2178926">]</span>&nbsp;<span class="op" id="2178928">+</span>&nbsp;<span class="ident" id="2178930">w</span><span class="op" id="2178931">*</span><span class="op" id="2178932">(</span><span class="ident" id="2178933">_lgamT</span><span class="op" id="2178939">[</span><span class="num" id="2178940">5</span><span class="op" id="2178941">]</span><span class="op" id="2178942">+</span><span class="ident" id="2178943">w</span><span class="op" id="2178944">*</span><span class="op" id="2178945">(</span><span class="ident" id="2178946">_lgamT</span><span class="op" id="2178952">[</span><span class="num" id="2178953">8</span><span class="op" id="2178954">]</span><span class="op" id="2178955">+</span><span class="ident" id="2178956">w</span><span class="op" id="2178957">*</span><span class="op" id="2178958">(</span><span class="ident" id="2178959">_lgamT</span><span class="op" id="2178965">[</span><span class="num" id="2178966">11</span><span class="op" id="2178968">]</span><span class="op" id="2178969">+</span><span class="ident" id="2178970">w</span><span class="op" id="2178971">*</span><span class="ident" id="2178972">_lgamT</span><span class="op" id="2178978">[</span><span class="num" id="2178979">14</span><span class="op" id="2178981">]</span><span class="op" id="2178982">)</span><span class="op" id="2178983">)</span><span class="op" id="2178984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178989">p</span>&nbsp;<span class="op" id="2178991">:=</span>&nbsp;<span class="ident" id="2178994">z</span><span class="op" id="2178995">*</span><span class="ident" id="2178996">p1</span>&nbsp;<span class="op" id="2178999">-</span>&nbsp;<span class="op" id="2179001">(</span><span class="ident" id="2179002">Tt</span>&nbsp;<span class="op" id="2179005">-</span>&nbsp;<span class="ident" id="2179007">w</span><span class="op" id="2179008">*</span><span class="op" id="2179009">(</span><span class="ident" id="2179010">p2</span><span class="op" id="2179012">+</span><span class="ident" id="2179013">y</span><span class="op" id="2179014">*</span><span class="ident" id="2179015">p3</span><span class="op" id="2179017">)</span><span class="op" id="2179018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179023">lgamma</span>&nbsp;<span class="op" id="2179030">+=</span>&nbsp;<span class="op" id="2179033">(</span><span class="ident" id="2179034">Tf</span>&nbsp;<span class="op" id="2179037">+</span>&nbsp;<span class="ident" id="2179039">p</span><span class="op" id="2179040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179044">case</span>&nbsp;<span class="num" id="2179049">2</span><span class="op" id="2179050">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179055">p1</span>&nbsp;<span class="op" id="2179058">:=</span>&nbsp;<span class="ident" id="2179061">y</span>&nbsp;<span class="op" id="2179063">*</span>&nbsp;<span class="op" id="2179065">(</span><span class="ident" id="2179066">_lgamU</span><span class="op" id="2179072">[</span><span class="num" id="2179073">0</span><span class="op" id="2179074">]</span>&nbsp;<span class="op" id="2179076">+</span>&nbsp;<span class="ident" id="2179078">y</span><span class="op" id="2179079">*</span><span class="op" id="2179080">(</span><span class="ident" id="2179081">_lgamU</span><span class="op" id="2179087">[</span><span class="num" id="2179088">1</span><span class="op" id="2179089">]</span><span class="op" id="2179090">+</span><span class="ident" id="2179091">y</span><span class="op" id="2179092">*</span><span class="op" id="2179093">(</span><span class="ident" id="2179094">_lgamU</span><span class="op" id="2179100">[</span><span class="num" id="2179101">2</span><span class="op" id="2179102">]</span><span class="op" id="2179103">+</span><span class="ident" id="2179104">y</span><span class="op" id="2179105">*</span><span class="op" id="2179106">(</span><span class="ident" id="2179107">_lgamU</span><span class="op" id="2179113">[</span><span class="num" id="2179114">3</span><span class="op" id="2179115">]</span><span class="op" id="2179116">+</span><span class="ident" id="2179117">y</span><span class="op" id="2179118">*</span><span class="op" id="2179119">(</span><span class="ident" id="2179120">_lgamU</span><span class="op" id="2179126">[</span><span class="num" id="2179127">4</span><span class="op" id="2179128">]</span><span class="op" id="2179129">+</span><span class="ident" id="2179130">y</span><span class="op" id="2179131">*</span><span class="ident" id="2179132">_lgamU</span><span class="op" id="2179138">[</span><span class="num" id="2179139">5</span><span class="op" id="2179140">]</span><span class="op" id="2179141">)</span><span class="op" id="2179142">)</span><span class="op" id="2179143">)</span><span class="op" id="2179144">)</span><span class="op" id="2179145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179150">p2</span>&nbsp;<span class="op" id="2179153">:=</span>&nbsp;<span class="num" id="2179156">1</span>&nbsp;<span class="op" id="2179158">+</span>&nbsp;<span class="ident" id="2179160">y</span><span class="op" id="2179161">*</span><span class="op" id="2179162">(</span><span class="ident" id="2179163">_lgamV</span><span class="op" id="2179169">[</span><span class="num" id="2179170">1</span><span class="op" id="2179171">]</span><span class="op" id="2179172">+</span><span class="ident" id="2179173">y</span><span class="op" id="2179174">*</span><span class="op" id="2179175">(</span><span class="ident" id="2179176">_lgamV</span><span class="op" id="2179182">[</span><span class="num" id="2179183">2</span><span class="op" id="2179184">]</span><span class="op" id="2179185">+</span><span class="ident" id="2179186">y</span><span class="op" id="2179187">*</span><span class="op" id="2179188">(</span><span class="ident" id="2179189">_lgamV</span><span class="op" id="2179195">[</span><span class="num" id="2179196">3</span><span class="op" id="2179197">]</span><span class="op" id="2179198">+</span><span class="ident" id="2179199">y</span><span class="op" id="2179200">*</span><span class="op" id="2179201">(</span><span class="ident" id="2179202">_lgamV</span><span class="op" id="2179208">[</span><span class="num" id="2179209">4</span><span class="op" id="2179210">]</span><span class="op" id="2179211">+</span><span class="ident" id="2179212">y</span><span class="op" id="2179213">*</span><span class="ident" id="2179214">_lgamV</span><span class="op" id="2179220">[</span><span class="num" id="2179221">5</span><span class="op" id="2179222">]</span><span class="op" id="2179223">)</span><span class="op" id="2179224">)</span><span class="op" id="2179225">)</span><span class="op" id="2179226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179231">lgamma</span>&nbsp;<span class="op" id="2179238">+=</span>&nbsp;<span class="op" id="2179241">(</span><span class="op" id="2179242">-</span><span class="num" id="2179243">0.5</span><span class="op" id="2179246">*</span><span class="ident" id="2179247">y</span>&nbsp;<span class="op" id="2179249">+</span>&nbsp;<span class="ident" id="2179251">p1</span><span class="op" id="2179253">/</span><span class="ident" id="2179254">p2</span><span class="op" id="2179256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179263">case</span>&nbsp;<span class="ident" id="2179268">x</span>&nbsp;<span class="op" id="2179270">&lt;</span>&nbsp;<span class="num" id="2179272">8</span><span class="op" id="2179273">:</span>&nbsp;<span class="comment" id="2179275">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179291">i</span>&nbsp;<span class="op" id="2179293">:=</span>&nbsp;<span class="builtintype" id="2179296">int</span><span class="op" id="2179299">(</span><span class="ident" id="2179300">x</span><span class="op" id="2179301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179305">y</span>&nbsp;<span class="op" id="2179307">:=</span>&nbsp;<span class="ident" id="2179310">x</span>&nbsp;<span class="op" id="2179312">-</span>&nbsp;<span class="builtintype" id="2179314">float64</span><span class="op" id="2179321">(</span><span class="ident" id="2179322">i</span><span class="op" id="2179323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179327">p</span>&nbsp;<span class="op" id="2179329">:=</span>&nbsp;<span class="ident" id="2179332">y</span>&nbsp;<span class="op" id="2179334">*</span>&nbsp;<span class="op" id="2179336">(</span><span class="ident" id="2179337">_lgamS</span><span class="op" id="2179343">[</span><span class="num" id="2179344">0</span><span class="op" id="2179345">]</span>&nbsp;<span class="op" id="2179347">+</span>&nbsp;<span class="ident" id="2179349">y</span><span class="op" id="2179350">*</span><span class="op" id="2179351">(</span><span class="ident" id="2179352">_lgamS</span><span class="op" id="2179358">[</span><span class="num" id="2179359">1</span><span class="op" id="2179360">]</span><span class="op" id="2179361">+</span><span class="ident" id="2179362">y</span><span class="op" id="2179363">*</span><span class="op" id="2179364">(</span><span class="ident" id="2179365">_lgamS</span><span class="op" id="2179371">[</span><span class="num" id="2179372">2</span><span class="op" id="2179373">]</span><span class="op" id="2179374">+</span><span class="ident" id="2179375">y</span><span class="op" id="2179376">*</span><span class="op" id="2179377">(</span><span class="ident" id="2179378">_lgamS</span><span class="op" id="2179384">[</span><span class="num" id="2179385">3</span><span class="op" id="2179386">]</span><span class="op" id="2179387">+</span><span class="ident" id="2179388">y</span><span class="op" id="2179389">*</span><span class="op" id="2179390">(</span><span class="ident" id="2179391">_lgamS</span><span class="op" id="2179397">[</span><span class="num" id="2179398">4</span><span class="op" id="2179399">]</span><span class="op" id="2179400">+</span><span class="ident" id="2179401">y</span><span class="op" id="2179402">*</span><span class="op" id="2179403">(</span><span class="ident" id="2179404">_lgamS</span><span class="op" id="2179410">[</span><span class="num" id="2179411">5</span><span class="op" id="2179412">]</span><span class="op" id="2179413">+</span><span class="ident" id="2179414">y</span><span class="op" id="2179415">*</span><span class="ident" id="2179416">_lgamS</span><span class="op" id="2179422">[</span><span class="num" id="2179423">6</span><span class="op" id="2179424">]</span><span class="op" id="2179425">)</span><span class="op" id="2179426">)</span><span class="op" id="2179427">)</span><span class="op" id="2179428">)</span><span class="op" id="2179429">)</span><span class="op" id="2179430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179434">q</span>&nbsp;<span class="op" id="2179436">:=</span>&nbsp;<span class="num" id="2179439">1</span>&nbsp;<span class="op" id="2179441">+</span>&nbsp;<span class="ident" id="2179443">y</span><span class="op" id="2179444">*</span><span class="op" id="2179445">(</span><span class="ident" id="2179446">_lgamR</span><span class="op" id="2179452">[</span><span class="num" id="2179453">1</span><span class="op" id="2179454">]</span><span class="op" id="2179455">+</span><span class="ident" id="2179456">y</span><span class="op" id="2179457">*</span><span class="op" id="2179458">(</span><span class="ident" id="2179459">_lgamR</span><span class="op" id="2179465">[</span><span class="num" id="2179466">2</span><span class="op" id="2179467">]</span><span class="op" id="2179468">+</span><span class="ident" id="2179469">y</span><span class="op" id="2179470">*</span><span class="op" id="2179471">(</span><span class="ident" id="2179472">_lgamR</span><span class="op" id="2179478">[</span><span class="num" id="2179479">3</span><span class="op" id="2179480">]</span><span class="op" id="2179481">+</span><span class="ident" id="2179482">y</span><span class="op" id="2179483">*</span><span class="op" id="2179484">(</span><span class="ident" id="2179485">_lgamR</span><span class="op" id="2179491">[</span><span class="num" id="2179492">4</span><span class="op" id="2179493">]</span><span class="op" id="2179494">+</span><span class="ident" id="2179495">y</span><span class="op" id="2179496">*</span><span class="op" id="2179497">(</span><span class="ident" id="2179498">_lgamR</span><span class="op" id="2179504">[</span><span class="num" id="2179505">5</span><span class="op" id="2179506">]</span><span class="op" id="2179507">+</span><span class="ident" id="2179508">y</span><span class="op" id="2179509">*</span><span class="ident" id="2179510">_lgamR</span><span class="op" id="2179516">[</span><span class="num" id="2179517">6</span><span class="op" id="2179518">]</span><span class="op" id="2179519">)</span><span class="op" id="2179520">)</span><span class="op" id="2179521">)</span><span class="op" id="2179522">)</span><span class="op" id="2179523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179527">lgamma</span>&nbsp;<span class="op" id="2179534">=</span>&nbsp;<span class="num" id="2179536">0.5</span><span class="op" id="2179539">*</span><span class="ident" id="2179540">y</span>&nbsp;<span class="op" id="2179542">+</span>&nbsp;<span class="ident" id="2179544">p</span><span class="op" id="2179545">/</span><span class="ident" id="2179546">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179550">z</span>&nbsp;<span class="op" id="2179552">:=</span>&nbsp;<span class="num" id="2179555">1.0</span>&nbsp;<span class="comment" id="2179559">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179597">switch</span>&nbsp;<span class="ident" id="2179604">i</span>&nbsp;<span class="op" id="2179606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179610">case</span>&nbsp;<span class="num" id="2179615">7</span><span class="op" id="2179616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179621">z</span>&nbsp;<span class="op" id="2179623">*=</span>&nbsp;<span class="op" id="2179626">(</span><span class="ident" id="2179627">y</span>&nbsp;<span class="op" id="2179629">+</span>&nbsp;<span class="num" id="2179631">6</span><span class="op" id="2179632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179637">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179651">case</span>&nbsp;<span class="num" id="2179656">6</span><span class="op" id="2179657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179662">z</span>&nbsp;<span class="op" id="2179664">*=</span>&nbsp;<span class="op" id="2179667">(</span><span class="ident" id="2179668">y</span>&nbsp;<span class="op" id="2179670">+</span>&nbsp;<span class="num" id="2179672">5</span><span class="op" id="2179673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179678">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179692">case</span>&nbsp;<span class="num" id="2179697">5</span><span class="op" id="2179698">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179703">z</span>&nbsp;<span class="op" id="2179705">*=</span>&nbsp;<span class="op" id="2179708">(</span><span class="ident" id="2179709">y</span>&nbsp;<span class="op" id="2179711">+</span>&nbsp;<span class="num" id="2179713">4</span><span class="op" id="2179714">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179719">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179733">case</span>&nbsp;<span class="num" id="2179738">4</span><span class="op" id="2179739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179744">z</span>&nbsp;<span class="op" id="2179746">*=</span>&nbsp;<span class="op" id="2179749">(</span><span class="ident" id="2179750">y</span>&nbsp;<span class="op" id="2179752">+</span>&nbsp;<span class="num" id="2179754">3</span><span class="op" id="2179755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179760">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179774">case</span>&nbsp;<span class="num" id="2179779">3</span><span class="op" id="2179780">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179785">z</span>&nbsp;<span class="op" id="2179787">*=</span>&nbsp;<span class="op" id="2179790">(</span><span class="ident" id="2179791">y</span>&nbsp;<span class="op" id="2179793">+</span>&nbsp;<span class="num" id="2179795">2</span><span class="op" id="2179796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179801">lgamma</span>&nbsp;<span class="op" id="2179808">+=</span>&nbsp;<span class="ident" id="2179811">Log</span><span class="op" id="2179814">(</span><span class="ident" id="2179815">z</span><span class="op" id="2179816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179823">case</span>&nbsp;<span class="ident" id="2179828">x</span>&nbsp;<span class="op" id="2179830">&lt;</span>&nbsp;<span class="ident" id="2179832">Two58</span><span class="op" id="2179837">:</span>&nbsp;<span class="comment" id="2179839">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179859">t</span>&nbsp;<span class="op" id="2179861">:=</span>&nbsp;<span class="ident" id="2179864">Log</span><span class="op" id="2179867">(</span><span class="ident" id="2179868">x</span><span class="op" id="2179869">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179873">z</span>&nbsp;<span class="op" id="2179875">:=</span>&nbsp;<span class="num" id="2179878">1</span>&nbsp;<span class="op" id="2179880">/</span>&nbsp;<span class="ident" id="2179882">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179886">y</span>&nbsp;<span class="op" id="2179888">:=</span>&nbsp;<span class="ident" id="2179891">z</span>&nbsp;<span class="op" id="2179893">*</span>&nbsp;<span class="ident" id="2179895">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179899">w</span>&nbsp;<span class="op" id="2179901">:=</span>&nbsp;<span class="ident" id="2179904">_lgamW</span><span class="op" id="2179910">[</span><span class="num" id="2179911">0</span><span class="op" id="2179912">]</span>&nbsp;<span class="op" id="2179914">+</span>&nbsp;<span class="ident" id="2179916">z</span><span class="op" id="2179917">*</span><span class="op" id="2179918">(</span><span class="ident" id="2179919">_lgamW</span><span class="op" id="2179925">[</span><span class="num" id="2179926">1</span><span class="op" id="2179927">]</span><span class="op" id="2179928">+</span><span class="ident" id="2179929">y</span><span class="op" id="2179930">*</span><span class="op" id="2179931">(</span><span class="ident" id="2179932">_lgamW</span><span class="op" id="2179938">[</span><span class="num" id="2179939">2</span><span class="op" id="2179940">]</span><span class="op" id="2179941">+</span><span class="ident" id="2179942">y</span><span class="op" id="2179943">*</span><span class="op" id="2179944">(</span><span class="ident" id="2179945">_lgamW</span><span class="op" id="2179951">[</span><span class="num" id="2179952">3</span><span class="op" id="2179953">]</span><span class="op" id="2179954">+</span><span class="ident" id="2179955">y</span><span class="op" id="2179956">*</span><span class="op" id="2179957">(</span><span class="ident" id="2179958">_lgamW</span><span class="op" id="2179964">[</span><span class="num" id="2179965">4</span><span class="op" id="2179966">]</span><span class="op" id="2179967">+</span><span class="ident" id="2179968">y</span><span class="op" id="2179969">*</span><span class="op" id="2179970">(</span><span class="ident" id="2179971">_lgamW</span><span class="op" id="2179977">[</span><span class="num" id="2179978">5</span><span class="op" id="2179979">]</span><span class="op" id="2179980">+</span><span class="ident" id="2179981">y</span><span class="op" id="2179982">*</span><span class="ident" id="2179983">_lgamW</span><span class="op" id="2179989">[</span><span class="num" id="2179990">6</span><span class="op" id="2179991">]</span><span class="op" id="2179992">)</span><span class="op" id="2179993">)</span><span class="op" id="2179994">)</span><span class="op" id="2179995">)</span><span class="op" id="2179996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180000">lgamma</span>&nbsp;<span class="op" id="2180007">=</span>&nbsp;<span class="op" id="2180009">(</span><span class="ident" id="2180010">x</span><span class="op" id="2180011">-</span><span class="num" id="2180012">0.5</span><span class="op" id="2180015">)</span><span class="op" id="2180016">*</span><span class="op" id="2180017">(</span><span class="ident" id="2180018">t</span><span class="op" id="2180019">-</span><span class="num" id="2180020">1</span><span class="op" id="2180021">)</span>&nbsp;<span class="op" id="2180023">+</span>&nbsp;<span class="ident" id="2180025">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180028">default</span><span class="op" id="2180035">:</span>&nbsp;<span class="comment" id="2180037">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180060">lgamma</span>&nbsp;<span class="op" id="2180067">=</span>&nbsp;<span class="ident" id="2180069">x</span>&nbsp;<span class="op" id="2180071">*</span>&nbsp;<span class="op" id="2180073">(</span><span class="ident" id="2180074">Log</span><span class="op" id="2180077">(</span><span class="ident" id="2180078">x</span><span class="op" id="2180079">)</span>&nbsp;<span class="op" id="2180081">-</span>&nbsp;<span class="num" id="2180083">1</span><span class="op" id="2180084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180090">if</span>&nbsp;<span class="ident" id="2180093">neg</span>&nbsp;<span class="op" id="2180097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180101">lgamma</span>&nbsp;<span class="op" id="2180108">=</span>&nbsp;<span class="ident" id="2180110">nadj</span>&nbsp;<span class="op" id="2180115">-</span>&nbsp;<span class="ident" id="2180117">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180125">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180128">return</span><br>
<span class="lineno"></span><span class="op" id="2180135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2180138">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2180186">func</span>&nbsp;<span class="ident" id="2180191">sinPi</span><span class="op" id="2180196">(</span><span class="ident" id="2180197">x</span>&nbsp;<span class="builtintype" id="2180199">float64</span><span class="op" id="2180206">)</span>&nbsp;<span class="builtintype" id="2180208">float64</span>&nbsp;<span class="op" id="2180216">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180219">const</span>&nbsp;<span class="op" id="2180225">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180229">Two52</span>&nbsp;<span class="op" id="2180235">=</span>&nbsp;<span class="num" id="2180237">1</span>&nbsp;<span class="op" id="2180239">&lt;&lt;</span>&nbsp;<span class="num" id="2180242">52</span>&nbsp;<span class="comment" id="2180245">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180281">Two53</span>&nbsp;<span class="op" id="2180287">=</span>&nbsp;<span class="num" id="2180289">1</span>&nbsp;<span class="op" id="2180291">&lt;&lt;</span>&nbsp;<span class="num" id="2180294">53</span>&nbsp;<span class="comment" id="2180297">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180335">if</span>&nbsp;<span class="ident" id="2180338">x</span>&nbsp;<span class="op" id="2180340">&lt;</span>&nbsp;<span class="num" id="2180342">0.25</span>&nbsp;<span class="op" id="2180347">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180351">return</span>&nbsp;<span class="op" id="2180358">-</span><span class="ident" id="2180359">Sin</span><span class="op" id="2180362">(</span><span class="ident" id="2180363">Pi</span>&nbsp;<span class="op" id="2180366">*</span>&nbsp;<span class="ident" id="2180368">x</span><span class="op" id="2180369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2180376">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180399">z</span>&nbsp;<span class="op" id="2180401">:=</span>&nbsp;<span class="ident" id="2180404">Floor</span><span class="op" id="2180409">(</span><span class="ident" id="2180410">x</span><span class="op" id="2180411">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180414">var</span>&nbsp;<span class="ident" id="2180418">n</span>&nbsp;<span class="builtintype" id="2180420">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180425">if</span>&nbsp;<span class="ident" id="2180428">z</span>&nbsp;<span class="op" id="2180430">!=</span>&nbsp;<span class="ident" id="2180433">x</span>&nbsp;<span class="op" id="2180435">{</span>&nbsp;<span class="comment" id="2180437">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180450">x</span>&nbsp;<span class="op" id="2180452">=</span>&nbsp;<span class="ident" id="2180454">Mod</span><span class="op" id="2180457">(</span><span class="ident" id="2180458">x</span><span class="op" id="2180459">,</span>&nbsp;<span class="num" id="2180461">2</span><span class="op" id="2180462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180466">n</span>&nbsp;<span class="op" id="2180468">=</span>&nbsp;<span class="builtintype" id="2180470">int</span><span class="op" id="2180473">(</span><span class="ident" id="2180474">x</span>&nbsp;<span class="op" id="2180476">*</span>&nbsp;<span class="num" id="2180478">4</span><span class="op" id="2180479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180482">}</span>&nbsp;<span class="keyword" id="2180484">else</span>&nbsp;<span class="op" id="2180489">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180493">if</span>&nbsp;<span class="ident" id="2180496">x</span>&nbsp;<span class="op" id="2180498">&gt;=</span>&nbsp;<span class="ident" id="2180501">Two53</span>&nbsp;<span class="op" id="2180507">{</span>&nbsp;<span class="comment" id="2180509">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180530">x</span>&nbsp;<span class="op" id="2180532">=</span>&nbsp;<span class="num" id="2180534">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180539">n</span>&nbsp;<span class="op" id="2180541">=</span>&nbsp;<span class="num" id="2180543">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180547">}</span>&nbsp;<span class="keyword" id="2180549">else</span>&nbsp;<span class="op" id="2180554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180559">if</span>&nbsp;<span class="ident" id="2180562">x</span>&nbsp;<span class="op" id="2180564">&lt;</span>&nbsp;<span class="ident" id="2180566">Two52</span>&nbsp;<span class="op" id="2180572">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180578">z</span>&nbsp;<span class="op" id="2180580">=</span>&nbsp;<span class="ident" id="2180582">x</span>&nbsp;<span class="op" id="2180584">+</span>&nbsp;<span class="ident" id="2180586">Two52</span>&nbsp;<span class="comment" id="2180592">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180609">n</span>&nbsp;<span class="op" id="2180611">=</span>&nbsp;<span class="builtintype" id="2180613">int</span><span class="op" id="2180616">(</span><span class="num" id="2180617">1</span>&nbsp;<span class="op" id="2180619">&amp;</span>&nbsp;<span class="ident" id="2180621">Float64bits</span><span class="op" id="2180632">(</span><span class="ident" id="2180633">z</span><span class="op" id="2180634">)</span><span class="op" id="2180635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180640">x</span>&nbsp;<span class="op" id="2180642">=</span>&nbsp;<span class="builtintype" id="2180644">float64</span><span class="op" id="2180651">(</span><span class="ident" id="2180652">n</span><span class="op" id="2180653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180658">n</span>&nbsp;<span class="op" id="2180660">&lt;&lt;=</span>&nbsp;<span class="num" id="2180664">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180674">switch</span>&nbsp;<span class="ident" id="2180681">n</span>&nbsp;<span class="op" id="2180683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180686">case</span>&nbsp;<span class="num" id="2180691">0</span><span class="op" id="2180692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180696">x</span>&nbsp;<span class="op" id="2180698">=</span>&nbsp;<span class="ident" id="2180700">Sin</span><span class="op" id="2180703">(</span><span class="ident" id="2180704">Pi</span>&nbsp;<span class="op" id="2180707">*</span>&nbsp;<span class="ident" id="2180709">x</span><span class="op" id="2180710">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180713">case</span>&nbsp;<span class="num" id="2180718">1</span><span class="op" id="2180719">,</span>&nbsp;<span class="num" id="2180721">2</span><span class="op" id="2180722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180726">x</span>&nbsp;<span class="op" id="2180728">=</span>&nbsp;<span class="ident" id="2180730">Cos</span><span class="op" id="2180733">(</span><span class="ident" id="2180734">Pi</span>&nbsp;<span class="op" id="2180737">*</span>&nbsp;<span class="op" id="2180739">(</span><span class="num" id="2180740">0.5</span>&nbsp;<span class="op" id="2180744">-</span>&nbsp;<span class="ident" id="2180746">x</span><span class="op" id="2180747">)</span><span class="op" id="2180748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180751">case</span>&nbsp;<span class="num" id="2180756">3</span><span class="op" id="2180757">,</span>&nbsp;<span class="num" id="2180759">4</span><span class="op" id="2180760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180764">x</span>&nbsp;<span class="op" id="2180766">=</span>&nbsp;<span class="ident" id="2180768">Sin</span><span class="op" id="2180771">(</span><span class="ident" id="2180772">Pi</span>&nbsp;<span class="op" id="2180775">*</span>&nbsp;<span class="op" id="2180777">(</span><span class="num" id="2180778">1</span>&nbsp;<span class="op" id="2180780">-</span>&nbsp;<span class="ident" id="2180782">x</span><span class="op" id="2180783">)</span><span class="op" id="2180784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180787">case</span>&nbsp;<span class="num" id="2180792">5</span><span class="op" id="2180793">,</span>&nbsp;<span class="num" id="2180795">6</span><span class="op" id="2180796">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180800">x</span>&nbsp;<span class="op" id="2180802">=</span>&nbsp;<span class="op" id="2180804">-</span><span class="ident" id="2180805">Cos</span><span class="op" id="2180808">(</span><span class="ident" id="2180809">Pi</span>&nbsp;<span class="op" id="2180812">*</span>&nbsp;<span class="op" id="2180814">(</span><span class="ident" id="2180815">x</span>&nbsp;<span class="op" id="2180817">-</span>&nbsp;<span class="num" id="2180819">1.5</span><span class="op" id="2180822">)</span><span class="op" id="2180823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180826">default</span><span class="op" id="2180833">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180837">x</span>&nbsp;<span class="op" id="2180839">=</span>&nbsp;<span class="ident" id="2180841">Sin</span><span class="op" id="2180844">(</span><span class="ident" id="2180845">Pi</span>&nbsp;<span class="op" id="2180848">*</span>&nbsp;<span class="op" id="2180850">(</span><span class="ident" id="2180851">x</span>&nbsp;<span class="op" id="2180853">-</span>&nbsp;<span class="num" id="2180855">2</span><span class="op" id="2180856">)</span><span class="op" id="2180857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180863">return</span>&nbsp;<span class="op" id="2180870">-</span><span class="ident" id="2180871">x</span><br>
<span class="lineno">365</span><span class="op" id="2180873">}</span>
</div>
</body>
</html>
