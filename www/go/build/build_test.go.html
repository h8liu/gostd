<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7928432">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7928488">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7928542">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7928593">package</span>&nbsp;<span class="ident" id="7928601">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7928608">import</span>&nbsp;<span class="op" id="7928615">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7928618">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7928624">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7928630">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7928647">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7928658">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7928669">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7928680">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7928690">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7928693">func</span>&nbsp;<span class="ident" id="7928698">TestMatch</span><span class="op" id="7928707">(</span><span class="ident" id="7928708">t</span>&nbsp;<span class="op" id="7928710">*</span><span class="ident" id="7928711">testing</span><span class="op" id="7928718">.</span><span class="ident" id="7928719">T</span><span class="op" id="7928720">)</span>&nbsp;<span class="op" id="7928722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928725">ctxt</span>&nbsp;<span class="op" id="7928730">:=</span>&nbsp;<span class="ident" id="7928733">Default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928742">what</span>&nbsp;<span class="op" id="7928747">:=</span>&nbsp;<span class="string" id="7928750">&#34;default&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928761">match</span>&nbsp;<span class="op" id="7928767">:=</span>&nbsp;<span class="keyword" id="7928770">func</span><span class="op" id="7928774">(</span><span class="ident" id="7928775">tag</span>&nbsp;<span class="builtintype" id="7928779">string</span><span class="op" id="7928785">,</span>&nbsp;<span class="ident" id="7928787">want</span>&nbsp;<span class="keyword" id="7928792">map</span><span class="op" id="7928795">[</span><span class="builtintype" id="7928796">string</span><span class="op" id="7928802">]</span><span class="builtintype" id="7928803">bool</span><span class="op" id="7928807">)</span>&nbsp;<span class="op" id="7928809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928813">m</span>&nbsp;<span class="op" id="7928815">:=</span>&nbsp;<span class="builtinfunc" id="7928818">make</span><span class="op" id="7928822">(</span><span class="keyword" id="7928823">map</span><span class="op" id="7928826">[</span><span class="builtintype" id="7928827">string</span><span class="op" id="7928833">]</span><span class="builtintype" id="7928834">bool</span><span class="op" id="7928838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928842">if</span>&nbsp;<span class="op" id="7928845">!</span><span class="ident" id="7928846">ctxt</span><span class="op" id="7928850">.</span><span class="ident" id="7928851">match</span><span class="op" id="7928856">(</span><span class="ident" id="7928857">tag</span><span class="op" id="7928860">,</span>&nbsp;<span class="ident" id="7928862">m</span><span class="op" id="7928863">)</span>&nbsp;<span class="op" id="7928865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928870">t</span><span class="op" id="7928871">.</span><span class="ident" id="7928872">Errorf</span><span class="op" id="7928878">(</span><span class="string" id="7928879">&#34;%s&nbsp;context&nbsp;should&nbsp;match&nbsp;%s,&nbsp;does&nbsp;not&#34;</span><span class="op" id="7928917">,</span>&nbsp;<span class="ident" id="7928919">what</span><span class="op" id="7928923">,</span>&nbsp;<span class="ident" id="7928925">tag</span><span class="op" id="7928928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928932">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928936">if</span>&nbsp;<span class="op" id="7928939">!</span><span class="ident" id="7928940">reflect</span><span class="op" id="7928947">.</span><span class="ident" id="7928948">DeepEqual</span><span class="op" id="7928957">(</span><span class="ident" id="7928958">m</span><span class="op" id="7928959">,</span>&nbsp;<span class="ident" id="7928961">want</span><span class="op" id="7928965">)</span>&nbsp;<span class="op" id="7928967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928972">t</span><span class="op" id="7928973">.</span><span class="ident" id="7928974">Errorf</span><span class="op" id="7928980">(</span><span class="string" id="7928981">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7929004">,</span>&nbsp;<span class="ident" id="7929006">tag</span><span class="op" id="7929009">,</span>&nbsp;<span class="ident" id="7929011">m</span><span class="op" id="7929012">,</span>&nbsp;<span class="ident" id="7929014">want</span><span class="op" id="7929018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929028">nomatch</span>&nbsp;<span class="op" id="7929036">:=</span>&nbsp;<span class="keyword" id="7929039">func</span><span class="op" id="7929043">(</span><span class="ident" id="7929044">tag</span>&nbsp;<span class="builtintype" id="7929048">string</span><span class="op" id="7929054">,</span>&nbsp;<span class="ident" id="7929056">want</span>&nbsp;<span class="keyword" id="7929061">map</span><span class="op" id="7929064">[</span><span class="builtintype" id="7929065">string</span><span class="op" id="7929071">]</span><span class="builtintype" id="7929072">bool</span><span class="op" id="7929076">)</span>&nbsp;<span class="op" id="7929078">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929082">m</span>&nbsp;<span class="op" id="7929084">:=</span>&nbsp;<span class="builtinfunc" id="7929087">make</span><span class="op" id="7929091">(</span><span class="keyword" id="7929092">map</span><span class="op" id="7929095">[</span><span class="builtintype" id="7929096">string</span><span class="op" id="7929102">]</span><span class="builtintype" id="7929103">bool</span><span class="op" id="7929107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929111">if</span>&nbsp;<span class="ident" id="7929114">ctxt</span><span class="op" id="7929118">.</span><span class="ident" id="7929119">match</span><span class="op" id="7929124">(</span><span class="ident" id="7929125">tag</span><span class="op" id="7929128">,</span>&nbsp;<span class="ident" id="7929130">m</span><span class="op" id="7929131">)</span>&nbsp;<span class="op" id="7929133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929138">t</span><span class="op" id="7929139">.</span><span class="ident" id="7929140">Errorf</span><span class="op" id="7929146">(</span><span class="string" id="7929147">&#34;%s&nbsp;context&nbsp;should&nbsp;NOT&nbsp;match&nbsp;%s,&nbsp;does&#34;</span><span class="op" id="7929185">,</span>&nbsp;<span class="ident" id="7929187">what</span><span class="op" id="7929191">,</span>&nbsp;<span class="ident" id="7929193">tag</span><span class="op" id="7929196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929204">if</span>&nbsp;<span class="op" id="7929207">!</span><span class="ident" id="7929208">reflect</span><span class="op" id="7929215">.</span><span class="ident" id="7929216">DeepEqual</span><span class="op" id="7929225">(</span><span class="ident" id="7929226">m</span><span class="op" id="7929227">,</span>&nbsp;<span class="ident" id="7929229">want</span><span class="op" id="7929233">)</span>&nbsp;<span class="op" id="7929235">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929240">t</span><span class="op" id="7929241">.</span><span class="ident" id="7929242">Errorf</span><span class="op" id="7929248">(</span><span class="string" id="7929249">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7929272">,</span>&nbsp;<span class="ident" id="7929274">tag</span><span class="op" id="7929277">,</span>&nbsp;<span class="ident" id="7929279">m</span><span class="op" id="7929280">,</span>&nbsp;<span class="ident" id="7929282">want</span><span class="op" id="7929286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929297">match</span><span class="op" id="7929302">(</span><span class="ident" id="7929303">runtime</span><span class="op" id="7929310">.</span><span class="ident" id="7929311">GOOS</span><span class="op" id="7929315">+</span><span class="string" id="7929316">&#34;,&#34;</span><span class="op" id="7929319">+</span><span class="ident" id="7929320">runtime</span><span class="op" id="7929327">.</span><span class="ident" id="7929328">GOARCH</span><span class="op" id="7929334">,</span>&nbsp;<span class="keyword" id="7929336">map</span><span class="op" id="7929339">[</span><span class="builtintype" id="7929340">string</span><span class="op" id="7929346">]</span><span class="builtintype" id="7929347">bool</span><span class="op" id="7929351">{</span><span class="ident" id="7929352">runtime</span><span class="op" id="7929359">.</span><span class="ident" id="7929360">GOOS</span><span class="op" id="7929364">:</span>&nbsp;<span class="ident" id="7929366">true</span><span class="op" id="7929370">,</span>&nbsp;<span class="ident" id="7929372">runtime</span><span class="op" id="7929379">.</span><span class="ident" id="7929380">GOARCH</span><span class="op" id="7929386">:</span>&nbsp;<span class="ident" id="7929388">true</span><span class="op" id="7929392">}</span><span class="op" id="7929393">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929396">match</span><span class="op" id="7929401">(</span><span class="ident" id="7929402">runtime</span><span class="op" id="7929409">.</span><span class="ident" id="7929410">GOOS</span><span class="op" id="7929414">+</span><span class="string" id="7929415">&#34;,&#34;</span><span class="op" id="7929418">+</span><span class="ident" id="7929419">runtime</span><span class="op" id="7929426">.</span><span class="ident" id="7929427">GOARCH</span><span class="op" id="7929433">+</span><span class="string" id="7929434">&#34;,!foo&#34;</span><span class="op" id="7929441">,</span>&nbsp;<span class="keyword" id="7929443">map</span><span class="op" id="7929446">[</span><span class="builtintype" id="7929447">string</span><span class="op" id="7929453">]</span><span class="builtintype" id="7929454">bool</span><span class="op" id="7929458">{</span><span class="ident" id="7929459">runtime</span><span class="op" id="7929466">.</span><span class="ident" id="7929467">GOOS</span><span class="op" id="7929471">:</span>&nbsp;<span class="ident" id="7929473">true</span><span class="op" id="7929477">,</span>&nbsp;<span class="ident" id="7929479">runtime</span><span class="op" id="7929486">.</span><span class="ident" id="7929487">GOARCH</span><span class="op" id="7929493">:</span>&nbsp;<span class="ident" id="7929495">true</span><span class="op" id="7929499">,</span>&nbsp;<span class="string" id="7929501">&#34;foo&#34;</span><span class="op" id="7929506">:</span>&nbsp;<span class="ident" id="7929508">true</span><span class="op" id="7929512">}</span><span class="op" id="7929513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929516">nomatch</span><span class="op" id="7929523">(</span><span class="ident" id="7929524">runtime</span><span class="op" id="7929531">.</span><span class="ident" id="7929532">GOOS</span><span class="op" id="7929536">+</span><span class="string" id="7929537">&#34;,&#34;</span><span class="op" id="7929540">+</span><span class="ident" id="7929541">runtime</span><span class="op" id="7929548">.</span><span class="ident" id="7929549">GOARCH</span><span class="op" id="7929555">+</span><span class="string" id="7929556">&#34;,foo&#34;</span><span class="op" id="7929562">,</span>&nbsp;<span class="keyword" id="7929564">map</span><span class="op" id="7929567">[</span><span class="builtintype" id="7929568">string</span><span class="op" id="7929574">]</span><span class="builtintype" id="7929575">bool</span><span class="op" id="7929579">{</span><span class="ident" id="7929580">runtime</span><span class="op" id="7929587">.</span><span class="ident" id="7929588">GOOS</span><span class="op" id="7929592">:</span>&nbsp;<span class="ident" id="7929594">true</span><span class="op" id="7929598">,</span>&nbsp;<span class="ident" id="7929600">runtime</span><span class="op" id="7929607">.</span><span class="ident" id="7929608">GOARCH</span><span class="op" id="7929614">:</span>&nbsp;<span class="ident" id="7929616">true</span><span class="op" id="7929620">,</span>&nbsp;<span class="string" id="7929622">&#34;foo&#34;</span><span class="op" id="7929627">:</span>&nbsp;<span class="ident" id="7929629">true</span><span class="op" id="7929633">}</span><span class="op" id="7929634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929638">what</span>&nbsp;<span class="op" id="7929643">=</span>&nbsp;<span class="string" id="7929645">&#34;modified&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929657">ctxt</span><span class="op" id="7929661">.</span><span class="ident" id="7929662">BuildTags</span>&nbsp;<span class="op" id="7929672">=</span>&nbsp;<span class="op" id="7929674">[</span><span class="op" id="7929675">]</span><span class="builtintype" id="7929676">string</span><span class="op" id="7929682">{</span><span class="string" id="7929683">&#34;foo&#34;</span><span class="op" id="7929688">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929691">match</span><span class="op" id="7929696">(</span><span class="ident" id="7929697">runtime</span><span class="op" id="7929704">.</span><span class="ident" id="7929705">GOOS</span><span class="op" id="7929709">+</span><span class="string" id="7929710">&#34;,&#34;</span><span class="op" id="7929713">+</span><span class="ident" id="7929714">runtime</span><span class="op" id="7929721">.</span><span class="ident" id="7929722">GOARCH</span><span class="op" id="7929728">,</span>&nbsp;<span class="keyword" id="7929730">map</span><span class="op" id="7929733">[</span><span class="builtintype" id="7929734">string</span><span class="op" id="7929740">]</span><span class="builtintype" id="7929741">bool</span><span class="op" id="7929745">{</span><span class="ident" id="7929746">runtime</span><span class="op" id="7929753">.</span><span class="ident" id="7929754">GOOS</span><span class="op" id="7929758">:</span>&nbsp;<span class="ident" id="7929760">true</span><span class="op" id="7929764">,</span>&nbsp;<span class="ident" id="7929766">runtime</span><span class="op" id="7929773">.</span><span class="ident" id="7929774">GOARCH</span><span class="op" id="7929780">:</span>&nbsp;<span class="ident" id="7929782">true</span><span class="op" id="7929786">}</span><span class="op" id="7929787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929790">match</span><span class="op" id="7929795">(</span><span class="ident" id="7929796">runtime</span><span class="op" id="7929803">.</span><span class="ident" id="7929804">GOOS</span><span class="op" id="7929808">+</span><span class="string" id="7929809">&#34;,&#34;</span><span class="op" id="7929812">+</span><span class="ident" id="7929813">runtime</span><span class="op" id="7929820">.</span><span class="ident" id="7929821">GOARCH</span><span class="op" id="7929827">+</span><span class="string" id="7929828">&#34;,foo&#34;</span><span class="op" id="7929834">,</span>&nbsp;<span class="keyword" id="7929836">map</span><span class="op" id="7929839">[</span><span class="builtintype" id="7929840">string</span><span class="op" id="7929846">]</span><span class="builtintype" id="7929847">bool</span><span class="op" id="7929851">{</span><span class="ident" id="7929852">runtime</span><span class="op" id="7929859">.</span><span class="ident" id="7929860">GOOS</span><span class="op" id="7929864">:</span>&nbsp;<span class="ident" id="7929866">true</span><span class="op" id="7929870">,</span>&nbsp;<span class="ident" id="7929872">runtime</span><span class="op" id="7929879">.</span><span class="ident" id="7929880">GOARCH</span><span class="op" id="7929886">:</span>&nbsp;<span class="ident" id="7929888">true</span><span class="op" id="7929892">,</span>&nbsp;<span class="string" id="7929894">&#34;foo&#34;</span><span class="op" id="7929899">:</span>&nbsp;<span class="ident" id="7929901">true</span><span class="op" id="7929905">}</span><span class="op" id="7929906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929909">nomatch</span><span class="op" id="7929916">(</span><span class="ident" id="7929917">runtime</span><span class="op" id="7929924">.</span><span class="ident" id="7929925">GOOS</span><span class="op" id="7929929">+</span><span class="string" id="7929930">&#34;,&#34;</span><span class="op" id="7929933">+</span><span class="ident" id="7929934">runtime</span><span class="op" id="7929941">.</span><span class="ident" id="7929942">GOARCH</span><span class="op" id="7929948">+</span><span class="string" id="7929949">&#34;,!foo&#34;</span><span class="op" id="7929956">,</span>&nbsp;<span class="keyword" id="7929958">map</span><span class="op" id="7929961">[</span><span class="builtintype" id="7929962">string</span><span class="op" id="7929968">]</span><span class="builtintype" id="7929969">bool</span><span class="op" id="7929973">{</span><span class="ident" id="7929974">runtime</span><span class="op" id="7929981">.</span><span class="ident" id="7929982">GOOS</span><span class="op" id="7929986">:</span>&nbsp;<span class="ident" id="7929988">true</span><span class="op" id="7929992">,</span>&nbsp;<span class="ident" id="7929994">runtime</span><span class="op" id="7930001">.</span><span class="ident" id="7930002">GOARCH</span><span class="op" id="7930008">:</span>&nbsp;<span class="ident" id="7930010">true</span><span class="op" id="7930014">,</span>&nbsp;<span class="string" id="7930016">&#34;foo&#34;</span><span class="op" id="7930021">:</span>&nbsp;<span class="ident" id="7930023">true</span><span class="op" id="7930027">}</span><span class="op" id="7930028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930031">match</span><span class="op" id="7930036">(</span><span class="ident" id="7930037">runtime</span><span class="op" id="7930044">.</span><span class="ident" id="7930045">GOOS</span><span class="op" id="7930049">+</span><span class="string" id="7930050">&#34;,&#34;</span><span class="op" id="7930053">+</span><span class="ident" id="7930054">runtime</span><span class="op" id="7930061">.</span><span class="ident" id="7930062">GOARCH</span><span class="op" id="7930068">+</span><span class="string" id="7930069">&#34;,!bar&#34;</span><span class="op" id="7930076">,</span>&nbsp;<span class="keyword" id="7930078">map</span><span class="op" id="7930081">[</span><span class="builtintype" id="7930082">string</span><span class="op" id="7930088">]</span><span class="builtintype" id="7930089">bool</span><span class="op" id="7930093">{</span><span class="ident" id="7930094">runtime</span><span class="op" id="7930101">.</span><span class="ident" id="7930102">GOOS</span><span class="op" id="7930106">:</span>&nbsp;<span class="ident" id="7930108">true</span><span class="op" id="7930112">,</span>&nbsp;<span class="ident" id="7930114">runtime</span><span class="op" id="7930121">.</span><span class="ident" id="7930122">GOARCH</span><span class="op" id="7930128">:</span>&nbsp;<span class="ident" id="7930130">true</span><span class="op" id="7930134">,</span>&nbsp;<span class="string" id="7930136">&#34;bar&#34;</span><span class="op" id="7930141">:</span>&nbsp;<span class="ident" id="7930143">true</span><span class="op" id="7930147">}</span><span class="op" id="7930148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930151">nomatch</span><span class="op" id="7930158">(</span><span class="ident" id="7930159">runtime</span><span class="op" id="7930166">.</span><span class="ident" id="7930167">GOOS</span><span class="op" id="7930171">+</span><span class="string" id="7930172">&#34;,&#34;</span><span class="op" id="7930175">+</span><span class="ident" id="7930176">runtime</span><span class="op" id="7930183">.</span><span class="ident" id="7930184">GOARCH</span><span class="op" id="7930190">+</span><span class="string" id="7930191">&#34;,bar&#34;</span><span class="op" id="7930197">,</span>&nbsp;<span class="keyword" id="7930199">map</span><span class="op" id="7930202">[</span><span class="builtintype" id="7930203">string</span><span class="op" id="7930209">]</span><span class="builtintype" id="7930210">bool</span><span class="op" id="7930214">{</span><span class="ident" id="7930215">runtime</span><span class="op" id="7930222">.</span><span class="ident" id="7930223">GOOS</span><span class="op" id="7930227">:</span>&nbsp;<span class="ident" id="7930229">true</span><span class="op" id="7930233">,</span>&nbsp;<span class="ident" id="7930235">runtime</span><span class="op" id="7930242">.</span><span class="ident" id="7930243">GOARCH</span><span class="op" id="7930249">:</span>&nbsp;<span class="ident" id="7930251">true</span><span class="op" id="7930255">,</span>&nbsp;<span class="string" id="7930257">&#34;bar&#34;</span><span class="op" id="7930262">:</span>&nbsp;<span class="ident" id="7930264">true</span><span class="op" id="7930268">}</span><span class="op" id="7930269">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930272">nomatch</span><span class="op" id="7930279">(</span><span class="string" id="7930280">&#34;!&#34;</span><span class="op" id="7930283">,</span>&nbsp;<span class="keyword" id="7930285">map</span><span class="op" id="7930288">[</span><span class="builtintype" id="7930289">string</span><span class="op" id="7930295">]</span><span class="builtintype" id="7930296">bool</span><span class="op" id="7930300">{</span><span class="op" id="7930301">}</span><span class="op" id="7930302">)</span><br>
<span class="lineno"></span><span class="op" id="7930304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7930307">func</span>&nbsp;<span class="ident" id="7930312">TestDotSlashImport</span><span class="op" id="7930330">(</span><span class="ident" id="7930331">t</span>&nbsp;<span class="op" id="7930333">*</span><span class="ident" id="7930334">testing</span><span class="op" id="7930341">.</span><span class="ident" id="7930342">T</span><span class="op" id="7930343">)</span>&nbsp;<span class="op" id="7930345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930348">p</span><span class="op" id="7930349">,</span>&nbsp;<span class="ident" id="7930351">err</span>&nbsp;<span class="op" id="7930355">:=</span>&nbsp;<span class="ident" id="7930358">ImportDir</span><span class="op" id="7930367">(</span><span class="string" id="7930368">&#34;testdata/other&#34;</span><span class="op" id="7930384">,</span>&nbsp;<span class="num" id="7930386">0</span><span class="op" id="7930387">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930390">if</span>&nbsp;<span class="ident" id="7930393">err</span>&nbsp;<span class="op" id="7930397">!=</span>&nbsp;<span class="ident" id="7930400">nil</span>&nbsp;<span class="op" id="7930404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930408">t</span><span class="op" id="7930409">.</span><span class="ident" id="7930410">Fatal</span><span class="op" id="7930415">(</span><span class="ident" id="7930416">err</span><span class="op" id="7930419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930425">if</span>&nbsp;<span class="builtinfunc" id="7930428">len</span><span class="op" id="7930431">(</span><span class="ident" id="7930432">p</span><span class="op" id="7930433">.</span><span class="ident" id="7930434">Imports</span><span class="op" id="7930441">)</span>&nbsp;<span class="op" id="7930443">!=</span>&nbsp;<span class="num" id="7930446">1</span>&nbsp;<span class="op" id="7930448">||</span>&nbsp;<span class="ident" id="7930451">p</span><span class="op" id="7930452">.</span><span class="ident" id="7930453">Imports</span><span class="op" id="7930460">[</span><span class="num" id="7930461">0</span><span class="op" id="7930462">]</span>&nbsp;<span class="op" id="7930464">!=</span>&nbsp;<span class="string" id="7930467">&#34;./file&#34;</span>&nbsp;<span class="op" id="7930476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930480">t</span><span class="op" id="7930481">.</span><span class="ident" id="7930482">Fatalf</span><span class="op" id="7930488">(</span><span class="string" id="7930489">&#34;testdata/other:&nbsp;Imports=%v,&nbsp;want&nbsp;[./file]&#34;</span><span class="op" id="7930532">,</span>&nbsp;<span class="ident" id="7930534">p</span><span class="op" id="7930535">.</span><span class="ident" id="7930536">Imports</span><span class="op" id="7930543">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930550">p1</span><span class="op" id="7930552">,</span>&nbsp;<span class="ident" id="7930554">err</span>&nbsp;<span class="op" id="7930558">:=</span>&nbsp;<span class="ident" id="7930561">Import</span><span class="op" id="7930567">(</span><span class="string" id="7930568">&#34;./file&#34;</span><span class="op" id="7930576">,</span>&nbsp;<span class="string" id="7930578">&#34;testdata/other&#34;</span><span class="op" id="7930594">,</span>&nbsp;<span class="num" id="7930596">0</span><span class="op" id="7930597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930600">if</span>&nbsp;<span class="ident" id="7930603">err</span>&nbsp;<span class="op" id="7930607">!=</span>&nbsp;<span class="ident" id="7930610">nil</span>&nbsp;<span class="op" id="7930614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930618">t</span><span class="op" id="7930619">.</span><span class="ident" id="7930620">Fatal</span><span class="op" id="7930625">(</span><span class="ident" id="7930626">err</span><span class="op" id="7930629">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930635">if</span>&nbsp;<span class="ident" id="7930638">p1</span><span class="op" id="7930640">.</span><span class="ident" id="7930641">Name</span>&nbsp;<span class="op" id="7930646">!=</span>&nbsp;<span class="string" id="7930649">&#34;file&#34;</span>&nbsp;<span class="op" id="7930656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930660">t</span><span class="op" id="7930661">.</span><span class="ident" id="7930662">Fatalf</span><span class="op" id="7930668">(</span><span class="string" id="7930669">&#34;./file:&nbsp;Name=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7930695">,</span>&nbsp;<span class="ident" id="7930697">p1</span><span class="op" id="7930699">.</span><span class="ident" id="7930700">Name</span><span class="op" id="7930704">,</span>&nbsp;<span class="string" id="7930706">&#34;file&#34;</span><span class="op" id="7930712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930718">dir</span>&nbsp;<span class="op" id="7930722">:=</span>&nbsp;<span class="ident" id="7930725">filepath</span><span class="op" id="7930733">.</span><span class="ident" id="7930734">Clean</span><span class="op" id="7930739">(</span><span class="string" id="7930740">&#34;testdata/other/file&#34;</span><span class="op" id="7930761">)</span>&nbsp;<span class="comment" id="7930763">//&nbsp;Clean&nbsp;to&nbsp;use&nbsp;\&nbsp;on&nbsp;Windows</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930793">if</span>&nbsp;<span class="ident" id="7930796">p1</span><span class="op" id="7930798">.</span><span class="ident" id="7930799">Dir</span>&nbsp;<span class="op" id="7930803">!=</span>&nbsp;<span class="ident" id="7930806">dir</span>&nbsp;<span class="op" id="7930810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930814">t</span><span class="op" id="7930815">.</span><span class="ident" id="7930816">Fatalf</span><span class="op" id="7930822">(</span><span class="string" id="7930823">&#34;./file:&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7930848">,</span>&nbsp;<span class="ident" id="7930850">p1</span><span class="op" id="7930852">.</span><span class="ident" id="7930853">Name</span><span class="op" id="7930857">,</span>&nbsp;<span class="ident" id="7930859">dir</span><span class="op" id="7930862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930865">}</span><br>
<span class="lineno"></span><span class="op" id="7930867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7930870">func</span>&nbsp;<span class="ident" id="7930875">TestEmptyImport</span><span class="op" id="7930890">(</span><span class="ident" id="7930891">t</span>&nbsp;<span class="op" id="7930893">*</span><span class="ident" id="7930894">testing</span><span class="op" id="7930901">.</span><span class="ident" id="7930902">T</span><span class="op" id="7930903">)</span>&nbsp;<span class="op" id="7930905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930908">p</span><span class="op" id="7930909">,</span>&nbsp;<span class="ident" id="7930911">err</span>&nbsp;<span class="op" id="7930915">:=</span>&nbsp;<span class="ident" id="7930918">Import</span><span class="op" id="7930924">(</span><span class="string" id="7930925">&#34;&#34;</span><span class="op" id="7930927">,</span>&nbsp;<span class="ident" id="7930929">Default</span><span class="op" id="7930936">.</span><span class="ident" id="7930937">GOROOT</span><span class="op" id="7930943">,</span>&nbsp;<span class="ident" id="7930945">FindOnly</span><span class="op" id="7930953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930956">if</span>&nbsp;<span class="ident" id="7930959">err</span>&nbsp;<span class="op" id="7930963">==</span>&nbsp;<span class="ident" id="7930966">nil</span>&nbsp;<span class="op" id="7930970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930974">t</span><span class="op" id="7930975">.</span><span class="ident" id="7930976">Fatal</span><span class="op" id="7930981">(</span><span class="string" id="7930982">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;error.`</span><span class="op" id="7931014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931017">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931020">if</span>&nbsp;<span class="ident" id="7931023">p</span>&nbsp;<span class="op" id="7931025">==</span>&nbsp;<span class="ident" id="7931028">nil</span>&nbsp;<span class="op" id="7931032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931036">t</span><span class="op" id="7931037">.</span><span class="ident" id="7931038">Fatal</span><span class="op" id="7931043">(</span><span class="string" id="7931044">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;package.`</span><span class="op" id="7931078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931084">if</span>&nbsp;<span class="ident" id="7931087">p</span><span class="op" id="7931088">.</span><span class="ident" id="7931089">ImportPath</span>&nbsp;<span class="op" id="7931100">!=</span>&nbsp;<span class="string" id="7931103">&#34;&#34;</span>&nbsp;<span class="op" id="7931106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931110">t</span><span class="op" id="7931111">.</span><span class="ident" id="7931112">Fatalf</span><span class="op" id="7931118">(</span><span class="string" id="7931119">&#34;ImportPath=%q,&nbsp;want&nbsp;%q.&#34;</span><span class="op" id="7931144">,</span>&nbsp;<span class="ident" id="7931146">p</span><span class="op" id="7931147">.</span><span class="ident" id="7931148">ImportPath</span><span class="op" id="7931158">,</span>&nbsp;<span class="string" id="7931160">&#34;&#34;</span><span class="op" id="7931162">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931165">}</span><br>
<span class="lineno"></span><span class="op" id="7931167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7931170">func</span>&nbsp;<span class="ident" id="7931175">TestEmptyFolderImport</span><span class="op" id="7931196">(</span><span class="ident" id="7931197">t</span>&nbsp;<span class="op" id="7931199">*</span><span class="ident" id="7931200">testing</span><span class="op" id="7931207">.</span><span class="ident" id="7931208">T</span><span class="op" id="7931209">)</span>&nbsp;<span class="op" id="7931211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931214">_</span><span class="op" id="7931215">,</span>&nbsp;<span class="ident" id="7931217">err</span>&nbsp;<span class="op" id="7931221">:=</span>&nbsp;<span class="ident" id="7931224">Import</span><span class="op" id="7931230">(</span><span class="string" id="7931231">&#34;.&#34;</span><span class="op" id="7931234">,</span>&nbsp;<span class="string" id="7931236">&#34;testdata/empty&#34;</span><span class="op" id="7931252">,</span>&nbsp;<span class="num" id="7931254">0</span><span class="op" id="7931255">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931258">if</span>&nbsp;<span class="ident" id="7931261">_</span><span class="op" id="7931262">,</span>&nbsp;<span class="ident" id="7931264">ok</span>&nbsp;<span class="op" id="7931267">:=</span>&nbsp;<span class="ident" id="7931270">err</span><span class="op" id="7931273">.</span><span class="op" id="7931274">(</span><span class="op" id="7931275">*</span><span class="ident" id="7931276">NoGoError</span><span class="op" id="7931285">)</span><span class="op" id="7931286">;</span>&nbsp;<span class="op" id="7931288">!</span><span class="ident" id="7931289">ok</span>&nbsp;<span class="op" id="7931292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931296">t</span><span class="op" id="7931297">.</span><span class="ident" id="7931298">Fatal</span><span class="op" id="7931303">(</span><span class="string" id="7931304">`Import(&#34;testdata/empty&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;NoGoError.`</span><span class="op" id="7931356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931359">}</span><br>
<span class="lineno"></span><span class="op" id="7931361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7931364">func</span>&nbsp;<span class="ident" id="7931369">TestMultiplePackageImport</span><span class="op" id="7931394">(</span><span class="ident" id="7931395">t</span>&nbsp;<span class="op" id="7931397">*</span><span class="ident" id="7931398">testing</span><span class="op" id="7931405">.</span><span class="ident" id="7931406">T</span><span class="op" id="7931407">)</span>&nbsp;<span class="op" id="7931409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931412">_</span><span class="op" id="7931413">,</span>&nbsp;<span class="ident" id="7931415">err</span>&nbsp;<span class="op" id="7931419">:=</span>&nbsp;<span class="ident" id="7931422">Import</span><span class="op" id="7931428">(</span><span class="string" id="7931429">&#34;.&#34;</span><span class="op" id="7931432">,</span>&nbsp;<span class="string" id="7931434">&#34;testdata/multi&#34;</span><span class="op" id="7931450">,</span>&nbsp;<span class="num" id="7931452">0</span><span class="op" id="7931453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931456">if</span>&nbsp;<span class="ident" id="7931459">_</span><span class="op" id="7931460">,</span>&nbsp;<span class="ident" id="7931462">ok</span>&nbsp;<span class="op" id="7931465">:=</span>&nbsp;<span class="ident" id="7931468">err</span><span class="op" id="7931471">.</span><span class="op" id="7931472">(</span><span class="op" id="7931473">*</span><span class="ident" id="7931474">MultiplePackageError</span><span class="op" id="7931494">)</span><span class="op" id="7931495">;</span>&nbsp;<span class="op" id="7931497">!</span><span class="ident" id="7931498">ok</span>&nbsp;<span class="op" id="7931501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931505">t</span><span class="op" id="7931506">.</span><span class="ident" id="7931507">Fatal</span><span class="op" id="7931512">(</span><span class="string" id="7931513">`Import(&#34;testdata/multi&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;MultiplePackageError.`</span><span class="op" id="7931576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931579">}</span><br>
<span class="lineno">100</span><span class="op" id="7931581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7931584">func</span>&nbsp;<span class="ident" id="7931589">TestLocalDirectory</span><span class="op" id="7931607">(</span><span class="ident" id="7931608">t</span>&nbsp;<span class="op" id="7931610">*</span><span class="ident" id="7931611">testing</span><span class="op" id="7931618">.</span><span class="ident" id="7931619">T</span><span class="op" id="7931620">)</span>&nbsp;<span class="op" id="7931622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931625">cwd</span><span class="op" id="7931628">,</span>&nbsp;<span class="ident" id="7931630">err</span>&nbsp;<span class="op" id="7931634">:=</span>&nbsp;<span class="ident" id="7931637">os</span><span class="op" id="7931639">.</span><span class="ident" id="7931640">Getwd</span><span class="op" id="7931645">(</span><span class="op" id="7931646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931649">if</span>&nbsp;<span class="ident" id="7931652">err</span>&nbsp;<span class="op" id="7931656">!=</span>&nbsp;<span class="ident" id="7931659">nil</span>&nbsp;<span class="op" id="7931663">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931667">t</span><span class="op" id="7931668">.</span><span class="ident" id="7931669">Fatal</span><span class="op" id="7931674">(</span><span class="ident" id="7931675">err</span><span class="op" id="7931678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931685">p</span><span class="op" id="7931686">,</span>&nbsp;<span class="ident" id="7931688">err</span>&nbsp;<span class="op" id="7931692">:=</span>&nbsp;<span class="ident" id="7931695">ImportDir</span><span class="op" id="7931704">(</span><span class="ident" id="7931705">cwd</span><span class="op" id="7931708">,</span>&nbsp;<span class="num" id="7931710">0</span><span class="op" id="7931711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931714">if</span>&nbsp;<span class="ident" id="7931717">err</span>&nbsp;<span class="op" id="7931721">!=</span>&nbsp;<span class="ident" id="7931724">nil</span>&nbsp;<span class="op" id="7931728">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931732">t</span><span class="op" id="7931733">.</span><span class="ident" id="7931734">Fatal</span><span class="op" id="7931739">(</span><span class="ident" id="7931740">err</span><span class="op" id="7931743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931749">if</span>&nbsp;<span class="ident" id="7931752">p</span><span class="op" id="7931753">.</span><span class="ident" id="7931754">ImportPath</span>&nbsp;<span class="op" id="7931765">!=</span>&nbsp;<span class="string" id="7931768">&#34;go/build&#34;</span>&nbsp;<span class="op" id="7931779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931783">t</span><span class="op" id="7931784">.</span><span class="ident" id="7931785">Fatalf</span><span class="op" id="7931791">(</span><span class="string" id="7931792">&#34;ImportPath=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7931816">,</span>&nbsp;<span class="ident" id="7931818">p</span><span class="op" id="7931819">.</span><span class="ident" id="7931820">ImportPath</span><span class="op" id="7931830">,</span>&nbsp;<span class="string" id="7931832">&#34;go/build&#34;</span><span class="op" id="7931842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931845">}</span><br>
<span class="lineno">115</span><span class="op" id="7931847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7931850">func</span>&nbsp;<span class="ident" id="7931855">TestShouldBuild</span><span class="op" id="7931870">(</span><span class="ident" id="7931871">t</span>&nbsp;<span class="op" id="7931873">*</span><span class="ident" id="7931874">testing</span><span class="op" id="7931881">.</span><span class="ident" id="7931882">T</span><span class="op" id="7931883">)</span>&nbsp;<span class="op" id="7931885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931888">const</span>&nbsp;<span class="ident" id="7931894">file1</span>&nbsp;<span class="op" id="7931900">=</span>&nbsp;<span class="string" id="7931902">&#34;//&nbsp;+build&nbsp;tag1\n\n&#34;</span>&nbsp;<span class="op" id="7931923">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7931927">&#34;package&nbsp;main\n&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931945">want1</span>&nbsp;<span class="op" id="7931951">:=</span>&nbsp;<span class="keyword" id="7931954">map</span><span class="op" id="7931957">[</span><span class="builtintype" id="7931958">string</span><span class="op" id="7931964">]</span><span class="builtintype" id="7931965">bool</span><span class="op" id="7931969">{</span><span class="string" id="7931970">&#34;tag1&#34;</span><span class="op" id="7931976">:</span>&nbsp;<span class="ident" id="7931978">true</span><span class="op" id="7931982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931986">const</span>&nbsp;<span class="ident" id="7931992">file2</span>&nbsp;<span class="op" id="7931998">=</span>&nbsp;<span class="string" id="7932000">&#34;//&nbsp;+build&nbsp;cgo\n\n&#34;</span>&nbsp;<span class="op" id="7932020">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7932024">&#34;//&nbsp;This&nbsp;package&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;tags&nbsp;like\n&#34;</span>&nbsp;<span class="op" id="7932076">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7932080">&#34;//&nbsp;+build&nbsp;tag1\n&#34;</span>&nbsp;<span class="op" id="7932099">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7932103">&#34;package&nbsp;build&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932120">want2</span>&nbsp;<span class="op" id="7932126">:=</span>&nbsp;<span class="keyword" id="7932129">map</span><span class="op" id="7932132">[</span><span class="builtintype" id="7932133">string</span><span class="op" id="7932139">]</span><span class="builtintype" id="7932140">bool</span><span class="op" id="7932144">{</span><span class="string" id="7932145">&#34;cgo&#34;</span><span class="op" id="7932150">:</span>&nbsp;<span class="ident" id="7932152">true</span><span class="op" id="7932156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932160">const</span>&nbsp;<span class="ident" id="7932166">file3</span>&nbsp;<span class="op" id="7932172">=</span>&nbsp;<span class="string" id="7932174">&#34;//&nbsp;Copyright&nbsp;The&nbsp;Go&nbsp;Authors.\n\n&#34;</span>&nbsp;<span class="op" id="7932209">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7932213">&#34;package&nbsp;build\n\n&#34;</span>&nbsp;<span class="op" id="7932233">+</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7932237">&#34;//&nbsp;shouldBuild&nbsp;checks&nbsp;tags&nbsp;given&nbsp;by&nbsp;lines&nbsp;of&nbsp;the&nbsp;form\n&#34;</span>&nbsp;<span class="op" id="7932295">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7932299">&#34;//&nbsp;+build&nbsp;tag\n&#34;</span>&nbsp;<span class="op" id="7932317">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7932321">&#34;func&nbsp;shouldBuild(content&nbsp;[]byte)\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932359">want3</span>&nbsp;<span class="op" id="7932365">:=</span>&nbsp;<span class="keyword" id="7932368">map</span><span class="op" id="7932371">[</span><span class="builtintype" id="7932372">string</span><span class="op" id="7932378">]</span><span class="builtintype" id="7932379">bool</span><span class="op" id="7932383">{</span><span class="op" id="7932384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932388">ctx</span>&nbsp;<span class="op" id="7932392">:=</span>&nbsp;<span class="op" id="7932395">&amp;</span><span class="ident" id="7932396">Context</span><span class="op" id="7932403">{</span><span class="ident" id="7932404">BuildTags</span><span class="op" id="7932413">:</span>&nbsp;<span class="op" id="7932415">[</span><span class="op" id="7932416">]</span><span class="builtintype" id="7932417">string</span><span class="op" id="7932423">{</span><span class="string" id="7932424">&#34;tag1&#34;</span><span class="op" id="7932430">}</span><span class="op" id="7932431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932434">m</span>&nbsp;<span class="op" id="7932436">:=</span>&nbsp;<span class="keyword" id="7932439">map</span><span class="op" id="7932442">[</span><span class="builtintype" id="7932443">string</span><span class="op" id="7932449">]</span><span class="builtintype" id="7932450">bool</span><span class="op" id="7932454">{</span><span class="op" id="7932455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932458">if</span>&nbsp;<span class="op" id="7932461">!</span><span class="ident" id="7932462">ctx</span><span class="op" id="7932465">.</span><span class="ident" id="7932466">shouldBuild</span><span class="op" id="7932477">(</span><span class="op" id="7932478">[</span><span class="op" id="7932479">]</span><span class="builtintype" id="7932480">byte</span><span class="op" id="7932484">(</span><span class="ident" id="7932485">file1</span><span class="op" id="7932490">)</span><span class="op" id="7932491">,</span>&nbsp;<span class="ident" id="7932493">m</span><span class="op" id="7932494">)</span>&nbsp;<span class="op" id="7932496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932500">t</span><span class="op" id="7932501">.</span><span class="ident" id="7932502">Errorf</span><span class="op" id="7932508">(</span><span class="string" id="7932509">&#34;shouldBuild(file1)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="7932548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932551">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932554">if</span>&nbsp;<span class="op" id="7932557">!</span><span class="ident" id="7932558">reflect</span><span class="op" id="7932565">.</span><span class="ident" id="7932566">DeepEqual</span><span class="op" id="7932575">(</span><span class="ident" id="7932576">m</span><span class="op" id="7932577">,</span>&nbsp;<span class="ident" id="7932579">want1</span><span class="op" id="7932584">)</span>&nbsp;<span class="op" id="7932586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932590">t</span><span class="op" id="7932591">.</span><span class="ident" id="7932592">Errorf</span><span class="op" id="7932598">(</span><span class="string" id="7932599">&#34;shoudBuild(file1)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7932637">,</span>&nbsp;<span class="ident" id="7932639">m</span><span class="op" id="7932640">,</span>&nbsp;<span class="ident" id="7932642">want1</span><span class="op" id="7932647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932654">m</span>&nbsp;<span class="op" id="7932656">=</span>&nbsp;<span class="keyword" id="7932658">map</span><span class="op" id="7932661">[</span><span class="builtintype" id="7932662">string</span><span class="op" id="7932668">]</span><span class="builtintype" id="7932669">bool</span><span class="op" id="7932673">{</span><span class="op" id="7932674">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932677">if</span>&nbsp;<span class="ident" id="7932680">ctx</span><span class="op" id="7932683">.</span><span class="ident" id="7932684">shouldBuild</span><span class="op" id="7932695">(</span><span class="op" id="7932696">[</span><span class="op" id="7932697">]</span><span class="builtintype" id="7932698">byte</span><span class="op" id="7932702">(</span><span class="ident" id="7932703">file2</span><span class="op" id="7932708">)</span><span class="op" id="7932709">,</span>&nbsp;<span class="ident" id="7932711">m</span><span class="op" id="7932712">)</span>&nbsp;<span class="op" id="7932714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932718">t</span><span class="op" id="7932719">.</span><span class="ident" id="7932720">Errorf</span><span class="op" id="7932726">(</span><span class="string" id="7932727">&#34;shouldBuild(file2)&nbsp;=&nbsp;true,&nbsp;want&nbsp;fakse&#34;</span><span class="op" id="7932766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932772">if</span>&nbsp;<span class="op" id="7932775">!</span><span class="ident" id="7932776">reflect</span><span class="op" id="7932783">.</span><span class="ident" id="7932784">DeepEqual</span><span class="op" id="7932793">(</span><span class="ident" id="7932794">m</span><span class="op" id="7932795">,</span>&nbsp;<span class="ident" id="7932797">want2</span><span class="op" id="7932802">)</span>&nbsp;<span class="op" id="7932804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932808">t</span><span class="op" id="7932809">.</span><span class="ident" id="7932810">Errorf</span><span class="op" id="7932816">(</span><span class="string" id="7932817">&#34;shoudBuild(file2)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7932855">,</span>&nbsp;<span class="ident" id="7932857">m</span><span class="op" id="7932858">,</span>&nbsp;<span class="ident" id="7932860">want2</span><span class="op" id="7932865">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932872">m</span>&nbsp;<span class="op" id="7932874">=</span>&nbsp;<span class="keyword" id="7932876">map</span><span class="op" id="7932879">[</span><span class="builtintype" id="7932880">string</span><span class="op" id="7932886">]</span><span class="builtintype" id="7932887">bool</span><span class="op" id="7932891">{</span><span class="op" id="7932892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932895">ctx</span>&nbsp;<span class="op" id="7932899">=</span>&nbsp;<span class="op" id="7932901">&amp;</span><span class="ident" id="7932902">Context</span><span class="op" id="7932909">{</span><span class="ident" id="7932910">BuildTags</span><span class="op" id="7932919">:</span>&nbsp;<span class="ident" id="7932921">nil</span><span class="op" id="7932924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932927">if</span>&nbsp;<span class="op" id="7932930">!</span><span class="ident" id="7932931">ctx</span><span class="op" id="7932934">.</span><span class="ident" id="7932935">shouldBuild</span><span class="op" id="7932946">(</span><span class="op" id="7932947">[</span><span class="op" id="7932948">]</span><span class="builtintype" id="7932949">byte</span><span class="op" id="7932953">(</span><span class="ident" id="7932954">file3</span><span class="op" id="7932959">)</span><span class="op" id="7932960">,</span>&nbsp;<span class="ident" id="7932962">m</span><span class="op" id="7932963">)</span>&nbsp;<span class="op" id="7932965">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932969">t</span><span class="op" id="7932970">.</span><span class="ident" id="7932971">Errorf</span><span class="op" id="7932977">(</span><span class="string" id="7932978">&#34;shouldBuild(file3)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="7933017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933023">if</span>&nbsp;<span class="op" id="7933026">!</span><span class="ident" id="7933027">reflect</span><span class="op" id="7933034">.</span><span class="ident" id="7933035">DeepEqual</span><span class="op" id="7933044">(</span><span class="ident" id="7933045">m</span><span class="op" id="7933046">,</span>&nbsp;<span class="ident" id="7933048">want3</span><span class="op" id="7933053">)</span>&nbsp;<span class="op" id="7933055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933059">t</span><span class="op" id="7933060">.</span><span class="ident" id="7933061">Errorf</span><span class="op" id="7933067">(</span><span class="string" id="7933068">&#34;shoudBuild(file3)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7933106">,</span>&nbsp;<span class="ident" id="7933108">m</span><span class="op" id="7933109">,</span>&nbsp;<span class="ident" id="7933111">want3</span><span class="op" id="7933116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933119">}</span><br>
<span class="lineno">160</span><span class="op" id="7933121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7933124">type</span>&nbsp;<span class="ident" id="7933129">readNopCloser</span>&nbsp;<span class="keyword" id="7933143">struct</span>&nbsp;<span class="op" id="7933150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933153">io</span><span class="op" id="7933155">.</span><span class="ident" id="7933156">Reader</span><br>
<span class="lineno"></span><span class="op" id="7933163">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="7933166">func</span>&nbsp;<span class="op" id="7933171">(</span><span class="ident" id="7933172">r</span>&nbsp;<span class="ident" id="7933174">readNopCloser</span><span class="op" id="7933187">)</span>&nbsp;<span class="ident" id="7933189">Close</span><span class="op" id="7933194">(</span><span class="op" id="7933195">)</span>&nbsp;<span class="builtintype" id="7933197">error</span>&nbsp;<span class="op" id="7933203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933206">return</span>&nbsp;<span class="ident" id="7933213">nil</span><br>
<span class="lineno"></span><span class="op" id="7933217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7933220">var</span>&nbsp;<span class="op" id="7933224">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933227">ctxtP9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7933239">=</span>&nbsp;<span class="ident" id="7933241">Context</span><span class="op" id="7933248">{</span><span class="ident" id="7933249">GOARCH</span><span class="op" id="7933255">:</span>&nbsp;<span class="string" id="7933257">&#34;arm&#34;</span><span class="op" id="7933262">,</span>&nbsp;<span class="ident" id="7933264">GOOS</span><span class="op" id="7933268">:</span>&nbsp;<span class="string" id="7933270">&#34;plan9&#34;</span><span class="op" id="7933277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933280">ctxtAndroid</span>&nbsp;<span class="op" id="7933292">=</span>&nbsp;<span class="ident" id="7933294">Context</span><span class="op" id="7933301">{</span><span class="ident" id="7933302">GOARCH</span><span class="op" id="7933308">:</span>&nbsp;<span class="string" id="7933310">&#34;arm&#34;</span><span class="op" id="7933315">,</span>&nbsp;<span class="ident" id="7933317">GOOS</span><span class="op" id="7933321">:</span>&nbsp;<span class="string" id="7933323">&#34;android&#34;</span><span class="op" id="7933332">}</span><br>
<span class="lineno"></span><span class="op" id="7933334">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7933337">var</span>&nbsp;<span class="ident" id="7933341">matchFileTests</span>&nbsp;<span class="op" id="7933356">=</span>&nbsp;<span class="op" id="7933358">[</span><span class="op" id="7933359">]</span><span class="keyword" id="7933360">struct</span>&nbsp;<span class="op" id="7933367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933370">ctxt</span>&nbsp;&nbsp;<span class="ident" id="7933376">Context</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933385">name</span>&nbsp;&nbsp;<span class="builtintype" id="7933391">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933399">data</span>&nbsp;&nbsp;<span class="builtintype" id="7933405">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933413">match</span>&nbsp;<span class="builtintype" id="7933419">bool</span><br>
<span class="lineno">180</span><span class="op" id="7933424">}</span><span class="op" id="7933425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933428">{</span><span class="ident" id="7933429">ctxtP9</span><span class="op" id="7933435">,</span>&nbsp;<span class="string" id="7933437">&#34;foo_arm.go&#34;</span><span class="op" id="7933449">,</span>&nbsp;<span class="string" id="7933451">&#34;&#34;</span><span class="op" id="7933453">,</span>&nbsp;<span class="ident" id="7933455">true</span><span class="op" id="7933459">}</span><span class="op" id="7933460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933463">{</span><span class="ident" id="7933464">ctxtP9</span><span class="op" id="7933470">,</span>&nbsp;<span class="string" id="7933472">&#34;foo1_arm.go&#34;</span><span class="op" id="7933485">,</span>&nbsp;<span class="string" id="7933487">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="7933522">,</span>&nbsp;<span class="ident" id="7933524">false</span><span class="op" id="7933529">}</span><span class="op" id="7933530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933533">{</span><span class="ident" id="7933534">ctxtP9</span><span class="op" id="7933540">,</span>&nbsp;<span class="string" id="7933542">&#34;foo_darwin.go&#34;</span><span class="op" id="7933557">,</span>&nbsp;<span class="string" id="7933559">&#34;&#34;</span><span class="op" id="7933561">,</span>&nbsp;<span class="ident" id="7933563">false</span><span class="op" id="7933568">}</span><span class="op" id="7933569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933572">{</span><span class="ident" id="7933573">ctxtP9</span><span class="op" id="7933579">,</span>&nbsp;<span class="string" id="7933581">&#34;foo.go&#34;</span><span class="op" id="7933589">,</span>&nbsp;<span class="string" id="7933591">&#34;&#34;</span><span class="op" id="7933593">,</span>&nbsp;<span class="ident" id="7933595">true</span><span class="op" id="7933599">}</span><span class="op" id="7933600">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933603">{</span><span class="ident" id="7933604">ctxtP9</span><span class="op" id="7933610">,</span>&nbsp;<span class="string" id="7933612">&#34;foo1.go&#34;</span><span class="op" id="7933621">,</span>&nbsp;<span class="string" id="7933623">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="7933658">,</span>&nbsp;<span class="ident" id="7933660">false</span><span class="op" id="7933665">}</span><span class="op" id="7933666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933669">{</span><span class="ident" id="7933670">ctxtP9</span><span class="op" id="7933676">,</span>&nbsp;<span class="string" id="7933678">&#34;foo.badsuffix&#34;</span><span class="op" id="7933693">,</span>&nbsp;<span class="string" id="7933695">&#34;&#34;</span><span class="op" id="7933697">,</span>&nbsp;<span class="ident" id="7933699">false</span><span class="op" id="7933704">}</span><span class="op" id="7933705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933708">{</span><span class="ident" id="7933709">ctxtAndroid</span><span class="op" id="7933720">,</span>&nbsp;<span class="string" id="7933722">&#34;foo_linux.go&#34;</span><span class="op" id="7933736">,</span>&nbsp;<span class="string" id="7933738">&#34;&#34;</span><span class="op" id="7933740">,</span>&nbsp;<span class="ident" id="7933742">true</span><span class="op" id="7933746">}</span><span class="op" id="7933747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933750">{</span><span class="ident" id="7933751">ctxtAndroid</span><span class="op" id="7933762">,</span>&nbsp;<span class="string" id="7933764">&#34;foo_android.go&#34;</span><span class="op" id="7933780">,</span>&nbsp;<span class="string" id="7933782">&#34;&#34;</span><span class="op" id="7933784">,</span>&nbsp;<span class="ident" id="7933786">true</span><span class="op" id="7933790">}</span><span class="op" id="7933791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933794">{</span><span class="ident" id="7933795">ctxtAndroid</span><span class="op" id="7933806">,</span>&nbsp;<span class="string" id="7933808">&#34;foo_plan9.go&#34;</span><span class="op" id="7933822">,</span>&nbsp;<span class="string" id="7933824">&#34;&#34;</span><span class="op" id="7933826">,</span>&nbsp;<span class="ident" id="7933828">false</span><span class="op" id="7933833">}</span><span class="op" id="7933834">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933837">{</span><span class="ident" id="7933838">ctxtAndroid</span><span class="op" id="7933849">,</span>&nbsp;<span class="string" id="7933851">&#34;android.go&#34;</span><span class="op" id="7933863">,</span>&nbsp;<span class="string" id="7933865">&#34;&#34;</span><span class="op" id="7933867">,</span>&nbsp;<span class="ident" id="7933869">true</span><span class="op" id="7933873">}</span><span class="op" id="7933874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933877">{</span><span class="ident" id="7933878">ctxtAndroid</span><span class="op" id="7933889">,</span>&nbsp;<span class="string" id="7933891">&#34;plan9.go&#34;</span><span class="op" id="7933901">,</span>&nbsp;<span class="string" id="7933903">&#34;&#34;</span><span class="op" id="7933905">,</span>&nbsp;<span class="ident" id="7933907">true</span><span class="op" id="7933911">}</span><span class="op" id="7933912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933915">{</span><span class="ident" id="7933916">ctxtAndroid</span><span class="op" id="7933927">,</span>&nbsp;<span class="string" id="7933929">&#34;plan9_test.go&#34;</span><span class="op" id="7933944">,</span>&nbsp;<span class="string" id="7933946">&#34;&#34;</span><span class="op" id="7933948">,</span>&nbsp;<span class="ident" id="7933950">true</span><span class="op" id="7933954">}</span><span class="op" id="7933955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933958">{</span><span class="ident" id="7933959">ctxtAndroid</span><span class="op" id="7933970">,</span>&nbsp;<span class="string" id="7933972">&#34;arm.s&#34;</span><span class="op" id="7933979">,</span>&nbsp;<span class="string" id="7933981">&#34;&#34;</span><span class="op" id="7933983">,</span>&nbsp;<span class="ident" id="7933985">true</span><span class="op" id="7933989">}</span><span class="op" id="7933990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933993">{</span><span class="ident" id="7933994">ctxtAndroid</span><span class="op" id="7934005">,</span>&nbsp;<span class="string" id="7934007">&#34;amd64.s&#34;</span><span class="op" id="7934016">,</span>&nbsp;<span class="string" id="7934018">&#34;&#34;</span><span class="op" id="7934020">,</span>&nbsp;<span class="ident" id="7934022">true</span><span class="op" id="7934026">}</span><span class="op" id="7934027">,</span><br>
<span class="lineno">195</span><span class="op" id="7934029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7934032">func</span>&nbsp;<span class="ident" id="7934037">TestMatchFile</span><span class="op" id="7934050">(</span><span class="ident" id="7934051">t</span>&nbsp;<span class="op" id="7934053">*</span><span class="ident" id="7934054">testing</span><span class="op" id="7934061">.</span><span class="ident" id="7934062">T</span><span class="op" id="7934063">)</span>&nbsp;<span class="op" id="7934065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934068">for</span>&nbsp;<span class="ident" id="7934072">_</span><span class="op" id="7934073">,</span>&nbsp;<span class="ident" id="7934075">tt</span>&nbsp;<span class="op" id="7934078">:=</span>&nbsp;<span class="keyword" id="7934081">range</span>&nbsp;<span class="ident" id="7934087">matchFileTests</span>&nbsp;<span class="op" id="7934102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934106">ctxt</span>&nbsp;<span class="op" id="7934111">:=</span>&nbsp;<span class="ident" id="7934114">tt</span><span class="op" id="7934116">.</span><span class="ident" id="7934117">ctxt</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934124">ctxt</span><span class="op" id="7934128">.</span><span class="ident" id="7934129">OpenFile</span>&nbsp;<span class="op" id="7934138">=</span>&nbsp;<span class="keyword" id="7934140">func</span><span class="op" id="7934144">(</span><span class="ident" id="7934145">path</span>&nbsp;<span class="builtintype" id="7934150">string</span><span class="op" id="7934156">)</span>&nbsp;<span class="op" id="7934158">(</span><span class="ident" id="7934159">r</span>&nbsp;<span class="ident" id="7934161">io</span><span class="op" id="7934163">.</span><span class="ident" id="7934164">ReadCloser</span><span class="op" id="7934174">,</span>&nbsp;<span class="ident" id="7934176">err</span>&nbsp;<span class="builtintype" id="7934180">error</span><span class="op" id="7934185">)</span>&nbsp;<span class="op" id="7934187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934192">if</span>&nbsp;<span class="ident" id="7934195">path</span>&nbsp;<span class="op" id="7934200">!=</span>&nbsp;<span class="string" id="7934203">&#34;x+&#34;</span><span class="op" id="7934207">+</span><span class="ident" id="7934208">tt</span><span class="op" id="7934210">.</span><span class="ident" id="7934211">name</span>&nbsp;<span class="op" id="7934216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934222">t</span><span class="op" id="7934223">.</span><span class="ident" id="7934224">Fatalf</span><span class="op" id="7934230">(</span><span class="string" id="7934231">&#34;OpenFile&nbsp;asked&nbsp;for&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7934267">,</span>&nbsp;<span class="ident" id="7934269">path</span><span class="op" id="7934273">,</span>&nbsp;<span class="string" id="7934275">&#34;x+&#34;</span><span class="op" id="7934279">+</span><span class="ident" id="7934280">tt</span><span class="op" id="7934282">.</span><span class="ident" id="7934283">name</span><span class="op" id="7934287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934297">return</span>&nbsp;<span class="op" id="7934304">&amp;</span><span class="ident" id="7934305">readNopCloser</span><span class="op" id="7934318">{</span><span class="ident" id="7934319">strings</span><span class="op" id="7934326">.</span><span class="ident" id="7934327">NewReader</span><span class="op" id="7934336">(</span><span class="ident" id="7934337">tt</span><span class="op" id="7934339">.</span><span class="ident" id="7934340">data</span><span class="op" id="7934344">)</span><span class="op" id="7934345">}</span><span class="op" id="7934346">,</span>&nbsp;<span class="ident" id="7934348">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934358">ctxt</span><span class="op" id="7934362">.</span><span class="ident" id="7934363">JoinPath</span>&nbsp;<span class="op" id="7934372">=</span>&nbsp;<span class="keyword" id="7934374">func</span><span class="op" id="7934378">(</span><span class="ident" id="7934379">elem</span>&nbsp;<span class="op" id="7934384">...</span><span class="builtintype" id="7934387">string</span><span class="op" id="7934393">)</span>&nbsp;<span class="builtintype" id="7934395">string</span>&nbsp;<span class="op" id="7934402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934407">return</span>&nbsp;<span class="ident" id="7934414">strings</span><span class="op" id="7934421">.</span><span class="ident" id="7934422">Join</span><span class="op" id="7934426">(</span><span class="ident" id="7934427">elem</span><span class="op" id="7934431">,</span>&nbsp;<span class="string" id="7934433">&#34;+&#34;</span><span class="op" id="7934436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934444">match</span><span class="op" id="7934449">,</span>&nbsp;<span class="ident" id="7934451">err</span>&nbsp;<span class="op" id="7934455">:=</span>&nbsp;<span class="ident" id="7934458">ctxt</span><span class="op" id="7934462">.</span><span class="ident" id="7934463">MatchFile</span><span class="op" id="7934472">(</span><span class="string" id="7934473">&#34;x&#34;</span><span class="op" id="7934476">,</span>&nbsp;<span class="ident" id="7934478">tt</span><span class="op" id="7934480">.</span><span class="ident" id="7934481">name</span><span class="op" id="7934485">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934489">if</span>&nbsp;<span class="ident" id="7934492">match</span>&nbsp;<span class="op" id="7934498">!=</span>&nbsp;<span class="ident" id="7934501">tt</span><span class="op" id="7934503">.</span><span class="ident" id="7934504">match</span>&nbsp;<span class="op" id="7934510">||</span>&nbsp;<span class="ident" id="7934513">err</span>&nbsp;<span class="op" id="7934517">!=</span>&nbsp;<span class="ident" id="7934520">nil</span>&nbsp;<span class="op" id="7934524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934529">t</span><span class="op" id="7934530">.</span><span class="ident" id="7934531">Fatalf</span><span class="op" id="7934537">(</span><span class="string" id="7934538">&#34;MatchFile(%q)&nbsp;=&nbsp;%v,&nbsp;%v,&nbsp;want&nbsp;%v,&nbsp;nil&#34;</span><span class="op" id="7934576">,</span>&nbsp;<span class="ident" id="7934578">tt</span><span class="op" id="7934580">.</span><span class="ident" id="7934581">name</span><span class="op" id="7934585">,</span>&nbsp;<span class="ident" id="7934587">match</span><span class="op" id="7934592">,</span>&nbsp;<span class="ident" id="7934594">err</span><span class="op" id="7934597">,</span>&nbsp;<span class="ident" id="7934599">tt</span><span class="op" id="7934601">.</span><span class="ident" id="7934602">match</span><span class="op" id="7934607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934614">}</span><br>
<span class="lineno"></span><span class="op" id="7934616">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7934619">func</span>&nbsp;<span class="ident" id="7934624">TestImportCmd</span><span class="op" id="7934637">(</span><span class="ident" id="7934638">t</span>&nbsp;<span class="op" id="7934640">*</span><span class="ident" id="7934641">testing</span><span class="op" id="7934648">.</span><span class="ident" id="7934649">T</span><span class="op" id="7934650">)</span>&nbsp;<span class="op" id="7934652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934655">p</span><span class="op" id="7934656">,</span>&nbsp;<span class="ident" id="7934658">err</span>&nbsp;<span class="op" id="7934662">:=</span>&nbsp;<span class="ident" id="7934665">Import</span><span class="op" id="7934671">(</span><span class="string" id="7934672">&#34;cmd/internal/objfile&#34;</span><span class="op" id="7934694">,</span>&nbsp;<span class="string" id="7934696">&#34;&#34;</span><span class="op" id="7934698">,</span>&nbsp;<span class="num" id="7934700">0</span><span class="op" id="7934701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934704">if</span>&nbsp;<span class="ident" id="7934707">err</span>&nbsp;<span class="op" id="7934711">!=</span>&nbsp;<span class="ident" id="7934714">nil</span>&nbsp;<span class="op" id="7934718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934722">t</span><span class="op" id="7934723">.</span><span class="ident" id="7934724">Fatal</span><span class="op" id="7934729">(</span><span class="ident" id="7934730">err</span><span class="op" id="7934733">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934739">if</span>&nbsp;<span class="op" id="7934742">!</span><span class="ident" id="7934743">strings</span><span class="op" id="7934750">.</span><span class="ident" id="7934751">HasSuffix</span><span class="op" id="7934760">(</span><span class="ident" id="7934761">filepath</span><span class="op" id="7934769">.</span><span class="ident" id="7934770">ToSlash</span><span class="op" id="7934777">(</span><span class="ident" id="7934778">p</span><span class="op" id="7934779">.</span><span class="ident" id="7934780">Dir</span><span class="op" id="7934783">)</span><span class="op" id="7934784">,</span>&nbsp;<span class="string" id="7934786">&#34;src/cmd/internal/objfile&#34;</span><span class="op" id="7934812">)</span>&nbsp;<span class="op" id="7934814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934818">t</span><span class="op" id="7934819">.</span><span class="ident" id="7934820">Fatalf</span><span class="op" id="7934826">(</span><span class="string" id="7934827">&#34;Import&nbsp;cmd/internal/objfile&nbsp;returned&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7934881">,</span>&nbsp;<span class="ident" id="7934883">filepath</span><span class="op" id="7934891">.</span><span class="ident" id="7934892">ToSlash</span><span class="op" id="7934899">(</span><span class="ident" id="7934900">p</span><span class="op" id="7934901">.</span><span class="ident" id="7934902">Dir</span><span class="op" id="7934905">)</span><span class="op" id="7934906">,</span>&nbsp;<span class="string" id="7934908">&#34;.../src/cmd/internal/objfile&#34;</span><span class="op" id="7934938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934941">}</span><br>
<span class="lineno"></span><span class="op" id="7934943">}</span>
</div>
</body>
</html>
