<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html" class="current">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3745711">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3745766">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3745820">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3745871">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3745936">package</span>&nbsp;<span class="ident" id="3745944">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3745949">import</span>&nbsp;<span class="op" id="3745956">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3745959">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3745965">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3745975">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3745978">func</span>&nbsp;<span class="ident" id="3745983">newFileFD</span><span class="op" id="3745992">(</span><span class="ident" id="3745993">f</span>&nbsp;<span class="op" id="3745995">*</span><span class="ident" id="3745996">os</span><span class="op" id="3745998">.</span><span class="ident" id="3745999">File</span><span class="op" id="3746003">)</span>&nbsp;<span class="op" id="3746005">(</span><span class="op" id="3746006">*</span><span class="ident" id="3746007">netFD</span><span class="op" id="3746012">,</span>&nbsp;<span class="builtintype" id="3746014">error</span><span class="op" id="3746019">)</span>&nbsp;<span class="op" id="3746021">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746024">fd</span><span class="op" id="3746026">,</span>&nbsp;<span class="ident" id="3746028">err</span>&nbsp;<span class="op" id="3746032">:=</span>&nbsp;<span class="ident" id="3746035">dupCloseOnExec</span><span class="op" id="3746049">(</span><span class="builtintype" id="3746050">int</span><span class="op" id="3746053">(</span><span class="ident" id="3746054">f</span><span class="op" id="3746055">.</span><span class="ident" id="3746056">Fd</span><span class="op" id="3746058">(</span><span class="op" id="3746059">)</span><span class="op" id="3746060">)</span><span class="op" id="3746061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746064">if</span>&nbsp;<span class="ident" id="3746067">err</span>&nbsp;<span class="op" id="3746071">!=</span>&nbsp;<span class="builtintype" id="3746074">nil</span>&nbsp;<span class="op" id="3746078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746082">return</span>&nbsp;<span class="builtintype" id="3746089">nil</span><span class="op" id="3746092">,</span>&nbsp;<span class="ident" id="3746094">os</span><span class="op" id="3746096">.</span><span class="ident" id="3746097">NewSyscallError</span><span class="op" id="3746112">(</span><span class="string" id="3746113">&#34;dup&#34;</span><span class="op" id="3746118">,</span>&nbsp;<span class="ident" id="3746120">err</span><span class="op" id="3746123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3746126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746130">if</span>&nbsp;<span class="ident" id="3746133">err</span>&nbsp;<span class="op" id="3746137">=</span>&nbsp;<span class="ident" id="3746139">syscall</span><span class="op" id="3746146">.</span><span class="ident" id="3746147">SetNonblock</span><span class="op" id="3746158">(</span><span class="ident" id="3746159">fd</span><span class="op" id="3746161">,</span>&nbsp;<span class="builtintype" id="3746163">true</span><span class="op" id="3746167">)</span><span class="op" id="3746168">;</span>&nbsp;<span class="ident" id="3746170">err</span>&nbsp;<span class="op" id="3746174">!=</span>&nbsp;<span class="builtintype" id="3746177">nil</span>&nbsp;<span class="op" id="3746181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746185">closesocket</span><span class="op" id="3746196">(</span><span class="ident" id="3746197">fd</span><span class="op" id="3746199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746203">return</span>&nbsp;<span class="builtintype" id="3746210">nil</span><span class="op" id="3746213">,</span>&nbsp;<span class="ident" id="3746215">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3746220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746224">sotype</span><span class="op" id="3746230">,</span>&nbsp;<span class="ident" id="3746232">err</span>&nbsp;<span class="op" id="3746236">:=</span>&nbsp;<span class="ident" id="3746239">syscall</span><span class="op" id="3746246">.</span><span class="ident" id="3746247">GetsockoptInt</span><span class="op" id="3746260">(</span><span class="ident" id="3746261">fd</span><span class="op" id="3746263">,</span>&nbsp;<span class="ident" id="3746265">syscall</span><span class="op" id="3746272">.</span><span class="ident" id="3746273">SOL_SOCKET</span><span class="op" id="3746283">,</span>&nbsp;<span class="ident" id="3746285">syscall</span><span class="op" id="3746292">.</span><span class="ident" id="3746293">SO_TYPE</span><span class="op" id="3746300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746303">if</span>&nbsp;<span class="ident" id="3746306">err</span>&nbsp;<span class="op" id="3746310">!=</span>&nbsp;<span class="builtintype" id="3746313">nil</span>&nbsp;<span class="op" id="3746317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746321">closesocket</span><span class="op" id="3746332">(</span><span class="ident" id="3746333">fd</span><span class="op" id="3746335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746339">return</span>&nbsp;<span class="builtintype" id="3746346">nil</span><span class="op" id="3746349">,</span>&nbsp;<span class="ident" id="3746351">os</span><span class="op" id="3746353">.</span><span class="ident" id="3746354">NewSyscallError</span><span class="op" id="3746369">(</span><span class="string" id="3746370">&#34;getsockopt&#34;</span><span class="op" id="3746382">,</span>&nbsp;<span class="ident" id="3746384">err</span><span class="op" id="3746387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3746390">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746394">family</span>&nbsp;<span class="op" id="3746401">:=</span>&nbsp;<span class="ident" id="3746404">syscall</span><span class="op" id="3746411">.</span><span class="ident" id="3746412">AF_UNSPEC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746423">toAddr</span>&nbsp;<span class="op" id="3746430">:=</span>&nbsp;<span class="ident" id="3746433">sockaddrToTCP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746448">lsa</span><span class="op" id="3746451">,</span>&nbsp;<span class="ident" id="3746453">_</span>&nbsp;<span class="op" id="3746455">:=</span>&nbsp;<span class="ident" id="3746458">syscall</span><span class="op" id="3746465">.</span><span class="ident" id="3746466">Getsockname</span><span class="op" id="3746477">(</span><span class="ident" id="3746478">fd</span><span class="op" id="3746480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746483">switch</span>&nbsp;<span class="ident" id="3746490">lsa</span><span class="op" id="3746493">.</span><span class="op" id="3746494">(</span><span class="keyword" id="3746495">type</span><span class="op" id="3746499">)</span>&nbsp;<span class="op" id="3746501">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746504">default</span><span class="op" id="3746511">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746515">closesocket</span><span class="op" id="3746526">(</span><span class="ident" id="3746527">fd</span><span class="op" id="3746529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746533">return</span>&nbsp;<span class="builtintype" id="3746540">nil</span><span class="op" id="3746543">,</span>&nbsp;<span class="ident" id="3746545">syscall</span><span class="op" id="3746552">.</span><span class="ident" id="3746553">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746561">case</span>&nbsp;<span class="op" id="3746566">*</span><span class="ident" id="3746567">syscall</span><span class="op" id="3746574">.</span><span class="ident" id="3746575">SockaddrInet4</span><span class="op" id="3746588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746592">family</span>&nbsp;<span class="op" id="3746599">=</span>&nbsp;<span class="ident" id="3746601">syscall</span><span class="op" id="3746608">.</span><span class="ident" id="3746609">AF_INET</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746619">if</span>&nbsp;<span class="ident" id="3746622">sotype</span>&nbsp;<span class="op" id="3746629">==</span>&nbsp;<span class="ident" id="3746632">syscall</span><span class="op" id="3746639">.</span><span class="ident" id="3746640">SOCK_DGRAM</span>&nbsp;<span class="op" id="3746651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746656">toAddr</span>&nbsp;<span class="op" id="3746663">=</span>&nbsp;<span class="ident" id="3746665">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3746681">}</span>&nbsp;<span class="keyword" id="3746683">else</span>&nbsp;<span class="keyword" id="3746688">if</span>&nbsp;<span class="ident" id="3746691">sotype</span>&nbsp;<span class="op" id="3746698">==</span>&nbsp;<span class="ident" id="3746701">syscall</span><span class="op" id="3746708">.</span><span class="ident" id="3746709">SOCK_RAW</span>&nbsp;<span class="op" id="3746718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746723">toAddr</span>&nbsp;<span class="op" id="3746730">=</span>&nbsp;<span class="ident" id="3746732">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3746747">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746750">case</span>&nbsp;<span class="op" id="3746755">*</span><span class="ident" id="3746756">syscall</span><span class="op" id="3746763">.</span><span class="ident" id="3746764">SockaddrInet6</span><span class="op" id="3746777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746781">family</span>&nbsp;<span class="op" id="3746788">=</span>&nbsp;<span class="ident" id="3746790">syscall</span><span class="op" id="3746797">.</span><span class="ident" id="3746798">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746809">if</span>&nbsp;<span class="ident" id="3746812">sotype</span>&nbsp;<span class="op" id="3746819">==</span>&nbsp;<span class="ident" id="3746822">syscall</span><span class="op" id="3746829">.</span><span class="ident" id="3746830">SOCK_DGRAM</span>&nbsp;<span class="op" id="3746841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746846">toAddr</span>&nbsp;<span class="op" id="3746853">=</span>&nbsp;<span class="ident" id="3746855">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3746871">}</span>&nbsp;<span class="keyword" id="3746873">else</span>&nbsp;<span class="keyword" id="3746878">if</span>&nbsp;<span class="ident" id="3746881">sotype</span>&nbsp;<span class="op" id="3746888">==</span>&nbsp;<span class="ident" id="3746891">syscall</span><span class="op" id="3746898">.</span><span class="ident" id="3746899">SOCK_RAW</span>&nbsp;<span class="op" id="3746908">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746913">toAddr</span>&nbsp;<span class="op" id="3746920">=</span>&nbsp;<span class="ident" id="3746922">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3746937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3746940">case</span>&nbsp;<span class="op" id="3746945">*</span><span class="ident" id="3746946">syscall</span><span class="op" id="3746953">.</span><span class="ident" id="3746954">SockaddrUnix</span><span class="op" id="3746966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746970">family</span>&nbsp;<span class="op" id="3746977">=</span>&nbsp;<span class="ident" id="3746979">syscall</span><span class="op" id="3746986">.</span><span class="ident" id="3746987">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3746997">toAddr</span>&nbsp;<span class="op" id="3747004">=</span>&nbsp;<span class="ident" id="3747006">sockaddrToUnix</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747023">if</span>&nbsp;<span class="ident" id="3747026">sotype</span>&nbsp;<span class="op" id="3747033">==</span>&nbsp;<span class="ident" id="3747036">syscall</span><span class="op" id="3747043">.</span><span class="ident" id="3747044">SOCK_DGRAM</span>&nbsp;<span class="op" id="3747055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747060">toAddr</span>&nbsp;<span class="op" id="3747067">=</span>&nbsp;<span class="ident" id="3747069">sockaddrToUnixgram</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3747090">}</span>&nbsp;<span class="keyword" id="3747092">else</span>&nbsp;<span class="keyword" id="3747097">if</span>&nbsp;<span class="ident" id="3747100">sotype</span>&nbsp;<span class="op" id="3747107">==</span>&nbsp;<span class="ident" id="3747110">syscall</span><span class="op" id="3747117">.</span><span class="ident" id="3747118">SOCK_SEQPACKET</span>&nbsp;<span class="op" id="3747133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747138">toAddr</span>&nbsp;<span class="op" id="3747145">=</span>&nbsp;<span class="ident" id="3747147">sockaddrToUnixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3747170">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3747173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747176">laddr</span>&nbsp;<span class="op" id="3747182">:=</span>&nbsp;<span class="ident" id="3747185">toAddr</span><span class="op" id="3747191">(</span><span class="ident" id="3747192">lsa</span><span class="op" id="3747195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747198">rsa</span><span class="op" id="3747201">,</span>&nbsp;<span class="ident" id="3747203">_</span>&nbsp;<span class="op" id="3747205">:=</span>&nbsp;<span class="ident" id="3747208">syscall</span><span class="op" id="3747215">.</span><span class="ident" id="3747216">Getpeername</span><span class="op" id="3747227">(</span><span class="ident" id="3747228">fd</span><span class="op" id="3747230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747233">raddr</span>&nbsp;<span class="op" id="3747239">:=</span>&nbsp;<span class="ident" id="3747242">toAddr</span><span class="op" id="3747248">(</span><span class="ident" id="3747249">rsa</span><span class="op" id="3747252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747256">netfd</span><span class="op" id="3747261">,</span>&nbsp;<span class="ident" id="3747263">err</span>&nbsp;<span class="op" id="3747267">:=</span>&nbsp;<span class="ident" id="3747270">newFD</span><span class="op" id="3747275">(</span><span class="ident" id="3747276">fd</span><span class="op" id="3747278">,</span>&nbsp;<span class="ident" id="3747280">family</span><span class="op" id="3747286">,</span>&nbsp;<span class="ident" id="3747288">sotype</span><span class="op" id="3747294">,</span>&nbsp;<span class="ident" id="3747296">laddr</span><span class="op" id="3747301">.</span><span class="ident" id="3747302">Network</span><span class="op" id="3747309">(</span><span class="op" id="3747310">)</span><span class="op" id="3747311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747314">if</span>&nbsp;<span class="ident" id="3747317">err</span>&nbsp;<span class="op" id="3747321">!=</span>&nbsp;<span class="builtintype" id="3747324">nil</span>&nbsp;<span class="op" id="3747328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747332">closesocket</span><span class="op" id="3747343">(</span><span class="ident" id="3747344">fd</span><span class="op" id="3747346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747350">return</span>&nbsp;<span class="builtintype" id="3747357">nil</span><span class="op" id="3747360">,</span>&nbsp;<span class="ident" id="3747362">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3747367">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747370">if</span>&nbsp;<span class="ident" id="3747373">err</span>&nbsp;<span class="op" id="3747377">:=</span>&nbsp;<span class="ident" id="3747380">netfd</span><span class="op" id="3747385">.</span><span class="ident" id="3747386">init</span><span class="op" id="3747390">(</span><span class="op" id="3747391">)</span><span class="op" id="3747392">;</span>&nbsp;<span class="ident" id="3747394">err</span>&nbsp;<span class="op" id="3747398">!=</span>&nbsp;<span class="builtintype" id="3747401">nil</span>&nbsp;<span class="op" id="3747405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747409">netfd</span><span class="op" id="3747414">.</span><span class="ident" id="3747415">Close</span><span class="op" id="3747420">(</span><span class="op" id="3747421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747425">return</span>&nbsp;<span class="builtintype" id="3747432">nil</span><span class="op" id="3747435">,</span>&nbsp;<span class="ident" id="3747437">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3747442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747445">netfd</span><span class="op" id="3747450">.</span><span class="ident" id="3747451">setAddr</span><span class="op" id="3747458">(</span><span class="ident" id="3747459">laddr</span><span class="op" id="3747464">,</span>&nbsp;<span class="ident" id="3747466">raddr</span><span class="op" id="3747471">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747474">return</span>&nbsp;<span class="ident" id="3747481">netfd</span><span class="op" id="3747486">,</span>&nbsp;<span class="builtintype" id="3747488">nil</span><br>
<span class="lineno"></span><span class="op" id="3747492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3747495">//&nbsp;FileConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;connection&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3747565">//&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when</span><br>
<span class="lineno">80</span><span class="comment" id="3747636">//&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3747702">//&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3747715">func</span>&nbsp;<span class="ident" id="3747720">FileConn</span><span class="op" id="3747728">(</span><span class="ident" id="3747729">f</span>&nbsp;<span class="op" id="3747731">*</span><span class="ident" id="3747732">os</span><span class="op" id="3747734">.</span><span class="ident" id="3747735">File</span><span class="op" id="3747739">)</span>&nbsp;<span class="op" id="3747741">(</span><span class="ident" id="3747742">c</span>&nbsp;<span class="ident" id="3747744">Conn</span><span class="op" id="3747748">,</span>&nbsp;<span class="ident" id="3747750">err</span>&nbsp;<span class="builtintype" id="3747754">error</span><span class="op" id="3747759">)</span>&nbsp;<span class="op" id="3747761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3747764">fd</span><span class="op" id="3747766">,</span>&nbsp;<span class="ident" id="3747768">err</span>&nbsp;<span class="op" id="3747772">:=</span>&nbsp;<span class="ident" id="3747775">newFileFD</span><span class="op" id="3747784">(</span><span class="ident" id="3747785">f</span><span class="op" id="3747786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747789">if</span>&nbsp;<span class="ident" id="3747792">err</span>&nbsp;<span class="op" id="3747796">!=</span>&nbsp;<span class="builtintype" id="3747799">nil</span>&nbsp;<span class="op" id="3747803">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747807">return</span>&nbsp;<span class="builtintype" id="3747814">nil</span><span class="op" id="3747817">,</span>&nbsp;<span class="ident" id="3747819">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3747824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747827">switch</span>&nbsp;<span class="ident" id="3747834">fd</span><span class="op" id="3747836">.</span><span class="ident" id="3747837">laddr</span><span class="op" id="3747842">.</span><span class="op" id="3747843">(</span><span class="keyword" id="3747844">type</span><span class="op" id="3747848">)</span>&nbsp;<span class="op" id="3747850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747853">case</span>&nbsp;<span class="op" id="3747858">*</span><span class="ident" id="3747859">TCPAddr</span><span class="op" id="3747866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747870">return</span>&nbsp;<span class="ident" id="3747877">newTCPConn</span><span class="op" id="3747887">(</span><span class="ident" id="3747888">fd</span><span class="op" id="3747890">)</span><span class="op" id="3747891">,</span>&nbsp;<span class="builtintype" id="3747893">nil</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747898">case</span>&nbsp;<span class="op" id="3747903">*</span><span class="ident" id="3747904">UDPAddr</span><span class="op" id="3747911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747915">return</span>&nbsp;<span class="ident" id="3747922">newUDPConn</span><span class="op" id="3747932">(</span><span class="ident" id="3747933">fd</span><span class="op" id="3747935">)</span><span class="op" id="3747936">,</span>&nbsp;<span class="builtintype" id="3747938">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747943">case</span>&nbsp;<span class="op" id="3747948">*</span><span class="ident" id="3747949">IPAddr</span><span class="op" id="3747955">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747959">return</span>&nbsp;<span class="ident" id="3747966">newIPConn</span><span class="op" id="3747975">(</span><span class="ident" id="3747976">fd</span><span class="op" id="3747978">)</span><span class="op" id="3747979">,</span>&nbsp;<span class="builtintype" id="3747981">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3747986">case</span>&nbsp;<span class="op" id="3747991">*</span><span class="ident" id="3747992">UnixAddr</span><span class="op" id="3748000">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748004">return</span>&nbsp;<span class="ident" id="3748011">newUnixConn</span><span class="op" id="3748022">(</span><span class="ident" id="3748023">fd</span><span class="op" id="3748025">)</span><span class="op" id="3748026">,</span>&nbsp;<span class="builtintype" id="3748028">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3748033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3748036">fd</span><span class="op" id="3748038">.</span><span class="ident" id="3748039">Close</span><span class="op" id="3748044">(</span><span class="op" id="3748045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748048">return</span>&nbsp;<span class="builtintype" id="3748055">nil</span><span class="op" id="3748058">,</span>&nbsp;<span class="ident" id="3748060">syscall</span><span class="op" id="3748067">.</span><span class="ident" id="3748068">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3748075">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3748078">//&nbsp;FileListener&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;listener&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3748147">//&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;l</span><br>
<span class="lineno"></span><span class="comment" id="3748216">//&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3748287">//&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">105</span><span class="keyword" id="3748300">func</span>&nbsp;<span class="ident" id="3748305">FileListener</span><span class="op" id="3748317">(</span><span class="ident" id="3748318">f</span>&nbsp;<span class="op" id="3748320">*</span><span class="ident" id="3748321">os</span><span class="op" id="3748323">.</span><span class="ident" id="3748324">File</span><span class="op" id="3748328">)</span>&nbsp;<span class="op" id="3748330">(</span><span class="ident" id="3748331">l</span>&nbsp;<span class="ident" id="3748333">Listener</span><span class="op" id="3748341">,</span>&nbsp;<span class="ident" id="3748343">err</span>&nbsp;<span class="builtintype" id="3748347">error</span><span class="op" id="3748352">)</span>&nbsp;<span class="op" id="3748354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3748357">fd</span><span class="op" id="3748359">,</span>&nbsp;<span class="ident" id="3748361">err</span>&nbsp;<span class="op" id="3748365">:=</span>&nbsp;<span class="ident" id="3748368">newFileFD</span><span class="op" id="3748377">(</span><span class="ident" id="3748378">f</span><span class="op" id="3748379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748382">if</span>&nbsp;<span class="ident" id="3748385">err</span>&nbsp;<span class="op" id="3748389">!=</span>&nbsp;<span class="builtintype" id="3748392">nil</span>&nbsp;<span class="op" id="3748396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748400">return</span>&nbsp;<span class="builtintype" id="3748407">nil</span><span class="op" id="3748410">,</span>&nbsp;<span class="ident" id="3748412">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3748417">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748420">switch</span>&nbsp;<span class="ident" id="3748427">laddr</span>&nbsp;<span class="op" id="3748433">:=</span>&nbsp;<span class="ident" id="3748436">fd</span><span class="op" id="3748438">.</span><span class="ident" id="3748439">laddr</span><span class="op" id="3748444">.</span><span class="op" id="3748445">(</span><span class="keyword" id="3748446">type</span><span class="op" id="3748450">)</span>&nbsp;<span class="op" id="3748452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748455">case</span>&nbsp;<span class="op" id="3748460">*</span><span class="ident" id="3748461">TCPAddr</span><span class="op" id="3748468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748472">return</span>&nbsp;<span class="op" id="3748479">&amp;</span><span class="ident" id="3748480">TCPListener</span><span class="op" id="3748491">{</span><span class="ident" id="3748492">fd</span><span class="op" id="3748494">}</span><span class="op" id="3748495">,</span>&nbsp;<span class="builtintype" id="3748497">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748502">case</span>&nbsp;<span class="op" id="3748507">*</span><span class="ident" id="3748508">UnixAddr</span><span class="op" id="3748516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748520">return</span>&nbsp;<span class="op" id="3748527">&amp;</span><span class="ident" id="3748528">UnixListener</span><span class="op" id="3748540">{</span><span class="ident" id="3748541">fd</span><span class="op" id="3748543">,</span>&nbsp;<span class="ident" id="3748545">laddr</span><span class="op" id="3748550">.</span><span class="ident" id="3748551">Name</span><span class="op" id="3748555">}</span><span class="op" id="3748556">,</span>&nbsp;<span class="builtintype" id="3748558">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3748563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3748566">fd</span><span class="op" id="3748568">.</span><span class="ident" id="3748569">Close</span><span class="op" id="3748574">(</span><span class="op" id="3748575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748578">return</span>&nbsp;<span class="builtintype" id="3748585">nil</span><span class="op" id="3748588">,</span>&nbsp;<span class="ident" id="3748590">syscall</span><span class="op" id="3748597">.</span><span class="ident" id="3748598">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3748605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3748608">//&nbsp;FilePacketConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;packet&nbsp;network&nbsp;connection</span><br>
<span class="lineno"></span><span class="comment" id="3748674">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3748731">//&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect</span><br>
<span class="lineno"></span><span class="comment" id="3748802">//&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3748841">func</span>&nbsp;<span class="ident" id="3748846">FilePacketConn</span><span class="op" id="3748860">(</span><span class="ident" id="3748861">f</span>&nbsp;<span class="op" id="3748863">*</span><span class="ident" id="3748864">os</span><span class="op" id="3748866">.</span><span class="ident" id="3748867">File</span><span class="op" id="3748871">)</span>&nbsp;<span class="op" id="3748873">(</span><span class="ident" id="3748874">c</span>&nbsp;<span class="ident" id="3748876">PacketConn</span><span class="op" id="3748886">,</span>&nbsp;<span class="ident" id="3748888">err</span>&nbsp;<span class="builtintype" id="3748892">error</span><span class="op" id="3748897">)</span>&nbsp;<span class="op" id="3748899">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3748902">fd</span><span class="op" id="3748904">,</span>&nbsp;<span class="ident" id="3748906">err</span>&nbsp;<span class="op" id="3748910">:=</span>&nbsp;<span class="ident" id="3748913">newFileFD</span><span class="op" id="3748922">(</span><span class="ident" id="3748923">f</span><span class="op" id="3748924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748927">if</span>&nbsp;<span class="ident" id="3748930">err</span>&nbsp;<span class="op" id="3748934">!=</span>&nbsp;<span class="builtintype" id="3748937">nil</span>&nbsp;<span class="op" id="3748941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748945">return</span>&nbsp;<span class="builtintype" id="3748952">nil</span><span class="op" id="3748955">,</span>&nbsp;<span class="ident" id="3748957">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3748962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748965">switch</span>&nbsp;<span class="ident" id="3748972">fd</span><span class="op" id="3748974">.</span><span class="ident" id="3748975">laddr</span><span class="op" id="3748980">.</span><span class="op" id="3748981">(</span><span class="keyword" id="3748982">type</span><span class="op" id="3748986">)</span>&nbsp;<span class="op" id="3748988">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3748991">case</span>&nbsp;<span class="op" id="3748996">*</span><span class="ident" id="3748997">UDPAddr</span><span class="op" id="3749004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3749008">return</span>&nbsp;<span class="ident" id="3749015">newUDPConn</span><span class="op" id="3749025">(</span><span class="ident" id="3749026">fd</span><span class="op" id="3749028">)</span><span class="op" id="3749029">,</span>&nbsp;<span class="builtintype" id="3749031">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3749036">case</span>&nbsp;<span class="op" id="3749041">*</span><span class="ident" id="3749042">IPAddr</span><span class="op" id="3749048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3749052">return</span>&nbsp;<span class="ident" id="3749059">newIPConn</span><span class="op" id="3749068">(</span><span class="ident" id="3749069">fd</span><span class="op" id="3749071">)</span><span class="op" id="3749072">,</span>&nbsp;<span class="builtintype" id="3749074">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3749079">case</span>&nbsp;<span class="op" id="3749084">*</span><span class="ident" id="3749085">UnixAddr</span><span class="op" id="3749093">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3749097">return</span>&nbsp;<span class="ident" id="3749104">newUnixConn</span><span class="op" id="3749115">(</span><span class="ident" id="3749116">fd</span><span class="op" id="3749118">)</span><span class="op" id="3749119">,</span>&nbsp;<span class="builtintype" id="3749121">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3749126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3749129">fd</span><span class="op" id="3749131">.</span><span class="ident" id="3749132">Close</span><span class="op" id="3749137">(</span><span class="op" id="3749138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3749141">return</span>&nbsp;<span class="builtintype" id="3749148">nil</span><span class="op" id="3749151">,</span>&nbsp;<span class="ident" id="3749153">syscall</span><span class="op" id="3749160">.</span><span class="ident" id="3749161">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3749168">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
